/*! For license information please see plotly.js.LICENSE.txt */
require([],(function(){return function(){var Ne={10352:function(Ne,Ge,Qe){var tt,rt;tt=[Qe(20198),Qe(54922),Qe(68996)],void 0===(rt=function(Ne,Ge,Qe){return Ge.bindingHandlers.plotly={init:function(tt,rt){var nt=Ge.unwrap(rt()),at={x:nt.data().value,y:nt.data().count,type:"scatter",mode:"lines",name:nt.data().name,line:{color:nt.primarySeriesColor,width:3}},it={title:{text:nt.title(),font:{family:"Arial, monospace",size:nt.titleSize()},xref:"paper",x:.05},xaxis:{title:{text:nt.xAxisLabel(),font:{family:"Arial, monospace",size:nt.xAxisLabelSize(),color:"#7f7f7f"}}},yaxis:{title:{text:nt.yAxisLabel(),font:{family:"Arial, monospace",size:nt.yAxisLabelSize(),color:"#7f7f7f"}}},legend:{font:{family:"Arial, monospace",color:"#7f7f7f"}},width:Ne(tt).width()-2},ot={responsive:!1,modeBarButtonsToAdd:[{name:"expand height",icon:{width:1800,height:1400,path:"M704 1216q0 -26 -19 -45t-45 -19h-128v-1024h128q26 0 45 -19t19 -45t-19 -45l-256 -256q-19 -19 -45 -19t-45 19l-256 256q-19 19 -19 45t19 45t45 19h128v1024h-128q-26 0 -45 19t-19 45t19 45l256 256q19 19 45 19t45 -19l256 -256q19 -19 19 -45z"},click:function(){nt.autosize=void 0!==Ge.unwrap(nt.autosize)&&!Ge.unwrap(nt.autosize),Ge.unwrap(nt.autosize)?it.height=450:it.height=Ge.unwrap(nt.height)||window.innerHeight-250,Qe.relayout(tt,it)}}]};this.chart=Qe.newPlot(tt,[at],it,ot),Ne(window).resize((function(){it.width=Ne(tt).width()-2,Qe.relayout(tt,it)})),nt.title.subscribe((function(Ne){it.title.text=Ne,Qe.relayout(tt,it)})),nt.titleSize.subscribe((function(Ne){it.title.font.size=Ne,Qe.relayout(tt,it)})),nt.xAxisLabel.subscribe((function(Ne){it.xaxis.title.text=Ne,Qe.relayout(tt,it)})),nt.xAxisLabelSize.subscribe((function(Ne){it.xaxis.title.font.size=Ne,Qe.relayout(tt,it)})),nt.yAxisLabel.subscribe((function(Ne){it.yaxis.title.text=Ne,Qe.relayout(tt,it)})),nt.yAxisLabelSize.subscribe((function(Ne){it.yaxis.title.font.size=Ne,Qe.relayout(tt,it)})),nt.seriesStyles.subscribe((function(Ne){var Ge;Ne.length>=1&&Ne.forEach((function(Ne){Ge=[],tt.data.forEach((function(Qe,tt){Qe.tileid===Ne.tileid&&(Ge=[tt])})),1===Ge.length&&Qe.restyle(tt,{"marker.color":Ne.color},Ge)}))})),nt.seriesData.subscribe((function(Ne){Ne.forEach((function(Ne){if("added"===Ne.status){var Ge=nt.seriesStyles().find((function(Ge){return Ge.tileid===Ne.value.tileid}));Ge&&Qe.addTraces(tt,{x:Ne.value.data.value,y:Ne.value.data.count,opacity:.9,marker:{color:Ge.color},name:Ne.value.name,tileid:Ne.value.tileid},tt.data.length)}else tt.data.forEach((function(Ge,rt){Ge.name===Ne.value.name&&Qe.deleteTraces(tt,rt)}))}))}),this,"arrayChange"),Ge.utils.domNodeDisposal.addDisposeCallback(tt,(function(){}),this)}},Ge.bindingHandlers.plotly}.apply(Ge,tt))||(Ne.exports=rt)},20198:function(Ne,Ge){var Qe;!function(Ge,Qe){"use strict";"object"==typeof Ne.exports?Ne.exports=Ge.document?Qe(Ge,!0):function(Ne){if(!Ne.document)throw new Error("jQuery requires a window with a document");return Qe(Ne)}:Qe(Ge)}("undefined"!=typeof window?window:this,(function(tt,rt){"use strict";var nt=[],at=Object.getPrototypeOf,it=nt.slice,ot=nt.flat?function(Ne){return nt.flat.call(Ne)}:function(Ne){return nt.concat.apply([],Ne)},dt=nt.push,ht=nt.indexOf,Dt={},Ot=Dt.toString,Rt=Dt.hasOwnProperty,Zt=Rt.toString,er=Zt.call(Object),dr={},m=function(Ne){return"function"==typeof Ne&&"number"!=typeof Ne.nodeType&&"function"!=typeof Ne.item},x=function(Ne){return null!=Ne&&Ne===Ne.window},mr=tt.document,xr={type:!0,src:!0,nonce:!0,noModule:!0};function b(Ne,Ge,Qe){var tt,rt,nt=(Qe=Qe||mr).createElement("script");if(nt.text=Ne,Ge)for(tt in xr)(rt=Ge[tt]||Ge.getAttribute&&Ge.getAttribute(tt))&&nt.setAttribute(tt,rt);Qe.head.appendChild(nt).parentNode.removeChild(nt)}function w(Ne){return null==Ne?Ne+"":"object"==typeof Ne||"function"==typeof Ne?Dt[Ot.call(Ne)]||"object":typeof Ne}var br="3.6.3",E=function(Ne,Ge){return new E.fn.init(Ne,Ge)};function p(Ne){var Ge=!!Ne&&"length"in Ne&&Ne.length,Qe=w(Ne);return!m(Ne)&&!x(Ne)&&("array"===Qe||0===Ge||"number"==typeof Ge&&0<Ge&&Ge-1 in Ne)}E.fn=E.prototype={jquery:br,constructor:E,length:0,toArray:function(){return it.call(this)},get:function(Ne){return null==Ne?it.call(this):Ne<0?this[Ne+this.length]:this[Ne]},pushStack:function(Ne){var Ge=E.merge(this.constructor(),Ne);return Ge.prevObject=this,Ge},each:function(Ne){return E.each(this,Ne)},map:function(Ne){return this.pushStack(E.map(this,(function(Ge,Qe){return Ne.call(Ge,Qe,Ge)})))},slice:function(){return this.pushStack(it.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(E.grep(this,(function(Ne,Ge){return(Ge+1)%2})))},odd:function(){return this.pushStack(E.grep(this,(function(Ne,Ge){return Ge%2})))},eq:function(Ne){var Ge=this.length,Qe=+Ne+(Ne<0?Ge:0);return this.pushStack(0<=Qe&&Qe<Ge?[this[Qe]]:[])},end:function(){return this.prevObject||this.constructor()},push:dt,sort:nt.sort,splice:nt.splice},E.extend=E.fn.extend=function(){var Ne,Ge,Qe,tt,rt,nt,at=arguments[0]||{},it=1,ot=arguments.length,dt=!1;for("boolean"==typeof at&&(dt=at,at=arguments[it]||{},it++),"object"==typeof at||m(at)||(at={}),it===ot&&(at=this,it--);it<ot;it++)if(null!=(Ne=arguments[it]))for(Ge in Ne)tt=Ne[Ge],"__proto__"!==Ge&&at!==tt&&(dt&&tt&&(E.isPlainObject(tt)||(rt=Array.isArray(tt)))?(Qe=at[Ge],nt=rt&&!Array.isArray(Qe)?[]:rt||E.isPlainObject(Qe)?Qe:{},rt=!1,at[Ge]=E.extend(dt,nt,tt)):void 0!==tt&&(at[Ge]=tt));return at},E.extend({expando:"jQuery"+(br+Math.random()).replace(/\D/g,""),isReady:!0,error:function(Ne){throw new Error(Ne)},noop:function(){},isPlainObject:function(Ne){var Ge,Qe;return!(!Ne||"[object Object]"!==Ot.call(Ne)||(Ge=at(Ne))&&("function"!=typeof(Qe=Rt.call(Ge,"constructor")&&Ge.constructor)||Zt.call(Qe)!==er))},isEmptyObject:function(Ne){var Ge;for(Ge in Ne)return!1;return!0},globalEval:function(Ne,Ge,Qe){b(Ne,{nonce:Ge&&Ge.nonce},Qe)},each:function(Ne,Ge){var Qe,tt=0;if(p(Ne))for(Qe=Ne.length;tt<Qe&&!1!==Ge.call(Ne[tt],tt,Ne[tt]);tt++);else for(tt in Ne)if(!1===Ge.call(Ne[tt],tt,Ne[tt]))break;return Ne},makeArray:function(Ne,Ge){var Qe=Ge||[];return null!=Ne&&(p(Object(Ne))?E.merge(Qe,"string"==typeof Ne?[Ne]:Ne):dt.call(Qe,Ne)),Qe},inArray:function(Ne,Ge,Qe){return null==Ge?-1:ht.call(Ge,Ne,Qe)},merge:function(Ne,Ge){for(var Qe=+Ge.length,tt=0,rt=Ne.length;tt<Qe;tt++)Ne[rt++]=Ge[tt];return Ne.length=rt,Ne},grep:function(Ne,Ge,Qe){for(var tt=[],rt=0,nt=Ne.length,at=!Qe;rt<nt;rt++)!Ge(Ne[rt],rt)!==at&&tt.push(Ne[rt]);return tt},map:function(Ne,Ge,Qe){var tt,rt,nt=0,at=[];if(p(Ne))for(tt=Ne.length;nt<tt;nt++)null!=(rt=Ge(Ne[nt],nt,Qe))&&at.push(rt);else for(nt in Ne)null!=(rt=Ge(Ne[nt],nt,Qe))&&at.push(rt);return ot(at)},guid:1,support:dr}),"function"==typeof Symbol&&(E.fn[Symbol.iterator]=nt[Symbol.iterator]),E.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(Ne,Ge){Dt["[object "+Ge+"]"]=Ge.toLowerCase()}));var Ar=function(Ne){var Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt,er,dr,mr,xr,br,Ar="sizzle"+1*new Date,en=Ne.document,mn=0,xn=0,kn=ue(),Cn=ue(),En=ue(),Pn=ue(),j=function(Ne,Ge){return Ne===Ge&&(Dt=!0),0},Dn={}.hasOwnProperty,In=[],zn=In.pop,Bn=In.push,Vn=In.push,Hn=In.slice,P=function(Ne,Ge){for(var Qe=0,tt=Ne.length;Qe<tt;Qe++)if(Ne[Qe]===Ge)return Qe;return-1},qn="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",Yn="[\\x20\\t\\r\\n\\f]",$n="(?:\\\\[\\da-fA-F]{1,6}"+Yn+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",ra="\\["+Yn+"*("+$n+")(?:"+Yn+"*([*^$|!~]?=)"+Yn+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+$n+"))|)"+Yn+"*\\]",oa=":("+$n+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ra+")*)|.*)\\)|)",pa=new RegExp(Yn+"+","g"),ga=new RegExp("^"+Yn+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Yn+"+$","g"),ma=new RegExp("^"+Yn+"*,"+Yn+"*"),_a=new RegExp("^"+Yn+"*([>+~]|"+Yn+")"+Yn+"*"),Va=new RegExp(Yn+"|>"),Wa=new RegExp(oa),Qa=new RegExp("^"+$n+"$"),ti={ID:new RegExp("^#("+$n+")"),CLASS:new RegExp("^\\.("+$n+")"),TAG:new RegExp("^("+$n+"|[*])"),ATTR:new RegExp("^"+ra),PSEUDO:new RegExp("^"+oa),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+Yn+"*(even|odd|(([+-]|)(\\d*)n|)"+Yn+"*(?:([+-]|)"+Yn+"*(\\d+)|))"+Yn+"*\\)|)","i"),bool:new RegExp("^(?:"+qn+")$","i"),needsContext:new RegExp("^"+Yn+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+Yn+"*((?:-\\d)?\\d*)"+Yn+"*\\)|)(?=[^-]|$)","i")},ni=/HTML$/i,di=/^(?:input|select|textarea|button)$/i,ji=/^h\d$/i,Hi=/^[^{]+\{\s*\[native \w/,Yi=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,uo=/[+~]/,go=new RegExp("\\\\[\\da-fA-F]{1,6}"+Yn+"?|\\\\([^\\r\\n\\f])","g"),ne=function(Ne,Ge){var Qe="0x"+Ne.slice(1)-65536;return Ge||(Qe<0?String.fromCharCode(Qe+65536):String.fromCharCode(Qe>>10|55296,1023&Qe|56320))},ns=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ie=function(Ne,Ge){return Ge?"\0"===Ne?"ï¿½":Ne.slice(0,-1)+"\\"+Ne.charCodeAt(Ne.length-1).toString(16)+" ":"\\"+Ne},oe=function(){Ot()},as=be((function(Ne){return!0===Ne.disabled&&"fieldset"===Ne.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{Vn.apply(In=Hn.call(en.childNodes),en.childNodes),In[en.childNodes.length].nodeType}catch(Ge){Vn={apply:In.length?function(Ne,Ge){Bn.apply(Ne,Hn.call(Ge))}:function(Ne,Ge){for(var Qe=Ne.length,tt=0;Ne[Qe++]=Ge[tt++];);Ne.length=Qe-1}}}function se(Ne,Ge,tt,rt){var nt,it,dt,ht,Dt,Zt,mr,xr=Ge&&Ge.ownerDocument,en=Ge?Ge.nodeType:9;if(tt=tt||[],"string"!=typeof Ne||!Ne||1!==en&&9!==en&&11!==en)return tt;if(!rt&&(Ot(Ge),Ge=Ge||Rt,er)){if(11!==en&&(Dt=Yi.exec(Ne)))if(nt=Dt[1]){if(9===en){if(!(dt=Ge.getElementById(nt)))return tt;if(dt.id===nt)return tt.push(dt),tt}else if(xr&&(dt=xr.getElementById(nt))&&br(Ge,dt)&&dt.id===nt)return tt.push(dt),tt}else{if(Dt[2])return Vn.apply(tt,Ge.getElementsByTagName(Ne)),tt;if((nt=Dt[3])&&Qe.getElementsByClassName&&Ge.getElementsByClassName)return Vn.apply(tt,Ge.getElementsByClassName(nt)),tt}if(Qe.qsa&&!Pn[Ne+" "]&&(!dr||!dr.test(Ne))&&(1!==en||"object"!==Ge.nodeName.toLowerCase())){if(mr=Ne,xr=Ge,1===en&&(Va.test(Ne)||_a.test(Ne))){for((xr=uo.test(Ne)&&ve(Ge.parentNode)||Ge)===Ge&&Qe.scope||((ht=Ge.getAttribute("id"))?ht=ht.replace(ns,ie):Ge.setAttribute("id",ht=Ar)),it=(Zt=at(Ne)).length;it--;)Zt[it]=(ht?"#"+ht:":scope")+" "+xe(Zt[it]);mr=Zt.join(",")}try{if(Qe.cssSupportsSelector&&!CSS.supports("selector(:is("+mr+"))"))throw new Error;return Vn.apply(tt,xr.querySelectorAll(mr)),tt}catch(Ge){Pn(Ne,!0)}finally{ht===Ar&&Ge.removeAttribute("id")}}}return ot(Ne.replace(ga,"$1"),Ge,tt,rt)}function ue(){var Ne=[];return function e(Ge,Qe){return Ne.push(Ge+" ")>tt.cacheLength&&delete e[Ne.shift()],e[Ge+" "]=Qe}}function le(Ne){return Ne[Ar]=!0,Ne}function ce(Ne){var Ge=Rt.createElement("fieldset");try{return!!Ne(Ge)}catch(Ne){return!1}finally{Ge.parentNode&&Ge.parentNode.removeChild(Ge),Ge=null}}function fe(Ne,Ge){for(var Qe=Ne.split("|"),rt=Qe.length;rt--;)tt.attrHandle[Qe[rt]]=Ge}function pe(Ne,Ge){var Qe=Ge&&Ne,tt=Qe&&1===Ne.nodeType&&1===Ge.nodeType&&Ne.sourceIndex-Ge.sourceIndex;if(tt)return tt;if(Qe)for(;Qe=Qe.nextSibling;)if(Qe===Ge)return-1;return Ne?1:-1}function de(Ne){return function(Ge){return"input"===Ge.nodeName.toLowerCase()&&Ge.type===Ne}}function he(Ne){return function(Ge){var Qe=Ge.nodeName.toLowerCase();return("input"===Qe||"button"===Qe)&&Ge.type===Ne}}function ge(Ne){return function(Ge){return"form"in Ge?Ge.parentNode&&!1===Ge.disabled?"label"in Ge?"label"in Ge.parentNode?Ge.parentNode.disabled===Ne:Ge.disabled===Ne:Ge.isDisabled===Ne||Ge.isDisabled!==!Ne&&as(Ge)===Ne:Ge.disabled===Ne:"label"in Ge&&Ge.disabled===Ne}}function ye(Ne){return le((function(Ge){return Ge=+Ge,le((function(Qe,tt){for(var rt,nt=Ne([],Qe.length,Ge),at=nt.length;at--;)Qe[rt=nt[at]]&&(Qe[rt]=!(tt[rt]=Qe[rt]))}))}))}function ve(Ne){return Ne&&void 0!==Ne.getElementsByTagName&&Ne}for(Ge in Qe=se.support={},nt=se.isXML=function(Ne){var Ge=Ne&&Ne.namespaceURI,Qe=Ne&&(Ne.ownerDocument||Ne).documentElement;return!ni.test(Ge||Qe&&Qe.nodeName||"HTML")},Ot=se.setDocument=function(Ne){var Ge,rt,at=Ne?Ne.ownerDocument||Ne:en;return at!=Rt&&9===at.nodeType&&at.documentElement&&(Zt=(Rt=at).documentElement,er=!nt(Rt),en!=Rt&&(rt=Rt.defaultView)&&rt.top!==rt&&(rt.addEventListener?rt.addEventListener("unload",oe,!1):rt.attachEvent&&rt.attachEvent("onunload",oe)),Qe.scope=ce((function(Ne){return Zt.appendChild(Ne).appendChild(Rt.createElement("div")),void 0!==Ne.querySelectorAll&&!Ne.querySelectorAll(":scope fieldset div").length})),Qe.cssSupportsSelector=ce((function(){return CSS.supports("selector(*)")&&Rt.querySelectorAll(":is(:jqfake)")&&!CSS.supports("selector(:is(*,:jqfake))")})),Qe.attributes=ce((function(Ne){return Ne.className="i",!Ne.getAttribute("className")})),Qe.getElementsByTagName=ce((function(Ne){return Ne.appendChild(Rt.createComment("")),!Ne.getElementsByTagName("*").length})),Qe.getElementsByClassName=Hi.test(Rt.getElementsByClassName),Qe.getById=ce((function(Ne){return Zt.appendChild(Ne).id=Ar,!Rt.getElementsByName||!Rt.getElementsByName(Ar).length})),Qe.getById?(tt.filter.ID=function(Ne){var Ge=Ne.replace(go,ne);return function(Ne){return Ne.getAttribute("id")===Ge}},tt.find.ID=function(Ne,Ge){if(void 0!==Ge.getElementById&&er){var Qe=Ge.getElementById(Ne);return Qe?[Qe]:[]}}):(tt.filter.ID=function(Ne){var Ge=Ne.replace(go,ne);return function(Ne){var Qe=void 0!==Ne.getAttributeNode&&Ne.getAttributeNode("id");return Qe&&Qe.value===Ge}},tt.find.ID=function(Ne,Ge){if(void 0!==Ge.getElementById&&er){var Qe,tt,rt,nt=Ge.getElementById(Ne);if(nt){if((Qe=nt.getAttributeNode("id"))&&Qe.value===Ne)return[nt];for(rt=Ge.getElementsByName(Ne),tt=0;nt=rt[tt++];)if((Qe=nt.getAttributeNode("id"))&&Qe.value===Ne)return[nt]}return[]}}),tt.find.TAG=Qe.getElementsByTagName?function(Ne,Ge){return void 0!==Ge.getElementsByTagName?Ge.getElementsByTagName(Ne):Qe.qsa?Ge.querySelectorAll(Ne):void 0}:function(Ne,Ge){var Qe,tt=[],rt=0,nt=Ge.getElementsByTagName(Ne);if("*"===Ne){for(;Qe=nt[rt++];)1===Qe.nodeType&&tt.push(Qe);return tt}return nt},tt.find.CLASS=Qe.getElementsByClassName&&function(Ne,Ge){if(void 0!==Ge.getElementsByClassName&&er)return Ge.getElementsByClassName(Ne)},mr=[],dr=[],(Qe.qsa=Hi.test(Rt.querySelectorAll))&&(ce((function(Ne){var Ge;Zt.appendChild(Ne).innerHTML="<a id='"+Ar+"'></a><select id='"+Ar+"-\r\\' msallowcapture=''><option selected=''></option></select>",Ne.querySelectorAll("[msallowcapture^='']").length&&dr.push("[*^$]="+Yn+"*(?:''|\"\")"),Ne.querySelectorAll("[selected]").length||dr.push("\\["+Yn+"*(?:value|"+qn+")"),Ne.querySelectorAll("[id~="+Ar+"-]").length||dr.push("~="),(Ge=Rt.createElement("input")).setAttribute("name",""),Ne.appendChild(Ge),Ne.querySelectorAll("[name='']").length||dr.push("\\["+Yn+"*name"+Yn+"*="+Yn+"*(?:''|\"\")"),Ne.querySelectorAll(":checked").length||dr.push(":checked"),Ne.querySelectorAll("a#"+Ar+"+*").length||dr.push(".#.+[+~]"),Ne.querySelectorAll("\\\f"),dr.push("[\\r\\n\\f]")})),ce((function(Ne){Ne.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var Ge=Rt.createElement("input");Ge.setAttribute("type","hidden"),Ne.appendChild(Ge).setAttribute("name","D"),Ne.querySelectorAll("[name=d]").length&&dr.push("name"+Yn+"*[*^$|!~]?="),2!==Ne.querySelectorAll(":enabled").length&&dr.push(":enabled",":disabled"),Zt.appendChild(Ne).disabled=!0,2!==Ne.querySelectorAll(":disabled").length&&dr.push(":enabled",":disabled"),Ne.querySelectorAll("*,:x"),dr.push(",.*:")}))),(Qe.matchesSelector=Hi.test(xr=Zt.matches||Zt.webkitMatchesSelector||Zt.mozMatchesSelector||Zt.oMatchesSelector||Zt.msMatchesSelector))&&ce((function(Ne){Qe.disconnectedMatch=xr.call(Ne,"*"),xr.call(Ne,"[s!='']:x"),mr.push("!=",oa)})),Qe.cssSupportsSelector||dr.push(":has"),dr=dr.length&&new RegExp(dr.join("|")),mr=mr.length&&new RegExp(mr.join("|")),Ge=Hi.test(Zt.compareDocumentPosition),br=Ge||Hi.test(Zt.contains)?function(Ne,Ge){var Qe=9===Ne.nodeType&&Ne.documentElement||Ne,tt=Ge&&Ge.parentNode;return Ne===tt||!(!tt||1!==tt.nodeType||!(Qe.contains?Qe.contains(tt):Ne.compareDocumentPosition&&16&Ne.compareDocumentPosition(tt)))}:function(Ne,Ge){if(Ge)for(;Ge=Ge.parentNode;)if(Ge===Ne)return!0;return!1},j=Ge?function(Ne,Ge){if(Ne===Ge)return Dt=!0,0;var tt=!Ne.compareDocumentPosition-!Ge.compareDocumentPosition;return tt||(1&(tt=(Ne.ownerDocument||Ne)==(Ge.ownerDocument||Ge)?Ne.compareDocumentPosition(Ge):1)||!Qe.sortDetached&&Ge.compareDocumentPosition(Ne)===tt?Ne==Rt||Ne.ownerDocument==en&&br(en,Ne)?-1:Ge==Rt||Ge.ownerDocument==en&&br(en,Ge)?1:ht?P(ht,Ne)-P(ht,Ge):0:4&tt?-1:1)}:function(Ne,Ge){if(Ne===Ge)return Dt=!0,0;var Qe,tt=0,rt=Ne.parentNode,nt=Ge.parentNode,at=[Ne],it=[Ge];if(!rt||!nt)return Ne==Rt?-1:Ge==Rt?1:rt?-1:nt?1:ht?P(ht,Ne)-P(ht,Ge):0;if(rt===nt)return pe(Ne,Ge);for(Qe=Ne;Qe=Qe.parentNode;)at.unshift(Qe);for(Qe=Ge;Qe=Qe.parentNode;)it.unshift(Qe);for(;at[tt]===it[tt];)tt++;return tt?pe(at[tt],it[tt]):at[tt]==en?-1:it[tt]==en?1:0}),Rt},se.matches=function(Ne,Ge){return se(Ne,null,null,Ge)},se.matchesSelector=function(Ne,Ge){if(Ot(Ne),Qe.matchesSelector&&er&&!Pn[Ge+" "]&&(!mr||!mr.test(Ge))&&(!dr||!dr.test(Ge)))try{var tt=xr.call(Ne,Ge);if(tt||Qe.disconnectedMatch||Ne.document&&11!==Ne.document.nodeType)return tt}catch(Ne){Pn(Ge,!0)}return 0<se(Ge,Rt,null,[Ne]).length},se.contains=function(Ne,Ge){return(Ne.ownerDocument||Ne)!=Rt&&Ot(Ne),br(Ne,Ge)},se.attr=function(Ne,Ge){(Ne.ownerDocument||Ne)!=Rt&&Ot(Ne);var rt=tt.attrHandle[Ge.toLowerCase()],nt=rt&&Dn.call(tt.attrHandle,Ge.toLowerCase())?rt(Ne,Ge,!er):void 0;return void 0!==nt?nt:Qe.attributes||!er?Ne.getAttribute(Ge):(nt=Ne.getAttributeNode(Ge))&&nt.specified?nt.value:null},se.escape=function(Ne){return(Ne+"").replace(ns,ie)},se.error=function(Ne){throw new Error("Syntax error, unrecognized expression: "+Ne)},se.uniqueSort=function(Ne){var Ge,tt=[],rt=0,nt=0;if(Dt=!Qe.detectDuplicates,ht=!Qe.sortStable&&Ne.slice(0),Ne.sort(j),Dt){for(;Ge=Ne[nt++];)Ge===Ne[nt]&&(rt=tt.push(nt));for(;rt--;)Ne.splice(tt[rt],1)}return ht=null,Ne},rt=se.getText=function(Ne){var Ge,Qe="",tt=0,nt=Ne.nodeType;if(nt){if(1===nt||9===nt||11===nt){if("string"==typeof Ne.textContent)return Ne.textContent;for(Ne=Ne.firstChild;Ne;Ne=Ne.nextSibling)Qe+=rt(Ne)}else if(3===nt||4===nt)return Ne.nodeValue}else for(;Ge=Ne[tt++];)Qe+=rt(Ge);return Qe},(tt=se.selectors={cacheLength:50,createPseudo:le,match:ti,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(Ne){return Ne[1]=Ne[1].replace(go,ne),Ne[3]=(Ne[3]||Ne[4]||Ne[5]||"").replace(go,ne),"~="===Ne[2]&&(Ne[3]=" "+Ne[3]+" "),Ne.slice(0,4)},CHILD:function(Ne){return Ne[1]=Ne[1].toLowerCase(),"nth"===Ne[1].slice(0,3)?(Ne[3]||se.error(Ne[0]),Ne[4]=+(Ne[4]?Ne[5]+(Ne[6]||1):2*("even"===Ne[3]||"odd"===Ne[3])),Ne[5]=+(Ne[7]+Ne[8]||"odd"===Ne[3])):Ne[3]&&se.error(Ne[0]),Ne},PSEUDO:function(Ne){var Ge,Qe=!Ne[6]&&Ne[2];return ti.CHILD.test(Ne[0])?null:(Ne[3]?Ne[2]=Ne[4]||Ne[5]||"":Qe&&Wa.test(Qe)&&(Ge=at(Qe,!0))&&(Ge=Qe.indexOf(")",Qe.length-Ge)-Qe.length)&&(Ne[0]=Ne[0].slice(0,Ge),Ne[2]=Qe.slice(0,Ge)),Ne.slice(0,3))}},filter:{TAG:function(Ne){var Ge=Ne.replace(go,ne).toLowerCase();return"*"===Ne?function(){return!0}:function(Ne){return Ne.nodeName&&Ne.nodeName.toLowerCase()===Ge}},CLASS:function(Ne){var Ge=kn[Ne+" "];return Ge||(Ge=new RegExp("(^|"+Yn+")"+Ne+"("+Yn+"|$)"))&&kn(Ne,(function(Ne){return Ge.test("string"==typeof Ne.className&&Ne.className||void 0!==Ne.getAttribute&&Ne.getAttribute("class")||"")}))},ATTR:function(Ne,Ge,Qe){return function(tt){var rt=se.attr(tt,Ne);return null==rt?"!="===Ge:!Ge||(rt+="","="===Ge?rt===Qe:"!="===Ge?rt!==Qe:"^="===Ge?Qe&&0===rt.indexOf(Qe):"*="===Ge?Qe&&-1<rt.indexOf(Qe):"$="===Ge?Qe&&rt.slice(-Qe.length)===Qe:"~="===Ge?-1<(" "+rt.replace(pa," ")+" ").indexOf(Qe):"|="===Ge&&(rt===Qe||rt.slice(0,Qe.length+1)===Qe+"-"))}},CHILD:function(Ne,Ge,Qe,tt,rt){var nt="nth"!==Ne.slice(0,3),at="last"!==Ne.slice(-4),it="of-type"===Ge;return 1===tt&&0===rt?function(Ne){return!!Ne.parentNode}:function(Ge,Qe,ot){var dt,ht,Dt,Ot,Rt,Zt,er=nt!==at?"nextSibling":"previousSibling",dr=Ge.parentNode,mr=it&&Ge.nodeName.toLowerCase(),xr=!ot&&!it,br=!1;if(dr){if(nt){for(;er;){for(Ot=Ge;Ot=Ot[er];)if(it?Ot.nodeName.toLowerCase()===mr:1===Ot.nodeType)return!1;Zt=er="only"===Ne&&!Zt&&"nextSibling"}return!0}if(Zt=[at?dr.firstChild:dr.lastChild],at&&xr){for(br=(Rt=(dt=(ht=(Dt=(Ot=dr)[Ar]||(Ot[Ar]={}))[Ot.uniqueID]||(Dt[Ot.uniqueID]={}))[Ne]||[])[0]===mn&&dt[1])&&dt[2],Ot=Rt&&dr.childNodes[Rt];Ot=++Rt&&Ot&&Ot[er]||(br=Rt=0)||Zt.pop();)if(1===Ot.nodeType&&++br&&Ot===Ge){ht[Ne]=[mn,Rt,br];break}}else if(xr&&(br=Rt=(dt=(ht=(Dt=(Ot=Ge)[Ar]||(Ot[Ar]={}))[Ot.uniqueID]||(Dt[Ot.uniqueID]={}))[Ne]||[])[0]===mn&&dt[1]),!1===br)for(;(Ot=++Rt&&Ot&&Ot[er]||(br=Rt=0)||Zt.pop())&&((it?Ot.nodeName.toLowerCase()!==mr:1!==Ot.nodeType)||!++br||(xr&&((ht=(Dt=Ot[Ar]||(Ot[Ar]={}))[Ot.uniqueID]||(Dt[Ot.uniqueID]={}))[Ne]=[mn,br]),Ot!==Ge)););return(br-=rt)===tt||br%tt==0&&0<=br/tt}}},PSEUDO:function(Ne,Ge){var Qe,rt=tt.pseudos[Ne]||tt.setFilters[Ne.toLowerCase()]||se.error("unsupported pseudo: "+Ne);return rt[Ar]?rt(Ge):1<rt.length?(Qe=[Ne,Ne,"",Ge],tt.setFilters.hasOwnProperty(Ne.toLowerCase())?le((function(Ne,Qe){for(var tt,nt=rt(Ne,Ge),at=nt.length;at--;)Ne[tt=P(Ne,nt[at])]=!(Qe[tt]=nt[at])})):function(Ne){return rt(Ne,0,Qe)}):rt}},pseudos:{not:le((function(Ne){var Ge=[],Qe=[],tt=it(Ne.replace(ga,"$1"));return tt[Ar]?le((function(Ne,Ge,Qe,rt){for(var nt,at=tt(Ne,null,rt,[]),it=Ne.length;it--;)(nt=at[it])&&(Ne[it]=!(Ge[it]=nt))})):function(Ne,rt,nt){return Ge[0]=Ne,tt(Ge,null,nt,Qe),Ge[0]=null,!Qe.pop()}})),has:le((function(Ne){return function(Ge){return 0<se(Ne,Ge).length}})),contains:le((function(Ne){return Ne=Ne.replace(go,ne),function(Ge){return-1<(Ge.textContent||rt(Ge)).indexOf(Ne)}})),lang:le((function(Ne){return Qa.test(Ne||"")||se.error("unsupported lang: "+Ne),Ne=Ne.replace(go,ne).toLowerCase(),function(Ge){var Qe;do{if(Qe=er?Ge.lang:Ge.getAttribute("xml:lang")||Ge.getAttribute("lang"))return(Qe=Qe.toLowerCase())===Ne||0===Qe.indexOf(Ne+"-")}while((Ge=Ge.parentNode)&&1===Ge.nodeType);return!1}})),target:function(Ge){var Qe=Ne.location&&Ne.location.hash;return Qe&&Qe.slice(1)===Ge.id},root:function(Ne){return Ne===Zt},focus:function(Ne){return Ne===Rt.activeElement&&(!Rt.hasFocus||Rt.hasFocus())&&!!(Ne.type||Ne.href||~Ne.tabIndex)},enabled:ge(!1),disabled:ge(!0),checked:function(Ne){var Ge=Ne.nodeName.toLowerCase();return"input"===Ge&&!!Ne.checked||"option"===Ge&&!!Ne.selected},selected:function(Ne){return Ne.parentNode&&Ne.parentNode.selectedIndex,!0===Ne.selected},empty:function(Ne){for(Ne=Ne.firstChild;Ne;Ne=Ne.nextSibling)if(Ne.nodeType<6)return!1;return!0},parent:function(Ne){return!tt.pseudos.empty(Ne)},header:function(Ne){return ji.test(Ne.nodeName)},input:function(Ne){return di.test(Ne.nodeName)},button:function(Ne){var Ge=Ne.nodeName.toLowerCase();return"input"===Ge&&"button"===Ne.type||"button"===Ge},text:function(Ne){var Ge;return"input"===Ne.nodeName.toLowerCase()&&"text"===Ne.type&&(null==(Ge=Ne.getAttribute("type"))||"text"===Ge.toLowerCase())},first:ye((function(){return[0]})),last:ye((function(Ne,Ge){return[Ge-1]})),eq:ye((function(Ne,Ge,Qe){return[Qe<0?Qe+Ge:Qe]})),even:ye((function(Ne,Ge){for(var Qe=0;Qe<Ge;Qe+=2)Ne.push(Qe);return Ne})),odd:ye((function(Ne,Ge){for(var Qe=1;Qe<Ge;Qe+=2)Ne.push(Qe);return Ne})),lt:ye((function(Ne,Ge,Qe){for(var tt=Qe<0?Qe+Ge:Ge<Qe?Ge:Qe;0<=--tt;)Ne.push(tt);return Ne})),gt:ye((function(Ne,Ge,Qe){for(var tt=Qe<0?Qe+Ge:Qe;++tt<Ge;)Ne.push(tt);return Ne}))}}).pseudos.nth=tt.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})tt.pseudos[Ge]=de(Ge);for(Ge in{submit:!0,reset:!0})tt.pseudos[Ge]=he(Ge);function me(){}function xe(Ne){for(var Ge=0,Qe=Ne.length,tt="";Ge<Qe;Ge++)tt+=Ne[Ge].value;return tt}function be(Ne,Ge,Qe){var tt=Ge.dir,rt=Ge.next,nt=rt||tt,at=Qe&&"parentNode"===nt,it=xn++;return Ge.first?function(Ge,Qe,rt){for(;Ge=Ge[tt];)if(1===Ge.nodeType||at)return Ne(Ge,Qe,rt);return!1}:function(Ge,Qe,ot){var dt,ht,Dt,Ot=[mn,it];if(ot){for(;Ge=Ge[tt];)if((1===Ge.nodeType||at)&&Ne(Ge,Qe,ot))return!0}else for(;Ge=Ge[tt];)if(1===Ge.nodeType||at)if(ht=(Dt=Ge[Ar]||(Ge[Ar]={}))[Ge.uniqueID]||(Dt[Ge.uniqueID]={}),rt&&rt===Ge.nodeName.toLowerCase())Ge=Ge[tt]||Ge;else{if((dt=ht[nt])&&dt[0]===mn&&dt[1]===it)return Ot[2]=dt[2];if((ht[nt]=Ot)[2]=Ne(Ge,Qe,ot))return!0}return!1}}function we(Ne){return 1<Ne.length?function(Ge,Qe,tt){for(var rt=Ne.length;rt--;)if(!Ne[rt](Ge,Qe,tt))return!1;return!0}:Ne[0]}function Te(Ne,Ge,Qe,tt,rt){for(var nt,at=[],it=0,ot=Ne.length,dt=null!=Ge;it<ot;it++)(nt=Ne[it])&&(Qe&&!Qe(nt,tt,rt)||(at.push(nt),dt&&Ge.push(it)));return at}function Ce(Ne,Ge,Qe,tt,rt,nt){return tt&&!tt[Ar]&&(tt=Ce(tt)),rt&&!rt[Ar]&&(rt=Ce(rt,nt)),le((function(nt,at,it,ot){var dt,ht,Dt,Ot=[],Rt=[],Zt=at.length,er=nt||function(Ne,Ge,Qe){for(var tt=0,rt=Ge.length;tt<rt;tt++)se(Ne,Ge[tt],Qe);return Qe}(Ge||"*",it.nodeType?[it]:it,[]),dr=!Ne||!nt&&Ge?er:Te(er,Ot,Ne,it,ot),mr=Qe?rt||(nt?Ne:Zt||tt)?[]:at:dr;if(Qe&&Qe(dr,mr,it,ot),tt)for(dt=Te(mr,Rt),tt(dt,[],it,ot),ht=dt.length;ht--;)(Dt=dt[ht])&&(mr[Rt[ht]]=!(dr[Rt[ht]]=Dt));if(nt){if(rt||Ne){if(rt){for(dt=[],ht=mr.length;ht--;)(Dt=mr[ht])&&dt.push(dr[ht]=Dt);rt(null,mr=[],dt,ot)}for(ht=mr.length;ht--;)(Dt=mr[ht])&&-1<(dt=rt?P(nt,Dt):Ot[ht])&&(nt[dt]=!(at[dt]=Dt))}}else mr=Te(mr===at?mr.splice(Zt,mr.length):mr),rt?rt(null,at,mr,ot):Vn.apply(at,mr)}))}function Se(Ne){for(var Ge,Qe,rt,nt=Ne.length,at=tt.relative[Ne[0].type],it=at||tt.relative[" "],ot=at?1:0,ht=be((function(Ne){return Ne===Ge}),it,!0),Dt=be((function(Ne){return-1<P(Ge,Ne)}),it,!0),Ot=[function(Ne,Qe,tt){var rt=!at&&(tt||Qe!==dt)||((Ge=Qe).nodeType?ht(Ne,Qe,tt):Dt(Ne,Qe,tt));return Ge=null,rt}];ot<nt;ot++)if(Qe=tt.relative[Ne[ot].type])Ot=[be(we(Ot),Qe)];else{if((Qe=tt.filter[Ne[ot].type].apply(null,Ne[ot].matches))[Ar]){for(rt=++ot;rt<nt&&!tt.relative[Ne[rt].type];rt++);return Ce(1<ot&&we(Ot),1<ot&&xe(Ne.slice(0,ot-1).concat({value:" "===Ne[ot-2].type?"*":""})).replace(ga,"$1"),Qe,ot<rt&&Se(Ne.slice(ot,rt)),rt<nt&&Se(Ne=Ne.slice(rt)),rt<nt&&xe(Ne))}Ot.push(Qe)}return we(Ot)}return me.prototype=tt.filters=tt.pseudos,tt.setFilters=new me,at=se.tokenize=function(Ne,Ge){var Qe,rt,nt,at,it,ot,dt,ht=Cn[Ne+" "];if(ht)return Ge?0:ht.slice(0);for(it=Ne,ot=[],dt=tt.preFilter;it;){for(at in Qe&&!(rt=ma.exec(it))||(rt&&(it=it.slice(rt[0].length)||it),ot.push(nt=[])),Qe=!1,(rt=_a.exec(it))&&(Qe=rt.shift(),nt.push({value:Qe,type:rt[0].replace(ga," ")}),it=it.slice(Qe.length)),tt.filter)!(rt=ti[at].exec(it))||dt[at]&&!(rt=dt[at](rt))||(Qe=rt.shift(),nt.push({value:Qe,type:at,matches:rt}),it=it.slice(Qe.length));if(!Qe)break}return Ge?it.length:it?se.error(Ne):Cn(Ne,ot).slice(0)},it=se.compile=function(Ne,Ge){var Qe,rt,nt,it,ot,ht,Dt=[],Zt=[],dr=En[Ne+" "];if(!dr){for(Ge||(Ge=at(Ne)),Qe=Ge.length;Qe--;)(dr=Se(Ge[Qe]))[Ar]?Dt.push(dr):Zt.push(dr);(dr=En(Ne,(rt=Zt,it=0<(nt=Dt).length,ot=0<rt.length,ht=function(Ne,Ge,Qe,at,ht){var Dt,Zt,dr,mr=0,xr="0",br=Ne&&[],Ar=[],en=dt,xn=Ne||ot&&tt.find.TAG("*",ht),kn=mn+=null==en?1:Math.random()||.1,Cn=xn.length;for(ht&&(dt=Ge==Rt||Ge||ht);xr!==Cn&&null!=(Dt=xn[xr]);xr++){if(ot&&Dt){for(Zt=0,Ge||Dt.ownerDocument==Rt||(Ot(Dt),Qe=!er);dr=rt[Zt++];)if(dr(Dt,Ge||Rt,Qe)){at.push(Dt);break}ht&&(mn=kn)}it&&((Dt=!dr&&Dt)&&mr--,Ne&&br.push(Dt))}if(mr+=xr,it&&xr!==mr){for(Zt=0;dr=nt[Zt++];)dr(br,Ar,Ge,Qe);if(Ne){if(0<mr)for(;xr--;)br[xr]||Ar[xr]||(Ar[xr]=zn.call(at));Ar=Te(Ar)}Vn.apply(at,Ar),ht&&!Ne&&0<Ar.length&&1<mr+nt.length&&se.uniqueSort(at)}return ht&&(mn=kn,dt=en),br},it?le(ht):ht))).selector=Ne}return dr},ot=se.select=function(Ne,Ge,Qe,rt){var nt,ot,dt,ht,Dt,Ot="function"==typeof Ne&&Ne,Rt=!rt&&at(Ne=Ot.selector||Ne);if(Qe=Qe||[],1===Rt.length){if(2<(ot=Rt[0]=Rt[0].slice(0)).length&&"ID"===(dt=ot[0]).type&&9===Ge.nodeType&&er&&tt.relative[ot[1].type]){if(!(Ge=(tt.find.ID(dt.matches[0].replace(go,ne),Ge)||[])[0]))return Qe;Ot&&(Ge=Ge.parentNode),Ne=Ne.slice(ot.shift().value.length)}for(nt=ti.needsContext.test(Ne)?0:ot.length;nt--&&(dt=ot[nt],!tt.relative[ht=dt.type]);)if((Dt=tt.find[ht])&&(rt=Dt(dt.matches[0].replace(go,ne),uo.test(ot[0].type)&&ve(Ge.parentNode)||Ge))){if(ot.splice(nt,1),!(Ne=rt.length&&xe(ot)))return Vn.apply(Qe,rt),Qe;break}}return(Ot||it(Ne,Rt))(rt,Ge,!er,Qe,!Ge||uo.test(Ne)&&ve(Ge.parentNode)||Ge),Qe},Qe.sortStable=Ar.split("").sort(j).join("")===Ar,Qe.detectDuplicates=!!Dt,Ot(),Qe.sortDetached=ce((function(Ne){return 1&Ne.compareDocumentPosition(Rt.createElement("fieldset"))})),ce((function(Ne){return Ne.innerHTML="<a href='#'></a>","#"===Ne.firstChild.getAttribute("href")}))||fe("type|href|height|width",(function(Ne,Ge,Qe){if(!Qe)return Ne.getAttribute(Ge,"type"===Ge.toLowerCase()?1:2)})),Qe.attributes&&ce((function(Ne){return Ne.innerHTML="<input/>",Ne.firstChild.setAttribute("value",""),""===Ne.firstChild.getAttribute("value")}))||fe("value",(function(Ne,Ge,Qe){if(!Qe&&"input"===Ne.nodeName.toLowerCase())return Ne.defaultValue})),ce((function(Ne){return null==Ne.getAttribute("disabled")}))||fe(qn,(function(Ne,Ge,Qe){var tt;if(!Qe)return!0===Ne[Ge]?Ge.toLowerCase():(tt=Ne.getAttributeNode(Ge))&&tt.specified?tt.value:null})),se}(tt);E.find=Ar,E.expr=Ar.selectors,E.expr[":"]=E.expr.pseudos,E.uniqueSort=E.unique=Ar.uniqueSort,E.text=Ar.getText,E.isXMLDoc=Ar.isXML,E.contains=Ar.contains,E.escapeSelector=Ar.escape;var h=function(Ne,Ge,Qe){for(var tt=[],rt=void 0!==Qe;(Ne=Ne[Ge])&&9!==Ne.nodeType;)if(1===Ne.nodeType){if(rt&&E(Ne).is(Qe))break;tt.push(Ne)}return tt},T=function(Ne,Ge){for(var Qe=[];Ne;Ne=Ne.nextSibling)1===Ne.nodeType&&Ne!==Ge&&Qe.push(Ne);return Qe},en=E.expr.match.needsContext;function A(Ne,Ge){return Ne.nodeName&&Ne.nodeName.toLowerCase()===Ge.toLowerCase()}var mn=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function j(Ne,Ge,Qe){return m(Ge)?E.grep(Ne,(function(Ne,tt){return!!Ge.call(Ne,tt,Ne)!==Qe})):Ge.nodeType?E.grep(Ne,(function(Ne){return Ne===Ge!==Qe})):"string"!=typeof Ge?E.grep(Ne,(function(Ne){return-1<ht.call(Ge,Ne)!==Qe})):E.filter(Ge,Ne,Qe)}E.filter=function(Ne,Ge,Qe){var tt=Ge[0];return Qe&&(Ne=":not("+Ne+")"),1===Ge.length&&1===tt.nodeType?E.find.matchesSelector(tt,Ne)?[tt]:[]:E.find.matches(Ne,E.grep(Ge,(function(Ne){return 1===Ne.nodeType})))},E.fn.extend({find:function(Ne){var Ge,Qe,tt=this.length,rt=this;if("string"!=typeof Ne)return this.pushStack(E(Ne).filter((function(){for(Ge=0;Ge<tt;Ge++)if(E.contains(rt[Ge],this))return!0})));for(Qe=this.pushStack([]),Ge=0;Ge<tt;Ge++)E.find(Ne,rt[Ge],Qe);return 1<tt?E.uniqueSort(Qe):Qe},filter:function(Ne){return this.pushStack(j(this,Ne||[],!1))},not:function(Ne){return this.pushStack(j(this,Ne||[],!0))},is:function(Ne){return!!j(this,"string"==typeof Ne&&en.test(Ne)?E(Ne):Ne||[],!1).length}});var xn,kn=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(E.fn.init=function(Ne,Ge,Qe){var tt,rt;if(!Ne)return this;if(Qe=Qe||xn,"string"==typeof Ne){if(!(tt="<"===Ne[0]&&">"===Ne[Ne.length-1]&&3<=Ne.length?[null,Ne,null]:kn.exec(Ne))||!tt[1]&&Ge)return!Ge||Ge.jquery?(Ge||Qe).find(Ne):this.constructor(Ge).find(Ne);if(tt[1]){if(Ge=Ge instanceof E?Ge[0]:Ge,E.merge(this,E.parseHTML(tt[1],Ge&&Ge.nodeType?Ge.ownerDocument||Ge:mr,!0)),mn.test(tt[1])&&E.isPlainObject(Ge))for(tt in Ge)m(this[tt])?this[tt](Ge[tt]):this.attr(tt,Ge[tt]);return this}return(rt=mr.getElementById(tt[2]))&&(this[0]=rt,this.length=1),this}return Ne.nodeType?(this[0]=Ne,this.length=1,this):m(Ne)?void 0!==Qe.ready?Qe.ready(Ne):Ne(E):E.makeArray(Ne,this)}).prototype=E.fn,xn=E(mr);var Cn=/^(?:parents|prev(?:Until|All))/,En={children:!0,contents:!0,next:!0,prev:!0};function O(Ne,Ge){for(;(Ne=Ne[Ge])&&1!==Ne.nodeType;);return Ne}E.fn.extend({has:function(Ne){var Ge=E(Ne,this),Qe=Ge.length;return this.filter((function(){for(var Ne=0;Ne<Qe;Ne++)if(E.contains(this,Ge[Ne]))return!0}))},closest:function(Ne,Ge){var Qe,tt=0,rt=this.length,nt=[],at="string"!=typeof Ne&&E(Ne);if(!en.test(Ne))for(;tt<rt;tt++)for(Qe=this[tt];Qe&&Qe!==Ge;Qe=Qe.parentNode)if(Qe.nodeType<11&&(at?-1<at.index(Qe):1===Qe.nodeType&&E.find.matchesSelector(Qe,Ne))){nt.push(Qe);break}return this.pushStack(1<nt.length?E.uniqueSort(nt):nt)},index:function(Ne){return Ne?"string"==typeof Ne?ht.call(E(Ne),this[0]):ht.call(this,Ne.jquery?Ne[0]:Ne):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(Ne,Ge){return this.pushStack(E.uniqueSort(E.merge(this.get(),E(Ne,Ge))))},addBack:function(Ne){return this.add(null==Ne?this.prevObject:this.prevObject.filter(Ne))}}),E.each({parent:function(Ne){var Ge=Ne.parentNode;return Ge&&11!==Ge.nodeType?Ge:null},parents:function(Ne){return h(Ne,"parentNode")},parentsUntil:function(Ne,Ge,Qe){return h(Ne,"parentNode",Qe)},next:function(Ne){return O(Ne,"nextSibling")},prev:function(Ne){return O(Ne,"previousSibling")},nextAll:function(Ne){return h(Ne,"nextSibling")},prevAll:function(Ne){return h(Ne,"previousSibling")},nextUntil:function(Ne,Ge,Qe){return h(Ne,"nextSibling",Qe)},prevUntil:function(Ne,Ge,Qe){return h(Ne,"previousSibling",Qe)},siblings:function(Ne){return T((Ne.parentNode||{}).firstChild,Ne)},children:function(Ne){return T(Ne.firstChild)},contents:function(Ne){return null!=Ne.contentDocument&&at(Ne.contentDocument)?Ne.contentDocument:(A(Ne,"template")&&(Ne=Ne.content||Ne),E.merge([],Ne.childNodes))}},(function(Ne,Ge){E.fn[Ne]=function(Qe,tt){var rt=E.map(this,Ge,Qe);return"Until"!==Ne.slice(-5)&&(tt=Qe),tt&&"string"==typeof tt&&(rt=E.filter(tt,rt)),1<this.length&&(En[Ne]||E.uniqueSort(rt),Cn.test(Ne)&&rt.reverse()),this.pushStack(rt)}}));var Pn=/[^\x20\t\r\n\f]+/g;function R(Ne){return Ne}function M(Ne){throw Ne}function I(Ne,Ge,Qe,tt){var rt;try{Ne&&m(rt=Ne.promise)?rt.call(Ne).done(Ge).fail(Qe):Ne&&m(rt=Ne.then)?rt.call(Ne,Ge,Qe):Ge.apply(void 0,[Ne].slice(tt))}catch(Ne){Qe.apply(void 0,[Ne])}}E.Callbacks=function(Ne){var Ge,Qe;Ne="string"==typeof Ne?(Ge=Ne,Qe={},E.each(Ge.match(Pn)||[],(function(Ne,Ge){Qe[Ge]=!0})),Qe):E.extend({},Ne);var tt,rt,nt,at,it=[],ot=[],dt=-1,c=function(){for(at=at||Ne.once,nt=tt=!0;ot.length;dt=-1)for(rt=ot.shift();++dt<it.length;)!1===it[dt].apply(rt[0],rt[1])&&Ne.stopOnFalse&&(dt=it.length,rt=!1);Ne.memory||(rt=!1),tt=!1,at&&(it=rt?[]:"")},ht={add:function(){return it&&(rt&&!tt&&(dt=it.length-1,ot.push(rt)),function n(Ge){E.each(Ge,(function(Ge,Qe){m(Qe)?Ne.unique&&ht.has(Qe)||it.push(Qe):Qe&&Qe.length&&"string"!==w(Qe)&&n(Qe)}))}(arguments),rt&&!tt&&c()),this},remove:function(){return E.each(arguments,(function(Ne,Ge){for(var Qe;-1<(Qe=E.inArray(Ge,it,Qe));)it.splice(Qe,1),Qe<=dt&&dt--})),this},has:function(Ne){return Ne?-1<E.inArray(Ne,it):0<it.length},empty:function(){return it&&(it=[]),this},disable:function(){return at=ot=[],it=rt="",this},disabled:function(){return!it},lock:function(){return at=ot=[],rt||tt||(it=rt=""),this},locked:function(){return!!at},fireWith:function(Ne,Ge){return at||(Ge=[Ne,(Ge=Ge||[]).slice?Ge.slice():Ge],ot.push(Ge),tt||c()),this},fire:function(){return ht.fireWith(this,arguments),this},fired:function(){return!!nt}};return ht},E.extend({Deferred:function(Ne){var Ge=[["notify","progress",E.Callbacks("memory"),E.Callbacks("memory"),2],["resolve","done",E.Callbacks("once memory"),E.Callbacks("once memory"),0,"resolved"],["reject","fail",E.Callbacks("once memory"),E.Callbacks("once memory"),1,"rejected"]],Qe="pending",rt={state:function(){return Qe},always:function(){return nt.done(arguments).fail(arguments),this},catch:function(Ne){return rt.then(null,Ne)},pipe:function(){var Ne=arguments;return E.Deferred((function(Qe){E.each(Ge,(function(Ge,tt){var rt=m(Ne[tt[4]])&&Ne[tt[4]];nt[tt[1]]((function(){var Ne=rt&&rt.apply(this,arguments);Ne&&m(Ne.promise)?Ne.promise().progress(Qe.notify).done(Qe.resolve).fail(Qe.reject):Qe[tt[0]+"With"](this,rt?[Ne]:arguments)}))})),Ne=null})).promise()},then:function(Ne,Qe,rt){var nt=0;function l(Ne,Ge,Qe,rt){return function(){var at=this,it=arguments,e=function(){var tt,ot;if(!(Ne<nt)){if((tt=Qe.apply(at,it))===Ge.promise())throw new TypeError("Thenable self-resolution");ot=tt&&("object"==typeof tt||"function"==typeof tt)&&tt.then,m(ot)?rt?ot.call(tt,l(nt,Ge,R,rt),l(nt,Ge,M,rt)):(nt++,ot.call(tt,l(nt,Ge,R,rt),l(nt,Ge,M,rt),l(nt,Ge,R,Ge.notifyWith))):(Qe!==R&&(at=void 0,it=[tt]),(rt||Ge.resolveWith)(at,it))}},ot=rt?e:function(){try{e()}catch(tt){E.Deferred.exceptionHook&&E.Deferred.exceptionHook(tt,ot.stackTrace),nt<=Ne+1&&(Qe!==M&&(at=void 0,it=[tt]),Ge.rejectWith(at,it))}};Ne?ot():(E.Deferred.getStackHook&&(ot.stackTrace=E.Deferred.getStackHook()),tt.setTimeout(ot))}}return E.Deferred((function(tt){Ge[0][3].add(l(0,tt,m(rt)?rt:R,tt.notifyWith)),Ge[1][3].add(l(0,tt,m(Ne)?Ne:R)),Ge[2][3].add(l(0,tt,m(Qe)?Qe:M))})).promise()},promise:function(Ne){return null!=Ne?E.extend(Ne,rt):rt}},nt={};return E.each(Ge,(function(Ne,tt){var at=tt[2],it=tt[5];rt[tt[1]]=at.add,it&&at.add((function(){Qe=it}),Ge[3-Ne][2].disable,Ge[3-Ne][3].disable,Ge[0][2].lock,Ge[0][3].lock),at.add(tt[3].fire),nt[tt[0]]=function(){return nt[tt[0]+"With"](this===nt?void 0:this,arguments),this},nt[tt[0]+"With"]=at.fireWith})),rt.promise(nt),Ne&&Ne.call(nt,nt),nt},when:function(Ne){var Ge=arguments.length,Qe=Ge,tt=Array(Qe),rt=it.call(arguments),nt=E.Deferred(),a=function(Ne){return function(Qe){tt[Ne]=this,rt[Ne]=1<arguments.length?it.call(arguments):Qe,--Ge||nt.resolveWith(tt,rt)}};if(Ge<=1&&(I(Ne,nt.done(a(Qe)).resolve,nt.reject,!Ge),"pending"===nt.state()||m(rt[Qe]&&rt[Qe].then)))return nt.then();for(;Qe--;)I(rt[Qe],a(Qe),nt.reject);return nt.promise()}});var Dn=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;E.Deferred.exceptionHook=function(Ne,Ge){tt.console&&tt.console.warn&&Ne&&Dn.test(Ne.name)&&tt.console.warn("jQuery.Deferred exception: "+Ne.message,Ne.stack,Ge)},E.readyException=function(Ne){tt.setTimeout((function(){throw Ne}))};var In=E.Deferred();function $(){mr.removeEventListener("DOMContentLoaded",$),tt.removeEventListener("load",$),E.ready()}E.fn.ready=function(Ne){return In.then(Ne).catch((function(Ne){E.readyException(Ne)})),this},E.extend({isReady:!1,readyWait:1,ready:function(Ne){(!0===Ne?--E.readyWait:E.isReady)||(E.isReady=!0)!==Ne&&0<--E.readyWait||In.resolveWith(mr,[E])}}),E.ready.then=In.then,"complete"===mr.readyState||"loading"!==mr.readyState&&!mr.documentElement.doScroll?tt.setTimeout(E.ready):(mr.addEventListener("DOMContentLoaded",$),tt.addEventListener("load",$));var B=function(Ne,Ge,Qe,tt,rt,nt,at){var it=0,ot=Ne.length,dt=null==Qe;if("object"===w(Qe))for(it in rt=!0,Qe)B(Ne,Ge,it,Qe[it],!0,nt,at);else if(void 0!==tt&&(rt=!0,m(tt)||(at=!0),dt&&(at?(Ge.call(Ne,tt),Ge=null):(dt=Ge,Ge=function(Ne,Ge,Qe){return dt.call(E(Ne),Qe)})),Ge))for(;it<ot;it++)Ge(Ne[it],Qe,at?tt:tt.call(Ne[it],it,Ge(Ne[it],Qe)));return rt?Ne:dt?Ge.call(Ne):ot?Ge(Ne[0],Qe):nt},zn=/^-ms-/,Bn=/-([a-z])/g;function U(Ne,Ge){return Ge.toUpperCase()}function X(Ne){return Ne.replace(zn,"ms-").replace(Bn,U)}var V=function(Ne){return 1===Ne.nodeType||9===Ne.nodeType||!+Ne.nodeType};function G(){this.expando=E.expando+G.uid++}G.uid=1,G.prototype={cache:function(Ne){var Ge=Ne[this.expando];return Ge||(Ge={},V(Ne)&&(Ne.nodeType?Ne[this.expando]=Ge:Object.defineProperty(Ne,this.expando,{value:Ge,configurable:!0}))),Ge},set:function(Ne,Ge,Qe){var tt,rt=this.cache(Ne);if("string"==typeof Ge)rt[X(Ge)]=Qe;else for(tt in Ge)rt[X(tt)]=Ge[tt];return rt},get:function(Ne,Ge){return void 0===Ge?this.cache(Ne):Ne[this.expando]&&Ne[this.expando][X(Ge)]},access:function(Ne,Ge,Qe){return void 0===Ge||Ge&&"string"==typeof Ge&&void 0===Qe?this.get(Ne,Ge):(this.set(Ne,Ge,Qe),void 0!==Qe?Qe:Ge)},remove:function(Ne,Ge){var Qe,tt=Ne[this.expando];if(void 0!==tt){if(void 0!==Ge){Qe=(Ge=Array.isArray(Ge)?Ge.map(X):(Ge=X(Ge))in tt?[Ge]:Ge.match(Pn)||[]).length;for(;Qe--;)delete tt[Ge[Qe]]}(void 0===Ge||E.isEmptyObject(tt))&&(Ne.nodeType?Ne[this.expando]=void 0:delete Ne[this.expando])}},hasData:function(Ne){var Ge=Ne[this.expando];return void 0!==Ge&&!E.isEmptyObject(Ge)}};var Vn=new G,Hn=new G,qn=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Yn=/[A-Z]/g;function Z(Ne,Ge,Qe){var tt,rt;if(void 0===Qe&&1===Ne.nodeType)if(tt="data-"+Ge.replace(Yn,"-$&").toLowerCase(),"string"==typeof(Qe=Ne.getAttribute(tt))){try{Qe="true"===(rt=Qe)||"false"!==rt&&("null"===rt?null:rt===+rt+""?+rt:qn.test(rt)?JSON.parse(rt):rt)}catch(Ne){}Hn.set(Ne,Ge,Qe)}else Qe=void 0;return Qe}E.extend({hasData:function(Ne){return Hn.hasData(Ne)||Vn.hasData(Ne)},data:function(Ne,Ge,Qe){return Hn.access(Ne,Ge,Qe)},removeData:function(Ne,Ge){Hn.remove(Ne,Ge)},_data:function(Ne,Ge,Qe){return Vn.access(Ne,Ge,Qe)},_removeData:function(Ne,Ge){Vn.remove(Ne,Ge)}}),E.fn.extend({data:function(Ne,Ge){var Qe,tt,rt,nt=this[0],at=nt&&nt.attributes;if(void 0===Ne){if(this.length&&(rt=Hn.get(nt),1===nt.nodeType&&!Vn.get(nt,"hasDataAttrs"))){for(Qe=at.length;Qe--;)at[Qe]&&0===(tt=at[Qe].name).indexOf("data-")&&(tt=X(tt.slice(5)),Z(nt,tt,rt[tt]));Vn.set(nt,"hasDataAttrs",!0)}return rt}return"object"==typeof Ne?this.each((function(){Hn.set(this,Ne)})):B(this,(function(Ge){var Qe;if(nt&&void 0===Ge)return void 0!==(Qe=Hn.get(nt,Ne))||void 0!==(Qe=Z(nt,Ne))?Qe:void 0;this.each((function(){Hn.set(this,Ne,Ge)}))}),null,Ge,1<arguments.length,null,!0)},removeData:function(Ne){return this.each((function(){Hn.remove(this,Ne)}))}}),E.extend({queue:function(Ne,Ge,Qe){var tt;if(Ne)return Ge=(Ge||"fx")+"queue",tt=Vn.get(Ne,Ge),Qe&&(!tt||Array.isArray(Qe)?tt=Vn.access(Ne,Ge,E.makeArray(Qe)):tt.push(Qe)),tt||[]},dequeue:function(Ne,Ge){Ge=Ge||"fx";var Qe=E.queue(Ne,Ge),tt=Qe.length,rt=Qe.shift(),nt=E._queueHooks(Ne,Ge);"inprogress"===rt&&(rt=Qe.shift(),tt--),rt&&("fx"===Ge&&Qe.unshift("inprogress"),delete nt.stop,rt.call(Ne,(function(){E.dequeue(Ne,Ge)}),nt)),!tt&&nt&&nt.empty.fire()},_queueHooks:function(Ne,Ge){var Qe=Ge+"queueHooks";return Vn.get(Ne,Qe)||Vn.access(Ne,Qe,{empty:E.Callbacks("once memory").add((function(){Vn.remove(Ne,[Ge+"queue",Qe])}))})}}),E.fn.extend({queue:function(Ne,Ge){var Qe=2;return"string"!=typeof Ne&&(Ge=Ne,Ne="fx",Qe--),arguments.length<Qe?E.queue(this[0],Ne):void 0===Ge?this:this.each((function(){var Qe=E.queue(this,Ne,Ge);E._queueHooks(this,Ne),"fx"===Ne&&"inprogress"!==Qe[0]&&E.dequeue(this,Ne)}))},dequeue:function(Ne){return this.each((function(){E.dequeue(this,Ne)}))},clearQueue:function(Ne){return this.queue(Ne||"fx",[])},promise:function(Ne,Ge){var Qe,tt=1,rt=E.Deferred(),nt=this,at=this.length,s=function(){--tt||rt.resolveWith(nt,[nt])};for("string"!=typeof Ne&&(Ge=Ne,Ne=void 0),Ne=Ne||"fx";at--;)(Qe=Vn.get(nt[at],Ne+"queueHooks"))&&Qe.empty&&(tt++,Qe.empty.add(s));return s(),rt.promise(Ge)}});var $n=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ra=new RegExp("^(?:([+-])=|)("+$n+")([a-z%]*)$","i"),oa=["Top","Right","Bottom","Left"],pa=mr.documentElement,ie=function(Ne){return E.contains(Ne.ownerDocument,Ne)},ga={composed:!0};pa.getRootNode&&(ie=function(Ne){return E.contains(Ne.ownerDocument,Ne)||Ne.getRootNode(ga)===Ne.ownerDocument});var ae=function(Ne,Ge){return"none"===(Ne=Ge||Ne).style.display||""===Ne.style.display&&ie(Ne)&&"none"===E.css(Ne,"display")};function se(Ne,Ge,Qe,tt){var rt,nt,at=20,it=tt?function(){return tt.cur()}:function(){return E.css(Ne,Ge,"")},ot=it(),dt=Qe&&Qe[3]||(E.cssNumber[Ge]?"":"px"),ht=Ne.nodeType&&(E.cssNumber[Ge]||"px"!==dt&&+ot)&&ra.exec(E.css(Ne,Ge));if(ht&&ht[3]!==dt){for(ot/=2,dt=dt||ht[3],ht=+ot||1;at--;)E.style(Ne,Ge,ht+dt),(1-nt)*(1-(nt=it()/ot||.5))<=0&&(at=0),ht/=nt;ht*=2,E.style(Ne,Ge,ht+dt),Qe=Qe||[]}return Qe&&(ht=+ht||+ot||0,rt=Qe[1]?ht+(Qe[1]+1)*Qe[2]:+Qe[2],tt&&(tt.unit=dt,tt.start=ht,tt.end=rt)),rt}var ma={};function le(Ne,Ge){for(var Qe,tt,rt,nt,at,it,ot,dt=[],ht=0,Dt=Ne.length;ht<Dt;ht++)(tt=Ne[ht]).style&&(Qe=tt.style.display,Ge?("none"===Qe&&(dt[ht]=Vn.get(tt,"display")||null,dt[ht]||(tt.style.display="")),""===tt.style.display&&ae(tt)&&(dt[ht]=(ot=at=nt=void 0,at=(rt=tt).ownerDocument,it=rt.nodeName,(ot=ma[it])||(nt=at.body.appendChild(at.createElement(it)),ot=E.css(nt,"display"),nt.parentNode.removeChild(nt),"none"===ot&&(ot="block"),ma[it]=ot)))):"none"!==Qe&&(dt[ht]="none",Vn.set(tt,"display",Qe)));for(ht=0;ht<Dt;ht++)null!=dt[ht]&&(Ne[ht].style.display=dt[ht]);return Ne}E.fn.extend({show:function(){return le(this,!0)},hide:function(){return le(this)},toggle:function(Ne){return"boolean"==typeof Ne?Ne?this.show():this.hide():this.each((function(){ae(this)?E(this).show():E(this).hide()}))}});var _a,Va,Wa=/^(?:checkbox|radio)$/i,Qa=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,ti=/^$|^module$|\/(?:java|ecma)script/i;_a=mr.createDocumentFragment().appendChild(mr.createElement("div")),(Va=mr.createElement("input")).setAttribute("type","radio"),Va.setAttribute("checked","checked"),Va.setAttribute("name","t"),_a.appendChild(Va),dr.checkClone=_a.cloneNode(!0).cloneNode(!0).lastChild.checked,_a.innerHTML="<textarea>x</textarea>",dr.noCloneChecked=!!_a.cloneNode(!0).lastChild.defaultValue,_a.innerHTML="<option></option>",dr.option=!!_a.lastChild;var ni={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ye(Ne,Ge){var Qe;return Qe=void 0!==Ne.getElementsByTagName?Ne.getElementsByTagName(Ge||"*"):void 0!==Ne.querySelectorAll?Ne.querySelectorAll(Ge||"*"):[],void 0===Ge||Ge&&A(Ne,Ge)?E.merge([Ne],Qe):Qe}function ve(Ne,Ge){for(var Qe=0,tt=Ne.length;Qe<tt;Qe++)Vn.set(Ne[Qe],"globalEval",!Ge||Vn.get(Ge[Qe],"globalEval"))}ni.tbody=ni.tfoot=ni.colgroup=ni.caption=ni.thead,ni.th=ni.td,dr.option||(ni.optgroup=ni.option=[1,"<select multiple='multiple'>","</select>"]);var di=/<|&#?\w+;/;function xe(Ne,Ge,Qe,tt,rt){for(var nt,at,it,ot,dt,ht,Dt=Ge.createDocumentFragment(),Ot=[],Rt=0,Zt=Ne.length;Rt<Zt;Rt++)if((nt=Ne[Rt])||0===nt)if("object"===w(nt))E.merge(Ot,nt.nodeType?[nt]:nt);else if(di.test(nt)){for(at=at||Dt.appendChild(Ge.createElement("div")),it=(Qa.exec(nt)||["",""])[1].toLowerCase(),ot=ni[it]||ni._default,at.innerHTML=ot[1]+E.htmlPrefilter(nt)+ot[2],ht=ot[0];ht--;)at=at.lastChild;E.merge(Ot,at.childNodes),(at=Dt.firstChild).textContent=""}else Ot.push(Ge.createTextNode(nt));for(Dt.textContent="",Rt=0;nt=Ot[Rt++];)if(tt&&-1<E.inArray(nt,tt))rt&&rt.push(nt);else if(dt=ie(nt),at=ye(Dt.appendChild(nt),"script"),dt&&ve(at),Qe)for(ht=0;nt=at[ht++];)ti.test(nt.type||"")&&Qe.push(nt);return Dt}var ji=/^([^.]*)(?:\.(.+)|)/;function we(){return!0}function Te(){return!1}function Ce(Ne,Ge){return Ne===function(){try{return mr.activeElement}catch(Ne){}}()==("focus"===Ge)}function Se(Ne,Ge,Qe,tt,rt,nt){var at,it;if("object"==typeof Ge){for(it in"string"!=typeof Qe&&(tt=tt||Qe,Qe=void 0),Ge)Se(Ne,it,Qe,tt,Ge[it],nt);return Ne}if(null==tt&&null==rt?(rt=Qe,tt=Qe=void 0):null==rt&&("string"==typeof Qe?(rt=tt,tt=void 0):(rt=tt,tt=Qe,Qe=void 0)),!1===rt)rt=Te;else if(!rt)return Ne;return 1===nt&&(at=rt,(rt=function(Ne){return E().off(Ne),at.apply(this,arguments)}).guid=at.guid||(at.guid=E.guid++)),Ne.each((function(){E.event.add(this,Ge,rt,tt,Qe)}))}function Ee(Ne,Ge,Qe){Qe?(Vn.set(Ne,Ge,!1),E.event.add(Ne,Ge,{namespace:!1,handler:function(Ne){var tt,rt,nt=Vn.get(this,Ge);if(1&Ne.isTrigger&&this[Ge]){if(nt.length)(E.event.special[Ge]||{}).delegateType&&Ne.stopPropagation();else if(nt=it.call(arguments),Vn.set(this,Ge,nt),tt=Qe(this,Ge),this[Ge](),nt!==(rt=Vn.get(this,Ge))||tt?Vn.set(this,Ge,!1):rt={},nt!==rt)return Ne.stopImmediatePropagation(),Ne.preventDefault(),rt&&rt.value}else nt.length&&(Vn.set(this,Ge,{value:E.event.trigger(E.extend(nt[0],E.Event.prototype),nt.slice(1),this)}),Ne.stopImmediatePropagation())}})):void 0===Vn.get(Ne,Ge)&&E.event.add(Ne,Ge,we)}E.event={global:{},add:function(Ne,Ge,Qe,tt,rt){var nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt,er,dr=Vn.get(Ne);if(V(Ne))for(Qe.handler&&(Qe=(nt=Qe).handler,rt=nt.selector),rt&&E.find.matchesSelector(pa,rt),Qe.guid||(Qe.guid=E.guid++),(ot=dr.events)||(ot=dr.events=Object.create(null)),(at=dr.handle)||(at=dr.handle=function(Ge){return void 0!==E&&E.event.triggered!==Ge.type?E.event.dispatch.apply(Ne,arguments):void 0}),dt=(Ge=(Ge||"").match(Pn)||[""]).length;dt--;)Rt=er=(it=ji.exec(Ge[dt])||[])[1],Zt=(it[2]||"").split(".").sort(),Rt&&(Dt=E.event.special[Rt]||{},Rt=(rt?Dt.delegateType:Dt.bindType)||Rt,Dt=E.event.special[Rt]||{},ht=E.extend({type:Rt,origType:er,data:tt,handler:Qe,guid:Qe.guid,selector:rt,needsContext:rt&&E.expr.match.needsContext.test(rt),namespace:Zt.join(".")},nt),(Ot=ot[Rt])||((Ot=ot[Rt]=[]).delegateCount=0,Dt.setup&&!1!==Dt.setup.call(Ne,tt,Zt,at)||Ne.addEventListener&&Ne.addEventListener(Rt,at)),Dt.add&&(Dt.add.call(Ne,ht),ht.handler.guid||(ht.handler.guid=Qe.guid)),rt?Ot.splice(Ot.delegateCount++,0,ht):Ot.push(ht),E.event.global[Rt]=!0)},remove:function(Ne,Ge,Qe,tt,rt){var nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt,er,dr=Vn.hasData(Ne)&&Vn.get(Ne);if(dr&&(ot=dr.events)){for(dt=(Ge=(Ge||"").match(Pn)||[""]).length;dt--;)if(Rt=er=(it=ji.exec(Ge[dt])||[])[1],Zt=(it[2]||"").split(".").sort(),Rt){for(Dt=E.event.special[Rt]||{},Ot=ot[Rt=(tt?Dt.delegateType:Dt.bindType)||Rt]||[],it=it[2]&&new RegExp("(^|\\.)"+Zt.join("\\.(?:.*\\.|)")+"(\\.|$)"),at=nt=Ot.length;nt--;)ht=Ot[nt],!rt&&er!==ht.origType||Qe&&Qe.guid!==ht.guid||it&&!it.test(ht.namespace)||tt&&tt!==ht.selector&&("**"!==tt||!ht.selector)||(Ot.splice(nt,1),ht.selector&&Ot.delegateCount--,Dt.remove&&Dt.remove.call(Ne,ht));at&&!Ot.length&&(Dt.teardown&&!1!==Dt.teardown.call(Ne,Zt,dr.handle)||E.removeEvent(Ne,Rt,dr.handle),delete ot[Rt])}else for(Rt in ot)E.event.remove(Ne,Rt+Ge[dt],Qe,tt,!0);E.isEmptyObject(ot)&&Vn.remove(Ne,"handle events")}},dispatch:function(Ne){var Ge,Qe,tt,rt,nt,at,it=new Array(arguments.length),ot=E.event.fix(Ne),dt=(Vn.get(this,"events")||Object.create(null))[ot.type]||[],ht=E.event.special[ot.type]||{};for(it[0]=ot,Ge=1;Ge<arguments.length;Ge++)it[Ge]=arguments[Ge];if(ot.delegateTarget=this,!ht.preDispatch||!1!==ht.preDispatch.call(this,ot)){for(at=E.event.handlers.call(this,ot,dt),Ge=0;(rt=at[Ge++])&&!ot.isPropagationStopped();)for(ot.currentTarget=rt.elem,Qe=0;(nt=rt.handlers[Qe++])&&!ot.isImmediatePropagationStopped();)ot.rnamespace&&!1!==nt.namespace&&!ot.rnamespace.test(nt.namespace)||(ot.handleObj=nt,ot.data=nt.data,void 0!==(tt=((E.event.special[nt.origType]||{}).handle||nt.handler).apply(rt.elem,it))&&!1===(ot.result=tt)&&(ot.preventDefault(),ot.stopPropagation()));return ht.postDispatch&&ht.postDispatch.call(this,ot),ot.result}},handlers:function(Ne,Ge){var Qe,tt,rt,nt,at,it=[],ot=Ge.delegateCount,dt=Ne.target;if(ot&&dt.nodeType&&!("click"===Ne.type&&1<=Ne.button))for(;dt!==this;dt=dt.parentNode||this)if(1===dt.nodeType&&("click"!==Ne.type||!0!==dt.disabled)){for(nt=[],at={},Qe=0;Qe<ot;Qe++)void 0===at[rt=(tt=Ge[Qe]).selector+" "]&&(at[rt]=tt.needsContext?-1<E(rt,this).index(dt):E.find(rt,this,null,[dt]).length),at[rt]&&nt.push(tt);nt.length&&it.push({elem:dt,handlers:nt})}return dt=this,ot<Ge.length&&it.push({elem:dt,handlers:Ge.slice(ot)}),it},addProp:function(Ne,Ge){Object.defineProperty(E.Event.prototype,Ne,{enumerable:!0,configurable:!0,get:m(Ge)?function(){if(this.originalEvent)return Ge(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[Ne]},set:function(Ge){Object.defineProperty(this,Ne,{enumerable:!0,configurable:!0,writable:!0,value:Ge})}})},fix:function(Ne){return Ne[E.expando]?Ne:new E.Event(Ne)},special:{load:{noBubble:!0},click:{setup:function(Ne){var Ge=this||Ne;return Wa.test(Ge.type)&&Ge.click&&A(Ge,"input")&&Ee(Ge,"click",we),!1},trigger:function(Ne){var Ge=this||Ne;return Wa.test(Ge.type)&&Ge.click&&A(Ge,"input")&&Ee(Ge,"click"),!0},_default:function(Ne){var Ge=Ne.target;return Wa.test(Ge.type)&&Ge.click&&A(Ge,"input")&&Vn.get(Ge,"click")||A(Ge,"a")}},beforeunload:{postDispatch:function(Ne){void 0!==Ne.result&&Ne.originalEvent&&(Ne.originalEvent.returnValue=Ne.result)}}}},E.removeEvent=function(Ne,Ge,Qe){Ne.removeEventListener&&Ne.removeEventListener(Ge,Qe)},E.Event=function(Ne,Ge){if(!(this instanceof E.Event))return new E.Event(Ne,Ge);Ne&&Ne.type?(this.originalEvent=Ne,this.type=Ne.type,this.isDefaultPrevented=Ne.defaultPrevented||void 0===Ne.defaultPrevented&&!1===Ne.returnValue?we:Te,this.target=Ne.target&&3===Ne.target.nodeType?Ne.target.parentNode:Ne.target,this.currentTarget=Ne.currentTarget,this.relatedTarget=Ne.relatedTarget):this.type=Ne,Ge&&E.extend(this,Ge),this.timeStamp=Ne&&Ne.timeStamp||Date.now(),this[E.expando]=!0},E.Event.prototype={constructor:E.Event,isDefaultPrevented:Te,isPropagationStopped:Te,isImmediatePropagationStopped:Te,isSimulated:!1,preventDefault:function(){var Ne=this.originalEvent;this.isDefaultPrevented=we,Ne&&!this.isSimulated&&Ne.preventDefault()},stopPropagation:function(){var Ne=this.originalEvent;this.isPropagationStopped=we,Ne&&!this.isSimulated&&Ne.stopPropagation()},stopImmediatePropagation:function(){var Ne=this.originalEvent;this.isImmediatePropagationStopped=we,Ne&&!this.isSimulated&&Ne.stopImmediatePropagation(),this.stopPropagation()}},E.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},E.event.addProp),E.each({focus:"focusin",blur:"focusout"},(function(Ne,Ge){E.event.special[Ne]={setup:function(){return Ee(this,Ne,Ce),!1},trigger:function(){return Ee(this,Ne),!0},_default:function(Ge){return Vn.get(Ge.target,Ne)},delegateType:Ge}})),E.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(Ne,Ge){E.event.special[Ne]={delegateType:Ge,bindType:Ge,handle:function(Ne){var Qe,tt=Ne.relatedTarget,rt=Ne.handleObj;return tt&&(tt===this||E.contains(this,tt))||(Ne.type=rt.origType,Qe=rt.handler.apply(this,arguments),Ne.type=Ge),Qe}}})),E.fn.extend({on:function(Ne,Ge,Qe,tt){return Se(this,Ne,Ge,Qe,tt)},one:function(Ne,Ge,Qe,tt){return Se(this,Ne,Ge,Qe,tt,1)},off:function(Ne,Ge,Qe){var tt,rt;if(Ne&&Ne.preventDefault&&Ne.handleObj)return tt=Ne.handleObj,E(Ne.delegateTarget).off(tt.namespace?tt.origType+"."+tt.namespace:tt.origType,tt.selector,tt.handler),this;if("object"==typeof Ne){for(rt in Ne)this.off(rt,Ge,Ne[rt]);return this}return!1!==Ge&&"function"!=typeof Ge||(Qe=Ge,Ge=void 0),!1===Qe&&(Qe=Te),this.each((function(){E.event.remove(this,Ne,Qe,Ge)}))}});var Hi=/<script|<style|<link/i,Yi=/checked\s*(?:[^=]|=\s*.checked.)/i,uo=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function je(Ne,Ge){return A(Ne,"table")&&A(11!==Ge.nodeType?Ge:Ge.firstChild,"tr")&&E(Ne).children("tbody")[0]||Ne}function De(Ne){return Ne.type=(null!==Ne.getAttribute("type"))+"/"+Ne.type,Ne}function qe(Ne){return"true/"===(Ne.type||"").slice(0,5)?Ne.type=Ne.type.slice(5):Ne.removeAttribute("type"),Ne}function Le(Ne,Ge){var Qe,tt,rt,nt,at,it;if(1===Ge.nodeType){if(Vn.hasData(Ne)&&(it=Vn.get(Ne).events))for(rt in Vn.remove(Ge,"handle events"),it)for(Qe=0,tt=it[rt].length;Qe<tt;Qe++)E.event.add(Ge,rt,it[rt][Qe]);Hn.hasData(Ne)&&(nt=Hn.access(Ne),at=E.extend({},nt),Hn.set(Ge,at))}}function He(Ne,Ge,Qe,tt){Ge=ot(Ge);var rt,nt,at,it,dt,ht,Dt=0,Ot=Ne.length,Rt=Ot-1,Zt=Ge[0],er=m(Zt);if(er||1<Ot&&"string"==typeof Zt&&!dr.checkClone&&Yi.test(Zt))return Ne.each((function(rt){var nt=Ne.eq(rt);er&&(Ge[0]=Zt.call(this,rt,nt.html())),He(nt,Ge,Qe,tt)}));if(Ot&&(nt=(rt=xe(Ge,Ne[0].ownerDocument,!1,Ne,tt)).firstChild,1===rt.childNodes.length&&(rt=nt),nt||tt)){for(it=(at=E.map(ye(rt,"script"),De)).length;Dt<Ot;Dt++)dt=rt,Dt!==Rt&&(dt=E.clone(dt,!0,!0),it&&E.merge(at,ye(dt,"script"))),Qe.call(Ne[Dt],dt,Dt);if(it)for(ht=at[at.length-1].ownerDocument,E.map(at,qe),Dt=0;Dt<it;Dt++)dt=at[Dt],ti.test(dt.type||"")&&!Vn.access(dt,"globalEval")&&E.contains(ht,dt)&&(dt.src&&"module"!==(dt.type||"").toLowerCase()?E._evalUrl&&!dt.noModule&&E._evalUrl(dt.src,{nonce:dt.nonce||dt.getAttribute("nonce")},ht):b(dt.textContent.replace(uo,""),dt,ht))}return Ne}function Oe(Ne,Ge,Qe){for(var tt,rt=Ge?E.filter(Ge,Ne):Ne,nt=0;null!=(tt=rt[nt]);nt++)Qe||1!==tt.nodeType||E.cleanData(ye(tt)),tt.parentNode&&(Qe&&ie(tt)&&ve(ye(tt,"script")),tt.parentNode.removeChild(tt));return Ne}E.extend({htmlPrefilter:function(Ne){return Ne},clone:function(Ne,Ge,Qe){var tt,rt,nt,at,it,ot,dt,ht=Ne.cloneNode(!0),Dt=ie(Ne);if(!(dr.noCloneChecked||1!==Ne.nodeType&&11!==Ne.nodeType||E.isXMLDoc(Ne)))for(at=ye(ht),tt=0,rt=(nt=ye(Ne)).length;tt<rt;tt++)it=nt[tt],"input"===(dt=(ot=at[tt]).nodeName.toLowerCase())&&Wa.test(it.type)?ot.checked=it.checked:"input"!==dt&&"textarea"!==dt||(ot.defaultValue=it.defaultValue);if(Ge)if(Qe)for(nt=nt||ye(Ne),at=at||ye(ht),tt=0,rt=nt.length;tt<rt;tt++)Le(nt[tt],at[tt]);else Le(Ne,ht);return 0<(at=ye(ht,"script")).length&&ve(at,!Dt&&ye(Ne,"script")),ht},cleanData:function(Ne){for(var Ge,Qe,tt,rt=E.event.special,nt=0;void 0!==(Qe=Ne[nt]);nt++)if(V(Qe)){if(Ge=Qe[Vn.expando]){if(Ge.events)for(tt in Ge.events)rt[tt]?E.event.remove(Qe,tt):E.removeEvent(Qe,tt,Ge.handle);Qe[Vn.expando]=void 0}Qe[Hn.expando]&&(Qe[Hn.expando]=void 0)}}}),E.fn.extend({detach:function(Ne){return Oe(this,Ne,!0)},remove:function(Ne){return Oe(this,Ne)},text:function(Ne){return B(this,(function(Ne){return void 0===Ne?E.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=Ne)}))}),null,Ne,arguments.length)},append:function(){return He(this,arguments,(function(Ne){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||je(this,Ne).appendChild(Ne)}))},prepend:function(){return He(this,arguments,(function(Ne){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var Ge=je(this,Ne);Ge.insertBefore(Ne,Ge.firstChild)}}))},before:function(){return He(this,arguments,(function(Ne){this.parentNode&&this.parentNode.insertBefore(Ne,this)}))},after:function(){return He(this,arguments,(function(Ne){this.parentNode&&this.parentNode.insertBefore(Ne,this.nextSibling)}))},empty:function(){for(var Ne,Ge=0;null!=(Ne=this[Ge]);Ge++)1===Ne.nodeType&&(E.cleanData(ye(Ne,!1)),Ne.textContent="");return this},clone:function(Ne,Ge){return Ne=null!=Ne&&Ne,Ge=null==Ge?Ne:Ge,this.map((function(){return E.clone(this,Ne,Ge)}))},html:function(Ne){return B(this,(function(Ne){var Ge=this[0]||{},Qe=0,tt=this.length;if(void 0===Ne&&1===Ge.nodeType)return Ge.innerHTML;if("string"==typeof Ne&&!Hi.test(Ne)&&!ni[(Qa.exec(Ne)||["",""])[1].toLowerCase()]){Ne=E.htmlPrefilter(Ne);try{for(;Qe<tt;Qe++)1===(Ge=this[Qe]||{}).nodeType&&(E.cleanData(ye(Ge,!1)),Ge.innerHTML=Ne);Ge=0}catch(Ne){}}Ge&&this.empty().append(Ne)}),null,Ne,arguments.length)},replaceWith:function(){var Ne=[];return He(this,arguments,(function(Ge){var Qe=this.parentNode;E.inArray(this,Ne)<0&&(E.cleanData(ye(this)),Qe&&Qe.replaceChild(Ge,this))}),Ne)}}),E.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(Ne,Ge){E.fn[Ne]=function(Ne){for(var Qe,tt=[],rt=E(Ne),nt=rt.length-1,at=0;at<=nt;at++)Qe=at===nt?this:this.clone(!0),E(rt[at])[Ge](Qe),dt.apply(tt,Qe.get());return this.pushStack(tt)}}));var go=new RegExp("^("+$n+")(?!px)[a-z%]+$","i"),ns=/^--/,Me=function(Ne){var Ge=Ne.ownerDocument.defaultView;return Ge&&Ge.opener||(Ge=tt),Ge.getComputedStyle(Ne)},Ie=function(Ne,Ge,Qe){var tt,rt,nt={};for(rt in Ge)nt[rt]=Ne.style[rt],Ne.style[rt]=Ge[rt];for(rt in tt=Qe.call(Ne),Ge)Ne.style[rt]=nt[rt];return tt},as=new RegExp(oa.join("|"),"i"),is="[\\x20\\t\\r\\n\\f]",os=new RegExp("^"+is+"+|((?:^|[^\\\\])(?:\\\\.)*)"+is+"+$","g");function Be(Ne,Ge,Qe){var tt,rt,nt,at,it=ns.test(Ge),ot=Ne.style;return(Qe=Qe||Me(Ne))&&(at=Qe.getPropertyValue(Ge)||Qe[Ge],it&&at&&(at=at.replace(os,"$1")||void 0),""!==at||ie(Ne)||(at=E.style(Ne,Ge)),!dr.pixelBoxStyles()&&go.test(at)&&as.test(Ge)&&(tt=ot.width,rt=ot.minWidth,nt=ot.maxWidth,ot.minWidth=ot.maxWidth=ot.width=at,at=Qe.width,ot.width=tt,ot.minWidth=rt,ot.maxWidth=nt)),void 0!==at?at+"":at}function _e(Ne,Ge){return{get:function(){if(!Ne())return(this.get=Ge).apply(this,arguments);delete this.get}}}!function(){function e(){if(ot){it.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",ot.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",pa.appendChild(it).appendChild(ot);var nt=tt.getComputedStyle(ot);Ne="1%"!==nt.top,at=12===t(nt.marginLeft),ot.style.right="60%",rt=36===t(nt.right),Ge=36===t(nt.width),ot.style.position="absolute",Qe=12===t(ot.offsetWidth/3),pa.removeChild(it),ot=null}}function t(Ne){return Math.round(parseFloat(Ne))}var Ne,Ge,Qe,rt,nt,at,it=mr.createElement("div"),ot=mr.createElement("div");ot.style&&(ot.style.backgroundClip="content-box",ot.cloneNode(!0).style.backgroundClip="",dr.clearCloneStyle="content-box"===ot.style.backgroundClip,E.extend(dr,{boxSizingReliable:function(){return e(),Ge},pixelBoxStyles:function(){return e(),rt},pixelPosition:function(){return e(),Ne},reliableMarginLeft:function(){return e(),at},scrollboxSize:function(){return e(),Qe},reliableTrDimensions:function(){var Ne,Ge,Qe,rt;return null==nt&&(Ne=mr.createElement("table"),Ge=mr.createElement("tr"),Qe=mr.createElement("div"),Ne.style.cssText="position:absolute;left:-11111px;border-collapse:separate",Ge.style.cssText="border:1px solid",Ge.style.height="1px",Qe.style.height="9px",Qe.style.display="block",pa.appendChild(Ne).appendChild(Ge).appendChild(Qe),rt=tt.getComputedStyle(Ge),nt=parseInt(rt.height,10)+parseInt(rt.borderTopWidth,10)+parseInt(rt.borderBottomWidth,10)===Ge.offsetHeight,pa.removeChild(Ne)),nt}}))}();var ss=["Webkit","Moz","ms"],cs=mr.createElement("div").style,ds={};function Ve(Ne){return E.cssProps[Ne]||ds[Ne]||(Ne in cs?Ne:ds[Ne]=function(Ne){for(var Ge=Ne[0].toUpperCase()+Ne.slice(1),Qe=ss.length;Qe--;)if((Ne=ss[Qe]+Ge)in cs)return Ne}(Ne)||Ne)}var ms=/^(none|table(?!-c[ea]).+)/,vs={position:"absolute",visibility:"hidden",display:"block"},_s={letterSpacing:"0",fontWeight:"400"};function Je(Ne,Ge,Qe){var tt=ra.exec(Ge);return tt?Math.max(0,tt[2]-(Qe||0))+(tt[3]||"px"):Ge}function Ke(Ne,Ge,Qe,tt,rt,nt){var at="width"===Ge?1:0,it=0,ot=0;if(Qe===(tt?"border":"content"))return 0;for(;at<4;at+=2)"margin"===Qe&&(ot+=E.css(Ne,Qe+oa[at],!0,rt)),tt?("content"===Qe&&(ot-=E.css(Ne,"padding"+oa[at],!0,rt)),"margin"!==Qe&&(ot-=E.css(Ne,"border"+oa[at]+"Width",!0,rt))):(ot+=E.css(Ne,"padding"+oa[at],!0,rt),"padding"!==Qe?ot+=E.css(Ne,"border"+oa[at]+"Width",!0,rt):it+=E.css(Ne,"border"+oa[at]+"Width",!0,rt));return!tt&&0<=nt&&(ot+=Math.max(0,Math.ceil(Ne["offset"+Ge[0].toUpperCase()+Ge.slice(1)]-nt-ot-it-.5))||0),ot}function Ze(Ne,Ge,Qe){var tt=Me(Ne),rt=(!dr.boxSizingReliable()||Qe)&&"border-box"===E.css(Ne,"boxSizing",!1,tt),nt=rt,at=Be(Ne,Ge,tt),it="offset"+Ge[0].toUpperCase()+Ge.slice(1);if(go.test(at)){if(!Qe)return at;at="auto"}return(!dr.boxSizingReliable()&&rt||!dr.reliableTrDimensions()&&A(Ne,"tr")||"auto"===at||!parseFloat(at)&&"inline"===E.css(Ne,"display",!1,tt))&&Ne.getClientRects().length&&(rt="border-box"===E.css(Ne,"boxSizing",!1,tt),(nt=it in Ne)&&(at=Ne[it])),(at=parseFloat(at)||0)+Ke(Ne,Ge,Qe||(rt?"border":"content"),nt,tt,at)+"px"}function et(Ne,Ge,Qe,tt,rt){return new et.prototype.init(Ne,Ge,Qe,tt,rt)}E.extend({cssHooks:{opacity:{get:function(Ne,Ge){if(Ge){var Qe=Be(Ne,"opacity");return""===Qe?"1":Qe}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(Ne,Ge,Qe,tt){if(Ne&&3!==Ne.nodeType&&8!==Ne.nodeType&&Ne.style){var rt,nt,at,it=X(Ge),ot=ns.test(Ge),dt=Ne.style;if(ot||(Ge=Ve(it)),at=E.cssHooks[Ge]||E.cssHooks[it],void 0===Qe)return at&&"get"in at&&void 0!==(rt=at.get(Ne,!1,tt))?rt:dt[Ge];"string"==(nt=typeof Qe)&&(rt=ra.exec(Qe))&&rt[1]&&(Qe=se(Ne,Ge,rt),nt="number"),null!=Qe&&Qe==Qe&&("number"!==nt||ot||(Qe+=rt&&rt[3]||(E.cssNumber[it]?"":"px")),dr.clearCloneStyle||""!==Qe||0!==Ge.indexOf("background")||(dt[Ge]="inherit"),at&&"set"in at&&void 0===(Qe=at.set(Ne,Qe,tt))||(ot?dt.setProperty(Ge,Qe):dt[Ge]=Qe))}},css:function(Ne,Ge,Qe,tt){var rt,nt,at,it=X(Ge);return ns.test(Ge)||(Ge=Ve(it)),(at=E.cssHooks[Ge]||E.cssHooks[it])&&"get"in at&&(rt=at.get(Ne,!0,Qe)),void 0===rt&&(rt=Be(Ne,Ge,tt)),"normal"===rt&&Ge in _s&&(rt=_s[Ge]),""===Qe||Qe?(nt=parseFloat(rt),!0===Qe||isFinite(nt)?nt||0:rt):rt}}),E.each(["height","width"],(function(Ne,Ge){E.cssHooks[Ge]={get:function(Ne,Qe,tt){if(Qe)return!ms.test(E.css(Ne,"display"))||Ne.getClientRects().length&&Ne.getBoundingClientRect().width?Ze(Ne,Ge,tt):Ie(Ne,vs,(function(){return Ze(Ne,Ge,tt)}))},set:function(Ne,Qe,tt){var rt,nt=Me(Ne),at=!dr.scrollboxSize()&&"absolute"===nt.position,it=(at||tt)&&"border-box"===E.css(Ne,"boxSizing",!1,nt),ot=tt?Ke(Ne,Ge,tt,it,nt):0;return it&&at&&(ot-=Math.ceil(Ne["offset"+Ge[0].toUpperCase()+Ge.slice(1)]-parseFloat(nt[Ge])-Ke(Ne,Ge,"border",!1,nt)-.5)),ot&&(rt=ra.exec(Qe))&&"px"!==(rt[3]||"px")&&(Ne.style[Ge]=Qe,Qe=E.css(Ne,Ge)),Je(0,Qe,ot)}}})),E.cssHooks.marginLeft=_e(dr.reliableMarginLeft,(function(Ne,Ge){if(Ge)return(parseFloat(Be(Ne,"marginLeft"))||Ne.getBoundingClientRect().left-Ie(Ne,{marginLeft:0},(function(){return Ne.getBoundingClientRect().left})))+"px"})),E.each({margin:"",padding:"",border:"Width"},(function(Ne,Ge){E.cssHooks[Ne+Ge]={expand:function(Qe){for(var tt=0,rt={},nt="string"==typeof Qe?Qe.split(" "):[Qe];tt<4;tt++)rt[Ne+oa[tt]+Ge]=nt[tt]||nt[tt-2]||nt[0];return rt}},"margin"!==Ne&&(E.cssHooks[Ne+Ge].set=Je)})),E.fn.extend({css:function(Ne,Ge){return B(this,(function(Ne,Ge,Qe){var tt,rt,nt={},at=0;if(Array.isArray(Ge)){for(tt=Me(Ne),rt=Ge.length;at<rt;at++)nt[Ge[at]]=E.css(Ne,Ge[at],!1,tt);return nt}return void 0!==Qe?E.style(Ne,Ge,Qe):E.css(Ne,Ge)}),Ne,Ge,1<arguments.length)}}),((E.Tween=et).prototype={constructor:et,init:function(Ne,Ge,Qe,tt,rt,nt){this.elem=Ne,this.prop=Qe,this.easing=rt||E.easing._default,this.options=Ge,this.start=this.now=this.cur(),this.end=tt,this.unit=nt||(E.cssNumber[Qe]?"":"px")},cur:function(){var Ne=et.propHooks[this.prop];return Ne&&Ne.get?Ne.get(this):et.propHooks._default.get(this)},run:function(Ne){var Ge,Qe=et.propHooks[this.prop];return this.options.duration?this.pos=Ge=E.easing[this.easing](Ne,this.options.duration*Ne,0,1,this.options.duration):this.pos=Ge=Ne,this.now=(this.end-this.start)*Ge+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),Qe&&Qe.set?Qe.set(this):et.propHooks._default.set(this),this}}).init.prototype=et.prototype,(et.propHooks={_default:{get:function(Ne){var Ge;return 1!==Ne.elem.nodeType||null!=Ne.elem[Ne.prop]&&null==Ne.elem.style[Ne.prop]?Ne.elem[Ne.prop]:(Ge=E.css(Ne.elem,Ne.prop,""))&&"auto"!==Ge?Ge:0},set:function(Ne){E.fx.step[Ne.prop]?E.fx.step[Ne.prop](Ne):1!==Ne.elem.nodeType||!E.cssHooks[Ne.prop]&&null==Ne.elem.style[Ve(Ne.prop)]?Ne.elem[Ne.prop]=Ne.now:E.style(Ne.elem,Ne.prop,Ne.now+Ne.unit)}}}).scrollTop=et.propHooks.scrollLeft={set:function(Ne){Ne.elem.nodeType&&Ne.elem.parentNode&&(Ne.elem[Ne.prop]=Ne.now)}},E.easing={linear:function(Ne){return Ne},swing:function(Ne){return.5-Math.cos(Ne*Math.PI)/2},_default:"swing"},E.fx=et.prototype.init,E.fx.step={};var ws,Ts,ks,Cs,Es=/^(?:toggle|show|hide)$/,Ls=/queueHooks$/;function st(){Ts&&(!1===mr.hidden&&tt.requestAnimationFrame?tt.requestAnimationFrame(st):tt.setTimeout(st,E.fx.interval),E.fx.tick())}function ut(){return tt.setTimeout((function(){ws=void 0})),ws=Date.now()}function lt(Ne,Ge){var Qe,tt=0,rt={height:Ne};for(Ge=Ge?1:0;tt<4;tt+=2-Ge)rt["margin"+(Qe=oa[tt])]=rt["padding"+Qe]=Ne;return Ge&&(rt.opacity=rt.width=Ne),rt}function ct(Ne,Ge,Qe){for(var tt,rt=(ft.tweeners[Ge]||[]).concat(ft.tweeners["*"]),nt=0,at=rt.length;nt<at;nt++)if(tt=rt[nt].call(Qe,Ge,Ne))return tt}function ft(Ne,Ge,Qe){var tt,rt,nt=0,at=ft.prefilters.length,it=E.Deferred().always((function(){delete u.elem})),u=function(){if(rt)return!1;for(var Ge=ws||ut(),Qe=Math.max(0,ot.startTime+ot.duration-Ge),tt=1-(Qe/ot.duration||0),nt=0,at=ot.tweens.length;nt<at;nt++)ot.tweens[nt].run(tt);return it.notifyWith(Ne,[ot,tt,Qe]),tt<1&&at?Qe:(at||it.notifyWith(Ne,[ot,1,0]),it.resolveWith(Ne,[ot]),!1)},ot=it.promise({elem:Ne,props:E.extend({},Ge),opts:E.extend(!0,{specialEasing:{},easing:E.easing._default},Qe),originalProperties:Ge,originalOptions:Qe,startTime:ws||ut(),duration:Qe.duration,tweens:[],createTween:function(Ge,Qe){var tt=E.Tween(Ne,ot.opts,Ge,Qe,ot.opts.specialEasing[Ge]||ot.opts.easing);return ot.tweens.push(tt),tt},stop:function(Ge){var Qe=0,tt=Ge?ot.tweens.length:0;if(rt)return this;for(rt=!0;Qe<tt;Qe++)ot.tweens[Qe].run(1);return Ge?(it.notifyWith(Ne,[ot,1,0]),it.resolveWith(Ne,[ot,Ge])):it.rejectWith(Ne,[ot,Ge]),this}}),dt=ot.props;for(function(Ne,Ge){var Qe,tt,rt,nt,at;for(Qe in Ne)if(rt=Ge[tt=X(Qe)],nt=Ne[Qe],Array.isArray(nt)&&(rt=nt[1],nt=Ne[Qe]=nt[0]),Qe!==tt&&(Ne[tt]=nt,delete Ne[Qe]),(at=E.cssHooks[tt])&&"expand"in at)for(Qe in nt=at.expand(nt),delete Ne[tt],nt)Qe in Ne||(Ne[Qe]=nt[Qe],Ge[Qe]=rt);else Ge[tt]=rt}(dt,ot.opts.specialEasing);nt<at;nt++)if(tt=ft.prefilters[nt].call(ot,Ne,dt,ot.opts))return m(tt.stop)&&(E._queueHooks(ot.elem,ot.opts.queue).stop=tt.stop.bind(tt)),tt;return E.map(dt,ct,ot),m(ot.opts.start)&&ot.opts.start.call(Ne,ot),ot.progress(ot.opts.progress).done(ot.opts.done,ot.opts.complete).fail(ot.opts.fail).always(ot.opts.always),E.fx.timer(E.extend(u,{elem:Ne,anim:ot,queue:ot.opts.queue})),ot}E.Animation=E.extend(ft,{tweeners:{"*":[function(Ne,Ge){var Qe=this.createTween(Ne,Ge);return se(Qe.elem,Ne,ra.exec(Ge),Qe),Qe}]},tweener:function(Ne,Ge){m(Ne)?(Ge=Ne,Ne=["*"]):Ne=Ne.match(Pn);for(var Qe,tt=0,rt=Ne.length;tt<rt;tt++)Qe=Ne[tt],ft.tweeners[Qe]=ft.tweeners[Qe]||[],ft.tweeners[Qe].unshift(Ge)},prefilters:[function(Ne,Ge,Qe){var tt,rt,nt,at,it,ot,dt,ht,Dt="width"in Ge||"height"in Ge,Ot=this,Rt={},Zt=Ne.style,er=Ne.nodeType&&ae(Ne),dr=Vn.get(Ne,"fxshow");for(tt in Qe.queue||(null==(at=E._queueHooks(Ne,"fx")).unqueued&&(at.unqueued=0,it=at.empty.fire,at.empty.fire=function(){at.unqueued||it()}),at.unqueued++,Ot.always((function(){Ot.always((function(){at.unqueued--,E.queue(Ne,"fx").length||at.empty.fire()}))}))),Ge)if(rt=Ge[tt],Es.test(rt)){if(delete Ge[tt],nt=nt||"toggle"===rt,rt===(er?"hide":"show")){if("show"!==rt||!dr||void 0===dr[tt])continue;er=!0}Rt[tt]=dr&&dr[tt]||E.style(Ne,tt)}if((ot=!E.isEmptyObject(Ge))||!E.isEmptyObject(Rt))for(tt in Dt&&1===Ne.nodeType&&(Qe.overflow=[Zt.overflow,Zt.overflowX,Zt.overflowY],null==(dt=dr&&dr.display)&&(dt=Vn.get(Ne,"display")),"none"===(ht=E.css(Ne,"display"))&&(dt?ht=dt:(le([Ne],!0),dt=Ne.style.display||dt,ht=E.css(Ne,"display"),le([Ne]))),("inline"===ht||"inline-block"===ht&&null!=dt)&&"none"===E.css(Ne,"float")&&(ot||(Ot.done((function(){Zt.display=dt})),null==dt&&(ht=Zt.display,dt="none"===ht?"":ht)),Zt.display="inline-block")),Qe.overflow&&(Zt.overflow="hidden",Ot.always((function(){Zt.overflow=Qe.overflow[0],Zt.overflowX=Qe.overflow[1],Zt.overflowY=Qe.overflow[2]}))),ot=!1,Rt)ot||(dr?"hidden"in dr&&(er=dr.hidden):dr=Vn.access(Ne,"fxshow",{display:dt}),nt&&(dr.hidden=!er),er&&le([Ne],!0),Ot.done((function(){for(tt in er||le([Ne]),Vn.remove(Ne,"fxshow"),Rt)E.style(Ne,tt,Rt[tt])}))),ot=ct(er?dr[tt]:0,tt,Ot),tt in dr||(dr[tt]=ot.start,er&&(ot.end=ot.start,ot.start=0))}],prefilter:function(Ne,Ge){Ge?ft.prefilters.unshift(Ne):ft.prefilters.push(Ne)}}),E.speed=function(Ne,Ge,Qe){var tt=Ne&&"object"==typeof Ne?E.extend({},Ne):{complete:Qe||!Qe&&Ge||m(Ne)&&Ne,duration:Ne,easing:Qe&&Ge||Ge&&!m(Ge)&&Ge};return E.fx.off?tt.duration=0:"number"!=typeof tt.duration&&(tt.duration in E.fx.speeds?tt.duration=E.fx.speeds[tt.duration]:tt.duration=E.fx.speeds._default),null!=tt.queue&&!0!==tt.queue||(tt.queue="fx"),tt.old=tt.complete,tt.complete=function(){m(tt.old)&&tt.old.call(this),tt.queue&&E.dequeue(this,tt.queue)},tt},E.fn.extend({fadeTo:function(Ne,Ge,Qe,tt){return this.filter(ae).css("opacity",0).show().end().animate({opacity:Ge},Ne,Qe,tt)},animate:function(Ne,Ge,Qe,tt){var rt=E.isEmptyObject(Ne),nt=E.speed(Ge,Qe,tt),a=function(){var Ge=ft(this,E.extend({},Ne),nt);(rt||Vn.get(this,"finish"))&&Ge.stop(!0)};return a.finish=a,rt||!1===nt.queue?this.each(a):this.queue(nt.queue,a)},stop:function(Ne,Ge,Qe){var a=function(Ne){var Ge=Ne.stop;delete Ne.stop,Ge(Qe)};return"string"!=typeof Ne&&(Qe=Ge,Ge=Ne,Ne=void 0),Ge&&this.queue(Ne||"fx",[]),this.each((function(){var Ge=!0,tt=null!=Ne&&Ne+"queueHooks",rt=E.timers,nt=Vn.get(this);if(tt)nt[tt]&&nt[tt].stop&&a(nt[tt]);else for(tt in nt)nt[tt]&&nt[tt].stop&&Ls.test(tt)&&a(nt[tt]);for(tt=rt.length;tt--;)rt[tt].elem!==this||null!=Ne&&rt[tt].queue!==Ne||(rt[tt].anim.stop(Qe),Ge=!1,rt.splice(tt,1));!Ge&&Qe||E.dequeue(this,Ne)}))},finish:function(Ne){return!1!==Ne&&(Ne=Ne||"fx"),this.each((function(){var Ge,Qe=Vn.get(this),tt=Qe[Ne+"queue"],rt=Qe[Ne+"queueHooks"],nt=E.timers,at=tt?tt.length:0;for(Qe.finish=!0,E.queue(this,Ne,[]),rt&&rt.stop&&rt.stop.call(this,!0),Ge=nt.length;Ge--;)nt[Ge].elem===this&&nt[Ge].queue===Ne&&(nt[Ge].anim.stop(!0),nt.splice(Ge,1));for(Ge=0;Ge<at;Ge++)tt[Ge]&&tt[Ge].finish&&tt[Ge].finish.call(this);delete Qe.finish}))}}),E.each(["toggle","show","hide"],(function(Ne,Ge){var Qe=E.fn[Ge];E.fn[Ge]=function(Ne,tt,rt){return null==Ne||"boolean"==typeof Ne?Qe.apply(this,arguments):this.animate(lt(Ge,!0),Ne,tt,rt)}})),E.each({slideDown:lt("show"),slideUp:lt("hide"),slideToggle:lt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(Ne,Ge){E.fn[Ne]=function(Ne,Qe,tt){return this.animate(Ge,Ne,Qe,tt)}})),E.timers=[],E.fx.tick=function(){var Ne,Ge=0,Qe=E.timers;for(ws=Date.now();Ge<Qe.length;Ge++)(Ne=Qe[Ge])()||Qe[Ge]!==Ne||Qe.splice(Ge--,1);Qe.length||E.fx.stop(),ws=void 0},E.fx.timer=function(Ne){E.timers.push(Ne),E.fx.start()},E.fx.interval=13,E.fx.start=function(){Ts||(Ts=!0,st())},E.fx.stop=function(){Ts=null},E.fx.speeds={slow:600,fast:200,_default:400},E.fn.delay=function(Ne,Ge){return Ne=E.fx&&E.fx.speeds[Ne]||Ne,Ge=Ge||"fx",this.queue(Ge,(function(Ge,Qe){var rt=tt.setTimeout(Ge,Ne);Qe.stop=function(){tt.clearTimeout(rt)}}))},ks=mr.createElement("input"),Cs=mr.createElement("select").appendChild(mr.createElement("option")),ks.type="checkbox",dr.checkOn=""!==ks.value,dr.optSelected=Cs.selected,(ks=mr.createElement("input")).value="t",ks.type="radio",dr.radioValue="t"===ks.value;var Ps,Ds=E.expr.attrHandle;E.fn.extend({attr:function(Ne,Ge){return B(this,E.attr,Ne,Ge,1<arguments.length)},removeAttr:function(Ne){return this.each((function(){E.removeAttr(this,Ne)}))}}),E.extend({attr:function(Ne,Ge,Qe){var tt,rt,nt=Ne.nodeType;if(3!==nt&&8!==nt&&2!==nt)return void 0===Ne.getAttribute?E.prop(Ne,Ge,Qe):(1===nt&&E.isXMLDoc(Ne)||(rt=E.attrHooks[Ge.toLowerCase()]||(E.expr.match.bool.test(Ge)?Ps:void 0)),void 0!==Qe?null===Qe?void E.removeAttr(Ne,Ge):rt&&"set"in rt&&void 0!==(tt=rt.set(Ne,Qe,Ge))?tt:(Ne.setAttribute(Ge,Qe+""),Qe):rt&&"get"in rt&&null!==(tt=rt.get(Ne,Ge))?tt:null==(tt=E.find.attr(Ne,Ge))?void 0:tt)},attrHooks:{type:{set:function(Ne,Ge){if(!dr.radioValue&&"radio"===Ge&&A(Ne,"input")){var Qe=Ne.value;return Ne.setAttribute("type",Ge),Qe&&(Ne.value=Qe),Ge}}}},removeAttr:function(Ne,Ge){var Qe,tt=0,rt=Ge&&Ge.match(Pn);if(rt&&1===Ne.nodeType)for(;Qe=rt[tt++];)Ne.removeAttribute(Qe)}}),Ps={set:function(Ne,Ge,Qe){return!1===Ge?E.removeAttr(Ne,Qe):Ne.setAttribute(Qe,Qe),Qe}},E.each(E.expr.match.bool.source.match(/\w+/g),(function(Ne,Ge){var Qe=Ds[Ge]||E.find.attr;Ds[Ge]=function(Ne,Ge,tt){var rt,nt,at=Ge.toLowerCase();return tt||(nt=Ds[at],Ds[at]=rt,rt=null!=Qe(Ne,Ge,tt)?at:null,Ds[at]=nt),rt}}));var Is=/^(?:input|select|textarea|button)$/i,Os=/^(?:a|area)$/i;function yt(Ne){return(Ne.match(Pn)||[]).join(" ")}function vt(Ne){return Ne.getAttribute&&Ne.getAttribute("class")||""}function mt(Ne){return Array.isArray(Ne)?Ne:"string"==typeof Ne&&Ne.match(Pn)||[]}E.fn.extend({prop:function(Ne,Ge){return B(this,E.prop,Ne,Ge,1<arguments.length)},removeProp:function(Ne){return this.each((function(){delete this[E.propFix[Ne]||Ne]}))}}),E.extend({prop:function(Ne,Ge,Qe){var tt,rt,nt=Ne.nodeType;if(3!==nt&&8!==nt&&2!==nt)return 1===nt&&E.isXMLDoc(Ne)||(Ge=E.propFix[Ge]||Ge,rt=E.propHooks[Ge]),void 0!==Qe?rt&&"set"in rt&&void 0!==(tt=rt.set(Ne,Qe,Ge))?tt:Ne[Ge]=Qe:rt&&"get"in rt&&null!==(tt=rt.get(Ne,Ge))?tt:Ne[Ge]},propHooks:{tabIndex:{get:function(Ne){var Ge=E.find.attr(Ne,"tabindex");return Ge?parseInt(Ge,10):Is.test(Ne.nodeName)||Os.test(Ne.nodeName)&&Ne.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),dr.optSelected||(E.propHooks.selected={get:function(Ne){var Ge=Ne.parentNode;return Ge&&Ge.parentNode&&Ge.parentNode.selectedIndex,null},set:function(Ne){var Ge=Ne.parentNode;Ge&&(Ge.selectedIndex,Ge.parentNode&&Ge.parentNode.selectedIndex)}}),E.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){E.propFix[this.toLowerCase()]=this})),E.fn.extend({addClass:function(Ne){var Ge,Qe,tt,rt,nt,at;return m(Ne)?this.each((function(Ge){E(this).addClass(Ne.call(this,Ge,vt(this)))})):(Ge=mt(Ne)).length?this.each((function(){if(tt=vt(this),Qe=1===this.nodeType&&" "+yt(tt)+" "){for(nt=0;nt<Ge.length;nt++)rt=Ge[nt],Qe.indexOf(" "+rt+" ")<0&&(Qe+=rt+" ");at=yt(Qe),tt!==at&&this.setAttribute("class",at)}})):this},removeClass:function(Ne){var Ge,Qe,tt,rt,nt,at;return m(Ne)?this.each((function(Ge){E(this).removeClass(Ne.call(this,Ge,vt(this)))})):arguments.length?(Ge=mt(Ne)).length?this.each((function(){if(tt=vt(this),Qe=1===this.nodeType&&" "+yt(tt)+" "){for(nt=0;nt<Ge.length;nt++)for(rt=Ge[nt];-1<Qe.indexOf(" "+rt+" ");)Qe=Qe.replace(" "+rt+" "," ");at=yt(Qe),tt!==at&&this.setAttribute("class",at)}})):this:this.attr("class","")},toggleClass:function(Ne,Ge){var Qe,tt,rt,nt,at=typeof Ne,it="string"===at||Array.isArray(Ne);return m(Ne)?this.each((function(Qe){E(this).toggleClass(Ne.call(this,Qe,vt(this),Ge),Ge)})):"boolean"==typeof Ge&&it?Ge?this.addClass(Ne):this.removeClass(Ne):(Qe=mt(Ne),this.each((function(){if(it)for(nt=E(this),rt=0;rt<Qe.length;rt++)tt=Qe[rt],nt.hasClass(tt)?nt.removeClass(tt):nt.addClass(tt);else void 0!==Ne&&"boolean"!==at||((tt=vt(this))&&Vn.set(this,"__className__",tt),this.setAttribute&&this.setAttribute("class",tt||!1===Ne?"":Vn.get(this,"__className__")||""))})))},hasClass:function(Ne){var Ge,Qe,tt=0;for(Ge=" "+Ne+" ";Qe=this[tt++];)if(1===Qe.nodeType&&-1<(" "+yt(vt(Qe))+" ").indexOf(Ge))return!0;return!1}});var zs=/\r/g;E.fn.extend({val:function(Ne){var Ge,Qe,tt,rt=this[0];return arguments.length?(tt=m(Ne),this.each((function(Qe){var rt;1===this.nodeType&&(null==(rt=tt?Ne.call(this,Qe,E(this).val()):Ne)?rt="":"number"==typeof rt?rt+="":Array.isArray(rt)&&(rt=E.map(rt,(function(Ne){return null==Ne?"":Ne+""}))),(Ge=E.valHooks[this.type]||E.valHooks[this.nodeName.toLowerCase()])&&"set"in Ge&&void 0!==Ge.set(this,rt,"value")||(this.value=rt))}))):rt?(Ge=E.valHooks[rt.type]||E.valHooks[rt.nodeName.toLowerCase()])&&"get"in Ge&&void 0!==(Qe=Ge.get(rt,"value"))?Qe:"string"==typeof(Qe=rt.value)?Qe.replace(zs,""):null==Qe?"":Qe:void 0}}),E.extend({valHooks:{option:{get:function(Ne){var Ge=E.find.attr(Ne,"value");return null!=Ge?Ge:yt(E.text(Ne))}},select:{get:function(Ne){var Ge,Qe,tt,rt=Ne.options,nt=Ne.selectedIndex,at="select-one"===Ne.type,it=at?null:[],ot=at?nt+1:rt.length;for(tt=nt<0?ot:at?nt:0;tt<ot;tt++)if(((Qe=rt[tt]).selected||tt===nt)&&!Qe.disabled&&(!Qe.parentNode.disabled||!A(Qe.parentNode,"optgroup"))){if(Ge=E(Qe).val(),at)return Ge;it.push(Ge)}return it},set:function(Ne,Ge){for(var Qe,tt,rt=Ne.options,nt=E.makeArray(Ge),at=rt.length;at--;)((tt=rt[at]).selected=-1<E.inArray(E.valHooks.option.get(tt),nt))&&(Qe=!0);return Qe||(Ne.selectedIndex=-1),nt}}}}),E.each(["radio","checkbox"],(function(){E.valHooks[this]={set:function(Ne,Ge){if(Array.isArray(Ge))return Ne.checked=-1<E.inArray(E(Ne).val(),Ge)}},dr.checkOn||(E.valHooks[this].get=function(Ne){return null===Ne.getAttribute("value")?"on":Ne.value})})),dr.focusin="onfocusin"in tt;var Rs=/^(?:focusinfocus|focusoutblur)$/,wt=function(Ne){Ne.stopPropagation()};E.extend(E.event,{trigger:function(Ne,Ge,Qe,rt){var nt,at,it,ot,dt,ht,Dt,Ot,Zt=[Qe||mr],er=Rt.call(Ne,"type")?Ne.type:Ne,dr=Rt.call(Ne,"namespace")?Ne.namespace.split("."):[];if(at=Ot=it=Qe=Qe||mr,3!==Qe.nodeType&&8!==Qe.nodeType&&!Rs.test(er+E.event.triggered)&&(-1<er.indexOf(".")&&(er=(dr=er.split(".")).shift(),dr.sort()),dt=er.indexOf(":")<0&&"on"+er,(Ne=Ne[E.expando]?Ne:new E.Event(er,"object"==typeof Ne&&Ne)).isTrigger=rt?2:3,Ne.namespace=dr.join("."),Ne.rnamespace=Ne.namespace?new RegExp("(^|\\.)"+dr.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,Ne.result=void 0,Ne.target||(Ne.target=Qe),Ge=null==Ge?[Ne]:E.makeArray(Ge,[Ne]),Dt=E.event.special[er]||{},rt||!Dt.trigger||!1!==Dt.trigger.apply(Qe,Ge))){if(!rt&&!Dt.noBubble&&!x(Qe)){for(ot=Dt.delegateType||er,Rs.test(ot+er)||(at=at.parentNode);at;at=at.parentNode)Zt.push(at),it=at;it===(Qe.ownerDocument||mr)&&Zt.push(it.defaultView||it.parentWindow||tt)}for(nt=0;(at=Zt[nt++])&&!Ne.isPropagationStopped();)Ot=at,Ne.type=1<nt?ot:Dt.bindType||er,(ht=(Vn.get(at,"events")||Object.create(null))[Ne.type]&&Vn.get(at,"handle"))&&ht.apply(at,Ge),(ht=dt&&at[dt])&&ht.apply&&V(at)&&(Ne.result=ht.apply(at,Ge),!1===Ne.result&&Ne.preventDefault());return Ne.type=er,rt||Ne.isDefaultPrevented()||Dt._default&&!1!==Dt._default.apply(Zt.pop(),Ge)||!V(Qe)||dt&&m(Qe[er])&&!x(Qe)&&((it=Qe[dt])&&(Qe[dt]=null),E.event.triggered=er,Ne.isPropagationStopped()&&Ot.addEventListener(er,wt),Qe[er](),Ne.isPropagationStopped()&&Ot.removeEventListener(er,wt),E.event.triggered=void 0,it&&(Qe[dt]=it)),Ne.result}},simulate:function(Ne,Ge,Qe){var tt=E.extend(new E.Event,Qe,{type:Ne,isSimulated:!0});E.event.trigger(tt,null,Ge)}}),E.fn.extend({trigger:function(Ne,Ge){return this.each((function(){E.event.trigger(Ne,Ge,this)}))},triggerHandler:function(Ne,Ge){var Qe=this[0];if(Qe)return E.event.trigger(Ne,Ge,Qe,!0)}}),dr.focusin||E.each({focus:"focusin",blur:"focusout"},(function(Ne,Ge){var i=function(Ne){E.event.simulate(Ge,Ne.target,E.event.fix(Ne))};E.event.special[Ge]={setup:function(){var Qe=this.ownerDocument||this.document||this,tt=Vn.access(Qe,Ge);tt||Qe.addEventListener(Ne,i,!0),Vn.access(Qe,Ge,(tt||0)+1)},teardown:function(){var Qe=this.ownerDocument||this.document||this,tt=Vn.access(Qe,Ge)-1;tt?Vn.access(Qe,Ge,tt):(Qe.removeEventListener(Ne,i,!0),Vn.remove(Qe,Ge))}}}));var Bs=tt.location,Fs={guid:Date.now()},js=/\?/;E.parseXML=function(Ne){var Ge,Qe;if(!Ne||"string"!=typeof Ne)return null;try{Ge=(new tt.DOMParser).parseFromString(Ne,"text/xml")}catch(Ne){}return Qe=Ge&&Ge.getElementsByTagName("parsererror")[0],Ge&&!Qe||E.error("Invalid XML: "+(Qe?E.map(Qe.childNodes,(function(Ne){return Ne.textContent})).join("\n"):Ne)),Ge};var Zs=/\[\]$/,Ks=/\r?\n/g,al=/^(?:submit|button|image|reset|file)$/i,il=/^(?:input|select|textarea|keygen)/i;function jt(Ne,Ge,Qe,tt){var rt;if(Array.isArray(Ge))E.each(Ge,(function(Ge,rt){Qe||Zs.test(Ne)?tt(Ne,rt):jt(Ne+"["+("object"==typeof rt&&null!=rt?Ge:"")+"]",rt,Qe,tt)}));else if(Qe||"object"!==w(Ge))tt(Ne,Ge);else for(rt in Ge)jt(Ne+"["+rt+"]",Ge[rt],Qe,tt)}E.param=function(Ne,Ge){var Qe,tt=[],i=function(Ne,Ge){var Qe=m(Ge)?Ge():Ge;tt[tt.length]=encodeURIComponent(Ne)+"="+encodeURIComponent(null==Qe?"":Qe)};if(null==Ne)return"";if(Array.isArray(Ne)||Ne.jquery&&!E.isPlainObject(Ne))E.each(Ne,(function(){i(this.name,this.value)}));else for(Qe in Ne)jt(Qe,Ne[Qe],Ge,i);return tt.join("&")},E.fn.extend({serialize:function(){return E.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var Ne=E.prop(this,"elements");return Ne?E.makeArray(Ne):this})).filter((function(){var Ne=this.type;return this.name&&!E(this).is(":disabled")&&il.test(this.nodeName)&&!al.test(Ne)&&(this.checked||!Wa.test(Ne))})).map((function(Ne,Ge){var Qe=E(this).val();return null==Qe?null:Array.isArray(Qe)?E.map(Qe,(function(Ne){return{name:Ge.name,value:Ne.replace(Ks,"\r\n")}})):{name:Ge.name,value:Qe.replace(Ks,"\r\n")}})).get()}});var fl=/%20/g,dl=/#.*$/,hl=/([?&])_=[^&]*/,gl=/^(.*?):[ \t]*([^\r\n]*)$/gm,ml=/^(?:GET|HEAD)$/,vl=/^\/\//,xl={},bl={},_l="*/".concat("*"),wl=mr.createElement("a");function Ft(Ne){return function(Ge,Qe){"string"!=typeof Ge&&(Qe=Ge,Ge="*");var tt,rt=0,nt=Ge.toLowerCase().match(Pn)||[];if(m(Qe))for(;tt=nt[rt++];)"+"===tt[0]?(tt=tt.slice(1)||"*",(Ne[tt]=Ne[tt]||[]).unshift(Qe)):(Ne[tt]=Ne[tt]||[]).push(Qe)}}function $t(Ne,Ge,Qe,tt){var rt={},nt=Ne===bl;function l(at){var it;return rt[at]=!0,E.each(Ne[at]||[],(function(Ne,at){var ot=at(Ge,Qe,tt);return"string"!=typeof ot||nt||rt[ot]?nt?!(it=ot):void 0:(Ge.dataTypes.unshift(ot),l(ot),!1)})),it}return l(Ge.dataTypes[0])||!rt["*"]&&l("*")}function Bt(Ne,Ge){var Qe,tt,rt=E.ajaxSettings.flatOptions||{};for(Qe in Ge)void 0!==Ge[Qe]&&((rt[Qe]?Ne:tt||(tt={}))[Qe]=Ge[Qe]);return tt&&E.extend(!0,Ne,tt),Ne}wl.href=Bs.href,E.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Bs.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Bs.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":_l,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":E.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(Ne,Ge){return Ge?Bt(Bt(Ne,E.ajaxSettings),Ge):Bt(E.ajaxSettings,Ne)},ajaxPrefilter:Ft(xl),ajaxTransport:Ft(bl),ajax:function(Ne,Ge){"object"==typeof Ne&&(Ge=Ne,Ne=void 0),Ge=Ge||{};var Qe,rt,nt,at,it,ot,dt,ht,Dt,Ot,Rt=E.ajaxSetup({},Ge),Zt=Rt.context||Rt,er=Rt.context&&(Zt.nodeType||Zt.jquery)?E(Zt):E.event,dr=E.Deferred(),xr=E.Callbacks("once memory"),br=Rt.statusCode||{},Ar={},en={},mn="canceled",xn={readyState:0,getResponseHeader:function(Ne){var Ge;if(dt){if(!at)for(at={};Ge=gl.exec(nt);)at[Ge[1].toLowerCase()+" "]=(at[Ge[1].toLowerCase()+" "]||[]).concat(Ge[2]);Ge=at[Ne.toLowerCase()+" "]}return null==Ge?null:Ge.join(", ")},getAllResponseHeaders:function(){return dt?nt:null},setRequestHeader:function(Ne,Ge){return null==dt&&(Ne=en[Ne.toLowerCase()]=en[Ne.toLowerCase()]||Ne,Ar[Ne]=Ge),this},overrideMimeType:function(Ne){return null==dt&&(Rt.mimeType=Ne),this},statusCode:function(Ne){var Ge;if(Ne)if(dt)xn.always(Ne[xn.status]);else for(Ge in Ne)br[Ge]=[br[Ge],Ne[Ge]];return this},abort:function(Ne){var Ge=Ne||mn;return Qe&&Qe.abort(Ge),l(0,Ge),this}};if(dr.promise(xn),Rt.url=((Ne||Rt.url||Bs.href)+"").replace(vl,Bs.protocol+"//"),Rt.type=Ge.method||Ge.type||Rt.method||Rt.type,Rt.dataTypes=(Rt.dataType||"*").toLowerCase().match(Pn)||[""],null==Rt.crossDomain){ot=mr.createElement("a");try{ot.href=Rt.url,ot.href=ot.href,Rt.crossDomain=wl.protocol+"//"+wl.host!=ot.protocol+"//"+ot.host}catch(Ne){Rt.crossDomain=!0}}if(Rt.data&&Rt.processData&&"string"!=typeof Rt.data&&(Rt.data=E.param(Rt.data,Rt.traditional)),$t(xl,Rt,Ge,xn),dt)return xn;for(Dt in(ht=E.event&&Rt.global)&&0==E.active++&&E.event.trigger("ajaxStart"),Rt.type=Rt.type.toUpperCase(),Rt.hasContent=!ml.test(Rt.type),rt=Rt.url.replace(dl,""),Rt.hasContent?Rt.data&&Rt.processData&&0===(Rt.contentType||"").indexOf("application/x-www-form-urlencoded")&&(Rt.data=Rt.data.replace(fl,"+")):(Ot=Rt.url.slice(rt.length),Rt.data&&(Rt.processData||"string"==typeof Rt.data)&&(rt+=(js.test(rt)?"&":"?")+Rt.data,delete Rt.data),!1===Rt.cache&&(rt=rt.replace(hl,"$1"),Ot=(js.test(rt)?"&":"?")+"_="+Fs.guid+++Ot),Rt.url=rt+Ot),Rt.ifModified&&(E.lastModified[rt]&&xn.setRequestHeader("If-Modified-Since",E.lastModified[rt]),E.etag[rt]&&xn.setRequestHeader("If-None-Match",E.etag[rt])),(Rt.data&&Rt.hasContent&&!1!==Rt.contentType||Ge.contentType)&&xn.setRequestHeader("Content-Type",Rt.contentType),xn.setRequestHeader("Accept",Rt.dataTypes[0]&&Rt.accepts[Rt.dataTypes[0]]?Rt.accepts[Rt.dataTypes[0]]+("*"!==Rt.dataTypes[0]?", "+_l+"; q=0.01":""):Rt.accepts["*"]),Rt.headers)xn.setRequestHeader(Dt,Rt.headers[Dt]);if(Rt.beforeSend&&(!1===Rt.beforeSend.call(Zt,xn,Rt)||dt))return xn.abort();if(mn="abort",xr.add(Rt.complete),xn.done(Rt.success),xn.fail(Rt.error),Qe=$t(bl,Rt,Ge,xn)){if(xn.readyState=1,ht&&er.trigger("ajaxSend",[xn,Rt]),dt)return xn;Rt.async&&0<Rt.timeout&&(it=tt.setTimeout((function(){xn.abort("timeout")}),Rt.timeout));try{dt=!1,Qe.send(Ar,l)}catch(Ne){if(dt)throw Ne;l(-1,Ne)}}else l(-1,"No Transport");function l(Ne,Ge,at,ot){var Dt,Ot,mr,Ar,en,mn=Ge;dt||(dt=!0,it&&tt.clearTimeout(it),Qe=void 0,nt=ot||"",xn.readyState=0<Ne?4:0,Dt=200<=Ne&&Ne<300||304===Ne,at&&(Ar=function(Ne,Ge,Qe){for(var tt,rt,nt,at,it=Ne.contents,ot=Ne.dataTypes;"*"===ot[0];)ot.shift(),void 0===tt&&(tt=Ne.mimeType||Ge.getResponseHeader("Content-Type"));if(tt)for(rt in it)if(it[rt]&&it[rt].test(tt)){ot.unshift(rt);break}if(ot[0]in Qe)nt=ot[0];else{for(rt in Qe){if(!ot[0]||Ne.converters[rt+" "+ot[0]]){nt=rt;break}at||(at=rt)}nt=nt||at}if(nt)return nt!==ot[0]&&ot.unshift(nt),Qe[nt]}(Rt,xn,at)),!Dt&&-1<E.inArray("script",Rt.dataTypes)&&E.inArray("json",Rt.dataTypes)<0&&(Rt.converters["text script"]=function(){}),Ar=function(Ne,Ge,Qe,tt){var rt,nt,at,it,ot,dt={},ht=Ne.dataTypes.slice();if(ht[1])for(at in Ne.converters)dt[at.toLowerCase()]=Ne.converters[at];for(nt=ht.shift();nt;)if(Ne.responseFields[nt]&&(Qe[Ne.responseFields[nt]]=Ge),!ot&&tt&&Ne.dataFilter&&(Ge=Ne.dataFilter(Ge,Ne.dataType)),ot=nt,nt=ht.shift())if("*"===nt)nt=ot;else if("*"!==ot&&ot!==nt){if(!(at=dt[ot+" "+nt]||dt["* "+nt]))for(rt in dt)if((it=rt.split(" "))[1]===nt&&(at=dt[ot+" "+it[0]]||dt["* "+it[0]])){!0===at?at=dt[rt]:!0!==dt[rt]&&(nt=it[0],ht.unshift(it[1]));break}if(!0!==at)if(at&&Ne.throws)Ge=at(Ge);else try{Ge=at(Ge)}catch(Ne){return{state:"parsererror",error:at?Ne:"No conversion from "+ot+" to "+nt}}}return{state:"success",data:Ge}}(Rt,Ar,xn,Dt),Dt?(Rt.ifModified&&((en=xn.getResponseHeader("Last-Modified"))&&(E.lastModified[rt]=en),(en=xn.getResponseHeader("etag"))&&(E.etag[rt]=en)),204===Ne||"HEAD"===Rt.type?mn="nocontent":304===Ne?mn="notmodified":(mn=Ar.state,Ot=Ar.data,Dt=!(mr=Ar.error))):(mr=mn,!Ne&&mn||(mn="error",Ne<0&&(Ne=0))),xn.status=Ne,xn.statusText=(Ge||mn)+"",Dt?dr.resolveWith(Zt,[Ot,mn,xn]):dr.rejectWith(Zt,[xn,mn,mr]),xn.statusCode(br),br=void 0,ht&&er.trigger(Dt?"ajaxSuccess":"ajaxError",[xn,Rt,Dt?Ot:mr]),xr.fireWith(Zt,[xn,mn]),ht&&(er.trigger("ajaxComplete",[xn,Rt]),--E.active||E.event.trigger("ajaxStop")))}return xn},getJSON:function(Ne,Ge,Qe){return E.get(Ne,Ge,Qe,"json")},getScript:function(Ne,Ge){return E.get(Ne,void 0,Ge,"script")}}),E.each(["get","post"],(function(Ne,Ge){E[Ge]=function(Ne,Qe,tt,rt){return m(Qe)&&(rt=rt||tt,tt=Qe,Qe=void 0),E.ajax(E.extend({url:Ne,type:Ge,dataType:rt,data:Qe,success:tt},E.isPlainObject(Ne)&&Ne))}})),E.ajaxPrefilter((function(Ne){var Ge;for(Ge in Ne.headers)"content-type"===Ge.toLowerCase()&&(Ne.contentType=Ne.headers[Ge]||"")})),E._evalUrl=function(Ne,Ge,Qe){return E.ajax({url:Ne,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(Ne){E.globalEval(Ne,Ge,Qe)}})},E.fn.extend({wrapAll:function(Ne){var Ge;return this[0]&&(m(Ne)&&(Ne=Ne.call(this[0])),Ge=E(Ne,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&Ge.insertBefore(this[0]),Ge.map((function(){for(var Ne=this;Ne.firstElementChild;)Ne=Ne.firstElementChild;return Ne})).append(this)),this},wrapInner:function(Ne){return m(Ne)?this.each((function(Ge){E(this).wrapInner(Ne.call(this,Ge))})):this.each((function(){var Ge=E(this),Qe=Ge.contents();Qe.length?Qe.wrapAll(Ne):Ge.append(Ne)}))},wrap:function(Ne){var Ge=m(Ne);return this.each((function(Qe){E(this).wrapAll(Ge?Ne.call(this,Qe):Ne)}))},unwrap:function(Ne){return this.parent(Ne).not("body").each((function(){E(this).replaceWith(this.childNodes)})),this}}),E.expr.pseudos.hidden=function(Ne){return!E.expr.pseudos.visible(Ne)},E.expr.pseudos.visible=function(Ne){return!!(Ne.offsetWidth||Ne.offsetHeight||Ne.getClientRects().length)},E.ajaxSettings.xhr=function(){try{return new tt.XMLHttpRequest}catch(Ne){}};var kl={0:200,1223:204},Al=E.ajaxSettings.xhr();dr.cors=!!Al&&"withCredentials"in Al,dr.ajax=Al=!!Al,E.ajaxTransport((function(Ne){var Ge,Qe;if(dr.cors||Al&&!Ne.crossDomain)return{send:function(rt,nt){var at,it=Ne.xhr();if(it.open(Ne.type,Ne.url,Ne.async,Ne.username,Ne.password),Ne.xhrFields)for(at in Ne.xhrFields)it[at]=Ne.xhrFields[at];for(at in Ne.mimeType&&it.overrideMimeType&&it.overrideMimeType(Ne.mimeType),Ne.crossDomain||rt["X-Requested-With"]||(rt["X-Requested-With"]="XMLHttpRequest"),rt)it.setRequestHeader(at,rt[at]);Ge=function(Ne){return function(){Ge&&(Ge=Qe=it.onload=it.onerror=it.onabort=it.ontimeout=it.onreadystatechange=null,"abort"===Ne?it.abort():"error"===Ne?"number"!=typeof it.status?nt(0,"error"):nt(it.status,it.statusText):nt(kl[it.status]||it.status,it.statusText,"text"!==(it.responseType||"text")||"string"!=typeof it.responseText?{binary:it.response}:{text:it.responseText},it.getAllResponseHeaders()))}},it.onload=Ge(),Qe=it.onerror=it.ontimeout=Ge("error"),void 0!==it.onabort?it.onabort=Qe:it.onreadystatechange=function(){4===it.readyState&&tt.setTimeout((function(){Ge&&Qe()}))},Ge=Ge("abort");try{it.send(Ne.hasContent&&Ne.data||null)}catch(rt){if(Ge)throw rt}},abort:function(){Ge&&Ge()}}})),E.ajaxPrefilter((function(Ne){Ne.crossDomain&&(Ne.contents.script=!1)})),E.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(Ne){return E.globalEval(Ne),Ne}}}),E.ajaxPrefilter("script",(function(Ne){void 0===Ne.cache&&(Ne.cache=!1),Ne.crossDomain&&(Ne.type="GET")})),E.ajaxTransport("script",(function(Ne){var Ge,Qe;if(Ne.crossDomain||Ne.scriptAttrs)return{send:function(tt,rt){Ge=E("<script>").attr(Ne.scriptAttrs||{}).prop({charset:Ne.scriptCharset,src:Ne.url}).on("load error",Qe=function(Ne){Ge.remove(),Qe=null,Ne&&rt("error"===Ne.type?404:200,Ne.type)}),mr.head.appendChild(Ge[0])},abort:function(){Qe&&Qe()}}}));var Sl,Il=[],Bl=/(=)\?(?=&|$)|\?\?/;E.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var Ne=Il.pop()||E.expando+"_"+Fs.guid++;return this[Ne]=!0,Ne}}),E.ajaxPrefilter("json jsonp",(function(Ne,Ge,Qe){var rt,nt,at,it=!1!==Ne.jsonp&&(Bl.test(Ne.url)?"url":"string"==typeof Ne.data&&0===(Ne.contentType||"").indexOf("application/x-www-form-urlencoded")&&Bl.test(Ne.data)&&"data");if(it||"jsonp"===Ne.dataTypes[0])return rt=Ne.jsonpCallback=m(Ne.jsonpCallback)?Ne.jsonpCallback():Ne.jsonpCallback,it?Ne[it]=Ne[it].replace(Bl,"$1"+rt):!1!==Ne.jsonp&&(Ne.url+=(js.test(Ne.url)?"&":"?")+Ne.jsonp+"="+rt),Ne.converters["script json"]=function(){return at||E.error(rt+" was not called"),at[0]},Ne.dataTypes[0]="json",nt=tt[rt],tt[rt]=function(){at=arguments},Qe.always((function(){void 0===nt?E(tt).removeProp(rt):tt[rt]=nt,Ne[rt]&&(Ne.jsonpCallback=Ge.jsonpCallback,Il.push(rt)),at&&m(nt)&&nt(at[0]),at=nt=void 0})),"script"})),dr.createHTMLDocument=((Sl=mr.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Sl.childNodes.length),E.parseHTML=function(Ne,Ge,Qe){return"string"!=typeof Ne?[]:("boolean"==typeof Ge&&(Qe=Ge,Ge=!1),Ge||(dr.createHTMLDocument?((tt=(Ge=mr.implementation.createHTMLDocument("")).createElement("base")).href=mr.location.href,Ge.head.appendChild(tt)):Ge=mr),nt=!Qe&&[],(rt=mn.exec(Ne))?[Ge.createElement(rt[1])]:(rt=xe([Ne],Ge,nt),nt&&nt.length&&E(nt).remove(),E.merge([],rt.childNodes)));var tt,rt,nt},E.fn.load=function(Ne,Ge,Qe){var tt,rt,nt,at=this,it=Ne.indexOf(" ");return-1<it&&(tt=yt(Ne.slice(it)),Ne=Ne.slice(0,it)),m(Ge)?(Qe=Ge,Ge=void 0):Ge&&"object"==typeof Ge&&(rt="POST"),0<at.length&&E.ajax({url:Ne,type:rt||"GET",dataType:"html",data:Ge}).done((function(Ne){nt=arguments,at.html(tt?E("<div>").append(E.parseHTML(Ne)).find(tt):Ne)})).always(Qe&&function(Ne,Ge){at.each((function(){Qe.apply(this,nt||[Ne.responseText,Ge,Ne])}))}),this},E.expr.pseudos.animated=function(Ne){return E.grep(E.timers,(function(Ge){return Ne===Ge.elem})).length},E.offset={setOffset:function(Ne,Ge,Qe){var tt,rt,nt,at,it,ot,dt=E.css(Ne,"position"),ht=E(Ne),Dt={};"static"===dt&&(Ne.style.position="relative"),it=ht.offset(),nt=E.css(Ne,"top"),ot=E.css(Ne,"left"),("absolute"===dt||"fixed"===dt)&&-1<(nt+ot).indexOf("auto")?(at=(tt=ht.position()).top,rt=tt.left):(at=parseFloat(nt)||0,rt=parseFloat(ot)||0),m(Ge)&&(Ge=Ge.call(Ne,Qe,E.extend({},it))),null!=Ge.top&&(Dt.top=Ge.top-it.top+at),null!=Ge.left&&(Dt.left=Ge.left-it.left+rt),"using"in Ge?Ge.using.call(Ne,Dt):ht.css(Dt)}},E.fn.extend({offset:function(Ne){if(arguments.length)return void 0===Ne?this:this.each((function(Ge){E.offset.setOffset(this,Ne,Ge)}));var Ge,Qe,tt=this[0];return tt?tt.getClientRects().length?(Ge=tt.getBoundingClientRect(),Qe=tt.ownerDocument.defaultView,{top:Ge.top+Qe.pageYOffset,left:Ge.left+Qe.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var Ne,Ge,Qe,tt=this[0],rt={top:0,left:0};if("fixed"===E.css(tt,"position"))Ge=tt.getBoundingClientRect();else{for(Ge=this.offset(),Qe=tt.ownerDocument,Ne=tt.offsetParent||Qe.documentElement;Ne&&(Ne===Qe.body||Ne===Qe.documentElement)&&"static"===E.css(Ne,"position");)Ne=Ne.parentNode;Ne&&Ne!==tt&&1===Ne.nodeType&&((rt=E(Ne).offset()).top+=E.css(Ne,"borderTopWidth",!0),rt.left+=E.css(Ne,"borderLeftWidth",!0))}return{top:Ge.top-rt.top-E.css(tt,"marginTop",!0),left:Ge.left-rt.left-E.css(tt,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var Ne=this.offsetParent;Ne&&"static"===E.css(Ne,"position");)Ne=Ne.offsetParent;return Ne||pa}))}}),E.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(Ne,Ge){var Qe="pageYOffset"===Ge;E.fn[Ne]=function(tt){return B(this,(function(Ne,tt,rt){var nt;if(x(Ne)?nt=Ne:9===Ne.nodeType&&(nt=Ne.defaultView),void 0===rt)return nt?nt[Ge]:Ne[tt];nt?nt.scrollTo(Qe?nt.pageXOffset:rt,Qe?rt:nt.pageYOffset):Ne[tt]=rt}),Ne,tt,arguments.length)}})),E.each(["top","left"],(function(Ne,Ge){E.cssHooks[Ge]=_e(dr.pixelPosition,(function(Ne,Qe){if(Qe)return Qe=Be(Ne,Ge),go.test(Qe)?E(Ne).position()[Ge]+"px":Qe}))})),E.each({Height:"height",Width:"width"},(function(Ne,Ge){E.each({padding:"inner"+Ne,content:Ge,"":"outer"+Ne},(function(Qe,tt){E.fn[tt]=function(rt,nt){var at=arguments.length&&(Qe||"boolean"!=typeof rt),it=Qe||(!0===rt||!0===nt?"margin":"border");return B(this,(function(Ge,Qe,rt){var nt;return x(Ge)?0===tt.indexOf("outer")?Ge["inner"+Ne]:Ge.document.documentElement["client"+Ne]:9===Ge.nodeType?(nt=Ge.documentElement,Math.max(Ge.body["scroll"+Ne],nt["scroll"+Ne],Ge.body["offset"+Ne],nt["offset"+Ne],nt["client"+Ne])):void 0===rt?E.css(Ge,Qe,it):E.style(Ge,Qe,rt,it)}),Ge,at?rt:void 0,at)}}))})),E.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(Ne,Ge){E.fn[Ge]=function(Ne){return this.on(Ge,Ne)}})),E.fn.extend({bind:function(Ne,Ge,Qe){return this.on(Ne,null,Ge,Qe)},unbind:function(Ne,Ge){return this.off(Ne,null,Ge)},delegate:function(Ne,Ge,Qe,tt){return this.on(Ge,Ne,Qe,tt)},undelegate:function(Ne,Ge,Qe){return 1===arguments.length?this.off(Ne,"**"):this.off(Ge,Ne||"**",Qe)},hover:function(Ne,Ge){return this.mouseenter(Ne).mouseleave(Ge||Ne)}}),E.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(Ne,Ge){E.fn[Ge]=function(Ne,Qe){return 0<arguments.length?this.on(Ge,null,Ne,Qe):this.trigger(Ge)}}));var Xl=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;E.proxy=function(Ne,Ge){var Qe,tt,rt;if("string"==typeof Ge&&(Qe=Ne[Ge],Ge=Ne,Ne=Qe),m(Ne))return tt=it.call(arguments,2),(rt=function(){return Ne.apply(Ge||this,tt.concat(it.call(arguments)))}).guid=Ne.guid=Ne.guid||E.guid++,rt},E.holdReady=function(Ne){Ne?E.readyWait++:E.ready(!0)},E.isArray=Array.isArray,E.parseJSON=JSON.parse,E.nodeName=A,E.isFunction=m,E.isWindow=x,E.camelCase=X,E.type=w,E.now=Date.now,E.isNumeric=function(Ne){var Ge=E.type(Ne);return("number"===Ge||"string"===Ge)&&!isNaN(Ne-parseFloat(Ne))},E.trim=function(Ne){return null==Ne?"":(Ne+"").replace(Xl,"$1")},void 0===(Qe=function(){return E}.apply(Ge,[]))||(Ne.exports=Qe);var ec=tt.jQuery,tc=tt.$;return E.noConflict=function(Ne){return tt.$===E&&(tt.$=tc),Ne&&tt.jQuery===E&&(tt.jQuery=ec),E},void 0===rt&&(tt.jQuery=tt.$=E),E}))},54922:function(Ne,Ge,Qe){var tt,rt,nt,at=Qe(20198);!function(it){var ot=this||(0,eval)("this"),dt=ot.document,ht=ot.navigator,Dt=ot.jQuery,Ot=ot.JSON;Dt||void 0===at||(Dt=at),function(at){rt=[Ge,Qe],void 0===(nt="function"==typeof(tt=at)?tt.apply(Ge,rt):tt)||(Ne.exports=nt)}((function(Ne,Ge){function K(Ne,Ge){return(null===Ne||typeof Ne in er)&&Ne===Ge}function X(Ne,Ge){var Qe;return function(){Qe||(Qe=Zt.a.setTimeout((function(){Qe=it,Ne()}),Ge))}}function Y(Ne,Ge){var Qe;return function(){clearTimeout(Qe),Qe=Zt.a.setTimeout(Ne,Ge)}}function Z(Ne,Ge){Ge&&"change"!==Ge?"beforeChange"===Ge?this.oc(Ne):this.bb(Ne,Ge):this.pc(Ne)}function aa(Ne,Ge){null!==Ge&&Ge.s&&Ge.s()}function ba(Ne,Ge){var Qe=this.pd,tt=Qe[Ar];tt.qa||(this.Pb&&this.kb[Ge]?(Qe.tc(Ge,Ne,this.kb[Ge]),this.kb[Ge]=null,--this.Pb):tt.F[Ge]||Qe.tc(Ge,Ne,tt.G?{da:Ne}:Qe.Zc(Ne)),Ne.Ka&&Ne.fd())}var Qe,tt,rt,nt,at,Rt,Zt=void 0!==Ne?Ne:{};Zt.b=function(Ne,Ge){for(var Qe=Ne.split("."),tt=Zt,rt=0;rt<Qe.length-1;rt++)tt=tt[Qe[rt]];tt[Qe[Qe.length-1]]=Ge},Zt.J=function(Ne,Ge,Qe){Ne[Ge]=Qe},Zt.version="3.5.0",Zt.b("version",Zt.version),Zt.options={deferUpdates:!1,useOnlyNativeEvents:!1,foreachHidesDestroyed:!1},Zt.a=function(){function b(Ge,Qe){for(var tt in Ge)Ne.call(Ge,tt)&&Qe(tt,Ge[tt])}function c(Ge,Qe){if(Qe)for(var tt in Qe)Ne.call(Qe,tt)&&(Ge[tt]=Qe[tt]);return Ge}function d(Ne,Ge){return Ne.__proto__=Ge,Ne}function e(Ne,Ge,Qe,tt){var rt=Ne[Ge].match(er)||[];Zt.a.C(Qe.match(er),(function(Ne){Zt.a.Oa(rt,Ne,tt)})),Ne[Ge]=rt.join(" ")}var Ne=Object.prototype.hasOwnProperty,Ge={__proto__:[]}instanceof Array,Qe="function"==typeof Symbol,tt={},rt={};tt[ht&&/Firefox\/2/i.test(ht.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],tt.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" "),b(tt,(function(Ne,Ge){if(Ge.length)for(var Qe=0,tt=Ge.length;Qe<tt;Qe++)rt[Ge[Qe]]=Ne}));var nt,at={propertychange:!0},Rt=dt&&function(){for(var Ne=3,Ge=dt.createElement("div"),Qe=Ge.getElementsByTagName("i");Ge.innerHTML="\x3c!--[if gt IE "+ ++Ne+"]><i></i><![endif]--\x3e",Qe[0];);return 4<Ne?Ne:it}(),er=/\S+/g;return{Ic:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],C:function(Ne,Ge,Qe){for(var tt=0,rt=Ne.length;tt<rt;tt++)Ge.call(Qe,Ne[tt],tt,Ne)},A:"function"==typeof Array.prototype.indexOf?function(Ne,Ge){return Array.prototype.indexOf.call(Ne,Ge)}:function(Ne,Ge){for(var Qe=0,tt=Ne.length;Qe<tt;Qe++)if(Ne[Qe]===Ge)return Qe;return-1},Lb:function(Ne,Ge,Qe){for(var tt=0,rt=Ne.length;tt<rt;tt++)if(Ge.call(Qe,Ne[tt],tt,Ne))return Ne[tt];return it},hb:function(Ne,Ge){var Qe=Zt.a.A(Ne,Ge);0<Qe?Ne.splice(Qe,1):0===Qe&&Ne.shift()},vc:function(Ne){var Ge=[];return Ne&&Zt.a.C(Ne,(function(Ne){0>Zt.a.A(Ge,Ne)&&Ge.push(Ne)})),Ge},Mb:function(Ne,Ge,Qe){var tt=[];if(Ne)for(var rt=0,nt=Ne.length;rt<nt;rt++)tt.push(Ge.call(Qe,Ne[rt],rt));return tt},fb:function(Ne,Ge,Qe){var tt=[];if(Ne)for(var rt=0,nt=Ne.length;rt<nt;rt++)Ge.call(Qe,Ne[rt],rt)&&tt.push(Ne[rt]);return tt},gb:function(Ne,Ge){if(Ge instanceof Array)Ne.push.apply(Ne,Ge);else for(var Qe=0,tt=Ge.length;Qe<tt;Qe++)Ne.push(Ge[Qe]);return Ne},Oa:function(Ne,Ge,Qe){var tt=Zt.a.A(Zt.a.$b(Ne),Ge);0>tt?Qe&&Ne.push(Ge):Qe||Ne.splice(tt,1)},Ba:Ge,extend:c,setPrototypeOf:d,zb:Ge?d:c,O:b,Ha:function(Ge,Qe,tt){if(!Ge)return Ge;var rt,nt={};for(rt in Ge)Ne.call(Ge,rt)&&(nt[rt]=Qe.call(tt,Ge[rt],rt,Ge));return nt},Sb:function(Ne){for(;Ne.firstChild;)Zt.removeNode(Ne.firstChild)},Xb:function(Ne){for(var Ge=((Ne=Zt.a.la(Ne))[0]&&Ne[0].ownerDocument||dt).createElement("div"),Qe=0,tt=Ne.length;Qe<tt;Qe++)Ge.appendChild(Zt.na(Ne[Qe]));return Ge},Ca:function(Ne,Ge){for(var Qe=0,tt=Ne.length,rt=[];Qe<tt;Qe++){var nt=Ne[Qe].cloneNode(!0);rt.push(Ge?Zt.na(nt):nt)}return rt},ua:function(Ne,Ge){if(Zt.a.Sb(Ne),Ge)for(var Qe=0,tt=Ge.length;Qe<tt;Qe++)Ne.appendChild(Ge[Qe])},Wc:function(Ne,Ge){var Qe=Ne.nodeType?[Ne]:Ne;if(0<Qe.length){for(var tt=Qe[0],rt=tt.parentNode,nt=0,at=Ge.length;nt<at;nt++)rt.insertBefore(Ge[nt],tt);for(nt=0,at=Qe.length;nt<at;nt++)Zt.removeNode(Qe[nt])}},Ua:function(Ne,Ge){if(Ne.length){for(Ge=8===Ge.nodeType&&Ge.parentNode||Ge;Ne.length&&Ne[0].parentNode!==Ge;)Ne.splice(0,1);for(;1<Ne.length&&Ne[Ne.length-1].parentNode!==Ge;)Ne.length--;if(1<Ne.length){var Qe=Ne[0],tt=Ne[Ne.length-1];for(Ne.length=0;Qe!==tt;)Ne.push(Qe),Qe=Qe.nextSibling;Ne.push(tt)}}return Ne},Yc:function(Ne,Ge){7>Rt?Ne.setAttribute("selected",Ge):Ne.selected=Ge},Cb:function(Ne){return null===Ne||Ne===it?"":Ne.trim?Ne.trim():Ne.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},Td:function(Ne,Ge){return Ne=Ne||"",!(Ge.length>Ne.length)&&Ne.substring(0,Ge.length)===Ge},ud:function(Ne,Ge){if(Ne===Ge)return!0;if(11===Ne.nodeType)return!1;if(Ge.contains)return Ge.contains(1!==Ne.nodeType?Ne.parentNode:Ne);if(Ge.compareDocumentPosition)return 16==(16&Ge.compareDocumentPosition(Ne));for(;Ne&&Ne!=Ge;)Ne=Ne.parentNode;return!!Ne},Rb:function(Ne){return Zt.a.ud(Ne,Ne.ownerDocument.documentElement)},jd:function(Ne){return!!Zt.a.Lb(Ne,Zt.a.Rb)},P:function(Ne){return Ne&&Ne.tagName&&Ne.tagName.toLowerCase()},zc:function(Ne){return Zt.onError?function(){try{return Ne.apply(this,arguments)}catch(Ne){throw Zt.onError&&Zt.onError(Ne),Ne}}:Ne},setTimeout:function(Ne,Ge){return setTimeout(Zt.a.zc(Ne),Ge)},Fc:function(Ne){setTimeout((function(){throw Zt.onError&&Zt.onError(Ne),Ne}),0)},H:function(Ne,Ge,Qe){var tt=Zt.a.zc(Qe);if(Qe=at[Ge],Zt.options.useOnlyNativeEvents||Qe||!Dt)if(Qe||"function"!=typeof Ne.addEventListener){if(void 0===Ne.attachEvent)throw Error("Browser doesn't support addEventListener or attachEvent");var f=function(Ge){tt.call(Ne,Ge)},rt="on"+Ge;Ne.attachEvent(rt,f),Zt.a.I.za(Ne,(function(){Ne.detachEvent(rt,f)}))}else Ne.addEventListener(Ge,tt,!1);else nt||(nt="function"==typeof Dt(Ne).on?"on":"bind"),Dt(Ne)[nt](Ge,tt)},Fb:function(Ne,Ge){if(!Ne||!Ne.nodeType)throw Error("element must be a DOM node when calling triggerEvent");var Qe;if(Qe=!("input"!==Zt.a.P(Ne)||!Ne.type||"click"!=Ge.toLowerCase())&&("checkbox"==(Qe=Ne.type)||"radio"==Qe),Zt.options.useOnlyNativeEvents||!Dt||Qe)if("function"==typeof dt.createEvent){if("function"!=typeof Ne.dispatchEvent)throw Error("The supplied element doesn't support dispatchEvent");(Qe=dt.createEvent(rt[Ge]||"HTMLEvents")).initEvent(Ge,!0,!0,ot,0,0,0,0,0,!1,!1,!1,!1,0,Ne),Ne.dispatchEvent(Qe)}else if(Qe&&Ne.click)Ne.click();else{if(void 0===Ne.fireEvent)throw Error("Browser doesn't support triggering events");Ne.fireEvent("on"+Ge)}else Dt(Ne).trigger(Ge)},c:function(Ne){return Zt.N(Ne)?Ne():Ne},$b:function(Ne){return Zt.N(Ne)?Ne.w():Ne},Eb:function(Ne,Ge,Qe){var tt;Ge&&("object"==typeof Ne.classList?(tt=Ne.classList[Qe?"add":"remove"],Zt.a.C(Ge.match(er),(function(Ge){tt.call(Ne.classList,Ge)}))):"string"==typeof Ne.className.baseVal?e(Ne.className,"baseVal",Ge,Qe):e(Ne,"className",Ge,Qe))},Ab:function(Ne,Ge){var Qe=Zt.a.c(Ge);null!==Qe&&Qe!==it||(Qe="");var tt=Zt.h.firstChild(Ne);!tt||3!=tt.nodeType||Zt.h.nextSibling(tt)?Zt.h.ua(Ne,[Ne.ownerDocument.createTextNode(Qe)]):tt.data=Qe,Zt.a.zd(Ne)},Xc:function(Ne,Ge){if(Ne.name=Ge,7>=Rt)try{var Qe=Ne.name.replace(/[&<>'"]/g,(function(Ne){return"&#"+Ne.charCodeAt(0)+";"}));Ne.mergeAttributes(dt.createElement("<input name='"+Qe+"'/>"),!1)}catch(Ne){}},zd:function(Ne){9<=Rt&&(Ne=1==Ne.nodeType?Ne:Ne.parentNode).style&&(Ne.style.zoom=Ne.style.zoom)},vd:function(Ne){if(Rt){var Ge=Ne.style.width;Ne.style.width=0,Ne.style.width=Ge}},Od:function(Ne,Ge){Ne=Zt.a.c(Ne),Ge=Zt.a.c(Ge);for(var Qe=[],tt=Ne;tt<=Ge;tt++)Qe.push(tt);return Qe},la:function(Ne){for(var Ge=[],Qe=0,tt=Ne.length;Qe<tt;Qe++)Ge.push(Ne[Qe]);return Ge},Da:function(Ne){return Qe?Symbol(Ne):Ne},Xd:6===Rt,Yd:7===Rt,W:Rt,Kc:function(Ne,Ge){for(var Qe=Zt.a.la(Ne.getElementsByTagName("input")).concat(Zt.a.la(Ne.getElementsByTagName("textarea"))),tt="string"==typeof Ge?function(Ne){return Ne.name===Ge}:function(Ne){return Ge.test(Ne.name)},rt=[],nt=Qe.length-1;0<=nt;nt--)tt(Qe[nt])&&rt.push(Qe[nt]);return rt},Md:function(Ne){return"string"==typeof Ne&&(Ne=Zt.a.Cb(Ne))?Ot&&Ot.parse?Ot.parse(Ne):new Function("return "+Ne)():null},fc:function(Ne,Ge,Qe){if(!Ot||!Ot.stringify)throw Error("Cannot find JSON.stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js");return Ot.stringify(Zt.a.c(Ne),Ge,Qe)},Nd:function(Ne,Ge,Qe){var tt=(Qe=Qe||{}).params||{},rt=Qe.includeFields||this.Ic,nt=Ne;if("object"==typeof Ne&&"form"===Zt.a.P(Ne)){nt=Ne.action;for(var at=rt.length-1;0<=at;at--)for(var it=Zt.a.Kc(Ne,rt[at]),ot=it.length-1;0<=ot;ot--)tt[it[ot].name]=it[ot].value}Ge=Zt.a.c(Ge);var ht=dt.createElement("form");for(var Dt in ht.style.display="none",ht.action=nt,ht.method="post",Ge)(Ne=dt.createElement("input")).type="hidden",Ne.name=Dt,Ne.value=Zt.a.fc(Zt.a.c(Ge[Dt])),ht.appendChild(Ne);b(tt,(function(Ne,Ge){var Qe=dt.createElement("input");Qe.type="hidden",Qe.name=Ne,Qe.value=Ge,ht.appendChild(Qe)})),dt.body.appendChild(ht),Qe.submitter?Qe.submitter(ht):ht.submit(),setTimeout((function(){ht.parentNode.removeChild(ht)}),0)}}}(),Zt.b("utils",Zt.a),Zt.b("utils.arrayForEach",Zt.a.C),Zt.b("utils.arrayFirst",Zt.a.Lb),Zt.b("utils.arrayFilter",Zt.a.fb),Zt.b("utils.arrayGetDistinctValues",Zt.a.vc),Zt.b("utils.arrayIndexOf",Zt.a.A),Zt.b("utils.arrayMap",Zt.a.Mb),Zt.b("utils.arrayPushAll",Zt.a.gb),Zt.b("utils.arrayRemoveItem",Zt.a.hb),Zt.b("utils.cloneNodes",Zt.a.Ca),Zt.b("utils.createSymbolOrString",Zt.a.Da),Zt.b("utils.extend",Zt.a.extend),Zt.b("utils.fieldsIncludedWithJsonPost",Zt.a.Ic),Zt.b("utils.getFormFields",Zt.a.Kc),Zt.b("utils.objectMap",Zt.a.Ha),Zt.b("utils.peekObservable",Zt.a.$b),Zt.b("utils.postJson",Zt.a.Nd),Zt.b("utils.parseJson",Zt.a.Md),Zt.b("utils.registerEventHandler",Zt.a.H),Zt.b("utils.stringifyJson",Zt.a.fc),Zt.b("utils.range",Zt.a.Od),Zt.b("utils.toggleDomNodeCssClass",Zt.a.Eb),Zt.b("utils.triggerEvent",Zt.a.Fb),Zt.b("utils.unwrapObservable",Zt.a.c),Zt.b("utils.objectForEach",Zt.a.O),Zt.b("utils.addOrRemoveItem",Zt.a.Oa),Zt.b("utils.setTextContent",Zt.a.Ab),Zt.b("unwrap",Zt.a.c),Function.prototype.bind||(Function.prototype.bind=function(Ne){var Ge=this;if(1===arguments.length)return function(){return Ge.apply(Ne,arguments)};var Qe=Array.prototype.slice.call(arguments,1);return function(){var tt=Qe.slice(0);return tt.push.apply(tt,arguments),Ge.apply(Ne,tt)}}),Zt.a.g=new function(){var Ne,Ge,Qe=0,tt="__ko__"+(new Date).getTime(),rt={};return Zt.a.W?(Ne=function(Ne,Ge){var nt=Ne[tt];if(!nt||"null"===nt||!rt[nt]){if(!Ge)return it;nt=Ne[tt]="ko"+Qe++,rt[nt]={}}return rt[nt]},Ge=function(Ne){var Ge=Ne[tt];return!!Ge&&(delete rt[Ge],Ne[tt]=null,!0)}):(Ne=function(Ne,Ge){var Qe=Ne[tt];return!Qe&&Ge&&(Qe=Ne[tt]={}),Qe},Ge=function(Ne){return!!Ne[tt]&&(delete Ne[tt],!0)}),{get:function(Ge,Qe){var tt=Ne(Ge,!1);return tt&&tt[Qe]},set:function(Ge,Qe,tt){(Ge=Ne(Ge,tt!==it))&&(Ge[Qe]=tt)},Tb:function(Ge,Qe,tt){return(Ge=Ne(Ge,!0))[Qe]||(Ge[Qe]=tt)},clear:Ge,Z:function(){return Qe+++tt}}},Zt.b("utils.domData",Zt.a.g),Zt.b("utils.domData.clear",Zt.a.g.clear),Zt.a.I=new function(){function b(Ge,Qe){var tt=Zt.a.g.get(Ge,Ne);return tt===it&&Qe&&(tt=[],Zt.a.g.set(Ge,Ne,tt)),tt}function c(Ne){if(Ge=b(Ne,!1))for(var Ge=Ge.slice(0),tt=0;tt<Ge.length;tt++)Ge[tt](Ne);Zt.a.g.clear(Ne),Zt.a.I.cleanExternalData(Ne),Qe[Ne.nodeType]&&d(Ne.childNodes,!0)}function d(Ne,Ge){for(var Qe,tt=[],rt=0;rt<Ne.length;rt++)if((!Ge||8===Ne[rt].nodeType)&&(c(tt[tt.length]=Qe=Ne[rt]),Ne[rt]!==Qe))for(;rt--&&-1==Zt.a.A(tt,Ne[rt]););}var Ne=Zt.a.g.Z(),Ge={1:!0,8:!0,9:!0},Qe={1:!0,9:!0};return{za:function(Ne,Ge){if("function"!=typeof Ge)throw Error("Callback must be a function");b(Ne,!0).push(Ge)},xb:function(Ge,Qe){var tt=b(Ge,!1);tt&&(Zt.a.hb(tt,Qe),0==tt.length&&Zt.a.g.set(Ge,Ne,it))},na:function(Ne){return Ge[Ne.nodeType]&&(c(Ne),Qe[Ne.nodeType]&&d(Ne.getElementsByTagName("*"))),Ne},removeNode:function(Ne){Zt.na(Ne),Ne.parentNode&&Ne.parentNode.removeChild(Ne)},cleanExternalData:function(Ne){Dt&&"function"==typeof Dt.cleanData&&Dt.cleanData([Ne])}}},Zt.na=Zt.a.I.na,Zt.removeNode=Zt.a.I.removeNode,Zt.b("cleanNode",Zt.na),Zt.b("removeNode",Zt.removeNode),Zt.b("utils.domNodeDisposal",Zt.a.I),Zt.b("utils.domNodeDisposal.addDisposeCallback",Zt.a.I.za),Zt.b("utils.domNodeDisposal.removeDisposeCallback",Zt.a.I.xb),Qe=[0,"",""],at={thead:tt=[1,"<table>","</table>"],tbody:tt,tfoot:tt,tr:[2,"<table><tbody>","</tbody></table>"],td:rt=[3,"<table><tbody><tr>","</tr></tbody></table>"],th:rt,option:nt=[1,"<select multiple='multiple'>","</select>"],optgroup:nt},Rt=8>=Zt.a.W,Zt.a.ta=function(Ne,Ge){var tt;if(Dt){if(Dt.parseHTML)tt=Dt.parseHTML(Ne,Ge)||[];else if((tt=Dt.clean([Ne],Ge))&&tt[0]){for(var rt=tt[0];rt.parentNode&&11!==rt.parentNode.nodeType;)rt=rt.parentNode;rt.parentNode&&rt.parentNode.removeChild(rt)}}else{(tt=Ge)||(tt=dt),rt=tt.parentWindow||tt.defaultView||ot;var nt,it=Zt.a.Cb(Ne).toLowerCase(),ht=tt.createElement("div");for(nt=(it=it.match(/^(?:\x3c!--.*?--\x3e\s*?)*?<([a-z]+)[\s>]/))&&at[it[1]]||Qe,it=nt[0],nt="ignored<div>"+nt[1]+Ne+nt[2]+"</div>","function"==typeof rt.innerShiv?ht.appendChild(rt.innerShiv(nt)):(Rt&&tt.body.appendChild(ht),ht.innerHTML=nt,Rt&&ht.parentNode.removeChild(ht));it--;)ht=ht.lastChild;tt=Zt.a.la(ht.lastChild.childNodes)}return tt},Zt.a.Ld=function(Ne,Ge){var Qe=Zt.a.ta(Ne,Ge);return Qe.length&&Qe[0].parentElement||Zt.a.Xb(Qe)},Zt.a.dc=function(Ne,Ge){if(Zt.a.Sb(Ne),null!==(Ge=Zt.a.c(Ge))&&Ge!==it)if("string"!=typeof Ge&&(Ge=Ge.toString()),Dt)Dt(Ne).html(Ge);else for(var Qe=Zt.a.ta(Ge,Ne.ownerDocument),tt=0;tt<Qe.length;tt++)Ne.appendChild(Qe[tt])},Zt.b("utils.parseHtmlFragment",Zt.a.ta),Zt.b("utils.setHtml",Zt.a.dc),Zt.aa=function(){function b(Ne,Ge){if(Ne)if(8==Ne.nodeType)null!=(Qe=Zt.aa.Tc(Ne.nodeValue))&&Ge.push({sd:Ne,Jd:Qe});else if(1==Ne.nodeType)for(var Qe=0,tt=Ne.childNodes,rt=tt.length;Qe<rt;Qe++)b(tt[Qe],Ge)}var Ne={};return{Wb:function(Ge){if("function"!=typeof Ge)throw Error("You can only pass a function to ko.memoization.memoize()");var Qe=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1);return Ne[Qe]=Ge,"\x3c!--[ko_memo:"+Qe+"]--\x3e"},ad:function(Ge,Qe){var tt=Ne[Ge];if(tt===it)throw Error("Couldn't find any memo with ID "+Ge+". Perhaps it's already been unmemoized.");try{return tt.apply(null,Qe||[]),!0}finally{delete Ne[Ge]}},bd:function(Ne,Ge){var Qe=[];b(Ne,Qe);for(var tt=0,rt=Qe.length;tt<rt;tt++){var nt=Qe[tt].sd,at=[nt];Ge&&Zt.a.gb(at,Ge),Zt.aa.ad(Qe[tt].Jd,at),nt.nodeValue="",nt.parentNode&&nt.parentNode.removeChild(nt)}},Tc:function(Ne){return(Ne=Ne.match(/^\[ko_memo\:(.*?)\]$/))?Ne[1]:null}}}(),Zt.b("memoization",Zt.aa),Zt.b("memoization.memoize",Zt.aa.Wb),Zt.b("memoization.unmemoize",Zt.aa.ad),Zt.b("memoization.parseMemoText",Zt.aa.Tc),Zt.b("memoization.unmemoizeDomNodeAndDescendants",Zt.aa.bd),Zt.ma=function(){function b(){if(Qe)for(var Ne,tt=Qe,nt=0;rt<Qe;)if(Ne=Ge[rt++]){if(rt>tt){if(5e3<=++nt){rt=Qe,Zt.a.Fc(Error("'Too much recursion' after processing "+nt+" task groups."));break}tt=Qe}try{Ne()}catch(Ne){Zt.a.Fc(Ne)}}}function c(){b(),rt=Qe=Ge.length=0}var Ne,Ge=[],Qe=0,tt=1,rt=0;return Ne=ot.MutationObserver?function(Ne){var Ge=dt.createElement("div");return new MutationObserver(Ne).observe(Ge,{attributes:!0}),function(){Ge.classList.toggle("foo")}}(c):dt&&"onreadystatechange"in dt.createElement("script")?function(Ne){var Ge=dt.createElement("script");Ge.onreadystatechange=function(){Ge.onreadystatechange=null,dt.documentElement.removeChild(Ge),Ge=null,Ne()},dt.documentElement.appendChild(Ge)}:function(Ne){setTimeout(Ne,0)},{scheduler:Ne,yb:function(Ne){return Qe||Zt.ma.scheduler(c),Ge[Qe++]=Ne,tt++},cancel:function(Ne){(Ne-=tt-Qe)>=rt&&Ne<Qe&&(Ge[Ne]=null)},resetForTesting:function(){var Ne=Qe-rt;return rt=Qe=Ge.length=0,Ne},Rd:b}}(),Zt.b("tasks",Zt.ma),Zt.b("tasks.schedule",Zt.ma.yb),Zt.b("tasks.runEarly",Zt.ma.Rd),Zt.Ta={throttle:function(Ne,Ge){Ne.throttleEvaluation=Ge;var Qe=null;return Zt.$({read:Ne,write:function(tt){clearTimeout(Qe),Qe=Zt.a.setTimeout((function(){Ne(tt)}),Ge)}})},rateLimit:function(Ne,Ge){var Qe,tt,rt;"number"==typeof Ge?Qe=Ge:(Qe=Ge.timeout,tt=Ge.method),Ne.Hb=!1,rt="function"==typeof tt?tt:"notifyWhenChangesStop"==tt?Y:X,Ne.tb((function(Ne){return rt(Ne,Qe,Ge)}))},deferred:function(Ne,Ge){if(!0!==Ge)throw Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.");Ne.Hb||(Ne.Hb=!0,Ne.tb((function(Ge){var Qe,tt=!1;return function(){if(!tt){Zt.ma.cancel(Qe),Qe=Zt.ma.yb(Ge);try{tt=!0,Ne.notifySubscribers(it,"dirty")}finally{tt=!1}}}})))},notify:function(Ne,Ge){Ne.equalityComparer="always"==Ge?null:K}};var er={undefined:1,boolean:1,number:1,string:1};Zt.b("extenders",Zt.Ta),Zt.gc=function(Ne,Ge,Qe){this.da=Ne,this.kc=Ge,this.lc=Qe,this.Ib=!1,this.ab=this.Jb=null,Zt.J(this,"dispose",this.s),Zt.J(this,"disposeWhenNodeIsRemoved",this.l)},Zt.gc.prototype.s=function(){this.Ib||(this.ab&&Zt.a.I.xb(this.Jb,this.ab),this.Ib=!0,this.lc(),this.da=this.kc=this.lc=this.Jb=this.ab=null)},Zt.gc.prototype.l=function(Ne){this.Jb=Ne,Zt.a.I.za(Ne,this.ab=this.s.bind(this))},Zt.R=function(){Zt.a.zb(this,dr),dr.ob(this)};var dr={ob:function(Ne){Ne.S={change:[]},Ne.rc=1},subscribe:function(Ne,Ge,Qe){var tt=this;Qe=Qe||"change";var rt=new Zt.gc(tt,Ge?Ne.bind(Ge):Ne,(function(){Zt.a.hb(tt.S[Qe],rt),tt.cb&&tt.cb(Qe)}));return tt.Qa&&tt.Qa(Qe),tt.S[Qe]||(tt.S[Qe]=[]),tt.S[Qe].push(rt),rt},notifySubscribers:function(Ne,Ge){if("change"===(Ge=Ge||"change")&&this.Gb(),this.Wa(Ge)){var Qe="change"===Ge&&this.dd||this.S[Ge].slice(0);try{Zt.v.wc();for(var tt,rt=0;tt=Qe[rt];++rt)tt.Ib||tt.kc(Ne)}finally{Zt.v.end()}}},mb:function(){return this.rc},Cd:function(Ne){return this.mb()!==Ne},Gb:function(){++this.rc},tb:function(Ne){var Ge,Qe,tt,rt,nt,at=this,it=Zt.N(at);at.bb||(at.bb=at.notifySubscribers,at.notifySubscribers=Z);var ot=Ne((function(){at.Ka=!1,it&&rt===at&&(rt=at.mc?at.mc():at());var Ne=Qe||nt&&at.qb(tt,rt);nt=Qe=Ge=!1,Ne&&at.bb(tt=rt)}));at.pc=function(Ne,Qe){Qe&&at.Ka||(nt=!Qe),at.dd=at.S.change.slice(0),at.Ka=Ge=!0,rt=Ne,ot()},at.oc=function(Ne){Ge||(tt=Ne,at.bb(Ne,"beforeChange"))},at.qc=function(){nt=!0},at.fd=function(){at.qb(tt,at.w(!0))&&(Qe=!0)}},Wa:function(Ne){return this.S[Ne]&&this.S[Ne].length},Ad:function(Ne){if(Ne)return this.S[Ne]&&this.S[Ne].length||0;var Ge=0;return Zt.a.O(this.S,(function(Ne,Qe){"dirty"!==Ne&&(Ge+=Qe.length)})),Ge},qb:function(Ne,Ge){return!this.equalityComparer||!this.equalityComparer(Ne,Ge)},toString:function(){return"[object Object]"},extend:function(Ne){var Ge=this;return Ne&&Zt.a.O(Ne,(function(Ne,Qe){var tt=Zt.Ta[Ne];"function"==typeof tt&&(Ge=tt(Ge,Qe)||Ge)})),Ge}};Zt.J(dr,"init",dr.ob),Zt.J(dr,"subscribe",dr.subscribe),Zt.J(dr,"extend",dr.extend),Zt.J(dr,"getSubscriptionsCount",dr.Ad),Zt.a.Ba&&Zt.a.setPrototypeOf(dr,Function.prototype),Zt.R.fn=dr,Zt.Pc=function(Ne){return null!=Ne&&"function"==typeof Ne.subscribe&&"function"==typeof Ne.notifySubscribers},Zt.b("subscribable",Zt.R),Zt.b("isSubscribable",Zt.Pc),Zt.U=Zt.v=function(){function b(Qe){Ge.push(Ne),Ne=Qe}function c(){Ne=Ge.pop()}var Ne,Ge=[],Qe=0;return{wc:b,end:c,ac:function(Ge){if(Ne){if(!Zt.Pc(Ge))throw Error("Only subscribable things can act as dependencies");Ne.nd.call(Ne.od,Ge,Ge.ed||(Ge.ed=++Qe))}},K:function(Ne,Ge,Qe){try{return b(),Ne.apply(Ge,Qe||[])}finally{c()}},pa:function(){if(Ne)return Ne.o.pa()},Va:function(){if(Ne)return Ne.o.Va()},rb:function(){if(Ne)return Ne.rb},o:function(){if(Ne)return Ne.o}}}(),Zt.b("computedContext",Zt.U),Zt.b("computedContext.getDependenciesCount",Zt.U.pa),Zt.b("computedContext.getDependencies",Zt.U.Va),Zt.b("computedContext.isInitial",Zt.U.rb),Zt.b("computedContext.registerDependency",Zt.U.ac),Zt.b("ignoreDependencies",Zt.Wd=Zt.v.K);var mr=Zt.a.Da("_latestValue");Zt.sa=function(Ne){function c(){return 0<arguments.length?(c.qb(c[mr],arguments[0])&&(c.xa(),c[mr]=arguments[0],c.wa()),this):(Zt.v.ac(c),c[mr])}return c[mr]=Ne,Zt.a.Ba||Zt.a.extend(c,Zt.R.fn),Zt.R.fn.ob(c),Zt.a.zb(c,xr),Zt.options.deferUpdates&&Zt.Ta.deferred(c,!0),c};var xr={equalityComparer:K,w:function(){return this[mr]},wa:function(){this.notifySubscribers(this[mr],"spectate"),this.notifySubscribers(this[mr])},xa:function(){this.notifySubscribers(this[mr],"beforeChange")}};Zt.a.Ba&&Zt.a.setPrototypeOf(xr,Zt.R.fn);var br=Zt.sa.Na="__ko_proto__";xr[br]=Zt.sa,Zt.N=function(Ne){if((Ne="function"==typeof Ne&&Ne[br])&&Ne!==xr[br]&&Ne!==Zt.o.fn[br])throw Error("Invalid object that looks like an observable; possibly from another Knockout instance");return!!Ne},Zt.Ya=function(Ne){return"function"==typeof Ne&&(Ne[br]===xr[br]||Ne[br]===Zt.o.fn[br]&&Ne.Mc)},Zt.b("observable",Zt.sa),Zt.b("isObservable",Zt.N),Zt.b("isWriteableObservable",Zt.Ya),Zt.b("isWritableObservable",Zt.Ya),Zt.b("observable.fn",xr),Zt.J(xr,"peek",xr.w),Zt.J(xr,"valueHasMutated",xr.wa),Zt.J(xr,"valueWillMutate",xr.xa),Zt.Ia=function(Ne){if("object"!=typeof(Ne=Ne||[])||!("length"in Ne))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.");return Ne=Zt.sa(Ne),Zt.a.zb(Ne,Zt.Ia.fn),Ne.extend({trackArrayChanges:!0})},Zt.Ia.fn={remove:function(Ne){for(var Ge=this.w(),Qe=[],tt="function"!=typeof Ne||Zt.N(Ne)?function(Ge){return Ge===Ne}:Ne,rt=0;rt<Ge.length;rt++){var nt=Ge[rt];if(tt(nt)){if(0===Qe.length&&this.xa(),Ge[rt]!==nt)throw Error("Array modified during remove; cannot remove item");Qe.push(nt),Ge.splice(rt,1),rt--}}return Qe.length&&this.wa(),Qe},removeAll:function(Ne){if(Ne===it){var Ge=this.w(),Qe=Ge.slice(0);return this.xa(),Ge.splice(0,Ge.length),this.wa(),Qe}return Ne?this.remove((function(Ge){return 0<=Zt.a.A(Ne,Ge)})):[]},destroy:function(Ne){var Ge=this.w(),Qe="function"!=typeof Ne||Zt.N(Ne)?function(Ge){return Ge===Ne}:Ne;this.xa();for(var tt=Ge.length-1;0<=tt;tt--){var rt=Ge[tt];Qe(rt)&&(rt._destroy=!0)}this.wa()},destroyAll:function(Ne){return Ne===it?this.destroy((function(){return!0})):Ne?this.destroy((function(Ge){return 0<=Zt.a.A(Ne,Ge)})):[]},indexOf:function(Ne){var Ge=this();return Zt.a.A(Ge,Ne)},replace:function(Ne,Ge){var Qe=this.indexOf(Ne);0<=Qe&&(this.xa(),this.w()[Qe]=Ge,this.wa())},sorted:function(Ne){var Ge=this().slice(0);return Ne?Ge.sort(Ne):Ge.sort()},reversed:function(){return this().slice(0).reverse()}},Zt.a.Ba&&Zt.a.setPrototypeOf(Zt.Ia.fn,Zt.sa.fn),Zt.a.C("pop push reverse shift sort splice unshift".split(" "),(function(Ne){Zt.Ia.fn[Ne]=function(){var Ge=this.w();this.xa(),this.yc(Ge,Ne,arguments);var Qe=Ge[Ne].apply(Ge,arguments);return this.wa(),Qe===Ge?this:Qe}})),Zt.a.C(["slice"],(function(Ne){Zt.Ia.fn[Ne]=function(){var Ge=this();return Ge[Ne].apply(Ge,arguments)}})),Zt.Oc=function(Ne){return Zt.N(Ne)&&"function"==typeof Ne.remove&&"function"==typeof Ne.push},Zt.b("observableArray",Zt.Ia),Zt.b("isObservableArray",Zt.Oc),Zt.Ta.trackArrayChanges=function(Ne,Ge){function d(){function c(){if(ot){var Ge,Qe=[].concat(Ne.w()||[]);Ne.Wa("arrayChange")&&((!at||1<ot)&&(at=Zt.a.Ob(tt,Qe,Ne.Nb)),Ge=at),tt=Qe,at=null,ot=0,Ge&&Ge.length&&Ne.notifySubscribers(Ge,"arrayChange")}}nt?c():(nt=!0,rt=Ne.notifySubscribers,Ne.notifySubscribers=function(Ne,Ge){return Ge&&"change"!==Ge||++ot,rt.apply(this,arguments)},tt=[].concat(Ne.w()||[]),at=null,Qe=Ne.subscribe(c))}if(Ne.Nb={},Ge&&"object"==typeof Ge&&Zt.a.extend(Ne.Nb,Ge),Ne.Nb.sparse=!0,!Ne.yc){var Qe,tt,rt,nt=!1,at=null,ot=0,dt=Ne.Qa,ht=Ne.cb;Ne.Qa=function(Ge){dt&&dt.call(Ne,Ge),"arrayChange"===Ge&&d()},Ne.cb=function(Ge){ht&&ht.call(Ne,Ge),"arrayChange"!==Ge||Ne.Wa("arrayChange")||(rt&&(Ne.notifySubscribers=rt,rt=it),Qe&&Qe.s(),Qe=null,nt=!1,tt=it)},Ne.yc=function(Ne,Ge,Qe){function k(Ne,Ge,Qe){return tt[tt.length]={status:Ne,value:Ge,index:Qe}}if(nt&&!ot){var tt=[],rt=Ne.length,it=Qe.length,dt=0;switch(Ge){case"push":dt=rt;case"unshift":for(Ge=0;Ge<it;Ge++)k("added",Qe[Ge],dt+Ge);break;case"pop":dt=rt-1;case"shift":rt&&k("deleted",Ne[dt],dt);break;case"splice":Ge=Math.min(Math.max(0,0>Qe[0]?rt+Qe[0]:Qe[0]),rt),rt=1===it?rt:Math.min(Ge+(Qe[1]||0),rt),it=Ge+it-2,dt=Math.max(rt,it);for(var ht=[],Dt=[],Ot=2;Ge<dt;++Ge,++Ot)Ge<rt&&Dt.push(k("deleted",Ne[Ge],Ge)),Ge<it&&ht.push(k("added",Qe[Ot],Ge));Zt.a.Jc(Dt,ht);break;default:return}at=tt}}}};var Ar=Zt.a.Da("_state");Zt.o=Zt.$=function(Ne,Ge,Qe){function e(){if(0<arguments.length){if("function"!=typeof tt)throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.");return tt.apply(rt.lb,arguments),this}return rt.qa||Zt.v.ac(e),(rt.ka||rt.G&&e.Xa())&&e.ha(),rt.X}if("object"==typeof Ne?Qe=Ne:(Qe=Qe||{},Ne&&(Qe.read=Ne)),"function"!=typeof Qe.read)throw Error("Pass a function that returns the value of the ko.computed");var tt=Qe.write,rt={X:it,ra:!0,ka:!0,pb:!1,hc:!1,qa:!1,vb:!1,G:!1,Vc:Qe.read,lb:Ge||Qe.owner,l:Qe.disposeWhenNodeIsRemoved||Qe.l||null,Sa:Qe.disposeWhen||Qe.Sa,Qb:null,F:{},V:0,Hc:null};return e[Ar]=rt,e.Mc="function"==typeof tt,Zt.a.Ba||Zt.a.extend(e,Zt.R.fn),Zt.R.fn.ob(e),Zt.a.zb(e,en),Qe.pure?(rt.vb=!0,rt.G=!0,Zt.a.extend(e,mn)):Qe.deferEvaluation&&Zt.a.extend(e,xn),Zt.options.deferUpdates&&Zt.Ta.deferred(e,!0),rt.l&&(rt.hc=!0,rt.l.nodeType||(rt.l=null)),rt.G||Qe.deferEvaluation||e.ha(),rt.l&&e.ja()&&Zt.a.I.za(rt.l,rt.Qb=function(){e.s()}),e};var en={equalityComparer:K,pa:function(){return this[Ar].V},Va:function(){var Ne=[];return Zt.a.O(this[Ar].F,(function(Ge,Qe){Ne[Qe.La]=Qe.da})),Ne},Ub:function(Ne){if(!this[Ar].V)return!1;var Ge=this.Va();return-1!==Zt.a.A(Ge,Ne)||!!Zt.a.Lb(Ge,(function(Ge){return Ge.Ub&&Ge.Ub(Ne)}))},tc:function(Ne,Ge,Qe){if(this[Ar].vb&&Ge===this)throw Error("A 'pure' computed must not be called recursively");this[Ar].F[Ne]=Qe,Qe.La=this[Ar].V++,Qe.Ma=Ge.mb()},Xa:function(){var Ne,Ge,Qe=this[Ar].F;for(Ne in Qe)if(Object.prototype.hasOwnProperty.call(Qe,Ne)&&(Ge=Qe[Ne],this.Ja&&Ge.da.Ka||Ge.da.Cd(Ge.Ma)))return!0},Id:function(){this.Ja&&!this[Ar].pb&&this.Ja(!1)},ja:function(){var Ne=this[Ar];return Ne.ka||0<Ne.V},Qd:function(){this.Ka?this[Ar].ka&&(this[Ar].ra=!0):this.Gc()},Zc:function(Ne){if(Ne.Hb){var Ge=Ne.subscribe(this.Id,this,"dirty"),Qe=Ne.subscribe(this.Qd,this);return{da:Ne,s:function(){Ge.s(),Qe.s()}}}return Ne.subscribe(this.Gc,this)},Gc:function(){var Ne=this,Ge=Ne.throttleEvaluation;Ge&&0<=Ge?(clearTimeout(this[Ar].Hc),this[Ar].Hc=Zt.a.setTimeout((function(){Ne.ha(!0)}),Ge)):Ne.Ja?Ne.Ja(!0):Ne.ha(!0)},ha:function(Ne){var Ge=this[Ar],Qe=Ge.Sa,tt=!1;if(!Ge.pb&&!Ge.qa){if(Ge.l&&!Zt.a.Rb(Ge.l)||Qe&&Qe()){if(!Ge.hc)return void this.s()}else Ge.hc=!1;Ge.pb=!0;try{tt=this.yd(Ne)}finally{Ge.pb=!1}return tt}},yd:function(Ne){var Ge=this[Ar],Qe=!1,tt=Ge.vb?it:!Ge.V;Qe={pd:this,kb:Ge.F,Pb:Ge.V},Zt.v.wc({od:Qe,nd:ba,o:this,rb:tt}),Ge.F={},Ge.V=0;var rt=this.xd(Ge,Qe);return Ge.V?Qe=this.qb(Ge.X,rt):(this.s(),Qe=!0),Qe&&(Ge.G?this.Gb():this.notifySubscribers(Ge.X,"beforeChange"),Ge.X=rt,this.notifySubscribers(Ge.X,"spectate"),!Ge.G&&Ne&&this.notifySubscribers(Ge.X),this.qc&&this.qc()),tt&&this.notifySubscribers(Ge.X,"awake"),Qe},xd:function(Ne,Ge){try{var Qe=Ne.Vc;return Ne.lb?Qe.call(Ne.lb):Qe()}finally{Zt.v.end(),Ge.Pb&&!Ne.G&&Zt.a.O(Ge.kb,aa),Ne.ra=Ne.ka=!1}},w:function(Ne){var Ge=this[Ar];return(Ge.ka&&(Ne||!Ge.V)||Ge.G&&this.Xa())&&this.ha(),Ge.X},tb:function(Ne){Zt.R.fn.tb.call(this,Ne),this.mc=function(){return this[Ar].G||(this[Ar].ra?this.ha():this[Ar].ka=!1),this[Ar].X},this.Ja=function(Ne){this.oc(this[Ar].X),this[Ar].ka=!0,Ne&&(this[Ar].ra=!0),this.pc(this,!Ne)}},s:function(){var Ne=this[Ar];!Ne.G&&Ne.F&&Zt.a.O(Ne.F,(function(Ne,Ge){Ge.s&&Ge.s()})),Ne.l&&Ne.Qb&&Zt.a.I.xb(Ne.l,Ne.Qb),Ne.F=it,Ne.V=0,Ne.qa=!0,Ne.ra=!1,Ne.ka=!1,Ne.G=!1,Ne.l=it,Ne.Sa=it,Ne.Vc=it,this.Mc||(Ne.lb=it)}},mn={Qa:function(Ne){var Ge=this,Qe=Ge[Ar];if(!Qe.qa&&Qe.G&&"change"==Ne){if(Qe.G=!1,Qe.ra||Ge.Xa())Qe.F=null,Qe.V=0,Ge.ha()&&Ge.Gb();else{var tt=[];Zt.a.O(Qe.F,(function(Ne,Ge){tt[Ge.La]=Ne})),Zt.a.C(tt,(function(Ne,tt){var rt=Qe.F[Ne],nt=Ge.Zc(rt.da);nt.La=tt,nt.Ma=rt.Ma,Qe.F[Ne]=nt})),Ge.Xa()&&Ge.ha()&&Ge.Gb()}Qe.qa||Ge.notifySubscribers(Qe.X,"awake")}},cb:function(Ne){var Ge=this[Ar];Ge.qa||"change"!=Ne||this.Wa("change")||(Zt.a.O(Ge.F,(function(Ne,Qe){Qe.s&&(Ge.F[Ne]={da:Qe.da,La:Qe.La,Ma:Qe.Ma},Qe.s())})),Ge.G=!0,this.notifySubscribers(it,"asleep"))},mb:function(){var Ne=this[Ar];return Ne.G&&(Ne.ra||this.Xa())&&this.ha(),Zt.R.fn.mb.call(this)}},xn={Qa:function(Ne){"change"!=Ne&&"beforeChange"!=Ne||this.w()}};Zt.a.Ba&&Zt.a.setPrototypeOf(en,Zt.R.fn);var kn=Zt.sa.Na;en[kn]=Zt.o,Zt.Nc=function(Ne){return"function"==typeof Ne&&Ne[kn]===en[kn]},Zt.Ed=function(Ne){return Zt.Nc(Ne)&&Ne[Ar]&&Ne[Ar].vb},Zt.b("computed",Zt.o),Zt.b("dependentObservable",Zt.o),Zt.b("isComputed",Zt.Nc),Zt.b("isPureComputed",Zt.Ed),Zt.b("computed.fn",en),Zt.J(en,"peek",en.w),Zt.J(en,"dispose",en.s),Zt.J(en,"isActive",en.ja),Zt.J(en,"getDependenciesCount",en.pa),Zt.J(en,"getDependencies",en.Va),Zt.wb=function(Ne,Ge){return"function"==typeof Ne?Zt.o(Ne,Ge,{pure:!0}):((Ne=Zt.a.extend({},Ne)).pure=!0,Zt.o(Ne,Ge))},Zt.b("pureComputed",Zt.wb),function(){function b(Ne,Ge,Qe){if(Qe=Qe||new d,"object"!=typeof(Ne=Ge(Ne))||null===Ne||Ne===it||Ne instanceof RegExp||Ne instanceof Date||Ne instanceof String||Ne instanceof Number||Ne instanceof Boolean)return Ne;var tt=Ne instanceof Array?[]:{};return Qe.save(Ne,tt),function(Ne,Ge){if(Ne instanceof Array){for(var Qe=0;Qe<Ne.length;Qe++)Ge(Qe);"function"==typeof Ne.toJSON&&Ge("toJSON")}else for(Qe in Ne)Ge(Qe)}(Ne,(function(rt){var nt=Ge(Ne[rt]);switch(typeof nt){case"boolean":case"number":case"string":case"function":tt[rt]=nt;break;case"object":case"undefined":var at=Qe.get(nt);tt[rt]=at!==it?at:b(nt,Ge,Qe)}})),tt}function d(){this.keys=[],this.values=[]}Zt.$c=function(Ne){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.");return b(Ne,(function(Ne){for(var Ge=0;Zt.N(Ne)&&10>Ge;Ge++)Ne=Ne();return Ne}))},Zt.toJSON=function(Ne,Ge,Qe){return Ne=Zt.$c(Ne),Zt.a.fc(Ne,Ge,Qe)},d.prototype={constructor:d,save:function(Ne,Ge){var Qe=Zt.a.A(this.keys,Ne);0<=Qe?this.values[Qe]=Ge:(this.keys.push(Ne),this.values.push(Ge))},get:function(Ne){return 0<=(Ne=Zt.a.A(this.keys,Ne))?this.values[Ne]:it}}}(),Zt.b("toJS",Zt.$c),Zt.b("toJSON",Zt.toJSON),Zt.Vd=function(Ne,Ge,Qe){function e(Ge){var tt=Zt.wb(Ne,Qe).extend({Ga:"always"}),rt=tt.subscribe((function(Ne){Ne&&(rt.s(),Ge(Ne))}));return tt.notifySubscribers(tt.w()),rt}return"function"!=typeof Promise||Ge?e(Ge.bind(Qe)):new Promise(e)},Zt.b("when",Zt.Vd),Zt.u={L:function(Ne){switch(Zt.a.P(Ne)){case"option":return!0===Ne.__ko__hasDomDataOptionValue__?Zt.a.g.get(Ne,Zt.f.options.Yb):7>=Zt.a.W?Ne.getAttributeNode("value")&&Ne.getAttributeNode("value").specified?Ne.value:Ne.text:Ne.value;case"select":return 0<=Ne.selectedIndex?Zt.u.L(Ne.options[Ne.selectedIndex]):it;default:return Ne.value}},ya:function(Ne,Ge,Qe){switch(Zt.a.P(Ne)){case"option":"string"==typeof Ge?(Zt.a.g.set(Ne,Zt.f.options.Yb,it),"__ko__hasDomDataOptionValue__"in Ne&&delete Ne.__ko__hasDomDataOptionValue__,Ne.value=Ge):(Zt.a.g.set(Ne,Zt.f.options.Yb,Ge),Ne.__ko__hasDomDataOptionValue__=!0,Ne.value="number"==typeof Ge?Ge:"");break;case"select":""!==Ge&&null!==Ge||(Ge=it);for(var tt,rt=-1,nt=0,at=Ne.options.length;nt<at;++nt)if((tt=Zt.u.L(Ne.options[nt]))==Ge||""===tt&&Ge===it){rt=nt;break}(Qe||0<=rt||Ge===it&&1<Ne.size)&&(Ne.selectedIndex=rt,6===Zt.a.W&&Zt.a.setTimeout((function(){Ne.selectedIndex=rt}),0));break;default:null!==Ge&&Ge!==it||(Ge=""),Ne.value=Ge}}},Zt.b("selectExtensions",Zt.u),Zt.b("selectExtensions.readValue",Zt.u.L),Zt.b("selectExtensions.writeValue",Zt.u.ya),Zt.m=function(){function b(Ne){123===(Ne=Zt.a.Cb(Ne)).charCodeAt(0)&&(Ne=Ne.slice(1,-1));var Ge,nt=[],at=(Ne+="\n,").match(Qe),it=[],ot=0;if(1<at.length){for(var dt,ht=0;dt=at[ht];++ht){var Dt=dt.charCodeAt(0);if(44===Dt){if(0>=ot){nt.push(Ge&&it.length?{key:Ge,value:it.join("")}:{unknown:Ge||it.join("")}),Ge=ot=0,it=[];continue}}else if(58===Dt){if(!ot&&!Ge&&1===it.length){Ge=it.pop();continue}}else{if(47===Dt&&1<dt.length&&(47===dt.charCodeAt(1)||42===dt.charCodeAt(1)))continue;47===Dt&&ht&&1<dt.length?(Dt=at[ht-1].match(tt))&&!rt[Dt[0]]&&(at=(Ne=Ne.substr(Ne.indexOf(dt)+1)).match(Qe),ht=-1,dt="/"):40===Dt||123===Dt||91===Dt?++ot:41===Dt||125===Dt||93===Dt?--ot:Ge||it.length||34!==Dt&&39!==Dt||(dt=dt.slice(1,-1))}it.push(dt)}if(0<ot)throw Error("Unbalanced parentheses, braces, or brackets")}return nt}var Ne=["true","false","null","undefined"],Ge=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,Qe=RegExp("\"(?:\\\\.|[^\"])*\"|'(?:\\\\.|[^'])*'|`(?:\\\\.|[^`])*`|/\\*(?:[^*]|\\*+[^*/])*\\*+/|//.*\n|/(?:\\\\.|[^/])+/w*|[^\\s:,/][^,\"'`{}()/:[\\]]*[^\\s,\"'`{}()/:[\\]]|[^\\s]","g"),tt=/[\])"'A-Za-z0-9_$]+$/,rt={in:1,return:1,typeof:1},nt={};return{Ra:[],va:nt,Zb:b,ub:function(Qe,tt){function k(Qe,tt){var dt;if(!ot){var ht=Zt.getBindingHandler(Qe);if(ht&&ht.preprocess&&!(tt=ht.preprocess(tt,Qe,k)))return;(ht=nt[Qe])&&(dt=tt,0<=Zt.a.A(Ne,dt)?dt=!1:(ht=dt.match(Ge),dt=null!==ht&&(ht[1]?"Object("+ht[1]+")"+ht[2]:dt)),ht=dt),ht&&at.push("'"+("string"==typeof nt[Qe]?nt[Qe]:Qe)+"':function(_z){"+dt+"=_z}")}it&&(tt="function(){return "+tt+" }"),rt.push("'"+Qe+"':"+tt)}var rt=[],at=[],it=(tt=tt||{}).valueAccessors,ot=tt.bindingParams,dt="string"==typeof Qe?b(Qe):Qe;return Zt.a.C(dt,(function(Ne){k(Ne.key||Ne.unknown,Ne.value)})),at.length&&k("_ko_property_writers","{"+at.join(",")+" }"),rt.join(",")},Hd:function(Ne,Ge){for(var Qe=0;Qe<Ne.length;Qe++)if(Ne[Qe].key==Ge)return!0;return!1},$a:function(Ne,Ge,Qe,tt,rt){Ne&&Zt.N(Ne)?!Zt.Ya(Ne)||rt&&Ne.w()===tt||Ne(tt):(Ne=Ge.get("_ko_property_writers"))&&Ne[Qe]&&Ne[Qe](tt)}}}(),Zt.b("expressionRewriting",Zt.m),Zt.b("expressionRewriting.bindingRewriteValidators",Zt.m.Ra),Zt.b("expressionRewriting.parseObjectLiteral",Zt.m.Zb),Zt.b("expressionRewriting.preProcessBindings",Zt.m.ub),Zt.b("expressionRewriting._twoWayBindings",Zt.m.va),Zt.b("jsonExpressionRewriting",Zt.m),Zt.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",Zt.m.ub),function(){function b(Qe){return 8==Qe.nodeType&&Ge.test(Ne?Qe.text:Qe.nodeValue)}function c(Ge){return 8==Ge.nodeType&&Qe.test(Ne?Ge.text:Ge.nodeValue)}function d(Ne,Ge){for(var Qe=Ne,tt=1,nt=[];Qe=Qe.nextSibling;){if(c(Qe)&&(Zt.a.g.set(Qe,rt,!0),0==--tt))return nt;nt.push(Qe),b(Qe)&&tt++}if(!Ge)throw Error("Cannot find closing comment tag to match: "+Ne.nodeValue);return null}function e(Ne,Ge){var Qe=d(Ne,Ge);return Qe?0<Qe.length?Qe[Qe.length-1].nextSibling:Ne.nextSibling:null}var Ne=dt&&"\x3c!--test--\x3e"===dt.createComment("test").text,Ge=Ne?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,Qe=Ne?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,tt={ul:!0,ol:!0},rt="__ko_matchedEndComment__";Zt.h={ea:{},childNodes:function(Ne){return b(Ne)?d(Ne):Ne.childNodes},Ea:function(Ne){if(b(Ne))for(var Ge=0,Qe=(Ne=Zt.h.childNodes(Ne)).length;Ge<Qe;Ge++)Zt.removeNode(Ne[Ge]);else Zt.a.Sb(Ne)},ua:function(Ne,Ge){if(b(Ne)){Zt.h.Ea(Ne);for(var Qe=Ne.nextSibling,tt=0,rt=Ge.length;tt<rt;tt++)Qe.parentNode.insertBefore(Ge[tt],Qe)}else Zt.a.ua(Ne,Ge)},Uc:function(Ne,Ge){b(Ne)?Ne.parentNode.insertBefore(Ge,Ne.nextSibling):Ne.firstChild?Ne.insertBefore(Ge,Ne.firstChild):Ne.appendChild(Ge)},Vb:function(Ne,Ge,Qe){Qe?b(Ne)?Ne.parentNode.insertBefore(Ge,Qe.nextSibling):Qe.nextSibling?Ne.insertBefore(Ge,Qe.nextSibling):Ne.appendChild(Ge):Zt.h.Uc(Ne,Ge)},firstChild:function(Ne){if(b(Ne))return!Ne.nextSibling||c(Ne.nextSibling)?null:Ne.nextSibling;if(Ne.firstChild&&c(Ne.firstChild))throw Error("Found invalid end comment, as the first child of "+Ne);return Ne.firstChild},nextSibling:function(Ne){if(b(Ne)&&(Ne=e(Ne)),Ne.nextSibling&&c(Ne.nextSibling)){var Ge=Ne.nextSibling;if(c(Ge)&&!Zt.a.g.get(Ge,rt))throw Error("Found end comment without a matching opening comment, as child of "+Ne);return null}return Ne.nextSibling},Bd:b,Ud:function(Qe){return(Qe=(Ne?Qe.text:Qe.nodeValue).match(Ge))?Qe[1]:null},Rc:function(Ne){if(tt[Zt.a.P(Ne)]){var Ge=Ne.firstChild;if(Ge)do{if(1===Ge.nodeType){var Qe,rt=null;if(Qe=Ge.firstChild)do{if(rt)rt.push(Qe);else if(b(Qe)){var nt=e(Qe,!0);nt?Qe=nt:rt=[Qe]}else c(Qe)&&(rt=[Qe])}while(Qe=Qe.nextSibling);if(Qe=rt)for(rt=Ge.nextSibling,nt=0;nt<Qe.length;nt++)rt?Ne.insertBefore(Qe[nt],rt):Ne.appendChild(Qe[nt])}}while(Ge=Ge.nextSibling)}}}}(),Zt.b("virtualElements",Zt.h),Zt.b("virtualElements.allowedBindings",Zt.h.ea),Zt.b("virtualElements.emptyNode",Zt.h.Ea),Zt.b("virtualElements.insertAfter",Zt.h.Vb),Zt.b("virtualElements.prepend",Zt.h.Uc),Zt.b("virtualElements.setDomNodeChildren",Zt.h.ua),Zt.ga=function(){this.md={}},Zt.a.extend(Zt.ga.prototype,{nodeHasBindings:function(Ne){switch(Ne.nodeType){case 1:return null!=Ne.getAttribute("data-bind")||Zt.i.getComponentNameForNode(Ne);case 8:return Zt.h.Bd(Ne);default:return!1}},getBindings:function(Ne,Ge){var Qe=(Qe=this.getBindingsString(Ne,Ge))?this.parseBindingsString(Qe,Ge,Ne):null;return Zt.i.sc(Qe,Ne,Ge,!1)},getBindingAccessors:function(Ne,Ge){var Qe=(Qe=this.getBindingsString(Ne,Ge))?this.parseBindingsString(Qe,Ge,Ne,{valueAccessors:!0}):null;return Zt.i.sc(Qe,Ne,Ge,!0)},getBindingsString:function(Ne){switch(Ne.nodeType){case 1:return Ne.getAttribute("data-bind");case 8:return Zt.h.Ud(Ne);default:return null}},parseBindingsString:function(Ne,Ge,Qe,tt){try{var rt,nt=this.md,at=Ne+(tt&&tt.valueAccessors||"");if(!(rt=nt[at])){var it,ot="with($context){with($data||{}){return{"+Zt.m.ub(Ne,tt)+"}}}";it=new Function("$context","$element",ot),rt=nt[at]=it}return rt(Ge,Qe)}catch(Ge){throw Ge.message="Unable to parse bindings.\nBindings value: "+Ne+"\nMessage: "+Ge.message,Ge}}}),Zt.ga.instance=new Zt.ga,Zt.b("bindingProvider",Zt.ga),function(){function b(Ne){var Ge=(Ne=Zt.a.g.get(Ne,nt))&&Ne.M;Ge&&(Ne.M=null,Ge.Sc())}function c(Ne,Ge,Qe){this.node=Ne,this.xc=Ge,this.ib=[],this.T=!1,Ge.M||Zt.a.I.za(Ne,b),Qe&&Qe.M&&(Qe.M.ib.push(Ne),this.Kb=Qe)}function d(Ne){return function(){return Ne}}function e(Ne){return Ne()}function f(Ne){return Zt.a.Ha(Zt.v.K(Ne),(function(Ge,Qe){return function(){return Ne()[Qe]}}))}function g(Ne,Ge,Qe){return"function"==typeof Ne?f(Ne.bind(null,Ge,Qe)):Zt.a.Ha(Ne,d)}function h(Ne,Ge){return f(this.getBindings.bind(this,Ne,Ge))}function m(Ne,Ge){var Qe=Zt.h.firstChild(Ge);if(Qe){var tt,rt=Zt.ga.instance,nt=rt.preprocessNode;if(nt){for(;tt=Qe;)Qe=Zt.h.nextSibling(tt),nt.call(rt,tt);Qe=Zt.h.firstChild(Ge)}for(;tt=Qe;)Qe=Zt.h.nextSibling(tt),l(Ne,tt)}Zt.j.Ga(Ge,Zt.j.T)}function l(Ne,Ge){var Qe=Ne,rt=1===Ge.nodeType;rt&&Zt.h.Rc(Ge),(rt||Zt.ga.instance.nodeHasBindings(Ge))&&(Qe=q(Ge,null,Ne).bindingContextForDescendants),Qe&&!tt[Zt.a.P(Ge)]&&m(Qe,Ge)}function q(Ge,tt,rt){var at,ot=Zt.a.g.Tb(Ge,nt,{}),dt=ot.gd;if(!tt){if(dt)throw Error("You cannot apply bindings multiple times to the same element.");ot.gd=!0}if(dt||(ot.context=rt),tt&&"function"!=typeof tt)at=tt;else{var ht=Zt.ga.instance,Dt=ht.getBindingAccessors||h,Ot=Zt.$((function(){return(at=tt?tt(rt,Ge):Dt.call(ht,Ge,rt))&&(rt[Ne]&&rt[Ne](),rt[Qe]&&rt[Qe]()),at}),null,{l:Ge});at&&Ot.ja()||(Ot=null)}var Rt,er=rt;if(at){var J=function(){return Zt.a.Ha(Ot?Ot():at,e)},dr=Ot?function(Ne){return function(){return e(Ot()[Ne])}}:function(Ne){return at[Ne]};J.get=function(Ne){return at[Ne]&&e(dr(Ne))},J.has=function(Ne){return Ne in at},Zt.j.T in at&&Zt.j.subscribe(Ge,Zt.j.T,(function(){var Ne=(0,at[Zt.j.T])();if(Ne){var Qe=Zt.h.childNodes(Ge);Qe.length&&Ne(Qe,Zt.Dc(Qe[0]))}})),Zt.j.oa in at&&(er=Zt.j.Bb(Ge,rt),Zt.j.subscribe(Ge,Zt.j.oa,(function(){var Ne=(0,at[Zt.j.oa])();Ne&&Zt.h.firstChild(Ge)&&Ne(Ge)}))),ot=function(Ne){var Ge=[],Qe={},tt=[];return Zt.a.O(Ne,(function ca(rt){if(!Qe[rt]){var nt=Zt.getBindingHandler(rt);nt&&(nt.after&&(tt.push(rt),Zt.a.C(nt.after,(function(Ge){if(Ne[Ge]){if(-1!==Zt.a.A(tt,Ge))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+tt.join(", "));ca(Ge)}})),tt.length--),Ge.push({key:rt,Lc:nt})),Qe[rt]=!0}})),Ge}(at),Zt.a.C(ot,(function(Ne){var Qe=Ne.Lc.init,tt=Ne.Lc.update,rt=Ne.key;if(8===Ge.nodeType&&!Zt.h.ea[rt])throw Error("The binding '"+rt+"' cannot be used with virtual elements");try{"function"==typeof Qe&&Zt.v.K((function(){var Ne=Qe(Ge,dr(rt),J,er.$data,er);if(Ne&&Ne.controlsDescendantBindings){if(Rt!==it)throw Error("Multiple bindings ("+Rt+" and "+rt+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.");Rt=rt}})),"function"==typeof tt&&Zt.$((function(){tt(Ge,dr(rt),J,er.$data,er)}),null,{l:Ge})}catch(Ne){throw Ne.message='Unable to process binding "'+rt+": "+at[rt]+'"\nMessage: '+Ne.message,Ne}}))}return{shouldBindDescendants:ot=Rt===it,bindingContextForDescendants:ot&&er}}function n(Ne,Ge){return Ne&&Ne instanceof Zt.fa?Ne:new Zt.fa(Ne,it,it,Ge)}var Ne=Zt.a.Da("_subscribable"),Ge=Zt.a.Da("_ancestorBindingInfo"),Qe=Zt.a.Da("_dataDependency");Zt.f={};var tt={script:!0,textarea:!0,template:!0};Zt.getBindingHandler=function(Ne){return Zt.f[Ne]};var rt={};Zt.fa=function(tt,nt,at,ot,dt){function l(){var tt=er?Rt():Rt,rt=Zt.a.c(tt);return nt?(Zt.a.extend(Dt,nt),Ge in nt&&(Dt[Ge]=nt[Ge])):(Dt.$parents=[],Dt.$root=rt,Dt.ko=Zt),Dt[Ne]=ht,Ot?rt=Dt.$data:(Dt.$rawData=tt,Dt.$data=rt),at&&(Dt[at]=rt),ot&&ot(Dt,nt,rt),nt&&nt[Ne]&&!Zt.U.o().Ub(nt[Ne])&&nt[Ne](),dr&&(Dt[Qe]=dr),Dt.$data}var ht,Dt=this,Ot=tt===rt,Rt=Ot?it:tt,er="function"==typeof Rt&&!Zt.N(Rt),dr=dt&&dt.dataDependency;dt&&dt.exportDependencies?l():((ht=Zt.wb(l)).w(),ht.ja()?ht.equalityComparer=null:Dt[Ne]=it)},Zt.fa.prototype.createChildContext=function(Ne,Ge,Qe,tt){if(!tt&&Ge&&"object"==typeof Ge&&(Ge=(tt=Ge).as,Qe=tt.extend),Ge&&tt&&tt.noChildContext){var nt="function"==typeof Ne&&!Zt.N(Ne);return new Zt.fa(rt,this,null,(function(tt){Qe&&Qe(tt),tt[Ge]=nt?Ne():Ne}),tt)}return new Zt.fa(Ne,this,Ge,(function(Ne,Ge){Ne.$parentContext=Ge,Ne.$parent=Ge.$data,Ne.$parents=(Ge.$parents||[]).slice(0),Ne.$parents.unshift(Ne.$parent),Qe&&Qe(Ne)}),tt)},Zt.fa.prototype.extend=function(Ne,Ge){return new Zt.fa(rt,this,null,(function(Ge){Zt.a.extend(Ge,"function"==typeof Ne?Ne(Ge):Ne)}),Ge)};var nt=Zt.a.g.Z();c.prototype.Sc=function(){this.Kb&&this.Kb.M&&this.Kb.M.rd(this.node)},c.prototype.rd=function(Ne){Zt.a.hb(this.ib,Ne),!this.ib.length&&this.T&&this.Bc()},c.prototype.Bc=function(){this.T=!0,this.xc.M&&!this.ib.length&&(this.xc.M=null,Zt.a.I.xb(this.node,b),Zt.j.Ga(this.node,Zt.j.oa),this.Sc())},Zt.j={T:"childrenComplete",oa:"descendantsComplete",subscribe:function(Ne,Ge,Qe,tt){return(Ne=Zt.a.g.Tb(Ne,nt,{})).Fa||(Ne.Fa=new Zt.R),Ne.Fa.subscribe(Qe,tt,Ge)},Ga:function(Ne,Ge){var Qe=Zt.a.g.get(Ne,nt);if(Qe&&(Qe.Fa&&Qe.Fa.notifySubscribers(Ne,Ge),Ge==Zt.j.T))if(Qe.M)Qe.M.Bc();else if(Qe.M===it&&Qe.Fa&&Qe.Fa.Wa(Zt.j.oa))throw Error("descendantsComplete event not supported for bindings on this node")},Bb:function(Ne,Qe){var tt=Zt.a.g.Tb(Ne,nt,{});return tt.M||(tt.M=new c(Ne,tt,Qe[Ge])),Qe[Ge]==tt?Qe:Qe.extend((function(Ne){Ne[Ge]=tt}))}},Zt.Sd=function(Ne){return(Ne=Zt.a.g.get(Ne,nt))&&Ne.context},Zt.eb=function(Ne,Ge,Qe){return 1===Ne.nodeType&&Zt.h.Rc(Ne),q(Ne,Ge,n(Qe))},Zt.kd=function(Ne,Ge,Qe){return Qe=n(Qe),Zt.eb(Ne,g(Ge,Qe,Ne),Qe)},Zt.Pa=function(Ne,Ge){1!==Ge.nodeType&&8!==Ge.nodeType||m(n(Ne),Ge)},Zt.uc=function(Ne,Ge,Qe){if(!Dt&&ot.jQuery&&(Dt=ot.jQuery),2>arguments.length){if(!(Ge=dt.body))throw Error("ko.applyBindings: could not find document.body; has the document been loaded?")}else if(!Ge||1!==Ge.nodeType&&8!==Ge.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node");l(n(Ne,Qe),Ge)},Zt.Cc=function(Ne){return!Ne||1!==Ne.nodeType&&8!==Ne.nodeType?it:Zt.Sd(Ne)},Zt.Dc=function(Ne){return(Ne=Zt.Cc(Ne))?Ne.$data:it},Zt.b("bindingHandlers",Zt.f),Zt.b("bindingEvent",Zt.j),Zt.b("bindingEvent.subscribe",Zt.j.subscribe),Zt.b("bindingEvent.startPossiblyAsyncContentBinding",Zt.j.Bb),Zt.b("applyBindings",Zt.uc),Zt.b("applyBindingsToDescendants",Zt.Pa),Zt.b("applyBindingAccessorsToNode",Zt.eb),Zt.b("applyBindingsToNode",Zt.kd),Zt.b("contextFor",Zt.Cc),Zt.b("dataFor",Zt.Dc)}(),function(Ne){function c(tt,rt){var nt,at=Object.prototype.hasOwnProperty.call(Ge,tt)?Ge[tt]:Ne;at?at.subscribe(rt):((at=Ge[tt]=new Zt.R).subscribe(rt),d(tt,(function(Ne,rt){var it=!(!rt||!rt.synchronous);Qe[tt]={definition:Ne,Fd:it},delete Ge[tt],nt||it?at.notifySubscribers(Ne):Zt.ma.yb((function(){at.notifySubscribers(Ne)}))})),nt=!0)}function d(Ne,Ge){e("getConfig",[Ne],(function(Qe){Qe?e("loadComponent",[Ne,Qe],(function(Ne){Ge(Ne,Qe)})):Ge(null,null)}))}function e(Ge,Qe,tt,rt){rt||(rt=Zt.i.loaders.slice(0));var nt=rt.shift();if(nt){var at=nt[Ge];if(at){var it=!1;if(at.apply(nt,Qe.concat((function(Ne){it?tt(null):null!==Ne?tt(Ne):e(Ge,Qe,tt,rt)})))!==Ne&&(it=!0,!nt.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else e(Ge,Qe,tt,rt)}else tt(null)}var Ge={},Qe={};Zt.i={get:function(Ge,tt){var rt=Object.prototype.hasOwnProperty.call(Qe,Ge)?Qe[Ge]:Ne;rt?rt.Fd?Zt.v.K((function(){tt(rt.definition)})):Zt.ma.yb((function(){tt(rt.definition)})):c(Ge,tt)},Ac:function(Ne){delete Qe[Ne]},nc:e},Zt.i.loaders=[],Zt.b("components",Zt.i),Zt.b("components.get",Zt.i.get),Zt.b("components.clearCachedDefinition",Zt.i.Ac)}(),function(){function b(Ne,Ge,tt,rt){function g(){0==--at&&rt(nt)}var nt={},at=2,it=tt.template;tt=tt.viewModel,it?f(Ge,it,(function(Ge){Zt.i.nc("loadTemplate",[Ne,Ge],(function(Ne){nt.template=Ne,g()}))})):g(),tt?f(Ge,tt,(function(Ge){Zt.i.nc("loadViewModel",[Ne,Ge],(function(Ne){nt[Qe]=Ne,g()}))})):g()}function c(Ne,Ge,tt){if("function"==typeof Ge)tt((function(Ne){return new Ge(Ne)}));else if("function"==typeof Ge[Qe])tt(Ge[Qe]);else if("instance"in Ge){var rt=Ge.instance;tt((function(){return rt}))}else"viewModel"in Ge?c(Ne,Ge.viewModel,tt):Ne("Unknown viewModel value: "+Ge)}function d(Ne){switch(Zt.a.P(Ne)){case"script":return Zt.a.ta(Ne.text);case"textarea":return Zt.a.ta(Ne.value);case"template":if(e(Ne.content))return Zt.a.Ca(Ne.content.childNodes)}return Zt.a.Ca(Ne.childNodes)}function e(Ne){return ot.DocumentFragment?Ne instanceof DocumentFragment:Ne&&11===Ne.nodeType}function f(Ne,Qe,tt){"string"==typeof Qe.require?Ge||ot.require?(Ge||ot.require)([Qe.require],tt):Ne("Uses require, but no AMD loader is present"):tt(Qe)}function g(Ne){return function(Ge){throw Error("Component '"+Ne+"': "+Ge)}}var Ne={};Zt.i.register=function(Ge,Qe){if(!Qe)throw Error("Invalid configuration for "+Ge);if(Zt.i.sb(Ge))throw Error("Component "+Ge+" is already registered");Ne[Ge]=Qe},Zt.i.sb=function(Ge){return Object.prototype.hasOwnProperty.call(Ne,Ge)},Zt.i.unregister=function(Ge){delete Ne[Ge],Zt.i.Ac(Ge)},Zt.i.Ec={getConfig:function(Ge,Qe){Qe(Zt.i.sb(Ge)?Ne[Ge]:null)},loadComponent:function(Ne,Ge,Qe){var tt=g(Ne);f(tt,Ge,(function(Ge){b(Ne,tt,Ge,Qe)}))},loadTemplate:function(Ne,Ge,Qe){if(Ne=g(Ne),"string"==typeof Ge)Qe(Zt.a.ta(Ge));else if(Ge instanceof Array)Qe(Ge);else if(e(Ge))Qe(Zt.a.la(Ge.childNodes));else if(Ge.element)if(Ge=Ge.element,ot.HTMLElement?Ge instanceof HTMLElement:Ge&&Ge.tagName&&1===Ge.nodeType)Qe(d(Ge));else if("string"==typeof Ge){var tt=dt.getElementById(Ge);tt?Qe(d(tt)):Ne("Cannot find element with ID "+Ge)}else Ne("Unknown element type: "+Ge);else Ne("Unknown template value: "+Ge)},loadViewModel:function(Ne,Ge,Qe){c(g(Ne),Ge,Qe)}};var Qe="createViewModel";Zt.b("components.register",Zt.i.register),Zt.b("components.isRegistered",Zt.i.sb),Zt.b("components.unregister",Zt.i.unregister),Zt.b("components.defaultLoader",Zt.i.Ec),Zt.i.loaders.push(Zt.i.Ec),Zt.i.cd=Ne}(),function(){function b(Ge,Qe){if(tt=Ge.getAttribute("params")){var tt=Ne.parseBindingsString(tt,Qe,Ge,{valueAccessors:!0,bindingParams:!0}),rt=(tt=Zt.a.Ha(tt,(function(Ne){return Zt.o(Ne,null,{l:Ge})})),Zt.a.Ha(tt,(function(Ne){var Qe=Ne.w();return Ne.ja()?Zt.o({read:function(){return Zt.a.c(Ne())},write:Zt.Ya(Qe)&&function(Ge){Ne()(Ge)},l:Ge}):Qe})));return Object.prototype.hasOwnProperty.call(rt,"$raw")||(rt.$raw=tt),rt}return{$raw:{}}}Zt.i.getComponentNameForNode=function(Ne){var Ge=Zt.a.P(Ne);if(Zt.i.sb(Ge)&&(-1!=Ge.indexOf("-")||"[object HTMLUnknownElement]"==""+Ne||8>=Zt.a.W&&Ne.tagName===Ge))return Ge},Zt.i.sc=function(Ne,Ge,Qe,tt){if(1===Ge.nodeType){var rt=Zt.i.getComponentNameForNode(Ge);if(rt){if((Ne=Ne||{}).component)throw Error('Cannot use the "component" binding on a custom element matching a component');var nt={name:rt,params:b(Ge,Qe)};Ne.component=tt?function(){return nt}:nt}}return Ne};var Ne=new Zt.ga;9>Zt.a.W&&(Zt.i.register=function(Ne){return function(Ge){return Ne.apply(this,arguments)}}(Zt.i.register),dt.createDocumentFragment=function(Ne){return function(){var Ge,Qe=Ne(),tt=Zt.i.cd;for(Ge in tt);return Qe}}(dt.createDocumentFragment))}(),function(){var Ne=0;Zt.f.component={init:function(Ge,Qe,tt,rt,nt){function l(){var Ne=at&&at.dispose;"function"==typeof Ne&&Ne.call(at),ot&&ot.s(),it=at=ot=null}var at,it,ot,dt=Zt.a.la(Zt.h.childNodes(Ge));return Zt.h.Ea(Ge),Zt.a.I.za(Ge,l),Zt.o((function(){var tt,rt,ht=Zt.a.c(Qe());if("string"==typeof ht?tt=ht:(tt=Zt.a.c(ht.name),rt=Zt.a.c(ht.params)),!tt)throw Error("No component name specified");var Dt=Zt.j.Bb(Ge,nt),Ot=it=++Ne;Zt.i.get(tt,(function(Ne){if(it===Ot){if(l(),!Ne)throw Error("Unknown component '"+tt+"'");!function(Ne,Ge,Qe){if(!(Ge=Ge.template))throw Error("Component '"+Ne+"' has no template");Ne=Zt.a.Ca(Ge),Zt.h.ua(Qe,Ne)}(tt,Ne,Ge);var Qe=function(Ne,Ge,Qe){var tt=Ne.createViewModel;return tt?tt.call(Ne,Ge,Qe):Ge}(Ne,rt,{element:Ge,templateNodes:dt});Ne=Dt.createChildContext(Qe,{extend:function(Ne){Ne.$component=Qe,Ne.$componentTemplateNodes=dt}}),Qe&&Qe.koDescendantsComplete&&(ot=Zt.j.subscribe(Ge,Zt.j.oa,Qe.koDescendantsComplete,Qe)),at=Qe,Zt.Pa(Ne,Ge)}}))}),null,{l:Ge}),{controlsDescendantBindings:!0}}},Zt.h.ea.component=!0}();var Cn={class:"className",for:"htmlFor"};Zt.f.attr={update:function(Ne,Ge){var Qe=Zt.a.c(Ge())||{};Zt.a.O(Qe,(function(Ge,Qe){Qe=Zt.a.c(Qe);var tt=Ge.indexOf(":"),rt=(tt="lookupNamespaceURI"in Ne&&0<tt&&Ne.lookupNamespaceURI(Ge.substr(0,tt)),!1===Qe||null===Qe||Qe===it);rt?tt?Ne.removeAttributeNS(tt,Ge):Ne.removeAttribute(Ge):Qe=Qe.toString(),8>=Zt.a.W&&Ge in Cn?(Ge=Cn[Ge],rt?Ne.removeAttribute(Ge):Ne[Ge]=Qe):rt||(tt?Ne.setAttributeNS(tt,Ge,Qe):Ne.setAttribute(Ge,Qe)),"name"===Ge&&Zt.a.Xc(Ne,rt?"":Qe)}))}},Zt.f.checked={after:["value","attr"],init:function(Ne,Ge,Qe){function e(){var at=Ne.checked,ht=tt();if(!Zt.U.rb()&&(at||!nt&&!Zt.U.pa())){var Ot=Zt.v.K(Ge);if(ot){var Rt=dt?Ot.w():Ot,er=Dt;Dt=ht,er!==ht?at&&(Zt.a.Oa(Rt,ht,!0),Zt.a.Oa(Rt,er,!1)):Zt.a.Oa(Rt,ht,at),dt&&Zt.Ya(Ot)&&Ot(Rt)}else rt&&(ht===it?ht=at:at||(ht=it)),Zt.m.$a(Ot,Qe,"checked",ht,!0)}}var tt=Zt.wb((function(){return Qe.has("checkedValue")?Zt.a.c(Qe.get("checkedValue")):ht?Qe.has("value")?Zt.a.c(Qe.get("value")):Ne.value:void 0})),rt="checkbox"==Ne.type,nt="radio"==Ne.type;if(rt||nt){var at=Ge(),ot=rt&&Zt.a.c(at)instanceof Array,dt=!(ot&&at.push&&at.splice),ht=nt||ot,Dt=ot?tt():it;nt&&!Ne.name&&Zt.f.uniqueName.init(Ne,(function(){return!0})),Zt.o(e,null,{l:Ne}),Zt.a.H(Ne,"click",e),Zt.o((function(){var Qe=Zt.a.c(Ge()),nt=tt();ot?(Ne.checked=0<=Zt.a.A(Qe,nt),Dt=nt):Ne.checked=rt&&nt===it?!!Qe:tt()===Qe}),null,{l:Ne}),at=it}}},Zt.m.va.checked=!0,Zt.f.checkedValue={update:function(Ne,Ge){Ne.value=Zt.a.c(Ge())}},Zt.f.class={update:function(Ne,Ge){var Qe=Zt.a.Cb(Zt.a.c(Ge()));Zt.a.Eb(Ne,Ne.__ko__cssValue,!1),Ne.__ko__cssValue=Qe,Zt.a.Eb(Ne,Qe,!0)}},Zt.f.css={update:function(Ne,Ge){var Qe=Zt.a.c(Ge());null!==Qe&&"object"==typeof Qe?Zt.a.O(Qe,(function(Ge,Qe){Qe=Zt.a.c(Qe),Zt.a.Eb(Ne,Ge,Qe)})):Zt.f.class.update(Ne,Ge)}},Zt.f.enable={update:function(Ne,Ge){var Qe=Zt.a.c(Ge());Qe&&Ne.disabled?Ne.removeAttribute("disabled"):Qe||Ne.disabled||(Ne.disabled=!0)}},Zt.f.disable={update:function(Ne,Ge){Zt.f.enable.update(Ne,(function(){return!Zt.a.c(Ge())}))}},Zt.f.event={init:function(Ne,Ge,Qe,tt,rt){var nt=Ge()||{};Zt.a.O(nt,(function(nt){"string"==typeof nt&&Zt.a.H(Ne,nt,(function(Ne){var at,it=Ge()[nt];if(it){try{var ot=Zt.a.la(arguments);tt=rt.$data,ot.unshift(tt),at=it.apply(tt,ot)}finally{!0!==at&&(Ne.preventDefault?Ne.preventDefault():Ne.returnValue=!1)}!1===Qe.get(nt+"Bubble")&&(Ne.cancelBubble=!0,Ne.stopPropagation&&Ne.stopPropagation())}}))}))}},Zt.f.foreach={Qc:function(Ne){return function(){var Ge=Ne(),Qe=Zt.a.$b(Ge);return Qe&&"number"!=typeof Qe.length?(Zt.a.c(Ge),{foreach:Qe.data,as:Qe.as,noChildContext:Qe.noChildContext,includeDestroyed:Qe.includeDestroyed,afterAdd:Qe.afterAdd,beforeRemove:Qe.beforeRemove,afterRender:Qe.afterRender,beforeMove:Qe.beforeMove,afterMove:Qe.afterMove,templateEngine:Zt.ba.Na}):{foreach:Ge,templateEngine:Zt.ba.Na}}},init:function(Ne,Ge){return Zt.f.template.init(Ne,Zt.f.foreach.Qc(Ge))},update:function(Ne,Ge,Qe,tt,rt){return Zt.f.template.update(Ne,Zt.f.foreach.Qc(Ge),Qe,tt,rt)}},Zt.m.Ra.foreach=!1,Zt.h.ea.foreach=!0,Zt.f.hasfocus={init:function(Ne,Ge,Qe){function e(tt){Ne.__ko_hasfocusUpdating=!0;var rt=Ne.ownerDocument;if("activeElement"in rt){var nt;try{nt=rt.activeElement}catch(Ne){nt=rt.body}tt=nt===Ne}rt=Ge(),Zt.m.$a(rt,Qe,"hasfocus",tt,!0),Ne.__ko_hasfocusLastValue=tt,Ne.__ko_hasfocusUpdating=!1}var tt=e.bind(null,!0),rt=e.bind(null,!1);Zt.a.H(Ne,"focus",tt),Zt.a.H(Ne,"focusin",tt),Zt.a.H(Ne,"blur",rt),Zt.a.H(Ne,"focusout",rt),Ne.__ko_hasfocusLastValue=!1},update:function(Ne,Ge){var Qe=!!Zt.a.c(Ge());Ne.__ko_hasfocusUpdating||Ne.__ko_hasfocusLastValue===Qe||(Qe?Ne.focus():Ne.blur(),!Qe&&Ne.__ko_hasfocusLastValue&&Ne.ownerDocument.body.focus(),Zt.v.K(Zt.a.Fb,null,[Ne,Qe?"focusin":"focusout"]))}},Zt.m.va.hasfocus=!0,Zt.f.hasFocus=Zt.f.hasfocus,Zt.m.va.hasFocus="hasfocus",Zt.f.html={init:function(){return{controlsDescendantBindings:!0}},update:function(Ne,Ge){Zt.a.dc(Ne,Ge())}},function(){function b(Ne,Ge,Qe){Zt.f[Ne]={init:function(Ne,tt,rt,nt,at){var it,ot,dt,ht,Dt,Ot={};if(Ge){nt=rt.get("as");var Rt=rt.get("noChildContext");Ot={as:nt,noChildContext:Rt,exportDependencies:Dt=!(nt&&Rt)}}return ht=(dt="render"==rt.get("completeOn"))||rt.has(Zt.j.oa),Zt.o((function(){var rt,nt=Zt.a.c(tt()),Rt=!Qe!=!nt,er=!ot;(Dt||Rt!==it)&&(ht&&(at=Zt.j.Bb(Ne,at)),Rt&&(Ge&&!Dt||(Ot.dataDependency=Zt.U.o()),rt=Ge?at.createChildContext("function"==typeof nt?nt:tt,Ot):Zt.U.pa()?at.extend(null,Ot):at),er&&Zt.U.pa()&&(ot=Zt.a.Ca(Zt.h.childNodes(Ne),!0)),Rt?(er||Zt.h.ua(Ne,Zt.a.Ca(ot)),Zt.Pa(rt,Ne)):(Zt.h.Ea(Ne),dt||Zt.j.Ga(Ne,Zt.j.T)),it=Rt)}),null,{l:Ne}),{controlsDescendantBindings:!0}}},Zt.m.Ra[Ne]=!1,Zt.h.ea[Ne]=!0}b("if"),b("ifnot",!1,!0),b("with",!0)}(),Zt.f.let={init:function(Ne,Ge,Qe,tt,rt){return Ge=rt.extend(Ge),Zt.Pa(Ge,Ne),{controlsDescendantBindings:!0}}},Zt.h.ea.let=!0;var En={};Zt.f.options={init:function(Ne){if("select"!==Zt.a.P(Ne))throw Error("options binding applies only to SELECT elements");for(;0<Ne.length;)Ne.remove(0);return{controlsDescendantBindings:!0}},update:function(Ne,Ge,Qe){function e(){return Zt.a.fb(Ne.options,(function(Ne){return Ne.selected}))}function f(Ne,Ge,Qe){var tt=typeof Ge;return"function"==tt?Ge(Ne):"string"==tt?Ne[Ge]:Qe}function g(Ge,tt){if(Dt&&at)Zt.u.ya(Ne,Zt.a.c(Qe.get("value")),!0);else if(ht.length){var rt=0<=Zt.a.A(ht,Zt.u.L(tt[0]));Zt.a.Yc(tt[0],rt),Dt&&!rt&&Zt.v.K(Zt.a.Fb,null,[Ne,"change"])}}var tt=Ne.multiple,rt=0!=Ne.length&&tt?Ne.scrollTop:null,nt=Zt.a.c(Ge()),at=Qe.get("valueAllowUnset")&&Qe.has("value"),ot=Qe.get("optionsIncludeDestroyed");Ge={};var dt,ht=[];at||(tt?ht=Zt.a.Mb(e(),Zt.u.L):0<=Ne.selectedIndex&&ht.push(Zt.u.L(Ne.options[Ne.selectedIndex]))),nt&&(void 0===nt.length&&(nt=[nt]),dt=Zt.a.fb(nt,(function(Ne){return ot||Ne===it||null===Ne||!Zt.a.c(Ne._destroy)})),Qe.has("optionsCaption")&&null!==(nt=Zt.a.c(Qe.get("optionsCaption")))&&nt!==it&&dt.unshift(En));var Dt=!1;Ge.beforeRemove=function(Ge){Ne.removeChild(Ge)},nt=g,Qe.has("optionsAfterRender")&&"function"==typeof Qe.get("optionsAfterRender")&&(nt=function(Ne,Ge){g(0,Ge),Zt.v.K(Qe.get("optionsAfterRender"),null,[Ge[0],Ne!==En?Ne:it])}),Zt.a.cc(Ne,dt,(function(Ge,tt,rt){return rt.length&&(ht=!at&&rt[0].selected?[Zt.u.L(rt[0])]:[],Dt=!0),tt=Ne.ownerDocument.createElement("option"),Ge===En?(Zt.a.Ab(tt,Qe.get("optionsCaption")),Zt.u.ya(tt,it)):(rt=f(Ge,Qe.get("optionsValue"),Ge),Zt.u.ya(tt,Zt.a.c(rt)),Ge=f(Ge,Qe.get("optionsText"),rt),Zt.a.Ab(tt,Ge)),[tt]}),Ge,nt),Zt.v.K((function(){at?Zt.u.ya(Ne,Zt.a.c(Qe.get("value")),!0):(tt?ht.length&&e().length<ht.length:ht.length&&0<=Ne.selectedIndex?Zt.u.L(Ne.options[Ne.selectedIndex])!==ht[0]:ht.length||0<=Ne.selectedIndex)&&Zt.a.Fb(Ne,"change")})),Zt.a.vd(Ne),rt&&20<Math.abs(rt-Ne.scrollTop)&&(Ne.scrollTop=rt)}},Zt.f.options.Yb=Zt.a.g.Z(),Zt.f.selectedOptions={after:["options","foreach"],init:function(Ne,Ge,Qe){Zt.a.H(Ne,"change",(function(){var tt=Ge(),rt=[];Zt.a.C(Ne.getElementsByTagName("option"),(function(Ne){Ne.selected&&rt.push(Zt.u.L(Ne))})),Zt.m.$a(tt,Qe,"selectedOptions",rt)}))},update:function(Ne,Ge){if("select"!=Zt.a.P(Ne))throw Error("values binding applies only to SELECT elements");var Qe=Zt.a.c(Ge()),tt=Ne.scrollTop;Qe&&"number"==typeof Qe.length&&Zt.a.C(Ne.getElementsByTagName("option"),(function(Ne){var Ge=0<=Zt.a.A(Qe,Zt.u.L(Ne));Ne.selected!=Ge&&Zt.a.Yc(Ne,Ge)})),Ne.scrollTop=tt}},Zt.m.va.selectedOptions=!0,Zt.f.style={update:function(Ne,Ge){var Qe=Zt.a.c(Ge()||{});Zt.a.O(Qe,(function(Ge,Qe){if(null!==(Qe=Zt.a.c(Qe))&&Qe!==it&&!1!==Qe||(Qe=""),Dt)Dt(Ne).css(Ge,Qe);else if(/^--/.test(Ge))Ne.style.setProperty(Ge,Qe);else{Ge=Ge.replace(/-(\w)/g,(function(Ne,Ge){return Ge.toUpperCase()}));var tt=Ne.style[Ge];Ne.style[Ge]=Qe,Qe===tt||Ne.style[Ge]!=tt||isNaN(Qe)||(Ne.style[Ge]=Qe+"px")}}))}},Zt.f.submit={init:function(Ne,Ge,Qe,tt,rt){if("function"!=typeof Ge())throw Error("The value for a submit binding must be a function");Zt.a.H(Ne,"submit",(function(Qe){var tt,nt=Ge();try{tt=nt.call(rt.$data,Ne)}finally{!0!==tt&&(Qe.preventDefault?Qe.preventDefault():Qe.returnValue=!1)}}))}},Zt.f.text={init:function(){return{controlsDescendantBindings:!0}},update:function(Ne,Ge){Zt.a.Ab(Ne,Ge())}},Zt.h.ea.text=!0,function(){if(ot&&ot.navigator){var Ne,Ge,Qe,tt,rt,b=function(Ne){if(Ne)return parseFloat(Ne[1])},nt=ot.navigator.userAgent;(Ne=ot.opera&&ot.opera.version&&parseInt(ot.opera.version()))||(rt=b(nt.match(/Edge\/([^ ]+)$/)))||b(nt.match(/Chrome\/([^ ]+)/))||(Ge=b(nt.match(/Version\/([^ ]+) Safari/)))||(Qe=b(nt.match(/Firefox\/([^ ]+)/)))||(tt=Zt.a.W||b(nt.match(/MSIE ([^ ]+)/)))||(tt=b(nt.match(/rv:([^ )]+)/)))}if(8<=tt&&10>tt)var at=Zt.a.g.Z(),dt=Zt.a.g.Z(),k=function(Ne){var Ge=this.activeElement;(Ge=Ge&&Zt.a.g.get(Ge,dt))&&Ge(Ne)},q=function(Ne,Ge){var Qe=Ne.ownerDocument;Zt.a.g.get(Qe,at)||(Zt.a.g.set(Qe,at,!0),Zt.a.H(Qe,"selectionchange",k)),Zt.a.g.set(Ne,dt,Ge)};Zt.f.textInput={init:function(nt,at,ot){function k(Ne,Ge){Zt.a.H(nt,Ne,Ge)}function t(){dt||(ht=nt.value,dt=Zt.a.setTimeout(B,4))}function B(){clearTimeout(dt),ht=dt=it;var Ne=nt.value;Dt!==Ne&&(Dt=Ne,Zt.m.$a(at(),ot,"textInput",Ne))}var dt,ht,Dt=nt.value,Ot=9==Zt.a.W?t:B,Rt=!1;tt&&k("keypress",B),11>tt&&k("propertychange",(function(Ne){Rt||"value"!==Ne.propertyName||Ot(Ne)})),8==tt&&(k("keyup",B),k("keydown",B)),q&&(q(nt,Ot),k("dragend",t)),(!tt||9<=tt)&&k("input",Ot),5>Ge&&"textarea"===Zt.a.P(nt)?(k("keydown",t),k("paste",t),k("cut",t)):11>Ne?k("keydown",t):4>Qe?(k("DOMAutoComplete",B),k("dragdrop",B),k("drop",B)):rt&&"number"===nt.type&&k("keydown",t),k("change",B),k("blur",B),Zt.o((function m(){var Ne=Zt.a.c(at());null!==Ne&&Ne!==it||(Ne=""),ht!==it&&Ne===ht?Zt.a.setTimeout(m,4):nt.value!==Ne&&(Rt=!0,nt.value=Ne,Rt=!1,Dt=nt.value)}),null,{l:nt})}},Zt.m.va.textInput=!0,Zt.f.textinput={preprocess:function(Ne,Ge,Qe){Qe("textInput",Ne)}}}(),Zt.f.uniqueName={init:function(Ne,Ge){if(Ge()){var Qe="ko_unique_"+ ++Zt.f.uniqueName.qd;Zt.a.Xc(Ne,Qe)}}},Zt.f.uniqueName.qd=0,Zt.f.using={init:function(Ne,Ge,Qe,tt,rt){var nt;return Qe.has("as")&&(nt={as:Qe.get("as"),noChildContext:Qe.get("noChildContext")}),Ge=rt.createChildContext(Ge,nt),Zt.Pa(Ge,Ne),{controlsDescendantBindings:!0}}},Zt.h.ea.using=!0,Zt.f.value={after:["options","foreach"],init:function(Ne,Ge,Qe){var tt=Zt.a.P(Ne),rt="input"==tt;if(!rt||"checkbox"!=Ne.type&&"radio"!=Ne.type){var nt=["change"],at=Qe.get("valueUpdate"),ot=!1,dt=null;at&&("string"==typeof at&&(at=[at]),Zt.a.gb(nt,at),nt=Zt.a.vc(nt));var ht,k=function(){dt=null,ot=!1;var tt=Ge(),rt=Zt.u.L(Ne);Zt.m.$a(tt,Qe,"value",rt)};!Zt.a.W||!rt||"text"!=Ne.type||"off"==Ne.autocomplete||Ne.form&&"off"==Ne.form.autocomplete||-1!=Zt.a.A(nt,"propertychange")||(Zt.a.H(Ne,"propertychange",(function(){ot=!0})),Zt.a.H(Ne,"focus",(function(){ot=!1})),Zt.a.H(Ne,"blur",(function(){ot&&k()}))),Zt.a.C(nt,(function(Ge){var Qe=k;Zt.a.Td(Ge,"after")&&(Qe=function(){dt=Zt.u.L(Ne),Zt.a.setTimeout(k,0)},Ge=Ge.substring(5)),Zt.a.H(Ne,Ge,Qe)})),ht=rt&&"file"==Ne.type?function(){var Qe=Zt.a.c(Ge());null===Qe||Qe===it||""===Qe?Ne.value="":Zt.v.K(k)}:function(){var rt=Zt.a.c(Ge()),nt=Zt.u.L(Ne);null!==dt&&rt===dt?Zt.a.setTimeout(ht,0):rt===nt&&nt!==it||("select"===tt?(nt=Qe.get("valueAllowUnset"),Zt.u.ya(Ne,rt,nt),nt||rt===Zt.u.L(Ne)||Zt.v.K(k)):Zt.u.ya(Ne,rt))},Zt.o(ht,null,{l:Ne})}else Zt.eb(Ne,{checkedValue:Ge})},update:function(){}},Zt.m.va.value=!0,Zt.f.visible={update:function(Ne,Ge){var Qe=Zt.a.c(Ge()),tt="none"!=Ne.style.display;Qe&&!tt?Ne.style.display="":!Qe&&tt&&(Ne.style.display="none")}},Zt.f.hidden={update:function(Ne,Ge){Zt.f.visible.update(Ne,(function(){return!Zt.a.c(Ge())}))}},function(Ne){Zt.f[Ne]={init:function(Ge,Qe,tt,rt,nt){return Zt.f.event.init.call(this,Ge,(function(){var Ge={};return Ge[Ne]=Qe(),Ge}),tt,rt,nt)}}}("click"),Zt.ca=function(){},Zt.ca.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")},Zt.ca.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")},Zt.ca.prototype.makeTemplateSource=function(Ne,Ge){if("string"==typeof Ne){var Qe=(Ge=Ge||dt).getElementById(Ne);if(!Qe)throw Error("Cannot find template with ID "+Ne);return new Zt.B.D(Qe)}if(1==Ne.nodeType||8==Ne.nodeType)return new Zt.B.ia(Ne);throw Error("Unknown template type: "+Ne)},Zt.ca.prototype.renderTemplate=function(Ne,Ge,Qe,tt){return Ne=this.makeTemplateSource(Ne,tt),this.renderTemplateSource(Ne,Ge,Qe,tt)},Zt.ca.prototype.isTemplateRewritten=function(Ne,Ge){return!1===this.allowTemplateRewriting||this.makeTemplateSource(Ne,Ge).data("isRewritten")},Zt.ca.prototype.rewriteTemplate=function(Ne,Ge,Qe){Ge=Ge((Ne=this.makeTemplateSource(Ne,Qe)).text()),Ne.text(Ge),Ne.data("isRewritten",!0)},Zt.b("templateEngine",Zt.ca),Zt.ic=function(){function b(Ne,Ge,Qe,tt){Ne=Zt.m.Zb(Ne);for(var rt=Zt.m.Ra,nt=0;nt<Ne.length;nt++){var at=Ne[nt].key;if(Object.prototype.hasOwnProperty.call(rt,at)){var it=rt[at];if("function"==typeof it){if(at=it(Ne[nt].value))throw Error(at)}else if(!it)throw Error("This template engine does not support the '"+at+"' binding within its templates")}}return Qe="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+Zt.m.ub(Ne,{valueAccessors:!0})+" } })()},'"+Qe.toLowerCase()+"')",tt.createJavaScriptEvaluatorBlock(Qe)+Ge}var Ne=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,Ge=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g;return{wd:function(Ne,Ge,Qe){Ge.isTemplateRewritten(Ne,Qe)||Ge.rewriteTemplate(Ne,(function(Ne){return Zt.ic.Kd(Ne,Ge)}),Qe)},Kd:function(Qe,tt){return Qe.replace(Ne,(function(Ne,Ge,Qe,rt,nt){return b(nt,Ge,Qe,tt)})).replace(Ge,(function(Ne,Ge){return b(Ge,"\x3c!-- ko --\x3e","#comment",tt)}))},ld:function(Ne,Ge){return Zt.aa.Wb((function(Qe,tt){var rt=Qe.nextSibling;rt&&rt.nodeName.toLowerCase()===Ge&&Zt.eb(rt,Ne,tt)}))}}}(),Zt.b("__tr_ambtns",Zt.ic.ld),function(){Zt.B={},Zt.B.D=function(Ne){if(this.D=Ne){var Ge=Zt.a.P(Ne);this.Db="script"===Ge?1:"textarea"===Ge?2:"template"==Ge&&Ne.content&&11===Ne.content.nodeType?3:4}},Zt.B.D.prototype.text=function(){var Ne=1===this.Db?"text":2===this.Db?"value":"innerHTML";if(0==arguments.length)return this.D[Ne];var Ge=arguments[0];"innerHTML"===Ne?Zt.a.dc(this.D,Ge):this.D[Ne]=Ge};var Ne=Zt.a.g.Z()+"_";Zt.B.D.prototype.data=function(Ge){if(1===arguments.length)return Zt.a.g.get(this.D,Ne+Ge);Zt.a.g.set(this.D,Ne+Ge,arguments[1])};var Ge=Zt.a.g.Z();Zt.B.D.prototype.nodes=function(){var Ne=this.D;if(0==arguments.length){var Qe=Zt.a.g.get(Ne,Ge)||{},tt=Qe.jb||(3===this.Db?Ne.content:4===this.Db?Ne:it);return tt&&!Qe.hd||(Qe=this.text())&&(tt=Zt.a.Ld(Qe,Ne.ownerDocument),this.text(""),Zt.a.g.set(Ne,Ge,{jb:tt,hd:!0})),tt}Zt.a.g.set(Ne,Ge,{jb:arguments[0]})},Zt.B.ia=function(Ne){this.D=Ne},Zt.B.ia.prototype=new Zt.B.D,Zt.B.ia.prototype.constructor=Zt.B.ia,Zt.B.ia.prototype.text=function(){if(0==arguments.length){var Ne=Zt.a.g.get(this.D,Ge)||{};return Ne.jc===it&&Ne.jb&&(Ne.jc=Ne.jb.innerHTML),Ne.jc}Zt.a.g.set(this.D,Ge,{jc:arguments[0]})},Zt.b("templateSources",Zt.B),Zt.b("templateSources.domElement",Zt.B.D),Zt.b("templateSources.anonymousTemplate",Zt.B.ia)}(),function(){function b(Ne,Ge,Qe){var tt;for(Ge=Zt.h.nextSibling(Ge);Ne&&(tt=Ne)!==Ge;)Qe(tt,Ne=Zt.h.nextSibling(tt))}function c(Ne,Ge){if(Ne.length){var Qe=Ne[0],tt=Ne[Ne.length-1],rt=Qe.parentNode,nt=Zt.ga.instance,at=nt.preprocessNode;if(at){if(b(Qe,tt,(function(Ne,Ge){var rt=Ne.previousSibling,it=at.call(nt,Ne);it&&(Ne===Qe&&(Qe=it[0]||Ge),Ne===tt&&(tt=it[it.length-1]||rt))})),Ne.length=0,!Qe)return;Qe===tt?Ne.push(Qe):(Ne.push(Qe,tt),Zt.a.Ua(Ne,rt))}b(Qe,tt,(function(Ne){1!==Ne.nodeType&&8!==Ne.nodeType||Zt.uc(Ge,Ne)})),b(Qe,tt,(function(Ne){1!==Ne.nodeType&&8!==Ne.nodeType||Zt.aa.bd(Ne,[Ge])})),Zt.a.Ua(Ne,rt)}}function d(Ne){return Ne.nodeType?Ne:0<Ne.length?Ne[0]:null}function e(Ge,Qe,tt,rt,nt){nt=nt||{};var at=(Ge&&d(Ge)||tt||{}).ownerDocument,it=nt.templateEngine||Ne;if(Zt.ic.wd(tt,it,at),"number"!=typeof(tt=it.renderTemplate(tt,rt,nt,at)).length||0<tt.length&&"number"!=typeof tt[0].nodeType)throw Error("Template engine must return an array of DOM nodes");switch(at=!1,Qe){case"replaceChildren":Zt.h.ua(Ge,tt),at=!0;break;case"replaceNode":Zt.a.Wc(Ge,tt),at=!0;break;case"ignoreTargetNode":break;default:throw Error("Unknown renderMode: "+Qe)}return at&&(c(tt,rt),nt.afterRender&&Zt.v.K(nt.afterRender,null,[tt,rt[nt.as||"$data"]]),"replaceChildren"==Qe&&Zt.j.Ga(Ge,Zt.j.T)),tt}function f(Ne,Ge,Qe){return Zt.N(Ne)?Ne():"function"==typeof Ne?Ne(Ge,Qe):Ne}var Ne;Zt.ec=function(Ge){if(Ge!=it&&!(Ge instanceof Zt.ca))throw Error("templateEngine must inherit from ko.templateEngine");Ne=Ge},Zt.bc=function(Ge,Qe,tt,rt,nt){if(((tt=tt||{}).templateEngine||Ne)==it)throw Error("Set a template engine before calling renderTemplate");if(nt=nt||"replaceChildren",rt){var at=d(rt);return Zt.$((function(){var Ne=Qe&&Qe instanceof Zt.fa?Qe:new Zt.fa(Qe,null,null,null,{exportDependencies:!0}),it=f(Ge,Ne.$data,Ne);Ne=e(rt,nt,it,Ne,tt),"replaceNode"==nt&&(at=d(rt=Ne))}),null,{Sa:function(){return!at||!Zt.a.Rb(at)},l:at&&"replaceNode"==nt?at.parentNode:at})}return Zt.aa.Wb((function(Ne){Zt.bc(Ge,Qe,tt,Ne,"replaceNode")}))},Zt.Pd=function(Ne,Ge,Qe,tt,rt){function y(Ne,Ge){Zt.v.K(Zt.a.cc,null,[tt,Ne,u,Qe,t,Ge]),Zt.j.Ga(tt,Zt.j.T)}function t(Ne,Ge){c(Ge,nt),Qe.afterRender&&Qe.afterRender(Ge,Ne),nt=null}function u(Ge,it){nt=rt.createChildContext(Ge,{as:at,noChildContext:Qe.noChildContext,extend:function(Ne){Ne.$index=it,at&&(Ne[at+"Index"]=it)}});var ot=f(Ne,Ge,nt);return e(tt,"ignoreTargetNode",ot,nt,Qe)}var nt,at=Qe.as,ot=!1===Qe.includeDestroyed||Zt.options.foreachHidesDestroyed&&!Qe.includeDestroyed;if(ot||Qe.beforeRemove||!Zt.Oc(Ge))return Zt.$((function(){var Ne=Zt.a.c(Ge)||[];void 0===Ne.length&&(Ne=[Ne]),ot&&(Ne=Zt.a.fb(Ne,(function(Ne){return Ne===it||null===Ne||!Zt.a.c(Ne._destroy)}))),y(Ne)}),null,{l:tt});y(Ge.w());var dt=Ge.subscribe((function(Ne){y(Ge(),Ne)}),null,"arrayChange");return dt.l(tt),dt};var Ge=Zt.a.g.Z(),Qe=Zt.a.g.Z();Zt.f.template={init:function(Ne,Ge){var tt=Zt.a.c(Ge());if("string"==typeof tt||tt.name)Zt.h.Ea(Ne);else if("nodes"in tt){if(tt=tt.nodes||[],Zt.N(tt))throw Error('The "nodes" option must be a plain, non-observable array.');var rt=tt[0]&&tt[0].parentNode;rt&&Zt.a.g.get(rt,Qe)||(rt=Zt.a.Xb(tt),Zt.a.g.set(rt,Qe,!0)),new Zt.B.ia(Ne).nodes(rt)}else{if(!(0<(tt=Zt.h.childNodes(Ne)).length))throw Error("Anonymous template defined, but no template content was provided");rt=Zt.a.Xb(tt),new Zt.B.ia(Ne).nodes(rt)}return{controlsDescendantBindings:!0}},update:function(Ne,Qe,tt,rt,nt){var at=Qe();tt=!0,rt=null,"string"==typeof(Qe=Zt.a.c(at))?Qe={}:(at=Qe.name,"if"in Qe&&(tt=Zt.a.c(Qe.if)),tt&&"ifnot"in Qe&&(tt=!Zt.a.c(Qe.ifnot))),"foreach"in Qe?rt=Zt.Pd(at||Ne,tt&&Qe.foreach||[],Qe,Ne,nt):tt?(tt=nt,"data"in Qe&&(tt=nt.createChildContext(Qe.data,{as:Qe.as,noChildContext:Qe.noChildContext,exportDependencies:!0})),rt=Zt.bc(at||Ne,tt,Qe,Ne)):Zt.h.Ea(Ne),nt=rt,(Qe=Zt.a.g.get(Ne,Ge))&&"function"==typeof Qe.s&&Qe.s(),Zt.a.g.set(Ne,Ge,!nt||nt.ja&&!nt.ja()?it:nt)}},Zt.m.Ra.template=function(Ne){return 1==(Ne=Zt.m.Zb(Ne)).length&&Ne[0].unknown||Zt.m.Hd(Ne,"name")?null:"This template engine does not support anonymous templates nested within its templates"},Zt.h.ea.template=!0}(),Zt.b("setTemplateEngine",Zt.ec),Zt.b("renderTemplate",Zt.bc),Zt.a.Jc=function(Ne,Ge,Qe){var tt,rt,nt,at,it;if(Ne.length&&Ge.length)for(tt=rt=0;(!Qe||tt<Qe)&&(at=Ne[rt]);++rt){for(nt=0;it=Ge[nt];++nt)if(at.value===it.value){at.moved=it.index,it.moved=at.index,Ge.splice(nt,1),tt=nt=0;break}tt+=nt}},Zt.a.Ob=function(){function b(Ne,Ge,Qe,tt,rt){var nt,at,it,ot,dt,ht=Math.min,Dt=Math.max,Ot=[],Rt=Ne.length,er=Ge.length,dr=er-Rt||1,mr=Rt+er+1;for(nt=0;nt<=Rt;nt++)for(ot=it,Ot.push(it=[]),dt=ht(er,nt+dr),at=Dt(0,nt-1);at<=dt;at++)it[at]=at?nt?Ne[nt-1]===Ge[at-1]?ot[at-1]:ht(ot[at]||mr,it[at-1]||mr)+1:at+1:nt+1;for(ht=[],Dt=[],dr=[],nt=Rt,at=er;nt||at;)er=Ot[nt][at]-1,at&&er===Ot[nt][at-1]?Dt.push(ht[ht.length]={status:Qe,value:Ge[--at],index:at}):nt&&er===Ot[nt-1][at]?dr.push(ht[ht.length]={status:tt,value:Ne[--nt],index:nt}):(--at,--nt,rt.sparse||ht.push({status:"retained",value:Ge[at]}));return Zt.a.Jc(dr,Dt,!rt.dontLimitMoves&&10*Rt),ht.reverse()}return function(Ne,Ge,Qe){return Qe="boolean"==typeof Qe?{dontLimitMoves:Qe}:Qe||{},Ge=Ge||[],(Ne=Ne||[]).length<Ge.length?b(Ne,Ge,"added","deleted",Qe):b(Ge,Ne,"deleted","added",Qe)}}(),Zt.b("utils.compareArrays",Zt.a.Ob),function(){function b(Ne,Ge,Qe,tt,rt){var nt=[],at=Zt.$((function(){var at=Ge(Qe,rt,Zt.a.Ua(nt,Ne))||[];0<nt.length&&(Zt.a.Wc(nt,at),tt&&Zt.v.K(tt,null,[Qe,at,rt])),nt.length=0,Zt.a.gb(nt,at)}),null,{l:Ne,Sa:function(){return!Zt.a.jd(nt)}});return{Y:nt,$:at.ja()?at:it}}var Ne=Zt.a.g.Z(),Ge=Zt.a.g.Z();Zt.a.cc=function(Qe,tt,rt,nt,at,ot){function k(Ne){dt={Aa:Ne,nb:Zt.sa(xr++)},dr.push(dt),er||xn.push(dt)}function q(Ne){dt=Rt[Ne],xr!==dt.nb.w()&&mn.push(dt),dt.nb(xr++),Zt.a.Ua(dt.Y,Qe),dr.push(dt)}function n(Ne,Ge){if(Ne)for(var Qe=0,tt=Ge.length;Qe<tt;Qe++)Zt.a.C(Ge[Qe].Y,(function(tt){Ne(tt,Qe,Ge[Qe].Aa)}))}void 0===(tt=tt||[]).length&&(tt=[tt]),nt=nt||{};var dt,ht,Dt,Ot,Rt=Zt.a.g.get(Qe,Ne),er=!Rt,dr=[],mr=0,xr=0,br=[],Ar=[],en=[],mn=[],xn=[],kn=0;if(er)Zt.a.C(tt,k);else{if(!ot||Rt&&Rt._countWaitingForRemove){var Cn=Zt.a.Mb(Rt,(function(Ne){return Ne.Aa}));ot=Zt.a.Ob(Cn,tt,{dontLimitMoves:nt.dontLimitMoves,sparse:!0})}var En,Pn,Dn;for(Cn=0;En=ot[Cn];Cn++)switch(Pn=En.moved,Dn=En.index,En.status){case"deleted":for(;mr<Dn;)q(mr++);Pn===it&&((dt=Rt[mr]).$&&(dt.$.s(),dt.$=it),Zt.a.Ua(dt.Y,Qe).length&&(nt.beforeRemove&&(dr.push(dt),kn++,dt.Aa===Ge?dt=null:en.push(dt)),dt&&br.push.apply(br,dt.Y))),mr++;break;case"added":for(;xr<Dn;)q(mr++);Pn!==it?(Ar.push(dr.length),q(Pn)):k(En.value)}for(;xr<tt.length;)q(mr++);dr._countWaitingForRemove=kn}Zt.a.g.set(Qe,Ne,dr),n(nt.beforeMove,mn),Zt.a.C(br,nt.beforeRemove?Zt.na:Zt.removeNode);try{Ot=Qe.ownerDocument.activeElement}catch(Ne){}if(Ar.length)for(;(Cn=Ar.shift())!=it;){for(dt=dr[Cn],ht=it;Cn;)if((Dt=dr[--Cn].Y)&&Dt.length){ht=Dt[Dt.length-1];break}for(tt=0;mr=dt.Y[tt];ht=mr,tt++)Zt.h.Vb(Qe,mr,ht)}for(Cn=0,Ar=Zt.h.firstChild(Qe);dt=dr[Cn];Cn++){for(dt.Y||Zt.a.extend(dt,b(Qe,rt,dt.Aa,at,dt.nb)),tt=0;mr=dt.Y[tt];Ar=mr.nextSibling,ht=mr,tt++)mr!==Ar&&Zt.h.Vb(Qe,mr,ht);!dt.Dd&&at&&(at(dt.Aa,dt.Y,dt.nb),dt.Dd=!0,ht=dt.Y[dt.Y.length-1])}for(Ot&&Qe.ownerDocument.activeElement!=Ot&&Ot.focus(),n(nt.beforeRemove,en),Cn=0;Cn<en.length;++Cn)en[Cn].Aa=Ge;n(nt.afterMove,mn),n(nt.afterAdd,xn)}}(),Zt.b("utils.setDomNodeChildrenFromArrayMapping",Zt.a.cc),Zt.ba=function(){this.allowTemplateRewriting=!1},Zt.ba.prototype=new Zt.ca,Zt.ba.prototype.constructor=Zt.ba,Zt.ba.prototype.renderTemplateSource=function(Ne,Ge,Qe,tt){return(Ge=9>Zt.a.W||!Ne.nodes?null:Ne.nodes())?Zt.a.la(Ge.cloneNode(!0).childNodes):(Ne=Ne.text(),Zt.a.ta(Ne,tt))},Zt.ba.Na=new Zt.ba,Zt.ec(Zt.ba.Na),Zt.b("nativeTemplateEngine",Zt.ba),function(){Zt.Za=function(){var Ne=this.Gd=function(){if(!Dt||!Dt.tmpl)return 0;try{if(0<=Dt.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(Ne){}return 1}();this.renderTemplateSource=function(Ge,Qe,tt,rt){if(rt=rt||dt,tt=tt||{},2>Ne)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.");var nt=Ge.data("precompiled");return nt||(nt=Ge.text()||"",nt=Dt.template(null,"{{ko_with $item.koBindingContext}}"+nt+"{{/ko_with}}"),Ge.data("precompiled",nt)),Ge=[Qe.$data],Qe=Dt.extend({koBindingContext:Qe},tt.templateOptions),(Qe=Dt.tmpl(nt,Ge,Qe)).appendTo(rt.createElement("div")),Dt.fragments={},Qe},this.createJavaScriptEvaluatorBlock=function(Ne){return"{{ko_code ((function() { return "+Ne+" })()) }}"},this.addTemplate=function(Ne,Ge){dt.write("<script type='text/html' id='"+Ne+"'>"+Ge+"<\/script>")},0<Ne&&(Dt.tmpl.tag.ko_code={open:"__.push($1 || '');"},Dt.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},Zt.Za.prototype=new Zt.ca,Zt.Za.prototype.constructor=Zt.Za;var Ne=new Zt.Za;0<Ne.Gd&&Zt.ec(Ne),Zt.b("jqueryTmplTemplateEngine",Zt.Za)}()}))}()},68996:function(Ne,Ge,Qe){var tt,rt=Qe(20198);Ne.exports=function(){function r(Ne,Ge,Qe){function o(rt,nt){if(!Ge[rt]){if(!Ne[rt]){if(tt)return tt(rt,!0);var at=new Error("Cannot find module '"+rt+"'");throw at.code="MODULE_NOT_FOUND",at}var it=Ge[rt]={exports:{}};Ne[rt][0].call(it.exports,(function(Ge){return o(Ne[rt][1][Ge]||Ge)}),it,it.exports,r,Ne,Ge,Qe)}return Ge[rt].exports}for(var tt=void 0,rt=0;rt<Qe.length;rt++)o(Qe[rt]);return o}return r}()({1:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../src/lib"),rt={"X,X div":"direction:ltr;font-family:'Open Sans', verdana, arial, sans-serif;margin:0;padding:0;","X input,X button":"font-family:'Open Sans', verdana, arial, sans-serif;","X input:focus,X button:focus":"outline:none;","X a":"text-decoration:none;","X a:hover":"text-decoration:none;","X .crisp":"shape-rendering:crispEdges;","X .user-select-none":"-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none;","X svg":"overflow:hidden;","X svg a":"fill:#447adb;","X svg a:hover":"fill:#3c6dc5;","X .main-svg":"position:absolute;top:0;left:0;pointer-events:none;","X .main-svg .draglayer":"pointer-events:all;","X .cursor-default":"cursor:default;","X .cursor-pointer":"cursor:pointer;","X .cursor-crosshair":"cursor:crosshair;","X .cursor-move":"cursor:move;","X .cursor-col-resize":"cursor:col-resize;","X .cursor-row-resize":"cursor:row-resize;","X .cursor-ns-resize":"cursor:ns-resize;","X .cursor-ew-resize":"cursor:ew-resize;","X .cursor-sw-resize":"cursor:sw-resize;","X .cursor-s-resize":"cursor:s-resize;","X .cursor-se-resize":"cursor:se-resize;","X .cursor-w-resize":"cursor:w-resize;","X .cursor-e-resize":"cursor:e-resize;","X .cursor-nw-resize":"cursor:nw-resize;","X .cursor-n-resize":"cursor:n-resize;","X .cursor-ne-resize":"cursor:ne-resize;","X .cursor-grab":"cursor:-webkit-grab;cursor:grab;","X .modebar":"position:absolute;top:2px;right:2px;","X .ease-bg":"-webkit-transition:background-color 0.3s ease 0s;-moz-transition:background-color 0.3s ease 0s;-ms-transition:background-color 0.3s ease 0s;-o-transition:background-color 0.3s ease 0s;transition:background-color 0.3s ease 0s;","X .modebar--hover>:not(.watermark)":"opacity:0;-webkit-transition:opacity 0.3s ease 0s;-moz-transition:opacity 0.3s ease 0s;-ms-transition:opacity 0.3s ease 0s;-o-transition:opacity 0.3s ease 0s;transition:opacity 0.3s ease 0s;","X:hover .modebar--hover .modebar-group":"opacity:1;","X .modebar-group":"float:left;display:inline-block;box-sizing:border-box;padding-left:8px;position:relative;vertical-align:middle;white-space:nowrap;","X .modebar-btn":"position:relative;font-size:16px;padding:3px 4px;height:22px;cursor:pointer;line-height:normal;box-sizing:border-box;","X .modebar-btn svg":"position:relative;top:2px;","X .modebar.vertical":"display:flex;flex-direction:column;flex-wrap:wrap;align-content:flex-end;max-height:100%;","X .modebar.vertical svg":"top:-1px;","X .modebar.vertical .modebar-group":"display:block;float:none;padding-left:0px;padding-bottom:8px;","X .modebar.vertical .modebar-group .modebar-btn":"display:block;text-align:center;","X [data-title]:before,X [data-title]:after":"position:absolute;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);-o-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);display:none;opacity:0;z-index:1001;pointer-events:none;top:110%;right:50%;","X [data-title]:hover:before,X [data-title]:hover:after":"display:block;opacity:1;","X [data-title]:before":"content:'';position:absolute;background:transparent;border:6px solid transparent;z-index:1002;margin-top:-12px;border-bottom-color:#69738a;margin-right:-6px;","X [data-title]:after":"content:attr(data-title);background:#69738a;color:white;padding:8px 10px;font-size:12px;line-height:12px;white-space:nowrap;margin-right:-18px;border-radius:2px;","X .vertical [data-title]:before,X .vertical [data-title]:after":"top:0%;right:200%;","X .vertical [data-title]:before":"border:6px solid transparent;border-left-color:#69738a;margin-top:8px;margin-right:-30px;","X .select-outline":"fill:none;stroke-width:1;shape-rendering:crispEdges;","X .select-outline-1":"stroke:white;","X .select-outline-2":"stroke:black;stroke-dasharray:2px 2px;",Y:"font-family:'Open Sans', verdana, arial, sans-serif;position:fixed;top:50px;right:20px;z-index:10000;font-size:10pt;max-width:180px;","Y p":"margin:0;","Y .notifier-note":"min-width:180px;max-width:250px;border:1px solid #fff;z-index:3000;margin:0;background-color:#8c97af;background-color:rgba(140,151,175,0.9);color:#fff;padding:10px;overflow-wrap:break-word;word-wrap:break-word;-ms-hyphens:auto;-webkit-hyphens:auto;hyphens:auto;","Y .notifier-close":"color:#fff;opacity:0.8;float:right;padding:0 5px;background:none;border:none;font-size:20px;font-weight:bold;line-height:20px;","Y .notifier-close:hover":"color:#444;text-decoration:none;cursor:pointer;"};for(var nt in rt){var at=nt.replace(/^,/," ,").replace(/X/g,".js-plotly-plot .plotly").replace(/Y/g,".plotly-notifier");tt.addStyleRule(at,rt[nt])}},{"../src/lib":778}],2:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/transforms/aggregate")},{"../src/transforms/aggregate":1365}],3:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/bar")},{"../src/traces/bar":929}],4:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/barpolar")},{"../src/traces/barpolar":942}],5:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/box")},{"../src/traces/box":952}],6:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/components/calendars")},{"../src/components/calendars":641}],7:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/candlestick")},{"../src/traces/candlestick":961}],8:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/carpet")},{"../src/traces/carpet":980}],9:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/choropleth")},{"../src/traces/choropleth":994}],10:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/choroplethmapbox")},{"../src/traces/choroplethmapbox":1001}],11:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/cone")},{"../src/traces/cone":1007}],12:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/contour")},{"../src/traces/contour":1022}],13:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/contourcarpet")},{"../src/traces/contourcarpet":1033}],14:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/core")},{"../src/core":755}],15:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/densitymapbox")},{"../src/traces/densitymapbox":1041}],16:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/transforms/filter")},{"../src/transforms/filter":1366}],17:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/funnel")},{"../src/traces/funnel":1051}],18:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/funnelarea")},{"../src/traces/funnelarea":1060}],19:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/transforms/groupby")},{"../src/transforms/groupby":1367}],20:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/heatmap")},{"../src/traces/heatmap":1073}],21:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/heatmapgl")},{"../src/traces/heatmapgl":1083}],22:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/histogram")},{"../src/traces/histogram":1095}],23:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/histogram2d")},{"../src/traces/histogram2d":1101}],24:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/histogram2dcontour")},{"../src/traces/histogram2dcontour":1105}],25:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/image")},{"../src/traces/image":1113}],26:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./core");tt.register([Ne("./bar"),Ne("./box"),Ne("./heatmap"),Ne("./histogram"),Ne("./histogram2d"),Ne("./histogram2dcontour"),Ne("./contour"),Ne("./scatterternary"),Ne("./violin"),Ne("./funnel"),Ne("./waterfall"),Ne("./image"),Ne("./pie"),Ne("./sunburst"),Ne("./treemap"),Ne("./funnelarea"),Ne("./scatter3d"),Ne("./surface"),Ne("./isosurface"),Ne("./volume"),Ne("./mesh3d"),Ne("./cone"),Ne("./streamtube"),Ne("./scattergeo"),Ne("./choropleth"),Ne("./scattergl"),Ne("./splom"),Ne("./pointcloud"),Ne("./heatmapgl"),Ne("./parcoords"),Ne("./parcats"),Ne("./scattermapbox"),Ne("./choroplethmapbox"),Ne("./densitymapbox"),Ne("./sankey"),Ne("./indicator"),Ne("./table"),Ne("./carpet"),Ne("./scattercarpet"),Ne("./contourcarpet"),Ne("./ohlc"),Ne("./candlestick"),Ne("./scatterpolar"),Ne("./scatterpolargl"),Ne("./barpolar")]),tt.register([Ne("./aggregate"),Ne("./filter"),Ne("./groupby"),Ne("./sort")]),tt.register([Ne("./calendars")]),Ge.exports=tt},{"./aggregate":2,"./bar":3,"./barpolar":4,"./box":5,"./calendars":6,"./candlestick":7,"./carpet":8,"./choropleth":9,"./choroplethmapbox":10,"./cone":11,"./contour":12,"./contourcarpet":13,"./core":14,"./densitymapbox":15,"./filter":16,"./funnel":17,"./funnelarea":18,"./groupby":19,"./heatmap":20,"./heatmapgl":21,"./histogram":22,"./histogram2d":23,"./histogram2dcontour":24,"./image":25,"./indicator":27,"./isosurface":28,"./mesh3d":29,"./ohlc":30,"./parcats":31,"./parcoords":32,"./pie":33,"./pointcloud":34,"./sankey":35,"./scatter3d":36,"./scattercarpet":37,"./scattergeo":38,"./scattergl":39,"./scattermapbox":40,"./scatterpolar":41,"./scatterpolargl":42,"./scatterternary":43,"./sort":44,"./splom":45,"./streamtube":46,"./sunburst":47,"./surface":48,"./table":49,"./treemap":50,"./violin":51,"./volume":52,"./waterfall":53}],27:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/indicator")},{"../src/traces/indicator":1121}],28:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/isosurface")},{"../src/traces/isosurface":1127}],29:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/mesh3d")},{"../src/traces/mesh3d":1132}],30:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/ohlc")},{"../src/traces/ohlc":1137}],31:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/parcats")},{"../src/traces/parcats":1146}],32:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/parcoords")},{"../src/traces/parcoords":1156}],33:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/pie")},{"../src/traces/pie":1167}],34:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/pointcloud")},{"../src/traces/pointcloud":1176}],35:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/sankey")},{"../src/traces/sankey":1182}],36:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/scatter3d")},{"../src/traces/scatter3d":1220}],37:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/scattercarpet")},{"../src/traces/scattercarpet":1227}],38:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/scattergeo")},{"../src/traces/scattergeo":1235}],39:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/scattergl")},{"../src/traces/scattergl":1248}],40:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/scattermapbox")},{"../src/traces/scattermapbox":1258}],41:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/scatterpolar")},{"../src/traces/scatterpolar":1266}],42:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/scatterpolargl")},{"../src/traces/scatterpolargl":1273}],43:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/scatterternary")},{"../src/traces/scatterternary":1281}],44:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/transforms/sort")},{"../src/transforms/sort":1369}],45:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/splom")},{"../src/traces/splom":1290}],46:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/streamtube")},{"../src/traces/streamtube":1298}],47:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/sunburst")},{"../src/traces/sunburst":1306}],48:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/surface")},{"../src/traces/surface":1315}],49:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/table")},{"../src/traces/table":1323}],50:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/treemap")},{"../src/traces/treemap":1332}],51:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/violin")},{"../src/traces/violin":1344}],52:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/volume")},{"../src/traces/volume":1352}],53:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("../src/traces/waterfall")},{"../src/traces/waterfall":1360}],54:[function(Ne,Ge,Qe){"use strict";Ge.exports=createViewController;var tt=Ne("turntable-camera-controller"),rt=Ne("orbit-camera-controller"),nt=Ne("matrix-camera-controller");function ViewController(Ne,Ge){this._controllerNames=Object.keys(Ne),this._controllerList=this._controllerNames.map((function(Ge){return Ne[Ge]})),this._mode=Ge,this._active=Ne[Ge],this._active||(this._mode="turntable",this._active=Ne.turntable),this.modes=this._controllerNames,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}var at=ViewController.prototype;function createViewController(Ne){var Ge=(Ne=Ne||{}).eye||[0,0,1],Qe=Ne.center||[0,0,0],at=Ne.up||[0,1,0],it=Ne.distanceLimits||[0,1/0],ot=Ne.mode||"turntable",dt=tt(),ht=rt(),Dt=nt();return dt.setDistanceLimits(it[0],it[1]),dt.lookAt(0,Ge,Qe,at),ht.setDistanceLimits(it[0],it[1]),ht.lookAt(0,Ge,Qe,at),Dt.setDistanceLimits(it[0],it[1]),Dt.lookAt(0,Ge,Qe,at),new ViewController({turntable:dt,orbit:ht,matrix:Dt},ot)}[["flush",1],["idle",1],["lookAt",4],["rotate",4],["pan",4],["translate",4],["setMatrix",2],["setDistanceLimits",2],["setDistance",2]].forEach((function(Ne){for(var Ge=Ne[0],Qe=[],tt=0;tt<Ne[1];++tt)Qe.push("a"+tt);var rt="var cc=this._controllerList;for(var i=0;i<cc.length;++i){cc[i]."+Ne[0]+"("+Qe.join()+")}";at[Ge]=Function.apply(null,Qe.concat(rt))})),at.recalcMatrix=function(Ne){this._active.recalcMatrix(Ne)},at.getDistance=function(Ne){return this._active.getDistance(Ne)},at.getDistanceLimits=function(Ne){return this._active.getDistanceLimits(Ne)},at.lastT=function(){return this._active.lastT()},at.setMode=function(Ne){if(Ne!==this._mode){var Ge=this._controllerNames.indexOf(Ne);if(!(Ge<0)){var Qe=this._active,tt=this._controllerList[Ge],rt=Math.max(Qe.lastT(),tt.lastT());Qe.recalcMatrix(rt),tt.setMatrix(rt,Qe.computedMatrix),this._active=tt,this._mode=Ne,this.computedMatrix=this._active.computedMatrix,this.computedEye=this._active.computedEye,this.computedUp=this._active.computedUp,this.computedCenter=this._active.computedCenter,this.computedRadius=this._active.computedRadius}}},at.getMode=function(){return this._mode}},{"matrix-camera-controller":480,"orbit-camera-controller":501,"turntable-camera-controller":581}],55:[function(Ne,Ge,Qe){var rt,nt;rt=this,nt=function(Ne,Ge,Qe,tt,rt){"use strict";function targetDepth(Ne){return Ne.target.depth}function left(Ne){return Ne.depth}function right(Ne,Ge){return Ge-1-Ne.height}function justify(Ne,Ge){return Ne.sourceLinks.length?Ne.depth:Ge-1}function center(Ne){return Ne.targetLinks.length?Ne.depth:Ne.sourceLinks.length?Ge.min(Ne.sourceLinks,targetDepth)-1:0}function constant(Ne){return function(){return Ne}}rt=rt&&rt.hasOwnProperty("default")?rt.default:rt;var nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(Ne){return typeof Ne}:function(Ne){return Ne&&"function"==typeof Symbol&&Ne.constructor===Symbol&&Ne!==Symbol.prototype?"symbol":typeof Ne};function ascendingSourceBreadth(Ne,Ge){return ascendingBreadth(Ne.source,Ge.source)||Ne.index-Ge.index}function ascendingTargetBreadth(Ne,Ge){return ascendingBreadth(Ne.target,Ge.target)||Ne.index-Ge.index}function ascendingBreadth(Ne,Ge){return Ne.partOfCycle===Ge.partOfCycle?Ne.y0-Ge.y0:"top"===Ne.circularLinkType||"bottom"===Ge.circularLinkType?-1:1}function value(Ne){return Ne.value}function nodeCenter(Ne){return(Ne.y0+Ne.y1)/2}function linkSourceCenter(Ne){return nodeCenter(Ne.source)}function linkTargetCenter(Ne){return nodeCenter(Ne.target)}function defaultId(Ne){return Ne.index}function defaultNodes(Ne){return Ne.nodes}function defaultLinks(Ne){return Ne.links}function find(Ne,Ge){var Qe=Ne.get(Ge);if(!Qe)throw new Error("missing: "+Ge);return Qe}function getNodeID(Ne,Ge){return Ge(Ne)}var at=25,it=10,ot=.3;function sankeyCircular(){var Ne,tt,rt=0,dt=0,ht=1,Dt=1,Ot=24,Rt=defaultId,Zt=justify,er=defaultNodes,dr=defaultLinks,mr=32,xr=2,br=null;function sankeyCircular(){var Ne={nodes:er.apply(null,arguments),links:dr.apply(null,arguments)};computeNodeLinks(Ne),identifyCircles(Ne,Rt,br),computeNodeValues(Ne),computeNodeDepths(Ne),selectCircularLinkTypes(Ne,Rt),computeNodeBreadths(Ne,mr,Rt),computeLinkBreadths(Ne);for(var Ge=4,Qe=0;Qe<Ge;Qe++)sortSourceLinks(Ne,Dt,Rt),sortTargetLinks(Ne,Dt,Rt),resolveNodeLinkOverlaps(Ne,dt,Dt,Rt),sortSourceLinks(Ne,Dt,Rt),sortTargetLinks(Ne,Dt,Rt);return fillHeight(Ne,dt,Dt),addCircularPathData(Ne,xr,Dt,Rt),Ne}function computeNodeLinks(Ne){Ne.nodes.forEach((function(Ne,Ge){Ne.index=Ge,Ne.sourceLinks=[],Ne.targetLinks=[]}));var Ge=Qe.map(Ne.nodes,Rt);return Ne.links.forEach((function(Ne,Qe){Ne.index=Qe;var tt=Ne.source,rt=Ne.target;"object"!==(void 0===tt?"undefined":nt(tt))&&(tt=Ne.source=find(Ge,tt)),"object"!==(void 0===rt?"undefined":nt(rt))&&(rt=Ne.target=find(Ge,rt)),tt.sourceLinks.push(Ne),rt.targetLinks.push(Ne)})),Ne}function computeNodeValues(Ne){Ne.nodes.forEach((function(Ne){Ne.partOfCycle=!1,Ne.value=Math.max(Ge.sum(Ne.sourceLinks,value),Ge.sum(Ne.targetLinks,value)),Ne.sourceLinks.forEach((function(Ge){Ge.circular&&(Ne.partOfCycle=!0,Ne.circularLinkType=Ge.circularLinkType)})),Ne.targetLinks.forEach((function(Ge){Ge.circular&&(Ne.partOfCycle=!0,Ne.circularLinkType=Ge.circularLinkType)}))}))}function getCircleMargins(Ne){var Qe=0,tt=0,rt=0,nt=0,ot=Ge.max(Ne.nodes,(function(Ne){return Ne.column}));return Ne.links.forEach((function(Ne){Ne.circular&&("top"==Ne.circularLinkType?Qe+=Ne.width:tt+=Ne.width,0==Ne.target.column&&(nt+=Ne.width),Ne.source.column==ot&&(rt+=Ne.width))})),{top:Qe=Qe>0?Qe+at+it:Qe,bottom:tt=tt>0?tt+at+it:tt,left:nt=nt>0?nt+at+it:nt,right:rt=rt>0?rt+at+it:rt}}function scaleSankeySize(Ne,Qe){var tt=Ge.max(Ne.nodes,(function(Ne){return Ne.column})),nt=ht-rt,at=Dt-dt,it=nt/(nt+Qe.right+Qe.left),ot=at/(at+Qe.top+Qe.bottom);return rt=rt*it+Qe.left,ht=0==Qe.right?ht:ht*it,dt=dt*ot+Qe.top,Dt*=ot,Ne.nodes.forEach((function(Ne){Ne.x0=rt+Ne.column*((ht-rt-Ot)/tt),Ne.x1=Ne.x0+Ot})),ot}function computeNodeDepths(Ne){var Ge,Qe,tt;for(Ge=Ne.nodes,Qe=[],tt=0;Ge.length;++tt,Ge=Qe,Qe=[])Ge.forEach((function(Ne){Ne.depth=tt,Ne.sourceLinks.forEach((function(Ne){Qe.indexOf(Ne.target)<0&&!Ne.circular&&Qe.push(Ne.target)}))}));for(Ge=Ne.nodes,Qe=[],tt=0;Ge.length;++tt,Ge=Qe,Qe=[])Ge.forEach((function(Ne){Ne.height=tt,Ne.targetLinks.forEach((function(Ne){Qe.indexOf(Ne.source)<0&&!Ne.circular&&Qe.push(Ne.source)}))}));Ne.nodes.forEach((function(Ne){Ne.column=Math.floor(Zt.call(null,Ne,tt))}))}function computeNodeBreadths(rt,nt,at){var it=Qe.nest().key((function(Ne){return Ne.column})).sortKeys(Ge.ascending).entries(rt.nodes).map((function(Ne){return Ne.values}));initializeNodeBreadth(at),resolveCollisions();for(var ht=1,Ot=nt;Ot>0;--Ot)relaxLeftAndRight(ht*=.99,at),resolveCollisions();function initializeNodeBreadth(Qe){if(tt){var nt=1/0;it.forEach((function(Ne){var Ge=Dt*tt/(Ne.length+1);nt=Ge<nt?Ge:nt})),Ne=nt}var at=Ge.min(it,(function(Qe){return(Dt-dt-(Qe.length-1)*Ne)/Ge.sum(Qe,value)}));at*=ot,rt.links.forEach((function(Ne){Ne.width=Ne.value*at}));var ht=getCircleMargins(rt),Ot=scaleSankeySize(rt,ht);at*=Ot,rt.links.forEach((function(Ne){Ne.width=Ne.value*at})),it.forEach((function(Ne){var Ge=Ne.length;Ne.forEach((function(Ne,tt){Ne.depth==it.length-1&&1==Ge||0==Ne.depth&&1==Ge?(Ne.y0=Dt/2-Ne.value*at,Ne.y1=Ne.y0+Ne.value*at):Ne.partOfCycle?0==numberOfNonSelfLinkingCycles(Ne,Qe)?(Ne.y0=Dt/2+tt,Ne.y1=Ne.y0+Ne.value*at):"top"==Ne.circularLinkType?(Ne.y0=dt+tt,Ne.y1=Ne.y0+Ne.value*at):(Ne.y0=Dt-Ne.value*at-tt,Ne.y1=Ne.y0+Ne.value*at):0==ht.top||0==ht.bottom?(Ne.y0=(Dt-dt)/Ge*tt,Ne.y1=Ne.y0+Ne.value*at):(Ne.y0=(Dt-dt)/2-Ge/2+tt,Ne.y1=Ne.y0+Ne.value*at)}))}))}function relaxLeftAndRight(Ne,Qe){var tt=it.length;it.forEach((function(rt){var nt=rt.length,at=rt[0].depth;rt.forEach((function(rt){var it;if(rt.sourceLinks.length||rt.targetLinks.length)if(rt.partOfCycle&&numberOfNonSelfLinkingCycles(rt,Qe)>0);else if(0==at&&1==nt)it=rt.y1-rt.y0,rt.y0=Dt/2-it/2,rt.y1=Dt/2+it/2;else if(at==tt-1&&1==nt)it=rt.y1-rt.y0,rt.y0=Dt/2-it/2,rt.y1=Dt/2+it/2;else{var ot=Ge.mean(rt.sourceLinks,linkTargetCenter),dt=Ge.mean(rt.targetLinks,linkSourceCenter),ht=((ot&&dt?(ot+dt)/2:ot||dt)-nodeCenter(rt))*Ne;rt.y0+=ht,rt.y1+=ht}}))}))}function resolveCollisions(){it.forEach((function(Ge){var Qe,tt,rt,nt=dt,at=Ge.length;for(Ge.sort(ascendingBreadth),rt=0;rt<at;++rt)(tt=nt-(Qe=Ge[rt]).y0)>0&&(Qe.y0+=tt,Qe.y1+=tt),nt=Qe.y1+Ne;if((tt=nt-Ne-Dt)>0)for(nt=Qe.y0-=tt,Qe.y1-=tt,rt=at-2;rt>=0;--rt)(tt=(Qe=Ge[rt]).y1+Ne-nt)>0&&(Qe.y0-=tt,Qe.y1-=tt),nt=Qe.y0}))}}function computeLinkBreadths(Ne){Ne.nodes.forEach((function(Ne){Ne.sourceLinks.sort(ascendingTargetBreadth),Ne.targetLinks.sort(ascendingSourceBreadth)})),Ne.nodes.forEach((function(Ne){var Ge=Ne.y0,Qe=Ge,tt=Ne.y1,rt=tt;Ne.sourceLinks.forEach((function(Ne){Ne.circular?(Ne.y0=tt-Ne.width/2,tt-=Ne.width):(Ne.y0=Ge+Ne.width/2,Ge+=Ne.width)})),Ne.targetLinks.forEach((function(Ne){Ne.circular?(Ne.y1=rt-Ne.width/2,rt-=Ne.width):(Ne.y1=Qe+Ne.width/2,Qe+=Ne.width)}))}))}return sankeyCircular.nodeId=function(Ne){return arguments.length?(Rt="function"==typeof Ne?Ne:constant(Ne),sankeyCircular):Rt},sankeyCircular.nodeAlign=function(Ne){return arguments.length?(Zt="function"==typeof Ne?Ne:constant(Ne),sankeyCircular):Zt},sankeyCircular.nodeWidth=function(Ne){return arguments.length?(Ot=+Ne,sankeyCircular):Ot},sankeyCircular.nodePadding=function(Ge){return arguments.length?(Ne=+Ge,sankeyCircular):Ne},sankeyCircular.nodes=function(Ne){return arguments.length?(er="function"==typeof Ne?Ne:constant(Ne),sankeyCircular):er},sankeyCircular.links=function(Ne){return arguments.length?(dr="function"==typeof Ne?Ne:constant(Ne),sankeyCircular):dr},sankeyCircular.size=function(Ne){return arguments.length?(rt=dt=0,ht=+Ne[0],Dt=+Ne[1],sankeyCircular):[ht-rt,Dt-dt]},sankeyCircular.extent=function(Ne){return arguments.length?(rt=+Ne[0][0],ht=+Ne[1][0],dt=+Ne[0][1],Dt=+Ne[1][1],sankeyCircular):[[rt,dt],[ht,Dt]]},sankeyCircular.iterations=function(Ne){return arguments.length?(mr=+Ne,sankeyCircular):mr},sankeyCircular.circularLinkGap=function(Ne){return arguments.length?(xr=+Ne,sankeyCircular):xr},sankeyCircular.nodePaddingRatio=function(Ne){return arguments.length?(tt=+Ne,sankeyCircular):tt},sankeyCircular.sortNodes=function(Ne){return arguments.length?(br=Ne,sankeyCircular):br},sankeyCircular.update=function(Ne){return selectCircularLinkTypes(Ne,Rt),computeLinkBreadths(Ne),Ne.links.forEach((function(Ne){Ne.circular&&(Ne.circularLinkType=Ne.y0+Ne.y1<Dt?"top":"bottom",Ne.source.circularLinkType=Ne.circularLinkType,Ne.target.circularLinkType=Ne.circularLinkType)})),sortSourceLinks(Ne,Dt,Rt,!1),sortTargetLinks(Ne,Dt,Rt),addCircularPathData(Ne,xr,Dt,Rt),Ne},sankeyCircular}function identifyCircles(Ne,Ge,Qe){var tt=0;if(null===Qe){for(var nt=[],at=0;at<Ne.links.length;at++){var it=Ne.links[at],ot=it.source.index,dt=it.target.index;nt[ot]||(nt[ot]=[]),nt[dt]||(nt[dt]=[]),-1===nt[ot].indexOf(dt)&&nt[ot].push(dt)}var ht=rt(nt);ht.sort((function(Ne,Ge){return Ne.length-Ge.length}));var Dt={};for(at=0;at<ht.length;at++){var Ot=ht[at].slice(-2);Dt[Ot[0]]||(Dt[Ot[0]]={}),Dt[Ot[0]][Ot[1]]=!0}Ne.links.forEach((function(Ne){var Ge=Ne.target.index,Qe=Ne.source.index;Ge===Qe||Dt[Qe]&&Dt[Qe][Ge]?(Ne.circular=!0,Ne.circularLinkID=tt,tt+=1):Ne.circular=!1}))}else Ne.links.forEach((function(Ne){Ne.source[Qe]<Ne.target[Qe]?Ne.circular=!1:(Ne.circular=!0,Ne.circularLinkID=tt,tt+=1)}))}function selectCircularLinkTypes(Ne,Ge){var Qe=0,tt=0;Ne.links.forEach((function(rt){rt.circular&&(rt.source.circularLinkType||rt.target.circularLinkType?rt.circularLinkType=rt.source.circularLinkType?rt.source.circularLinkType:rt.target.circularLinkType:rt.circularLinkType=Qe<tt?"top":"bottom","top"==rt.circularLinkType?Qe+=1:tt+=1,Ne.nodes.forEach((function(Ne){getNodeID(Ne,Ge)!=getNodeID(rt.source,Ge)&&getNodeID(Ne,Ge)!=getNodeID(rt.target,Ge)||(Ne.circularLinkType=rt.circularLinkType)})))})),Ne.links.forEach((function(Ne){Ne.circular&&(Ne.source.circularLinkType==Ne.target.circularLinkType&&(Ne.circularLinkType=Ne.source.circularLinkType),selfLinking(Ne,Ge)&&(Ne.circularLinkType=Ne.source.circularLinkType))}))}function linkAngle(Ne){var Ge=Math.abs(Ne.y1-Ne.y0),Qe=Math.abs(Ne.target.x0-Ne.source.x1);return Math.atan(Qe/Ge)}function circularLinksCross(Ne,Ge){return!(Ne.source.column<Ge.target.column||Ne.target.column>Ge.source.column)}function numberOfNonSelfLinkingCycles(Ne,Ge){var Qe=0;Ne.sourceLinks.forEach((function(Ne){Qe=Ne.circular&&!selfLinking(Ne,Ge)?Qe+1:Qe}));var tt=0;return Ne.targetLinks.forEach((function(Ne){tt=Ne.circular&&!selfLinking(Ne,Ge)?tt+1:tt})),Qe+tt}function onlyCircularLink(Ne){var Ge=Ne.source.sourceLinks,Qe=0;Ge.forEach((function(Ne){Qe=Ne.circular?Qe+1:Qe}));var tt=Ne.target.targetLinks,rt=0;return tt.forEach((function(Ne){rt=Ne.circular?rt+1:rt})),!(Qe>1||rt>1)}function calcVerticalBuffer(Ne,Ge,Qe){return Ne.sort(sortLinkColumnAscending),Ne.forEach((function(tt,rt){var nt=0;if(selfLinking(tt,Qe)&&onlyCircularLink(tt))tt.circularPathData.verticalBuffer=nt+tt.width/2;else{for(var at=0;at<rt;at++)if(circularLinksCross(Ne[rt],Ne[at])){var it=Ne[at].circularPathData.verticalBuffer+Ne[at].width/2+Ge;nt=it>nt?it:nt}tt.circularPathData.verticalBuffer=nt+tt.width/2}})),Ne}function addCircularPathData(Ne,Qe,rt,nt){var ot=5,dt=Ge.min(Ne.links,(function(Ne){return Ne.source.y0}));Ne.links.forEach((function(Ne){Ne.circular&&(Ne.circularPathData={})})),calcVerticalBuffer(Ne.links.filter((function(Ne){return"top"==Ne.circularLinkType})),Qe,nt),calcVerticalBuffer(Ne.links.filter((function(Ne){return"bottom"==Ne.circularLinkType})),Qe,nt),Ne.links.forEach((function(Ge){if(Ge.circular){if(Ge.circularPathData.arcRadius=Ge.width+it,Ge.circularPathData.leftNodeBuffer=ot,Ge.circularPathData.rightNodeBuffer=ot,Ge.circularPathData.sourceWidth=Ge.source.x1-Ge.source.x0,Ge.circularPathData.sourceX=Ge.source.x0+Ge.circularPathData.sourceWidth,Ge.circularPathData.targetX=Ge.target.x0,Ge.circularPathData.sourceY=Ge.y0,Ge.circularPathData.targetY=Ge.y1,selfLinking(Ge,nt)&&onlyCircularLink(Ge))Ge.circularPathData.leftSmallArcRadius=it+Ge.width/2,Ge.circularPathData.leftLargeArcRadius=it+Ge.width/2,Ge.circularPathData.rightSmallArcRadius=it+Ge.width/2,Ge.circularPathData.rightLargeArcRadius=it+Ge.width/2,"bottom"==Ge.circularLinkType?(Ge.circularPathData.verticalFullExtent=Ge.source.y1+at+Ge.circularPathData.verticalBuffer,Ge.circularPathData.verticalLeftInnerExtent=Ge.circularPathData.verticalFullExtent-Ge.circularPathData.leftLargeArcRadius,Ge.circularPathData.verticalRightInnerExtent=Ge.circularPathData.verticalFullExtent-Ge.circularPathData.rightLargeArcRadius):(Ge.circularPathData.verticalFullExtent=Ge.source.y0-at-Ge.circularPathData.verticalBuffer,Ge.circularPathData.verticalLeftInnerExtent=Ge.circularPathData.verticalFullExtent+Ge.circularPathData.leftLargeArcRadius,Ge.circularPathData.verticalRightInnerExtent=Ge.circularPathData.verticalFullExtent+Ge.circularPathData.rightLargeArcRadius);else{var ht=Ge.source.column,Dt=Ge.circularLinkType,Ot=Ne.links.filter((function(Ne){return Ne.source.column==ht&&Ne.circularLinkType==Dt}));"bottom"==Ge.circularLinkType?Ot.sort(sortLinkSourceYDescending):Ot.sort(sortLinkSourceYAscending);var Rt=0;Ot.forEach((function(Ne,tt){Ne.circularLinkID==Ge.circularLinkID&&(Ge.circularPathData.leftSmallArcRadius=it+Ge.width/2+Rt,Ge.circularPathData.leftLargeArcRadius=it+Ge.width/2+tt*Qe+Rt),Rt+=Ne.width})),ht=Ge.target.column,Ot=Ne.links.filter((function(Ne){return Ne.target.column==ht&&Ne.circularLinkType==Dt})),"bottom"==Ge.circularLinkType?Ot.sort(sortLinkTargetYDescending):Ot.sort(sortLinkTargetYAscending),Rt=0,Ot.forEach((function(Ne,tt){Ne.circularLinkID==Ge.circularLinkID&&(Ge.circularPathData.rightSmallArcRadius=it+Ge.width/2+Rt,Ge.circularPathData.rightLargeArcRadius=it+Ge.width/2+tt*Qe+Rt),Rt+=Ne.width})),"bottom"==Ge.circularLinkType?(Ge.circularPathData.verticalFullExtent=Math.max(rt,Ge.source.y1,Ge.target.y1)+at+Ge.circularPathData.verticalBuffer,Ge.circularPathData.verticalLeftInnerExtent=Ge.circularPathData.verticalFullExtent-Ge.circularPathData.leftLargeArcRadius,Ge.circularPathData.verticalRightInnerExtent=Ge.circularPathData.verticalFullExtent-Ge.circularPathData.rightLargeArcRadius):(Ge.circularPathData.verticalFullExtent=dt-at-Ge.circularPathData.verticalBuffer,Ge.circularPathData.verticalLeftInnerExtent=Ge.circularPathData.verticalFullExtent+Ge.circularPathData.leftLargeArcRadius,Ge.circularPathData.verticalRightInnerExtent=Ge.circularPathData.verticalFullExtent+Ge.circularPathData.rightLargeArcRadius)}Ge.circularPathData.leftInnerExtent=Ge.circularPathData.sourceX+Ge.circularPathData.leftNodeBuffer,Ge.circularPathData.rightInnerExtent=Ge.circularPathData.targetX-Ge.circularPathData.rightNodeBuffer,Ge.circularPathData.leftFullExtent=Ge.circularPathData.sourceX+Ge.circularPathData.leftLargeArcRadius+Ge.circularPathData.leftNodeBuffer,Ge.circularPathData.rightFullExtent=Ge.circularPathData.targetX-Ge.circularPathData.rightLargeArcRadius-Ge.circularPathData.rightNodeBuffer}if(Ge.circular)Ge.path=createCircularPathString(Ge);else{var Zt=tt.linkHorizontal().source((function(Ne){return[Ne.source.x0+(Ne.source.x1-Ne.source.x0),Ne.y0]})).target((function(Ne){return[Ne.target.x0,Ne.y1]}));Ge.path=Zt(Ge)}}))}function createCircularPathString(Ne){return"top"==Ne.circularLinkType?"M"+Ne.circularPathData.sourceX+" "+Ne.circularPathData.sourceY+" L"+Ne.circularPathData.leftInnerExtent+" "+Ne.circularPathData.sourceY+" A"+Ne.circularPathData.leftLargeArcRadius+" "+Ne.circularPathData.leftSmallArcRadius+" 0 0 0 "+Ne.circularPathData.leftFullExtent+" "+(Ne.circularPathData.sourceY-Ne.circularPathData.leftSmallArcRadius)+" L"+Ne.circularPathData.leftFullExtent+" "+Ne.circularPathData.verticalLeftInnerExtent+" A"+Ne.circularPathData.leftLargeArcRadius+" "+Ne.circularPathData.leftLargeArcRadius+" 0 0 0 "+Ne.circularPathData.leftInnerExtent+" "+Ne.circularPathData.verticalFullExtent+" L"+Ne.circularPathData.rightInnerExtent+" "+Ne.circularPathData.verticalFullExtent+" A"+Ne.circularPathData.rightLargeArcRadius+" "+Ne.circularPathData.rightLargeArcRadius+" 0 0 0 "+Ne.circularPathData.rightFullExtent+" "+Ne.circularPathData.verticalRightInnerExtent+" L"+Ne.circularPathData.rightFullExtent+" "+(Ne.circularPathData.targetY-Ne.circularPathData.rightSmallArcRadius)+" A"+Ne.circularPathData.rightLargeArcRadius+" "+Ne.circularPathData.rightSmallArcRadius+" 0 0 0 "+Ne.circularPathData.rightInnerExtent+" "+Ne.circularPathData.targetY+" L"+Ne.circularPathData.targetX+" "+Ne.circularPathData.targetY:"M"+Ne.circularPathData.sourceX+" "+Ne.circularPathData.sourceY+" L"+Ne.circularPathData.leftInnerExtent+" "+Ne.circularPathData.sourceY+" A"+Ne.circularPathData.leftLargeArcRadius+" "+Ne.circularPathData.leftSmallArcRadius+" 0 0 1 "+Ne.circularPathData.leftFullExtent+" "+(Ne.circularPathData.sourceY+Ne.circularPathData.leftSmallArcRadius)+" L"+Ne.circularPathData.leftFullExtent+" "+Ne.circularPathData.verticalLeftInnerExtent+" A"+Ne.circularPathData.leftLargeArcRadius+" "+Ne.circularPathData.leftLargeArcRadius+" 0 0 1 "+Ne.circularPathData.leftInnerExtent+" "+Ne.circularPathData.verticalFullExtent+" L"+Ne.circularPathData.rightInnerExtent+" "+Ne.circularPathData.verticalFullExtent+" A"+Ne.circularPathData.rightLargeArcRadius+" "+Ne.circularPathData.rightLargeArcRadius+" 0 0 1 "+Ne.circularPathData.rightFullExtent+" "+Ne.circularPathData.verticalRightInnerExtent+" L"+Ne.circularPathData.rightFullExtent+" "+(Ne.circularPathData.targetY+Ne.circularPathData.rightSmallArcRadius)+" A"+Ne.circularPathData.rightLargeArcRadius+" "+Ne.circularPathData.rightSmallArcRadius+" 0 0 1 "+Ne.circularPathData.rightInnerExtent+" "+Ne.circularPathData.targetY+" L"+Ne.circularPathData.targetX+" "+Ne.circularPathData.targetY}function sortLinkColumnAscending(Ne,Ge){return linkColumnDistance(Ne)==linkColumnDistance(Ge)?"bottom"==Ne.circularLinkType?sortLinkSourceYDescending(Ne,Ge):sortLinkSourceYAscending(Ne,Ge):linkColumnDistance(Ge)-linkColumnDistance(Ne)}function sortLinkSourceYAscending(Ne,Ge){return Ne.y0-Ge.y0}function sortLinkSourceYDescending(Ne,Ge){return Ge.y0-Ne.y0}function sortLinkTargetYAscending(Ne,Ge){return Ne.y1-Ge.y1}function sortLinkTargetYDescending(Ne,Ge){return Ge.y1-Ne.y1}function linkColumnDistance(Ne){return Ne.target.column-Ne.source.column}function linkXLength(Ne){return Ne.target.x0-Ne.source.x1}function linkPerpendicularYToLinkSource(Ne,Ge){var Qe=linkAngle(Ne),tt=linkXLength(Ge)/Math.tan(Qe);return"up"==incline(Ne)?Ne.y1+tt:Ne.y1-tt}function linkPerpendicularYToLinkTarget(Ne,Ge){var Qe=linkAngle(Ne),tt=linkXLength(Ge)/Math.tan(Qe);return"up"==incline(Ne)?Ne.y1-tt:Ne.y1+tt}function resolveNodeLinkOverlaps(Ne,Ge,Qe,tt){Ne.links.forEach((function(rt){if(!rt.circular&&rt.target.column-rt.source.column>1){var nt=rt.source.column+1,at=rt.target.column-1,it=1,ot=at-nt+1;for(it=1;nt<=at;nt++,it++)Ne.nodes.forEach((function(at){if(at.column==nt){var dt,ht=it/(ot+1),Dt=Math.pow(1-ht,3),Ot=3*ht*Math.pow(1-ht,2),Rt=3*Math.pow(ht,2)*(1-ht),Zt=Math.pow(ht,3),er=Dt*rt.y0+Ot*rt.y0+Rt*rt.y1+Zt*rt.y1,dr=er-rt.width/2,mr=er+rt.width/2;dr>at.y0&&dr<at.y1?(dt=at.y1-dr+10,dt="bottom"==at.circularLinkType?dt:-dt,at=adjustNodeHeight(at,dt,Ge,Qe),Ne.nodes.forEach((function(Ne){getNodeID(Ne,tt)!=getNodeID(at,tt)&&Ne.column==at.column&&nodesOverlap(at,Ne)&&adjustNodeHeight(Ne,dt,Ge,Qe)}))):(mr>at.y0&&mr<at.y1||dr<at.y0&&mr>at.y1)&&(dt=mr-at.y0+10,at=adjustNodeHeight(at,dt,Ge,Qe),Ne.nodes.forEach((function(Ne){getNodeID(Ne,tt)!=getNodeID(at,tt)&&Ne.column==at.column&&Ne.y0<at.y1&&Ne.y1>at.y1&&adjustNodeHeight(Ne,dt,Ge,Qe)})))}}))}}))}function nodesOverlap(Ne,Ge){return Ne.y0>Ge.y0&&Ne.y0<Ge.y1||Ne.y1>Ge.y0&&Ne.y1<Ge.y1||Ne.y0<Ge.y0&&Ne.y1>Ge.y1}function adjustNodeHeight(Ne,Ge,Qe,tt){return Ne.y0+Ge>=Qe&&Ne.y1+Ge<=tt&&(Ne.y0=Ne.y0+Ge,Ne.y1=Ne.y1+Ge,Ne.targetLinks.forEach((function(Ne){Ne.y1=Ne.y1+Ge})),Ne.sourceLinks.forEach((function(Ne){Ne.y0=Ne.y0+Ge}))),Ne}function sortSourceLinks(Ne,Ge,Qe,tt){Ne.nodes.forEach((function(rt){tt&&rt.y+(rt.y1-rt.y0)>Ge&&(rt.y=rt.y-(rt.y+(rt.y1-rt.y0)-Ge));var nt=Ne.links.filter((function(Ne){return getNodeID(Ne.source,Qe)==getNodeID(rt,Qe)})),at=nt.length;at>1&&nt.sort((function(Ne,Ge){if(!Ne.circular&&!Ge.circular){if(Ne.target.column==Ge.target.column)return Ne.y1-Ge.y1;if(!sameInclines(Ne,Ge))return Ne.y1-Ge.y1;if(Ne.target.column>Ge.target.column){var Qe=linkPerpendicularYToLinkTarget(Ge,Ne);return Ne.y1-Qe}if(Ge.target.column>Ne.target.column)return linkPerpendicularYToLinkTarget(Ne,Ge)-Ge.y1}return Ne.circular&&!Ge.circular?"top"==Ne.circularLinkType?-1:1:Ge.circular&&!Ne.circular?"top"==Ge.circularLinkType?1:-1:Ne.circular&&Ge.circular?Ne.circularLinkType===Ge.circularLinkType&&"top"==Ne.circularLinkType?Ne.target.column===Ge.target.column?Ne.target.y1-Ge.target.y1:Ge.target.column-Ne.target.column:Ne.circularLinkType===Ge.circularLinkType&&"bottom"==Ne.circularLinkType?Ne.target.column===Ge.target.column?Ge.target.y1-Ne.target.y1:Ne.target.column-Ge.target.column:"top"==Ne.circularLinkType?-1:1:void 0}));var it=rt.y0;nt.forEach((function(Ne){Ne.y0=it+Ne.width/2,it+=Ne.width})),nt.forEach((function(Ne,Ge){if("bottom"==Ne.circularLinkType){for(var Qe=Ge+1,tt=0;Qe<at;Qe++)tt+=nt[Qe].width;Ne.y0=rt.y1-tt-Ne.width/2}}))}))}function sortTargetLinks(Ne,Ge,Qe){Ne.nodes.forEach((function(Ge){var tt=Ne.links.filter((function(Ne){return getNodeID(Ne.target,Qe)==getNodeID(Ge,Qe)})),rt=tt.length;rt>1&&tt.sort((function(Ne,Ge){if(!Ne.circular&&!Ge.circular){if(Ne.source.column==Ge.source.column)return Ne.y0-Ge.y0;if(!sameInclines(Ne,Ge))return Ne.y0-Ge.y0;if(Ge.source.column<Ne.source.column){var Qe=linkPerpendicularYToLinkSource(Ge,Ne);return Ne.y0-Qe}if(Ne.source.column<Ge.source.column)return linkPerpendicularYToLinkSource(Ne,Ge)-Ge.y0}return Ne.circular&&!Ge.circular?"top"==Ne.circularLinkType?-1:1:Ge.circular&&!Ne.circular?"top"==Ge.circularLinkType?1:-1:Ne.circular&&Ge.circular?Ne.circularLinkType===Ge.circularLinkType&&"top"==Ne.circularLinkType?Ne.source.column===Ge.source.column?Ne.source.y1-Ge.source.y1:Ne.source.column-Ge.source.column:Ne.circularLinkType===Ge.circularLinkType&&"bottom"==Ne.circularLinkType?Ne.source.column===Ge.source.column?Ne.source.y1-Ge.source.y1:Ge.source.column-Ne.source.column:"top"==Ne.circularLinkType?-1:1:void 0}));var nt=Ge.y0;tt.forEach((function(Ne){Ne.y1=nt+Ne.width/2,nt+=Ne.width})),tt.forEach((function(Ne,Qe){if("bottom"==Ne.circularLinkType){for(var nt=Qe+1,at=0;nt<rt;nt++)at+=tt[nt].width;Ne.y1=Ge.y1-at-Ne.width/2}}))}))}function sameInclines(Ne,Ge){return incline(Ne)==incline(Ge)}function incline(Ne){return Ne.y0-Ne.y1>0?"up":"down"}function selfLinking(Ne,Ge){return getNodeID(Ne.source,Ge)==getNodeID(Ne.target,Ge)}function fillHeight(Ne,Qe,tt){var rt=Ne.nodes,nt=Ne.links,at=!1,it=!1;if(nt.forEach((function(Ne){"top"==Ne.circularLinkType?at=!0:"bottom"==Ne.circularLinkType&&(it=!0)})),0==at||0==it){var ot=Ge.min(rt,(function(Ne){return Ne.y0})),dt=(tt-Qe)/(Ge.max(rt,(function(Ne){return Ne.y1}))-ot);rt.forEach((function(Ne){var Ge=(Ne.y1-Ne.y0)*dt;Ne.y0=(Ne.y0-ot)*dt,Ne.y1=Ne.y0+Ge})),nt.forEach((function(Ne){Ne.y0=(Ne.y0-ot)*dt,Ne.y1=(Ne.y1-ot)*dt,Ne.width=Ne.width*dt}))}}Ne.sankeyCircular=sankeyCircular,Ne.sankeyCenter=center,Ne.sankeyLeft=left,Ne.sankeyRight=right,Ne.sankeyJustify=justify,Object.defineProperty(Ne,"__esModule",{value:!0})},"object"==typeof Qe&&void 0!==Ge?nt(Qe,Ne("d3-array"),Ne("d3-collection"),Ne("d3-shape"),Ne("elementary-circuits-directed-graph")):"function"==typeof tt&&tt.amd?tt(["exports","d3-array","d3-collection","d3-shape","elementary-circuits-directed-graph"],nt):nt(rt.d3=rt.d3||{},rt.d3,rt.d3,rt.d3,null)},{"d3-array":156,"d3-collection":157,"d3-shape":165,"elementary-circuits-directed-graph":179}],56:[function(Ne,Ge,Qe){var rt,nt;rt=this,nt=function(Ne,Ge,Qe,tt){"use strict";function targetDepth(Ne){return Ne.target.depth}function left(Ne){return Ne.depth}function right(Ne,Ge){return Ge-1-Ne.height}function justify(Ne,Ge){return Ne.sourceLinks.length?Ne.depth:Ge-1}function center(Ne){return Ne.targetLinks.length?Ne.depth:Ne.sourceLinks.length?Ge.min(Ne.sourceLinks,targetDepth)-1:0}function constant(Ne){return function(){return Ne}}function ascendingSourceBreadth(Ne,Ge){return ascendingBreadth(Ne.source,Ge.source)||Ne.index-Ge.index}function ascendingTargetBreadth(Ne,Ge){return ascendingBreadth(Ne.target,Ge.target)||Ne.index-Ge.index}function ascendingBreadth(Ne,Ge){return Ne.y0-Ge.y0}function value(Ne){return Ne.value}function nodeCenter(Ne){return(Ne.y0+Ne.y1)/2}function weightedSource(Ne){return nodeCenter(Ne.source)*Ne.value}function weightedTarget(Ne){return nodeCenter(Ne.target)*Ne.value}function defaultId(Ne){return Ne.index}function defaultNodes(Ne){return Ne.nodes}function defaultLinks(Ne){return Ne.links}function find(Ne,Ge){var Qe=Ne.get(Ge);if(!Qe)throw new Error("missing: "+Ge);return Qe}var sankey=function(){var Ne=0,tt=0,rt=1,nt=1,at=24,it=8,ot=defaultId,dt=justify,ht=defaultNodes,Dt=defaultLinks,Ot=32,Rt=2/3;function sankey(){var Ne={nodes:ht.apply(null,arguments),links:Dt.apply(null,arguments)};return computeNodeLinks(Ne),computeNodeValues(Ne),computeNodeDepths(Ne),computeNodeBreadths(Ne,Ot),computeLinkBreadths(Ne),Ne}function computeNodeLinks(Ne){Ne.nodes.forEach((function(Ne,Ge){Ne.index=Ge,Ne.sourceLinks=[],Ne.targetLinks=[]}));var Ge=Qe.map(Ne.nodes,ot);Ne.links.forEach((function(Ne,Qe){Ne.index=Qe;var tt=Ne.source,rt=Ne.target;"object"!=typeof tt&&(tt=Ne.source=find(Ge,tt)),"object"!=typeof rt&&(rt=Ne.target=find(Ge,rt)),tt.sourceLinks.push(Ne),rt.targetLinks.push(Ne)}))}function computeNodeValues(Ne){Ne.nodes.forEach((function(Ne){Ne.value=Math.max(Ge.sum(Ne.sourceLinks,value),Ge.sum(Ne.targetLinks,value))}))}function computeNodeDepths(Ge){var Qe,tt,nt;for(Qe=Ge.nodes,tt=[],nt=0;Qe.length;++nt,Qe=tt,tt=[])Qe.forEach((function(Ne){Ne.depth=nt,Ne.sourceLinks.forEach((function(Ne){tt.indexOf(Ne.target)<0&&tt.push(Ne.target)}))}));for(Qe=Ge.nodes,tt=[],nt=0;Qe.length;++nt,Qe=tt,tt=[])Qe.forEach((function(Ne){Ne.height=nt,Ne.targetLinks.forEach((function(Ne){tt.indexOf(Ne.source)<0&&tt.push(Ne.source)}))}));var it=(rt-Ne-at)/(nt-1);Ge.nodes.forEach((function(Ge){Ge.x1=(Ge.x0=Ne+Math.max(0,Math.min(nt-1,Math.floor(dt.call(null,Ge,nt))))*it)+at}))}function computeNodeBreadths(Ne){var rt=Qe.nest().key((function(Ne){return Ne.x0})).sortKeys(Ge.ascending).entries(Ne.nodes).map((function(Ne){return Ne.values}));initializeNodeBreadth(),resolveCollisions();for(var at=1,ot=Ot;ot>0;--ot)relaxRightToLeft(at*=.99),resolveCollisions(),relaxLeftToRight(at),resolveCollisions();function initializeNodeBreadth(){var Qe=Ge.max(rt,(function(Ne){return Ne.length})),at=Rt*(nt-tt)/(Qe-1);it>at&&(it=at);var ot=Ge.min(rt,(function(Ne){return(nt-tt-(Ne.length-1)*it)/Ge.sum(Ne,value)}));rt.forEach((function(Ne){Ne.forEach((function(Ne,Ge){Ne.y1=(Ne.y0=Ge)+Ne.value*ot}))})),Ne.links.forEach((function(Ne){Ne.width=Ne.value*ot}))}function relaxLeftToRight(Ne){rt.forEach((function(Qe){Qe.forEach((function(Qe){if(Qe.targetLinks.length){var tt=(Ge.sum(Qe.targetLinks,weightedSource)/Ge.sum(Qe.targetLinks,value)-nodeCenter(Qe))*Ne;Qe.y0+=tt,Qe.y1+=tt}}))}))}function relaxRightToLeft(Ne){rt.slice().reverse().forEach((function(Qe){Qe.forEach((function(Qe){if(Qe.sourceLinks.length){var tt=(Ge.sum(Qe.sourceLinks,weightedTarget)/Ge.sum(Qe.sourceLinks,value)-nodeCenter(Qe))*Ne;Qe.y0+=tt,Qe.y1+=tt}}))}))}function resolveCollisions(){rt.forEach((function(Ne){var Ge,Qe,rt,at=tt,ot=Ne.length;for(Ne.sort(ascendingBreadth),rt=0;rt<ot;++rt)(Qe=at-(Ge=Ne[rt]).y0)>0&&(Ge.y0+=Qe,Ge.y1+=Qe),at=Ge.y1+it;if((Qe=at-it-nt)>0)for(at=Ge.y0-=Qe,Ge.y1-=Qe,rt=ot-2;rt>=0;--rt)(Qe=(Ge=Ne[rt]).y1+it-at)>0&&(Ge.y0-=Qe,Ge.y1-=Qe),at=Ge.y0}))}}function computeLinkBreadths(Ne){Ne.nodes.forEach((function(Ne){Ne.sourceLinks.sort(ascendingTargetBreadth),Ne.targetLinks.sort(ascendingSourceBreadth)})),Ne.nodes.forEach((function(Ne){var Ge=Ne.y0,Qe=Ge;Ne.sourceLinks.forEach((function(Ne){Ne.y0=Ge+Ne.width/2,Ge+=Ne.width})),Ne.targetLinks.forEach((function(Ne){Ne.y1=Qe+Ne.width/2,Qe+=Ne.width}))}))}return sankey.update=function(Ne){return computeLinkBreadths(Ne),Ne},sankey.nodeId=function(Ne){return arguments.length?(ot="function"==typeof Ne?Ne:constant(Ne),sankey):ot},sankey.nodeAlign=function(Ne){return arguments.length?(dt="function"==typeof Ne?Ne:constant(Ne),sankey):dt},sankey.nodeWidth=function(Ne){return arguments.length?(at=+Ne,sankey):at},sankey.nodePadding=function(Ne){return arguments.length?(it=+Ne,sankey):it},sankey.nodes=function(Ne){return arguments.length?(ht="function"==typeof Ne?Ne:constant(Ne),sankey):ht},sankey.links=function(Ne){return arguments.length?(Dt="function"==typeof Ne?Ne:constant(Ne),sankey):Dt},sankey.size=function(Ge){return arguments.length?(Ne=tt=0,rt=+Ge[0],nt=+Ge[1],sankey):[rt-Ne,nt-tt]},sankey.extent=function(Ge){return arguments.length?(Ne=+Ge[0][0],rt=+Ge[1][0],tt=+Ge[0][1],nt=+Ge[1][1],sankey):[[Ne,tt],[rt,nt]]},sankey.iterations=function(Ne){return arguments.length?(Ot=+Ne,sankey):Ot},sankey};function horizontalSource(Ne){return[Ne.source.x1,Ne.y0]}function horizontalTarget(Ne){return[Ne.target.x0,Ne.y1]}var sankeyLinkHorizontal=function(){return tt.linkHorizontal().source(horizontalSource).target(horizontalTarget)};Ne.sankey=sankey,Ne.sankeyCenter=center,Ne.sankeyLeft=left,Ne.sankeyRight=right,Ne.sankeyJustify=justify,Ne.sankeyLinkHorizontal=sankeyLinkHorizontal,Object.defineProperty(Ne,"__esModule",{value:!0})},"object"==typeof Qe&&void 0!==Ge?nt(Qe,Ne("d3-array"),Ne("d3-collection"),Ne("d3-shape")):"function"==typeof tt&&tt.amd?tt(["exports","d3-array","d3-collection","d3-shape"],nt):nt(rt.d3=rt.d3||{},rt.d3,rt.d3,rt.d3)},{"d3-array":156,"d3-collection":157,"d3-shape":165}],57:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("./quad")},{"./quad":58}],58:[function(Ne,Ge,Qe){"use strict";var tt=Ne("binary-search-bounds"),rt=Ne("clamp"),nt=Ne("parse-rect"),at=Ne("array-bounds"),it=Ne("pick-by-alias"),ot=Ne("defined"),dt=Ne("flatten-vertex-data"),ht=Ne("is-obj"),Dt=Ne("dtype"),Ot=Ne("math-log2"),Rt=1073741824;function normalize(Ne,Ge){for(var Qe=Ge[0],tt=Ge[1],nt=1/(Ge[2]-Qe),at=1/(Ge[3]-tt),it=new Array(Ne.length),ot=0,dt=Ne.length/2;ot<dt;ot++)it[2*ot]=rt((Ne[2*ot]-Qe)*nt,0,1),it[2*ot+1]=rt((Ne[2*ot+1]-tt)*at,0,1);return it}Ge.exports=function(Ne,Ge){Ge||(Ge={}),Ne=dt(Ne,"float64"),Ge=it(Ge,{bounds:"range bounds dataBox databox",maxDepth:"depth maxDepth maxdepth level maxLevel maxlevel levels",dtype:"type dtype format out dst output destination"});var Qe=ot(Ge.maxDepth,255),rt=ot(Ge.bounds,at(Ne,2));rt[0]===rt[2]&&rt[2]++,rt[1]===rt[3]&&rt[3]++;var Zt,er=normalize(Ne,rt),dr=Ne.length>>>1;Ge.dtype||(Ge.dtype="array"),"string"==typeof Ge.dtype?Zt=new(Dt(Ge.dtype))(dr):Ge.dtype&&(Zt=Ge.dtype,Array.isArray(Zt)&&(Zt.length=dr));for(var mr=0;mr<dr;++mr)Zt[mr]=mr;var xr=[],br=[],Ar=[],en=[];sort(0,0,1,Zt,0,1);for(var mn=0,xn=0;xn<xr.length;xn++){var kn=xr[xn];if(Zt.set)Zt.set(kn,mn);else for(var Cn=0,En=kn.length;Cn<En;Cn++)Zt[Cn+mn]=kn[Cn];var Pn=mn+xr[xn].length;en[xn]=[mn,Pn],mn=Pn}return Zt.range=range,Zt;function sort(Ne,Ge,tt,rt,nt,at){if(!rt.length)return null;var it=xr[nt]||(xr[nt]=[]),ot=Ar[nt]||(Ar[nt]=[]),dt=br[nt]||(br[nt]=[]),ht=it.length;if(++nt>Qe||at>Rt){for(var Dt=0;Dt<rt.length;Dt++)it.push(rt[Dt]),ot.push(at),dt.push(null,null,null,null);return ht}if(it.push(rt[0]),ot.push(at),rt.length<=1)return dt.push(null,null,null,null),ht;for(var Ot=.5*tt,Zt=Ne+Ot,dr=Ge+Ot,mr=[],en=[],mn=[],xn=[],kn=1,Cn=rt.length;kn<Cn;kn++){var En=rt[kn],Pn=er[2*En],Dn=er[2*En+1];Pn<Zt?Dn<dr?mr.push(En):en.push(En):Dn<dr?mn.push(En):xn.push(En)}return at<<=2,dt.push(sort(Ne,Ge,Ot,mr,nt,at),sort(Ne,dr,Ot,en,nt,at+1),sort(Zt,Ge,Ot,mn,nt,at+2),sort(Zt,dr,Ot,xn,nt,at+3)),ht}function range(){for(var Ge,Qe=[],tt=arguments.length;tt--;)Qe[tt]=arguments[tt];if(ht(Qe[Qe.length-1])){var at=Qe.pop();Qe.length||null==at.x&&null==at.l&&null==at.left||(Qe=[at],Ge={}),Ge=it(at,{level:"level maxLevel",d:"d diam diameter r radius px pxSize pixel pixelSize maxD size minSize",lod:"lod details ranges offsets"})}else Ge={};Qe.length||(Qe=rt);var dt,Dt=nt.apply(void 0,Qe),Rt=[Math.min(Dt.x,Dt.x+Dt.width),Math.min(Dt.y,Dt.y+Dt.height),Math.max(Dt.x,Dt.x+Dt.width),Math.max(Dt.y,Dt.y+Dt.height)],Zt=Rt[0],er=Rt[1],dr=Rt[2],mr=Rt[3],Ar=normalize([Zt,er,dr,mr],rt),en=Ar[0],mn=Ar[1],xn=Ar[2],kn=Ar[3],Cn=ot(Ge.level,xr.length);if(null!=Ge.d&&("number"==typeof Ge.d?dt=[Ge.d,Ge.d]:Ge.d.length&&(dt=Ge.d),Cn=Math.min(Math.max(Math.ceil(-Ot(Math.abs(dt[0])/(rt[2]-rt[0]))),Math.ceil(-Ot(Math.abs(dt[1])/(rt[3]-rt[1])))),Cn)),Cn=Math.min(Cn,xr.length),Ge.lod)return lod(en,mn,xn,kn,Cn);var En=[];function select(Ge,Qe,tt,rt,nt,at){if(null!==nt&&null!==at&&!(en>Ge+tt||mn>Qe+tt||xn<Ge||kn<Qe||rt>=Cn||nt===at)){var it=xr[rt];void 0===at&&(at=it.length);for(var ot=nt;ot<at;ot++){var dt=it[ot],ht=Ne[2*dt],Dt=Ne[2*dt+1];ht>=Zt&&ht<=dr&&Dt>=er&&Dt<=mr&&En.push(dt)}var Ot=br[rt],Rt=Ot[4*nt+0],Ar=Ot[4*nt+1],Pn=Ot[4*nt+2],Dn=Ot[4*nt+3],In=nextOffset(Ot,nt+1),zn=.5*tt,Bn=rt+1;select(Ge,Qe,zn,Bn,Rt,Ar||Pn||Dn||In),select(Ge,Qe+zn,zn,Bn,Ar,Pn||Dn||In),select(Ge+zn,Qe,zn,Bn,Pn,Dn||In),select(Ge+zn,Qe+zn,zn,Bn,Dn,In)}}function nextOffset(Ne,Ge){for(var Qe=null,tt=0;null===Qe;)if(Qe=Ne[4*Ge+tt],++tt>Ne.length)return null;return Qe}return select(0,0,1,0,0,1),En}function lod(Ne,Ge,Qe,rt,nt){for(var at=[],it=0;it<nt;it++){var ot=Ar[it],dt=en[it][0],ht=group(Ne,Ge,it),Dt=group(Qe,rt,it),Ot=tt.ge(ot,ht),Rt=tt.gt(ot,Dt,Ot,ot.length-1);at[it]=[Ot+dt,Rt+dt]}return at}function group(Ne,Ge,Qe){for(var tt=1,rt=.5,nt=.5,at=.5,it=0;it<Qe;it++)tt<<=2,tt+=Ne<rt?Ge<nt?0:1:Ge<nt?2:3,at*=.5,rt+=Ne<rt?-at:at,nt+=Ge<nt?-at:at;return tt}}},{"array-bounds":70,"binary-search-bounds":96,clamp:120,defined:170,dtype:175,"flatten-vertex-data":244,"is-obj":468,"math-log2":479,"parse-rect":504,"pick-by-alias":511}],59:[function(Ne,Ge,Qe){"use strict";Object.defineProperty(Qe,"__esModule",{value:!0});var tt=Ne("@turf/meta"),rt=6378137;function area(Ne){return tt.geomReduce(Ne,(function(Ne,Ge){return Ne+calculateArea(Ge)}),0)}function calculateArea(Ne){var Ge,Qe=0;switch(Ne.type){case"Polygon":return polygonArea(Ne.coordinates);case"MultiPolygon":for(Ge=0;Ge<Ne.coordinates.length;Ge++)Qe+=polygonArea(Ne.coordinates[Ge]);return Qe;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function polygonArea(Ne){var Ge=0;if(Ne&&Ne.length>0){Ge+=Math.abs(ringArea(Ne[0]));for(var Qe=1;Qe<Ne.length;Qe++)Ge-=Math.abs(ringArea(Ne[Qe]))}return Ge}function ringArea(Ne){var Ge,Qe,tt,nt,at,it,ot=0,dt=Ne.length;if(dt>2){for(it=0;it<dt;it++)it===dt-2?(tt=dt-2,nt=dt-1,at=0):it===dt-1?(tt=dt-1,nt=0,at=1):(tt=it,nt=it+1,at=it+2),Ge=Ne[tt],Qe=Ne[nt],ot+=(rad(Ne[at][0])-rad(Ge[0]))*Math.sin(rad(Qe[1]));ot=ot*rt*rt/2}return ot}function rad(Ne){return Ne*Math.PI/180}Qe.default=area},{"@turf/meta":63}],60:[function(Ne,Ge,Qe){"use strict";Object.defineProperty(Qe,"__esModule",{value:!0});var tt=Ne("@turf/meta");function bbox(Ne){var Ge=[1/0,1/0,-1/0,-1/0];return tt.coordEach(Ne,(function(Ne){Ge[0]>Ne[0]&&(Ge[0]=Ne[0]),Ge[1]>Ne[1]&&(Ge[1]=Ne[1]),Ge[2]<Ne[0]&&(Ge[2]=Ne[0]),Ge[3]<Ne[1]&&(Ge[3]=Ne[1])})),Ge}Qe.default=bbox},{"@turf/meta":63}],61:[function(Ne,Ge,Qe){"use strict";Object.defineProperty(Qe,"__esModule",{value:!0});var tt=Ne("@turf/meta"),rt=Ne("@turf/helpers");function centroid(Ne,Ge){void 0===Ge&&(Ge={});var Qe=0,nt=0,at=0;return tt.coordEach(Ne,(function(Ne){Qe+=Ne[0],nt+=Ne[1],at++})),rt.point([Qe/at,nt/at],Ge.properties)}Qe.default=centroid},{"@turf/helpers":62,"@turf/meta":63}],62:[function(Ne,Ge,Qe){"use strict";function feature(Ne,Ge,Qe){void 0===Qe&&(Qe={});var tt={type:"Feature"};return(0===Qe.id||Qe.id)&&(tt.id=Qe.id),Qe.bbox&&(tt.bbox=Qe.bbox),tt.properties=Ge||{},tt.geometry=Ne,tt}function geometry(Ne,Ge,Qe){switch(void 0===Qe&&(Qe={}),Ne){case"Point":return point(Ge).geometry;case"LineString":return lineString(Ge).geometry;case"Polygon":return polygon(Ge).geometry;case"MultiPoint":return multiPoint(Ge).geometry;case"MultiLineString":return multiLineString(Ge).geometry;case"MultiPolygon":return multiPolygon(Ge).geometry;default:throw new Error(Ne+" is invalid")}}function point(Ne,Ge,Qe){return void 0===Qe&&(Qe={}),feature({type:"Point",coordinates:Ne},Ge,Qe)}function points(Ne,Ge,Qe){return void 0===Qe&&(Qe={}),featureCollection(Ne.map((function(Ne){return point(Ne,Ge)})),Qe)}function polygon(Ne,Ge,Qe){void 0===Qe&&(Qe={});for(var tt=0,rt=Ne;tt<rt.length;tt++){var nt=rt[tt];if(nt.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var at=0;at<nt[nt.length-1].length;at++)if(nt[nt.length-1][at]!==nt[0][at])throw new Error("First and last Position are not equivalent.")}return feature({type:"Polygon",coordinates:Ne},Ge,Qe)}function polygons(Ne,Ge,Qe){return void 0===Qe&&(Qe={}),featureCollection(Ne.map((function(Ne){return polygon(Ne,Ge)})),Qe)}function lineString(Ne,Ge,Qe){if(void 0===Qe&&(Qe={}),Ne.length<2)throw new Error("coordinates must be an array of two or more positions");return feature({type:"LineString",coordinates:Ne},Ge,Qe)}function lineStrings(Ne,Ge,Qe){return void 0===Qe&&(Qe={}),featureCollection(Ne.map((function(Ne){return lineString(Ne,Ge)})),Qe)}function featureCollection(Ne,Ge){void 0===Ge&&(Ge={});var Qe={type:"FeatureCollection"};return Ge.id&&(Qe.id=Ge.id),Ge.bbox&&(Qe.bbox=Ge.bbox),Qe.features=Ne,Qe}function multiLineString(Ne,Ge,Qe){return void 0===Qe&&(Qe={}),feature({type:"MultiLineString",coordinates:Ne},Ge,Qe)}function multiPoint(Ne,Ge,Qe){return void 0===Qe&&(Qe={}),feature({type:"MultiPoint",coordinates:Ne},Ge,Qe)}function multiPolygon(Ne,Ge,Qe){return void 0===Qe&&(Qe={}),feature({type:"MultiPolygon",coordinates:Ne},Ge,Qe)}function geometryCollection(Ne,Ge,Qe){return void 0===Qe&&(Qe={}),feature({type:"GeometryCollection",geometries:Ne},Ge,Qe)}function round(Ne,Ge){if(void 0===Ge&&(Ge=0),Ge&&!(Ge>=0))throw new Error("precision must be a positive number");var Qe=Math.pow(10,Ge||0);return Math.round(Ne*Qe)/Qe}function radiansToLength(Ne,Ge){void 0===Ge&&(Ge="kilometers");var tt=Qe.factors[Ge];if(!tt)throw new Error(Ge+" units is invalid");return Ne*tt}function lengthToRadians(Ne,Ge){void 0===Ge&&(Ge="kilometers");var tt=Qe.factors[Ge];if(!tt)throw new Error(Ge+" units is invalid");return Ne/tt}function lengthToDegrees(Ne,Ge){return radiansToDegrees(lengthToRadians(Ne,Ge))}function bearingToAzimuth(Ne){var Ge=Ne%360;return Ge<0&&(Ge+=360),Ge}function radiansToDegrees(Ne){return Ne%(2*Math.PI)*180/Math.PI}function degreesToRadians(Ne){return Ne%360*Math.PI/180}function convertLength(Ne,Ge,Qe){if(void 0===Ge&&(Ge="kilometers"),void 0===Qe&&(Qe="kilometers"),!(Ne>=0))throw new Error("length must be a positive number");return radiansToLength(lengthToRadians(Ne,Ge),Qe)}function convertArea(Ne,Ge,tt){if(void 0===Ge&&(Ge="meters"),void 0===tt&&(tt="kilometers"),!(Ne>=0))throw new Error("area must be a positive number");var rt=Qe.areaFactors[Ge];if(!rt)throw new Error("invalid original units");var nt=Qe.areaFactors[tt];if(!nt)throw new Error("invalid final units");return Ne/rt*nt}function isNumber(Ne){return!isNaN(Ne)&&null!==Ne&&!Array.isArray(Ne)&&!/^\s*$/.test(Ne)}function isObject(Ne){return!!Ne&&Ne.constructor===Object}function validateBBox(Ne){if(!Ne)throw new Error("bbox is required");if(!Array.isArray(Ne))throw new Error("bbox must be an Array");if(4!==Ne.length&&6!==Ne.length)throw new Error("bbox must be an Array of 4 or 6 numbers");Ne.forEach((function(Ne){if(!isNumber(Ne))throw new Error("bbox must only contain numbers")}))}function validateId(Ne){if(!Ne)throw new Error("id is required");if(-1===["string","number"].indexOf(typeof Ne))throw new Error("id must be a number or a string")}function radians2degrees(){throw new Error("method has been renamed to `radiansToDegrees`")}function degrees2radians(){throw new Error("method has been renamed to `degreesToRadians`")}function distanceToDegrees(){throw new Error("method has been renamed to `lengthToDegrees`")}function distanceToRadians(){throw new Error("method has been renamed to `lengthToRadians`")}function radiansToDistance(){throw new Error("method has been renamed to `radiansToLength`")}function bearingToAngle(){throw new Error("method has been renamed to `bearingToAzimuth`")}function convertDistance(){throw new Error("method has been renamed to `convertLength`")}Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.earthRadius=6371008.8,Qe.factors={centimeters:100*Qe.earthRadius,centimetres:100*Qe.earthRadius,degrees:Qe.earthRadius/111325,feet:3.28084*Qe.earthRadius,inches:39.37*Qe.earthRadius,kilometers:Qe.earthRadius/1e3,kilometres:Qe.earthRadius/1e3,meters:Qe.earthRadius,metres:Qe.earthRadius,miles:Qe.earthRadius/1609.344,millimeters:1e3*Qe.earthRadius,millimetres:1e3*Qe.earthRadius,nauticalmiles:Qe.earthRadius/1852,radians:1,yards:Qe.earthRadius/1.0936},Qe.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/Qe.earthRadius,yards:1/1.0936},Qe.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},Qe.feature=feature,Qe.geometry=geometry,Qe.point=point,Qe.points=points,Qe.polygon=polygon,Qe.polygons=polygons,Qe.lineString=lineString,Qe.lineStrings=lineStrings,Qe.featureCollection=featureCollection,Qe.multiLineString=multiLineString,Qe.multiPoint=multiPoint,Qe.multiPolygon=multiPolygon,Qe.geometryCollection=geometryCollection,Qe.round=round,Qe.radiansToLength=radiansToLength,Qe.lengthToRadians=lengthToRadians,Qe.lengthToDegrees=lengthToDegrees,Qe.bearingToAzimuth=bearingToAzimuth,Qe.radiansToDegrees=radiansToDegrees,Qe.degreesToRadians=degreesToRadians,Qe.convertLength=convertLength,Qe.convertArea=convertArea,Qe.isNumber=isNumber,Qe.isObject=isObject,Qe.validateBBox=validateBBox,Qe.validateId=validateId,Qe.radians2degrees=radians2degrees,Qe.degrees2radians=degrees2radians,Qe.distanceToDegrees=distanceToDegrees,Qe.distanceToRadians=distanceToRadians,Qe.radiansToDistance=radiansToDistance,Qe.bearingToAngle=bearingToAngle,Qe.convertDistance=convertDistance},{}],63:[function(Ne,Ge,Qe){"use strict";Object.defineProperty(Qe,"__esModule",{value:!0});var tt=Ne("@turf/helpers");function coordEach(Ne,Ge,Qe){if(null!==Ne)for(var tt,rt,nt,at,it,ot,dt,ht,Dt=0,Ot=0,Rt=Ne.type,Zt="FeatureCollection"===Rt,er="Feature"===Rt,dr=Zt?Ne.features.length:1,mr=0;mr<dr;mr++){it=(ht=!!(dt=Zt?Ne.features[mr].geometry:er?Ne.geometry:Ne)&&"GeometryCollection"===dt.type)?dt.geometries.length:1;for(var xr=0;xr<it;xr++){var br=0,Ar=0;if(null!==(at=ht?dt.geometries[xr]:dt)){ot=at.coordinates;var en=at.type;switch(Dt=!Qe||"Polygon"!==en&&"MultiPolygon"!==en?0:1,en){case null:break;case"Point":if(!1===Ge(ot,Ot,mr,br,Ar))return!1;Ot++,br++;break;case"LineString":case"MultiPoint":for(tt=0;tt<ot.length;tt++){if(!1===Ge(ot[tt],Ot,mr,br,Ar))return!1;Ot++,"MultiPoint"===en&&br++}"LineString"===en&&br++;break;case"Polygon":case"MultiLineString":for(tt=0;tt<ot.length;tt++){for(rt=0;rt<ot[tt].length-Dt;rt++){if(!1===Ge(ot[tt][rt],Ot,mr,br,Ar))return!1;Ot++}"MultiLineString"===en&&br++,"Polygon"===en&&Ar++}"Polygon"===en&&br++;break;case"MultiPolygon":for(tt=0;tt<ot.length;tt++){for(Ar=0,rt=0;rt<ot[tt].length;rt++){for(nt=0;nt<ot[tt][rt].length-Dt;nt++){if(!1===Ge(ot[tt][rt][nt],Ot,mr,br,Ar))return!1;Ot++}Ar++}br++}break;case"GeometryCollection":for(tt=0;tt<at.geometries.length;tt++)if(!1===coordEach(at.geometries[tt],Ge,Qe))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function coordReduce(Ne,Ge,Qe,tt){var rt=Qe;return coordEach(Ne,(function(Ne,tt,nt,at,it){rt=0===tt&&void 0===Qe?Ne:Ge(rt,Ne,tt,nt,at,it)}),tt),rt}function propEach(Ne,Ge){var Qe;switch(Ne.type){case"FeatureCollection":for(Qe=0;Qe<Ne.features.length&&!1!==Ge(Ne.features[Qe].properties,Qe);Qe++);break;case"Feature":Ge(Ne.properties,0)}}function propReduce(Ne,Ge,Qe){var tt=Qe;return propEach(Ne,(function(Ne,rt){tt=0===rt&&void 0===Qe?Ne:Ge(tt,Ne,rt)})),tt}function featureEach(Ne,Ge){if("Feature"===Ne.type)Ge(Ne,0);else if("FeatureCollection"===Ne.type)for(var Qe=0;Qe<Ne.features.length&&!1!==Ge(Ne.features[Qe],Qe);Qe++);}function featureReduce(Ne,Ge,Qe){var tt=Qe;return featureEach(Ne,(function(Ne,rt){tt=0===rt&&void 0===Qe?Ne:Ge(tt,Ne,rt)})),tt}function coordAll(Ne){var Ge=[];return coordEach(Ne,(function(Ne){Ge.push(Ne)})),Ge}function geomEach(Ne,Ge){var Qe,tt,rt,nt,at,it,ot,dt,ht,Dt,Ot=0,Rt="FeatureCollection"===Ne.type,Zt="Feature"===Ne.type,er=Rt?Ne.features.length:1;for(Qe=0;Qe<er;Qe++){for(it=Rt?Ne.features[Qe].geometry:Zt?Ne.geometry:Ne,dt=Rt?Ne.features[Qe].properties:Zt?Ne.properties:{},ht=Rt?Ne.features[Qe].bbox:Zt?Ne.bbox:void 0,Dt=Rt?Ne.features[Qe].id:Zt?Ne.id:void 0,at=(ot=!!it&&"GeometryCollection"===it.type)?it.geometries.length:1,rt=0;rt<at;rt++)if(null!==(nt=ot?it.geometries[rt]:it))switch(nt.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===Ge(nt,Ot,dt,ht,Dt))return!1;break;case"GeometryCollection":for(tt=0;tt<nt.geometries.length;tt++)if(!1===Ge(nt.geometries[tt],Ot,dt,ht,Dt))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===Ge(null,Ot,dt,ht,Dt))return!1;Ot++}}function geomReduce(Ne,Ge,Qe){var tt=Qe;return geomEach(Ne,(function(Ne,rt,nt,at,it){tt=0===rt&&void 0===Qe?Ne:Ge(tt,Ne,rt,nt,at,it)})),tt}function flattenEach(Ne,Ge){geomEach(Ne,(function(Ne,Qe,rt,nt,at){var it,ot=null===Ne?null:Ne.type;switch(ot){case null:case"Point":case"LineString":case"Polygon":return!1!==Ge(tt.feature(Ne,rt,{bbox:nt,id:at}),Qe,0)&&void 0}switch(ot){case"MultiPoint":it="Point";break;case"MultiLineString":it="LineString";break;case"MultiPolygon":it="Polygon"}for(var dt=0;dt<Ne.coordinates.length;dt++){var ht={type:it,coordinates:Ne.coordinates[dt]};if(!1===Ge(tt.feature(ht,rt),Qe,dt))return!1}}))}function flattenReduce(Ne,Ge,Qe){var tt=Qe;return flattenEach(Ne,(function(Ne,rt,nt){tt=0===rt&&0===nt&&void 0===Qe?Ne:Ge(tt,Ne,rt,nt)})),tt}function segmentEach(Ne,Ge){flattenEach(Ne,(function(Ne,Qe,rt){var nt=0;if(Ne.geometry){var at=Ne.geometry.type;if("Point"!==at&&"MultiPoint"!==at){var it,ot=0,dt=0,ht=0;return!1!==coordEach(Ne,(function(at,Dt,Ot,Rt,Zt){if(void 0===it||Qe>ot||Rt>dt||Zt>ht)return it=at,ot=Qe,dt=Rt,ht=Zt,void(nt=0);var er=tt.lineString([it,at],Ne.properties);if(!1===Ge(er,Qe,rt,Zt,nt))return!1;nt++,it=at}))&&void 0}}}))}function segmentReduce(Ne,Ge,Qe){var tt=Qe,rt=!1;return segmentEach(Ne,(function(Ne,nt,at,it,ot){tt=!1===rt&&void 0===Qe?Ne:Ge(tt,Ne,nt,at,it,ot),rt=!0})),tt}function lineEach(Ne,Ge){if(!Ne)throw new Error("geojson is required");flattenEach(Ne,(function(Ne,Qe,rt){if(null!==Ne.geometry){var nt=Ne.geometry.type,at=Ne.geometry.coordinates;switch(nt){case"LineString":if(!1===Ge(Ne,Qe,rt,0,0))return!1;break;case"Polygon":for(var it=0;it<at.length;it++)if(!1===Ge(tt.lineString(at[it],Ne.properties),Qe,rt,it))return!1}}}))}function lineReduce(Ne,Ge,Qe){var tt=Qe;return lineEach(Ne,(function(Ne,rt,nt,at){tt=0===rt&&void 0===Qe?Ne:Ge(tt,Ne,rt,nt,at)})),tt}function findSegment(Ne,Ge){if(Ge=Ge||{},!tt.isObject(Ge))throw new Error("options is invalid");var Qe,rt=Ge.featureIndex||0,nt=Ge.multiFeatureIndex||0,at=Ge.geometryIndex||0,it=Ge.segmentIndex||0,ot=Ge.properties;switch(Ne.type){case"FeatureCollection":rt<0&&(rt=Ne.features.length+rt),ot=ot||Ne.features[rt].properties,Qe=Ne.features[rt].geometry;break;case"Feature":ot=ot||Ne.properties,Qe=Ne.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Qe=Ne;break;default:throw new Error("geojson is invalid")}if(null===Qe)return null;var dt=Qe.coordinates;switch(Qe.type){case"Point":case"MultiPoint":return null;case"LineString":return it<0&&(it=dt.length+it-1),tt.lineString([dt[it],dt[it+1]],ot,Ge);case"Polygon":return at<0&&(at=dt.length+at),it<0&&(it=dt[at].length+it-1),tt.lineString([dt[at][it],dt[at][it+1]],ot,Ge);case"MultiLineString":return nt<0&&(nt=dt.length+nt),it<0&&(it=dt[nt].length+it-1),tt.lineString([dt[nt][it],dt[nt][it+1]],ot,Ge);case"MultiPolygon":return nt<0&&(nt=dt.length+nt),at<0&&(at=dt[nt].length+at),it<0&&(it=dt[nt][at].length-it-1),tt.lineString([dt[nt][at][it],dt[nt][at][it+1]],ot,Ge)}throw new Error("geojson is invalid")}function findPoint(Ne,Ge){if(Ge=Ge||{},!tt.isObject(Ge))throw new Error("options is invalid");var Qe,rt=Ge.featureIndex||0,nt=Ge.multiFeatureIndex||0,at=Ge.geometryIndex||0,it=Ge.coordIndex||0,ot=Ge.properties;switch(Ne.type){case"FeatureCollection":rt<0&&(rt=Ne.features.length+rt),ot=ot||Ne.features[rt].properties,Qe=Ne.features[rt].geometry;break;case"Feature":ot=ot||Ne.properties,Qe=Ne.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":Qe=Ne;break;default:throw new Error("geojson is invalid")}if(null===Qe)return null;var dt=Qe.coordinates;switch(Qe.type){case"Point":return tt.point(dt,ot,Ge);case"MultiPoint":return nt<0&&(nt=dt.length+nt),tt.point(dt[nt],ot,Ge);case"LineString":return it<0&&(it=dt.length+it),tt.point(dt[it],ot,Ge);case"Polygon":return at<0&&(at=dt.length+at),it<0&&(it=dt[at].length+it),tt.point(dt[at][it],ot,Ge);case"MultiLineString":return nt<0&&(nt=dt.length+nt),it<0&&(it=dt[nt].length+it),tt.point(dt[nt][it],ot,Ge);case"MultiPolygon":return nt<0&&(nt=dt.length+nt),at<0&&(at=dt[nt].length+at),it<0&&(it=dt[nt][at].length-it),tt.point(dt[nt][at][it],ot,Ge)}throw new Error("geojson is invalid")}Qe.coordEach=coordEach,Qe.coordReduce=coordReduce,Qe.propEach=propEach,Qe.propReduce=propReduce,Qe.featureEach=featureEach,Qe.featureReduce=featureReduce,Qe.coordAll=coordAll,Qe.geomEach=geomEach,Qe.geomReduce=geomReduce,Qe.flattenEach=flattenEach,Qe.flattenReduce=flattenReduce,Qe.segmentEach=segmentEach,Qe.segmentReduce=segmentReduce,Qe.lineEach=lineEach,Qe.lineReduce=lineReduce,Qe.findSegment=findSegment,Qe.findPoint=findPoint},{"@turf/helpers":62}],64:[function(Ne,Ge,Qe){"use strict";var tt="undefined"==typeof WeakMap?Ne("weak-map"):WeakMap,rt=Ne("gl-buffer"),nt=Ne("gl-vao"),at=new tt;function createABigTriangle(Ne){var Ge=at.get(Ne),Qe=Ge&&(Ge._triangleBuffer.handle||Ge._triangleBuffer.buffer);if(!Qe||!Ne.isBuffer(Qe)){var tt=rt(Ne,new Float32Array([-1,-1,-1,4,4,-1]));(Ge=nt(Ne,[{buffer:tt,type:Ne.FLOAT,size:2}]))._triangleBuffer=tt,at.set(Ne,Ge)}Ge.bind(),Ne.drawArrays(Ne.TRIANGLES,0,3),Ge.unbind()}Ge.exports=createABigTriangle},{"gl-buffer":259,"gl-vao":358,"weak-map":602}],65:[function(Ne,Ge,Qe){function absolutize(Ne){var Ge=0,Qe=0,tt=0,rt=0;return Ne.map((function(Ne){var nt=(Ne=Ne.slice())[0],at=nt.toUpperCase();if(nt!=at)switch(Ne[0]=at,nt){case"a":Ne[6]+=tt,Ne[7]+=rt;break;case"v":Ne[1]+=rt;break;case"h":Ne[1]+=tt;break;default:for(var it=1;it<Ne.length;)Ne[it++]+=tt,Ne[it++]+=rt}switch(at){case"Z":tt=Ge,rt=Qe;break;case"H":tt=Ne[1];break;case"V":rt=Ne[1];break;case"M":tt=Ge=Ne[1],rt=Qe=Ne[2];break;default:tt=Ne[Ne.length-2],rt=Ne[Ne.length-1]}return Ne}))}Ge.exports=absolutize},{}],66:[function(Ne,Ge,Qe){var tt=Ne("pad-left");function addLineNumbers(Ne,Ge,Qe){Ge="number"==typeof Ge?Ge:1,Qe=Qe||": ";var rt=Ne.split(/\r?\n/),nt=String(rt.length+Ge-1).length;return rt.map((function(Ne,rt){var at=rt+Ge,it=String(at).length;return tt(at,nt-it)+Qe+Ne})).join("\n")}Ge.exports=addLineNumbers},{"pad-left":502}],67:[function(Ne,Ge,Qe){"use strict";Ge.exports=affineHull;var tt=Ne("robust-orientation");function linearlyIndependent(Ne,Ge){for(var Qe=new Array(Ge+1),rt=0;rt<Ne.length;++rt)Qe[rt]=Ne[rt];for(rt=0;rt<=Ne.length;++rt){for(var nt=Ne.length;nt<=Ge;++nt){for(var at=new Array(Ge),it=0;it<Ge;++it)at[it]=Math.pow(nt+1-rt,it);Qe[nt]=at}if(tt.apply(void 0,Qe))return!0}return!1}function affineHull(Ne){var Ge=Ne.length;if(0===Ge)return[];if(1===Ge)return[0];for(var Qe=Ne[0].length,tt=[Ne[0]],rt=[0],nt=1;nt<Ge;++nt)if(tt.push(Ne[nt]),linearlyIndependent(tt,Qe)){if(rt.push(nt),rt.length===Qe+1)return rt}else tt.pop();return rt}},{"robust-orientation":548}],68:[function(Ne,Ge,Qe){"use strict";Ge.exports=alphaComplex;var tt=Ne("delaunay-triangulate"),rt=Ne("circumradius");function alphaComplex(Ne,Ge){return tt(Ge).filter((function(Qe){for(var tt=new Array(Qe.length),nt=0;nt<Qe.length;++nt)tt[nt]=Ge[Qe[nt]];return rt(tt)*Ne<1}))}},{circumradius:119,"delaunay-triangulate":171}],69:[function(Ne,Ge,Qe){Ge.exports=alphaShape;var tt=Ne("alpha-complex"),rt=Ne("simplicial-complex-boundary");function alphaShape(Ne,Ge){return rt(tt(Ne,Ge))}},{"alpha-complex":68,"simplicial-complex-boundary":555}],70:[function(Ne,Ge,Qe){"use strict";function normalize(Ne,Ge){if(!Ne||null==Ne.length)throw Error("Argument should be an array");Ge=null==Ge?1:Math.floor(Ge);for(var Qe=Array(2*Ge),tt=0;tt<Ge;tt++){for(var rt=-1/0,nt=1/0,at=tt,it=Ne.length;at<it;at+=Ge)Ne[at]>rt&&(rt=Ne[at]),Ne[at]<nt&&(nt=Ne[at]);Qe[tt]=nt,Qe[Ge+tt]=rt}return Qe}Ge.exports=normalize},{}],71:[function(Ne,Ge,Qe){"use strict";var tt=Ne("array-bounds");function normalize(Ne,Ge,Qe){if(!Ne||null==Ne.length)throw Error("Argument should be an array");null==Ge&&(Ge=1),null==Qe&&(Qe=tt(Ne,Ge));for(var rt=0;rt<Ge;rt++){var nt=Qe[Ge+rt],at=Qe[rt],it=rt,ot=Ne.length;if(nt===1/0&&at===-1/0)for(it=rt;it<ot;it+=Ge)Ne[it]=Ne[it]===nt?1:Ne[it]===at?0:.5;else if(nt===1/0)for(it=rt;it<ot;it+=Ge)Ne[it]=Ne[it]===nt?1:0;else if(at===-1/0)for(it=rt;it<ot;it+=Ge)Ne[it]=Ne[it]===at?0:1;else{var dt=nt-at;for(it=rt;it<ot;it+=Ge)isNaN(Ne[it])||(Ne[it]=0===dt?.5:(Ne[it]-at)/dt)}}return Ne}Ge.exports=normalize},{"array-bounds":70}],72:[function(Ne,Ge,Qe){Ge.exports=function(Ne,Ge){var Qe="number"==typeof Ne,tt="number"==typeof Ge;Qe&&!tt?(Ge=Ne,Ne=0):Qe||tt||(Ne=0,Ge=0);var rt=(Ge|=0)-(Ne|=0);if(rt<0)throw new Error("array length must be positive");for(var nt=new Array(rt),at=0,it=Ne;at<rt;at++,it++)nt[at]=it;return nt}},{}],73:[function(Ne,Ge,tt){(function(Qe){(function(){"use strict";var tt=Ne("object-assign");function compare(Ne,Ge){if(Ne===Ge)return 0;for(var Qe=Ne.length,tt=Ge.length,rt=0,nt=Math.min(Qe,tt);rt<nt;++rt)if(Ne[rt]!==Ge[rt]){Qe=Ne[rt],tt=Ge[rt];break}return Qe<tt?-1:tt<Qe?1:0}function isBuffer(Ne){return Qe.Buffer&&"function"==typeof Qe.Buffer.isBuffer?Qe.Buffer.isBuffer(Ne):!(null==Ne||!Ne._isBuffer)}var rt=Ne("util/"),nt=Object.prototype.hasOwnProperty,at=Array.prototype.slice,it="foo"===function(){}.name;function pToString(Ne){return Object.prototype.toString.call(Ne)}function isView(Ne){return!isBuffer(Ne)&&"function"==typeof Qe.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(Ne):!!Ne&&(Ne instanceof DataView||!!(Ne.buffer&&Ne.buffer instanceof ArrayBuffer)))}var ot=Ge.exports=ok,dt=/\s*function\s+([^\(\s]*)\s*/;function getName(Ne){if(rt.isFunction(Ne)){if(it)return Ne.name;var Ge=Ne.toString().match(dt);return Ge&&Ge[1]}}function truncate(Ne,Ge){return"string"==typeof Ne?Ne.length<Ge?Ne:Ne.slice(0,Ge):Ne}function inspect(Ne){if(it||!rt.isFunction(Ne))return rt.inspect(Ne);var Ge=getName(Ne);return"[Function"+(Ge?": "+Ge:"")+"]"}function getMessage(Ne){return truncate(inspect(Ne.actual),128)+" "+Ne.operator+" "+truncate(inspect(Ne.expected),128)}function fail(Ne,Ge,Qe,tt,rt){throw new ot.AssertionError({message:Qe,actual:Ne,expected:Ge,operator:tt,stackStartFunction:rt})}function ok(Ne,Ge){Ne||fail(Ne,!0,Ge,"==",ot.ok)}function _deepEqual(Ne,Ge,Qe,tt){if(Ne===Ge)return!0;if(isBuffer(Ne)&&isBuffer(Ge))return 0===compare(Ne,Ge);if(rt.isDate(Ne)&&rt.isDate(Ge))return Ne.getTime()===Ge.getTime();if(rt.isRegExp(Ne)&&rt.isRegExp(Ge))return Ne.source===Ge.source&&Ne.global===Ge.global&&Ne.multiline===Ge.multiline&&Ne.lastIndex===Ge.lastIndex&&Ne.ignoreCase===Ge.ignoreCase;if(null!==Ne&&"object"==typeof Ne||null!==Ge&&"object"==typeof Ge){if(isView(Ne)&&isView(Ge)&&pToString(Ne)===pToString(Ge)&&!(Ne instanceof Float32Array||Ne instanceof Float64Array))return 0===compare(new Uint8Array(Ne.buffer),new Uint8Array(Ge.buffer));if(isBuffer(Ne)!==isBuffer(Ge))return!1;var nt=(tt=tt||{actual:[],expected:[]}).actual.indexOf(Ne);return-1!==nt&&nt===tt.expected.indexOf(Ge)||(tt.actual.push(Ne),tt.expected.push(Ge),objEquiv(Ne,Ge,Qe,tt))}return Qe?Ne===Ge:Ne==Ge}function isArguments(Ne){return"[object Arguments]"==Object.prototype.toString.call(Ne)}function objEquiv(Ne,Ge,Qe,tt){if(null==Ne||null==Ge)return!1;if(rt.isPrimitive(Ne)||rt.isPrimitive(Ge))return Ne===Ge;if(Qe&&Object.getPrototypeOf(Ne)!==Object.getPrototypeOf(Ge))return!1;var nt=isArguments(Ne),it=isArguments(Ge);if(nt&&!it||!nt&&it)return!1;if(nt)return _deepEqual(Ne=at.call(Ne),Ge=at.call(Ge),Qe);var ot,dt,Dt=ht(Ne),Ot=ht(Ge);if(Dt.length!==Ot.length)return!1;for(Dt.sort(),Ot.sort(),dt=Dt.length-1;dt>=0;dt--)if(Dt[dt]!==Ot[dt])return!1;for(dt=Dt.length-1;dt>=0;dt--)if(!_deepEqual(Ne[ot=Dt[dt]],Ge[ot],Qe,tt))return!1;return!0}function notDeepStrictEqual(Ne,Ge,Qe){_deepEqual(Ne,Ge,!0)&&fail(Ne,Ge,Qe,"notDeepStrictEqual",notDeepStrictEqual)}function expectedException(Ne,Ge){if(!Ne||!Ge)return!1;if("[object RegExp]"==Object.prototype.toString.call(Ge))return Ge.test(Ne);try{if(Ne instanceof Ge)return!0}catch(Ne){}return!Error.isPrototypeOf(Ge)&&!0===Ge.call({},Ne)}function _tryBlock(Ne){var Ge;try{Ne()}catch(Ne){Ge=Ne}return Ge}function _throws(Ne,Ge,Qe,tt){var nt;if("function"!=typeof Ge)throw new TypeError('"block" argument must be a function');"string"==typeof Qe&&(tt=Qe,Qe=null),nt=_tryBlock(Ge),tt=(Qe&&Qe.name?" ("+Qe.name+").":".")+(tt?" "+tt:"."),Ne&&!nt&&fail(nt,Qe,"Missing expected exception"+tt);var at="string"==typeof tt,it=!Ne&&nt&&!Qe;if((!Ne&&rt.isError(nt)&&at&&expectedException(nt,Qe)||it)&&fail(nt,Qe,"Got unwanted exception"+tt),Ne&&nt&&Qe&&!expectedException(nt,Qe)||!Ne&&nt)throw nt}function strict(Ne,Ge){Ne||fail(Ne,!0,Ge,"==",strict)}ot.AssertionError=function(Ne){this.name="AssertionError",this.actual=Ne.actual,this.expected=Ne.expected,this.operator=Ne.operator,Ne.message?(this.message=Ne.message,this.generatedMessage=!1):(this.message=getMessage(this),this.generatedMessage=!0);var Ge=Ne.stackStartFunction||fail;if(Error.captureStackTrace)Error.captureStackTrace(this,Ge);else{var Qe=new Error;if(Qe.stack){var tt=Qe.stack,rt=getName(Ge),nt=tt.indexOf("\n"+rt);if(nt>=0){var at=tt.indexOf("\n",nt+1);tt=tt.substring(at+1)}this.stack=tt}}},rt.inherits(ot.AssertionError,Error),ot.fail=fail,ot.ok=ok,ot.equal=function(Ne,Ge,Qe){Ne!=Ge&&fail(Ne,Ge,Qe,"==",ot.equal)},ot.notEqual=function(Ne,Ge,Qe){Ne==Ge&&fail(Ne,Ge,Qe,"!=",ot.notEqual)},ot.deepEqual=function(Ne,Ge,Qe){_deepEqual(Ne,Ge,!1)||fail(Ne,Ge,Qe,"deepEqual",ot.deepEqual)},ot.deepStrictEqual=function(Ne,Ge,Qe){_deepEqual(Ne,Ge,!0)||fail(Ne,Ge,Qe,"deepStrictEqual",ot.deepStrictEqual)},ot.notDeepEqual=function(Ne,Ge,Qe){_deepEqual(Ne,Ge,!1)&&fail(Ne,Ge,Qe,"notDeepEqual",ot.notDeepEqual)},ot.notDeepStrictEqual=notDeepStrictEqual,ot.strictEqual=function(Ne,Ge,Qe){Ne!==Ge&&fail(Ne,Ge,Qe,"===",ot.strictEqual)},ot.notStrictEqual=function(Ne,Ge,Qe){Ne===Ge&&fail(Ne,Ge,Qe,"!==",ot.notStrictEqual)},ot.throws=function(Ne,Ge,Qe){_throws(!0,Ne,Ge,Qe)},ot.doesNotThrow=function(Ne,Ge,Qe){_throws(!1,Ne,Ge,Qe)},ot.ifError=function(Ne){if(Ne)throw Ne},ot.strict=tt(strict,ot,{equal:ot.strictEqual,deepEqual:ot.deepStrictEqual,notEqual:ot.notStrictEqual,notDeepEqual:ot.notDeepStrictEqual}),ot.strict.strict=ot.strict;var ht=Object.keys||function(Ne){var Ge=[];for(var Qe in Ne)nt.call(Ne,Qe)&&Ge.push(Qe);return Ge}}).call(this)}).call(this,void 0!==Qe.g?Qe.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"object-assign":499,"util/":76}],74:[function(Ne,Ge,Qe){"function"==typeof Object.create?Ge.exports=function(Ne,Ge){Ne.super_=Ge,Ne.prototype=Object.create(Ge.prototype,{constructor:{value:Ne,enumerable:!1,writable:!0,configurable:!0}})}:Ge.exports=function(Ne,Ge){Ne.super_=Ge;var TempCtor=function(){};TempCtor.prototype=Ge.prototype,Ne.prototype=new TempCtor,Ne.prototype.constructor=Ne}},{}],75:[function(Ne,Ge,Qe){Ge.exports=function(Ne){return Ne&&"object"==typeof Ne&&"function"==typeof Ne.copy&&"function"==typeof Ne.fill&&"function"==typeof Ne.readUInt8}},{}],76:[function(Ne,Ge,tt){(function(Ge,Qe){(function(){var rt=/%[sdj%]/g;tt.format=function(Ne){if(!isString(Ne)){for(var Ge=[],Qe=0;Qe<arguments.length;Qe++)Ge.push(inspect(arguments[Qe]));return Ge.join(" ")}Qe=1;for(var tt=arguments,nt=tt.length,at=String(Ne).replace(rt,(function(Ne){if("%%"===Ne)return"%";if(Qe>=nt)return Ne;switch(Ne){case"%s":return String(tt[Qe++]);case"%d":return Number(tt[Qe++]);case"%j":try{return JSON.stringify(tt[Qe++])}catch(Ne){return"[Circular]"}default:return Ne}})),it=tt[Qe];Qe<nt;it=tt[++Qe])isNull(it)||!isObject(it)?at+=" "+it:at+=" "+inspect(it);return at},tt.deprecate=function(Ne,rt){if(isUndefined(Qe.process))return function(){return tt.deprecate(Ne,rt).apply(this,arguments)};if(!0===Ge.noDeprecation)return Ne;var nt=!1;function deprecated(){if(!nt){if(Ge.throwDeprecation)throw new Error(rt);Ge.traceDeprecation?console.trace(rt):console.error(rt),nt=!0}return Ne.apply(this,arguments)}return deprecated};var nt,at={};function inspect(Ne,Ge){var Qe={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(Qe.depth=arguments[2]),arguments.length>=4&&(Qe.colors=arguments[3]),isBoolean(Ge)?Qe.showHidden=Ge:Ge&&tt._extend(Qe,Ge),isUndefined(Qe.showHidden)&&(Qe.showHidden=!1),isUndefined(Qe.depth)&&(Qe.depth=2),isUndefined(Qe.colors)&&(Qe.colors=!1),isUndefined(Qe.customInspect)&&(Qe.customInspect=!0),Qe.colors&&(Qe.stylize=stylizeWithColor),formatValue(Qe,Ne,Qe.depth)}function stylizeWithColor(Ne,Ge){var Qe=inspect.styles[Ge];return Qe?"["+inspect.colors[Qe][0]+"m"+Ne+"["+inspect.colors[Qe][1]+"m":Ne}function stylizeNoColor(Ne,Ge){return Ne}function arrayToHash(Ne){var Ge={};return Ne.forEach((function(Ne,Qe){Ge[Ne]=!0})),Ge}function formatValue(Ne,Ge,Qe){if(Ne.customInspect&&Ge&&isFunction(Ge.inspect)&&Ge.inspect!==tt.inspect&&(!Ge.constructor||Ge.constructor.prototype!==Ge)){var rt=Ge.inspect(Qe,Ne);return isString(rt)||(rt=formatValue(Ne,rt,Qe)),rt}var nt=formatPrimitive(Ne,Ge);if(nt)return nt;var at=Object.keys(Ge),it=arrayToHash(at);if(Ne.showHidden&&(at=Object.getOwnPropertyNames(Ge)),isError(Ge)&&(at.indexOf("message")>=0||at.indexOf("description")>=0))return formatError(Ge);if(0===at.length){if(isFunction(Ge)){var ot=Ge.name?": "+Ge.name:"";return Ne.stylize("[Function"+ot+"]","special")}if(isRegExp(Ge))return Ne.stylize(RegExp.prototype.toString.call(Ge),"regexp");if(isDate(Ge))return Ne.stylize(Date.prototype.toString.call(Ge),"date");if(isError(Ge))return formatError(Ge)}var dt,ht="",Dt=!1,Ot=["{","}"];return isArray(Ge)&&(Dt=!0,Ot=["[","]"]),isFunction(Ge)&&(ht=" [Function"+(Ge.name?": "+Ge.name:"")+"]"),isRegExp(Ge)&&(ht=" "+RegExp.prototype.toString.call(Ge)),isDate(Ge)&&(ht=" "+Date.prototype.toUTCString.call(Ge)),isError(Ge)&&(ht=" "+formatError(Ge)),0!==at.length||Dt&&0!=Ge.length?Qe<0?isRegExp(Ge)?Ne.stylize(RegExp.prototype.toString.call(Ge),"regexp"):Ne.stylize("[Object]","special"):(Ne.seen.push(Ge),dt=Dt?formatArray(Ne,Ge,Qe,it,at):at.map((function(tt){return formatProperty(Ne,Ge,Qe,it,tt,Dt)})),Ne.seen.pop(),reduceToSingleString(dt,ht,Ot)):Ot[0]+ht+Ot[1]}function formatPrimitive(Ne,Ge){if(isUndefined(Ge))return Ne.stylize("undefined","undefined");if(isString(Ge)){var Qe="'"+JSON.stringify(Ge).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return Ne.stylize(Qe,"string")}return isNumber(Ge)?Ne.stylize(""+Ge,"number"):isBoolean(Ge)?Ne.stylize(""+Ge,"boolean"):isNull(Ge)?Ne.stylize("null","null"):void 0}function formatError(Ne){return"["+Error.prototype.toString.call(Ne)+"]"}function formatArray(Ne,Ge,Qe,tt,rt){for(var nt=[],at=0,it=Ge.length;at<it;++at)hasOwnProperty(Ge,String(at))?nt.push(formatProperty(Ne,Ge,Qe,tt,String(at),!0)):nt.push("");return rt.forEach((function(rt){rt.match(/^\d+$/)||nt.push(formatProperty(Ne,Ge,Qe,tt,rt,!0))})),nt}function formatProperty(Ne,Ge,Qe,tt,rt,nt){var at,it,ot;if((ot=Object.getOwnPropertyDescriptor(Ge,rt)||{value:Ge[rt]}).get?it=ot.set?Ne.stylize("[Getter/Setter]","special"):Ne.stylize("[Getter]","special"):ot.set&&(it=Ne.stylize("[Setter]","special")),hasOwnProperty(tt,rt)||(at="["+rt+"]"),it||(Ne.seen.indexOf(ot.value)<0?(it=isNull(Qe)?formatValue(Ne,ot.value,null):formatValue(Ne,ot.value,Qe-1)).indexOf("\n")>-1&&(it=nt?it.split("\n").map((function(Ne){return"  "+Ne})).join("\n").substr(2):"\n"+it.split("\n").map((function(Ne){return"   "+Ne})).join("\n")):it=Ne.stylize("[Circular]","special")),isUndefined(at)){if(nt&&rt.match(/^\d+$/))return it;(at=JSON.stringify(""+rt)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(at=at.substr(1,at.length-2),at=Ne.stylize(at,"name")):(at=at.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),at=Ne.stylize(at,"string"))}return at+": "+it}function reduceToSingleString(Ne,Ge,Qe){return Ne.reduce((function(Ne,Ge){return Ge.indexOf("\n"),Ne+Ge.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?Qe[0]+(""===Ge?"":Ge+"\n ")+" "+Ne.join(",\n  ")+" "+Qe[1]:Qe[0]+Ge+" "+Ne.join(", ")+" "+Qe[1]}function isArray(Ne){return Array.isArray(Ne)}function isBoolean(Ne){return"boolean"==typeof Ne}function isNull(Ne){return null===Ne}function isNullOrUndefined(Ne){return null==Ne}function isNumber(Ne){return"number"==typeof Ne}function isString(Ne){return"string"==typeof Ne}function isSymbol(Ne){return"symbol"==typeof Ne}function isUndefined(Ne){return void 0===Ne}function isRegExp(Ne){return isObject(Ne)&&"[object RegExp]"===objectToString(Ne)}function isObject(Ne){return"object"==typeof Ne&&null!==Ne}function isDate(Ne){return isObject(Ne)&&"[object Date]"===objectToString(Ne)}function isError(Ne){return isObject(Ne)&&("[object Error]"===objectToString(Ne)||Ne instanceof Error)}function isFunction(Ne){return"function"==typeof Ne}function isPrimitive(Ne){return null===Ne||"boolean"==typeof Ne||"number"==typeof Ne||"string"==typeof Ne||"symbol"==typeof Ne||void 0===Ne}function objectToString(Ne){return Object.prototype.toString.call(Ne)}function pad(Ne){return Ne<10?"0"+Ne.toString(10):Ne.toString(10)}tt.debuglog=function(Ne){if(isUndefined(nt)&&(nt=Ge.env.NODE_DEBUG||""),Ne=Ne.toUpperCase(),!at[Ne])if(new RegExp("\\b"+Ne+"\\b","i").test(nt)){var Qe=Ge.pid;at[Ne]=function(){var Ge=tt.format.apply(tt,arguments);console.error("%s %d: %s",Ne,Qe,Ge)}}else at[Ne]=function(){};return at[Ne]},tt.inspect=inspect,inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},tt.isArray=isArray,tt.isBoolean=isBoolean,tt.isNull=isNull,tt.isNullOrUndefined=isNullOrUndefined,tt.isNumber=isNumber,tt.isString=isString,tt.isSymbol=isSymbol,tt.isUndefined=isUndefined,tt.isRegExp=isRegExp,tt.isObject=isObject,tt.isDate=isDate,tt.isError=isError,tt.isFunction=isFunction,tt.isPrimitive=isPrimitive,tt.isBuffer=Ne("./support/isBuffer");var it=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp(){var Ne=new Date,Ge=[pad(Ne.getHours()),pad(Ne.getMinutes()),pad(Ne.getSeconds())].join(":");return[Ne.getDate(),it[Ne.getMonth()],Ge].join(" ")}function hasOwnProperty(Ne,Ge){return Object.prototype.hasOwnProperty.call(Ne,Ge)}tt.log=function(){console.log("%s - %s",timestamp(),tt.format.apply(tt,arguments))},tt.inherits=Ne("inherits"),tt._extend=function(Ne,Ge){if(!Ge||!isObject(Ge))return Ne;for(var Qe=Object.keys(Ge),tt=Qe.length;tt--;)Ne[Qe[tt]]=Ge[Qe[tt]];return Ne}}).call(this)}).call(this,Ne("_process"),void 0!==Qe.g?Qe.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":75,_process:526,inherits:74}],77:[function(Ne,Ge,Qe){Ge.exports=function(Ne){return atob(Ne)}},{}],78:[function(Ne,Ge,Qe){"use strict";Ge.exports=barycentric;var tt=Ne("robust-linear-solve");function reduce(Ne){for(var Ge=0,Qe=0;Qe<Ne.length;++Qe)Ge+=Ne[Qe];return Ge}function barycentric(Ne,Ge){for(var Qe=Ge.length,rt=new Array(Qe+1),nt=0;nt<Qe;++nt){for(var at=new Array(Qe+1),it=0;it<=Qe;++it)at[it]=Ne[it][nt];rt[nt]=at}for(rt[Qe]=new Array(Qe+1),nt=0;nt<=Qe;++nt)rt[Qe][nt]=1;var ot=new Array(Qe+1);for(nt=0;nt<Qe;++nt)ot[nt]=Ge[nt];ot[Qe]=1;var dt=tt(rt,ot),ht=reduce(dt[Qe+1]);0===ht&&(ht=1);var Dt=new Array(Qe+1);for(nt=0;nt<=Qe;++nt)Dt[nt]=reduce(dt[nt])/ht;return Dt}},{"robust-linear-solve":547}],79:[function(Ne,Ge,Qe){"use strict";Qe.byteLength=byteLength,Qe.toByteArray=toByteArray,Qe.fromByteArray=fromByteArray;for(var tt=[],rt=[],nt="undefined"!=typeof Uint8Array?Uint8Array:Array,at="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",it=0,ot=at.length;it<ot;++it)tt[it]=at[it],rt[at.charCodeAt(it)]=it;function getLens(Ne){var Ge=Ne.length;if(Ge%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var Qe=Ne.indexOf("=");return-1===Qe&&(Qe=Ge),[Qe,Qe===Ge?0:4-Qe%4]}function byteLength(Ne){var Ge=getLens(Ne),Qe=Ge[0],tt=Ge[1];return 3*(Qe+tt)/4-tt}function _byteLength(Ne,Ge,Qe){return 3*(Ge+Qe)/4-Qe}function toByteArray(Ne){var Ge,Qe,tt=getLens(Ne),at=tt[0],it=tt[1],ot=new nt(_byteLength(Ne,at,it)),dt=0,ht=it>0?at-4:at;for(Qe=0;Qe<ht;Qe+=4)Ge=rt[Ne.charCodeAt(Qe)]<<18|rt[Ne.charCodeAt(Qe+1)]<<12|rt[Ne.charCodeAt(Qe+2)]<<6|rt[Ne.charCodeAt(Qe+3)],ot[dt++]=Ge>>16&255,ot[dt++]=Ge>>8&255,ot[dt++]=255&Ge;return 2===it&&(Ge=rt[Ne.charCodeAt(Qe)]<<2|rt[Ne.charCodeAt(Qe+1)]>>4,ot[dt++]=255&Ge),1===it&&(Ge=rt[Ne.charCodeAt(Qe)]<<10|rt[Ne.charCodeAt(Qe+1)]<<4|rt[Ne.charCodeAt(Qe+2)]>>2,ot[dt++]=Ge>>8&255,ot[dt++]=255&Ge),ot}function tripletToBase64(Ne){return tt[Ne>>18&63]+tt[Ne>>12&63]+tt[Ne>>6&63]+tt[63&Ne]}function encodeChunk(Ne,Ge,Qe){for(var tt,rt=[],nt=Ge;nt<Qe;nt+=3)tt=(Ne[nt]<<16&16711680)+(Ne[nt+1]<<8&65280)+(255&Ne[nt+2]),rt.push(tripletToBase64(tt));return rt.join("")}function fromByteArray(Ne){for(var Ge,Qe=Ne.length,rt=Qe%3,nt=[],at=16383,it=0,ot=Qe-rt;it<ot;it+=at)nt.push(encodeChunk(Ne,it,it+at>ot?ot:it+at));return 1===rt?(Ge=Ne[Qe-1],nt.push(tt[Ge>>2]+tt[Ge<<4&63]+"==")):2===rt&&(Ge=(Ne[Qe-2]<<8)+Ne[Qe-1],nt.push(tt[Ge>>10]+tt[Ge>>4&63]+tt[Ge<<2&63]+"=")),nt.join("")}rt["-".charCodeAt(0)]=62,rt["_".charCodeAt(0)]=63},{}],80:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./lib/rationalize");function add(Ne,Ge){return tt(Ne[0].mul(Ge[1]).add(Ge[0].mul(Ne[1])),Ne[1].mul(Ge[1]))}Ge.exports=add},{"./lib/rationalize":90}],81:[function(Ne,Ge,Qe){"use strict";function cmp(Ne,Ge){return Ne[0].mul(Ge[1]).cmp(Ge[0].mul(Ne[1]))}Ge.exports=cmp},{}],82:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./lib/rationalize");function div(Ne,Ge){return tt(Ne[0].mul(Ge[1]),Ne[1].mul(Ge[0]))}Ge.exports=div},{"./lib/rationalize":90}],83:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./is-rat"),rt=Ne("./lib/is-bn"),nt=Ne("./lib/num-to-bn"),at=Ne("./lib/str-to-bn"),it=Ne("./lib/rationalize"),ot=Ne("./div");function makeRational(Ne,Ge){if(tt(Ne))return Ge?ot(Ne,makeRational(Ge)):[Ne[0].clone(),Ne[1].clone()];var Qe,dt,ht=0;if(rt(Ne))Qe=Ne.clone();else if("string"==typeof Ne)Qe=at(Ne);else{if(0===Ne)return[nt(0),nt(1)];if(Ne===Math.floor(Ne))Qe=nt(Ne);else{for(;Ne!==Math.floor(Ne);)Ne*=Math.pow(2,256),ht-=256;Qe=nt(Ne)}}if(tt(Ge))Qe.mul(Ge[1]),dt=Ge[0].clone();else if(rt(Ge))dt=Ge.clone();else if("string"==typeof Ge)dt=at(Ge);else if(Ge)if(Ge===Math.floor(Ge))dt=nt(Ge);else{for(;Ge!==Math.floor(Ge);)Ge*=Math.pow(2,256),ht+=256;dt=nt(Ge)}else dt=nt(1);return ht>0?Qe=Qe.ushln(ht):ht<0&&(dt=dt.ushln(-ht)),it(Qe,dt)}Ge.exports=makeRational},{"./div":82,"./is-rat":84,"./lib/is-bn":88,"./lib/num-to-bn":89,"./lib/rationalize":90,"./lib/str-to-bn":91}],84:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./lib/is-bn");function isRat(Ne){return Array.isArray(Ne)&&2===Ne.length&&tt(Ne[0])&&tt(Ne[1])}Ge.exports=isRat},{"./lib/is-bn":88}],85:[function(Ne,Ge,Qe){"use strict";var tt=Ne("bn.js");function sign(Ne){return Ne.cmp(new tt(0))}Ge.exports=sign},{"bn.js":99}],86:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./bn-sign");function bn2num(Ne){var Ge=Ne.length,Qe=Ne.words,rt=0;if(1===Ge)rt=Qe[0];else if(2===Ge)rt=Qe[0]+67108864*Qe[1];else for(var nt=0;nt<Ge;nt++)rt+=Qe[nt]*Math.pow(67108864,nt);return tt(Ne)*rt}Ge.exports=bn2num},{"./bn-sign":85}],87:[function(Ne,Ge,Qe){"use strict";var tt=Ne("double-bits"),rt=Ne("bit-twiddle").countTrailingZeros;function ctzNumber(Ne){var Ge=rt(tt.lo(Ne));if(Ge<32)return Ge;var Qe=rt(tt.hi(Ne));return Qe>20?52:Qe+32}Ge.exports=ctzNumber},{"bit-twiddle":97,"double-bits":173}],88:[function(Ne,Ge,Qe){"use strict";function isBN(Ne){return Ne&&"object"==typeof Ne&&Boolean(Ne.words)}Ne("bn.js"),Ge.exports=isBN},{"bn.js":99}],89:[function(Ne,Ge,Qe){"use strict";var tt=Ne("bn.js"),rt=Ne("double-bits");function num2bn(Ne){var Ge=rt.exponent(Ne);return Ge<52?new tt(Ne):new tt(Ne*Math.pow(2,52-Ge)).ushln(Ge-52)}Ge.exports=num2bn},{"bn.js":99,"double-bits":173}],90:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./num-to-bn"),rt=Ne("./bn-sign");function rationalize(Ne,Ge){var Qe=rt(Ne),nt=rt(Ge);if(0===Qe)return[tt(0),tt(1)];if(0===nt)return[tt(0),tt(0)];nt<0&&(Ne=Ne.neg(),Ge=Ge.neg());var at=Ne.gcd(Ge);return at.cmpn(1)?[Ne.div(at),Ge.div(at)]:[Ne,Ge]}Ge.exports=rationalize},{"./bn-sign":85,"./num-to-bn":89}],91:[function(Ne,Ge,Qe){"use strict";var tt=Ne("bn.js");function str2BN(Ne){return new tt(Ne)}Ge.exports=str2BN},{"bn.js":99}],92:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./lib/rationalize");function mul(Ne,Ge){return tt(Ne[0].mul(Ge[0]),Ne[1].mul(Ge[1]))}Ge.exports=mul},{"./lib/rationalize":90}],93:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./lib/bn-sign");function sign(Ne){return tt(Ne[0])*tt(Ne[1])}Ge.exports=sign},{"./lib/bn-sign":85}],94:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./lib/rationalize");function sub(Ne,Ge){return tt(Ne[0].mul(Ge[1]).sub(Ne[1].mul(Ge[0])),Ne[1].mul(Ge[1]))}Ge.exports=sub},{"./lib/rationalize":90}],95:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./lib/bn-to-num"),rt=Ne("./lib/ctz");function roundRat(Ne){var Ge=Ne[0],Qe=Ne[1];if(0===Ge.cmpn(0))return 0;var nt=Ge.abs().divmod(Qe.abs()),at=nt.div,it=tt(at),ot=nt.mod,dt=Ge.negative!==Qe.negative?-1:1;if(0===ot.cmpn(0))return dt*it;if(it){var ht=rt(it)+4;return dt*(it+(Ot=tt(ot.ushln(ht).divRound(Qe)))*Math.pow(2,-ht))}var Dt=Qe.bitLength()-ot.bitLength()+53,Ot=tt(ot.ushln(Dt).divRound(Qe));return Dt<1023?dt*Ot*Math.pow(2,-Dt):dt*(Ot*=Math.pow(2,-1023))*Math.pow(2,1023-Dt)}Ge.exports=roundRat},{"./lib/bn-to-num":86,"./lib/ctz":87}],96:[function(Ne,Ge,Qe){"use strict";function compileSearch(Ne,Ge,Qe,tt,rt){var nt=["function ",Ne,"(a,l,h,",tt.join(","),"){",rt?"":"var i=",Qe?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a[m]"];return rt?Ge.indexOf("c")<0?nt.push(";if(x===y){return m}else if(x<=y){"):nt.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):nt.push(";if(",Ge,"){i=m;"),Qe?nt.push("l=m+1}else{h=m-1}"):nt.push("h=m-1}else{l=m+1}"),nt.push("}"),rt?nt.push("return -1};"):nt.push("return i};"),nt.join("")}function compileBoundsSearch(Ne,Ge,Qe,tt){return new Function([compileSearch("A","x"+Ne+"y",Ge,["y"],tt),compileSearch("P","c(x,y)"+Ne+"0",Ge,["y","c"],tt),"function dispatchBsearch",Qe,"(a,y,c,l,h){if(typeof(c)==='function'){return P(a,(l===void 0)?0:l|0,(h===void 0)?a.length-1:h|0,y,c)}else{return A(a,(c===void 0)?0:c|0,(l===void 0)?a.length-1:l|0,y)}}return dispatchBsearch",Qe].join(""))()}Ge.exports={ge:compileBoundsSearch(">=",!1,"GE"),gt:compileBoundsSearch(">",!1,"GT"),lt:compileBoundsSearch("<",!0,"LT"),le:compileBoundsSearch("<=",!0,"LE"),eq:compileBoundsSearch("-",!0,"EQ",!0)}},{}],97:[function(Ne,Ge,Qe){"use strict";var tt=32;function countTrailingZeros(Ne){var Ge=32;return(Ne&=-Ne)&&Ge--,65535&Ne&&(Ge-=16),16711935&Ne&&(Ge-=8),252645135&Ne&&(Ge-=4),858993459&Ne&&(Ge-=2),1431655765&Ne&&(Ge-=1),Ge}Qe.INT_BITS=tt,Qe.INT_MAX=2147483647,Qe.INT_MIN=-1<<tt-1,Qe.sign=function(Ne){return(Ne>0)-(Ne<0)},Qe.abs=function(Ne){var Ge=Ne>>tt-1;return(Ne^Ge)-Ge},Qe.min=function(Ne,Ge){return Ge^(Ne^Ge)&-(Ne<Ge)},Qe.max=function(Ne,Ge){return Ne^(Ne^Ge)&-(Ne<Ge)},Qe.isPow2=function(Ne){return!(Ne&Ne-1||!Ne)},Qe.log2=function(Ne){var Ge,Qe;return Ge=(Ne>65535)<<4,Ge|=Qe=((Ne>>>=Ge)>255)<<3,Ge|=Qe=((Ne>>>=Qe)>15)<<2,(Ge|=Qe=((Ne>>>=Qe)>3)<<1)|(Ne>>>=Qe)>>1},Qe.log10=function(Ne){return Ne>=1e9?9:Ne>=1e8?8:Ne>=1e7?7:Ne>=1e6?6:Ne>=1e5?5:Ne>=1e4?4:Ne>=1e3?3:Ne>=100?2:Ne>=10?1:0},Qe.popCount=function(Ne){return 16843009*((Ne=(858993459&(Ne-=Ne>>>1&1431655765))+(Ne>>>2&858993459))+(Ne>>>4)&252645135)>>>24},Qe.countTrailingZeros=countTrailingZeros,Qe.nextPow2=function(Ne){return Ne+=0===Ne,--Ne,Ne|=Ne>>>1,Ne|=Ne>>>2,Ne|=Ne>>>4,Ne|=Ne>>>8,1+(Ne|=Ne>>>16)},Qe.prevPow2=function(Ne){return Ne|=Ne>>>1,Ne|=Ne>>>2,Ne|=Ne>>>4,Ne|=Ne>>>8,(Ne|=Ne>>>16)-(Ne>>>1)},Qe.parity=function(Ne){return Ne^=Ne>>>16,Ne^=Ne>>>8,Ne^=Ne>>>4,27030>>>(Ne&=15)&1};var rt=new Array(256);!function(Ne){for(var Ge=0;Ge<256;++Ge){var Qe=Ge,tt=Ge,rt=7;for(Qe>>>=1;Qe;Qe>>>=1)tt<<=1,tt|=1&Qe,--rt;Ne[Ge]=tt<<rt&255}}(rt),Qe.reverse=function(Ne){return rt[255&Ne]<<24|rt[Ne>>>8&255]<<16|rt[Ne>>>16&255]<<8|rt[Ne>>>24&255]},Qe.interleave2=function(Ne,Ge){return(Ne=1431655765&((Ne=858993459&((Ne=252645135&((Ne=16711935&((Ne&=65535)|Ne<<8))|Ne<<4))|Ne<<2))|Ne<<1))|(Ge=1431655765&((Ge=858993459&((Ge=252645135&((Ge=16711935&((Ge&=65535)|Ge<<8))|Ge<<4))|Ge<<2))|Ge<<1))<<1},Qe.deinterleave2=function(Ne,Ge){return(Ne=65535&((Ne=16711935&((Ne=252645135&((Ne=858993459&((Ne=Ne>>>Ge&1431655765)|Ne>>>1))|Ne>>>2))|Ne>>>4))|Ne>>>16))<<16>>16},Qe.interleave3=function(Ne,Ge,Qe){return Ne=1227133513&((Ne=3272356035&((Ne=251719695&((Ne=4278190335&((Ne&=1023)|Ne<<16))|Ne<<8))|Ne<<4))|Ne<<2),(Ne|=(Ge=1227133513&((Ge=3272356035&((Ge=251719695&((Ge=4278190335&((Ge&=1023)|Ge<<16))|Ge<<8))|Ge<<4))|Ge<<2))<<1)|(Qe=1227133513&((Qe=3272356035&((Qe=251719695&((Qe=4278190335&((Qe&=1023)|Qe<<16))|Qe<<8))|Qe<<4))|Qe<<2))<<2},Qe.deinterleave3=function(Ne,Ge){return(Ne=1023&((Ne=4278190335&((Ne=251719695&((Ne=3272356035&((Ne=Ne>>>Ge&1227133513)|Ne>>>2))|Ne>>>4))|Ne>>>8))|Ne>>>16))<<22>>22},Qe.nextCombination=function(Ne){var Ge=Ne|Ne-1;return Ge+1|(~Ge&-~Ge)-1>>>countTrailingZeros(Ne)+1}},{}],98:[function(Ne,Ge,Qe){"use strict";var tt=Ne("clamp");Ge.exports=calcSDF;var rt=1e20;function calcSDF(Ne,Ge){Ge||(Ge={});var Qe,nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt,er=null==Ge.cutoff?.25:Ge.cutoff,dr=null==Ge.radius?8:Ge.radius,mr=Ge.channel||0;if(ArrayBuffer.isView(Ne)||Array.isArray(Ne)){if(!Ge.width||!Ge.height)throw Error("For raw data width and height should be provided by options");Qe=Ge.width,nt=Ge.height,it=Ne,dt=Ge.stride?Ge.stride:Math.floor(Ne.length/Qe/nt)}else window.HTMLCanvasElement&&Ne instanceof window.HTMLCanvasElement?(ht=(Dt=Ne).getContext("2d"),Qe=Dt.width,nt=Dt.height,it=(Ot=ht.getImageData(0,0,Qe,nt)).data,dt=4):window.CanvasRenderingContext2D&&Ne instanceof window.CanvasRenderingContext2D?(ht=Ne,Qe=(Dt=Ne.canvas).width,nt=Dt.height,it=(Ot=ht.getImageData(0,0,Qe,nt)).data,dt=4):window.ImageData&&Ne instanceof window.ImageData&&(Ot=Ne,Qe=Ne.width,nt=Ne.height,it=Ot.data,dt=4);if(at=Math.max(Qe,nt),window.Uint8ClampedArray&&it instanceof window.Uint8ClampedArray||window.Uint8Array&&it instanceof window.Uint8Array)for(ot=it,it=Array(Qe*nt),Rt=0,Zt=ot.length;Rt<Zt;Rt++)it[Rt]=ot[Rt*dt+mr]/255;else if(1!==dt)throw Error("Raw data can have only 1 value per pixel");var xr=Array(Qe*nt),br=Array(Qe*nt),Ar=Array(at),en=Array(at),mn=Array(at+1),xn=Array(at);for(Rt=0,Zt=Qe*nt;Rt<Zt;Rt++){var kn=it[Rt];xr[Rt]=1===kn?0:0===kn?rt:Math.pow(Math.max(0,.5-kn),2),br[Rt]=1===kn?rt:0===kn?0:Math.pow(Math.max(0,kn-.5),2)}edt(xr,Qe,nt,Ar,en,xn,mn),edt(br,Qe,nt,Ar,en,xn,mn);var Cn=window.Float32Array?new Float32Array(Qe*nt):new Array(Qe*nt);for(Rt=0,Zt=Qe*nt;Rt<Zt;Rt++)Cn[Rt]=tt(1-((xr[Rt]-br[Rt])/dr+er),0,1);return Cn}function edt(Ne,Ge,Qe,tt,rt,nt,at){for(var it=0;it<Ge;it++){for(var ot=0;ot<Qe;ot++)tt[ot]=Ne[ot*Ge+it];for(edt1d(tt,rt,nt,at,Qe),ot=0;ot<Qe;ot++)Ne[ot*Ge+it]=rt[ot]}for(ot=0;ot<Qe;ot++){for(it=0;it<Ge;it++)tt[it]=Ne[ot*Ge+it];for(edt1d(tt,rt,nt,at,Ge),it=0;it<Ge;it++)Ne[ot*Ge+it]=Math.sqrt(rt[it])}}function edt1d(Ne,Ge,Qe,tt,nt){Qe[0]=0,tt[0]=-rt,tt[1]=+rt;for(var at=1,it=0;at<nt;at++){for(var ot=(Ne[at]+at*at-(Ne[Qe[it]]+Qe[it]*Qe[it]))/(2*at-2*Qe[it]);ot<=tt[it];)it--,ot=(Ne[at]+at*at-(Ne[Qe[it]]+Qe[it]*Qe[it]))/(2*at-2*Qe[it]);Qe[++it]=at,tt[it]=ot,tt[it+1]=+rt}for(at=0,it=0;at<nt;at++){for(;tt[it+1]<at;)it++;Ge[at]=(at-Qe[it])*(at-Qe[it])+Ne[Qe[it]]}}},{clamp:120}],99:[function(Ne,Ge,Qe){!function(Ge,Qe){"use strict";function assert(Ne,Ge){if(!Ne)throw new Error(Ge||"Assertion failed")}function inherits(Ne,Ge){Ne.super_=Ge;var TempCtor=function(){};TempCtor.prototype=Ge.prototype,Ne.prototype=new TempCtor,Ne.prototype.constructor=Ne}function BN(Ne,Ge,Qe){if(BN.isBN(Ne))return Ne;this.negative=0,this.words=null,this.length=0,this.red=null,null!==Ne&&("le"!==Ge&&"be"!==Ge||(Qe=Ge,Ge=10),this._init(Ne||0,Ge||10,Qe||"be"))}var tt;"object"==typeof Ge?Ge.exports=BN:Qe.BN=BN,BN.BN=BN,BN.wordSize=26;try{tt=Ne("buffer").Buffer}catch(Ne){}function parseHex(Ne,Ge,Qe){for(var tt=0,rt=Math.min(Ne.length,Qe),nt=Ge;nt<rt;nt++){var at=Ne.charCodeAt(nt)-48;tt<<=4,tt|=at>=49&&at<=54?at-49+10:at>=17&&at<=22?at-17+10:15&at}return tt}function parseBase(Ne,Ge,Qe,tt){for(var rt=0,nt=Math.min(Ne.length,Qe),at=Ge;at<nt;at++){var it=Ne.charCodeAt(at)-48;rt*=tt,rt+=it>=49?it-49+10:it>=17?it-17+10:it}return rt}BN.isBN=function(Ne){return Ne instanceof BN||null!==Ne&&"object"==typeof Ne&&Ne.constructor.wordSize===BN.wordSize&&Array.isArray(Ne.words)},BN.max=function(Ne,Ge){return Ne.cmp(Ge)>0?Ne:Ge},BN.min=function(Ne,Ge){return Ne.cmp(Ge)<0?Ne:Ge},BN.prototype._init=function(Ne,Ge,Qe){if("number"==typeof Ne)return this._initNumber(Ne,Ge,Qe);if("object"==typeof Ne)return this._initArray(Ne,Ge,Qe);"hex"===Ge&&(Ge=16),assert(Ge===(0|Ge)&&Ge>=2&&Ge<=36);var tt=0;"-"===(Ne=Ne.toString().replace(/\s+/g,""))[0]&&tt++,16===Ge?this._parseHex(Ne,tt):this._parseBase(Ne,Ge,tt),"-"===Ne[0]&&(this.negative=1),this.strip(),"le"===Qe&&this._initArray(this.toArray(),Ge,Qe)},BN.prototype._initNumber=function(Ne,Ge,Qe){Ne<0&&(this.negative=1,Ne=-Ne),Ne<67108864?(this.words=[67108863&Ne],this.length=1):Ne<4503599627370496?(this.words=[67108863&Ne,Ne/67108864&67108863],this.length=2):(assert(Ne<9007199254740992),this.words=[67108863&Ne,Ne/67108864&67108863,1],this.length=3),"le"===Qe&&this._initArray(this.toArray(),Ge,Qe)},BN.prototype._initArray=function(Ne,Ge,Qe){if(assert("number"==typeof Ne.length),Ne.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(Ne.length/3),this.words=new Array(this.length);for(var tt=0;tt<this.length;tt++)this.words[tt]=0;var rt,nt,at=0;if("be"===Qe)for(tt=Ne.length-1,rt=0;tt>=0;tt-=3)nt=Ne[tt]|Ne[tt-1]<<8|Ne[tt-2]<<16,this.words[rt]|=nt<<at&67108863,this.words[rt+1]=nt>>>26-at&67108863,(at+=24)>=26&&(at-=26,rt++);else if("le"===Qe)for(tt=0,rt=0;tt<Ne.length;tt+=3)nt=Ne[tt]|Ne[tt+1]<<8|Ne[tt+2]<<16,this.words[rt]|=nt<<at&67108863,this.words[rt+1]=nt>>>26-at&67108863,(at+=24)>=26&&(at-=26,rt++);return this.strip()},BN.prototype._parseHex=function(Ne,Ge){this.length=Math.ceil((Ne.length-Ge)/6),this.words=new Array(this.length);for(var Qe=0;Qe<this.length;Qe++)this.words[Qe]=0;var tt,rt,nt=0;for(Qe=Ne.length-6,tt=0;Qe>=Ge;Qe-=6)rt=parseHex(Ne,Qe,Qe+6),this.words[tt]|=rt<<nt&67108863,this.words[tt+1]|=rt>>>26-nt&4194303,(nt+=24)>=26&&(nt-=26,tt++);Qe+6!==Ge&&(rt=parseHex(Ne,Ge,Qe+6),this.words[tt]|=rt<<nt&67108863,this.words[tt+1]|=rt>>>26-nt&4194303),this.strip()},BN.prototype._parseBase=function(Ne,Ge,Qe){this.words=[0],this.length=1;for(var tt=0,rt=1;rt<=67108863;rt*=Ge)tt++;tt--,rt=rt/Ge|0;for(var nt=Ne.length-Qe,at=nt%tt,it=Math.min(nt,nt-at)+Qe,ot=0,dt=Qe;dt<it;dt+=tt)ot=parseBase(Ne,dt,dt+tt,Ge),this.imuln(rt),this.words[0]+ot<67108864?this.words[0]+=ot:this._iaddn(ot);if(0!==at){var ht=1;for(ot=parseBase(Ne,dt,Ne.length,Ge),dt=0;dt<at;dt++)ht*=Ge;this.imuln(ht),this.words[0]+ot<67108864?this.words[0]+=ot:this._iaddn(ot)}},BN.prototype.copy=function(Ne){Ne.words=new Array(this.length);for(var Ge=0;Ge<this.length;Ge++)Ne.words[Ge]=this.words[Ge];Ne.length=this.length,Ne.negative=this.negative,Ne.red=this.red},BN.prototype.clone=function(){var Ne=new BN(null);return this.copy(Ne),Ne},BN.prototype._expand=function(Ne){for(;this.length<Ne;)this.words[this.length++]=0;return this},BN.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},BN.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},BN.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var rt=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],nt=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],at=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function toBitArray(Ne){for(var Ge=new Array(Ne.bitLength()),Qe=0;Qe<Ge.length;Qe++){var tt=Qe/26|0,rt=Qe%26;Ge[Qe]=(Ne.words[tt]&1<<rt)>>>rt}return Ge}function smallMulTo(Ne,Ge,Qe){Qe.negative=Ge.negative^Ne.negative;var tt=Ne.length+Ge.length|0;Qe.length=tt,tt=tt-1|0;var rt=0|Ne.words[0],nt=0|Ge.words[0],at=rt*nt,it=67108863&at,ot=at/67108864|0;Qe.words[0]=it;for(var dt=1;dt<tt;dt++){for(var ht=ot>>>26,Dt=67108863&ot,Ot=Math.min(dt,Ge.length-1),Rt=Math.max(0,dt-Ne.length+1);Rt<=Ot;Rt++){var Zt=dt-Rt|0;ht+=(at=(rt=0|Ne.words[Zt])*(nt=0|Ge.words[Rt])+Dt)/67108864|0,Dt=67108863&at}Qe.words[dt]=0|Dt,ot=0|ht}return 0!==ot?Qe.words[dt]=0|ot:Qe.length--,Qe.strip()}BN.prototype.toString=function(Ne,Ge){var Qe;if(Ge=0|Ge||1,16===(Ne=Ne||10)||"hex"===Ne){Qe="";for(var tt=0,it=0,ot=0;ot<this.length;ot++){var dt=this.words[ot],ht=(16777215&(dt<<tt|it)).toString(16);Qe=0!=(it=dt>>>24-tt&16777215)||ot!==this.length-1?rt[6-ht.length]+ht+Qe:ht+Qe,(tt+=2)>=26&&(tt-=26,ot--)}for(0!==it&&(Qe=it.toString(16)+Qe);Qe.length%Ge!=0;)Qe="0"+Qe;return 0!==this.negative&&(Qe="-"+Qe),Qe}if(Ne===(0|Ne)&&Ne>=2&&Ne<=36){var Dt=nt[Ne],Ot=at[Ne];Qe="";var Rt=this.clone();for(Rt.negative=0;!Rt.isZero();){var Zt=Rt.modn(Ot).toString(Ne);Qe=(Rt=Rt.idivn(Ot)).isZero()?Zt+Qe:rt[Dt-Zt.length]+Zt+Qe}for(this.isZero()&&(Qe="0"+Qe);Qe.length%Ge!=0;)Qe="0"+Qe;return 0!==this.negative&&(Qe="-"+Qe),Qe}assert(!1,"Base should be between 2 and 36")},BN.prototype.toNumber=function(){var Ne=this.words[0];return 2===this.length?Ne+=67108864*this.words[1]:3===this.length&&1===this.words[2]?Ne+=4503599627370496+67108864*this.words[1]:this.length>2&&assert(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-Ne:Ne},BN.prototype.toJSON=function(){return this.toString(16)},BN.prototype.toBuffer=function(Ne,Ge){return assert(void 0!==tt),this.toArrayLike(tt,Ne,Ge)},BN.prototype.toArray=function(Ne,Ge){return this.toArrayLike(Array,Ne,Ge)},BN.prototype.toArrayLike=function(Ne,Ge,Qe){var tt=this.byteLength(),rt=Qe||Math.max(1,tt);assert(tt<=rt,"byte array longer than desired length"),assert(rt>0,"Requested array length <= 0"),this.strip();var nt,at,it="le"===Ge,ot=new Ne(rt),dt=this.clone();if(it){for(at=0;!dt.isZero();at++)nt=dt.andln(255),dt.iushrn(8),ot[at]=nt;for(;at<rt;at++)ot[at]=0}else{for(at=0;at<rt-tt;at++)ot[at]=0;for(at=0;!dt.isZero();at++)nt=dt.andln(255),dt.iushrn(8),ot[rt-at-1]=nt}return ot},Math.clz32?BN.prototype._countBits=function(Ne){return 32-Math.clz32(Ne)}:BN.prototype._countBits=function(Ne){var Ge=Ne,Qe=0;return Ge>=4096&&(Qe+=13,Ge>>>=13),Ge>=64&&(Qe+=7,Ge>>>=7),Ge>=8&&(Qe+=4,Ge>>>=4),Ge>=2&&(Qe+=2,Ge>>>=2),Qe+Ge},BN.prototype._zeroBits=function(Ne){if(0===Ne)return 26;var Ge=Ne,Qe=0;return 0==(8191&Ge)&&(Qe+=13,Ge>>>=13),0==(127&Ge)&&(Qe+=7,Ge>>>=7),0==(15&Ge)&&(Qe+=4,Ge>>>=4),0==(3&Ge)&&(Qe+=2,Ge>>>=2),0==(1&Ge)&&Qe++,Qe},BN.prototype.bitLength=function(){var Ne=this.words[this.length-1],Ge=this._countBits(Ne);return 26*(this.length-1)+Ge},BN.prototype.zeroBits=function(){if(this.isZero())return 0;for(var Ne=0,Ge=0;Ge<this.length;Ge++){var Qe=this._zeroBits(this.words[Ge]);if(Ne+=Qe,26!==Qe)break}return Ne},BN.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},BN.prototype.toTwos=function(Ne){return 0!==this.negative?this.abs().inotn(Ne).iaddn(1):this.clone()},BN.prototype.fromTwos=function(Ne){return this.testn(Ne-1)?this.notn(Ne).iaddn(1).ineg():this.clone()},BN.prototype.isNeg=function(){return 0!==this.negative},BN.prototype.neg=function(){return this.clone().ineg()},BN.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},BN.prototype.iuor=function(Ne){for(;this.length<Ne.length;)this.words[this.length++]=0;for(var Ge=0;Ge<Ne.length;Ge++)this.words[Ge]=this.words[Ge]|Ne.words[Ge];return this.strip()},BN.prototype.ior=function(Ne){return assert(0==(this.negative|Ne.negative)),this.iuor(Ne)},BN.prototype.or=function(Ne){return this.length>Ne.length?this.clone().ior(Ne):Ne.clone().ior(this)},BN.prototype.uor=function(Ne){return this.length>Ne.length?this.clone().iuor(Ne):Ne.clone().iuor(this)},BN.prototype.iuand=function(Ne){var Ge;Ge=this.length>Ne.length?Ne:this;for(var Qe=0;Qe<Ge.length;Qe++)this.words[Qe]=this.words[Qe]&Ne.words[Qe];return this.length=Ge.length,this.strip()},BN.prototype.iand=function(Ne){return assert(0==(this.negative|Ne.negative)),this.iuand(Ne)},BN.prototype.and=function(Ne){return this.length>Ne.length?this.clone().iand(Ne):Ne.clone().iand(this)},BN.prototype.uand=function(Ne){return this.length>Ne.length?this.clone().iuand(Ne):Ne.clone().iuand(this)},BN.prototype.iuxor=function(Ne){var Ge,Qe;this.length>Ne.length?(Ge=this,Qe=Ne):(Ge=Ne,Qe=this);for(var tt=0;tt<Qe.length;tt++)this.words[tt]=Ge.words[tt]^Qe.words[tt];if(this!==Ge)for(;tt<Ge.length;tt++)this.words[tt]=Ge.words[tt];return this.length=Ge.length,this.strip()},BN.prototype.ixor=function(Ne){return assert(0==(this.negative|Ne.negative)),this.iuxor(Ne)},BN.prototype.xor=function(Ne){return this.length>Ne.length?this.clone().ixor(Ne):Ne.clone().ixor(this)},BN.prototype.uxor=function(Ne){return this.length>Ne.length?this.clone().iuxor(Ne):Ne.clone().iuxor(this)},BN.prototype.inotn=function(Ne){assert("number"==typeof Ne&&Ne>=0);var Ge=0|Math.ceil(Ne/26),Qe=Ne%26;this._expand(Ge),Qe>0&&Ge--;for(var tt=0;tt<Ge;tt++)this.words[tt]=67108863&~this.words[tt];return Qe>0&&(this.words[tt]=~this.words[tt]&67108863>>26-Qe),this.strip()},BN.prototype.notn=function(Ne){return this.clone().inotn(Ne)},BN.prototype.setn=function(Ne,Ge){assert("number"==typeof Ne&&Ne>=0);var Qe=Ne/26|0,tt=Ne%26;return this._expand(Qe+1),this.words[Qe]=Ge?this.words[Qe]|1<<tt:this.words[Qe]&~(1<<tt),this.strip()},BN.prototype.iadd=function(Ne){var Ge,Qe,tt;if(0!==this.negative&&0===Ne.negative)return this.negative=0,Ge=this.isub(Ne),this.negative^=1,this._normSign();if(0===this.negative&&0!==Ne.negative)return Ne.negative=0,Ge=this.isub(Ne),Ne.negative=1,Ge._normSign();this.length>Ne.length?(Qe=this,tt=Ne):(Qe=Ne,tt=this);for(var rt=0,nt=0;nt<tt.length;nt++)Ge=(0|Qe.words[nt])+(0|tt.words[nt])+rt,this.words[nt]=67108863&Ge,rt=Ge>>>26;for(;0!==rt&&nt<Qe.length;nt++)Ge=(0|Qe.words[nt])+rt,this.words[nt]=67108863&Ge,rt=Ge>>>26;if(this.length=Qe.length,0!==rt)this.words[this.length]=rt,this.length++;else if(Qe!==this)for(;nt<Qe.length;nt++)this.words[nt]=Qe.words[nt];return this},BN.prototype.add=function(Ne){var Ge;return 0!==Ne.negative&&0===this.negative?(Ne.negative=0,Ge=this.sub(Ne),Ne.negative^=1,Ge):0===Ne.negative&&0!==this.negative?(this.negative=0,Ge=Ne.sub(this),this.negative=1,Ge):this.length>Ne.length?this.clone().iadd(Ne):Ne.clone().iadd(this)},BN.prototype.isub=function(Ne){if(0!==Ne.negative){Ne.negative=0;var Ge=this.iadd(Ne);return Ne.negative=1,Ge._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(Ne),this.negative=1,this._normSign();var Qe,tt,rt=this.cmp(Ne);if(0===rt)return this.negative=0,this.length=1,this.words[0]=0,this;rt>0?(Qe=this,tt=Ne):(Qe=Ne,tt=this);for(var nt=0,at=0;at<tt.length;at++)nt=(Ge=(0|Qe.words[at])-(0|tt.words[at])+nt)>>26,this.words[at]=67108863&Ge;for(;0!==nt&&at<Qe.length;at++)nt=(Ge=(0|Qe.words[at])+nt)>>26,this.words[at]=67108863&Ge;if(0===nt&&at<Qe.length&&Qe!==this)for(;at<Qe.length;at++)this.words[at]=Qe.words[at];return this.length=Math.max(this.length,at),Qe!==this&&(this.negative=1),this.strip()},BN.prototype.sub=function(Ne){return this.clone().isub(Ne)};var comb10MulTo=function(Ne,Ge,Qe){var tt,rt,nt,at=Ne.words,it=Ge.words,ot=Qe.words,dt=0,ht=0|at[0],Dt=8191&ht,Ot=ht>>>13,Rt=0|at[1],Zt=8191&Rt,er=Rt>>>13,dr=0|at[2],mr=8191&dr,xr=dr>>>13,br=0|at[3],Ar=8191&br,en=br>>>13,mn=0|at[4],xn=8191&mn,kn=mn>>>13,Cn=0|at[5],En=8191&Cn,Pn=Cn>>>13,Dn=0|at[6],In=8191&Dn,zn=Dn>>>13,Bn=0|at[7],Vn=8191&Bn,Hn=Bn>>>13,qn=0|at[8],Yn=8191&qn,$n=qn>>>13,ra=0|at[9],oa=8191&ra,pa=ra>>>13,ga=0|it[0],ma=8191&ga,_a=ga>>>13,Va=0|it[1],Wa=8191&Va,Qa=Va>>>13,ti=0|it[2],ni=8191&ti,di=ti>>>13,ji=0|it[3],Hi=8191&ji,Yi=ji>>>13,uo=0|it[4],go=8191&uo,ns=uo>>>13,as=0|it[5],is=8191&as,os=as>>>13,ss=0|it[6],cs=8191&ss,ds=ss>>>13,ms=0|it[7],vs=8191&ms,_s=ms>>>13,ws=0|it[8],Ts=8191&ws,ks=ws>>>13,Cs=0|it[9],Es=8191&Cs,Ls=Cs>>>13;Qe.negative=Ne.negative^Ge.negative,Qe.length=19;var Ps=(dt+(tt=Math.imul(Dt,ma))|0)+((8191&(rt=(rt=Math.imul(Dt,_a))+Math.imul(Ot,ma)|0))<<13)|0;dt=((nt=Math.imul(Ot,_a))+(rt>>>13)|0)+(Ps>>>26)|0,Ps&=67108863,tt=Math.imul(Zt,ma),rt=(rt=Math.imul(Zt,_a))+Math.imul(er,ma)|0,nt=Math.imul(er,_a);var Ds=(dt+(tt=tt+Math.imul(Dt,Wa)|0)|0)+((8191&(rt=(rt=rt+Math.imul(Dt,Qa)|0)+Math.imul(Ot,Wa)|0))<<13)|0;dt=((nt=nt+Math.imul(Ot,Qa)|0)+(rt>>>13)|0)+(Ds>>>26)|0,Ds&=67108863,tt=Math.imul(mr,ma),rt=(rt=Math.imul(mr,_a))+Math.imul(xr,ma)|0,nt=Math.imul(xr,_a),tt=tt+Math.imul(Zt,Wa)|0,rt=(rt=rt+Math.imul(Zt,Qa)|0)+Math.imul(er,Wa)|0,nt=nt+Math.imul(er,Qa)|0;var Is=(dt+(tt=tt+Math.imul(Dt,ni)|0)|0)+((8191&(rt=(rt=rt+Math.imul(Dt,di)|0)+Math.imul(Ot,ni)|0))<<13)|0;dt=((nt=nt+Math.imul(Ot,di)|0)+(rt>>>13)|0)+(Is>>>26)|0,Is&=67108863,tt=Math.imul(Ar,ma),rt=(rt=Math.imul(Ar,_a))+Math.imul(en,ma)|0,nt=Math.imul(en,_a),tt=tt+Math.imul(mr,Wa)|0,rt=(rt=rt+Math.imul(mr,Qa)|0)+Math.imul(xr,Wa)|0,nt=nt+Math.imul(xr,Qa)|0,tt=tt+Math.imul(Zt,ni)|0,rt=(rt=rt+Math.imul(Zt,di)|0)+Math.imul(er,ni)|0,nt=nt+Math.imul(er,di)|0;var Os=(dt+(tt=tt+Math.imul(Dt,Hi)|0)|0)+((8191&(rt=(rt=rt+Math.imul(Dt,Yi)|0)+Math.imul(Ot,Hi)|0))<<13)|0;dt=((nt=nt+Math.imul(Ot,Yi)|0)+(rt>>>13)|0)+(Os>>>26)|0,Os&=67108863,tt=Math.imul(xn,ma),rt=(rt=Math.imul(xn,_a))+Math.imul(kn,ma)|0,nt=Math.imul(kn,_a),tt=tt+Math.imul(Ar,Wa)|0,rt=(rt=rt+Math.imul(Ar,Qa)|0)+Math.imul(en,Wa)|0,nt=nt+Math.imul(en,Qa)|0,tt=tt+Math.imul(mr,ni)|0,rt=(rt=rt+Math.imul(mr,di)|0)+Math.imul(xr,ni)|0,nt=nt+Math.imul(xr,di)|0,tt=tt+Math.imul(Zt,Hi)|0,rt=(rt=rt+Math.imul(Zt,Yi)|0)+Math.imul(er,Hi)|0,nt=nt+Math.imul(er,Yi)|0;var zs=(dt+(tt=tt+Math.imul(Dt,go)|0)|0)+((8191&(rt=(rt=rt+Math.imul(Dt,ns)|0)+Math.imul(Ot,go)|0))<<13)|0;dt=((nt=nt+Math.imul(Ot,ns)|0)+(rt>>>13)|0)+(zs>>>26)|0,zs&=67108863,tt=Math.imul(En,ma),rt=(rt=Math.imul(En,_a))+Math.imul(Pn,ma)|0,nt=Math.imul(Pn,_a),tt=tt+Math.imul(xn,Wa)|0,rt=(rt=rt+Math.imul(xn,Qa)|0)+Math.imul(kn,Wa)|0,nt=nt+Math.imul(kn,Qa)|0,tt=tt+Math.imul(Ar,ni)|0,rt=(rt=rt+Math.imul(Ar,di)|0)+Math.imul(en,ni)|0,nt=nt+Math.imul(en,di)|0,tt=tt+Math.imul(mr,Hi)|0,rt=(rt=rt+Math.imul(mr,Yi)|0)+Math.imul(xr,Hi)|0,nt=nt+Math.imul(xr,Yi)|0,tt=tt+Math.imul(Zt,go)|0,rt=(rt=rt+Math.imul(Zt,ns)|0)+Math.imul(er,go)|0,nt=nt+Math.imul(er,ns)|0;var Rs=(dt+(tt=tt+Math.imul(Dt,is)|0)|0)+((8191&(rt=(rt=rt+Math.imul(Dt,os)|0)+Math.imul(Ot,is)|0))<<13)|0;dt=((nt=nt+Math.imul(Ot,os)|0)+(rt>>>13)|0)+(Rs>>>26)|0,Rs&=67108863,tt=Math.imul(In,ma),rt=(rt=Math.imul(In,_a))+Math.imul(zn,ma)|0,nt=Math.imul(zn,_a),tt=tt+Math.imul(En,Wa)|0,rt=(rt=rt+Math.imul(En,Qa)|0)+Math.imul(Pn,Wa)|0,nt=nt+Math.imul(Pn,Qa)|0,tt=tt+Math.imul(xn,ni)|0,rt=(rt=rt+Math.imul(xn,di)|0)+Math.imul(kn,ni)|0,nt=nt+Math.imul(kn,di)|0,tt=tt+Math.imul(Ar,Hi)|0,rt=(rt=rt+Math.imul(Ar,Yi)|0)+Math.imul(en,Hi)|0,nt=nt+Math.imul(en,Yi)|0,tt=tt+Math.imul(mr,go)|0,rt=(rt=rt+Math.imul(mr,ns)|0)+Math.imul(xr,go)|0,nt=nt+Math.imul(xr,ns)|0,tt=tt+Math.imul(Zt,is)|0,rt=(rt=rt+Math.imul(Zt,os)|0)+Math.imul(er,is)|0,nt=nt+Math.imul(er,os)|0;var Bs=(dt+(tt=tt+Math.imul(Dt,cs)|0)|0)+((8191&(rt=(rt=rt+Math.imul(Dt,ds)|0)+Math.imul(Ot,cs)|0))<<13)|0;dt=((nt=nt+Math.imul(Ot,ds)|0)+(rt>>>13)|0)+(Bs>>>26)|0,Bs&=67108863,tt=Math.imul(Vn,ma),rt=(rt=Math.imul(Vn,_a))+Math.imul(Hn,ma)|0,nt=Math.imul(Hn,_a),tt=tt+Math.imul(In,Wa)|0,rt=(rt=rt+Math.imul(In,Qa)|0)+Math.imul(zn,Wa)|0,nt=nt+Math.imul(zn,Qa)|0,tt=tt+Math.imul(En,ni)|0,rt=(rt=rt+Math.imul(En,di)|0)+Math.imul(Pn,ni)|0,nt=nt+Math.imul(Pn,di)|0,tt=tt+Math.imul(xn,Hi)|0,rt=(rt=rt+Math.imul(xn,Yi)|0)+Math.imul(kn,Hi)|0,nt=nt+Math.imul(kn,Yi)|0,tt=tt+Math.imul(Ar,go)|0,rt=(rt=rt+Math.imul(Ar,ns)|0)+Math.imul(en,go)|0,nt=nt+Math.imul(en,ns)|0,tt=tt+Math.imul(mr,is)|0,rt=(rt=rt+Math.imul(mr,os)|0)+Math.imul(xr,is)|0,nt=nt+Math.imul(xr,os)|0,tt=tt+Math.imul(Zt,cs)|0,rt=(rt=rt+Math.imul(Zt,ds)|0)+Math.imul(er,cs)|0,nt=nt+Math.imul(er,ds)|0;var Fs=(dt+(tt=tt+Math.imul(Dt,vs)|0)|0)+((8191&(rt=(rt=rt+Math.imul(Dt,_s)|0)+Math.imul(Ot,vs)|0))<<13)|0;dt=((nt=nt+Math.imul(Ot,_s)|0)+(rt>>>13)|0)+(Fs>>>26)|0,Fs&=67108863,tt=Math.imul(Yn,ma),rt=(rt=Math.imul(Yn,_a))+Math.imul($n,ma)|0,nt=Math.imul($n,_a),tt=tt+Math.imul(Vn,Wa)|0,rt=(rt=rt+Math.imul(Vn,Qa)|0)+Math.imul(Hn,Wa)|0,nt=nt+Math.imul(Hn,Qa)|0,tt=tt+Math.imul(In,ni)|0,rt=(rt=rt+Math.imul(In,di)|0)+Math.imul(zn,ni)|0,nt=nt+Math.imul(zn,di)|0,tt=tt+Math.imul(En,Hi)|0,rt=(rt=rt+Math.imul(En,Yi)|0)+Math.imul(Pn,Hi)|0,nt=nt+Math.imul(Pn,Yi)|0,tt=tt+Math.imul(xn,go)|0,rt=(rt=rt+Math.imul(xn,ns)|0)+Math.imul(kn,go)|0,nt=nt+Math.imul(kn,ns)|0,tt=tt+Math.imul(Ar,is)|0,rt=(rt=rt+Math.imul(Ar,os)|0)+Math.imul(en,is)|0,nt=nt+Math.imul(en,os)|0,tt=tt+Math.imul(mr,cs)|0,rt=(rt=rt+Math.imul(mr,ds)|0)+Math.imul(xr,cs)|0,nt=nt+Math.imul(xr,ds)|0,tt=tt+Math.imul(Zt,vs)|0,rt=(rt=rt+Math.imul(Zt,_s)|0)+Math.imul(er,vs)|0,nt=nt+Math.imul(er,_s)|0;var js=(dt+(tt=tt+Math.imul(Dt,Ts)|0)|0)+((8191&(rt=(rt=rt+Math.imul(Dt,ks)|0)+Math.imul(Ot,Ts)|0))<<13)|0;dt=((nt=nt+Math.imul(Ot,ks)|0)+(rt>>>13)|0)+(js>>>26)|0,js&=67108863,tt=Math.imul(oa,ma),rt=(rt=Math.imul(oa,_a))+Math.imul(pa,ma)|0,nt=Math.imul(pa,_a),tt=tt+Math.imul(Yn,Wa)|0,rt=(rt=rt+Math.imul(Yn,Qa)|0)+Math.imul($n,Wa)|0,nt=nt+Math.imul($n,Qa)|0,tt=tt+Math.imul(Vn,ni)|0,rt=(rt=rt+Math.imul(Vn,di)|0)+Math.imul(Hn,ni)|0,nt=nt+Math.imul(Hn,di)|0,tt=tt+Math.imul(In,Hi)|0,rt=(rt=rt+Math.imul(In,Yi)|0)+Math.imul(zn,Hi)|0,nt=nt+Math.imul(zn,Yi)|0,tt=tt+Math.imul(En,go)|0,rt=(rt=rt+Math.imul(En,ns)|0)+Math.imul(Pn,go)|0,nt=nt+Math.imul(Pn,ns)|0,tt=tt+Math.imul(xn,is)|0,rt=(rt=rt+Math.imul(xn,os)|0)+Math.imul(kn,is)|0,nt=nt+Math.imul(kn,os)|0,tt=tt+Math.imul(Ar,cs)|0,rt=(rt=rt+Math.imul(Ar,ds)|0)+Math.imul(en,cs)|0,nt=nt+Math.imul(en,ds)|0,tt=tt+Math.imul(mr,vs)|0,rt=(rt=rt+Math.imul(mr,_s)|0)+Math.imul(xr,vs)|0,nt=nt+Math.imul(xr,_s)|0,tt=tt+Math.imul(Zt,Ts)|0,rt=(rt=rt+Math.imul(Zt,ks)|0)+Math.imul(er,Ts)|0,nt=nt+Math.imul(er,ks)|0;var Zs=(dt+(tt=tt+Math.imul(Dt,Es)|0)|0)+((8191&(rt=(rt=rt+Math.imul(Dt,Ls)|0)+Math.imul(Ot,Es)|0))<<13)|0;dt=((nt=nt+Math.imul(Ot,Ls)|0)+(rt>>>13)|0)+(Zs>>>26)|0,Zs&=67108863,tt=Math.imul(oa,Wa),rt=(rt=Math.imul(oa,Qa))+Math.imul(pa,Wa)|0,nt=Math.imul(pa,Qa),tt=tt+Math.imul(Yn,ni)|0,rt=(rt=rt+Math.imul(Yn,di)|0)+Math.imul($n,ni)|0,nt=nt+Math.imul($n,di)|0,tt=tt+Math.imul(Vn,Hi)|0,rt=(rt=rt+Math.imul(Vn,Yi)|0)+Math.imul(Hn,Hi)|0,nt=nt+Math.imul(Hn,Yi)|0,tt=tt+Math.imul(In,go)|0,rt=(rt=rt+Math.imul(In,ns)|0)+Math.imul(zn,go)|0,nt=nt+Math.imul(zn,ns)|0,tt=tt+Math.imul(En,is)|0,rt=(rt=rt+Math.imul(En,os)|0)+Math.imul(Pn,is)|0,nt=nt+Math.imul(Pn,os)|0,tt=tt+Math.imul(xn,cs)|0,rt=(rt=rt+Math.imul(xn,ds)|0)+Math.imul(kn,cs)|0,nt=nt+Math.imul(kn,ds)|0,tt=tt+Math.imul(Ar,vs)|0,rt=(rt=rt+Math.imul(Ar,_s)|0)+Math.imul(en,vs)|0,nt=nt+Math.imul(en,_s)|0,tt=tt+Math.imul(mr,Ts)|0,rt=(rt=rt+Math.imul(mr,ks)|0)+Math.imul(xr,Ts)|0,nt=nt+Math.imul(xr,ks)|0;var Ks=(dt+(tt=tt+Math.imul(Zt,Es)|0)|0)+((8191&(rt=(rt=rt+Math.imul(Zt,Ls)|0)+Math.imul(er,Es)|0))<<13)|0;dt=((nt=nt+Math.imul(er,Ls)|0)+(rt>>>13)|0)+(Ks>>>26)|0,Ks&=67108863,tt=Math.imul(oa,ni),rt=(rt=Math.imul(oa,di))+Math.imul(pa,ni)|0,nt=Math.imul(pa,di),tt=tt+Math.imul(Yn,Hi)|0,rt=(rt=rt+Math.imul(Yn,Yi)|0)+Math.imul($n,Hi)|0,nt=nt+Math.imul($n,Yi)|0,tt=tt+Math.imul(Vn,go)|0,rt=(rt=rt+Math.imul(Vn,ns)|0)+Math.imul(Hn,go)|0,nt=nt+Math.imul(Hn,ns)|0,tt=tt+Math.imul(In,is)|0,rt=(rt=rt+Math.imul(In,os)|0)+Math.imul(zn,is)|0,nt=nt+Math.imul(zn,os)|0,tt=tt+Math.imul(En,cs)|0,rt=(rt=rt+Math.imul(En,ds)|0)+Math.imul(Pn,cs)|0,nt=nt+Math.imul(Pn,ds)|0,tt=tt+Math.imul(xn,vs)|0,rt=(rt=rt+Math.imul(xn,_s)|0)+Math.imul(kn,vs)|0,nt=nt+Math.imul(kn,_s)|0,tt=tt+Math.imul(Ar,Ts)|0,rt=(rt=rt+Math.imul(Ar,ks)|0)+Math.imul(en,Ts)|0,nt=nt+Math.imul(en,ks)|0;var al=(dt+(tt=tt+Math.imul(mr,Es)|0)|0)+((8191&(rt=(rt=rt+Math.imul(mr,Ls)|0)+Math.imul(xr,Es)|0))<<13)|0;dt=((nt=nt+Math.imul(xr,Ls)|0)+(rt>>>13)|0)+(al>>>26)|0,al&=67108863,tt=Math.imul(oa,Hi),rt=(rt=Math.imul(oa,Yi))+Math.imul(pa,Hi)|0,nt=Math.imul(pa,Yi),tt=tt+Math.imul(Yn,go)|0,rt=(rt=rt+Math.imul(Yn,ns)|0)+Math.imul($n,go)|0,nt=nt+Math.imul($n,ns)|0,tt=tt+Math.imul(Vn,is)|0,rt=(rt=rt+Math.imul(Vn,os)|0)+Math.imul(Hn,is)|0,nt=nt+Math.imul(Hn,os)|0,tt=tt+Math.imul(In,cs)|0,rt=(rt=rt+Math.imul(In,ds)|0)+Math.imul(zn,cs)|0,nt=nt+Math.imul(zn,ds)|0,tt=tt+Math.imul(En,vs)|0,rt=(rt=rt+Math.imul(En,_s)|0)+Math.imul(Pn,vs)|0,nt=nt+Math.imul(Pn,_s)|0,tt=tt+Math.imul(xn,Ts)|0,rt=(rt=rt+Math.imul(xn,ks)|0)+Math.imul(kn,Ts)|0,nt=nt+Math.imul(kn,ks)|0;var il=(dt+(tt=tt+Math.imul(Ar,Es)|0)|0)+((8191&(rt=(rt=rt+Math.imul(Ar,Ls)|0)+Math.imul(en,Es)|0))<<13)|0;dt=((nt=nt+Math.imul(en,Ls)|0)+(rt>>>13)|0)+(il>>>26)|0,il&=67108863,tt=Math.imul(oa,go),rt=(rt=Math.imul(oa,ns))+Math.imul(pa,go)|0,nt=Math.imul(pa,ns),tt=tt+Math.imul(Yn,is)|0,rt=(rt=rt+Math.imul(Yn,os)|0)+Math.imul($n,is)|0,nt=nt+Math.imul($n,os)|0,tt=tt+Math.imul(Vn,cs)|0,rt=(rt=rt+Math.imul(Vn,ds)|0)+Math.imul(Hn,cs)|0,nt=nt+Math.imul(Hn,ds)|0,tt=tt+Math.imul(In,vs)|0,rt=(rt=rt+Math.imul(In,_s)|0)+Math.imul(zn,vs)|0,nt=nt+Math.imul(zn,_s)|0,tt=tt+Math.imul(En,Ts)|0,rt=(rt=rt+Math.imul(En,ks)|0)+Math.imul(Pn,Ts)|0,nt=nt+Math.imul(Pn,ks)|0;var fl=(dt+(tt=tt+Math.imul(xn,Es)|0)|0)+((8191&(rt=(rt=rt+Math.imul(xn,Ls)|0)+Math.imul(kn,Es)|0))<<13)|0;dt=((nt=nt+Math.imul(kn,Ls)|0)+(rt>>>13)|0)+(fl>>>26)|0,fl&=67108863,tt=Math.imul(oa,is),rt=(rt=Math.imul(oa,os))+Math.imul(pa,is)|0,nt=Math.imul(pa,os),tt=tt+Math.imul(Yn,cs)|0,rt=(rt=rt+Math.imul(Yn,ds)|0)+Math.imul($n,cs)|0,nt=nt+Math.imul($n,ds)|0,tt=tt+Math.imul(Vn,vs)|0,rt=(rt=rt+Math.imul(Vn,_s)|0)+Math.imul(Hn,vs)|0,nt=nt+Math.imul(Hn,_s)|0,tt=tt+Math.imul(In,Ts)|0,rt=(rt=rt+Math.imul(In,ks)|0)+Math.imul(zn,Ts)|0,nt=nt+Math.imul(zn,ks)|0;var dl=(dt+(tt=tt+Math.imul(En,Es)|0)|0)+((8191&(rt=(rt=rt+Math.imul(En,Ls)|0)+Math.imul(Pn,Es)|0))<<13)|0;dt=((nt=nt+Math.imul(Pn,Ls)|0)+(rt>>>13)|0)+(dl>>>26)|0,dl&=67108863,tt=Math.imul(oa,cs),rt=(rt=Math.imul(oa,ds))+Math.imul(pa,cs)|0,nt=Math.imul(pa,ds),tt=tt+Math.imul(Yn,vs)|0,rt=(rt=rt+Math.imul(Yn,_s)|0)+Math.imul($n,vs)|0,nt=nt+Math.imul($n,_s)|0,tt=tt+Math.imul(Vn,Ts)|0,rt=(rt=rt+Math.imul(Vn,ks)|0)+Math.imul(Hn,Ts)|0,nt=nt+Math.imul(Hn,ks)|0;var hl=(dt+(tt=tt+Math.imul(In,Es)|0)|0)+((8191&(rt=(rt=rt+Math.imul(In,Ls)|0)+Math.imul(zn,Es)|0))<<13)|0;dt=((nt=nt+Math.imul(zn,Ls)|0)+(rt>>>13)|0)+(hl>>>26)|0,hl&=67108863,tt=Math.imul(oa,vs),rt=(rt=Math.imul(oa,_s))+Math.imul(pa,vs)|0,nt=Math.imul(pa,_s),tt=tt+Math.imul(Yn,Ts)|0,rt=(rt=rt+Math.imul(Yn,ks)|0)+Math.imul($n,Ts)|0,nt=nt+Math.imul($n,ks)|0;var gl=(dt+(tt=tt+Math.imul(Vn,Es)|0)|0)+((8191&(rt=(rt=rt+Math.imul(Vn,Ls)|0)+Math.imul(Hn,Es)|0))<<13)|0;dt=((nt=nt+Math.imul(Hn,Ls)|0)+(rt>>>13)|0)+(gl>>>26)|0,gl&=67108863,tt=Math.imul(oa,Ts),rt=(rt=Math.imul(oa,ks))+Math.imul(pa,Ts)|0,nt=Math.imul(pa,ks);var ml=(dt+(tt=tt+Math.imul(Yn,Es)|0)|0)+((8191&(rt=(rt=rt+Math.imul(Yn,Ls)|0)+Math.imul($n,Es)|0))<<13)|0;dt=((nt=nt+Math.imul($n,Ls)|0)+(rt>>>13)|0)+(ml>>>26)|0,ml&=67108863;var vl=(dt+(tt=Math.imul(oa,Es))|0)+((8191&(rt=(rt=Math.imul(oa,Ls))+Math.imul(pa,Es)|0))<<13)|0;return dt=((nt=Math.imul(pa,Ls))+(rt>>>13)|0)+(vl>>>26)|0,vl&=67108863,ot[0]=Ps,ot[1]=Ds,ot[2]=Is,ot[3]=Os,ot[4]=zs,ot[5]=Rs,ot[6]=Bs,ot[7]=Fs,ot[8]=js,ot[9]=Zs,ot[10]=Ks,ot[11]=al,ot[12]=il,ot[13]=fl,ot[14]=dl,ot[15]=hl,ot[16]=gl,ot[17]=ml,ot[18]=vl,0!==dt&&(ot[19]=dt,Qe.length++),Qe};function bigMulTo(Ne,Ge,Qe){Qe.negative=Ge.negative^Ne.negative,Qe.length=Ne.length+Ge.length;for(var tt=0,rt=0,nt=0;nt<Qe.length-1;nt++){var at=rt;rt=0;for(var it=67108863&tt,ot=Math.min(nt,Ge.length-1),dt=Math.max(0,nt-Ne.length+1);dt<=ot;dt++){var ht=nt-dt,Dt=(0|Ne.words[ht])*(0|Ge.words[dt]),Ot=67108863&Dt;it=67108863&(Ot=Ot+it|0),rt+=(at=(at=at+(Dt/67108864|0)|0)+(Ot>>>26)|0)>>>26,at&=67108863}Qe.words[nt]=it,tt=at,at=rt}return 0!==tt?Qe.words[nt]=tt:Qe.length--,Qe.strip()}function jumboMulTo(Ne,Ge,Qe){return(new FFTM).mulp(Ne,Ge,Qe)}function FFTM(Ne,Ge){this.x=Ne,this.y=Ge}Math.imul||(comb10MulTo=smallMulTo),BN.prototype.mulTo=function(Ne,Ge){var Qe=this.length+Ne.length;return 10===this.length&&10===Ne.length?comb10MulTo(this,Ne,Ge):Qe<63?smallMulTo(this,Ne,Ge):Qe<1024?bigMulTo(this,Ne,Ge):jumboMulTo(this,Ne,Ge)},FFTM.prototype.makeRBT=function(Ne){for(var Ge=new Array(Ne),Qe=BN.prototype._countBits(Ne)-1,tt=0;tt<Ne;tt++)Ge[tt]=this.revBin(tt,Qe,Ne);return Ge},FFTM.prototype.revBin=function(Ne,Ge,Qe){if(0===Ne||Ne===Qe-1)return Ne;for(var tt=0,rt=0;rt<Ge;rt++)tt|=(1&Ne)<<Ge-rt-1,Ne>>=1;return tt},FFTM.prototype.permute=function(Ne,Ge,Qe,tt,rt,nt){for(var at=0;at<nt;at++)tt[at]=Ge[Ne[at]],rt[at]=Qe[Ne[at]]},FFTM.prototype.transform=function(Ne,Ge,Qe,tt,rt,nt){this.permute(nt,Ne,Ge,Qe,tt,rt);for(var at=1;at<rt;at<<=1)for(var it=at<<1,ot=Math.cos(2*Math.PI/it),dt=Math.sin(2*Math.PI/it),ht=0;ht<rt;ht+=it)for(var Dt=ot,Ot=dt,Rt=0;Rt<at;Rt++){var Zt=Qe[ht+Rt],er=tt[ht+Rt],dr=Qe[ht+Rt+at],mr=tt[ht+Rt+at],xr=Dt*dr-Ot*mr;mr=Dt*mr+Ot*dr,dr=xr,Qe[ht+Rt]=Zt+dr,tt[ht+Rt]=er+mr,Qe[ht+Rt+at]=Zt-dr,tt[ht+Rt+at]=er-mr,Rt!==it&&(xr=ot*Dt-dt*Ot,Ot=ot*Ot+dt*Dt,Dt=xr)}},FFTM.prototype.guessLen13b=function(Ne,Ge){var Qe=1|Math.max(Ge,Ne),tt=1&Qe,rt=0;for(Qe=Qe/2|0;Qe;Qe>>>=1)rt++;return 1<<rt+1+tt},FFTM.prototype.conjugate=function(Ne,Ge,Qe){if(!(Qe<=1))for(var tt=0;tt<Qe/2;tt++){var rt=Ne[tt];Ne[tt]=Ne[Qe-tt-1],Ne[Qe-tt-1]=rt,rt=Ge[tt],Ge[tt]=-Ge[Qe-tt-1],Ge[Qe-tt-1]=-rt}},FFTM.prototype.normalize13b=function(Ne,Ge){for(var Qe=0,tt=0;tt<Ge/2;tt++){var rt=8192*Math.round(Ne[2*tt+1]/Ge)+Math.round(Ne[2*tt]/Ge)+Qe;Ne[tt]=67108863&rt,Qe=rt<67108864?0:rt/67108864|0}return Ne},FFTM.prototype.convert13b=function(Ne,Ge,Qe,tt){for(var rt=0,nt=0;nt<Ge;nt++)rt+=0|Ne[nt],Qe[2*nt]=8191&rt,rt>>>=13,Qe[2*nt+1]=8191&rt,rt>>>=13;for(nt=2*Ge;nt<tt;++nt)Qe[nt]=0;assert(0===rt),assert(0==(-8192&rt))},FFTM.prototype.stub=function(Ne){for(var Ge=new Array(Ne),Qe=0;Qe<Ne;Qe++)Ge[Qe]=0;return Ge},FFTM.prototype.mulp=function(Ne,Ge,Qe){var tt=2*this.guessLen13b(Ne.length,Ge.length),rt=this.makeRBT(tt),nt=this.stub(tt),at=new Array(tt),it=new Array(tt),ot=new Array(tt),dt=new Array(tt),ht=new Array(tt),Dt=new Array(tt),Ot=Qe.words;Ot.length=tt,this.convert13b(Ne.words,Ne.length,at,tt),this.convert13b(Ge.words,Ge.length,dt,tt),this.transform(at,nt,it,ot,tt,rt),this.transform(dt,nt,ht,Dt,tt,rt);for(var Rt=0;Rt<tt;Rt++){var Zt=it[Rt]*ht[Rt]-ot[Rt]*Dt[Rt];ot[Rt]=it[Rt]*Dt[Rt]+ot[Rt]*ht[Rt],it[Rt]=Zt}return this.conjugate(it,ot,tt),this.transform(it,ot,Ot,nt,tt,rt),this.conjugate(Ot,nt,tt),this.normalize13b(Ot,tt),Qe.negative=Ne.negative^Ge.negative,Qe.length=Ne.length+Ge.length,Qe.strip()},BN.prototype.mul=function(Ne){var Ge=new BN(null);return Ge.words=new Array(this.length+Ne.length),this.mulTo(Ne,Ge)},BN.prototype.mulf=function(Ne){var Ge=new BN(null);return Ge.words=new Array(this.length+Ne.length),jumboMulTo(this,Ne,Ge)},BN.prototype.imul=function(Ne){return this.clone().mulTo(Ne,this)},BN.prototype.imuln=function(Ne){assert("number"==typeof Ne),assert(Ne<67108864);for(var Ge=0,Qe=0;Qe<this.length;Qe++){var tt=(0|this.words[Qe])*Ne,rt=(67108863&tt)+(67108863&Ge);Ge>>=26,Ge+=tt/67108864|0,Ge+=rt>>>26,this.words[Qe]=67108863&rt}return 0!==Ge&&(this.words[Qe]=Ge,this.length++),this},BN.prototype.muln=function(Ne){return this.clone().imuln(Ne)},BN.prototype.sqr=function(){return this.mul(this)},BN.prototype.isqr=function(){return this.imul(this.clone())},BN.prototype.pow=function(Ne){var Ge=toBitArray(Ne);if(0===Ge.length)return new BN(1);for(var Qe=this,tt=0;tt<Ge.length&&0===Ge[tt];tt++,Qe=Qe.sqr());if(++tt<Ge.length)for(var rt=Qe.sqr();tt<Ge.length;tt++,rt=rt.sqr())0!==Ge[tt]&&(Qe=Qe.mul(rt));return Qe},BN.prototype.iushln=function(Ne){assert("number"==typeof Ne&&Ne>=0);var Ge,Qe=Ne%26,tt=(Ne-Qe)/26,rt=67108863>>>26-Qe<<26-Qe;if(0!==Qe){var nt=0;for(Ge=0;Ge<this.length;Ge++){var at=this.words[Ge]&rt,it=(0|this.words[Ge])-at<<Qe;this.words[Ge]=it|nt,nt=at>>>26-Qe}nt&&(this.words[Ge]=nt,this.length++)}if(0!==tt){for(Ge=this.length-1;Ge>=0;Ge--)this.words[Ge+tt]=this.words[Ge];for(Ge=0;Ge<tt;Ge++)this.words[Ge]=0;this.length+=tt}return this.strip()},BN.prototype.ishln=function(Ne){return assert(0===this.negative),this.iushln(Ne)},BN.prototype.iushrn=function(Ne,Ge,Qe){var tt;assert("number"==typeof Ne&&Ne>=0),tt=Ge?(Ge-Ge%26)/26:0;var rt=Ne%26,nt=Math.min((Ne-rt)/26,this.length),at=67108863^67108863>>>rt<<rt,it=Qe;if(tt-=nt,tt=Math.max(0,tt),it){for(var ot=0;ot<nt;ot++)it.words[ot]=this.words[ot];it.length=nt}if(0===nt);else if(this.length>nt)for(this.length-=nt,ot=0;ot<this.length;ot++)this.words[ot]=this.words[ot+nt];else this.words[0]=0,this.length=1;var dt=0;for(ot=this.length-1;ot>=0&&(0!==dt||ot>=tt);ot--){var ht=0|this.words[ot];this.words[ot]=dt<<26-rt|ht>>>rt,dt=ht&at}return it&&0!==dt&&(it.words[it.length++]=dt),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},BN.prototype.ishrn=function(Ne,Ge,Qe){return assert(0===this.negative),this.iushrn(Ne,Ge,Qe)},BN.prototype.shln=function(Ne){return this.clone().ishln(Ne)},BN.prototype.ushln=function(Ne){return this.clone().iushln(Ne)},BN.prototype.shrn=function(Ne){return this.clone().ishrn(Ne)},BN.prototype.ushrn=function(Ne){return this.clone().iushrn(Ne)},BN.prototype.testn=function(Ne){assert("number"==typeof Ne&&Ne>=0);var Ge=Ne%26,Qe=(Ne-Ge)/26,tt=1<<Ge;return!(this.length<=Qe||!(this.words[Qe]&tt))},BN.prototype.imaskn=function(Ne){assert("number"==typeof Ne&&Ne>=0);var Ge=Ne%26,Qe=(Ne-Ge)/26;if(assert(0===this.negative,"imaskn works only with positive numbers"),this.length<=Qe)return this;if(0!==Ge&&Qe++,this.length=Math.min(Qe,this.length),0!==Ge){var tt=67108863^67108863>>>Ge<<Ge;this.words[this.length-1]&=tt}return this.strip()},BN.prototype.maskn=function(Ne){return this.clone().imaskn(Ne)},BN.prototype.iaddn=function(Ne){return assert("number"==typeof Ne),assert(Ne<67108864),Ne<0?this.isubn(-Ne):0!==this.negative?1===this.length&&(0|this.words[0])<Ne?(this.words[0]=Ne-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(Ne),this.negative=1,this):this._iaddn(Ne)},BN.prototype._iaddn=function(Ne){this.words[0]+=Ne;for(var Ge=0;Ge<this.length&&this.words[Ge]>=67108864;Ge++)this.words[Ge]-=67108864,Ge===this.length-1?this.words[Ge+1]=1:this.words[Ge+1]++;return this.length=Math.max(this.length,Ge+1),this},BN.prototype.isubn=function(Ne){if(assert("number"==typeof Ne),assert(Ne<67108864),Ne<0)return this.iaddn(-Ne);if(0!==this.negative)return this.negative=0,this.iaddn(Ne),this.negative=1,this;if(this.words[0]-=Ne,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var Ge=0;Ge<this.length&&this.words[Ge]<0;Ge++)this.words[Ge]+=67108864,this.words[Ge+1]-=1;return this.strip()},BN.prototype.addn=function(Ne){return this.clone().iaddn(Ne)},BN.prototype.subn=function(Ne){return this.clone().isubn(Ne)},BN.prototype.iabs=function(){return this.negative=0,this},BN.prototype.abs=function(){return this.clone().iabs()},BN.prototype._ishlnsubmul=function(Ne,Ge,Qe){var tt,rt,nt=Ne.length+Qe;this._expand(nt);var at=0;for(tt=0;tt<Ne.length;tt++){rt=(0|this.words[tt+Qe])+at;var it=(0|Ne.words[tt])*Ge;at=((rt-=67108863&it)>>26)-(it/67108864|0),this.words[tt+Qe]=67108863&rt}for(;tt<this.length-Qe;tt++)at=(rt=(0|this.words[tt+Qe])+at)>>26,this.words[tt+Qe]=67108863&rt;if(0===at)return this.strip();for(assert(-1===at),at=0,tt=0;tt<this.length;tt++)at=(rt=-(0|this.words[tt])+at)>>26,this.words[tt]=67108863&rt;return this.negative=1,this.strip()},BN.prototype._wordDiv=function(Ne,Ge){var Qe=this.length-Ne.length,tt=this.clone(),rt=Ne,nt=0|rt.words[rt.length-1];0!=(Qe=26-this._countBits(nt))&&(rt=rt.ushln(Qe),tt.iushln(Qe),nt=0|rt.words[rt.length-1]);var at,it=tt.length-rt.length;if("mod"!==Ge){(at=new BN(null)).length=it+1,at.words=new Array(at.length);for(var ot=0;ot<at.length;ot++)at.words[ot]=0}var dt=tt.clone()._ishlnsubmul(rt,1,it);0===dt.negative&&(tt=dt,at&&(at.words[it]=1));for(var ht=it-1;ht>=0;ht--){var Dt=67108864*(0|tt.words[rt.length+ht])+(0|tt.words[rt.length+ht-1]);for(Dt=Math.min(Dt/nt|0,67108863),tt._ishlnsubmul(rt,Dt,ht);0!==tt.negative;)Dt--,tt.negative=0,tt._ishlnsubmul(rt,1,ht),tt.isZero()||(tt.negative^=1);at&&(at.words[ht]=Dt)}return at&&at.strip(),tt.strip(),"div"!==Ge&&0!==Qe&&tt.iushrn(Qe),{div:at||null,mod:tt}},BN.prototype.divmod=function(Ne,Ge,Qe){return assert(!Ne.isZero()),this.isZero()?{div:new BN(0),mod:new BN(0)}:0!==this.negative&&0===Ne.negative?(nt=this.neg().divmod(Ne,Ge),"mod"!==Ge&&(tt=nt.div.neg()),"div"!==Ge&&(rt=nt.mod.neg(),Qe&&0!==rt.negative&&rt.iadd(Ne)),{div:tt,mod:rt}):0===this.negative&&0!==Ne.negative?(nt=this.divmod(Ne.neg(),Ge),"mod"!==Ge&&(tt=nt.div.neg()),{div:tt,mod:nt.mod}):0!=(this.negative&Ne.negative)?(nt=this.neg().divmod(Ne.neg(),Ge),"div"!==Ge&&(rt=nt.mod.neg(),Qe&&0!==rt.negative&&rt.isub(Ne)),{div:nt.div,mod:rt}):Ne.length>this.length||this.cmp(Ne)<0?{div:new BN(0),mod:this}:1===Ne.length?"div"===Ge?{div:this.divn(Ne.words[0]),mod:null}:"mod"===Ge?{div:null,mod:new BN(this.modn(Ne.words[0]))}:{div:this.divn(Ne.words[0]),mod:new BN(this.modn(Ne.words[0]))}:this._wordDiv(Ne,Ge);var tt,rt,nt},BN.prototype.div=function(Ne){return this.divmod(Ne,"div",!1).div},BN.prototype.mod=function(Ne){return this.divmod(Ne,"mod",!1).mod},BN.prototype.umod=function(Ne){return this.divmod(Ne,"mod",!0).mod},BN.prototype.divRound=function(Ne){var Ge=this.divmod(Ne);if(Ge.mod.isZero())return Ge.div;var Qe=0!==Ge.div.negative?Ge.mod.isub(Ne):Ge.mod,tt=Ne.ushrn(1),rt=Ne.andln(1),nt=Qe.cmp(tt);return nt<0||1===rt&&0===nt?Ge.div:0!==Ge.div.negative?Ge.div.isubn(1):Ge.div.iaddn(1)},BN.prototype.modn=function(Ne){assert(Ne<=67108863);for(var Ge=(1<<26)%Ne,Qe=0,tt=this.length-1;tt>=0;tt--)Qe=(Ge*Qe+(0|this.words[tt]))%Ne;return Qe},BN.prototype.idivn=function(Ne){assert(Ne<=67108863);for(var Ge=0,Qe=this.length-1;Qe>=0;Qe--){var tt=(0|this.words[Qe])+67108864*Ge;this.words[Qe]=tt/Ne|0,Ge=tt%Ne}return this.strip()},BN.prototype.divn=function(Ne){return this.clone().idivn(Ne)},BN.prototype.egcd=function(Ne){assert(0===Ne.negative),assert(!Ne.isZero());var Ge=this,Qe=Ne.clone();Ge=0!==Ge.negative?Ge.umod(Ne):Ge.clone();for(var tt=new BN(1),rt=new BN(0),nt=new BN(0),at=new BN(1),it=0;Ge.isEven()&&Qe.isEven();)Ge.iushrn(1),Qe.iushrn(1),++it;for(var ot=Qe.clone(),dt=Ge.clone();!Ge.isZero();){for(var ht=0,Dt=1;0==(Ge.words[0]&Dt)&&ht<26;++ht,Dt<<=1);if(ht>0)for(Ge.iushrn(ht);ht-- >0;)(tt.isOdd()||rt.isOdd())&&(tt.iadd(ot),rt.isub(dt)),tt.iushrn(1),rt.iushrn(1);for(var Ot=0,Rt=1;0==(Qe.words[0]&Rt)&&Ot<26;++Ot,Rt<<=1);if(Ot>0)for(Qe.iushrn(Ot);Ot-- >0;)(nt.isOdd()||at.isOdd())&&(nt.iadd(ot),at.isub(dt)),nt.iushrn(1),at.iushrn(1);Ge.cmp(Qe)>=0?(Ge.isub(Qe),tt.isub(nt),rt.isub(at)):(Qe.isub(Ge),nt.isub(tt),at.isub(rt))}return{a:nt,b:at,gcd:Qe.iushln(it)}},BN.prototype._invmp=function(Ne){assert(0===Ne.negative),assert(!Ne.isZero());var Ge=this,Qe=Ne.clone();Ge=0!==Ge.negative?Ge.umod(Ne):Ge.clone();for(var tt,rt=new BN(1),nt=new BN(0),at=Qe.clone();Ge.cmpn(1)>0&&Qe.cmpn(1)>0;){for(var it=0,ot=1;0==(Ge.words[0]&ot)&&it<26;++it,ot<<=1);if(it>0)for(Ge.iushrn(it);it-- >0;)rt.isOdd()&&rt.iadd(at),rt.iushrn(1);for(var dt=0,ht=1;0==(Qe.words[0]&ht)&&dt<26;++dt,ht<<=1);if(dt>0)for(Qe.iushrn(dt);dt-- >0;)nt.isOdd()&&nt.iadd(at),nt.iushrn(1);Ge.cmp(Qe)>=0?(Ge.isub(Qe),rt.isub(nt)):(Qe.isub(Ge),nt.isub(rt))}return(tt=0===Ge.cmpn(1)?rt:nt).cmpn(0)<0&&tt.iadd(Ne),tt},BN.prototype.gcd=function(Ne){if(this.isZero())return Ne.abs();if(Ne.isZero())return this.abs();var Ge=this.clone(),Qe=Ne.clone();Ge.negative=0,Qe.negative=0;for(var tt=0;Ge.isEven()&&Qe.isEven();tt++)Ge.iushrn(1),Qe.iushrn(1);for(;;){for(;Ge.isEven();)Ge.iushrn(1);for(;Qe.isEven();)Qe.iushrn(1);var rt=Ge.cmp(Qe);if(rt<0){var nt=Ge;Ge=Qe,Qe=nt}else if(0===rt||0===Qe.cmpn(1))break;Ge.isub(Qe)}return Qe.iushln(tt)},BN.prototype.invm=function(Ne){return this.egcd(Ne).a.umod(Ne)},BN.prototype.isEven=function(){return 0==(1&this.words[0])},BN.prototype.isOdd=function(){return 1==(1&this.words[0])},BN.prototype.andln=function(Ne){return this.words[0]&Ne},BN.prototype.bincn=function(Ne){assert("number"==typeof Ne);var Ge=Ne%26,Qe=(Ne-Ge)/26,tt=1<<Ge;if(this.length<=Qe)return this._expand(Qe+1),this.words[Qe]|=tt,this;for(var rt=tt,nt=Qe;0!==rt&&nt<this.length;nt++){var at=0|this.words[nt];rt=(at+=rt)>>>26,at&=67108863,this.words[nt]=at}return 0!==rt&&(this.words[nt]=rt,this.length++),this},BN.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},BN.prototype.cmpn=function(Ne){var Ge,Qe=Ne<0;if(0!==this.negative&&!Qe)return-1;if(0===this.negative&&Qe)return 1;if(this.strip(),this.length>1)Ge=1;else{Qe&&(Ne=-Ne),assert(Ne<=67108863,"Number is too big");var tt=0|this.words[0];Ge=tt===Ne?0:tt<Ne?-1:1}return 0!==this.negative?0|-Ge:Ge},BN.prototype.cmp=function(Ne){if(0!==this.negative&&0===Ne.negative)return-1;if(0===this.negative&&0!==Ne.negative)return 1;var Ge=this.ucmp(Ne);return 0!==this.negative?0|-Ge:Ge},BN.prototype.ucmp=function(Ne){if(this.length>Ne.length)return 1;if(this.length<Ne.length)return-1;for(var Ge=0,Qe=this.length-1;Qe>=0;Qe--){var tt=0|this.words[Qe],rt=0|Ne.words[Qe];if(tt!==rt){tt<rt?Ge=-1:tt>rt&&(Ge=1);break}}return Ge},BN.prototype.gtn=function(Ne){return 1===this.cmpn(Ne)},BN.prototype.gt=function(Ne){return 1===this.cmp(Ne)},BN.prototype.gten=function(Ne){return this.cmpn(Ne)>=0},BN.prototype.gte=function(Ne){return this.cmp(Ne)>=0},BN.prototype.ltn=function(Ne){return-1===this.cmpn(Ne)},BN.prototype.lt=function(Ne){return-1===this.cmp(Ne)},BN.prototype.lten=function(Ne){return this.cmpn(Ne)<=0},BN.prototype.lte=function(Ne){return this.cmp(Ne)<=0},BN.prototype.eqn=function(Ne){return 0===this.cmpn(Ne)},BN.prototype.eq=function(Ne){return 0===this.cmp(Ne)},BN.red=function(Ne){return new Red(Ne)},BN.prototype.toRed=function(Ne){return assert(!this.red,"Already a number in reduction context"),assert(0===this.negative,"red works only with positives"),Ne.convertTo(this)._forceRed(Ne)},BN.prototype.fromRed=function(){return assert(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},BN.prototype._forceRed=function(Ne){return this.red=Ne,this},BN.prototype.forceRed=function(Ne){return assert(!this.red,"Already a number in reduction context"),this._forceRed(Ne)},BN.prototype.redAdd=function(Ne){return assert(this.red,"redAdd works only with red numbers"),this.red.add(this,Ne)},BN.prototype.redIAdd=function(Ne){return assert(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,Ne)},BN.prototype.redSub=function(Ne){return assert(this.red,"redSub works only with red numbers"),this.red.sub(this,Ne)},BN.prototype.redISub=function(Ne){return assert(this.red,"redISub works only with red numbers"),this.red.isub(this,Ne)},BN.prototype.redShl=function(Ne){return assert(this.red,"redShl works only with red numbers"),this.red.shl(this,Ne)},BN.prototype.redMul=function(Ne){return assert(this.red,"redMul works only with red numbers"),this.red._verify2(this,Ne),this.red.mul(this,Ne)},BN.prototype.redIMul=function(Ne){return assert(this.red,"redMul works only with red numbers"),this.red._verify2(this,Ne),this.red.imul(this,Ne)},BN.prototype.redSqr=function(){return assert(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},BN.prototype.redISqr=function(){return assert(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},BN.prototype.redSqrt=function(){return assert(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},BN.prototype.redInvm=function(){return assert(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},BN.prototype.redNeg=function(){return assert(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},BN.prototype.redPow=function(Ne){return assert(this.red&&!Ne.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,Ne)};var it={k256:null,p224:null,p192:null,p25519:null};function MPrime(Ne,Ge){this.name=Ne,this.p=new BN(Ge,16),this.n=this.p.bitLength(),this.k=new BN(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function K256(){MPrime.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function P224(){MPrime.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function P192(){MPrime.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function P25519(){MPrime.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function Red(Ne){if("string"==typeof Ne){var Ge=BN._prime(Ne);this.m=Ge.p,this.prime=Ge}else assert(Ne.gtn(1),"modulus must be greater than 1"),this.m=Ne,this.prime=null}function Mont(Ne){Red.call(this,Ne),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new BN(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}MPrime.prototype._tmp=function(){var Ne=new BN(null);return Ne.words=new Array(Math.ceil(this.n/13)),Ne},MPrime.prototype.ireduce=function(Ne){var Ge,Qe=Ne;do{this.split(Qe,this.tmp),Ge=(Qe=(Qe=this.imulK(Qe)).iadd(this.tmp)).bitLength()}while(Ge>this.n);var tt=Ge<this.n?-1:Qe.ucmp(this.p);return 0===tt?(Qe.words[0]=0,Qe.length=1):tt>0?Qe.isub(this.p):Qe.strip(),Qe},MPrime.prototype.split=function(Ne,Ge){Ne.iushrn(this.n,0,Ge)},MPrime.prototype.imulK=function(Ne){return Ne.imul(this.k)},inherits(K256,MPrime),K256.prototype.split=function(Ne,Ge){for(var Qe=4194303,tt=Math.min(Ne.length,9),rt=0;rt<tt;rt++)Ge.words[rt]=Ne.words[rt];if(Ge.length=tt,Ne.length<=9)return Ne.words[0]=0,void(Ne.length=1);var nt=Ne.words[9];for(Ge.words[Ge.length++]=nt&Qe,rt=10;rt<Ne.length;rt++){var at=0|Ne.words[rt];Ne.words[rt-10]=(at&Qe)<<4|nt>>>22,nt=at}nt>>>=22,Ne.words[rt-10]=nt,0===nt&&Ne.length>10?Ne.length-=10:Ne.length-=9},K256.prototype.imulK=function(Ne){Ne.words[Ne.length]=0,Ne.words[Ne.length+1]=0,Ne.length+=2;for(var Ge=0,Qe=0;Qe<Ne.length;Qe++){var tt=0|Ne.words[Qe];Ge+=977*tt,Ne.words[Qe]=67108863&Ge,Ge=64*tt+(Ge/67108864|0)}return 0===Ne.words[Ne.length-1]&&(Ne.length--,0===Ne.words[Ne.length-1]&&Ne.length--),Ne},inherits(P224,MPrime),inherits(P192,MPrime),inherits(P25519,MPrime),P25519.prototype.imulK=function(Ne){for(var Ge=0,Qe=0;Qe<Ne.length;Qe++){var tt=19*(0|Ne.words[Qe])+Ge,rt=67108863&tt;tt>>>=26,Ne.words[Qe]=rt,Ge=tt}return 0!==Ge&&(Ne.words[Ne.length++]=Ge),Ne},BN._prime=function(Ne){if(it[Ne])return it[Ne];var Ge;if("k256"===Ne)Ge=new K256;else if("p224"===Ne)Ge=new P224;else if("p192"===Ne)Ge=new P192;else{if("p25519"!==Ne)throw new Error("Unknown prime "+Ne);Ge=new P25519}return it[Ne]=Ge,Ge},Red.prototype._verify1=function(Ne){assert(0===Ne.negative,"red works only with positives"),assert(Ne.red,"red works only with red numbers")},Red.prototype._verify2=function(Ne,Ge){assert(0==(Ne.negative|Ge.negative),"red works only with positives"),assert(Ne.red&&Ne.red===Ge.red,"red works only with red numbers")},Red.prototype.imod=function(Ne){return this.prime?this.prime.ireduce(Ne)._forceRed(this):Ne.umod(this.m)._forceRed(this)},Red.prototype.neg=function(Ne){return Ne.isZero()?Ne.clone():this.m.sub(Ne)._forceRed(this)},Red.prototype.add=function(Ne,Ge){this._verify2(Ne,Ge);var Qe=Ne.add(Ge);return Qe.cmp(this.m)>=0&&Qe.isub(this.m),Qe._forceRed(this)},Red.prototype.iadd=function(Ne,Ge){this._verify2(Ne,Ge);var Qe=Ne.iadd(Ge);return Qe.cmp(this.m)>=0&&Qe.isub(this.m),Qe},Red.prototype.sub=function(Ne,Ge){this._verify2(Ne,Ge);var Qe=Ne.sub(Ge);return Qe.cmpn(0)<0&&Qe.iadd(this.m),Qe._forceRed(this)},Red.prototype.isub=function(Ne,Ge){this._verify2(Ne,Ge);var Qe=Ne.isub(Ge);return Qe.cmpn(0)<0&&Qe.iadd(this.m),Qe},Red.prototype.shl=function(Ne,Ge){return this._verify1(Ne),this.imod(Ne.ushln(Ge))},Red.prototype.imul=function(Ne,Ge){return this._verify2(Ne,Ge),this.imod(Ne.imul(Ge))},Red.prototype.mul=function(Ne,Ge){return this._verify2(Ne,Ge),this.imod(Ne.mul(Ge))},Red.prototype.isqr=function(Ne){return this.imul(Ne,Ne.clone())},Red.prototype.sqr=function(Ne){return this.mul(Ne,Ne)},Red.prototype.sqrt=function(Ne){if(Ne.isZero())return Ne.clone();var Ge=this.m.andln(3);if(assert(Ge%2==1),3===Ge){var Qe=this.m.add(new BN(1)).iushrn(2);return this.pow(Ne,Qe)}for(var tt=this.m.subn(1),rt=0;!tt.isZero()&&0===tt.andln(1);)rt++,tt.iushrn(1);assert(!tt.isZero());var nt=new BN(1).toRed(this),at=nt.redNeg(),it=this.m.subn(1).iushrn(1),ot=this.m.bitLength();for(ot=new BN(2*ot*ot).toRed(this);0!==this.pow(ot,it).cmp(at);)ot.redIAdd(at);for(var dt=this.pow(ot,tt),ht=this.pow(Ne,tt.addn(1).iushrn(1)),Dt=this.pow(Ne,tt),Ot=rt;0!==Dt.cmp(nt);){for(var Rt=Dt,Zt=0;0!==Rt.cmp(nt);Zt++)Rt=Rt.redSqr();assert(Zt<Ot);var er=this.pow(dt,new BN(1).iushln(Ot-Zt-1));ht=ht.redMul(er),dt=er.redSqr(),Dt=Dt.redMul(dt),Ot=Zt}return ht},Red.prototype.invm=function(Ne){var Ge=Ne._invmp(this.m);return 0!==Ge.negative?(Ge.negative=0,this.imod(Ge).redNeg()):this.imod(Ge)},Red.prototype.pow=function(Ne,Ge){if(Ge.isZero())return new BN(1).toRed(this);if(0===Ge.cmpn(1))return Ne.clone();var Qe=4,tt=new Array(1<<Qe);tt[0]=new BN(1).toRed(this),tt[1]=Ne;for(var rt=2;rt<tt.length;rt++)tt[rt]=this.mul(tt[rt-1],Ne);var nt=tt[0],at=0,it=0,ot=Ge.bitLength()%26;for(0===ot&&(ot=26),rt=Ge.length-1;rt>=0;rt--){for(var dt=Ge.words[rt],ht=ot-1;ht>=0;ht--){var Dt=dt>>ht&1;nt!==tt[0]&&(nt=this.sqr(nt)),0!==Dt||0!==at?(at<<=1,at|=Dt,(++it===Qe||0===rt&&0===ht)&&(nt=this.mul(nt,tt[at]),it=0,at=0)):it=0}ot=26}return nt},Red.prototype.convertTo=function(Ne){var Ge=Ne.umod(this.m);return Ge===Ne?Ge.clone():Ge},Red.prototype.convertFrom=function(Ne){var Ge=Ne.clone();return Ge.red=null,Ge},BN.mont=function(Ne){return new Mont(Ne)},inherits(Mont,Red),Mont.prototype.convertTo=function(Ne){return this.imod(Ne.ushln(this.shift))},Mont.prototype.convertFrom=function(Ne){var Ge=this.imod(Ne.mul(this.rinv));return Ge.red=null,Ge},Mont.prototype.imul=function(Ne,Ge){if(Ne.isZero()||Ge.isZero())return Ne.words[0]=0,Ne.length=1,Ne;var Qe=Ne.imul(Ge),tt=Qe.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),rt=Qe.isub(tt).iushrn(this.shift),nt=rt;return rt.cmp(this.m)>=0?nt=rt.isub(this.m):rt.cmpn(0)<0&&(nt=rt.iadd(this.m)),nt._forceRed(this)},Mont.prototype.mul=function(Ne,Ge){if(Ne.isZero()||Ge.isZero())return new BN(0)._forceRed(this);var Qe=Ne.mul(Ge),tt=Qe.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),rt=Qe.isub(tt).iushrn(this.shift),nt=rt;return rt.cmp(this.m)>=0?nt=rt.isub(this.m):rt.cmpn(0)<0&&(nt=rt.iadd(this.m)),nt._forceRed(this)},Mont.prototype.invm=function(Ne){return this.imod(Ne._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===Ge||Ge,this)},{buffer:108}],100:[function(Ne,Ge,Qe){"use strict";function boundary(Ne){var Ge,Qe,tt,rt=Ne.length,nt=0;for(Ge=0;Ge<rt;++Ge)nt+=Ne[Ge].length;var at=new Array(nt),it=0;for(Ge=0;Ge<rt;++Ge){var ot=Ne[Ge],dt=ot.length;for(Qe=0;Qe<dt;++Qe){var ht=at[it++]=new Array(dt-1),Dt=0;for(tt=0;tt<dt;++tt)tt!==Qe&&(ht[Dt++]=ot[tt]);if(1&Qe){var Ot=ht[1];ht[1]=ht[0],ht[0]=Ot}}}return at}Ge.exports=boundary},{}],101:[function(Ne,Ge,Qe){"use strict";Ge.exports=boxIntersectWrapper;var tt,rt=Ne("typedarray-pool"),nt=Ne("./lib/sweep"),at=Ne("./lib/intersect");function boxEmpty(Ne,Ge){for(var Qe=0;Qe<Ne;++Qe)if(!(Ge[Qe]<=Ge[Qe+Ne]))return!0;return!1}function convertBoxes(Ne,Ge,Qe,tt){for(var rt=0,nt=0,at=0,it=Ne.length;at<it;++at){var ot=Ne[at];if(!boxEmpty(Ge,ot)){for(var dt=0;dt<2*Ge;++dt)Qe[rt++]=ot[dt];tt[nt++]=at}}return nt}function boxIntersect(Ne,Ge,Qe,tt){var it=Ne.length,ot=Ge.length;if(!(it<=0||ot<=0)){var dt=Ne[0].length>>>1;if(!(dt<=0)){var ht,Dt=rt.mallocDouble(2*dt*it),Ot=rt.mallocInt32(it);if((it=convertBoxes(Ne,dt,Dt,Ot))>0){if(1===dt&&tt)nt.init(it),ht=nt.sweepComplete(dt,Qe,0,it,Dt,Ot,0,it,Dt,Ot);else{var Rt=rt.mallocDouble(2*dt*ot),Zt=rt.mallocInt32(ot);(ot=convertBoxes(Ge,dt,Rt,Zt))>0&&(nt.init(it+ot),ht=1===dt?nt.sweepBipartite(dt,Qe,0,it,Dt,Ot,0,ot,Rt,Zt):at(dt,Qe,tt,it,Dt,Ot,ot,Rt,Zt),rt.free(Rt),rt.free(Zt))}rt.free(Dt),rt.free(Ot)}return ht}}}function appendItem(Ne,Ge){tt.push([Ne,Ge])}function intersectFullArray(Ne){return tt=[],boxIntersect(Ne,Ne,appendItem,!0),tt}function intersectBipartiteArray(Ne,Ge){return tt=[],boxIntersect(Ne,Ge,appendItem,!1),tt}function boxIntersectWrapper(Ne,Ge,Qe){switch(arguments.length){case 1:return intersectFullArray(Ne);case 2:return"function"==typeof Ge?boxIntersect(Ne,Ne,Ge,!0):intersectBipartiteArray(Ne,Ge);case 3:return boxIntersect(Ne,Ge,Qe,!1);default:throw new Error("box-intersect: Invalid arguments")}}},{"./lib/intersect":103,"./lib/sweep":107,"typedarray-pool":595}],102:[function(Ne,Ge,Qe){"use strict";var tt="d",rt="ax",nt="vv",at="fp",it="es",ot="rs",dt="re",ht="rb",Dt="ri",Ot="rp",Rt="bs",Zt="be",er="bb",dr="bi",mr="bp",xr="rv",br="Q",Ar=[tt,rt,nt,ot,dt,ht,Dt,Rt,Zt,er,dr];function generateBruteForce(Ne,Ge,Qe){var at="bruteForce"+(Ne?"Red":"Blue")+(Ge?"Flip":"")+(Qe?"Full":""),en=["function ",at,"(",Ar.join(),"){","var ",it,"=2*",tt,";"],mn="for(var i="+ot+","+Ot+"="+it+"*"+ot+";i<"+dt+";++i,"+Ot+"+="+it+"){var x0="+ht+"["+rt+"+"+Ot+"],x1="+ht+"["+rt+"+"+Ot+"+"+tt+"],xi="+Dt+"[i];",xn="for(var j="+Rt+","+mr+"="+it+"*"+Rt+";j<"+Zt+";++j,"+mr+"+="+it+"){var y0="+er+"["+rt+"+"+mr+"],"+(Qe?"y1="+er+"["+rt+"+"+mr+"+"+tt+"],":"")+"yi="+dr+"[j];";return Ne?en.push(mn,br,":",xn):en.push(xn,br,":",mn),Qe?en.push("if(y1<x0||x1<y0)continue;"):Ge?en.push("if(y0<=x0||x1<y0)continue;"):en.push("if(y0<x0||x1<y0)continue;"),en.push("for(var k="+rt+"+1;k<"+tt+";++k){var r0="+ht+"[k+"+Ot+"],r1="+ht+"[k+"+tt+"+"+Ot+"],b0="+er+"[k+"+mr+"],b1="+er+"[k+"+tt+"+"+mr+"];if(r1<b0||b1<r0)continue "+br+";}var "+xr+"="+nt+"("),Ge?en.push("yi,xi"):en.push("xi,yi"),en.push(");if("+xr+"!==void 0)return "+xr+";}}}"),{name:at,code:en.join("")}}function bruteForcePlanner(Ne){var Ge="bruteForce"+(Ne?"Full":"Partial"),Qe=[],tt=Ar.slice();Ne||tt.splice(3,0,at);var rt=["function "+Ge+"("+tt.join()+"){"];function invoke(Ge,tt){var nt=generateBruteForce(Ge,tt,Ne);Qe.push(nt.code),rt.push("return "+nt.name+"("+Ar.join()+");")}rt.push("if("+dt+"-"+ot+">"+Zt+"-"+Rt+"){"),Ne?(invoke(!0,!1),rt.push("}else{"),invoke(!1,!1)):(rt.push("if("+at+"){"),invoke(!0,!0),rt.push("}else{"),invoke(!0,!1),rt.push("}}else{if("+at+"){"),invoke(!1,!0),rt.push("}else{"),invoke(!1,!1),rt.push("}")),rt.push("}}return "+Ge);var nt=Qe.join("")+rt.join("");return new Function(nt)()}Qe.partial=bruteForcePlanner(!1),Qe.full=bruteForcePlanner(!0)},{}],103:[function(Ne,Ge,Qe){"use strict";Ge.exports=boxIntersectIter;var tt=Ne("typedarray-pool"),rt=Ne("bit-twiddle"),nt=Ne("./brute"),at=nt.partial,it=nt.full,ot=Ne("./sweep"),dt=Ne("./median"),ht=Ne("./partition"),Dt=128,Ot=1<<22,Rt=1<<22,Zt=ht("!(lo>=p0)&&!(p1>=hi)",["p0","p1"]),er=ht("lo===p0",["p0"]),dr=ht("lo<p0",["p0"]),mr=ht("hi<=p0",["p0"]),xr=ht("lo<=p0&&p0<=hi",["p0"]),br=ht("lo<p0&&p0<=hi",["p0"]),Ar=6,en=2,mn=1024,xn=tt.mallocInt32(mn),kn=tt.mallocDouble(mn);function iterInit(Ne,Ge){var Qe=8*rt.log2(Ge+1)*(Ne+1)|0,nt=rt.nextPow2(Ar*Qe);xn.length<nt&&(tt.free(xn),xn=tt.mallocInt32(nt));var at=rt.nextPow2(en*Qe);kn.length<at&&(tt.free(kn),kn=tt.mallocDouble(at))}function iterPush(Ne,Ge,Qe,tt,rt,nt,at,it,ot){var dt=Ar*Ne;xn[dt]=Ge,xn[dt+1]=Qe,xn[dt+2]=tt,xn[dt+3]=rt,xn[dt+4]=nt,xn[dt+5]=at;var ht=en*Ne;kn[ht]=it,kn[ht+1]=ot}function onePointPartial(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht){var Dt=2*Ne,Ot=ot*Dt,Rt=dt[Ot+Ge];e:for(var Zt=rt,er=rt*Dt;Zt<nt;++Zt,er+=Dt){var dr=at[er+Ge],mr=at[er+Ge+Ne];if(!(Rt<dr||mr<Rt||tt&&Rt===dr)){for(var xr,br=it[Zt],Ar=Ge+1;Ar<Ne;++Ar){dr=at[er+Ar],mr=at[er+Ar+Ne];var en=dt[Ot+Ar],mn=dt[Ot+Ar+Ne];if(mr<en||mn<dr)continue e}if(void 0!==(xr=tt?Qe(ht,br):Qe(br,ht)))return xr}}}function onePointFull(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt){var ht=2*Ne,Dt=it*ht,Ot=ot[Dt+Ge];e:for(var Rt=tt,Zt=tt*ht;Rt<rt;++Rt,Zt+=ht){var er=at[Rt];if(er!==dt){var dr=nt[Zt+Ge],mr=nt[Zt+Ge+Ne];if(!(Ot<dr||mr<Ot)){for(var xr=Ge+1;xr<Ne;++xr){dr=nt[Zt+xr],mr=nt[Zt+xr+Ne];var br=ot[Dt+xr],Ar=ot[Dt+xr+Ne];if(mr<br||Ar<dr)continue e}var en=Qe(er,dt);if(void 0!==en)return en}}}}function boxIntersectIter(Ne,Ge,Qe,tt,rt,nt,ht,mn,Cn){iterInit(Ne,tt+ht);var En,Pn=0,Dn=2*Ne;for(iterPush(Pn++,0,0,tt,0,ht,Qe?16:0,-1/0,1/0),Qe||iterPush(Pn++,0,0,ht,0,tt,1,-1/0,1/0);Pn>0;){var In=(Pn-=1)*Ar,zn=xn[In],Bn=xn[In+1],Vn=xn[In+2],Hn=xn[In+3],qn=xn[In+4],Yn=xn[In+5],$n=Pn*en,ra=kn[$n],oa=kn[$n+1],pa=1&Yn,ga=!!(16&Yn),ma=rt,_a=nt,Va=mn,Wa=Cn;if(pa&&(ma=mn,_a=Cn,Va=rt,Wa=nt),!(2&Yn&&Bn>=(Vn=dr(Ne,zn,Bn,Vn,ma,_a,oa))||4&Yn&&(Bn=mr(Ne,zn,Bn,Vn,ma,_a,ra))>=Vn)){var Qa=Vn-Bn,ti=qn-Hn;if(ga){if(Ne*Qa*(Qa+ti)<Rt){if(void 0!==(En=ot.scanComplete(Ne,zn,Ge,Bn,Vn,ma,_a,Hn,qn,Va,Wa)))return En;continue}}else{if(Ne*Math.min(Qa,ti)<Dt){if(void 0!==(En=at(Ne,zn,Ge,pa,Bn,Vn,ma,_a,Hn,qn,Va,Wa)))return En;continue}if(Ne*Qa*ti<Ot){if(void 0!==(En=ot.scanBipartite(Ne,zn,Ge,pa,Bn,Vn,ma,_a,Hn,qn,Va,Wa)))return En;continue}}var ni=Zt(Ne,zn,Bn,Vn,ma,_a,ra,oa);if(Bn<ni)if(Ne*(ni-Bn)<Dt){if(void 0!==(En=it(Ne,zn+1,Ge,Bn,ni,ma,_a,Hn,qn,Va,Wa)))return En}else if(zn===Ne-2){if(void 0!==(En=pa?ot.sweepBipartite(Ne,Ge,Hn,qn,Va,Wa,Bn,ni,ma,_a):ot.sweepBipartite(Ne,Ge,Bn,ni,ma,_a,Hn,qn,Va,Wa)))return En}else iterPush(Pn++,zn+1,Bn,ni,Hn,qn,pa,-1/0,1/0),iterPush(Pn++,zn+1,Hn,qn,Bn,ni,1^pa,-1/0,1/0);if(ni<Vn){var di=dt(Ne,zn,Hn,qn,Va,Wa),ji=Va[Dn*di+zn],Hi=er(Ne,zn,di,qn,Va,Wa,ji);if(Hi<qn&&iterPush(Pn++,zn,ni,Vn,Hi,qn,(4|pa)+(ga?16:0),ji,oa),Hn<di&&iterPush(Pn++,zn,ni,Vn,Hn,di,(2|pa)+(ga?16:0),ra,ji),di+1===Hi){if(void 0!==(En=ga?onePointFull(Ne,zn,Ge,ni,Vn,ma,_a,di,Va,Wa[di]):onePointPartial(Ne,zn,Ge,pa,ni,Vn,ma,_a,di,Va,Wa[di])))return En}else if(di<Hi){var Yi;if(ga){if(ni<(Yi=xr(Ne,zn,ni,Vn,ma,_a,ji))){var uo=er(Ne,zn,ni,Yi,ma,_a,ji);if(zn===Ne-2){if(ni<uo&&void 0!==(En=ot.sweepComplete(Ne,Ge,ni,uo,ma,_a,di,Hi,Va,Wa)))return En;if(uo<Yi&&void 0!==(En=ot.sweepBipartite(Ne,Ge,uo,Yi,ma,_a,di,Hi,Va,Wa)))return En}else ni<uo&&iterPush(Pn++,zn+1,ni,uo,di,Hi,16,-1/0,1/0),uo<Yi&&(iterPush(Pn++,zn+1,uo,Yi,di,Hi,0,-1/0,1/0),iterPush(Pn++,zn+1,di,Hi,uo,Yi,1,-1/0,1/0))}}else ni<(Yi=pa?br(Ne,zn,ni,Vn,ma,_a,ji):xr(Ne,zn,ni,Vn,ma,_a,ji))&&(zn===Ne-2?En=pa?ot.sweepBipartite(Ne,Ge,di,Hi,Va,Wa,ni,Yi,ma,_a):ot.sweepBipartite(Ne,Ge,ni,Yi,ma,_a,di,Hi,Va,Wa):(iterPush(Pn++,zn+1,ni,Yi,di,Hi,pa,-1/0,1/0),iterPush(Pn++,zn+1,di,Hi,ni,Yi,1^pa,-1/0,1/0)))}}}}}},{"./brute":102,"./median":104,"./partition":105,"./sweep":107,"bit-twiddle":97,"typedarray-pool":595}],104:[function(Ne,Ge,Qe){"use strict";Ge.exports=findMedian;var tt=Ne("./partition")("lo<p0",["p0"]),rt=8;function insertionSort(Ne,Ge,Qe,tt,rt,nt){for(var at=2*Ne,it=at*(Qe+1)+Ge,ot=Qe+1;ot<tt;++ot,it+=at)for(var dt=rt[it],ht=ot,Dt=at*(ot-1);ht>Qe&&rt[Dt+Ge]>dt;--ht,Dt-=at){for(var Ot=Dt,Rt=Dt+at,Zt=0;Zt<at;++Zt,++Ot,++Rt){var er=rt[Ot];rt[Ot]=rt[Rt],rt[Rt]=er}var dr=nt[ht];nt[ht]=nt[ht-1],nt[ht-1]=dr}}function findMedian(Ne,Ge,Qe,nt,at,it){if(nt<=Qe+1)return Qe;for(var ot=Qe,dt=nt,ht=nt+Qe>>>1,Dt=2*Ne,Ot=ht,Rt=at[Dt*ht+Ge];ot<dt;){if(dt-ot<rt){insertionSort(Ne,Ge,ot,dt,at,it),Rt=at[Dt*ht+Ge];break}var Zt=dt-ot,er=Math.random()*Zt+ot|0,dr=at[Dt*er+Ge],mr=Math.random()*Zt+ot|0,xr=at[Dt*mr+Ge],br=Math.random()*Zt+ot|0,Ar=at[Dt*br+Ge];dr<=xr?Ar>=xr?(Ot=mr,Rt=xr):dr>=Ar?(Ot=er,Rt=dr):(Ot=br,Rt=Ar):xr>=Ar?(Ot=mr,Rt=xr):Ar>=dr?(Ot=er,Rt=dr):(Ot=br,Rt=Ar);for(var en=Dt*(dt-1),mn=Dt*Ot,xn=0;xn<Dt;++xn,++en,++mn){var kn=at[en];at[en]=at[mn],at[mn]=kn}var Cn=it[dt-1];for(it[dt-1]=it[Ot],it[Ot]=Cn,en=Dt*(dt-1),mn=Dt*(Ot=tt(Ne,Ge,ot,dt-1,at,it,Rt)),xn=0;xn<Dt;++xn,++en,++mn)kn=at[en],at[en]=at[mn],at[mn]=kn;if(Cn=it[dt-1],it[dt-1]=it[Ot],it[Ot]=Cn,ht<Ot){for(dt=Ot-1;ot<dt&&at[Dt*(dt-1)+Ge]===Rt;)dt-=1;dt+=1}else{if(!(Ot<ht))break;for(ot=Ot+1;ot<dt&&at[Dt*ot+Ge]===Rt;)ot+=1}}return tt(Ne,Ge,Qe,ht,at,it,at[Dt*ht+Ge])}},{"./partition":105}],105:[function(Ne,Ge,Qe){"use strict";Ge.exports=genPartition;var tt="for(var j=2*a,k=j*c,l=k,m=c,n=b,o=a+b,p=c;d>p;++p,k+=j){var _;if($)if(m===p)m+=1,l+=j;else{for(var s=0;j>s;++s){var t=e[k+s];e[k+s]=e[l],e[l++]=t}var u=f[p];f[p]=f[m],f[m++]=u}}return m";function genPartition(Ne,Ge){var Qe="abcdef".split("").concat(Ge),rt=[];return Ne.indexOf("lo")>=0&&rt.push("lo=e[k+n]"),Ne.indexOf("hi")>=0&&rt.push("hi=e[k+o]"),Qe.push(tt.replace("_",rt.join()).replace("$",Ne)),Function.apply(void 0,Qe)}},{}],106:[function(Ne,Ge,Qe){"use strict";Ge.exports=wrapper;var tt=32;function wrapper(Ne,Ge){Ge<=4*tt?insertionSort(0,Ge-1,Ne):quickSort(0,Ge-1,Ne)}function insertionSort(Ne,Ge,Qe){for(var tt=2*(Ne+1),rt=Ne+1;rt<=Ge;++rt){for(var nt=Qe[tt++],at=Qe[tt++],it=rt,ot=tt-2;it-- >Ne;){var dt=Qe[ot-2],ht=Qe[ot-1];if(dt<nt)break;if(dt===nt&&ht<at)break;Qe[ot]=dt,Qe[ot+1]=ht,ot-=2}Qe[ot]=nt,Qe[ot+1]=at}}function swap(Ne,Ge,Qe){Ge*=2;var tt=Qe[Ne*=2],rt=Qe[Ne+1];Qe[Ne]=Qe[Ge],Qe[Ne+1]=Qe[Ge+1],Qe[Ge]=tt,Qe[Ge+1]=rt}function move(Ne,Ge,Qe){Ge*=2,Qe[Ne*=2]=Qe[Ge],Qe[Ne+1]=Qe[Ge+1]}function rotate(Ne,Ge,Qe,tt){Ge*=2,Qe*=2;var rt=tt[Ne*=2],nt=tt[Ne+1];tt[Ne]=tt[Ge],tt[Ne+1]=tt[Ge+1],tt[Ge]=tt[Qe],tt[Ge+1]=tt[Qe+1],tt[Qe]=rt,tt[Qe+1]=nt}function shufflePivot(Ne,Ge,Qe,tt,rt){Ge*=2,rt[Ne*=2]=rt[Ge],rt[Ge]=Qe,rt[Ne+1]=rt[Ge+1],rt[Ge+1]=tt}function compare(Ne,Ge,Qe){Ge*=2;var tt=Qe[Ne*=2],rt=Qe[Ge];return!(tt<rt)&&(tt!==rt||Qe[Ne+1]>Qe[Ge+1])}function comparePivot(Ne,Ge,Qe,tt){var rt=tt[Ne*=2];return rt<Ge||rt===Ge&&tt[Ne+1]<Qe}function quickSort(Ne,Ge,Qe){var rt=(Ge-Ne+1)/6|0,nt=Ne+rt,at=Ge-rt,it=Ne+Ge>>1,ot=it-rt,dt=it+rt,ht=nt,Dt=ot,Ot=it,Rt=dt,Zt=at,er=Ne+1,dr=Ge-1,mr=0;compare(ht,Dt,Qe)&&(mr=ht,ht=Dt,Dt=mr),compare(Rt,Zt,Qe)&&(mr=Rt,Rt=Zt,Zt=mr),compare(ht,Ot,Qe)&&(mr=ht,ht=Ot,Ot=mr),compare(Dt,Ot,Qe)&&(mr=Dt,Dt=Ot,Ot=mr),compare(ht,Rt,Qe)&&(mr=ht,ht=Rt,Rt=mr),compare(Ot,Rt,Qe)&&(mr=Ot,Ot=Rt,Rt=mr),compare(Dt,Zt,Qe)&&(mr=Dt,Dt=Zt,Zt=mr),compare(Dt,Ot,Qe)&&(mr=Dt,Dt=Ot,Ot=mr),compare(Rt,Zt,Qe)&&(mr=Rt,Rt=Zt,Zt=mr);for(var xr=Qe[2*Dt],br=Qe[2*Dt+1],Ar=Qe[2*Rt],en=Qe[2*Rt+1],mn=2*ht,xn=2*Ot,kn=2*Zt,Cn=2*nt,En=2*it,Pn=2*at,Dn=0;Dn<2;++Dn){var In=Qe[mn+Dn],zn=Qe[xn+Dn],Bn=Qe[kn+Dn];Qe[Cn+Dn]=In,Qe[En+Dn]=zn,Qe[Pn+Dn]=Bn}move(ot,Ne,Qe),move(dt,Ge,Qe);for(var Vn=er;Vn<=dr;++Vn)if(comparePivot(Vn,xr,br,Qe))Vn!==er&&swap(Vn,er,Qe),++er;else if(!comparePivot(Vn,Ar,en,Qe))for(;;){if(comparePivot(dr,Ar,en,Qe)){comparePivot(dr,xr,br,Qe)?(rotate(Vn,er,dr,Qe),++er,--dr):(swap(Vn,dr,Qe),--dr);break}if(--dr<Vn)break}shufflePivot(Ne,er-1,xr,br,Qe),shufflePivot(Ge,dr+1,Ar,en,Qe),er-2-Ne<=tt?insertionSort(Ne,er-2,Qe):quickSort(Ne,er-2,Qe),Ge-(dr+2)<=tt?insertionSort(dr+2,Ge,Qe):quickSort(dr+2,Ge,Qe),dr-er<=tt?insertionSort(er,dr,Qe):quickSort(er,dr,Qe)}},{}],107:[function(Ne,Ge,Qe){"use strict";Ge.exports={init:sqInit,sweepBipartite:sweepBipartite,sweepComplete:sweepComplete,scanBipartite:scanBipartite,scanComplete:scanComplete};var tt=Ne("typedarray-pool"),rt=Ne("bit-twiddle"),nt=Ne("./sort"),at=1<<28,it=1024,ot=tt.mallocInt32(it),dt=tt.mallocInt32(it),ht=tt.mallocInt32(it),Dt=tt.mallocInt32(it),Ot=tt.mallocInt32(it),Rt=tt.mallocInt32(it),Zt=tt.mallocDouble(8*it);function sqInit(Ne){var Ge=rt.nextPow2(Ne);ot.length<Ge&&(tt.free(ot),ot=tt.mallocInt32(Ge)),dt.length<Ge&&(tt.free(dt),dt=tt.mallocInt32(Ge)),ht.length<Ge&&(tt.free(ht),ht=tt.mallocInt32(Ge)),Dt.length<Ge&&(tt.free(Dt),Dt=tt.mallocInt32(Ge)),Ot.length<Ge&&(tt.free(Ot),Ot=tt.mallocInt32(Ge)),Rt.length<Ge&&(tt.free(Rt),Rt=tt.mallocInt32(Ge));var Qe=8*Ge;Zt.length<Qe&&(tt.free(Zt),Zt=tt.mallocDouble(Qe))}function sqPop(Ne,Ge,Qe,tt){var rt=Ge[tt],nt=Ne[Qe-1];Ne[rt]=nt,Ge[nt]=rt}function sqPush(Ne,Ge,Qe,tt){Ne[Qe]=tt,Ge[tt]=Qe}function sweepBipartite(Ne,Ge,Qe,tt,rt,it,Ot,Rt,er,dr){for(var mr=0,xr=2*Ne,br=Ne-1,Ar=xr-1,en=Qe;en<tt;++en){var mn=it[en],xn=xr*en;Zt[mr++]=rt[xn+br],Zt[mr++]=-(mn+1),Zt[mr++]=rt[xn+Ar],Zt[mr++]=mn}for(en=Ot;en<Rt;++en){mn=dr[en]+at;var kn=xr*en;Zt[mr++]=er[kn+br],Zt[mr++]=-mn,Zt[mr++]=er[kn+Ar],Zt[mr++]=mn}var Cn=mr>>>1;nt(Zt,Cn);var En=0,Pn=0;for(en=0;en<Cn;++en){var Dn=0|Zt[2*en+1];if(Dn>=at)sqPop(ht,Dt,Pn--,Dn=Dn-at|0);else if(Dn>=0)sqPop(ot,dt,En--,Dn);else if(Dn<=-at){Dn=-Dn-at|0;for(var In=0;In<En;++In)if(void 0!==(zn=Ge(ot[In],Dn)))return zn;sqPush(ht,Dt,Pn++,Dn)}else{for(Dn=-Dn-1|0,In=0;In<Pn;++In){var zn;if(void 0!==(zn=Ge(Dn,ht[In])))return zn}sqPush(ot,dt,En++,Dn)}}}function sweepComplete(Ne,Ge,Qe,tt,rt,at,it,er,dr,mr){for(var xr=0,br=2*Ne,Ar=Ne-1,en=br-1,mn=Qe;mn<tt;++mn){var xn=at[mn]+1<<1,kn=br*mn;Zt[xr++]=rt[kn+Ar],Zt[xr++]=-xn,Zt[xr++]=rt[kn+en],Zt[xr++]=xn}for(mn=it;mn<er;++mn){xn=mr[mn]+1<<1;var Cn=br*mn;Zt[xr++]=dr[Cn+Ar],Zt[xr++]=1|-xn,Zt[xr++]=dr[Cn+en],Zt[xr++]=1|xn}var En=xr>>>1;nt(Zt,En);var Pn=0,Dn=0,In=0;for(mn=0;mn<En;++mn){var zn=0|Zt[2*mn+1],Bn=1&zn;if(mn<En-1&&zn>>1==Zt[2*mn+3]>>1&&(Bn=2,mn+=1),zn<0){for(var Vn=-(zn>>1)-1,Hn=0;Hn<In;++Hn)if(void 0!==(qn=Ge(Ot[Hn],Vn)))return qn;if(0!==Bn)for(Hn=0;Hn<Pn;++Hn)if(void 0!==(qn=Ge(ot[Hn],Vn)))return qn;if(1!==Bn)for(Hn=0;Hn<Dn;++Hn){var qn;if(void 0!==(qn=Ge(ht[Hn],Vn)))return qn}0===Bn?sqPush(ot,dt,Pn++,Vn):1===Bn?sqPush(ht,Dt,Dn++,Vn):2===Bn&&sqPush(Ot,Rt,In++,Vn)}else Vn=(zn>>1)-1,0===Bn?sqPop(ot,dt,Pn--,Vn):1===Bn?sqPop(ht,Dt,Dn--,Vn):2===Bn&&sqPop(Ot,Rt,In--,Vn)}}function scanBipartite(Ne,Ge,Qe,tt,rt,it,ht,Dt,Ot,Rt,er,dr){var mr=0,xr=2*Ne,br=Ge,Ar=Ge+Ne,en=1,mn=1;tt?mn=at:en=at;for(var xn=rt;xn<it;++xn){var kn=xn+en,Cn=xr*xn;Zt[mr++]=ht[Cn+br],Zt[mr++]=-kn,Zt[mr++]=ht[Cn+Ar],Zt[mr++]=kn}for(xn=Ot;xn<Rt;++xn){kn=xn+mn;var En=xr*xn;Zt[mr++]=er[En+br],Zt[mr++]=-kn}var Pn=mr>>>1;nt(Zt,Pn);var Dn=0;for(xn=0;xn<Pn;++xn){var In=0|Zt[2*xn+1];if(In<0){var zn=!1;if((kn=-In)>=at?(zn=!tt,kn-=at):(zn=!!tt,kn-=1),zn)sqPush(ot,dt,Dn++,kn);else{var Bn=dr[kn],Vn=xr*kn,Hn=er[Vn+Ge+1],qn=er[Vn+Ge+1+Ne];e:for(var Yn=0;Yn<Dn;++Yn){var $n=ot[Yn],ra=xr*$n;if(!(qn<ht[ra+Ge+1]||ht[ra+Ge+1+Ne]<Hn)){for(var oa=Ge+2;oa<Ne;++oa)if(er[Vn+oa+Ne]<ht[ra+oa]||ht[ra+oa+Ne]<er[Vn+oa])continue e;var pa,ga=Dt[$n];if(void 0!==(pa=tt?Qe(Bn,ga):Qe(ga,Bn)))return pa}}}}else sqPop(ot,dt,Dn--,In-en)}}function scanComplete(Ne,Ge,Qe,tt,rt,it,dt,ht,Dt,Ot,Rt){for(var er=0,dr=2*Ne,mr=Ge,xr=Ge+Ne,br=tt;br<rt;++br){var Ar=br+at,en=dr*br;Zt[er++]=it[en+mr],Zt[er++]=-Ar,Zt[er++]=it[en+xr],Zt[er++]=Ar}for(br=ht;br<Dt;++br){Ar=br+1;var mn=dr*br;Zt[er++]=Ot[mn+mr],Zt[er++]=-Ar}var xn=er>>>1;nt(Zt,xn);var kn=0;for(br=0;br<xn;++br){var Cn=0|Zt[2*br+1];if(Cn<0)if((Ar=-Cn)>=at)ot[kn++]=Ar-at;else{var En=Rt[Ar-=1],Pn=dr*Ar,Dn=Ot[Pn+Ge+1],In=Ot[Pn+Ge+1+Ne];e:for(var zn=0;zn<kn;++zn){var Bn=ot[zn],Vn=dt[Bn];if(Vn===En)break;var Hn=dr*Bn;if(!(In<it[Hn+Ge+1]||it[Hn+Ge+1+Ne]<Dn)){for(var qn=Ge+2;qn<Ne;++qn)if(Ot[Pn+qn+Ne]<it[Hn+qn]||it[Hn+qn+Ne]<Ot[Pn+qn])continue e;var Yn=Qe(Vn,En);if(void 0!==Yn)return Yn}}}else{for(Ar=Cn-at,zn=kn-1;zn>=0;--zn)if(ot[zn]===Ar){for(qn=zn+1;qn<kn;++qn)ot[qn-1]=ot[qn];break}--kn}}}},{"./sort":106,"bit-twiddle":97,"typedarray-pool":595}],108:[function(Ne,Ge,Qe){},{}],109:[function(Ne,Ge,Qe){arguments[4][108][0].apply(Qe,arguments)},{dup:108}],110:[function(Ne,Ge,Qe){"use strict";var tt,rt="object"==typeof Reflect?Reflect:null,nt=rt&&"function"==typeof rt.apply?rt.apply:function(Ne,Ge,Qe){return Function.prototype.apply.call(Ne,Ge,Qe)};function ProcessEmitWarning(Ne){console&&console.warn&&console.warn(Ne)}tt=rt&&"function"==typeof rt.ownKeys?rt.ownKeys:Object.getOwnPropertySymbols?function(Ne){return Object.getOwnPropertyNames(Ne).concat(Object.getOwnPropertySymbols(Ne))}:function(Ne){return Object.getOwnPropertyNames(Ne)};var at=Number.isNaN||function(Ne){return Ne!=Ne};function EventEmitter(){EventEmitter.init.call(this)}Ge.exports=EventEmitter,Ge.exports.once=once,EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._eventsCount=0,EventEmitter.prototype._maxListeners=void 0;var it=10;function checkListener(Ne){if("function"!=typeof Ne)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof Ne)}function _getMaxListeners(Ne){return void 0===Ne._maxListeners?EventEmitter.defaultMaxListeners:Ne._maxListeners}function _addListener(Ne,Ge,Qe,tt){var rt,nt,at;if(checkListener(Qe),void 0===(nt=Ne._events)?(nt=Ne._events=Object.create(null),Ne._eventsCount=0):(void 0!==nt.newListener&&(Ne.emit("newListener",Ge,Qe.listener?Qe.listener:Qe),nt=Ne._events),at=nt[Ge]),void 0===at)at=nt[Ge]=Qe,++Ne._eventsCount;else if("function"==typeof at?at=nt[Ge]=tt?[Qe,at]:[at,Qe]:tt?at.unshift(Qe):at.push(Qe),(rt=_getMaxListeners(Ne))>0&&at.length>rt&&!at.warned){at.warned=!0;var it=new Error("Possible EventEmitter memory leak detected. "+at.length+" "+String(Ge)+" listeners added. Use emitter.setMaxListeners() to increase limit");it.name="MaxListenersExceededWarning",it.emitter=Ne,it.type=Ge,it.count=at.length,ProcessEmitWarning(it)}return Ne}function onceWrapper(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap(Ne,Ge,Qe){var tt={fired:!1,wrapFn:void 0,target:Ne,type:Ge,listener:Qe},rt=onceWrapper.bind(tt);return rt.listener=Qe,tt.wrapFn=rt,rt}function _listeners(Ne,Ge,Qe){var tt=Ne._events;if(void 0===tt)return[];var rt=tt[Ge];return void 0===rt?[]:"function"==typeof rt?Qe?[rt.listener||rt]:[rt]:Qe?unwrapListeners(rt):arrayClone(rt,rt.length)}function listenerCount(Ne){var Ge=this._events;if(void 0!==Ge){var Qe=Ge[Ne];if("function"==typeof Qe)return 1;if(void 0!==Qe)return Qe.length}return 0}function arrayClone(Ne,Ge){for(var Qe=new Array(Ge),tt=0;tt<Ge;++tt)Qe[tt]=Ne[tt];return Qe}function spliceOne(Ne,Ge){for(;Ge+1<Ne.length;Ge++)Ne[Ge]=Ne[Ge+1];Ne.pop()}function unwrapListeners(Ne){for(var Ge=new Array(Ne.length),Qe=0;Qe<Ge.length;++Qe)Ge[Qe]=Ne[Qe].listener||Ne[Qe];return Ge}function once(Ne,Ge){return new Promise((function(Qe,tt){function eventListener(){void 0!==rt&&Ne.removeListener("error",rt),Qe([].slice.call(arguments))}var rt;"error"!==Ge&&(rt=function(Qe){Ne.removeListener(Ge,eventListener),tt(Qe)},Ne.once("error",rt)),Ne.once(Ge,eventListener)}))}Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:!0,get:function(){return it},set:function(Ne){if("number"!=typeof Ne||Ne<0||at(Ne))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+Ne+".");it=Ne}}),EventEmitter.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},EventEmitter.prototype.setMaxListeners=function(Ne){if("number"!=typeof Ne||Ne<0||at(Ne))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+Ne+".");return this._maxListeners=Ne,this},EventEmitter.prototype.getMaxListeners=function(){return _getMaxListeners(this)},EventEmitter.prototype.emit=function(Ne){for(var Ge=[],Qe=1;Qe<arguments.length;Qe++)Ge.push(arguments[Qe]);var tt="error"===Ne,rt=this._events;if(void 0!==rt)tt=tt&&void 0===rt.error;else if(!tt)return!1;if(tt){var at;if(Ge.length>0&&(at=Ge[0]),at instanceof Error)throw at;var it=new Error("Unhandled error."+(at?" ("+at.message+")":""));throw it.context=at,it}var ot=rt[Ne];if(void 0===ot)return!1;if("function"==typeof ot)nt(ot,this,Ge);else{var dt=ot.length,ht=arrayClone(ot,dt);for(Qe=0;Qe<dt;++Qe)nt(ht[Qe],this,Ge)}return!0},EventEmitter.prototype.addListener=function(Ne,Ge){return _addListener(this,Ne,Ge,!1)},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.prependListener=function(Ne,Ge){return _addListener(this,Ne,Ge,!0)},EventEmitter.prototype.once=function(Ne,Ge){return checkListener(Ge),this.on(Ne,_onceWrap(this,Ne,Ge)),this},EventEmitter.prototype.prependOnceListener=function(Ne,Ge){return checkListener(Ge),this.prependListener(Ne,_onceWrap(this,Ne,Ge)),this},EventEmitter.prototype.removeListener=function(Ne,Ge){var Qe,tt,rt,nt,at;if(checkListener(Ge),void 0===(tt=this._events))return this;if(void 0===(Qe=tt[Ne]))return this;if(Qe===Ge||Qe.listener===Ge)0==--this._eventsCount?this._events=Object.create(null):(delete tt[Ne],tt.removeListener&&this.emit("removeListener",Ne,Qe.listener||Ge));else if("function"!=typeof Qe){for(rt=-1,nt=Qe.length-1;nt>=0;nt--)if(Qe[nt]===Ge||Qe[nt].listener===Ge){at=Qe[nt].listener,rt=nt;break}if(rt<0)return this;0===rt?Qe.shift():spliceOne(Qe,rt),1===Qe.length&&(tt[Ne]=Qe[0]),void 0!==tt.removeListener&&this.emit("removeListener",Ne,at||Ge)}return this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.removeAllListeners=function(Ne){var Ge,Qe,tt;if(void 0===(Qe=this._events))return this;if(void 0===Qe.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==Qe[Ne]&&(0==--this._eventsCount?this._events=Object.create(null):delete Qe[Ne]),this;if(0===arguments.length){var rt,nt=Object.keys(Qe);for(tt=0;tt<nt.length;++tt)"removeListener"!==(rt=nt[tt])&&this.removeAllListeners(rt);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(Ge=Qe[Ne]))this.removeListener(Ne,Ge);else if(void 0!==Ge)for(tt=Ge.length-1;tt>=0;tt--)this.removeListener(Ne,Ge[tt]);return this},EventEmitter.prototype.listeners=function(Ne){return _listeners(this,Ne,!0)},EventEmitter.prototype.rawListeners=function(Ne){return _listeners(this,Ne,!1)},EventEmitter.listenerCount=function(Ne,Ge){return"function"==typeof Ne.listenerCount?Ne.listenerCount(Ge):listenerCount.call(Ne,Ge)},EventEmitter.prototype.listenerCount=listenerCount,EventEmitter.prototype.eventNames=function(){return this._eventsCount>0?tt(this._events):[]}},{}],111:[function(Ne,Ge,Qe){(function(Ge){(function(){"use strict";var Ge=Ne("base64-js"),tt=Ne("ieee754");Qe.Buffer=Buffer,Qe.SlowBuffer=SlowBuffer,Qe.INSPECT_MAX_BYTES=50;var rt=2147483647;function typedArraySupport(){try{var Ne=new Uint8Array(1);return Ne.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===Ne.foo()}catch(Ne){return!1}}function createBuffer(Ne){if(Ne>rt)throw new RangeError('The value "'+Ne+'" is invalid for option "size"');var Ge=new Uint8Array(Ne);return Ge.__proto__=Buffer.prototype,Ge}function Buffer(Ne,Ge,Qe){if("number"==typeof Ne){if("string"==typeof Ge)throw new TypeError('The "string" argument must be of type string. Received type number');return allocUnsafe(Ne)}return from(Ne,Ge,Qe)}function from(Ne,Ge,Qe){if("string"==typeof Ne)return fromString(Ne,Ge);if(ArrayBuffer.isView(Ne))return fromArrayLike(Ne);if(null==Ne)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Ne);if(isInstance(Ne,ArrayBuffer)||Ne&&isInstance(Ne.buffer,ArrayBuffer))return fromArrayBuffer(Ne,Ge,Qe);if("number"==typeof Ne)throw new TypeError('The "value" argument must not be of type number. Received type number');var tt=Ne.valueOf&&Ne.valueOf();if(null!=tt&&tt!==Ne)return Buffer.from(tt,Ge,Qe);var rt=fromObject(Ne);if(rt)return rt;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof Ne[Symbol.toPrimitive])return Buffer.from(Ne[Symbol.toPrimitive]("string"),Ge,Qe);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Ne)}function assertSize(Ne){if("number"!=typeof Ne)throw new TypeError('"size" argument must be of type number');if(Ne<0)throw new RangeError('The value "'+Ne+'" is invalid for option "size"')}function alloc(Ne,Ge,Qe){return assertSize(Ne),Ne<=0?createBuffer(Ne):void 0!==Ge?"string"==typeof Qe?createBuffer(Ne).fill(Ge,Qe):createBuffer(Ne).fill(Ge):createBuffer(Ne)}function allocUnsafe(Ne){return assertSize(Ne),createBuffer(Ne<0?0:0|checked(Ne))}function fromString(Ne,Ge){if("string"==typeof Ge&&""!==Ge||(Ge="utf8"),!Buffer.isEncoding(Ge))throw new TypeError("Unknown encoding: "+Ge);var Qe=0|byteLength(Ne,Ge),tt=createBuffer(Qe),rt=tt.write(Ne,Ge);return rt!==Qe&&(tt=tt.slice(0,rt)),tt}function fromArrayLike(Ne){for(var Ge=Ne.length<0?0:0|checked(Ne.length),Qe=createBuffer(Ge),tt=0;tt<Ge;tt+=1)Qe[tt]=255&Ne[tt];return Qe}function fromArrayBuffer(Ne,Ge,Qe){if(Ge<0||Ne.byteLength<Ge)throw new RangeError('"offset" is outside of buffer bounds');if(Ne.byteLength<Ge+(Qe||0))throw new RangeError('"length" is outside of buffer bounds');var tt;return(tt=void 0===Ge&&void 0===Qe?new Uint8Array(Ne):void 0===Qe?new Uint8Array(Ne,Ge):new Uint8Array(Ne,Ge,Qe)).__proto__=Buffer.prototype,tt}function fromObject(Ne){if(Buffer.isBuffer(Ne)){var Ge=0|checked(Ne.length),Qe=createBuffer(Ge);return 0===Qe.length||Ne.copy(Qe,0,0,Ge),Qe}return void 0!==Ne.length?"number"!=typeof Ne.length||numberIsNaN(Ne.length)?createBuffer(0):fromArrayLike(Ne):"Buffer"===Ne.type&&Array.isArray(Ne.data)?fromArrayLike(Ne.data):void 0}function checked(Ne){if(Ne>=rt)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+rt.toString(16)+" bytes");return 0|Ne}function SlowBuffer(Ne){return+Ne!=Ne&&(Ne=0),Buffer.alloc(+Ne)}function byteLength(Ne,Ge){if(Buffer.isBuffer(Ne))return Ne.length;if(ArrayBuffer.isView(Ne)||isInstance(Ne,ArrayBuffer))return Ne.byteLength;if("string"!=typeof Ne)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Ne);var Qe=Ne.length,tt=arguments.length>2&&!0===arguments[2];if(!tt&&0===Qe)return 0;for(var rt=!1;;)switch(Ge){case"ascii":case"latin1":case"binary":return Qe;case"utf8":case"utf-8":return utf8ToBytes(Ne).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*Qe;case"hex":return Qe>>>1;case"base64":return base64ToBytes(Ne).length;default:if(rt)return tt?-1:utf8ToBytes(Ne).length;Ge=(""+Ge).toLowerCase(),rt=!0}}function slowToString(Ne,Ge,Qe){var tt=!1;if((void 0===Ge||Ge<0)&&(Ge=0),Ge>this.length)return"";if((void 0===Qe||Qe>this.length)&&(Qe=this.length),Qe<=0)return"";if((Qe>>>=0)<=(Ge>>>=0))return"";for(Ne||(Ne="utf8");;)switch(Ne){case"hex":return hexSlice(this,Ge,Qe);case"utf8":case"utf-8":return utf8Slice(this,Ge,Qe);case"ascii":return asciiSlice(this,Ge,Qe);case"latin1":case"binary":return latin1Slice(this,Ge,Qe);case"base64":return base64Slice(this,Ge,Qe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return utf16leSlice(this,Ge,Qe);default:if(tt)throw new TypeError("Unknown encoding: "+Ne);Ne=(Ne+"").toLowerCase(),tt=!0}}function swap(Ne,Ge,Qe){var tt=Ne[Ge];Ne[Ge]=Ne[Qe],Ne[Qe]=tt}function bidirectionalIndexOf(Ne,Ge,Qe,tt,rt){if(0===Ne.length)return-1;if("string"==typeof Qe?(tt=Qe,Qe=0):Qe>2147483647?Qe=2147483647:Qe<-2147483648&&(Qe=-2147483648),numberIsNaN(Qe=+Qe)&&(Qe=rt?0:Ne.length-1),Qe<0&&(Qe=Ne.length+Qe),Qe>=Ne.length){if(rt)return-1;Qe=Ne.length-1}else if(Qe<0){if(!rt)return-1;Qe=0}if("string"==typeof Ge&&(Ge=Buffer.from(Ge,tt)),Buffer.isBuffer(Ge))return 0===Ge.length?-1:arrayIndexOf(Ne,Ge,Qe,tt,rt);if("number"==typeof Ge)return Ge&=255,"function"==typeof Uint8Array.prototype.indexOf?rt?Uint8Array.prototype.indexOf.call(Ne,Ge,Qe):Uint8Array.prototype.lastIndexOf.call(Ne,Ge,Qe):arrayIndexOf(Ne,[Ge],Qe,tt,rt);throw new TypeError("val must be string, number or Buffer")}function arrayIndexOf(Ne,Ge,Qe,tt,rt){var nt,at=1,it=Ne.length,ot=Ge.length;if(void 0!==tt&&("ucs2"===(tt=String(tt).toLowerCase())||"ucs-2"===tt||"utf16le"===tt||"utf-16le"===tt)){if(Ne.length<2||Ge.length<2)return-1;at=2,it/=2,ot/=2,Qe/=2}function read(Ne,Ge){return 1===at?Ne[Ge]:Ne.readUInt16BE(Ge*at)}if(rt){var dt=-1;for(nt=Qe;nt<it;nt++)if(read(Ne,nt)===read(Ge,-1===dt?0:nt-dt)){if(-1===dt&&(dt=nt),nt-dt+1===ot)return dt*at}else-1!==dt&&(nt-=nt-dt),dt=-1}else for(Qe+ot>it&&(Qe=it-ot),nt=Qe;nt>=0;nt--){for(var ht=!0,Dt=0;Dt<ot;Dt++)if(read(Ne,nt+Dt)!==read(Ge,Dt)){ht=!1;break}if(ht)return nt}return-1}function hexWrite(Ne,Ge,Qe,tt){Qe=Number(Qe)||0;var rt=Ne.length-Qe;tt?(tt=Number(tt))>rt&&(tt=rt):tt=rt;var nt=Ge.length;tt>nt/2&&(tt=nt/2);for(var at=0;at<tt;++at){var it=parseInt(Ge.substr(2*at,2),16);if(numberIsNaN(it))return at;Ne[Qe+at]=it}return at}function utf8Write(Ne,Ge,Qe,tt){return blitBuffer(utf8ToBytes(Ge,Ne.length-Qe),Ne,Qe,tt)}function asciiWrite(Ne,Ge,Qe,tt){return blitBuffer(asciiToBytes(Ge),Ne,Qe,tt)}function latin1Write(Ne,Ge,Qe,tt){return asciiWrite(Ne,Ge,Qe,tt)}function base64Write(Ne,Ge,Qe,tt){return blitBuffer(base64ToBytes(Ge),Ne,Qe,tt)}function ucs2Write(Ne,Ge,Qe,tt){return blitBuffer(utf16leToBytes(Ge,Ne.length-Qe),Ne,Qe,tt)}function base64Slice(Ne,Qe,tt){return 0===Qe&&tt===Ne.length?Ge.fromByteArray(Ne):Ge.fromByteArray(Ne.slice(Qe,tt))}function utf8Slice(Ne,Ge,Qe){Qe=Math.min(Ne.length,Qe);for(var tt=[],rt=Ge;rt<Qe;){var nt,at,it,ot,dt=Ne[rt],ht=null,Dt=dt>239?4:dt>223?3:dt>191?2:1;if(rt+Dt<=Qe)switch(Dt){case 1:dt<128&&(ht=dt);break;case 2:128==(192&(nt=Ne[rt+1]))&&(ot=(31&dt)<<6|63&nt)>127&&(ht=ot);break;case 3:nt=Ne[rt+1],at=Ne[rt+2],128==(192&nt)&&128==(192&at)&&(ot=(15&dt)<<12|(63&nt)<<6|63&at)>2047&&(ot<55296||ot>57343)&&(ht=ot);break;case 4:nt=Ne[rt+1],at=Ne[rt+2],it=Ne[rt+3],128==(192&nt)&&128==(192&at)&&128==(192&it)&&(ot=(15&dt)<<18|(63&nt)<<12|(63&at)<<6|63&it)>65535&&ot<1114112&&(ht=ot)}null===ht?(ht=65533,Dt=1):ht>65535&&(ht-=65536,tt.push(ht>>>10&1023|55296),ht=56320|1023&ht),tt.push(ht),rt+=Dt}return decodeCodePointsArray(tt)}Qe.kMaxLength=rt,Buffer.TYPED_ARRAY_SUPPORT=typedArraySupport(),Buffer.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(Buffer.prototype,"parent",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.buffer}}),Object.defineProperty(Buffer.prototype,"offset",{enumerable:!0,get:function(){if(Buffer.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&Buffer[Symbol.species]===Buffer&&Object.defineProperty(Buffer,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),Buffer.poolSize=8192,Buffer.from=function(Ne,Ge,Qe){return from(Ne,Ge,Qe)},Buffer.prototype.__proto__=Uint8Array.prototype,Buffer.__proto__=Uint8Array,Buffer.alloc=function(Ne,Ge,Qe){return alloc(Ne,Ge,Qe)},Buffer.allocUnsafe=function(Ne){return allocUnsafe(Ne)},Buffer.allocUnsafeSlow=function(Ne){return allocUnsafe(Ne)},Buffer.isBuffer=function(Ne){return null!=Ne&&!0===Ne._isBuffer&&Ne!==Buffer.prototype},Buffer.compare=function(Ne,Ge){if(isInstance(Ne,Uint8Array)&&(Ne=Buffer.from(Ne,Ne.offset,Ne.byteLength)),isInstance(Ge,Uint8Array)&&(Ge=Buffer.from(Ge,Ge.offset,Ge.byteLength)),!Buffer.isBuffer(Ne)||!Buffer.isBuffer(Ge))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(Ne===Ge)return 0;for(var Qe=Ne.length,tt=Ge.length,rt=0,nt=Math.min(Qe,tt);rt<nt;++rt)if(Ne[rt]!==Ge[rt]){Qe=Ne[rt],tt=Ge[rt];break}return Qe<tt?-1:tt<Qe?1:0},Buffer.isEncoding=function(Ne){switch(String(Ne).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Buffer.concat=function(Ne,Ge){if(!Array.isArray(Ne))throw new TypeError('"list" argument must be an Array of Buffers');if(0===Ne.length)return Buffer.alloc(0);var Qe;if(void 0===Ge)for(Ge=0,Qe=0;Qe<Ne.length;++Qe)Ge+=Ne[Qe].length;var tt=Buffer.allocUnsafe(Ge),rt=0;for(Qe=0;Qe<Ne.length;++Qe){var nt=Ne[Qe];if(isInstance(nt,Uint8Array)&&(nt=Buffer.from(nt)),!Buffer.isBuffer(nt))throw new TypeError('"list" argument must be an Array of Buffers');nt.copy(tt,rt),rt+=nt.length}return tt},Buffer.byteLength=byteLength,Buffer.prototype._isBuffer=!0,Buffer.prototype.swap16=function(){var Ne=this.length;if(Ne%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var Ge=0;Ge<Ne;Ge+=2)swap(this,Ge,Ge+1);return this},Buffer.prototype.swap32=function(){var Ne=this.length;if(Ne%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var Ge=0;Ge<Ne;Ge+=4)swap(this,Ge,Ge+3),swap(this,Ge+1,Ge+2);return this},Buffer.prototype.swap64=function(){var Ne=this.length;if(Ne%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var Ge=0;Ge<Ne;Ge+=8)swap(this,Ge,Ge+7),swap(this,Ge+1,Ge+6),swap(this,Ge+2,Ge+5),swap(this,Ge+3,Ge+4);return this},Buffer.prototype.toString=function(){var Ne=this.length;return 0===Ne?"":0===arguments.length?utf8Slice(this,0,Ne):slowToString.apply(this,arguments)},Buffer.prototype.toLocaleString=Buffer.prototype.toString,Buffer.prototype.equals=function(Ne){if(!Buffer.isBuffer(Ne))throw new TypeError("Argument must be a Buffer");return this===Ne||0===Buffer.compare(this,Ne)},Buffer.prototype.inspect=function(){var Ne="",Ge=Qe.INSPECT_MAX_BYTES;return Ne=this.toString("hex",0,Ge).replace(/(.{2})/g,"$1 ").trim(),this.length>Ge&&(Ne+=" ... "),"<Buffer "+Ne+">"},Buffer.prototype.compare=function(Ne,Ge,Qe,tt,rt){if(isInstance(Ne,Uint8Array)&&(Ne=Buffer.from(Ne,Ne.offset,Ne.byteLength)),!Buffer.isBuffer(Ne))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof Ne);if(void 0===Ge&&(Ge=0),void 0===Qe&&(Qe=Ne?Ne.length:0),void 0===tt&&(tt=0),void 0===rt&&(rt=this.length),Ge<0||Qe>Ne.length||tt<0||rt>this.length)throw new RangeError("out of range index");if(tt>=rt&&Ge>=Qe)return 0;if(tt>=rt)return-1;if(Ge>=Qe)return 1;if(this===Ne)return 0;for(var nt=(rt>>>=0)-(tt>>>=0),at=(Qe>>>=0)-(Ge>>>=0),it=Math.min(nt,at),ot=this.slice(tt,rt),dt=Ne.slice(Ge,Qe),ht=0;ht<it;++ht)if(ot[ht]!==dt[ht]){nt=ot[ht],at=dt[ht];break}return nt<at?-1:at<nt?1:0},Buffer.prototype.includes=function(Ne,Ge,Qe){return-1!==this.indexOf(Ne,Ge,Qe)},Buffer.prototype.indexOf=function(Ne,Ge,Qe){return bidirectionalIndexOf(this,Ne,Ge,Qe,!0)},Buffer.prototype.lastIndexOf=function(Ne,Ge,Qe){return bidirectionalIndexOf(this,Ne,Ge,Qe,!1)},Buffer.prototype.write=function(Ne,Ge,Qe,tt){if(void 0===Ge)tt="utf8",Qe=this.length,Ge=0;else if(void 0===Qe&&"string"==typeof Ge)tt=Ge,Qe=this.length,Ge=0;else{if(!isFinite(Ge))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");Ge>>>=0,isFinite(Qe)?(Qe>>>=0,void 0===tt&&(tt="utf8")):(tt=Qe,Qe=void 0)}var rt=this.length-Ge;if((void 0===Qe||Qe>rt)&&(Qe=rt),Ne.length>0&&(Qe<0||Ge<0)||Ge>this.length)throw new RangeError("Attempt to write outside buffer bounds");tt||(tt="utf8");for(var nt=!1;;)switch(tt){case"hex":return hexWrite(this,Ne,Ge,Qe);case"utf8":case"utf-8":return utf8Write(this,Ne,Ge,Qe);case"ascii":return asciiWrite(this,Ne,Ge,Qe);case"latin1":case"binary":return latin1Write(this,Ne,Ge,Qe);case"base64":return base64Write(this,Ne,Ge,Qe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ucs2Write(this,Ne,Ge,Qe);default:if(nt)throw new TypeError("Unknown encoding: "+tt);tt=(""+tt).toLowerCase(),nt=!0}},Buffer.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var nt=4096;function decodeCodePointsArray(Ne){var Ge=Ne.length;if(Ge<=nt)return String.fromCharCode.apply(String,Ne);for(var Qe="",tt=0;tt<Ge;)Qe+=String.fromCharCode.apply(String,Ne.slice(tt,tt+=nt));return Qe}function asciiSlice(Ne,Ge,Qe){var tt="";Qe=Math.min(Ne.length,Qe);for(var rt=Ge;rt<Qe;++rt)tt+=String.fromCharCode(127&Ne[rt]);return tt}function latin1Slice(Ne,Ge,Qe){var tt="";Qe=Math.min(Ne.length,Qe);for(var rt=Ge;rt<Qe;++rt)tt+=String.fromCharCode(Ne[rt]);return tt}function hexSlice(Ne,Ge,Qe){var tt=Ne.length;(!Ge||Ge<0)&&(Ge=0),(!Qe||Qe<0||Qe>tt)&&(Qe=tt);for(var rt="",nt=Ge;nt<Qe;++nt)rt+=toHex(Ne[nt]);return rt}function utf16leSlice(Ne,Ge,Qe){for(var tt=Ne.slice(Ge,Qe),rt="",nt=0;nt<tt.length;nt+=2)rt+=String.fromCharCode(tt[nt]+256*tt[nt+1]);return rt}function checkOffset(Ne,Ge,Qe){if(Ne%1!=0||Ne<0)throw new RangeError("offset is not uint");if(Ne+Ge>Qe)throw new RangeError("Trying to access beyond buffer length")}function checkInt(Ne,Ge,Qe,tt,rt,nt){if(!Buffer.isBuffer(Ne))throw new TypeError('"buffer" argument must be a Buffer instance');if(Ge>rt||Ge<nt)throw new RangeError('"value" argument is out of bounds');if(Qe+tt>Ne.length)throw new RangeError("Index out of range")}function checkIEEE754(Ne,Ge,Qe,tt,rt,nt){if(Qe+tt>Ne.length)throw new RangeError("Index out of range");if(Qe<0)throw new RangeError("Index out of range")}function writeFloat(Ne,Ge,Qe,rt,nt){return Ge=+Ge,Qe>>>=0,nt||checkIEEE754(Ne,Ge,Qe,4,34028234663852886e22,-34028234663852886e22),tt.write(Ne,Ge,Qe,rt,23,4),Qe+4}function writeDouble(Ne,Ge,Qe,rt,nt){return Ge=+Ge,Qe>>>=0,nt||checkIEEE754(Ne,Ge,Qe,8,17976931348623157e292,-17976931348623157e292),tt.write(Ne,Ge,Qe,rt,52,8),Qe+8}Buffer.prototype.slice=function(Ne,Ge){var Qe=this.length;(Ne=~~Ne)<0?(Ne+=Qe)<0&&(Ne=0):Ne>Qe&&(Ne=Qe),(Ge=void 0===Ge?Qe:~~Ge)<0?(Ge+=Qe)<0&&(Ge=0):Ge>Qe&&(Ge=Qe),Ge<Ne&&(Ge=Ne);var tt=this.subarray(Ne,Ge);return tt.__proto__=Buffer.prototype,tt},Buffer.prototype.readUIntLE=function(Ne,Ge,Qe){Ne>>>=0,Ge>>>=0,Qe||checkOffset(Ne,Ge,this.length);for(var tt=this[Ne],rt=1,nt=0;++nt<Ge&&(rt*=256);)tt+=this[Ne+nt]*rt;return tt},Buffer.prototype.readUIntBE=function(Ne,Ge,Qe){Ne>>>=0,Ge>>>=0,Qe||checkOffset(Ne,Ge,this.length);for(var tt=this[Ne+--Ge],rt=1;Ge>0&&(rt*=256);)tt+=this[Ne+--Ge]*rt;return tt},Buffer.prototype.readUInt8=function(Ne,Ge){return Ne>>>=0,Ge||checkOffset(Ne,1,this.length),this[Ne]},Buffer.prototype.readUInt16LE=function(Ne,Ge){return Ne>>>=0,Ge||checkOffset(Ne,2,this.length),this[Ne]|this[Ne+1]<<8},Buffer.prototype.readUInt16BE=function(Ne,Ge){return Ne>>>=0,Ge||checkOffset(Ne,2,this.length),this[Ne]<<8|this[Ne+1]},Buffer.prototype.readUInt32LE=function(Ne,Ge){return Ne>>>=0,Ge||checkOffset(Ne,4,this.length),(this[Ne]|this[Ne+1]<<8|this[Ne+2]<<16)+16777216*this[Ne+3]},Buffer.prototype.readUInt32BE=function(Ne,Ge){return Ne>>>=0,Ge||checkOffset(Ne,4,this.length),16777216*this[Ne]+(this[Ne+1]<<16|this[Ne+2]<<8|this[Ne+3])},Buffer.prototype.readIntLE=function(Ne,Ge,Qe){Ne>>>=0,Ge>>>=0,Qe||checkOffset(Ne,Ge,this.length);for(var tt=this[Ne],rt=1,nt=0;++nt<Ge&&(rt*=256);)tt+=this[Ne+nt]*rt;return tt>=(rt*=128)&&(tt-=Math.pow(2,8*Ge)),tt},Buffer.prototype.readIntBE=function(Ne,Ge,Qe){Ne>>>=0,Ge>>>=0,Qe||checkOffset(Ne,Ge,this.length);for(var tt=Ge,rt=1,nt=this[Ne+--tt];tt>0&&(rt*=256);)nt+=this[Ne+--tt]*rt;return nt>=(rt*=128)&&(nt-=Math.pow(2,8*Ge)),nt},Buffer.prototype.readInt8=function(Ne,Ge){return Ne>>>=0,Ge||checkOffset(Ne,1,this.length),128&this[Ne]?-1*(255-this[Ne]+1):this[Ne]},Buffer.prototype.readInt16LE=function(Ne,Ge){Ne>>>=0,Ge||checkOffset(Ne,2,this.length);var Qe=this[Ne]|this[Ne+1]<<8;return 32768&Qe?4294901760|Qe:Qe},Buffer.prototype.readInt16BE=function(Ne,Ge){Ne>>>=0,Ge||checkOffset(Ne,2,this.length);var Qe=this[Ne+1]|this[Ne]<<8;return 32768&Qe?4294901760|Qe:Qe},Buffer.prototype.readInt32LE=function(Ne,Ge){return Ne>>>=0,Ge||checkOffset(Ne,4,this.length),this[Ne]|this[Ne+1]<<8|this[Ne+2]<<16|this[Ne+3]<<24},Buffer.prototype.readInt32BE=function(Ne,Ge){return Ne>>>=0,Ge||checkOffset(Ne,4,this.length),this[Ne]<<24|this[Ne+1]<<16|this[Ne+2]<<8|this[Ne+3]},Buffer.prototype.readFloatLE=function(Ne,Ge){return Ne>>>=0,Ge||checkOffset(Ne,4,this.length),tt.read(this,Ne,!0,23,4)},Buffer.prototype.readFloatBE=function(Ne,Ge){return Ne>>>=0,Ge||checkOffset(Ne,4,this.length),tt.read(this,Ne,!1,23,4)},Buffer.prototype.readDoubleLE=function(Ne,Ge){return Ne>>>=0,Ge||checkOffset(Ne,8,this.length),tt.read(this,Ne,!0,52,8)},Buffer.prototype.readDoubleBE=function(Ne,Ge){return Ne>>>=0,Ge||checkOffset(Ne,8,this.length),tt.read(this,Ne,!1,52,8)},Buffer.prototype.writeUIntLE=function(Ne,Ge,Qe,tt){Ne=+Ne,Ge>>>=0,Qe>>>=0,tt||checkInt(this,Ne,Ge,Qe,Math.pow(2,8*Qe)-1,0);var rt=1,nt=0;for(this[Ge]=255&Ne;++nt<Qe&&(rt*=256);)this[Ge+nt]=Ne/rt&255;return Ge+Qe},Buffer.prototype.writeUIntBE=function(Ne,Ge,Qe,tt){Ne=+Ne,Ge>>>=0,Qe>>>=0,tt||checkInt(this,Ne,Ge,Qe,Math.pow(2,8*Qe)-1,0);var rt=Qe-1,nt=1;for(this[Ge+rt]=255&Ne;--rt>=0&&(nt*=256);)this[Ge+rt]=Ne/nt&255;return Ge+Qe},Buffer.prototype.writeUInt8=function(Ne,Ge,Qe){return Ne=+Ne,Ge>>>=0,Qe||checkInt(this,Ne,Ge,1,255,0),this[Ge]=255&Ne,Ge+1},Buffer.prototype.writeUInt16LE=function(Ne,Ge,Qe){return Ne=+Ne,Ge>>>=0,Qe||checkInt(this,Ne,Ge,2,65535,0),this[Ge]=255&Ne,this[Ge+1]=Ne>>>8,Ge+2},Buffer.prototype.writeUInt16BE=function(Ne,Ge,Qe){return Ne=+Ne,Ge>>>=0,Qe||checkInt(this,Ne,Ge,2,65535,0),this[Ge]=Ne>>>8,this[Ge+1]=255&Ne,Ge+2},Buffer.prototype.writeUInt32LE=function(Ne,Ge,Qe){return Ne=+Ne,Ge>>>=0,Qe||checkInt(this,Ne,Ge,4,4294967295,0),this[Ge+3]=Ne>>>24,this[Ge+2]=Ne>>>16,this[Ge+1]=Ne>>>8,this[Ge]=255&Ne,Ge+4},Buffer.prototype.writeUInt32BE=function(Ne,Ge,Qe){return Ne=+Ne,Ge>>>=0,Qe||checkInt(this,Ne,Ge,4,4294967295,0),this[Ge]=Ne>>>24,this[Ge+1]=Ne>>>16,this[Ge+2]=Ne>>>8,this[Ge+3]=255&Ne,Ge+4},Buffer.prototype.writeIntLE=function(Ne,Ge,Qe,tt){if(Ne=+Ne,Ge>>>=0,!tt){var rt=Math.pow(2,8*Qe-1);checkInt(this,Ne,Ge,Qe,rt-1,-rt)}var nt=0,at=1,it=0;for(this[Ge]=255&Ne;++nt<Qe&&(at*=256);)Ne<0&&0===it&&0!==this[Ge+nt-1]&&(it=1),this[Ge+nt]=(Ne/at>>0)-it&255;return Ge+Qe},Buffer.prototype.writeIntBE=function(Ne,Ge,Qe,tt){if(Ne=+Ne,Ge>>>=0,!tt){var rt=Math.pow(2,8*Qe-1);checkInt(this,Ne,Ge,Qe,rt-1,-rt)}var nt=Qe-1,at=1,it=0;for(this[Ge+nt]=255&Ne;--nt>=0&&(at*=256);)Ne<0&&0===it&&0!==this[Ge+nt+1]&&(it=1),this[Ge+nt]=(Ne/at>>0)-it&255;return Ge+Qe},Buffer.prototype.writeInt8=function(Ne,Ge,Qe){return Ne=+Ne,Ge>>>=0,Qe||checkInt(this,Ne,Ge,1,127,-128),Ne<0&&(Ne=255+Ne+1),this[Ge]=255&Ne,Ge+1},Buffer.prototype.writeInt16LE=function(Ne,Ge,Qe){return Ne=+Ne,Ge>>>=0,Qe||checkInt(this,Ne,Ge,2,32767,-32768),this[Ge]=255&Ne,this[Ge+1]=Ne>>>8,Ge+2},Buffer.prototype.writeInt16BE=function(Ne,Ge,Qe){return Ne=+Ne,Ge>>>=0,Qe||checkInt(this,Ne,Ge,2,32767,-32768),this[Ge]=Ne>>>8,this[Ge+1]=255&Ne,Ge+2},Buffer.prototype.writeInt32LE=function(Ne,Ge,Qe){return Ne=+Ne,Ge>>>=0,Qe||checkInt(this,Ne,Ge,4,2147483647,-2147483648),this[Ge]=255&Ne,this[Ge+1]=Ne>>>8,this[Ge+2]=Ne>>>16,this[Ge+3]=Ne>>>24,Ge+4},Buffer.prototype.writeInt32BE=function(Ne,Ge,Qe){return Ne=+Ne,Ge>>>=0,Qe||checkInt(this,Ne,Ge,4,2147483647,-2147483648),Ne<0&&(Ne=4294967295+Ne+1),this[Ge]=Ne>>>24,this[Ge+1]=Ne>>>16,this[Ge+2]=Ne>>>8,this[Ge+3]=255&Ne,Ge+4},Buffer.prototype.writeFloatLE=function(Ne,Ge,Qe){return writeFloat(this,Ne,Ge,!0,Qe)},Buffer.prototype.writeFloatBE=function(Ne,Ge,Qe){return writeFloat(this,Ne,Ge,!1,Qe)},Buffer.prototype.writeDoubleLE=function(Ne,Ge,Qe){return writeDouble(this,Ne,Ge,!0,Qe)},Buffer.prototype.writeDoubleBE=function(Ne,Ge,Qe){return writeDouble(this,Ne,Ge,!1,Qe)},Buffer.prototype.copy=function(Ne,Ge,Qe,tt){if(!Buffer.isBuffer(Ne))throw new TypeError("argument should be a Buffer");if(Qe||(Qe=0),tt||0===tt||(tt=this.length),Ge>=Ne.length&&(Ge=Ne.length),Ge||(Ge=0),tt>0&&tt<Qe&&(tt=Qe),tt===Qe)return 0;if(0===Ne.length||0===this.length)return 0;if(Ge<0)throw new RangeError("targetStart out of bounds");if(Qe<0||Qe>=this.length)throw new RangeError("Index out of range");if(tt<0)throw new RangeError("sourceEnd out of bounds");tt>this.length&&(tt=this.length),Ne.length-Ge<tt-Qe&&(tt=Ne.length-Ge+Qe);var rt=tt-Qe;if(this===Ne&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(Ge,Qe,tt);else if(this===Ne&&Qe<Ge&&Ge<tt)for(var nt=rt-1;nt>=0;--nt)Ne[nt+Ge]=this[nt+Qe];else Uint8Array.prototype.set.call(Ne,this.subarray(Qe,tt),Ge);return rt},Buffer.prototype.fill=function(Ne,Ge,Qe,tt){if("string"==typeof Ne){if("string"==typeof Ge?(tt=Ge,Ge=0,Qe=this.length):"string"==typeof Qe&&(tt=Qe,Qe=this.length),void 0!==tt&&"string"!=typeof tt)throw new TypeError("encoding must be a string");if("string"==typeof tt&&!Buffer.isEncoding(tt))throw new TypeError("Unknown encoding: "+tt);if(1===Ne.length){var rt=Ne.charCodeAt(0);("utf8"===tt&&rt<128||"latin1"===tt)&&(Ne=rt)}}else"number"==typeof Ne&&(Ne&=255);if(Ge<0||this.length<Ge||this.length<Qe)throw new RangeError("Out of range index");if(Qe<=Ge)return this;var nt;if(Ge>>>=0,Qe=void 0===Qe?this.length:Qe>>>0,Ne||(Ne=0),"number"==typeof Ne)for(nt=Ge;nt<Qe;++nt)this[nt]=Ne;else{var at=Buffer.isBuffer(Ne)?Ne:Buffer.from(Ne,tt),it=at.length;if(0===it)throw new TypeError('The value "'+Ne+'" is invalid for argument "value"');for(nt=0;nt<Qe-Ge;++nt)this[nt+Ge]=at[nt%it]}return this};var at=/[^+/0-9A-Za-z-_]/g;function base64clean(Ne){if((Ne=(Ne=Ne.split("=")[0]).trim().replace(at,"")).length<2)return"";for(;Ne.length%4!=0;)Ne+="=";return Ne}function toHex(Ne){return Ne<16?"0"+Ne.toString(16):Ne.toString(16)}function utf8ToBytes(Ne,Ge){var Qe;Ge=Ge||1/0;for(var tt=Ne.length,rt=null,nt=[],at=0;at<tt;++at){if((Qe=Ne.charCodeAt(at))>55295&&Qe<57344){if(!rt){if(Qe>56319){(Ge-=3)>-1&&nt.push(239,191,189);continue}if(at+1===tt){(Ge-=3)>-1&&nt.push(239,191,189);continue}rt=Qe;continue}if(Qe<56320){(Ge-=3)>-1&&nt.push(239,191,189),rt=Qe;continue}Qe=65536+(rt-55296<<10|Qe-56320)}else rt&&(Ge-=3)>-1&&nt.push(239,191,189);if(rt=null,Qe<128){if((Ge-=1)<0)break;nt.push(Qe)}else if(Qe<2048){if((Ge-=2)<0)break;nt.push(Qe>>6|192,63&Qe|128)}else if(Qe<65536){if((Ge-=3)<0)break;nt.push(Qe>>12|224,Qe>>6&63|128,63&Qe|128)}else{if(!(Qe<1114112))throw new Error("Invalid code point");if((Ge-=4)<0)break;nt.push(Qe>>18|240,Qe>>12&63|128,Qe>>6&63|128,63&Qe|128)}}return nt}function asciiToBytes(Ne){for(var Ge=[],Qe=0;Qe<Ne.length;++Qe)Ge.push(255&Ne.charCodeAt(Qe));return Ge}function utf16leToBytes(Ne,Ge){for(var Qe,tt,rt,nt=[],at=0;at<Ne.length&&!((Ge-=2)<0);++at)tt=(Qe=Ne.charCodeAt(at))>>8,rt=Qe%256,nt.push(rt),nt.push(tt);return nt}function base64ToBytes(Ne){return Ge.toByteArray(base64clean(Ne))}function blitBuffer(Ne,Ge,Qe,tt){for(var rt=0;rt<tt&&!(rt+Qe>=Ge.length||rt>=Ne.length);++rt)Ge[rt+Qe]=Ne[rt];return rt}function isInstance(Ne,Ge){return Ne instanceof Ge||null!=Ne&&null!=Ne.constructor&&null!=Ne.constructor.name&&Ne.constructor.name===Ge.name}function numberIsNaN(Ne){return Ne!=Ne}}).call(this)}).call(this,Ne("buffer").Buffer)},{"base64-js":79,buffer:111,ieee754:442}],112:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./lib/monotone"),rt=Ne("./lib/triangulation"),nt=Ne("./lib/delaunay"),at=Ne("./lib/filter");function canonicalizeEdge(Ne){return[Math.min(Ne[0],Ne[1]),Math.max(Ne[0],Ne[1])]}function compareEdge(Ne,Ge){return Ne[0]-Ge[0]||Ne[1]-Ge[1]}function canonicalizeEdges(Ne){return Ne.map(canonicalizeEdge).sort(compareEdge)}function getDefault(Ne,Ge,Qe){return Ge in Ne?Ne[Ge]:Qe}function cdt2d(Ne,Ge,Qe){Array.isArray(Ge)?(Qe=Qe||{},Ge=Ge||[]):(Qe=Ge||{},Ge=[]);var it=!!getDefault(Qe,"delaunay",!0),ot=!!getDefault(Qe,"interior",!0),dt=!!getDefault(Qe,"exterior",!0),ht=!!getDefault(Qe,"infinity",!1);if(!ot&&!dt||0===Ne.length)return[];var Dt=tt(Ne,Ge);if(it||ot!==dt||ht){for(var Ot=rt(Ne.length,canonicalizeEdges(Ge)),Rt=0;Rt<Dt.length;++Rt){var Zt=Dt[Rt];Ot.addTriangle(Zt[0],Zt[1],Zt[2])}return it&&nt(Ne,Ot),dt?ot?ht?at(Ot,0,ht):Ot.cells():at(Ot,1,ht):at(Ot,-1)}return Dt}Ge.exports=cdt2d},{"./lib/delaunay":113,"./lib/filter":114,"./lib/monotone":115,"./lib/triangulation":116}],113:[function(Ne,Ge,Qe){"use strict";var tt=Ne("robust-in-sphere")[4];function testFlip(Ne,Ge,Qe,rt,nt,at){var it=Ge.opposite(rt,nt);if(!(it<0)){if(nt<rt){var ot=rt;rt=nt,nt=ot,ot=at,at=it,it=ot}Ge.isConstraint(rt,nt)||tt(Ne[rt],Ne[nt],Ne[at],Ne[it])<0&&Qe.push(rt,nt)}}function delaunayRefine(Ne,Ge){for(var Qe=[],rt=Ne.length,nt=Ge.stars,at=0;at<rt;++at)for(var it=nt[at],ot=1;ot<it.length;ot+=2)if(!((Ot=it[ot])<at||Ge.isConstraint(at,Ot))){for(var dt=it[ot-1],ht=-1,Dt=1;Dt<it.length;Dt+=2)if(it[Dt-1]===Ot){ht=it[Dt];break}ht<0||tt(Ne[at],Ne[Ot],Ne[dt],Ne[ht])<0&&Qe.push(at,Ot)}for(;Qe.length>0;){for(var Ot=Qe.pop(),Rt=(dt=-1,ht=-1,it=nt[at=Qe.pop()],1);Rt<it.length;Rt+=2){var Zt=it[Rt-1],er=it[Rt];Zt===Ot?ht=er:er===Ot&&(dt=Zt)}dt<0||ht<0||tt(Ne[at],Ne[Ot],Ne[dt],Ne[ht])>=0||(Ge.flip(at,Ot),testFlip(Ne,Ge,Qe,dt,at,ht),testFlip(Ne,Ge,Qe,at,ht,dt),testFlip(Ne,Ge,Qe,ht,Ot,dt),testFlip(Ne,Ge,Qe,Ot,dt,ht))}}Ne("binary-search-bounds"),Ge.exports=delaunayRefine},{"binary-search-bounds":96,"robust-in-sphere":546}],114:[function(Ne,Ge,Qe){"use strict";var tt,rt=Ne("binary-search-bounds");function FaceIndex(Ne,Ge,Qe,tt,rt,nt,at){this.cells=Ne,this.neighbor=Ge,this.flags=tt,this.constraint=Qe,this.active=rt,this.next=nt,this.boundary=at}function compareCell(Ne,Ge){return Ne[0]-Ge[0]||Ne[1]-Ge[1]||Ne[2]-Ge[2]}function indexCells(Ne,Ge){for(var Qe=Ne.cells(),tt=Qe.length,rt=0;rt<tt;++rt){var nt=(er=Qe[rt])[0],at=er[1],it=er[2];at<it?at<nt&&(er[0]=at,er[1]=it,er[2]=nt):it<nt&&(er[0]=it,er[1]=nt,er[2]=at)}Qe.sort(compareCell);var ot=new Array(tt);for(rt=0;rt<ot.length;++rt)ot[rt]=0;var dt=[],ht=[],Dt=new Array(3*tt),Ot=new Array(3*tt),Rt=null;Ge&&(Rt=[]);var Zt=new FaceIndex(Qe,Dt,Ot,ot,dt,ht,Rt);for(rt=0;rt<tt;++rt)for(var er=Qe[rt],dr=0;dr<3;++dr){nt=er[dr],at=er[(dr+1)%3];var mr=Dt[3*rt+dr]=Zt.locate(at,nt,Ne.opposite(at,nt)),xr=Ot[3*rt+dr]=Ne.isConstraint(nt,at);mr<0&&(xr?ht.push(rt):(dt.push(rt),ot[rt]=1),Ge&&Rt.push([at,nt,-1]))}return Zt}function filterCells(Ne,Ge,Qe){for(var tt=0,rt=0;rt<Ne.length;++rt)Ge[rt]===Qe&&(Ne[tt++]=Ne[rt]);return Ne.length=tt,Ne}function classifyFaces(Ne,Ge,Qe){var tt=indexCells(Ne,Qe);if(0===Ge)return Qe?tt.cells.concat(tt.boundary):tt.cells;for(var rt=1,nt=tt.active,at=tt.next,it=tt.flags,ot=tt.cells,dt=tt.constraint,ht=tt.neighbor;nt.length>0||at.length>0;){for(;nt.length>0;){var Dt=nt.pop();if(it[Dt]!==-rt){it[Dt]=rt,ot[Dt];for(var Ot=0;Ot<3;++Ot){var Rt=ht[3*Dt+Ot];Rt>=0&&0===it[Rt]&&(dt[3*Dt+Ot]?at.push(Rt):(nt.push(Rt),it[Rt]=rt))}}}var Zt=at;at=nt,nt=Zt,at.length=0,rt=-rt}var er=filterCells(ot,it,Ge);return Qe?er.concat(tt.boundary):er}Ge.exports=classifyFaces,FaceIndex.prototype.locate=(tt=[0,0,0],function(Ne,Ge,Qe){var nt=Ne,at=Ge,it=Qe;return Ge<Qe?Ge<Ne&&(nt=Ge,at=Qe,it=Ne):Qe<Ne&&(nt=Qe,at=Ne,it=Ge),nt<0?-1:(tt[0]=nt,tt[1]=at,tt[2]=it,rt.eq(this.cells,tt,compareCell))})},{"binary-search-bounds":96}],115:[function(Ne,Ge,Qe){"use strict";var tt=Ne("binary-search-bounds"),rt=Ne("robust-orientation")[3],nt=0,at=1,it=2;function PartialHull(Ne,Ge,Qe,tt,rt){this.a=Ne,this.b=Ge,this.idx=Qe,this.lowerIds=tt,this.upperIds=rt}function Event(Ne,Ge,Qe,tt){this.a=Ne,this.b=Ge,this.type=Qe,this.idx=tt}function compareEvent(Ne,Ge){var Qe=Ne.a[0]-Ge.a[0]||Ne.a[1]-Ge.a[1]||Ne.type-Ge.type;return Qe||(Ne.type!==nt&&(Qe=rt(Ne.a,Ne.b,Ge.b))?Qe:Ne.idx-Ge.idx)}function testPoint(Ne,Ge){return rt(Ne.a,Ne.b,Ge)}function addPoint(Ne,Ge,Qe,nt,at){for(var it=tt.lt(Ge,nt,testPoint),ot=tt.gt(Ge,nt,testPoint),dt=it;dt<ot;++dt){for(var ht=Ge[dt],Dt=ht.lowerIds,Ot=Dt.length;Ot>1&&rt(Qe[Dt[Ot-2]],Qe[Dt[Ot-1]],nt)>0;)Ne.push([Dt[Ot-1],Dt[Ot-2],at]),Ot-=1;Dt.length=Ot,Dt.push(at);var Rt=ht.upperIds;for(Ot=Rt.length;Ot>1&&rt(Qe[Rt[Ot-2]],Qe[Rt[Ot-1]],nt)<0;)Ne.push([Rt[Ot-2],Rt[Ot-1],at]),Ot-=1;Rt.length=Ot,Rt.push(at)}}function findSplit(Ne,Ge){var Qe;return(Qe=Ne.a[0]<Ge.a[0]?rt(Ne.a,Ne.b,Ge.a):rt(Ge.b,Ge.a,Ne.a))?Qe:(Qe=Ge.b[0]<Ne.b[0]?rt(Ne.a,Ne.b,Ge.b):rt(Ge.b,Ge.a,Ne.b))||Ne.idx-Ge.idx}function splitHulls(Ne,Ge,Qe){var rt=tt.le(Ne,Qe,findSplit),nt=Ne[rt],at=nt.upperIds,it=at[at.length-1];nt.upperIds=[it],Ne.splice(rt+1,0,new PartialHull(Qe.a,Qe.b,Qe.idx,[it],at))}function mergeHulls(Ne,Ge,Qe){var rt=Qe.a;Qe.a=Qe.b,Qe.b=rt;var nt=tt.eq(Ne,Qe,findSplit),at=Ne[nt];Ne[nt-1].upperIds=at.upperIds,Ne.splice(nt,1)}function monotoneTriangulate(Ne,Ge){for(var Qe=Ne.length,tt=Ge.length,rt=[],ot=0;ot<Qe;++ot)rt.push(new Event(Ne[ot],null,nt,ot));for(ot=0;ot<tt;++ot){var dt=Ge[ot],ht=Ne[dt[0]],Dt=Ne[dt[1]];ht[0]<Dt[0]?rt.push(new Event(ht,Dt,it,ot),new Event(Dt,ht,at,ot)):ht[0]>Dt[0]&&rt.push(new Event(Dt,ht,it,ot),new Event(ht,Dt,at,ot))}rt.sort(compareEvent);for(var Ot=rt[0].a[0]-(1+Math.abs(rt[0].a[0]))*Math.pow(2,-52),Rt=[new PartialHull([Ot,1],[Ot,0],-1,[],[],[],[])],Zt=[],er=(ot=0,rt.length);ot<er;++ot){var dr=rt[ot],mr=dr.type;mr===nt?addPoint(Zt,Rt,Ne,dr.a,dr.idx):mr===it?splitHulls(Rt,Ne,dr):mergeHulls(Rt,Ne,dr)}return Zt}Ge.exports=monotoneTriangulate},{"binary-search-bounds":96,"robust-orientation":548}],116:[function(Ne,Ge,Qe){"use strict";var tt=Ne("binary-search-bounds");function Triangulation(Ne,Ge){this.stars=Ne,this.edges=Ge}Ge.exports=createTriangulation;var rt=Triangulation.prototype;function removePair(Ne,Ge,Qe){for(var tt=1,rt=Ne.length;tt<rt;tt+=2)if(Ne[tt-1]===Ge&&Ne[tt]===Qe)return Ne[tt-1]=Ne[rt-2],Ne[tt]=Ne[rt-1],void(Ne.length=rt-2)}function createTriangulation(Ne,Ge){for(var Qe=new Array(Ne),tt=0;tt<Ne;++tt)Qe[tt]=[];return new Triangulation(Qe,Ge)}rt.isConstraint=function(){var Ne=[0,0];function compareLex(Ne,Ge){return Ne[0]-Ge[0]||Ne[1]-Ge[1]}return function(Ge,Qe){return Ne[0]=Math.min(Ge,Qe),Ne[1]=Math.max(Ge,Qe),tt.eq(this.edges,Ne,compareLex)>=0}}(),rt.removeTriangle=function(Ne,Ge,Qe){var tt=this.stars;removePair(tt[Ne],Ge,Qe),removePair(tt[Ge],Qe,Ne),removePair(tt[Qe],Ne,Ge)},rt.addTriangle=function(Ne,Ge,Qe){var tt=this.stars;tt[Ne].push(Ge,Qe),tt[Ge].push(Qe,Ne),tt[Qe].push(Ne,Ge)},rt.opposite=function(Ne,Ge){for(var Qe=this.stars[Ge],tt=1,rt=Qe.length;tt<rt;tt+=2)if(Qe[tt]===Ne)return Qe[tt-1];return-1},rt.flip=function(Ne,Ge){var Qe=this.opposite(Ne,Ge),tt=this.opposite(Ge,Ne);this.removeTriangle(Ne,Ge,Qe),this.removeTriangle(Ge,Ne,tt),this.addTriangle(Ne,tt,Qe),this.addTriangle(Ge,Qe,tt)},rt.edges=function(){for(var Ne=this.stars,Ge=[],Qe=0,tt=Ne.length;Qe<tt;++Qe)for(var rt=Ne[Qe],nt=0,at=rt.length;nt<at;nt+=2)Ge.push([rt[nt],rt[nt+1]]);return Ge},rt.cells=function(){for(var Ne=this.stars,Ge=[],Qe=0,tt=Ne.length;Qe<tt;++Qe)for(var rt=Ne[Qe],nt=0,at=rt.length;nt<at;nt+=2){var it=rt[nt],ot=rt[nt+1];Qe<Math.min(it,ot)&&Ge.push([Qe,it,ot])}return Ge}},{"binary-search-bounds":96}],117:[function(Ne,Ge,Qe){"use strict";function orientation(Ne){for(var Ge=1,Qe=1;Qe<Ne.length;++Qe)for(var tt=0;tt<Qe;++tt)if(Ne[Qe]<Ne[tt])Ge=-Ge;else if(Ne[tt]===Ne[Qe])return 0;return Ge}Ge.exports=orientation},{}],118:[function(Ne,Ge,Qe){"use strict";var tt=Ne("dup"),rt=Ne("robust-linear-solve");function dot(Ne,Ge){for(var Qe=0,tt=Ne.length,rt=0;rt<tt;++rt)Qe+=Ne[rt]*Ge[rt];return Qe}function barycentricCircumcenter(Ne){var Ge=Ne.length;if(0===Ge)return[];Ne[0].length;var Qe=tt([Ne.length+1,Ne.length+1],1),nt=tt([Ne.length+1],1);Qe[Ge][Ge]=0;for(var at=0;at<Ge;++at){for(var it=0;it<=at;++it)Qe[it][at]=Qe[at][it]=2*dot(Ne[at],Ne[it]);nt[at]=dot(Ne[at],Ne[at])}var ot=rt(Qe,nt),dt=0,ht=ot[Ge+1];for(at=0;at<ht.length;++at)dt+=ht[at];var Dt=new Array(Ge);for(at=0;at<Ge;++at){ht=ot[at];var Ot=0;for(it=0;it<ht.length;++it)Ot+=ht[it];Dt[at]=Ot/dt}return Dt}function circumcenter(Ne){if(0===Ne.length)return[];for(var Ge=Ne[0].length,Qe=tt([Ge]),rt=barycentricCircumcenter(Ne),nt=0;nt<Ne.length;++nt)for(var at=0;at<Ge;++at)Qe[at]+=Ne[nt][at]*rt[nt];return Qe}circumcenter.barycenetric=barycentricCircumcenter,Ge.exports=circumcenter},{dup:176,"robust-linear-solve":547}],119:[function(Ne,Ge,Qe){Ge.exports=circumradius;var tt=Ne("circumcenter");function circumradius(Ne){for(var Ge=tt(Ne),Qe=0,rt=0;rt<Ne.length;++rt)for(var nt=Ne[rt],at=0;at<Ge.length;++at)Qe+=Math.pow(nt[at]-Ge[at],2);return Math.sqrt(Qe/Ne.length)}},{circumcenter:118}],120:[function(Ne,Ge,Qe){function clamp(Ne,Ge,Qe){return Ge<Qe?Ne<Ge?Ge:Ne>Qe?Qe:Ne:Ne<Qe?Qe:Ne>Ge?Ge:Ne}Ge.exports=clamp},{}],121:[function(Ne,Ge,Qe){"use strict";Ge.exports=cleanPSLG;var tt=Ne("union-find"),rt=Ne("box-intersect"),nt=Ne("robust-segment-intersect"),at=Ne("big-rat"),it=Ne("big-rat/cmp"),ot=Ne("big-rat/to-float"),dt=Ne("rat-vec"),ht=Ne("nextafter"),Dt=Ne("./lib/rat-seg-intersect");function boundRat(Ne){var Ge=ot(Ne);return[ht(Ge,-1/0),ht(Ge,1/0)]}function boundEdges(Ne,Ge){for(var Qe=new Array(Ge.length),tt=0;tt<Ge.length;++tt){var rt=Ge[tt],nt=Ne[rt[0]],at=Ne[rt[1]];Qe[tt]=[ht(Math.min(nt[0],at[0]),-1/0),ht(Math.min(nt[1],at[1]),-1/0),ht(Math.max(nt[0],at[0]),1/0),ht(Math.max(nt[1],at[1]),1/0)]}return Qe}function boundPoints(Ne){for(var Ge=new Array(Ne.length),Qe=0;Qe<Ne.length;++Qe){var tt=Ne[Qe];Ge[Qe]=[ht(tt[0],-1/0),ht(tt[1],-1/0),ht(tt[0],1/0),ht(tt[1],1/0)]}return Ge}function getCrossings(Ne,Ge,Qe){var tt=[];return rt(Qe,(function(Qe,rt){var at=Ge[Qe],it=Ge[rt];if(at[0]!==it[0]&&at[0]!==it[1]&&at[1]!==it[0]&&at[1]!==it[1]){var ot=Ne[at[0]],dt=Ne[at[1]],ht=Ne[it[0]],Dt=Ne[it[1]];nt(ot,dt,ht,Dt)&&tt.push([Qe,rt])}})),tt}function getTJunctions(Ne,Ge,Qe,tt){var at=[];return rt(Qe,tt,(function(Qe,tt){var rt=Ge[Qe];if(rt[0]!==tt&&rt[1]!==tt){var it=Ne[tt],ot=Ne[rt[0]],dt=Ne[rt[1]];nt(ot,dt,it,it)&&at.push([Qe,tt])}})),at}function cutEdges(Ne,Ge,Qe,tt,rt){var nt,ht,Ot=Ne.map((function(Ne){return[at(Ne[0]),at(Ne[1])]}));for(nt=0;nt<Qe.length;++nt){var Rt=Qe[nt];ht=Rt[0];var Zt=Rt[1],er=Ge[ht],dr=Ge[Zt],mr=Dt(dt(Ne[er[0]]),dt(Ne[er[1]]),dt(Ne[dr[0]]),dt(Ne[dr[1]]));if(mr){var xr=Ne.length;Ne.push([ot(mr[0]),ot(mr[1])]),Ot.push(mr),tt.push([ht,xr],[Zt,xr])}}for(tt.sort((function(Ne,Ge){if(Ne[0]!==Ge[0])return Ne[0]-Ge[0];var Qe=Ot[Ne[1]],tt=Ot[Ge[1]];return it(Qe[0],tt[0])||it(Qe[1],tt[1])})),nt=tt.length-1;nt>=0;--nt){var br=Ge[ht=(Pn=tt[nt])[0]],Ar=br[0],en=br[1],mn=Ne[Ar],xn=Ne[en];if((mn[0]-xn[0]||mn[1]-xn[1])<0){var kn=Ar;Ar=en,en=kn}br[0]=Ar;var Cn,En=br[1]=Pn[1];for(rt&&(Cn=br[2]);nt>0&&tt[nt-1][0]===ht;){var Pn,Dn=(Pn=tt[--nt])[1];rt?Ge.push([En,Dn,Cn]):Ge.push([En,Dn]),En=Dn}rt?Ge.push([En,en,Cn]):Ge.push([En,en])}return Ot}function dedupPoints(Ne,Ge,Qe){for(var nt=Ge.length,at=new tt(nt),it=[],ot=0;ot<Ge.length;++ot){var dt=Ge[ot],Dt=boundRat(dt[0]),Ot=boundRat(dt[1]);it.push([ht(Dt[0],-1/0),ht(Ot[0],-1/0),ht(Dt[1],1/0),ht(Ot[1],1/0)])}rt(it,(function(Ne,Ge){at.link(Ne,Ge)}));var Rt=!0,Zt=new Array(nt);for(ot=0;ot<nt;++ot)(dr=at.find(ot))!==ot&&(Rt=!1,Ne[dr]=[Math.min(Ne[ot][0],Ne[dr][0]),Math.min(Ne[ot][1],Ne[dr][1])]);if(Rt)return null;var er=0;for(ot=0;ot<nt;++ot){var dr;(dr=at.find(ot))===ot?(Zt[ot]=er,Ne[er++]=Ne[ot]):Zt[ot]=-1}for(Ne.length=er,ot=0;ot<nt;++ot)Zt[ot]<0&&(Zt[ot]=Zt[at.find(ot)]);return Zt}function compareLex2(Ne,Ge){return Ne[0]-Ge[0]||Ne[1]-Ge[1]}function compareLex3(Ne,Ge){var Qe=Ne[0]-Ge[0]||Ne[1]-Ge[1];return Qe||(Ne[2]<Ge[2]?-1:Ne[2]>Ge[2]?1:0)}function dedupEdges(Ne,Ge,Qe){if(0!==Ne.length){if(Ge)for(var tt=0;tt<Ne.length;++tt){var rt=Ge[(at=Ne[tt])[0]],nt=Ge[at[1]];at[0]=Math.min(rt,nt),at[1]=Math.max(rt,nt)}else for(tt=0;tt<Ne.length;++tt){var at;rt=(at=Ne[tt])[0],nt=at[1],at[0]=Math.min(rt,nt),at[1]=Math.max(rt,nt)}Qe?Ne.sort(compareLex3):Ne.sort(compareLex2);var it=1;for(tt=1;tt<Ne.length;++tt){var ot=Ne[tt-1],dt=Ne[tt];(dt[0]!==ot[0]||dt[1]!==ot[1]||Qe&&dt[2]!==ot[2])&&(Ne[it++]=dt)}Ne.length=it}}function preRound(Ne,Ge,Qe){var tt=dedupPoints(Ne,[],boundPoints(Ne));return dedupEdges(Ge,tt,Qe),!!tt}function snapRound(Ne,Ge,Qe){var tt=boundEdges(Ne,Ge),rt=getCrossings(Ne,Ge,tt),nt=boundPoints(Ne),at=getTJunctions(Ne,Ge,tt,nt),it=dedupPoints(Ne,cutEdges(Ne,Ge,rt,at,Qe),nt);return dedupEdges(Ge,it,Qe),!!it||rt.length>0||at.length>0}function cleanPSLG(Ne,Ge,Qe){var tt;if(Qe){tt=Ge;for(var rt=new Array(Ge.length),nt=0;nt<Ge.length;++nt){var at=Ge[nt];rt[nt]=[at[0],at[1],Qe[nt]]}Ge=rt}for(var it=preRound(Ne,Ge,!!Qe);snapRound(Ne,Ge,!!Qe);)it=!0;if(Qe&&it)for(tt.length=0,Qe.length=0,nt=0;nt<Ge.length;++nt)at=Ge[nt],tt.push([at[0],at[1]]),Qe.push(at[2]);return it}},{"./lib/rat-seg-intersect":122,"big-rat":83,"big-rat/cmp":81,"big-rat/to-float":95,"box-intersect":101,nextafter:496,"rat-vec":530,"robust-segment-intersect":551,"union-find":596}],122:[function(Ne,Ge,Qe){"use strict";Ge.exports=solveIntersection;var tt=Ne("big-rat/mul"),rt=Ne("big-rat/div"),nt=Ne("big-rat/sub"),at=Ne("big-rat/sign"),it=Ne("rat-vec/sub"),ot=Ne("rat-vec/add"),dt=Ne("rat-vec/muls");function ratPerp(Ne,Ge){return nt(tt(Ne[0],Ge[1]),tt(Ne[1],Ge[0]))}function solveIntersection(Ne,Ge,Qe,tt){var nt=it(Ge,Ne),ht=it(tt,Qe),Dt=ratPerp(nt,ht);if(0===at(Dt))return null;var Ot=ratPerp(ht,it(Ne,Qe)),Rt=rt(Ot,Dt),Zt=dt(nt,Rt);return ot(Ne,Zt)}},{"big-rat/div":82,"big-rat/mul":92,"big-rat/sign":93,"big-rat/sub":94,"rat-vec/add":529,"rat-vec/muls":531,"rat-vec/sub":532}],123:[function(Ne,Ge,Qe){"use strict";var tt=Ne("clamp");function toNumber(Ne,Ge){null==Ge&&(Ge=!0);var Qe=Ne[0],rt=Ne[1],nt=Ne[2],at=Ne[3];return null==at&&(at=Ge?1:255),Ge&&(Qe*=255,rt*=255,nt*=255,at*=255),16777216*(Qe=255&tt(Qe,0,255))+((rt=255&tt(rt,0,255))<<16)+((nt=255&tt(nt,0,255))<<8)+(at=255&tt(at,0,255))}function fromNumber(Ne,Ge){var Qe=(Ne=+Ne)>>>24,tt=(16711680&Ne)>>>16,rt=(65280&Ne)>>>8,nt=255&Ne;return!1===Ge?[Qe,tt,rt,nt]:[Qe/255,tt/255,rt/255,nt/255]}Ge.exports=toNumber,Ge.exports.to=toNumber,Ge.exports.from=fromNumber},{clamp:120}],124:[function(Ne,Ge,Qe){"use strict";Ge.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},{}],125:[function(Ne,Ge,Qe){"use strict";var tt=Ne("color-rgba"),rt=Ne("clamp"),nt=Ne("dtype");function isInt(Ne){return Ne instanceof Uint8Array||Ne instanceof Uint8ClampedArray||!!(Array.isArray(Ne)&&(Ne[0]>1||0===Ne[0])&&(Ne[1]>1||0===Ne[1])&&(Ne[2]>1||0===Ne[2])&&(!Ne[3]||Ne[3]>1))}Ge.exports=function(Ne,Ge){"float"!==Ge&&Ge||(Ge="array"),"uint"===Ge&&(Ge="uint8"),"uint_clamped"===Ge&&(Ge="uint8_clamped");var Qe=new(nt(Ge))(4),at="uint8"!==Ge&&"uint8_clamped"!==Ge;return Ne.length&&"string"!=typeof Ne||((Ne=tt(Ne))[0]/=255,Ne[1]/=255,Ne[2]/=255),isInt(Ne)?(Qe[0]=Ne[0],Qe[1]=Ne[1],Qe[2]=Ne[2],Qe[3]=null!=Ne[3]?Ne[3]:255,at&&(Qe[0]/=255,Qe[1]/=255,Qe[2]/=255,Qe[3]/=255),Qe):(at?(Qe[0]=Ne[0],Qe[1]=Ne[1],Qe[2]=Ne[2],Qe[3]=null!=Ne[3]?Ne[3]:1):(Qe[0]=rt(Math.floor(255*Ne[0]),0,255),Qe[1]=rt(Math.floor(255*Ne[1]),0,255),Qe[2]=rt(Math.floor(255*Ne[2]),0,255),Qe[3]=null==Ne[3]?255:rt(Math.floor(255*Ne[3]),0,255)),Qe)}},{clamp:120,"color-rgba":127,dtype:175}],126:[function(Ne,Ge,tt){(function(Qe){(function(){"use strict";var tt=Ne("color-name"),rt=Ne("is-plain-obj"),nt=Ne("defined");Ge.exports=parse;var at={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function parse(Ne){var Ge,it,ot=[],dt=1;if("string"==typeof Ne)if(tt[Ne])ot=tt[Ne].slice(),it="rgb";else if("transparent"===Ne)dt=0,it="rgb",ot=[0,0,0];else if(/^#[A-Fa-f0-9]+$/.test(Ne)){var ht=Ne.slice(1);dt=1,(Rt=ht.length)<=4?(ot=[parseInt(ht[0]+ht[0],16),parseInt(ht[1]+ht[1],16),parseInt(ht[2]+ht[2],16)],4===Rt&&(dt=parseInt(ht[3]+ht[3],16)/255)):(ot=[parseInt(ht[0]+ht[1],16),parseInt(ht[2]+ht[3],16),parseInt(ht[4]+ht[5],16)],8===Rt&&(dt=parseInt(ht[6]+ht[7],16)/255)),ot[0]||(ot[0]=0),ot[1]||(ot[1]=0),ot[2]||(ot[2]=0),it="rgb"}else if(Ge=/^((?:rgb|hs[lvb]|hwb|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms)a?)\s*\(([^\)]*)\)/.exec(Ne)){var Dt=Ge[1],Ot="rgb"===Dt;it=ht=Dt.replace(/a$/,"");var Rt="cmyk"===ht?4:"gray"===ht?1:3;ot=Ge[2].trim().split(/\s*,\s*/).map((function(Ne,Ge){if(/%$/.test(Ne))return Ge===Rt?parseFloat(Ne)/100:"rgb"===ht?255*parseFloat(Ne)/100:parseFloat(Ne);if("h"===ht[Ge]){if(/deg$/.test(Ne))return parseFloat(Ne);if(void 0!==at[Ne])return at[Ne]}return parseFloat(Ne)})),Dt===ht&&ot.push(1),dt=Ot||void 0===ot[Rt]?1:ot[Rt],ot=ot.slice(0,Rt)}else Ne.length>10&&/[0-9](?:\s|\/)/.test(Ne)&&(ot=Ne.match(/([0-9]+)/g).map((function(Ne){return parseFloat(Ne)})),it=Ne.match(/([a-z])/gi).join("").toLowerCase());else if(isNaN(Ne))if(rt(Ne)){var Zt=nt(Ne.r,Ne.red,Ne.R,null);null!==Zt?(it="rgb",ot=[Zt,nt(Ne.g,Ne.green,Ne.G),nt(Ne.b,Ne.blue,Ne.B)]):(it="hsl",ot=[nt(Ne.h,Ne.hue,Ne.H),nt(Ne.s,Ne.saturation,Ne.S),nt(Ne.l,Ne.lightness,Ne.L,Ne.b,Ne.brightness)]),dt=nt(Ne.a,Ne.alpha,Ne.opacity,1),null!=Ne.opacity&&(dt/=100)}else(Array.isArray(Ne)||Qe.ArrayBuffer&&ArrayBuffer.isView&&ArrayBuffer.isView(Ne))&&(ot=[Ne[0],Ne[1],Ne[2]],it="rgb",dt=4===Ne.length?Ne[3]:1);else it="rgb",ot=[Ne>>>16,(65280&Ne)>>>8,255&Ne];return{space:it,values:ot,alpha:dt}}}).call(this)}).call(this,void 0!==Qe.g?Qe.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"color-name":124,defined:170,"is-plain-obj":469}],127:[function(Ne,Ge,Qe){"use strict";var tt=Ne("color-parse"),rt=Ne("color-space/hsl"),nt=Ne("clamp");Ge.exports=function(Ne){var Ge,Qe=tt(Ne);return Qe.space?((Ge=Array(3))[0]=nt(Qe.values[0],0,255),Ge[1]=nt(Qe.values[1],0,255),Ge[2]=nt(Qe.values[2],0,255),"h"===Qe.space[0]&&(Ge=rt.rgb(Ge)),Ge.push(nt(Qe.alpha,0,1)),Ge):[]}},{clamp:120,"color-parse":126,"color-space/hsl":128}],128:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./rgb");Ge.exports={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(Ne){var Ge,Qe,tt,rt,nt,at=Ne[0]/360,it=Ne[1]/100,ot=Ne[2]/100;if(0===it)return[nt=255*ot,nt,nt];Ge=2*ot-(Qe=ot<.5?ot*(1+it):ot+it-ot*it),rt=[0,0,0];for(var dt=0;dt<3;dt++)(tt=at+1/3*-(dt-1))<0?tt++:tt>1&&tt--,nt=6*tt<1?Ge+6*(Qe-Ge)*tt:2*tt<1?Qe:3*tt<2?Ge+(Qe-Ge)*(2/3-tt)*6:Ge,rt[dt]=255*nt;return rt}},tt.hsl=function(Ne){var Ge,Qe,tt=Ne[0]/255,rt=Ne[1]/255,nt=Ne[2]/255,at=Math.min(tt,rt,nt),it=Math.max(tt,rt,nt),ot=it-at;return it===at?Ge=0:tt===it?Ge=(rt-nt)/ot:rt===it?Ge=2+(nt-tt)/ot:nt===it&&(Ge=4+(tt-rt)/ot),(Ge=Math.min(60*Ge,360))<0&&(Ge+=360),Qe=(at+it)/2,[Ge,100*(it===at?0:Qe<=.5?ot/(it+at):ot/(2-it-at)),100*Qe]}},{"./rgb":129}],129:[function(Ne,Ge,Qe){"use strict";Ge.exports={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]}},{}],130:[function(Ne,Ge,Qe){Ge.exports={jet:[{index:0,rgb:[0,0,131]},{index:.125,rgb:[0,60,170]},{index:.375,rgb:[5,255,255]},{index:.625,rgb:[255,255,0]},{index:.875,rgb:[250,0,0]},{index:1,rgb:[128,0,0]}],hsv:[{index:0,rgb:[255,0,0]},{index:.169,rgb:[253,255,2]},{index:.173,rgb:[247,255,2]},{index:.337,rgb:[0,252,4]},{index:.341,rgb:[0,252,10]},{index:.506,rgb:[1,249,255]},{index:.671,rgb:[2,0,253]},{index:.675,rgb:[8,0,253]},{index:.839,rgb:[255,0,251]},{index:.843,rgb:[255,0,245]},{index:1,rgb:[255,0,6]}],hot:[{index:0,rgb:[0,0,0]},{index:.3,rgb:[230,0,0]},{index:.6,rgb:[255,210,0]},{index:1,rgb:[255,255,255]}],cool:[{index:0,rgb:[0,255,255]},{index:1,rgb:[255,0,255]}],spring:[{index:0,rgb:[255,0,255]},{index:1,rgb:[255,255,0]}],summer:[{index:0,rgb:[0,128,102]},{index:1,rgb:[255,255,102]}],autumn:[{index:0,rgb:[255,0,0]},{index:1,rgb:[255,255,0]}],winter:[{index:0,rgb:[0,0,255]},{index:1,rgb:[0,255,128]}],bone:[{index:0,rgb:[0,0,0]},{index:.376,rgb:[84,84,116]},{index:.753,rgb:[169,200,200]},{index:1,rgb:[255,255,255]}],copper:[{index:0,rgb:[0,0,0]},{index:.804,rgb:[255,160,102]},{index:1,rgb:[255,199,127]}],greys:[{index:0,rgb:[0,0,0]},{index:1,rgb:[255,255,255]}],yignbu:[{index:0,rgb:[8,29,88]},{index:.125,rgb:[37,52,148]},{index:.25,rgb:[34,94,168]},{index:.375,rgb:[29,145,192]},{index:.5,rgb:[65,182,196]},{index:.625,rgb:[127,205,187]},{index:.75,rgb:[199,233,180]},{index:.875,rgb:[237,248,217]},{index:1,rgb:[255,255,217]}],greens:[{index:0,rgb:[0,68,27]},{index:.125,rgb:[0,109,44]},{index:.25,rgb:[35,139,69]},{index:.375,rgb:[65,171,93]},{index:.5,rgb:[116,196,118]},{index:.625,rgb:[161,217,155]},{index:.75,rgb:[199,233,192]},{index:.875,rgb:[229,245,224]},{index:1,rgb:[247,252,245]}],yiorrd:[{index:0,rgb:[128,0,38]},{index:.125,rgb:[189,0,38]},{index:.25,rgb:[227,26,28]},{index:.375,rgb:[252,78,42]},{index:.5,rgb:[253,141,60]},{index:.625,rgb:[254,178,76]},{index:.75,rgb:[254,217,118]},{index:.875,rgb:[255,237,160]},{index:1,rgb:[255,255,204]}],bluered:[{index:0,rgb:[0,0,255]},{index:1,rgb:[255,0,0]}],rdbu:[{index:0,rgb:[5,10,172]},{index:.35,rgb:[106,137,247]},{index:.5,rgb:[190,190,190]},{index:.6,rgb:[220,170,132]},{index:.7,rgb:[230,145,90]},{index:1,rgb:[178,10,28]}],picnic:[{index:0,rgb:[0,0,255]},{index:.1,rgb:[51,153,255]},{index:.2,rgb:[102,204,255]},{index:.3,rgb:[153,204,255]},{index:.4,rgb:[204,204,255]},{index:.5,rgb:[255,255,255]},{index:.6,rgb:[255,204,255]},{index:.7,rgb:[255,153,255]},{index:.8,rgb:[255,102,204]},{index:.9,rgb:[255,102,102]},{index:1,rgb:[255,0,0]}],rainbow:[{index:0,rgb:[150,0,90]},{index:.125,rgb:[0,0,200]},{index:.25,rgb:[0,25,255]},{index:.375,rgb:[0,152,255]},{index:.5,rgb:[44,255,150]},{index:.625,rgb:[151,255,0]},{index:.75,rgb:[255,234,0]},{index:.875,rgb:[255,111,0]},{index:1,rgb:[255,0,0]}],portland:[{index:0,rgb:[12,51,131]},{index:.25,rgb:[10,136,186]},{index:.5,rgb:[242,211,56]},{index:.75,rgb:[242,143,56]},{index:1,rgb:[217,30,30]}],blackbody:[{index:0,rgb:[0,0,0]},{index:.2,rgb:[230,0,0]},{index:.4,rgb:[230,210,0]},{index:.7,rgb:[255,255,255]},{index:1,rgb:[160,200,255]}],earth:[{index:0,rgb:[0,0,130]},{index:.1,rgb:[0,180,180]},{index:.2,rgb:[40,210,40]},{index:.4,rgb:[230,230,50]},{index:.6,rgb:[120,70,20]},{index:1,rgb:[255,255,255]}],electric:[{index:0,rgb:[0,0,0]},{index:.15,rgb:[30,0,100]},{index:.4,rgb:[120,0,100]},{index:.6,rgb:[160,90,0]},{index:.8,rgb:[230,200,0]},{index:1,rgb:[255,250,220]}],alpha:[{index:0,rgb:[255,255,255,0]},{index:1,rgb:[255,255,255,1]}],viridis:[{index:0,rgb:[68,1,84]},{index:.13,rgb:[71,44,122]},{index:.25,rgb:[59,81,139]},{index:.38,rgb:[44,113,142]},{index:.5,rgb:[33,144,141]},{index:.63,rgb:[39,173,129]},{index:.75,rgb:[92,200,99]},{index:.88,rgb:[170,220,50]},{index:1,rgb:[253,231,37]}],inferno:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[31,12,72]},{index:.25,rgb:[85,15,109]},{index:.38,rgb:[136,34,106]},{index:.5,rgb:[186,54,85]},{index:.63,rgb:[227,89,51]},{index:.75,rgb:[249,140,10]},{index:.88,rgb:[249,201,50]},{index:1,rgb:[252,255,164]}],magma:[{index:0,rgb:[0,0,4]},{index:.13,rgb:[28,16,68]},{index:.25,rgb:[79,18,123]},{index:.38,rgb:[129,37,129]},{index:.5,rgb:[181,54,122]},{index:.63,rgb:[229,80,100]},{index:.75,rgb:[251,135,97]},{index:.88,rgb:[254,194,135]},{index:1,rgb:[252,253,191]}],plasma:[{index:0,rgb:[13,8,135]},{index:.13,rgb:[75,3,161]},{index:.25,rgb:[125,3,168]},{index:.38,rgb:[168,34,150]},{index:.5,rgb:[203,70,121]},{index:.63,rgb:[229,107,93]},{index:.75,rgb:[248,148,65]},{index:.88,rgb:[253,195,40]},{index:1,rgb:[240,249,33]}],warm:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[172,0,187]},{index:.25,rgb:[219,0,170]},{index:.38,rgb:[255,0,130]},{index:.5,rgb:[255,63,74]},{index:.63,rgb:[255,123,0]},{index:.75,rgb:[234,176,0]},{index:.88,rgb:[190,228,0]},{index:1,rgb:[147,255,0]}],cool:[{index:0,rgb:[125,0,179]},{index:.13,rgb:[116,0,218]},{index:.25,rgb:[98,74,237]},{index:.38,rgb:[68,146,231]},{index:.5,rgb:[0,204,197]},{index:.63,rgb:[0,247,146]},{index:.75,rgb:[0,255,88]},{index:.88,rgb:[40,255,8]},{index:1,rgb:[147,255,0]}],"rainbow-soft":[{index:0,rgb:[125,0,179]},{index:.1,rgb:[199,0,180]},{index:.2,rgb:[255,0,121]},{index:.3,rgb:[255,108,0]},{index:.4,rgb:[222,194,0]},{index:.5,rgb:[150,255,0]},{index:.6,rgb:[0,255,55]},{index:.7,rgb:[0,246,150]},{index:.8,rgb:[50,167,222]},{index:.9,rgb:[103,51,235]},{index:1,rgb:[124,0,186]}],bathymetry:[{index:0,rgb:[40,26,44]},{index:.13,rgb:[59,49,90]},{index:.25,rgb:[64,76,139]},{index:.38,rgb:[63,110,151]},{index:.5,rgb:[72,142,158]},{index:.63,rgb:[85,174,163]},{index:.75,rgb:[120,206,163]},{index:.88,rgb:[187,230,172]},{index:1,rgb:[253,254,204]}],cdom:[{index:0,rgb:[47,15,62]},{index:.13,rgb:[87,23,86]},{index:.25,rgb:[130,28,99]},{index:.38,rgb:[171,41,96]},{index:.5,rgb:[206,67,86]},{index:.63,rgb:[230,106,84]},{index:.75,rgb:[242,149,103]},{index:.88,rgb:[249,193,135]},{index:1,rgb:[254,237,176]}],chlorophyll:[{index:0,rgb:[18,36,20]},{index:.13,rgb:[25,63,41]},{index:.25,rgb:[24,91,59]},{index:.38,rgb:[13,119,72]},{index:.5,rgb:[18,148,80]},{index:.63,rgb:[80,173,89]},{index:.75,rgb:[132,196,122]},{index:.88,rgb:[175,221,162]},{index:1,rgb:[215,249,208]}],density:[{index:0,rgb:[54,14,36]},{index:.13,rgb:[89,23,80]},{index:.25,rgb:[110,45,132]},{index:.38,rgb:[120,77,178]},{index:.5,rgb:[120,113,213]},{index:.63,rgb:[115,151,228]},{index:.75,rgb:[134,185,227]},{index:.88,rgb:[177,214,227]},{index:1,rgb:[230,241,241]}],"freesurface-blue":[{index:0,rgb:[30,4,110]},{index:.13,rgb:[47,14,176]},{index:.25,rgb:[41,45,236]},{index:.38,rgb:[25,99,212]},{index:.5,rgb:[68,131,200]},{index:.63,rgb:[114,156,197]},{index:.75,rgb:[157,181,203]},{index:.88,rgb:[200,208,216]},{index:1,rgb:[241,237,236]}],"freesurface-red":[{index:0,rgb:[60,9,18]},{index:.13,rgb:[100,17,27]},{index:.25,rgb:[142,20,29]},{index:.38,rgb:[177,43,27]},{index:.5,rgb:[192,87,63]},{index:.63,rgb:[205,125,105]},{index:.75,rgb:[216,162,148]},{index:.88,rgb:[227,199,193]},{index:1,rgb:[241,237,236]}],oxygen:[{index:0,rgb:[64,5,5]},{index:.13,rgb:[106,6,15]},{index:.25,rgb:[144,26,7]},{index:.38,rgb:[168,64,3]},{index:.5,rgb:[188,100,4]},{index:.63,rgb:[206,136,11]},{index:.75,rgb:[220,174,25]},{index:.88,rgb:[231,215,44]},{index:1,rgb:[248,254,105]}],par:[{index:0,rgb:[51,20,24]},{index:.13,rgb:[90,32,35]},{index:.25,rgb:[129,44,34]},{index:.38,rgb:[159,68,25]},{index:.5,rgb:[182,99,19]},{index:.63,rgb:[199,134,22]},{index:.75,rgb:[212,171,35]},{index:.88,rgb:[221,210,54]},{index:1,rgb:[225,253,75]}],phase:[{index:0,rgb:[145,105,18]},{index:.13,rgb:[184,71,38]},{index:.25,rgb:[186,58,115]},{index:.38,rgb:[160,71,185]},{index:.5,rgb:[110,97,218]},{index:.63,rgb:[50,123,164]},{index:.75,rgb:[31,131,110]},{index:.88,rgb:[77,129,34]},{index:1,rgb:[145,105,18]}],salinity:[{index:0,rgb:[42,24,108]},{index:.13,rgb:[33,50,162]},{index:.25,rgb:[15,90,145]},{index:.38,rgb:[40,118,137]},{index:.5,rgb:[59,146,135]},{index:.63,rgb:[79,175,126]},{index:.75,rgb:[120,203,104]},{index:.88,rgb:[193,221,100]},{index:1,rgb:[253,239,154]}],temperature:[{index:0,rgb:[4,35,51]},{index:.13,rgb:[23,51,122]},{index:.25,rgb:[85,59,157]},{index:.38,rgb:[129,79,143]},{index:.5,rgb:[175,95,130]},{index:.63,rgb:[222,112,101]},{index:.75,rgb:[249,146,66]},{index:.88,rgb:[249,196,65]},{index:1,rgb:[232,250,91]}],turbidity:[{index:0,rgb:[34,31,27]},{index:.13,rgb:[65,50,41]},{index:.25,rgb:[98,69,52]},{index:.38,rgb:[131,89,57]},{index:.5,rgb:[161,112,59]},{index:.63,rgb:[185,140,66]},{index:.75,rgb:[202,174,88]},{index:.88,rgb:[216,209,126]},{index:1,rgb:[233,246,171]}],"velocity-blue":[{index:0,rgb:[17,32,64]},{index:.13,rgb:[35,52,116]},{index:.25,rgb:[29,81,156]},{index:.38,rgb:[31,113,162]},{index:.5,rgb:[50,144,169]},{index:.63,rgb:[87,173,176]},{index:.75,rgb:[149,196,189]},{index:.88,rgb:[203,221,211]},{index:1,rgb:[254,251,230]}],"velocity-green":[{index:0,rgb:[23,35,19]},{index:.13,rgb:[24,64,38]},{index:.25,rgb:[11,95,45]},{index:.38,rgb:[39,123,35]},{index:.5,rgb:[95,146,12]},{index:.63,rgb:[152,165,18]},{index:.75,rgb:[201,186,69]},{index:.88,rgb:[233,216,137]},{index:1,rgb:[255,253,205]}],cubehelix:[{index:0,rgb:[0,0,0]},{index:.07,rgb:[22,5,59]},{index:.13,rgb:[60,4,105]},{index:.2,rgb:[109,1,135]},{index:.27,rgb:[161,0,147]},{index:.33,rgb:[210,2,142]},{index:.4,rgb:[251,11,123]},{index:.47,rgb:[255,29,97]},{index:.53,rgb:[255,54,69]},{index:.6,rgb:[255,85,46]},{index:.67,rgb:[255,120,34]},{index:.73,rgb:[255,157,37]},{index:.8,rgb:[241,191,57]},{index:.87,rgb:[224,220,93]},{index:.93,rgb:[218,241,142]},{index:1,rgb:[227,253,198]}]}},{}],131:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./colorScale"),rt=Ne("lerp");function createColormap(Ne){var Ge,Qe,nt,at,it,ot,dt,ht,Dt,Ot;if(Ne||(Ne={}),ht=(Ne.nshades||72)-1,dt=Ne.format||"hex",(ot=Ne.colormap)||(ot="jet"),"string"==typeof ot){if(ot=ot.toLowerCase(),!tt[ot])throw Error(ot+" not a supported colorscale");it=tt[ot]}else{if(!Array.isArray(ot))throw Error("unsupported colormap option",ot);it=ot.slice()}if(it.length>ht+1)throw new Error(ot+" map requires nshades to be at least size "+it.length);Dt=Array.isArray(Ne.alpha)?2!==Ne.alpha.length?[1,1]:Ne.alpha.slice():"number"==typeof Ne.alpha?[Ne.alpha,Ne.alpha]:[1,1],Ge=it.map((function(Ne){return Math.round(Ne.index*ht)})),Dt[0]=Math.min(Math.max(Dt[0],0),1),Dt[1]=Math.min(Math.max(Dt[1],0),1);var Rt=it.map((function(Ne,Ge){var Qe=it[Ge].index,tt=it[Ge].rgb.slice();return 4===tt.length&&tt[3]>=0&&tt[3]<=1||(tt[3]=Dt[0]+(Dt[1]-Dt[0])*Qe),tt})),Zt=[];for(Ot=0;Ot<Ge.length-1;++Ot){at=Ge[Ot+1]-Ge[Ot],Qe=Rt[Ot],nt=Rt[Ot+1];for(var er=0;er<at;er++){var dr=er/at;Zt.push([Math.round(rt(Qe[0],nt[0],dr)),Math.round(rt(Qe[1],nt[1],dr)),Math.round(rt(Qe[2],nt[2],dr)),rt(Qe[3],nt[3],dr)])}}return Zt.push(it[it.length-1].rgb.concat(Dt[1])),"hex"===dt?Zt=Zt.map(rgb2hex):"rgbaString"===dt?Zt=Zt.map(rgbaStr):"float"===dt&&(Zt=Zt.map(rgb2float)),Zt}function rgb2float(Ne){return[Ne[0]/255,Ne[1]/255,Ne[2]/255,Ne[3]]}function rgb2hex(Ne){for(var Ge,Qe="#",tt=0;tt<3;++tt)Qe+=("00"+(Ge=(Ge=Ne[tt]).toString(16))).substr(Ge.length);return Qe}function rgbaStr(Ne){return"rgba("+Ne.join(",")+")"}Ge.exports=createColormap},{"./colorScale":130,lerp:472}],132:[function(Ne,Ge,Qe){"use strict";Ge.exports=compareAngle;var tt=Ne("robust-orientation"),rt=Ne("signum"),nt=Ne("two-sum"),at=Ne("robust-product"),it=Ne("robust-sum");function testInterior(Ne,Ge,Qe){var tt=nt(Ne[0],-Ge[0]),rt=nt(Ne[1],-Ge[1]),ot=nt(Qe[0],-Ge[0]),dt=nt(Qe[1],-Ge[1]),ht=it(at(tt,ot),at(rt,dt));return ht[ht.length-1]>=0}function compareAngle(Ne,Ge,Qe,nt){var at=tt(Ge,Qe,nt);if(0===at){var it=rt(tt(Ne,Ge,Qe)),ot=rt(tt(Ne,Ge,nt));if(it===ot){if(0===it){var dt=testInterior(Ne,Ge,Qe);return dt===testInterior(Ne,Ge,nt)?0:dt?1:-1}return 0}return 0===ot?it>0||testInterior(Ne,Ge,nt)?-1:1:0===it?ot>0||testInterior(Ne,Ge,Qe)?1:-1:rt(ot-it)}var ht=tt(Ne,Ge,Qe);return ht>0?at>0&&tt(Ne,Ge,nt)>0?1:-1:ht<0?at>0||tt(Ne,Ge,nt)>0?1:-1:tt(Ne,Ge,nt)>0||testInterior(Ne,Ge,Qe)?1:-1}},{"robust-orientation":548,"robust-product":549,"robust-sum":553,signum:554,"two-sum":583}],133:[function(Ne,Ge,Qe){Ge.exports=compareCells;var tt=Math.min;function compareInt(Ne,Ge){return Ne-Ge}function compareCells(Ne,Ge){var Qe=Ne.length,rt=Ne.length-Ge.length;if(rt)return rt;switch(Qe){case 0:return 0;case 1:return Ne[0]-Ge[0];case 2:return Ne[0]+Ne[1]-Ge[0]-Ge[1]||tt(Ne[0],Ne[1])-tt(Ge[0],Ge[1]);case 3:var nt=Ne[0]+Ne[1],at=Ge[0]+Ge[1];if(rt=nt+Ne[2]-(at+Ge[2]))return rt;var it=tt(Ne[0],Ne[1]),ot=tt(Ge[0],Ge[1]);return tt(it,Ne[2])-tt(ot,Ge[2])||tt(it+Ne[2],nt)-tt(ot+Ge[2],at);case 4:var dt=Ne[0],ht=Ne[1],Dt=Ne[2],Ot=Ne[3],Rt=Ge[0],Zt=Ge[1],er=Ge[2],dr=Ge[3];return dt+ht+Dt+Ot-(Rt+Zt+er+dr)||tt(dt,ht,Dt,Ot)-tt(Rt,Zt,er,dr,Rt)||tt(dt+ht,dt+Dt,dt+Ot,ht+Dt,ht+Ot,Dt+Ot)-tt(Rt+Zt,Rt+er,Rt+dr,Zt+er,Zt+dr,er+dr)||tt(dt+ht+Dt,dt+ht+Ot,dt+Dt+Ot,ht+Dt+Ot)-tt(Rt+Zt+er,Rt+Zt+dr,Rt+er+dr,Zt+er+dr);default:for(var mr=Ne.slice().sort(compareInt),xr=Ge.slice().sort(compareInt),br=0;br<Qe;++br)if(rt=mr[br]-xr[br])return rt;return 0}}},{}],134:[function(Ne,Ge,Qe){"use strict";var tt=Ne("compare-cell"),rt=Ne("cell-orientation");function compareOrientedCells(Ne,Ge){return tt(Ne,Ge)||rt(Ne)-rt(Ge)}Ge.exports=compareOrientedCells},{"cell-orientation":117,"compare-cell":133}],135:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./lib/ch1d"),rt=Ne("./lib/ch2d"),nt=Ne("./lib/chnd");function convexHull(Ne){var Ge=Ne.length;if(0===Ge)return[];if(1===Ge)return[[0]];var Qe=Ne[0].length;return 0===Qe?[]:1===Qe?tt(Ne):2===Qe?rt(Ne):nt(Ne,Qe)}Ge.exports=convexHull},{"./lib/ch1d":136,"./lib/ch2d":137,"./lib/chnd":138}],136:[function(Ne,Ge,Qe){"use strict";function convexHull1d(Ne){for(var Ge=0,Qe=0,tt=1;tt<Ne.length;++tt)Ne[tt][0]<Ne[Ge][0]&&(Ge=tt),Ne[tt][0]>Ne[Qe][0]&&(Qe=tt);return Ge<Qe?[[Ge],[Qe]]:Ge>Qe?[[Qe],[Ge]]:[[Ge]]}Ge.exports=convexHull1d},{}],137:[function(Ne,Ge,Qe){"use strict";Ge.exports=convexHull2D;var tt=Ne("monotone-convex-hull-2d");function convexHull2D(Ne){var Ge=tt(Ne),Qe=Ge.length;if(Qe<=2)return[];for(var rt=new Array(Qe),nt=Ge[Qe-1],at=0;at<Qe;++at){var it=Ge[at];rt[at]=[nt,it],nt=it}return rt}},{"monotone-convex-hull-2d":482}],138:[function(Ne,Ge,Qe){"use strict";Ge.exports=convexHullnD;var tt=Ne("incremental-convex-hull"),rt=Ne("affine-hull");function permute(Ne,Ge){for(var Qe=Ne.length,tt=new Array(Qe),rt=0;rt<Ge.length;++rt)tt[rt]=Ne[Ge[rt]];var nt=Ge.length;for(rt=0;rt<Qe;++rt)Ge.indexOf(rt)<0&&(tt[nt++]=Ne[rt]);return tt}function invPermute(Ne,Ge){for(var Qe=Ne.length,tt=Ge.length,rt=0;rt<Qe;++rt)for(var nt=Ne[rt],at=0;at<nt.length;++at){var it=nt[at];if(it<tt)nt[at]=Ge[it];else{it-=tt;for(var ot=0;ot<tt;++ot)it>=Ge[ot]&&(it+=1);nt[at]=it}}return Ne}function convexHullnD(Ne,Ge){try{return tt(Ne,!0)}catch(at){var Qe=rt(Ne);if(Qe.length<=Ge)return[];var nt=permute(Ne,Qe);return invPermute(tt(nt,!0),Qe)}}},{"affine-hull":67,"incremental-convex-hull":459}],139:[function(Ne,Ge,Qe){Ge.exports={AFG:"afghan",ALA:"\\b\\wland",ALB:"albania",DZA:"algeria",ASM:"^(?=.*americ).*samoa",AND:"andorra",AGO:"angola",AIA:"anguill?a",ATA:"antarctica",ATG:"antigua",ARG:"argentin",ARM:"armenia",ABW:"^(?!.*bonaire).*\\baruba",AUS:"australia",AUT:"^(?!.*hungary).*austria|\\baustri.*\\bemp",AZE:"azerbaijan",BHS:"bahamas",BHR:"bahrain",BGD:"bangladesh|^(?=.*east).*paki?stan",BRB:"barbados",BLR:"belarus|byelo",BEL:"^(?!.*luxem).*belgium",BLZ:"belize|^(?=.*british).*honduras",BEN:"benin|dahome",BMU:"bermuda",BTN:"bhutan",BOL:"bolivia",BES:"^(?=.*bonaire).*eustatius|^(?=.*carib).*netherlands|\\bbes.?islands",BIH:"herzegovina|bosnia",BWA:"botswana|bechuana",BVT:"bouvet",BRA:"brazil",IOT:"british.?indian.?ocean",BRN:"brunei",BGR:"bulgaria",BFA:"burkina|\\bfaso|upper.?volta",BDI:"burundi",CPV:"verde",KHM:"cambodia|kampuchea|khmer",CMR:"cameroon",CAN:"canada",CYM:"cayman",CAF:"\\bcentral.african.republic",TCD:"\\bchad",CHL:"\\bchile",CHN:"^(?!.*\\bmac)(?!.*\\bhong)(?!.*\\btai)(?!.*\\brep).*china|^(?=.*peo)(?=.*rep).*china",CXR:"christmas",CCK:"\\bcocos|keeling",COL:"colombia",COM:"comoro",COG:"^(?!.*\\bdem)(?!.*\\bd[\\.]?r)(?!.*kinshasa)(?!.*zaire)(?!.*belg)(?!.*l.opoldville)(?!.*free).*\\bcongo",COK:"\\bcook",CRI:"costa.?rica",CIV:"ivoire|ivory",HRV:"croatia",CUB:"\\bcuba",CUW:"^(?!.*bonaire).*\\bcura(c|Ã§)ao",CYP:"cyprus",CSK:"czechoslovakia",CZE:"^(?=.*rep).*czech|czechia|bohemia",COD:"\\bdem.*congo|congo.*\\bdem|congo.*\\bd[\\.]?r|\\bd[\\.]?r.*congo|belgian.?congo|congo.?free.?state|kinshasa|zaire|l.opoldville|drc|droc|rdc",DNK:"denmark",DJI:"djibouti",DMA:"dominica(?!n)",DOM:"dominican.rep",ECU:"ecuador",EGY:"egypt",SLV:"el.?salvador",GNQ:"guine.*eq|eq.*guine|^(?=.*span).*guinea",ERI:"eritrea",EST:"estonia",ETH:"ethiopia|abyssinia",FLK:"falkland|malvinas",FRO:"faroe|faeroe",FJI:"fiji",FIN:"finland",FRA:"^(?!.*\\bdep)(?!.*martinique).*france|french.?republic|\\bgaul",GUF:"^(?=.*french).*guiana",PYF:"french.?polynesia|tahiti",ATF:"french.?southern",GAB:"gabon",GMB:"gambia",GEO:"^(?!.*south).*georgia",DDR:"german.?democratic.?republic|democratic.?republic.*germany|east.germany",DEU:"^(?!.*east).*germany|^(?=.*\\bfed.*\\brep).*german",GHA:"ghana|gold.?coast",GIB:"gibraltar",GRC:"greece|hellenic|hellas",GRL:"greenland",GRD:"grenada",GLP:"guadeloupe",GUM:"\\bguam",GTM:"guatemala",GGY:"guernsey",GIN:"^(?!.*eq)(?!.*span)(?!.*bissau)(?!.*portu)(?!.*new).*guinea",GNB:"bissau|^(?=.*portu).*guinea",GUY:"guyana|british.?guiana",HTI:"haiti",HMD:"heard.*mcdonald",VAT:"holy.?see|vatican|papal.?st",HND:"^(?!.*brit).*honduras",HKG:"hong.?kong",HUN:"^(?!.*austr).*hungary",ISL:"iceland",IND:"india(?!.*ocea)",IDN:"indonesia",IRN:"\\biran|persia",IRQ:"\\biraq|mesopotamia",IRL:"(^ireland)|(^republic.*ireland)",IMN:"^(?=.*isle).*\\bman",ISR:"israel",ITA:"italy",JAM:"jamaica",JPN:"japan",JEY:"jersey",JOR:"jordan",KAZ:"kazak",KEN:"kenya|british.?east.?africa|east.?africa.?prot",KIR:"kiribati",PRK:"^(?=.*democrat|people|north|d.*p.*.r).*\\bkorea|dprk|korea.*(d.*p.*r)",KWT:"kuwait",KGZ:"kyrgyz|kirghiz",LAO:"\\blaos?\\b",LVA:"latvia",LBN:"lebanon",LSO:"lesotho|basuto",LBR:"liberia",LBY:"libya",LIE:"liechtenstein",LTU:"lithuania",LUX:"^(?!.*belg).*luxem",MAC:"maca(o|u)",MDG:"madagascar|malagasy",MWI:"malawi|nyasa",MYS:"malaysia",MDV:"maldive",MLI:"\\bmali\\b",MLT:"\\bmalta",MHL:"marshall",MTQ:"martinique",MRT:"mauritania",MUS:"mauritius",MYT:"\\bmayotte",MEX:"\\bmexic",FSM:"fed.*micronesia|micronesia.*fed",MCO:"monaco",MNG:"mongolia",MNE:"^(?!.*serbia).*montenegro",MSR:"montserrat",MAR:"morocco|\\bmaroc",MOZ:"mozambique",MMR:"myanmar|burma",NAM:"namibia",NRU:"nauru",NPL:"nepal",NLD:"^(?!.*\\bant)(?!.*\\bcarib).*netherlands",ANT:"^(?=.*\\bant).*(nether|dutch)",NCL:"new.?caledonia",NZL:"new.?zealand",NIC:"nicaragua",NER:"\\bniger(?!ia)",NGA:"nigeria",NIU:"niue",NFK:"norfolk",MNP:"mariana",NOR:"norway",OMN:"\\boman|trucial",PAK:"^(?!.*east).*paki?stan",PLW:"palau",PSE:"palestin|\\bgaza|west.?bank",PAN:"panama",PNG:"papua|new.?guinea",PRY:"paraguay",PER:"peru",PHL:"philippines",PCN:"pitcairn",POL:"poland",PRT:"portugal",PRI:"puerto.?rico",QAT:"qatar",KOR:"^(?!.*d.*p.*r)(?!.*democrat)(?!.*people)(?!.*north).*\\bkorea(?!.*d.*p.*r)",MDA:"moldov|b(a|e)ssarabia",REU:"r(e|Ã©)union",ROU:"r(o|u|ou)mania",RUS:"\\brussia|soviet.?union|u\\.?s\\.?s\\.?r|socialist.?republics",RWA:"rwanda",BLM:"barth(e|Ã©)lemy",SHN:"helena",KNA:"kitts|\\bnevis",LCA:"\\blucia",MAF:"^(?=.*collectivity).*martin|^(?=.*france).*martin(?!ique)|^(?=.*french).*martin(?!ique)",SPM:"miquelon",VCT:"vincent",WSM:"^(?!.*amer).*samoa",SMR:"san.?marino",STP:"\\bs(a|Ã£)o.?tom(e|Ã©)",SAU:"\\bsa\\w*.?arabia",SEN:"senegal",SRB:"^(?!.*monte).*serbia",SYC:"seychell",SLE:"sierra",SGP:"singapore",SXM:"^(?!.*martin)(?!.*saba).*maarten",SVK:"^(?!.*cze).*slovak",SVN:"slovenia",SLB:"solomon",SOM:"somali",ZAF:"south.africa|s\\\\..?africa",SGS:"south.?georgia|sandwich",SSD:"\\bs\\w*.?sudan",ESP:"spain",LKA:"sri.?lanka|ceylon",SDN:"^(?!.*\\bs(?!u)).*sudan",SUR:"surinam|dutch.?guiana",SJM:"svalbard",SWZ:"swaziland",SWE:"sweden",CHE:"switz|swiss",SYR:"syria",TWN:"taiwan|taipei|formosa|^(?!.*peo)(?=.*rep).*china",TJK:"tajik",THA:"thailand|\\bsiam",MKD:"macedonia|fyrom",TLS:"^(?=.*leste).*timor|^(?=.*east).*timor",TGO:"togo",TKL:"tokelau",TON:"tonga",TTO:"trinidad|tobago",TUN:"tunisia",TUR:"turkey",TKM:"turkmen",TCA:"turks",TUV:"tuvalu",UGA:"uganda",UKR:"ukrain",ARE:"emirates|^u\\.?a\\.?e\\.?$|united.?arab.?em",GBR:"united.?kingdom|britain|^u\\.?k\\.?$",TZA:"tanzania",USA:"united.?states\\b(?!.*islands)|\\bu\\.?s\\.?a\\.?\\b|^\\s*u\\.?s\\.?\\b(?!.*islands)",UMI:"minor.?outlying.?is",URY:"uruguay",UZB:"uzbek",VUT:"vanuatu|new.?hebrides",VEN:"venezuela",VNM:"^(?!.*republic).*viet.?nam|^(?=.*socialist).*viet.?nam",VGB:"^(?=.*\\bu\\.?\\s?k).*virgin|^(?=.*brit).*virgin|^(?=.*kingdom).*virgin",VIR:"^(?=.*\\bu\\.?\\s?s).*virgin|^(?=.*states).*virgin",WLF:"futuna|wallis",ESH:"western.sahara",YEM:"^(?!.*arab)(?!.*north)(?!.*sana)(?!.*peo)(?!.*dem)(?!.*south)(?!.*aden)(?!.*\\bp\\.?d\\.?r).*yemen",YMD:"^(?=.*peo).*yemen|^(?!.*rep)(?=.*dem).*yemen|^(?=.*south).*yemen|^(?=.*aden).*yemen|^(?=.*\\bp\\.?d\\.?r).*yemen",YUG:"yugoslavia",ZMB:"zambia|northern.?rhodesia",EAZ:"zanzibar",ZWE:"zimbabwe|^(?!.*northern).*rhodesia"}},{}],140:[function(Ne,Ge,Qe){Ge.exports=["xx-small","x-small","small","medium","large","x-large","xx-large","larger","smaller"]},{}],141:[function(Ne,Ge,Qe){Ge.exports=["normal","condensed","semi-condensed","extra-condensed","ultra-condensed","expanded","semi-expanded","extra-expanded","ultra-expanded"]},{}],142:[function(Ne,Ge,Qe){Ge.exports=["normal","italic","oblique"]},{}],143:[function(Ne,Ge,Qe){Ge.exports=["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"]},{}],144:[function(Ne,Ge,Qe){"use strict";Ge.exports={parse:Ne("./parse"),stringify:Ne("./stringify")}},{"./parse":146,"./stringify":147}],145:[function(Ne,Ge,Qe){"use strict";var tt=Ne("css-font-size-keywords");Ge.exports={isSize:function(Ne){return/^[\d\.]/.test(Ne)||-1!==Ne.indexOf("/")||-1!==tt.indexOf(Ne)}}},{"css-font-size-keywords":140}],146:[function(Ne,Ge,Qe){"use strict";var tt=Ne("unquote"),rt=Ne("css-global-keywords"),nt=Ne("css-system-font-keywords"),at=Ne("css-font-weight-keywords"),it=Ne("css-font-style-keywords"),ot=Ne("css-font-stretch-keywords"),dt=Ne("string-split-by"),ht=Ne("./lib/util").isSize;Ge.exports=parseFont;var Dt=parseFont.cache={};function parseFont(Ne){if("string"!=typeof Ne)throw new Error("Font argument must be a string.");if(Dt[Ne])return Dt[Ne];if(""===Ne)throw new Error("Cannot parse an empty string.");if(-1!==nt.indexOf(Ne))return Dt[Ne]={system:Ne};for(var Ge,Qe={style:"normal",variant:"normal",weight:"normal",stretch:"normal",lineHeight:"normal",size:"1rem",family:["serif"]},Ot=dt(Ne,/\s+/);Ge=Ot.shift();){if(-1!==rt.indexOf(Ge))return["style","variant","weight","stretch"].forEach((function(Ne){Qe[Ne]=Ge})),Dt[Ne]=Qe;if(-1===it.indexOf(Ge))if("normal"!==Ge&&"small-caps"!==Ge)if(-1===ot.indexOf(Ge)){if(-1===at.indexOf(Ge)){if(ht(Ge)){var Rt=dt(Ge,"/");if(Qe.size=Rt[0],null!=Rt[1]?Qe.lineHeight=parseLineHeight(Rt[1]):"/"===Ot[0]&&(Ot.shift(),Qe.lineHeight=parseLineHeight(Ot.shift())),!Ot.length)throw new Error("Missing required font-family.");return Qe.family=dt(Ot.join(" "),/\s*,\s*/).map(tt),Dt[Ne]=Qe}throw new Error("Unknown or unsupported font token: "+Ge)}Qe.weight=Ge}else Qe.stretch=Ge;else Qe.variant=Ge;else Qe.style=Ge}throw new Error("Missing required font-size.")}function parseLineHeight(Ne){var Ge=parseFloat(Ne);return Ge.toString()===Ne?Ge:Ne}},{"./lib/util":145,"css-font-stretch-keywords":141,"css-font-style-keywords":142,"css-font-weight-keywords":143,"css-global-keywords":148,"css-system-font-keywords":149,"string-split-by":568,unquote:598}],147:[function(Ne,Ge,Qe){"use strict";var tt=Ne("pick-by-alias"),rt=Ne("./lib/util").isSize,nt=a2o(Ne("css-global-keywords")),at=a2o(Ne("css-system-font-keywords")),it=a2o(Ne("css-font-weight-keywords")),ot=a2o(Ne("css-font-style-keywords")),dt=a2o(Ne("css-font-stretch-keywords")),ht={normal:1,"small-caps":1},Dt={serif:1,"sans-serif":1,monospace:1,cursive:1,fantasy:1,"system-ui":1},Ot={style:"normal",variant:"normal",weight:"normal",stretch:"normal",size:"1rem",lineHeight:"normal",family:"serif"};function verify(Ne,Ge){if(Ne&&!Ge[Ne]&&!nt[Ne])throw Error("Unknown keyword `"+Ne+"`");return Ne}function a2o(Ne){for(var Ge={},Qe=0;Qe<Ne.length;Qe++)Ge[Ne[Qe]]=1;return Ge}Ge.exports=function(Ne){if((Ne=tt(Ne,{style:"style fontstyle fontStyle font-style slope distinction",variant:"variant font-variant fontVariant fontvariant var capitalization",weight:"weight w font-weight fontWeight fontweight",stretch:"stretch font-stretch fontStretch fontstretch width",size:"size s font-size fontSize fontsize height em emSize",lineHeight:"lh line-height lineHeight lineheight leading",family:"font family fontFamily font-family fontfamily type typeface face",system:"system reserved default global"})).system)return Ne.system&&verify(Ne.system,at),Ne.system;if(verify(Ne.style,ot),verify(Ne.variant,ht),verify(Ne.weight,it),verify(Ne.stretch,dt),null==Ne.size&&(Ne.size=Ot.size),"number"==typeof Ne.size&&(Ne.size+="px"),!rt)throw Error("Bad size value `"+Ne.size+"`");Ne.family||(Ne.family=Ot.family),Array.isArray(Ne.family)&&(Ne.family.length||(Ne.family=[Ot.family]),Ne.family=Ne.family.map((function(Ne){return Dt[Ne]?Ne:'"'+Ne+'"'})).join(", "));var Ge=[];return Ge.push(Ne.style),Ne.variant!==Ne.style&&Ge.push(Ne.variant),Ne.weight!==Ne.variant&&Ne.weight!==Ne.style&&Ge.push(Ne.weight),Ne.stretch!==Ne.weight&&Ne.stretch!==Ne.variant&&Ne.stretch!==Ne.style&&Ge.push(Ne.stretch),Ge.push(Ne.size+(null==Ne.lineHeight||"normal"===Ne.lineHeight||Ne.lineHeight+""=="1"?"":"/"+Ne.lineHeight)),Ge.push(Ne.family),Ge.filter(Boolean).join(" ")}},{"./lib/util":145,"css-font-stretch-keywords":141,"css-font-style-keywords":142,"css-font-weight-keywords":143,"css-global-keywords":148,"css-system-font-keywords":149,"pick-by-alias":511}],148:[function(Ne,Ge,Qe){Ge.exports=["inherit","initial","unset"]},{}],149:[function(Ne,Ge,Qe){Ge.exports=["caption","icon","menu","message-box","small-caption","status-bar"]},{}],150:[function(Ne,Ge,Qe){"use strict";function dcubicHermite(Ne,Ge,Qe,tt,rt,nt){var at=6*rt*rt-6*rt,it=3*rt*rt-4*rt+1,ot=-6*rt*rt+6*rt,dt=3*rt*rt-2*rt;if(Ne.length){nt||(nt=new Array(Ne.length));for(var ht=Ne.length-1;ht>=0;--ht)nt[ht]=at*Ne[ht]+it*Ge[ht]+ot*Qe[ht]+dt*tt[ht];return nt}return at*Ne+it*Ge+ot*Qe[ht]+dt*tt}function cubicHermite(Ne,Ge,Qe,tt,rt,nt){var at=rt-1,it=rt*rt,ot=at*at,dt=(1+2*rt)*ot,ht=rt*ot,Dt=it*(3-2*rt),Ot=it*at;if(Ne.length){nt||(nt=new Array(Ne.length));for(var Rt=Ne.length-1;Rt>=0;--Rt)nt[Rt]=dt*Ne[Rt]+ht*Ge[Rt]+Dt*Qe[Rt]+Ot*tt[Rt];return nt}return dt*Ne+ht*Ge+Dt*Qe+Ot*tt}Ge.exports=cubicHermite,Ge.exports.derivative=dcubicHermite},{}],151:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./lib/thunk.js");function Procedure(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}function compileCwise(Ne){var Ge=new Procedure;Ge.pre=Ne.pre,Ge.body=Ne.body,Ge.post=Ne.post;var Qe=Ne.args.slice(0);Ge.argTypes=Qe;for(var rt=0;rt<Qe.length;++rt){var nt=Qe[rt];if("array"===nt||"object"==typeof nt&&nt.blockIndices){if(Ge.argTypes[rt]="array",Ge.arrayArgs.push(rt),Ge.arrayBlockIndices.push(nt.blockIndices?nt.blockIndices:0),Ge.shimArgs.push("array"+rt),rt<Ge.pre.args.length&&Ge.pre.args[rt].count>0)throw new Error("cwise: pre() block may not reference array args");if(rt<Ge.post.args.length&&Ge.post.args[rt].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===nt)Ge.scalarArgs.push(rt),Ge.shimArgs.push("scalar"+rt);else if("index"===nt){if(Ge.indexArgs.push(rt),rt<Ge.pre.args.length&&Ge.pre.args[rt].count>0)throw new Error("cwise: pre() block may not reference array index");if(rt<Ge.body.args.length&&Ge.body.args[rt].lvalue)throw new Error("cwise: body() block may not write to array index");if(rt<Ge.post.args.length&&Ge.post.args[rt].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===nt){if(Ge.shapeArgs.push(rt),rt<Ge.pre.args.length&&Ge.pre.args[rt].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(rt<Ge.body.args.length&&Ge.body.args[rt].lvalue)throw new Error("cwise: body() block may not write to array shape");if(rt<Ge.post.args.length&&Ge.post.args[rt].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=typeof nt||!nt.offset)throw new Error("cwise: Unknown argument type "+Qe[rt]);Ge.argTypes[rt]="offset",Ge.offsetArgs.push({array:nt.array,offset:nt.offset}),Ge.offsetArgIndex.push(rt)}}if(Ge.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(Ge.pre.args.length>Qe.length)throw new Error("cwise: Too many arguments in pre() block");if(Ge.body.args.length>Qe.length)throw new Error("cwise: Too many arguments in body() block");if(Ge.post.args.length>Qe.length)throw new Error("cwise: Too many arguments in post() block");return Ge.debug=!!Ne.printCode||!!Ne.debug,Ge.funcName=Ne.funcName||"cwise",Ge.blockSize=Ne.blockSize||64,tt(Ge)}Ge.exports=compileCwise},{"./lib/thunk.js":153}],152:[function(Ne,Ge,Qe){"use strict";var tt=Ne("uniq");function innerFill(Ne,Ge,Qe){var tt,rt,nt=Ne.length,at=Ge.arrayArgs.length,it=Ge.indexArgs.length>0,ot=[],dt=[],ht=0,Dt=0;for(tt=0;tt<nt;++tt)dt.push(["i",tt,"=0"].join(""));for(rt=0;rt<at;++rt)for(tt=0;tt<nt;++tt)Dt=ht,ht=Ne[tt],0===tt?dt.push(["d",rt,"s",tt,"=t",rt,"p",ht].join("")):dt.push(["d",rt,"s",tt,"=(t",rt,"p",ht,"-s",Dt,"*t",rt,"p",Dt,")"].join(""));for(dt.length>0&&ot.push("var "+dt.join(",")),tt=nt-1;tt>=0;--tt)ht=Ne[tt],ot.push(["for(i",tt,"=0;i",tt,"<s",ht,";++i",tt,"){"].join(""));for(ot.push(Qe),tt=0;tt<nt;++tt){for(Dt=ht,ht=Ne[tt],rt=0;rt<at;++rt)ot.push(["p",rt,"+=d",rt,"s",tt].join(""));it&&(tt>0&&ot.push(["index[",Dt,"]-=s",Dt].join("")),ot.push(["++index[",ht,"]"].join(""))),ot.push("}")}return ot.join("\n")}function outerFill(Ne,Ge,Qe,tt){for(var rt=Ge.length,nt=Qe.arrayArgs.length,at=Qe.blockSize,it=Qe.indexArgs.length>0,ot=[],dt=0;dt<nt;++dt)ot.push(["var offset",dt,"=p",dt].join(""));for(dt=Ne;dt<rt;++dt)ot.push(["for(var j"+dt+"=SS[",Ge[dt],"]|0;j",dt,">0;){"].join("")),ot.push(["if(j",dt,"<",at,"){"].join("")),ot.push(["s",Ge[dt],"=j",dt].join("")),ot.push(["j",dt,"=0"].join("")),ot.push(["}else{s",Ge[dt],"=",at].join("")),ot.push(["j",dt,"-=",at,"}"].join("")),it&&ot.push(["index[",Ge[dt],"]=j",dt].join(""));for(dt=0;dt<nt;++dt){for(var ht=["offset"+dt],Dt=Ne;Dt<rt;++Dt)ht.push(["j",Dt,"*t",dt,"p",Ge[Dt]].join(""));ot.push(["p",dt,"=(",ht.join("+"),")"].join(""))}for(ot.push(innerFill(Ge,Qe,tt)),dt=Ne;dt<rt;++dt)ot.push("}");return ot.join("\n")}function countMatches(Ne){for(var Ge=0,Qe=Ne[0].length;Ge<Qe;){for(var tt=1;tt<Ne.length;++tt)if(Ne[tt][Ge]!==Ne[0][Ge])return Ge;++Ge}return Ge}function processBlock(Ne,Ge,Qe){for(var tt=Ne.body,rt=[],nt=[],at=0;at<Ne.args.length;++at){var it=Ne.args[at];if(!(it.count<=0)){var ot=new RegExp(it.name,"g"),dt="",ht=Ge.arrayArgs.indexOf(at);switch(Ge.argTypes[at]){case"offset":var Dt=Ge.offsetArgIndex.indexOf(at);ht=Ge.offsetArgs[Dt].array,dt="+q"+Dt;case"array":dt="p"+ht+dt;var Ot="l"+at,Rt="a"+ht;if(0===Ge.arrayBlockIndices[ht])1===it.count?"generic"===Qe[ht]?it.lvalue?(rt.push(["var ",Ot,"=",Rt,".get(",dt,")"].join("")),tt=tt.replace(ot,Ot),nt.push([Rt,".set(",dt,",",Ot,")"].join(""))):tt=tt.replace(ot,[Rt,".get(",dt,")"].join("")):tt=tt.replace(ot,[Rt,"[",dt,"]"].join("")):"generic"===Qe[ht]?(rt.push(["var ",Ot,"=",Rt,".get(",dt,")"].join("")),tt=tt.replace(ot,Ot),it.lvalue&&nt.push([Rt,".set(",dt,",",Ot,")"].join(""))):(rt.push(["var ",Ot,"=",Rt,"[",dt,"]"].join("")),tt=tt.replace(ot,Ot),it.lvalue&&nt.push([Rt,"[",dt,"]=",Ot].join("")));else{for(var Zt=[it.name],er=[dt],dr=0;dr<Math.abs(Ge.arrayBlockIndices[ht]);dr++)Zt.push("\\s*\\[([^\\]]+)\\]"),er.push("$"+(dr+1)+"*t"+ht+"b"+dr);if(ot=new RegExp(Zt.join(""),"g"),dt=er.join("+"),"generic"===Qe[ht])throw new Error("cwise: Generic arrays not supported in combination with blocks!");tt=tt.replace(ot,[Rt,"[",dt,"]"].join(""))}break;case"scalar":tt=tt.replace(ot,"Y"+Ge.scalarArgs.indexOf(at));break;case"index":tt=tt.replace(ot,"index");break;case"shape":tt=tt.replace(ot,"shape")}}}return[rt.join("\n"),tt,nt.join("\n")].join("\n").trim()}function typeSummary(Ne){for(var Ge=new Array(Ne.length),Qe=!0,tt=0;tt<Ne.length;++tt){var rt=Ne[tt],nt=rt.match(/\d+/);nt=nt?nt[0]:"",0===rt.charAt(0)?Ge[tt]="u"+rt.charAt(1)+nt:Ge[tt]=rt.charAt(0)+nt,tt>0&&(Qe=Qe&&Ge[tt]===Ge[tt-1])}return Qe?Ge[0]:Ge.join("")}function generateCWiseOp(Ne,Ge){for(var Qe=Ge[1].length-Math.abs(Ne.arrayBlockIndices[0])|0,rt=new Array(Ne.arrayArgs.length),nt=new Array(Ne.arrayArgs.length),at=0;at<Ne.arrayArgs.length;++at)nt[at]=Ge[2*at],rt[at]=Ge[2*at+1];var it=[],ot=[],dt=[],ht=[],Dt=[];for(at=0;at<Ne.arrayArgs.length;++at){Ne.arrayBlockIndices[at]<0?(dt.push(0),ht.push(Qe),it.push(Qe),ot.push(Qe+Ne.arrayBlockIndices[at])):(dt.push(Ne.arrayBlockIndices[at]),ht.push(Ne.arrayBlockIndices[at]+Qe),it.push(0),ot.push(Ne.arrayBlockIndices[at]));for(var Ot=[],Rt=0;Rt<rt[at].length;Rt++)dt[at]<=rt[at][Rt]&&rt[at][Rt]<ht[at]&&Ot.push(rt[at][Rt]-dt[at]);Dt.push(Ot)}var Zt=["SS"],er=["'use strict'"],dr=[];for(Rt=0;Rt<Qe;++Rt)dr.push(["s",Rt,"=SS[",Rt,"]"].join(""));for(at=0;at<Ne.arrayArgs.length;++at){for(Zt.push("a"+at),Zt.push("t"+at),Zt.push("p"+at),Rt=0;Rt<Qe;++Rt)dr.push(["t",at,"p",Rt,"=t",at,"[",dt[at]+Rt,"]"].join(""));for(Rt=0;Rt<Math.abs(Ne.arrayBlockIndices[at]);++Rt)dr.push(["t",at,"b",Rt,"=t",at,"[",it[at]+Rt,"]"].join(""))}for(at=0;at<Ne.scalarArgs.length;++at)Zt.push("Y"+at);if(Ne.shapeArgs.length>0&&dr.push("shape=SS.slice(0)"),Ne.indexArgs.length>0){var mr=new Array(Qe);for(at=0;at<Qe;++at)mr[at]="0";dr.push(["index=[",mr.join(","),"]"].join(""))}for(at=0;at<Ne.offsetArgs.length;++at){var xr=Ne.offsetArgs[at],br=[];for(Rt=0;Rt<xr.offset.length;++Rt)0!==xr.offset[Rt]&&(1===xr.offset[Rt]?br.push(["t",xr.array,"p",Rt].join("")):br.push([xr.offset[Rt],"*t",xr.array,"p",Rt].join("")));0===br.length?dr.push("q"+at+"=0"):dr.push(["q",at,"=",br.join("+")].join(""))}var Ar=tt([].concat(Ne.pre.thisVars).concat(Ne.body.thisVars).concat(Ne.post.thisVars));for((dr=dr.concat(Ar)).length>0&&er.push("var "+dr.join(",")),at=0;at<Ne.arrayArgs.length;++at)er.push("p"+at+"|=0");Ne.pre.body.length>3&&er.push(processBlock(Ne.pre,Ne,nt));var en=processBlock(Ne.body,Ne,nt),mn=countMatches(Dt);mn<Qe?er.push(outerFill(mn,Dt[0],Ne,en)):er.push(innerFill(Dt[0],Ne,en)),Ne.post.body.length>3&&er.push(processBlock(Ne.post,Ne,nt)),Ne.debug&&console.log("-----Generated cwise routine for ",Ge,":\n"+er.join("\n")+"\n----------");var xn=[Ne.funcName||"unnamed","_cwise_loop_",rt[0].join("s"),"m",mn,typeSummary(nt)].join("");return new Function(["function ",xn,"(",Zt.join(","),"){",er.join("\n"),"} return ",xn].join(""))()}Ge.exports=generateCWiseOp},{uniq:597}],153:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./compile.js");function createThunk(Ne){var Ge=["'use strict'","var CACHED={}"],Qe=[],rt=Ne.funcName+"_cwise_thunk";Ge.push(["return function ",rt,"(",Ne.shimArgs.join(","),"){"].join(""));for(var nt=[],at=[],it=[["array",Ne.arrayArgs[0],".shape.slice(",Math.max(0,Ne.arrayBlockIndices[0]),Ne.arrayBlockIndices[0]<0?","+Ne.arrayBlockIndices[0]+")":")"].join("")],ot=[],dt=[],ht=0;ht<Ne.arrayArgs.length;++ht){var Dt=Ne.arrayArgs[ht];Qe.push(["t",Dt,"=array",Dt,".dtype,","r",Dt,"=array",Dt,".order"].join("")),nt.push("t"+Dt),nt.push("r"+Dt),at.push("t"+Dt),at.push("r"+Dt+".join()"),it.push("array"+Dt+".data"),it.push("array"+Dt+".stride"),it.push("array"+Dt+".offset|0"),ht>0&&(ot.push("array"+Ne.arrayArgs[0]+".shape.length===array"+Dt+".shape.length+"+(Math.abs(Ne.arrayBlockIndices[0])-Math.abs(Ne.arrayBlockIndices[ht]))),dt.push("array"+Ne.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,Ne.arrayBlockIndices[0])+"]===array"+Dt+".shape[shapeIndex+"+Math.max(0,Ne.arrayBlockIndices[ht])+"]"))}for(Ne.arrayArgs.length>1&&(Ge.push("if (!("+ot.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),Ge.push("for(var shapeIndex=array"+Ne.arrayArgs[0]+".shape.length-"+Math.abs(Ne.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {"),Ge.push("if (!("+dt.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),Ge.push("}")),ht=0;ht<Ne.scalarArgs.length;++ht)it.push("scalar"+Ne.scalarArgs[ht]);return Qe.push(["type=[",at.join(","),"].join()"].join("")),Qe.push("proc=CACHED[type]"),Ge.push("var "+Qe.join(",")),Ge.push(["if(!proc){","CACHED[type]=proc=compile([",nt.join(","),"])}","return proc(",it.join(","),")}"].join("")),Ne.debug&&console.log("-----Generated thunk:\n"+Ge.join("\n")+"\n----------"),new Function("compile",Ge.join("\n"))(tt.bind(void 0,Ne))}Ge.exports=createThunk},{"./compile.js":152}],154:[function(Ne,Ge,Qe){"use strict";var tt,rt=Ne("type/value/is"),nt=Ne("type/value/ensure"),at=Ne("type/plain-function/ensure"),it=Ne("es5-ext/object/copy"),ot=Ne("es5-ext/object/normalize-options"),dt=Ne("es5-ext/object/map"),ht=Function.prototype.bind,Dt=Object.defineProperty,Ot=Object.prototype.hasOwnProperty;tt=function(Ne,Ge,Qe){var tt,rt=nt(Ge)&&at(Ge.value);return delete(tt=it(Ge)).writable,delete tt.value,tt.get=function(){return!Qe.overwriteDefinition&&Ot.call(this,Ne)?rt:(Ge.value=ht.call(rt,Qe.resolveContext?Qe.resolveContext(this):this),Dt(this,Ne,Ge),this[Ne])},tt},Ge.exports=function(Ne){var Ge=ot(arguments[1]);return rt(Ge.resolveContext)&&at(Ge.resolveContext),dt(Ne,(function(Ne,Qe){return tt(Qe,Ne,Ge)}))}},{"es5-ext/object/copy":196,"es5-ext/object/map":204,"es5-ext/object/normalize-options":205,"type/plain-function/ensure":589,"type/value/ensure":593,"type/value/is":594}],155:[function(Ne,Ge,Qe){"use strict";var tt=Ne("type/value/is"),rt=Ne("type/plain-function/is"),nt=Ne("es5-ext/object/assign"),at=Ne("es5-ext/object/normalize-options"),it=Ne("es5-ext/string/#/contains"),ot=Ge.exports=function(Ne,Ge){var Qe,rt,ot,dt,ht;return arguments.length<2||"string"!=typeof Ne?(dt=Ge,Ge=Ne,Ne=null):dt=arguments[2],tt(Ne)?(Qe=it.call(Ne,"c"),rt=it.call(Ne,"e"),ot=it.call(Ne,"w")):(Qe=ot=!0,rt=!1),ht={value:Ge,configurable:Qe,enumerable:rt,writable:ot},dt?nt(at(dt),ht):ht};ot.gs=function(Ne,Ge,Qe){var ot,dt,ht,Dt;return"string"!=typeof Ne?(ht=Qe,Qe=Ge,Ge=Ne,Ne=null):ht=arguments[3],tt(Ge)?rt(Ge)?tt(Qe)?rt(Qe)||(ht=Qe,Qe=void 0):Qe=void 0:(ht=Ge,Ge=Qe=void 0):Ge=void 0,tt(Ne)?(ot=it.call(Ne,"c"),dt=it.call(Ne,"e")):(ot=!0,dt=!1),Dt={get:Ge,set:Qe,configurable:ot,enumerable:dt},ht?nt(at(ht),Dt):Dt}},{"es5-ext/object/assign":193,"es5-ext/object/normalize-options":205,"es5-ext/string/#/contains":212,"type/plain-function/is":590,"type/value/is":594}],156:[function(Ne,Ge,Qe){var rt,nt;rt=this,nt=function(Ne){"use strict";function ascending(Ne,Ge){return Ne<Ge?-1:Ne>Ge?1:Ne>=Ge?0:NaN}function bisector(Ne){return 1===Ne.length&&(Ne=ascendingComparator(Ne)),{left:function(Ge,Qe,tt,rt){for(null==tt&&(tt=0),null==rt&&(rt=Ge.length);tt<rt;){var nt=tt+rt>>>1;Ne(Ge[nt],Qe)<0?tt=nt+1:rt=nt}return tt},right:function(Ge,Qe,tt,rt){for(null==tt&&(tt=0),null==rt&&(rt=Ge.length);tt<rt;){var nt=tt+rt>>>1;Ne(Ge[nt],Qe)>0?rt=nt:tt=nt+1}return tt}}}function ascendingComparator(Ne){return function(Ge,Qe){return ascending(Ne(Ge),Qe)}}var Ge=bisector(ascending),Qe=Ge.right,tt=Ge.left;function pairs(Ne,Ge){null==Ge&&(Ge=pair);for(var Qe=0,tt=Ne.length-1,rt=Ne[0],nt=new Array(tt<0?0:tt);Qe<tt;)nt[Qe]=Ge(rt,rt=Ne[++Qe]);return nt}function pair(Ne,Ge){return[Ne,Ge]}function cross(Ne,Ge,Qe){var tt,rt,nt,at,it=Ne.length,ot=Ge.length,dt=new Array(it*ot);for(null==Qe&&(Qe=pair),tt=nt=0;tt<it;++tt)for(at=Ne[tt],rt=0;rt<ot;++rt,++nt)dt[nt]=Qe(at,Ge[rt]);return dt}function descending(Ne,Ge){return Ge<Ne?-1:Ge>Ne?1:Ge>=Ne?0:NaN}function number(Ne){return null===Ne?NaN:+Ne}function variance(Ne,Ge){var Qe,tt,rt=Ne.length,nt=0,at=-1,it=0,ot=0;if(null==Ge)for(;++at<rt;)isNaN(Qe=number(Ne[at]))||(ot+=(tt=Qe-it)*(Qe-(it+=tt/++nt)));else for(;++at<rt;)isNaN(Qe=number(Ge(Ne[at],at,Ne)))||(ot+=(tt=Qe-it)*(Qe-(it+=tt/++nt)));if(nt>1)return ot/(nt-1)}function deviation(Ne,Ge){var Qe=variance(Ne,Ge);return Qe?Math.sqrt(Qe):Qe}function extent(Ne,Ge){var Qe,tt,rt,nt=Ne.length,at=-1;if(null==Ge){for(;++at<nt;)if(null!=(Qe=Ne[at])&&Qe>=Qe)for(tt=rt=Qe;++at<nt;)null!=(Qe=Ne[at])&&(tt>Qe&&(tt=Qe),rt<Qe&&(rt=Qe))}else for(;++at<nt;)if(null!=(Qe=Ge(Ne[at],at,Ne))&&Qe>=Qe)for(tt=rt=Qe;++at<nt;)null!=(Qe=Ge(Ne[at],at,Ne))&&(tt>Qe&&(tt=Qe),rt<Qe&&(rt=Qe));return[tt,rt]}var rt=Array.prototype,nt=rt.slice,at=rt.map;function constant(Ne){return function(){return Ne}}function identity(Ne){return Ne}function range(Ne,Ge,Qe){Ne=+Ne,Ge=+Ge,Qe=(rt=arguments.length)<2?(Ge=Ne,Ne=0,1):rt<3?1:+Qe;for(var tt=-1,rt=0|Math.max(0,Math.ceil((Ge-Ne)/Qe)),nt=new Array(rt);++tt<rt;)nt[tt]=Ne+tt*Qe;return nt}var it=Math.sqrt(50),ot=Math.sqrt(10),dt=Math.sqrt(2);function ticks(Ne,Ge,Qe){var tt,rt,nt,at,it=-1;if(Qe=+Qe,(Ne=+Ne)==(Ge=+Ge)&&Qe>0)return[Ne];if((tt=Ge<Ne)&&(rt=Ne,Ne=Ge,Ge=rt),0===(at=tickIncrement(Ne,Ge,Qe))||!isFinite(at))return[];if(at>0)for(Ne=Math.ceil(Ne/at),Ge=Math.floor(Ge/at),nt=new Array(rt=Math.ceil(Ge-Ne+1));++it<rt;)nt[it]=(Ne+it)*at;else for(Ne=Math.floor(Ne*at),Ge=Math.ceil(Ge*at),nt=new Array(rt=Math.ceil(Ne-Ge+1));++it<rt;)nt[it]=(Ne-it)/at;return tt&&nt.reverse(),nt}function tickIncrement(Ne,Ge,Qe){var tt=(Ge-Ne)/Math.max(0,Qe),rt=Math.floor(Math.log(tt)/Math.LN10),nt=tt/Math.pow(10,rt);return rt>=0?(nt>=it?10:nt>=ot?5:nt>=dt?2:1)*Math.pow(10,rt):-Math.pow(10,-rt)/(nt>=it?10:nt>=ot?5:nt>=dt?2:1)}function tickStep(Ne,Ge,Qe){var tt=Math.abs(Ge-Ne)/Math.max(0,Qe),rt=Math.pow(10,Math.floor(Math.log(tt)/Math.LN10)),nt=tt/rt;return nt>=it?rt*=10:nt>=ot?rt*=5:nt>=dt&&(rt*=2),Ge<Ne?-rt:rt}function sturges(Ne){return Math.ceil(Math.log(Ne.length)/Math.LN2)+1}function histogram(){var Ne=identity,Ge=extent,tt=sturges;function histogram(rt){var nt,at,it=rt.length,ot=new Array(it);for(nt=0;nt<it;++nt)ot[nt]=Ne(rt[nt],nt,rt);var dt=Ge(ot),ht=dt[0],Dt=dt[1],Ot=tt(ot,ht,Dt);Array.isArray(Ot)||(Ot=tickStep(ht,Dt,Ot),Ot=range(Math.ceil(ht/Ot)*Ot,Dt,Ot));for(var Rt=Ot.length;Ot[0]<=ht;)Ot.shift(),--Rt;for(;Ot[Rt-1]>Dt;)Ot.pop(),--Rt;var Zt,er=new Array(Rt+1);for(nt=0;nt<=Rt;++nt)(Zt=er[nt]=[]).x0=nt>0?Ot[nt-1]:ht,Zt.x1=nt<Rt?Ot[nt]:Dt;for(nt=0;nt<it;++nt)ht<=(at=ot[nt])&&at<=Dt&&er[Qe(Ot,at,0,Rt)].push(rt[nt]);return er}return histogram.value=function(Ge){return arguments.length?(Ne="function"==typeof Ge?Ge:constant(Ge),histogram):Ne},histogram.domain=function(Ne){return arguments.length?(Ge="function"==typeof Ne?Ne:constant([Ne[0],Ne[1]]),histogram):Ge},histogram.thresholds=function(Ne){return arguments.length?(tt="function"==typeof Ne?Ne:Array.isArray(Ne)?constant(nt.call(Ne)):constant(Ne),histogram):tt},histogram}function quantile(Ne,Ge,Qe){if(null==Qe&&(Qe=number),tt=Ne.length){if((Ge=+Ge)<=0||tt<2)return+Qe(Ne[0],0,Ne);if(Ge>=1)return+Qe(Ne[tt-1],tt-1,Ne);var tt,rt=(tt-1)*Ge,nt=Math.floor(rt),at=+Qe(Ne[nt],nt,Ne);return at+(+Qe(Ne[nt+1],nt+1,Ne)-at)*(rt-nt)}}function freedmanDiaconis(Ne,Ge,Qe){return Ne=at.call(Ne,number).sort(ascending),Math.ceil((Qe-Ge)/(2*(quantile(Ne,.75)-quantile(Ne,.25))*Math.pow(Ne.length,-1/3)))}function scott(Ne,Ge,Qe){return Math.ceil((Qe-Ge)/(3.5*deviation(Ne)*Math.pow(Ne.length,-1/3)))}function max(Ne,Ge){var Qe,tt,rt=Ne.length,nt=-1;if(null==Ge){for(;++nt<rt;)if(null!=(Qe=Ne[nt])&&Qe>=Qe)for(tt=Qe;++nt<rt;)null!=(Qe=Ne[nt])&&Qe>tt&&(tt=Qe)}else for(;++nt<rt;)if(null!=(Qe=Ge(Ne[nt],nt,Ne))&&Qe>=Qe)for(tt=Qe;++nt<rt;)null!=(Qe=Ge(Ne[nt],nt,Ne))&&Qe>tt&&(tt=Qe);return tt}function mean(Ne,Ge){var Qe,tt=Ne.length,rt=tt,nt=-1,at=0;if(null==Ge)for(;++nt<tt;)isNaN(Qe=number(Ne[nt]))?--rt:at+=Qe;else for(;++nt<tt;)isNaN(Qe=number(Ge(Ne[nt],nt,Ne)))?--rt:at+=Qe;if(rt)return at/rt}function median(Ne,Ge){var Qe,tt=Ne.length,rt=-1,nt=[];if(null==Ge)for(;++rt<tt;)isNaN(Qe=number(Ne[rt]))||nt.push(Qe);else for(;++rt<tt;)isNaN(Qe=number(Ge(Ne[rt],rt,Ne)))||nt.push(Qe);return quantile(nt.sort(ascending),.5)}function merge(Ne){for(var Ge,Qe,tt,rt=Ne.length,nt=-1,at=0;++nt<rt;)at+=Ne[nt].length;for(Qe=new Array(at);--rt>=0;)for(Ge=(tt=Ne[rt]).length;--Ge>=0;)Qe[--at]=tt[Ge];return Qe}function min(Ne,Ge){var Qe,tt,rt=Ne.length,nt=-1;if(null==Ge){for(;++nt<rt;)if(null!=(Qe=Ne[nt])&&Qe>=Qe)for(tt=Qe;++nt<rt;)null!=(Qe=Ne[nt])&&tt>Qe&&(tt=Qe)}else for(;++nt<rt;)if(null!=(Qe=Ge(Ne[nt],nt,Ne))&&Qe>=Qe)for(tt=Qe;++nt<rt;)null!=(Qe=Ge(Ne[nt],nt,Ne))&&tt>Qe&&(tt=Qe);return tt}function permute(Ne,Ge){for(var Qe=Ge.length,tt=new Array(Qe);Qe--;)tt[Qe]=Ne[Ge[Qe]];return tt}function scan(Ne,Ge){if(Qe=Ne.length){var Qe,tt,rt=0,nt=0,at=Ne[nt];for(null==Ge&&(Ge=ascending);++rt<Qe;)(Ge(tt=Ne[rt],at)<0||0!==Ge(at,at))&&(at=tt,nt=rt);return 0===Ge(at,at)?nt:void 0}}function shuffle(Ne,Ge,Qe){for(var tt,rt,nt=(null==Qe?Ne.length:Qe)-(Ge=null==Ge?0:+Ge);nt;)rt=Math.random()*nt--|0,tt=Ne[nt+Ge],Ne[nt+Ge]=Ne[rt+Ge],Ne[rt+Ge]=tt;return Ne}function sum(Ne,Ge){var Qe,tt=Ne.length,rt=-1,nt=0;if(null==Ge)for(;++rt<tt;)(Qe=+Ne[rt])&&(nt+=Qe);else for(;++rt<tt;)(Qe=+Ge(Ne[rt],rt,Ne))&&(nt+=Qe);return nt}function transpose(Ne){if(!(rt=Ne.length))return[];for(var Ge=-1,Qe=min(Ne,length),tt=new Array(Qe);++Ge<Qe;)for(var rt,nt=-1,at=tt[Ge]=new Array(rt);++nt<rt;)at[nt]=Ne[nt][Ge];return tt}function length(Ne){return Ne.length}function zip(){return transpose(arguments)}Ne.bisect=Qe,Ne.bisectRight=Qe,Ne.bisectLeft=tt,Ne.ascending=ascending,Ne.bisector=bisector,Ne.cross=cross,Ne.descending=descending,Ne.deviation=deviation,Ne.extent=extent,Ne.histogram=histogram,Ne.thresholdFreedmanDiaconis=freedmanDiaconis,Ne.thresholdScott=scott,Ne.thresholdSturges=sturges,Ne.max=max,Ne.mean=mean,Ne.median=median,Ne.merge=merge,Ne.min=min,Ne.pairs=pairs,Ne.permute=permute,Ne.quantile=quantile,Ne.range=range,Ne.scan=scan,Ne.shuffle=shuffle,Ne.sum=sum,Ne.ticks=ticks,Ne.tickIncrement=tickIncrement,Ne.tickStep=tickStep,Ne.transpose=transpose,Ne.variance=variance,Ne.zip=zip,Object.defineProperty(Ne,"__esModule",{value:!0})},"object"==typeof Qe&&void 0!==Ge?nt(Qe):"function"==typeof tt&&tt.amd?tt(["exports"],nt):nt(rt.d3=rt.d3||{})},{}],157:[function(Ne,Ge,Qe){var rt,nt;rt=this,nt=function(Ne){"use strict";var Ge="$";function Map(){}function map(Ne,Ge){var Qe=new Map;if(Ne instanceof Map)Ne.each((function(Ne,Ge){Qe.set(Ge,Ne)}));else if(Array.isArray(Ne)){var tt,rt=-1,nt=Ne.length;if(null==Ge)for(;++rt<nt;)Qe.set(rt,Ne[rt]);else for(;++rt<nt;)Qe.set(Ge(tt=Ne[rt],rt,Ne),tt)}else if(Ne)for(var at in Ne)Qe.set(at,Ne[at]);return Qe}function nest(){var Ne,Ge,Qe,tt=[],rt=[];function apply(Qe,rt,nt,at){if(rt>=tt.length)return null!=Ne&&Qe.sort(Ne),null!=Ge?Ge(Qe):Qe;for(var it,ot,dt,ht=-1,Dt=Qe.length,Ot=tt[rt++],Rt=map(),Zt=nt();++ht<Dt;)(dt=Rt.get(it=Ot(ot=Qe[ht])+""))?dt.push(ot):Rt.set(it,[ot]);return Rt.each((function(Ne,Ge){at(Zt,Ge,apply(Ne,rt,nt,at))})),Zt}function entries(Ne,Qe){if(++Qe>tt.length)return Ne;var nt,at=rt[Qe-1];return null!=Ge&&Qe>=tt.length?nt=Ne.entries():(nt=[],Ne.each((function(Ne,Ge){nt.push({key:Ge,values:entries(Ne,Qe)})}))),null!=at?nt.sort((function(Ne,Ge){return at(Ne.key,Ge.key)})):nt}return Qe={object:function(Ne){return apply(Ne,0,createObject,setObject)},map:function(Ne){return apply(Ne,0,createMap,setMap)},entries:function(Ne){return entries(apply(Ne,0,createMap,setMap),0)},key:function(Ne){return tt.push(Ne),Qe},sortKeys:function(Ne){return rt[tt.length-1]=Ne,Qe},sortValues:function(Ge){return Ne=Ge,Qe},rollup:function(Ne){return Ge=Ne,Qe}}}function createObject(){return{}}function setObject(Ne,Ge,Qe){Ne[Ge]=Qe}function createMap(){return map()}function setMap(Ne,Ge,Qe){Ne.set(Ge,Qe)}function Set(){}Map.prototype=map.prototype={constructor:Map,has:function(Ne){return Ge+Ne in this},get:function(Ne){return this[Ge+Ne]},set:function(Ne,Qe){return this[Ge+Ne]=Qe,this},remove:function(Ne){var Qe=Ge+Ne;return Qe in this&&delete this[Qe]},clear:function(){for(var Ne in this)Ne[0]===Ge&&delete this[Ne]},keys:function(){var Ne=[];for(var Qe in this)Qe[0]===Ge&&Ne.push(Qe.slice(1));return Ne},values:function(){var Ne=[];for(var Qe in this)Qe[0]===Ge&&Ne.push(this[Qe]);return Ne},entries:function(){var Ne=[];for(var Qe in this)Qe[0]===Ge&&Ne.push({key:Qe.slice(1),value:this[Qe]});return Ne},size:function(){var Ne=0;for(var Qe in this)Qe[0]===Ge&&++Ne;return Ne},empty:function(){for(var Ne in this)if(Ne[0]===Ge)return!1;return!0},each:function(Ne){for(var Qe in this)Qe[0]===Ge&&Ne(this[Qe],Qe.slice(1),this)}};var Qe=map.prototype;function set(Ne,Ge){var Qe=new Set;if(Ne instanceof Set)Ne.each((function(Ne){Qe.add(Ne)}));else if(Ne){var tt=-1,rt=Ne.length;if(null==Ge)for(;++tt<rt;)Qe.add(Ne[tt]);else for(;++tt<rt;)Qe.add(Ge(Ne[tt],tt,Ne))}return Qe}function keys(Ne){var Ge=[];for(var Qe in Ne)Ge.push(Qe);return Ge}function values(Ne){var Ge=[];for(var Qe in Ne)Ge.push(Ne[Qe]);return Ge}function entries(Ne){var Ge=[];for(var Qe in Ne)Ge.push({key:Qe,value:Ne[Qe]});return Ge}Set.prototype=set.prototype={constructor:Set,has:Qe.has,add:function(Ne){return this[Ge+(Ne+="")]=Ne,this},remove:Qe.remove,clear:Qe.clear,values:Qe.keys,size:Qe.size,empty:Qe.empty,each:Qe.each},Ne.nest=nest,Ne.set=set,Ne.map=map,Ne.keys=keys,Ne.values=values,Ne.entries=entries,Object.defineProperty(Ne,"__esModule",{value:!0})},"object"==typeof Qe&&void 0!==Ge?nt(Qe):"function"==typeof tt&&tt.amd?tt(["exports"],nt):nt(rt.d3=rt.d3||{})},{}],158:[function(Ne,Ge,Qe){var rt,nt;rt=this,nt=function(Ne){"use strict";function define(Ne,Ge,Qe){Ne.prototype=Ge.prototype=Qe,Qe.constructor=Ne}function extend(Ne,Ge){var Qe=Object.create(Ne.prototype);for(var tt in Ge)Qe[tt]=Ge[tt];return Qe}function Color(){}var Ge=.7,Qe=1/Ge,tt="\\s*([+-]?\\d+)\\s*",rt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",nt="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",at=/^#([0-9a-f]{3,8})$/,it=new RegExp("^rgb\\("+[tt,tt,tt]+"\\)$"),ot=new RegExp("^rgb\\("+[nt,nt,nt]+"\\)$"),dt=new RegExp("^rgba\\("+[tt,tt,tt,rt]+"\\)$"),ht=new RegExp("^rgba\\("+[nt,nt,nt,rt]+"\\)$"),Dt=new RegExp("^hsl\\("+[rt,nt,nt]+"\\)$"),Ot=new RegExp("^hsla\\("+[rt,nt,nt,rt]+"\\)$"),Rt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function color_formatHex(){return this.rgb().formatHex()}function color_formatHsl(){return hslConvert(this).formatHsl()}function color_formatRgb(){return this.rgb().formatRgb()}function color(Ne){var Ge,Qe;return Ne=(Ne+"").trim().toLowerCase(),(Ge=at.exec(Ne))?(Qe=Ge[1].length,Ge=parseInt(Ge[1],16),6===Qe?rgbn(Ge):3===Qe?new Rgb(Ge>>8&15|Ge>>4&240,Ge>>4&15|240&Ge,(15&Ge)<<4|15&Ge,1):8===Qe?rgba(Ge>>24&255,Ge>>16&255,Ge>>8&255,(255&Ge)/255):4===Qe?rgba(Ge>>12&15|Ge>>8&240,Ge>>8&15|Ge>>4&240,Ge>>4&15|240&Ge,((15&Ge)<<4|15&Ge)/255):null):(Ge=it.exec(Ne))?new Rgb(Ge[1],Ge[2],Ge[3],1):(Ge=ot.exec(Ne))?new Rgb(255*Ge[1]/100,255*Ge[2]/100,255*Ge[3]/100,1):(Ge=dt.exec(Ne))?rgba(Ge[1],Ge[2],Ge[3],Ge[4]):(Ge=ht.exec(Ne))?rgba(255*Ge[1]/100,255*Ge[2]/100,255*Ge[3]/100,Ge[4]):(Ge=Dt.exec(Ne))?hsla(Ge[1],Ge[2]/100,Ge[3]/100,1):(Ge=Ot.exec(Ne))?hsla(Ge[1],Ge[2]/100,Ge[3]/100,Ge[4]):Rt.hasOwnProperty(Ne)?rgbn(Rt[Ne]):"transparent"===Ne?new Rgb(NaN,NaN,NaN,0):null}function rgbn(Ne){return new Rgb(Ne>>16&255,Ne>>8&255,255&Ne,1)}function rgba(Ne,Ge,Qe,tt){return tt<=0&&(Ne=Ge=Qe=NaN),new Rgb(Ne,Ge,Qe,tt)}function rgbConvert(Ne){return Ne instanceof Color||(Ne=color(Ne)),Ne?new Rgb((Ne=Ne.rgb()).r,Ne.g,Ne.b,Ne.opacity):new Rgb}function rgb(Ne,Ge,Qe,tt){return 1===arguments.length?rgbConvert(Ne):new Rgb(Ne,Ge,Qe,null==tt?1:tt)}function Rgb(Ne,Ge,Qe,tt){this.r=+Ne,this.g=+Ge,this.b=+Qe,this.opacity=+tt}function rgb_formatHex(){return"#"+hex(this.r)+hex(this.g)+hex(this.b)}function rgb_formatRgb(){var Ne=this.opacity;return(1===(Ne=isNaN(Ne)?1:Math.max(0,Math.min(1,Ne)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===Ne?")":", "+Ne+")")}function hex(Ne){return((Ne=Math.max(0,Math.min(255,Math.round(Ne)||0)))<16?"0":"")+Ne.toString(16)}function hsla(Ne,Ge,Qe,tt){return tt<=0?Ne=Ge=Qe=NaN:Qe<=0||Qe>=1?Ne=Ge=NaN:Ge<=0&&(Ne=NaN),new Hsl(Ne,Ge,Qe,tt)}function hslConvert(Ne){if(Ne instanceof Hsl)return new Hsl(Ne.h,Ne.s,Ne.l,Ne.opacity);if(Ne instanceof Color||(Ne=color(Ne)),!Ne)return new Hsl;if(Ne instanceof Hsl)return Ne;var Ge=(Ne=Ne.rgb()).r/255,Qe=Ne.g/255,tt=Ne.b/255,rt=Math.min(Ge,Qe,tt),nt=Math.max(Ge,Qe,tt),at=NaN,it=nt-rt,ot=(nt+rt)/2;return it?(at=Ge===nt?(Qe-tt)/it+6*(Qe<tt):Qe===nt?(tt-Ge)/it+2:(Ge-Qe)/it+4,it/=ot<.5?nt+rt:2-nt-rt,at*=60):it=ot>0&&ot<1?0:at,new Hsl(at,it,ot,Ne.opacity)}function hsl(Ne,Ge,Qe,tt){return 1===arguments.length?hslConvert(Ne):new Hsl(Ne,Ge,Qe,null==tt?1:tt)}function Hsl(Ne,Ge,Qe,tt){this.h=+Ne,this.s=+Ge,this.l=+Qe,this.opacity=+tt}function hsl2rgb(Ne,Ge,Qe){return 255*(Ne<60?Ge+(Qe-Ge)*Ne/60:Ne<180?Qe:Ne<240?Ge+(Qe-Ge)*(240-Ne)/60:Ge)}define(Color,color,{copy:function(Ne){return Object.assign(new this.constructor,this,Ne)},displayable:function(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHsl:color_formatHsl,formatRgb:color_formatRgb,toString:color_formatRgb}),define(Rgb,rgb,extend(Color,{brighter:function(Ne){return Ne=null==Ne?Qe:Math.pow(Qe,Ne),new Rgb(this.r*Ne,this.g*Ne,this.b*Ne,this.opacity)},darker:function(Ne){return Ne=null==Ne?Ge:Math.pow(Ge,Ne),new Rgb(this.r*Ne,this.g*Ne,this.b*Ne,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatRgb:rgb_formatRgb,toString:rgb_formatRgb})),define(Hsl,hsl,extend(Color,{brighter:function(Ne){return Ne=null==Ne?Qe:Math.pow(Qe,Ne),new Hsl(this.h,this.s,this.l*Ne,this.opacity)},darker:function(Ne){return Ne=null==Ne?Ge:Math.pow(Ge,Ne),new Hsl(this.h,this.s,this.l*Ne,this.opacity)},rgb:function(){var Ne=this.h%360+360*(this.h<0),Ge=isNaN(Ne)||isNaN(this.s)?0:this.s,Qe=this.l,tt=Qe+(Qe<.5?Qe:1-Qe)*Ge,rt=2*Qe-tt;return new Rgb(hsl2rgb(Ne>=240?Ne-240:Ne+120,rt,tt),hsl2rgb(Ne,rt,tt),hsl2rgb(Ne<120?Ne+240:Ne-120,rt,tt),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var Ne=this.opacity;return(1===(Ne=isNaN(Ne)?1:Math.max(0,Math.min(1,Ne)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===Ne?")":", "+Ne+")")}}));var Zt=Math.PI/180,er=180/Math.PI,dr=18,mr=.96422,xr=1,br=.82521,Ar=4/29,en=6/29,mn=3*en*en,xn=en*en*en;function labConvert(Ne){if(Ne instanceof Lab)return new Lab(Ne.l,Ne.a,Ne.b,Ne.opacity);if(Ne instanceof Hcl)return hcl2lab(Ne);Ne instanceof Rgb||(Ne=rgbConvert(Ne));var Ge,Qe,tt=rgb2lrgb(Ne.r),rt=rgb2lrgb(Ne.g),nt=rgb2lrgb(Ne.b),at=xyz2lab((.2225045*tt+.7168786*rt+.0606169*nt)/xr);return tt===rt&&rt===nt?Ge=Qe=at:(Ge=xyz2lab((.4360747*tt+.3850649*rt+.1430804*nt)/mr),Qe=xyz2lab((.0139322*tt+.0971045*rt+.7141733*nt)/br)),new Lab(116*at-16,500*(Ge-at),200*(at-Qe),Ne.opacity)}function gray(Ne,Ge){return new Lab(Ne,0,0,null==Ge?1:Ge)}function lab(Ne,Ge,Qe,tt){return 1===arguments.length?labConvert(Ne):new Lab(Ne,Ge,Qe,null==tt?1:tt)}function Lab(Ne,Ge,Qe,tt){this.l=+Ne,this.a=+Ge,this.b=+Qe,this.opacity=+tt}function xyz2lab(Ne){return Ne>xn?Math.pow(Ne,1/3):Ne/mn+Ar}function lab2xyz(Ne){return Ne>en?Ne*Ne*Ne:mn*(Ne-Ar)}function lrgb2rgb(Ne){return 255*(Ne<=.0031308?12.92*Ne:1.055*Math.pow(Ne,1/2.4)-.055)}function rgb2lrgb(Ne){return(Ne/=255)<=.04045?Ne/12.92:Math.pow((Ne+.055)/1.055,2.4)}function hclConvert(Ne){if(Ne instanceof Hcl)return new Hcl(Ne.h,Ne.c,Ne.l,Ne.opacity);if(Ne instanceof Lab||(Ne=labConvert(Ne)),0===Ne.a&&0===Ne.b)return new Hcl(NaN,0<Ne.l&&Ne.l<100?0:NaN,Ne.l,Ne.opacity);var Ge=Math.atan2(Ne.b,Ne.a)*er;return new Hcl(Ge<0?Ge+360:Ge,Math.sqrt(Ne.a*Ne.a+Ne.b*Ne.b),Ne.l,Ne.opacity)}function lch(Ne,Ge,Qe,tt){return 1===arguments.length?hclConvert(Ne):new Hcl(Qe,Ge,Ne,null==tt?1:tt)}function hcl(Ne,Ge,Qe,tt){return 1===arguments.length?hclConvert(Ne):new Hcl(Ne,Ge,Qe,null==tt?1:tt)}function Hcl(Ne,Ge,Qe,tt){this.h=+Ne,this.c=+Ge,this.l=+Qe,this.opacity=+tt}function hcl2lab(Ne){if(isNaN(Ne.h))return new Lab(Ne.l,0,0,Ne.opacity);var Ge=Ne.h*Zt;return new Lab(Ne.l,Math.cos(Ge)*Ne.c,Math.sin(Ge)*Ne.c,Ne.opacity)}define(Lab,lab,extend(Color,{brighter:function(Ne){return new Lab(this.l+dr*(null==Ne?1:Ne),this.a,this.b,this.opacity)},darker:function(Ne){return new Lab(this.l-dr*(null==Ne?1:Ne),this.a,this.b,this.opacity)},rgb:function(){var Ne=(this.l+16)/116,Ge=isNaN(this.a)?Ne:Ne+this.a/500,Qe=isNaN(this.b)?Ne:Ne-this.b/200;return new Rgb(lrgb2rgb(3.1338561*(Ge=mr*lab2xyz(Ge))-1.6168667*(Ne=xr*lab2xyz(Ne))-.4906146*(Qe=br*lab2xyz(Qe))),lrgb2rgb(-.9787684*Ge+1.9161415*Ne+.033454*Qe),lrgb2rgb(.0719453*Ge-.2289914*Ne+1.4052427*Qe),this.opacity)}})),define(Hcl,hcl,extend(Color,{brighter:function(Ne){return new Hcl(this.h,this.c,this.l+dr*(null==Ne?1:Ne),this.opacity)},darker:function(Ne){return new Hcl(this.h,this.c,this.l-dr*(null==Ne?1:Ne),this.opacity)},rgb:function(){return hcl2lab(this).rgb()}}));var kn=-.14861,Cn=1.78277,En=-.29227,Pn=-.90649,Dn=1.97294,In=Dn*Pn,zn=Dn*Cn,Bn=Cn*En-Pn*kn;function cubehelixConvert(Ne){if(Ne instanceof Cubehelix)return new Cubehelix(Ne.h,Ne.s,Ne.l,Ne.opacity);Ne instanceof Rgb||(Ne=rgbConvert(Ne));var Ge=Ne.r/255,Qe=Ne.g/255,tt=Ne.b/255,rt=(Bn*tt+In*Ge-zn*Qe)/(Bn+In-zn),nt=tt-rt,at=(Dn*(Qe-rt)-En*nt)/Pn,it=Math.sqrt(at*at+nt*nt)/(Dn*rt*(1-rt)),ot=it?Math.atan2(at,nt)*er-120:NaN;return new Cubehelix(ot<0?ot+360:ot,it,rt,Ne.opacity)}function cubehelix(Ne,Ge,Qe,tt){return 1===arguments.length?cubehelixConvert(Ne):new Cubehelix(Ne,Ge,Qe,null==tt?1:tt)}function Cubehelix(Ne,Ge,Qe,tt){this.h=+Ne,this.s=+Ge,this.l=+Qe,this.opacity=+tt}define(Cubehelix,cubehelix,extend(Color,{brighter:function(Ne){return Ne=null==Ne?Qe:Math.pow(Qe,Ne),new Cubehelix(this.h,this.s,this.l*Ne,this.opacity)},darker:function(Ne){return Ne=null==Ne?Ge:Math.pow(Ge,Ne),new Cubehelix(this.h,this.s,this.l*Ne,this.opacity)},rgb:function(){var Ne=isNaN(this.h)?0:(this.h+120)*Zt,Ge=+this.l,Qe=isNaN(this.s)?0:this.s*Ge*(1-Ge),tt=Math.cos(Ne),rt=Math.sin(Ne);return new Rgb(255*(Ge+Qe*(kn*tt+Cn*rt)),255*(Ge+Qe*(En*tt+Pn*rt)),255*(Ge+Qe*(Dn*tt)),this.opacity)}})),Ne.color=color,Ne.cubehelix=cubehelix,Ne.gray=gray,Ne.hcl=hcl,Ne.hsl=hsl,Ne.lab=lab,Ne.lch=lch,Ne.rgb=rgb,Object.defineProperty(Ne,"__esModule",{value:!0})},"object"==typeof Qe&&void 0!==Ge?nt(Qe):"function"==typeof tt&&tt.amd?tt(["exports"],nt):nt((rt=rt||self).d3=rt.d3||{})},{}],159:[function(Ne,Ge,Qe){var rt,nt;rt=this,nt=function(Ne){"use strict";var Ge={value:function(){}};function dispatch(){for(var Ne,Ge=0,Qe=arguments.length,tt={};Ge<Qe;++Ge){if(!(Ne=arguments[Ge]+"")||Ne in tt||/[\s.]/.test(Ne))throw new Error("illegal type: "+Ne);tt[Ne]=[]}return new Dispatch(tt)}function Dispatch(Ne){this._=Ne}function parseTypenames(Ne,Ge){return Ne.trim().split(/^|\s+/).map((function(Ne){var Qe="",tt=Ne.indexOf(".");if(tt>=0&&(Qe=Ne.slice(tt+1),Ne=Ne.slice(0,tt)),Ne&&!Ge.hasOwnProperty(Ne))throw new Error("unknown type: "+Ne);return{type:Ne,name:Qe}}))}function get(Ne,Ge){for(var Qe,tt=0,rt=Ne.length;tt<rt;++tt)if((Qe=Ne[tt]).name===Ge)return Qe.value}function set(Ne,Qe,tt){for(var rt=0,nt=Ne.length;rt<nt;++rt)if(Ne[rt].name===Qe){Ne[rt]=Ge,Ne=Ne.slice(0,rt).concat(Ne.slice(rt+1));break}return null!=tt&&Ne.push({name:Qe,value:tt}),Ne}Dispatch.prototype=dispatch.prototype={constructor:Dispatch,on:function(Ne,Ge){var Qe,tt=this._,rt=parseTypenames(Ne+"",tt),nt=-1,at=rt.length;if(!(arguments.length<2)){if(null!=Ge&&"function"!=typeof Ge)throw new Error("invalid callback: "+Ge);for(;++nt<at;)if(Qe=(Ne=rt[nt]).type)tt[Qe]=set(tt[Qe],Ne.name,Ge);else if(null==Ge)for(Qe in tt)tt[Qe]=set(tt[Qe],Ne.name,null);return this}for(;++nt<at;)if((Qe=(Ne=rt[nt]).type)&&(Qe=get(tt[Qe],Ne.name)))return Qe},copy:function(){var Ne={},Ge=this._;for(var Qe in Ge)Ne[Qe]=Ge[Qe].slice();return new Dispatch(Ne)},call:function(Ne,Ge){if((Qe=arguments.length-2)>0)for(var Qe,tt,rt=new Array(Qe),nt=0;nt<Qe;++nt)rt[nt]=arguments[nt+2];if(!this._.hasOwnProperty(Ne))throw new Error("unknown type: "+Ne);for(nt=0,Qe=(tt=this._[Ne]).length;nt<Qe;++nt)tt[nt].value.apply(Ge,rt)},apply:function(Ne,Ge,Qe){if(!this._.hasOwnProperty(Ne))throw new Error("unknown type: "+Ne);for(var tt=this._[Ne],rt=0,nt=tt.length;rt<nt;++rt)tt[rt].value.apply(Ge,Qe)}},Ne.dispatch=dispatch,Object.defineProperty(Ne,"__esModule",{value:!0})},"object"==typeof Qe&&void 0!==Ge?nt(Qe):"function"==typeof tt&&tt.amd?tt(["exports"],nt):nt((rt=rt||self).d3=rt.d3||{})},{}],160:[function(Ne,Ge,Qe){var rt,nt;rt=this,nt=function(Ne,Ge,Qe,tt,rt){"use strict";function center(Ne,Ge){var Qe;function force(){var tt,rt,nt=Qe.length,at=0,it=0;for(tt=0;tt<nt;++tt)at+=(rt=Qe[tt]).x,it+=rt.y;for(at=at/nt-Ne,it=it/nt-Ge,tt=0;tt<nt;++tt)(rt=Qe[tt]).x-=at,rt.y-=it}return null==Ne&&(Ne=0),null==Ge&&(Ge=0),force.initialize=function(Ne){Qe=Ne},force.x=function(Ge){return arguments.length?(Ne=+Ge,force):Ne},force.y=function(Ne){return arguments.length?(Ge=+Ne,force):Ge},force}function constant(Ne){return function(){return Ne}}function jiggle(){return 1e-6*(Math.random()-.5)}function x(Ne){return Ne.x+Ne.vx}function y(Ne){return Ne.y+Ne.vy}function collide(Ne){var Qe,tt,rt=1,nt=1;function force(){for(var Ne,at,it,ot,dt,ht,Dt,Ot=Qe.length,Rt=0;Rt<nt;++Rt)for(at=Ge.quadtree(Qe,x,y).visitAfter(prepare),Ne=0;Ne<Ot;++Ne)it=Qe[Ne],ht=tt[it.index],Dt=ht*ht,ot=it.x+it.vx,dt=it.y+it.vy,at.visit(apply);function apply(Ne,Ge,Qe,tt,nt){var at=Ne.data,Ot=Ne.r,Rt=ht+Ot;if(!at)return Ge>ot+Rt||tt<ot-Rt||Qe>dt+Rt||nt<dt-Rt;if(at.index>it.index){var Zt=ot-at.x-at.vx,er=dt-at.y-at.vy,dr=Zt*Zt+er*er;dr<Rt*Rt&&(0===Zt&&(dr+=(Zt=jiggle())*Zt),0===er&&(dr+=(er=jiggle())*er),dr=(Rt-(dr=Math.sqrt(dr)))/dr*rt,it.vx+=(Zt*=dr)*(Rt=(Ot*=Ot)/(Dt+Ot)),it.vy+=(er*=dr)*Rt,at.vx-=Zt*(Rt=1-Rt),at.vy-=er*Rt)}}}function prepare(Ne){if(Ne.data)return Ne.r=tt[Ne.data.index];for(var Ge=Ne.r=0;Ge<4;++Ge)Ne[Ge]&&Ne[Ge].r>Ne.r&&(Ne.r=Ne[Ge].r)}function initialize(){if(Qe){var Ge,rt,nt=Qe.length;for(tt=new Array(nt),Ge=0;Ge<nt;++Ge)rt=Qe[Ge],tt[rt.index]=+Ne(rt,Ge,Qe)}}return"function"!=typeof Ne&&(Ne=constant(null==Ne?1:+Ne)),force.initialize=function(Ne){Qe=Ne,initialize()},force.iterations=function(Ne){return arguments.length?(nt=+Ne,force):nt},force.strength=function(Ne){return arguments.length?(rt=+Ne,force):rt},force.radius=function(Ge){return arguments.length?(Ne="function"==typeof Ge?Ge:constant(+Ge),initialize(),force):Ne},force}function index(Ne){return Ne.index}function find(Ne,Ge){var Qe=Ne.get(Ge);if(!Qe)throw new Error("missing: "+Ge);return Qe}function link(Ne){var Ge,tt,rt,nt,at,it=index,ot=defaultStrength,dt=constant(30),ht=1;function defaultStrength(Ne){return 1/Math.min(nt[Ne.source.index],nt[Ne.target.index])}function force(Qe){for(var rt=0,nt=Ne.length;rt<ht;++rt)for(var it,ot,dt,Dt,Ot,Rt,Zt,er=0;er<nt;++er)ot=(it=Ne[er]).source,Dt=(dt=it.target).x+dt.vx-ot.x-ot.vx||jiggle(),Ot=dt.y+dt.vy-ot.y-ot.vy||jiggle(),Dt*=Rt=((Rt=Math.sqrt(Dt*Dt+Ot*Ot))-tt[er])/Rt*Qe*Ge[er],Ot*=Rt,dt.vx-=Dt*(Zt=at[er]),dt.vy-=Ot*Zt,ot.vx+=Dt*(Zt=1-Zt),ot.vy+=Ot*Zt}function initialize(){if(rt){var ot,dt,ht=rt.length,Dt=Ne.length,Ot=Qe.map(rt,it);for(ot=0,nt=new Array(ht);ot<Dt;++ot)(dt=Ne[ot]).index=ot,"object"!=typeof dt.source&&(dt.source=find(Ot,dt.source)),"object"!=typeof dt.target&&(dt.target=find(Ot,dt.target)),nt[dt.source.index]=(nt[dt.source.index]||0)+1,nt[dt.target.index]=(nt[dt.target.index]||0)+1;for(ot=0,at=new Array(Dt);ot<Dt;++ot)dt=Ne[ot],at[ot]=nt[dt.source.index]/(nt[dt.source.index]+nt[dt.target.index]);Ge=new Array(Dt),initializeStrength(),tt=new Array(Dt),initializeDistance()}}function initializeStrength(){if(rt)for(var Qe=0,tt=Ne.length;Qe<tt;++Qe)Ge[Qe]=+ot(Ne[Qe],Qe,Ne)}function initializeDistance(){if(rt)for(var Ge=0,Qe=Ne.length;Ge<Qe;++Ge)tt[Ge]=+dt(Ne[Ge],Ge,Ne)}return null==Ne&&(Ne=[]),force.initialize=function(Ne){rt=Ne,initialize()},force.links=function(Ge){return arguments.length?(Ne=Ge,initialize(),force):Ne},force.id=function(Ne){return arguments.length?(it=Ne,force):it},force.iterations=function(Ne){return arguments.length?(ht=+Ne,force):ht},force.strength=function(Ne){return arguments.length?(ot="function"==typeof Ne?Ne:constant(+Ne),initializeStrength(),force):ot},force.distance=function(Ne){return arguments.length?(dt="function"==typeof Ne?Ne:constant(+Ne),initializeDistance(),force):dt},force}function x$1(Ne){return Ne.x}function y$1(Ne){return Ne.y}var nt=10,at=Math.PI*(3-Math.sqrt(5));function simulation(Ne){var Ge,it=1,ot=.001,dt=1-Math.pow(ot,1/300),ht=0,Dt=.6,Ot=Qe.map(),Rt=rt.timer(step),Zt=tt.dispatch("tick","end");function step(){tick(),Zt.call("tick",Ge),it<ot&&(Rt.stop(),Zt.call("end",Ge))}function tick(Qe){var tt,rt,nt=Ne.length;void 0===Qe&&(Qe=1);for(var at=0;at<Qe;++at)for(it+=(ht-it)*dt,Ot.each((function(Ne){Ne(it)})),tt=0;tt<nt;++tt)null==(rt=Ne[tt]).fx?rt.x+=rt.vx*=Dt:(rt.x=rt.fx,rt.vx=0),null==rt.fy?rt.y+=rt.vy*=Dt:(rt.y=rt.fy,rt.vy=0);return Ge}function initializeNodes(){for(var Ge,Qe=0,tt=Ne.length;Qe<tt;++Qe){if((Ge=Ne[Qe]).index=Qe,null!=Ge.fx&&(Ge.x=Ge.fx),null!=Ge.fy&&(Ge.y=Ge.fy),isNaN(Ge.x)||isNaN(Ge.y)){var rt=nt*Math.sqrt(Qe),it=Qe*at;Ge.x=rt*Math.cos(it),Ge.y=rt*Math.sin(it)}(isNaN(Ge.vx)||isNaN(Ge.vy))&&(Ge.vx=Ge.vy=0)}}function initializeForce(Ge){return Ge.initialize&&Ge.initialize(Ne),Ge}return null==Ne&&(Ne=[]),initializeNodes(),Ge={tick:tick,restart:function(){return Rt.restart(step),Ge},stop:function(){return Rt.stop(),Ge},nodes:function(Qe){return arguments.length?(Ne=Qe,initializeNodes(),Ot.each(initializeForce),Ge):Ne},alpha:function(Ne){return arguments.length?(it=+Ne,Ge):it},alphaMin:function(Ne){return arguments.length?(ot=+Ne,Ge):ot},alphaDecay:function(Ne){return arguments.length?(dt=+Ne,Ge):+dt},alphaTarget:function(Ne){return arguments.length?(ht=+Ne,Ge):ht},velocityDecay:function(Ne){return arguments.length?(Dt=1-Ne,Ge):1-Dt},force:function(Ne,Qe){return arguments.length>1?(null==Qe?Ot.remove(Ne):Ot.set(Ne,initializeForce(Qe)),Ge):Ot.get(Ne)},find:function(Ge,Qe,tt){var rt,nt,at,it,ot,dt=0,ht=Ne.length;for(null==tt?tt=1/0:tt*=tt,dt=0;dt<ht;++dt)(at=(rt=Ge-(it=Ne[dt]).x)*rt+(nt=Qe-it.y)*nt)<tt&&(ot=it,tt=at);return ot},on:function(Ne,Qe){return arguments.length>1?(Zt.on(Ne,Qe),Ge):Zt.on(Ne)}}}function manyBody(){var Ne,Qe,tt,rt,nt=constant(-30),at=1,it=1/0,ot=.81;function force(rt){var nt,at=Ne.length,it=Ge.quadtree(Ne,x$1,y$1).visitAfter(accumulate);for(tt=rt,nt=0;nt<at;++nt)Qe=Ne[nt],it.visit(apply)}function initialize(){if(Ne){var Ge,Qe,tt=Ne.length;for(rt=new Array(tt),Ge=0;Ge<tt;++Ge)Qe=Ne[Ge],rt[Qe.index]=+nt(Qe,Ge,Ne)}}function accumulate(Ne){var Ge,Qe,tt,nt,at,it=0,ot=0;if(Ne.length){for(tt=nt=at=0;at<4;++at)(Ge=Ne[at])&&(Qe=Math.abs(Ge.value))&&(it+=Ge.value,ot+=Qe,tt+=Qe*Ge.x,nt+=Qe*Ge.y);Ne.x=tt/ot,Ne.y=nt/ot}else{(Ge=Ne).x=Ge.data.x,Ge.y=Ge.data.y;do{it+=rt[Ge.data.index]}while(Ge=Ge.next)}Ne.value=it}function apply(Ne,Ge,nt,dt){if(!Ne.value)return!0;var ht=Ne.x-Qe.x,Dt=Ne.y-Qe.y,Ot=dt-Ge,Rt=ht*ht+Dt*Dt;if(Ot*Ot/ot<Rt)return Rt<it&&(0===ht&&(Rt+=(ht=jiggle())*ht),0===Dt&&(Rt+=(Dt=jiggle())*Dt),Rt<at&&(Rt=Math.sqrt(at*Rt)),Qe.vx+=ht*Ne.value*tt/Rt,Qe.vy+=Dt*Ne.value*tt/Rt),!0;if(!(Ne.length||Rt>=it)){(Ne.data!==Qe||Ne.next)&&(0===ht&&(Rt+=(ht=jiggle())*ht),0===Dt&&(Rt+=(Dt=jiggle())*Dt),Rt<at&&(Rt=Math.sqrt(at*Rt)));do{Ne.data!==Qe&&(Ot=rt[Ne.data.index]*tt/Rt,Qe.vx+=ht*Ot,Qe.vy+=Dt*Ot)}while(Ne=Ne.next)}}return force.initialize=function(Ge){Ne=Ge,initialize()},force.strength=function(Ne){return arguments.length?(nt="function"==typeof Ne?Ne:constant(+Ne),initialize(),force):nt},force.distanceMin=function(Ne){return arguments.length?(at=Ne*Ne,force):Math.sqrt(at)},force.distanceMax=function(Ne){return arguments.length?(it=Ne*Ne,force):Math.sqrt(it)},force.theta=function(Ne){return arguments.length?(ot=Ne*Ne,force):Math.sqrt(ot)},force}function radial(Ne,Ge,Qe){var tt,rt,nt,at=constant(.1);function force(Ne){for(var at=0,it=tt.length;at<it;++at){var ot=tt[at],dt=ot.x-Ge||1e-6,ht=ot.y-Qe||1e-6,Dt=Math.sqrt(dt*dt+ht*ht),Ot=(nt[at]-Dt)*rt[at]*Ne/Dt;ot.vx+=dt*Ot,ot.vy+=ht*Ot}}function initialize(){if(tt){var Ge,Qe=tt.length;for(rt=new Array(Qe),nt=new Array(Qe),Ge=0;Ge<Qe;++Ge)nt[Ge]=+Ne(tt[Ge],Ge,tt),rt[Ge]=isNaN(nt[Ge])?0:+at(tt[Ge],Ge,tt)}}return"function"!=typeof Ne&&(Ne=constant(+Ne)),null==Ge&&(Ge=0),null==Qe&&(Qe=0),force.initialize=function(Ne){tt=Ne,initialize()},force.strength=function(Ne){return arguments.length?(at="function"==typeof Ne?Ne:constant(+Ne),initialize(),force):at},force.radius=function(Ge){return arguments.length?(Ne="function"==typeof Ge?Ge:constant(+Ge),initialize(),force):Ne},force.x=function(Ne){return arguments.length?(Ge=+Ne,force):Ge},force.y=function(Ne){return arguments.length?(Qe=+Ne,force):Qe},force}function x$2(Ne){var Ge,Qe,tt,rt=constant(.1);function force(Ne){for(var rt,nt=0,at=Ge.length;nt<at;++nt)(rt=Ge[nt]).vx+=(tt[nt]-rt.x)*Qe[nt]*Ne}function initialize(){if(Ge){var nt,at=Ge.length;for(Qe=new Array(at),tt=new Array(at),nt=0;nt<at;++nt)Qe[nt]=isNaN(tt[nt]=+Ne(Ge[nt],nt,Ge))?0:+rt(Ge[nt],nt,Ge)}}return"function"!=typeof Ne&&(Ne=constant(null==Ne?0:+Ne)),force.initialize=function(Ne){Ge=Ne,initialize()},force.strength=function(Ne){return arguments.length?(rt="function"==typeof Ne?Ne:constant(+Ne),initialize(),force):rt},force.x=function(Ge){return arguments.length?(Ne="function"==typeof Ge?Ge:constant(+Ge),initialize(),force):Ne},force}function y$2(Ne){var Ge,Qe,tt,rt=constant(.1);function force(Ne){for(var rt,nt=0,at=Ge.length;nt<at;++nt)(rt=Ge[nt]).vy+=(tt[nt]-rt.y)*Qe[nt]*Ne}function initialize(){if(Ge){var nt,at=Ge.length;for(Qe=new Array(at),tt=new Array(at),nt=0;nt<at;++nt)Qe[nt]=isNaN(tt[nt]=+Ne(Ge[nt],nt,Ge))?0:+rt(Ge[nt],nt,Ge)}}return"function"!=typeof Ne&&(Ne=constant(null==Ne?0:+Ne)),force.initialize=function(Ne){Ge=Ne,initialize()},force.strength=function(Ne){return arguments.length?(rt="function"==typeof Ne?Ne:constant(+Ne),initialize(),force):rt},force.y=function(Ge){return arguments.length?(Ne="function"==typeof Ge?Ge:constant(+Ge),initialize(),force):Ne},force}Ne.forceCenter=center,Ne.forceCollide=collide,Ne.forceLink=link,Ne.forceManyBody=manyBody,Ne.forceRadial=radial,Ne.forceSimulation=simulation,Ne.forceX=x$2,Ne.forceY=y$2,Object.defineProperty(Ne,"__esModule",{value:!0})},"object"==typeof Qe&&void 0!==Ge?nt(Qe,Ne("d3-quadtree"),Ne("d3-collection"),Ne("d3-dispatch"),Ne("d3-timer")):"function"==typeof tt&&tt.amd?tt(["exports","d3-quadtree","d3-collection","d3-dispatch","d3-timer"],nt):nt(rt.d3=rt.d3||{},rt.d3,rt.d3,rt.d3,rt.d3)},{"d3-collection":157,"d3-dispatch":159,"d3-quadtree":164,"d3-timer":168}],161:[function(Ne,Ge,Qe){var rt,nt;rt=this,nt=function(Ne){"use strict";function defaultSeparation(Ne,Ge){return Ne.parent===Ge.parent?1:2}function meanX(Ne){return Ne.reduce(meanXReduce,0)/Ne.length}function meanXReduce(Ne,Ge){return Ne+Ge.x}function maxY(Ne){return 1+Ne.reduce(maxYReduce,0)}function maxYReduce(Ne,Ge){return Math.max(Ne,Ge.y)}function leafLeft(Ne){for(var Ge;Ge=Ne.children;)Ne=Ge[0];return Ne}function leafRight(Ne){for(var Ge;Ge=Ne.children;)Ne=Ge[Ge.length-1];return Ne}function cluster(){var Ne=defaultSeparation,Ge=1,Qe=1,tt=!1;function cluster(rt){var nt,at=0;rt.eachAfter((function(Ge){var Qe=Ge.children;Qe?(Ge.x=meanX(Qe),Ge.y=maxY(Qe)):(Ge.x=nt?at+=Ne(Ge,nt):0,Ge.y=0,nt=Ge)}));var it=leafLeft(rt),ot=leafRight(rt),dt=it.x-Ne(it,ot)/2,ht=ot.x+Ne(ot,it)/2;return rt.eachAfter(tt?function(Ne){Ne.x=(Ne.x-rt.x)*Ge,Ne.y=(rt.y-Ne.y)*Qe}:function(Ne){Ne.x=(Ne.x-dt)/(ht-dt)*Ge,Ne.y=(1-(rt.y?Ne.y/rt.y:1))*Qe})}return cluster.separation=function(Ge){return arguments.length?(Ne=Ge,cluster):Ne},cluster.size=function(Ne){return arguments.length?(tt=!1,Ge=+Ne[0],Qe=+Ne[1],cluster):tt?null:[Ge,Qe]},cluster.nodeSize=function(Ne){return arguments.length?(tt=!0,Ge=+Ne[0],Qe=+Ne[1],cluster):tt?[Ge,Qe]:null},cluster}function count(Ne){var Ge=0,Qe=Ne.children,tt=Qe&&Qe.length;if(tt)for(;--tt>=0;)Ge+=Qe[tt].value;else Ge=1;Ne.value=Ge}function node_count(){return this.eachAfter(count)}function node_each(Ne){var Ge,Qe,tt,rt,nt=this,at=[nt];do{for(Ge=at.reverse(),at=[];nt=Ge.pop();)if(Ne(nt),Qe=nt.children)for(tt=0,rt=Qe.length;tt<rt;++tt)at.push(Qe[tt])}while(at.length);return this}function node_eachBefore(Ne){for(var Ge,Qe,tt=this,rt=[tt];tt=rt.pop();)if(Ne(tt),Ge=tt.children)for(Qe=Ge.length-1;Qe>=0;--Qe)rt.push(Ge[Qe]);return this}function node_eachAfter(Ne){for(var Ge,Qe,tt,rt=this,nt=[rt],at=[];rt=nt.pop();)if(at.push(rt),Ge=rt.children)for(Qe=0,tt=Ge.length;Qe<tt;++Qe)nt.push(Ge[Qe]);for(;rt=at.pop();)Ne(rt);return this}function node_sum(Ne){return this.eachAfter((function(Ge){for(var Qe=+Ne(Ge.data)||0,tt=Ge.children,rt=tt&&tt.length;--rt>=0;)Qe+=tt[rt].value;Ge.value=Qe}))}function node_sort(Ne){return this.eachBefore((function(Ge){Ge.children&&Ge.children.sort(Ne)}))}function node_path(Ne){for(var Ge=this,Qe=leastCommonAncestor(Ge,Ne),tt=[Ge];Ge!==Qe;)Ge=Ge.parent,tt.push(Ge);for(var rt=tt.length;Ne!==Qe;)tt.splice(rt,0,Ne),Ne=Ne.parent;return tt}function leastCommonAncestor(Ne,Ge){if(Ne===Ge)return Ne;var Qe=Ne.ancestors(),tt=Ge.ancestors(),rt=null;for(Ne=Qe.pop(),Ge=tt.pop();Ne===Ge;)rt=Ne,Ne=Qe.pop(),Ge=tt.pop();return rt}function node_ancestors(){for(var Ne=this,Ge=[Ne];Ne=Ne.parent;)Ge.push(Ne);return Ge}function node_descendants(){var Ne=[];return this.each((function(Ge){Ne.push(Ge)})),Ne}function node_leaves(){var Ne=[];return this.eachBefore((function(Ge){Ge.children||Ne.push(Ge)})),Ne}function node_links(){var Ne=this,Ge=[];return Ne.each((function(Qe){Qe!==Ne&&Ge.push({source:Qe.parent,target:Qe})})),Ge}function hierarchy(Ne,Ge){var Qe,tt,rt,nt,at,it=new Node(Ne),ot=+Ne.value&&(it.value=Ne.value),dt=[it];for(null==Ge&&(Ge=defaultChildren);Qe=dt.pop();)if(ot&&(Qe.value=+Qe.data.value),(rt=Ge(Qe.data))&&(at=rt.length))for(Qe.children=new Array(at),nt=at-1;nt>=0;--nt)dt.push(tt=Qe.children[nt]=new Node(rt[nt])),tt.parent=Qe,tt.depth=Qe.depth+1;return it.eachBefore(computeHeight)}function node_copy(){return hierarchy(this).eachBefore(copyData)}function defaultChildren(Ne){return Ne.children}function copyData(Ne){Ne.data=Ne.data.data}function computeHeight(Ne){var Ge=0;do{Ne.height=Ge}while((Ne=Ne.parent)&&Ne.height<++Ge)}function Node(Ne){this.data=Ne,this.depth=this.height=0,this.parent=null}Node.prototype=hierarchy.prototype={constructor:Node,count:node_count,each:node_each,eachAfter:node_eachAfter,eachBefore:node_eachBefore,sum:node_sum,sort:node_sort,path:node_path,ancestors:node_ancestors,descendants:node_descendants,leaves:node_leaves,links:node_links,copy:node_copy};var Ge=Array.prototype.slice;function shuffle(Ne){for(var Ge,Qe,tt=Ne.length;tt;)Qe=Math.random()*tt--|0,Ge=Ne[tt],Ne[tt]=Ne[Qe],Ne[Qe]=Ge;return Ne}function enclose(Ne){for(var Qe,tt,rt=0,nt=(Ne=shuffle(Ge.call(Ne))).length,at=[];rt<nt;)Qe=Ne[rt],tt&&enclosesWeak(tt,Qe)?++rt:(tt=encloseBasis(at=extendBasis(at,Qe)),rt=0);return tt}function extendBasis(Ne,Ge){var Qe,tt;if(enclosesWeakAll(Ge,Ne))return[Ge];for(Qe=0;Qe<Ne.length;++Qe)if(enclosesNot(Ge,Ne[Qe])&&enclosesWeakAll(encloseBasis2(Ne[Qe],Ge),Ne))return[Ne[Qe],Ge];for(Qe=0;Qe<Ne.length-1;++Qe)for(tt=Qe+1;tt<Ne.length;++tt)if(enclosesNot(encloseBasis2(Ne[Qe],Ne[tt]),Ge)&&enclosesNot(encloseBasis2(Ne[Qe],Ge),Ne[tt])&&enclosesNot(encloseBasis2(Ne[tt],Ge),Ne[Qe])&&enclosesWeakAll(encloseBasis3(Ne[Qe],Ne[tt],Ge),Ne))return[Ne[Qe],Ne[tt],Ge];throw new Error}function enclosesNot(Ne,Ge){var Qe=Ne.r-Ge.r,tt=Ge.x-Ne.x,rt=Ge.y-Ne.y;return Qe<0||Qe*Qe<tt*tt+rt*rt}function enclosesWeak(Ne,Ge){var Qe=Ne.r-Ge.r+1e-6,tt=Ge.x-Ne.x,rt=Ge.y-Ne.y;return Qe>0&&Qe*Qe>tt*tt+rt*rt}function enclosesWeakAll(Ne,Ge){for(var Qe=0;Qe<Ge.length;++Qe)if(!enclosesWeak(Ne,Ge[Qe]))return!1;return!0}function encloseBasis(Ne){switch(Ne.length){case 1:return encloseBasis1(Ne[0]);case 2:return encloseBasis2(Ne[0],Ne[1]);case 3:return encloseBasis3(Ne[0],Ne[1],Ne[2])}}function encloseBasis1(Ne){return{x:Ne.x,y:Ne.y,r:Ne.r}}function encloseBasis2(Ne,Ge){var Qe=Ne.x,tt=Ne.y,rt=Ne.r,nt=Ge.x,at=Ge.y,it=Ge.r,ot=nt-Qe,dt=at-tt,ht=it-rt,Dt=Math.sqrt(ot*ot+dt*dt);return{x:(Qe+nt+ot/Dt*ht)/2,y:(tt+at+dt/Dt*ht)/2,r:(Dt+rt+it)/2}}function encloseBasis3(Ne,Ge,Qe){var tt=Ne.x,rt=Ne.y,nt=Ne.r,at=Ge.x,it=Ge.y,ot=Ge.r,dt=Qe.x,ht=Qe.y,Dt=Qe.r,Ot=tt-at,Rt=tt-dt,Zt=rt-it,er=rt-ht,dr=ot-nt,mr=Dt-nt,xr=tt*tt+rt*rt-nt*nt,br=xr-at*at-it*it+ot*ot,Ar=xr-dt*dt-ht*ht+Dt*Dt,en=Rt*Zt-Ot*er,mn=(Zt*Ar-er*br)/(2*en)-tt,xn=(er*dr-Zt*mr)/en,kn=(Rt*br-Ot*Ar)/(2*en)-rt,Cn=(Ot*mr-Rt*dr)/en,En=xn*xn+Cn*Cn-1,Pn=2*(nt+mn*xn+kn*Cn),Dn=mn*mn+kn*kn-nt*nt,In=-(En?(Pn+Math.sqrt(Pn*Pn-4*En*Dn))/(2*En):Dn/Pn);return{x:tt+mn+xn*In,y:rt+kn+Cn*In,r:In}}function place(Ne,Ge,Qe){var tt,rt,nt,at,it=Ne.x-Ge.x,ot=Ne.y-Ge.y,dt=it*it+ot*ot;dt?(rt=Ge.r+Qe.r,rt*=rt,at=Ne.r+Qe.r,rt>(at*=at)?(tt=(dt+at-rt)/(2*dt),nt=Math.sqrt(Math.max(0,at/dt-tt*tt)),Qe.x=Ne.x-tt*it-nt*ot,Qe.y=Ne.y-tt*ot+nt*it):(tt=(dt+rt-at)/(2*dt),nt=Math.sqrt(Math.max(0,rt/dt-tt*tt)),Qe.x=Ge.x+tt*it-nt*ot,Qe.y=Ge.y+tt*ot+nt*it)):(Qe.x=Ge.x+Qe.r,Qe.y=Ge.y)}function intersects(Ne,Ge){var Qe=Ne.r+Ge.r-1e-6,tt=Ge.x-Ne.x,rt=Ge.y-Ne.y;return Qe>0&&Qe*Qe>tt*tt+rt*rt}function score(Ne){var Ge=Ne._,Qe=Ne.next._,tt=Ge.r+Qe.r,rt=(Ge.x*Qe.r+Qe.x*Ge.r)/tt,nt=(Ge.y*Qe.r+Qe.y*Ge.r)/tt;return rt*rt+nt*nt}function Node$1(Ne){this._=Ne,this.next=null,this.previous=null}function packEnclose(Ne){if(!(rt=Ne.length))return 0;var Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt;if((Ge=Ne[0]).x=0,Ge.y=0,!(rt>1))return Ge.r;if(Qe=Ne[1],Ge.x=-Qe.r,Qe.x=Ge.r,Qe.y=0,!(rt>2))return Ge.r+Qe.r;place(Qe,Ge,tt=Ne[2]),Ge=new Node$1(Ge),Qe=new Node$1(Qe),tt=new Node$1(tt),Ge.next=tt.previous=Qe,Qe.next=Ge.previous=tt,tt.next=Qe.previous=Ge;e:for(it=3;it<rt;++it){place(Ge._,Qe._,tt=Ne[it]),tt=new Node$1(tt),ot=Qe.next,dt=Ge.previous,ht=Qe._.r,Dt=Ge._.r;do{if(ht<=Dt){if(intersects(ot._,tt._)){Qe=ot,Ge.next=Qe,Qe.previous=Ge,--it;continue e}ht+=ot._.r,ot=ot.next}else{if(intersects(dt._,tt._)){(Ge=dt).next=Qe,Qe.previous=Ge,--it;continue e}Dt+=dt._.r,dt=dt.previous}}while(ot!==dt.next);for(tt.previous=Ge,tt.next=Qe,Ge.next=Qe.previous=Qe=tt,nt=score(Ge);(tt=tt.next)!==Qe;)(at=score(tt))<nt&&(Ge=tt,nt=at);Qe=Ge.next}for(Ge=[Qe._],tt=Qe;(tt=tt.next)!==Qe;)Ge.push(tt._);for(tt=enclose(Ge),it=0;it<rt;++it)(Ge=Ne[it]).x-=tt.x,Ge.y-=tt.y;return tt.r}function siblings(Ne){return packEnclose(Ne),Ne}function optional(Ne){return null==Ne?null:required(Ne)}function required(Ne){if("function"!=typeof Ne)throw new Error;return Ne}function constantZero(){return 0}function constant(Ne){return function(){return Ne}}function defaultRadius(Ne){return Math.sqrt(Ne.value)}function index(){var Ne=null,Ge=1,Qe=1,tt=constantZero;function pack(rt){return rt.x=Ge/2,rt.y=Qe/2,Ne?rt.eachBefore(radiusLeaf(Ne)).eachAfter(packChildren(tt,.5)).eachBefore(translateChild(1)):rt.eachBefore(radiusLeaf(defaultRadius)).eachAfter(packChildren(constantZero,1)).eachAfter(packChildren(tt,rt.r/Math.min(Ge,Qe))).eachBefore(translateChild(Math.min(Ge,Qe)/(2*rt.r))),rt}return pack.radius=function(Ge){return arguments.length?(Ne=optional(Ge),pack):Ne},pack.size=function(Ne){return arguments.length?(Ge=+Ne[0],Qe=+Ne[1],pack):[Ge,Qe]},pack.padding=function(Ne){return arguments.length?(tt="function"==typeof Ne?Ne:constant(+Ne),pack):tt},pack}function radiusLeaf(Ne){return function(Ge){Ge.children||(Ge.r=Math.max(0,+Ne(Ge)||0))}}function packChildren(Ne,Ge){return function(Qe){if(tt=Qe.children){var tt,rt,nt,at=tt.length,it=Ne(Qe)*Ge||0;if(it)for(rt=0;rt<at;++rt)tt[rt].r+=it;if(nt=packEnclose(tt),it)for(rt=0;rt<at;++rt)tt[rt].r-=it;Qe.r=nt+it}}}function translateChild(Ne){return function(Ge){var Qe=Ge.parent;Ge.r*=Ne,Qe&&(Ge.x=Qe.x+Ne*Ge.x,Ge.y=Qe.y+Ne*Ge.y)}}function roundNode(Ne){Ne.x0=Math.round(Ne.x0),Ne.y0=Math.round(Ne.y0),Ne.x1=Math.round(Ne.x1),Ne.y1=Math.round(Ne.y1)}function treemapDice(Ne,Ge,Qe,tt,rt){for(var nt,at=Ne.children,it=-1,ot=at.length,dt=Ne.value&&(tt-Ge)/Ne.value;++it<ot;)(nt=at[it]).y0=Qe,nt.y1=rt,nt.x0=Ge,nt.x1=Ge+=nt.value*dt}function partition(){var Ne=1,Ge=1,Qe=0,tt=!1;function partition(rt){var nt=rt.height+1;return rt.x0=rt.y0=Qe,rt.x1=Ne,rt.y1=Ge/nt,rt.eachBefore(positionNode(Ge,nt)),tt&&rt.eachBefore(roundNode),rt}function positionNode(Ne,Ge){return function(tt){tt.children&&treemapDice(tt,tt.x0,Ne*(tt.depth+1)/Ge,tt.x1,Ne*(tt.depth+2)/Ge);var rt=tt.x0,nt=tt.y0,at=tt.x1-Qe,it=tt.y1-Qe;at<rt&&(rt=at=(rt+at)/2),it<nt&&(nt=it=(nt+it)/2),tt.x0=rt,tt.y0=nt,tt.x1=at,tt.y1=it}}return partition.round=function(Ne){return arguments.length?(tt=!!Ne,partition):tt},partition.size=function(Qe){return arguments.length?(Ne=+Qe[0],Ge=+Qe[1],partition):[Ne,Ge]},partition.padding=function(Ne){return arguments.length?(Qe=+Ne,partition):Qe},partition}var Qe="$",tt={depth:-1},rt={};function defaultId(Ne){return Ne.id}function defaultParentId(Ne){return Ne.parentId}function stratify(){var Ne=defaultId,Ge=defaultParentId;function stratify(nt){var at,it,ot,dt,ht,Dt,Ot,Rt=nt.length,Zt=new Array(Rt),er={};for(it=0;it<Rt;++it)at=nt[it],ht=Zt[it]=new Node(at),null!=(Dt=Ne(at,it,nt))&&(Dt+="")&&(er[Ot=Qe+(ht.id=Dt)]=Ot in er?rt:ht);for(it=0;it<Rt;++it)if(ht=Zt[it],null!=(Dt=Ge(nt[it],it,nt))&&(Dt+="")){if(!(dt=er[Qe+Dt]))throw new Error("missing: "+Dt);if(dt===rt)throw new Error("ambiguous: "+Dt);dt.children?dt.children.push(ht):dt.children=[ht],ht.parent=dt}else{if(ot)throw new Error("multiple roots");ot=ht}if(!ot)throw new Error("no root");if(ot.parent=tt,ot.eachBefore((function(Ne){Ne.depth=Ne.parent.depth+1,--Rt})).eachBefore(computeHeight),ot.parent=null,Rt>0)throw new Error("cycle");return ot}return stratify.id=function(Ge){return arguments.length?(Ne=required(Ge),stratify):Ne},stratify.parentId=function(Ne){return arguments.length?(Ge=required(Ne),stratify):Ge},stratify}function defaultSeparation$1(Ne,Ge){return Ne.parent===Ge.parent?1:2}function nextLeft(Ne){var Ge=Ne.children;return Ge?Ge[0]:Ne.t}function nextRight(Ne){var Ge=Ne.children;return Ge?Ge[Ge.length-1]:Ne.t}function moveSubtree(Ne,Ge,Qe){var tt=Qe/(Ge.i-Ne.i);Ge.c-=tt,Ge.s+=Qe,Ne.c+=tt,Ge.z+=Qe,Ge.m+=Qe}function executeShifts(Ne){for(var Ge,Qe=0,tt=0,rt=Ne.children,nt=rt.length;--nt>=0;)(Ge=rt[nt]).z+=Qe,Ge.m+=Qe,Qe+=Ge.s+(tt+=Ge.c)}function nextAncestor(Ne,Ge,Qe){return Ne.a.parent===Ge.parent?Ne.a:Qe}function TreeNode(Ne,Ge){this._=Ne,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=Ge}function treeRoot(Ne){for(var Ge,Qe,tt,rt,nt,at=new TreeNode(Ne,0),it=[at];Ge=it.pop();)if(tt=Ge._.children)for(Ge.children=new Array(nt=tt.length),rt=nt-1;rt>=0;--rt)it.push(Qe=Ge.children[rt]=new TreeNode(tt[rt],rt)),Qe.parent=Ge;return(at.parent=new TreeNode(null,0)).children=[at],at}function tree(){var Ne=defaultSeparation$1,Ge=1,Qe=1,tt=null;function tree(rt){var nt=treeRoot(rt);if(nt.eachAfter(firstWalk),nt.parent.m=-nt.z,nt.eachBefore(secondWalk),tt)rt.eachBefore(sizeNode);else{var at=rt,it=rt,ot=rt;rt.eachBefore((function(Ne){Ne.x<at.x&&(at=Ne),Ne.x>it.x&&(it=Ne),Ne.depth>ot.depth&&(ot=Ne)}));var dt=at===it?1:Ne(at,it)/2,ht=dt-at.x,Dt=Ge/(it.x+dt+ht),Ot=Qe/(ot.depth||1);rt.eachBefore((function(Ne){Ne.x=(Ne.x+ht)*Dt,Ne.y=Ne.depth*Ot}))}return rt}function firstWalk(Ge){var Qe=Ge.children,tt=Ge.parent.children,rt=Ge.i?tt[Ge.i-1]:null;if(Qe){executeShifts(Ge);var nt=(Qe[0].z+Qe[Qe.length-1].z)/2;rt?(Ge.z=rt.z+Ne(Ge._,rt._),Ge.m=Ge.z-nt):Ge.z=nt}else rt&&(Ge.z=rt.z+Ne(Ge._,rt._));Ge.parent.A=apportion(Ge,rt,Ge.parent.A||tt[0])}function secondWalk(Ne){Ne._.x=Ne.z+Ne.parent.m,Ne.m+=Ne.parent.m}function apportion(Ge,Qe,tt){if(Qe){for(var rt,nt=Ge,at=Ge,it=Qe,ot=nt.parent.children[0],dt=nt.m,ht=at.m,Dt=it.m,Ot=ot.m;it=nextRight(it),nt=nextLeft(nt),it&&nt;)ot=nextLeft(ot),(at=nextRight(at)).a=Ge,(rt=it.z+Dt-nt.z-dt+Ne(it._,nt._))>0&&(moveSubtree(nextAncestor(it,Ge,tt),Ge,rt),dt+=rt,ht+=rt),Dt+=it.m,dt+=nt.m,Ot+=ot.m,ht+=at.m;it&&!nextRight(at)&&(at.t=it,at.m+=Dt-ht),nt&&!nextLeft(ot)&&(ot.t=nt,ot.m+=dt-Ot,tt=Ge)}return tt}function sizeNode(Ne){Ne.x*=Ge,Ne.y=Ne.depth*Qe}return tree.separation=function(Ge){return arguments.length?(Ne=Ge,tree):Ne},tree.size=function(Ne){return arguments.length?(tt=!1,Ge=+Ne[0],Qe=+Ne[1],tree):tt?null:[Ge,Qe]},tree.nodeSize=function(Ne){return arguments.length?(tt=!0,Ge=+Ne[0],Qe=+Ne[1],tree):tt?[Ge,Qe]:null},tree}function treemapSlice(Ne,Ge,Qe,tt,rt){for(var nt,at=Ne.children,it=-1,ot=at.length,dt=Ne.value&&(rt-Qe)/Ne.value;++it<ot;)(nt=at[it]).x0=Ge,nt.x1=tt,nt.y0=Qe,nt.y1=Qe+=nt.value*dt}TreeNode.prototype=Object.create(Node.prototype);var nt=(1+Math.sqrt(5))/2;function squarifyRatio(Ne,Ge,Qe,tt,rt,nt){for(var at,it,ot,dt,ht,Dt,Ot,Rt,Zt,er,dr,mr=[],xr=Ge.children,br=0,Ar=0,en=xr.length,mn=Ge.value;br<en;){ot=rt-Qe,dt=nt-tt;do{ht=xr[Ar++].value}while(!ht&&Ar<en);for(Dt=Ot=ht,dr=ht*ht*(er=Math.max(dt/ot,ot/dt)/(mn*Ne)),Zt=Math.max(Ot/dr,dr/Dt);Ar<en;++Ar){if(ht+=it=xr[Ar].value,it<Dt&&(Dt=it),it>Ot&&(Ot=it),dr=ht*ht*er,(Rt=Math.max(Ot/dr,dr/Dt))>Zt){ht-=it;break}Zt=Rt}mr.push(at={value:ht,dice:ot<dt,children:xr.slice(br,Ar)}),at.dice?treemapDice(at,Qe,tt,rt,mn?tt+=dt*ht/mn:nt):treemapSlice(at,Qe,tt,mn?Qe+=ot*ht/mn:rt,nt),mn-=ht,br=Ar}return mr}var at=function custom(Ne){function squarify(Ge,Qe,tt,rt,nt){squarifyRatio(Ne,Ge,Qe,tt,rt,nt)}return squarify.ratio=function(Ne){return custom((Ne=+Ne)>1?Ne:1)},squarify}(nt);function index$1(){var Ne=at,Ge=!1,Qe=1,tt=1,rt=[0],nt=constantZero,it=constantZero,ot=constantZero,dt=constantZero,ht=constantZero;function treemap(Ne){return Ne.x0=Ne.y0=0,Ne.x1=Qe,Ne.y1=tt,Ne.eachBefore(positionNode),rt=[0],Ge&&Ne.eachBefore(roundNode),Ne}function positionNode(Ge){var Qe=rt[Ge.depth],tt=Ge.x0+Qe,at=Ge.y0+Qe,Dt=Ge.x1-Qe,Ot=Ge.y1-Qe;Dt<tt&&(tt=Dt=(tt+Dt)/2),Ot<at&&(at=Ot=(at+Ot)/2),Ge.x0=tt,Ge.y0=at,Ge.x1=Dt,Ge.y1=Ot,Ge.children&&(Qe=rt[Ge.depth+1]=nt(Ge)/2,tt+=ht(Ge)-Qe,at+=it(Ge)-Qe,(Dt-=ot(Ge)-Qe)<tt&&(tt=Dt=(tt+Dt)/2),(Ot-=dt(Ge)-Qe)<at&&(at=Ot=(at+Ot)/2),Ne(Ge,tt,at,Dt,Ot))}return treemap.round=function(Ne){return arguments.length?(Ge=!!Ne,treemap):Ge},treemap.size=function(Ne){return arguments.length?(Qe=+Ne[0],tt=+Ne[1],treemap):[Qe,tt]},treemap.tile=function(Ge){return arguments.length?(Ne=required(Ge),treemap):Ne},treemap.padding=function(Ne){return arguments.length?treemap.paddingInner(Ne).paddingOuter(Ne):treemap.paddingInner()},treemap.paddingInner=function(Ne){return arguments.length?(nt="function"==typeof Ne?Ne:constant(+Ne),treemap):nt},treemap.paddingOuter=function(Ne){return arguments.length?treemap.paddingTop(Ne).paddingRight(Ne).paddingBottom(Ne).paddingLeft(Ne):treemap.paddingTop()},treemap.paddingTop=function(Ne){return arguments.length?(it="function"==typeof Ne?Ne:constant(+Ne),treemap):it},treemap.paddingRight=function(Ne){return arguments.length?(ot="function"==typeof Ne?Ne:constant(+Ne),treemap):ot},treemap.paddingBottom=function(Ne){return arguments.length?(dt="function"==typeof Ne?Ne:constant(+Ne),treemap):dt},treemap.paddingLeft=function(Ne){return arguments.length?(ht="function"==typeof Ne?Ne:constant(+Ne),treemap):ht},treemap}function binary(Ne,Ge,Qe,tt,rt){var nt,at,it=Ne.children,ot=it.length,dt=new Array(ot+1);for(dt[0]=at=nt=0;nt<ot;++nt)dt[nt+1]=at+=it[nt].value;function partition(Ne,Ge,Qe,tt,rt,nt,at){if(Ne>=Ge-1){var ot=it[Ne];return ot.x0=tt,ot.y0=rt,ot.x1=nt,void(ot.y1=at)}for(var ht=dt[Ne],Dt=Qe/2+ht,Ot=Ne+1,Rt=Ge-1;Ot<Rt;){var Zt=Ot+Rt>>>1;dt[Zt]<Dt?Ot=Zt+1:Rt=Zt}Dt-dt[Ot-1]<dt[Ot]-Dt&&Ne+1<Ot&&--Ot;var er=dt[Ot]-ht,dr=Qe-er;if(nt-tt>at-rt){var mr=(tt*dr+nt*er)/Qe;partition(Ne,Ot,er,tt,rt,mr,at),partition(Ot,Ge,dr,mr,rt,nt,at)}else{var xr=(rt*dr+at*er)/Qe;partition(Ne,Ot,er,tt,rt,nt,xr),partition(Ot,Ge,dr,tt,xr,nt,at)}}partition(0,ot,Ne.value,Ge,Qe,tt,rt)}function sliceDice(Ne,Ge,Qe,tt,rt){(1&Ne.depth?treemapSlice:treemapDice)(Ne,Ge,Qe,tt,rt)}var it=function custom(Ne){function resquarify(Ge,Qe,tt,rt,nt){if((at=Ge._squarify)&&at.ratio===Ne)for(var at,it,ot,dt,ht,Dt=-1,Ot=at.length,Rt=Ge.value;++Dt<Ot;){for(ot=(it=at[Dt]).children,dt=it.value=0,ht=ot.length;dt<ht;++dt)it.value+=ot[dt].value;it.dice?treemapDice(it,Qe,tt,rt,tt+=(nt-tt)*it.value/Rt):treemapSlice(it,Qe,tt,Qe+=(rt-Qe)*it.value/Rt,nt),Rt-=it.value}else Ge._squarify=at=squarifyRatio(Ne,Ge,Qe,tt,rt,nt),at.ratio=Ne}return resquarify.ratio=function(Ne){return custom((Ne=+Ne)>1?Ne:1)},resquarify}(nt);Ne.cluster=cluster,Ne.hierarchy=hierarchy,Ne.pack=index,Ne.packEnclose=enclose,Ne.packSiblings=siblings,Ne.partition=partition,Ne.stratify=stratify,Ne.tree=tree,Ne.treemap=index$1,Ne.treemapBinary=binary,Ne.treemapDice=treemapDice,Ne.treemapResquarify=it,Ne.treemapSlice=treemapSlice,Ne.treemapSliceDice=sliceDice,Ne.treemapSquarify=at,Object.defineProperty(Ne,"__esModule",{value:!0})},"object"==typeof Qe&&void 0!==Ge?nt(Qe):"function"==typeof tt&&tt.amd?tt(["exports"],nt):nt((rt=rt||self).d3=rt.d3||{})},{}],162:[function(Ne,Ge,Qe){var rt,nt;rt=this,nt=function(Ne,Ge){"use strict";function basis(Ne,Ge,Qe,tt,rt){var nt=Ne*Ne,at=nt*Ne;return((1-3*Ne+3*nt-at)*Ge+(4-6*nt+3*at)*Qe+(1+3*Ne+3*nt-3*at)*tt+at*rt)/6}function basis$1(Ne){var Ge=Ne.length-1;return function(Qe){var tt=Qe<=0?Qe=0:Qe>=1?(Qe=1,Ge-1):Math.floor(Qe*Ge),rt=Ne[tt],nt=Ne[tt+1],at=tt>0?Ne[tt-1]:2*rt-nt,it=tt<Ge-1?Ne[tt+2]:2*nt-rt;return basis((Qe-tt/Ge)*Ge,at,rt,nt,it)}}function basisClosed(Ne){var Ge=Ne.length;return function(Qe){var tt=Math.floor(((Qe%=1)<0?++Qe:Qe)*Ge),rt=Ne[(tt+Ge-1)%Ge],nt=Ne[tt%Ge],at=Ne[(tt+1)%Ge],it=Ne[(tt+2)%Ge];return basis((Qe-tt/Ge)*Ge,rt,nt,at,it)}}function constant(Ne){return function(){return Ne}}function linear(Ne,Ge){return function(Qe){return Ne+Qe*Ge}}function exponential(Ne,Ge,Qe){return Ne=Math.pow(Ne,Qe),Ge=Math.pow(Ge,Qe)-Ne,Qe=1/Qe,function(tt){return Math.pow(Ne+tt*Ge,Qe)}}function hue(Ne,Ge){var Qe=Ge-Ne;return Qe?linear(Ne,Qe>180||Qe<-180?Qe-360*Math.round(Qe/360):Qe):constant(isNaN(Ne)?Ge:Ne)}function gamma(Ne){return 1==(Ne=+Ne)?nogamma:function(Ge,Qe){return Qe-Ge?exponential(Ge,Qe,Ne):constant(isNaN(Ge)?Qe:Ge)}}function nogamma(Ne,Ge){var Qe=Ge-Ne;return Qe?linear(Ne,Qe):constant(isNaN(Ne)?Ge:Ne)}var Qe=function rgbGamma(Ne){var Qe=gamma(Ne);function rgb(Ne,tt){var rt=Qe((Ne=Ge.rgb(Ne)).r,(tt=Ge.rgb(tt)).r),nt=Qe(Ne.g,tt.g),at=Qe(Ne.b,tt.b),it=nogamma(Ne.opacity,tt.opacity);return function(Ge){return Ne.r=rt(Ge),Ne.g=nt(Ge),Ne.b=at(Ge),Ne.opacity=it(Ge),Ne+""}}return rgb.gamma=rgbGamma,rgb}(1);function rgbSpline(Ne){return function(Qe){var tt,rt,nt=Qe.length,at=new Array(nt),it=new Array(nt),ot=new Array(nt);for(tt=0;tt<nt;++tt)rt=Ge.rgb(Qe[tt]),at[tt]=rt.r||0,it[tt]=rt.g||0,ot[tt]=rt.b||0;return at=Ne(at),it=Ne(it),ot=Ne(ot),rt.opacity=1,function(Ne){return rt.r=at(Ne),rt.g=it(Ne),rt.b=ot(Ne),rt+""}}}var tt=rgbSpline(basis$1),rt=rgbSpline(basisClosed);function numberArray(Ne,Ge){Ge||(Ge=[]);var Qe,tt=Ne?Math.min(Ge.length,Ne.length):0,rt=Ge.slice();return function(nt){for(Qe=0;Qe<tt;++Qe)rt[Qe]=Ne[Qe]*(1-nt)+Ge[Qe]*nt;return rt}}function isNumberArray(Ne){return ArrayBuffer.isView(Ne)&&!(Ne instanceof DataView)}function array(Ne,Ge){return(isNumberArray(Ge)?numberArray:genericArray)(Ne,Ge)}function genericArray(Ne,Ge){var Qe,tt=Ge?Ge.length:0,rt=Ne?Math.min(tt,Ne.length):0,nt=new Array(rt),at=new Array(tt);for(Qe=0;Qe<rt;++Qe)nt[Qe]=value(Ne[Qe],Ge[Qe]);for(;Qe<tt;++Qe)at[Qe]=Ge[Qe];return function(Ne){for(Qe=0;Qe<rt;++Qe)at[Qe]=nt[Qe](Ne);return at}}function date(Ne,Ge){var Qe=new Date;return Ne=+Ne,Ge=+Ge,function(tt){return Qe.setTime(Ne*(1-tt)+Ge*tt),Qe}}function number(Ne,Ge){return Ne=+Ne,Ge=+Ge,function(Qe){return Ne*(1-Qe)+Ge*Qe}}function object(Ne,Ge){var Qe,tt={},rt={};for(Qe in null!==Ne&&"object"==typeof Ne||(Ne={}),null!==Ge&&"object"==typeof Ge||(Ge={}),Ge)Qe in Ne?tt[Qe]=value(Ne[Qe],Ge[Qe]):rt[Qe]=Ge[Qe];return function(Ne){for(Qe in tt)rt[Qe]=tt[Qe](Ne);return rt}}var nt=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,at=new RegExp(nt.source,"g");function zero(Ne){return function(){return Ne}}function one(Ne){return function(Ge){return Ne(Ge)+""}}function string(Ne,Ge){var Qe,tt,rt,it=nt.lastIndex=at.lastIndex=0,ot=-1,dt=[],ht=[];for(Ne+="",Ge+="";(Qe=nt.exec(Ne))&&(tt=at.exec(Ge));)(rt=tt.index)>it&&(rt=Ge.slice(it,rt),dt[ot]?dt[ot]+=rt:dt[++ot]=rt),(Qe=Qe[0])===(tt=tt[0])?dt[ot]?dt[ot]+=tt:dt[++ot]=tt:(dt[++ot]=null,ht.push({i:ot,x:number(Qe,tt)})),it=at.lastIndex;return it<Ge.length&&(rt=Ge.slice(it),dt[ot]?dt[ot]+=rt:dt[++ot]=rt),dt.length<2?ht[0]?one(ht[0].x):zero(Ge):(Ge=ht.length,function(Ne){for(var Qe,tt=0;tt<Ge;++tt)dt[(Qe=ht[tt]).i]=Qe.x(Ne);return dt.join("")})}function value(Ne,tt){var rt,nt=typeof tt;return null==tt||"boolean"===nt?constant(tt):("number"===nt?number:"string"===nt?(rt=Ge.color(tt))?(tt=rt,Qe):string:tt instanceof Ge.color?Qe:tt instanceof Date?date:isNumberArray(tt)?numberArray:Array.isArray(tt)?genericArray:"function"!=typeof tt.valueOf&&"function"!=typeof tt.toString||isNaN(tt)?object:number)(Ne,tt)}function discrete(Ne){var Ge=Ne.length;return function(Qe){return Ne[Math.max(0,Math.min(Ge-1,Math.floor(Qe*Ge)))]}}function hue$1(Ne,Ge){var Qe=hue(+Ne,+Ge);return function(Ne){var Ge=Qe(Ne);return Ge-360*Math.floor(Ge/360)}}function round(Ne,Ge){return Ne=+Ne,Ge=+Ge,function(Qe){return Math.round(Ne*(1-Qe)+Ge*Qe)}}var it,ot,dt,ht,Dt=180/Math.PI,Ot={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function decompose(Ne,Ge,Qe,tt,rt,nt){var at,it,ot;return(at=Math.sqrt(Ne*Ne+Ge*Ge))&&(Ne/=at,Ge/=at),(ot=Ne*Qe+Ge*tt)&&(Qe-=Ne*ot,tt-=Ge*ot),(it=Math.sqrt(Qe*Qe+tt*tt))&&(Qe/=it,tt/=it,ot/=it),Ne*tt<Ge*Qe&&(Ne=-Ne,Ge=-Ge,ot=-ot,at=-at),{translateX:rt,translateY:nt,rotate:Math.atan2(Ge,Ne)*Dt,skewX:Math.atan(ot)*Dt,scaleX:at,scaleY:it}}function parseCss(Ne){return"none"===Ne?Ot:(it||(it=document.createElement("DIV"),ot=document.documentElement,dt=document.defaultView),it.style.transform=Ne,Ne=dt.getComputedStyle(ot.appendChild(it),null).getPropertyValue("transform"),ot.removeChild(it),decompose(+(Ne=Ne.slice(7,-1).split(","))[0],+Ne[1],+Ne[2],+Ne[3],+Ne[4],+Ne[5]))}function parseSvg(Ne){return null==Ne?Ot:(ht||(ht=document.createElementNS("http://www.w3.org/2000/svg","g")),ht.setAttribute("transform",Ne),(Ne=ht.transform.baseVal.consolidate())?decompose((Ne=Ne.matrix).a,Ne.b,Ne.c,Ne.d,Ne.e,Ne.f):Ot)}function interpolateTransform(Ne,Ge,Qe,tt){function pop(Ne){return Ne.length?Ne.pop()+" ":""}function translate(Ne,tt,rt,nt,at,it){if(Ne!==rt||tt!==nt){var ot=at.push("translate(",null,Ge,null,Qe);it.push({i:ot-4,x:number(Ne,rt)},{i:ot-2,x:number(tt,nt)})}else(rt||nt)&&at.push("translate("+rt+Ge+nt+Qe)}function rotate(Ne,Ge,Qe,rt){Ne!==Ge?(Ne-Ge>180?Ge+=360:Ge-Ne>180&&(Ne+=360),rt.push({i:Qe.push(pop(Qe)+"rotate(",null,tt)-2,x:number(Ne,Ge)})):Ge&&Qe.push(pop(Qe)+"rotate("+Ge+tt)}function skewX(Ne,Ge,Qe,rt){Ne!==Ge?rt.push({i:Qe.push(pop(Qe)+"skewX(",null,tt)-2,x:number(Ne,Ge)}):Ge&&Qe.push(pop(Qe)+"skewX("+Ge+tt)}function scale(Ne,Ge,Qe,tt,rt,nt){if(Ne!==Qe||Ge!==tt){var at=rt.push(pop(rt)+"scale(",null,",",null,")");nt.push({i:at-4,x:number(Ne,Qe)},{i:at-2,x:number(Ge,tt)})}else 1===Qe&&1===tt||rt.push(pop(rt)+"scale("+Qe+","+tt+")")}return function(Ge,Qe){var tt=[],rt=[];return Ge=Ne(Ge),Qe=Ne(Qe),translate(Ge.translateX,Ge.translateY,Qe.translateX,Qe.translateY,tt,rt),rotate(Ge.rotate,Qe.rotate,tt,rt),skewX(Ge.skewX,Qe.skewX,tt,rt),scale(Ge.scaleX,Ge.scaleY,Qe.scaleX,Qe.scaleY,tt,rt),Ge=Qe=null,function(Ne){for(var Ge,Qe=-1,nt=rt.length;++Qe<nt;)tt[(Ge=rt[Qe]).i]=Ge.x(Ne);return tt.join("")}}}var Rt=interpolateTransform(parseCss,"px, ","px)","deg)"),Zt=interpolateTransform(parseSvg,", ",")",")"),er=Math.SQRT2,dr=2,mr=4,xr=1e-12;function cosh(Ne){return((Ne=Math.exp(Ne))+1/Ne)/2}function sinh(Ne){return((Ne=Math.exp(Ne))-1/Ne)/2}function tanh(Ne){return((Ne=Math.exp(2*Ne))-1)/(Ne+1)}function zoom(Ne,Ge){var Qe,tt,rt=Ne[0],nt=Ne[1],at=Ne[2],it=Ge[0],ot=Ge[1],dt=Ge[2],ht=it-rt,Dt=ot-nt,Ot=ht*ht+Dt*Dt;if(Ot<xr)tt=Math.log(dt/at)/er,Qe=function(Ne){return[rt+Ne*ht,nt+Ne*Dt,at*Math.exp(er*Ne*tt)]};else{var Rt=Math.sqrt(Ot),Zt=(dt*dt-at*at+mr*Ot)/(2*at*dr*Rt),br=(dt*dt-at*at-mr*Ot)/(2*dt*dr*Rt),Ar=Math.log(Math.sqrt(Zt*Zt+1)-Zt),en=Math.log(Math.sqrt(br*br+1)-br);tt=(en-Ar)/er,Qe=function(Ne){var Ge=Ne*tt,Qe=cosh(Ar),it=at/(dr*Rt)*(Qe*tanh(er*Ge+Ar)-sinh(Ar));return[rt+it*ht,nt+it*Dt,at*Qe/cosh(er*Ge+Ar)]}}return Qe.duration=1e3*tt,Qe}function hsl(Ne){return function(Qe,tt){var rt=Ne((Qe=Ge.hsl(Qe)).h,(tt=Ge.hsl(tt)).h),nt=nogamma(Qe.s,tt.s),at=nogamma(Qe.l,tt.l),it=nogamma(Qe.opacity,tt.opacity);return function(Ne){return Qe.h=rt(Ne),Qe.s=nt(Ne),Qe.l=at(Ne),Qe.opacity=it(Ne),Qe+""}}}var br=hsl(hue),Ar=hsl(nogamma);function lab(Ne,Qe){var tt=nogamma((Ne=Ge.lab(Ne)).l,(Qe=Ge.lab(Qe)).l),rt=nogamma(Ne.a,Qe.a),nt=nogamma(Ne.b,Qe.b),at=nogamma(Ne.opacity,Qe.opacity);return function(Ge){return Ne.l=tt(Ge),Ne.a=rt(Ge),Ne.b=nt(Ge),Ne.opacity=at(Ge),Ne+""}}function hcl(Ne){return function(Qe,tt){var rt=Ne((Qe=Ge.hcl(Qe)).h,(tt=Ge.hcl(tt)).h),nt=nogamma(Qe.c,tt.c),at=nogamma(Qe.l,tt.l),it=nogamma(Qe.opacity,tt.opacity);return function(Ne){return Qe.h=rt(Ne),Qe.c=nt(Ne),Qe.l=at(Ne),Qe.opacity=it(Ne),Qe+""}}}var en=hcl(hue),mn=hcl(nogamma);function cubehelix(Ne){return function cubehelixGamma(Qe){function cubehelix(tt,rt){var nt=Ne((tt=Ge.cubehelix(tt)).h,(rt=Ge.cubehelix(rt)).h),at=nogamma(tt.s,rt.s),it=nogamma(tt.l,rt.l),ot=nogamma(tt.opacity,rt.opacity);return function(Ne){return tt.h=nt(Ne),tt.s=at(Ne),tt.l=it(Math.pow(Ne,Qe)),tt.opacity=ot(Ne),tt+""}}return Qe=+Qe,cubehelix.gamma=cubehelixGamma,cubehelix}(1)}var xn=cubehelix(hue),kn=cubehelix(nogamma);function piecewise(Ne,Ge){for(var Qe=0,tt=Ge.length-1,rt=Ge[0],nt=new Array(tt<0?0:tt);Qe<tt;)nt[Qe]=Ne(rt,rt=Ge[++Qe]);return function(Ne){var Ge=Math.max(0,Math.min(tt-1,Math.floor(Ne*=tt)));return nt[Ge](Ne-Ge)}}function quantize(Ne,Ge){for(var Qe=new Array(Ge),tt=0;tt<Ge;++tt)Qe[tt]=Ne(tt/(Ge-1));return Qe}Ne.interpolate=value,Ne.interpolateArray=array,Ne.interpolateBasis=basis$1,Ne.interpolateBasisClosed=basisClosed,Ne.interpolateCubehelix=xn,Ne.interpolateCubehelixLong=kn,Ne.interpolateDate=date,Ne.interpolateDiscrete=discrete,Ne.interpolateHcl=en,Ne.interpolateHclLong=mn,Ne.interpolateHsl=br,Ne.interpolateHslLong=Ar,Ne.interpolateHue=hue$1,Ne.interpolateLab=lab,Ne.interpolateNumber=number,Ne.interpolateNumberArray=numberArray,Ne.interpolateObject=object,Ne.interpolateRgb=Qe,Ne.interpolateRgbBasis=tt,Ne.interpolateRgbBasisClosed=rt,Ne.interpolateRound=round,Ne.interpolateString=string,Ne.interpolateTransformCss=Rt,Ne.interpolateTransformSvg=Zt,Ne.interpolateZoom=zoom,Ne.piecewise=piecewise,Ne.quantize=quantize,Object.defineProperty(Ne,"__esModule",{value:!0})},"object"==typeof Qe&&void 0!==Ge?nt(Qe,Ne("d3-color")):"function"==typeof tt&&tt.amd?tt(["exports","d3-color"],nt):nt((rt=rt||self).d3=rt.d3||{},rt.d3)},{"d3-color":158}],163:[function(Ne,Ge,Qe){var rt,nt;rt=this,nt=function(Ne){"use strict";var Ge=Math.PI,Qe=2*Ge,tt=1e-6,rt=Qe-tt;function Path(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function path(){return new Path}Path.prototype=path.prototype={constructor:Path,moveTo:function(Ne,Ge){this._+="M"+(this._x0=this._x1=+Ne)+","+(this._y0=this._y1=+Ge)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(Ne,Ge){this._+="L"+(this._x1=+Ne)+","+(this._y1=+Ge)},quadraticCurveTo:function(Ne,Ge,Qe,tt){this._+="Q"+ +Ne+","+ +Ge+","+(this._x1=+Qe)+","+(this._y1=+tt)},bezierCurveTo:function(Ne,Ge,Qe,tt,rt,nt){this._+="C"+ +Ne+","+ +Ge+","+ +Qe+","+ +tt+","+(this._x1=+rt)+","+(this._y1=+nt)},arcTo:function(Ne,Qe,rt,nt,at){Ne=+Ne,Qe=+Qe,rt=+rt,nt=+nt,at=+at;var it=this._x1,ot=this._y1,dt=rt-Ne,ht=nt-Qe,Dt=it-Ne,Ot=ot-Qe,Rt=Dt*Dt+Ot*Ot;if(at<0)throw new Error("negative radius: "+at);if(null===this._x1)this._+="M"+(this._x1=Ne)+","+(this._y1=Qe);else if(Rt>tt)if(Math.abs(Ot*dt-ht*Dt)>tt&&at){var Zt=rt-it,er=nt-ot,dr=dt*dt+ht*ht,mr=Zt*Zt+er*er,xr=Math.sqrt(dr),br=Math.sqrt(Rt),Ar=at*Math.tan((Ge-Math.acos((dr+Rt-mr)/(2*xr*br)))/2),en=Ar/br,mn=Ar/xr;Math.abs(en-1)>tt&&(this._+="L"+(Ne+en*Dt)+","+(Qe+en*Ot)),this._+="A"+at+","+at+",0,0,"+ +(Ot*Zt>Dt*er)+","+(this._x1=Ne+mn*dt)+","+(this._y1=Qe+mn*ht)}else this._+="L"+(this._x1=Ne)+","+(this._y1=Qe)},arc:function(Ne,nt,at,it,ot,dt){Ne=+Ne,nt=+nt,dt=!!dt;var ht=(at=+at)*Math.cos(it),Dt=at*Math.sin(it),Ot=Ne+ht,Rt=nt+Dt,Zt=1^dt,er=dt?it-ot:ot-it;if(at<0)throw new Error("negative radius: "+at);null===this._x1?this._+="M"+Ot+","+Rt:(Math.abs(this._x1-Ot)>tt||Math.abs(this._y1-Rt)>tt)&&(this._+="L"+Ot+","+Rt),at&&(er<0&&(er=er%Qe+Qe),er>rt?this._+="A"+at+","+at+",0,1,"+Zt+","+(Ne-ht)+","+(nt-Dt)+"A"+at+","+at+",0,1,"+Zt+","+(this._x1=Ot)+","+(this._y1=Rt):er>tt&&(this._+="A"+at+","+at+",0,"+ +(er>=Ge)+","+Zt+","+(this._x1=Ne+at*Math.cos(ot))+","+(this._y1=nt+at*Math.sin(ot))))},rect:function(Ne,Ge,Qe,tt){this._+="M"+(this._x0=this._x1=+Ne)+","+(this._y0=this._y1=+Ge)+"h"+ +Qe+"v"+ +tt+"h"+-Qe+"Z"},toString:function(){return this._}},Ne.path=path,Object.defineProperty(Ne,"__esModule",{value:!0})},"object"==typeof Qe&&void 0!==Ge?nt(Qe):"function"==typeof tt&&tt.amd?tt(["exports"],nt):nt((rt=rt||self).d3=rt.d3||{})},{}],164:[function(Ne,Ge,Qe){var rt,nt;rt=this,nt=function(Ne){"use strict";function tree_add(Ne){var Ge=+this._x.call(null,Ne),Qe=+this._y.call(null,Ne);return add(this.cover(Ge,Qe),Ge,Qe,Ne)}function add(Ne,Ge,Qe,tt){if(isNaN(Ge)||isNaN(Qe))return Ne;var rt,nt,at,it,ot,dt,ht,Dt,Ot,Rt=Ne._root,Zt={data:tt},er=Ne._x0,dr=Ne._y0,mr=Ne._x1,xr=Ne._y1;if(!Rt)return Ne._root=Zt,Ne;for(;Rt.length;)if((dt=Ge>=(nt=(er+mr)/2))?er=nt:mr=nt,(ht=Qe>=(at=(dr+xr)/2))?dr=at:xr=at,rt=Rt,!(Rt=Rt[Dt=ht<<1|dt]))return rt[Dt]=Zt,Ne;if(it=+Ne._x.call(null,Rt.data),ot=+Ne._y.call(null,Rt.data),Ge===it&&Qe===ot)return Zt.next=Rt,rt?rt[Dt]=Zt:Ne._root=Zt,Ne;do{rt=rt?rt[Dt]=new Array(4):Ne._root=new Array(4),(dt=Ge>=(nt=(er+mr)/2))?er=nt:mr=nt,(ht=Qe>=(at=(dr+xr)/2))?dr=at:xr=at}while((Dt=ht<<1|dt)==(Ot=(ot>=at)<<1|it>=nt));return rt[Ot]=Rt,rt[Dt]=Zt,Ne}function addAll(Ne){var Ge,Qe,tt,rt,nt=Ne.length,at=new Array(nt),it=new Array(nt),ot=1/0,dt=1/0,ht=-1/0,Dt=-1/0;for(Qe=0;Qe<nt;++Qe)isNaN(tt=+this._x.call(null,Ge=Ne[Qe]))||isNaN(rt=+this._y.call(null,Ge))||(at[Qe]=tt,it[Qe]=rt,tt<ot&&(ot=tt),tt>ht&&(ht=tt),rt<dt&&(dt=rt),rt>Dt&&(Dt=rt));if(ot>ht||dt>Dt)return this;for(this.cover(ot,dt).cover(ht,Dt),Qe=0;Qe<nt;++Qe)add(this,at[Qe],it[Qe],Ne[Qe]);return this}function tree_cover(Ne,Ge){if(isNaN(Ne=+Ne)||isNaN(Ge=+Ge))return this;var Qe=this._x0,tt=this._y0,rt=this._x1,nt=this._y1;if(isNaN(Qe))rt=(Qe=Math.floor(Ne))+1,nt=(tt=Math.floor(Ge))+1;else{for(var at,it,ot=rt-Qe,dt=this._root;Qe>Ne||Ne>=rt||tt>Ge||Ge>=nt;)switch(it=(Ge<tt)<<1|Ne<Qe,(at=new Array(4))[it]=dt,dt=at,ot*=2,it){case 0:rt=Qe+ot,nt=tt+ot;break;case 1:Qe=rt-ot,nt=tt+ot;break;case 2:rt=Qe+ot,tt=nt-ot;break;case 3:Qe=rt-ot,tt=nt-ot}this._root&&this._root.length&&(this._root=dt)}return this._x0=Qe,this._y0=tt,this._x1=rt,this._y1=nt,this}function tree_data(){var Ne=[];return this.visit((function(Ge){if(!Ge.length)do{Ne.push(Ge.data)}while(Ge=Ge.next)})),Ne}function tree_extent(Ne){return arguments.length?this.cover(+Ne[0][0],+Ne[0][1]).cover(+Ne[1][0],+Ne[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Quad(Ne,Ge,Qe,tt,rt){this.node=Ne,this.x0=Ge,this.y0=Qe,this.x1=tt,this.y1=rt}function tree_find(Ne,Ge,Qe){var tt,rt,nt,at,it,ot,dt,ht=this._x0,Dt=this._y0,Ot=this._x1,Rt=this._y1,Zt=[],er=this._root;for(er&&Zt.push(new Quad(er,ht,Dt,Ot,Rt)),null==Qe?Qe=1/0:(ht=Ne-Qe,Dt=Ge-Qe,Ot=Ne+Qe,Rt=Ge+Qe,Qe*=Qe);ot=Zt.pop();)if(!(!(er=ot.node)||(rt=ot.x0)>Ot||(nt=ot.y0)>Rt||(at=ot.x1)<ht||(it=ot.y1)<Dt))if(er.length){var dr=(rt+at)/2,mr=(nt+it)/2;Zt.push(new Quad(er[3],dr,mr,at,it),new Quad(er[2],rt,mr,dr,it),new Quad(er[1],dr,nt,at,mr),new Quad(er[0],rt,nt,dr,mr)),(dt=(Ge>=mr)<<1|Ne>=dr)&&(ot=Zt[Zt.length-1],Zt[Zt.length-1]=Zt[Zt.length-1-dt],Zt[Zt.length-1-dt]=ot)}else{var xr=Ne-+this._x.call(null,er.data),br=Ge-+this._y.call(null,er.data),Ar=xr*xr+br*br;if(Ar<Qe){var en=Math.sqrt(Qe=Ar);ht=Ne-en,Dt=Ge-en,Ot=Ne+en,Rt=Ge+en,tt=er.data}}return tt}function tree_remove(Ne){if(isNaN(nt=+this._x.call(null,Ne))||isNaN(at=+this._y.call(null,Ne)))return this;var Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt,Ot,Rt=this._root,Zt=this._x0,er=this._y0,dr=this._x1,mr=this._y1;if(!Rt)return this;if(Rt.length)for(;;){if((dt=nt>=(it=(Zt+dr)/2))?Zt=it:dr=it,(ht=at>=(ot=(er+mr)/2))?er=ot:mr=ot,Ge=Rt,!(Rt=Rt[Dt=ht<<1|dt]))return this;if(!Rt.length)break;(Ge[Dt+1&3]||Ge[Dt+2&3]||Ge[Dt+3&3])&&(Qe=Ge,Ot=Dt)}for(;Rt.data!==Ne;)if(tt=Rt,!(Rt=Rt.next))return this;return(rt=Rt.next)&&delete Rt.next,tt?(rt?tt.next=rt:delete tt.next,this):Ge?(rt?Ge[Dt]=rt:delete Ge[Dt],(Rt=Ge[0]||Ge[1]||Ge[2]||Ge[3])&&Rt===(Ge[3]||Ge[2]||Ge[1]||Ge[0])&&!Rt.length&&(Qe?Qe[Ot]=Rt:this._root=Rt),this):(this._root=rt,this)}function removeAll(Ne){for(var Ge=0,Qe=Ne.length;Ge<Qe;++Ge)this.remove(Ne[Ge]);return this}function tree_root(){return this._root}function tree_size(){var Ne=0;return this.visit((function(Ge){if(!Ge.length)do{++Ne}while(Ge=Ge.next)})),Ne}function tree_visit(Ne){var Ge,Qe,tt,rt,nt,at,it=[],ot=this._root;for(ot&&it.push(new Quad(ot,this._x0,this._y0,this._x1,this._y1));Ge=it.pop();)if(!Ne(ot=Ge.node,tt=Ge.x0,rt=Ge.y0,nt=Ge.x1,at=Ge.y1)&&ot.length){var dt=(tt+nt)/2,ht=(rt+at)/2;(Qe=ot[3])&&it.push(new Quad(Qe,dt,ht,nt,at)),(Qe=ot[2])&&it.push(new Quad(Qe,tt,ht,dt,at)),(Qe=ot[1])&&it.push(new Quad(Qe,dt,rt,nt,ht)),(Qe=ot[0])&&it.push(new Quad(Qe,tt,rt,dt,ht))}return this}function tree_visitAfter(Ne){var Ge,Qe=[],tt=[];for(this._root&&Qe.push(new Quad(this._root,this._x0,this._y0,this._x1,this._y1));Ge=Qe.pop();){var rt=Ge.node;if(rt.length){var nt,at=Ge.x0,it=Ge.y0,ot=Ge.x1,dt=Ge.y1,ht=(at+ot)/2,Dt=(it+dt)/2;(nt=rt[0])&&Qe.push(new Quad(nt,at,it,ht,Dt)),(nt=rt[1])&&Qe.push(new Quad(nt,ht,it,ot,Dt)),(nt=rt[2])&&Qe.push(new Quad(nt,at,Dt,ht,dt)),(nt=rt[3])&&Qe.push(new Quad(nt,ht,Dt,ot,dt))}tt.push(Ge)}for(;Ge=tt.pop();)Ne(Ge.node,Ge.x0,Ge.y0,Ge.x1,Ge.y1);return this}function defaultX(Ne){return Ne[0]}function tree_x(Ne){return arguments.length?(this._x=Ne,this):this._x}function defaultY(Ne){return Ne[1]}function tree_y(Ne){return arguments.length?(this._y=Ne,this):this._y}function quadtree(Ne,Ge,Qe){var tt=new Quadtree(null==Ge?defaultX:Ge,null==Qe?defaultY:Qe,NaN,NaN,NaN,NaN);return null==Ne?tt:tt.addAll(Ne)}function Quadtree(Ne,Ge,Qe,tt,rt,nt){this._x=Ne,this._y=Ge,this._x0=Qe,this._y0=tt,this._x1=rt,this._y1=nt,this._root=void 0}function leaf_copy(Ne){for(var Ge={data:Ne.data},Qe=Ge;Ne=Ne.next;)Qe=Qe.next={data:Ne.data};return Ge}var Ge=quadtree.prototype=Quadtree.prototype;Ge.copy=function(){var Ne,Ge,Qe=new Quadtree(this._x,this._y,this._x0,this._y0,this._x1,this._y1),tt=this._root;if(!tt)return Qe;if(!tt.length)return Qe._root=leaf_copy(tt),Qe;for(Ne=[{source:tt,target:Qe._root=new Array(4)}];tt=Ne.pop();)for(var rt=0;rt<4;++rt)(Ge=tt.source[rt])&&(Ge.length?Ne.push({source:Ge,target:tt.target[rt]=new Array(4)}):tt.target[rt]=leaf_copy(Ge));return Qe},Ge.add=tree_add,Ge.addAll=addAll,Ge.cover=tree_cover,Ge.data=tree_data,Ge.extent=tree_extent,Ge.find=tree_find,Ge.remove=tree_remove,Ge.removeAll=removeAll,Ge.root=tree_root,Ge.size=tree_size,Ge.visit=tree_visit,Ge.visitAfter=tree_visitAfter,Ge.x=tree_x,Ge.y=tree_y,Ne.quadtree=quadtree,Object.defineProperty(Ne,"__esModule",{value:!0})},"object"==typeof Qe&&void 0!==Ge?nt(Qe):"function"==typeof tt&&tt.amd?tt(["exports"],nt):nt((rt=rt||self).d3=rt.d3||{})},{}],165:[function(Ne,Ge,Qe){var rt,nt;rt=this,nt=function(Ne,Ge){"use strict";function constant(Ne){return function(){return Ne}}var Qe=Math.abs,tt=Math.atan2,rt=Math.cos,nt=Math.max,at=Math.min,it=Math.sin,ot=Math.sqrt,dt=1e-12,ht=Math.PI,Dt=ht/2,Ot=2*ht;function acos(Ne){return Ne>1?0:Ne<-1?ht:Math.acos(Ne)}function asin(Ne){return Ne>=1?Dt:Ne<=-1?-Dt:Math.asin(Ne)}function arcInnerRadius(Ne){return Ne.innerRadius}function arcOuterRadius(Ne){return Ne.outerRadius}function arcStartAngle(Ne){return Ne.startAngle}function arcEndAngle(Ne){return Ne.endAngle}function arcPadAngle(Ne){return Ne&&Ne.padAngle}function intersect(Ne,Ge,Qe,tt,rt,nt,at,it){var ot=Qe-Ne,ht=tt-Ge,Dt=at-rt,Ot=it-nt,Rt=Ot*ot-Dt*ht;if(!(Rt*Rt<dt))return[Ne+(Rt=(Dt*(Ge-nt)-Ot*(Ne-rt))/Rt)*ot,Ge+Rt*ht]}function cornerTangents(Ne,Ge,Qe,tt,rt,at,it){var dt=Ne-Qe,ht=Ge-tt,Dt=(it?at:-at)/ot(dt*dt+ht*ht),Ot=Dt*ht,Rt=-Dt*dt,Zt=Ne+Ot,er=Ge+Rt,dr=Qe+Ot,mr=tt+Rt,xr=(Zt+dr)/2,br=(er+mr)/2,Ar=dr-Zt,en=mr-er,mn=Ar*Ar+en*en,xn=rt-at,kn=Zt*mr-dr*er,Cn=(en<0?-1:1)*ot(nt(0,xn*xn*mn-kn*kn)),En=(kn*en-Ar*Cn)/mn,Pn=(-kn*Ar-en*Cn)/mn,Dn=(kn*en+Ar*Cn)/mn,In=(-kn*Ar+en*Cn)/mn,zn=En-xr,Bn=Pn-br,Vn=Dn-xr,Hn=In-br;return zn*zn+Bn*Bn>Vn*Vn+Hn*Hn&&(En=Dn,Pn=In),{cx:En,cy:Pn,x01:-Ot,y01:-Rt,x11:En*(rt/xn-1),y11:Pn*(rt/xn-1)}}function arc(){var Ne=arcInnerRadius,nt=arcOuterRadius,Rt=constant(0),Zt=null,er=arcStartAngle,dr=arcEndAngle,mr=arcPadAngle,xr=null;function arc(){var br,Ar,en=+Ne.apply(this,arguments),mn=+nt.apply(this,arguments),xn=er.apply(this,arguments)-Dt,kn=dr.apply(this,arguments)-Dt,Cn=Qe(kn-xn),En=kn>xn;if(xr||(xr=br=Ge.path()),mn<en&&(Ar=mn,mn=en,en=Ar),mn>dt)if(Cn>Ot-dt)xr.moveTo(mn*rt(xn),mn*it(xn)),xr.arc(0,0,mn,xn,kn,!En),en>dt&&(xr.moveTo(en*rt(kn),en*it(kn)),xr.arc(0,0,en,kn,xn,En));else{var Pn,Dn,In=xn,zn=kn,Bn=xn,Vn=kn,Hn=Cn,qn=Cn,Yn=mr.apply(this,arguments)/2,$n=Yn>dt&&(Zt?+Zt.apply(this,arguments):ot(en*en+mn*mn)),ra=at(Qe(mn-en)/2,+Rt.apply(this,arguments)),oa=ra,pa=ra;if($n>dt){var ga=asin($n/en*it(Yn)),ma=asin($n/mn*it(Yn));(Hn-=2*ga)>dt?(Bn+=ga*=En?1:-1,Vn-=ga):(Hn=0,Bn=Vn=(xn+kn)/2),(qn-=2*ma)>dt?(In+=ma*=En?1:-1,zn-=ma):(qn=0,In=zn=(xn+kn)/2)}var _a=mn*rt(In),Va=mn*it(In),Wa=en*rt(Vn),Qa=en*it(Vn);if(ra>dt){var ti,ni=mn*rt(zn),di=mn*it(zn),ji=en*rt(Bn),Hi=en*it(Bn);if(Cn<ht&&(ti=intersect(_a,Va,ji,Hi,ni,di,Wa,Qa))){var Yi=_a-ti[0],uo=Va-ti[1],go=ni-ti[0],ns=di-ti[1],as=1/it(acos((Yi*go+uo*ns)/(ot(Yi*Yi+uo*uo)*ot(go*go+ns*ns)))/2),is=ot(ti[0]*ti[0]+ti[1]*ti[1]);oa=at(ra,(en-is)/(as-1)),pa=at(ra,(mn-is)/(as+1))}}qn>dt?pa>dt?(Pn=cornerTangents(ji,Hi,_a,Va,mn,pa,En),Dn=cornerTangents(ni,di,Wa,Qa,mn,pa,En),xr.moveTo(Pn.cx+Pn.x01,Pn.cy+Pn.y01),pa<ra?xr.arc(Pn.cx,Pn.cy,pa,tt(Pn.y01,Pn.x01),tt(Dn.y01,Dn.x01),!En):(xr.arc(Pn.cx,Pn.cy,pa,tt(Pn.y01,Pn.x01),tt(Pn.y11,Pn.x11),!En),xr.arc(0,0,mn,tt(Pn.cy+Pn.y11,Pn.cx+Pn.x11),tt(Dn.cy+Dn.y11,Dn.cx+Dn.x11),!En),xr.arc(Dn.cx,Dn.cy,pa,tt(Dn.y11,Dn.x11),tt(Dn.y01,Dn.x01),!En))):(xr.moveTo(_a,Va),xr.arc(0,0,mn,In,zn,!En)):xr.moveTo(_a,Va),en>dt&&Hn>dt?oa>dt?(Pn=cornerTangents(Wa,Qa,ni,di,en,-oa,En),Dn=cornerTangents(_a,Va,ji,Hi,en,-oa,En),xr.lineTo(Pn.cx+Pn.x01,Pn.cy+Pn.y01),oa<ra?xr.arc(Pn.cx,Pn.cy,oa,tt(Pn.y01,Pn.x01),tt(Dn.y01,Dn.x01),!En):(xr.arc(Pn.cx,Pn.cy,oa,tt(Pn.y01,Pn.x01),tt(Pn.y11,Pn.x11),!En),xr.arc(0,0,en,tt(Pn.cy+Pn.y11,Pn.cx+Pn.x11),tt(Dn.cy+Dn.y11,Dn.cx+Dn.x11),En),xr.arc(Dn.cx,Dn.cy,oa,tt(Dn.y11,Dn.x11),tt(Dn.y01,Dn.x01),!En))):xr.arc(0,0,en,Vn,Bn,En):xr.lineTo(Wa,Qa)}else xr.moveTo(0,0);if(xr.closePath(),br)return xr=null,br+""||null}return arc.centroid=function(){var Ge=(+Ne.apply(this,arguments)+ +nt.apply(this,arguments))/2,Qe=(+er.apply(this,arguments)+ +dr.apply(this,arguments))/2-ht/2;return[rt(Qe)*Ge,it(Qe)*Ge]},arc.innerRadius=function(Ge){return arguments.length?(Ne="function"==typeof Ge?Ge:constant(+Ge),arc):Ne},arc.outerRadius=function(Ne){return arguments.length?(nt="function"==typeof Ne?Ne:constant(+Ne),arc):nt},arc.cornerRadius=function(Ne){return arguments.length?(Rt="function"==typeof Ne?Ne:constant(+Ne),arc):Rt},arc.padRadius=function(Ne){return arguments.length?(Zt=null==Ne?null:"function"==typeof Ne?Ne:constant(+Ne),arc):Zt},arc.startAngle=function(Ne){return arguments.length?(er="function"==typeof Ne?Ne:constant(+Ne),arc):er},arc.endAngle=function(Ne){return arguments.length?(dr="function"==typeof Ne?Ne:constant(+Ne),arc):dr},arc.padAngle=function(Ne){return arguments.length?(mr="function"==typeof Ne?Ne:constant(+Ne),arc):mr},arc.context=function(Ne){return arguments.length?(xr=null==Ne?null:Ne,arc):xr},arc}function Linear(Ne){this._context=Ne}function curveLinear(Ne){return new Linear(Ne)}function x(Ne){return Ne[0]}function y(Ne){return Ne[1]}function line(){var Ne=x,Qe=y,tt=constant(!0),rt=null,nt=curveLinear,at=null;function line(it){var ot,dt,ht,Dt=it.length,Ot=!1;for(null==rt&&(at=nt(ht=Ge.path())),ot=0;ot<=Dt;++ot)!(ot<Dt&&tt(dt=it[ot],ot,it))===Ot&&((Ot=!Ot)?at.lineStart():at.lineEnd()),Ot&&at.point(+Ne(dt,ot,it),+Qe(dt,ot,it));if(ht)return at=null,ht+""||null}return line.x=function(Ge){return arguments.length?(Ne="function"==typeof Ge?Ge:constant(+Ge),line):Ne},line.y=function(Ne){return arguments.length?(Qe="function"==typeof Ne?Ne:constant(+Ne),line):Qe},line.defined=function(Ne){return arguments.length?(tt="function"==typeof Ne?Ne:constant(!!Ne),line):tt},line.curve=function(Ne){return arguments.length?(nt=Ne,null!=rt&&(at=nt(rt)),line):nt},line.context=function(Ne){return arguments.length?(null==Ne?rt=at=null:at=nt(rt=Ne),line):rt},line}function area(){var Ne=x,Qe=null,tt=constant(0),rt=y,nt=constant(!0),at=null,it=curveLinear,ot=null;function area(dt){var ht,Dt,Ot,Rt,Zt,er=dt.length,dr=!1,mr=new Array(er),xr=new Array(er);for(null==at&&(ot=it(Zt=Ge.path())),ht=0;ht<=er;++ht){if(!(ht<er&&nt(Rt=dt[ht],ht,dt))===dr)if(dr=!dr)Dt=ht,ot.areaStart(),ot.lineStart();else{for(ot.lineEnd(),ot.lineStart(),Ot=ht-1;Ot>=Dt;--Ot)ot.point(mr[Ot],xr[Ot]);ot.lineEnd(),ot.areaEnd()}dr&&(mr[ht]=+Ne(Rt,ht,dt),xr[ht]=+tt(Rt,ht,dt),ot.point(Qe?+Qe(Rt,ht,dt):mr[ht],rt?+rt(Rt,ht,dt):xr[ht]))}if(Zt)return ot=null,Zt+""||null}function arealine(){return line().defined(nt).curve(it).context(at)}return area.x=function(Ge){return arguments.length?(Ne="function"==typeof Ge?Ge:constant(+Ge),Qe=null,area):Ne},area.x0=function(Ge){return arguments.length?(Ne="function"==typeof Ge?Ge:constant(+Ge),area):Ne},area.x1=function(Ne){return arguments.length?(Qe=null==Ne?null:"function"==typeof Ne?Ne:constant(+Ne),area):Qe},area.y=function(Ne){return arguments.length?(tt="function"==typeof Ne?Ne:constant(+Ne),rt=null,area):tt},area.y0=function(Ne){return arguments.length?(tt="function"==typeof Ne?Ne:constant(+Ne),area):tt},area.y1=function(Ne){return arguments.length?(rt=null==Ne?null:"function"==typeof Ne?Ne:constant(+Ne),area):rt},area.lineX0=area.lineY0=function(){return arealine().x(Ne).y(tt)},area.lineY1=function(){return arealine().x(Ne).y(rt)},area.lineX1=function(){return arealine().x(Qe).y(tt)},area.defined=function(Ne){return arguments.length?(nt="function"==typeof Ne?Ne:constant(!!Ne),area):nt},area.curve=function(Ne){return arguments.length?(it=Ne,null!=at&&(ot=it(at)),area):it},area.context=function(Ne){return arguments.length?(null==Ne?at=ot=null:ot=it(at=Ne),area):at},area}function descending(Ne,Ge){return Ge<Ne?-1:Ge>Ne?1:Ge>=Ne?0:NaN}function identity(Ne){return Ne}function pie(){var Ne=identity,Ge=descending,Qe=null,tt=constant(0),rt=constant(Ot),nt=constant(0);function pie(at){var it,ot,dt,ht,Dt,Rt=at.length,Zt=0,er=new Array(Rt),dr=new Array(Rt),mr=+tt.apply(this,arguments),xr=Math.min(Ot,Math.max(-Ot,rt.apply(this,arguments)-mr)),br=Math.min(Math.abs(xr)/Rt,nt.apply(this,arguments)),Ar=br*(xr<0?-1:1);for(it=0;it<Rt;++it)(Dt=dr[er[it]=it]=+Ne(at[it],it,at))>0&&(Zt+=Dt);for(null!=Ge?er.sort((function(Ne,Qe){return Ge(dr[Ne],dr[Qe])})):null!=Qe&&er.sort((function(Ne,Ge){return Qe(at[Ne],at[Ge])})),it=0,dt=Zt?(xr-Rt*Ar)/Zt:0;it<Rt;++it,mr=ht)ot=er[it],ht=mr+((Dt=dr[ot])>0?Dt*dt:0)+Ar,dr[ot]={data:at[ot],index:it,value:Dt,startAngle:mr,endAngle:ht,padAngle:br};return dr}return pie.value=function(Ge){return arguments.length?(Ne="function"==typeof Ge?Ge:constant(+Ge),pie):Ne},pie.sortValues=function(Ne){return arguments.length?(Ge=Ne,Qe=null,pie):Ge},pie.sort=function(Ne){return arguments.length?(Qe=Ne,Ge=null,pie):Qe},pie.startAngle=function(Ne){return arguments.length?(tt="function"==typeof Ne?Ne:constant(+Ne),pie):tt},pie.endAngle=function(Ne){return arguments.length?(rt="function"==typeof Ne?Ne:constant(+Ne),pie):rt},pie.padAngle=function(Ne){return arguments.length?(nt="function"==typeof Ne?Ne:constant(+Ne),pie):nt},pie}Linear.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Ne,Ge){switch(Ne=+Ne,Ge=+Ge,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ne,Ge):this._context.moveTo(Ne,Ge);break;case 1:this._point=2;default:this._context.lineTo(Ne,Ge)}}};var Rt=curveRadial(curveLinear);function Radial(Ne){this._curve=Ne}function curveRadial(Ne){function radial(Ge){return new Radial(Ne(Ge))}return radial._curve=Ne,radial}function lineRadial(Ne){var Ge=Ne.curve;return Ne.angle=Ne.x,delete Ne.x,Ne.radius=Ne.y,delete Ne.y,Ne.curve=function(Ne){return arguments.length?Ge(curveRadial(Ne)):Ge()._curve},Ne}function lineRadial$1(){return lineRadial(line().curve(Rt))}function areaRadial(){var Ne=area().curve(Rt),Ge=Ne.curve,Qe=Ne.lineX0,tt=Ne.lineX1,rt=Ne.lineY0,nt=Ne.lineY1;return Ne.angle=Ne.x,delete Ne.x,Ne.startAngle=Ne.x0,delete Ne.x0,Ne.endAngle=Ne.x1,delete Ne.x1,Ne.radius=Ne.y,delete Ne.y,Ne.innerRadius=Ne.y0,delete Ne.y0,Ne.outerRadius=Ne.y1,delete Ne.y1,Ne.lineStartAngle=function(){return lineRadial(Qe())},delete Ne.lineX0,Ne.lineEndAngle=function(){return lineRadial(tt())},delete Ne.lineX1,Ne.lineInnerRadius=function(){return lineRadial(rt())},delete Ne.lineY0,Ne.lineOuterRadius=function(){return lineRadial(nt())},delete Ne.lineY1,Ne.curve=function(Ne){return arguments.length?Ge(curveRadial(Ne)):Ge()._curve},Ne}function pointRadial(Ne,Ge){return[(Ge=+Ge)*Math.cos(Ne-=Math.PI/2),Ge*Math.sin(Ne)]}Radial.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(Ne,Ge){this._curve.point(Ge*Math.sin(Ne),Ge*-Math.cos(Ne))}};var Zt=Array.prototype.slice;function linkSource(Ne){return Ne.source}function linkTarget(Ne){return Ne.target}function link(Ne){var Qe=linkSource,tt=linkTarget,rt=x,nt=y,at=null;function link(){var it,ot=Zt.call(arguments),dt=Qe.apply(this,ot),ht=tt.apply(this,ot);if(at||(at=it=Ge.path()),Ne(at,+rt.apply(this,(ot[0]=dt,ot)),+nt.apply(this,ot),+rt.apply(this,(ot[0]=ht,ot)),+nt.apply(this,ot)),it)return at=null,it+""||null}return link.source=function(Ne){return arguments.length?(Qe=Ne,link):Qe},link.target=function(Ne){return arguments.length?(tt=Ne,link):tt},link.x=function(Ne){return arguments.length?(rt="function"==typeof Ne?Ne:constant(+Ne),link):rt},link.y=function(Ne){return arguments.length?(nt="function"==typeof Ne?Ne:constant(+Ne),link):nt},link.context=function(Ne){return arguments.length?(at=null==Ne?null:Ne,link):at},link}function curveHorizontal(Ne,Ge,Qe,tt,rt){Ne.moveTo(Ge,Qe),Ne.bezierCurveTo(Ge=(Ge+tt)/2,Qe,Ge,rt,tt,rt)}function curveVertical(Ne,Ge,Qe,tt,rt){Ne.moveTo(Ge,Qe),Ne.bezierCurveTo(Ge,Qe=(Qe+rt)/2,tt,Qe,tt,rt)}function curveRadial$1(Ne,Ge,Qe,tt,rt){var nt=pointRadial(Ge,Qe),at=pointRadial(Ge,Qe=(Qe+rt)/2),it=pointRadial(tt,Qe),ot=pointRadial(tt,rt);Ne.moveTo(nt[0],nt[1]),Ne.bezierCurveTo(at[0],at[1],it[0],it[1],ot[0],ot[1])}function linkHorizontal(){return link(curveHorizontal)}function linkVertical(){return link(curveVertical)}function linkRadial(){var Ne=link(curveRadial$1);return Ne.angle=Ne.x,delete Ne.x,Ne.radius=Ne.y,delete Ne.y,Ne}var er={draw:function(Ne,Ge){var Qe=Math.sqrt(Ge/ht);Ne.moveTo(Qe,0),Ne.arc(0,0,Qe,0,Ot)}},dr={draw:function(Ne,Ge){var Qe=Math.sqrt(Ge/5)/2;Ne.moveTo(-3*Qe,-Qe),Ne.lineTo(-Qe,-Qe),Ne.lineTo(-Qe,-3*Qe),Ne.lineTo(Qe,-3*Qe),Ne.lineTo(Qe,-Qe),Ne.lineTo(3*Qe,-Qe),Ne.lineTo(3*Qe,Qe),Ne.lineTo(Qe,Qe),Ne.lineTo(Qe,3*Qe),Ne.lineTo(-Qe,3*Qe),Ne.lineTo(-Qe,Qe),Ne.lineTo(-3*Qe,Qe),Ne.closePath()}},mr=Math.sqrt(1/3),xr=2*mr,br={draw:function(Ne,Ge){var Qe=Math.sqrt(Ge/xr),tt=Qe*mr;Ne.moveTo(0,-Qe),Ne.lineTo(tt,0),Ne.lineTo(0,Qe),Ne.lineTo(-tt,0),Ne.closePath()}},Ar=.8908130915292852,en=Math.sin(ht/10)/Math.sin(7*ht/10),mn=Math.sin(Ot/10)*en,xn=-Math.cos(Ot/10)*en,kn={draw:function(Ne,Ge){var Qe=Math.sqrt(Ge*Ar),tt=mn*Qe,rt=xn*Qe;Ne.moveTo(0,-Qe),Ne.lineTo(tt,rt);for(var nt=1;nt<5;++nt){var at=Ot*nt/5,it=Math.cos(at),ot=Math.sin(at);Ne.lineTo(ot*Qe,-it*Qe),Ne.lineTo(it*tt-ot*rt,ot*tt+it*rt)}Ne.closePath()}},Cn={draw:function(Ne,Ge){var Qe=Math.sqrt(Ge),tt=-Qe/2;Ne.rect(tt,tt,Qe,Qe)}},En=Math.sqrt(3),Pn={draw:function(Ne,Ge){var Qe=-Math.sqrt(Ge/(3*En));Ne.moveTo(0,2*Qe),Ne.lineTo(-En*Qe,-Qe),Ne.lineTo(En*Qe,-Qe),Ne.closePath()}},Dn=-.5,In=Math.sqrt(3)/2,zn=1/Math.sqrt(12),Bn=3*(zn/2+1),Vn={draw:function(Ne,Ge){var Qe=Math.sqrt(Ge/Bn),tt=Qe/2,rt=Qe*zn,nt=tt,at=Qe*zn+Qe,it=-nt,ot=at;Ne.moveTo(tt,rt),Ne.lineTo(nt,at),Ne.lineTo(it,ot),Ne.lineTo(Dn*tt-In*rt,In*tt+Dn*rt),Ne.lineTo(Dn*nt-In*at,In*nt+Dn*at),Ne.lineTo(Dn*it-In*ot,In*it+Dn*ot),Ne.lineTo(Dn*tt+In*rt,Dn*rt-In*tt),Ne.lineTo(Dn*nt+In*at,Dn*at-In*nt),Ne.lineTo(Dn*it+In*ot,Dn*ot-In*it),Ne.closePath()}},Hn=[er,dr,br,Cn,kn,Pn,Vn];function symbol(){var Ne=constant(er),Qe=constant(64),tt=null;function symbol(){var rt;if(tt||(tt=rt=Ge.path()),Ne.apply(this,arguments).draw(tt,+Qe.apply(this,arguments)),rt)return tt=null,rt+""||null}return symbol.type=function(Ge){return arguments.length?(Ne="function"==typeof Ge?Ge:constant(Ge),symbol):Ne},symbol.size=function(Ne){return arguments.length?(Qe="function"==typeof Ne?Ne:constant(+Ne),symbol):Qe},symbol.context=function(Ne){return arguments.length?(tt=null==Ne?null:Ne,symbol):tt},symbol}function noop(){}function point(Ne,Ge,Qe){Ne._context.bezierCurveTo((2*Ne._x0+Ne._x1)/3,(2*Ne._y0+Ne._y1)/3,(Ne._x0+2*Ne._x1)/3,(Ne._y0+2*Ne._y1)/3,(Ne._x0+4*Ne._x1+Ge)/6,(Ne._y0+4*Ne._y1+Qe)/6)}function Basis(Ne){this._context=Ne}function basis(Ne){return new Basis(Ne)}function BasisClosed(Ne){this._context=Ne}function basisClosed(Ne){return new BasisClosed(Ne)}function BasisOpen(Ne){this._context=Ne}function basisOpen(Ne){return new BasisOpen(Ne)}function Bundle(Ne,Ge){this._basis=new Basis(Ne),this._beta=Ge}Basis.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:point(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Ne,Ge){switch(Ne=+Ne,Ge=+Ge,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ne,Ge):this._context.moveTo(Ne,Ge);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:point(this,Ne,Ge)}this._x0=this._x1,this._x1=Ne,this._y0=this._y1,this._y1=Ge}},BasisClosed.prototype={areaStart:noop,areaEnd:noop,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(Ne,Ge){switch(Ne=+Ne,Ge=+Ge,this._point){case 0:this._point=1,this._x2=Ne,this._y2=Ge;break;case 1:this._point=2,this._x3=Ne,this._y3=Ge;break;case 2:this._point=3,this._x4=Ne,this._y4=Ge,this._context.moveTo((this._x0+4*this._x1+Ne)/6,(this._y0+4*this._y1+Ge)/6);break;default:point(this,Ne,Ge)}this._x0=this._x1,this._x1=Ne,this._y0=this._y1,this._y1=Ge}},BasisOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Ne,Ge){switch(Ne=+Ne,Ge=+Ge,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var Qe=(this._x0+4*this._x1+Ne)/6,tt=(this._y0+4*this._y1+Ge)/6;this._line?this._context.lineTo(Qe,tt):this._context.moveTo(Qe,tt);break;case 3:this._point=4;default:point(this,Ne,Ge)}this._x0=this._x1,this._x1=Ne,this._y0=this._y1,this._y1=Ge}},Bundle.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var Ne=this._x,Ge=this._y,Qe=Ne.length-1;if(Qe>0)for(var tt,rt=Ne[0],nt=Ge[0],at=Ne[Qe]-rt,it=Ge[Qe]-nt,ot=-1;++ot<=Qe;)tt=ot/Qe,this._basis.point(this._beta*Ne[ot]+(1-this._beta)*(rt+tt*at),this._beta*Ge[ot]+(1-this._beta)*(nt+tt*it));this._x=this._y=null,this._basis.lineEnd()},point:function(Ne,Ge){this._x.push(+Ne),this._y.push(+Ge)}};var qn=function custom(Ne){function bundle(Ge){return 1===Ne?new Basis(Ge):new Bundle(Ge,Ne)}return bundle.beta=function(Ne){return custom(+Ne)},bundle}(.85);function point$1(Ne,Ge,Qe){Ne._context.bezierCurveTo(Ne._x1+Ne._k*(Ne._x2-Ne._x0),Ne._y1+Ne._k*(Ne._y2-Ne._y0),Ne._x2+Ne._k*(Ne._x1-Ge),Ne._y2+Ne._k*(Ne._y1-Qe),Ne._x2,Ne._y2)}function Cardinal(Ne,Ge){this._context=Ne,this._k=(1-Ge)/6}Cardinal.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:point$1(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Ne,Ge){switch(Ne=+Ne,Ge=+Ge,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ne,Ge):this._context.moveTo(Ne,Ge);break;case 1:this._point=2,this._x1=Ne,this._y1=Ge;break;case 2:this._point=3;default:point$1(this,Ne,Ge)}this._x0=this._x1,this._x1=this._x2,this._x2=Ne,this._y0=this._y1,this._y1=this._y2,this._y2=Ge}};var Yn=function custom(Ne){function cardinal(Ge){return new Cardinal(Ge,Ne)}return cardinal.tension=function(Ne){return custom(+Ne)},cardinal}(0);function CardinalClosed(Ne,Ge){this._context=Ne,this._k=(1-Ge)/6}CardinalClosed.prototype={areaStart:noop,areaEnd:noop,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(Ne,Ge){switch(Ne=+Ne,Ge=+Ge,this._point){case 0:this._point=1,this._x3=Ne,this._y3=Ge;break;case 1:this._point=2,this._context.moveTo(this._x4=Ne,this._y4=Ge);break;case 2:this._point=3,this._x5=Ne,this._y5=Ge;break;default:point$1(this,Ne,Ge)}this._x0=this._x1,this._x1=this._x2,this._x2=Ne,this._y0=this._y1,this._y1=this._y2,this._y2=Ge}};var $n=function custom(Ne){function cardinal(Ge){return new CardinalClosed(Ge,Ne)}return cardinal.tension=function(Ne){return custom(+Ne)},cardinal}(0);function CardinalOpen(Ne,Ge){this._context=Ne,this._k=(1-Ge)/6}CardinalOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Ne,Ge){switch(Ne=+Ne,Ge=+Ge,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:point$1(this,Ne,Ge)}this._x0=this._x1,this._x1=this._x2,this._x2=Ne,this._y0=this._y1,this._y1=this._y2,this._y2=Ge}};var ra=function custom(Ne){function cardinal(Ge){return new CardinalOpen(Ge,Ne)}return cardinal.tension=function(Ne){return custom(+Ne)},cardinal}(0);function point$2(Ne,Ge,Qe){var tt=Ne._x1,rt=Ne._y1,nt=Ne._x2,at=Ne._y2;if(Ne._l01_a>dt){var it=2*Ne._l01_2a+3*Ne._l01_a*Ne._l12_a+Ne._l12_2a,ot=3*Ne._l01_a*(Ne._l01_a+Ne._l12_a);tt=(tt*it-Ne._x0*Ne._l12_2a+Ne._x2*Ne._l01_2a)/ot,rt=(rt*it-Ne._y0*Ne._l12_2a+Ne._y2*Ne._l01_2a)/ot}if(Ne._l23_a>dt){var ht=2*Ne._l23_2a+3*Ne._l23_a*Ne._l12_a+Ne._l12_2a,Dt=3*Ne._l23_a*(Ne._l23_a+Ne._l12_a);nt=(nt*ht+Ne._x1*Ne._l23_2a-Ge*Ne._l12_2a)/Dt,at=(at*ht+Ne._y1*Ne._l23_2a-Qe*Ne._l12_2a)/Dt}Ne._context.bezierCurveTo(tt,rt,nt,at,Ne._x2,Ne._y2)}function CatmullRom(Ne,Ge){this._context=Ne,this._alpha=Ge}CatmullRom.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Ne,Ge){if(Ne=+Ne,Ge=+Ge,this._point){var Qe=this._x2-Ne,tt=this._y2-Ge;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(Qe*Qe+tt*tt,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(Ne,Ge):this._context.moveTo(Ne,Ge);break;case 1:this._point=2;break;case 2:this._point=3;default:point$2(this,Ne,Ge)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ne,this._y0=this._y1,this._y1=this._y2,this._y2=Ge}};var oa=function custom(Ne){function catmullRom(Ge){return Ne?new CatmullRom(Ge,Ne):new Cardinal(Ge,0)}return catmullRom.alpha=function(Ne){return custom(+Ne)},catmullRom}(.5);function CatmullRomClosed(Ne,Ge){this._context=Ne,this._alpha=Ge}CatmullRomClosed.prototype={areaStart:noop,areaEnd:noop,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(Ne,Ge){if(Ne=+Ne,Ge=+Ge,this._point){var Qe=this._x2-Ne,tt=this._y2-Ge;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(Qe*Qe+tt*tt,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=Ne,this._y3=Ge;break;case 1:this._point=2,this._context.moveTo(this._x4=Ne,this._y4=Ge);break;case 2:this._point=3,this._x5=Ne,this._y5=Ge;break;default:point$2(this,Ne,Ge)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ne,this._y0=this._y1,this._y1=this._y2,this._y2=Ge}};var pa=function custom(Ne){function catmullRom(Ge){return Ne?new CatmullRomClosed(Ge,Ne):new CardinalClosed(Ge,0)}return catmullRom.alpha=function(Ne){return custom(+Ne)},catmullRom}(.5);function CatmullRomOpen(Ne,Ge){this._context=Ne,this._alpha=Ge}CatmullRomOpen.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Ne,Ge){if(Ne=+Ne,Ge=+Ge,this._point){var Qe=this._x2-Ne,tt=this._y2-Ge;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(Qe*Qe+tt*tt,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:point$2(this,Ne,Ge)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=Ne,this._y0=this._y1,this._y1=this._y2,this._y2=Ge}};var ga=function custom(Ne){function catmullRom(Ge){return Ne?new CatmullRomOpen(Ge,Ne):new CardinalOpen(Ge,0)}return catmullRom.alpha=function(Ne){return custom(+Ne)},catmullRom}(.5);function LinearClosed(Ne){this._context=Ne}function linearClosed(Ne){return new LinearClosed(Ne)}function sign(Ne){return Ne<0?-1:1}function slope3(Ne,Ge,Qe){var tt=Ne._x1-Ne._x0,rt=Ge-Ne._x1,nt=(Ne._y1-Ne._y0)/(tt||rt<0&&-0),at=(Qe-Ne._y1)/(rt||tt<0&&-0),it=(nt*rt+at*tt)/(tt+rt);return(sign(nt)+sign(at))*Math.min(Math.abs(nt),Math.abs(at),.5*Math.abs(it))||0}function slope2(Ne,Ge){var Qe=Ne._x1-Ne._x0;return Qe?(3*(Ne._y1-Ne._y0)/Qe-Ge)/2:Ge}function point$3(Ne,Ge,Qe){var tt=Ne._x0,rt=Ne._y0,nt=Ne._x1,at=Ne._y1,it=(nt-tt)/3;Ne._context.bezierCurveTo(tt+it,rt+it*Ge,nt-it,at-it*Qe,nt,at)}function MonotoneX(Ne){this._context=Ne}function MonotoneY(Ne){this._context=new ReflectContext(Ne)}function ReflectContext(Ne){this._context=Ne}function monotoneX(Ne){return new MonotoneX(Ne)}function monotoneY(Ne){return new MonotoneY(Ne)}function Natural(Ne){this._context=Ne}function controlPoints(Ne){var Ge,Qe,tt=Ne.length-1,rt=new Array(tt),nt=new Array(tt),at=new Array(tt);for(rt[0]=0,nt[0]=2,at[0]=Ne[0]+2*Ne[1],Ge=1;Ge<tt-1;++Ge)rt[Ge]=1,nt[Ge]=4,at[Ge]=4*Ne[Ge]+2*Ne[Ge+1];for(rt[tt-1]=2,nt[tt-1]=7,at[tt-1]=8*Ne[tt-1]+Ne[tt],Ge=1;Ge<tt;++Ge)Qe=rt[Ge]/nt[Ge-1],nt[Ge]-=Qe,at[Ge]-=Qe*at[Ge-1];for(rt[tt-1]=at[tt-1]/nt[tt-1],Ge=tt-2;Ge>=0;--Ge)rt[Ge]=(at[Ge]-rt[Ge+1])/nt[Ge];for(nt[tt-1]=(Ne[tt]+rt[tt-1])/2,Ge=0;Ge<tt-1;++Ge)nt[Ge]=2*Ne[Ge+1]-rt[Ge+1];return[rt,nt]}function natural(Ne){return new Natural(Ne)}function Step(Ne,Ge){this._context=Ne,this._t=Ge}function step(Ne){return new Step(Ne,.5)}function stepBefore(Ne){return new Step(Ne,0)}function stepAfter(Ne){return new Step(Ne,1)}function none(Ne,Ge){if((rt=Ne.length)>1)for(var Qe,tt,rt,nt=1,at=Ne[Ge[0]],it=at.length;nt<rt;++nt)for(tt=at,at=Ne[Ge[nt]],Qe=0;Qe<it;++Qe)at[Qe][1]+=at[Qe][0]=isNaN(tt[Qe][1])?tt[Qe][0]:tt[Qe][1]}function none$1(Ne){for(var Ge=Ne.length,Qe=new Array(Ge);--Ge>=0;)Qe[Ge]=Ge;return Qe}function stackValue(Ne,Ge){return Ne[Ge]}function stack(){var Ne=constant([]),Ge=none$1,Qe=none,tt=stackValue;function stack(rt){var nt,at,it=Ne.apply(this,arguments),ot=rt.length,dt=it.length,ht=new Array(dt);for(nt=0;nt<dt;++nt){for(var Dt,Ot=it[nt],Rt=ht[nt]=new Array(ot),Zt=0;Zt<ot;++Zt)Rt[Zt]=Dt=[0,+tt(rt[Zt],Ot,Zt,rt)],Dt.data=rt[Zt];Rt.key=Ot}for(nt=0,at=Ge(ht);nt<dt;++nt)ht[at[nt]].index=nt;return Qe(ht,at),ht}return stack.keys=function(Ge){return arguments.length?(Ne="function"==typeof Ge?Ge:constant(Zt.call(Ge)),stack):Ne},stack.value=function(Ne){return arguments.length?(tt="function"==typeof Ne?Ne:constant(+Ne),stack):tt},stack.order=function(Ne){return arguments.length?(Ge=null==Ne?none$1:"function"==typeof Ne?Ne:constant(Zt.call(Ne)),stack):Ge},stack.offset=function(Ne){return arguments.length?(Qe=null==Ne?none:Ne,stack):Qe},stack}function expand(Ne,Ge){if((tt=Ne.length)>0){for(var Qe,tt,rt,nt=0,at=Ne[0].length;nt<at;++nt){for(rt=Qe=0;Qe<tt;++Qe)rt+=Ne[Qe][nt][1]||0;if(rt)for(Qe=0;Qe<tt;++Qe)Ne[Qe][nt][1]/=rt}none(Ne,Ge)}}function diverging(Ne,Ge){if((it=Ne.length)>0)for(var Qe,tt,rt,nt,at,it,ot=0,dt=Ne[Ge[0]].length;ot<dt;++ot)for(nt=at=0,Qe=0;Qe<it;++Qe)(rt=(tt=Ne[Ge[Qe]][ot])[1]-tt[0])>0?(tt[0]=nt,tt[1]=nt+=rt):rt<0?(tt[1]=at,tt[0]=at+=rt):(tt[0]=0,tt[1]=rt)}function silhouette(Ne,Ge){if((Qe=Ne.length)>0){for(var Qe,tt=0,rt=Ne[Ge[0]],nt=rt.length;tt<nt;++tt){for(var at=0,it=0;at<Qe;++at)it+=Ne[at][tt][1]||0;rt[tt][1]+=rt[tt][0]=-it/2}none(Ne,Ge)}}function wiggle(Ne,Ge){if((rt=Ne.length)>0&&(tt=(Qe=Ne[Ge[0]]).length)>0){for(var Qe,tt,rt,nt=0,at=1;at<tt;++at){for(var it=0,ot=0,dt=0;it<rt;++it){for(var ht=Ne[Ge[it]],Dt=ht[at][1]||0,Ot=(Dt-(ht[at-1][1]||0))/2,Rt=0;Rt<it;++Rt){var Zt=Ne[Ge[Rt]];Ot+=(Zt[at][1]||0)-(Zt[at-1][1]||0)}ot+=Dt,dt+=Ot*Dt}Qe[at-1][1]+=Qe[at-1][0]=nt,ot&&(nt-=dt/ot)}Qe[at-1][1]+=Qe[at-1][0]=nt,none(Ne,Ge)}}function appearance(Ne){var Ge=Ne.map(peak);return none$1(Ne).sort((function(Ne,Qe){return Ge[Ne]-Ge[Qe]}))}function peak(Ne){for(var Ge,Qe=-1,tt=0,rt=Ne.length,nt=-1/0;++Qe<rt;)(Ge=+Ne[Qe][1])>nt&&(nt=Ge,tt=Qe);return tt}function ascending(Ne){var Ge=Ne.map(sum);return none$1(Ne).sort((function(Ne,Qe){return Ge[Ne]-Ge[Qe]}))}function sum(Ne){for(var Ge,Qe=0,tt=-1,rt=Ne.length;++tt<rt;)(Ge=+Ne[tt][1])&&(Qe+=Ge);return Qe}function descending$1(Ne){return ascending(Ne).reverse()}function insideOut(Ne){var Ge,Qe,tt=Ne.length,rt=Ne.map(sum),nt=appearance(Ne),at=0,it=0,ot=[],dt=[];for(Ge=0;Ge<tt;++Ge)Qe=nt[Ge],at<it?(at+=rt[Qe],ot.push(Qe)):(it+=rt[Qe],dt.push(Qe));return dt.reverse().concat(ot)}function reverse(Ne){return none$1(Ne).reverse()}LinearClosed.prototype={areaStart:noop,areaEnd:noop,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(Ne,Ge){Ne=+Ne,Ge=+Ge,this._point?this._context.lineTo(Ne,Ge):(this._point=1,this._context.moveTo(Ne,Ge))}},MonotoneX.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:point$3(this,this._t0,slope2(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(Ne,Ge){var Qe=NaN;if(Ge=+Ge,(Ne=+Ne)!==this._x1||Ge!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(Ne,Ge):this._context.moveTo(Ne,Ge);break;case 1:this._point=2;break;case 2:this._point=3,point$3(this,slope2(this,Qe=slope3(this,Ne,Ge)),Qe);break;default:point$3(this,this._t0,Qe=slope3(this,Ne,Ge))}this._x0=this._x1,this._x1=Ne,this._y0=this._y1,this._y1=Ge,this._t0=Qe}}},(MonotoneY.prototype=Object.create(MonotoneX.prototype)).point=function(Ne,Ge){MonotoneX.prototype.point.call(this,Ge,Ne)},ReflectContext.prototype={moveTo:function(Ne,Ge){this._context.moveTo(Ge,Ne)},closePath:function(){this._context.closePath()},lineTo:function(Ne,Ge){this._context.lineTo(Ge,Ne)},bezierCurveTo:function(Ne,Ge,Qe,tt,rt,nt){this._context.bezierCurveTo(Ge,Ne,tt,Qe,nt,rt)}},Natural.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var Ne=this._x,Ge=this._y,Qe=Ne.length;if(Qe)if(this._line?this._context.lineTo(Ne[0],Ge[0]):this._context.moveTo(Ne[0],Ge[0]),2===Qe)this._context.lineTo(Ne[1],Ge[1]);else for(var tt=controlPoints(Ne),rt=controlPoints(Ge),nt=0,at=1;at<Qe;++nt,++at)this._context.bezierCurveTo(tt[0][nt],rt[0][nt],tt[1][nt],rt[1][nt],Ne[at],Ge[at]);(this._line||0!==this._line&&1===Qe)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(Ne,Ge){this._x.push(+Ne),this._y.push(+Ge)}},Step.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(Ne,Ge){switch(Ne=+Ne,Ge=+Ge,this._point){case 0:this._point=1,this._line?this._context.lineTo(Ne,Ge):this._context.moveTo(Ne,Ge);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,Ge),this._context.lineTo(Ne,Ge);else{var Qe=this._x*(1-this._t)+Ne*this._t;this._context.lineTo(Qe,this._y),this._context.lineTo(Qe,Ge)}}this._x=Ne,this._y=Ge}},Ne.arc=arc,Ne.area=area,Ne.areaRadial=areaRadial,Ne.curveBasis=basis,Ne.curveBasisClosed=basisClosed,Ne.curveBasisOpen=basisOpen,Ne.curveBundle=qn,Ne.curveCardinal=Yn,Ne.curveCardinalClosed=$n,Ne.curveCardinalOpen=ra,Ne.curveCatmullRom=oa,Ne.curveCatmullRomClosed=pa,Ne.curveCatmullRomOpen=ga,Ne.curveLinear=curveLinear,Ne.curveLinearClosed=linearClosed,Ne.curveMonotoneX=monotoneX,Ne.curveMonotoneY=monotoneY,Ne.curveNatural=natural,Ne.curveStep=step,Ne.curveStepAfter=stepAfter,Ne.curveStepBefore=stepBefore,Ne.line=line,Ne.lineRadial=lineRadial$1,Ne.linkHorizontal=linkHorizontal,Ne.linkRadial=linkRadial,Ne.linkVertical=linkVertical,Ne.pie=pie,Ne.pointRadial=pointRadial,Ne.radialArea=areaRadial,Ne.radialLine=lineRadial$1,Ne.stack=stack,Ne.stackOffsetDiverging=diverging,Ne.stackOffsetExpand=expand,Ne.stackOffsetNone=none,Ne.stackOffsetSilhouette=silhouette,Ne.stackOffsetWiggle=wiggle,Ne.stackOrderAppearance=appearance,Ne.stackOrderAscending=ascending,Ne.stackOrderDescending=descending$1,Ne.stackOrderInsideOut=insideOut,Ne.stackOrderNone=none$1,Ne.stackOrderReverse=reverse,Ne.symbol=symbol,Ne.symbolCircle=er,Ne.symbolCross=dr,Ne.symbolDiamond=br,Ne.symbolSquare=Cn,Ne.symbolStar=kn,Ne.symbolTriangle=Pn,Ne.symbolWye=Vn,Ne.symbols=Hn,Object.defineProperty(Ne,"__esModule",{value:!0})},"object"==typeof Qe&&void 0!==Ge?nt(Qe,Ne("d3-path")):"function"==typeof tt&&tt.amd?tt(["exports","d3-path"],nt):nt((rt=rt||self).d3=rt.d3||{},rt.d3)},{"d3-path":163}],166:[function(Ne,Ge,Qe){var rt,nt;rt=this,nt=function(Ne,Ge){"use strict";function localDate(Ne){if(0<=Ne.y&&Ne.y<100){var Ge=new Date(-1,Ne.m,Ne.d,Ne.H,Ne.M,Ne.S,Ne.L);return Ge.setFullYear(Ne.y),Ge}return new Date(Ne.y,Ne.m,Ne.d,Ne.H,Ne.M,Ne.S,Ne.L)}function utcDate(Ne){if(0<=Ne.y&&Ne.y<100){var Ge=new Date(Date.UTC(-1,Ne.m,Ne.d,Ne.H,Ne.M,Ne.S,Ne.L));return Ge.setUTCFullYear(Ne.y),Ge}return new Date(Date.UTC(Ne.y,Ne.m,Ne.d,Ne.H,Ne.M,Ne.S,Ne.L))}function newDate(Ne,Ge,Qe){return{y:Ne,m:Ge,d:Qe,H:0,M:0,S:0,L:0}}function formatLocale(Ne){var Qe=Ne.dateTime,rt=Ne.date,nt=Ne.time,at=Ne.periods,it=Ne.days,ot=Ne.shortDays,dt=Ne.months,ht=Ne.shortMonths,Dt=formatRe(at),Ot=formatLookup(at),Rt=formatRe(it),Zt=formatLookup(it),er=formatRe(ot),dr=formatLookup(ot),mr=formatRe(dt),xr=formatLookup(dt),br=formatRe(ht),Ar=formatLookup(ht),en={a:formatShortWeekday,A:formatWeekday,b:formatShortMonth,B:formatMonth,c:null,d:formatDayOfMonth,e:formatDayOfMonth,f:formatMicroseconds,H:formatHour24,I:formatHour12,j:formatDayOfYear,L:formatMilliseconds,m:formatMonthNumber,M:formatMinutes,p:formatPeriod,q:formatQuarter,Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatSeconds,u:formatWeekdayNumberMonday,U:formatWeekNumberSunday,V:formatWeekNumberISO,w:formatWeekdayNumberSunday,W:formatWeekNumberMonday,x:null,X:null,y:formatYear,Y:formatFullYear,Z:formatZone,"%":formatLiteralPercent},mn={a:formatUTCShortWeekday,A:formatUTCWeekday,b:formatUTCShortMonth,B:formatUTCMonth,c:null,d:formatUTCDayOfMonth,e:formatUTCDayOfMonth,f:formatUTCMicroseconds,H:formatUTCHour24,I:formatUTCHour12,j:formatUTCDayOfYear,L:formatUTCMilliseconds,m:formatUTCMonthNumber,M:formatUTCMinutes,p:formatUTCPeriod,q:formatUTCQuarter,Q:formatUnixTimestamp,s:formatUnixTimestampSeconds,S:formatUTCSeconds,u:formatUTCWeekdayNumberMonday,U:formatUTCWeekNumberSunday,V:formatUTCWeekNumberISO,w:formatUTCWeekdayNumberSunday,W:formatUTCWeekNumberMonday,x:null,X:null,y:formatUTCYear,Y:formatUTCFullYear,Z:formatUTCZone,"%":formatLiteralPercent},xn={a:parseShortWeekday,A:parseWeekday,b:parseShortMonth,B:parseMonth,c:parseLocaleDateTime,d:parseDayOfMonth,e:parseDayOfMonth,f:parseMicroseconds,H:parseHour24,I:parseHour24,j:parseDayOfYear,L:parseMilliseconds,m:parseMonthNumber,M:parseMinutes,p:parsePeriod,q:parseQuarter,Q:parseUnixTimestamp,s:parseUnixTimestampSeconds,S:parseSeconds,u:parseWeekdayNumberMonday,U:parseWeekNumberSunday,V:parseWeekNumberISO,w:parseWeekdayNumberSunday,W:parseWeekNumberMonday,x:parseLocaleDate,X:parseLocaleTime,y:parseYear,Y:parseFullYear,Z:parseZone,"%":parseLiteralPercent};function newFormat(Ne,Ge){return function(Qe){var rt,nt,at,it=[],ot=-1,dt=0,ht=Ne.length;for(Qe instanceof Date||(Qe=new Date(+Qe));++ot<ht;)37===Ne.charCodeAt(ot)&&(it.push(Ne.slice(dt,ot)),null!=(nt=tt[rt=Ne.charAt(++ot)])?rt=Ne.charAt(++ot):nt="e"===rt?" ":"0",(at=Ge[rt])&&(rt=at(Qe,nt)),it.push(rt),dt=ot+1);return it.push(Ne.slice(dt,ot)),it.join("")}}function newParse(Ne,Qe){return function(tt){var rt,nt,at=newDate(1900,void 0,1);if(parseSpecifier(at,Ne,tt+="",0)!=tt.length)return null;if("Q"in at)return new Date(at.Q);if("s"in at)return new Date(1e3*at.s+("L"in at?at.L:0));if(Qe&&!("Z"in at)&&(at.Z=0),"p"in at&&(at.H=at.H%12+12*at.p),void 0===at.m&&(at.m="q"in at?at.q:0),"V"in at){if(at.V<1||at.V>53)return null;"w"in at||(at.w=1),"Z"in at?(nt=(rt=utcDate(newDate(at.y,0,1))).getUTCDay(),rt=nt>4||0===nt?Ge.utcMonday.ceil(rt):Ge.utcMonday(rt),rt=Ge.utcDay.offset(rt,7*(at.V-1)),at.y=rt.getUTCFullYear(),at.m=rt.getUTCMonth(),at.d=rt.getUTCDate()+(at.w+6)%7):(nt=(rt=localDate(newDate(at.y,0,1))).getDay(),rt=nt>4||0===nt?Ge.timeMonday.ceil(rt):Ge.timeMonday(rt),rt=Ge.timeDay.offset(rt,7*(at.V-1)),at.y=rt.getFullYear(),at.m=rt.getMonth(),at.d=rt.getDate()+(at.w+6)%7)}else("W"in at||"U"in at)&&("w"in at||(at.w="u"in at?at.u%7:"W"in at?1:0),nt="Z"in at?utcDate(newDate(at.y,0,1)).getUTCDay():localDate(newDate(at.y,0,1)).getDay(),at.m=0,at.d="W"in at?(at.w+6)%7+7*at.W-(nt+5)%7:at.w+7*at.U-(nt+6)%7);return"Z"in at?(at.H+=at.Z/100|0,at.M+=at.Z%100,utcDate(at)):localDate(at)}}function parseSpecifier(Ne,Ge,Qe,rt){for(var nt,at,it=0,ot=Ge.length,dt=Qe.length;it<ot;){if(rt>=dt)return-1;if(37===(nt=Ge.charCodeAt(it++))){if(nt=Ge.charAt(it++),!(at=xn[nt in tt?Ge.charAt(it++):nt])||(rt=at(Ne,Qe,rt))<0)return-1}else if(nt!=Qe.charCodeAt(rt++))return-1}return rt}function parsePeriod(Ne,Ge,Qe){var tt=Dt.exec(Ge.slice(Qe));return tt?(Ne.p=Ot[tt[0].toLowerCase()],Qe+tt[0].length):-1}function parseShortWeekday(Ne,Ge,Qe){var tt=er.exec(Ge.slice(Qe));return tt?(Ne.w=dr[tt[0].toLowerCase()],Qe+tt[0].length):-1}function parseWeekday(Ne,Ge,Qe){var tt=Rt.exec(Ge.slice(Qe));return tt?(Ne.w=Zt[tt[0].toLowerCase()],Qe+tt[0].length):-1}function parseShortMonth(Ne,Ge,Qe){var tt=br.exec(Ge.slice(Qe));return tt?(Ne.m=Ar[tt[0].toLowerCase()],Qe+tt[0].length):-1}function parseMonth(Ne,Ge,Qe){var tt=mr.exec(Ge.slice(Qe));return tt?(Ne.m=xr[tt[0].toLowerCase()],Qe+tt[0].length):-1}function parseLocaleDateTime(Ne,Ge,tt){return parseSpecifier(Ne,Qe,Ge,tt)}function parseLocaleDate(Ne,Ge,Qe){return parseSpecifier(Ne,rt,Ge,Qe)}function parseLocaleTime(Ne,Ge,Qe){return parseSpecifier(Ne,nt,Ge,Qe)}function formatShortWeekday(Ne){return ot[Ne.getDay()]}function formatWeekday(Ne){return it[Ne.getDay()]}function formatShortMonth(Ne){return ht[Ne.getMonth()]}function formatMonth(Ne){return dt[Ne.getMonth()]}function formatPeriod(Ne){return at[+(Ne.getHours()>=12)]}function formatQuarter(Ne){return 1+~~(Ne.getMonth()/3)}function formatUTCShortWeekday(Ne){return ot[Ne.getUTCDay()]}function formatUTCWeekday(Ne){return it[Ne.getUTCDay()]}function formatUTCShortMonth(Ne){return ht[Ne.getUTCMonth()]}function formatUTCMonth(Ne){return dt[Ne.getUTCMonth()]}function formatUTCPeriod(Ne){return at[+(Ne.getUTCHours()>=12)]}function formatUTCQuarter(Ne){return 1+~~(Ne.getUTCMonth()/3)}return en.x=newFormat(rt,en),en.X=newFormat(nt,en),en.c=newFormat(Qe,en),mn.x=newFormat(rt,mn),mn.X=newFormat(nt,mn),mn.c=newFormat(Qe,mn),{format:function(Ne){var Ge=newFormat(Ne+="",en);return Ge.toString=function(){return Ne},Ge},parse:function(Ne){var Ge=newParse(Ne+="",!1);return Ge.toString=function(){return Ne},Ge},utcFormat:function(Ne){var Ge=newFormat(Ne+="",mn);return Ge.toString=function(){return Ne},Ge},utcParse:function(Ne){var Ge=newParse(Ne+="",!0);return Ge.toString=function(){return Ne},Ge}}}var Qe,tt={"-":"",_:" ",0:"0"},rt=/^\s*\d+/,nt=/^%/,at=/[\\^$*+?|[\]().{}]/g;function pad(Ne,Ge,Qe){var tt=Ne<0?"-":"",rt=(tt?-Ne:Ne)+"",nt=rt.length;return tt+(nt<Qe?new Array(Qe-nt+1).join(Ge)+rt:rt)}function requote(Ne){return Ne.replace(at,"\\$&")}function formatRe(Ne){return new RegExp("^(?:"+Ne.map(requote).join("|")+")","i")}function formatLookup(Ne){for(var Ge={},Qe=-1,tt=Ne.length;++Qe<tt;)Ge[Ne[Qe].toLowerCase()]=Qe;return Ge}function parseWeekdayNumberSunday(Ne,Ge,Qe){var tt=rt.exec(Ge.slice(Qe,Qe+1));return tt?(Ne.w=+tt[0],Qe+tt[0].length):-1}function parseWeekdayNumberMonday(Ne,Ge,Qe){var tt=rt.exec(Ge.slice(Qe,Qe+1));return tt?(Ne.u=+tt[0],Qe+tt[0].length):-1}function parseWeekNumberSunday(Ne,Ge,Qe){var tt=rt.exec(Ge.slice(Qe,Qe+2));return tt?(Ne.U=+tt[0],Qe+tt[0].length):-1}function parseWeekNumberISO(Ne,Ge,Qe){var tt=rt.exec(Ge.slice(Qe,Qe+2));return tt?(Ne.V=+tt[0],Qe+tt[0].length):-1}function parseWeekNumberMonday(Ne,Ge,Qe){var tt=rt.exec(Ge.slice(Qe,Qe+2));return tt?(Ne.W=+tt[0],Qe+tt[0].length):-1}function parseFullYear(Ne,Ge,Qe){var tt=rt.exec(Ge.slice(Qe,Qe+4));return tt?(Ne.y=+tt[0],Qe+tt[0].length):-1}function parseYear(Ne,Ge,Qe){var tt=rt.exec(Ge.slice(Qe,Qe+2));return tt?(Ne.y=+tt[0]+(+tt[0]>68?1900:2e3),Qe+tt[0].length):-1}function parseZone(Ne,Ge,Qe){var tt=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(Ge.slice(Qe,Qe+6));return tt?(Ne.Z=tt[1]?0:-(tt[2]+(tt[3]||"00")),Qe+tt[0].length):-1}function parseQuarter(Ne,Ge,Qe){var tt=rt.exec(Ge.slice(Qe,Qe+1));return tt?(Ne.q=3*tt[0]-3,Qe+tt[0].length):-1}function parseMonthNumber(Ne,Ge,Qe){var tt=rt.exec(Ge.slice(Qe,Qe+2));return tt?(Ne.m=tt[0]-1,Qe+tt[0].length):-1}function parseDayOfMonth(Ne,Ge,Qe){var tt=rt.exec(Ge.slice(Qe,Qe+2));return tt?(Ne.d=+tt[0],Qe+tt[0].length):-1}function parseDayOfYear(Ne,Ge,Qe){var tt=rt.exec(Ge.slice(Qe,Qe+3));return tt?(Ne.m=0,Ne.d=+tt[0],Qe+tt[0].length):-1}function parseHour24(Ne,Ge,Qe){var tt=rt.exec(Ge.slice(Qe,Qe+2));return tt?(Ne.H=+tt[0],Qe+tt[0].length):-1}function parseMinutes(Ne,Ge,Qe){var tt=rt.exec(Ge.slice(Qe,Qe+2));return tt?(Ne.M=+tt[0],Qe+tt[0].length):-1}function parseSeconds(Ne,Ge,Qe){var tt=rt.exec(Ge.slice(Qe,Qe+2));return tt?(Ne.S=+tt[0],Qe+tt[0].length):-1}function parseMilliseconds(Ne,Ge,Qe){var tt=rt.exec(Ge.slice(Qe,Qe+3));return tt?(Ne.L=+tt[0],Qe+tt[0].length):-1}function parseMicroseconds(Ne,Ge,Qe){var tt=rt.exec(Ge.slice(Qe,Qe+6));return tt?(Ne.L=Math.floor(tt[0]/1e3),Qe+tt[0].length):-1}function parseLiteralPercent(Ne,Ge,Qe){var tt=nt.exec(Ge.slice(Qe,Qe+1));return tt?Qe+tt[0].length:-1}function parseUnixTimestamp(Ne,Ge,Qe){var tt=rt.exec(Ge.slice(Qe));return tt?(Ne.Q=+tt[0],Qe+tt[0].length):-1}function parseUnixTimestampSeconds(Ne,Ge,Qe){var tt=rt.exec(Ge.slice(Qe));return tt?(Ne.s=+tt[0],Qe+tt[0].length):-1}function formatDayOfMonth(Ne,Ge){return pad(Ne.getDate(),Ge,2)}function formatHour24(Ne,Ge){return pad(Ne.getHours(),Ge,2)}function formatHour12(Ne,Ge){return pad(Ne.getHours()%12||12,Ge,2)}function formatDayOfYear(Ne,Qe){return pad(1+Ge.timeDay.count(Ge.timeYear(Ne),Ne),Qe,3)}function formatMilliseconds(Ne,Ge){return pad(Ne.getMilliseconds(),Ge,3)}function formatMicroseconds(Ne,Ge){return formatMilliseconds(Ne,Ge)+"000"}function formatMonthNumber(Ne,Ge){return pad(Ne.getMonth()+1,Ge,2)}function formatMinutes(Ne,Ge){return pad(Ne.getMinutes(),Ge,2)}function formatSeconds(Ne,Ge){return pad(Ne.getSeconds(),Ge,2)}function formatWeekdayNumberMonday(Ne){var Ge=Ne.getDay();return 0===Ge?7:Ge}function formatWeekNumberSunday(Ne,Qe){return pad(Ge.timeSunday.count(Ge.timeYear(Ne)-1,Ne),Qe,2)}function formatWeekNumberISO(Ne,Qe){var tt=Ne.getDay();return Ne=tt>=4||0===tt?Ge.timeThursday(Ne):Ge.timeThursday.ceil(Ne),pad(Ge.timeThursday.count(Ge.timeYear(Ne),Ne)+(4===Ge.timeYear(Ne).getDay()),Qe,2)}function formatWeekdayNumberSunday(Ne){return Ne.getDay()}function formatWeekNumberMonday(Ne,Qe){return pad(Ge.timeMonday.count(Ge.timeYear(Ne)-1,Ne),Qe,2)}function formatYear(Ne,Ge){return pad(Ne.getFullYear()%100,Ge,2)}function formatFullYear(Ne,Ge){return pad(Ne.getFullYear()%1e4,Ge,4)}function formatZone(Ne){var Ge=Ne.getTimezoneOffset();return(Ge>0?"-":(Ge*=-1,"+"))+pad(Ge/60|0,"0",2)+pad(Ge%60,"0",2)}function formatUTCDayOfMonth(Ne,Ge){return pad(Ne.getUTCDate(),Ge,2)}function formatUTCHour24(Ne,Ge){return pad(Ne.getUTCHours(),Ge,2)}function formatUTCHour12(Ne,Ge){return pad(Ne.getUTCHours()%12||12,Ge,2)}function formatUTCDayOfYear(Ne,Qe){return pad(1+Ge.utcDay.count(Ge.utcYear(Ne),Ne),Qe,3)}function formatUTCMilliseconds(Ne,Ge){return pad(Ne.getUTCMilliseconds(),Ge,3)}function formatUTCMicroseconds(Ne,Ge){return formatUTCMilliseconds(Ne,Ge)+"000"}function formatUTCMonthNumber(Ne,Ge){return pad(Ne.getUTCMonth()+1,Ge,2)}function formatUTCMinutes(Ne,Ge){return pad(Ne.getUTCMinutes(),Ge,2)}function formatUTCSeconds(Ne,Ge){return pad(Ne.getUTCSeconds(),Ge,2)}function formatUTCWeekdayNumberMonday(Ne){var Ge=Ne.getUTCDay();return 0===Ge?7:Ge}function formatUTCWeekNumberSunday(Ne,Qe){return pad(Ge.utcSunday.count(Ge.utcYear(Ne)-1,Ne),Qe,2)}function formatUTCWeekNumberISO(Ne,Qe){var tt=Ne.getUTCDay();return Ne=tt>=4||0===tt?Ge.utcThursday(Ne):Ge.utcThursday.ceil(Ne),pad(Ge.utcThursday.count(Ge.utcYear(Ne),Ne)+(4===Ge.utcYear(Ne).getUTCDay()),Qe,2)}function formatUTCWeekdayNumberSunday(Ne){return Ne.getUTCDay()}function formatUTCWeekNumberMonday(Ne,Qe){return pad(Ge.utcMonday.count(Ge.utcYear(Ne)-1,Ne),Qe,2)}function formatUTCYear(Ne,Ge){return pad(Ne.getUTCFullYear()%100,Ge,2)}function formatUTCFullYear(Ne,Ge){return pad(Ne.getUTCFullYear()%1e4,Ge,4)}function formatUTCZone(){return"+0000"}function formatLiteralPercent(){return"%"}function formatUnixTimestamp(Ne){return+Ne}function formatUnixTimestampSeconds(Ne){return Math.floor(+Ne/1e3)}function defaultLocale(Ge){return Qe=formatLocale(Ge),Ne.timeFormat=Qe.format,Ne.timeParse=Qe.parse,Ne.utcFormat=Qe.utcFormat,Ne.utcParse=Qe.utcParse,Qe}defaultLocale({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var it="%Y-%m-%dT%H:%M:%S.%LZ";function formatIsoNative(Ne){return Ne.toISOString()}var ot=Date.prototype.toISOString?formatIsoNative:Ne.utcFormat(it);function parseIsoNative(Ne){var Ge=new Date(Ne);return isNaN(Ge)?null:Ge}var dt=+new Date("2000-01-01T00:00:00.000Z")?parseIsoNative:Ne.utcParse(it);Ne.isoFormat=ot,Ne.isoParse=dt,Ne.timeFormatDefaultLocale=defaultLocale,Ne.timeFormatLocale=formatLocale,Object.defineProperty(Ne,"__esModule",{value:!0})},"object"==typeof Qe&&void 0!==Ge?nt(Qe,Ne("d3-time")):"function"==typeof tt&&tt.amd?tt(["exports","d3-time"],nt):nt((rt=rt||self).d3=rt.d3||{},rt.d3)},{"d3-time":167}],167:[function(Ne,Ge,Qe){var rt,nt;rt=this,nt=function(Ne){"use strict";var Ge=new Date,Qe=new Date;function newInterval(Ne,tt,rt,nt){function interval(Ge){return Ne(Ge=0===arguments.length?new Date:new Date(+Ge)),Ge}return interval.floor=function(Ge){return Ne(Ge=new Date(+Ge)),Ge},interval.ceil=function(Ge){return Ne(Ge=new Date(Ge-1)),tt(Ge,1),Ne(Ge),Ge},interval.round=function(Ne){var Ge=interval(Ne),Qe=interval.ceil(Ne);return Ne-Ge<Qe-Ne?Ge:Qe},interval.offset=function(Ne,Ge){return tt(Ne=new Date(+Ne),null==Ge?1:Math.floor(Ge)),Ne},interval.range=function(Ge,Qe,rt){var nt,at=[];if(Ge=interval.ceil(Ge),rt=null==rt?1:Math.floor(rt),!(Ge<Qe&&rt>0))return at;do{at.push(nt=new Date(+Ge)),tt(Ge,rt),Ne(Ge)}while(nt<Ge&&Ge<Qe);return at},interval.filter=function(Ge){return newInterval((function(Qe){if(Qe>=Qe)for(;Ne(Qe),!Ge(Qe);)Qe.setTime(Qe-1)}),(function(Ne,Qe){if(Ne>=Ne)if(Qe<0)for(;++Qe<=0;)for(;tt(Ne,-1),!Ge(Ne););else for(;--Qe>=0;)for(;tt(Ne,1),!Ge(Ne););}))},rt&&(interval.count=function(tt,nt){return Ge.setTime(+tt),Qe.setTime(+nt),Ne(Ge),Ne(Qe),Math.floor(rt(Ge,Qe))},interval.every=function(Ne){return Ne=Math.floor(Ne),isFinite(Ne)&&Ne>0?Ne>1?interval.filter(nt?function(Ge){return nt(Ge)%Ne==0}:function(Ge){return interval.count(0,Ge)%Ne==0}):interval:null}),interval}var tt=newInterval((function(){}),(function(Ne,Ge){Ne.setTime(+Ne+Ge)}),(function(Ne,Ge){return Ge-Ne}));tt.every=function(Ne){return Ne=Math.floor(Ne),isFinite(Ne)&&Ne>0?Ne>1?newInterval((function(Ge){Ge.setTime(Math.floor(Ge/Ne)*Ne)}),(function(Ge,Qe){Ge.setTime(+Ge+Qe*Ne)}),(function(Ge,Qe){return(Qe-Ge)/Ne})):tt:null};var rt=tt.range,nt=1e3,at=6e4,it=36e5,ot=864e5,dt=6048e5,ht=newInterval((function(Ne){Ne.setTime(Ne-Ne.getMilliseconds())}),(function(Ne,Ge){Ne.setTime(+Ne+Ge*nt)}),(function(Ne,Ge){return(Ge-Ne)/nt}),(function(Ne){return Ne.getUTCSeconds()})),Dt=ht.range,Ot=newInterval((function(Ne){Ne.setTime(Ne-Ne.getMilliseconds()-Ne.getSeconds()*nt)}),(function(Ne,Ge){Ne.setTime(+Ne+Ge*at)}),(function(Ne,Ge){return(Ge-Ne)/at}),(function(Ne){return Ne.getMinutes()})),Rt=Ot.range,Zt=newInterval((function(Ne){Ne.setTime(Ne-Ne.getMilliseconds()-Ne.getSeconds()*nt-Ne.getMinutes()*at)}),(function(Ne,Ge){Ne.setTime(+Ne+Ge*it)}),(function(Ne,Ge){return(Ge-Ne)/it}),(function(Ne){return Ne.getHours()})),er=Zt.range,dr=newInterval((function(Ne){Ne.setHours(0,0,0,0)}),(function(Ne,Ge){Ne.setDate(Ne.getDate()+Ge)}),(function(Ne,Ge){return(Ge-Ne-(Ge.getTimezoneOffset()-Ne.getTimezoneOffset())*at)/ot}),(function(Ne){return Ne.getDate()-1})),mr=dr.range;function weekday(Ne){return newInterval((function(Ge){Ge.setDate(Ge.getDate()-(Ge.getDay()+7-Ne)%7),Ge.setHours(0,0,0,0)}),(function(Ne,Ge){Ne.setDate(Ne.getDate()+7*Ge)}),(function(Ne,Ge){return(Ge-Ne-(Ge.getTimezoneOffset()-Ne.getTimezoneOffset())*at)/dt}))}var xr=weekday(0),br=weekday(1),Ar=weekday(2),en=weekday(3),mn=weekday(4),xn=weekday(5),kn=weekday(6),Cn=xr.range,En=br.range,Pn=Ar.range,Dn=en.range,In=mn.range,zn=xn.range,Bn=kn.range,Vn=newInterval((function(Ne){Ne.setDate(1),Ne.setHours(0,0,0,0)}),(function(Ne,Ge){Ne.setMonth(Ne.getMonth()+Ge)}),(function(Ne,Ge){return Ge.getMonth()-Ne.getMonth()+12*(Ge.getFullYear()-Ne.getFullYear())}),(function(Ne){return Ne.getMonth()})),Hn=Vn.range,qn=newInterval((function(Ne){Ne.setMonth(0,1),Ne.setHours(0,0,0,0)}),(function(Ne,Ge){Ne.setFullYear(Ne.getFullYear()+Ge)}),(function(Ne,Ge){return Ge.getFullYear()-Ne.getFullYear()}),(function(Ne){return Ne.getFullYear()}));qn.every=function(Ne){return isFinite(Ne=Math.floor(Ne))&&Ne>0?newInterval((function(Ge){Ge.setFullYear(Math.floor(Ge.getFullYear()/Ne)*Ne),Ge.setMonth(0,1),Ge.setHours(0,0,0,0)}),(function(Ge,Qe){Ge.setFullYear(Ge.getFullYear()+Qe*Ne)})):null};var Yn=qn.range,$n=newInterval((function(Ne){Ne.setUTCSeconds(0,0)}),(function(Ne,Ge){Ne.setTime(+Ne+Ge*at)}),(function(Ne,Ge){return(Ge-Ne)/at}),(function(Ne){return Ne.getUTCMinutes()})),ra=$n.range,oa=newInterval((function(Ne){Ne.setUTCMinutes(0,0,0)}),(function(Ne,Ge){Ne.setTime(+Ne+Ge*it)}),(function(Ne,Ge){return(Ge-Ne)/it}),(function(Ne){return Ne.getUTCHours()})),pa=oa.range,ga=newInterval((function(Ne){Ne.setUTCHours(0,0,0,0)}),(function(Ne,Ge){Ne.setUTCDate(Ne.getUTCDate()+Ge)}),(function(Ne,Ge){return(Ge-Ne)/ot}),(function(Ne){return Ne.getUTCDate()-1})),ma=ga.range;function utcWeekday(Ne){return newInterval((function(Ge){Ge.setUTCDate(Ge.getUTCDate()-(Ge.getUTCDay()+7-Ne)%7),Ge.setUTCHours(0,0,0,0)}),(function(Ne,Ge){Ne.setUTCDate(Ne.getUTCDate()+7*Ge)}),(function(Ne,Ge){return(Ge-Ne)/dt}))}var _a=utcWeekday(0),Va=utcWeekday(1),Wa=utcWeekday(2),Qa=utcWeekday(3),ti=utcWeekday(4),ni=utcWeekday(5),di=utcWeekday(6),ji=_a.range,Hi=Va.range,Yi=Wa.range,uo=Qa.range,go=ti.range,ns=ni.range,as=di.range,is=newInterval((function(Ne){Ne.setUTCDate(1),Ne.setUTCHours(0,0,0,0)}),(function(Ne,Ge){Ne.setUTCMonth(Ne.getUTCMonth()+Ge)}),(function(Ne,Ge){return Ge.getUTCMonth()-Ne.getUTCMonth()+12*(Ge.getUTCFullYear()-Ne.getUTCFullYear())}),(function(Ne){return Ne.getUTCMonth()})),os=is.range,ss=newInterval((function(Ne){Ne.setUTCMonth(0,1),Ne.setUTCHours(0,0,0,0)}),(function(Ne,Ge){Ne.setUTCFullYear(Ne.getUTCFullYear()+Ge)}),(function(Ne,Ge){return Ge.getUTCFullYear()-Ne.getUTCFullYear()}),(function(Ne){return Ne.getUTCFullYear()}));ss.every=function(Ne){return isFinite(Ne=Math.floor(Ne))&&Ne>0?newInterval((function(Ge){Ge.setUTCFullYear(Math.floor(Ge.getUTCFullYear()/Ne)*Ne),Ge.setUTCMonth(0,1),Ge.setUTCHours(0,0,0,0)}),(function(Ge,Qe){Ge.setUTCFullYear(Ge.getUTCFullYear()+Qe*Ne)})):null};var cs=ss.range;Ne.timeDay=dr,Ne.timeDays=mr,Ne.timeFriday=xn,Ne.timeFridays=zn,Ne.timeHour=Zt,Ne.timeHours=er,Ne.timeInterval=newInterval,Ne.timeMillisecond=tt,Ne.timeMilliseconds=rt,Ne.timeMinute=Ot,Ne.timeMinutes=Rt,Ne.timeMonday=br,Ne.timeMondays=En,Ne.timeMonth=Vn,Ne.timeMonths=Hn,Ne.timeSaturday=kn,Ne.timeSaturdays=Bn,Ne.timeSecond=ht,Ne.timeSeconds=Dt,Ne.timeSunday=xr,Ne.timeSundays=Cn,Ne.timeThursday=mn,Ne.timeThursdays=In,Ne.timeTuesday=Ar,Ne.timeTuesdays=Pn,Ne.timeWednesday=en,Ne.timeWednesdays=Dn,Ne.timeWeek=xr,Ne.timeWeeks=Cn,Ne.timeYear=qn,Ne.timeYears=Yn,Ne.utcDay=ga,Ne.utcDays=ma,Ne.utcFriday=ni,Ne.utcFridays=ns,Ne.utcHour=oa,Ne.utcHours=pa,Ne.utcMillisecond=tt,Ne.utcMilliseconds=rt,Ne.utcMinute=$n,Ne.utcMinutes=ra,Ne.utcMonday=Va,Ne.utcMondays=Hi,Ne.utcMonth=is,Ne.utcMonths=os,Ne.utcSaturday=di,Ne.utcSaturdays=as,Ne.utcSecond=ht,Ne.utcSeconds=Dt,Ne.utcSunday=_a,Ne.utcSundays=ji,Ne.utcThursday=ti,Ne.utcThursdays=go,Ne.utcTuesday=Wa,Ne.utcTuesdays=Yi,Ne.utcWednesday=Qa,Ne.utcWednesdays=uo,Ne.utcWeek=_a,Ne.utcWeeks=ji,Ne.utcYear=ss,Ne.utcYears=cs,Object.defineProperty(Ne,"__esModule",{value:!0})},"object"==typeof Qe&&void 0!==Ge?nt(Qe):"function"==typeof tt&&tt.amd?tt(["exports"],nt):nt((rt=rt||self).d3=rt.d3||{})},{}],168:[function(Ne,Ge,Qe){var rt,nt;rt=this,nt=function(Ne){"use strict";var Ge,Qe,tt=0,rt=0,nt=0,at=1e3,it=0,ot=0,dt=0,ht="object"==typeof performance&&performance.now?performance:Date,Dt="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(Ne){setTimeout(Ne,17)};function now(){return ot||(Dt(clearNow),ot=ht.now()+dt)}function clearNow(){ot=0}function Timer(){this._call=this._time=this._next=null}function timer(Ne,Ge,Qe){var tt=new Timer;return tt.restart(Ne,Ge,Qe),tt}function timerFlush(){now(),++tt;for(var Ne,Qe=Ge;Qe;)(Ne=ot-Qe._time)>=0&&Qe._call.call(null,Ne),Qe=Qe._next;--tt}function wake(){ot=(it=ht.now())+dt,tt=rt=0;try{timerFlush()}finally{tt=0,nap(),ot=0}}function poke(){var Ne=ht.now(),Ge=Ne-it;Ge>at&&(dt-=Ge,it=Ne)}function nap(){for(var Ne,tt,rt=Ge,nt=1/0;rt;)rt._call?(nt>rt._time&&(nt=rt._time),Ne=rt,rt=rt._next):(tt=rt._next,rt._next=null,rt=Ne?Ne._next=tt:Ge=tt);Qe=Ne,sleep(nt)}function sleep(Ne){tt||(rt&&(rt=clearTimeout(rt)),Ne-ot>24?(Ne<1/0&&(rt=setTimeout(wake,Ne-ht.now()-dt)),nt&&(nt=clearInterval(nt))):(nt||(it=ht.now(),nt=setInterval(poke,at)),tt=1,Dt(wake)))}function timeout$1(Ne,Ge,Qe){var tt=new Timer;return Ge=null==Ge?0:+Ge,tt.restart((function(Qe){tt.stop(),Ne(Qe+Ge)}),Ge,Qe),tt}function interval$1(Ne,Ge,Qe){var tt=new Timer,rt=Ge;return null==Ge?(tt.restart(Ne,Ge,Qe),tt):(Ge=+Ge,Qe=null==Qe?now():+Qe,tt.restart((function tick(nt){nt+=rt,tt.restart(tick,rt+=Ge,Qe),Ne(nt)}),Ge,Qe),tt)}Timer.prototype=timer.prototype={constructor:Timer,restart:function(Ne,tt,rt){if("function"!=typeof Ne)throw new TypeError("callback is not a function");rt=(null==rt?now():+rt)+(null==tt?0:+tt),this._next||Qe===this||(Qe?Qe._next=this:Ge=this,Qe=this),this._call=Ne,this._time=rt,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}},Ne.interval=interval$1,Ne.now=now,Ne.timeout=timeout$1,Ne.timer=timer,Ne.timerFlush=timerFlush,Object.defineProperty(Ne,"__esModule",{value:!0})},"object"==typeof Qe&&void 0!==Ge?nt(Qe):"function"==typeof tt&&tt.amd?tt(["exports"],nt):nt((rt=rt||self).d3=rt.d3||{})},{}],169:[function(Ne,Ge,Qe){!function(){var Ne={version:"3.5.17"},Qe=[].slice,d3_array=function(Ne){return Qe.call(Ne)},rt=this.document;function d3_documentElement(Ne){return Ne&&(Ne.ownerDocument||Ne.document||Ne).documentElement}function d3_window(Ne){return Ne&&(Ne.ownerDocument&&Ne.ownerDocument.defaultView||Ne.document&&Ne||Ne.defaultView)}if(rt)try{d3_array(rt.documentElement.childNodes)[0].nodeType}catch(Ne){d3_array=function(Ne){for(var Ge=Ne.length,Qe=new Array(Ge);Ge--;)Qe[Ge]=Ne[Ge];return Qe}}if(Date.now||(Date.now=function(){return+new Date}),rt)try{rt.createElement("DIV").style.setProperty("opacity",0,"")}catch(Ne){var nt=this.Element.prototype,at=nt.setAttribute,it=nt.setAttributeNS,ot=this.CSSStyleDeclaration.prototype,dt=ot.setProperty;nt.setAttribute=function(Ne,Ge){at.call(this,Ne,Ge+"")},nt.setAttributeNS=function(Ne,Ge,Qe){it.call(this,Ne,Ge,Qe+"")},ot.setProperty=function(Ne,Ge,Qe){dt.call(this,Ne,Ge+"",Qe)}}function d3_ascending(Ne,Ge){return Ne<Ge?-1:Ne>Ge?1:Ne>=Ge?0:NaN}function d3_number(Ne){return null===Ne?NaN:+Ne}function d3_numeric(Ne){return!isNaN(Ne)}function d3_bisector(Ne){return{left:function(Ge,Qe,tt,rt){for(arguments.length<3&&(tt=0),arguments.length<4&&(rt=Ge.length);tt<rt;){var nt=tt+rt>>>1;Ne(Ge[nt],Qe)<0?tt=nt+1:rt=nt}return tt},right:function(Ge,Qe,tt,rt){for(arguments.length<3&&(tt=0),arguments.length<4&&(rt=Ge.length);tt<rt;){var nt=tt+rt>>>1;Ne(Ge[nt],Qe)>0?rt=nt:tt=nt+1}return tt}}}Ne.ascending=d3_ascending,Ne.descending=function(Ne,Ge){return Ge<Ne?-1:Ge>Ne?1:Ge>=Ne?0:NaN},Ne.min=function(Ne,Ge){var Qe,tt,rt=-1,nt=Ne.length;if(1===arguments.length){for(;++rt<nt;)if(null!=(tt=Ne[rt])&&tt>=tt){Qe=tt;break}for(;++rt<nt;)null!=(tt=Ne[rt])&&Qe>tt&&(Qe=tt)}else{for(;++rt<nt;)if(null!=(tt=Ge.call(Ne,Ne[rt],rt))&&tt>=tt){Qe=tt;break}for(;++rt<nt;)null!=(tt=Ge.call(Ne,Ne[rt],rt))&&Qe>tt&&(Qe=tt)}return Qe},Ne.max=function(Ne,Ge){var Qe,tt,rt=-1,nt=Ne.length;if(1===arguments.length){for(;++rt<nt;)if(null!=(tt=Ne[rt])&&tt>=tt){Qe=tt;break}for(;++rt<nt;)null!=(tt=Ne[rt])&&tt>Qe&&(Qe=tt)}else{for(;++rt<nt;)if(null!=(tt=Ge.call(Ne,Ne[rt],rt))&&tt>=tt){Qe=tt;break}for(;++rt<nt;)null!=(tt=Ge.call(Ne,Ne[rt],rt))&&tt>Qe&&(Qe=tt)}return Qe},Ne.extent=function(Ne,Ge){var Qe,tt,rt,nt=-1,at=Ne.length;if(1===arguments.length){for(;++nt<at;)if(null!=(tt=Ne[nt])&&tt>=tt){Qe=rt=tt;break}for(;++nt<at;)null!=(tt=Ne[nt])&&(Qe>tt&&(Qe=tt),rt<tt&&(rt=tt))}else{for(;++nt<at;)if(null!=(tt=Ge.call(Ne,Ne[nt],nt))&&tt>=tt){Qe=rt=tt;break}for(;++nt<at;)null!=(tt=Ge.call(Ne,Ne[nt],nt))&&(Qe>tt&&(Qe=tt),rt<tt&&(rt=tt))}return[Qe,rt]},Ne.sum=function(Ne,Ge){var Qe,tt=0,rt=Ne.length,nt=-1;if(1===arguments.length)for(;++nt<rt;)d3_numeric(Qe=+Ne[nt])&&(tt+=Qe);else for(;++nt<rt;)d3_numeric(Qe=+Ge.call(Ne,Ne[nt],nt))&&(tt+=Qe);return tt},Ne.mean=function(Ne,Ge){var Qe,tt=0,rt=Ne.length,nt=-1,at=rt;if(1===arguments.length)for(;++nt<rt;)d3_numeric(Qe=d3_number(Ne[nt]))?tt+=Qe:--at;else for(;++nt<rt;)d3_numeric(Qe=d3_number(Ge.call(Ne,Ne[nt],nt)))?tt+=Qe:--at;if(at)return tt/at},Ne.quantile=function(Ne,Ge){var Qe=(Ne.length-1)*Ge+1,tt=Math.floor(Qe),rt=+Ne[tt-1],nt=Qe-tt;return nt?rt+nt*(Ne[tt]-rt):rt},Ne.median=function(Ge,Qe){var tt,rt=[],nt=Ge.length,at=-1;if(1===arguments.length)for(;++at<nt;)d3_numeric(tt=d3_number(Ge[at]))&&rt.push(tt);else for(;++at<nt;)d3_numeric(tt=d3_number(Qe.call(Ge,Ge[at],at)))&&rt.push(tt);if(rt.length)return Ne.quantile(rt.sort(d3_ascending),.5)},Ne.variance=function(Ne,Ge){var Qe,tt,rt=Ne.length,nt=0,at=0,it=-1,ot=0;if(1===arguments.length)for(;++it<rt;)d3_numeric(Qe=d3_number(Ne[it]))&&(at+=(tt=Qe-nt)*(Qe-(nt+=tt/++ot)));else for(;++it<rt;)d3_numeric(Qe=d3_number(Ge.call(Ne,Ne[it],it)))&&(at+=(tt=Qe-nt)*(Qe-(nt+=tt/++ot)));if(ot>1)return at/(ot-1)},Ne.deviation=function(){var Ge=Ne.variance.apply(this,arguments);return Ge?Math.sqrt(Ge):Ge};var ht=d3_bisector(d3_ascending);function d3_transposeLength(Ne){return Ne.length}Ne.bisectLeft=ht.left,Ne.bisect=Ne.bisectRight=ht.right,Ne.bisector=function(Ne){return d3_bisector(1===Ne.length?function(Ge,Qe){return d3_ascending(Ne(Ge),Qe)}:Ne)},Ne.shuffle=function(Ne,Ge,Qe){(nt=arguments.length)<3&&(Qe=Ne.length,nt<2&&(Ge=0));for(var tt,rt,nt=Qe-Ge;nt;)rt=Math.random()*nt--|0,tt=Ne[nt+Ge],Ne[nt+Ge]=Ne[rt+Ge],Ne[rt+Ge]=tt;return Ne},Ne.permute=function(Ne,Ge){for(var Qe=Ge.length,tt=new Array(Qe);Qe--;)tt[Qe]=Ne[Ge[Qe]];return tt},Ne.pairs=function(Ne){for(var Ge=0,Qe=Ne.length-1,tt=Ne[0],rt=new Array(Qe<0?0:Qe);Ge<Qe;)rt[Ge]=[tt,tt=Ne[++Ge]];return rt},Ne.transpose=function(Ge){if(!(nt=Ge.length))return[];for(var Qe=-1,tt=Ne.min(Ge,d3_transposeLength),rt=new Array(tt);++Qe<tt;)for(var nt,at=-1,it=rt[Qe]=new Array(nt);++at<nt;)it[at]=Ge[at][Qe];return rt},Ne.zip=function(){return Ne.transpose(arguments)},Ne.keys=function(Ne){var Ge=[];for(var Qe in Ne)Ge.push(Qe);return Ge},Ne.values=function(Ne){var Ge=[];for(var Qe in Ne)Ge.push(Ne[Qe]);return Ge},Ne.entries=function(Ne){var Ge=[];for(var Qe in Ne)Ge.push({key:Qe,value:Ne[Qe]});return Ge},Ne.merge=function(Ne){for(var Ge,Qe,tt,rt=Ne.length,nt=-1,at=0;++nt<rt;)at+=Ne[nt].length;for(Qe=new Array(at);--rt>=0;)for(Ge=(tt=Ne[rt]).length;--Ge>=0;)Qe[--at]=tt[Ge];return Qe};var Dt=Math.abs;function d3_range_integerScale(Ne){for(var Ge=1;Ne*Ge%1;)Ge*=10;return Ge}function d3_class(Ne,Ge){for(var Qe in Ge)Object.defineProperty(Ne.prototype,Qe,{value:Ge[Qe],enumerable:!1})}function d3_Map(){this._=Object.create(null)}Ne.range=function(Ne,Ge,Qe){if(arguments.length<3&&(Qe=1,arguments.length<2&&(Ge=Ne,Ne=0)),(Ge-Ne)/Qe==1/0)throw new Error("infinite range");var tt,rt=[],nt=d3_range_integerScale(Dt(Qe)),at=-1;if(Ne*=nt,Ge*=nt,(Qe*=nt)<0)for(;(tt=Ne+Qe*++at)>Ge;)rt.push(tt/nt);else for(;(tt=Ne+Qe*++at)<Ge;)rt.push(tt/nt);return rt},Ne.map=function(Ne,Ge){var Qe=new d3_Map;if(Ne instanceof d3_Map)Ne.forEach((function(Ne,Ge){Qe.set(Ne,Ge)}));else if(Array.isArray(Ne)){var tt,rt=-1,nt=Ne.length;if(1===arguments.length)for(;++rt<nt;)Qe.set(rt,Ne[rt]);else for(;++rt<nt;)Qe.set(Ge.call(Ne,tt=Ne[rt],rt),tt)}else for(var at in Ne)Qe.set(at,Ne[at]);return Qe};var Ot="__proto__",Rt="\0";function d3_map_escape(Ne){return(Ne+="")===Ot||Ne[0]===Rt?Rt+Ne:Ne}function d3_map_unescape(Ne){return(Ne+="")[0]===Rt?Ne.slice(1):Ne}function d3_map_has(Ne){return d3_map_escape(Ne)in this._}function d3_map_remove(Ne){return(Ne=d3_map_escape(Ne))in this._&&delete this._[Ne]}function d3_map_keys(){var Ne=[];for(var Ge in this._)Ne.push(d3_map_unescape(Ge));return Ne}function d3_map_size(){var Ne=0;for(var Ge in this._)++Ne;return Ne}function d3_map_empty(){for(var Ne in this._)return!1;return!0}function d3_Set(){this._=Object.create(null)}function d3_identity(Ne){return Ne}function d3_rebind(Ne,Ge,Qe){return function(){var tt=Qe.apply(Ge,arguments);return tt===Ge?Ne:tt}}function d3_vendorSymbol(Ne,Ge){if(Ge in Ne)return Ge;Ge=Ge.charAt(0).toUpperCase()+Ge.slice(1);for(var Qe=0,tt=Zt.length;Qe<tt;++Qe){var rt=Zt[Qe]+Ge;if(rt in Ne)return rt}}d3_class(d3_Map,{has:d3_map_has,get:function(Ne){return this._[d3_map_escape(Ne)]},set:function(Ne,Ge){return this._[d3_map_escape(Ne)]=Ge},remove:d3_map_remove,keys:d3_map_keys,values:function(){var Ne=[];for(var Ge in this._)Ne.push(this._[Ge]);return Ne},entries:function(){var Ne=[];for(var Ge in this._)Ne.push({key:d3_map_unescape(Ge),value:this._[Ge]});return Ne},size:d3_map_size,empty:d3_map_empty,forEach:function(Ne){for(var Ge in this._)Ne.call(this,d3_map_unescape(Ge),this._[Ge])}}),Ne.nest=function(){var Ge,Qe,tt={},rt=[],nt=[];function map(Ne,nt,at){if(at>=rt.length)return Qe?Qe.call(tt,nt):Ge?nt.sort(Ge):nt;for(var it,ot,dt,ht,Dt=-1,Ot=nt.length,Rt=rt[at++],Zt=new d3_Map;++Dt<Ot;)(ht=Zt.get(it=Rt(ot=nt[Dt])))?ht.push(ot):Zt.set(it,[ot]);return Ne?(ot=Ne(),dt=function(Ge,Qe){ot.set(Ge,map(Ne,Qe,at))}):(ot={},dt=function(Ge,Qe){ot[Ge]=map(Ne,Qe,at)}),Zt.forEach(dt),ot}function entries(Ne,Ge){if(Ge>=rt.length)return Ne;var Qe=[],tt=nt[Ge++];return Ne.forEach((function(Ne,tt){Qe.push({key:Ne,values:entries(tt,Ge)})})),tt?Qe.sort((function(Ne,Ge){return tt(Ne.key,Ge.key)})):Qe}return tt.map=function(Ne,Ge){return map(Ge,Ne,0)},tt.entries=function(Ge){return entries(map(Ne.map,Ge,0),0)},tt.key=function(Ne){return rt.push(Ne),tt},tt.sortKeys=function(Ne){return nt[rt.length-1]=Ne,tt},tt.sortValues=function(Ne){return Ge=Ne,tt},tt.rollup=function(Ne){return Qe=Ne,tt},tt},Ne.set=function(Ne){var Ge=new d3_Set;if(Ne)for(var Qe=0,tt=Ne.length;Qe<tt;++Qe)Ge.add(Ne[Qe]);return Ge},d3_class(d3_Set,{has:d3_map_has,add:function(Ne){return this._[d3_map_escape(Ne+="")]=!0,Ne},remove:d3_map_remove,values:d3_map_keys,size:d3_map_size,empty:d3_map_empty,forEach:function(Ne){for(var Ge in this._)Ne.call(this,d3_map_unescape(Ge))}}),Ne.behavior={},Ne.rebind=function(Ne,Ge){for(var Qe,tt=1,rt=arguments.length;++tt<rt;)Ne[Qe=arguments[tt]]=d3_rebind(Ne,Ge,Ge[Qe]);return Ne};var Zt=["webkit","ms","moz","Moz","o","O"];function d3_noop(){}function d3_dispatch(){}function d3_dispatch_event(Ne){var Ge=[],Qe=new d3_Map;function event(){for(var Qe,tt=Ge,rt=-1,nt=tt.length;++rt<nt;)(Qe=tt[rt].on)&&Qe.apply(this,arguments);return Ne}return event.on=function(tt,rt){var nt,at=Qe.get(tt);return arguments.length<2?at&&at.on:(at&&(at.on=null,Ge=Ge.slice(0,nt=Ge.indexOf(at)).concat(Ge.slice(nt+1)),Qe.remove(tt)),rt&&Ge.push(Qe.set(tt,{on:rt})),Ne)},event}function d3_eventPreventDefault(){Ne.event.preventDefault()}function d3_eventSource(){for(var Ge,Qe=Ne.event;Ge=Qe.sourceEvent;)Qe=Ge;return Qe}function d3_eventDispatch(Ge){for(var Qe=new d3_dispatch,tt=0,rt=arguments.length;++tt<rt;)Qe[arguments[tt]]=d3_dispatch_event(Qe);return Qe.of=function(tt,rt){return function(nt){try{var at=nt.sourceEvent=Ne.event;nt.target=Ge,Ne.event=nt,Qe[nt.type].apply(tt,rt)}finally{Ne.event=at}}},Qe}Ne.dispatch=function(){for(var Ne=new d3_dispatch,Ge=-1,Qe=arguments.length;++Ge<Qe;)Ne[arguments[Ge]]=d3_dispatch_event(Ne);return Ne},d3_dispatch.prototype.on=function(Ne,Ge){var Qe=Ne.indexOf("."),tt="";if(Qe>=0&&(tt=Ne.slice(Qe+1),Ne=Ne.slice(0,Qe)),Ne)return arguments.length<2?this[Ne].on(tt):this[Ne].on(tt,Ge);if(2===arguments.length){if(null==Ge)for(Ne in this)this.hasOwnProperty(Ne)&&this[Ne].on(tt,null);return this}},Ne.event=null,Ne.requote=function(Ne){return Ne.replace(er,"\\$&")};var er=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,dr={}.__proto__?function(Ne,Ge){Ne.__proto__=Ge}:function(Ne,Ge){for(var Qe in Ge)Ne[Qe]=Ge[Qe]};function d3_selection(Ne){return dr(Ne,mr),Ne}var d3_select=function(Ne,Ge){return Ge.querySelector(Ne)},d3_selectAll=function(Ne,Ge){return Ge.querySelectorAll(Ne)},d3_selectMatches=function(Ne,Ge){var Qe=Ne.matches||Ne[d3_vendorSymbol(Ne,"matchesSelector")];return d3_selectMatches=function(Ne,Ge){return Qe.call(Ne,Ge)},d3_selectMatches(Ne,Ge)};"function"==typeof Sizzle&&(d3_select=function(Ne,Ge){return Sizzle(Ne,Ge)[0]||null},d3_selectAll=Sizzle,d3_selectMatches=Sizzle.matchesSelector),Ne.selection=function(){return Ne.select(rt.documentElement)};var mr=Ne.selection.prototype=[];function d3_selection_selector(Ne){return"function"==typeof Ne?Ne:function(){return d3_select(Ne,this)}}function d3_selection_selectorAll(Ne){return"function"==typeof Ne?Ne:function(){return d3_selectAll(Ne,this)}}mr.select=function(Ne){var Ge,Qe,tt,rt,nt=[];Ne=d3_selection_selector(Ne);for(var at=-1,it=this.length;++at<it;){nt.push(Ge=[]),Ge.parentNode=(tt=this[at]).parentNode;for(var ot=-1,dt=tt.length;++ot<dt;)(rt=tt[ot])?(Ge.push(Qe=Ne.call(rt,rt.__data__,ot,at)),Qe&&"__data__"in rt&&(Qe.__data__=rt.__data__)):Ge.push(null)}return d3_selection(nt)},mr.selectAll=function(Ne){var Ge,Qe,tt=[];Ne=d3_selection_selectorAll(Ne);for(var rt=-1,nt=this.length;++rt<nt;)for(var at=this[rt],it=-1,ot=at.length;++it<ot;)(Qe=at[it])&&(tt.push(Ge=d3_array(Ne.call(Qe,Qe.__data__,it,rt))),Ge.parentNode=Qe);return d3_selection(tt)};var xr="http://www.w3.org/1999/xhtml",br={svg:"http://www.w3.org/2000/svg",xhtml:xr,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function d3_selection_attr(Ge,Qe){function attrNull(){this.removeAttribute(Ge)}function attrNullNS(){this.removeAttributeNS(Ge.space,Ge.local)}function attrConstant(){this.setAttribute(Ge,Qe)}function attrConstantNS(){this.setAttributeNS(Ge.space,Ge.local,Qe)}function attrFunction(){var Ne=Qe.apply(this,arguments);null==Ne?this.removeAttribute(Ge):this.setAttribute(Ge,Ne)}function attrFunctionNS(){var Ne=Qe.apply(this,arguments);null==Ne?this.removeAttributeNS(Ge.space,Ge.local):this.setAttributeNS(Ge.space,Ge.local,Ne)}return Ge=Ne.ns.qualify(Ge),null==Qe?Ge.local?attrNullNS:attrNull:"function"==typeof Qe?Ge.local?attrFunctionNS:attrFunction:Ge.local?attrConstantNS:attrConstant}function d3_collapse(Ne){return Ne.trim().replace(/\s+/g," ")}function d3_selection_classedRe(Ge){return new RegExp("(?:^|\\s+)"+Ne.requote(Ge)+"(?:\\s+|$)","g")}function d3_selection_classes(Ne){return(Ne+"").trim().split(/^|\s+/)}function d3_selection_classed(Ne,Ge){var Qe=(Ne=d3_selection_classes(Ne).map(d3_selection_classedName)).length;function classedConstant(){for(var tt=-1;++tt<Qe;)Ne[tt](this,Ge)}function classedFunction(){for(var tt=-1,rt=Ge.apply(this,arguments);++tt<Qe;)Ne[tt](this,rt)}return"function"==typeof Ge?classedFunction:classedConstant}function d3_selection_classedName(Ne){var Ge=d3_selection_classedRe(Ne);return function(Qe,tt){if(rt=Qe.classList)return tt?rt.add(Ne):rt.remove(Ne);var rt=Qe.getAttribute("class")||"";tt?(Ge.lastIndex=0,Ge.test(rt)||Qe.setAttribute("class",d3_collapse(rt+" "+Ne))):Qe.setAttribute("class",d3_collapse(rt.replace(Ge," ")))}}function d3_selection_style(Ne,Ge,Qe){function styleNull(){this.style.removeProperty(Ne)}function styleConstant(){this.style.setProperty(Ne,Ge,Qe)}function styleFunction(){var tt=Ge.apply(this,arguments);null==tt?this.style.removeProperty(Ne):this.style.setProperty(Ne,tt,Qe)}return null==Ge?styleNull:"function"==typeof Ge?styleFunction:styleConstant}function d3_selection_property(Ne,Ge){function propertyNull(){delete this[Ne]}function propertyConstant(){this[Ne]=Ge}function propertyFunction(){var Qe=Ge.apply(this,arguments);null==Qe?delete this[Ne]:this[Ne]=Qe}return null==Ge?propertyNull:"function"==typeof Ge?propertyFunction:propertyConstant}function d3_selection_creator(Ge){function create(){var Ne=this.ownerDocument,Qe=this.namespaceURI;return Qe===xr&&Ne.documentElement.namespaceURI===xr?Ne.createElement(Ge):Ne.createElementNS(Qe,Ge)}function createNS(){return this.ownerDocument.createElementNS(Ge.space,Ge.local)}return"function"==typeof Ge?Ge:(Ge=Ne.ns.qualify(Ge)).local?createNS:create}function d3_selectionRemove(){var Ne=this.parentNode;Ne&&Ne.removeChild(this)}function d3_selection_dataNode(Ne){return{__data__:Ne}}function d3_selection_filter(Ne){return function(){return d3_selectMatches(this,Ne)}}function d3_selection_sortComparator(Ne){return arguments.length||(Ne=d3_ascending),function(Ge,Qe){return Ge&&Qe?Ne(Ge.__data__,Qe.__data__):!Ge-!Qe}}function d3_selection_each(Ne,Ge){for(var Qe=0,tt=Ne.length;Qe<tt;Qe++)for(var rt,nt=Ne[Qe],at=0,it=nt.length;at<it;at++)(rt=nt[at])&&Ge(rt,at,Qe);return Ne}function d3_selection_enter(Ne){return dr(Ne,Ar),Ne}Ne.ns={prefix:br,qualify:function(Ne){var Ge=Ne.indexOf(":"),Qe=Ne;return Ge>=0&&"xmlns"!==(Qe=Ne.slice(0,Ge))&&(Ne=Ne.slice(Ge+1)),br.hasOwnProperty(Qe)?{space:br[Qe],local:Ne}:Ne}},mr.attr=function(Ge,Qe){if(arguments.length<2){if("string"==typeof Ge){var tt=this.node();return(Ge=Ne.ns.qualify(Ge)).local?tt.getAttributeNS(Ge.space,Ge.local):tt.getAttribute(Ge)}for(Qe in Ge)this.each(d3_selection_attr(Qe,Ge[Qe]));return this}return this.each(d3_selection_attr(Ge,Qe))},mr.classed=function(Ne,Ge){if(arguments.length<2){if("string"==typeof Ne){var Qe=this.node(),tt=(Ne=d3_selection_classes(Ne)).length,rt=-1;if(Ge=Qe.classList){for(;++rt<tt;)if(!Ge.contains(Ne[rt]))return!1}else for(Ge=Qe.getAttribute("class");++rt<tt;)if(!d3_selection_classedRe(Ne[rt]).test(Ge))return!1;return!0}for(Ge in Ne)this.each(d3_selection_classed(Ge,Ne[Ge]));return this}return this.each(d3_selection_classed(Ne,Ge))},mr.style=function(Ne,Ge,Qe){var tt=arguments.length;if(tt<3){if("string"!=typeof Ne){for(Qe in tt<2&&(Ge=""),Ne)this.each(d3_selection_style(Qe,Ne[Qe],Ge));return this}if(tt<2){var rt=this.node();return d3_window(rt).getComputedStyle(rt,null).getPropertyValue(Ne)}Qe=""}return this.each(d3_selection_style(Ne,Ge,Qe))},mr.property=function(Ne,Ge){if(arguments.length<2){if("string"==typeof Ne)return this.node()[Ne];for(Ge in Ne)this.each(d3_selection_property(Ge,Ne[Ge]));return this}return this.each(d3_selection_property(Ne,Ge))},mr.text=function(Ne){return arguments.length?this.each("function"==typeof Ne?function(){var Ge=Ne.apply(this,arguments);this.textContent=null==Ge?"":Ge}:null==Ne?function(){this.textContent=""}:function(){this.textContent=Ne}):this.node().textContent},mr.html=function(Ne){return arguments.length?this.each("function"==typeof Ne?function(){var Ge=Ne.apply(this,arguments);this.innerHTML=null==Ge?"":Ge}:null==Ne?function(){this.innerHTML=""}:function(){this.innerHTML=Ne}):this.node().innerHTML},mr.append=function(Ne){return Ne=d3_selection_creator(Ne),this.select((function(){return this.appendChild(Ne.apply(this,arguments))}))},mr.insert=function(Ne,Ge){return Ne=d3_selection_creator(Ne),Ge=d3_selection_selector(Ge),this.select((function(){return this.insertBefore(Ne.apply(this,arguments),Ge.apply(this,arguments)||null)}))},mr.remove=function(){return this.each(d3_selectionRemove)},mr.data=function(Ne,Ge){var Qe,tt,rt=-1,nt=this.length;if(!arguments.length){for(Ne=new Array(nt=(Qe=this[0]).length);++rt<nt;)(tt=Qe[rt])&&(Ne[rt]=tt.__data__);return Ne}function bind(Ne,Qe){var tt,rt,nt,dt=Ne.length,ht=Qe.length,Dt=Math.min(dt,ht),Ot=new Array(ht),Rt=new Array(ht),Zt=new Array(dt);if(Ge){var er,dr=new d3_Map,mr=new Array(dt);for(tt=-1;++tt<dt;)(rt=Ne[tt])&&(dr.has(er=Ge.call(rt,rt.__data__,tt))?Zt[tt]=rt:dr.set(er,rt),mr[tt]=er);for(tt=-1;++tt<ht;)(rt=dr.get(er=Ge.call(Qe,nt=Qe[tt],tt)))?!0!==rt&&(Ot[tt]=rt,rt.__data__=nt):Rt[tt]=d3_selection_dataNode(nt),dr.set(er,!0);for(tt=-1;++tt<dt;)tt in mr&&!0!==dr.get(mr[tt])&&(Zt[tt]=Ne[tt])}else{for(tt=-1;++tt<Dt;)rt=Ne[tt],nt=Qe[tt],rt?(rt.__data__=nt,Ot[tt]=rt):Rt[tt]=d3_selection_dataNode(nt);for(;tt<ht;++tt)Rt[tt]=d3_selection_dataNode(Qe[tt]);for(;tt<dt;++tt)Zt[tt]=Ne[tt]}Rt.update=Ot,Rt.parentNode=Ot.parentNode=Zt.parentNode=Ne.parentNode,at.push(Rt),it.push(Ot),ot.push(Zt)}var at=d3_selection_enter([]),it=d3_selection([]),ot=d3_selection([]);if("function"==typeof Ne)for(;++rt<nt;)bind(Qe=this[rt],Ne.call(Qe,Qe.parentNode.__data__,rt));else for(;++rt<nt;)bind(Qe=this[rt],Ne);return it.enter=function(){return at},it.exit=function(){return ot},it},mr.datum=function(Ne){return arguments.length?this.property("__data__",Ne):this.property("__data__")},mr.filter=function(Ne){var Ge,Qe,tt,rt=[];"function"!=typeof Ne&&(Ne=d3_selection_filter(Ne));for(var nt=0,at=this.length;nt<at;nt++){rt.push(Ge=[]),Ge.parentNode=(Qe=this[nt]).parentNode;for(var it=0,ot=Qe.length;it<ot;it++)(tt=Qe[it])&&Ne.call(tt,tt.__data__,it,nt)&&Ge.push(tt)}return d3_selection(rt)},mr.order=function(){for(var Ne=-1,Ge=this.length;++Ne<Ge;)for(var Qe,tt=this[Ne],rt=tt.length-1,nt=tt[rt];--rt>=0;)(Qe=tt[rt])&&(nt&&nt!==Qe.nextSibling&&nt.parentNode.insertBefore(Qe,nt),nt=Qe);return this},mr.sort=function(Ne){Ne=d3_selection_sortComparator.apply(this,arguments);for(var Ge=-1,Qe=this.length;++Ge<Qe;)this[Ge].sort(Ne);return this.order()},mr.each=function(Ne){return d3_selection_each(this,(function(Ge,Qe,tt){Ne.call(Ge,Ge.__data__,Qe,tt)}))},mr.call=function(Ne){var Ge=d3_array(arguments);return Ne.apply(Ge[0]=this,Ge),this},mr.empty=function(){return!this.node()},mr.node=function(){for(var Ne=0,Ge=this.length;Ne<Ge;Ne++)for(var Qe=this[Ne],tt=0,rt=Qe.length;tt<rt;tt++){var nt=Qe[tt];if(nt)return nt}return null},mr.size=function(){var Ne=0;return d3_selection_each(this,(function(){++Ne})),Ne};var Ar=[];function d3_selection_enterInsertBefore(Ne){var Ge,Qe;return function(tt,rt,nt){var at,it=Ne[nt].update,ot=it.length;for(nt!=Qe&&(Qe=nt,Ge=0),rt>=Ge&&(Ge=rt+1);!(at=it[Ge])&&++Ge<ot;);return at}}function d3_selection_on(Ge,Qe,tt){var rt="__on"+Ge,nt=Ge.indexOf("."),at=d3_selection_onListener;nt>0&&(Ge=Ge.slice(0,nt));var it=en.get(Ge);function onRemove(){var Ne=this[rt];Ne&&(this.removeEventListener(Ge,Ne,Ne.$),delete this[rt])}function onAdd(){var Ne=at(Qe,d3_array(arguments));onRemove.call(this),this.addEventListener(Ge,this[rt]=Ne,Ne.$=tt),Ne._=Qe}function removeAll(){var Qe,tt=new RegExp("^__on([^.]+)"+Ne.requote(Ge)+"$");for(var rt in this)if(Qe=rt.match(tt)){var nt=this[rt];this.removeEventListener(Qe[1],nt,nt.$),delete this[rt]}}return it&&(Ge=it,at=d3_selection_onFilter),nt?Qe?onAdd:onRemove:Qe?d3_noop:removeAll}Ne.selection.enter=d3_selection_enter,Ne.selection.enter.prototype=Ar,Ar.append=mr.append,Ar.empty=mr.empty,Ar.node=mr.node,Ar.call=mr.call,Ar.size=mr.size,Ar.select=function(Ne){for(var Ge,Qe,tt,rt,nt,at=[],it=-1,ot=this.length;++it<ot;){tt=(rt=this[it]).update,at.push(Ge=[]),Ge.parentNode=rt.parentNode;for(var dt=-1,ht=rt.length;++dt<ht;)(nt=rt[dt])?(Ge.push(tt[dt]=Qe=Ne.call(rt.parentNode,nt.__data__,dt,it)),Qe.__data__=nt.__data__):Ge.push(null)}return d3_selection(at)},Ar.insert=function(Ne,Ge){return arguments.length<2&&(Ge=d3_selection_enterInsertBefore(this)),mr.insert.call(this,Ne,Ge)},Ne.select=function(Ne){var Ge;return"string"==typeof Ne?(Ge=[d3_select(Ne,rt)]).parentNode=rt.documentElement:(Ge=[Ne]).parentNode=d3_documentElement(Ne),d3_selection([Ge])},Ne.selectAll=function(Ne){var Ge;return"string"==typeof Ne?(Ge=d3_array(d3_selectAll(Ne,rt))).parentNode=rt.documentElement:(Ge=d3_array(Ne)).parentNode=null,d3_selection([Ge])},mr.on=function(Ne,Ge,Qe){var tt=arguments.length;if(tt<3){if("string"!=typeof Ne){for(Qe in tt<2&&(Ge=!1),Ne)this.each(d3_selection_on(Qe,Ne[Qe],Ge));return this}if(tt<2)return(tt=this.node()["__on"+Ne])&&tt._;Qe=!1}return this.each(d3_selection_on(Ne,Ge,Qe))};var en=Ne.map({mouseenter:"mouseover",mouseleave:"mouseout"});function d3_selection_onListener(Ge,Qe){return function(tt){var rt=Ne.event;Ne.event=tt,Qe[0]=this.__data__;try{Ge.apply(this,Qe)}finally{Ne.event=rt}}}function d3_selection_onFilter(Ne,Ge){var Qe=d3_selection_onListener(Ne,Ge);return function(Ne){var Ge=this,tt=Ne.relatedTarget;tt&&(tt===Ge||8&tt.compareDocumentPosition(Ge))||Qe.call(Ge,Ne)}}rt&&en.forEach((function(Ne){"on"+Ne in rt&&en.remove(Ne)}));var mn,xn=0;function d3_event_dragSuppress(Ge){var Qe=".dragsuppress-"+ ++xn,tt="click"+Qe,rt=Ne.select(d3_window(Ge)).on("touchmove"+Qe,d3_eventPreventDefault).on("dragstart"+Qe,d3_eventPreventDefault).on("selectstart"+Qe,d3_eventPreventDefault);if(null==mn&&(mn=!("onselectstart"in Ge)&&d3_vendorSymbol(Ge.style,"userSelect")),mn){var nt=d3_documentElement(Ge).style,at=nt[mn];nt[mn]="none"}return function(Ne){if(rt.on(Qe,null),mn&&(nt[mn]=at),Ne){var off=function(){rt.on(tt,null)};rt.on(tt,(function(){d3_eventPreventDefault(),off()}),!0),setTimeout(off,0)}}}Ne.mouse=function(Ne){return d3_mousePoint(Ne,d3_eventSource())};var kn=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;function d3_mousePoint(Ge,Qe){Qe.changedTouches&&(Qe=Qe.changedTouches[0]);var tt=Ge.ownerSVGElement||Ge;if(tt.createSVGPoint){var rt=tt.createSVGPoint();if(kn<0){var nt=d3_window(Ge);if(nt.scrollX||nt.scrollY){var at=(tt=Ne.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();kn=!(at.f||at.e),tt.remove()}}return kn?(rt.x=Qe.pageX,rt.y=Qe.pageY):(rt.x=Qe.clientX,rt.y=Qe.clientY),[(rt=rt.matrixTransform(Ge.getScreenCTM().inverse())).x,rt.y]}var it=Ge.getBoundingClientRect();return[Qe.clientX-it.left-Ge.clientLeft,Qe.clientY-it.top-Ge.clientTop]}function d3_behavior_dragTouchId(){return Ne.event.changedTouches[0].identifier}Ne.touch=function(Ne,Ge,Qe){if(arguments.length<3&&(Qe=Ge,Ge=d3_eventSource().changedTouches),Ge)for(var tt,rt=0,nt=Ge.length;rt<nt;++rt)if((tt=Ge[rt]).identifier===Qe)return d3_mousePoint(Ne,tt)},Ne.behavior.drag=function(){var Ge=d3_eventDispatch(drag,"drag","dragstart","dragend"),Qe=null,tt=dragstart(d3_noop,Ne.mouse,d3_window,"mousemove","mouseup"),rt=dragstart(d3_behavior_dragTouchId,Ne.touch,d3_identity,"touchmove","touchend");function drag(){this.on("mousedown.drag",tt).on("touchstart.drag",rt)}function dragstart(tt,rt,nt,at,it){return function(){var ot,dt=this,ht=Ne.event.target.correspondingElement||Ne.event.target,Dt=dt.parentNode,Ot=Ge.of(dt,arguments),Rt=0,Zt=tt(),er=".drag"+(null==Zt?"":"-"+Zt),dr=Ne.select(nt(ht)).on(at+er,moved).on(it+er,ended),mr=d3_event_dragSuppress(ht),xr=rt(Dt,Zt);function moved(){var Ne,Ge,Qe=rt(Dt,Zt);Qe&&(Ne=Qe[0]-xr[0],Ge=Qe[1]-xr[1],Rt|=Ne|Ge,xr=Qe,Ot({type:"drag",x:Qe[0]+ot[0],y:Qe[1]+ot[1],dx:Ne,dy:Ge}))}function ended(){rt(Dt,Zt)&&(dr.on(at+er,null).on(it+er,null),mr(Rt),Ot({type:"dragend"}))}ot=Qe?[(ot=Qe.apply(dt,arguments)).x-xr[0],ot.y-xr[1]]:[0,0],Ot({type:"dragstart"})}}return drag.origin=function(Ne){return arguments.length?(Qe=Ne,drag):Qe},Ne.rebind(drag,Ge,"on")},Ne.touches=function(Ne,Ge){return arguments.length<2&&(Ge=d3_eventSource().touches),Ge?d3_array(Ge).map((function(Ge){var Qe=d3_mousePoint(Ne,Ge);return Qe.identifier=Ge.identifier,Qe})):[]};var Cn=1e-6,En=Cn*Cn,Pn=Math.PI,Dn=2*Pn,In=Dn-Cn,zn=Pn/2,Bn=Pn/180,Vn=180/Pn;function d3_sgn(Ne){return Ne>0?1:Ne<0?-1:0}function d3_cross2d(Ne,Ge,Qe){return(Ge[0]-Ne[0])*(Qe[1]-Ne[1])-(Ge[1]-Ne[1])*(Qe[0]-Ne[0])}function d3_acos(Ne){return Ne>1?0:Ne<-1?Pn:Math.acos(Ne)}function d3_asin(Ne){return Ne>1?zn:Ne<-1?-zn:Math.asin(Ne)}function d3_sinh(Ne){return((Ne=Math.exp(Ne))-1/Ne)/2}function d3_cosh(Ne){return((Ne=Math.exp(Ne))+1/Ne)/2}function d3_tanh(Ne){return((Ne=Math.exp(2*Ne))-1)/(Ne+1)}function d3_haversin(Ne){return(Ne=Math.sin(Ne/2))*Ne}var Hn=Math.SQRT2,qn=2,Yn=4;Ne.interpolateZoom=function(Ne,Ge){var Qe,tt,rt=Ne[0],nt=Ne[1],at=Ne[2],it=Ge[0],ot=Ge[1],dt=Ge[2],ht=it-rt,Dt=ot-nt,Ot=ht*ht+Dt*Dt;if(Ot<En)tt=Math.log(dt/at)/Hn,Qe=function(Ne){return[rt+Ne*ht,nt+Ne*Dt,at*Math.exp(Hn*Ne*tt)]};else{var Rt=Math.sqrt(Ot),Zt=(dt*dt-at*at+Yn*Ot)/(2*at*qn*Rt),er=(dt*dt-at*at-Yn*Ot)/(2*dt*qn*Rt),dr=Math.log(Math.sqrt(Zt*Zt+1)-Zt),mr=Math.log(Math.sqrt(er*er+1)-er);tt=(mr-dr)/Hn,Qe=function(Ne){var Ge=Ne*tt,Qe=d3_cosh(dr),it=at/(qn*Rt)*(Qe*d3_tanh(Hn*Ge+dr)-d3_sinh(dr));return[rt+it*ht,nt+it*Dt,at*Qe/d3_cosh(Hn*Ge+dr)]}}return Qe.duration=1e3*tt,Qe},Ne.behavior.zoom=function(){var Ge,Qe,tt,nt,at,it,ot,dt,ht,Dt={x:0,y:0,k:1},Ot=[960,500],Rt=oa,Zt=250,er=0,dr="mousedown.zoom",mr="mousemove.zoom",xr="mouseup.zoom",br="touchstart.zoom",Ar=d3_eventDispatch(zoom,"zoomstart","zoom","zoomend");function zoom(Ne){Ne.on(dr,mousedowned).on(ra+".zoom",mousewheeled).on("dblclick.zoom",dblclicked).on(br,touchstarted)}function location(Ne){return[(Ne[0]-Dt.x)/Dt.k,(Ne[1]-Dt.y)/Dt.k]}function point(Ne){return[Ne[0]*Dt.k+Dt.x,Ne[1]*Dt.k+Dt.y]}function scaleTo(Ne){Dt.k=Math.max(Rt[0],Math.min(Rt[1],Ne))}function translateTo(Ne,Ge){Ge=point(Ge),Dt.x+=Ne[0]-Ge[0],Dt.y+=Ne[1]-Ge[1]}function zoomTo(Ge,tt,rt,nt){Ge.__chart__={x:Dt.x,y:Dt.y,k:Dt.k},scaleTo(Math.pow(2,nt)),translateTo(Qe=tt,rt),Ge=Ne.select(Ge),Zt>0&&(Ge=Ge.transition().duration(Zt)),Ge.call(zoom.event)}function rescale(){ot&&ot.domain(it.range().map((function(Ne){return(Ne-Dt.x)/Dt.k})).map(it.invert)),ht&&ht.domain(dt.range().map((function(Ne){return(Ne-Dt.y)/Dt.k})).map(dt.invert))}function zoomstarted(Ne){er++||Ne({type:"zoomstart"})}function zoomed(Ne){rescale(),Ne({type:"zoom",scale:Dt.k,translate:[Dt.x,Dt.y]})}function zoomended(Ne){--er||(Ne({type:"zoomend"}),Qe=null)}function mousedowned(){var Ge=this,Qe=Ar.of(Ge,arguments),tt=0,rt=Ne.select(d3_window(Ge)).on(mr,moved).on(xr,ended),nt=location(Ne.mouse(Ge)),at=d3_event_dragSuppress(Ge);function moved(){tt=1,translateTo(Ne.mouse(Ge),nt),zoomed(Qe)}function ended(){rt.on(mr,null).on(xr,null),at(tt),zoomended(Qe)}Rc.call(Ge),zoomstarted(Qe)}function touchstarted(){var Ge,Qe=this,tt=Ar.of(Qe,arguments),rt={},nt=0,it=".zoom-"+Ne.event.changedTouches[0].identifier,ot="touchmove"+it,dt="touchend"+it,ht=[],Ot=Ne.select(Qe),Rt=d3_event_dragSuppress(Qe);function relocate(){var tt=Ne.touches(Qe);return Ge=Dt.k,tt.forEach((function(Ne){Ne.identifier in rt&&(rt[Ne.identifier]=location(Ne))})),tt}function started(){var Ge=Ne.event.target;Ne.select(Ge).on(ot,moved).on(dt,ended),ht.push(Ge);for(var tt=Ne.event.changedTouches,it=0,Ot=tt.length;it<Ot;++it)rt[tt[it].identifier]=null;var Rt=relocate(),Zt=Date.now();if(1===Rt.length){if(Zt-at<500){var er=Rt[0];zoomTo(Qe,er,rt[er.identifier],Math.floor(Math.log(Dt.k)/Math.LN2)+1),d3_eventPreventDefault()}at=Zt}else if(Rt.length>1){er=Rt[0];var dr=Rt[1],mr=er[0]-dr[0],xr=er[1]-dr[1];nt=mr*mr+xr*xr}}function moved(){var it,ot,dt,ht,Dt=Ne.touches(Qe);Rc.call(Qe);for(var Ot=0,Rt=Dt.length;Ot<Rt;++Ot,ht=null)if(dt=Dt[Ot],ht=rt[dt.identifier]){if(ot)break;it=dt,ot=ht}if(ht){var Zt=(Zt=dt[0]-it[0])*Zt+(Zt=dt[1]-it[1])*Zt,er=nt&&Math.sqrt(Zt/nt);it=[(it[0]+dt[0])/2,(it[1]+dt[1])/2],ot=[(ot[0]+ht[0])/2,(ot[1]+ht[1])/2],scaleTo(er*Ge)}at=null,translateTo(it,ot),zoomed(tt)}function ended(){if(Ne.event.touches.length){for(var Ge=Ne.event.changedTouches,Qe=0,nt=Ge.length;Qe<nt;++Qe)delete rt[Ge[Qe].identifier];for(var at in rt)return void relocate()}Ne.selectAll(ht).on(it,null),Ot.on(dr,mousedowned).on(br,touchstarted),Rt(),zoomended(tt)}started(),zoomstarted(tt),Ot.on(dr,null).on(br,started)}function mousewheeled(){var rt=Ar.of(this,arguments);nt?clearTimeout(nt):(Rc.call(this),Ge=location(Qe=tt||Ne.mouse(this)),zoomstarted(rt)),nt=setTimeout((function(){nt=null,zoomended(rt)}),50),d3_eventPreventDefault(),scaleTo(Math.pow(2,.002*$n())*Dt.k),translateTo(Qe,Ge),zoomed(rt)}function dblclicked(){var Ge=Ne.mouse(this),Qe=Math.log(Dt.k)/Math.LN2;zoomTo(this,Ge,location(Ge),Ne.event.shiftKey?Math.ceil(Qe)-1:Math.floor(Qe)+1)}return ra||(ra="onwheel"in rt?($n=function(){return-Ne.event.deltaY*(Ne.event.deltaMode?120:1)},"wheel"):"onmousewheel"in rt?($n=function(){return Ne.event.wheelDelta},"mousewheel"):($n=function(){return-Ne.event.detail},"MozMousePixelScroll")),zoom.event=function(Ge){Ge.each((function(){var Ge=Ar.of(this,arguments),tt=Dt;Bc?Ne.select(this).transition().each("start.zoom",(function(){Dt=this.__chart__||{x:0,y:0,k:1},zoomstarted(Ge)})).tween("zoom:zoom",(function(){var rt=Ot[0],nt=Ot[1],at=Qe?Qe[0]:rt/2,it=Qe?Qe[1]:nt/2,ot=Ne.interpolateZoom([(at-Dt.x)/Dt.k,(it-Dt.y)/Dt.k,rt/Dt.k],[(at-tt.x)/tt.k,(it-tt.y)/tt.k,rt/tt.k]);return function(Ne){var Qe=ot(Ne),tt=rt/Qe[2];this.__chart__=Dt={x:at-Qe[0]*tt,y:it-Qe[1]*tt,k:tt},zoomed(Ge)}})).each("interrupt.zoom",(function(){zoomended(Ge)})).each("end.zoom",(function(){zoomended(Ge)})):(this.__chart__=Dt,zoomstarted(Ge),zoomed(Ge),zoomended(Ge))}))},zoom.translate=function(Ne){return arguments.length?(Dt={x:+Ne[0],y:+Ne[1],k:Dt.k},rescale(),zoom):[Dt.x,Dt.y]},zoom.scale=function(Ne){return arguments.length?(Dt={x:Dt.x,y:Dt.y,k:null},scaleTo(+Ne),rescale(),zoom):Dt.k},zoom.scaleExtent=function(Ne){return arguments.length?(Rt=null==Ne?oa:[+Ne[0],+Ne[1]],zoom):Rt},zoom.center=function(Ne){return arguments.length?(tt=Ne&&[+Ne[0],+Ne[1]],zoom):tt},zoom.size=function(Ne){return arguments.length?(Ot=Ne&&[+Ne[0],+Ne[1]],zoom):Ot},zoom.duration=function(Ne){return arguments.length?(Zt=+Ne,zoom):Zt},zoom.x=function(Ne){return arguments.length?(ot=Ne,it=Ne.copy(),Dt={x:0,y:0,k:1},zoom):ot},zoom.y=function(Ne){return arguments.length?(ht=Ne,dt=Ne.copy(),Dt={x:0,y:0,k:1},zoom):ht},Ne.rebind(zoom,Ar,"on")};var $n,ra,oa=[0,1/0];function d3_color(){}function d3_hsl(Ne,Ge,Qe){return this instanceof d3_hsl?(this.h=+Ne,this.s=+Ge,void(this.l=+Qe)):arguments.length<2?Ne instanceof d3_hsl?new d3_hsl(Ne.h,Ne.s,Ne.l):d3_rgb_parse(""+Ne,d3_rgb_hsl,d3_hsl):new d3_hsl(Ne,Ge,Qe)}Ne.color=d3_color,d3_color.prototype.toString=function(){return this.rgb()+""},Ne.hsl=d3_hsl;var pa=d3_hsl.prototype=new d3_color;function d3_hsl_rgb(Ne,Ge,Qe){var tt,rt;function v(Ne){return Ne>360?Ne-=360:Ne<0&&(Ne+=360),Ne<60?tt+(rt-tt)*Ne/60:Ne<180?rt:Ne<240?tt+(rt-tt)*(240-Ne)/60:tt}function vv(Ne){return Math.round(255*v(Ne))}return Ne=isNaN(Ne)?0:(Ne%=360)<0?Ne+360:Ne,Ge=isNaN(Ge)||Ge<0?0:Ge>1?1:Ge,tt=2*(Qe=Qe<0?0:Qe>1?1:Qe)-(rt=Qe<=.5?Qe*(1+Ge):Qe+Ge-Qe*Ge),new d3_rgb(vv(Ne+120),vv(Ne),vv(Ne-120))}function d3_hcl(Ge,Qe,tt){return this instanceof d3_hcl?(this.h=+Ge,this.c=+Qe,void(this.l=+tt)):arguments.length<2?Ge instanceof d3_hcl?new d3_hcl(Ge.h,Ge.c,Ge.l):d3_lab_hcl(Ge instanceof d3_lab?Ge.l:(Ge=d3_rgb_lab((Ge=Ne.rgb(Ge)).r,Ge.g,Ge.b)).l,Ge.a,Ge.b):new d3_hcl(Ge,Qe,tt)}pa.brighter=function(Ne){return Ne=Math.pow(.7,arguments.length?Ne:1),new d3_hsl(this.h,this.s,this.l/Ne)},pa.darker=function(Ne){return Ne=Math.pow(.7,arguments.length?Ne:1),new d3_hsl(this.h,this.s,Ne*this.l)},pa.rgb=function(){return d3_hsl_rgb(this.h,this.s,this.l)},Ne.hcl=d3_hcl;var ga=d3_hcl.prototype=new d3_color;function d3_hcl_lab(Ne,Ge,Qe){return isNaN(Ne)&&(Ne=0),isNaN(Ge)&&(Ge=0),new d3_lab(Qe,Math.cos(Ne*=Bn)*Ge,Math.sin(Ne)*Ge)}function d3_lab(Ne,Ge,Qe){return this instanceof d3_lab?(this.l=+Ne,this.a=+Ge,void(this.b=+Qe)):arguments.length<2?Ne instanceof d3_lab?new d3_lab(Ne.l,Ne.a,Ne.b):Ne instanceof d3_hcl?d3_hcl_lab(Ne.h,Ne.c,Ne.l):d3_rgb_lab((Ne=d3_rgb(Ne)).r,Ne.g,Ne.b):new d3_lab(Ne,Ge,Qe)}ga.brighter=function(Ne){return new d3_hcl(this.h,this.c,Math.min(100,this.l+ma*(arguments.length?Ne:1)))},ga.darker=function(Ne){return new d3_hcl(this.h,this.c,Math.max(0,this.l-ma*(arguments.length?Ne:1)))},ga.rgb=function(){return d3_hcl_lab(this.h,this.c,this.l).rgb()},Ne.lab=d3_lab;var ma=18,_a=.95047,Va=1,Wa=1.08883,Qa=d3_lab.prototype=new d3_color;function d3_lab_rgb(Ne,Ge,Qe){var tt=(Ne+16)/116,rt=tt+Ge/500,nt=tt-Qe/200;return new d3_rgb(d3_xyz_rgb(3.2404542*(rt=d3_lab_xyz(rt)*_a)-1.5371385*(tt=d3_lab_xyz(tt)*Va)-.4985314*(nt=d3_lab_xyz(nt)*Wa)),d3_xyz_rgb(-.969266*rt+1.8760108*tt+.041556*nt),d3_xyz_rgb(.0556434*rt-.2040259*tt+1.0572252*nt))}function d3_lab_hcl(Ne,Ge,Qe){return Ne>0?new d3_hcl(Math.atan2(Qe,Ge)*Vn,Math.sqrt(Ge*Ge+Qe*Qe),Ne):new d3_hcl(NaN,NaN,Ne)}function d3_lab_xyz(Ne){return Ne>.206893034?Ne*Ne*Ne:(Ne-4/29)/7.787037}function d3_xyz_lab(Ne){return Ne>.008856?Math.pow(Ne,1/3):7.787037*Ne+4/29}function d3_xyz_rgb(Ne){return Math.round(255*(Ne<=.00304?12.92*Ne:1.055*Math.pow(Ne,1/2.4)-.055))}function d3_rgb(Ne,Ge,Qe){return this instanceof d3_rgb?(this.r=~~Ne,this.g=~~Ge,void(this.b=~~Qe)):arguments.length<2?Ne instanceof d3_rgb?new d3_rgb(Ne.r,Ne.g,Ne.b):d3_rgb_parse(""+Ne,d3_rgb,d3_hsl_rgb):new d3_rgb(Ne,Ge,Qe)}function d3_rgbNumber(Ne){return new d3_rgb(Ne>>16,Ne>>8&255,255&Ne)}function d3_rgbString(Ne){return d3_rgbNumber(Ne)+""}Qa.brighter=function(Ne){return new d3_lab(Math.min(100,this.l+ma*(arguments.length?Ne:1)),this.a,this.b)},Qa.darker=function(Ne){return new d3_lab(Math.max(0,this.l-ma*(arguments.length?Ne:1)),this.a,this.b)},Qa.rgb=function(){return d3_lab_rgb(this.l,this.a,this.b)},Ne.rgb=d3_rgb;var ti=d3_rgb.prototype=new d3_color;function d3_rgb_hex(Ne){return Ne<16?"0"+Math.max(0,Ne).toString(16):Math.min(255,Ne).toString(16)}function d3_rgb_parse(Ne,Ge,Qe){var tt,rt,nt,at=0,it=0,ot=0;if(tt=/([a-z]+)\((.*)\)/.exec(Ne=Ne.toLowerCase()))switch(rt=tt[2].split(","),tt[1]){case"hsl":return Qe(parseFloat(rt[0]),parseFloat(rt[1])/100,parseFloat(rt[2])/100);case"rgb":return Ge(d3_rgb_parseNumber(rt[0]),d3_rgb_parseNumber(rt[1]),d3_rgb_parseNumber(rt[2]))}return(nt=ni.get(Ne))?Ge(nt.r,nt.g,nt.b):(null==Ne||"#"!==Ne.charAt(0)||isNaN(nt=parseInt(Ne.slice(1),16))||(4===Ne.length?(at=(3840&nt)>>4,at|=at>>4,it=240&nt,it|=it>>4,ot=15&nt,ot|=ot<<4):7===Ne.length&&(at=(16711680&nt)>>16,it=(65280&nt)>>8,ot=255&nt)),Ge(at,it,ot))}function d3_rgb_hsl(Ne,Ge,Qe){var tt,rt,nt=Math.min(Ne/=255,Ge/=255,Qe/=255),at=Math.max(Ne,Ge,Qe),it=at-nt,ot=(at+nt)/2;return it?(rt=ot<.5?it/(at+nt):it/(2-at-nt),tt=Ne==at?(Ge-Qe)/it+(Ge<Qe?6:0):Ge==at?(Qe-Ne)/it+2:(Ne-Ge)/it+4,tt*=60):(tt=NaN,rt=ot>0&&ot<1?0:tt),new d3_hsl(tt,rt,ot)}function d3_rgb_lab(Ne,Ge,Qe){var tt=d3_xyz_lab((.4124564*(Ne=d3_rgb_xyz(Ne))+.3575761*(Ge=d3_rgb_xyz(Ge))+.1804375*(Qe=d3_rgb_xyz(Qe)))/_a),rt=d3_xyz_lab((.2126729*Ne+.7151522*Ge+.072175*Qe)/Va);return d3_lab(116*rt-16,500*(tt-rt),200*(rt-d3_xyz_lab((.0193339*Ne+.119192*Ge+.9503041*Qe)/Wa)))}function d3_rgb_xyz(Ne){return(Ne/=255)<=.04045?Ne/12.92:Math.pow((Ne+.055)/1.055,2.4)}function d3_rgb_parseNumber(Ne){var Ge=parseFloat(Ne);return"%"===Ne.charAt(Ne.length-1)?Math.round(2.55*Ge):Ge}ti.brighter=function(Ne){Ne=Math.pow(.7,arguments.length?Ne:1);var Ge=this.r,Qe=this.g,tt=this.b,rt=30;return Ge||Qe||tt?(Ge&&Ge<rt&&(Ge=rt),Qe&&Qe<rt&&(Qe=rt),tt&&tt<rt&&(tt=rt),new d3_rgb(Math.min(255,Ge/Ne),Math.min(255,Qe/Ne),Math.min(255,tt/Ne))):new d3_rgb(rt,rt,rt)},ti.darker=function(Ne){return new d3_rgb((Ne=Math.pow(.7,arguments.length?Ne:1))*this.r,Ne*this.g,Ne*this.b)},ti.hsl=function(){return d3_rgb_hsl(this.r,this.g,this.b)},ti.toString=function(){return"#"+d3_rgb_hex(this.r)+d3_rgb_hex(this.g)+d3_rgb_hex(this.b)};var ni=Ne.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});function d3_functor(Ne){return"function"==typeof Ne?Ne:function(){return Ne}}function d3_xhrType(Ne){return function(Ge,Qe,tt){return 2===arguments.length&&"function"==typeof Qe&&(tt=Qe,Qe=null),d3_xhr(Ge,Qe,Ne,tt)}}function d3_xhr(Ge,Qe,tt,rt){var nt={},at=Ne.dispatch("beforesend","progress","load","error"),it={},ot=new XMLHttpRequest,dt=null;function respond(){var Ne,Ge=ot.status;if(!Ge&&d3_xhrHasResponse(ot)||Ge>=200&&Ge<300||304===Ge){try{Ne=tt.call(nt,ot)}catch(Ne){return void at.error.call(nt,Ne)}at.load.call(nt,Ne)}else at.error.call(nt,ot)}return this.XDomainRequest&&!("withCredentials"in ot)&&/^(http(s)?:)?\/\//.test(Ge)&&(ot=new XDomainRequest),"onload"in ot?ot.onload=ot.onerror=respond:ot.onreadystatechange=function(){ot.readyState>3&&respond()},ot.onprogress=function(Ge){var Qe=Ne.event;Ne.event=Ge;try{at.progress.call(nt,ot)}finally{Ne.event=Qe}},nt.header=function(Ne,Ge){return Ne=(Ne+"").toLowerCase(),arguments.length<2?it[Ne]:(null==Ge?delete it[Ne]:it[Ne]=Ge+"",nt)},nt.mimeType=function(Ne){return arguments.length?(Qe=null==Ne?null:Ne+"",nt):Qe},nt.responseType=function(Ne){return arguments.length?(dt=Ne,nt):dt},nt.response=function(Ne){return tt=Ne,nt},["get","post"].forEach((function(Ne){nt[Ne]=function(){return nt.send.apply(nt,[Ne].concat(d3_array(arguments)))}})),nt.send=function(Ne,tt,rt){if(2===arguments.length&&"function"==typeof tt&&(rt=tt,tt=null),ot.open(Ne,Ge,!0),null==Qe||"accept"in it||(it.accept=Qe+",*/*"),ot.setRequestHeader)for(var ht in it)ot.setRequestHeader(ht,it[ht]);return null!=Qe&&ot.overrideMimeType&&ot.overrideMimeType(Qe),null!=dt&&(ot.responseType=dt),null!=rt&&nt.on("error",rt).on("load",(function(Ne){rt(null,Ne)})),at.beforesend.call(nt,ot),ot.send(null==tt?null:tt),nt},nt.abort=function(){return ot.abort(),nt},Ne.rebind(nt,at,"on"),null==rt?nt:nt.get(d3_xhr_fixCallback(rt))}function d3_xhr_fixCallback(Ne){return 1===Ne.length?function(Ge,Qe){Ne(null==Ge?Qe:null)}:Ne}function d3_xhrHasResponse(Ne){var Ge=Ne.responseType;return Ge&&"text"!==Ge?Ne.response:Ne.responseText}ni.forEach((function(Ne,Ge){ni.set(Ne,d3_rgbNumber(Ge))})),Ne.functor=d3_functor,Ne.xhr=d3_xhrType(d3_identity),Ne.dsv=function(Ne,Ge){var Qe=new RegExp('["'+Ne+"\n]"),tt=Ne.charCodeAt(0);function dsv(Ne,Qe,tt){arguments.length<3&&(tt=Qe,Qe=null);var rt=d3_xhr(Ne,Ge,null==Qe?response:typedResponse(Qe),tt);return rt.row=function(Ne){return arguments.length?rt.response(null==(Qe=Ne)?response:typedResponse(Ne)):Qe},rt}function response(Ne){return dsv.parse(Ne.responseText)}function typedResponse(Ne){return function(Ge){return dsv.parse(Ge.responseText,Ne)}}function formatRow(Ge){return Ge.map(formatValue).join(Ne)}function formatValue(Ne){return Qe.test(Ne)?'"'+Ne.replace(/\"/g,'""')+'"':Ne}return dsv.parse=function(Ne,Ge){var Qe;return dsv.parseRows(Ne,(function(Ne,tt){if(Qe)return Qe(Ne,tt-1);var rt=new Function("d","return {"+Ne.map((function(Ne,Ge){return JSON.stringify(Ne)+": d["+Ge+"]"})).join(",")+"}");Qe=Ge?function(Ne,Qe){return Ge(rt(Ne),Qe)}:rt}))},dsv.parseRows=function(Ne,Ge){var Qe,rt,nt={},at={},it=[],ot=Ne.length,dt=0,ht=0;function token(){if(dt>=ot)return at;if(rt)return rt=!1,nt;var Ge=dt;if(34===Ne.charCodeAt(Ge)){for(var Qe=Ge;Qe++<ot;)if(34===Ne.charCodeAt(Qe)){if(34!==Ne.charCodeAt(Qe+1))break;++Qe}return dt=Qe+2,13===(it=Ne.charCodeAt(Qe+1))?(rt=!0,10===Ne.charCodeAt(Qe+2)&&++dt):10===it&&(rt=!0),Ne.slice(Ge+1,Qe).replace(/""/g,'"')}for(;dt<ot;){var it,ht=1;if(10===(it=Ne.charCodeAt(dt++)))rt=!0;else if(13===it)rt=!0,10===Ne.charCodeAt(dt)&&(++dt,++ht);else if(it!==tt)continue;return Ne.slice(Ge,dt-ht)}return Ne.slice(Ge)}for(;(Qe=token())!==at;){for(var Dt=[];Qe!==nt&&Qe!==at;)Dt.push(Qe),Qe=token();Ge&&null==(Dt=Ge(Dt,ht++))||it.push(Dt)}return it},dsv.format=function(Ge){if(Array.isArray(Ge[0]))return dsv.formatRows(Ge);var Qe=new d3_Set,tt=[];return Ge.forEach((function(Ne){for(var Ge in Ne)Qe.has(Ge)||tt.push(Qe.add(Ge))})),[tt.map(formatValue).join(Ne)].concat(Ge.map((function(Ge){return tt.map((function(Ne){return formatValue(Ge[Ne])})).join(Ne)}))).join("\n")},dsv.formatRows=function(Ne){return Ne.map(formatRow).join("\n")},dsv},Ne.csv=Ne.dsv(",","text/csv"),Ne.tsv=Ne.dsv("\t","text/tab-separated-values");var di,ji,Hi,Yi,uo=this[d3_vendorSymbol(this,"requestAnimationFrame")]||function(Ne){setTimeout(Ne,17)};function d3_timer(Ne,Ge,Qe){var tt=arguments.length;tt<2&&(Ge=0),tt<3&&(Qe=Date.now());var rt={c:Ne,t:Qe+Ge,n:null};return ji?ji.n=rt:di=rt,ji=rt,Hi||(Yi=clearTimeout(Yi),Hi=1,uo(d3_timer_step)),rt}function d3_timer_step(){var Ne=d3_timer_mark(),Ge=d3_timer_sweep()-Ne;Ge>24?(isFinite(Ge)&&(clearTimeout(Yi),Yi=setTimeout(d3_timer_step,Ge)),Hi=0):(Hi=1,uo(d3_timer_step))}function d3_timer_mark(){for(var Ne=Date.now(),Ge=di;Ge;)Ne>=Ge.t&&Ge.c(Ne-Ge.t)&&(Ge.c=null),Ge=Ge.n;return Ne}function d3_timer_sweep(){for(var Ne,Ge=di,Qe=1/0;Ge;)Ge.c?(Ge.t<Qe&&(Qe=Ge.t),Ge=(Ne=Ge).n):Ge=Ne?Ne.n=Ge.n:di=Ge.n;return ji=Ne,Qe}function d3_format_precision(Ne,Ge){return Ge-(Ne?Math.ceil(Math.log(Ne)/Math.LN10):1)}Ne.timer=function(){d3_timer.apply(this,arguments)},Ne.timer.flush=function(){d3_timer_mark(),d3_timer_sweep()},Ne.round=function(Ne,Ge){return Ge?Math.round(Ne*(Ge=Math.pow(10,Ge)))/Ge:Math.round(Ne)};var go=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E","Z","Y"].map(d3_formatPrefix);function d3_formatPrefix(Ne,Ge){var Qe=Math.pow(10,3*Dt(8-Ge));return{scale:Ge>8?function(Ne){return Ne/Qe}:function(Ne){return Ne*Qe},symbol:Ne}}function d3_locale_numberFormat(Ge){var Qe=Ge.decimal,tt=Ge.thousands,rt=Ge.grouping,nt=Ge.currency,at=rt&&tt?function(Ne,Ge){for(var Qe=Ne.length,nt=[],at=0,it=rt[0],ot=0;Qe>0&&it>0&&(ot+it+1>Ge&&(it=Math.max(1,Ge-ot)),nt.push(Ne.substring(Qe-=it,Qe+it)),!((ot+=it+1)>Ge));)it=rt[at=(at+1)%rt.length];return nt.reverse().join(tt)}:d3_identity;return function(Ge){var tt=ns.exec(Ge),rt=tt[1]||" ",it=tt[2]||">",ot=tt[3]||"-",dt=tt[4]||"",ht=tt[5],Dt=+tt[6],Ot=tt[7],Rt=tt[8],Zt=tt[9],er=1,dr="",mr="",xr=!1,br=!0;switch(Rt&&(Rt=+Rt.substring(1)),(ht||"0"===rt&&"="===it)&&(ht=rt="0",it="="),Zt){case"n":Ot=!0,Zt="g";break;case"%":er=100,mr="%",Zt="f";break;case"p":er=100,mr="%",Zt="r";break;case"b":case"o":case"x":case"X":"#"===dt&&(dr="0"+Zt.toLowerCase());case"c":br=!1;case"d":xr=!0,Rt=0;break;case"s":er=-1,Zt="r"}"$"===dt&&(dr=nt[0],mr=nt[1]),"r"!=Zt||Rt||(Zt="g"),null!=Rt&&("g"==Zt?Rt=Math.max(1,Math.min(21,Rt)):"e"!=Zt&&"f"!=Zt||(Rt=Math.max(0,Math.min(20,Rt)))),Zt=as.get(Zt)||d3_format_typeDefault;var Ar=ht&&Ot;return function(Ge){var tt=mr;if(xr&&Ge%1)return"";var nt=Ge<0||0===Ge&&1/Ge<0?(Ge=-Ge,"-"):"-"===ot?"":ot;if(er<0){var dt=Ne.formatPrefix(Ge,Rt);Ge=dt.scale(Ge),tt=dt.symbol+mr}else Ge*=er;var en,mn,xn=(Ge=Zt(Ge,Rt)).lastIndexOf(".");if(xn<0){var kn=br?Ge.lastIndexOf("e"):-1;kn<0?(en=Ge,mn=""):(en=Ge.substring(0,kn),mn=Ge.substring(kn))}else en=Ge.substring(0,xn),mn=Qe+Ge.substring(xn+1);!ht&&Ot&&(en=at(en,1/0));var Cn=dr.length+en.length+mn.length+(Ar?0:nt.length),En=Cn<Dt?new Array(Cn=Dt-Cn+1).join(rt):"";return Ar&&(en=at(En+en,En.length?Dt-mn.length:1/0)),nt+=dr,Ge=en+mn,("<"===it?nt+Ge+En:">"===it?En+nt+Ge:"^"===it?En.substring(0,Cn>>=1)+nt+Ge+En.substring(Cn):nt+(Ar?Ge:En+Ge))+tt}}}Ne.formatPrefix=function(Ge,Qe){var tt=0;return(Ge=+Ge)&&(Ge<0&&(Ge*=-1),Qe&&(Ge=Ne.round(Ge,d3_format_precision(Ge,Qe))),tt=1+Math.floor(1e-12+Math.log(Ge)/Math.LN10),tt=Math.max(-24,Math.min(24,3*Math.floor((tt-1)/3)))),go[8+tt/3]};var ns=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,as=Ne.map({b:function(Ne){return Ne.toString(2)},c:function(Ne){return String.fromCharCode(Ne)},o:function(Ne){return Ne.toString(8)},x:function(Ne){return Ne.toString(16)},X:function(Ne){return Ne.toString(16).toUpperCase()},g:function(Ne,Ge){return Ne.toPrecision(Ge)},e:function(Ne,Ge){return Ne.toExponential(Ge)},f:function(Ne,Ge){return Ne.toFixed(Ge)},r:function(Ge,Qe){return(Ge=Ne.round(Ge,d3_format_precision(Ge,Qe))).toFixed(Math.max(0,Math.min(20,d3_format_precision(Ge*(1+1e-15),Qe))))}});function d3_format_typeDefault(Ne){return Ne+""}var is=Ne.time={},os=Date;function d3_date_utc(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}d3_date_utc.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){ss.setUTCDate.apply(this._,arguments)},setDay:function(){ss.setUTCDay.apply(this._,arguments)},setFullYear:function(){ss.setUTCFullYear.apply(this._,arguments)},setHours:function(){ss.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){ss.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){ss.setUTCMinutes.apply(this._,arguments)},setMonth:function(){ss.setUTCMonth.apply(this._,arguments)},setSeconds:function(){ss.setUTCSeconds.apply(this._,arguments)},setTime:function(){ss.setTime.apply(this._,arguments)}};var ss=Date.prototype;function d3_time_interval(Ne,Ge,Qe){function round(Ge){var Qe=Ne(Ge),tt=offset(Qe,1);return Ge-Qe<tt-Ge?Qe:tt}function ceil(Qe){return Ge(Qe=Ne(new os(Qe-1)),1),Qe}function offset(Ne,Qe){return Ge(Ne=new os(+Ne),Qe),Ne}function range(Ne,tt,rt){var nt=ceil(Ne),at=[];if(rt>1)for(;nt<tt;)Qe(nt)%rt||at.push(new Date(+nt)),Ge(nt,1);else for(;nt<tt;)at.push(new Date(+nt)),Ge(nt,1);return at}function range_utc(Ne,Ge,Qe){try{os=d3_date_utc;var tt=new d3_date_utc;return tt._=Ne,range(tt,Ge,Qe)}finally{os=Date}}Ne.floor=Ne,Ne.round=round,Ne.ceil=ceil,Ne.offset=offset,Ne.range=range;var tt=Ne.utc=d3_time_interval_utc(Ne);return tt.floor=tt,tt.round=d3_time_interval_utc(round),tt.ceil=d3_time_interval_utc(ceil),tt.offset=d3_time_interval_utc(offset),tt.range=range_utc,Ne}function d3_time_interval_utc(Ne){return function(Ge,Qe){try{os=d3_date_utc;var tt=new d3_date_utc;return tt._=Ge,Ne(tt,Qe)._}finally{os=Date}}}function d3_locale_timeFormat(Ge){var Qe=Ge.dateTime,tt=Ge.date,rt=Ge.time,nt=Ge.periods,at=Ge.days,it=Ge.shortDays,ot=Ge.months,dt=Ge.shortMonths;function d3_time_format(Ne){var Ge=Ne.length;function format(Qe){for(var tt,rt,nt,at=[],it=-1,ot=0;++it<Ge;)37===Ne.charCodeAt(it)&&(at.push(Ne.slice(ot,it)),null!=(rt=cs[tt=Ne.charAt(++it)])&&(tt=Ne.charAt(++it)),(nt=br[tt])&&(tt=nt(Qe,null==rt?"e"===tt?" ":"0":rt)),at.push(tt),ot=it+1);return at.push(Ne.slice(ot,it)),at.join("")}return format.parse=function(Ge){var Qe={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(d3_time_parse(Qe,Ne,Ge,0)!=Ge.length)return null;"p"in Qe&&(Qe.H=Qe.H%12+12*Qe.p);var tt=null!=Qe.Z&&os!==d3_date_utc,rt=new(tt?d3_date_utc:os);return"j"in Qe?rt.setFullYear(Qe.y,0,Qe.j):"W"in Qe||"U"in Qe?("w"in Qe||(Qe.w="W"in Qe?1:0),rt.setFullYear(Qe.y,0,1),rt.setFullYear(Qe.y,0,"W"in Qe?(Qe.w+6)%7+7*Qe.W-(rt.getDay()+5)%7:Qe.w+7*Qe.U-(rt.getDay()+6)%7)):rt.setFullYear(Qe.y,Qe.m,Qe.d),rt.setHours(Qe.H+(Qe.Z/100|0),Qe.M+Qe.Z%100,Qe.S,Qe.L),tt?rt._:rt},format.toString=function(){return Ne},format}function d3_time_parse(Ne,Ge,Qe,tt){for(var rt,nt,at,it=0,ot=Ge.length,dt=Qe.length;it<ot;){if(tt>=dt)return-1;if(37===(rt=Ge.charCodeAt(it++))){if(at=Ge.charAt(it++),!(nt=Ar[at in cs?Ge.charAt(it++):at])||(tt=nt(Ne,Qe,tt))<0)return-1}else if(rt!=Qe.charCodeAt(tt++))return-1}return tt}d3_time_format.utc=function(Ne){var Ge=d3_time_format(Ne);function format(Ne){try{var Qe=new(os=d3_date_utc);return Qe._=Ne,Ge(Qe)}finally{os=Date}}return format.parse=function(Ne){try{os=d3_date_utc;var Qe=Ge.parse(Ne);return Qe&&Qe._}finally{os=Date}},format.toString=Ge.toString,format},d3_time_format.multi=d3_time_format.utc.multi=d3_time_formatMulti;var ht=Ne.map(),Dt=d3_time_formatRe(at),Ot=d3_time_formatLookup(at),Rt=d3_time_formatRe(it),Zt=d3_time_formatLookup(it),er=d3_time_formatRe(ot),dr=d3_time_formatLookup(ot),mr=d3_time_formatRe(dt),xr=d3_time_formatLookup(dt);nt.forEach((function(Ne,Ge){ht.set(Ne.toLowerCase(),Ge)}));var br={a:function(Ne){return it[Ne.getDay()]},A:function(Ne){return at[Ne.getDay()]},b:function(Ne){return dt[Ne.getMonth()]},B:function(Ne){return ot[Ne.getMonth()]},c:d3_time_format(Qe),d:function(Ne,Ge){return d3_time_formatPad(Ne.getDate(),Ge,2)},e:function(Ne,Ge){return d3_time_formatPad(Ne.getDate(),Ge,2)},H:function(Ne,Ge){return d3_time_formatPad(Ne.getHours(),Ge,2)},I:function(Ne,Ge){return d3_time_formatPad(Ne.getHours()%12||12,Ge,2)},j:function(Ne,Ge){return d3_time_formatPad(1+is.dayOfYear(Ne),Ge,3)},L:function(Ne,Ge){return d3_time_formatPad(Ne.getMilliseconds(),Ge,3)},m:function(Ne,Ge){return d3_time_formatPad(Ne.getMonth()+1,Ge,2)},M:function(Ne,Ge){return d3_time_formatPad(Ne.getMinutes(),Ge,2)},p:function(Ne){return nt[+(Ne.getHours()>=12)]},S:function(Ne,Ge){return d3_time_formatPad(Ne.getSeconds(),Ge,2)},U:function(Ne,Ge){return d3_time_formatPad(is.sundayOfYear(Ne),Ge,2)},w:function(Ne){return Ne.getDay()},W:function(Ne,Ge){return d3_time_formatPad(is.mondayOfYear(Ne),Ge,2)},x:d3_time_format(tt),X:d3_time_format(rt),y:function(Ne,Ge){return d3_time_formatPad(Ne.getFullYear()%100,Ge,2)},Y:function(Ne,Ge){return d3_time_formatPad(Ne.getFullYear()%1e4,Ge,4)},Z:d3_time_zone,"%":function(){return"%"}},Ar={a:d3_time_parseWeekdayAbbrev,A:d3_time_parseWeekday,b:d3_time_parseMonthAbbrev,B:d3_time_parseMonth,c:d3_time_parseLocaleFull,d:d3_time_parseDay,e:d3_time_parseDay,H:d3_time_parseHour24,I:d3_time_parseHour24,j:d3_time_parseDayOfYear,L:d3_time_parseMilliseconds,m:d3_time_parseMonthNumber,M:d3_time_parseMinutes,p:d3_time_parseAmPm,S:d3_time_parseSeconds,U:d3_time_parseWeekNumberSunday,w:d3_time_parseWeekdayNumber,W:d3_time_parseWeekNumberMonday,x:d3_time_parseLocaleDate,X:d3_time_parseLocaleTime,y:d3_time_parseYear,Y:d3_time_parseFullYear,Z:d3_time_parseZone,"%":d3_time_parseLiteralPercent};function d3_time_parseWeekdayAbbrev(Ne,Ge,Qe){Rt.lastIndex=0;var tt=Rt.exec(Ge.slice(Qe));return tt?(Ne.w=Zt.get(tt[0].toLowerCase()),Qe+tt[0].length):-1}function d3_time_parseWeekday(Ne,Ge,Qe){Dt.lastIndex=0;var tt=Dt.exec(Ge.slice(Qe));return tt?(Ne.w=Ot.get(tt[0].toLowerCase()),Qe+tt[0].length):-1}function d3_time_parseMonthAbbrev(Ne,Ge,Qe){mr.lastIndex=0;var tt=mr.exec(Ge.slice(Qe));return tt?(Ne.m=xr.get(tt[0].toLowerCase()),Qe+tt[0].length):-1}function d3_time_parseMonth(Ne,Ge,Qe){er.lastIndex=0;var tt=er.exec(Ge.slice(Qe));return tt?(Ne.m=dr.get(tt[0].toLowerCase()),Qe+tt[0].length):-1}function d3_time_parseLocaleFull(Ne,Ge,Qe){return d3_time_parse(Ne,br.c.toString(),Ge,Qe)}function d3_time_parseLocaleDate(Ne,Ge,Qe){return d3_time_parse(Ne,br.x.toString(),Ge,Qe)}function d3_time_parseLocaleTime(Ne,Ge,Qe){return d3_time_parse(Ne,br.X.toString(),Ge,Qe)}function d3_time_parseAmPm(Ne,Ge,Qe){var tt=ht.get(Ge.slice(Qe,Qe+=2).toLowerCase());return null==tt?-1:(Ne.p=tt,Qe)}return d3_time_format}is.year=d3_time_interval((function(Ne){return(Ne=is.day(Ne)).setMonth(0,1),Ne}),(function(Ne,Ge){Ne.setFullYear(Ne.getFullYear()+Ge)}),(function(Ne){return Ne.getFullYear()})),is.years=is.year.range,is.years.utc=is.year.utc.range,is.day=d3_time_interval((function(Ne){var Ge=new os(2e3,0);return Ge.setFullYear(Ne.getFullYear(),Ne.getMonth(),Ne.getDate()),Ge}),(function(Ne,Ge){Ne.setDate(Ne.getDate()+Ge)}),(function(Ne){return Ne.getDate()-1})),is.days=is.day.range,is.days.utc=is.day.utc.range,is.dayOfYear=function(Ne){var Ge=is.year(Ne);return Math.floor((Ne-Ge-6e4*(Ne.getTimezoneOffset()-Ge.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach((function(Ne,Ge){Ge=7-Ge;var Qe=is[Ne]=d3_time_interval((function(Ne){return(Ne=is.day(Ne)).setDate(Ne.getDate()-(Ne.getDay()+Ge)%7),Ne}),(function(Ne,Ge){Ne.setDate(Ne.getDate()+7*Math.floor(Ge))}),(function(Ne){var Qe=is.year(Ne).getDay();return Math.floor((is.dayOfYear(Ne)+(Qe+Ge)%7)/7)-(Qe!==Ge)}));is[Ne+"s"]=Qe.range,is[Ne+"s"].utc=Qe.utc.range,is[Ne+"OfYear"]=function(Ne){var Qe=is.year(Ne).getDay();return Math.floor((is.dayOfYear(Ne)+(Qe+Ge)%7)/7)}})),is.week=is.sunday,is.weeks=is.sunday.range,is.weeks.utc=is.sunday.utc.range,is.weekOfYear=is.sundayOfYear;var cs={"-":"",_:" ",0:"0"},ds=/^\s*\d+/,ms=/^%/;function d3_time_formatPad(Ne,Ge,Qe){var tt=Ne<0?"-":"",rt=(tt?-Ne:Ne)+"",nt=rt.length;return tt+(nt<Qe?new Array(Qe-nt+1).join(Ge)+rt:rt)}function d3_time_formatRe(Ge){return new RegExp("^(?:"+Ge.map(Ne.requote).join("|")+")","i")}function d3_time_formatLookup(Ne){for(var Ge=new d3_Map,Qe=-1,tt=Ne.length;++Qe<tt;)Ge.set(Ne[Qe].toLowerCase(),Qe);return Ge}function d3_time_parseWeekdayNumber(Ne,Ge,Qe){ds.lastIndex=0;var tt=ds.exec(Ge.slice(Qe,Qe+1));return tt?(Ne.w=+tt[0],Qe+tt[0].length):-1}function d3_time_parseWeekNumberSunday(Ne,Ge,Qe){ds.lastIndex=0;var tt=ds.exec(Ge.slice(Qe));return tt?(Ne.U=+tt[0],Qe+tt[0].length):-1}function d3_time_parseWeekNumberMonday(Ne,Ge,Qe){ds.lastIndex=0;var tt=ds.exec(Ge.slice(Qe));return tt?(Ne.W=+tt[0],Qe+tt[0].length):-1}function d3_time_parseFullYear(Ne,Ge,Qe){ds.lastIndex=0;var tt=ds.exec(Ge.slice(Qe,Qe+4));return tt?(Ne.y=+tt[0],Qe+tt[0].length):-1}function d3_time_parseYear(Ne,Ge,Qe){ds.lastIndex=0;var tt=ds.exec(Ge.slice(Qe,Qe+2));return tt?(Ne.y=d3_time_expandYear(+tt[0]),Qe+tt[0].length):-1}function d3_time_parseZone(Ne,Ge,Qe){return/^[+-]\d{4}$/.test(Ge=Ge.slice(Qe,Qe+5))?(Ne.Z=-Ge,Qe+5):-1}function d3_time_expandYear(Ne){return Ne+(Ne>68?1900:2e3)}function d3_time_parseMonthNumber(Ne,Ge,Qe){ds.lastIndex=0;var tt=ds.exec(Ge.slice(Qe,Qe+2));return tt?(Ne.m=tt[0]-1,Qe+tt[0].length):-1}function d3_time_parseDay(Ne,Ge,Qe){ds.lastIndex=0;var tt=ds.exec(Ge.slice(Qe,Qe+2));return tt?(Ne.d=+tt[0],Qe+tt[0].length):-1}function d3_time_parseDayOfYear(Ne,Ge,Qe){ds.lastIndex=0;var tt=ds.exec(Ge.slice(Qe,Qe+3));return tt?(Ne.j=+tt[0],Qe+tt[0].length):-1}function d3_time_parseHour24(Ne,Ge,Qe){ds.lastIndex=0;var tt=ds.exec(Ge.slice(Qe,Qe+2));return tt?(Ne.H=+tt[0],Qe+tt[0].length):-1}function d3_time_parseMinutes(Ne,Ge,Qe){ds.lastIndex=0;var tt=ds.exec(Ge.slice(Qe,Qe+2));return tt?(Ne.M=+tt[0],Qe+tt[0].length):-1}function d3_time_parseSeconds(Ne,Ge,Qe){ds.lastIndex=0;var tt=ds.exec(Ge.slice(Qe,Qe+2));return tt?(Ne.S=+tt[0],Qe+tt[0].length):-1}function d3_time_parseMilliseconds(Ne,Ge,Qe){ds.lastIndex=0;var tt=ds.exec(Ge.slice(Qe,Qe+3));return tt?(Ne.L=+tt[0],Qe+tt[0].length):-1}function d3_time_zone(Ne){var Ge=Ne.getTimezoneOffset(),Qe=Ge>0?"-":"+",tt=Dt(Ge)/60|0,rt=Dt(Ge)%60;return Qe+d3_time_formatPad(tt,"0",2)+d3_time_formatPad(rt,"0",2)}function d3_time_parseLiteralPercent(Ne,Ge,Qe){ms.lastIndex=0;var tt=ms.exec(Ge.slice(Qe,Qe+1));return tt?Qe+tt[0].length:-1}function d3_time_formatMulti(Ne){for(var Ge=Ne.length,Qe=-1;++Qe<Ge;)Ne[Qe][0]=this(Ne[Qe][0]);return function(Ge){for(var Qe=0,tt=Ne[Qe];!tt[1](Ge);)tt=Ne[++Qe];return tt[0](Ge)}}Ne.locale=function(Ne){return{numberFormat:d3_locale_numberFormat(Ne),timeFormat:d3_locale_timeFormat(Ne)}};var vs=Ne.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function d3_adder(){}Ne.format=vs.numberFormat,Ne.geo={},d3_adder.prototype={s:0,t:0,add:function(Ne){d3_adderSum(Ne,this.t,_s),d3_adderSum(_s.s,this.s,this),this.s?this.t+=_s.t:this.s=_s.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var _s=new d3_adder;function d3_adderSum(Ne,Ge,Qe){var tt=Qe.s=Ne+Ge,rt=tt-Ne,nt=tt-rt;Qe.t=Ne-nt+(Ge-rt)}function d3_geo_streamGeometry(Ne,Ge){Ne&&Ts.hasOwnProperty(Ne.type)&&Ts[Ne.type](Ne,Ge)}Ne.geo.stream=function(Ne,Ge){Ne&&ws.hasOwnProperty(Ne.type)?ws[Ne.type](Ne,Ge):d3_geo_streamGeometry(Ne,Ge)};var ws={Feature:function(Ne,Ge){d3_geo_streamGeometry(Ne.geometry,Ge)},FeatureCollection:function(Ne,Ge){for(var Qe=Ne.features,tt=-1,rt=Qe.length;++tt<rt;)d3_geo_streamGeometry(Qe[tt].geometry,Ge)}},Ts={Sphere:function(Ne,Ge){Ge.sphere()},Point:function(Ne,Ge){Ne=Ne.coordinates,Ge.point(Ne[0],Ne[1],Ne[2])},MultiPoint:function(Ne,Ge){for(var Qe=Ne.coordinates,tt=-1,rt=Qe.length;++tt<rt;)Ne=Qe[tt],Ge.point(Ne[0],Ne[1],Ne[2])},LineString:function(Ne,Ge){d3_geo_streamLine(Ne.coordinates,Ge,0)},MultiLineString:function(Ne,Ge){for(var Qe=Ne.coordinates,tt=-1,rt=Qe.length;++tt<rt;)d3_geo_streamLine(Qe[tt],Ge,0)},Polygon:function(Ne,Ge){d3_geo_streamPolygon(Ne.coordinates,Ge)},MultiPolygon:function(Ne,Ge){for(var Qe=Ne.coordinates,tt=-1,rt=Qe.length;++tt<rt;)d3_geo_streamPolygon(Qe[tt],Ge)},GeometryCollection:function(Ne,Ge){for(var Qe=Ne.geometries,tt=-1,rt=Qe.length;++tt<rt;)d3_geo_streamGeometry(Qe[tt],Ge)}};function d3_geo_streamLine(Ne,Ge,Qe){var tt,rt=-1,nt=Ne.length-Qe;for(Ge.lineStart();++rt<nt;)tt=Ne[rt],Ge.point(tt[0],tt[1],tt[2]);Ge.lineEnd()}function d3_geo_streamPolygon(Ne,Ge){var Qe=-1,tt=Ne.length;for(Ge.polygonStart();++Qe<tt;)d3_geo_streamLine(Ne[Qe],Ge,1);Ge.polygonEnd()}Ne.geo.area=function(Ge){return ks=0,Ne.geo.stream(Ge,Zs),ks};var ks,Cs,Es,Ls,Ps,Ds,Is,Os,zs,Rs,Bs,Fs,js=new d3_adder,Zs={sphere:function(){ks+=4*Pn},point:d3_noop,lineStart:d3_noop,lineEnd:d3_noop,polygonStart:function(){js.reset(),Zs.lineStart=d3_geo_areaRingStart},polygonEnd:function(){var Ne=2*js;ks+=Ne<0?4*Pn+Ne:Ne,Zs.lineStart=Zs.lineEnd=Zs.point=d3_noop}};function d3_geo_areaRingStart(){var Ne,Ge,Qe,tt,rt;function nextPoint(Ne,Ge){Ge=Ge*Bn/2+Pn/4;var nt=(Ne*=Bn)-Qe,at=nt>=0?1:-1,it=at*nt,ot=Math.cos(Ge),dt=Math.sin(Ge),ht=rt*dt,Dt=tt*ot+ht*Math.cos(it),Ot=ht*at*Math.sin(it);js.add(Math.atan2(Ot,Dt)),Qe=Ne,tt=ot,rt=dt}Zs.point=function(nt,at){Zs.point=nextPoint,Qe=(Ne=nt)*Bn,tt=Math.cos(at=(Ge=at)*Bn/2+Pn/4),rt=Math.sin(at)},Zs.lineEnd=function(){nextPoint(Ne,Ge)}}function d3_geo_cartesian(Ne){var Ge=Ne[0],Qe=Ne[1],tt=Math.cos(Qe);return[tt*Math.cos(Ge),tt*Math.sin(Ge),Math.sin(Qe)]}function d3_geo_cartesianDot(Ne,Ge){return Ne[0]*Ge[0]+Ne[1]*Ge[1]+Ne[2]*Ge[2]}function d3_geo_cartesianCross(Ne,Ge){return[Ne[1]*Ge[2]-Ne[2]*Ge[1],Ne[2]*Ge[0]-Ne[0]*Ge[2],Ne[0]*Ge[1]-Ne[1]*Ge[0]]}function d3_geo_cartesianAdd(Ne,Ge){Ne[0]+=Ge[0],Ne[1]+=Ge[1],Ne[2]+=Ge[2]}function d3_geo_cartesianScale(Ne,Ge){return[Ne[0]*Ge,Ne[1]*Ge,Ne[2]*Ge]}function d3_geo_cartesianNormalize(Ne){var Ge=Math.sqrt(Ne[0]*Ne[0]+Ne[1]*Ne[1]+Ne[2]*Ne[2]);Ne[0]/=Ge,Ne[1]/=Ge,Ne[2]/=Ge}function d3_geo_spherical(Ne){return[Math.atan2(Ne[1],Ne[0]),d3_asin(Ne[2])]}function d3_geo_sphericalEqual(Ne,Ge){return Dt(Ne[0]-Ge[0])<Cn&&Dt(Ne[1]-Ge[1])<Cn}Ne.geo.bounds=function(){var Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Ot,Rt={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){Rt.point=ringPoint,Rt.lineStart=ringStart,Rt.lineEnd=ringEnd,dt=0,Zs.polygonStart()},polygonEnd:function(){Zs.polygonEnd(),Rt.point=point,Rt.lineStart=lineStart,Rt.lineEnd=lineEnd,js<0?(Ge=-(tt=180),Qe=-(rt=90)):dt>Cn?rt=90:dt<-Cn&&(Qe=-90),Ot[0]=Ge,Ot[1]=tt}};function point(Ne,nt){ht.push(Ot=[Ge=Ne,tt=Ne]),nt<Qe&&(Qe=nt),nt>rt&&(rt=nt)}function linePoint(Ne,at){var it=d3_geo_cartesian([Ne*Bn,at*Bn]);if(ot){var dt=d3_geo_cartesianCross(ot,it),ht=d3_geo_cartesianCross([dt[1],-dt[0],0],dt);d3_geo_cartesianNormalize(ht),ht=d3_geo_spherical(ht);var Ot=Ne-nt,Rt=Ot>0?1:-1,Zt=ht[0]*Vn*Rt,er=Dt(Ot)>180;if(er^(Rt*nt<Zt&&Zt<Rt*Ne))(dr=ht[1]*Vn)>rt&&(rt=dr);else if(er^(Rt*nt<(Zt=(Zt+360)%360-180)&&Zt<Rt*Ne)){var dr;(dr=-ht[1]*Vn)<Qe&&(Qe=dr)}else at<Qe&&(Qe=at),at>rt&&(rt=at);er?Ne<nt?angle(Ge,Ne)>angle(Ge,tt)&&(tt=Ne):angle(Ne,tt)>angle(Ge,tt)&&(Ge=Ne):tt>=Ge?(Ne<Ge&&(Ge=Ne),Ne>tt&&(tt=Ne)):Ne>nt?angle(Ge,Ne)>angle(Ge,tt)&&(tt=Ne):angle(Ne,tt)>angle(Ge,tt)&&(Ge=Ne)}else point(Ne,at);ot=it,nt=Ne}function lineStart(){Rt.point=linePoint}function lineEnd(){Ot[0]=Ge,Ot[1]=tt,Rt.point=point,ot=null}function ringPoint(Ne,Ge){if(ot){var Qe=Ne-nt;dt+=Dt(Qe)>180?Qe+(Qe>0?360:-360):Qe}else at=Ne,it=Ge;Zs.point(Ne,Ge),linePoint(Ne,Ge)}function ringStart(){Zs.lineStart()}function ringEnd(){ringPoint(at,it),Zs.lineEnd(),Dt(dt)>Cn&&(Ge=-(tt=180)),Ot[0]=Ge,Ot[1]=tt,ot=null}function angle(Ne,Ge){return(Ge-=Ne)<0?Ge+360:Ge}function compareRanges(Ne,Ge){return Ne[0]-Ge[0]}function withinRange(Ne,Ge){return Ge[0]<=Ge[1]?Ge[0]<=Ne&&Ne<=Ge[1]:Ne<Ge[0]||Ge[1]<Ne}return function(nt){if(rt=tt=-(Ge=Qe=1/0),ht=[],Ne.geo.stream(nt,Rt),dt=ht.length){ht.sort(compareRanges);for(var at=1,it=[er=ht[0]];at<dt;++at)withinRange((Dt=ht[at])[0],er)||withinRange(Dt[1],er)?(angle(er[0],Dt[1])>angle(er[0],er[1])&&(er[1]=Dt[1]),angle(Dt[0],er[1])>angle(er[0],er[1])&&(er[0]=Dt[0])):it.push(er=Dt);for(var ot,dt,Dt,Zt=-1/0,er=(at=0,it[dt=it.length-1]);at<=dt;er=Dt,++at)Dt=it[at],(ot=angle(er[1],Dt[0]))>Zt&&(Zt=ot,Ge=Dt[0],tt=er[1])}return ht=Ot=null,Ge===1/0||Qe===1/0?[[NaN,NaN],[NaN,NaN]]:[[Ge,Qe],[tt,rt]]}}(),Ne.geo.centroid=function(Ge){Cs=Es=Ls=Ps=Ds=Is=Os=zs=Rs=Bs=Fs=0,Ne.geo.stream(Ge,Ks);var Qe=Rs,tt=Bs,rt=Fs,nt=Qe*Qe+tt*tt+rt*rt;return nt<En&&(Qe=Is,tt=Os,rt=zs,Es<Cn&&(Qe=Ls,tt=Ps,rt=Ds),(nt=Qe*Qe+tt*tt+rt*rt)<En)?[NaN,NaN]:[Math.atan2(tt,Qe)*Vn,d3_asin(rt/Math.sqrt(nt))*Vn]};var Ks={sphere:d3_noop,point:d3_geo_centroidPoint,lineStart:d3_geo_centroidLineStart,lineEnd:d3_geo_centroidLineEnd,polygonStart:function(){Ks.lineStart=d3_geo_centroidRingStart},polygonEnd:function(){Ks.lineStart=d3_geo_centroidLineStart}};function d3_geo_centroidPoint(Ne,Ge){Ne*=Bn;var Qe=Math.cos(Ge*=Bn);d3_geo_centroidPointXYZ(Qe*Math.cos(Ne),Qe*Math.sin(Ne),Math.sin(Ge))}function d3_geo_centroidPointXYZ(Ne,Ge,Qe){++Cs,Ls+=(Ne-Ls)/Cs,Ps+=(Ge-Ps)/Cs,Ds+=(Qe-Ds)/Cs}function d3_geo_centroidLineStart(){var Ne,Ge,Qe;function nextPoint(tt,rt){tt*=Bn;var nt=Math.cos(rt*=Bn),at=nt*Math.cos(tt),it=nt*Math.sin(tt),ot=Math.sin(rt),dt=Math.atan2(Math.sqrt((dt=Ge*ot-Qe*it)*dt+(dt=Qe*at-Ne*ot)*dt+(dt=Ne*it-Ge*at)*dt),Ne*at+Ge*it+Qe*ot);Es+=dt,Is+=dt*(Ne+(Ne=at)),Os+=dt*(Ge+(Ge=it)),zs+=dt*(Qe+(Qe=ot)),d3_geo_centroidPointXYZ(Ne,Ge,Qe)}Ks.point=function(tt,rt){tt*=Bn;var nt=Math.cos(rt*=Bn);Ne=nt*Math.cos(tt),Ge=nt*Math.sin(tt),Qe=Math.sin(rt),Ks.point=nextPoint,d3_geo_centroidPointXYZ(Ne,Ge,Qe)}}function d3_geo_centroidLineEnd(){Ks.point=d3_geo_centroidPoint}function d3_geo_centroidRingStart(){var Ne,Ge,Qe,tt,rt;function nextPoint(Ne,Ge){Ne*=Bn;var nt=Math.cos(Ge*=Bn),at=nt*Math.cos(Ne),it=nt*Math.sin(Ne),ot=Math.sin(Ge),dt=tt*ot-rt*it,ht=rt*at-Qe*ot,Dt=Qe*it-tt*at,Ot=Math.sqrt(dt*dt+ht*ht+Dt*Dt),Rt=Qe*at+tt*it+rt*ot,Zt=Ot&&-d3_acos(Rt)/Ot,er=Math.atan2(Ot,Rt);Rs+=Zt*dt,Bs+=Zt*ht,Fs+=Zt*Dt,Es+=er,Is+=er*(Qe+(Qe=at)),Os+=er*(tt+(tt=it)),zs+=er*(rt+(rt=ot)),d3_geo_centroidPointXYZ(Qe,tt,rt)}Ks.point=function(nt,at){Ne=nt,Ge=at,Ks.point=nextPoint,nt*=Bn;var it=Math.cos(at*=Bn);Qe=it*Math.cos(nt),tt=it*Math.sin(nt),rt=Math.sin(at),d3_geo_centroidPointXYZ(Qe,tt,rt)},Ks.lineEnd=function(){nextPoint(Ne,Ge),Ks.lineEnd=d3_geo_centroidLineEnd,Ks.point=d3_geo_centroidPoint}}function d3_geo_compose(Ne,Ge){function compose(Qe,tt){return Qe=Ne(Qe,tt),Ge(Qe[0],Qe[1])}return Ne.invert&&Ge.invert&&(compose.invert=function(Qe,tt){return(Qe=Ge.invert(Qe,tt))&&Ne.invert(Qe[0],Qe[1])}),compose}function d3_true(){return!0}function d3_geo_clipPolygon(Ne,Ge,Qe,tt,rt){var nt=[],at=[];if(Ne.forEach((function(Ne){if(!((Ge=Ne.length-1)<=0)){var Ge,Qe=Ne[0],tt=Ne[Ge];if(d3_geo_sphericalEqual(Qe,tt)){rt.lineStart();for(var it=0;it<Ge;++it)rt.point((Qe=Ne[it])[0],Qe[1]);rt.lineEnd()}else{var ot=new d3_geo_clipPolygonIntersection(Qe,Ne,null,!0),dt=new d3_geo_clipPolygonIntersection(Qe,null,ot,!1);ot.o=dt,nt.push(ot),at.push(dt),ot=new d3_geo_clipPolygonIntersection(tt,Ne,null,!1),dt=new d3_geo_clipPolygonIntersection(tt,null,ot,!0),ot.o=dt,nt.push(ot),at.push(dt)}}})),at.sort(Ge),d3_geo_clipPolygonLinkCircular(nt),d3_geo_clipPolygonLinkCircular(at),nt.length){for(var it=0,ot=Qe,dt=at.length;it<dt;++it)at[it].e=ot=!ot;for(var ht,Dt,Ot=nt[0];;){for(var Rt=Ot,Zt=!0;Rt.v;)if((Rt=Rt.n)===Ot)return;ht=Rt.z,rt.lineStart();do{if(Rt.v=Rt.o.v=!0,Rt.e){if(Zt)for(it=0,dt=ht.length;it<dt;++it)rt.point((Dt=ht[it])[0],Dt[1]);else tt(Rt.x,Rt.n.x,1,rt);Rt=Rt.n}else{if(Zt)for(it=(ht=Rt.p.z).length-1;it>=0;--it)rt.point((Dt=ht[it])[0],Dt[1]);else tt(Rt.x,Rt.p.x,-1,rt);Rt=Rt.p}ht=(Rt=Rt.o).z,Zt=!Zt}while(!Rt.v);rt.lineEnd()}}}function d3_geo_clipPolygonLinkCircular(Ne){if(Ge=Ne.length){for(var Ge,Qe,tt=0,rt=Ne[0];++tt<Ge;)rt.n=Qe=Ne[tt],Qe.p=rt,rt=Qe;rt.n=Qe=Ne[0],Qe.p=rt}}function d3_geo_clipPolygonIntersection(Ne,Ge,Qe,tt){this.x=Ne,this.z=Ge,this.o=Qe,this.e=tt,this.v=!1,this.n=this.p=null}function d3_geo_clip(Ge,Qe,tt,rt){return function(nt,at){var it,ot=Qe(at),dt=nt.invert(rt[0],rt[1]),ht={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){ht.point=pointRing,ht.lineStart=ringStart,ht.lineEnd=ringEnd,it=[],Dt=[]},polygonEnd:function(){ht.point=point,ht.lineStart=lineStart,ht.lineEnd=lineEnd,it=Ne.merge(it);var Ge=d3_geo_pointInPolygon(dt,Dt);it.length?(er||(at.polygonStart(),er=!0),d3_geo_clipPolygon(it,d3_geo_clipSort,Ge,tt,at)):Ge&&(er||(at.polygonStart(),er=!0),at.lineStart(),tt(null,null,1,at),at.lineEnd()),er&&(at.polygonEnd(),er=!1),it=Dt=null},sphere:function(){at.polygonStart(),at.lineStart(),tt(null,null,1,at),at.lineEnd(),at.polygonEnd()}};function point(Ne,Qe){var tt=nt(Ne,Qe);Ge(Ne=tt[0],Qe=tt[1])&&at.point(Ne,Qe)}function pointLine(Ne,Ge){var Qe=nt(Ne,Ge);ot.point(Qe[0],Qe[1])}function lineStart(){ht.point=pointLine,ot.lineStart()}function lineEnd(){ht.point=point,ot.lineEnd()}var Dt,Ot,Rt=d3_geo_clipBufferListener(),Zt=Qe(Rt),er=!1;function pointRing(Ne,Ge){Ot.push([Ne,Ge]);var Qe=nt(Ne,Ge);Zt.point(Qe[0],Qe[1])}function ringStart(){Zt.lineStart(),Ot=[]}function ringEnd(){pointRing(Ot[0][0],Ot[0][1]),Zt.lineEnd();var Ne,Ge=Zt.clean(),Qe=Rt.buffer(),tt=Qe.length;if(Ot.pop(),Dt.push(Ot),Ot=null,tt)if(1&Ge){var rt,nt=-1;if((tt=(Ne=Qe[0]).length-1)>0){for(er||(at.polygonStart(),er=!0),at.lineStart();++nt<tt;)at.point((rt=Ne[nt])[0],rt[1]);at.lineEnd()}}else tt>1&&2&Ge&&Qe.push(Qe.pop().concat(Qe.shift())),it.push(Qe.filter(d3_geo_clipSegmentLength1))}return ht}}function d3_geo_clipSegmentLength1(Ne){return Ne.length>1}function d3_geo_clipBufferListener(){var Ne,Ge=[];return{lineStart:function(){Ge.push(Ne=[])},point:function(Ge,Qe){Ne.push([Ge,Qe])},lineEnd:d3_noop,buffer:function(){var Qe=Ge;return Ge=[],Ne=null,Qe},rejoin:function(){Ge.length>1&&Ge.push(Ge.pop().concat(Ge.shift()))}}}function d3_geo_clipSort(Ne,Ge){return((Ne=Ne.x)[0]<0?Ne[1]-zn-Cn:zn-Ne[1])-((Ge=Ge.x)[0]<0?Ge[1]-zn-Cn:zn-Ge[1])}var al=d3_geo_clip(d3_true,d3_geo_clipAntimeridianLine,d3_geo_clipAntimeridianInterpolate,[-Pn,-Pn/2]);function d3_geo_clipAntimeridianLine(Ne){var Ge,Qe=NaN,tt=NaN,rt=NaN;return{lineStart:function(){Ne.lineStart(),Ge=1},point:function(nt,at){var it=nt>0?Pn:-Pn,ot=Dt(nt-Qe);Dt(ot-Pn)<Cn?(Ne.point(Qe,tt=(tt+at)/2>0?zn:-zn),Ne.point(rt,tt),Ne.lineEnd(),Ne.lineStart(),Ne.point(it,tt),Ne.point(nt,tt),Ge=0):rt!==it&&ot>=Pn&&(Dt(Qe-rt)<Cn&&(Qe-=rt*Cn),Dt(nt-it)<Cn&&(nt-=it*Cn),tt=d3_geo_clipAntimeridianIntersect(Qe,tt,nt,at),Ne.point(rt,tt),Ne.lineEnd(),Ne.lineStart(),Ne.point(it,tt),Ge=0),Ne.point(Qe=nt,tt=at),rt=it},lineEnd:function(){Ne.lineEnd(),Qe=tt=NaN},clean:function(){return 2-Ge}}}function d3_geo_clipAntimeridianIntersect(Ne,Ge,Qe,tt){var rt,nt,at=Math.sin(Ne-Qe);return Dt(at)>Cn?Math.atan((Math.sin(Ge)*(nt=Math.cos(tt))*Math.sin(Qe)-Math.sin(tt)*(rt=Math.cos(Ge))*Math.sin(Ne))/(rt*nt*at)):(Ge+tt)/2}function d3_geo_clipAntimeridianInterpolate(Ne,Ge,Qe,tt){var rt;if(null==Ne)rt=Qe*zn,tt.point(-Pn,rt),tt.point(0,rt),tt.point(Pn,rt),tt.point(Pn,0),tt.point(Pn,-rt),tt.point(0,-rt),tt.point(-Pn,-rt),tt.point(-Pn,0),tt.point(-Pn,rt);else if(Dt(Ne[0]-Ge[0])>Cn){var nt=Ne[0]<Ge[0]?Pn:-Pn;rt=Qe*nt/2,tt.point(-nt,rt),tt.point(0,rt),tt.point(nt,rt)}else tt.point(Ge[0],Ge[1])}function d3_geo_pointInPolygon(Ne,Ge){var Qe=Ne[0],tt=Ne[1],rt=[Math.sin(Qe),-Math.cos(Qe),0],nt=0,at=0;js.reset();for(var it=0,ot=Ge.length;it<ot;++it){var dt=Ge[it],ht=dt.length;if(ht)for(var Dt=dt[0],Ot=Dt[0],Rt=Dt[1]/2+Pn/4,Zt=Math.sin(Rt),er=Math.cos(Rt),dr=1;;){dr===ht&&(dr=0);var mr=(Ne=dt[dr])[0],xr=Ne[1]/2+Pn/4,br=Math.sin(xr),Ar=Math.cos(xr),en=mr-Ot,mn=en>=0?1:-1,xn=mn*en,kn=xn>Pn,En=Zt*br;if(js.add(Math.atan2(En*mn*Math.sin(xn),er*Ar+En*Math.cos(xn))),nt+=kn?en+mn*Dn:en,kn^Ot>=Qe^mr>=Qe){var In=d3_geo_cartesianCross(d3_geo_cartesian(Dt),d3_geo_cartesian(Ne));d3_geo_cartesianNormalize(In);var zn=d3_geo_cartesianCross(rt,In);d3_geo_cartesianNormalize(zn);var Bn=(kn^en>=0?-1:1)*d3_asin(zn[2]);(tt>Bn||tt===Bn&&(In[0]||In[1]))&&(at+=kn^en>=0?1:-1)}if(!dr++)break;Ot=mr,Zt=br,er=Ar,Dt=Ne}}return(nt<-Cn||nt<Cn&&js<-Cn)^1&at}function d3_geo_clipCircle(Ne){var Ge=Math.cos(Ne),Qe=Ge>0,tt=Dt(Ge)>Cn;return d3_geo_clip(visible,clipLine,d3_geo_circleInterpolate(Ne,6*Bn),Qe?[0,-Ne]:[-Pn,Ne-Pn]);function visible(Ne,Qe){return Math.cos(Ne)*Math.cos(Qe)>Ge}function clipLine(Ne){var Ge,rt,nt,at,it;return{lineStart:function(){at=nt=!1,it=1},point:function(ot,dt){var ht,Dt=[ot,dt],Ot=visible(ot,dt),Rt=Qe?Ot?0:code(ot,dt):Ot?code(ot+(ot<0?Pn:-Pn),dt):0;if(!Ge&&(at=nt=Ot)&&Ne.lineStart(),Ot!==nt&&(ht=intersect(Ge,Dt),(d3_geo_sphericalEqual(Ge,ht)||d3_geo_sphericalEqual(Dt,ht))&&(Dt[0]+=Cn,Dt[1]+=Cn,Ot=visible(Dt[0],Dt[1]))),Ot!==nt)it=0,Ot?(Ne.lineStart(),ht=intersect(Dt,Ge),Ne.point(ht[0],ht[1])):(ht=intersect(Ge,Dt),Ne.point(ht[0],ht[1]),Ne.lineEnd()),Ge=ht;else if(tt&&Ge&&Qe^Ot){var Zt;Rt&rt||!(Zt=intersect(Dt,Ge,!0))||(it=0,Qe?(Ne.lineStart(),Ne.point(Zt[0][0],Zt[0][1]),Ne.point(Zt[1][0],Zt[1][1]),Ne.lineEnd()):(Ne.point(Zt[1][0],Zt[1][1]),Ne.lineEnd(),Ne.lineStart(),Ne.point(Zt[0][0],Zt[0][1])))}!Ot||Ge&&d3_geo_sphericalEqual(Ge,Dt)||Ne.point(Dt[0],Dt[1]),Ge=Dt,nt=Ot,rt=Rt},lineEnd:function(){nt&&Ne.lineEnd(),Ge=null},clean:function(){return it|(at&&nt)<<1}}}function intersect(Ne,Qe,tt){var rt=[1,0,0],nt=d3_geo_cartesianCross(d3_geo_cartesian(Ne),d3_geo_cartesian(Qe)),at=d3_geo_cartesianDot(nt,nt),it=nt[0],ot=at-it*it;if(!ot)return!tt&&Ne;var dt=Ge*at/ot,ht=-Ge*it/ot,Ot=d3_geo_cartesianCross(rt,nt),Rt=d3_geo_cartesianScale(rt,dt);d3_geo_cartesianAdd(Rt,d3_geo_cartesianScale(nt,ht));var Zt=Ot,er=d3_geo_cartesianDot(Rt,Zt),dr=d3_geo_cartesianDot(Zt,Zt),mr=er*er-dr*(d3_geo_cartesianDot(Rt,Rt)-1);if(!(mr<0)){var xr=Math.sqrt(mr),br=d3_geo_cartesianScale(Zt,(-er-xr)/dr);if(d3_geo_cartesianAdd(br,Rt),br=d3_geo_spherical(br),!tt)return br;var Ar,en=Ne[0],mn=Qe[0],xn=Ne[1],kn=Qe[1];mn<en&&(Ar=en,en=mn,mn=Ar);var En=mn-en,Dn=Dt(En-Pn)<Cn;if(!Dn&&kn<xn&&(Ar=xn,xn=kn,kn=Ar),Dn||En<Cn?Dn?xn+kn>0^br[1]<(Dt(br[0]-en)<Cn?xn:kn):xn<=br[1]&&br[1]<=kn:En>Pn^(en<=br[0]&&br[0]<=mn)){var In=d3_geo_cartesianScale(Zt,(-er+xr)/dr);return d3_geo_cartesianAdd(In,Rt),[br,d3_geo_spherical(In)]}}}function code(Ge,tt){var rt=Qe?Ne:Pn-Ne,nt=0;return Ge<-rt?nt|=1:Ge>rt&&(nt|=2),tt<-rt?nt|=4:tt>rt&&(nt|=8),nt}}function d3_geom_clipLine(Ne,Ge,Qe,tt){return function(rt){var nt,at=rt.a,it=rt.b,ot=at.x,dt=at.y,ht=0,Dt=1,Ot=it.x-ot,Rt=it.y-dt;if(nt=Ne-ot,Ot||!(nt>0)){if(nt/=Ot,Ot<0){if(nt<ht)return;nt<Dt&&(Dt=nt)}else if(Ot>0){if(nt>Dt)return;nt>ht&&(ht=nt)}if(nt=Qe-ot,Ot||!(nt<0)){if(nt/=Ot,Ot<0){if(nt>Dt)return;nt>ht&&(ht=nt)}else if(Ot>0){if(nt<ht)return;nt<Dt&&(Dt=nt)}if(nt=Ge-dt,Rt||!(nt>0)){if(nt/=Rt,Rt<0){if(nt<ht)return;nt<Dt&&(Dt=nt)}else if(Rt>0){if(nt>Dt)return;nt>ht&&(ht=nt)}if(nt=tt-dt,Rt||!(nt<0)){if(nt/=Rt,Rt<0){if(nt>Dt)return;nt>ht&&(ht=nt)}else if(Rt>0){if(nt<ht)return;nt<Dt&&(Dt=nt)}return ht>0&&(rt.a={x:ot+ht*Ot,y:dt+ht*Rt}),Dt<1&&(rt.b={x:ot+Dt*Ot,y:dt+Dt*Rt}),rt}}}}}}var il=1e9;function d3_geo_clipExtent(Ge,Qe,tt,rt){return function(nt){var at,it,ot,dt,ht,Dt,Ot,Rt,Zt,er,dr,mr=nt,xr=d3_geo_clipBufferListener(),br=d3_geom_clipLine(Ge,Qe,tt,rt),Ar={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){nt=xr,at=[],it=[],dr=!0},polygonEnd:function(){nt=mr,at=Ne.merge(at);var Qe=insidePolygon([Ge,rt]),tt=dr&&Qe,dt=at.length;(tt||dt)&&(nt.polygonStart(),tt&&(nt.lineStart(),interpolate(null,null,1,nt),nt.lineEnd()),dt&&d3_geo_clipPolygon(at,compare,Qe,interpolate,nt),nt.polygonEnd()),at=it=ot=null}};function insidePolygon(Ne){for(var Ge=0,Qe=it.length,tt=Ne[1],rt=0;rt<Qe;++rt)for(var nt,at=1,ot=it[rt],dt=ot.length,ht=ot[0];at<dt;++at)nt=ot[at],ht[1]<=tt?nt[1]>tt&&d3_cross2d(ht,nt,Ne)>0&&++Ge:nt[1]<=tt&&d3_cross2d(ht,nt,Ne)<0&&--Ge,ht=nt;return 0!==Ge}function interpolate(Ne,nt,at,it){var ot=0,dt=0;if(null==Ne||(ot=corner(Ne,at))!==(dt=corner(nt,at))||comparePoints(Ne,nt)<0^at>0)do{it.point(0===ot||3===ot?Ge:tt,ot>1?rt:Qe)}while((ot=(ot+at+4)%4)!==dt);else it.point(nt[0],nt[1])}function pointVisible(Ne,nt){return Ge<=Ne&&Ne<=tt&&Qe<=nt&&nt<=rt}function point(Ne,Ge){pointVisible(Ne,Ge)&&nt.point(Ne,Ge)}function lineStart(){Ar.point=linePoint,it&&it.push(ot=[]),er=!0,Zt=!1,Ot=Rt=NaN}function lineEnd(){at&&(linePoint(dt,ht),Dt&&Zt&&xr.rejoin(),at.push(xr.buffer())),Ar.point=point,Zt&&nt.lineEnd()}function linePoint(Ne,Ge){var Qe=pointVisible(Ne=Math.max(-il,Math.min(il,Ne)),Ge=Math.max(-il,Math.min(il,Ge)));if(it&&ot.push([Ne,Ge]),er)dt=Ne,ht=Ge,Dt=Qe,er=!1,Qe&&(nt.lineStart(),nt.point(Ne,Ge));else if(Qe&&Zt)nt.point(Ne,Ge);else{var tt={a:{x:Ot,y:Rt},b:{x:Ne,y:Ge}};br(tt)?(Zt||(nt.lineStart(),nt.point(tt.a.x,tt.a.y)),nt.point(tt.b.x,tt.b.y),Qe||nt.lineEnd(),dr=!1):Qe&&(nt.lineStart(),nt.point(Ne,Ge),dr=!1)}Ot=Ne,Rt=Ge,Zt=Qe}return Ar};function corner(Ne,rt){return Dt(Ne[0]-Ge)<Cn?rt>0?0:3:Dt(Ne[0]-tt)<Cn?rt>0?2:1:Dt(Ne[1]-Qe)<Cn?rt>0?1:0:rt>0?3:2}function compare(Ne,Ge){return comparePoints(Ne.x,Ge.x)}function comparePoints(Ne,Ge){var Qe=corner(Ne,1),tt=corner(Ge,1);return Qe!==tt?Qe-tt:0===Qe?Ge[1]-Ne[1]:1===Qe?Ne[0]-Ge[0]:2===Qe?Ne[1]-Ge[1]:Ge[0]-Ne[0]}}function d3_geo_conic(Ne){var Ge=0,Qe=Pn/3,tt=d3_geo_projectionMutator(Ne),rt=tt(Ge,Qe);return rt.parallels=function(Ne){return arguments.length?tt(Ge=Ne[0]*Pn/180,Qe=Ne[1]*Pn/180):[Ge/Pn*180,Qe/Pn*180]},rt}function d3_geo_conicEqualArea(Ne,Ge){var Qe=Math.sin(Ne),tt=(Qe+Math.sin(Ge))/2,rt=1+Qe*(2*tt-Qe),nt=Math.sqrt(rt)/tt;function forward(Ne,Ge){var Qe=Math.sqrt(rt-2*tt*Math.sin(Ge))/tt;return[Qe*Math.sin(Ne*=tt),nt-Qe*Math.cos(Ne)]}return forward.invert=function(Ne,Ge){var Qe=nt-Ge;return[Math.atan2(Ne,Qe)/tt,d3_asin((rt-(Ne*Ne+Qe*Qe)*tt*tt)/(2*tt))]},forward}Ne.geo.clipExtent=function(){var Ne,Ge,Qe,tt,rt,nt,at={stream:function(Ne){return rt&&(rt.valid=!1),(rt=nt(Ne)).valid=!0,rt},extent:function(it){return arguments.length?(nt=d3_geo_clipExtent(Ne=+it[0][0],Ge=+it[0][1],Qe=+it[1][0],tt=+it[1][1]),rt&&(rt.valid=!1,rt=null),at):[[Ne,Ge],[Qe,tt]]}};return at.extent([[0,0],[960,500]])},(Ne.geo.conicEqualArea=function(){return d3_geo_conic(d3_geo_conicEqualArea)}).raw=d3_geo_conicEqualArea,Ne.geo.albers=function(){return Ne.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},Ne.geo.albersUsa=function(){var Ge,Qe,tt,rt,nt=Ne.geo.albers(),at=Ne.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),it=Ne.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),ot={point:function(Ne,Qe){Ge=[Ne,Qe]}};function albersUsa(Ne){var nt=Ne[0],at=Ne[1];return Ge=null,Qe(nt,at),Ge||(tt(nt,at),Ge)||rt(nt,at),Ge}return albersUsa.invert=function(Ne){var Ge=nt.scale(),Qe=nt.translate(),tt=(Ne[0]-Qe[0])/Ge,rt=(Ne[1]-Qe[1])/Ge;return(rt>=.12&&rt<.234&&tt>=-.425&&tt<-.214?at:rt>=.166&&rt<.234&&tt>=-.214&&tt<-.115?it:nt).invert(Ne)},albersUsa.stream=function(Ne){var Ge=nt.stream(Ne),Qe=at.stream(Ne),tt=it.stream(Ne);return{point:function(Ne,rt){Ge.point(Ne,rt),Qe.point(Ne,rt),tt.point(Ne,rt)},sphere:function(){Ge.sphere(),Qe.sphere(),tt.sphere()},lineStart:function(){Ge.lineStart(),Qe.lineStart(),tt.lineStart()},lineEnd:function(){Ge.lineEnd(),Qe.lineEnd(),tt.lineEnd()},polygonStart:function(){Ge.polygonStart(),Qe.polygonStart(),tt.polygonStart()},polygonEnd:function(){Ge.polygonEnd(),Qe.polygonEnd(),tt.polygonEnd()}}},albersUsa.precision=function(Ne){return arguments.length?(nt.precision(Ne),at.precision(Ne),it.precision(Ne),albersUsa):nt.precision()},albersUsa.scale=function(Ne){return arguments.length?(nt.scale(Ne),at.scale(.35*Ne),it.scale(Ne),albersUsa.translate(nt.translate())):nt.scale()},albersUsa.translate=function(Ne){if(!arguments.length)return nt.translate();var Ge=nt.scale(),dt=+Ne[0],ht=+Ne[1];return Qe=nt.translate(Ne).clipExtent([[dt-.455*Ge,ht-.238*Ge],[dt+.455*Ge,ht+.238*Ge]]).stream(ot).point,tt=at.translate([dt-.307*Ge,ht+.201*Ge]).clipExtent([[dt-.425*Ge+Cn,ht+.12*Ge+Cn],[dt-.214*Ge-Cn,ht+.234*Ge-Cn]]).stream(ot).point,rt=it.translate([dt-.205*Ge,ht+.212*Ge]).clipExtent([[dt-.214*Ge+Cn,ht+.166*Ge+Cn],[dt-.115*Ge-Cn,ht+.234*Ge-Cn]]).stream(ot).point,albersUsa},albersUsa.scale(1070)};var fl,dl,hl,gl,ml,vl,xl={point:d3_noop,lineStart:d3_noop,lineEnd:d3_noop,polygonStart:function(){dl=0,xl.lineStart=d3_geo_pathAreaRingStart},polygonEnd:function(){xl.lineStart=xl.lineEnd=xl.point=d3_noop,fl+=Dt(dl/2)}};function d3_geo_pathAreaRingStart(){var Ne,Ge,Qe,tt;function nextPoint(Ne,Ge){dl+=tt*Ne-Qe*Ge,Qe=Ne,tt=Ge}xl.point=function(rt,nt){xl.point=nextPoint,Ne=Qe=rt,Ge=tt=nt},xl.lineEnd=function(){nextPoint(Ne,Ge)}}var bl={point:d3_geo_pathBoundsPoint,lineStart:d3_noop,lineEnd:d3_noop,polygonStart:d3_noop,polygonEnd:d3_noop};function d3_geo_pathBoundsPoint(Ne,Ge){Ne<hl&&(hl=Ne),Ne>ml&&(ml=Ne),Ge<gl&&(gl=Ge),Ge>vl&&(vl=Ge)}function d3_geo_pathBuffer(){var Ne=d3_geo_pathBufferCircle(4.5),Ge=[],Qe={point:point,lineStart:function(){Qe.point=pointLineStart},lineEnd:lineEnd,polygonStart:function(){Qe.lineEnd=lineEndPolygon},polygonEnd:function(){Qe.lineEnd=lineEnd,Qe.point=point},pointRadius:function(Ge){return Ne=d3_geo_pathBufferCircle(Ge),Qe},result:function(){if(Ge.length){var Ne=Ge.join("");return Ge=[],Ne}}};function point(Qe,tt){Ge.push("M",Qe,",",tt,Ne)}function pointLineStart(Ne,tt){Ge.push("M",Ne,",",tt),Qe.point=pointLine}function pointLine(Ne,Qe){Ge.push("L",Ne,",",Qe)}function lineEnd(){Qe.point=point}function lineEndPolygon(){Ge.push("Z")}return Qe}function d3_geo_pathBufferCircle(Ne){return"m0,"+Ne+"a"+Ne+","+Ne+" 0 1,1 0,"+-2*Ne+"a"+Ne+","+Ne+" 0 1,1 0,"+2*Ne+"z"}var _l,wl={point:d3_geo_pathCentroidPoint,lineStart:d3_geo_pathCentroidLineStart,lineEnd:d3_geo_pathCentroidLineEnd,polygonStart:function(){wl.lineStart=d3_geo_pathCentroidRingStart},polygonEnd:function(){wl.point=d3_geo_pathCentroidPoint,wl.lineStart=d3_geo_pathCentroidLineStart,wl.lineEnd=d3_geo_pathCentroidLineEnd}};function d3_geo_pathCentroidPoint(Ne,Ge){Ls+=Ne,Ps+=Ge,++Ds}function d3_geo_pathCentroidLineStart(){var Ne,Ge;function nextPoint(Qe,tt){var rt=Qe-Ne,nt=tt-Ge,at=Math.sqrt(rt*rt+nt*nt);Is+=at*(Ne+Qe)/2,Os+=at*(Ge+tt)/2,zs+=at,d3_geo_pathCentroidPoint(Ne=Qe,Ge=tt)}wl.point=function(Qe,tt){wl.point=nextPoint,d3_geo_pathCentroidPoint(Ne=Qe,Ge=tt)}}function d3_geo_pathCentroidLineEnd(){wl.point=d3_geo_pathCentroidPoint}function d3_geo_pathCentroidRingStart(){var Ne,Ge,Qe,tt;function nextPoint(Ne,Ge){var rt=Ne-Qe,nt=Ge-tt,at=Math.sqrt(rt*rt+nt*nt);Is+=at*(Qe+Ne)/2,Os+=at*(tt+Ge)/2,zs+=at,Rs+=(at=tt*Ne-Qe*Ge)*(Qe+Ne),Bs+=at*(tt+Ge),Fs+=3*at,d3_geo_pathCentroidPoint(Qe=Ne,tt=Ge)}wl.point=function(rt,nt){wl.point=nextPoint,d3_geo_pathCentroidPoint(Ne=Qe=rt,Ge=tt=nt)},wl.lineEnd=function(){nextPoint(Ne,Ge)}}function d3_geo_pathContext(Ne){var Ge=4.5,Qe={point:point,lineStart:function(){Qe.point=pointLineStart},lineEnd:lineEnd,polygonStart:function(){Qe.lineEnd=lineEndPolygon},polygonEnd:function(){Qe.lineEnd=lineEnd,Qe.point=point},pointRadius:function(Ne){return Ge=Ne,Qe},result:d3_noop};function point(Qe,tt){Ne.moveTo(Qe+Ge,tt),Ne.arc(Qe,tt,Ge,0,Dn)}function pointLineStart(Ge,tt){Ne.moveTo(Ge,tt),Qe.point=pointLine}function pointLine(Ge,Qe){Ne.lineTo(Ge,Qe)}function lineEnd(){Qe.point=point}function lineEndPolygon(){Ne.closePath()}return Qe}function d3_geo_resample(Ne){var Ge=.5,Qe=Math.cos(30*Bn),tt=16;function resample(Ne){return(tt?resampleRecursive:resampleNone)(Ne)}function resampleNone(Ge){return d3_geo_transformPoint(Ge,(function(Qe,tt){Qe=Ne(Qe,tt),Ge.point(Qe[0],Qe[1])}))}function resampleRecursive(Ge){var Qe,rt,nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt,er={point:point,lineStart:lineStart,lineEnd:lineEnd,polygonStart:function(){Ge.polygonStart(),er.lineStart=ringStart},polygonEnd:function(){Ge.polygonEnd(),er.lineStart=lineStart}};function point(Qe,tt){Qe=Ne(Qe,tt),Ge.point(Qe[0],Qe[1])}function lineStart(){ht=NaN,er.point=linePoint,Ge.lineStart()}function linePoint(Qe,rt){var nt=d3_geo_cartesian([Qe,rt]),at=Ne(Qe,rt);resampleLineTo(ht,Dt,dt,Ot,Rt,Zt,ht=at[0],Dt=at[1],dt=Qe,Ot=nt[0],Rt=nt[1],Zt=nt[2],tt,Ge),Ge.point(ht,Dt)}function lineEnd(){er.point=point,Ge.lineEnd()}function ringStart(){lineStart(),er.point=ringPoint,er.lineEnd=ringEnd}function ringPoint(Ne,Ge){linePoint(Qe=Ne,Ge),rt=ht,nt=Dt,at=Ot,it=Rt,ot=Zt,er.point=linePoint}function ringEnd(){resampleLineTo(ht,Dt,dt,Ot,Rt,Zt,rt,nt,Qe,at,it,ot,tt,Ge),er.lineEnd=lineEnd,lineEnd()}return er}function resampleLineTo(tt,rt,nt,at,it,ot,dt,ht,Ot,Rt,Zt,er,dr,mr){var xr=dt-tt,br=ht-rt,Ar=xr*xr+br*br;if(Ar>4*Ge&&dr--){var en=at+Rt,mn=it+Zt,xn=ot+er,kn=Math.sqrt(en*en+mn*mn+xn*xn),En=Math.asin(xn/=kn),Pn=Dt(Dt(xn)-1)<Cn||Dt(nt-Ot)<Cn?(nt+Ot)/2:Math.atan2(mn,en),Dn=Ne(Pn,En),In=Dn[0],zn=Dn[1],Bn=In-tt,Vn=zn-rt,Hn=br*Bn-xr*Vn;(Hn*Hn/Ar>Ge||Dt((xr*Bn+br*Vn)/Ar-.5)>.3||at*Rt+it*Zt+ot*er<Qe)&&(resampleLineTo(tt,rt,nt,at,it,ot,In,zn,Pn,en/=kn,mn/=kn,xn,dr,mr),mr.point(In,zn),resampleLineTo(In,zn,Pn,en,mn,xn,dt,ht,Ot,Rt,Zt,er,dr,mr))}}return resample.precision=function(Ne){return arguments.length?(tt=(Ge=Ne*Ne)>0&&16,resample):Math.sqrt(Ge)},resample}function d3_geo_pathProjectStream(Ne){var Ge=d3_geo_resample((function(Ge,Qe){return Ne([Ge*Vn,Qe*Vn])}));return function(Ne){return d3_geo_projectionRadians(Ge(Ne))}}function d3_geo_transform(Ne){this.stream=Ne}function d3_geo_transformPoint(Ne,Ge){return{point:Ge,sphere:function(){Ne.sphere()},lineStart:function(){Ne.lineStart()},lineEnd:function(){Ne.lineEnd()},polygonStart:function(){Ne.polygonStart()},polygonEnd:function(){Ne.polygonEnd()}}}function d3_geo_projection(Ne){return d3_geo_projectionMutator((function(){return Ne}))()}function d3_geo_projectionMutator(Ge){var Qe,tt,rt,nt,at,it,ot=d3_geo_resample((function(Ne,Ge){return[(Ne=Qe(Ne,Ge))[0]*dt+nt,at-Ne[1]*dt]})),dt=150,ht=480,Dt=250,Ot=0,Rt=0,Zt=0,er=0,dr=0,mr=al,xr=d3_identity,br=null,Ar=null;function projection(Ne){return[(Ne=rt(Ne[0]*Bn,Ne[1]*Bn))[0]*dt+nt,at-Ne[1]*dt]}function invert(Ne){return(Ne=rt.invert((Ne[0]-nt)/dt,(at-Ne[1])/dt))&&[Ne[0]*Vn,Ne[1]*Vn]}function reset(){rt=d3_geo_compose(tt=d3_geo_rotation(Zt,er,dr),Qe);var Ne=Qe(Ot,Rt);return nt=ht-Ne[0]*dt,at=Dt+Ne[1]*dt,invalidate()}function invalidate(){return it&&(it.valid=!1,it=null),projection}return projection.stream=function(Ne){return it&&(it.valid=!1),(it=d3_geo_projectionRadians(mr(tt,ot(xr(Ne))))).valid=!0,it},projection.clipAngle=function(Ne){return arguments.length?(mr=null==Ne?(br=Ne,al):d3_geo_clipCircle((br=+Ne)*Bn),invalidate()):br},projection.clipExtent=function(Ne){return arguments.length?(Ar=Ne,xr=Ne?d3_geo_clipExtent(Ne[0][0],Ne[0][1],Ne[1][0],Ne[1][1]):d3_identity,invalidate()):Ar},projection.scale=function(Ne){return arguments.length?(dt=+Ne,reset()):dt},projection.translate=function(Ne){return arguments.length?(ht=+Ne[0],Dt=+Ne[1],reset()):[ht,Dt]},projection.center=function(Ne){return arguments.length?(Ot=Ne[0]%360*Bn,Rt=Ne[1]%360*Bn,reset()):[Ot*Vn,Rt*Vn]},projection.rotate=function(Ne){return arguments.length?(Zt=Ne[0]%360*Bn,er=Ne[1]%360*Bn,dr=Ne.length>2?Ne[2]%360*Bn:0,reset()):[Zt*Vn,er*Vn,dr*Vn]},Ne.rebind(projection,ot,"precision"),function(){return Qe=Ge.apply(this,arguments),projection.invert=Qe.invert&&invert,reset()}}function d3_geo_projectionRadians(Ne){return d3_geo_transformPoint(Ne,(function(Ge,Qe){Ne.point(Ge*Bn,Qe*Bn)}))}function d3_geo_equirectangular(Ne,Ge){return[Ne,Ge]}function d3_geo_identityRotation(Ne,Ge){return[Ne>Pn?Ne-Dn:Ne<-Pn?Ne+Dn:Ne,Ge]}function d3_geo_rotation(Ne,Ge,Qe){return Ne?Ge||Qe?d3_geo_compose(d3_geo_rotationÎ»(Ne),d3_geo_rotationÏÎ³(Ge,Qe)):d3_geo_rotationÎ»(Ne):Ge||Qe?d3_geo_rotationÏÎ³(Ge,Qe):d3_geo_identityRotation}function d3_geo_forwardRotationÎ»(Ne){return function(Ge,Qe){return[(Ge+=Ne)>Pn?Ge-Dn:Ge<-Pn?Ge+Dn:Ge,Qe]}}function d3_geo_rotationÎ»(Ne){var Ge=d3_geo_forwardRotationÎ»(Ne);return Ge.invert=d3_geo_forwardRotationÎ»(-Ne),Ge}function d3_geo_rotationÏÎ³(Ne,Ge){var Qe=Math.cos(Ne),tt=Math.sin(Ne),rt=Math.cos(Ge),nt=Math.sin(Ge);function rotation(Ne,Ge){var at=Math.cos(Ge),it=Math.cos(Ne)*at,ot=Math.sin(Ne)*at,dt=Math.sin(Ge),ht=dt*Qe+it*tt;return[Math.atan2(ot*rt-ht*nt,it*Qe-dt*tt),d3_asin(ht*rt+ot*nt)]}return rotation.invert=function(Ne,Ge){var at=Math.cos(Ge),it=Math.cos(Ne)*at,ot=Math.sin(Ne)*at,dt=Math.sin(Ge),ht=dt*rt-ot*nt;return[Math.atan2(ot*rt+dt*nt,it*Qe+ht*tt),d3_asin(ht*Qe-it*tt)]},rotation}function d3_geo_circleInterpolate(Ne,Ge){var Qe=Math.cos(Ne),tt=Math.sin(Ne);return function(rt,nt,at,it){var ot=at*Ge;null!=rt?(rt=d3_geo_circleAngle(Qe,rt),nt=d3_geo_circleAngle(Qe,nt),(at>0?rt<nt:rt>nt)&&(rt+=at*Dn)):(rt=Ne+at*Dn,nt=Ne-.5*ot);for(var dt,ht=rt;at>0?ht>nt:ht<nt;ht-=ot)it.point((dt=d3_geo_spherical([Qe,-tt*Math.cos(ht),-tt*Math.sin(ht)]))[0],dt[1])}}function d3_geo_circleAngle(Ne,Ge){var Qe=d3_geo_cartesian(Ge);Qe[0]-=Ne,d3_geo_cartesianNormalize(Qe);var tt=d3_acos(-Qe[1]);return((-Qe[2]<0?-tt:tt)+2*Math.PI-Cn)%(2*Math.PI)}function d3_geo_graticuleX(Ge,Qe,tt){var rt=Ne.range(Ge,Qe-Cn,tt).concat(Qe);return function(Ne){return rt.map((function(Ge){return[Ne,Ge]}))}}function d3_geo_graticuleY(Ge,Qe,tt){var rt=Ne.range(Ge,Qe-Cn,tt).concat(Qe);return function(Ne){return rt.map((function(Ge){return[Ge,Ne]}))}}function d3_source(Ne){return Ne.source}function d3_target(Ne){return Ne.target}function d3_geo_interpolate(Ne,Ge,Qe,tt){var rt=Math.cos(Ge),nt=Math.sin(Ge),at=Math.cos(tt),it=Math.sin(tt),ot=rt*Math.cos(Ne),dt=rt*Math.sin(Ne),ht=at*Math.cos(Qe),Dt=at*Math.sin(Qe),Ot=2*Math.asin(Math.sqrt(d3_haversin(tt-Ge)+rt*at*d3_haversin(Qe-Ne))),Rt=1/Math.sin(Ot),Zt=Ot?function(Ne){var Ge=Math.sin(Ne*=Ot)*Rt,Qe=Math.sin(Ot-Ne)*Rt,tt=Qe*ot+Ge*ht,rt=Qe*dt+Ge*Dt,at=Qe*nt+Ge*it;return[Math.atan2(rt,tt)*Vn,Math.atan2(at,Math.sqrt(tt*tt+rt*rt))*Vn]}:function(){return[Ne*Vn,Ge*Vn]};return Zt.distance=Ot,Zt}Ne.geo.path=function(){var Ge,Qe,tt,rt,nt,at=4.5;function path(Ge){return Ge&&("function"==typeof at&&rt.pointRadius(+at.apply(this,arguments)),nt&&nt.valid||(nt=tt(rt)),Ne.geo.stream(Ge,nt)),rt.result()}function reset(){return nt=null,path}return path.area=function(Ge){return fl=0,Ne.geo.stream(Ge,tt(xl)),fl},path.centroid=function(Ge){return Ls=Ps=Ds=Is=Os=zs=Rs=Bs=Fs=0,Ne.geo.stream(Ge,tt(wl)),Fs?[Rs/Fs,Bs/Fs]:zs?[Is/zs,Os/zs]:Ds?[Ls/Ds,Ps/Ds]:[NaN,NaN]},path.bounds=function(Ge){return ml=vl=-(hl=gl=1/0),Ne.geo.stream(Ge,tt(bl)),[[hl,gl],[ml,vl]]},path.projection=function(Ne){return arguments.length?(tt=(Ge=Ne)?Ne.stream||d3_geo_pathProjectStream(Ne):d3_identity,reset()):Ge},path.context=function(Ne){return arguments.length?(rt=null==(Qe=Ne)?new d3_geo_pathBuffer:new d3_geo_pathContext(Ne),"function"!=typeof at&&rt.pointRadius(at),reset()):Qe},path.pointRadius=function(Ne){return arguments.length?(at="function"==typeof Ne?Ne:(rt.pointRadius(+Ne),+Ne),path):at},path.projection(Ne.geo.albersUsa()).context(null)},Ne.geo.transform=function(Ne){return{stream:function(Ge){var Qe=new d3_geo_transform(Ge);for(var tt in Ne)Qe[tt]=Ne[tt];return Qe}}},d3_geo_transform.prototype={point:function(Ne,Ge){this.stream.point(Ne,Ge)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},Ne.geo.projection=d3_geo_projection,Ne.geo.projectionMutator=d3_geo_projectionMutator,(Ne.geo.equirectangular=function(){return d3_geo_projection(d3_geo_equirectangular)}).raw=d3_geo_equirectangular.invert=d3_geo_equirectangular,Ne.geo.rotation=function(Ne){function forward(Ge){return(Ge=Ne(Ge[0]*Bn,Ge[1]*Bn))[0]*=Vn,Ge[1]*=Vn,Ge}return Ne=d3_geo_rotation(Ne[0]%360*Bn,Ne[1]*Bn,Ne.length>2?Ne[2]*Bn:0),forward.invert=function(Ge){return(Ge=Ne.invert(Ge[0]*Bn,Ge[1]*Bn))[0]*=Vn,Ge[1]*=Vn,Ge},forward},d3_geo_identityRotation.invert=d3_geo_equirectangular,Ne.geo.circle=function(){var Ne,Ge,Qe=[0,0],tt=6;function circle(){var Ne="function"==typeof Qe?Qe.apply(this,arguments):Qe,tt=d3_geo_rotation(-Ne[0]*Bn,-Ne[1]*Bn,0).invert,rt=[];return Ge(null,null,1,{point:function(Ne,Ge){rt.push(Ne=tt(Ne,Ge)),Ne[0]*=Vn,Ne[1]*=Vn}}),{type:"Polygon",coordinates:[rt]}}return circle.origin=function(Ne){return arguments.length?(Qe=Ne,circle):Qe},circle.angle=function(Qe){return arguments.length?(Ge=d3_geo_circleInterpolate((Ne=+Qe)*Bn,tt*Bn),circle):Ne},circle.precision=function(Qe){return arguments.length?(Ge=d3_geo_circleInterpolate(Ne*Bn,(tt=+Qe)*Bn),circle):tt},circle.angle(90)},Ne.geo.distance=function(Ne,Ge){var Qe,tt=(Ge[0]-Ne[0])*Bn,rt=Ne[1]*Bn,nt=Ge[1]*Bn,at=Math.sin(tt),it=Math.cos(tt),ot=Math.sin(rt),dt=Math.cos(rt),ht=Math.sin(nt),Dt=Math.cos(nt);return Math.atan2(Math.sqrt((Qe=Dt*at)*Qe+(Qe=dt*ht-ot*Dt*it)*Qe),ot*ht+dt*Dt*it)},Ne.geo.graticule=function(){var Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Ot,Rt,Zt=10,er=Zt,dr=90,mr=360,xr=2.5;function graticule(){return{type:"MultiLineString",coordinates:lines()}}function lines(){return Ne.range(Math.ceil(rt/dr)*dr,tt,dr).map(Ot).concat(Ne.range(Math.ceil(ot/mr)*mr,it,mr).map(Rt)).concat(Ne.range(Math.ceil(Qe/Zt)*Zt,Ge,Zt).filter((function(Ne){return Dt(Ne%dr)>Cn})).map(dt)).concat(Ne.range(Math.ceil(at/er)*er,nt,er).filter((function(Ne){return Dt(Ne%mr)>Cn})).map(ht))}return graticule.lines=function(){return lines().map((function(Ne){return{type:"LineString",coordinates:Ne}}))},graticule.outline=function(){return{type:"Polygon",coordinates:[Ot(rt).concat(Rt(it).slice(1),Ot(tt).reverse().slice(1),Rt(ot).reverse().slice(1))]}},graticule.extent=function(Ne){return arguments.length?graticule.majorExtent(Ne).minorExtent(Ne):graticule.minorExtent()},graticule.majorExtent=function(Ne){return arguments.length?(rt=+Ne[0][0],tt=+Ne[1][0],ot=+Ne[0][1],it=+Ne[1][1],rt>tt&&(Ne=rt,rt=tt,tt=Ne),ot>it&&(Ne=ot,ot=it,it=Ne),graticule.precision(xr)):[[rt,ot],[tt,it]]},graticule.minorExtent=function(Ne){return arguments.length?(Qe=+Ne[0][0],Ge=+Ne[1][0],at=+Ne[0][1],nt=+Ne[1][1],Qe>Ge&&(Ne=Qe,Qe=Ge,Ge=Ne),at>nt&&(Ne=at,at=nt,nt=Ne),graticule.precision(xr)):[[Qe,at],[Ge,nt]]},graticule.step=function(Ne){return arguments.length?graticule.majorStep(Ne).minorStep(Ne):graticule.minorStep()},graticule.majorStep=function(Ne){return arguments.length?(dr=+Ne[0],mr=+Ne[1],graticule):[dr,mr]},graticule.minorStep=function(Ne){return arguments.length?(Zt=+Ne[0],er=+Ne[1],graticule):[Zt,er]},graticule.precision=function(Ne){return arguments.length?(xr=+Ne,dt=d3_geo_graticuleX(at,nt,90),ht=d3_geo_graticuleY(Qe,Ge,xr),Ot=d3_geo_graticuleX(ot,it,90),Rt=d3_geo_graticuleY(rt,tt,xr),graticule):xr},graticule.majorExtent([[-180,-90+Cn],[180,90-Cn]]).minorExtent([[-180,-80-Cn],[180,80+Cn]])},Ne.geo.greatArc=function(){var Ge,Qe,tt=d3_source,rt=d3_target;function greatArc(){return{type:"LineString",coordinates:[Ge||tt.apply(this,arguments),Qe||rt.apply(this,arguments)]}}return greatArc.distance=function(){return Ne.geo.distance(Ge||tt.apply(this,arguments),Qe||rt.apply(this,arguments))},greatArc.source=function(Ne){return arguments.length?(tt=Ne,Ge="function"==typeof Ne?null:Ne,greatArc):tt},greatArc.target=function(Ne){return arguments.length?(rt=Ne,Qe="function"==typeof Ne?null:Ne,greatArc):rt},greatArc.precision=function(){return arguments.length?greatArc:0},greatArc},Ne.geo.interpolate=function(Ne,Ge){return d3_geo_interpolate(Ne[0]*Bn,Ne[1]*Bn,Ge[0]*Bn,Ge[1]*Bn)},Ne.geo.length=function(Ge){return _l=0,Ne.geo.stream(Ge,kl),_l};var kl={sphere:d3_noop,point:d3_noop,lineStart:d3_geo_lengthLineStart,lineEnd:d3_noop,polygonStart:d3_noop,polygonEnd:d3_noop};function d3_geo_lengthLineStart(){var Ne,Ge,Qe;function nextPoint(tt,rt){var nt=Math.sin(rt*=Bn),at=Math.cos(rt),it=Dt((tt*=Bn)-Ne),ot=Math.cos(it);_l+=Math.atan2(Math.sqrt((it=at*Math.sin(it))*it+(it=Qe*nt-Ge*at*ot)*it),Ge*nt+Qe*at*ot),Ne=tt,Ge=nt,Qe=at}kl.point=function(tt,rt){Ne=tt*Bn,Ge=Math.sin(rt*=Bn),Qe=Math.cos(rt),kl.point=nextPoint},kl.lineEnd=function(){kl.point=kl.lineEnd=d3_noop}}function d3_geo_azimuthal(Ne,Ge){function azimuthal(Ge,Qe){var tt=Math.cos(Ge),rt=Math.cos(Qe),nt=Ne(tt*rt);return[nt*rt*Math.sin(Ge),nt*Math.sin(Qe)]}return azimuthal.invert=function(Ne,Qe){var tt=Math.sqrt(Ne*Ne+Qe*Qe),rt=Ge(tt),nt=Math.sin(rt),at=Math.cos(rt);return[Math.atan2(Ne*nt,tt*at),Math.asin(tt&&Qe*nt/tt)]},azimuthal}var Al=d3_geo_azimuthal((function(Ne){return Math.sqrt(2/(1+Ne))}),(function(Ne){return 2*Math.asin(Ne/2)}));(Ne.geo.azimuthalEqualArea=function(){return d3_geo_projection(Al)}).raw=Al;var Sl=d3_geo_azimuthal((function(Ne){var Ge=Math.acos(Ne);return Ge&&Ge/Math.sin(Ge)}),d3_identity);function d3_geo_conicConformal(Ne,Ge){var Qe=Math.cos(Ne),t=function(Ne){return Math.tan(Pn/4+Ne/2)},tt=Ne===Ge?Math.sin(Ne):Math.log(Qe/Math.cos(Ge))/Math.log(t(Ge)/t(Ne)),rt=Qe*Math.pow(t(Ne),tt)/tt;if(!tt)return d3_geo_mercator;function forward(Ne,Ge){rt>0?Ge<-zn+Cn&&(Ge=-zn+Cn):Ge>zn-Cn&&(Ge=zn-Cn);var Qe=rt/Math.pow(t(Ge),tt);return[Qe*Math.sin(tt*Ne),rt-Qe*Math.cos(tt*Ne)]}return forward.invert=function(Ne,Ge){var Qe=rt-Ge,nt=d3_sgn(tt)*Math.sqrt(Ne*Ne+Qe*Qe);return[Math.atan2(Ne,Qe)/tt,2*Math.atan(Math.pow(rt/nt,1/tt))-zn]},forward}function d3_geo_conicEquidistant(Ne,Ge){var Qe=Math.cos(Ne),tt=Ne===Ge?Math.sin(Ne):(Qe-Math.cos(Ge))/(Ge-Ne),rt=Qe/tt+Ne;if(Dt(tt)<Cn)return d3_geo_equirectangular;function forward(Ne,Ge){var Qe=rt-Ge;return[Qe*Math.sin(tt*Ne),rt-Qe*Math.cos(tt*Ne)]}return forward.invert=function(Ne,Ge){var Qe=rt-Ge;return[Math.atan2(Ne,Qe)/tt,rt-d3_sgn(tt)*Math.sqrt(Ne*Ne+Qe*Qe)]},forward}(Ne.geo.azimuthalEquidistant=function(){return d3_geo_projection(Sl)}).raw=Sl,(Ne.geo.conicConformal=function(){return d3_geo_conic(d3_geo_conicConformal)}).raw=d3_geo_conicConformal,(Ne.geo.conicEquidistant=function(){return d3_geo_conic(d3_geo_conicEquidistant)}).raw=d3_geo_conicEquidistant;var Il=d3_geo_azimuthal((function(Ne){return 1/Ne}),Math.atan);function d3_geo_mercator(Ne,Ge){return[Ne,Math.log(Math.tan(Pn/4+Ge/2))]}function d3_geo_mercatorProjection(Ne){var Ge,Qe=d3_geo_projection(Ne),tt=Qe.scale,rt=Qe.translate,nt=Qe.clipExtent;return Qe.scale=function(){var Ne=tt.apply(Qe,arguments);return Ne===Qe?Ge?Qe.clipExtent(null):Qe:Ne},Qe.translate=function(){var Ne=rt.apply(Qe,arguments);return Ne===Qe?Ge?Qe.clipExtent(null):Qe:Ne},Qe.clipExtent=function(Ne){var at=nt.apply(Qe,arguments);if(at===Qe){if(Ge=null==Ne){var it=Pn*tt(),ot=rt();nt([[ot[0]-it,ot[1]-it],[ot[0]+it,ot[1]+it]])}}else Ge&&(at=null);return at},Qe.clipExtent(null)}(Ne.geo.gnomonic=function(){return d3_geo_projection(Il)}).raw=Il,d3_geo_mercator.invert=function(Ne,Ge){return[Ne,2*Math.atan(Math.exp(Ge))-zn]},(Ne.geo.mercator=function(){return d3_geo_mercatorProjection(d3_geo_mercator)}).raw=d3_geo_mercator;var Bl=d3_geo_azimuthal((function(){return 1}),Math.asin);(Ne.geo.orthographic=function(){return d3_geo_projection(Bl)}).raw=Bl;var Xl=d3_geo_azimuthal((function(Ne){return 1/(1+Ne)}),(function(Ne){return 2*Math.atan(Ne)}));function d3_geo_transverseMercator(Ne,Ge){return[Math.log(Math.tan(Pn/4+Ge/2)),-Ne]}function d3_geom_pointX(Ne){return Ne[0]}function d3_geom_pointY(Ne){return Ne[1]}function d3_geom_hullUpper(Ne){for(var Ge=Ne.length,Qe=[0,1],tt=2,rt=2;rt<Ge;rt++){for(;tt>1&&d3_cross2d(Ne[Qe[tt-2]],Ne[Qe[tt-1]],Ne[rt])<=0;)--tt;Qe[tt++]=rt}return Qe.slice(0,tt)}function d3_geom_hullOrder(Ne,Ge){return Ne[0]-Ge[0]||Ne[1]-Ge[1]}(Ne.geo.stereographic=function(){return d3_geo_projection(Xl)}).raw=Xl,d3_geo_transverseMercator.invert=function(Ne,Ge){return[-Ge,2*Math.atan(Math.exp(Ne))-zn]},(Ne.geo.transverseMercator=function(){var Ne=d3_geo_mercatorProjection(d3_geo_transverseMercator),Ge=Ne.center,Qe=Ne.rotate;return Ne.center=function(Ne){return Ne?Ge([-Ne[1],Ne[0]]):[(Ne=Ge())[1],-Ne[0]]},Ne.rotate=function(Ne){return Ne?Qe([Ne[0],Ne[1],Ne.length>2?Ne[2]+90:90]):[(Ne=Qe())[0],Ne[1],Ne[2]-90]},Qe([0,0,90])}).raw=d3_geo_transverseMercator,Ne.geom={},Ne.geom.hull=function(Ne){var Ge=d3_geom_pointX,Qe=d3_geom_pointY;if(arguments.length)return hull(Ne);function hull(Ne){if(Ne.length<3)return[];var tt,rt=d3_functor(Ge),nt=d3_functor(Qe),at=Ne.length,it=[],ot=[];for(tt=0;tt<at;tt++)it.push([+rt.call(this,Ne[tt],tt),+nt.call(this,Ne[tt],tt),tt]);for(it.sort(d3_geom_hullOrder),tt=0;tt<at;tt++)ot.push([it[tt][0],-it[tt][1]]);var dt=d3_geom_hullUpper(it),ht=d3_geom_hullUpper(ot),Dt=ht[0]===dt[0],Ot=ht[ht.length-1]===dt[dt.length-1],Rt=[];for(tt=dt.length-1;tt>=0;--tt)Rt.push(Ne[it[dt[tt]][2]]);for(tt=+Dt;tt<ht.length-Ot;++tt)Rt.push(Ne[it[ht[tt]][2]]);return Rt}return hull.x=function(Ne){return arguments.length?(Ge=Ne,hull):Ge},hull.y=function(Ne){return arguments.length?(Qe=Ne,hull):Qe},hull},Ne.geom.polygon=function(Ne){return dr(Ne,ec),Ne};var ec=Ne.geom.polygon.prototype=[];function d3_geom_polygonInside(Ne,Ge,Qe){return(Qe[0]-Ge[0])*(Ne[1]-Ge[1])<(Qe[1]-Ge[1])*(Ne[0]-Ge[0])}function d3_geom_polygonIntersect(Ne,Ge,Qe,tt){var rt=Ne[0],nt=Qe[0],at=Ge[0]-rt,it=tt[0]-nt,ot=Ne[1],dt=Qe[1],ht=Ge[1]-ot,Dt=tt[1]-dt,Ot=(it*(ot-dt)-Dt*(rt-nt))/(Dt*at-it*ht);return[rt+Ot*at,ot+Ot*ht]}function d3_geom_polygonClosed(Ne){var Ge=Ne[0],Qe=Ne[Ne.length-1];return!(Ge[0]-Qe[0]||Ge[1]-Qe[1])}ec.area=function(){for(var Ne,Ge=-1,Qe=this.length,tt=this[Qe-1],rt=0;++Ge<Qe;)Ne=tt,tt=this[Ge],rt+=Ne[1]*tt[0]-Ne[0]*tt[1];return.5*rt},ec.centroid=function(Ne){var Ge,Qe,tt=-1,rt=this.length,nt=0,at=0,it=this[rt-1];for(arguments.length||(Ne=-1/(6*this.area()));++tt<rt;)Ge=it,it=this[tt],Qe=Ge[0]*it[1]-it[0]*Ge[1],nt+=(Ge[0]+it[0])*Qe,at+=(Ge[1]+it[1])*Qe;return[nt*Ne,at*Ne]},ec.clip=function(Ne){for(var Ge,Qe,tt,rt,nt,at,it=d3_geom_polygonClosed(Ne),ot=-1,dt=this.length-d3_geom_polygonClosed(this),ht=this[dt-1];++ot<dt;){for(Ge=Ne.slice(),Ne.length=0,rt=this[ot],nt=Ge[(tt=Ge.length-it)-1],Qe=-1;++Qe<tt;)d3_geom_polygonInside(at=Ge[Qe],ht,rt)?(d3_geom_polygonInside(nt,ht,rt)||Ne.push(d3_geom_polygonIntersect(nt,at,ht,rt)),Ne.push(at)):d3_geom_polygonInside(nt,ht,rt)&&Ne.push(d3_geom_polygonIntersect(nt,at,ht,rt)),nt=at;it&&Ne.push(Ne[0]),ht=rt}return Ne};var tc,rc,nc,ac,ic,oc=[],sc=[];function d3_geom_voronoiBeach(){d3_geom_voronoiRedBlackNode(this),this.edge=this.site=this.circle=null}function d3_geom_voronoiCreateBeach(Ne){var Ge=oc.pop()||new d3_geom_voronoiBeach;return Ge.site=Ne,Ge}function d3_geom_voronoiDetachBeach(Ne){d3_geom_voronoiDetachCircle(Ne),nc.remove(Ne),oc.push(Ne),d3_geom_voronoiRedBlackNode(Ne)}function d3_geom_voronoiRemoveBeach(Ne){var Ge=Ne.circle,Qe=Ge.x,tt=Ge.cy,rt={x:Qe,y:tt},nt=Ne.P,at=Ne.N,it=[Ne];d3_geom_voronoiDetachBeach(Ne);for(var ot=nt;ot.circle&&Dt(Qe-ot.circle.x)<Cn&&Dt(tt-ot.circle.cy)<Cn;)nt=ot.P,it.unshift(ot),d3_geom_voronoiDetachBeach(ot),ot=nt;it.unshift(ot),d3_geom_voronoiDetachCircle(ot);for(var dt=at;dt.circle&&Dt(Qe-dt.circle.x)<Cn&&Dt(tt-dt.circle.cy)<Cn;)at=dt.N,it.push(dt),d3_geom_voronoiDetachBeach(dt),dt=at;it.push(dt),d3_geom_voronoiDetachCircle(dt);var ht,Ot=it.length;for(ht=1;ht<Ot;++ht)dt=it[ht],ot=it[ht-1],d3_geom_voronoiSetEdgeEnd(dt.edge,ot.site,dt.site,rt);ot=it[0],(dt=it[Ot-1]).edge=d3_geom_voronoiCreateEdge(ot.site,dt.site,null,rt),d3_geom_voronoiAttachCircle(ot),d3_geom_voronoiAttachCircle(dt)}function d3_geom_voronoiAddBeach(Ne){for(var Ge,Qe,tt,rt,nt=Ne.x,at=Ne.y,it=nc._;it;)if((tt=d3_geom_voronoiLeftBreakPoint(it,at)-nt)>Cn)it=it.L;else{if(!((rt=nt-d3_geom_voronoiRightBreakPoint(it,at))>Cn)){tt>-Cn?(Ge=it.P,Qe=it):rt>-Cn?(Ge=it,Qe=it.N):Ge=Qe=it;break}if(!it.R){Ge=it;break}it=it.R}var ot=d3_geom_voronoiCreateBeach(Ne);if(nc.insert(Ge,ot),Ge||Qe){if(Ge===Qe)return d3_geom_voronoiDetachCircle(Ge),Qe=d3_geom_voronoiCreateBeach(Ge.site),nc.insert(ot,Qe),ot.edge=Qe.edge=d3_geom_voronoiCreateEdge(Ge.site,ot.site),d3_geom_voronoiAttachCircle(Ge),void d3_geom_voronoiAttachCircle(Qe);if(Qe){d3_geom_voronoiDetachCircle(Ge),d3_geom_voronoiDetachCircle(Qe);var dt=Ge.site,ht=dt.x,Dt=dt.y,Ot=Ne.x-ht,Rt=Ne.y-Dt,Zt=Qe.site,er=Zt.x-ht,dr=Zt.y-Dt,mr=2*(Ot*dr-Rt*er),xr=Ot*Ot+Rt*Rt,br=er*er+dr*dr,Ar={x:(dr*xr-Rt*br)/mr+ht,y:(Ot*br-er*xr)/mr+Dt};d3_geom_voronoiSetEdgeEnd(Qe.edge,dt,Zt,Ar),ot.edge=d3_geom_voronoiCreateEdge(dt,Ne,null,Ar),Qe.edge=d3_geom_voronoiCreateEdge(Ne,Zt,null,Ar),d3_geom_voronoiAttachCircle(Ge),d3_geom_voronoiAttachCircle(Qe)}else ot.edge=d3_geom_voronoiCreateEdge(Ge.site,ot.site)}}function d3_geom_voronoiLeftBreakPoint(Ne,Ge){var Qe=Ne.site,tt=Qe.x,rt=Qe.y,nt=rt-Ge;if(!nt)return tt;var at=Ne.P;if(!at)return-1/0;var it=(Qe=at.site).x,ot=Qe.y,dt=ot-Ge;if(!dt)return it;var ht=it-tt,Dt=1/nt-1/dt,Ot=ht/dt;return Dt?(-Ot+Math.sqrt(Ot*Ot-2*Dt*(ht*ht/(-2*dt)-ot+dt/2+rt-nt/2)))/Dt+tt:(tt+it)/2}function d3_geom_voronoiRightBreakPoint(Ne,Ge){var Qe=Ne.N;if(Qe)return d3_geom_voronoiLeftBreakPoint(Qe,Ge);var tt=Ne.site;return tt.y===Ge?tt.x:1/0}function d3_geom_voronoiCell(Ne){this.site=Ne,this.edges=[]}function d3_geom_voronoiCloseCells(Ne){for(var Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Ot=Ne[0][0],Rt=Ne[1][0],Zt=Ne[0][1],er=Ne[1][1],dr=rc,mr=dr.length;mr--;)if((nt=dr[mr])&&nt.prepare())for(ot=(it=nt.edges).length,at=0;at<ot;)tt=(ht=it[at].end()).x,rt=ht.y,Ge=(dt=it[++at%ot].start()).x,Qe=dt.y,(Dt(tt-Ge)>Cn||Dt(rt-Qe)>Cn)&&(it.splice(at,0,new d3_geom_voronoiHalfEdge(d3_geom_voronoiCreateBorderEdge(nt.site,ht,Dt(tt-Ot)<Cn&&er-rt>Cn?{x:Ot,y:Dt(Ge-Ot)<Cn?Qe:er}:Dt(rt-er)<Cn&&Rt-tt>Cn?{x:Dt(Qe-er)<Cn?Ge:Rt,y:er}:Dt(tt-Rt)<Cn&&rt-Zt>Cn?{x:Rt,y:Dt(Ge-Rt)<Cn?Qe:Zt}:Dt(rt-Zt)<Cn&&tt-Ot>Cn?{x:Dt(Qe-Zt)<Cn?Ge:Ot,y:Zt}:null),nt.site,null)),++ot)}function d3_geom_voronoiHalfEdgeOrder(Ne,Ge){return Ge.angle-Ne.angle}function d3_geom_voronoiCircle(){d3_geom_voronoiRedBlackNode(this),this.x=this.y=this.arc=this.site=this.cy=null}function d3_geom_voronoiAttachCircle(Ne){var Ge=Ne.P,Qe=Ne.N;if(Ge&&Qe){var tt=Ge.site,rt=Ne.site,nt=Qe.site;if(tt!==nt){var at=rt.x,it=rt.y,ot=tt.x-at,dt=tt.y-it,ht=nt.x-at,Dt=2*(ot*(dr=nt.y-it)-dt*ht);if(!(Dt>=-En)){var Ot=ot*ot+dt*dt,Rt=ht*ht+dr*dr,Zt=(dr*Ot-dt*Rt)/Dt,er=(ot*Rt-ht*Ot)/Dt,dr=er+it,mr=sc.pop()||new d3_geom_voronoiCircle;mr.arc=Ne,mr.site=rt,mr.x=Zt+at,mr.y=dr+Math.sqrt(Zt*Zt+er*er),mr.cy=dr,Ne.circle=mr;for(var xr=null,br=ic._;br;)if(mr.y<br.y||mr.y===br.y&&mr.x<=br.x){if(!br.L){xr=br.P;break}br=br.L}else{if(!br.R){xr=br;break}br=br.R}ic.insert(xr,mr),xr||(ac=mr)}}}}function d3_geom_voronoiDetachCircle(Ne){var Ge=Ne.circle;Ge&&(Ge.P||(ac=Ge.N),ic.remove(Ge),sc.push(Ge),d3_geom_voronoiRedBlackNode(Ge),Ne.circle=null)}function d3_geom_voronoiClipEdges(Ne){for(var Ge,Qe=tc,tt=d3_geom_clipLine(Ne[0][0],Ne[0][1],Ne[1][0],Ne[1][1]),rt=Qe.length;rt--;)(!d3_geom_voronoiConnectEdge(Ge=Qe[rt],Ne)||!tt(Ge)||Dt(Ge.a.x-Ge.b.x)<Cn&&Dt(Ge.a.y-Ge.b.y)<Cn)&&(Ge.a=Ge.b=null,Qe.splice(rt,1))}function d3_geom_voronoiConnectEdge(Ne,Ge){var Qe=Ne.b;if(Qe)return!0;var tt,rt,nt=Ne.a,at=Ge[0][0],it=Ge[1][0],ot=Ge[0][1],dt=Ge[1][1],ht=Ne.l,Dt=Ne.r,Ot=ht.x,Rt=ht.y,Zt=Dt.x,er=Dt.y,dr=(Ot+Zt)/2,mr=(Rt+er)/2;if(er===Rt){if(dr<at||dr>=it)return;if(Ot>Zt){if(nt){if(nt.y>=dt)return}else nt={x:dr,y:ot};Qe={x:dr,y:dt}}else{if(nt){if(nt.y<ot)return}else nt={x:dr,y:dt};Qe={x:dr,y:ot}}}else if(rt=mr-(tt=(Ot-Zt)/(er-Rt))*dr,tt<-1||tt>1)if(Ot>Zt){if(nt){if(nt.y>=dt)return}else nt={x:(ot-rt)/tt,y:ot};Qe={x:(dt-rt)/tt,y:dt}}else{if(nt){if(nt.y<ot)return}else nt={x:(dt-rt)/tt,y:dt};Qe={x:(ot-rt)/tt,y:ot}}else if(Rt<er){if(nt){if(nt.x>=it)return}else nt={x:at,y:tt*at+rt};Qe={x:it,y:tt*it+rt}}else{if(nt){if(nt.x<at)return}else nt={x:it,y:tt*it+rt};Qe={x:at,y:tt*at+rt}}return Ne.a=nt,Ne.b=Qe,!0}function d3_geom_voronoiEdge(Ne,Ge){this.l=Ne,this.r=Ge,this.a=this.b=null}function d3_geom_voronoiCreateEdge(Ne,Ge,Qe,tt){var rt=new d3_geom_voronoiEdge(Ne,Ge);return tc.push(rt),Qe&&d3_geom_voronoiSetEdgeEnd(rt,Ne,Ge,Qe),tt&&d3_geom_voronoiSetEdgeEnd(rt,Ge,Ne,tt),rc[Ne.i].edges.push(new d3_geom_voronoiHalfEdge(rt,Ne,Ge)),rc[Ge.i].edges.push(new d3_geom_voronoiHalfEdge(rt,Ge,Ne)),rt}function d3_geom_voronoiCreateBorderEdge(Ne,Ge,Qe){var tt=new d3_geom_voronoiEdge(Ne,null);return tt.a=Ge,tt.b=Qe,tc.push(tt),tt}function d3_geom_voronoiSetEdgeEnd(Ne,Ge,Qe,tt){Ne.a||Ne.b?Ne.l===Qe?Ne.b=tt:Ne.a=tt:(Ne.a=tt,Ne.l=Ge,Ne.r=Qe)}function d3_geom_voronoiHalfEdge(Ne,Ge,Qe){var tt=Ne.a,rt=Ne.b;this.edge=Ne,this.site=Ge,this.angle=Qe?Math.atan2(Qe.y-Ge.y,Qe.x-Ge.x):Ne.l===Ge?Math.atan2(rt.x-tt.x,tt.y-rt.y):Math.atan2(tt.x-rt.x,rt.y-tt.y)}function d3_geom_voronoiRedBlackTree(){this._=null}function d3_geom_voronoiRedBlackNode(Ne){Ne.U=Ne.C=Ne.L=Ne.R=Ne.P=Ne.N=null}function d3_geom_voronoiRedBlackRotateLeft(Ne,Ge){var Qe=Ge,tt=Ge.R,rt=Qe.U;rt?rt.L===Qe?rt.L=tt:rt.R=tt:Ne._=tt,tt.U=rt,Qe.U=tt,Qe.R=tt.L,Qe.R&&(Qe.R.U=Qe),tt.L=Qe}function d3_geom_voronoiRedBlackRotateRight(Ne,Ge){var Qe=Ge,tt=Ge.L,rt=Qe.U;rt?rt.L===Qe?rt.L=tt:rt.R=tt:Ne._=tt,tt.U=rt,Qe.U=tt,Qe.L=tt.R,Qe.L&&(Qe.L.U=Qe),tt.R=Qe}function d3_geom_voronoiRedBlackFirst(Ne){for(;Ne.L;)Ne=Ne.L;return Ne}function d3_geom_voronoi(Ne,Ge){var Qe,tt,rt,nt=Ne.sort(d3_geom_voronoiVertexOrder).pop();for(tc=[],rc=new Array(Ne.length),nc=new d3_geom_voronoiRedBlackTree,ic=new d3_geom_voronoiRedBlackTree;;)if(rt=ac,nt&&(!rt||nt.y<rt.y||nt.y===rt.y&&nt.x<rt.x))nt.x===Qe&&nt.y===tt||(rc[nt.i]=new d3_geom_voronoiCell(nt),d3_geom_voronoiAddBeach(nt),Qe=nt.x,tt=nt.y),nt=Ne.pop();else{if(!rt)break;d3_geom_voronoiRemoveBeach(rt.arc)}Ge&&(d3_geom_voronoiClipEdges(Ge),d3_geom_voronoiCloseCells(Ge));var at={cells:rc,edges:tc};return nc=ic=tc=rc=null,at}function d3_geom_voronoiVertexOrder(Ne,Ge){return Ge.y-Ne.y||Ge.x-Ne.x}d3_geom_voronoiCell.prototype.prepare=function(){for(var Ne,Ge=this.edges,Qe=Ge.length;Qe--;)(Ne=Ge[Qe].edge).b&&Ne.a||Ge.splice(Qe,1);return Ge.sort(d3_geom_voronoiHalfEdgeOrder),Ge.length},d3_geom_voronoiHalfEdge.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},d3_geom_voronoiRedBlackTree.prototype={insert:function(Ne,Ge){var Qe,tt,rt;if(Ne){if(Ge.P=Ne,Ge.N=Ne.N,Ne.N&&(Ne.N.P=Ge),Ne.N=Ge,Ne.R){for(Ne=Ne.R;Ne.L;)Ne=Ne.L;Ne.L=Ge}else Ne.R=Ge;Qe=Ne}else this._?(Ne=d3_geom_voronoiRedBlackFirst(this._),Ge.P=null,Ge.N=Ne,Ne.P=Ne.L=Ge,Qe=Ne):(Ge.P=Ge.N=null,this._=Ge,Qe=null);for(Ge.L=Ge.R=null,Ge.U=Qe,Ge.C=!0,Ne=Ge;Qe&&Qe.C;)Qe===(tt=Qe.U).L?(rt=tt.R)&&rt.C?(Qe.C=rt.C=!1,tt.C=!0,Ne=tt):(Ne===Qe.R&&(d3_geom_voronoiRedBlackRotateLeft(this,Qe),Qe=(Ne=Qe).U),Qe.C=!1,tt.C=!0,d3_geom_voronoiRedBlackRotateRight(this,tt)):(rt=tt.L)&&rt.C?(Qe.C=rt.C=!1,tt.C=!0,Ne=tt):(Ne===Qe.L&&(d3_geom_voronoiRedBlackRotateRight(this,Qe),Qe=(Ne=Qe).U),Qe.C=!1,tt.C=!0,d3_geom_voronoiRedBlackRotateLeft(this,tt)),Qe=Ne.U;this._.C=!1},remove:function(Ne){Ne.N&&(Ne.N.P=Ne.P),Ne.P&&(Ne.P.N=Ne.N),Ne.N=Ne.P=null;var Ge,Qe,tt,rt=Ne.U,nt=Ne.L,at=Ne.R;if(Qe=nt?at?d3_geom_voronoiRedBlackFirst(at):nt:at,rt?rt.L===Ne?rt.L=Qe:rt.R=Qe:this._=Qe,nt&&at?(tt=Qe.C,Qe.C=Ne.C,Qe.L=nt,nt.U=Qe,Qe!==at?(rt=Qe.U,Qe.U=Ne.U,Ne=Qe.R,rt.L=Ne,Qe.R=at,at.U=Qe):(Qe.U=rt,rt=Qe,Ne=Qe.R)):(tt=Ne.C,Ne=Qe),Ne&&(Ne.U=rt),!tt)if(Ne&&Ne.C)Ne.C=!1;else{do{if(Ne===this._)break;if(Ne===rt.L){if((Ge=rt.R).C&&(Ge.C=!1,rt.C=!0,d3_geom_voronoiRedBlackRotateLeft(this,rt),Ge=rt.R),Ge.L&&Ge.L.C||Ge.R&&Ge.R.C){Ge.R&&Ge.R.C||(Ge.L.C=!1,Ge.C=!0,d3_geom_voronoiRedBlackRotateRight(this,Ge),Ge=rt.R),Ge.C=rt.C,rt.C=Ge.R.C=!1,d3_geom_voronoiRedBlackRotateLeft(this,rt),Ne=this._;break}}else if((Ge=rt.L).C&&(Ge.C=!1,rt.C=!0,d3_geom_voronoiRedBlackRotateRight(this,rt),Ge=rt.L),Ge.L&&Ge.L.C||Ge.R&&Ge.R.C){Ge.L&&Ge.L.C||(Ge.R.C=!1,Ge.C=!0,d3_geom_voronoiRedBlackRotateLeft(this,Ge),Ge=rt.L),Ge.C=rt.C,rt.C=Ge.L.C=!1,d3_geom_voronoiRedBlackRotateRight(this,rt),Ne=this._;break}Ge.C=!0,Ne=rt,rt=rt.U}while(!Ne.C);Ne&&(Ne.C=!1)}}},Ne.geom.voronoi=function(Ne){var Ge=d3_geom_pointX,Qe=d3_geom_pointY,tt=Ge,rt=Qe,nt=lc;if(Ne)return voronoi(Ne);function voronoi(Ne){var Ge=new Array(Ne.length),Qe=nt[0][0],tt=nt[0][1],rt=nt[1][0],at=nt[1][1];return d3_geom_voronoi(sites(Ne),nt).cells.forEach((function(nt,it){var ot=nt.edges,dt=nt.site;(Ge[it]=ot.length?ot.map((function(Ne){var Ge=Ne.start();return[Ge.x,Ge.y]})):dt.x>=Qe&&dt.x<=rt&&dt.y>=tt&&dt.y<=at?[[Qe,at],[rt,at],[rt,tt],[Qe,tt]]:[]).point=Ne[it]})),Ge}function sites(Ne){return Ne.map((function(Ne,Ge){return{x:Math.round(tt(Ne,Ge)/Cn)*Cn,y:Math.round(rt(Ne,Ge)/Cn)*Cn,i:Ge}}))}return voronoi.links=function(Ne){return d3_geom_voronoi(sites(Ne)).edges.filter((function(Ne){return Ne.l&&Ne.r})).map((function(Ge){return{source:Ne[Ge.l.i],target:Ne[Ge.r.i]}}))},voronoi.triangles=function(Ne){var Ge=[];return d3_geom_voronoi(sites(Ne)).cells.forEach((function(Qe,tt){for(var rt,nt=Qe.site,at=Qe.edges.sort(d3_geom_voronoiHalfEdgeOrder),it=-1,ot=at.length,dt=at[ot-1].edge,ht=dt.l===nt?dt.r:dt.l;++it<ot;)rt=ht,ht=(dt=at[it].edge).l===nt?dt.r:dt.l,tt<rt.i&&tt<ht.i&&d3_geom_voronoiTriangleArea(nt,rt,ht)<0&&Ge.push([Ne[tt],Ne[rt.i],Ne[ht.i]])})),Ge},voronoi.x=function(Ne){return arguments.length?(tt=d3_functor(Ge=Ne),voronoi):Ge},voronoi.y=function(Ne){return arguments.length?(rt=d3_functor(Qe=Ne),voronoi):Qe},voronoi.clipExtent=function(Ne){return arguments.length?(nt=null==Ne?lc:Ne,voronoi):nt===lc?null:nt},voronoi.size=function(Ne){return arguments.length?voronoi.clipExtent(Ne&&[[0,0],Ne]):nt===lc?null:nt&&nt[1]},voronoi};var lc=[[-1e6,-1e6],[1e6,1e6]];function d3_geom_voronoiTriangleArea(Ne,Ge,Qe){return(Ne.x-Qe.x)*(Ge.y-Ne.y)-(Ne.x-Ge.x)*(Qe.y-Ne.y)}function d3_geom_quadtreeCompatX(Ne){return Ne.x}function d3_geom_quadtreeCompatY(Ne){return Ne.y}function d3_geom_quadtreeNode(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function d3_geom_quadtreeVisit(Ne,Ge,Qe,tt,rt,nt){if(!Ne(Ge,Qe,tt,rt,nt)){var at=.5*(Qe+rt),it=.5*(tt+nt),ot=Ge.nodes;ot[0]&&d3_geom_quadtreeVisit(Ne,ot[0],Qe,tt,at,it),ot[1]&&d3_geom_quadtreeVisit(Ne,ot[1],at,tt,rt,it),ot[2]&&d3_geom_quadtreeVisit(Ne,ot[2],Qe,it,at,nt),ot[3]&&d3_geom_quadtreeVisit(Ne,ot[3],at,it,rt,nt)}}function d3_geom_quadtreeFind(Ne,Ge,Qe,tt,rt,nt,at){var it,ot=1/0;return function find(Ne,dt,ht,Dt,Ot){if(!(dt>nt||ht>at||Dt<tt||Ot<rt)){if(Rt=Ne.point){var Rt,Zt=Ge-Ne.x,er=Qe-Ne.y,dr=Zt*Zt+er*er;if(dr<ot){var mr=Math.sqrt(ot=dr);tt=Ge-mr,rt=Qe-mr,nt=Ge+mr,at=Qe+mr,it=Rt}}for(var xr=Ne.nodes,br=.5*(dt+Dt),Ar=.5*(ht+Ot),en=(Qe>=Ar)<<1|Ge>=br,mn=en+4;en<mn;++en)if(Ne=xr[3&en])switch(3&en){case 0:find(Ne,dt,ht,br,Ar);break;case 1:find(Ne,br,ht,Dt,Ar);break;case 2:find(Ne,dt,Ar,br,Ot);break;case 3:find(Ne,br,Ar,Dt,Ot)}}}(Ne,tt,rt,nt,at),it}function d3_interpolateRgb(Ge,Qe){Ge=Ne.rgb(Ge),Qe=Ne.rgb(Qe);var tt=Ge.r,rt=Ge.g,nt=Ge.b,at=Qe.r-tt,it=Qe.g-rt,ot=Qe.b-nt;return function(Ne){return"#"+d3_rgb_hex(Math.round(tt+at*Ne))+d3_rgb_hex(Math.round(rt+it*Ne))+d3_rgb_hex(Math.round(nt+ot*Ne))}}function d3_interpolateObject(Ne,Ge){var Qe,tt={},rt={};for(Qe in Ne)Qe in Ge?tt[Qe]=d3_interpolate(Ne[Qe],Ge[Qe]):rt[Qe]=Ne[Qe];for(Qe in Ge)Qe in Ne||(rt[Qe]=Ge[Qe]);return function(Ne){for(Qe in tt)rt[Qe]=tt[Qe](Ne);return rt}}function d3_interpolateNumber(Ne,Ge){return Ne=+Ne,Ge=+Ge,function(Qe){return Ne*(1-Qe)+Ge*Qe}}function d3_interpolateString(Ne,Ge){var Qe,tt,rt,nt=cc.lastIndex=uc.lastIndex=0,at=-1,it=[],ot=[];for(Ne+="",Ge+="";(Qe=cc.exec(Ne))&&(tt=uc.exec(Ge));)(rt=tt.index)>nt&&(rt=Ge.slice(nt,rt),it[at]?it[at]+=rt:it[++at]=rt),(Qe=Qe[0])===(tt=tt[0])?it[at]?it[at]+=tt:it[++at]=tt:(it[++at]=null,ot.push({i:at,x:d3_interpolateNumber(Qe,tt)})),nt=uc.lastIndex;return nt<Ge.length&&(rt=Ge.slice(nt),it[at]?it[at]+=rt:it[++at]=rt),it.length<2?ot[0]?(Ge=ot[0].x,function(Ne){return Ge(Ne)+""}):function(){return Ge}:(Ge=ot.length,function(Ne){for(var Qe,tt=0;tt<Ge;++tt)it[(Qe=ot[tt]).i]=Qe.x(Ne);return it.join("")})}Ne.geom.delaunay=function(Ge){return Ne.geom.voronoi().triangles(Ge)},Ne.geom.quadtree=function(Ne,Ge,Qe,tt,rt){var nt,at=d3_geom_pointX,it=d3_geom_pointY;if(nt=arguments.length)return at=d3_geom_quadtreeCompatX,it=d3_geom_quadtreeCompatY,3===nt&&(rt=Qe,tt=Ge,Qe=Ge=0),quadtree(Ne);function quadtree(Ne){var ot,dt,ht,Ot,Rt,Zt,er,dr,mr,xr=d3_functor(at),br=d3_functor(it);if(null!=Ge)Zt=Ge,er=Qe,dr=tt,mr=rt;else if(dr=mr=-(Zt=er=1/0),dt=[],ht=[],Rt=Ne.length,nt)for(Ot=0;Ot<Rt;++Ot)(ot=Ne[Ot]).x<Zt&&(Zt=ot.x),ot.y<er&&(er=ot.y),ot.x>dr&&(dr=ot.x),ot.y>mr&&(mr=ot.y),dt.push(ot.x),ht.push(ot.y);else for(Ot=0;Ot<Rt;++Ot){var Ar=+xr(ot=Ne[Ot],Ot),en=+br(ot,Ot);Ar<Zt&&(Zt=Ar),en<er&&(er=en),Ar>dr&&(dr=Ar),en>mr&&(mr=en),dt.push(Ar),ht.push(en)}var mn=dr-Zt,xn=mr-er;function insert(Ne,Ge,Qe,tt,rt,nt,at,it){if(!isNaN(Qe)&&!isNaN(tt))if(Ne.leaf){var ot=Ne.x,dt=Ne.y;if(null!=ot)if(Dt(ot-Qe)+Dt(dt-tt)<.01)insertChild(Ne,Ge,Qe,tt,rt,nt,at,it);else{var ht=Ne.point;Ne.x=Ne.y=Ne.point=null,insertChild(Ne,ht,ot,dt,rt,nt,at,it),insertChild(Ne,Ge,Qe,tt,rt,nt,at,it)}else Ne.x=Qe,Ne.y=tt,Ne.point=Ge}else insertChild(Ne,Ge,Qe,tt,rt,nt,at,it)}function insertChild(Ne,Ge,Qe,tt,rt,nt,at,it){var ot=.5*(rt+at),dt=.5*(nt+it),ht=Qe>=ot,Dt=tt>=dt,Ot=Dt<<1|ht;Ne.leaf=!1,ht?rt=ot:at=ot,Dt?nt=dt:it=dt,insert(Ne=Ne.nodes[Ot]||(Ne.nodes[Ot]=d3_geom_quadtreeNode()),Ge,Qe,tt,rt,nt,at,it)}mn>xn?mr=er+mn:dr=Zt+xn;var kn=d3_geom_quadtreeNode();if(kn.add=function(Ne){insert(kn,Ne,+xr(Ne,++Ot),+br(Ne,Ot),Zt,er,dr,mr)},kn.visit=function(Ne){d3_geom_quadtreeVisit(Ne,kn,Zt,er,dr,mr)},kn.find=function(Ne){return d3_geom_quadtreeFind(kn,Ne[0],Ne[1],Zt,er,dr,mr)},Ot=-1,null==Ge){for(;++Ot<Rt;)insert(kn,Ne[Ot],dt[Ot],ht[Ot],Zt,er,dr,mr);--Ot}else Ne.forEach(kn.add);return dt=ht=Ne=ot=null,kn}return quadtree.x=function(Ne){return arguments.length?(at=Ne,quadtree):at},quadtree.y=function(Ne){return arguments.length?(it=Ne,quadtree):it},quadtree.extent=function(Ne){return arguments.length?(null==Ne?Ge=Qe=tt=rt=null:(Ge=+Ne[0][0],Qe=+Ne[0][1],tt=+Ne[1][0],rt=+Ne[1][1]),quadtree):null==Ge?null:[[Ge,Qe],[tt,rt]]},quadtree.size=function(Ne){return arguments.length?(null==Ne?Ge=Qe=tt=rt=null:(Ge=Qe=0,tt=+Ne[0],rt=+Ne[1]),quadtree):null==Ge?null:[tt-Ge,rt-Qe]},quadtree},Ne.interpolateRgb=d3_interpolateRgb,Ne.interpolateObject=d3_interpolateObject,Ne.interpolateNumber=d3_interpolateNumber,Ne.interpolateString=d3_interpolateString;var cc=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,uc=new RegExp(cc.source,"g");function d3_interpolate(Ge,Qe){for(var tt,rt=Ne.interpolators.length;--rt>=0&&!(tt=Ne.interpolators[rt](Ge,Qe)););return tt}function d3_interpolateArray(Ne,Ge){var Qe,tt=[],rt=[],nt=Ne.length,at=Ge.length,it=Math.min(Ne.length,Ge.length);for(Qe=0;Qe<it;++Qe)tt.push(d3_interpolate(Ne[Qe],Ge[Qe]));for(;Qe<nt;++Qe)rt[Qe]=Ne[Qe];for(;Qe<at;++Qe)rt[Qe]=Ge[Qe];return function(Ne){for(Qe=0;Qe<it;++Qe)rt[Qe]=tt[Qe](Ne);return rt}}Ne.interpolate=d3_interpolate,Ne.interpolators=[function(Ne,Ge){var Qe=typeof Ge;return("string"===Qe?ni.has(Ge.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(Ge)?d3_interpolateRgb:d3_interpolateString:Ge instanceof d3_color?d3_interpolateRgb:Array.isArray(Ge)?d3_interpolateArray:"object"===Qe&&isNaN(Ge)?d3_interpolateObject:d3_interpolateNumber)(Ne,Ge)}],Ne.interpolateArray=d3_interpolateArray;var d3_ease_default=function(){return d3_identity},fc=Ne.map({linear:d3_ease_default,poly:d3_ease_poly,quad:function(){return d3_ease_quad},cubic:function(){return d3_ease_cubic},sin:function(){return d3_ease_sin},exp:function(){return d3_ease_exp},circle:function(){return d3_ease_circle},elastic:d3_ease_elastic,back:d3_ease_back,bounce:function(){return d3_ease_bounce}}),pc=Ne.map({in:d3_identity,out:d3_ease_reverse,"in-out":d3_ease_reflect,"out-in":function(Ne){return d3_ease_reflect(d3_ease_reverse(Ne))}});function d3_ease_clamp(Ne){return function(Ge){return Ge<=0?0:Ge>=1?1:Ne(Ge)}}function d3_ease_reverse(Ne){return function(Ge){return 1-Ne(1-Ge)}}function d3_ease_reflect(Ne){return function(Ge){return.5*(Ge<.5?Ne(2*Ge):2-Ne(2-2*Ge))}}function d3_ease_quad(Ne){return Ne*Ne}function d3_ease_cubic(Ne){return Ne*Ne*Ne}function d3_ease_cubicInOut(Ne){if(Ne<=0)return 0;if(Ne>=1)return 1;var Ge=Ne*Ne,Qe=Ge*Ne;return 4*(Ne<.5?Qe:3*(Ne-Ge)+Qe-.75)}function d3_ease_poly(Ne){return function(Ge){return Math.pow(Ge,Ne)}}function d3_ease_sin(Ne){return 1-Math.cos(Ne*zn)}function d3_ease_exp(Ne){return Math.pow(2,10*(Ne-1))}function d3_ease_circle(Ne){return 1-Math.sqrt(1-Ne*Ne)}function d3_ease_elastic(Ne,Ge){var Qe;return arguments.length<2&&(Ge=.45),arguments.length?Qe=Ge/Dn*Math.asin(1/Ne):(Ne=1,Qe=Ge/4),function(tt){return 1+Ne*Math.pow(2,-10*tt)*Math.sin((tt-Qe)*Dn/Ge)}}function d3_ease_back(Ne){return Ne||(Ne=1.70158),function(Ge){return Ge*Ge*((Ne+1)*Ge-Ne)}}function d3_ease_bounce(Ne){return Ne<1/2.75?7.5625*Ne*Ne:Ne<2/2.75?7.5625*(Ne-=1.5/2.75)*Ne+.75:Ne<2.5/2.75?7.5625*(Ne-=2.25/2.75)*Ne+.9375:7.5625*(Ne-=2.625/2.75)*Ne+.984375}function d3_interpolateHcl(Ge,Qe){Ge=Ne.hcl(Ge),Qe=Ne.hcl(Qe);var tt=Ge.h,rt=Ge.c,nt=Ge.l,at=Qe.h-tt,it=Qe.c-rt,ot=Qe.l-nt;return isNaN(it)&&(it=0,rt=isNaN(rt)?Qe.c:rt),isNaN(at)?(at=0,tt=isNaN(tt)?Qe.h:tt):at>180?at-=360:at<-180&&(at+=360),function(Ne){return d3_hcl_lab(tt+at*Ne,rt+it*Ne,nt+ot*Ne)+""}}function d3_interpolateHsl(Ge,Qe){Ge=Ne.hsl(Ge),Qe=Ne.hsl(Qe);var tt=Ge.h,rt=Ge.s,nt=Ge.l,at=Qe.h-tt,it=Qe.s-rt,ot=Qe.l-nt;return isNaN(it)&&(it=0,rt=isNaN(rt)?Qe.s:rt),isNaN(at)?(at=0,tt=isNaN(tt)?Qe.h:tt):at>180?at-=360:at<-180&&(at+=360),function(Ne){return d3_hsl_rgb(tt+at*Ne,rt+it*Ne,nt+ot*Ne)+""}}function d3_interpolateLab(Ge,Qe){Ge=Ne.lab(Ge),Qe=Ne.lab(Qe);var tt=Ge.l,rt=Ge.a,nt=Ge.b,at=Qe.l-tt,it=Qe.a-rt,ot=Qe.b-nt;return function(Ne){return d3_lab_rgb(tt+at*Ne,rt+it*Ne,nt+ot*Ne)+""}}function d3_interpolateRound(Ne,Ge){return Ge-=Ne,function(Qe){return Math.round(Ne+Ge*Qe)}}function d3_transform(Ne){var Ge=[Ne.a,Ne.b],Qe=[Ne.c,Ne.d],tt=d3_transformNormalize(Ge),rt=d3_transformDot(Ge,Qe),nt=d3_transformNormalize(d3_transformCombine(Qe,Ge,-rt))||0;Ge[0]*Qe[1]<Qe[0]*Ge[1]&&(Ge[0]*=-1,Ge[1]*=-1,tt*=-1,rt*=-1),this.rotate=(tt?Math.atan2(Ge[1],Ge[0]):Math.atan2(-Qe[0],Qe[1]))*Vn,this.translate=[Ne.e,Ne.f],this.scale=[tt,nt],this.skew=nt?Math.atan2(rt,nt)*Vn:0}function d3_transformDot(Ne,Ge){return Ne[0]*Ge[0]+Ne[1]*Ge[1]}function d3_transformNormalize(Ne){var Ge=Math.sqrt(d3_transformDot(Ne,Ne));return Ge&&(Ne[0]/=Ge,Ne[1]/=Ge),Ge}function d3_transformCombine(Ne,Ge,Qe){return Ne[0]+=Qe*Ge[0],Ne[1]+=Qe*Ge[1],Ne}Ne.ease=function(Ne){var Ge=Ne.indexOf("-"),tt=Ge>=0?Ne.slice(0,Ge):Ne,rt=Ge>=0?Ne.slice(Ge+1):"in";return tt=fc.get(tt)||d3_ease_default,d3_ease_clamp((rt=pc.get(rt)||d3_identity)(tt.apply(null,Qe.call(arguments,1))))},Ne.interpolateHcl=d3_interpolateHcl,Ne.interpolateHsl=d3_interpolateHsl,Ne.interpolateLab=d3_interpolateLab,Ne.interpolateRound=d3_interpolateRound,Ne.transform=function(Ge){var Qe=rt.createElementNS(Ne.ns.prefix.svg,"g");return(Ne.transform=function(Ne){if(null!=Ne){Qe.setAttribute("transform",Ne);var Ge=Qe.transform.baseVal.consolidate()}return new d3_transform(Ge?Ge.matrix:dc)})(Ge)},d3_transform.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var dc={a:1,b:0,c:0,d:1,e:0,f:0};function d3_interpolateTransformPop(Ne){return Ne.length?Ne.pop()+",":""}function d3_interpolateTranslate(Ne,Ge,Qe,tt){if(Ne[0]!==Ge[0]||Ne[1]!==Ge[1]){var rt=Qe.push("translate(",null,",",null,")");tt.push({i:rt-4,x:d3_interpolateNumber(Ne[0],Ge[0])},{i:rt-2,x:d3_interpolateNumber(Ne[1],Ge[1])})}else(Ge[0]||Ge[1])&&Qe.push("translate("+Ge+")")}function d3_interpolateRotate(Ne,Ge,Qe,tt){Ne!==Ge?(Ne-Ge>180?Ge+=360:Ge-Ne>180&&(Ne+=360),tt.push({i:Qe.push(d3_interpolateTransformPop(Qe)+"rotate(",null,")")-2,x:d3_interpolateNumber(Ne,Ge)})):Ge&&Qe.push(d3_interpolateTransformPop(Qe)+"rotate("+Ge+")")}function d3_interpolateSkew(Ne,Ge,Qe,tt){Ne!==Ge?tt.push({i:Qe.push(d3_interpolateTransformPop(Qe)+"skewX(",null,")")-2,x:d3_interpolateNumber(Ne,Ge)}):Ge&&Qe.push(d3_interpolateTransformPop(Qe)+"skewX("+Ge+")")}function d3_interpolateScale(Ne,Ge,Qe,tt){if(Ne[0]!==Ge[0]||Ne[1]!==Ge[1]){var rt=Qe.push(d3_interpolateTransformPop(Qe)+"scale(",null,",",null,")");tt.push({i:rt-4,x:d3_interpolateNumber(Ne[0],Ge[0])},{i:rt-2,x:d3_interpolateNumber(Ne[1],Ge[1])})}else 1===Ge[0]&&1===Ge[1]||Qe.push(d3_interpolateTransformPop(Qe)+"scale("+Ge+")")}function d3_interpolateTransform(Ge,Qe){var tt=[],rt=[];return Ge=Ne.transform(Ge),Qe=Ne.transform(Qe),d3_interpolateTranslate(Ge.translate,Qe.translate,tt,rt),d3_interpolateRotate(Ge.rotate,Qe.rotate,tt,rt),d3_interpolateSkew(Ge.skew,Qe.skew,tt,rt),d3_interpolateScale(Ge.scale,Qe.scale,tt,rt),Ge=Qe=null,function(Ne){for(var Ge,Qe=-1,nt=rt.length;++Qe<nt;)tt[(Ge=rt[Qe]).i]=Ge.x(Ne);return tt.join("")}}function d3_uninterpolateNumber(Ne,Ge){return Ge=(Ge-=Ne=+Ne)||1/Ge,function(Qe){return(Qe-Ne)/Ge}}function d3_uninterpolateClamp(Ne,Ge){return Ge=(Ge-=Ne=+Ne)||1/Ge,function(Qe){return Math.max(0,Math.min(1,(Qe-Ne)/Ge))}}function d3_layout_bundlePath(Ne){for(var Ge=Ne.source,Qe=Ne.target,tt=d3_layout_bundleLeastCommonAncestor(Ge,Qe),rt=[Ge];Ge!==tt;)Ge=Ge.parent,rt.push(Ge);for(var nt=rt.length;Qe!==tt;)rt.splice(nt,0,Qe),Qe=Qe.parent;return rt}function d3_layout_bundleAncestors(Ne){for(var Ge=[],Qe=Ne.parent;null!=Qe;)Ge.push(Ne),Ne=Qe,Qe=Qe.parent;return Ge.push(Ne),Ge}function d3_layout_bundleLeastCommonAncestor(Ne,Ge){if(Ne===Ge)return Ne;for(var Qe=d3_layout_bundleAncestors(Ne),tt=d3_layout_bundleAncestors(Ge),rt=Qe.pop(),nt=tt.pop(),at=null;rt===nt;)at=rt,rt=Qe.pop(),nt=tt.pop();return at}function d3_layout_forceDragstart(Ne){Ne.fixed|=2}function d3_layout_forceDragend(Ne){Ne.fixed&=-7}function d3_layout_forceMouseover(Ne){Ne.fixed|=4,Ne.px=Ne.x,Ne.py=Ne.y}function d3_layout_forceMouseout(Ne){Ne.fixed&=-5}function d3_layout_forceAccumulate(Ne,Ge,Qe){var tt=0,rt=0;if(Ne.charge=0,!Ne.leaf)for(var nt,at=Ne.nodes,it=at.length,ot=-1;++ot<it;)null!=(nt=at[ot])&&(d3_layout_forceAccumulate(nt,Ge,Qe),Ne.charge+=nt.charge,tt+=nt.charge*nt.cx,rt+=nt.charge*nt.cy);if(Ne.point){Ne.leaf||(Ne.point.x+=Math.random()-.5,Ne.point.y+=Math.random()-.5);var dt=Ge*Qe[Ne.point.index];Ne.charge+=Ne.pointCharge=dt,tt+=dt*Ne.point.x,rt+=dt*Ne.point.y}Ne.cx=tt/Ne.charge,Ne.cy=rt/Ne.charge}Ne.interpolateTransform=d3_interpolateTransform,Ne.layout={},Ne.layout.bundle=function(){return function(Ne){for(var Ge=[],Qe=-1,tt=Ne.length;++Qe<tt;)Ge.push(d3_layout_bundlePath(Ne[Qe]));return Ge}},Ne.layout.chord=function(){var Ge,Qe,tt,rt,nt,at,it,ot={},dt=0;function relayout(){var ot,ht,Dt,Ot,Rt,Zt={},er=[],dr=Ne.range(rt),mr=[];for(Ge=[],Qe=[],ot=0,Ot=-1;++Ot<rt;){for(ht=0,Rt=-1;++Rt<rt;)ht+=tt[Ot][Rt];er.push(ht),mr.push(Ne.range(rt)),ot+=ht}for(nt&&dr.sort((function(Ne,Ge){return nt(er[Ne],er[Ge])})),at&&mr.forEach((function(Ne,Ge){Ne.sort((function(Ne,Qe){return at(tt[Ge][Ne],tt[Ge][Qe])}))})),ot=(Dn-dt*rt)/ot,ht=0,Ot=-1;++Ot<rt;){for(Dt=ht,Rt=-1;++Rt<rt;){var xr=dr[Ot],br=mr[xr][Rt],Ar=tt[xr][br],en=ht,mn=ht+=Ar*ot;Zt[xr+"-"+br]={index:xr,subindex:br,startAngle:en,endAngle:mn,value:Ar}}Qe[xr]={index:xr,startAngle:Dt,endAngle:ht,value:er[xr]},ht+=dt}for(Ot=-1;++Ot<rt;)for(Rt=Ot-1;++Rt<rt;){var xn=Zt[Ot+"-"+Rt],kn=Zt[Rt+"-"+Ot];(xn.value||kn.value)&&Ge.push(xn.value<kn.value?{source:kn,target:xn}:{source:xn,target:kn})}it&&resort()}function resort(){Ge.sort((function(Ne,Ge){return it((Ne.source.value+Ne.target.value)/2,(Ge.source.value+Ge.target.value)/2)}))}return ot.matrix=function(Ne){return arguments.length?(rt=(tt=Ne)&&tt.length,Ge=Qe=null,ot):tt},ot.padding=function(Ne){return arguments.length?(dt=Ne,Ge=Qe=null,ot):dt},ot.sortGroups=function(Ne){return arguments.length?(nt=Ne,Ge=Qe=null,ot):nt},ot.sortSubgroups=function(Ne){return arguments.length?(at=Ne,Ge=null,ot):at},ot.sortChords=function(Ne){return arguments.length?(it=Ne,Ge&&resort(),ot):it},ot.chords=function(){return Ge||relayout(),Ge},ot.groups=function(){return Qe||relayout(),Qe},ot},Ne.layout.force=function(){var Ge,Qe,tt,rt,nt,at,it={},ot=Ne.dispatch("start","tick","end"),dt=[1,1],ht=.9,Dt=hc,Ot=gc,Rt=-30,Zt=mc,er=.1,dr=.64,mr=[],xr=[];function repulse(Ne){return function(Ge,Qe,tt,rt){if(Ge.point!==Ne){var nt=Ge.cx-Ne.x,at=Ge.cy-Ne.y,it=rt-Qe,ot=nt*nt+at*at;if(it*it/dr<ot){if(ot<Zt){var dt=Ge.charge/ot;Ne.px-=nt*dt,Ne.py-=at*dt}return!0}Ge.point&&ot&&ot<Zt&&(dt=Ge.pointCharge/ot,Ne.px-=nt*dt,Ne.py-=at*dt)}return!Ge.charge}}function dragmove(Ge){Ge.px=Ne.event.x,Ge.py=Ne.event.y,it.resume()}return it.tick=function(){if((tt*=.99)<.005)return Ge=null,ot.end({type:"end",alpha:tt=0}),!0;var Qe,it,Dt,Ot,Zt,dr,br,Ar,en,mn=mr.length,xn=xr.length;for(it=0;it<xn;++it)Ot=(Dt=xr[it]).source,(dr=(Ar=(Zt=Dt.target).x-Ot.x)*Ar+(en=Zt.y-Ot.y)*en)&&(Ar*=dr=tt*nt[it]*((dr=Math.sqrt(dr))-rt[it])/dr,en*=dr,Zt.x-=Ar*(br=Ot.weight+Zt.weight?Ot.weight/(Ot.weight+Zt.weight):.5),Zt.y-=en*br,Ot.x+=Ar*(br=1-br),Ot.y+=en*br);if((br=tt*er)&&(Ar=dt[0]/2,en=dt[1]/2,it=-1,br))for(;++it<mn;)(Dt=mr[it]).x+=(Ar-Dt.x)*br,Dt.y+=(en-Dt.y)*br;if(Rt)for(d3_layout_forceAccumulate(Qe=Ne.geom.quadtree(mr),tt,at),it=-1;++it<mn;)(Dt=mr[it]).fixed||Qe.visit(repulse(Dt));for(it=-1;++it<mn;)(Dt=mr[it]).fixed?(Dt.x=Dt.px,Dt.y=Dt.py):(Dt.x-=(Dt.px-(Dt.px=Dt.x))*ht,Dt.y-=(Dt.py-(Dt.py=Dt.y))*ht);ot.tick({type:"tick",alpha:tt})},it.nodes=function(Ne){return arguments.length?(mr=Ne,it):mr},it.links=function(Ne){return arguments.length?(xr=Ne,it):xr},it.size=function(Ne){return arguments.length?(dt=Ne,it):dt},it.linkDistance=function(Ne){return arguments.length?(Dt="function"==typeof Ne?Ne:+Ne,it):Dt},it.distance=it.linkDistance,it.linkStrength=function(Ne){return arguments.length?(Ot="function"==typeof Ne?Ne:+Ne,it):Ot},it.friction=function(Ne){return arguments.length?(ht=+Ne,it):ht},it.charge=function(Ne){return arguments.length?(Rt="function"==typeof Ne?Ne:+Ne,it):Rt},it.chargeDistance=function(Ne){return arguments.length?(Zt=Ne*Ne,it):Math.sqrt(Zt)},it.gravity=function(Ne){return arguments.length?(er=+Ne,it):er},it.theta=function(Ne){return arguments.length?(dr=Ne*Ne,it):Math.sqrt(dr)},it.alpha=function(Ne){return arguments.length?(Ne=+Ne,tt?Ne>0?tt=Ne:(Ge.c=null,Ge.t=NaN,Ge=null,ot.end({type:"end",alpha:tt=0})):Ne>0&&(ot.start({type:"start",alpha:tt=Ne}),Ge=d3_timer(it.tick)),it):tt},it.start=function(){var Ne,Ge,Qe,tt=mr.length,ot=xr.length,ht=dt[0],Zt=dt[1];for(Ne=0;Ne<tt;++Ne)(Qe=mr[Ne]).index=Ne,Qe.weight=0;for(Ne=0;Ne<ot;++Ne)"number"==typeof(Qe=xr[Ne]).source&&(Qe.source=mr[Qe.source]),"number"==typeof Qe.target&&(Qe.target=mr[Qe.target]),++Qe.source.weight,++Qe.target.weight;for(Ne=0;Ne<tt;++Ne)Qe=mr[Ne],isNaN(Qe.x)&&(Qe.x=position("x",ht)),isNaN(Qe.y)&&(Qe.y=position("y",Zt)),isNaN(Qe.px)&&(Qe.px=Qe.x),isNaN(Qe.py)&&(Qe.py=Qe.y);if(rt=[],"function"==typeof Dt)for(Ne=0;Ne<ot;++Ne)rt[Ne]=+Dt.call(this,xr[Ne],Ne);else for(Ne=0;Ne<ot;++Ne)rt[Ne]=Dt;if(nt=[],"function"==typeof Ot)for(Ne=0;Ne<ot;++Ne)nt[Ne]=+Ot.call(this,xr[Ne],Ne);else for(Ne=0;Ne<ot;++Ne)nt[Ne]=Ot;if(at=[],"function"==typeof Rt)for(Ne=0;Ne<tt;++Ne)at[Ne]=+Rt.call(this,mr[Ne],Ne);else for(Ne=0;Ne<tt;++Ne)at[Ne]=Rt;function position(Qe,rt){if(!Ge){for(Ge=new Array(tt),dt=0;dt<tt;++dt)Ge[dt]=[];for(dt=0;dt<ot;++dt){var nt=xr[dt];Ge[nt.source.index].push(nt.target),Ge[nt.target.index].push(nt.source)}}for(var at,it=Ge[Ne],dt=-1,ht=it.length;++dt<ht;)if(!isNaN(at=it[dt][Qe]))return at;return Math.random()*rt}return it.resume()},it.resume=function(){return it.alpha(.1)},it.stop=function(){return it.alpha(0)},it.drag=function(){if(Qe||(Qe=Ne.behavior.drag().origin(d3_identity).on("dragstart.force",d3_layout_forceDragstart).on("drag.force",dragmove).on("dragend.force",d3_layout_forceDragend)),!arguments.length)return Qe;this.on("mouseover.force",d3_layout_forceMouseover).on("mouseout.force",d3_layout_forceMouseout).call(Qe)},Ne.rebind(it,ot,"on")};var hc=20,gc=1,mc=1/0;function d3_layout_hierarchyRebind(Ge,Qe){return Ne.rebind(Ge,Qe,"sort","children","value"),Ge.nodes=Ge,Ge.links=d3_layout_hierarchyLinks,Ge}function d3_layout_hierarchyVisitBefore(Ne,Ge){for(var Qe=[Ne];null!=(Ne=Qe.pop());)if(Ge(Ne),(rt=Ne.children)&&(tt=rt.length))for(var tt,rt;--tt>=0;)Qe.push(rt[tt])}function d3_layout_hierarchyVisitAfter(Ne,Ge){for(var Qe=[Ne],tt=[];null!=(Ne=Qe.pop());)if(tt.push(Ne),(nt=Ne.children)&&(rt=nt.length))for(var rt,nt,at=-1;++at<rt;)Qe.push(nt[at]);for(;null!=(Ne=tt.pop());)Ge(Ne)}function d3_layout_hierarchyChildren(Ne){return Ne.children}function d3_layout_hierarchyValue(Ne){return Ne.value}function d3_layout_hierarchySort(Ne,Ge){return Ge.value-Ne.value}function d3_layout_hierarchyLinks(Ge){return Ne.merge(Ge.map((function(Ne){return(Ne.children||[]).map((function(Ge){return{source:Ne,target:Ge}}))})))}Ne.layout.hierarchy=function(){var Ne=d3_layout_hierarchySort,Ge=d3_layout_hierarchyChildren,Qe=d3_layout_hierarchyValue;function hierarchy(tt){var rt,nt=[tt],at=[];for(tt.depth=0;null!=(rt=nt.pop());)if(at.push(rt),(ot=Ge.call(hierarchy,rt,rt.depth))&&(it=ot.length)){for(var it,ot,dt;--it>=0;)nt.push(dt=ot[it]),dt.parent=rt,dt.depth=rt.depth+1;Qe&&(rt.value=0),rt.children=ot}else Qe&&(rt.value=+Qe.call(hierarchy,rt,rt.depth)||0),delete rt.children;return d3_layout_hierarchyVisitAfter(tt,(function(Ge){var tt,rt;Ne&&(tt=Ge.children)&&tt.sort(Ne),Qe&&(rt=Ge.parent)&&(rt.value+=Ge.value)})),at}return hierarchy.sort=function(Ge){return arguments.length?(Ne=Ge,hierarchy):Ne},hierarchy.children=function(Ne){return arguments.length?(Ge=Ne,hierarchy):Ge},hierarchy.value=function(Ne){return arguments.length?(Qe=Ne,hierarchy):Qe},hierarchy.revalue=function(Ne){return Qe&&(d3_layout_hierarchyVisitBefore(Ne,(function(Ne){Ne.children&&(Ne.value=0)})),d3_layout_hierarchyVisitAfter(Ne,(function(Ne){var Ge;Ne.children||(Ne.value=+Qe.call(hierarchy,Ne,Ne.depth)||0),(Ge=Ne.parent)&&(Ge.value+=Ne.value)}))),Ne},hierarchy},Ne.layout.partition=function(){var Ge=Ne.layout.hierarchy(),Qe=[1,1];function position(Ne,Ge,Qe,tt){var rt=Ne.children;if(Ne.x=Ge,Ne.y=Ne.depth*tt,Ne.dx=Qe,Ne.dy=tt,rt&&(nt=rt.length)){var nt,at,it,ot=-1;for(Qe=Ne.value?Qe/Ne.value:0;++ot<nt;)position(at=rt[ot],Ge,it=at.value*Qe,tt),Ge+=it}}function depth(Ne){var Ge=Ne.children,Qe=0;if(Ge&&(tt=Ge.length))for(var tt,rt=-1;++rt<tt;)Qe=Math.max(Qe,depth(Ge[rt]));return 1+Qe}function partition(Ne,tt){var rt=Ge.call(this,Ne,tt);return position(rt[0],0,Qe[0],Qe[1]/depth(rt[0])),rt}return partition.size=function(Ne){return arguments.length?(Qe=Ne,partition):Qe},d3_layout_hierarchyRebind(partition,Ge)},Ne.layout.pie=function(){var Ge=Number,Qe=vc,tt=0,rt=Dn,nt=0;function pie(at){var it,ot=at.length,dt=at.map((function(Ne,Qe){return+Ge.call(pie,Ne,Qe)})),ht=+("function"==typeof tt?tt.apply(this,arguments):tt),Dt=("function"==typeof rt?rt.apply(this,arguments):rt)-ht,Ot=Math.min(Math.abs(Dt)/ot,+("function"==typeof nt?nt.apply(this,arguments):nt)),Rt=Ot*(Dt<0?-1:1),Zt=Ne.sum(dt),er=Zt?(Dt-ot*Rt)/Zt:0,dr=Ne.range(ot),mr=[];return null!=Qe&&dr.sort(Qe===vc?function(Ne,Ge){return dt[Ge]-dt[Ne]}:function(Ne,Ge){return Qe(at[Ne],at[Ge])}),dr.forEach((function(Ne){mr[Ne]={data:at[Ne],value:it=dt[Ne],startAngle:ht,endAngle:ht+=it*er+Rt,padAngle:Ot}})),mr}return pie.value=function(Ne){return arguments.length?(Ge=Ne,pie):Ge},pie.sort=function(Ne){return arguments.length?(Qe=Ne,pie):Qe},pie.startAngle=function(Ne){return arguments.length?(tt=Ne,pie):tt},pie.endAngle=function(Ne){return arguments.length?(rt=Ne,pie):rt},pie.padAngle=function(Ne){return arguments.length?(nt=Ne,pie):nt},pie};var vc={};function d3_layout_stackX(Ne){return Ne.x}function d3_layout_stackY(Ne){return Ne.y}function d3_layout_stackOut(Ne,Ge,Qe){Ne.y0=Ge,Ne.y=Qe}Ne.layout.stack=function(){var Ge=d3_identity,Qe=d3_layout_stackOrderDefault,tt=d3_layout_stackOffsetZero,rt=d3_layout_stackOut,nt=d3_layout_stackX,at=d3_layout_stackY;function stack(it,ot){if(!(Ot=it.length))return it;var dt=it.map((function(Ne,Qe){return Ge.call(stack,Ne,Qe)})),ht=dt.map((function(Ne){return Ne.map((function(Ne,Ge){return[nt.call(stack,Ne,Ge),at.call(stack,Ne,Ge)]}))})),Dt=Qe.call(stack,ht,ot);dt=Ne.permute(dt,Dt),ht=Ne.permute(ht,Dt);var Ot,Rt,Zt,er,dr=tt.call(stack,ht,ot),mr=dt[0].length;for(Zt=0;Zt<mr;++Zt)for(rt.call(stack,dt[0][Zt],er=dr[Zt],ht[0][Zt][1]),Rt=1;Rt<Ot;++Rt)rt.call(stack,dt[Rt][Zt],er+=ht[Rt-1][Zt][1],ht[Rt][Zt][1]);return it}return stack.values=function(Ne){return arguments.length?(Ge=Ne,stack):Ge},stack.order=function(Ne){return arguments.length?(Qe="function"==typeof Ne?Ne:yc.get(Ne)||d3_layout_stackOrderDefault,stack):Qe},stack.offset=function(Ne){return arguments.length?(tt="function"==typeof Ne?Ne:xc.get(Ne)||d3_layout_stackOffsetZero,stack):tt},stack.x=function(Ne){return arguments.length?(nt=Ne,stack):nt},stack.y=function(Ne){return arguments.length?(at=Ne,stack):at},stack.out=function(Ne){return arguments.length?(rt=Ne,stack):rt},stack};var yc=Ne.map({"inside-out":function(Ge){var Qe,tt,rt=Ge.length,nt=Ge.map(d3_layout_stackMaxIndex),at=Ge.map(d3_layout_stackReduceSum),it=Ne.range(rt).sort((function(Ne,Ge){return nt[Ne]-nt[Ge]})),ot=0,dt=0,ht=[],Dt=[];for(Qe=0;Qe<rt;++Qe)tt=it[Qe],ot<dt?(ot+=at[tt],ht.push(tt)):(dt+=at[tt],Dt.push(tt));return Dt.reverse().concat(ht)},reverse:function(Ge){return Ne.range(Ge.length).reverse()},default:d3_layout_stackOrderDefault}),xc=Ne.map({silhouette:function(Ne){var Ge,Qe,tt,rt=Ne.length,nt=Ne[0].length,at=[],it=0,ot=[];for(Qe=0;Qe<nt;++Qe){for(Ge=0,tt=0;Ge<rt;Ge++)tt+=Ne[Ge][Qe][1];tt>it&&(it=tt),at.push(tt)}for(Qe=0;Qe<nt;++Qe)ot[Qe]=(it-at[Qe])/2;return ot},wiggle:function(Ne){var Ge,Qe,tt,rt,nt,at,it,ot,dt,ht=Ne.length,Dt=Ne[0],Ot=Dt.length,Rt=[];for(Rt[0]=ot=dt=0,Qe=1;Qe<Ot;++Qe){for(Ge=0,rt=0;Ge<ht;++Ge)rt+=Ne[Ge][Qe][1];for(Ge=0,nt=0,it=Dt[Qe][0]-Dt[Qe-1][0];Ge<ht;++Ge){for(tt=0,at=(Ne[Ge][Qe][1]-Ne[Ge][Qe-1][1])/(2*it);tt<Ge;++tt)at+=(Ne[tt][Qe][1]-Ne[tt][Qe-1][1])/it;nt+=at*Ne[Ge][Qe][1]}Rt[Qe]=ot-=rt?nt/rt*it:0,ot<dt&&(dt=ot)}for(Qe=0;Qe<Ot;++Qe)Rt[Qe]-=dt;return Rt},expand:function(Ne){var Ge,Qe,tt,rt=Ne.length,nt=Ne[0].length,at=1/rt,it=[];for(Qe=0;Qe<nt;++Qe){for(Ge=0,tt=0;Ge<rt;Ge++)tt+=Ne[Ge][Qe][1];if(tt)for(Ge=0;Ge<rt;Ge++)Ne[Ge][Qe][1]/=tt;else for(Ge=0;Ge<rt;Ge++)Ne[Ge][Qe][1]=at}for(Qe=0;Qe<nt;++Qe)it[Qe]=0;return it},zero:d3_layout_stackOffsetZero});function d3_layout_stackOrderDefault(Ge){return Ne.range(Ge.length)}function d3_layout_stackOffsetZero(Ne){for(var Ge=-1,Qe=Ne[0].length,tt=[];++Ge<Qe;)tt[Ge]=0;return tt}function d3_layout_stackMaxIndex(Ne){for(var Ge,Qe=1,tt=0,rt=Ne[0][1],nt=Ne.length;Qe<nt;++Qe)(Ge=Ne[Qe][1])>rt&&(tt=Qe,rt=Ge);return tt}function d3_layout_stackReduceSum(Ne){return Ne.reduce(d3_layout_stackSum,0)}function d3_layout_stackSum(Ne,Ge){return Ne+Ge[1]}function d3_layout_histogramBinSturges(Ne,Ge){return d3_layout_histogramBinFixed(Ne,Math.ceil(Math.log(Ge.length)/Math.LN2+1))}function d3_layout_histogramBinFixed(Ne,Ge){for(var Qe=-1,tt=+Ne[0],rt=(Ne[1]-tt)/Ge,nt=[];++Qe<=Ge;)nt[Qe]=rt*Qe+tt;return nt}function d3_layout_histogramRange(Ge){return[Ne.min(Ge),Ne.max(Ge)]}function d3_layout_packSort(Ne,Ge){return Ne.value-Ge.value}function d3_layout_packInsert(Ne,Ge){var Qe=Ne._pack_next;Ne._pack_next=Ge,Ge._pack_prev=Ne,Ge._pack_next=Qe,Qe._pack_prev=Ge}function d3_layout_packSplice(Ne,Ge){Ne._pack_next=Ge,Ge._pack_prev=Ne}function d3_layout_packIntersects(Ne,Ge){var Qe=Ge.x-Ne.x,tt=Ge.y-Ne.y,rt=Ne.r+Ge.r;return.999*rt*rt>Qe*Qe+tt*tt}function d3_layout_packSiblings(Ne){if((Ge=Ne.children)&&(ot=Ge.length)){var Ge,Qe,tt,rt,nt,at,it,ot,dt=1/0,ht=-1/0,Dt=1/0,Ot=-1/0;if(Ge.forEach(d3_layout_packLink),(Qe=Ge[0]).x=-Qe.r,Qe.y=0,bound(Qe),ot>1&&((tt=Ge[1]).x=tt.r,tt.y=0,bound(tt),ot>2))for(d3_layout_packPlace(Qe,tt,rt=Ge[2]),bound(rt),d3_layout_packInsert(Qe,rt),Qe._pack_prev=rt,d3_layout_packInsert(rt,tt),tt=Qe._pack_next,nt=3;nt<ot;nt++){d3_layout_packPlace(Qe,tt,rt=Ge[nt]);var Rt=0,Zt=1,er=1;for(at=tt._pack_next;at!==tt;at=at._pack_next,Zt++)if(d3_layout_packIntersects(at,rt)){Rt=1;break}if(1==Rt)for(it=Qe._pack_prev;it!==at._pack_prev&&!d3_layout_packIntersects(it,rt);it=it._pack_prev,er++);Rt?(Zt<er||Zt==er&&tt.r<Qe.r?d3_layout_packSplice(Qe,tt=at):d3_layout_packSplice(Qe=it,tt),nt--):(d3_layout_packInsert(Qe,rt),tt=rt,bound(rt))}var dr=(dt+ht)/2,mr=(Dt+Ot)/2,xr=0;for(nt=0;nt<ot;nt++)(rt=Ge[nt]).x-=dr,rt.y-=mr,xr=Math.max(xr,rt.r+Math.sqrt(rt.x*rt.x+rt.y*rt.y));Ne.r=xr,Ge.forEach(d3_layout_packUnlink)}function bound(Ne){dt=Math.min(Ne.x-Ne.r,dt),ht=Math.max(Ne.x+Ne.r,ht),Dt=Math.min(Ne.y-Ne.r,Dt),Ot=Math.max(Ne.y+Ne.r,Ot)}}function d3_layout_packLink(Ne){Ne._pack_next=Ne._pack_prev=Ne}function d3_layout_packUnlink(Ne){delete Ne._pack_next,delete Ne._pack_prev}function d3_layout_packTransform(Ne,Ge,Qe,tt){var rt=Ne.children;if(Ne.x=Ge+=tt*Ne.x,Ne.y=Qe+=tt*Ne.y,Ne.r*=tt,rt)for(var nt=-1,at=rt.length;++nt<at;)d3_layout_packTransform(rt[nt],Ge,Qe,tt)}function d3_layout_packPlace(Ne,Ge,Qe){var tt=Ne.r+Qe.r,rt=Ge.x-Ne.x,nt=Ge.y-Ne.y;if(tt&&(rt||nt)){var at=Ge.r+Qe.r,it=rt*rt+nt*nt,ot=.5+((tt*=tt)-(at*=at))/(2*it),dt=Math.sqrt(Math.max(0,2*at*(tt+it)-(tt-=it)*tt-at*at))/(2*it);Qe.x=Ne.x+ot*rt+dt*nt,Qe.y=Ne.y+ot*nt-dt*rt}else Qe.x=Ne.x+tt,Qe.y=Ne.y}function d3_layout_treeSeparation(Ne,Ge){return Ne.parent==Ge.parent?1:2}function d3_layout_treeLeft(Ne){var Ge=Ne.children;return Ge.length?Ge[0]:Ne.t}function d3_layout_treeRight(Ne){var Ge,Qe=Ne.children;return(Ge=Qe.length)?Qe[Ge-1]:Ne.t}function d3_layout_treeMove(Ne,Ge,Qe){var tt=Qe/(Ge.i-Ne.i);Ge.c-=tt,Ge.s+=Qe,Ne.c+=tt,Ge.z+=Qe,Ge.m+=Qe}function d3_layout_treeShift(Ne){for(var Ge,Qe=0,tt=0,rt=Ne.children,nt=rt.length;--nt>=0;)(Ge=rt[nt]).z+=Qe,Ge.m+=Qe,Qe+=Ge.s+(tt+=Ge.c)}function d3_layout_treeAncestor(Ne,Ge,Qe){return Ne.a.parent===Ge.parent?Ne.a:Qe}function d3_layout_clusterY(Ge){return 1+Ne.max(Ge,(function(Ne){return Ne.y}))}function d3_layout_clusterX(Ne){return Ne.reduce((function(Ne,Ge){return Ne+Ge.x}),0)/Ne.length}function d3_layout_clusterLeft(Ne){var Ge=Ne.children;return Ge&&Ge.length?d3_layout_clusterLeft(Ge[0]):Ne}function d3_layout_clusterRight(Ne){var Ge,Qe=Ne.children;return Qe&&(Ge=Qe.length)?d3_layout_clusterRight(Qe[Ge-1]):Ne}function d3_layout_treemapPadNull(Ne){return{x:Ne.x,y:Ne.y,dx:Ne.dx,dy:Ne.dy}}function d3_layout_treemapPad(Ne,Ge){var Qe=Ne.x+Ge[3],tt=Ne.y+Ge[0],rt=Ne.dx-Ge[1]-Ge[3],nt=Ne.dy-Ge[0]-Ge[2];return rt<0&&(Qe+=rt/2,rt=0),nt<0&&(tt+=nt/2,nt=0),{x:Qe,y:tt,dx:rt,dy:nt}}function d3_scaleExtent(Ne){var Ge=Ne[0],Qe=Ne[Ne.length-1];return Ge<Qe?[Ge,Qe]:[Qe,Ge]}function d3_scaleRange(Ne){return Ne.rangeExtent?Ne.rangeExtent():d3_scaleExtent(Ne.range())}function d3_scale_bilinear(Ne,Ge,Qe,tt){var rt=Qe(Ne[0],Ne[1]),nt=tt(Ge[0],Ge[1]);return function(Ne){return nt(rt(Ne))}}function d3_scale_nice(Ne,Ge){var Qe,tt=0,rt=Ne.length-1,nt=Ne[tt],at=Ne[rt];return at<nt&&(Qe=tt,tt=rt,rt=Qe,Qe=nt,nt=at,at=Qe),Ne[tt]=Ge.floor(nt),Ne[rt]=Ge.ceil(at),Ne}function d3_scale_niceStep(Ne){return Ne?{floor:function(Ge){return Math.floor(Ge/Ne)*Ne},ceil:function(Ge){return Math.ceil(Ge/Ne)*Ne}}:bc}Ne.layout.histogram=function(){var Ge=!0,Qe=Number,tt=d3_layout_histogramRange,rt=d3_layout_histogramBinSturges;function histogram(nt,at){for(var it,ot,dt=[],ht=nt.map(Qe,this),Dt=tt.call(this,ht,at),Ot=rt.call(this,Dt,ht,at),Rt=(at=-1,ht.length),Zt=Ot.length-1,er=Ge?1:1/Rt;++at<Zt;)(it=dt[at]=[]).dx=Ot[at+1]-(it.x=Ot[at]),it.y=0;if(Zt>0)for(at=-1;++at<Rt;)(ot=ht[at])>=Dt[0]&&ot<=Dt[1]&&((it=dt[Ne.bisect(Ot,ot,1,Zt)-1]).y+=er,it.push(nt[at]));return dt}return histogram.value=function(Ne){return arguments.length?(Qe=Ne,histogram):Qe},histogram.range=function(Ne){return arguments.length?(tt=d3_functor(Ne),histogram):tt},histogram.bins=function(Ne){return arguments.length?(rt="number"==typeof Ne?function(Ge){return d3_layout_histogramBinFixed(Ge,Ne)}:d3_functor(Ne),histogram):rt},histogram.frequency=function(Ne){return arguments.length?(Ge=!!Ne,histogram):Ge},histogram},Ne.layout.pack=function(){var Ge,Qe=Ne.layout.hierarchy().sort(d3_layout_packSort),tt=0,rt=[1,1];function pack(Ne,nt){var at=Qe.call(this,Ne,nt),it=at[0],ot=rt[0],dt=rt[1],ht=null==Ge?Math.sqrt:"function"==typeof Ge?Ge:function(){return Ge};if(it.x=it.y=0,d3_layout_hierarchyVisitAfter(it,(function(Ne){Ne.r=+ht(Ne.value)})),d3_layout_hierarchyVisitAfter(it,d3_layout_packSiblings),tt){var Dt=tt*(Ge?1:Math.max(2*it.r/ot,2*it.r/dt))/2;d3_layout_hierarchyVisitAfter(it,(function(Ne){Ne.r+=Dt})),d3_layout_hierarchyVisitAfter(it,d3_layout_packSiblings),d3_layout_hierarchyVisitAfter(it,(function(Ne){Ne.r-=Dt}))}return d3_layout_packTransform(it,ot/2,dt/2,Ge?1:1/Math.max(2*it.r/ot,2*it.r/dt)),at}return pack.size=function(Ne){return arguments.length?(rt=Ne,pack):rt},pack.radius=function(Ne){return arguments.length?(Ge=null==Ne||"function"==typeof Ne?Ne:+Ne,pack):Ge},pack.padding=function(Ne){return arguments.length?(tt=+Ne,pack):tt},d3_layout_hierarchyRebind(pack,Qe)},Ne.layout.tree=function(){var Ge=Ne.layout.hierarchy().sort(null).value(null),Qe=d3_layout_treeSeparation,tt=[1,1],rt=null;function tree(Ne,nt){var at=Ge.call(this,Ne,nt),it=at[0],ot=wrapTree(it);if(d3_layout_hierarchyVisitAfter(ot,firstWalk),ot.parent.m=-ot.z,d3_layout_hierarchyVisitBefore(ot,secondWalk),rt)d3_layout_hierarchyVisitBefore(it,sizeNode);else{var dt=it,ht=it,Dt=it;d3_layout_hierarchyVisitBefore(it,(function(Ne){Ne.x<dt.x&&(dt=Ne),Ne.x>ht.x&&(ht=Ne),Ne.depth>Dt.depth&&(Dt=Ne)}));var Ot=Qe(dt,ht)/2-dt.x,Rt=tt[0]/(ht.x+Qe(ht,dt)/2+Ot),Zt=tt[1]/(Dt.depth||1);d3_layout_hierarchyVisitBefore(it,(function(Ne){Ne.x=(Ne.x+Ot)*Rt,Ne.y=Ne.depth*Zt}))}return at}function wrapTree(Ne){for(var Ge,Qe={A:null,children:[Ne]},tt=[Qe];null!=(Ge=tt.pop());)for(var rt,nt=Ge.children,at=0,it=nt.length;at<it;++at)tt.push((nt[at]=rt={_:nt[at],parent:Ge,children:(rt=nt[at].children)&&rt.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:at}).a=rt);return Qe.children[0]}function firstWalk(Ne){var Ge=Ne.children,tt=Ne.parent.children,rt=Ne.i?tt[Ne.i-1]:null;if(Ge.length){d3_layout_treeShift(Ne);var nt=(Ge[0].z+Ge[Ge.length-1].z)/2;rt?(Ne.z=rt.z+Qe(Ne._,rt._),Ne.m=Ne.z-nt):Ne.z=nt}else rt&&(Ne.z=rt.z+Qe(Ne._,rt._));Ne.parent.A=apportion(Ne,rt,Ne.parent.A||tt[0])}function secondWalk(Ne){Ne._.x=Ne.z+Ne.parent.m,Ne.m+=Ne.parent.m}function apportion(Ne,Ge,tt){if(Ge){for(var rt,nt=Ne,at=Ne,it=Ge,ot=nt.parent.children[0],dt=nt.m,ht=at.m,Dt=it.m,Ot=ot.m;it=d3_layout_treeRight(it),nt=d3_layout_treeLeft(nt),it&&nt;)ot=d3_layout_treeLeft(ot),(at=d3_layout_treeRight(at)).a=Ne,(rt=it.z+Dt-nt.z-dt+Qe(it._,nt._))>0&&(d3_layout_treeMove(d3_layout_treeAncestor(it,Ne,tt),Ne,rt),dt+=rt,ht+=rt),Dt+=it.m,dt+=nt.m,Ot+=ot.m,ht+=at.m;it&&!d3_layout_treeRight(at)&&(at.t=it,at.m+=Dt-ht),nt&&!d3_layout_treeLeft(ot)&&(ot.t=nt,ot.m+=dt-Ot,tt=Ne)}return tt}function sizeNode(Ne){Ne.x*=tt[0],Ne.y=Ne.depth*tt[1]}return tree.separation=function(Ne){return arguments.length?(Qe=Ne,tree):Qe},tree.size=function(Ne){return arguments.length?(rt=null==(tt=Ne)?sizeNode:null,tree):rt?null:tt},tree.nodeSize=function(Ne){return arguments.length?(rt=null==(tt=Ne)?null:sizeNode,tree):rt?tt:null},d3_layout_hierarchyRebind(tree,Ge)},Ne.layout.cluster=function(){var Ge=Ne.layout.hierarchy().sort(null).value(null),Qe=d3_layout_treeSeparation,tt=[1,1],rt=!1;function cluster(Ne,nt){var at,it=Ge.call(this,Ne,nt),ot=it[0],dt=0;d3_layout_hierarchyVisitAfter(ot,(function(Ne){var Ge=Ne.children;Ge&&Ge.length?(Ne.x=d3_layout_clusterX(Ge),Ne.y=d3_layout_clusterY(Ge)):(Ne.x=at?dt+=Qe(Ne,at):0,Ne.y=0,at=Ne)}));var ht=d3_layout_clusterLeft(ot),Dt=d3_layout_clusterRight(ot),Ot=ht.x-Qe(ht,Dt)/2,Rt=Dt.x+Qe(Dt,ht)/2;return d3_layout_hierarchyVisitAfter(ot,rt?function(Ne){Ne.x=(Ne.x-ot.x)*tt[0],Ne.y=(ot.y-Ne.y)*tt[1]}:function(Ne){Ne.x=(Ne.x-Ot)/(Rt-Ot)*tt[0],Ne.y=(1-(ot.y?Ne.y/ot.y:1))*tt[1]}),it}return cluster.separation=function(Ne){return arguments.length?(Qe=Ne,cluster):Qe},cluster.size=function(Ne){return arguments.length?(rt=null==(tt=Ne),cluster):rt?null:tt},cluster.nodeSize=function(Ne){return arguments.length?(rt=null!=(tt=Ne),cluster):rt?tt:null},d3_layout_hierarchyRebind(cluster,Ge)},Ne.layout.treemap=function(){var Ge,Qe=Ne.layout.hierarchy(),tt=Math.round,rt=[1,1],nt=null,at=d3_layout_treemapPadNull,it=!1,ot="squarify",dt=.5*(1+Math.sqrt(5));function scale(Ne,Ge){for(var Qe,tt,rt=-1,nt=Ne.length;++rt<nt;)tt=(Qe=Ne[rt]).value*(Ge<0?0:Ge),Qe.area=isNaN(tt)||tt<=0?0:tt}function squarify(Ne){var Ge=Ne.children;if(Ge&&Ge.length){var Qe,tt,rt,nt=at(Ne),it=[],dt=Ge.slice(),ht=1/0,Dt="slice"===ot?nt.dx:"dice"===ot?nt.dy:"slice-dice"===ot?1&Ne.depth?nt.dy:nt.dx:Math.min(nt.dx,nt.dy);for(scale(dt,nt.dx*nt.dy/Ne.value),it.area=0;(rt=dt.length)>0;)it.push(Qe=dt[rt-1]),it.area+=Qe.area,"squarify"!==ot||(tt=worst(it,Dt))<=ht?(dt.pop(),ht=tt):(it.area-=it.pop().area,position(it,Dt,nt,!1),Dt=Math.min(nt.dx,nt.dy),it.length=it.area=0,ht=1/0);it.length&&(position(it,Dt,nt,!0),it.length=it.area=0),Ge.forEach(squarify)}}function stickify(Ne){var Ge=Ne.children;if(Ge&&Ge.length){var Qe,tt=at(Ne),rt=Ge.slice(),nt=[];for(scale(rt,tt.dx*tt.dy/Ne.value),nt.area=0;Qe=rt.pop();)nt.push(Qe),nt.area+=Qe.area,null!=Qe.z&&(position(nt,Qe.z?tt.dx:tt.dy,tt,!rt.length),nt.length=nt.area=0);Ge.forEach(stickify)}}function worst(Ne,Ge){for(var Qe,tt=Ne.area,rt=0,nt=1/0,at=-1,it=Ne.length;++at<it;)(Qe=Ne[at].area)&&(Qe<nt&&(nt=Qe),Qe>rt&&(rt=Qe));return Ge*=Ge,(tt*=tt)?Math.max(Ge*rt*dt/tt,tt/(Ge*nt*dt)):1/0}function position(Ne,Ge,Qe,rt){var nt,at=-1,it=Ne.length,ot=Qe.x,dt=Qe.y,ht=Ge?tt(Ne.area/Ge):0;if(Ge==Qe.dx){for((rt||ht>Qe.dy)&&(ht=Qe.dy);++at<it;)(nt=Ne[at]).x=ot,nt.y=dt,nt.dy=ht,ot+=nt.dx=Math.min(Qe.x+Qe.dx-ot,ht?tt(nt.area/ht):0);nt.z=!0,nt.dx+=Qe.x+Qe.dx-ot,Qe.y+=ht,Qe.dy-=ht}else{for((rt||ht>Qe.dx)&&(ht=Qe.dx);++at<it;)(nt=Ne[at]).x=ot,nt.y=dt,nt.dx=ht,dt+=nt.dy=Math.min(Qe.y+Qe.dy-dt,ht?tt(nt.area/ht):0);nt.z=!1,nt.dy+=Qe.y+Qe.dy-dt,Qe.x+=ht,Qe.dx-=ht}}function treemap(Ne){var tt=Ge||Qe(Ne),nt=tt[0];return nt.x=nt.y=0,nt.value?(nt.dx=rt[0],nt.dy=rt[1]):nt.dx=nt.dy=0,Ge&&Qe.revalue(nt),scale([nt],nt.dx*nt.dy/nt.value),(Ge?stickify:squarify)(nt),it&&(Ge=tt),tt}return treemap.size=function(Ne){return arguments.length?(rt=Ne,treemap):rt},treemap.padding=function(Ne){if(!arguments.length)return nt;function padFunction(Ge){var Qe=Ne.call(treemap,Ge,Ge.depth);return null==Qe?d3_layout_treemapPadNull(Ge):d3_layout_treemapPad(Ge,"number"==typeof Qe?[Qe,Qe,Qe,Qe]:Qe)}function padConstant(Ge){return d3_layout_treemapPad(Ge,Ne)}var Ge;return at=null==(nt=Ne)?d3_layout_treemapPadNull:"function"==(Ge=typeof Ne)?padFunction:"number"===Ge?(Ne=[Ne,Ne,Ne,Ne],padConstant):padConstant,treemap},treemap.round=function(Ne){return arguments.length?(tt=Ne?Math.round:Number,treemap):tt!=Number},treemap.sticky=function(Ne){return arguments.length?(it=Ne,Ge=null,treemap):it},treemap.ratio=function(Ne){return arguments.length?(dt=Ne,treemap):dt},treemap.mode=function(Ne){return arguments.length?(ot=Ne+"",treemap):ot},d3_layout_hierarchyRebind(treemap,Qe)},Ne.random={normal:function(Ne,Ge){var Qe=arguments.length;return Qe<2&&(Ge=1),Qe<1&&(Ne=0),function(){var Qe,tt,rt;do{rt=(Qe=2*Math.random()-1)*Qe+(tt=2*Math.random()-1)*tt}while(!rt||rt>1);return Ne+Ge*Qe*Math.sqrt(-2*Math.log(rt)/rt)}},logNormal:function(){var Ge=Ne.random.normal.apply(Ne,arguments);return function(){return Math.exp(Ge())}},bates:function(Ge){var Qe=Ne.random.irwinHall(Ge);return function(){return Qe()/Ge}},irwinHall:function(Ne){return function(){for(var Ge=0,Qe=0;Qe<Ne;Qe++)Ge+=Math.random();return Ge}}},Ne.scale={};var bc={floor:d3_identity,ceil:d3_identity};function d3_scale_polylinear(Ge,Qe,tt,rt){var nt=[],at=[],it=0,ot=Math.min(Ge.length,Qe.length)-1;for(Ge[ot]<Ge[0]&&(Ge=Ge.slice().reverse(),Qe=Qe.slice().reverse());++it<=ot;)nt.push(tt(Ge[it-1],Ge[it])),at.push(rt(Qe[it-1],Qe[it]));return function(Qe){var tt=Ne.bisect(Ge,Qe,1,ot)-1;return at[tt](nt[tt](Qe))}}function d3_scale_linear(Ne,Ge,Qe,tt){var rt,nt;function rescale(){var at=Math.min(Ne.length,Ge.length)>2?d3_scale_polylinear:d3_scale_bilinear,it=tt?d3_uninterpolateClamp:d3_uninterpolateNumber;return rt=at(Ne,Ge,it,Qe),nt=at(Ge,Ne,it,d3_interpolate),scale}function scale(Ne){return rt(Ne)}return scale.invert=function(Ne){return nt(Ne)},scale.domain=function(Ge){return arguments.length?(Ne=Ge.map(Number),rescale()):Ne},scale.range=function(Ne){return arguments.length?(Ge=Ne,rescale()):Ge},scale.rangeRound=function(Ne){return scale.range(Ne).interpolate(d3_interpolateRound)},scale.clamp=function(Ne){return arguments.length?(tt=Ne,rescale()):tt},scale.interpolate=function(Ne){return arguments.length?(Qe=Ne,rescale()):Qe},scale.ticks=function(Ge){return d3_scale_linearTicks(Ne,Ge)},scale.tickFormat=function(Ge,Qe){return d3_scale_linearTickFormat(Ne,Ge,Qe)},scale.nice=function(Ge){return d3_scale_linearNice(Ne,Ge),rescale()},scale.copy=function(){return d3_scale_linear(Ne,Ge,Qe,tt)},rescale()}function d3_scale_linearRebind(Ge,Qe){return Ne.rebind(Ge,Qe,"range","rangeRound","interpolate","clamp")}function d3_scale_linearNice(Ne,Ge){return d3_scale_nice(Ne,d3_scale_niceStep(d3_scale_linearTickRange(Ne,Ge)[2])),d3_scale_nice(Ne,d3_scale_niceStep(d3_scale_linearTickRange(Ne,Ge)[2])),Ne}function d3_scale_linearTickRange(Ne,Ge){null==Ge&&(Ge=10);var Qe=d3_scaleExtent(Ne),tt=Qe[1]-Qe[0],rt=Math.pow(10,Math.floor(Math.log(tt/Ge)/Math.LN10)),nt=Ge/tt*rt;return nt<=.15?rt*=10:nt<=.35?rt*=5:nt<=.75&&(rt*=2),Qe[0]=Math.ceil(Qe[0]/rt)*rt,Qe[1]=Math.floor(Qe[1]/rt)*rt+.5*rt,Qe[2]=rt,Qe}function d3_scale_linearTicks(Ge,Qe){return Ne.range.apply(Ne,d3_scale_linearTickRange(Ge,Qe))}function d3_scale_linearTickFormat(Ge,Qe,tt){var rt=d3_scale_linearTickRange(Ge,Qe);if(tt){var nt=ns.exec(tt);if(nt.shift(),"s"===nt[8]){var at=Ne.formatPrefix(Math.max(Dt(rt[0]),Dt(rt[1])));return nt[7]||(nt[7]="."+d3_scale_linearPrecision(at.scale(rt[2]))),nt[8]="f",tt=Ne.format(nt.join("")),function(Ne){return tt(at.scale(Ne))+at.symbol}}nt[7]||(nt[7]="."+d3_scale_linearFormatPrecision(nt[8],rt)),tt=nt.join("")}else tt=",."+d3_scale_linearPrecision(rt[2])+"f";return Ne.format(tt)}Ne.scale.linear=function(){return d3_scale_linear([0,1],[0,1],d3_interpolate,!1)};var _c={s:1,g:1,p:1,r:1,e:1};function d3_scale_linearPrecision(Ne){return-Math.floor(Math.log(Ne)/Math.LN10+.01)}function d3_scale_linearFormatPrecision(Ne,Ge){var Qe=d3_scale_linearPrecision(Ge[2]);return Ne in _c?Math.abs(Qe-d3_scale_linearPrecision(Math.max(Dt(Ge[0]),Dt(Ge[1]))))+ +("e"!==Ne):Qe-2*("%"===Ne)}function d3_scale_log(Ge,Qe,tt,rt){function log(Ne){return(tt?Math.log(Ne<0?0:Ne):-Math.log(Ne>0?0:-Ne))/Math.log(Qe)}function pow(Ne){return tt?Math.pow(Qe,Ne):-Math.pow(Qe,-Ne)}function scale(Ne){return Ge(log(Ne))}return scale.invert=function(Ne){return pow(Ge.invert(Ne))},scale.domain=function(Ne){return arguments.length?(tt=Ne[0]>=0,Ge.domain((rt=Ne.map(Number)).map(log)),scale):rt},scale.base=function(Ne){return arguments.length?(Qe=+Ne,Ge.domain(rt.map(log)),scale):Qe},scale.nice=function(){var Ne=d3_scale_nice(rt.map(log),tt?Math:Tc);return Ge.domain(Ne),rt=Ne.map(pow),scale},scale.ticks=function(){var Ne=d3_scaleExtent(rt),Ge=[],nt=Ne[0],at=Ne[1],it=Math.floor(log(nt)),ot=Math.ceil(log(at)),dt=Qe%1?2:Qe;if(isFinite(ot-it)){if(tt){for(;it<ot;it++)for(var ht=1;ht<dt;ht++)Ge.push(pow(it)*ht);Ge.push(pow(it))}else for(Ge.push(pow(it));it++<ot;)for(ht=dt-1;ht>0;ht--)Ge.push(pow(it)*ht);for(it=0;Ge[it]<nt;it++);for(ot=Ge.length;Ge[ot-1]>at;ot--);Ge=Ge.slice(it,ot)}return Ge},scale.tickFormat=function(Ge,tt){if(!arguments.length)return wc;arguments.length<2?tt=wc:"function"!=typeof tt&&(tt=Ne.format(tt));var rt=Math.max(1,Qe*Ge/scale.ticks().length);return function(Ne){var Ge=Ne/pow(Math.round(log(Ne)));return Ge*Qe<Qe-.5&&(Ge*=Qe),Ge<=rt?tt(Ne):""}},scale.copy=function(){return d3_scale_log(Ge.copy(),Qe,tt,rt)},d3_scale_linearRebind(scale,Ge)}Ne.scale.log=function(){return d3_scale_log(Ne.scale.linear().domain([0,1]),10,!0,[1,10])};var wc=Ne.format(".0e"),Tc={floor:function(Ne){return-Math.ceil(-Ne)},ceil:function(Ne){return-Math.floor(-Ne)}};function d3_scale_pow(Ne,Ge,Qe){var tt=d3_scale_powPow(Ge),rt=d3_scale_powPow(1/Ge);function scale(Ge){return Ne(tt(Ge))}return scale.invert=function(Ge){return rt(Ne.invert(Ge))},scale.domain=function(Ge){return arguments.length?(Ne.domain((Qe=Ge.map(Number)).map(tt)),scale):Qe},scale.ticks=function(Ne){return d3_scale_linearTicks(Qe,Ne)},scale.tickFormat=function(Ne,Ge){return d3_scale_linearTickFormat(Qe,Ne,Ge)},scale.nice=function(Ne){return scale.domain(d3_scale_linearNice(Qe,Ne))},scale.exponent=function(nt){return arguments.length?(tt=d3_scale_powPow(Ge=nt),rt=d3_scale_powPow(1/Ge),Ne.domain(Qe.map(tt)),scale):Ge},scale.copy=function(){return d3_scale_pow(Ne.copy(),Ge,Qe)},d3_scale_linearRebind(scale,Ne)}function d3_scale_powPow(Ne){return function(Ge){return Ge<0?-Math.pow(-Ge,Ne):Math.pow(Ge,Ne)}}function d3_scale_ordinal(Ge,Qe){var tt,rt,nt;function scale(Ne){return rt[((tt.get(Ne)||("range"===Qe.t?tt.set(Ne,Ge.push(Ne)):NaN))-1)%rt.length]}function steps(Qe,tt){return Ne.range(Ge.length).map((function(Ne){return Qe+tt*Ne}))}return scale.domain=function(Ne){if(!arguments.length)return Ge;Ge=[],tt=new d3_Map;for(var rt,nt=-1,at=Ne.length;++nt<at;)tt.has(rt=Ne[nt])||tt.set(rt,Ge.push(rt));return scale[Qe.t].apply(scale,Qe.a)},scale.range=function(Ne){return arguments.length?(rt=Ne,nt=0,Qe={t:"range",a:arguments},scale):rt},scale.rangePoints=function(Ne,tt){arguments.length<2&&(tt=0);var at=Ne[0],it=Ne[1],ot=Ge.length<2?(at=(at+it)/2,0):(it-at)/(Ge.length-1+tt);return rt=steps(at+ot*tt/2,ot),nt=0,Qe={t:"rangePoints",a:arguments},scale},scale.rangeRoundPoints=function(Ne,tt){arguments.length<2&&(tt=0);var at=Ne[0],it=Ne[1],ot=Ge.length<2?(at=it=Math.round((at+it)/2),0):(it-at)/(Ge.length-1+tt)|0;return rt=steps(at+Math.round(ot*tt/2+(it-at-(Ge.length-1+tt)*ot)/2),ot),nt=0,Qe={t:"rangeRoundPoints",a:arguments},scale},scale.rangeBands=function(Ne,tt,at){arguments.length<2&&(tt=0),arguments.length<3&&(at=tt);var it=Ne[1]<Ne[0],ot=Ne[it-0],dt=(Ne[1-it]-ot)/(Ge.length-tt+2*at);return rt=steps(ot+dt*at,dt),it&&rt.reverse(),nt=dt*(1-tt),Qe={t:"rangeBands",a:arguments},scale},scale.rangeRoundBands=function(Ne,tt,at){arguments.length<2&&(tt=0),arguments.length<3&&(at=tt);var it=Ne[1]<Ne[0],ot=Ne[it-0],dt=Ne[1-it],ht=Math.floor((dt-ot)/(Ge.length-tt+2*at));return rt=steps(ot+Math.round((dt-ot-(Ge.length-tt)*ht)/2),ht),it&&rt.reverse(),nt=Math.round(ht*(1-tt)),Qe={t:"rangeRoundBands",a:arguments},scale},scale.rangeBand=function(){return nt},scale.rangeExtent=function(){return d3_scaleExtent(Qe.a[0])},scale.copy=function(){return d3_scale_ordinal(Ge,Qe)},scale.domain(Ge)}Ne.scale.pow=function(){return d3_scale_pow(Ne.scale.linear(),1,[0,1])},Ne.scale.sqrt=function(){return Ne.scale.pow().exponent(.5)},Ne.scale.ordinal=function(){return d3_scale_ordinal([],{t:"range",a:[[]]})},Ne.scale.category10=function(){return Ne.scale.ordinal().range(kc)},Ne.scale.category20=function(){return Ne.scale.ordinal().range(Ac)},Ne.scale.category20b=function(){return Ne.scale.ordinal().range(Mc)},Ne.scale.category20c=function(){return Ne.scale.ordinal().range(Sc)};var kc=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(d3_rgbString),Ac=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(d3_rgbString),Mc=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(d3_rgbString),Sc=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(d3_rgbString);function d3_scale_quantile(Ge,Qe){var tt;function rescale(){var rt=0,nt=Qe.length;for(tt=[];++rt<nt;)tt[rt-1]=Ne.quantile(Ge,rt/nt);return scale}function scale(Ge){if(!isNaN(Ge=+Ge))return Qe[Ne.bisect(tt,Ge)]}return scale.domain=function(Ne){return arguments.length?(Ge=Ne.map(d3_number).filter(d3_numeric).sort(d3_ascending),rescale()):Ge},scale.range=function(Ne){return arguments.length?(Qe=Ne,rescale()):Qe},scale.quantiles=function(){return tt},scale.invertExtent=function(Ne){return(Ne=Qe.indexOf(Ne))<0?[NaN,NaN]:[Ne>0?tt[Ne-1]:Ge[0],Ne<tt.length?tt[Ne]:Ge[Ge.length-1]]},scale.copy=function(){return d3_scale_quantile(Ge,Qe)},rescale()}function d3_scale_quantize(Ne,Ge,Qe){var tt,rt;function scale(Ge){return Qe[Math.max(0,Math.min(rt,Math.floor(tt*(Ge-Ne))))]}function rescale(){return tt=Qe.length/(Ge-Ne),rt=Qe.length-1,scale}return scale.domain=function(Qe){return arguments.length?(Ne=+Qe[0],Ge=+Qe[Qe.length-1],rescale()):[Ne,Ge]},scale.range=function(Ne){return arguments.length?(Qe=Ne,rescale()):Qe},scale.invertExtent=function(Ge){return[Ge=(Ge=Qe.indexOf(Ge))<0?NaN:Ge/tt+Ne,Ge+1/tt]},scale.copy=function(){return d3_scale_quantize(Ne,Ge,Qe)},rescale()}function d3_scale_threshold(Ge,Qe){function scale(tt){if(tt<=tt)return Qe[Ne.bisect(Ge,tt)]}return scale.domain=function(Ne){return arguments.length?(Ge=Ne,scale):Ge},scale.range=function(Ne){return arguments.length?(Qe=Ne,scale):Qe},scale.invertExtent=function(Ne){return Ne=Qe.indexOf(Ne),[Ge[Ne-1],Ge[Ne]]},scale.copy=function(){return d3_scale_threshold(Ge,Qe)},scale}function d3_scale_identity(Ne){function identity(Ne){return+Ne}return identity.invert=identity,identity.domain=identity.range=function(Ge){return arguments.length?(Ne=Ge.map(identity),identity):Ne},identity.ticks=function(Ge){return d3_scale_linearTicks(Ne,Ge)},identity.tickFormat=function(Ge,Qe){return d3_scale_linearTickFormat(Ne,Ge,Qe)},identity.copy=function(){return d3_scale_identity(Ne)},identity}function d3_zero(){return 0}Ne.scale.quantile=function(){return d3_scale_quantile([],[])},Ne.scale.quantize=function(){return d3_scale_quantize(0,1,[0,1])},Ne.scale.threshold=function(){return d3_scale_threshold([.5],[0,1])},Ne.scale.identity=function(){return d3_scale_identity([0,1])},Ne.svg={},Ne.svg.arc=function(){var Ne=d3_svg_arcInnerRadius,Ge=d3_svg_arcOuterRadius,Qe=d3_zero,tt=Cc,rt=d3_svg_arcStartAngle,nt=d3_svg_arcEndAngle,at=d3_svg_arcPadAngle;function arc(){var it=Math.max(0,+Ne.apply(this,arguments)),ot=Math.max(0,+Ge.apply(this,arguments)),dt=rt.apply(this,arguments)-zn,ht=nt.apply(this,arguments)-zn,Dt=Math.abs(ht-dt),Ot=dt>ht?0:1;if(ot<it&&(Rt=ot,ot=it,it=Rt),Dt>=In)return circleSegment(ot,Ot)+(it?circleSegment(it,1-Ot):"")+"Z";var Rt,Zt,er,dr,mr,xr,br,Ar,en,mn,xn,kn,En=0,Dn=0,Bn=[];if((dr=(+at.apply(this,arguments)||0)/2)&&(er=tt===Cc?Math.sqrt(it*it+ot*ot):+tt.apply(this,arguments),Ot||(Dn*=-1),ot&&(Dn=d3_asin(er/ot*Math.sin(dr))),it&&(En=d3_asin(er/it*Math.sin(dr)))),ot){mr=ot*Math.cos(dt+Dn),xr=ot*Math.sin(dt+Dn),br=ot*Math.cos(ht-Dn),Ar=ot*Math.sin(ht-Dn);var Vn=Math.abs(ht-dt-2*Dn)<=Pn?0:1;if(Dn&&d3_svg_arcSweep(mr,xr,br,Ar)===Ot^Vn){var Hn=(dt+ht)/2;mr=ot*Math.cos(Hn),xr=ot*Math.sin(Hn),br=Ar=null}}else mr=xr=0;if(it){en=it*Math.cos(ht-En),mn=it*Math.sin(ht-En),xn=it*Math.cos(dt+En),kn=it*Math.sin(dt+En);var qn=Math.abs(dt-ht+2*En)<=Pn?0:1;if(En&&d3_svg_arcSweep(en,mn,xn,kn)===1-Ot^qn){var Yn=(dt+ht)/2;en=it*Math.cos(Yn),mn=it*Math.sin(Yn),xn=kn=null}}else en=mn=0;if(Dt>Cn&&(Rt=Math.min(Math.abs(ot-it)/2,+Qe.apply(this,arguments)))>.001){Zt=it<ot^Ot?0:1;var $n=Rt,ra=Rt;if(Dt<Pn){var oa=null==xn?[en,mn]:null==br?[mr,xr]:d3_geom_polygonIntersect([mr,xr],[xn,kn],[br,Ar],[en,mn]),pa=mr-oa[0],ga=xr-oa[1],ma=br-oa[0],_a=Ar-oa[1],Va=1/Math.sin(Math.acos((pa*ma+ga*_a)/(Math.sqrt(pa*pa+ga*ga)*Math.sqrt(ma*ma+_a*_a)))/2),Wa=Math.sqrt(oa[0]*oa[0]+oa[1]*oa[1]);ra=Math.min(Rt,(it-Wa)/(Va-1)),$n=Math.min(Rt,(ot-Wa)/(Va+1))}if(null!=br){var Qa=d3_svg_arcCornerTangents(null==xn?[en,mn]:[xn,kn],[mr,xr],ot,$n,Ot),ti=d3_svg_arcCornerTangents([br,Ar],[en,mn],ot,$n,Ot);Rt===$n?Bn.push("M",Qa[0],"A",$n,",",$n," 0 0,",Zt," ",Qa[1],"A",ot,",",ot," 0 ",1-Ot^d3_svg_arcSweep(Qa[1][0],Qa[1][1],ti[1][0],ti[1][1]),",",Ot," ",ti[1],"A",$n,",",$n," 0 0,",Zt," ",ti[0]):Bn.push("M",Qa[0],"A",$n,",",$n," 0 1,",Zt," ",ti[0])}else Bn.push("M",mr,",",xr);if(null!=xn){var ni=d3_svg_arcCornerTangents([mr,xr],[xn,kn],it,-ra,Ot),di=d3_svg_arcCornerTangents([en,mn],null==br?[mr,xr]:[br,Ar],it,-ra,Ot);Rt===ra?Bn.push("L",di[0],"A",ra,",",ra," 0 0,",Zt," ",di[1],"A",it,",",it," 0 ",Ot^d3_svg_arcSweep(di[1][0],di[1][1],ni[1][0],ni[1][1]),",",1-Ot," ",ni[1],"A",ra,",",ra," 0 0,",Zt," ",ni[0]):Bn.push("L",di[0],"A",ra,",",ra," 0 0,",Zt," ",ni[0])}else Bn.push("L",en,",",mn)}else Bn.push("M",mr,",",xr),null!=br&&Bn.push("A",ot,",",ot," 0 ",Vn,",",Ot," ",br,",",Ar),Bn.push("L",en,",",mn),null!=xn&&Bn.push("A",it,",",it," 0 ",qn,",",1-Ot," ",xn,",",kn);return Bn.push("Z"),Bn.join("")}function circleSegment(Ne,Ge){return"M0,"+Ne+"A"+Ne+","+Ne+" 0 1,"+Ge+" 0,"+-Ne+"A"+Ne+","+Ne+" 0 1,"+Ge+" 0,"+Ne}return arc.innerRadius=function(Ge){return arguments.length?(Ne=d3_functor(Ge),arc):Ne},arc.outerRadius=function(Ne){return arguments.length?(Ge=d3_functor(Ne),arc):Ge},arc.cornerRadius=function(Ne){return arguments.length?(Qe=d3_functor(Ne),arc):Qe},arc.padRadius=function(Ne){return arguments.length?(tt=Ne==Cc?Cc:d3_functor(Ne),arc):tt},arc.startAngle=function(Ne){return arguments.length?(rt=d3_functor(Ne),arc):rt},arc.endAngle=function(Ne){return arguments.length?(nt=d3_functor(Ne),arc):nt},arc.padAngle=function(Ne){return arguments.length?(at=d3_functor(Ne),arc):at},arc.centroid=function(){var Qe=(+Ne.apply(this,arguments)+ +Ge.apply(this,arguments))/2,tt=(+rt.apply(this,arguments)+ +nt.apply(this,arguments))/2-zn;return[Math.cos(tt)*Qe,Math.sin(tt)*Qe]},arc};var Cc="auto";function d3_svg_arcInnerRadius(Ne){return Ne.innerRadius}function d3_svg_arcOuterRadius(Ne){return Ne.outerRadius}function d3_svg_arcStartAngle(Ne){return Ne.startAngle}function d3_svg_arcEndAngle(Ne){return Ne.endAngle}function d3_svg_arcPadAngle(Ne){return Ne&&Ne.padAngle}function d3_svg_arcSweep(Ne,Ge,Qe,tt){return(Ne-Qe)*Ge-(Ge-tt)*Ne>0?0:1}function d3_svg_arcCornerTangents(Ne,Ge,Qe,tt,rt){var nt=Ne[0]-Ge[0],at=Ne[1]-Ge[1],it=(rt?tt:-tt)/Math.sqrt(nt*nt+at*at),ot=it*at,dt=-it*nt,ht=Ne[0]+ot,Dt=Ne[1]+dt,Ot=Ge[0]+ot,Rt=Ge[1]+dt,Zt=(ht+Ot)/2,er=(Dt+Rt)/2,dr=Ot-ht,mr=Rt-Dt,xr=dr*dr+mr*mr,br=Qe-tt,Ar=ht*Rt-Ot*Dt,en=(mr<0?-1:1)*Math.sqrt(Math.max(0,br*br*xr-Ar*Ar)),mn=(Ar*mr-dr*en)/xr,xn=(-Ar*dr-mr*en)/xr,kn=(Ar*mr+dr*en)/xr,Cn=(-Ar*dr+mr*en)/xr,En=mn-Zt,Pn=xn-er,Dn=kn-Zt,In=Cn-er;return En*En+Pn*Pn>Dn*Dn+In*In&&(mn=kn,xn=Cn),[[mn-ot,xn-dt],[mn*Qe/br,xn*Qe/br]]}function d3_svg_line(Ne){var Ge=d3_geom_pointX,Qe=d3_geom_pointY,tt=d3_true,rt=d3_svg_lineLinear,nt=rt.key,at=.7;function line(nt){var it,ot=[],dt=[],ht=-1,Dt=nt.length,Ot=d3_functor(Ge),Rt=d3_functor(Qe);function segment(){ot.push("M",rt(Ne(dt),at))}for(;++ht<Dt;)tt.call(this,it=nt[ht],ht)?dt.push([+Ot.call(this,it,ht),+Rt.call(this,it,ht)]):dt.length&&(segment(),dt=[]);return dt.length&&segment(),ot.length?ot.join(""):null}return line.x=function(Ne){return arguments.length?(Ge=Ne,line):Ge},line.y=function(Ne){return arguments.length?(Qe=Ne,line):Qe},line.defined=function(Ne){return arguments.length?(tt=Ne,line):tt},line.interpolate=function(Ne){return arguments.length?(nt="function"==typeof Ne?rt=Ne:(rt=Ec.get(Ne)||d3_svg_lineLinear).key,line):nt},line.tension=function(Ne){return arguments.length?(at=Ne,line):at},line}Ne.svg.line=function(){return d3_svg_line(d3_identity)};var Ec=Ne.map({linear:d3_svg_lineLinear,"linear-closed":d3_svg_lineLinearClosed,step:d3_svg_lineStep,"step-before":d3_svg_lineStepBefore,"step-after":d3_svg_lineStepAfter,basis:d3_svg_lineBasis,"basis-open":d3_svg_lineBasisOpen,"basis-closed":d3_svg_lineBasisClosed,bundle:d3_svg_lineBundle,cardinal:d3_svg_lineCardinal,"cardinal-open":d3_svg_lineCardinalOpen,"cardinal-closed":d3_svg_lineCardinalClosed,monotone:d3_svg_lineMonotone});function d3_svg_lineLinear(Ne){return Ne.length>1?Ne.join("L"):Ne+"Z"}function d3_svg_lineLinearClosed(Ne){return Ne.join("L")+"Z"}function d3_svg_lineStep(Ne){for(var Ge=0,Qe=Ne.length,tt=Ne[0],rt=[tt[0],",",tt[1]];++Ge<Qe;)rt.push("H",(tt[0]+(tt=Ne[Ge])[0])/2,"V",tt[1]);return Qe>1&&rt.push("H",tt[0]),rt.join("")}function d3_svg_lineStepBefore(Ne){for(var Ge=0,Qe=Ne.length,tt=Ne[0],rt=[tt[0],",",tt[1]];++Ge<Qe;)rt.push("V",(tt=Ne[Ge])[1],"H",tt[0]);return rt.join("")}function d3_svg_lineStepAfter(Ne){for(var Ge=0,Qe=Ne.length,tt=Ne[0],rt=[tt[0],",",tt[1]];++Ge<Qe;)rt.push("H",(tt=Ne[Ge])[0],"V",tt[1]);return rt.join("")}function d3_svg_lineCardinalOpen(Ne,Ge){return Ne.length<4?d3_svg_lineLinear(Ne):Ne[1]+d3_svg_lineHermite(Ne.slice(1,-1),d3_svg_lineCardinalTangents(Ne,Ge))}function d3_svg_lineCardinalClosed(Ne,Ge){return Ne.length<3?d3_svg_lineLinearClosed(Ne):Ne[0]+d3_svg_lineHermite((Ne.push(Ne[0]),Ne),d3_svg_lineCardinalTangents([Ne[Ne.length-2]].concat(Ne,[Ne[1]]),Ge))}function d3_svg_lineCardinal(Ne,Ge){return Ne.length<3?d3_svg_lineLinear(Ne):Ne[0]+d3_svg_lineHermite(Ne,d3_svg_lineCardinalTangents(Ne,Ge))}function d3_svg_lineHermite(Ne,Ge){if(Ge.length<1||Ne.length!=Ge.length&&Ne.length!=Ge.length+2)return d3_svg_lineLinear(Ne);var Qe=Ne.length!=Ge.length,tt="",rt=Ne[0],nt=Ne[1],at=Ge[0],it=at,ot=1;if(Qe&&(tt+="Q"+(nt[0]-2*at[0]/3)+","+(nt[1]-2*at[1]/3)+","+nt[0]+","+nt[1],rt=Ne[1],ot=2),Ge.length>1){it=Ge[1],nt=Ne[ot],ot++,tt+="C"+(rt[0]+at[0])+","+(rt[1]+at[1])+","+(nt[0]-it[0])+","+(nt[1]-it[1])+","+nt[0]+","+nt[1];for(var dt=2;dt<Ge.length;dt++,ot++)nt=Ne[ot],it=Ge[dt],tt+="S"+(nt[0]-it[0])+","+(nt[1]-it[1])+","+nt[0]+","+nt[1]}if(Qe){var ht=Ne[ot];tt+="Q"+(nt[0]+2*it[0]/3)+","+(nt[1]+2*it[1]/3)+","+ht[0]+","+ht[1]}return tt}function d3_svg_lineCardinalTangents(Ne,Ge){for(var Qe,tt=[],rt=(1-Ge)/2,nt=Ne[0],at=Ne[1],it=1,ot=Ne.length;++it<ot;)Qe=nt,nt=at,at=Ne[it],tt.push([rt*(at[0]-Qe[0]),rt*(at[1]-Qe[1])]);return tt}function d3_svg_lineBasis(Ne){if(Ne.length<3)return d3_svg_lineLinear(Ne);var Ge=1,Qe=Ne.length,tt=Ne[0],rt=tt[0],nt=tt[1],at=[rt,rt,rt,(tt=Ne[1])[0]],it=[nt,nt,nt,tt[1]],ot=[rt,",",nt,"L",d3_svg_lineDot4(Dc,at),",",d3_svg_lineDot4(Dc,it)];for(Ne.push(Ne[Qe-1]);++Ge<=Qe;)tt=Ne[Ge],at.shift(),at.push(tt[0]),it.shift(),it.push(tt[1]),d3_svg_lineBasisBezier(ot,at,it);return Ne.pop(),ot.push("L",tt),ot.join("")}function d3_svg_lineBasisOpen(Ne){if(Ne.length<4)return d3_svg_lineLinear(Ne);for(var Ge,Qe=[],tt=-1,rt=Ne.length,nt=[0],at=[0];++tt<3;)Ge=Ne[tt],nt.push(Ge[0]),at.push(Ge[1]);for(Qe.push(d3_svg_lineDot4(Dc,nt)+","+d3_svg_lineDot4(Dc,at)),--tt;++tt<rt;)Ge=Ne[tt],nt.shift(),nt.push(Ge[0]),at.shift(),at.push(Ge[1]),d3_svg_lineBasisBezier(Qe,nt,at);return Qe.join("")}function d3_svg_lineBasisClosed(Ne){for(var Ge,Qe,tt=-1,rt=Ne.length,nt=rt+4,at=[],it=[];++tt<4;)Qe=Ne[tt%rt],at.push(Qe[0]),it.push(Qe[1]);for(Ge=[d3_svg_lineDot4(Dc,at),",",d3_svg_lineDot4(Dc,it)],--tt;++tt<nt;)Qe=Ne[tt%rt],at.shift(),at.push(Qe[0]),it.shift(),it.push(Qe[1]),d3_svg_lineBasisBezier(Ge,at,it);return Ge.join("")}function d3_svg_lineBundle(Ne,Ge){var Qe=Ne.length-1;if(Qe)for(var tt,rt,nt=Ne[0][0],at=Ne[0][1],it=Ne[Qe][0]-nt,ot=Ne[Qe][1]-at,dt=-1;++dt<=Qe;)rt=dt/Qe,(tt=Ne[dt])[0]=Ge*tt[0]+(1-Ge)*(nt+rt*it),tt[1]=Ge*tt[1]+(1-Ge)*(at+rt*ot);return d3_svg_lineBasis(Ne)}function d3_svg_lineDot4(Ne,Ge){return Ne[0]*Ge[0]+Ne[1]*Ge[1]+Ne[2]*Ge[2]+Ne[3]*Ge[3]}Ec.forEach((function(Ne,Ge){Ge.key=Ne,Ge.closed=/-closed$/.test(Ne)}));var Lc=[0,2/3,1/3,0],Pc=[0,1/3,2/3,0],Dc=[0,1/6,2/3,1/6];function d3_svg_lineBasisBezier(Ne,Ge,Qe){Ne.push("C",d3_svg_lineDot4(Lc,Ge),",",d3_svg_lineDot4(Lc,Qe),",",d3_svg_lineDot4(Pc,Ge),",",d3_svg_lineDot4(Pc,Qe),",",d3_svg_lineDot4(Dc,Ge),",",d3_svg_lineDot4(Dc,Qe))}function d3_svg_lineSlope(Ne,Ge){return(Ge[1]-Ne[1])/(Ge[0]-Ne[0])}function d3_svg_lineFiniteDifferences(Ne){for(var Ge=0,Qe=Ne.length-1,tt=[],rt=Ne[0],nt=Ne[1],at=tt[0]=d3_svg_lineSlope(rt,nt);++Ge<Qe;)tt[Ge]=(at+(at=d3_svg_lineSlope(rt=nt,nt=Ne[Ge+1])))/2;return tt[Ge]=at,tt}function d3_svg_lineMonotoneTangents(Ne){for(var Ge,Qe,tt,rt,nt=[],at=d3_svg_lineFiniteDifferences(Ne),it=-1,ot=Ne.length-1;++it<ot;)Ge=d3_svg_lineSlope(Ne[it],Ne[it+1]),Dt(Ge)<Cn?at[it]=at[it+1]=0:(rt=(Qe=at[it]/Ge)*Qe+(tt=at[it+1]/Ge)*tt)>9&&(rt=3*Ge/Math.sqrt(rt),at[it]=rt*Qe,at[it+1]=rt*tt);for(it=-1;++it<=ot;)rt=(Ne[Math.min(ot,it+1)][0]-Ne[Math.max(0,it-1)][0])/(6*(1+at[it]*at[it])),nt.push([rt||0,at[it]*rt||0]);return nt}function d3_svg_lineMonotone(Ne){return Ne.length<3?d3_svg_lineLinear(Ne):Ne[0]+d3_svg_lineHermite(Ne,d3_svg_lineMonotoneTangents(Ne))}function d3_svg_lineRadial(Ne){for(var Ge,Qe,tt,rt=-1,nt=Ne.length;++rt<nt;)Qe=(Ge=Ne[rt])[0],tt=Ge[1]-zn,Ge[0]=Qe*Math.cos(tt),Ge[1]=Qe*Math.sin(tt);return Ne}function d3_svg_area(Ne){var Ge=d3_geom_pointX,Qe=d3_geom_pointX,tt=0,rt=d3_geom_pointY,nt=d3_true,at=d3_svg_lineLinear,it=at.key,ot=at,dt="L",ht=.7;function area(it){var Dt,Ot,Rt,Zt=[],er=[],dr=[],mr=-1,xr=it.length,br=d3_functor(Ge),Ar=d3_functor(tt),en=Ge===Qe?function(){return Ot}:d3_functor(Qe),mn=tt===rt?function(){return Rt}:d3_functor(rt);function segment(){Zt.push("M",at(Ne(dr),ht),dt,ot(Ne(er.reverse()),ht),"Z")}for(;++mr<xr;)nt.call(this,Dt=it[mr],mr)?(er.push([Ot=+br.call(this,Dt,mr),Rt=+Ar.call(this,Dt,mr)]),dr.push([+en.call(this,Dt,mr),+mn.call(this,Dt,mr)])):er.length&&(segment(),er=[],dr=[]);return er.length&&segment(),Zt.length?Zt.join(""):null}return area.x=function(Ne){return arguments.length?(Ge=Qe=Ne,area):Qe},area.x0=function(Ne){return arguments.length?(Ge=Ne,area):Ge},area.x1=function(Ne){return arguments.length?(Qe=Ne,area):Qe},area.y=function(Ne){return arguments.length?(tt=rt=Ne,area):rt},area.y0=function(Ne){return arguments.length?(tt=Ne,area):tt},area.y1=function(Ne){return arguments.length?(rt=Ne,area):rt},area.defined=function(Ne){return arguments.length?(nt=Ne,area):nt},area.interpolate=function(Ne){return arguments.length?(it="function"==typeof Ne?at=Ne:(at=Ec.get(Ne)||d3_svg_lineLinear).key,ot=at.reverse||at,dt=at.closed?"M":"L",area):it},area.tension=function(Ne){return arguments.length?(ht=Ne,area):ht},area}function d3_svg_chordRadius(Ne){return Ne.radius}function d3_svg_diagonalProjection(Ne){return[Ne.x,Ne.y]}function d3_svg_diagonalRadialProjection(Ne){return function(){var Ge=Ne.apply(this,arguments),Qe=Ge[0],tt=Ge[1]-zn;return[Qe*Math.cos(tt),Qe*Math.sin(tt)]}}function d3_svg_symbolSize(){return 64}function d3_svg_symbolType(){return"circle"}function d3_svg_symbolCircle(Ne){var Ge=Math.sqrt(Ne/Pn);return"M0,"+Ge+"A"+Ge+","+Ge+" 0 1,1 0,"+-Ge+"A"+Ge+","+Ge+" 0 1,1 0,"+Ge+"Z"}Ne.svg.line.radial=function(){var Ne=d3_svg_line(d3_svg_lineRadial);return Ne.radius=Ne.x,delete Ne.x,Ne.angle=Ne.y,delete Ne.y,Ne},d3_svg_lineStepBefore.reverse=d3_svg_lineStepAfter,d3_svg_lineStepAfter.reverse=d3_svg_lineStepBefore,Ne.svg.area=function(){return d3_svg_area(d3_identity)},Ne.svg.area.radial=function(){var Ne=d3_svg_area(d3_svg_lineRadial);return Ne.radius=Ne.x,delete Ne.x,Ne.innerRadius=Ne.x0,delete Ne.x0,Ne.outerRadius=Ne.x1,delete Ne.x1,Ne.angle=Ne.y,delete Ne.y,Ne.startAngle=Ne.y0,delete Ne.y0,Ne.endAngle=Ne.y1,delete Ne.y1,Ne},Ne.svg.chord=function(){var Ne=d3_source,Ge=d3_target,Qe=d3_svg_chordRadius,tt=d3_svg_arcStartAngle,rt=d3_svg_arcEndAngle;function chord(Qe,tt){var rt=subgroup(this,Ne,Qe,tt),nt=subgroup(this,Ge,Qe,tt);return"M"+rt.p0+arc(rt.r,rt.p1,rt.a1-rt.a0)+(equals(rt,nt)?curve(rt.r,rt.p1,rt.r,rt.p0):curve(rt.r,rt.p1,nt.r,nt.p0)+arc(nt.r,nt.p1,nt.a1-nt.a0)+curve(nt.r,nt.p1,rt.r,rt.p0))+"Z"}function subgroup(Ne,Ge,nt,at){var it=Ge.call(Ne,nt,at),ot=Qe.call(Ne,it,at),dt=tt.call(Ne,it,at)-zn,ht=rt.call(Ne,it,at)-zn;return{r:ot,a0:dt,a1:ht,p0:[ot*Math.cos(dt),ot*Math.sin(dt)],p1:[ot*Math.cos(ht),ot*Math.sin(ht)]}}function equals(Ne,Ge){return Ne.a0==Ge.a0&&Ne.a1==Ge.a1}function arc(Ne,Ge,Qe){return"A"+Ne+","+Ne+" 0 "+ +(Qe>Pn)+",1 "+Ge}function curve(Ne,Ge,Qe,tt){return"Q 0,0 "+tt}return chord.radius=function(Ne){return arguments.length?(Qe=d3_functor(Ne),chord):Qe},chord.source=function(Ge){return arguments.length?(Ne=d3_functor(Ge),chord):Ne},chord.target=function(Ne){return arguments.length?(Ge=d3_functor(Ne),chord):Ge},chord.startAngle=function(Ne){return arguments.length?(tt=d3_functor(Ne),chord):tt},chord.endAngle=function(Ne){return arguments.length?(rt=d3_functor(Ne),chord):rt},chord},Ne.svg.diagonal=function(){var Ne=d3_source,Ge=d3_target,Qe=d3_svg_diagonalProjection;function diagonal(tt,rt){var nt=Ne.call(this,tt,rt),at=Ge.call(this,tt,rt),it=(nt.y+at.y)/2,ot=[nt,{x:nt.x,y:it},{x:at.x,y:it},at];return"M"+(ot=ot.map(Qe))[0]+"C"+ot[1]+" "+ot[2]+" "+ot[3]}return diagonal.source=function(Ge){return arguments.length?(Ne=d3_functor(Ge),diagonal):Ne},diagonal.target=function(Ne){return arguments.length?(Ge=d3_functor(Ne),diagonal):Ge},diagonal.projection=function(Ne){return arguments.length?(Qe=Ne,diagonal):Qe},diagonal},Ne.svg.diagonal.radial=function(){var Ge=Ne.svg.diagonal(),Qe=d3_svg_diagonalProjection,tt=Ge.projection;return Ge.projection=function(Ne){return arguments.length?tt(d3_svg_diagonalRadialProjection(Qe=Ne)):Qe},Ge},Ne.svg.symbol=function(){var Ne=d3_svg_symbolType,Ge=d3_svg_symbolSize;function symbol(Qe,tt){return(Ic.get(Ne.call(this,Qe,tt))||d3_svg_symbolCircle)(Ge.call(this,Qe,tt))}return symbol.type=function(Ge){return arguments.length?(Ne=d3_functor(Ge),symbol):Ne},symbol.size=function(Ne){return arguments.length?(Ge=d3_functor(Ne),symbol):Ge},symbol};var Ic=Ne.map({circle:d3_svg_symbolCircle,cross:function(Ne){var Ge=Math.sqrt(Ne/5)/2;return"M"+-3*Ge+","+-Ge+"H"+-Ge+"V"+-3*Ge+"H"+Ge+"V"+-Ge+"H"+3*Ge+"V"+Ge+"H"+Ge+"V"+3*Ge+"H"+-Ge+"V"+Ge+"H"+-3*Ge+"Z"},diamond:function(Ne){var Ge=Math.sqrt(Ne/(2*zc)),Qe=Ge*zc;return"M0,"+-Ge+"L"+Qe+",0 0,"+Ge+" "+-Qe+",0Z"},square:function(Ne){var Ge=Math.sqrt(Ne)/2;return"M"+-Ge+","+-Ge+"L"+Ge+","+-Ge+" "+Ge+","+Ge+" "+-Ge+","+Ge+"Z"},"triangle-down":function(Ne){var Ge=Math.sqrt(Ne/Oc),Qe=Ge*Oc/2;return"M0,"+Qe+"L"+Ge+","+-Qe+" "+-Ge+","+-Qe+"Z"},"triangle-up":function(Ne){var Ge=Math.sqrt(Ne/Oc),Qe=Ge*Oc/2;return"M0,"+-Qe+"L"+Ge+","+Qe+" "+-Ge+","+Qe+"Z"}});Ne.svg.symbolTypes=Ic.keys();var Oc=Math.sqrt(3),zc=Math.tan(30*Bn);mr.transition=function(Ne){for(var Ge,Qe,tt=Bc||++jc,rt=d3_transitionNamespace(Ne),nt=[],at=Fc||{time:Date.now(),ease:d3_ease_cubicInOut,delay:0,duration:250},it=-1,ot=this.length;++it<ot;){nt.push(Ge=[]);for(var dt=this[it],ht=-1,Dt=dt.length;++ht<Dt;)(Qe=dt[ht])&&d3_transitionNode(Qe,ht,rt,tt,at),Ge.push(Qe)}return d3_transition(nt,rt,tt)},mr.interrupt=function(Ne){return this.each(null==Ne?Rc:d3_selection_interruptNS(d3_transitionNamespace(Ne)))};var Rc=d3_selection_interruptNS(d3_transitionNamespace());function d3_selection_interruptNS(Ne){return function(){var Ge,Qe,tt;(Ge=this[Ne])&&(tt=Ge[Qe=Ge.active])&&(tt.timer.c=null,tt.timer.t=NaN,--Ge.count?delete Ge[Qe]:delete this[Ne],Ge.active+=.5,tt.event&&tt.event.interrupt.call(this,this.__data__,tt.index))}}function d3_transition(Ne,Ge,Qe){return dr(Ne,Nc),Ne.namespace=Ge,Ne.id=Qe,Ne}var Bc,Fc,Nc=[],jc=0;function d3_transition_tween(Ne,Ge,Qe,tt){var rt=Ne.id,nt=Ne.namespace;return d3_selection_each(Ne,"function"==typeof Qe?function(Ne,at,it){Ne[nt][rt].tween.set(Ge,tt(Qe.call(Ne,Ne.__data__,at,it)))}:(Qe=tt(Qe),function(Ne){Ne[nt][rt].tween.set(Ge,Qe)}))}function d3_transition_text(Ne){return null==Ne&&(Ne=""),function(){this.textContent=Ne}}function d3_transitionNamespace(Ne){return null==Ne?"__transition__":"__transition_"+Ne+"__"}function d3_transitionNode(Ne,Ge,Qe,tt,rt){var nt,at,it,ot,dt,ht=Ne[Qe]||(Ne[Qe]={active:0,count:0}),Dt=ht[tt];function schedule(Ne){var Ge=Dt.delay;if(at.t=Ge+nt,Ge<=Ne)return start(Ne-Ge);at.c=start}function start(Qe){var rt=ht.active,Ot=ht[rt];for(var Rt in Ot&&(Ot.timer.c=null,Ot.timer.t=NaN,--ht.count,delete ht[rt],Ot.event&&Ot.event.interrupt.call(Ne,Ne.__data__,Ot.index)),ht)if(+Rt<tt){var Zt=ht[Rt];Zt.timer.c=null,Zt.timer.t=NaN,--ht.count,delete ht[Rt]}at.c=tick,d3_timer((function(){return at.c&&tick(Qe||1)&&(at.c=null,at.t=NaN),1}),0,nt),ht.active=tt,Dt.event&&Dt.event.start.call(Ne,Ne.__data__,Ge),dt=[],Dt.tween.forEach((function(Qe,tt){(tt=tt.call(Ne,Ne.__data__,Ge))&&dt.push(tt)})),ot=Dt.ease,it=Dt.duration}function tick(rt){for(var nt=rt/it,at=ot(nt),Ot=dt.length;Ot>0;)dt[--Ot].call(Ne,at);if(nt>=1)return Dt.event&&Dt.event.end.call(Ne,Ne.__data__,Ge),--ht.count?delete ht[tt]:delete Ne[Qe],1}Dt||(nt=rt.time,at=d3_timer(schedule,0,nt),Dt=ht[tt]={tween:new d3_Map,time:nt,timer:at,delay:rt.delay,duration:rt.duration,ease:rt.ease,index:Ge},rt=null,++ht.count)}Nc.call=mr.call,Nc.empty=mr.empty,Nc.node=mr.node,Nc.size=mr.size,Ne.transition=function(Ge,Qe){return Ge&&Ge.transition?Bc?Ge.transition(Qe):Ge:Ne.selection().transition(Ge)},Ne.transition.prototype=Nc,Nc.select=function(Ne){var Ge,Qe,tt,rt=this.id,nt=this.namespace,at=[];Ne=d3_selection_selector(Ne);for(var it=-1,ot=this.length;++it<ot;){at.push(Ge=[]);for(var dt=this[it],ht=-1,Dt=dt.length;++ht<Dt;)(tt=dt[ht])&&(Qe=Ne.call(tt,tt.__data__,ht,it))?("__data__"in tt&&(Qe.__data__=tt.__data__),d3_transitionNode(Qe,ht,nt,rt,tt[nt][rt]),Ge.push(Qe)):Ge.push(null)}return d3_transition(at,nt,rt)},Nc.selectAll=function(Ne){var Ge,Qe,tt,rt,nt,at=this.id,it=this.namespace,ot=[];Ne=d3_selection_selectorAll(Ne);for(var dt=-1,ht=this.length;++dt<ht;)for(var Dt=this[dt],Ot=-1,Rt=Dt.length;++Ot<Rt;)if(tt=Dt[Ot]){nt=tt[it][at],Qe=Ne.call(tt,tt.__data__,Ot,dt),ot.push(Ge=[]);for(var Zt=-1,er=Qe.length;++Zt<er;)(rt=Qe[Zt])&&d3_transitionNode(rt,Zt,it,at,nt),Ge.push(rt)}return d3_transition(ot,it,at)},Nc.filter=function(Ne){var Ge,Qe,tt=[];"function"!=typeof Ne&&(Ne=d3_selection_filter(Ne));for(var rt=0,nt=this.length;rt<nt;rt++){tt.push(Ge=[]);for(var at,it=0,ot=(at=this[rt]).length;it<ot;it++)(Qe=at[it])&&Ne.call(Qe,Qe.__data__,it,rt)&&Ge.push(Qe)}return d3_transition(tt,this.namespace,this.id)},Nc.tween=function(Ne,Ge){var Qe=this.id,tt=this.namespace;return arguments.length<2?this.node()[tt][Qe].tween.get(Ne):d3_selection_each(this,null==Ge?function(Ge){Ge[tt][Qe].tween.remove(Ne)}:function(rt){rt[tt][Qe].tween.set(Ne,Ge)})},Nc.attr=function(Ge,Qe){if(arguments.length<2){for(Qe in Ge)this.attr(Qe,Ge[Qe]);return this}var tt="transform"==Ge?d3_interpolateTransform:d3_interpolate,rt=Ne.ns.qualify(Ge);function attrNull(){this.removeAttribute(rt)}function attrNullNS(){this.removeAttributeNS(rt.space,rt.local)}function attrTween(Ne){return null==Ne?attrNull:(Ne+="",function(){var Ge,Qe=this.getAttribute(rt);return Qe!==Ne&&(Ge=tt(Qe,Ne),function(Ne){this.setAttribute(rt,Ge(Ne))})})}function attrTweenNS(Ne){return null==Ne?attrNullNS:(Ne+="",function(){var Ge,Qe=this.getAttributeNS(rt.space,rt.local);return Qe!==Ne&&(Ge=tt(Qe,Ne),function(Ne){this.setAttributeNS(rt.space,rt.local,Ge(Ne))})})}return d3_transition_tween(this,"attr."+Ge,Qe,rt.local?attrTweenNS:attrTween)},Nc.attrTween=function(Ge,Qe){var tt=Ne.ns.qualify(Ge);function attrTween(Ne,Ge){var rt=Qe.call(this,Ne,Ge,this.getAttribute(tt));return rt&&function(Ne){this.setAttribute(tt,rt(Ne))}}function attrTweenNS(Ne,Ge){var rt=Qe.call(this,Ne,Ge,this.getAttributeNS(tt.space,tt.local));return rt&&function(Ne){this.setAttributeNS(tt.space,tt.local,rt(Ne))}}return this.tween("attr."+Ge,tt.local?attrTweenNS:attrTween)},Nc.style=function(Ne,Ge,Qe){var tt=arguments.length;if(tt<3){if("string"!=typeof Ne){for(Qe in tt<2&&(Ge=""),Ne)this.style(Qe,Ne[Qe],Ge);return this}Qe=""}function styleNull(){this.style.removeProperty(Ne)}function styleString(Ge){return null==Ge?styleNull:(Ge+="",function(){var tt,rt=d3_window(this).getComputedStyle(this,null).getPropertyValue(Ne);return rt!==Ge&&(tt=d3_interpolate(rt,Ge),function(Ge){this.style.setProperty(Ne,tt(Ge),Qe)})})}return d3_transition_tween(this,"style."+Ne,Ge,styleString)},Nc.styleTween=function(Ne,Ge,Qe){function styleTween(tt,rt){var nt=Ge.call(this,tt,rt,d3_window(this).getComputedStyle(this,null).getPropertyValue(Ne));return nt&&function(Ge){this.style.setProperty(Ne,nt(Ge),Qe)}}return arguments.length<3&&(Qe=""),this.tween("style."+Ne,styleTween)},Nc.text=function(Ne){return d3_transition_tween(this,"text",Ne,d3_transition_text)},Nc.remove=function(){var Ne=this.namespace;return this.each("end.transition",(function(){var Ge;this[Ne].count<2&&(Ge=this.parentNode)&&Ge.removeChild(this)}))},Nc.ease=function(Ge){var Qe=this.id,tt=this.namespace;return arguments.length<1?this.node()[tt][Qe].ease:("function"!=typeof Ge&&(Ge=Ne.ease.apply(Ne,arguments)),d3_selection_each(this,(function(Ne){Ne[tt][Qe].ease=Ge})))},Nc.delay=function(Ne){var Ge=this.id,Qe=this.namespace;return arguments.length<1?this.node()[Qe][Ge].delay:d3_selection_each(this,"function"==typeof Ne?function(tt,rt,nt){tt[Qe][Ge].delay=+Ne.call(tt,tt.__data__,rt,nt)}:(Ne=+Ne,function(tt){tt[Qe][Ge].delay=Ne}))},Nc.duration=function(Ne){var Ge=this.id,Qe=this.namespace;return arguments.length<1?this.node()[Qe][Ge].duration:d3_selection_each(this,"function"==typeof Ne?function(tt,rt,nt){tt[Qe][Ge].duration=Math.max(1,Ne.call(tt,tt.__data__,rt,nt))}:(Ne=Math.max(1,Ne),function(tt){tt[Qe][Ge].duration=Ne}))},Nc.each=function(Ge,Qe){var tt=this.id,rt=this.namespace;if(arguments.length<2){var nt=Fc,at=Bc;try{Bc=tt,d3_selection_each(this,(function(Ne,Qe,nt){Fc=Ne[rt][tt],Ge.call(Ne,Ne.__data__,Qe,nt)}))}finally{Fc=nt,Bc=at}}else d3_selection_each(this,(function(nt){var at=nt[rt][tt];(at.event||(at.event=Ne.dispatch("start","end","interrupt"))).on(Ge,Qe)}));return this},Nc.transition=function(){for(var Ne,Ge,Qe,tt=this.id,rt=++jc,nt=this.namespace,at=[],it=0,ot=this.length;it<ot;it++){at.push(Ne=[]);for(var dt,ht=0,Dt=(dt=this[it]).length;ht<Dt;ht++)(Ge=dt[ht])&&d3_transitionNode(Ge,ht,nt,rt,{time:(Qe=Ge[nt][tt]).time,ease:Qe.ease,delay:Qe.delay+Qe.duration,duration:Qe.duration}),Ne.push(Ge)}return d3_transition(at,nt,rt)},Ne.svg.axis=function(){var Ge,Qe=Ne.scale.linear(),tt=Vc,rt=6,nt=6,at=3,it=[10],ot=null;function axis(dt){dt.each((function(){var dt,ht=Ne.select(this),Dt=this.__chart__||Qe,Ot=this.__chart__=Qe.copy(),Rt=null==ot?Ot.ticks?Ot.ticks.apply(Ot,it):Ot.domain():ot,Zt=null==Ge?Ot.tickFormat?Ot.tickFormat.apply(Ot,it):d3_identity:Ge,er=ht.selectAll(".tick").data(Rt,Ot),dr=er.enter().insert("g",".domain").attr("class","tick").style("opacity",Cn),mr=Ne.transition(er.exit()).style("opacity",Cn).remove(),xr=Ne.transition(er.order()).style("opacity",1),br=Math.max(rt,0)+at,Ar=d3_scaleRange(Ot),en=ht.selectAll(".domain").data([0]),mn=(en.enter().append("path").attr("class","domain"),Ne.transition(en));dr.append("line"),dr.append("text");var xn,kn,En,Pn,Dn=dr.select("line"),In=xr.select("line"),zn=er.select("text").text(Zt),Bn=dr.select("text"),Vn=xr.select("text"),Hn="top"===tt||"left"===tt?-1:1;if("bottom"===tt||"top"===tt?(dt=d3_svg_axisX,xn="x",En="y",kn="x2",Pn="y2",zn.attr("dy",Hn<0?"0em":".71em").style("text-anchor","middle"),mn.attr("d","M"+Ar[0]+","+Hn*nt+"V0H"+Ar[1]+"V"+Hn*nt)):(dt=d3_svg_axisY,xn="y",En="x",kn="y2",Pn="x2",zn.attr("dy",".32em").style("text-anchor",Hn<0?"end":"start"),mn.attr("d","M"+Hn*nt+","+Ar[0]+"H0V"+Ar[1]+"H"+Hn*nt)),Dn.attr(Pn,Hn*rt),Bn.attr(En,Hn*br),In.attr(kn,0).attr(Pn,Hn*rt),Vn.attr(xn,0).attr(En,Hn*br),Ot.rangeBand){var qn=Ot,Yn=qn.rangeBand()/2;Dt=Ot=function(Ne){return qn(Ne)+Yn}}else Dt.rangeBand?Dt=Ot:mr.call(dt,Ot,Dt);dr.call(dt,Dt,Ot),xr.call(dt,Ot,Ot)}))}return axis.scale=function(Ne){return arguments.length?(Qe=Ne,axis):Qe},axis.orient=function(Ne){return arguments.length?(tt=Ne in Uc?Ne+"":Vc,axis):tt},axis.ticks=function(){return arguments.length?(it=d3_array(arguments),axis):it},axis.tickValues=function(Ne){return arguments.length?(ot=Ne,axis):ot},axis.tickFormat=function(Ne){return arguments.length?(Ge=Ne,axis):Ge},axis.tickSize=function(Ne){var Ge=arguments.length;return Ge?(rt=+Ne,nt=+arguments[Ge-1],axis):rt},axis.innerTickSize=function(Ne){return arguments.length?(rt=+Ne,axis):rt},axis.outerTickSize=function(Ne){return arguments.length?(nt=+Ne,axis):nt},axis.tickPadding=function(Ne){return arguments.length?(at=+Ne,axis):at},axis.tickSubdivide=function(){return arguments.length&&axis},axis};var Vc="bottom",Uc={top:1,right:1,bottom:1,left:1};function d3_svg_axisX(Ne,Ge,Qe){Ne.attr("transform",(function(Ne){var tt=Ge(Ne);return"translate("+(isFinite(tt)?tt:Qe(Ne))+",0)"}))}function d3_svg_axisY(Ne,Ge,Qe){Ne.attr("transform",(function(Ne){var tt=Ge(Ne);return"translate(0,"+(isFinite(tt)?tt:Qe(Ne))+")"}))}Ne.svg.brush=function(){var Ge,Qe,tt=d3_eventDispatch(brush,"brushstart","brush","brushend"),rt=null,nt=null,at=[0,0],it=[0,0],ot=!0,dt=!0,ht=qc[0];function brush(Ge){Ge.each((function(){var Ge=Ne.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",brushstart).on("touchstart.brush",brushstart),Qe=Ge.selectAll(".background").data([0]);Qe.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),Ge.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var tt=Ge.selectAll(".resize").data(ht,d3_identity);tt.exit().remove(),tt.enter().append("g").attr("class",(function(Ne){return"resize "+Ne})).style("cursor",(function(Ne){return Hc[Ne]})).append("rect").attr("x",(function(Ne){return/[ew]$/.test(Ne)?-3:null})).attr("y",(function(Ne){return/^[ns]/.test(Ne)?-3:null})).attr("width",6).attr("height",6).style("visibility","hidden"),tt.style("display",brush.empty()?"none":null);var at,it=Ne.transition(Ge),ot=Ne.transition(Qe);rt&&(at=d3_scaleRange(rt),ot.attr("x",at[0]).attr("width",at[1]-at[0]),redrawX(it)),nt&&(at=d3_scaleRange(nt),ot.attr("y",at[0]).attr("height",at[1]-at[0]),redrawY(it)),redraw(it)}))}function redraw(Ne){Ne.selectAll(".resize").attr("transform",(function(Ne){return"translate("+at[+/e$/.test(Ne)]+","+it[+/^s/.test(Ne)]+")"}))}function redrawX(Ne){Ne.select(".extent").attr("x",at[0]),Ne.selectAll(".extent,.n>rect,.s>rect").attr("width",at[1]-at[0])}function redrawY(Ne){Ne.select(".extent").attr("y",it[0]),Ne.selectAll(".extent,.e>rect,.w>rect").attr("height",it[1]-it[0])}function brushstart(){var ht,Dt,Ot=this,Rt=Ne.select(Ne.event.target),Zt=tt.of(Ot,arguments),er=Ne.select(Ot),dr=Rt.datum(),mr=!/^(n|s)$/.test(dr)&&rt,xr=!/^(e|w)$/.test(dr)&&nt,br=Rt.classed("extent"),Ar=d3_event_dragSuppress(Ot),en=Ne.mouse(Ot),mn=Ne.select(d3_window(Ot)).on("keydown.brush",keydown).on("keyup.brush",keyup);if(Ne.event.changedTouches?mn.on("touchmove.brush",brushmove).on("touchend.brush",brushend):mn.on("mousemove.brush",brushmove).on("mouseup.brush",brushend),er.interrupt().selectAll("*").interrupt(),br)en[0]=at[0]-en[0],en[1]=it[0]-en[1];else if(dr){var xn=+/w$/.test(dr),kn=+/^n/.test(dr);Dt=[at[1-xn]-en[0],it[1-kn]-en[1]],en[0]=at[xn],en[1]=it[kn]}else Ne.event.altKey&&(ht=en.slice());function keydown(){32==Ne.event.keyCode&&(br||(ht=null,en[0]-=at[1],en[1]-=it[1],br=2),d3_eventPreventDefault())}function keyup(){32==Ne.event.keyCode&&2==br&&(en[0]+=at[1],en[1]+=it[1],br=0,d3_eventPreventDefault())}function brushmove(){var Ge=Ne.mouse(Ot),Qe=!1;Dt&&(Ge[0]+=Dt[0],Ge[1]+=Dt[1]),br||(Ne.event.altKey?(ht||(ht=[(at[0]+at[1])/2,(it[0]+it[1])/2]),en[0]=at[+(Ge[0]<ht[0])],en[1]=it[+(Ge[1]<ht[1])]):ht=null),mr&&move1(Ge,rt,0)&&(redrawX(er),Qe=!0),xr&&move1(Ge,nt,1)&&(redrawY(er),Qe=!0),Qe&&(redraw(er),Zt({type:"brush",mode:br?"move":"resize"}))}function move1(Ne,tt,rt){var nt,Dt,Ot=d3_scaleRange(tt),Rt=Ot[0],Zt=Ot[1],er=en[rt],dr=rt?it:at,mr=dr[1]-dr[0];if(br&&(Rt-=er,Zt-=mr+er),nt=(rt?dt:ot)?Math.max(Rt,Math.min(Zt,Ne[rt])):Ne[rt],br?Dt=(nt+=er)+mr:(ht&&(er=Math.max(Rt,Math.min(Zt,2*ht[rt]-nt))),er<nt?(Dt=nt,nt=er):Dt=er),dr[0]!=nt||dr[1]!=Dt)return rt?Qe=null:Ge=null,dr[0]=nt,dr[1]=Dt,!0}function brushend(){brushmove(),er.style("pointer-events","all").selectAll(".resize").style("display",brush.empty()?"none":null),Ne.select("body").style("cursor",null),mn.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),Ar(),Zt({type:"brushend"})}er.style("pointer-events","none").selectAll(".resize").style("display",null),Ne.select("body").style("cursor",Rt.style("cursor")),Zt({type:"brushstart"}),brushmove()}return brush.event=function(rt){rt.each((function(){var rt=tt.of(this,arguments),nt={x:at,y:it,i:Ge,j:Qe},ot=this.__chart__||nt;this.__chart__=nt,Bc?Ne.select(this).transition().each("start.brush",(function(){Ge=ot.i,Qe=ot.j,at=ot.x,it=ot.y,rt({type:"brushstart"})})).tween("brush:brush",(function(){var Ne=d3_interpolateArray(at,nt.x),tt=d3_interpolateArray(it,nt.y);return Ge=Qe=null,function(Ge){at=nt.x=Ne(Ge),it=nt.y=tt(Ge),rt({type:"brush",mode:"resize"})}})).each("end.brush",(function(){Ge=nt.i,Qe=nt.j,rt({type:"brush",mode:"resize"}),rt({type:"brushend"})})):(rt({type:"brushstart"}),rt({type:"brush",mode:"resize"}),rt({type:"brushend"}))}))},brush.x=function(Ne){return arguments.length?(ht=qc[!(rt=Ne)<<1|!nt],brush):rt},brush.y=function(Ne){return arguments.length?(ht=qc[!rt<<1|!(nt=Ne)],brush):nt},brush.clamp=function(Ne){return arguments.length?(rt&&nt?(ot=!!Ne[0],dt=!!Ne[1]):rt?ot=!!Ne:nt&&(dt=!!Ne),brush):rt&&nt?[ot,dt]:rt?ot:nt?dt:null},brush.extent=function(Ne){var tt,ot,dt,ht,Dt;return arguments.length?(rt&&(tt=Ne[0],ot=Ne[1],nt&&(tt=tt[0],ot=ot[0]),Ge=[tt,ot],rt.invert&&(tt=rt(tt),ot=rt(ot)),ot<tt&&(Dt=tt,tt=ot,ot=Dt),tt==at[0]&&ot==at[1]||(at=[tt,ot])),nt&&(dt=Ne[0],ht=Ne[1],rt&&(dt=dt[1],ht=ht[1]),Qe=[dt,ht],nt.invert&&(dt=nt(dt),ht=nt(ht)),ht<dt&&(Dt=dt,dt=ht,ht=Dt),dt==it[0]&&ht==it[1]||(it=[dt,ht])),brush):(rt&&(Ge?(tt=Ge[0],ot=Ge[1]):(tt=at[0],ot=at[1],rt.invert&&(tt=rt.invert(tt),ot=rt.invert(ot)),ot<tt&&(Dt=tt,tt=ot,ot=Dt))),nt&&(Qe?(dt=Qe[0],ht=Qe[1]):(dt=it[0],ht=it[1],nt.invert&&(dt=nt.invert(dt),ht=nt.invert(ht)),ht<dt&&(Dt=dt,dt=ht,ht=Dt))),rt&&nt?[[tt,dt],[ot,ht]]:rt?[tt,ot]:nt&&[dt,ht])},brush.clear=function(){return brush.empty()||(at=[0,0],it=[0,0],Ge=Qe=null),brush},brush.empty=function(){return!!rt&&at[0]==at[1]||!!nt&&it[0]==it[1]},Ne.rebind(brush,tt,"on")};var Hc={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},qc=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Gc=is.format=vs.timeFormat,Yc=Gc.utc,Wc=Yc("%Y-%m-%dT%H:%M:%S.%LZ");function d3_time_formatIsoNative(Ne){return Ne.toISOString()}function d3_time_scale(Ge,Qe,tt){function scale(Ne){return Ge(Ne)}function tickMethod(Ge,tt){var rt=(Ge[1]-Ge[0])/tt,nt=Ne.bisect(Xc,rt);return nt==Xc.length?[Qe.year,d3_scale_linearTickRange(Ge.map((function(Ne){return Ne/31536e6})),tt)[2]]:nt?Qe[rt/Xc[nt-1]<Xc[nt]/rt?nt-1:nt]:[Kc,d3_scale_linearTickRange(Ge,tt)[2]]}return scale.invert=function(Ne){return d3_time_scaleDate(Ge.invert(Ne))},scale.domain=function(Ne){return arguments.length?(Ge.domain(Ne),scale):Ge.domain().map(d3_time_scaleDate)},scale.nice=function(Ne,Ge){var Qe=scale.domain(),tt=d3_scaleExtent(Qe),rt=null==Ne?tickMethod(tt,10):"number"==typeof Ne&&tickMethod(tt,Ne);function skipped(Qe){return!isNaN(Qe)&&!Ne.range(Qe,d3_time_scaleDate(+Qe+1),Ge).length}return rt&&(Ne=rt[0],Ge=rt[1]),scale.domain(d3_scale_nice(Qe,Ge>1?{floor:function(Ge){for(;skipped(Ge=Ne.floor(Ge));)Ge=d3_time_scaleDate(Ge-1);return Ge},ceil:function(Ge){for(;skipped(Ge=Ne.ceil(Ge));)Ge=d3_time_scaleDate(+Ge+1);return Ge}}:Ne))},scale.ticks=function(Ne,Ge){var Qe=d3_scaleExtent(scale.domain()),tt=null==Ne?tickMethod(Qe,10):"number"==typeof Ne?tickMethod(Qe,Ne):!Ne.range&&[{range:Ne},Ge];return tt&&(Ne=tt[0],Ge=tt[1]),Ne.range(Qe[0],d3_time_scaleDate(+Qe[1]+1),Ge<1?1:Ge)},scale.tickFormat=function(){return tt},scale.copy=function(){return d3_time_scale(Ge.copy(),Qe,tt)},d3_scale_linearRebind(scale,Ge)}function d3_time_scaleDate(Ne){return new Date(Ne)}Gc.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?d3_time_formatIsoNative:Wc,d3_time_formatIsoNative.parse=function(Ne){var Ge=new Date(Ne);return isNaN(Ge)?null:Ge},d3_time_formatIsoNative.toString=Wc.toString,is.second=d3_time_interval((function(Ne){return new os(1e3*Math.floor(Ne/1e3))}),(function(Ne,Ge){Ne.setTime(Ne.getTime()+1e3*Math.floor(Ge))}),(function(Ne){return Ne.getSeconds()})),is.seconds=is.second.range,is.seconds.utc=is.second.utc.range,is.minute=d3_time_interval((function(Ne){return new os(6e4*Math.floor(Ne/6e4))}),(function(Ne,Ge){Ne.setTime(Ne.getTime()+6e4*Math.floor(Ge))}),(function(Ne){return Ne.getMinutes()})),is.minutes=is.minute.range,is.minutes.utc=is.minute.utc.range,is.hour=d3_time_interval((function(Ne){var Ge=Ne.getTimezoneOffset()/60;return new os(36e5*(Math.floor(Ne/36e5-Ge)+Ge))}),(function(Ne,Ge){Ne.setTime(Ne.getTime()+36e5*Math.floor(Ge))}),(function(Ne){return Ne.getHours()})),is.hours=is.hour.range,is.hours.utc=is.hour.utc.range,is.month=d3_time_interval((function(Ne){return(Ne=is.day(Ne)).setDate(1),Ne}),(function(Ne,Ge){Ne.setMonth(Ne.getMonth()+Ge)}),(function(Ne){return Ne.getMonth()})),is.months=is.month.range,is.months.utc=is.month.utc.range;var Xc=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Zc=[[is.second,1],[is.second,5],[is.second,15],[is.second,30],[is.minute,1],[is.minute,5],[is.minute,15],[is.minute,30],[is.hour,1],[is.hour,3],[is.hour,6],[is.hour,12],[is.day,1],[is.day,2],[is.week,1],[is.month,1],[is.month,3],[is.year,1]],Jc=Gc.multi([[".%L",function(Ne){return Ne.getMilliseconds()}],[":%S",function(Ne){return Ne.getSeconds()}],["%I:%M",function(Ne){return Ne.getMinutes()}],["%I %p",function(Ne){return Ne.getHours()}],["%a %d",function(Ne){return Ne.getDay()&&1!=Ne.getDate()}],["%b %d",function(Ne){return 1!=Ne.getDate()}],["%B",function(Ne){return Ne.getMonth()}],["%Y",d3_true]]),Kc={range:function(Ge,Qe,tt){return Ne.range(Math.ceil(Ge/tt)*tt,+Qe,tt).map(d3_time_scaleDate)},floor:d3_identity,ceil:d3_identity};Zc.year=is.year,is.scale=function(){return d3_time_scale(Ne.scale.linear(),Zc,Jc)};var $c=Zc.map((function(Ne){return[Ne[0].utc,Ne[1]]})),Qc=Yc.multi([[".%L",function(Ne){return Ne.getUTCMilliseconds()}],[":%S",function(Ne){return Ne.getUTCSeconds()}],["%I:%M",function(Ne){return Ne.getUTCMinutes()}],["%I %p",function(Ne){return Ne.getUTCHours()}],["%a %d",function(Ne){return Ne.getUTCDay()&&1!=Ne.getUTCDate()}],["%b %d",function(Ne){return 1!=Ne.getUTCDate()}],["%B",function(Ne){return Ne.getUTCMonth()}],["%Y",d3_true]]);function d3_json(Ne){return JSON.parse(Ne.responseText)}function d3_html(Ne){var Ge=rt.createRange();return Ge.selectNode(rt.body),Ge.createContextualFragment(Ne.responseText)}$c.year=is.year.utc,is.scale.utc=function(){return d3_time_scale(Ne.scale.linear(),$c,Qc)},Ne.text=d3_xhrType((function(Ne){return Ne.responseText})),Ne.json=function(Ne,Ge){return d3_xhr(Ne,"application/json",d3_json,Ge)},Ne.html=function(Ne,Ge){return d3_xhr(Ne,"text/html",d3_html,Ge)},Ne.xml=d3_xhrType((function(Ne){return Ne.responseXML})),"function"==typeof tt&&tt.amd?(this.d3=Ne,tt(Ne)):"object"==typeof Ge&&Ge.exports?Ge.exports=Ne:this.d3=Ne}()},{}],170:[function(Ne,Ge,Qe){Ge.exports=function(){for(var Ne=0;Ne<arguments.length;Ne++)if(void 0!==arguments[Ne])return arguments[Ne]}},{}],171:[function(Ne,Ge,Qe){"use strict";var tt=Ne("incremental-convex-hull"),rt=Ne("uniq");function LiftedPoint(Ne,Ge){this.point=Ne,this.index=Ge}function compareLifted(Ne,Ge){for(var Qe=Ne.point,tt=Ge.point,rt=Qe.length,nt=0;nt<rt;++nt){var at=tt[nt]-Qe[nt];if(at)return at}return 0}function triangulate1D(Ne,Ge,Qe){if(1===Ne)return Qe?[[-1,0]]:[];var tt=Ge.map((function(Ne,Ge){return[Ne[0],Ge]}));tt.sort((function(Ne,Ge){return Ne[0]-Ge[0]}));for(var rt=new Array(Ne-1),nt=1;nt<Ne;++nt){var at=tt[nt-1],it=tt[nt];rt[nt-1]=[at[1],it[1]]}return Qe&&rt.push([-1,rt[0][1]],[rt[Ne-1][1],-1]),rt}function triangulate(Ne,Ge){var Qe=Ne.length;if(0===Qe)return[];var nt=Ne[0].length;if(nt<1)return[];if(1===nt)return triangulate1D(Qe,Ne,Ge);for(var at=new Array(Qe),it=1,ot=0;ot<Qe;++ot){for(var dt=Ne[ot],ht=new Array(nt+1),Dt=0,Ot=0;Ot<nt;++Ot){var Rt=dt[Ot];ht[Ot]=Rt,Dt+=Rt*Rt}ht[nt]=Dt,at[ot]=new LiftedPoint(ht,ot),it=Math.max(Dt,it)}rt(at,compareLifted),Qe=at.length;var Zt=new Array(Qe+nt+1),er=new Array(Qe+nt+1),dr=(nt+1)*(nt+1)*it,mr=new Array(nt+1);for(ot=0;ot<=nt;++ot)mr[ot]=0;for(mr[nt]=dr,Zt[0]=mr.slice(),er[0]=-1,ot=0;ot<=nt;++ot)(ht=mr.slice())[ot]=1,Zt[ot+1]=ht,er[ot+1]=-1;for(ot=0;ot<Qe;++ot){var xr=at[ot];Zt[ot+nt+1]=xr.point,er[ot+nt+1]=xr.index}var br=tt(Zt,!1);if(br=Ge?br.filter((function(Ne){for(var Ge=0,Qe=0;Qe<=nt;++Qe){var tt=er[Ne[Qe]];if(tt<0&&++Ge>=2)return!1;Ne[Qe]=tt}return!0})):br.filter((function(Ne){for(var Ge=0;Ge<=nt;++Ge){var Qe=er[Ne[Ge]];if(Qe<0)return!1;Ne[Ge]=Qe}return!0})),1&nt)for(ot=0;ot<br.length;++ot)ht=(xr=br[ot])[0],xr[0]=xr[1],xr[1]=ht;return br}Ge.exports=triangulate},{"incremental-convex-hull":459,uniq:597}],172:[function(Ne,Ge,Qe){"use strict";Ge.exports=kerning;var tt=(kerning.canvas=document.createElement("canvas")).getContext("2d"),rt=createPairs([32,126]);function kerning(Ne,Ge){Array.isArray(Ne)&&(Ne=Ne.join(", "));var Qe,nt={},at=16,it=.05;Ge&&(2===Ge.length&&"number"==typeof Ge[0]?Qe=createPairs(Ge):Array.isArray(Ge)?Qe=Ge:(Ge.o?Qe=createPairs(Ge.o):Ge.pairs&&(Qe=Ge.pairs),Ge.fontSize&&(at=Ge.fontSize),null!=Ge.threshold&&(it=Ge.threshold))),Qe||(Qe=rt),tt.font=at+"px "+Ne;for(var ot=0;ot<Qe.length;ot++){var dt=Qe[ot],ht=tt.measureText(dt[0]).width+tt.measureText(dt[1]).width,Dt=tt.measureText(dt).width;if(Math.abs(ht-Dt)>at*it){var Ot=(Dt-ht)/at;nt[dt]=1e3*Ot}}return nt}function createPairs(Ne){for(var Ge=[],Qe=Ne[0];Qe<=Ne[1];Qe++)for(var tt=String.fromCharCode(Qe),rt=Ne[0];rt<Ne[1];rt++){var nt=tt+String.fromCharCode(rt);Ge.push(nt)}return Ge}kerning.createPairs=createPairs,kerning.ascii=rt},{}],173:[function(Ne,Ge,Qe){(function(Ne){(function(){var Qe=!1;if("undefined"!=typeof Float64Array){var tt=new Float64Array(1),rt=new Uint32Array(tt.buffer);if(tt[0]=1,Qe=!0,1072693248===rt[1]){function toDoubleLE(Ne,Ge){return rt[0]=Ne,rt[1]=Ge,tt[0]}function lowUintLE(Ne){return tt[0]=Ne,rt[0]}function highUintLE(Ne){return tt[0]=Ne,rt[1]}Ge.exports=function(Ne){return tt[0]=Ne,[rt[0],rt[1]]},Ge.exports.pack=toDoubleLE,Ge.exports.lo=lowUintLE,Ge.exports.hi=highUintLE}else if(1072693248===rt[0]){function toDoubleBE(Ne,Ge){return rt[1]=Ne,rt[0]=Ge,tt[0]}function lowUintBE(Ne){return tt[0]=Ne,rt[1]}function highUintBE(Ne){return tt[0]=Ne,rt[0]}Ge.exports=function(Ne){return tt[0]=Ne,[rt[1],rt[0]]},Ge.exports.pack=toDoubleBE,Ge.exports.lo=lowUintBE,Ge.exports.hi=highUintBE}else Qe=!1}if(!Qe){var nt=new Ne(8);function toDouble(Ne,Ge){return nt.writeUInt32LE(Ne,0,!0),nt.writeUInt32LE(Ge,4,!0),nt.readDoubleLE(0,!0)}function lowUint(Ne){return nt.writeDoubleLE(Ne,0,!0),nt.readUInt32LE(0,!0)}function highUint(Ne){return nt.writeDoubleLE(Ne,0,!0),nt.readUInt32LE(4,!0)}Ge.exports=function(Ne){return nt.writeDoubleLE(Ne,0,!0),[nt.readUInt32LE(0,!0),nt.readUInt32LE(4,!0)]},Ge.exports.pack=toDouble,Ge.exports.lo=lowUint,Ge.exports.hi=highUint}Ge.exports.sign=function(Ne){return Ge.exports.hi(Ne)>>>31},Ge.exports.exponent=function(Ne){return(Ge.exports.hi(Ne)<<1>>>21)-1023},Ge.exports.fraction=function(Ne){var Qe=Ge.exports.lo(Ne),tt=Ge.exports.hi(Ne),rt=1048575&tt;return 2146435072&tt&&(rt+=1<<20),[Qe,rt]},Ge.exports.denormalized=function(Ne){return!(2146435072&Ge.exports.hi(Ne))}}).call(this)}).call(this,Ne("buffer").Buffer)},{buffer:111}],174:[function(Ne,Ge,Qe){var tt=Ne("abs-svg-path"),rt=Ne("normalize-svg-path"),nt={M:"moveTo",C:"bezierCurveTo"};Ge.exports=function(Ne,Ge){Ne.beginPath(),rt(tt(Ge)).forEach((function(Ge){var Qe=Ge[0],tt=Ge.slice(1);Ne[nt[Qe]].apply(Ne,tt)})),Ne.closePath()}},{"abs-svg-path":65,"normalize-svg-path":497}],175:[function(Ne,Ge,Qe){Ge.exports=function(Ne){switch(Ne){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],176:[function(Ne,Ge,Qe){"use strict";function dupe_array(Ne,Ge,Qe){var tt=0|Ne[Qe];if(tt<=0)return[];var rt,nt=new Array(tt);if(Qe===Ne.length-1)for(rt=0;rt<tt;++rt)nt[rt]=Ge;else for(rt=0;rt<tt;++rt)nt[rt]=dupe_array(Ne,Ge,Qe+1);return nt}function dupe_number(Ne,Ge){var Qe,tt;for(Qe=new Array(Ne),tt=0;tt<Ne;++tt)Qe[tt]=Ge;return Qe}function dupe(Ne,Ge){switch(void 0===Ge&&(Ge=0),typeof Ne){case"number":if(Ne>0)return dupe_number(0|Ne,Ge);break;case"object":if("number"==typeof Ne.length)return dupe_array(Ne,Ge,0)}return[]}Ge.exports=dupe},{}],177:[function(Ne,Ge,Qe){"use strict";function earcut(Ne,Ge,Qe){Qe=Qe||2;var tt,rt,nt,at,it,ot,dt,ht=Ge&&Ge.length,Dt=ht?Ge[0]*Qe:Ne.length,Ot=linkedList(Ne,0,Dt,Qe,!0),Rt=[];if(!Ot||Ot.next===Ot.prev)return Rt;if(ht&&(Ot=eliminateHoles(Ne,Ge,Ot,Qe)),Ne.length>80*Qe){tt=nt=Ne[0],rt=at=Ne[1];for(var Zt=Qe;Zt<Dt;Zt+=Qe)(it=Ne[Zt])<tt&&(tt=it),(ot=Ne[Zt+1])<rt&&(rt=ot),it>nt&&(nt=it),ot>at&&(at=ot);dt=0!==(dt=Math.max(nt-tt,at-rt))?1/dt:0}return earcutLinked(Ot,Rt,Qe,tt,rt,dt),Rt}function linkedList(Ne,Ge,Qe,tt,rt){var nt,at;if(rt===signedArea(Ne,Ge,Qe,tt)>0)for(nt=Ge;nt<Qe;nt+=tt)at=insertNode(nt,Ne[nt],Ne[nt+1],at);else for(nt=Qe-tt;nt>=Ge;nt-=tt)at=insertNode(nt,Ne[nt],Ne[nt+1],at);return at&&equals(at,at.next)&&(removeNode(at),at=at.next),at}function filterPoints(Ne,Ge){if(!Ne)return Ne;Ge||(Ge=Ne);var Qe,tt=Ne;do{if(Qe=!1,tt.steiner||!equals(tt,tt.next)&&0!==area(tt.prev,tt,tt.next))tt=tt.next;else{if(removeNode(tt),(tt=Ge=tt.prev)===tt.next)break;Qe=!0}}while(Qe||tt!==Ge);return Ge}function earcutLinked(Ne,Ge,Qe,tt,rt,nt,at){if(Ne){!at&&nt&&indexCurve(Ne,tt,rt,nt);for(var it,ot,dt=Ne;Ne.prev!==Ne.next;)if(it=Ne.prev,ot=Ne.next,nt?isEarHashed(Ne,tt,rt,nt):isEar(Ne))Ge.push(it.i/Qe),Ge.push(Ne.i/Qe),Ge.push(ot.i/Qe),removeNode(Ne),Ne=ot.next,dt=ot.next;else if((Ne=ot)===dt){at?1===at?earcutLinked(Ne=cureLocalIntersections(filterPoints(Ne),Ge,Qe),Ge,Qe,tt,rt,nt,2):2===at&&splitEarcut(Ne,Ge,Qe,tt,rt,nt):earcutLinked(filterPoints(Ne),Ge,Qe,tt,rt,nt,1);break}}}function isEar(Ne){var Ge=Ne.prev,Qe=Ne,tt=Ne.next;if(area(Ge,Qe,tt)>=0)return!1;for(var rt=Ne.next.next;rt!==Ne.prev;){if(pointInTriangle(Ge.x,Ge.y,Qe.x,Qe.y,tt.x,tt.y,rt.x,rt.y)&&area(rt.prev,rt,rt.next)>=0)return!1;rt=rt.next}return!0}function isEarHashed(Ne,Ge,Qe,tt){var rt=Ne.prev,nt=Ne,at=Ne.next;if(area(rt,nt,at)>=0)return!1;for(var it=rt.x<nt.x?rt.x<at.x?rt.x:at.x:nt.x<at.x?nt.x:at.x,ot=rt.y<nt.y?rt.y<at.y?rt.y:at.y:nt.y<at.y?nt.y:at.y,dt=rt.x>nt.x?rt.x>at.x?rt.x:at.x:nt.x>at.x?nt.x:at.x,ht=rt.y>nt.y?rt.y>at.y?rt.y:at.y:nt.y>at.y?nt.y:at.y,Dt=zOrder(it,ot,Ge,Qe,tt),Ot=zOrder(dt,ht,Ge,Qe,tt),Rt=Ne.prevZ,Zt=Ne.nextZ;Rt&&Rt.z>=Dt&&Zt&&Zt.z<=Ot;){if(Rt!==Ne.prev&&Rt!==Ne.next&&pointInTriangle(rt.x,rt.y,nt.x,nt.y,at.x,at.y,Rt.x,Rt.y)&&area(Rt.prev,Rt,Rt.next)>=0)return!1;if(Rt=Rt.prevZ,Zt!==Ne.prev&&Zt!==Ne.next&&pointInTriangle(rt.x,rt.y,nt.x,nt.y,at.x,at.y,Zt.x,Zt.y)&&area(Zt.prev,Zt,Zt.next)>=0)return!1;Zt=Zt.nextZ}for(;Rt&&Rt.z>=Dt;){if(Rt!==Ne.prev&&Rt!==Ne.next&&pointInTriangle(rt.x,rt.y,nt.x,nt.y,at.x,at.y,Rt.x,Rt.y)&&area(Rt.prev,Rt,Rt.next)>=0)return!1;Rt=Rt.prevZ}for(;Zt&&Zt.z<=Ot;){if(Zt!==Ne.prev&&Zt!==Ne.next&&pointInTriangle(rt.x,rt.y,nt.x,nt.y,at.x,at.y,Zt.x,Zt.y)&&area(Zt.prev,Zt,Zt.next)>=0)return!1;Zt=Zt.nextZ}return!0}function cureLocalIntersections(Ne,Ge,Qe){var tt=Ne;do{var rt=tt.prev,nt=tt.next.next;!equals(rt,nt)&&intersects(rt,tt,tt.next,nt)&&locallyInside(rt,nt)&&locallyInside(nt,rt)&&(Ge.push(rt.i/Qe),Ge.push(tt.i/Qe),Ge.push(nt.i/Qe),removeNode(tt),removeNode(tt.next),tt=Ne=nt),tt=tt.next}while(tt!==Ne);return filterPoints(tt)}function splitEarcut(Ne,Ge,Qe,tt,rt,nt){var at=Ne;do{for(var it=at.next.next;it!==at.prev;){if(at.i!==it.i&&isValidDiagonal(at,it)){var ot=splitPolygon(at,it);return at=filterPoints(at,at.next),ot=filterPoints(ot,ot.next),earcutLinked(at,Ge,Qe,tt,rt,nt),void earcutLinked(ot,Ge,Qe,tt,rt,nt)}it=it.next}at=at.next}while(at!==Ne)}function eliminateHoles(Ne,Ge,Qe,tt){var rt,nt,at,it=[];for(rt=0,nt=Ge.length;rt<nt;rt++)(at=linkedList(Ne,Ge[rt]*tt,rt<nt-1?Ge[rt+1]*tt:Ne.length,tt,!1))===at.next&&(at.steiner=!0),it.push(getLeftmost(at));for(it.sort(compareX),rt=0;rt<it.length;rt++)eliminateHole(it[rt],Qe),Qe=filterPoints(Qe,Qe.next);return Qe}function compareX(Ne,Ge){return Ne.x-Ge.x}function eliminateHole(Ne,Ge){if(Ge=findHoleBridge(Ne,Ge)){var Qe=splitPolygon(Ge,Ne);filterPoints(Ge,Ge.next),filterPoints(Qe,Qe.next)}}function findHoleBridge(Ne,Ge){var Qe,tt=Ge,rt=Ne.x,nt=Ne.y,at=-1/0;do{if(nt<=tt.y&&nt>=tt.next.y&&tt.next.y!==tt.y){var it=tt.x+(nt-tt.y)*(tt.next.x-tt.x)/(tt.next.y-tt.y);if(it<=rt&&it>at){if(at=it,it===rt){if(nt===tt.y)return tt;if(nt===tt.next.y)return tt.next}Qe=tt.x<tt.next.x?tt:tt.next}}tt=tt.next}while(tt!==Ge);if(!Qe)return null;if(rt===at)return Qe;var ot,dt=Qe,ht=Qe.x,Dt=Qe.y,Ot=1/0;tt=Qe;do{rt>=tt.x&&tt.x>=ht&&rt!==tt.x&&pointInTriangle(nt<Dt?rt:at,nt,ht,Dt,nt<Dt?at:rt,nt,tt.x,tt.y)&&(ot=Math.abs(nt-tt.y)/(rt-tt.x),locallyInside(tt,Ne)&&(ot<Ot||ot===Ot&&(tt.x>Qe.x||tt.x===Qe.x&&sectorContainsSector(Qe,tt)))&&(Qe=tt,Ot=ot)),tt=tt.next}while(tt!==dt);return Qe}function sectorContainsSector(Ne,Ge){return area(Ne.prev,Ne,Ge.prev)<0&&area(Ge.next,Ne,Ne.next)<0}function indexCurve(Ne,Ge,Qe,tt){var rt=Ne;do{null===rt.z&&(rt.z=zOrder(rt.x,rt.y,Ge,Qe,tt)),rt.prevZ=rt.prev,rt.nextZ=rt.next,rt=rt.next}while(rt!==Ne);rt.prevZ.nextZ=null,rt.prevZ=null,sortLinked(rt)}function sortLinked(Ne){var Ge,Qe,tt,rt,nt,at,it,ot,dt=1;do{for(Qe=Ne,Ne=null,nt=null,at=0;Qe;){for(at++,tt=Qe,it=0,Ge=0;Ge<dt&&(it++,tt=tt.nextZ);Ge++);for(ot=dt;it>0||ot>0&&tt;)0!==it&&(0===ot||!tt||Qe.z<=tt.z)?(rt=Qe,Qe=Qe.nextZ,it--):(rt=tt,tt=tt.nextZ,ot--),nt?nt.nextZ=rt:Ne=rt,rt.prevZ=nt,nt=rt;Qe=tt}nt.nextZ=null,dt*=2}while(at>1);return Ne}function zOrder(Ne,Ge,Qe,tt,rt){return(Ne=1431655765&((Ne=858993459&((Ne=252645135&((Ne=16711935&((Ne=32767*(Ne-Qe)*rt)|Ne<<8))|Ne<<4))|Ne<<2))|Ne<<1))|(Ge=1431655765&((Ge=858993459&((Ge=252645135&((Ge=16711935&((Ge=32767*(Ge-tt)*rt)|Ge<<8))|Ge<<4))|Ge<<2))|Ge<<1))<<1}function getLeftmost(Ne){var Ge=Ne,Qe=Ne;do{(Ge.x<Qe.x||Ge.x===Qe.x&&Ge.y<Qe.y)&&(Qe=Ge),Ge=Ge.next}while(Ge!==Ne);return Qe}function pointInTriangle(Ne,Ge,Qe,tt,rt,nt,at,it){return(rt-at)*(Ge-it)-(Ne-at)*(nt-it)>=0&&(Ne-at)*(tt-it)-(Qe-at)*(Ge-it)>=0&&(Qe-at)*(nt-it)-(rt-at)*(tt-it)>=0}function isValidDiagonal(Ne,Ge){return Ne.next.i!==Ge.i&&Ne.prev.i!==Ge.i&&!intersectsPolygon(Ne,Ge)&&(locallyInside(Ne,Ge)&&locallyInside(Ge,Ne)&&middleInside(Ne,Ge)&&(area(Ne.prev,Ne,Ge.prev)||area(Ne,Ge.prev,Ge))||equals(Ne,Ge)&&area(Ne.prev,Ne,Ne.next)>0&&area(Ge.prev,Ge,Ge.next)>0)}function area(Ne,Ge,Qe){return(Ge.y-Ne.y)*(Qe.x-Ge.x)-(Ge.x-Ne.x)*(Qe.y-Ge.y)}function equals(Ne,Ge){return Ne.x===Ge.x&&Ne.y===Ge.y}function intersects(Ne,Ge,Qe,tt){var rt=sign(area(Ne,Ge,Qe)),nt=sign(area(Ne,Ge,tt)),at=sign(area(Qe,tt,Ne)),it=sign(area(Qe,tt,Ge));return rt!==nt&&at!==it||!(0!==rt||!onSegment(Ne,Qe,Ge))||!(0!==nt||!onSegment(Ne,tt,Ge))||!(0!==at||!onSegment(Qe,Ne,tt))||!(0!==it||!onSegment(Qe,Ge,tt))}function onSegment(Ne,Ge,Qe){return Ge.x<=Math.max(Ne.x,Qe.x)&&Ge.x>=Math.min(Ne.x,Qe.x)&&Ge.y<=Math.max(Ne.y,Qe.y)&&Ge.y>=Math.min(Ne.y,Qe.y)}function sign(Ne){return Ne>0?1:Ne<0?-1:0}function intersectsPolygon(Ne,Ge){var Qe=Ne;do{if(Qe.i!==Ne.i&&Qe.next.i!==Ne.i&&Qe.i!==Ge.i&&Qe.next.i!==Ge.i&&intersects(Qe,Qe.next,Ne,Ge))return!0;Qe=Qe.next}while(Qe!==Ne);return!1}function locallyInside(Ne,Ge){return area(Ne.prev,Ne,Ne.next)<0?area(Ne,Ge,Ne.next)>=0&&area(Ne,Ne.prev,Ge)>=0:area(Ne,Ge,Ne.prev)<0||area(Ne,Ne.next,Ge)<0}function middleInside(Ne,Ge){var Qe=Ne,tt=!1,rt=(Ne.x+Ge.x)/2,nt=(Ne.y+Ge.y)/2;do{Qe.y>nt!=Qe.next.y>nt&&Qe.next.y!==Qe.y&&rt<(Qe.next.x-Qe.x)*(nt-Qe.y)/(Qe.next.y-Qe.y)+Qe.x&&(tt=!tt),Qe=Qe.next}while(Qe!==Ne);return tt}function splitPolygon(Ne,Ge){var Qe=new Node(Ne.i,Ne.x,Ne.y),tt=new Node(Ge.i,Ge.x,Ge.y),rt=Ne.next,nt=Ge.prev;return Ne.next=Ge,Ge.prev=Ne,Qe.next=rt,rt.prev=Qe,tt.next=Qe,Qe.prev=tt,nt.next=tt,tt.prev=nt,tt}function insertNode(Ne,Ge,Qe,tt){var rt=new Node(Ne,Ge,Qe);return tt?(rt.next=tt.next,rt.prev=tt,tt.next.prev=rt,tt.next=rt):(rt.prev=rt,rt.next=rt),rt}function removeNode(Ne){Ne.next.prev=Ne.prev,Ne.prev.next=Ne.next,Ne.prevZ&&(Ne.prevZ.nextZ=Ne.nextZ),Ne.nextZ&&(Ne.nextZ.prevZ=Ne.prevZ)}function Node(Ne,Ge,Qe){this.i=Ne,this.x=Ge,this.y=Qe,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(Ne,Ge,Qe,tt){for(var rt=0,nt=Ge,at=Qe-tt;nt<Qe;nt+=tt)rt+=(Ne[at]-Ne[nt])*(Ne[nt+1]+Ne[at+1]),at=nt;return rt}Ge.exports=earcut,Ge.exports.default=earcut,earcut.deviation=function(Ne,Ge,Qe,tt){var rt=Ge&&Ge.length,nt=rt?Ge[0]*Qe:Ne.length,at=Math.abs(signedArea(Ne,0,nt,Qe));if(rt)for(var it=0,ot=Ge.length;it<ot;it++){var dt=Ge[it]*Qe,ht=it<ot-1?Ge[it+1]*Qe:Ne.length;at-=Math.abs(signedArea(Ne,dt,ht,Qe))}var Dt=0;for(it=0;it<tt.length;it+=3){var Ot=tt[it]*Qe,Rt=tt[it+1]*Qe,Zt=tt[it+2]*Qe;Dt+=Math.abs((Ne[Ot]-Ne[Zt])*(Ne[Rt+1]-Ne[Ot+1])-(Ne[Ot]-Ne[Rt])*(Ne[Zt+1]-Ne[Ot+1]))}return 0===at&&0===Dt?0:Math.abs((Dt-at)/at)},earcut.flatten=function(Ne){for(var Ge=Ne[0][0].length,Qe={vertices:[],holes:[],dimensions:Ge},tt=0,rt=0;rt<Ne.length;rt++){for(var nt=0;nt<Ne[rt].length;nt++)for(var at=0;at<Ge;at++)Qe.vertices.push(Ne[rt][nt][at]);rt>0&&(tt+=Ne[rt-1].length,Qe.holes.push(tt))}return Qe}},{}],178:[function(Ne,Ge,Qe){"use strict";Ge.exports=edgeToAdjacency;var tt=Ne("uniq");function edgeToAdjacency(Ne,Ge){var Qe=Ne.length;if("number"!=typeof Ge){Ge=0;for(var rt=0;rt<Qe;++rt){var nt=Ne[rt];Ge=Math.max(Ge,nt[0],nt[1])}Ge=1+(0|Ge)}Ge|=0;var at=new Array(Ge);for(rt=0;rt<Ge;++rt)at[rt]=[];for(rt=0;rt<Qe;++rt)at[(nt=Ne[rt])[0]].push(nt[1]),at[nt[1]].push(nt[0]);for(var it=0;it<Ge;++it)tt(at[it],(function(Ne,Ge){return Ne-Ge}));return at}},{uniq:597}],179:[function(Ne,Ge,Qe){var tt=Ne("strongly-connected-components");Ge.exports=function(Ne,Ge){var Qe,rt=[],nt=[],at=[],it={},ot=[];function unblock(Ne){at[Ne]=!1,it.hasOwnProperty(Ne)&&Object.keys(it[Ne]).forEach((function(Ge){delete it[Ne][Ge],at[Ge]&&unblock(Ge)}))}function circuit(Ne){var Ge,tt,rt=!1;for(nt.push(Ne),at[Ne]=!0,Ge=0;Ge<ot[Ne].length;Ge++)(tt=ot[Ne][Ge])===Qe?(output(Qe,nt),rt=!0):at[tt]||(rt=circuit(tt));if(rt)unblock(Ne);else for(Ge=0;Ge<ot[Ne].length;Ge++){tt=ot[Ne][Ge];var dt=it[tt];dt||(dt={},it[tt]=dt),dt[tt]=!0}return nt.pop(),rt}function output(Ne,Qe){var tt=[].concat(Qe).concat(Ne);Ge?Ge(circuit):rt.push(tt)}function subgraph(Ge){for(var Qe=0;Qe<Ne.length;Qe++)Qe<Ge&&(Ne[Qe]=[]),Ne[Qe]=Ne[Qe].filter((function(Ne){return Ne>=Ge}))}function adjacencyStructureSCC(Ge){subgraph(Ge);for(var Qe,rt=tt(Ne).components.filter((function(Ne){return Ne.length>1})),nt=1/0,at=0;at<rt.length;at++)for(var it=0;it<rt[at].length;it++)rt[at][it]<nt&&(nt=rt[at][it],Qe=at);var ot=rt[Qe];if(!ot)return!1;var dt=Ne.map((function(Ne,Ge){return-1===ot.indexOf(Ge)?[]:Ne.filter((function(Ne){return-1!==ot.indexOf(Ne)}))}));return{leastVertex:nt,adjList:dt}}Qe=0;for(var dt=Ne.length;Qe<dt;){var ht=adjacencyStructureSCC(Qe);if(Qe=ht.leastVertex,ot=ht.adjList){for(var Dt=0;Dt<ot.length;Dt++)for(var Ot=0;Ot<ot[Dt].length;Ot++){var Rt=ot[Dt][Ot];at[+Rt]=!1,it[Rt]={}}circuit(Qe),Qe+=1}else Qe=dt}return Ge?void 0:rt}},{"strongly-connected-components":569}],180:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../object/valid-value");Ge.exports=function(){return tt(this).length=0,this}},{"../../object/valid-value":211}],181:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("./is-implemented")()?Array.from:Ne("./shim")},{"./is-implemented":182,"./shim":183}],182:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(){var Ne,Ge,Qe=Array.from;return"function"==typeof Qe&&(Ge=Qe(Ne=["raz","dwa"]),Boolean(Ge&&Ge!==Ne&&"dwa"===Ge[1]))}},{}],183:[function(Ne,Ge,Qe){"use strict";var tt=Ne("es6-symbol").iterator,rt=Ne("../../function/is-arguments"),nt=Ne("../../function/is-function"),at=Ne("../../number/to-pos-integer"),it=Ne("../../object/valid-callable"),ot=Ne("../../object/valid-value"),dt=Ne("../../object/is-value"),ht=Ne("../../string/is-string"),Dt=Array.isArray,Ot=Function.prototype.call,Rt={configurable:!0,enumerable:!0,writable:!0,value:null},Zt=Object.defineProperty;Ge.exports=function(Ne){var Ge,Qe,er,dr,mr,xr,br,Ar,en,mn,xn=arguments[1],kn=arguments[2];if(Ne=Object(ot(Ne)),dt(xn)&&it(xn),this&&this!==Array&&nt(this))Ge=this;else{if(!xn){if(rt(Ne))return 1!==(mr=Ne.length)?Array.apply(null,Ne):((dr=new Array(1))[0]=Ne[0],dr);if(Dt(Ne)){for(dr=new Array(mr=Ne.length),Qe=0;Qe<mr;++Qe)dr[Qe]=Ne[Qe];return dr}}dr=[]}if(!Dt(Ne))if(void 0!==(en=Ne[tt])){for(br=it(en).call(Ne),Ge&&(dr=new Ge),Ar=br.next(),Qe=0;!Ar.done;)mn=xn?Ot.call(xn,kn,Ar.value,Qe):Ar.value,Ge?(Rt.value=mn,Zt(dr,Qe,Rt)):dr[Qe]=mn,Ar=br.next(),++Qe;mr=Qe}else if(ht(Ne)){for(mr=Ne.length,Ge&&(dr=new Ge),Qe=0,er=0;Qe<mr;++Qe)mn=Ne[Qe],Qe+1<mr&&(xr=mn.charCodeAt(0))>=55296&&xr<=56319&&(mn+=Ne[++Qe]),mn=xn?Ot.call(xn,kn,mn,er):mn,Ge?(Rt.value=mn,Zt(dr,er,Rt)):dr[er]=mn,++er;mr=er}if(void 0===mr)for(mr=at(Ne.length),Ge&&(dr=new Ge(mr)),Qe=0;Qe<mr;++Qe)mn=xn?Ot.call(xn,kn,Ne[Qe],Qe):Ne[Qe],Ge?(Rt.value=mn,Zt(dr,Qe,Rt)):dr[Qe]=mn;return Ge&&(Rt.value=null,dr.length=mr),dr}},{"../../function/is-arguments":184,"../../function/is-function":185,"../../number/to-pos-integer":191,"../../object/is-value":200,"../../object/valid-callable":209,"../../object/valid-value":211,"../../string/is-string":215,"es6-symbol":225}],184:[function(Ne,Ge,Qe){"use strict";var tt=Object.prototype.toString,rt=tt.call(function(){return arguments}());Ge.exports=function(Ne){return tt.call(Ne)===rt}},{}],185:[function(Ne,Ge,Qe){"use strict";var tt=Object.prototype.toString,rt=RegExp.prototype.test.bind(/^[object [A-Za-z0-9]*Function]$/);Ge.exports=function(Ne){return"function"==typeof Ne&&rt(tt.call(Ne))}},{}],186:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(){}},{}],187:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("./is-implemented")()?Math.sign:Ne("./shim")},{"./is-implemented":188,"./shim":189}],188:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(){var Ne=Math.sign;return"function"==typeof Ne&&1===Ne(10)&&-1===Ne(-20)}},{}],189:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne){return Ne=Number(Ne),isNaN(Ne)||0===Ne?Ne:Ne>0?1:-1}},{}],190:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../math/sign"),rt=Math.abs,nt=Math.floor;Ge.exports=function(Ne){return isNaN(Ne)?0:0!==(Ne=Number(Ne))&&isFinite(Ne)?tt(Ne)*nt(rt(Ne)):Ne}},{"../math/sign":187}],191:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./to-integer"),rt=Math.max;Ge.exports=function(Ne){return rt(0,tt(Ne))}},{"./to-integer":190}],192:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./valid-callable"),rt=Ne("./valid-value"),nt=Function.prototype.bind,at=Function.prototype.call,it=Object.keys,ot=Object.prototype.propertyIsEnumerable;Ge.exports=function(Ne,Ge){return function(Qe,dt){var ht,Dt=arguments[2],Ot=arguments[3];return Qe=Object(rt(Qe)),tt(dt),ht=it(Qe),Ot&&ht.sort("function"==typeof Ot?nt.call(Ot,Qe):void 0),"function"!=typeof Ne&&(Ne=ht[Ne]),at.call(Ne,ht,(function(Ne,tt){return ot.call(Qe,Ne)?at.call(dt,Dt,Qe[Ne],Ne,Qe,tt):Ge}))}}},{"./valid-callable":209,"./valid-value":211}],193:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("./is-implemented")()?Object.assign:Ne("./shim")},{"./is-implemented":194,"./shim":195}],194:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(){var Ne,Ge=Object.assign;return"function"==typeof Ge&&(Ge(Ne={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),Ne.foo+Ne.bar+Ne.trzy==="razdwatrzy")}},{}],195:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../keys"),rt=Ne("../valid-value"),nt=Math.max;Ge.exports=function(Ne,Ge){var Qe,at,it,ot=nt(arguments.length,2);for(Ne=Object(rt(Ne)),it=function(tt){try{Ne[tt]=Ge[tt]}catch(Ne){Qe||(Qe=Ne)}},at=1;at<ot;++at)tt(Ge=arguments[at]).forEach(it);if(void 0!==Qe)throw Qe;return Ne}},{"../keys":201,"../valid-value":211}],196:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../array/from"),rt=Ne("./assign"),nt=Ne("./valid-value");Ge.exports=function(Ne){var Ge=Object(nt(Ne)),Qe=arguments[1],at=Object(arguments[2]);if(Ge!==Ne&&!Qe)return Ge;var it={};return Qe?tt(Qe,(function(Ge){(at.ensure||Ge in Ne)&&(it[Ge]=Ne[Ge])})):rt(it,Ne),it}},{"../array/from":181,"./assign":193,"./valid-value":211}],197:[function(Ne,Ge,Qe){"use strict";var tt,rt,nt,at,it=Object.create;Ne("./set-prototype-of/is-implemented")()||(tt=Ne("./set-prototype-of/shim")),Ge.exports=tt?1!==tt.level?it:(rt={},nt={},at={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach((function(Ne){nt[Ne]="__proto__"!==Ne?at:{configurable:!0,enumerable:!1,writable:!0,value:void 0}})),Object.defineProperties(rt,nt),Object.defineProperty(tt,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:rt}),function(Ne,Ge){return it(null===Ne?rt:Ne,Ge)}):it},{"./set-prototype-of/is-implemented":207,"./set-prototype-of/shim":208}],198:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("./_iterate")("forEach")},{"./_iterate":192}],199:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./is-value"),rt={function:!0,object:!0};Ge.exports=function(Ne){return tt(Ne)&&rt[typeof Ne]||!1}},{"./is-value":200}],200:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../function/noop")();Ge.exports=function(Ne){return Ne!==tt&&null!==Ne}},{"../function/noop":186}],201:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("./is-implemented")()?Object.keys:Ne("./shim")},{"./is-implemented":202,"./shim":203}],202:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(){try{return Object.keys("primitive"),!0}catch(Ne){return!1}}},{}],203:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../is-value"),rt=Object.keys;Ge.exports=function(Ne){return rt(tt(Ne)?Object(Ne):Ne)}},{"../is-value":200}],204:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./valid-callable"),rt=Ne("./for-each"),nt=Function.prototype.call;Ge.exports=function(Ne,Ge){var Qe={},at=arguments[2];return tt(Ge),rt(Ne,(function(Ne,tt,rt,it){Qe[tt]=nt.call(Ge,at,Ne,tt,rt,it)})),Qe}},{"./for-each":198,"./valid-callable":209}],205:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./is-value"),rt=Array.prototype.forEach,nt=Object.create,process=function(Ne,Ge){var Qe;for(Qe in Ne)Ge[Qe]=Ne[Qe]};Ge.exports=function(Ne){var Ge=nt(null);return rt.call(arguments,(function(Ne){tt(Ne)&&process(Object(Ne),Ge)})),Ge}},{"./is-value":200}],206:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("./is-implemented")()?Object.setPrototypeOf:Ne("./shim")},{"./is-implemented":207,"./shim":208}],207:[function(Ne,Ge,Qe){"use strict";var tt=Object.create,rt=Object.getPrototypeOf,nt={};Ge.exports=function(){var Ne=Object.setPrototypeOf;return"function"==typeof Ne&&rt(Ne((arguments[0]||tt)(null),nt))===nt}},{}],208:[function(Ne,Ge,Qe){"use strict";var tt,rt,nt,at,it=Ne("../is-object"),ot=Ne("../valid-value"),dt=Object.prototype.isPrototypeOf,ht=Object.defineProperty,Dt={configurable:!0,enumerable:!1,writable:!0,value:void 0};tt=function(Ne,Ge){if(ot(Ne),null===Ge||it(Ge))return Ne;throw new TypeError("Prototype must be null or an object")},Ge.exports=(rt=function(){var Ne,Ge=Object.create(null),Qe={},tt=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(tt){try{(Ne=tt.set).call(Ge,Qe)}catch(Ne){}if(Object.getPrototypeOf(Ge)===Qe)return{set:Ne,level:2}}return Ge.__proto__=Qe,Object.getPrototypeOf(Ge)===Qe?{level:2}:((Ge={}).__proto__=Qe,Object.getPrototypeOf(Ge)===Qe&&{level:1})}(),rt?(2===rt.level?rt.set?(at=rt.set,nt=function(Ne,Ge){return at.call(tt(Ne,Ge),Ge),Ne}):nt=function(Ne,Ge){return tt(Ne,Ge).__proto__=Ge,Ne}:nt=function self(Ne,Ge){var Qe;return tt(Ne,Ge),(Qe=dt.call(self.nullPolyfill,Ne))&&delete self.nullPolyfill.__proto__,null===Ge&&(Ge=self.nullPolyfill),Ne.__proto__=Ge,Qe&&ht(self.nullPolyfill,"__proto__",Dt),Ne},Object.defineProperty(nt,"level",{configurable:!1,enumerable:!1,writable:!1,value:rt.level})):null),Ne("../create")},{"../create":197,"../is-object":199,"../valid-value":211}],209:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne){if("function"!=typeof Ne)throw new TypeError(Ne+" is not a function");return Ne}},{}],210:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./is-object");Ge.exports=function(Ne){if(!tt(Ne))throw new TypeError(Ne+" is not an Object");return Ne}},{"./is-object":199}],211:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./is-value");Ge.exports=function(Ne){if(!tt(Ne))throw new TypeError("Cannot use null or undefined");return Ne}},{"./is-value":200}],212:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("./is-implemented")()?String.prototype.contains:Ne("./shim")},{"./is-implemented":213,"./shim":214}],213:[function(Ne,Ge,Qe){"use strict";var tt="razdwatrzy";Ge.exports=function(){return"function"==typeof tt.contains&&!0===tt.contains("dwa")&&!1===tt.contains("foo")}},{}],214:[function(Ne,Ge,Qe){"use strict";var tt=String.prototype.indexOf;Ge.exports=function(Ne){return tt.call(this,Ne,arguments[1])>-1}},{}],215:[function(Ne,Ge,Qe){"use strict";var tt=Object.prototype.toString,rt=tt.call("");Ge.exports=function(Ne){return"string"==typeof Ne||Ne&&"object"==typeof Ne&&(Ne instanceof String||tt.call(Ne)===rt)||!1}},{}],216:[function(Ne,Ge,Qe){"use strict";var tt=Object.create(null),rt=Math.random;Ge.exports=function(){var Ne;do{Ne=rt().toString(36).slice(2)}while(tt[Ne]);return Ne}},{}],217:[function(Ne,Ge,Qe){"use strict";var tt,rt=Ne("es5-ext/object/set-prototype-of"),nt=Ne("es5-ext/string/#/contains"),at=Ne("d"),it=Ne("es6-symbol"),ot=Ne("./"),dt=Object.defineProperty;tt=Ge.exports=function(Ne,Ge){if(!(this instanceof tt))throw new TypeError("Constructor requires 'new'");ot.call(this,Ne),Ge=Ge?nt.call(Ge,"key+value")?"key+value":nt.call(Ge,"key")?"key":"value":"value",dt(this,"__kind__",at("",Ge))},rt&&rt(tt,ot),delete tt.prototype.constructor,tt.prototype=Object.create(ot.prototype,{_resolve:at((function(Ne){return"value"===this.__kind__?this.__list__[Ne]:"key+value"===this.__kind__?[Ne,this.__list__[Ne]]:Ne}))}),dt(tt.prototype,it.toStringTag,at("c","Array Iterator"))},{"./":220,d:155,"es5-ext/object/set-prototype-of":206,"es5-ext/string/#/contains":212,"es6-symbol":225}],218:[function(Ne,Ge,Qe){"use strict";var tt=Ne("es5-ext/function/is-arguments"),rt=Ne("es5-ext/object/valid-callable"),nt=Ne("es5-ext/string/is-string"),at=Ne("./get"),it=Array.isArray,ot=Function.prototype.call,dt=Array.prototype.some;Ge.exports=function(Ne,Ge){var Qe,ht,Dt,Ot,Rt,Zt,er,dr,mr=arguments[2];if(it(Ne)||tt(Ne)?Qe="array":nt(Ne)?Qe="string":Ne=at(Ne),rt(Ge),Dt=function(){Ot=!0},"array"!==Qe)if("string"!==Qe)for(ht=Ne.next();!ht.done;){if(ot.call(Ge,mr,ht.value,Dt),Ot)return;ht=Ne.next()}else for(Zt=Ne.length,Rt=0;Rt<Zt&&(er=Ne[Rt],Rt+1<Zt&&(dr=er.charCodeAt(0))>=55296&&dr<=56319&&(er+=Ne[++Rt]),ot.call(Ge,mr,er,Dt),!Ot);++Rt);else dt.call(Ne,(function(Ne){return ot.call(Ge,mr,Ne,Dt),Ot}))}},{"./get":219,"es5-ext/function/is-arguments":184,"es5-ext/object/valid-callable":209,"es5-ext/string/is-string":215}],219:[function(Ne,Ge,Qe){"use strict";var tt=Ne("es5-ext/function/is-arguments"),rt=Ne("es5-ext/string/is-string"),nt=Ne("./array"),at=Ne("./string"),it=Ne("./valid-iterable"),ot=Ne("es6-symbol").iterator;Ge.exports=function(Ne){return"function"==typeof it(Ne)[ot]?Ne[ot]():tt(Ne)?new nt(Ne):rt(Ne)?new at(Ne):new nt(Ne)}},{"./array":217,"./string":222,"./valid-iterable":223,"es5-ext/function/is-arguments":184,"es5-ext/string/is-string":215,"es6-symbol":225}],220:[function(Ne,Ge,Qe){"use strict";var tt,rt=Ne("es5-ext/array/#/clear"),nt=Ne("es5-ext/object/assign"),at=Ne("es5-ext/object/valid-callable"),it=Ne("es5-ext/object/valid-value"),ot=Ne("d"),dt=Ne("d/auto-bind"),ht=Ne("es6-symbol"),Dt=Object.defineProperty,Ot=Object.defineProperties;Ge.exports=tt=function(Ne,Ge){if(!(this instanceof tt))throw new TypeError("Constructor requires 'new'");Ot(this,{__list__:ot("w",it(Ne)),__context__:ot("w",Ge),__nextIndex__:ot("w",0)}),Ge&&(at(Ge.on),Ge.on("_add",this._onAdd),Ge.on("_delete",this._onDelete),Ge.on("_clear",this._onClear))},delete tt.prototype.constructor,Ot(tt.prototype,nt({_next:ot((function(){var Ne;if(this.__list__)return this.__redo__&&void 0!==(Ne=this.__redo__.shift())?Ne:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()})),next:ot((function(){return this._createResult(this._next())})),_createResult:ot((function(Ne){return void 0===Ne?{done:!0,value:void 0}:{done:!1,value:this._resolve(Ne)}})),_resolve:ot((function(Ne){return this.__list__[Ne]})),_unBind:ot((function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)})),toString:ot((function(){return"[object "+(this[ht.toStringTag]||"Object")+"]"}))},dt({_onAdd:ot((function(Ne){Ne>=this.__nextIndex__||(++this.__nextIndex__,this.__redo__?(this.__redo__.forEach((function(Ge,Qe){Ge>=Ne&&(this.__redo__[Qe]=++Ge)}),this),this.__redo__.push(Ne)):Dt(this,"__redo__",ot("c",[Ne])))})),_onDelete:ot((function(Ne){var Ge;Ne>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(-1!==(Ge=this.__redo__.indexOf(Ne))&&this.__redo__.splice(Ge,1),this.__redo__.forEach((function(Ge,Qe){Ge>Ne&&(this.__redo__[Qe]=--Ge)}),this)))})),_onClear:ot((function(){this.__redo__&&rt.call(this.__redo__),this.__nextIndex__=0}))}))),Dt(tt.prototype,ht.iterator,ot((function(){return this})))},{d:155,"d/auto-bind":154,"es5-ext/array/#/clear":180,"es5-ext/object/assign":193,"es5-ext/object/valid-callable":209,"es5-ext/object/valid-value":211,"es6-symbol":225}],221:[function(Ne,Ge,Qe){"use strict";var tt=Ne("es5-ext/function/is-arguments"),rt=Ne("es5-ext/object/is-value"),nt=Ne("es5-ext/string/is-string"),at=Ne("es6-symbol").iterator,it=Array.isArray;Ge.exports=function(Ne){return!(!rt(Ne)||!it(Ne)&&!nt(Ne)&&!tt(Ne)&&"function"!=typeof Ne[at])}},{"es5-ext/function/is-arguments":184,"es5-ext/object/is-value":200,"es5-ext/string/is-string":215,"es6-symbol":225}],222:[function(Ne,Ge,Qe){"use strict";var tt,rt=Ne("es5-ext/object/set-prototype-of"),nt=Ne("d"),at=Ne("es6-symbol"),it=Ne("./"),ot=Object.defineProperty;tt=Ge.exports=function(Ne){if(!(this instanceof tt))throw new TypeError("Constructor requires 'new'");Ne=String(Ne),it.call(this,Ne),ot(this,"__length__",nt("",Ne.length))},rt&&rt(tt,it),delete tt.prototype.constructor,tt.prototype=Object.create(it.prototype,{_next:nt((function(){if(this.__list__)return this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind()})),_resolve:nt((function(Ne){var Ge,Qe=this.__list__[Ne];return this.__nextIndex__===this.__length__?Qe:(Ge=Qe.charCodeAt(0))>=55296&&Ge<=56319?Qe+this.__list__[this.__nextIndex__++]:Qe}))}),ot(tt.prototype,at.toStringTag,nt("c","String Iterator"))},{"./":220,d:155,"es5-ext/object/set-prototype-of":206,"es6-symbol":225}],223:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./is-iterable");Ge.exports=function(Ne){if(!tt(Ne))throw new TypeError(Ne+" is not iterable");return Ne}},{"./is-iterable":221}],224:[function(Ne,Ge,rt){(function(Qe,nt){(function(){!function(Ne,Qe){"object"==typeof rt&&void 0!==Ge?Ge.exports=Qe():"function"==typeof tt&&tt.amd?tt(Qe):Ne.ES6Promise=Qe()}(this,(function(){"use strict";function objectOrFunction(Ne){var Ge=typeof Ne;return null!==Ne&&("object"===Ge||"function"===Ge)}function isFunction(Ne){return"function"==typeof Ne}var Ge=Array.isArray?Array.isArray:function(Ne){return"[object Array]"===Object.prototype.toString.call(Ne)},tt=0,rt=void 0,at=void 0,asap=function(Ne,Ge){Ot[tt]=Ne,Ot[tt+1]=Ge,2===(tt+=2)&&(at?at(flush):Rt())};function setScheduler(Ne){at=Ne}function setAsap(Ne){asap=Ne}var it="undefined"!=typeof window?window:void 0,ot=it||{},dt=ot.MutationObserver||ot.WebKitMutationObserver,ht="undefined"==typeof self&&void 0!==Qe&&"[object process]"==={}.toString.call(Qe),Dt="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function useNextTick(){return function(){return Qe.nextTick(flush)}}function useVertxTimer(){return void 0!==rt?function(){rt(flush)}:useSetTimeout()}function useMutationObserver(){var Ne=0,Ge=new dt(flush),Qe=document.createTextNode("");return Ge.observe(Qe,{characterData:!0}),function(){Qe.data=Ne=++Ne%2}}function useMessageChannel(){var Ne=new MessageChannel;return Ne.port1.onmessage=flush,function(){return Ne.port2.postMessage(0)}}function useSetTimeout(){var Ne=setTimeout;return function(){return Ne(flush,1)}}var Ot=new Array(1e3);function flush(){for(var Ne=0;Ne<tt;Ne+=2)(0,Ot[Ne])(Ot[Ne+1]),Ot[Ne]=void 0,Ot[Ne+1]=void 0;tt=0}function attemptVertx(){try{var Ne=Function("return this")().require("vertx");return rt=Ne.runOnLoop||Ne.runOnContext,useVertxTimer()}catch(Ne){return useSetTimeout()}}var Rt=void 0;function then(Ne,Ge){var Qe=this,tt=new this.constructor(noop);void 0===tt[Zt]&&makePromise(tt);var rt=Qe._state;if(rt){var nt=arguments[rt-1];asap((function(){return invokeCallback(rt,tt,nt,Qe._result)}))}else subscribe(Qe,tt,Ne,Ge);return tt}function resolve$1(Ne){var Ge=this;if(Ne&&"object"==typeof Ne&&Ne.constructor===Ge)return Ne;var Qe=new Ge(noop);return resolve(Qe,Ne),Qe}Rt=ht?useNextTick():dt?useMutationObserver():Dt?useMessageChannel():void 0===it&&"function"==typeof Ne?attemptVertx():useSetTimeout();var Zt=Math.random().toString(36).substring(2);function noop(){}var er=void 0,dr=1,mr=2;function selfFulfillment(){return new TypeError("You cannot resolve a promise with itself")}function cannotReturnOwn(){return new TypeError("A promises callback cannot return that same promise.")}function tryThen(Ne,Ge,Qe,tt){try{Ne.call(Ge,Qe,tt)}catch(Ne){return Ne}}function handleForeignThenable(Ne,Ge,Qe){asap((function(Ne){var tt=!1,rt=tryThen(Qe,Ge,(function(Qe){tt||(tt=!0,Ge!==Qe?resolve(Ne,Qe):fulfill(Ne,Qe))}),(function(Ge){tt||(tt=!0,reject(Ne,Ge))}),"Settle: "+(Ne._label||" unknown promise"));!tt&&rt&&(tt=!0,reject(Ne,rt))}),Ne)}function handleOwnThenable(Ne,Ge){Ge._state===dr?fulfill(Ne,Ge._result):Ge._state===mr?reject(Ne,Ge._result):subscribe(Ge,void 0,(function(Ge){return resolve(Ne,Ge)}),(function(Ge){return reject(Ne,Ge)}))}function handleMaybeThenable(Ne,Ge,Qe){Ge.constructor===Ne.constructor&&Qe===then&&Ge.constructor.resolve===resolve$1?handleOwnThenable(Ne,Ge):void 0===Qe?fulfill(Ne,Ge):isFunction(Qe)?handleForeignThenable(Ne,Ge,Qe):fulfill(Ne,Ge)}function resolve(Ne,Ge){if(Ne===Ge)reject(Ne,selfFulfillment());else if(objectOrFunction(Ge)){var Qe=void 0;try{Qe=Ge.then}catch(Ge){return void reject(Ne,Ge)}handleMaybeThenable(Ne,Ge,Qe)}else fulfill(Ne,Ge)}function publishRejection(Ne){Ne._onerror&&Ne._onerror(Ne._result),publish(Ne)}function fulfill(Ne,Ge){Ne._state===er&&(Ne._result=Ge,Ne._state=dr,0!==Ne._subscribers.length&&asap(publish,Ne))}function reject(Ne,Ge){Ne._state===er&&(Ne._state=mr,Ne._result=Ge,asap(publishRejection,Ne))}function subscribe(Ne,Ge,Qe,tt){var rt=Ne._subscribers,nt=rt.length;Ne._onerror=null,rt[nt]=Ge,rt[nt+dr]=Qe,rt[nt+mr]=tt,0===nt&&Ne._state&&asap(publish,Ne)}function publish(Ne){var Ge=Ne._subscribers,Qe=Ne._state;if(0!==Ge.length){for(var tt=void 0,rt=void 0,nt=Ne._result,at=0;at<Ge.length;at+=3)tt=Ge[at],rt=Ge[at+Qe],tt?invokeCallback(Qe,tt,rt,nt):rt(nt);Ne._subscribers.length=0}}function invokeCallback(Ne,Ge,Qe,tt){var rt=isFunction(Qe),nt=void 0,at=void 0,it=!0;if(rt){try{nt=Qe(tt)}catch(Ne){it=!1,at=Ne}if(Ge===nt)return void reject(Ge,cannotReturnOwn())}else nt=tt;Ge._state!==er||(rt&&it?resolve(Ge,nt):!1===it?reject(Ge,at):Ne===dr?fulfill(Ge,nt):Ne===mr&&reject(Ge,nt))}function initializePromise(Ne,Ge){try{Ge((function(Ge){resolve(Ne,Ge)}),(function(Ge){reject(Ne,Ge)}))}catch(Ge){reject(Ne,Ge)}}var xr=0;function nextId(){return xr++}function makePromise(Ne){Ne[Zt]=xr++,Ne._state=void 0,Ne._result=void 0,Ne._subscribers=[]}function validationError(){return new Error("Array Methods must be provided an Array")}var br=function(){function Enumerator(Ne,Qe){this._instanceConstructor=Ne,this.promise=new Ne(noop),this.promise[Zt]||makePromise(this.promise),Ge(Qe)?(this.length=Qe.length,this._remaining=Qe.length,this._result=new Array(this.length),0===this.length?fulfill(this.promise,this._result):(this.length=this.length||0,this._enumerate(Qe),0===this._remaining&&fulfill(this.promise,this._result))):reject(this.promise,validationError())}return Enumerator.prototype._enumerate=function(Ne){for(var Ge=0;this._state===er&&Ge<Ne.length;Ge++)this._eachEntry(Ne[Ge],Ge)},Enumerator.prototype._eachEntry=function(Ne,Ge){var Qe=this._instanceConstructor,tt=Qe.resolve;if(tt===resolve$1){var rt=void 0,nt=void 0,at=!1;try{rt=Ne.then}catch(Ne){at=!0,nt=Ne}if(rt===then&&Ne._state!==er)this._settledAt(Ne._state,Ge,Ne._result);else if("function"!=typeof rt)this._remaining--,this._result[Ge]=Ne;else if(Qe===Ar){var it=new Qe(noop);at?reject(it,nt):handleMaybeThenable(it,Ne,rt),this._willSettleAt(it,Ge)}else this._willSettleAt(new Qe((function(Ge){return Ge(Ne)})),Ge)}else this._willSettleAt(tt(Ne),Ge)},Enumerator.prototype._settledAt=function(Ne,Ge,Qe){var tt=this.promise;tt._state===er&&(this._remaining--,Ne===mr?reject(tt,Qe):this._result[Ge]=Qe),0===this._remaining&&fulfill(tt,this._result)},Enumerator.prototype._willSettleAt=function(Ne,Ge){var Qe=this;subscribe(Ne,void 0,(function(Ne){return Qe._settledAt(dr,Ge,Ne)}),(function(Ne){return Qe._settledAt(mr,Ge,Ne)}))},Enumerator}();function all(Ne){return new br(this,Ne).promise}function race(Ne){var Qe=this;return Ge(Ne)?new Qe((function(Ge,tt){for(var rt=Ne.length,nt=0;nt<rt;nt++)Qe.resolve(Ne[nt]).then(Ge,tt)})):new Qe((function(Ne,Ge){return Ge(new TypeError("You must pass an array to race."))}))}function reject$1(Ne){var Ge=new this(noop);return reject(Ge,Ne),Ge}function needsResolver(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function needsNew(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var Ar=function(){function Promise(Ne){this[Zt]=nextId(),this._result=this._state=void 0,this._subscribers=[],noop!==Ne&&("function"!=typeof Ne&&needsResolver(),this instanceof Promise?initializePromise(this,Ne):needsNew())}return Promise.prototype.catch=function(Ne){return this.then(null,Ne)},Promise.prototype.finally=function(Ne){var Ge=this,Qe=Ge.constructor;return isFunction(Ne)?Ge.then((function(Ge){return Qe.resolve(Ne()).then((function(){return Ge}))}),(function(Ge){return Qe.resolve(Ne()).then((function(){throw Ge}))})):Ge.then(Ne,Ne)},Promise}();function polyfill(){var Ne=void 0;if(void 0!==nt)Ne=nt;else if("undefined"!=typeof self)Ne=self;else try{Ne=Function("return this")()}catch(Ne){throw new Error("polyfill failed because global object is unavailable in this environment")}var Ge=Ne.Promise;if(Ge){var Qe=null;try{Qe=Object.prototype.toString.call(Ge.resolve())}catch(Ne){}if("[object Promise]"===Qe&&!Ge.cast)return}Ne.Promise=Ar}return Ar.prototype.then=then,Ar.all=all,Ar.race=race,Ar.resolve=resolve$1,Ar.reject=reject$1,Ar._setScheduler=setScheduler,Ar._setAsap=setAsap,Ar._asap=asap,Ar.polyfill=polyfill,Ar.Promise=Ar,Ar}))}).call(this)}).call(this,Ne("_process"),void 0!==Qe.g?Qe.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:526}],225:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("./is-implemented")()?Ne("ext/global-this").Symbol:Ne("./polyfill")},{"./is-implemented":226,"./polyfill":231,"ext/global-this":238}],226:[function(Ne,Ge,Qe){"use strict";var tt=Ne("ext/global-this"),rt={object:!0,symbol:!0};Ge.exports=function(){var Ne,Ge=tt.Symbol;if("function"!=typeof Ge)return!1;Ne=Ge("test symbol");try{String(Ne)}catch(Ne){return!1}return!!rt[typeof Ge.iterator]&&!!rt[typeof Ge.toPrimitive]&&!!rt[typeof Ge.toStringTag]}},{"ext/global-this":238}],227:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne){return!!Ne&&("symbol"==typeof Ne||!!Ne.constructor&&"Symbol"===Ne.constructor.name&&"Symbol"===Ne[Ne.constructor.toStringTag])}},{}],228:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d"),rt=Object.create,nt=Object.defineProperty,at=Object.prototype,it=rt(null);Ge.exports=function(Ne){for(var Ge,Qe,rt=0;it[Ne+(rt||"")];)++rt;return it[Ne+=rt||""]=!0,nt(at,Ge="@@"+Ne,tt.gs(null,(function(Ne){Qe||(Qe=!0,nt(this,Ge,tt(Ne)),Qe=!1)}))),Ge}},{d:155}],229:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d"),rt=Ne("ext/global-this").Symbol;Ge.exports=function(Ne){return Object.defineProperties(Ne,{hasInstance:tt("",rt&&rt.hasInstance||Ne("hasInstance")),isConcatSpreadable:tt("",rt&&rt.isConcatSpreadable||Ne("isConcatSpreadable")),iterator:tt("",rt&&rt.iterator||Ne("iterator")),match:tt("",rt&&rt.match||Ne("match")),replace:tt("",rt&&rt.replace||Ne("replace")),search:tt("",rt&&rt.search||Ne("search")),species:tt("",rt&&rt.species||Ne("species")),split:tt("",rt&&rt.split||Ne("split")),toPrimitive:tt("",rt&&rt.toPrimitive||Ne("toPrimitive")),toStringTag:tt("",rt&&rt.toStringTag||Ne("toStringTag")),unscopables:tt("",rt&&rt.unscopables||Ne("unscopables"))})}},{d:155,"ext/global-this":238}],230:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d"),rt=Ne("../../../validate-symbol"),nt=Object.create(null);Ge.exports=function(Ne){return Object.defineProperties(Ne,{for:tt((function(Ge){return nt[Ge]?nt[Ge]:nt[Ge]=Ne(String(Ge))})),keyFor:tt((function(Ne){var Ge;for(Ge in rt(Ne),nt)if(nt[Ge]===Ne)return Ge}))})}},{"../../../validate-symbol":232,d:155}],231:[function(Ne,Ge,Qe){"use strict";var tt,rt,nt,at=Ne("d"),it=Ne("./validate-symbol"),ot=Ne("ext/global-this").Symbol,dt=Ne("./lib/private/generate-name"),ht=Ne("./lib/private/setup/standard-symbols"),Dt=Ne("./lib/private/setup/symbol-registry"),Ot=Object.create,Rt=Object.defineProperties,Zt=Object.defineProperty;if("function"==typeof ot)try{String(ot()),nt=!0}catch(Ne){}else ot=null;rt=function(Ne){if(this instanceof rt)throw new TypeError("Symbol is not a constructor");return tt(Ne)},Ge.exports=tt=function Symbol(Ne){var Ge;if(this instanceof Symbol)throw new TypeError("Symbol is not a constructor");return nt?ot(Ne):(Ge=Ot(rt.prototype),Ne=void 0===Ne?"":String(Ne),Rt(Ge,{__description__:at("",Ne),__name__:at("",dt(Ne))}))},ht(tt),Dt(tt),Rt(rt.prototype,{constructor:at(tt),toString:at("",(function(){return this.__name__}))}),Rt(tt.prototype,{toString:at((function(){return"Symbol ("+it(this).__description__+")"})),valueOf:at((function(){return it(this)}))}),Zt(tt.prototype,tt.toPrimitive,at("",(function(){var Ne=it(this);return"symbol"==typeof Ne?Ne:Ne.toString()}))),Zt(tt.prototype,tt.toStringTag,at("c","Symbol")),Zt(rt.prototype,tt.toStringTag,at("c",tt.prototype[tt.toStringTag])),Zt(rt.prototype,tt.toPrimitive,at("c",tt.prototype[tt.toPrimitive]))},{"./lib/private/generate-name":228,"./lib/private/setup/standard-symbols":229,"./lib/private/setup/symbol-registry":230,"./validate-symbol":232,d:155,"ext/global-this":238}],232:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./is-symbol");Ge.exports=function(Ne){if(!tt(Ne))throw new TypeError(Ne+" is not a symbol");return Ne}},{"./is-symbol":227}],233:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("./is-implemented")()?WeakMap:Ne("./polyfill")},{"./is-implemented":234,"./polyfill":236}],234:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(){var Ne,Ge;if("function"!=typeof WeakMap)return!1;try{Ne=new WeakMap([[Ge={},"one"],[{},"two"],[{},"three"]])}catch(Ne){return!1}return"[object WeakMap]"===String(Ne)&&"function"==typeof Ne.set&&Ne.set({},1)===Ne&&"function"==typeof Ne.delete&&"function"==typeof Ne.has&&"one"===Ne.get(Ge)}},{}],235:[function(Ne,Ge,Qe){"use strict";Ge.exports="function"==typeof WeakMap&&"[object WeakMap]"===Object.prototype.toString.call(new WeakMap)},{}],236:[function(Ne,Ge,Qe){"use strict";var tt,rt=Ne("es5-ext/object/is-value"),nt=Ne("es5-ext/object/set-prototype-of"),at=Ne("es5-ext/object/valid-object"),it=Ne("es5-ext/object/valid-value"),ot=Ne("es5-ext/string/random-uniq"),dt=Ne("d"),ht=Ne("es6-iterator/get"),Dt=Ne("es6-iterator/for-of"),Ot=Ne("es6-symbol").toStringTag,Rt=Ne("./is-native-implemented"),Zt=Array.isArray,er=Object.defineProperty,dr=Object.prototype.hasOwnProperty,mr=Object.getPrototypeOf;Ge.exports=tt=function(){var Ne,Ge=arguments[0];if(!(this instanceof tt))throw new TypeError("Constructor requires 'new'");return Ne=Rt&&nt&&WeakMap!==tt?nt(new WeakMap,mr(this)):this,rt(Ge)&&(Zt(Ge)||(Ge=ht(Ge))),er(Ne,"__weakMapData__",dt("c","$weakMap$"+ot())),Ge?(Dt(Ge,(function(Ge){it(Ge),Ne.set(Ge[0],Ge[1])})),Ne):Ne},Rt&&(nt&&nt(tt,WeakMap),tt.prototype=Object.create(WeakMap.prototype,{constructor:dt(tt)})),Object.defineProperties(tt.prototype,{delete:dt((function(Ne){return!!dr.call(at(Ne),this.__weakMapData__)&&(delete Ne[this.__weakMapData__],!0)})),get:dt((function(Ne){if(dr.call(at(Ne),this.__weakMapData__))return Ne[this.__weakMapData__]})),has:dt((function(Ne){return dr.call(at(Ne),this.__weakMapData__)})),set:dt((function(Ne,Ge){return er(at(Ne),this.__weakMapData__,dt("c",Ge)),this})),toString:dt((function(){return"[object WeakMap]"}))}),er(tt.prototype,Ot,dt("c","WeakMap"))},{"./is-native-implemented":235,d:155,"es5-ext/object/is-value":200,"es5-ext/object/set-prototype-of":206,"es5-ext/object/valid-object":210,"es5-ext/object/valid-value":211,"es5-ext/string/random-uniq":216,"es6-iterator/for-of":218,"es6-iterator/get":219,"es6-symbol":225}],237:[function(Ne,Ge,Qe){var naiveFallback=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};Ge.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(Ne){return naiveFallback()}try{return __global__||naiveFallback()}finally{delete Object.prototype.__global__}}()},{}],238:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("./is-implemented")()?globalThis:Ne("./implementation")},{"./implementation":237,"./is-implemented":239}],239:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(){return"object"==typeof globalThis&&!!globalThis&&globalThis.Array===Array}},{}],240:[function(Ne,Ge,Qe){"use strict";function extractPlanes(Ne,Ge,Qe){var tt=Ge||0,rt=Qe||1;return[[Ne[12]+Ne[0],Ne[13]+Ne[1],Ne[14]+Ne[2],Ne[15]+Ne[3]],[Ne[12]-Ne[0],Ne[13]-Ne[1],Ne[14]-Ne[2],Ne[15]-Ne[3]],[Ne[12]+Ne[4],Ne[13]+Ne[5],Ne[14]+Ne[6],Ne[15]+Ne[7]],[Ne[12]-Ne[4],Ne[13]-Ne[5],Ne[14]-Ne[6],Ne[15]-Ne[7]],[tt*Ne[12]+Ne[8],tt*Ne[13]+Ne[9],tt*Ne[14]+Ne[10],tt*Ne[15]+Ne[11]],[rt*Ne[12]-Ne[8],rt*Ne[13]-Ne[9],rt*Ne[14]-Ne[10],rt*Ne[15]-Ne[11]]]}Ge.exports=extractPlanes},{}],241:[function(Ne,Ge,Qe){"use strict";var tt=Ne("is-string-blank");Ge.exports=function(Ne){var Ge=typeof Ne;if("string"===Ge){var Qe=Ne;if(0==(Ne=+Ne)&&tt(Qe))return!1}else if("number"!==Ge)return!1;return Ne-Ne<1}},{"is-string-blank":470}],242:[function(Ne,Ge,Qe){"use strict";Ge.exports=createFilteredVector;var tt=Ne("cubic-hermite"),rt=Ne("binary-search-bounds");function clamp(Ne,Ge,Qe){return Math.min(Ge,Math.max(Ne,Qe))}function FilteredVector(Ne,Ge,Qe){this.dimension=Ne.length,this.bounds=[new Array(this.dimension),new Array(this.dimension)];for(var tt=0;tt<this.dimension;++tt)this.bounds[0][tt]=-1/0,this.bounds[1][tt]=1/0;this._state=Ne.slice().reverse(),this._velocity=Ge.slice().reverse(),this._time=[Qe],this._scratch=[Ne.slice(),Ne.slice(),Ne.slice(),Ne.slice(),Ne.slice()]}var nt=FilteredVector.prototype;function getZero(Ne){for(var Ge=new Array(Ne),Qe=0;Qe<Ne;++Qe)Ge[Qe]=0;return Ge}function createFilteredVector(Ne,Ge,Qe){switch(arguments.length){case 0:return new FilteredVector([0],[0],0);case 1:return"number"==typeof Ne?new FilteredVector(tt=getZero(Ne),tt,0):new FilteredVector(Ne,getZero(Ne.length),0);case 2:var tt;if("number"==typeof Ge)return new FilteredVector(Ne,tt=getZero(Ne.length),+Ge);Qe=0;case 3:if(Ne.length!==Ge.length)throw new Error("state and velocity lengths must match");return new FilteredVector(Ne,Ge,Qe)}}nt.flush=function(Ne){var Ge=rt.gt(this._time,Ne)-1;Ge<=0||(this._time.splice(0,Ge),this._state.splice(0,Ge*this.dimension),this._velocity.splice(0,Ge*this.dimension))},nt.curve=function(Ne){var Ge=this._time,Qe=Ge.length,nt=rt.le(Ge,Ne),at=this._scratch[0],it=this._state,ot=this._velocity,dt=this.dimension,ht=this.bounds;if(nt<0)for(var Dt=dt-1,Ot=0;Ot<dt;++Ot,--Dt)at[Ot]=it[Dt];else if(nt>=Qe-1){Dt=it.length-1;var Rt=Ne-Ge[Qe-1];for(Ot=0;Ot<dt;++Ot,--Dt)at[Ot]=it[Dt]+Rt*ot[Dt]}else{Dt=dt*(nt+1)-1;var Zt=Ge[nt],er=Ge[nt+1]-Zt||1,dr=this._scratch[1],mr=this._scratch[2],xr=this._scratch[3],br=this._scratch[4],Ar=!0;for(Ot=0;Ot<dt;++Ot,--Dt)dr[Ot]=it[Dt],xr[Ot]=ot[Dt]*er,mr[Ot]=it[Dt+dt],br[Ot]=ot[Dt+dt]*er,Ar=Ar&&dr[Ot]===mr[Ot]&&xr[Ot]===br[Ot]&&0===xr[Ot];if(Ar)for(Ot=0;Ot<dt;++Ot)at[Ot]=dr[Ot];else tt(dr,xr,mr,br,(Ne-Zt)/er,at)}var en=ht[0],mn=ht[1];for(Ot=0;Ot<dt;++Ot)at[Ot]=clamp(en[Ot],mn[Ot],at[Ot]);return at},nt.dcurve=function(Ne){var Ge=this._time,Qe=Ge.length,nt=rt.le(Ge,Ne),at=this._scratch[0],it=this._state,ot=this._velocity,dt=this.dimension;if(nt>=Qe-1)for(var ht=it.length-1,Dt=(Ge[Qe-1],0);Dt<dt;++Dt,--ht)at[Dt]=ot[ht];else{ht=dt*(nt+1)-1;var Ot=Ge[nt],Rt=Ge[nt+1]-Ot||1,Zt=this._scratch[1],er=this._scratch[2],dr=this._scratch[3],mr=this._scratch[4],xr=!0;for(Dt=0;Dt<dt;++Dt,--ht)Zt[Dt]=it[ht],dr[Dt]=ot[ht]*Rt,er[Dt]=it[ht+dt],mr[Dt]=ot[ht+dt]*Rt,xr=xr&&Zt[Dt]===er[Dt]&&dr[Dt]===mr[Dt]&&0===dr[Dt];if(xr)for(Dt=0;Dt<dt;++Dt)at[Dt]=0;else for(tt.derivative(Zt,dr,er,mr,(Ne-Ot)/Rt,at),Dt=0;Dt<dt;++Dt)at[Dt]/=Rt}return at},nt.lastT=function(){var Ne=this._time;return Ne[Ne.length-1]},nt.stable=function(){for(var Ne=this._velocity,Ge=Ne.length,Qe=this.dimension-1;Qe>=0;--Qe)if(Ne[--Ge])return!1;return!0},nt.jump=function(Ne){var Ge=this.lastT(),Qe=this.dimension;if(!(Ne<Ge||arguments.length!==Qe+1)){var tt=this._state,rt=this._velocity,nt=tt.length-this.dimension,at=this.bounds,it=at[0],ot=at[1];this._time.push(Ge,Ne);for(var dt=0;dt<2;++dt)for(var ht=0;ht<Qe;++ht)tt.push(tt[nt++]),rt.push(0);for(this._time.push(Ne),ht=Qe;ht>0;--ht)tt.push(clamp(it[ht-1],ot[ht-1],arguments[ht])),rt.push(0)}},nt.push=function(Ne){var Ge=this.lastT(),Qe=this.dimension;if(!(Ne<Ge||arguments.length!==Qe+1)){var tt=this._state,rt=this._velocity,nt=tt.length-this.dimension,at=Ne-Ge,it=this.bounds,ot=it[0],dt=it[1],ht=at>1e-6?1/at:0;this._time.push(Ne);for(var Dt=Qe;Dt>0;--Dt){var Ot=clamp(ot[Dt-1],dt[Dt-1],arguments[Dt]);tt.push(Ot),rt.push((Ot-tt[nt++])*ht)}}},nt.set=function(Ne){var Ge=this.dimension;if(!(Ne<this.lastT()||arguments.length!==Ge+1)){var Qe=this._state,tt=this._velocity,rt=this.bounds,nt=rt[0],at=rt[1];this._time.push(Ne);for(var it=Ge;it>0;--it)Qe.push(clamp(nt[it-1],at[it-1],arguments[it])),tt.push(0)}},nt.move=function(Ne){var Ge=this.lastT(),Qe=this.dimension;if(!(Ne<=Ge||arguments.length!==Qe+1)){var tt=this._state,rt=this._velocity,nt=tt.length-this.dimension,at=this.bounds,it=at[0],ot=at[1],dt=Ne-Ge,ht=dt>1e-6?1/dt:0;this._time.push(Ne);for(var Dt=Qe;Dt>0;--Dt){var Ot=arguments[Dt];tt.push(clamp(it[Dt-1],ot[Dt-1],tt[nt++]+Ot)),rt.push(Ot*ht)}}},nt.idle=function(Ne){var Ge=this.lastT();if(!(Ne<Ge)){var Qe=this.dimension,tt=this._state,rt=this._velocity,nt=tt.length-Qe,at=this.bounds,it=at[0],ot=at[1],dt=Ne-Ge;this._time.push(Ne);for(var ht=Qe-1;ht>=0;--ht)tt.push(clamp(it[ht],ot[ht],tt[nt]+dt*rt[nt])),rt.push(0),nt+=1}}},{"binary-search-bounds":243,"cubic-hermite":150}],243:[function(Ne,Ge,Qe){"use strict";function compileSearch(Ne,Ge,Qe,tt,rt,nt){var at=["function ",Ne,"(a,l,h,",tt.join(","),"){",nt?"":"var i=",Qe?"l-1":"h+1",";while(l<=h){var m=(l+h)>>>1,x=a",rt?".get(m)":"[m]"];return nt?Ge.indexOf("c")<0?at.push(";if(x===y){return m}else if(x<=y){"):at.push(";var p=c(x,y);if(p===0){return m}else if(p<=0){"):at.push(";if(",Ge,"){i=m;"),Qe?at.push("l=m+1}else{h=m-1}"):at.push("h=m-1}else{l=m+1}"),at.push("}"),nt?at.push("return -1};"):at.push("return i};"),at.join("")}function compileBoundsSearch(Ne,Ge,Qe,tt){return new Function([compileSearch("A","x"+Ne+"y",Ge,["y"],!1,tt),compileSearch("B","x"+Ne+"y",Ge,["y"],!0,tt),compileSearch("P","c(x,y)"+Ne+"0",Ge,["y","c"],!1,tt),compileSearch("Q","c(x,y)"+Ne+"0",Ge,["y","c"],!0,tt),"function dispatchBsearch",Qe,"(a,y,c,l,h){if(a.shape){if(typeof(c)==='function'){return Q(a,(l===undefined)?0:l|0,(h===undefined)?a.shape[0]-1:h|0,y,c)}else{return B(a,(c===undefined)?0:c|0,(l===undefined)?a.shape[0]-1:l|0,y)}}else{if(typeof(c)==='function'){return P(a,(l===undefined)?0:l|0,(h===undefined)?a.length-1:h|0,y,c)}else{return A(a,(c===undefined)?0:c|0,(l===undefined)?a.length-1:l|0,y)}}}return dispatchBsearch",Qe].join(""))()}Ge.exports={ge:compileBoundsSearch(">=",!1,"GE"),gt:compileBoundsSearch(">",!1,"GT"),lt:compileBoundsSearch("<",!0,"LT"),le:compileBoundsSearch("<=",!0,"LE"),eq:compileBoundsSearch("-",!0,"EQ",!0)}},{}],244:[function(Ne,Ge,Qe){var tt=Ne("dtype");function flattenVertexData(Ne,Ge,Qe){if(!Ne)throw new TypeError("must specify data as first parameter");if(Qe=0|+(Qe||0),Array.isArray(Ne)&&Ne[0]&&"number"==typeof Ne[0][0]){var rt,nt,at,it,ot=Ne[0].length,dt=Ne.length*ot;Ge&&"string"!=typeof Ge||(Ge=new(tt(Ge||"float32"))(dt+Qe));var ht=Ge.length-Qe;if(dt!==ht)throw new Error("source length "+dt+" ("+ot+"x"+Ne.length+") does not match destination length "+ht);for(rt=0,at=Qe;rt<Ne.length;rt++)for(nt=0;nt<ot;nt++)Ge[at++]=null===Ne[rt][nt]?NaN:Ne[rt][nt]}else if(Ge&&"string"!=typeof Ge)Ge.set(Ne,Qe);else{var Dt=tt(Ge||"float32");if(Array.isArray(Ne)||"array"===Ge)for(rt=0,at=Qe,it=(Ge=new Dt(Ne.length+Qe)).length;at<it;at++,rt++)Ge[at]=null===Ne[rt]?NaN:Ne[rt];else 0===Qe?Ge=new Dt(Ne):(Ge=new Dt(Ne.length+Qe)).set(Ne,Qe)}return Ge}Ge.exports=flattenVertexData},{dtype:175}],245:[function(Ne,Ge,Qe){"use strict";var tt=Ne("css-font/stringify"),rt=[32,126];function atlas(Ne){var Ge=(Ne=Ne||{}).shape?Ne.shape:Ne.canvas?[Ne.canvas.width,Ne.canvas.height]:[512,512],Qe=Ne.canvas||document.createElement("canvas"),nt=Ne.font,at="number"==typeof Ne.step?[Ne.step,Ne.step]:Ne.step||[32,32],it=Ne.chars||rt;if(nt&&"string"!=typeof nt&&(nt=tt(nt)),Array.isArray(it)){if(2===it.length&&"number"==typeof it[0]&&"number"==typeof it[1]){for(var ot=[],dt=it[0],ht=0;dt<=it[1];dt++)ot[ht++]=String.fromCharCode(dt);it=ot}}else it=String(it).split("");Ge=Ge.slice(),Qe.width=Ge[0],Qe.height=Ge[1];var Dt=Qe.getContext("2d");Dt.fillStyle="#000",Dt.fillRect(0,0,Qe.width,Qe.height),Dt.font=nt,Dt.textAlign="center",Dt.textBaseline="middle",Dt.fillStyle="#fff";var Ot=at[0]/2,Rt=at[1]/2;for(dt=0;dt<it.length;dt++)Dt.fillText(it[dt],Ot,Rt),(Ot+=at[0])>Ge[0]-at[0]/2&&(Ot=at[0]/2,Rt+=at[1]);return Qe}Ge.exports=atlas},{"css-font/stringify":147}],246:[function(Ne,Ge,Qe){"use strict";function measure(Ne,Ge){Ge||(Ge={}),("string"==typeof Ne||Array.isArray(Ne))&&(Ge.family=Ne);var Qe=Array.isArray(Ge.family)?Ge.family.join(", "):Ge.family;if(!Qe)throw Error("`family` must be defined");var tt=Ge.size||Ge.fontSize||Ge.em||48,rt=Ge.weight||Ge.fontWeight||"",nt=(Ne=[Ge.style||Ge.fontStyle||"",rt,tt].join(" ")+"px "+Qe,Ge.origin||"top");if(measure.cache[Qe]&&tt<=measure.cache[Qe].em)return applyOrigin(measure.cache[Qe],nt);var at=Ge.canvas||measure.canvas,it=at.getContext("2d"),ot={upper:void 0!==Ge.upper?Ge.upper:"H",lower:void 0!==Ge.lower?Ge.lower:"x",descent:void 0!==Ge.descent?Ge.descent:"p",ascent:void 0!==Ge.ascent?Ge.ascent:"h",tittle:void 0!==Ge.tittle?Ge.tittle:"i",overshoot:void 0!==Ge.overshoot?Ge.overshoot:"O"},dt=Math.ceil(1.5*tt);at.height=dt,at.width=.5*dt,it.font=Ne;var ht="H",Dt={top:0};it.clearRect(0,0,dt,dt),it.textBaseline="top",it.fillStyle="black",it.fillText(ht,0,0);var Ot=firstTop(it.getImageData(0,0,dt,dt));it.clearRect(0,0,dt,dt),it.textBaseline="bottom",it.fillText(ht,0,dt);var Rt=firstTop(it.getImageData(0,0,dt,dt));Dt.lineHeight=Dt.bottom=dt-Rt+Ot,it.clearRect(0,0,dt,dt),it.textBaseline="alphabetic",it.fillText(ht,0,dt);var Zt=dt-firstTop(it.getImageData(0,0,dt,dt))-1+Ot;Dt.baseline=Dt.alphabetic=Zt,it.clearRect(0,0,dt,dt),it.textBaseline="middle",it.fillText(ht,0,.5*dt);var er=firstTop(it.getImageData(0,0,dt,dt));Dt.median=Dt.middle=dt-er-1+Ot-.5*dt,it.clearRect(0,0,dt,dt),it.textBaseline="hanging",it.fillText(ht,0,.5*dt);var dr=firstTop(it.getImageData(0,0,dt,dt));Dt.hanging=dt-dr-1+Ot-.5*dt,it.clearRect(0,0,dt,dt),it.textBaseline="ideographic",it.fillText(ht,0,dt);var mr=firstTop(it.getImageData(0,0,dt,dt));if(Dt.ideographic=dt-mr-1+Ot,ot.upper&&(it.clearRect(0,0,dt,dt),it.textBaseline="top",it.fillText(ot.upper,0,0),Dt.upper=firstTop(it.getImageData(0,0,dt,dt)),Dt.capHeight=Dt.baseline-Dt.upper),ot.lower&&(it.clearRect(0,0,dt,dt),it.textBaseline="top",it.fillText(ot.lower,0,0),Dt.lower=firstTop(it.getImageData(0,0,dt,dt)),Dt.xHeight=Dt.baseline-Dt.lower),ot.tittle&&(it.clearRect(0,0,dt,dt),it.textBaseline="top",it.fillText(ot.tittle,0,0),Dt.tittle=firstTop(it.getImageData(0,0,dt,dt))),ot.ascent&&(it.clearRect(0,0,dt,dt),it.textBaseline="top",it.fillText(ot.ascent,0,0),Dt.ascent=firstTop(it.getImageData(0,0,dt,dt))),ot.descent&&(it.clearRect(0,0,dt,dt),it.textBaseline="top",it.fillText(ot.descent,0,0),Dt.descent=firstBottom(it.getImageData(0,0,dt,dt))),ot.overshoot){it.clearRect(0,0,dt,dt),it.textBaseline="top",it.fillText(ot.overshoot,0,0);var xr=firstBottom(it.getImageData(0,0,dt,dt));Dt.overshoot=xr-Zt}for(var br in Dt)Dt[br]/=tt;return Dt.em=tt,measure.cache[Qe]=Dt,applyOrigin(Dt,nt)}function applyOrigin(Ne,Ge){var Qe={};for(var tt in"string"==typeof Ge&&(Ge=Ne[Ge]),Ne)"em"!==tt&&(Qe[tt]=Ne[tt]-Ge);return Qe}function firstTop(Ne){for(var Ge=Ne.height,Qe=Ne.data,tt=3;tt<Qe.length;tt+=4)if(0!==Qe[tt])return Math.floor(.25*(tt-3)/Ge)}function firstBottom(Ne){for(var Ge=Ne.height,Qe=Ne.data,tt=Qe.length-1;tt>0;tt-=4)if(0!==Qe[tt])return Math.floor(.25*(tt-3)/Ge)}Ge.exports=measure,measure.canvas=document.createElement("canvas"),measure.cache={}},{}],247:[function(Ne,Ge,Qe){"use strict";Ge.exports=createRBTree;var tt=0,rt=1;function RBNode(Ne,Ge,Qe,tt,rt,nt){this._color=Ne,this.key=Ge,this.value=Qe,this.left=tt,this.right=rt,this._count=nt}function cloneNode(Ne){return new RBNode(Ne._color,Ne.key,Ne.value,Ne.left,Ne.right,Ne._count)}function repaint(Ne,Ge){return new RBNode(Ne,Ge.key,Ge.value,Ge.left,Ge.right,Ge._count)}function recount(Ne){Ne._count=1+(Ne.left?Ne.left._count:0)+(Ne.right?Ne.right._count:0)}function RedBlackTree(Ne,Ge){this._compare=Ne,this.root=Ge}var nt=RedBlackTree.prototype;function doVisitFull(Ne,Ge){var Qe;return Ge.left&&(Qe=doVisitFull(Ne,Ge.left))?Qe:(Qe=Ne(Ge.key,Ge.value))||(Ge.right?doVisitFull(Ne,Ge.right):void 0)}function doVisitHalf(Ne,Ge,Qe,tt){if(Ge(Ne,tt.key)<=0){var rt;if(tt.left&&(rt=doVisitHalf(Ne,Ge,Qe,tt.left)))return rt;if(rt=Qe(tt.key,tt.value))return rt}if(tt.right)return doVisitHalf(Ne,Ge,Qe,tt.right)}function doVisit(Ne,Ge,Qe,tt,rt){var nt,at=Qe(Ne,rt.key),it=Qe(Ge,rt.key);if(at<=0){if(rt.left&&(nt=doVisit(Ne,Ge,Qe,tt,rt.left)))return nt;if(it>0&&(nt=tt(rt.key,rt.value)))return nt}if(it>0&&rt.right)return doVisit(Ne,Ge,Qe,tt,rt.right)}function RedBlackTreeIterator(Ne,Ge){this.tree=Ne,this._stack=Ge}Object.defineProperty(nt,"keys",{get:function(){var Ne=[];return this.forEach((function(Ge,Qe){Ne.push(Ge)})),Ne}}),Object.defineProperty(nt,"values",{get:function(){var Ne=[];return this.forEach((function(Ge,Qe){Ne.push(Qe)})),Ne}}),Object.defineProperty(nt,"length",{get:function(){return this.root?this.root._count:0}}),nt.insert=function(Ne,Ge){for(var Qe=this._compare,nt=this.root,at=[],it=[];nt;){var ot=Qe(Ne,nt.key);at.push(nt),it.push(ot),nt=ot<=0?nt.left:nt.right}at.push(new RBNode(tt,Ne,Ge,null,null,1));for(var dt=at.length-2;dt>=0;--dt)nt=at[dt],it[dt]<=0?at[dt]=new RBNode(nt._color,nt.key,nt.value,at[dt+1],nt.right,nt._count+1):at[dt]=new RBNode(nt._color,nt.key,nt.value,nt.left,at[dt+1],nt._count+1);for(dt=at.length-1;dt>1;--dt){var ht=at[dt-1];if(nt=at[dt],ht._color===rt||nt._color===rt)break;var Dt=at[dt-2];if(Dt.left===ht)if(ht.left===nt){if(!(Ot=Dt.right)||Ot._color!==tt){Dt._color=tt,Dt.left=ht.right,ht._color=rt,ht.right=Dt,at[dt-2]=ht,at[dt-1]=nt,recount(Dt),recount(ht),dt>=3&&((Rt=at[dt-3]).left===Dt?Rt.left=ht:Rt.right=ht);break}ht._color=rt,Dt.right=repaint(rt,Ot),Dt._color=tt,dt-=1}else{if(!(Ot=Dt.right)||Ot._color!==tt){ht.right=nt.left,Dt._color=tt,Dt.left=nt.right,nt._color=rt,nt.left=ht,nt.right=Dt,at[dt-2]=nt,at[dt-1]=ht,recount(Dt),recount(ht),recount(nt),dt>=3&&((Rt=at[dt-3]).left===Dt?Rt.left=nt:Rt.right=nt);break}ht._color=rt,Dt.right=repaint(rt,Ot),Dt._color=tt,dt-=1}else if(ht.right===nt){if(!(Ot=Dt.left)||Ot._color!==tt){Dt._color=tt,Dt.right=ht.left,ht._color=rt,ht.left=Dt,at[dt-2]=ht,at[dt-1]=nt,recount(Dt),recount(ht),dt>=3&&((Rt=at[dt-3]).right===Dt?Rt.right=ht:Rt.left=ht);break}ht._color=rt,Dt.left=repaint(rt,Ot),Dt._color=tt,dt-=1}else{var Ot;if(!(Ot=Dt.left)||Ot._color!==tt){var Rt;ht.left=nt.right,Dt._color=tt,Dt.right=nt.left,nt._color=rt,nt.right=ht,nt.left=Dt,at[dt-2]=nt,at[dt-1]=ht,recount(Dt),recount(ht),recount(nt),dt>=3&&((Rt=at[dt-3]).right===Dt?Rt.right=nt:Rt.left=nt);break}ht._color=rt,Dt.left=repaint(rt,Ot),Dt._color=tt,dt-=1}}return at[0]._color=rt,new RedBlackTree(Qe,at[0])},nt.forEach=function(Ne,Ge,Qe){if(this.root)switch(arguments.length){case 1:return doVisitFull(Ne,this.root);case 2:return doVisitHalf(Ge,this._compare,Ne,this.root);case 3:if(this._compare(Ge,Qe)>=0)return;return doVisit(Ge,Qe,this._compare,Ne,this.root)}},Object.defineProperty(nt,"begin",{get:function(){for(var Ne=[],Ge=this.root;Ge;)Ne.push(Ge),Ge=Ge.left;return new RedBlackTreeIterator(this,Ne)}}),Object.defineProperty(nt,"end",{get:function(){for(var Ne=[],Ge=this.root;Ge;)Ne.push(Ge),Ge=Ge.right;return new RedBlackTreeIterator(this,Ne)}}),nt.at=function(Ne){if(Ne<0)return new RedBlackTreeIterator(this,[]);for(var Ge=this.root,Qe=[];;){if(Qe.push(Ge),Ge.left){if(Ne<Ge.left._count){Ge=Ge.left;continue}Ne-=Ge.left._count}if(!Ne)return new RedBlackTreeIterator(this,Qe);if(Ne-=1,!Ge.right)break;if(Ne>=Ge.right._count)break;Ge=Ge.right}return new RedBlackTreeIterator(this,[])},nt.ge=function(Ne){for(var Ge=this._compare,Qe=this.root,tt=[],rt=0;Qe;){var nt=Ge(Ne,Qe.key);tt.push(Qe),nt<=0&&(rt=tt.length),Qe=nt<=0?Qe.left:Qe.right}return tt.length=rt,new RedBlackTreeIterator(this,tt)},nt.gt=function(Ne){for(var Ge=this._compare,Qe=this.root,tt=[],rt=0;Qe;){var nt=Ge(Ne,Qe.key);tt.push(Qe),nt<0&&(rt=tt.length),Qe=nt<0?Qe.left:Qe.right}return tt.length=rt,new RedBlackTreeIterator(this,tt)},nt.lt=function(Ne){for(var Ge=this._compare,Qe=this.root,tt=[],rt=0;Qe;){var nt=Ge(Ne,Qe.key);tt.push(Qe),nt>0&&(rt=tt.length),Qe=nt<=0?Qe.left:Qe.right}return tt.length=rt,new RedBlackTreeIterator(this,tt)},nt.le=function(Ne){for(var Ge=this._compare,Qe=this.root,tt=[],rt=0;Qe;){var nt=Ge(Ne,Qe.key);tt.push(Qe),nt>=0&&(rt=tt.length),Qe=nt<0?Qe.left:Qe.right}return tt.length=rt,new RedBlackTreeIterator(this,tt)},nt.find=function(Ne){for(var Ge=this._compare,Qe=this.root,tt=[];Qe;){var rt=Ge(Ne,Qe.key);if(tt.push(Qe),0===rt)return new RedBlackTreeIterator(this,tt);Qe=rt<=0?Qe.left:Qe.right}return new RedBlackTreeIterator(this,[])},nt.remove=function(Ne){var Ge=this.find(Ne);return Ge?Ge.remove():this},nt.get=function(Ne){for(var Ge=this._compare,Qe=this.root;Qe;){var tt=Ge(Ne,Qe.key);if(0===tt)return Qe.value;Qe=tt<=0?Qe.left:Qe.right}};var at=RedBlackTreeIterator.prototype;function swapNode(Ne,Ge){Ne.key=Ge.key,Ne.value=Ge.value,Ne.left=Ge.left,Ne.right=Ge.right,Ne._color=Ge._color,Ne._count=Ge._count}function fixDoubleBlack(Ne){for(var Ge,Qe,nt,at,it=Ne.length-1;it>=0;--it){if(Ge=Ne[it],0===it)return void(Ge._color=rt);if((Qe=Ne[it-1]).left===Ge){if((nt=Qe.right).right&&nt.right._color===tt)return at=(nt=Qe.right=cloneNode(nt)).right=cloneNode(nt.right),Qe.right=nt.left,nt.left=Qe,nt.right=at,nt._color=Qe._color,Ge._color=rt,Qe._color=rt,at._color=rt,recount(Qe),recount(nt),it>1&&((ot=Ne[it-2]).left===Qe?ot.left=nt:ot.right=nt),void(Ne[it-1]=nt);if(nt.left&&nt.left._color===tt)return at=(nt=Qe.right=cloneNode(nt)).left=cloneNode(nt.left),Qe.right=at.left,nt.left=at.right,at.left=Qe,at.right=nt,at._color=Qe._color,Qe._color=rt,nt._color=rt,Ge._color=rt,recount(Qe),recount(nt),recount(at),it>1&&((ot=Ne[it-2]).left===Qe?ot.left=at:ot.right=at),void(Ne[it-1]=at);if(nt._color===rt){if(Qe._color===tt)return Qe._color=rt,void(Qe.right=repaint(tt,nt));Qe.right=repaint(tt,nt);continue}nt=cloneNode(nt),Qe.right=nt.left,nt.left=Qe,nt._color=Qe._color,Qe._color=tt,recount(Qe),recount(nt),it>1&&((ot=Ne[it-2]).left===Qe?ot.left=nt:ot.right=nt),Ne[it-1]=nt,Ne[it]=Qe,it+1<Ne.length?Ne[it+1]=Ge:Ne.push(Ge),it+=2}else{if((nt=Qe.left).left&&nt.left._color===tt)return at=(nt=Qe.left=cloneNode(nt)).left=cloneNode(nt.left),Qe.left=nt.right,nt.right=Qe,nt.left=at,nt._color=Qe._color,Ge._color=rt,Qe._color=rt,at._color=rt,recount(Qe),recount(nt),it>1&&((ot=Ne[it-2]).right===Qe?ot.right=nt:ot.left=nt),void(Ne[it-1]=nt);if(nt.right&&nt.right._color===tt)return at=(nt=Qe.left=cloneNode(nt)).right=cloneNode(nt.right),Qe.left=at.right,nt.right=at.left,at.right=Qe,at.left=nt,at._color=Qe._color,Qe._color=rt,nt._color=rt,Ge._color=rt,recount(Qe),recount(nt),recount(at),it>1&&((ot=Ne[it-2]).right===Qe?ot.right=at:ot.left=at),void(Ne[it-1]=at);if(nt._color===rt){if(Qe._color===tt)return Qe._color=rt,void(Qe.left=repaint(tt,nt));Qe.left=repaint(tt,nt);continue}var ot;nt=cloneNode(nt),Qe.left=nt.right,nt.right=Qe,nt._color=Qe._color,Qe._color=tt,recount(Qe),recount(nt),it>1&&((ot=Ne[it-2]).right===Qe?ot.right=nt:ot.left=nt),Ne[it-1]=nt,Ne[it]=Qe,it+1<Ne.length?Ne[it+1]=Ge:Ne.push(Ge),it+=2}}}function defaultCompare(Ne,Ge){return Ne<Ge?-1:Ne>Ge?1:0}function createRBTree(Ne){return new RedBlackTree(Ne||defaultCompare,null)}Object.defineProperty(at,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(at,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),at.clone=function(){return new RedBlackTreeIterator(this.tree,this._stack.slice())},at.remove=function(){var Ne=this._stack;if(0===Ne.length)return this.tree;var Ge=new Array(Ne.length),Qe=Ne[Ne.length-1];Ge[Ge.length-1]=new RBNode(Qe._color,Qe.key,Qe.value,Qe.left,Qe.right,Qe._count);for(var nt=Ne.length-2;nt>=0;--nt)(Qe=Ne[nt]).left===Ne[nt+1]?Ge[nt]=new RBNode(Qe._color,Qe.key,Qe.value,Ge[nt+1],Qe.right,Qe._count):Ge[nt]=new RBNode(Qe._color,Qe.key,Qe.value,Qe.left,Ge[nt+1],Qe._count);if((Qe=Ge[Ge.length-1]).left&&Qe.right){var at=Ge.length;for(Qe=Qe.left;Qe.right;)Ge.push(Qe),Qe=Qe.right;var it=Ge[at-1];for(Ge.push(new RBNode(Qe._color,it.key,it.value,Qe.left,Qe.right,Qe._count)),Ge[at-1].key=Qe.key,Ge[at-1].value=Qe.value,nt=Ge.length-2;nt>=at;--nt)Qe=Ge[nt],Ge[nt]=new RBNode(Qe._color,Qe.key,Qe.value,Qe.left,Ge[nt+1],Qe._count);Ge[at-1].left=Ge[at]}if((Qe=Ge[Ge.length-1])._color===tt){var ot=Ge[Ge.length-2];for(ot.left===Qe?ot.left=null:ot.right===Qe&&(ot.right=null),Ge.pop(),nt=0;nt<Ge.length;++nt)Ge[nt]._count--;return new RedBlackTree(this.tree._compare,Ge[0])}if(Qe.left||Qe.right){for(Qe.left?swapNode(Qe,Qe.left):Qe.right&&swapNode(Qe,Qe.right),Qe._color=rt,nt=0;nt<Ge.length-1;++nt)Ge[nt]._count--;return new RedBlackTree(this.tree._compare,Ge[0])}if(1===Ge.length)return new RedBlackTree(this.tree._compare,null);for(nt=0;nt<Ge.length;++nt)Ge[nt]._count--;var dt=Ge[Ge.length-2];return fixDoubleBlack(Ge),dt.left===Qe?dt.left=null:dt.right=null,new RedBlackTree(this.tree._compare,Ge[0])},Object.defineProperty(at,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(at,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(at,"index",{get:function(){var Ne=0,Ge=this._stack;if(0===Ge.length){var Qe=this.tree.root;return Qe?Qe._count:0}Ge[Ge.length-1].left&&(Ne=Ge[Ge.length-1].left._count);for(var tt=Ge.length-2;tt>=0;--tt)Ge[tt+1]===Ge[tt].right&&(++Ne,Ge[tt].left&&(Ne+=Ge[tt].left._count));return Ne},enumerable:!0}),at.next=function(){var Ne=this._stack;if(0!==Ne.length){var Ge=Ne[Ne.length-1];if(Ge.right)for(Ge=Ge.right;Ge;)Ne.push(Ge),Ge=Ge.left;else for(Ne.pop();Ne.length>0&&Ne[Ne.length-1].right===Ge;)Ge=Ne[Ne.length-1],Ne.pop()}},Object.defineProperty(at,"hasNext",{get:function(){var Ne=this._stack;if(0===Ne.length)return!1;if(Ne[Ne.length-1].right)return!0;for(var Ge=Ne.length-1;Ge>0;--Ge)if(Ne[Ge-1].left===Ne[Ge])return!0;return!1}}),at.update=function(Ne){var Ge=this._stack;if(0===Ge.length)throw new Error("Can't update empty node!");var Qe=new Array(Ge.length),tt=Ge[Ge.length-1];Qe[Qe.length-1]=new RBNode(tt._color,tt.key,Ne,tt.left,tt.right,tt._count);for(var rt=Ge.length-2;rt>=0;--rt)(tt=Ge[rt]).left===Ge[rt+1]?Qe[rt]=new RBNode(tt._color,tt.key,tt.value,Qe[rt+1],tt.right,tt._count):Qe[rt]=new RBNode(tt._color,tt.key,tt.value,tt.left,Qe[rt+1],tt._count);return new RedBlackTree(this.tree._compare,Qe[0])},at.prev=function(){var Ne=this._stack;if(0!==Ne.length){var Ge=Ne[Ne.length-1];if(Ge.left)for(Ge=Ge.left;Ge;)Ne.push(Ge),Ge=Ge.right;else for(Ne.pop();Ne.length>0&&Ne[Ne.length-1].left===Ge;)Ge=Ne[Ne.length-1],Ne.pop()}},Object.defineProperty(at,"hasPrev",{get:function(){var Ne=this._stack;if(0===Ne.length)return!1;if(Ne[Ne.length-1].left)return!0;for(var Ge=Ne.length-1;Ge>0;--Ge)if(Ne[Ge-1].right===Ne[Ge])return!0;return!1}})},{}],248:[function(Ne,Ge,Qe){var tt=7,rt=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7],nt=607/128,at=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];function lngamma(Ne){if(Ne<0)return Number("0/0");for(var Ge=at[0],Qe=at.length-1;Qe>0;--Qe)Ge+=at[Qe]/(Ne+Qe);var tt=Ne+nt+.5;return.5*Math.log(2*Math.PI)+(Ne+.5)*Math.log(tt)-tt+Math.log(Ge)-Math.log(Ne)}Ge.exports=function gamma(Ne){if(Ne<.5)return Math.PI/(Math.sin(Math.PI*Ne)*gamma(1-Ne));if(Ne>100)return Math.exp(lngamma(Ne));Ne-=1;for(var Ge=rt[0],Qe=1;Qe<tt+2;Qe++)Ge+=rt[Qe]/(Ne+Qe);var nt=Ne+tt+.5;return Math.sqrt(2*Math.PI)*Math.pow(nt,Ne+.5)*Math.exp(-nt)*Ge},Ge.exports.log=lngamma},{}],249:[function(Ne,Ge,Qe){function getCanvasContext(Ne,Ge){if("string"!=typeof Ne)throw new TypeError("must specify type string");if(Ge=Ge||{},"undefined"==typeof document&&!Ge.canvas)return null;var Qe=Ge.canvas||document.createElement("canvas");"number"==typeof Ge.width&&(Qe.width=Ge.width),"number"==typeof Ge.height&&(Qe.height=Ge.height);var tt,rt=Ge;try{var nt=[Ne];0===Ne.indexOf("webgl")&&nt.push("experimental-"+Ne);for(var at=0;at<nt.length;at++)if(tt=Qe.getContext(nt[at],rt))return tt}catch(Ne){tt=null}return tt||null}Ge.exports=getCanvasContext},{}],250:[function(Ne,Ge,Qe){"use strict";Ge.exports=createAxes;var tt=Ne("./lib/text.js"),rt=Ne("./lib/lines.js"),nt=Ne("./lib/background.js"),at=Ne("./lib/cube.js"),it=Ne("./lib/ticks.js"),ot=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);function copyVec3(Ne,Ge){return Ne[0]=Ge[0],Ne[1]=Ge[1],Ne[2]=Ge[2],Ne}function Axes(Ne){this.gl=Ne,this.pixelRatio=1,this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.autoTicks=!0,this.tickSpacing=[1,1,1],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickAlign=["auto","auto","auto"],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[10,10,10],this.lastCubeProps={cubeEdges:[0,0,0],axis:[0,0,0]},this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont="sans-serif",this.labelSize=[20,20,20],this.labelAngle=[0,0,0],this.labelAlign=["auto","auto","auto"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[10,10,10],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[0,0,0],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!1,!1,!1],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._firstInit=!0,this._text=null,this._lines=null,this._background=nt(Ne)}var dt=Axes.prototype;function OffsetInfo(){this.primalOffset=[0,0,0],this.primalMinor=[0,0,0],this.mirrorOffset=[0,0,0],this.mirrorMinor=[0,0,0]}dt.update=function(Ne){function parseOption(Ge,Qe,tt){if(tt in Ne){var rt,nt=Ne[tt],at=this[tt];(Ge?Array.isArray(nt)&&Array.isArray(nt[0]):Array.isArray(nt))?this[tt]=rt=[Qe(nt[0]),Qe(nt[1]),Qe(nt[2])]:this[tt]=rt=[Qe(nt),Qe(nt),Qe(nt)];for(var it=0;it<3;++it)if(rt[it]!==at[it])return!0}return!1}Ne=Ne||{};var Ge,Qe=parseOption.bind(this,!1,Number),nt=parseOption.bind(this,!1,Boolean),at=parseOption.bind(this,!1,String),ot=parseOption.bind(this,!0,(function(Ne){if(Array.isArray(Ne)){if(3===Ne.length)return[+Ne[0],+Ne[1],+Ne[2],1];if(4===Ne.length)return[+Ne[0],+Ne[1],+Ne[2],+Ne[3]]}return[0,0,0,1]})),dt=!1,ht=!1;if("bounds"in Ne)for(var Dt=Ne.bounds,Ot=0;Ot<2;++Ot)for(var Rt=0;Rt<3;++Rt)Dt[Ot][Rt]!==this.bounds[Ot][Rt]&&(ht=!0),this.bounds[Ot][Rt]=Dt[Ot][Rt];if("ticks"in Ne)for(Ge=Ne.ticks,dt=!0,this.autoTicks=!1,Ot=0;Ot<3;++Ot)this.tickSpacing[Ot]=0;else Qe("tickSpacing")&&(this.autoTicks=!0,ht=!0);if(this._firstInit&&("ticks"in Ne||"tickSpacing"in Ne||(this.autoTicks=!0),ht=!0,dt=!0,this._firstInit=!1),ht&&this.autoTicks&&(Ge=it.create(this.bounds,this.tickSpacing),dt=!0),dt){for(Ot=0;Ot<3;++Ot)Ge[Ot].sort((function(Ne,Ge){return Ne.x-Ge.x}));it.equal(Ge,this.ticks)?dt=!1:this.ticks=Ge}nt("tickEnable"),at("tickFont")&&(dt=!0),Qe("tickSize"),Qe("tickAngle"),Qe("tickPad"),ot("tickColor");var Zt=at("labels");at("labelFont")&&(Zt=!0),nt("labelEnable"),Qe("labelSize"),Qe("labelPad"),ot("labelColor"),nt("lineEnable"),nt("lineMirror"),Qe("lineWidth"),ot("lineColor"),nt("lineTickEnable"),nt("lineTickMirror"),Qe("lineTickLength"),Qe("lineTickWidth"),ot("lineTickColor"),nt("gridEnable"),Qe("gridWidth"),ot("gridColor"),nt("zeroEnable"),ot("zeroLineColor"),Qe("zeroLineWidth"),nt("backgroundEnable"),ot("backgroundColor"),this._text?this._text&&(Zt||dt)&&this._text.update(this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont):this._text=tt(this.gl,this.bounds,this.labels,this.labelFont,this.ticks,this.tickFont),this._lines&&dt&&(this._lines.dispose(),this._lines=null),this._lines||(this._lines=rt(this.gl,this.bounds,this.ticks))};var ht=[new OffsetInfo,new OffsetInfo,new OffsetInfo];function computeLineOffset(Ne,Ge,Qe,tt,rt){for(var nt=Ne.primalOffset,at=Ne.primalMinor,it=Ne.mirrorOffset,ot=Ne.mirrorMinor,dt=tt[Ge],ht=0;ht<3;++ht)if(Ge!==ht){var Dt=nt,Ot=it,Rt=at,Zt=ot;dt&1<<ht&&(Dt=it,Ot=nt,Rt=ot,Zt=at),Dt[ht]=Qe[0][ht],Ot[ht]=Qe[1][ht],rt[ht]>0?(Rt[ht]=-1,Zt[ht]=0):(Rt[ht]=0,Zt[ht]=1)}}var Dt=[0,0,0],Ot={model:ot,view:ot,projection:ot,_ortho:!1};dt.isOpaque=function(){return!0},dt.isTransparent=function(){return!1},dt.drawTransparent=function(Ne){};var Rt=0,Zt=[0,0,0],er=[0,0,0],dr=[0,0,0];function createAxes(Ne,Ge){var Qe=new Axes(Ne);return Qe.update(Ge),Qe}dt.draw=function(Ne){Ne=Ne||Ot;for(var Ge=this.gl,Qe=Ne.model||ot,tt=Ne.view||ot,rt=Ne.projection||ot,nt=this.bounds,it=Ne._ortho||!1,dt=at(Qe,tt,rt,nt,it),mr=dt.cubeEdges,xr=dt.axis,br=tt[12],Ar=tt[13],en=tt[14],mn=tt[15],xn=(it?2:1)*this.pixelRatio*(rt[3]*br+rt[7]*Ar+rt[11]*en+rt[15]*mn)/Ge.drawingBufferHeight,kn=0;kn<3;++kn)this.lastCubeProps.cubeEdges[kn]=mr[kn],this.lastCubeProps.axis[kn]=xr[kn];var Cn=ht;for(kn=0;kn<3;++kn)computeLineOffset(ht[kn],kn,this.bounds,mr,xr);Ge=this.gl;var En,Pn=Dt;for(kn=0;kn<3;++kn)this.backgroundEnable[kn]?Pn[kn]=xr[kn]:Pn[kn]=0;for(this._background.draw(Qe,tt,rt,nt,Pn,this.backgroundColor),this._lines.bind(Qe,tt,rt,this),kn=0;kn<3;++kn){var Dn=[0,0,0];xr[kn]>0?Dn[kn]=nt[1][kn]:Dn[kn]=nt[0][kn];for(var In=0;In<2;++In){var zn=(kn+1+In)%3,Bn=(kn+1+(1^In))%3;this.gridEnable[zn]&&this._lines.drawGrid(zn,Bn,this.bounds,Dn,this.gridColor[zn],this.gridWidth[zn]*this.pixelRatio)}for(In=0;In<2;++In)zn=(kn+1+In)%3,Bn=(kn+1+(1^In))%3,this.zeroEnable[Bn]&&Math.min(nt[0][Bn],nt[1][Bn])<=0&&Math.max(nt[0][Bn],nt[1][Bn])>=0&&this._lines.drawZero(zn,Bn,this.bounds,Dn,this.zeroLineColor[Bn],this.zeroLineWidth[Bn]*this.pixelRatio)}for(kn=0;kn<3;++kn){this.lineEnable[kn]&&this._lines.drawAxisLine(kn,this.bounds,Cn[kn].primalOffset,this.lineColor[kn],this.lineWidth[kn]*this.pixelRatio),this.lineMirror[kn]&&this._lines.drawAxisLine(kn,this.bounds,Cn[kn].mirrorOffset,this.lineColor[kn],this.lineWidth[kn]*this.pixelRatio);var Vn=copyVec3(Zt,Cn[kn].primalMinor),Hn=copyVec3(er,Cn[kn].mirrorMinor),qn=this.lineTickLength;for(In=0;In<3;++In){var Yn=xn/Qe[5*In];Vn[In]*=qn[In]*Yn,Hn[In]*=qn[In]*Yn}this.lineTickEnable[kn]&&this._lines.drawAxisTicks(kn,Cn[kn].primalOffset,Vn,this.lineTickColor[kn],this.lineTickWidth[kn]*this.pixelRatio),this.lineTickMirror[kn]&&this._lines.drawAxisTicks(kn,Cn[kn].mirrorOffset,Hn,this.lineTickColor[kn],this.lineTickWidth[kn]*this.pixelRatio)}this._lines.unbind(),this._text.bind(Qe,tt,rt,this.pixelRatio);var $n,ra,oa=.5;function alignTo(Ne){(ra=[0,0,0])[Ne]=1}function solveTickAlignments(Ne,Ge,Qe){var tt=(Ne+1)%3,rt=(Ne+2)%3,nt=Ge[tt],at=Ge[rt],it=Qe[tt],ot=Qe[rt];nt>0&&ot>0||nt>0&&ot<0||nt<0&&ot>0||nt<0&&ot<0?alignTo(tt):(at>0&&it>0||at>0&&it<0||at<0&&it>0||at<0&&it<0)&&alignTo(rt)}for(kn=0;kn<3;++kn){var pa=Cn[kn].primalMinor,ga=Cn[kn].mirrorMinor,ma=copyVec3(dr,Cn[kn].primalOffset);for(In=0;In<3;++In)this.lineTickEnable[kn]&&(ma[In]+=xn*pa[In]*Math.max(this.lineTickLength[In],0)/Qe[5*In]);var _a=[0,0,0];if(_a[kn]=1,this.tickEnable[kn]){for(-3600===this.tickAngle[kn]?(this.tickAngle[kn]=0,this.tickAlign[kn]="auto"):this.tickAlign[kn]=-1,$n=1,"auto"===(En=[this.tickAlign[kn],oa,$n])[0]?En[0]=Rt:En[0]=parseInt(""+En[0]),ra=[0,0,0],solveTickAlignments(kn,pa,ga),In=0;In<3;++In)ma[In]+=xn*pa[In]*this.tickPad[In]/Qe[5*In];this._text.drawTicks(kn,this.tickSize[kn],this.tickAngle[kn],ma,this.tickColor[kn],_a,ra,En)}if(this.labelEnable[kn]){for($n=0,ra=[0,0,0],this.labels[kn].length>4&&(alignTo(kn),$n=1),"auto"===(En=[this.labelAlign[kn],oa,$n])[0]?En[0]=Rt:En[0]=parseInt(""+En[0]),In=0;In<3;++In)ma[In]+=xn*pa[In]*this.labelPad[In]/Qe[5*In];ma[kn]+=.5*(nt[0][kn]+nt[1][kn]),this._text.drawLabel(kn,this.labelSize[kn],this.labelAngle[kn],ma,this.labelColor[kn],[0,0,0],ra,En)}}this._text.unbind()},dt.dispose=function(){this._text.dispose(),this._lines.dispose(),this._background.dispose(),this._lines=null,this._text=null,this._background=null,this.gl=null}},{"./lib/background.js":251,"./lib/cube.js":252,"./lib/lines.js":253,"./lib/text.js":255,"./lib/ticks.js":256}],251:[function(Ne,Ge,Qe){"use strict";Ge.exports=createBackgroundCube;var tt=Ne("gl-buffer"),rt=Ne("gl-vao"),nt=Ne("./shaders").bg;function BackgroundCube(Ne,Ge,Qe,tt){this.gl=Ne,this.buffer=Ge,this.vao=Qe,this.shader=tt}var at=BackgroundCube.prototype;function createBackgroundCube(Ne){for(var Ge=[],Qe=[],at=0,it=0;it<3;++it)for(var ot=(it+1)%3,dt=(it+2)%3,ht=[0,0,0],Dt=[0,0,0],Ot=-1;Ot<=1;Ot+=2){Qe.push(at,at+2,at+1,at+1,at+2,at+3),ht[it]=Ot,Dt[it]=Ot;for(var Rt=-1;Rt<=1;Rt+=2){ht[ot]=Rt;for(var Zt=-1;Zt<=1;Zt+=2)ht[dt]=Zt,Ge.push(ht[0],ht[1],ht[2],Dt[0],Dt[1],Dt[2]),at+=1}var er=ot;ot=dt,dt=er}var dr=tt(Ne,new Float32Array(Ge)),mr=tt(Ne,new Uint16Array(Qe),Ne.ELEMENT_ARRAY_BUFFER),xr=rt(Ne,[{buffer:dr,type:Ne.FLOAT,size:3,offset:0,stride:24},{buffer:dr,type:Ne.FLOAT,size:3,offset:12,stride:24}],mr),br=nt(Ne);return br.attributes.position.location=0,br.attributes.normal.location=1,new BackgroundCube(Ne,dr,xr,br)}at.draw=function(Ne,Ge,Qe,tt,rt,nt){for(var at=!1,it=0;it<3;++it)at=at||rt[it];if(at){var ot=this.gl;ot.enable(ot.POLYGON_OFFSET_FILL),ot.polygonOffset(1,2),this.shader.bind(),this.shader.uniforms={model:Ne,view:Ge,projection:Qe,bounds:tt,enable:rt,colors:nt},this.vao.bind(),this.vao.draw(this.gl.TRIANGLES,36),this.vao.unbind(),ot.disable(ot.POLYGON_OFFSET_FILL)}},at.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders":254,"gl-buffer":259,"gl-vao":358}],252:[function(Ne,Ge,Qe){"use strict";Ge.exports=getCubeEdges;var tt=Ne("bit-twiddle"),rt=Ne("gl-mat4/multiply"),nt=Ne("split-polygon"),at=Ne("robust-orientation"),it=new Array(16),ot=new Array(8),dt=new Array(8),ht=new Array(3),Dt=[0,0,0];function transformHg(Ne,Ge,Qe){for(var tt=0;tt<4;++tt){Ne[tt]=Qe[12+tt];for(var rt=0;rt<3;++rt)Ne[tt]+=Ge[rt]*Qe[4*rt+tt]}}!function(){for(var Ne=0;Ne<8;++Ne)ot[Ne]=[1,1,1,1],dt[Ne]=[1,1,1]}();var Ot=[[0,0,1,0,0],[0,0,-1,1,0],[0,-1,0,1,0],[0,1,0,1,0],[-1,0,0,1,0],[1,0,0,1,0]];function polygonArea(Ne){for(var Ge=0;Ge<Ot.length;++Ge)if((Ne=nt.positive(Ne,Ot[Ge])).length<3)return 0;var Qe=Ne[0],tt=Qe[0]/Qe[3],rt=Qe[1]/Qe[3],at=0;for(Ge=1;Ge+1<Ne.length;++Ge){var it=Ne[Ge],ot=Ne[Ge+1],dt=it[0]/it[3]-tt,ht=it[1]/it[3]-rt,Dt=ot[0]/ot[3]-tt,Rt=ot[1]/ot[3]-rt;at+=Math.abs(dt*Rt-ht*Dt)}return at}var Rt=[1,1,1],Zt=[0,0,0],er={cubeEdges:Rt,axis:Zt};function getCubeEdges(Ne,Ge,Qe,nt,Ot){rt(it,Ge,Ne),rt(it,Qe,it);for(var dr=0,mr=0;mr<2;++mr){ht[2]=nt[mr][2];for(var xr=0;xr<2;++xr){ht[1]=nt[xr][1];for(var br=0;br<2;++br)ht[0]=nt[br][0],transformHg(ot[dr],ht,it),dr+=1}}var Ar=-1;for(mr=0;mr<8;++mr){for(var en=ot[mr][3],mn=0;mn<3;++mn)dt[mr][mn]=ot[mr][mn]/en;Ot&&(dt[mr][2]*=-1),en<0&&(Ar<0||dt[mr][2]<dt[Ar][2])&&(Ar=mr)}if(Ar<0){Ar=0;for(var xn=0;xn<3;++xn){for(var kn=(xn+2)%3,Cn=(xn+1)%3,En=-1,Pn=-1,Dn=0;Dn<2;++Dn){var In=(Bn=Dn<<xn)+(Dn<<kn)+(1-Dn<<Cn),zn=Bn+(1-Dn<<kn)+(Dn<<Cn);at(dt[Bn],dt[In],dt[zn],Dt)<0||(Dn?En=1:Pn=1)}if(En<0||Pn<0)Pn>En&&(Ar|=1<<xn);else{for(Dn=0;Dn<2;++Dn){In=(Bn=Dn<<xn)+(Dn<<kn)+(1-Dn<<Cn),zn=Bn+(1-Dn<<kn)+(Dn<<Cn);var Bn,Vn=polygonArea([ot[Bn],ot[In],ot[zn],ot[Bn+(1<<kn)+(1<<Cn)]]);Dn?En=Vn:Pn=Vn}Pn>En&&(Ar|=1<<xn)}}}var Hn=7^Ar,qn=-1;for(mr=0;mr<8;++mr)mr!==Ar&&mr!==Hn&&(qn<0||dt[qn][1]>dt[mr][1])&&(qn=mr);var Yn=-1;for(mr=0;mr<3;++mr)(ra=qn^1<<mr)!==Ar&&ra!==Hn&&(Yn<0&&(Yn=ra),(Cn=dt[ra])[0]<dt[Yn][0]&&(Yn=ra));var $n=-1;for(mr=0;mr<3;++mr){var ra;(ra=qn^1<<mr)!==Ar&&ra!==Hn&&ra!==Yn&&($n<0&&($n=ra),(Cn=dt[ra])[0]>dt[$n][0]&&($n=ra))}var oa=Rt;oa[0]=oa[1]=oa[2]=0,oa[tt.log2(Yn^qn)]=qn&Yn,oa[tt.log2(qn^$n)]=qn&$n;var pa=7^$n;pa===Ar||pa===Hn?(pa=7^Yn,oa[tt.log2($n^pa)]=pa&$n):oa[tt.log2(Yn^pa)]=pa&Yn;var ga=Zt,ma=Ar;for(xn=0;xn<3;++xn)ga[xn]=ma&1<<xn?-1:1;return er}},{"bit-twiddle":97,"gl-mat4/multiply":295,"robust-orientation":548,"split-polygon":566}],253:[function(Ne,Ge,Qe){"use strict";Ge.exports=createLines;var tt=Ne("gl-buffer"),rt=Ne("gl-vao"),nt=Ne("./shaders").line,at=[0,0,0],it=[0,0,0],ot=[0,0,0],dt=[0,0,0],ht=[1,1];function zeroVec(Ne){return Ne[0]=Ne[1]=Ne[2]=0,Ne}function copyVec(Ne,Ge){return Ne[0]=Ge[0],Ne[1]=Ge[1],Ne[2]=Ge[2],Ne}function Lines(Ne,Ge,Qe,tt,rt,nt,at,it){this.gl=Ne,this.vertBuffer=Ge,this.vao=Qe,this.shader=tt,this.tickCount=rt,this.tickOffset=nt,this.gridCount=at,this.gridOffset=it}var Dt=Lines.prototype;function createLines(Ne,Ge,Qe){var at=[],it=[0,0,0],ot=[0,0,0],dt=[0,0,0],ht=[0,0,0];at.push(0,0,1,0,1,1,0,0,-1,0,0,-1,0,1,1,0,1,-1);for(var Dt=0;Dt<3;++Dt){for(var Ot=at.length/3|0,Rt=0;Rt<Qe[Dt].length;++Rt){var Zt=+Qe[Dt][Rt].x;at.push(Zt,0,1,Zt,1,1,Zt,0,-1,Zt,0,-1,Zt,1,1,Zt,1,-1)}var er=at.length/3|0;it[Dt]=Ot,ot[Dt]=er-Ot,Ot=at.length/3|0;for(var dr=0;dr<Qe[Dt].length;++dr)Zt=+Qe[Dt][dr].x,at.push(Zt,0,1,Zt,1,1,Zt,0,-1,Zt,0,-1,Zt,1,1,Zt,1,-1);er=at.length/3|0,dt[Dt]=Ot,ht[Dt]=er-Ot}var mr=tt(Ne,new Float32Array(at)),xr=rt(Ne,[{buffer:mr,type:Ne.FLOAT,size:3,stride:0,offset:0}]),br=nt(Ne);return br.attributes.position.location=0,new Lines(Ne,mr,xr,br,ot,it,ht,dt)}Dt.bind=function(Ne,Ge,Qe){this.shader.bind(),this.shader.uniforms.model=Ne,this.shader.uniforms.view=Ge,this.shader.uniforms.projection=Qe,ht[0]=this.gl.drawingBufferWidth,ht[1]=this.gl.drawingBufferHeight,this.shader.uniforms.screenShape=ht,this.vao.bind()},Dt.unbind=function(){this.vao.unbind()},Dt.drawAxisLine=function(Ne,Ge,Qe,tt,rt){var nt=zeroVec(it);this.shader.uniforms.majorAxis=it,nt[Ne]=Ge[1][Ne]-Ge[0][Ne],this.shader.uniforms.minorAxis=nt;var at,ht=copyVec(dt,Qe);ht[Ne]+=Ge[0][Ne],this.shader.uniforms.offset=ht,this.shader.uniforms.lineWidth=rt,this.shader.uniforms.color=tt,(at=zeroVec(ot))[(Ne+2)%3]=1,this.shader.uniforms.screenAxis=at,this.vao.draw(this.gl.TRIANGLES,6),(at=zeroVec(ot))[(Ne+1)%3]=1,this.shader.uniforms.screenAxis=at,this.vao.draw(this.gl.TRIANGLES,6)},Dt.drawAxisTicks=function(Ne,Ge,Qe,tt,rt){if(this.tickCount[Ne]){var nt=zeroVec(at);nt[Ne]=1,this.shader.uniforms.majorAxis=nt,this.shader.uniforms.offset=Ge,this.shader.uniforms.minorAxis=Qe,this.shader.uniforms.color=tt,this.shader.uniforms.lineWidth=rt;var it=zeroVec(ot);it[Ne]=1,this.shader.uniforms.screenAxis=it,this.vao.draw(this.gl.TRIANGLES,this.tickCount[Ne],this.tickOffset[Ne])}},Dt.drawGrid=function(Ne,Ge,Qe,tt,rt,nt){if(this.gridCount[Ne]){var ht=zeroVec(it);ht[Ge]=Qe[1][Ge]-Qe[0][Ge],this.shader.uniforms.minorAxis=ht;var Dt=copyVec(dt,tt);Dt[Ge]+=Qe[0][Ge],this.shader.uniforms.offset=Dt;var Ot=zeroVec(at);Ot[Ne]=1,this.shader.uniforms.majorAxis=Ot;var Rt=zeroVec(ot);Rt[Ne]=1,this.shader.uniforms.screenAxis=Rt,this.shader.uniforms.lineWidth=nt,this.shader.uniforms.color=rt,this.vao.draw(this.gl.TRIANGLES,this.gridCount[Ne],this.gridOffset[Ne])}},Dt.drawZero=function(Ne,Ge,Qe,tt,rt,nt){var at=zeroVec(it);this.shader.uniforms.majorAxis=at,at[Ne]=Qe[1][Ne]-Qe[0][Ne],this.shader.uniforms.minorAxis=at;var ht=copyVec(dt,tt);ht[Ne]+=Qe[0][Ne],this.shader.uniforms.offset=ht;var Dt=zeroVec(ot);Dt[Ge]=1,this.shader.uniforms.screenAxis=Dt,this.shader.uniforms.lineWidth=nt,this.shader.uniforms.color=rt,this.vao.draw(this.gl.TRIANGLES,6)},Dt.dispose=function(){this.vao.dispose(),this.vertBuffer.dispose(),this.shader.dispose()}},{"./shaders":254,"gl-buffer":259,"gl-vao":358}],254:[function(Ne,Ge,Qe){"use strict";var tt=Ne("glslify"),rt=Ne("gl-shader"),nt=tt(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, majorAxis, minorAxis, screenAxis;\nuniform float lineWidth;\nuniform vec2 screenShape;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nvoid main() {\n  vec3 major = position.x * majorAxis;\n  vec3 minor = position.y * minorAxis;\n\n  vec3 vPosition = major + minor + offset;\n  vec3 pPosition = project(vPosition);\n  vec3 offset = project(vPosition + screenAxis * position.z);\n\n  vec2 screen = normalize((offset - pPosition).xy * screenShape) / screenShape;\n\n  gl_Position = vec4(pPosition + vec3(0.5 * screen * lineWidth, 0), 1.0);\n}\n"]),at=tt(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);Qe.line=function(Ne){return rt(Ne,nt,at,null,[{name:"position",type:"vec3"}])};var it=tt(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\nuniform vec3 offset, axis, alignDir, alignOpt;\nuniform float scale, angle, pixelScale;\nuniform vec2 resolution;\n\nvec3 project(vec3 p) {\n  vec4 pp = projection * view * model * vec4(p, 1.0);\n  return pp.xyz / max(pp.w, 0.0001);\n}\n\nfloat computeViewAngle(vec3 a, vec3 b) {\n  vec3 A = project(a);\n  vec3 B = project(b);\n\n  return atan(\n    (B.y - A.y) * resolution.y,\n    (B.x - A.x) * resolution.x\n  );\n}\n\nconst float PI = 3.141592;\nconst float TWO_PI = 2.0 * PI;\nconst float HALF_PI = 0.5 * PI;\nconst float ONE_AND_HALF_PI = 1.5 * PI;\n\nint option = int(floor(alignOpt.x + 0.001));\nfloat hv_ratio =       alignOpt.y;\nbool enableAlign =    (alignOpt.z != 0.0);\n\nfloat mod_angle(float a) {\n  return mod(a, PI);\n}\n\nfloat positive_angle(float a) {\n  return mod_angle((a < 0.0) ?\n    a + TWO_PI :\n    a\n  );\n}\n\nfloat look_upwards(float a) {\n  float b = positive_angle(a);\n  return ((b > HALF_PI) && (b <= ONE_AND_HALF_PI)) ?\n    b - PI :\n    b;\n}\n\nfloat look_horizontal_or_vertical(float a, float ratio) {\n  // ratio controls the ratio between being horizontal to (vertical + horizontal)\n  // if ratio is set to 0.5 then it is 50%, 50%.\n  // when using a higher ratio e.g. 0.75 the result would\n  // likely be more horizontal than vertical.\n\n  float b = positive_angle(a);\n\n  return\n    (b < (      ratio) * HALF_PI) ? 0.0 :\n    (b < (2.0 - ratio) * HALF_PI) ? -HALF_PI :\n    (b < (2.0 + ratio) * HALF_PI) ? 0.0 :\n    (b < (4.0 - ratio) * HALF_PI) ? HALF_PI :\n                                    0.0;\n}\n\nfloat roundTo(float a, float b) {\n  return float(b * floor((a + 0.5 * b) / b));\n}\n\nfloat look_round_n_directions(float a, int n) {\n  float b = positive_angle(a);\n  float div = TWO_PI / float(n);\n  float c = roundTo(b, div);\n  return look_upwards(c);\n}\n\nfloat applyAlignOption(float rawAngle, float delta) {\n  return\n    (option >  2) ? look_round_n_directions(rawAngle + delta, option) :       // option 3-n: round to n directions\n    (option == 2) ? look_horizontal_or_vertical(rawAngle + delta, hv_ratio) : // horizontal or vertical\n    (option == 1) ? rawAngle + delta :       // use free angle, and flip to align with one direction of the axis\n    (option == 0) ? look_upwards(rawAngle) : // use free angle, and stay upwards\n    (option ==-1) ? 0.0 :                    // useful for backward compatibility, all texts remains horizontal\n                    rawAngle;                // otherwise return back raw input angle\n}\n\nbool isAxisTitle = (axis.x == 0.0) &&\n                   (axis.y == 0.0) &&\n                   (axis.z == 0.0);\n\nvoid main() {\n  //Compute world offset\n  float axisDistance = position.z;\n  vec3 dataPosition = axisDistance * axis + offset;\n\n  float beta = angle; // i.e. user defined attributes for each tick\n\n  float axisAngle;\n  float clipAngle;\n  float flip;\n\n  if (enableAlign) {\n    axisAngle = (isAxisTitle) ? HALF_PI :\n                      computeViewAngle(dataPosition, dataPosition + axis);\n    clipAngle = computeViewAngle(dataPosition, dataPosition + alignDir);\n\n    axisAngle += (sin(axisAngle) < 0.0) ? PI : 0.0;\n    clipAngle += (sin(clipAngle) < 0.0) ? PI : 0.0;\n\n    flip = (dot(vec2(cos(axisAngle), sin(axisAngle)),\n                vec2(sin(clipAngle),-cos(clipAngle))) > 0.0) ? 1.0 : 0.0;\n\n    beta += applyAlignOption(clipAngle, flip * PI);\n  }\n\n  //Compute plane offset\n  vec2 planeCoord = position.xy * pixelScale;\n\n  mat2 planeXform = scale * mat2(\n     cos(beta), sin(beta),\n    -sin(beta), cos(beta)\n  );\n\n  vec2 viewOffset = 2.0 * planeXform * planeCoord / resolution;\n\n  //Compute clip position\n  vec3 clipPosition = project(dataPosition);\n\n  //Apply text offset in clip coordinates\n  clipPosition += vec3(viewOffset, 0.0);\n\n  //Done\n  gl_Position = vec4(clipPosition, 1.0);\n}"]),ot=tt(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = color;\n}"]);Qe.text=function(Ne){return rt(Ne,it,ot,null,[{name:"position",type:"vec3"}])};var dt=tt(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec3 normal;\n\nuniform mat4 model, view, projection;\nuniform vec3 enable;\nuniform vec3 bounds[2];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n\n  vec3 signAxis = sign(bounds[1] - bounds[0]);\n\n  vec3 realNormal = signAxis * normal;\n\n  if(dot(realNormal, enable) > 0.0) {\n    vec3 minRange = min(bounds[0], bounds[1]);\n    vec3 maxRange = max(bounds[0], bounds[1]);\n    vec3 nPosition = mix(minRange, maxRange, 0.5 * (position + 1.0));\n    gl_Position = projection * view * model * vec4(nPosition, 1.0);\n  } else {\n    gl_Position = vec4(0,0,0,0);\n  }\n\n  colorChannel = abs(realNormal);\n}"]),ht=tt(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec4 colors[3];\n\nvarying vec3 colorChannel;\n\nvoid main() {\n  gl_FragColor = colorChannel.x * colors[0] +\n                 colorChannel.y * colors[1] +\n                 colorChannel.z * colors[2];\n}"]);Qe.bg=function(Ne){return rt(Ne,dt,ht,null,[{name:"position",type:"vec3"},{name:"normal",type:"vec3"}])}},{"gl-shader":335,glslify:257}],255:[function(Ne,Ge,Qe){(function(Qe){(function(){"use strict";Ge.exports=createTextSprites;var tt=Ne("gl-buffer"),rt=Ne("gl-vao"),nt=Ne("vectorize-text"),at=Ne("./shaders").text,it=window||Qe.global||{},ot=it.__TEXT_CACHE||{};it.__TEXT_CACHE={};var dt=3;function TextSprites(Ne,Ge,Qe,tt){this.gl=Ne,this.shader=Ge,this.buffer=Qe,this.vao=tt,this.tickOffset=this.tickCount=this.labelOffset=this.labelCount=null}var ht=TextSprites.prototype,Dt=[0,0];function tryVectorizeText(Ne,Ge){try{return nt(Ne,Ge)}catch(Ge){return console.warn('error vectorizing text:"'+Ne+'" error:',Ge),{cells:[],positions:[]}}}function createTextSprites(Ne,Ge,Qe,nt,it,ot){var dt=tt(Ne),ht=rt(Ne,[{buffer:dt,size:3}]),Dt=at(Ne);Dt.attributes.position.location=0;var Ot=new TextSprites(Ne,Dt,dt,ht);return Ot.update(Ge,Qe,nt,it,ot),Ot}ht.bind=function(Ne,Ge,Qe,tt){this.vao.bind(),this.shader.bind();var rt=this.shader.uniforms;rt.model=Ne,rt.view=Ge,rt.projection=Qe,rt.pixelScale=tt,Dt[0]=this.gl.drawingBufferWidth,Dt[1]=this.gl.drawingBufferHeight,this.shader.uniforms.resolution=Dt},ht.unbind=function(){this.vao.unbind()},ht.update=function(Ne,Ge,Qe,tt,rt){var nt=[];function addItem(Ne,Ge,Qe,tt,rt,at){var it=ot[Qe];it||(it=ot[Qe]={});var dt=it[Ge];dt||(dt=it[Ge]=tryVectorizeText(Ge,{triangles:!0,font:Qe,textAlign:"center",textBaseline:"middle",lineSpacing:rt,styletags:at}));for(var ht=(tt||12)/12,Dt=dt.positions,Ot=dt.cells,Rt=0,Zt=Ot.length;Rt<Zt;++Rt)for(var er=Ot[Rt],dr=2;dr>=0;--dr){var mr=Dt[er[dr]];nt.push(ht*mr[0],-ht*mr[1],Ne)}}for(var at=[0,0,0],it=[0,0,0],ht=[0,0,0],Dt=[0,0,0],Ot=1.25,Rt={breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},Zt=0;Zt<3;++Zt){ht[Zt]=nt.length/dt|0,addItem(.5*(Ne[0][Zt]+Ne[1][Zt]),Ge[Zt],Qe[Zt],12,Ot,Rt),Dt[Zt]=(nt.length/dt|0)-ht[Zt],at[Zt]=nt.length/dt|0;for(var er=0;er<tt[Zt].length;++er)tt[Zt][er].text&&addItem(tt[Zt][er].x,tt[Zt][er].text,tt[Zt][er].font||rt,tt[Zt][er].fontSize||12,Ot,Rt);it[Zt]=(nt.length/dt|0)-at[Zt]}this.buffer.update(nt),this.tickOffset=at,this.tickCount=it,this.labelOffset=ht,this.labelCount=Dt},ht.drawTicks=function(Ne,Ge,Qe,tt,rt,nt,at,it){this.tickCount[Ne]&&(this.shader.uniforms.axis=nt,this.shader.uniforms.color=rt,this.shader.uniforms.angle=Qe,this.shader.uniforms.scale=Ge,this.shader.uniforms.offset=tt,this.shader.uniforms.alignDir=at,this.shader.uniforms.alignOpt=it,this.vao.draw(this.gl.TRIANGLES,this.tickCount[Ne],this.tickOffset[Ne]))},ht.drawLabel=function(Ne,Ge,Qe,tt,rt,nt,at,it){this.labelCount[Ne]&&(this.shader.uniforms.axis=nt,this.shader.uniforms.color=rt,this.shader.uniforms.angle=Qe,this.shader.uniforms.scale=Ge,this.shader.uniforms.offset=tt,this.shader.uniforms.alignDir=at,this.shader.uniforms.alignOpt=it,this.vao.draw(this.gl.TRIANGLES,this.labelCount[Ne],this.labelOffset[Ne]))},ht.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()}}).call(this)}).call(this,Ne("_process"))},{"./shaders":254,_process:526,"gl-buffer":259,"gl-vao":358,"vectorize-text":600}],256:[function(Ne,Ge,Qe){"use strict";function prettyPrint(Ne,Ge){var Qe=Ne+"",tt=Qe.indexOf("."),rt=0;tt>=0&&(rt=Qe.length-tt-1);var nt=Math.pow(10,rt),at=Math.round(Ne*Ge*nt),it=at+"";if(it.indexOf("e")>=0)return it;var ot=at/nt,dt=at%nt;at<0?(ot=0|-Math.ceil(ot),dt=0|-dt):(ot=0|Math.floor(ot),dt|=0);var ht=""+ot;if(at<0&&(ht="-"+ht),rt){for(var Dt=""+dt;Dt.length<rt;)Dt="0"+Dt;return ht+"."+Dt}return ht}function defaultTicks(Ne,Ge){for(var Qe=[],tt=0;tt<3;++tt){for(var rt=[],nt=(Ne[0][tt],Ne[1][tt],0);nt*Ge[tt]<=Ne[1][tt];++nt)rt.push({x:nt*Ge[tt],text:prettyPrint(Ge[tt],nt)});for(nt=-1;nt*Ge[tt]>=Ne[0][tt];--nt)rt.push({x:nt*Ge[tt],text:prettyPrint(Ge[tt],nt)});Qe.push(rt)}return Qe}function ticksEqual(Ne,Ge){for(var Qe=0;Qe<3;++Qe){if(Ne[Qe].length!==Ge[Qe].length)return!1;for(var tt=0;tt<Ne[Qe].length;++tt){var rt=Ne[Qe][tt],nt=Ge[Qe][tt];if(rt.x!==nt.x||rt.text!==nt.text||rt.font!==nt.font||rt.fontColor!==nt.fontColor||rt.fontSize!==nt.fontSize||rt.dx!==nt.dx||rt.dy!==nt.dy)return!1}}return!0}Qe.create=defaultTicks,Qe.equal=ticksEqual},{}],257:[function(Ne,Ge,Qe){Ge.exports=function(Ne){"string"==typeof Ne&&(Ne=[Ne]);for(var Ge=[].slice.call(arguments,1),Qe=[],tt=0;tt<Ne.length-1;tt++)Qe.push(Ne[tt],Ge[tt]||"");return Qe.push(Ne[tt]),Qe.join("")}},{}],258:[function(Ne,Ge,Qe){"use strict";Ge.exports=axesProperties;var tt=Ne("extract-frustum-planes"),rt=Ne("split-polygon"),nt=Ne("./lib/cube.js"),at=Ne("gl-mat4/multiply"),it=Ne("gl-mat4/transpose"),ot=Ne("gl-vec4/transformMat4"),dt=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),ht=new Float32Array(16);function AxesRange3D(Ne,Ge,Qe){this.lo=Ne,this.hi=Ge,this.pixelsPerDataUnit=Qe}var Dt=[0,0,0,1],Ot=[0,0,0,1];function gradient(Ne,Ge,Qe,tt,rt){for(var nt=0;nt<3;++nt){for(var at=Dt,it=Ot,dt=0;dt<3;++dt)it[dt]=at[dt]=Qe[dt];it[3]=at[3]=1,it[nt]+=1,ot(it,it,Ge),it[3]<0&&(Ne[nt]=1/0),at[nt]-=1,ot(at,at,Ge),at[3]<0&&(Ne[nt]=1/0);var ht=(at[0]/at[3]-it[0]/it[3])*tt,Rt=(at[1]/at[3]-it[1]/it[3])*rt;Ne[nt]=.25*Math.sqrt(ht*ht+Rt*Rt)}return Ne}var Rt=[new AxesRange3D(1/0,-1/0,1/0),new AxesRange3D(1/0,-1/0,1/0),new AxesRange3D(1/0,-1/0,1/0)],Zt=[0,0,0];function axesProperties(Ne,Ge,Qe,ot,Dt){var Ot=Ge.model||dt,er=Ge.view||dt,dr=Ge.projection||dt,mr=Ge._ortho||!1,xr=Ne.bounds,br=(Dt=Dt||nt(Ot,er,dr,xr,mr)).axis;at(ht,er,Ot),at(ht,dr,ht);for(var Ar=Rt,en=0;en<3;++en)Ar[en].lo=1/0,Ar[en].hi=-1/0,Ar[en].pixelsPerDataUnit=1/0;var mn=tt(it(ht,ht));it(ht,ht);for(var xn=0;xn<3;++xn){var kn=(xn+1)%3,Cn=(xn+2)%3,En=Zt;e:for(en=0;en<2;++en){var Pn=[];if(br[xn]<0!=!!en){En[xn]=xr[en][xn];for(var Dn=0;Dn<2;++Dn){En[kn]=xr[Dn^en][kn];for(var In=0;In<2;++In)En[Cn]=xr[In^Dn^en][Cn],Pn.push(En.slice())}var zn=mr?5:4;for(Dn=zn;Dn===zn;++Dn){if(0===Pn.length)continue e;Pn=rt.positive(Pn,mn[Dn])}for(Dn=0;Dn<Pn.length;++Dn){Cn=Pn[Dn];var Bn=gradient(Zt,ht,Cn,Qe,ot);for(In=0;In<3;++In)Ar[In].lo=Math.min(Ar[In].lo,Cn[In]),Ar[In].hi=Math.max(Ar[In].hi,Cn[In]),In!==xn&&(Ar[In].pixelsPerDataUnit=Math.min(Ar[In].pixelsPerDataUnit,Math.abs(Bn[In])))}}}}return Ar}},{"./lib/cube.js":252,"extract-frustum-planes":240,"gl-mat4/multiply":295,"gl-mat4/transpose":306,"gl-vec4/transformMat4":429,"split-polygon":566}],259:[function(Ne,Ge,Qe){"use strict";var tt=Ne("typedarray-pool"),rt=Ne("ndarray-ops"),nt=Ne("ndarray"),at=["uint8","uint8_clamped","uint16","uint32","int8","int16","int32","float32"];function GLBuffer(Ne,Ge,Qe,tt,rt){this.gl=Ne,this.type=Ge,this.handle=Qe,this.length=tt,this.usage=rt}var it=GLBuffer.prototype;function updateTypeArray(Ne,Ge,Qe,tt,rt,nt){var at=rt.length*rt.BYTES_PER_ELEMENT;if(nt<0)return Ne.bufferData(Ge,rt,tt),at;if(at+nt>Qe)throw new Error("gl-buffer: If resizing buffer, must not specify offset");return Ne.bufferSubData(Ge,nt,rt),Qe}function makeScratchTypeArray(Ne,Ge){for(var Qe=tt.malloc(Ne.length,Ge),rt=Ne.length,nt=0;nt<rt;++nt)Qe[nt]=Ne[nt];return Qe}function isPacked(Ne,Ge){for(var Qe=1,tt=Ge.length-1;tt>=0;--tt){if(Ge[tt]!==Qe)return!1;Qe*=Ne[tt]}return!0}function createBuffer(Ne,Ge,Qe,tt){if(Qe=Qe||Ne.ARRAY_BUFFER,tt=tt||Ne.DYNAMIC_DRAW,Qe!==Ne.ARRAY_BUFFER&&Qe!==Ne.ELEMENT_ARRAY_BUFFER)throw new Error("gl-buffer: Invalid type for webgl buffer, must be either gl.ARRAY_BUFFER or gl.ELEMENT_ARRAY_BUFFER");if(tt!==Ne.DYNAMIC_DRAW&&tt!==Ne.STATIC_DRAW&&tt!==Ne.STREAM_DRAW)throw new Error("gl-buffer: Invalid usage for buffer, must be either gl.DYNAMIC_DRAW, gl.STATIC_DRAW or gl.STREAM_DRAW");var rt=Ne.createBuffer(),nt=new GLBuffer(Ne,Qe,rt,0,tt);return nt.update(Ge),nt}it.bind=function(){this.gl.bindBuffer(this.type,this.handle)},it.unbind=function(){this.gl.bindBuffer(this.type,null)},it.dispose=function(){this.gl.deleteBuffer(this.handle)},it.update=function(Ne,Ge){if("number"!=typeof Ge&&(Ge=-1),this.bind(),"object"==typeof Ne&&void 0!==Ne.shape){var Qe=Ne.dtype;if(at.indexOf(Qe)<0&&(Qe="float32"),this.type===this.gl.ELEMENT_ARRAY_BUFFER&&(Qe=gl.getExtension("OES_element_index_uint")&&"uint16"!==Qe?"uint32":"uint16"),Qe===Ne.dtype&&isPacked(Ne.shape,Ne.stride))0===Ne.offset&&Ne.data.length===Ne.shape[0]?this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,Ne.data,Ge):this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,Ne.data.subarray(Ne.offset,Ne.shape[0]),Ge);else{var it=tt.malloc(Ne.size,Qe),ot=nt(it,Ne.shape);rt.assign(ot,Ne),this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,Ge<0?it:it.subarray(0,Ne.size),Ge),tt.free(it)}}else if(Array.isArray(Ne)){var dt;dt=this.type===this.gl.ELEMENT_ARRAY_BUFFER?makeScratchTypeArray(Ne,"uint16"):makeScratchTypeArray(Ne,"float32"),this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,Ge<0?dt:dt.subarray(0,Ne.length),Ge),tt.free(dt)}else if("object"==typeof Ne&&"number"==typeof Ne.length)this.length=updateTypeArray(this.gl,this.type,this.length,this.usage,Ne,Ge);else{if("number"!=typeof Ne&&void 0!==Ne)throw new Error("gl-buffer: Invalid data type");if(Ge>=0)throw new Error("gl-buffer: Cannot specify offset when resizing buffer");(Ne|=0)<=0&&(Ne=1),this.gl.bufferData(this.type,0|Ne,this.usage),this.length=Ne}},Ge.exports=createBuffer},{ndarray:495,"ndarray-ops":490,"typedarray-pool":595}],260:[function(Ne,Ge,Qe){"use strict";var tt=Ne("gl-vec3");Ge.exports=function(Ne,Ge){var Qe=Ne.positions,rt=Ne.vectors,nt={positions:[],vertexIntensity:[],vertexIntensityBounds:Ne.vertexIntensityBounds,vectors:[],cells:[],coneOffset:Ne.coneOffset,colormap:Ne.colormap};if(0===Ne.positions.length)return Ge&&(Ge[0]=[0,0,0],Ge[1]=[0,0,0]),nt;for(var at=0,it=1/0,ot=-1/0,dt=1/0,ht=-1/0,Dt=1/0,Ot=-1/0,Rt=null,Zt=null,er=[],dr=1/0,mr=!1,xr=0;xr<Qe.length;xr++){var br=Qe[xr];it=Math.min(br[0],it),ot=Math.max(br[0],ot),dt=Math.min(br[1],dt),ht=Math.max(br[1],ht),Dt=Math.min(br[2],Dt),Ot=Math.max(br[2],Ot);var Ar=rt[xr];if(tt.length(Ar)>at&&(at=tt.length(Ar)),xr){var en=2*tt.distance(Rt,br)/(tt.length(Zt)+tt.length(Ar));en?(dr=Math.min(dr,en),mr=!1):mr=!0}mr||(Rt=br,Zt=Ar),er.push(Ar)}var mn=[it,dt,Dt],xn=[ot,ht,Ot];Ge&&(Ge[0]=mn,Ge[1]=xn),0===at&&(at=1);var kn=1/at;isFinite(dr)||(dr=1),nt.vectorScale=dr;var Cn=Ne.coneSize||.5;Ne.absoluteConeSize&&(Cn=Ne.absoluteConeSize*kn),nt.coneScale=Cn,xr=0;for(var En=0;xr<Qe.length;xr++)for(var Pn=(br=Qe[xr])[0],Dn=br[1],In=br[2],zn=er[xr],Bn=tt.length(zn)*kn,Vn=0,Hn=8;Vn<Hn;Vn++){nt.positions.push([Pn,Dn,In,En++]),nt.positions.push([Pn,Dn,In,En++]),nt.positions.push([Pn,Dn,In,En++]),nt.positions.push([Pn,Dn,In,En++]),nt.positions.push([Pn,Dn,In,En++]),nt.positions.push([Pn,Dn,In,En++]),nt.vectors.push(zn),nt.vectors.push(zn),nt.vectors.push(zn),nt.vectors.push(zn),nt.vectors.push(zn),nt.vectors.push(zn),nt.vertexIntensity.push(Bn,Bn,Bn),nt.vertexIntensity.push(Bn,Bn,Bn);var qn=nt.positions.length;nt.cells.push([qn-6,qn-5,qn-4],[qn-3,qn-2,qn-1])}return nt};var rt=Ne("./lib/shaders");Ge.exports.createMesh=Ne("./create_mesh"),Ge.exports.createConeMesh=function(Ne,Qe){return Ge.exports.createMesh(Ne,Qe,{shaders:rt,traceType:"cone"})}},{"./create_mesh":261,"./lib/shaders":262,"gl-vec3":377}],261:[function(Ne,Ge,Qe){"use strict";var tt=Ne("gl-shader"),rt=Ne("gl-buffer"),nt=Ne("gl-vao"),at=Ne("gl-texture2d"),it=Ne("gl-mat4/multiply"),ot=Ne("gl-mat4/invert"),dt=Ne("ndarray"),ht=Ne("colormap"),Dt=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function VectorMesh(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht){this.gl=Ne,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=Ge,this.dirty=!0,this.triShader=Qe,this.pickShader=tt,this.trianglePositions=rt,this.triangleVectors=nt,this.triangleColors=it,this.triangleUVs=ot,this.triangleIds=at,this.triangleVAO=dt,this.triangleCount=0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.traceType=ht,this.tubeScale=1,this.coneScale=2,this.vectorScale=1,this.coneOffset=.25,this._model=Dt,this._view=Dt,this._projection=Dt,this._resolution=[1,1]}var Ot=VectorMesh.prototype;function genColormap(Ne){for(var Ge=ht({colormap:Ne,nshades:256,format:"rgba"}),Qe=new Uint8Array(1024),tt=0;tt<256;++tt){for(var rt=Ge[tt],nt=0;nt<3;++nt)Qe[4*tt+nt]=rt[nt];Qe[4*tt+3]=255*rt[3]}return dt(Qe,[256,256,4],[4,0,1])}function takeZComponent(Ne){for(var Ge=Ne.length,Qe=new Array(Ge),tt=0;tt<Ge;++tt)Qe[tt]=Ne[tt][2];return Qe}function createMeshShader(Ne,Ge){var Qe=tt(Ne,Ge.meshShader.vertex,Ge.meshShader.fragment,null,Ge.meshShader.attributes);return Qe.attributes.position.location=0,Qe.attributes.color.location=2,Qe.attributes.uv.location=3,Qe.attributes.vector.location=4,Qe}function createPickShader(Ne,Ge){var Qe=tt(Ne,Ge.pickShader.vertex,Ge.pickShader.fragment,null,Ge.pickShader.attributes);return Qe.attributes.position.location=0,Qe.attributes.id.location=1,Qe.attributes.vector.location=4,Qe}function createVectorMesh(Ne,Ge,Qe){var tt=Qe.shaders;1===arguments.length&&(Ne=(Ge=Ne).gl);var it=createMeshShader(Ne,tt),ot=createPickShader(Ne,tt),ht=at(Ne,dt(new Uint8Array([255,255,255,255]),[1,1,4]));ht.generateMipmap(),ht.minFilter=Ne.LINEAR_MIPMAP_LINEAR,ht.magFilter=Ne.LINEAR;var Dt=rt(Ne),Ot=rt(Ne),Rt=rt(Ne),Zt=rt(Ne),er=rt(Ne),dr=new VectorMesh(Ne,ht,it,ot,Dt,Ot,er,Rt,Zt,nt(Ne,[{buffer:Dt,type:Ne.FLOAT,size:4},{buffer:er,type:Ne.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:Rt,type:Ne.FLOAT,size:4},{buffer:Zt,type:Ne.FLOAT,size:2},{buffer:Ot,type:Ne.FLOAT,size:4}]),Qe.traceType||"cone");return dr.update(Ge),dr}Ot.isOpaque=function(){return this.opacity>=1},Ot.isTransparent=function(){return this.opacity<1},Ot.pickSlots=1,Ot.setPickBase=function(Ne){this.pickId=Ne},Ot.update=function(Ne){Ne=Ne||{};var Ge=this.gl;this.dirty=!0,"lightPosition"in Ne&&(this.lightPosition=Ne.lightPosition),"opacity"in Ne&&(this.opacity=Ne.opacity),"ambient"in Ne&&(this.ambientLight=Ne.ambient),"diffuse"in Ne&&(this.diffuseLight=Ne.diffuse),"specular"in Ne&&(this.specularLight=Ne.specular),"roughness"in Ne&&(this.roughness=Ne.roughness),"fresnel"in Ne&&(this.fresnel=Ne.fresnel),void 0!==Ne.tubeScale&&(this.tubeScale=Ne.tubeScale),void 0!==Ne.vectorScale&&(this.vectorScale=Ne.vectorScale),void 0!==Ne.coneScale&&(this.coneScale=Ne.coneScale),void 0!==Ne.coneOffset&&(this.coneOffset=Ne.coneOffset),Ne.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=Ge.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=Ge.LINEAR,this.texture.setPixels(genColormap(Ne.colormap)),this.texture.generateMipmap());var Qe=Ne.cells,tt=Ne.positions,rt=Ne.vectors;if(tt&&Qe&&rt){var nt=[],at=[],it=[],ot=[],dt=[];this.cells=Qe,this.positions=tt,this.vectors=rt;var ht=Ne.meshColor||[1,1,1,1],Dt=Ne.vertexIntensity,Ot=1/0,Rt=-1/0;if(Dt)if(Ne.vertexIntensityBounds)Ot=+Ne.vertexIntensityBounds[0],Rt=+Ne.vertexIntensityBounds[1];else for(var Zt=0;Zt<Dt.length;++Zt){var er=Dt[Zt];Ot=Math.min(Ot,er),Rt=Math.max(Rt,er)}else for(Zt=0;Zt<tt.length;++Zt)er=tt[Zt][2],Ot=Math.min(Ot,er),Rt=Math.max(Rt,er);for(this.intensity=Dt||takeZComponent(tt),this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],Zt=0;Zt<tt.length;++Zt)for(var dr=tt[Zt],mr=0;mr<3;++mr)!isNaN(dr[mr])&&isFinite(dr[mr])&&(this.bounds[0][mr]=Math.min(this.bounds[0][mr],dr[mr]),this.bounds[1][mr]=Math.max(this.bounds[1][mr],dr[mr]));var xr=0;e:for(Zt=0;Zt<Qe.length;++Zt){var br=Qe[Zt];if(3===br.length){for(mr=0;mr<3;++mr){dr=tt[en=br[mr]];for(var Ar=0;Ar<3;++Ar)if(isNaN(dr[Ar])||!isFinite(dr[Ar]))continue e}for(mr=0;mr<3;++mr){var en;dr=tt[en=br[2-mr]],nt.push(dr[0],dr[1],dr[2],dr[3]);var mn=rt[en];at.push(mn[0],mn[1],mn[2],mn[3]||0);var xn,kn=ht;3===kn.length?it.push(kn[0],kn[1],kn[2],1):it.push(kn[0],kn[1],kn[2],kn[3]),xn=Dt?[(Dt[en]-Ot)/(Rt-Ot),0]:[(dr[2]-Ot)/(Rt-Ot),0],ot.push(xn[0],xn[1]),dt.push(Zt)}xr+=1}}this.triangleCount=xr,this.trianglePositions.update(nt),this.triangleVectors.update(at),this.triangleColors.update(it),this.triangleUVs.update(ot),this.triangleIds.update(new Uint32Array(dt))}},Ot.drawTransparent=Ot.draw=function(Ne){Ne=Ne||{};for(var Ge=this.gl,Qe=Ne.model||Dt,tt=Ne.view||Dt,rt=Ne.projection||Dt,nt=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],at=0;at<3;++at)nt[0][at]=Math.max(nt[0][at],this.clipBounds[0][at]),nt[1][at]=Math.min(nt[1][at],this.clipBounds[1][at]);var dt={model:Qe,view:tt,projection:rt,inverseModel:Dt.slice(),clipBounds:nt,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],opacity:this.opacity,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,texture:0};dt.inverseModel=ot(dt.inverseModel,dt.model),Ge.disable(Ge.CULL_FACE),this.texture.bind(0);var ht=new Array(16);for(it(ht,dt.view,dt.model),it(ht,dt.projection,ht),ot(ht,ht),at=0;at<3;++at)dt.eyePosition[at]=ht[12+at]/ht[15];var Ot=ht[15];for(at=0;at<3;++at)Ot+=this.lightPosition[at]*ht[4*at+3];for(at=0;at<3;++at){for(var Rt=ht[12+at],Zt=0;Zt<3;++Zt)Rt+=ht[4*Zt+at]*this.lightPosition[Zt];dt.lightPosition[at]=Rt/Ot}if(this.triangleCount>0){var er=this.triShader;er.bind(),er.uniforms=dt,this.triangleVAO.bind(),Ge.drawArrays(Ge.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()}},Ot.drawPick=function(Ne){Ne=Ne||{};for(var Ge=this.gl,Qe=Ne.model||Dt,tt=Ne.view||Dt,rt=Ne.projection||Dt,nt=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],at=0;at<3;++at)nt[0][at]=Math.max(nt[0][at],this.clipBounds[0][at]),nt[1][at]=Math.min(nt[1][at],this.clipBounds[1][at]);this._model=[].slice.call(Qe),this._view=[].slice.call(tt),this._projection=[].slice.call(rt),this._resolution=[Ge.drawingBufferWidth,Ge.drawingBufferHeight];var it={model:Qe,view:tt,projection:rt,clipBounds:nt,tubeScale:this.tubeScale,vectorScale:this.vectorScale,coneScale:this.coneScale,coneOffset:this.coneOffset,pickId:this.pickId/255},ot=this.pickShader;ot.bind(),ot.uniforms=it,this.triangleCount>0&&(this.triangleVAO.bind(),Ge.drawArrays(Ge.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind())},Ot.pick=function(Ne){if(!Ne)return null;if(Ne.id!==this.pickId)return null;var Ge=Ne.value[0]+256*Ne.value[1]+65536*Ne.value[2],Qe=this.cells[Ge],tt=this.positions[Qe[1]].slice(0,3),rt={position:tt,dataCoordinate:tt,index:Math.floor(Qe[1]/48)};return"cone"===this.traceType?rt.index=Math.floor(Qe[1]/48):"streamtube"===this.traceType&&(rt.intensity=this.intensity[Qe[1]],rt.velocity=this.vectors[Qe[1]].slice(0,3),rt.divergence=this.vectors[Qe[1]][3],rt.index=Ge),rt},Ot.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.pickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleVectors.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleIds.dispose()},Ge.exports=createVectorMesh},{colormap:131,"gl-buffer":259,"gl-mat4/invert":293,"gl-mat4/multiply":295,"gl-shader":335,"gl-texture2d":353,"gl-vao":358,ndarray:495}],262:[function(Ne,Ge,Qe){var tt=Ne("glslify"),rt=tt(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  float index = rawIndex - floor(rawIndex /\n    (segmentCount * 6.0)) *\n    (segmentCount * 6.0);\n\n  float segment = floor(0.001 + index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex > 2.99 && segmentIndex < 3.01) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  float nextAngle = (\n    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||\n    (segmentIndex > 4.99 &&  segmentIndex < 5.01)\n  ) ? 1.0 : 0.0;\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex < 3.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec3 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\n\nuniform float vectorScale, coneScale, coneOffset;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 eyePosition, lightPosition;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector), position.w, coneOffset, normal);\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * conePosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  // vec4 m_position  = model * vec4(conePosition, 1.0);\n  vec4 t_position  = view * conePosition;\n  gl_Position      = projection * t_position;\n\n  f_color          = color;\n  f_data           = conePosition.xyz;\n  f_position       = position.xyz;\n  f_uv             = uv;\n}\n"]),nt=tt(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}\n"]),at=tt(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the cone vertex and normal at the given index.\n//\n// The returned vertex is for a cone with its top at origin and height of 1.0,\n// pointing in the direction of the vector attribute.\n//\n// Each cone is made up of a top vertex, a center base vertex and base perimeter vertices.\n// These vertices are used to make up the triangles of the cone by the following:\n//   segment + 0 top vertex\n//   segment + 1 perimeter vertex a+1\n//   segment + 2 perimeter vertex a\n//   segment + 3 center base vertex\n//   segment + 4 perimeter vertex a\n//   segment + 5 perimeter vertex a+1\n// Where segment is the number of the radial segment * 6 and a is the angle at that radial segment.\n// To go from index to segment, floor(index / 6)\n// To go from segment to angle, 2*pi * (segment/segmentCount)\n// To go from index to segment index, index - (segment*6)\n//\nvec3 getConePosition(vec3 d, float rawIndex, float coneOffset, out vec3 normal) {\n\n  const float segmentCount = 8.0;\n\n  float index = rawIndex - floor(rawIndex /\n    (segmentCount * 6.0)) *\n    (segmentCount * 6.0);\n\n  float segment = floor(0.001 + index/6.0);\n  float segmentIndex = index - (segment*6.0);\n\n  normal = -normalize(d);\n\n  if (segmentIndex > 2.99 && segmentIndex < 3.01) {\n    return mix(vec3(0.0), -d, coneOffset);\n  }\n\n  float nextAngle = (\n    (segmentIndex > 0.99 &&  segmentIndex < 1.01) ||\n    (segmentIndex > 4.99 &&  segmentIndex < 5.01)\n  ) ? 1.0 : 0.0;\n  float angle = 2.0 * 3.14159 * ((segment + nextAngle) / segmentCount);\n\n  vec3 v1 = mix(d, vec3(0.0), coneOffset);\n  vec3 v2 = v1 - d;\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d)*0.25;\n  vec3 y = v * sin(angle) * length(d)*0.25;\n  vec3 v3 = v2 + x + y;\n  if (segmentIndex < 3.0) {\n    vec3 tx = u * sin(angle);\n    vec3 ty = v * -cos(angle);\n    vec3 tangent = tx + ty;\n    normal = normalize(cross(v3 - v1, tangent));\n  }\n\n  if (segmentIndex == 0.0) {\n    return mix(d, vec3(0.0), coneOffset);\n  }\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform float vectorScale, coneScale, coneOffset;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec3 XYZ = getConePosition(mat3(model) * ((vectorScale * coneScale) * vector.xyz), position.w, coneOffset, normal);\n  vec4 conePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n  gl_Position = projection * view * conePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]),it=tt(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);Qe.meshShader={vertex:rt,fragment:nt,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec3"}]},Qe.pickShader={vertex:at,fragment:it,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec3"}]}},{glslify:263}],263:[function(Ne,Ge,Qe){arguments[4][257][0].apply(Qe,arguments)},{dup:257}],264:[function(Ne,Ge,Qe){Ge.exports={0:"NONE",1:"ONE",2:"LINE_LOOP",3:"LINE_STRIP",4:"TRIANGLES",5:"TRIANGLE_STRIP",6:"TRIANGLE_FAN",256:"DEPTH_BUFFER_BIT",512:"NEVER",513:"LESS",514:"EQUAL",515:"LEQUAL",516:"GREATER",517:"NOTEQUAL",518:"GEQUAL",519:"ALWAYS",768:"SRC_COLOR",769:"ONE_MINUS_SRC_COLOR",770:"SRC_ALPHA",771:"ONE_MINUS_SRC_ALPHA",772:"DST_ALPHA",773:"ONE_MINUS_DST_ALPHA",774:"DST_COLOR",775:"ONE_MINUS_DST_COLOR",776:"SRC_ALPHA_SATURATE",1024:"STENCIL_BUFFER_BIT",1028:"FRONT",1029:"BACK",1032:"FRONT_AND_BACK",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",2304:"CW",2305:"CCW",2849:"LINE_WIDTH",2884:"CULL_FACE",2885:"CULL_FACE_MODE",2886:"FRONT_FACE",2928:"DEPTH_RANGE",2929:"DEPTH_TEST",2930:"DEPTH_WRITEMASK",2931:"DEPTH_CLEAR_VALUE",2932:"DEPTH_FUNC",2960:"STENCIL_TEST",2961:"STENCIL_CLEAR_VALUE",2962:"STENCIL_FUNC",2963:"STENCIL_VALUE_MASK",2964:"STENCIL_FAIL",2965:"STENCIL_PASS_DEPTH_FAIL",2966:"STENCIL_PASS_DEPTH_PASS",2967:"STENCIL_REF",2968:"STENCIL_WRITEMASK",2978:"VIEWPORT",3024:"DITHER",3042:"BLEND",3088:"SCISSOR_BOX",3089:"SCISSOR_TEST",3106:"COLOR_CLEAR_VALUE",3107:"COLOR_WRITEMASK",3317:"UNPACK_ALIGNMENT",3333:"PACK_ALIGNMENT",3379:"MAX_TEXTURE_SIZE",3386:"MAX_VIEWPORT_DIMS",3408:"SUBPIXEL_BITS",3410:"RED_BITS",3411:"GREEN_BITS",3412:"BLUE_BITS",3413:"ALPHA_BITS",3414:"DEPTH_BITS",3415:"STENCIL_BITS",3553:"TEXTURE_2D",4352:"DONT_CARE",4353:"FASTEST",4354:"NICEST",5120:"BYTE",5121:"UNSIGNED_BYTE",5122:"SHORT",5123:"UNSIGNED_SHORT",5124:"INT",5125:"UNSIGNED_INT",5126:"FLOAT",5386:"INVERT",5890:"TEXTURE",6401:"STENCIL_INDEX",6402:"DEPTH_COMPONENT",6406:"ALPHA",6407:"RGB",6408:"RGBA",6409:"LUMINANCE",6410:"LUMINANCE_ALPHA",7680:"KEEP",7681:"REPLACE",7682:"INCR",7683:"DECR",7936:"VENDOR",7937:"RENDERER",7938:"VERSION",9728:"NEAREST",9729:"LINEAR",9984:"NEAREST_MIPMAP_NEAREST",9985:"LINEAR_MIPMAP_NEAREST",9986:"NEAREST_MIPMAP_LINEAR",9987:"LINEAR_MIPMAP_LINEAR",10240:"TEXTURE_MAG_FILTER",10241:"TEXTURE_MIN_FILTER",10242:"TEXTURE_WRAP_S",10243:"TEXTURE_WRAP_T",10497:"REPEAT",10752:"POLYGON_OFFSET_UNITS",16384:"COLOR_BUFFER_BIT",32769:"CONSTANT_COLOR",32770:"ONE_MINUS_CONSTANT_COLOR",32771:"CONSTANT_ALPHA",32772:"ONE_MINUS_CONSTANT_ALPHA",32773:"BLEND_COLOR",32774:"FUNC_ADD",32777:"BLEND_EQUATION_RGB",32778:"FUNC_SUBTRACT",32779:"FUNC_REVERSE_SUBTRACT",32819:"UNSIGNED_SHORT_4_4_4_4",32820:"UNSIGNED_SHORT_5_5_5_1",32823:"POLYGON_OFFSET_FILL",32824:"POLYGON_OFFSET_FACTOR",32854:"RGBA4",32855:"RGB5_A1",32873:"TEXTURE_BINDING_2D",32926:"SAMPLE_ALPHA_TO_COVERAGE",32928:"SAMPLE_COVERAGE",32936:"SAMPLE_BUFFERS",32937:"SAMPLES",32938:"SAMPLE_COVERAGE_VALUE",32939:"SAMPLE_COVERAGE_INVERT",32968:"BLEND_DST_RGB",32969:"BLEND_SRC_RGB",32970:"BLEND_DST_ALPHA",32971:"BLEND_SRC_ALPHA",33071:"CLAMP_TO_EDGE",33170:"GENERATE_MIPMAP_HINT",33189:"DEPTH_COMPONENT16",33306:"DEPTH_STENCIL_ATTACHMENT",33635:"UNSIGNED_SHORT_5_6_5",33648:"MIRRORED_REPEAT",33901:"ALIASED_POINT_SIZE_RANGE",33902:"ALIASED_LINE_WIDTH_RANGE",33984:"TEXTURE0",33985:"TEXTURE1",33986:"TEXTURE2",33987:"TEXTURE3",33988:"TEXTURE4",33989:"TEXTURE5",33990:"TEXTURE6",33991:"TEXTURE7",33992:"TEXTURE8",33993:"TEXTURE9",33994:"TEXTURE10",33995:"TEXTURE11",33996:"TEXTURE12",33997:"TEXTURE13",33998:"TEXTURE14",33999:"TEXTURE15",34e3:"TEXTURE16",34001:"TEXTURE17",34002:"TEXTURE18",34003:"TEXTURE19",34004:"TEXTURE20",34005:"TEXTURE21",34006:"TEXTURE22",34007:"TEXTURE23",34008:"TEXTURE24",34009:"TEXTURE25",34010:"TEXTURE26",34011:"TEXTURE27",34012:"TEXTURE28",34013:"TEXTURE29",34014:"TEXTURE30",34015:"TEXTURE31",34016:"ACTIVE_TEXTURE",34024:"MAX_RENDERBUFFER_SIZE",34041:"DEPTH_STENCIL",34055:"INCR_WRAP",34056:"DECR_WRAP",34067:"TEXTURE_CUBE_MAP",34068:"TEXTURE_BINDING_CUBE_MAP",34069:"TEXTURE_CUBE_MAP_POSITIVE_X",34070:"TEXTURE_CUBE_MAP_NEGATIVE_X",34071:"TEXTURE_CUBE_MAP_POSITIVE_Y",34072:"TEXTURE_CUBE_MAP_NEGATIVE_Y",34073:"TEXTURE_CUBE_MAP_POSITIVE_Z",34074:"TEXTURE_CUBE_MAP_NEGATIVE_Z",34076:"MAX_CUBE_MAP_TEXTURE_SIZE",34338:"VERTEX_ATTRIB_ARRAY_ENABLED",34339:"VERTEX_ATTRIB_ARRAY_SIZE",34340:"VERTEX_ATTRIB_ARRAY_STRIDE",34341:"VERTEX_ATTRIB_ARRAY_TYPE",34342:"CURRENT_VERTEX_ATTRIB",34373:"VERTEX_ATTRIB_ARRAY_POINTER",34466:"NUM_COMPRESSED_TEXTURE_FORMATS",34467:"COMPRESSED_TEXTURE_FORMATS",34660:"BUFFER_SIZE",34661:"BUFFER_USAGE",34816:"STENCIL_BACK_FUNC",34817:"STENCIL_BACK_FAIL",34818:"STENCIL_BACK_PASS_DEPTH_FAIL",34819:"STENCIL_BACK_PASS_DEPTH_PASS",34877:"BLEND_EQUATION_ALPHA",34921:"MAX_VERTEX_ATTRIBS",34922:"VERTEX_ATTRIB_ARRAY_NORMALIZED",34930:"MAX_TEXTURE_IMAGE_UNITS",34962:"ARRAY_BUFFER",34963:"ELEMENT_ARRAY_BUFFER",34964:"ARRAY_BUFFER_BINDING",34965:"ELEMENT_ARRAY_BUFFER_BINDING",34975:"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",35040:"STREAM_DRAW",35044:"STATIC_DRAW",35048:"DYNAMIC_DRAW",35632:"FRAGMENT_SHADER",35633:"VERTEX_SHADER",35660:"MAX_VERTEX_TEXTURE_IMAGE_UNITS",35661:"MAX_COMBINED_TEXTURE_IMAGE_UNITS",35663:"SHADER_TYPE",35664:"FLOAT_VEC2",35665:"FLOAT_VEC3",35666:"FLOAT_VEC4",35667:"INT_VEC2",35668:"INT_VEC3",35669:"INT_VEC4",35670:"BOOL",35671:"BOOL_VEC2",35672:"BOOL_VEC3",35673:"BOOL_VEC4",35674:"FLOAT_MAT2",35675:"FLOAT_MAT3",35676:"FLOAT_MAT4",35678:"SAMPLER_2D",35680:"SAMPLER_CUBE",35712:"DELETE_STATUS",35713:"COMPILE_STATUS",35714:"LINK_STATUS",35715:"VALIDATE_STATUS",35716:"INFO_LOG_LENGTH",35717:"ATTACHED_SHADERS",35718:"ACTIVE_UNIFORMS",35719:"ACTIVE_UNIFORM_MAX_LENGTH",35720:"SHADER_SOURCE_LENGTH",35721:"ACTIVE_ATTRIBUTES",35722:"ACTIVE_ATTRIBUTE_MAX_LENGTH",35724:"SHADING_LANGUAGE_VERSION",35725:"CURRENT_PROGRAM",36003:"STENCIL_BACK_REF",36004:"STENCIL_BACK_VALUE_MASK",36005:"STENCIL_BACK_WRITEMASK",36006:"FRAMEBUFFER_BINDING",36007:"RENDERBUFFER_BINDING",36048:"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",36049:"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",36050:"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",36051:"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",36053:"FRAMEBUFFER_COMPLETE",36054:"FRAMEBUFFER_INCOMPLETE_ATTACHMENT",36055:"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",36057:"FRAMEBUFFER_INCOMPLETE_DIMENSIONS",36061:"FRAMEBUFFER_UNSUPPORTED",36064:"COLOR_ATTACHMENT0",36096:"DEPTH_ATTACHMENT",36128:"STENCIL_ATTACHMENT",36160:"FRAMEBUFFER",36161:"RENDERBUFFER",36162:"RENDERBUFFER_WIDTH",36163:"RENDERBUFFER_HEIGHT",36164:"RENDERBUFFER_INTERNAL_FORMAT",36168:"STENCIL_INDEX8",36176:"RENDERBUFFER_RED_SIZE",36177:"RENDERBUFFER_GREEN_SIZE",36178:"RENDERBUFFER_BLUE_SIZE",36179:"RENDERBUFFER_ALPHA_SIZE",36180:"RENDERBUFFER_DEPTH_SIZE",36181:"RENDERBUFFER_STENCIL_SIZE",36194:"RGB565",36336:"LOW_FLOAT",36337:"MEDIUM_FLOAT",36338:"HIGH_FLOAT",36339:"LOW_INT",36340:"MEDIUM_INT",36341:"HIGH_INT",36346:"SHADER_COMPILER",36347:"MAX_VERTEX_UNIFORM_VECTORS",36348:"MAX_VARYING_VECTORS",36349:"MAX_FRAGMENT_UNIFORM_VECTORS",37440:"UNPACK_FLIP_Y_WEBGL",37441:"UNPACK_PREMULTIPLY_ALPHA_WEBGL",37442:"CONTEXT_LOST_WEBGL",37443:"UNPACK_COLORSPACE_CONVERSION_WEBGL",37444:"BROWSER_DEFAULT_WEBGL"}},{}],265:[function(Ne,Ge,Qe){var tt=Ne("./1.0/numbers");Ge.exports=function(Ne){return tt[Ne]}},{"./1.0/numbers":264}],266:[function(Ne,Ge,Qe){"use strict";Ge.exports=createErrorBars;var tt=Ne("gl-buffer"),rt=Ne("gl-vao"),nt=Ne("./shaders/index"),at=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function ErrorBars(Ne,Ge,Qe,tt){this.gl=Ne,this.shader=tt,this.buffer=Ge,this.vao=Qe,this.pixelRatio=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lineWidth=[1,1,1],this.capSize=[10,10,10],this.lineCount=[0,0,0],this.lineOffset=[0,0,0],this.opacity=1,this.hasAlpha=!1}var it=ErrorBars.prototype;function updateBounds(Ne,Ge){for(var Qe=0;Qe<3;++Qe)Ne[0][Qe]=Math.min(Ne[0][Qe],Ge[Qe]),Ne[1][Qe]=Math.max(Ne[1][Qe],Ge[Qe])}it.isOpaque=function(){return!this.hasAlpha},it.isTransparent=function(){return this.hasAlpha},it.drawTransparent=it.draw=function(Ne){var Ge=this.gl,Qe=this.shader.uniforms;this.shader.bind();var tt=Qe.view=Ne.view||at,rt=Qe.projection=Ne.projection||at;Qe.model=Ne.model||at,Qe.clipBounds=this.clipBounds,Qe.opacity=this.opacity;var nt=tt[12],it=tt[13],ot=tt[14],dt=tt[15],ht=(Ne._ortho?2:1)*this.pixelRatio*(rt[3]*nt+rt[7]*it+rt[11]*ot+rt[15]*dt)/Ge.drawingBufferHeight;this.vao.bind();for(var Dt=0;Dt<3;++Dt)Ge.lineWidth(this.lineWidth[Dt]*this.pixelRatio),Qe.capSize=this.capSize[Dt]*ht,this.lineCount[Dt]&&Ge.drawArrays(Ge.LINES,this.lineOffset[Dt],this.lineCount[Dt]);this.vao.unbind()};var ot=function(){for(var Ne=new Array(3),Ge=0;Ge<3;++Ge){for(var Qe=[],tt=1;tt<=2;++tt)for(var rt=-1;rt<=1;rt+=2){var nt=[0,0,0];nt[(tt+Ge)%3]=rt,Qe.push(nt)}Ne[Ge]=Qe}return Ne}();function emitFace(Ne,Ge,Qe,tt){for(var rt=ot[tt],nt=0;nt<rt.length;++nt){var at=rt[nt];Ne.push(Ge[0],Ge[1],Ge[2],Qe[0],Qe[1],Qe[2],Qe[3],at[0],at[1],at[2])}return rt.length}function createErrorBars(Ne){var Ge=Ne.gl,Qe=tt(Ge),at=rt(Ge,[{buffer:Qe,type:Ge.FLOAT,size:3,offset:0,stride:40},{buffer:Qe,type:Ge.FLOAT,size:4,offset:12,stride:40},{buffer:Qe,type:Ge.FLOAT,size:3,offset:28,stride:40}]),it=nt(Ge);it.attributes.position.location=0,it.attributes.color.location=1,it.attributes.offset.location=2;var ot=new ErrorBars(Ge,Qe,at,it);return ot.update(Ne),ot}it.update=function(Ne){"lineWidth"in(Ne=Ne||{})&&(this.lineWidth=Ne.lineWidth,Array.isArray(this.lineWidth)||(this.lineWidth=[this.lineWidth,this.lineWidth,this.lineWidth])),"capSize"in Ne&&(this.capSize=Ne.capSize,Array.isArray(this.capSize)||(this.capSize=[this.capSize,this.capSize,this.capSize])),this.hasAlpha=!1,"opacity"in Ne&&(this.opacity=+Ne.opacity,this.opacity<1&&(this.hasAlpha=!0));var Ge=Ne.color||[[0,0,0],[0,0,0],[0,0,0]],Qe=Ne.position,tt=Ne.error;if(Array.isArray(Ge[0])||(Ge=[Ge,Ge,Ge]),Qe&&tt){var rt=[],nt=Qe.length,at=0;this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.lineCount=[0,0,0];for(var it=0;it<3;++it){this.lineOffset[it]=at;e:for(var ot=0;ot<nt;++ot){for(var dt=Qe[ot],ht=0;ht<3;++ht)if(isNaN(dt[ht])||!isFinite(dt[ht]))continue e;var Dt,Ot=tt[ot],Rt=Ge[it];Array.isArray(Rt[0])&&(Rt=Ge[ot]),3===Rt.length?Rt=[Rt[0],Rt[1],Rt[2],1]:4===Rt.length&&(Rt=[Rt[0],Rt[1],Rt[2],Rt[3]],!this.hasAlpha&&Rt[3]<1&&(this.hasAlpha=!0)),isNaN(Ot[0][it])||isNaN(Ot[1][it])||(Ot[0][it]<0&&((Dt=dt.slice())[it]+=Ot[0][it],rt.push(dt[0],dt[1],dt[2],Rt[0],Rt[1],Rt[2],Rt[3],0,0,0,Dt[0],Dt[1],Dt[2],Rt[0],Rt[1],Rt[2],Rt[3],0,0,0),updateBounds(this.bounds,Dt),at+=2+emitFace(rt,Dt,Rt,it)),Ot[1][it]>0&&((Dt=dt.slice())[it]+=Ot[1][it],rt.push(dt[0],dt[1],dt[2],Rt[0],Rt[1],Rt[2],Rt[3],0,0,0,Dt[0],Dt[1],Dt[2],Rt[0],Rt[1],Rt[2],Rt[3],0,0,0),updateBounds(this.bounds,Dt),at+=2+emitFace(rt,Dt,Rt,it)))}this.lineCount[it]=at-this.lineOffset[it]}this.buffer.update(rt)}},it.dispose=function(){this.shader.dispose(),this.buffer.dispose(),this.vao.dispose()}},{"./shaders/index":268,"gl-buffer":259,"gl-vao":358}],267:[function(Ne,Ge,Qe){arguments[4][257][0].apply(Qe,arguments)},{dup:257}],268:[function(Ne,Ge,Qe){"use strict";var tt=Ne("glslify"),rt=Ne("gl-shader"),nt=tt(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, offset;\nattribute vec4 color;\nuniform mat4 model, view, projection;\nuniform float capSize;\nvarying vec4 fragColor;\nvarying vec3 fragPosition;\n\nvoid main() {\n  vec4 worldPosition  = model * vec4(position, 1.0);\n  worldPosition       = (worldPosition / worldPosition.w) + vec4(capSize * offset, 0.0);\n  gl_Position         = projection * view * worldPosition;\n  fragColor           = color;\n  fragPosition        = position;\n}"]),at=tt(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float opacity;\nvarying vec3 fragPosition;\nvarying vec4 fragColor;\n\nvoid main() {\n  if (\n    outOfRange(clipBounds[0], clipBounds[1], fragPosition) ||\n    fragColor.a * opacity == 0.\n  ) discard;\n\n  gl_FragColor = opacity * fragColor;\n}"]);Ge.exports=function(Ne){return rt(Ne,nt,at,null,[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"offset",type:"vec3"}])}},{"gl-shader":335,glslify:267}],269:[function(Ne,Ge,Qe){"use strict";var tt=Ne("gl-texture2d");Ge.exports=createFBO;var rt,nt,at,it,ot=null;function saveFBOState(Ne){return[Ne.getParameter(Ne.FRAMEBUFFER_BINDING),Ne.getParameter(Ne.RENDERBUFFER_BINDING),Ne.getParameter(Ne.TEXTURE_BINDING_2D)]}function restoreFBOState(Ne,Ge){Ne.bindFramebuffer(Ne.FRAMEBUFFER,Ge[0]),Ne.bindRenderbuffer(Ne.RENDERBUFFER,Ge[1]),Ne.bindTexture(Ne.TEXTURE_2D,Ge[2])}function lazyInitColorAttachments(Ne,Ge){var Qe=Ne.getParameter(Ge.MAX_COLOR_ATTACHMENTS_WEBGL);ot=new Array(Qe+1);for(var tt=0;tt<=Qe;++tt){for(var rt=new Array(Qe),nt=0;nt<tt;++nt)rt[nt]=Ne.COLOR_ATTACHMENT0+nt;for(nt=tt;nt<Qe;++nt)rt[nt]=Ne.NONE;ot[tt]=rt}}function throwFBOError(Ne){switch(Ne){case rt:throw new Error("gl-fbo: Framebuffer unsupported");case nt:throw new Error("gl-fbo: Framebuffer incomplete attachment");case at:throw new Error("gl-fbo: Framebuffer incomplete dimensions");case it:throw new Error("gl-fbo: Framebuffer incomplete missing attachment");default:throw new Error("gl-fbo: Framebuffer failed for unspecified reason")}}function initTexture(Ne,Ge,Qe,rt,nt,at){if(!rt)return null;var it=tt(Ne,Ge,Qe,nt,rt);return it.magFilter=Ne.NEAREST,it.minFilter=Ne.NEAREST,it.mipSamples=1,it.bind(),Ne.framebufferTexture2D(Ne.FRAMEBUFFER,at,Ne.TEXTURE_2D,it.handle,0),it}function initRenderBuffer(Ne,Ge,Qe,tt,rt){var nt=Ne.createRenderbuffer();return Ne.bindRenderbuffer(Ne.RENDERBUFFER,nt),Ne.renderbufferStorage(Ne.RENDERBUFFER,tt,Ge,Qe),Ne.framebufferRenderbuffer(Ne.FRAMEBUFFER,rt,Ne.RENDERBUFFER,nt),nt}function rebuildFBO(Ne){var Ge=saveFBOState(Ne.gl),Qe=Ne.gl,tt=Ne.handle=Qe.createFramebuffer(),rt=Ne._shape[0],nt=Ne._shape[1],at=Ne.color.length,it=Ne._ext,dt=Ne._useStencil,ht=Ne._useDepth,Dt=Ne._colorType;Qe.bindFramebuffer(Qe.FRAMEBUFFER,tt);for(var Ot=0;Ot<at;++Ot)Ne.color[Ot]=initTexture(Qe,rt,nt,Dt,Qe.RGBA,Qe.COLOR_ATTACHMENT0+Ot);0===at?(Ne._color_rb=initRenderBuffer(Qe,rt,nt,Qe.RGBA4,Qe.COLOR_ATTACHMENT0),it&&it.drawBuffersWEBGL(ot[0])):at>1&&it.drawBuffersWEBGL(ot[at]);var Rt=Qe.getExtension("WEBGL_depth_texture");Rt?dt?Ne.depth=initTexture(Qe,rt,nt,Rt.UNSIGNED_INT_24_8_WEBGL,Qe.DEPTH_STENCIL,Qe.DEPTH_STENCIL_ATTACHMENT):ht&&(Ne.depth=initTexture(Qe,rt,nt,Qe.UNSIGNED_SHORT,Qe.DEPTH_COMPONENT,Qe.DEPTH_ATTACHMENT)):ht&&dt?Ne._depth_rb=initRenderBuffer(Qe,rt,nt,Qe.DEPTH_STENCIL,Qe.DEPTH_STENCIL_ATTACHMENT):ht?Ne._depth_rb=initRenderBuffer(Qe,rt,nt,Qe.DEPTH_COMPONENT16,Qe.DEPTH_ATTACHMENT):dt&&(Ne._depth_rb=initRenderBuffer(Qe,rt,nt,Qe.STENCIL_INDEX,Qe.STENCIL_ATTACHMENT));var Zt=Qe.checkFramebufferStatus(Qe.FRAMEBUFFER);if(Zt!==Qe.FRAMEBUFFER_COMPLETE){for(Ne._destroyed=!0,Qe.bindFramebuffer(Qe.FRAMEBUFFER,null),Qe.deleteFramebuffer(Ne.handle),Ne.handle=null,Ne.depth&&(Ne.depth.dispose(),Ne.depth=null),Ne._depth_rb&&(Qe.deleteRenderbuffer(Ne._depth_rb),Ne._depth_rb=null),Ot=0;Ot<Ne.color.length;++Ot)Ne.color[Ot].dispose(),Ne.color[Ot]=null;Ne._color_rb&&(Qe.deleteRenderbuffer(Ne._color_rb),Ne._color_rb=null),restoreFBOState(Qe,Ge),throwFBOError(Zt)}restoreFBOState(Qe,Ge)}function Framebuffer(Ne,Ge,Qe,tt,rt,nt,at,it){this.gl=Ne,this._shape=[0|Ge,0|Qe],this._destroyed=!1,this._ext=it,this.color=new Array(rt);for(var ot=0;ot<rt;++ot)this.color[ot]=null;this._color_rb=null,this.depth=null,this._depth_rb=null,this._colorType=tt,this._useDepth=nt,this._useStencil=at;var dt=this,ht=[0|Ge,0|Qe];Object.defineProperties(ht,{0:{get:function(){return dt._shape[0]},set:function(Ne){return dt.width=Ne}},1:{get:function(){return dt._shape[1]},set:function(Ne){return dt.height=Ne}}}),this._shapeVector=ht,rebuildFBO(this)}var dt=Framebuffer.prototype;function reshapeFBO(Ne,Ge,Qe){if(Ne._destroyed)throw new Error("gl-fbo: Can't resize destroyed FBO");if(Ne._shape[0]!==Ge||Ne._shape[1]!==Qe){var tt=Ne.gl,rt=tt.getParameter(tt.MAX_RENDERBUFFER_SIZE);if(Ge<0||Ge>rt||Qe<0||Qe>rt)throw new Error("gl-fbo: Can't resize FBO, invalid dimensions");Ne._shape[0]=Ge,Ne._shape[1]=Qe;for(var nt=saveFBOState(tt),at=0;at<Ne.color.length;++at)Ne.color[at].shape=Ne._shape;Ne._color_rb&&(tt.bindRenderbuffer(tt.RENDERBUFFER,Ne._color_rb),tt.renderbufferStorage(tt.RENDERBUFFER,tt.RGBA4,Ne._shape[0],Ne._shape[1])),Ne.depth&&(Ne.depth.shape=Ne._shape),Ne._depth_rb&&(tt.bindRenderbuffer(tt.RENDERBUFFER,Ne._depth_rb),Ne._useDepth&&Ne._useStencil?tt.renderbufferStorage(tt.RENDERBUFFER,tt.DEPTH_STENCIL,Ne._shape[0],Ne._shape[1]):Ne._useDepth?tt.renderbufferStorage(tt.RENDERBUFFER,tt.DEPTH_COMPONENT16,Ne._shape[0],Ne._shape[1]):Ne._useStencil&&tt.renderbufferStorage(tt.RENDERBUFFER,tt.STENCIL_INDEX,Ne._shape[0],Ne._shape[1])),tt.bindFramebuffer(tt.FRAMEBUFFER,Ne.handle);var it=tt.checkFramebufferStatus(tt.FRAMEBUFFER);it!==tt.FRAMEBUFFER_COMPLETE&&(Ne.dispose(),restoreFBOState(tt,nt),throwFBOError(it)),restoreFBOState(tt,nt)}}function createFBO(Ne,Ge,Qe,tt){rt||(rt=Ne.FRAMEBUFFER_UNSUPPORTED,nt=Ne.FRAMEBUFFER_INCOMPLETE_ATTACHMENT,at=Ne.FRAMEBUFFER_INCOMPLETE_DIMENSIONS,it=Ne.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT);var dt=Ne.getExtension("WEBGL_draw_buffers");if(!ot&&dt&&lazyInitColorAttachments(Ne,dt),Array.isArray(Ge)&&(tt=Qe,Qe=0|Ge[1],Ge=0|Ge[0]),"number"!=typeof Ge)throw new Error("gl-fbo: Missing shape parameter");var ht=Ne.getParameter(Ne.MAX_RENDERBUFFER_SIZE);if(Ge<0||Ge>ht||Qe<0||Qe>ht)throw new Error("gl-fbo: Parameters are too large for FBO");var Dt=1;if("color"in(tt=tt||{})){if((Dt=Math.max(0|tt.color,0))<0)throw new Error("gl-fbo: Must specify a nonnegative number of colors");if(Dt>1){if(!dt)throw new Error("gl-fbo: Multiple draw buffer extension not supported");if(Dt>Ne.getParameter(dt.MAX_COLOR_ATTACHMENTS_WEBGL))throw new Error("gl-fbo: Context does not support "+Dt+" draw buffers")}}var Ot=Ne.UNSIGNED_BYTE,Rt=Ne.getExtension("OES_texture_float");if(tt.float&&Dt>0){if(!Rt)throw new Error("gl-fbo: Context does not support floating point textures");Ot=Ne.FLOAT}else tt.preferFloat&&Dt>0&&Rt&&(Ot=Ne.FLOAT);var Zt=!0;"depth"in tt&&(Zt=!!tt.depth);var er=!1;return"stencil"in tt&&(er=!!tt.stencil),new Framebuffer(Ne,Ge,Qe,Ot,Dt,Zt,er,dt)}Object.defineProperties(dt,{shape:{get:function(){return this._destroyed?[0,0]:this._shapeVector},set:function(Ne){if(Array.isArray(Ne)||(Ne=[0|Ne,0|Ne]),2!==Ne.length)throw new Error("gl-fbo: Shape vector must be length 2");var Ge=0|Ne[0],Qe=0|Ne[1];return reshapeFBO(this,Ge,Qe),[Ge,Qe]},enumerable:!1},width:{get:function(){return this._destroyed?0:this._shape[0]},set:function(Ne){return reshapeFBO(this,Ne|=0,this._shape[1]),Ne},enumerable:!1},height:{get:function(){return this._destroyed?0:this._shape[1]},set:function(Ne){return Ne|=0,reshapeFBO(this,this._shape[0],Ne),Ne},enumerable:!1}}),dt.bind=function(){if(!this._destroyed){var Ne=this.gl;Ne.bindFramebuffer(Ne.FRAMEBUFFER,this.handle),Ne.viewport(0,0,this._shape[0],this._shape[1])}},dt.dispose=function(){if(!this._destroyed){this._destroyed=!0;var Ne=this.gl;Ne.deleteFramebuffer(this.handle),this.handle=null,this.depth&&(this.depth.dispose(),this.depth=null),this._depth_rb&&(Ne.deleteRenderbuffer(this._depth_rb),this._depth_rb=null);for(var Ge=0;Ge<this.color.length;++Ge)this.color[Ge].dispose(),this.color[Ge]=null;this._color_rb&&(Ne.deleteRenderbuffer(this._color_rb),this._color_rb=null)}}},{"gl-texture2d":353}],270:[function(Ne,Ge,Qe){var tt=Ne("sprintf-js").sprintf,rt=Ne("gl-constants/lookup"),nt=Ne("glsl-shader-name"),at=Ne("add-line-numbers");function formatCompilerError(Ne,Ge,Qe){"use strict";var it=nt(Ge)||"of unknown name (see npm glsl-shader-name)",ot="unknown type";void 0!==Qe&&(ot=Qe===rt.FRAGMENT_SHADER?"fragment":"vertex");for(var dt=tt("Error compiling %s shader %s:\n",ot,it),ht=tt("%s%s",dt,Ne),Dt=Ne.split("\n"),Ot={},Rt=0;Rt<Dt.length;Rt++){var Zt=Dt[Rt];if(""!==Zt&&"\0"!==Zt){var er=parseInt(Zt.split(":")[2]);if(isNaN(er))throw new Error(tt("Could not parse error: %s",Zt));Ot[er]=Zt}}var dr=at(Ge).split("\n");for(Rt=0;Rt<dr.length;Rt++)if((Ot[Rt+3]||Ot[Rt+2]||Ot[Rt+1])&&(dt+=dr[Rt]+"\n",Ot[Rt+1])){var mr=Ot[Rt+1];mr=mr.substr(mr.split(":",3).join(":").length+1).trim(),dt+=tt("^^^ %s\n\n",mr)}return{long:dt.trim(),short:ht.trim()}}Ge.exports=formatCompilerError},{"add-line-numbers":66,"gl-constants/lookup":265,"glsl-shader-name":431,"sprintf-js":567}],271:[function(Ne,Ge,Qe){"use strict";Ge.exports=createHeatmap2D;var tt=Ne("binary-search-bounds"),rt=Ne("iota-array"),nt=Ne("typedarray-pool"),at=Ne("gl-shader"),it=Ne("gl-buffer"),ot=Ne("./lib/shaders");function GLHeatmap2D(Ne,Ge,Qe,tt,rt,nt,at){this.plot=Ne,this.shader=Ge,this.pickShader=Qe,this.positionBuffer=tt,this.weightBuffer=rt,this.colorBuffer=nt,this.idBuffer=at,this.xData=[],this.yData=[],this.shape=[0,0],this.bounds=[1/0,1/0,-1/0,-1/0],this.pickOffset=0}var dt,ht=GLHeatmap2D.prototype,Dt=[0,0,1,0,0,1,1,0,1,1,0,1];function createHeatmap2D(Ne,Ge){var Qe=Ne.gl,tt=new GLHeatmap2D(Ne,at(Qe,ot.vertex,ot.fragment),at(Qe,ot.pickVertex,ot.pickFragment),it(Qe),it(Qe),it(Qe),it(Qe));return tt.update(Ge),Ne.addObject(tt),tt}ht.draw=(dt=[1,0,0,0,1,0,0,0,1],function(){var Ne=this.plot,Ge=this.shader,Qe=this.bounds,tt=this.numVertices;if(!(tt<=0)){var rt=Ne.gl,nt=Ne.dataBox,at=Qe[2]-Qe[0],it=Qe[3]-Qe[1],ot=nt[2]-nt[0],ht=nt[3]-nt[1];dt[0]=2*at/ot,dt[4]=2*it/ht,dt[6]=2*(Qe[0]-nt[0])/ot-1,dt[7]=2*(Qe[1]-nt[1])/ht-1,Ge.bind();var Dt=Ge.uniforms;Dt.viewTransform=dt,Dt.shape=this.shape;var Ot=Ge.attributes;this.positionBuffer.bind(),Ot.position.pointer(),this.weightBuffer.bind(),Ot.weight.pointer(rt.UNSIGNED_BYTE,!1),this.colorBuffer.bind(),Ot.color.pointer(rt.UNSIGNED_BYTE,!0),rt.drawArrays(rt.TRIANGLES,0,tt)}}),ht.drawPick=function(){var Ne=[1,0,0,0,1,0,0,0,1],Ge=[0,0,0,0];return function(Qe){var tt=this.plot,rt=this.pickShader,nt=this.bounds,at=this.numVertices;if(!(at<=0)){var it=tt.gl,ot=tt.dataBox,dt=nt[2]-nt[0],ht=nt[3]-nt[1],Dt=ot[2]-ot[0],Ot=ot[3]-ot[1];Ne[0]=2*dt/Dt,Ne[4]=2*ht/Ot,Ne[6]=2*(nt[0]-ot[0])/Dt-1,Ne[7]=2*(nt[1]-ot[1])/Ot-1;for(var Rt=0;Rt<4;++Rt)Ge[Rt]=Qe>>8*Rt&255;this.pickOffset=Qe,rt.bind();var Zt=rt.uniforms;Zt.viewTransform=Ne,Zt.pickOffset=Ge,Zt.shape=this.shape;var er=rt.attributes;return this.positionBuffer.bind(),er.position.pointer(),this.weightBuffer.bind(),er.weight.pointer(it.UNSIGNED_BYTE,!1),this.idBuffer.bind(),er.pickId.pointer(it.UNSIGNED_BYTE,!1),it.drawArrays(it.TRIANGLES,0,at),Qe+this.shape[0]*this.shape[1]}}}(),ht.pick=function(Ne,Ge,Qe){var tt=this.pickOffset,rt=this.shape[0]*this.shape[1];if(Qe<tt||Qe>=tt+rt)return null;var nt=Qe-tt,at=this.xData,it=this.yData;return{object:this,pointId:nt,dataCoord:[at[nt%this.shape[0]],it[nt/this.shape[0]|0]]}},ht.update=function(Ne){var Ge=(Ne=Ne||{}).shape||[0,0],Qe=Ne.x||rt(Ge[0]),at=Ne.y||rt(Ge[1]),it=Ne.z||new Float32Array(Ge[0]*Ge[1]),ot=!1!==Ne.zsmooth;this.xData=Qe,this.yData=at;var dt,ht,Ot,Rt,Zt=Ne.colorLevels||[0],er=Ne.colorValues||[0,0,0,1],dr=Zt.length,mr=this.bounds;ot?(dt=mr[0]=Qe[0],ht=mr[1]=at[0],Ot=mr[2]=Qe[Qe.length-1],Rt=mr[3]=at[at.length-1]):(dt=mr[0]=Qe[0]+(Qe[1]-Qe[0])/2,ht=mr[1]=at[0]+(at[1]-at[0])/2,Ot=mr[2]=Qe[Qe.length-1]+(Qe[Qe.length-1]-Qe[Qe.length-2])/2,Rt=mr[3]=at[at.length-1]+(at[at.length-1]-at[at.length-2])/2);var xr=1/(Ot-dt),br=1/(Rt-ht),Ar=Ge[0],en=Ge[1];this.shape=[Ar,en];var mn=(ot?(Ar-1)*(en-1):Ar*en)*(Dt.length>>>1);this.numVertices=mn;for(var xn=nt.mallocUint8(4*mn),kn=nt.mallocFloat32(2*mn),Cn=nt.mallocUint8(2*mn),En=nt.mallocUint32(mn),Pn=0,Dn=ot?Ar-1:Ar,In=ot?en-1:en,zn=0;zn<In;++zn){var Bn,Vn;ot?(Bn=br*(at[zn]-ht),Vn=br*(at[zn+1]-ht)):(Bn=zn<en-1?br*(at[zn]-(at[zn+1]-at[zn])/2-ht):br*(at[zn]-(at[zn]-at[zn-1])/2-ht),Vn=zn<en-1?br*(at[zn]+(at[zn+1]-at[zn])/2-ht):br*(at[zn]+(at[zn]-at[zn-1])/2-ht));for(var Hn=0;Hn<Dn;++Hn){var qn,Yn;ot?(qn=xr*(Qe[Hn]-dt),Yn=xr*(Qe[Hn+1]-dt)):(qn=Hn<Ar-1?xr*(Qe[Hn]-(Qe[Hn+1]-Qe[Hn])/2-dt):xr*(Qe[Hn]-(Qe[Hn]-Qe[Hn-1])/2-dt),Yn=Hn<Ar-1?xr*(Qe[Hn]+(Qe[Hn+1]-Qe[Hn])/2-dt):xr*(Qe[Hn]+(Qe[Hn]-Qe[Hn-1])/2-dt));for(var $n=0;$n<Dt.length;$n+=2){var ra,oa,pa,ga,ma=Dt[$n],_a=Dt[$n+1],Va=it[ot?(zn+_a)*Ar+(Hn+ma):zn*Ar+Hn],Wa=tt.le(Zt,Va);if(Wa<0)ra=er[0],oa=er[1],pa=er[2],ga=er[3];else if(Wa===dr-1)ra=er[4*dr-4],oa=er[4*dr-3],pa=er[4*dr-2],ga=er[4*dr-1];else{var Qa=(Va-Zt[Wa])/(Zt[Wa+1]-Zt[Wa]),ti=1-Qa,ni=4*Wa,di=4*(Wa+1);ra=ti*er[ni]+Qa*er[di],oa=ti*er[ni+1]+Qa*er[di+1],pa=ti*er[ni+2]+Qa*er[di+2],ga=ti*er[ni+3]+Qa*er[di+3]}xn[4*Pn]=255*ra,xn[4*Pn+1]=255*oa,xn[4*Pn+2]=255*pa,xn[4*Pn+3]=255*ga,kn[2*Pn]=.5*qn+.5*Yn,kn[2*Pn+1]=.5*Bn+.5*Vn,Cn[2*Pn]=ma,Cn[2*Pn+1]=_a,En[Pn]=zn*Ar+Hn,Pn+=1}}}this.positionBuffer.update(kn),this.weightBuffer.update(Cn),this.colorBuffer.update(xn),this.idBuffer.update(En),nt.free(kn),nt.free(xn),nt.free(Cn),nt.free(En)},ht.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.positionBuffer.dispose(),this.weightBuffer.dispose(),this.colorBuffer.dispose(),this.idBuffer.dispose(),this.plot.removeObject(this)}},{"./lib/shaders":272,"binary-search-bounds":96,"gl-buffer":259,"gl-shader":335,"iota-array":463,"typedarray-pool":595}],272:[function(Ne,Ge,Qe){"use strict";var tt=Ne("glslify");Ge.exports={fragment:tt(["precision lowp float;\n#define GLSLIFY 1\nvarying vec4 fragColor;\nvoid main() {\n  gl_FragColor = vec4(fragColor.rgb * fragColor.a, fragColor.a);\n}\n"]),vertex:tt(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 color;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  fragColor = color;\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"]),pickFragment:tt(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nuniform vec2 shape;\nuniform vec4 pickOffset;\n\nvoid main() {\n  vec2 d = step(.5, vWeight);\n  vec4 id = fragId + pickOffset;\n  id.x += d.x + d.y*shape.x;\n\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  gl_FragColor = id/255.;\n}\n"]),pickVertex:tt(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\nattribute vec2 weight;\n\nuniform vec2 shape;\nuniform mat3 viewTransform;\n\nvarying vec4 fragId;\nvarying vec2 vWeight;\n\nvoid main() {\n  vWeight = weight;\n\n  fragId = pickId;\n\n  vec3 vPosition = viewTransform * vec3( position + (weight-.5)/(shape-1.) , 1.0);\n  gl_Position = vec4(vPosition.xy, 0, vPosition.z);\n}\n"])}},{glslify:273}],273:[function(Ne,Ge,Qe){arguments[4][257][0].apply(Qe,arguments)},{dup:257}],274:[function(Ne,Ge,Qe){var tt=Ne("glslify"),rt=Ne("gl-shader"),nt=tt(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, nextPosition;\nattribute float arcLength, lineWidth;\nattribute vec4 color;\n\nuniform vec2 screenShape;\nuniform float pixelRatio;\nuniform mat4 model, view, projection;\n\nvarying vec4 fragColor;\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\n\nvec4 project(vec3 p) {\n  return projection * view * model * vec4(p, 1.0);\n}\n\nvoid main() {\n  vec4 startPoint = project(position);\n  vec4 endPoint   = project(nextPosition);\n\n  vec2 A = startPoint.xy / startPoint.w;\n  vec2 B =   endPoint.xy /   endPoint.w;\n\n  float clipAngle = atan(\n    (B.y - A.y) * screenShape.y,\n    (B.x - A.x) * screenShape.x\n  );\n\n  vec2 offset = 0.5 * pixelRatio * lineWidth * vec2(\n    sin(clipAngle),\n    -cos(clipAngle)\n  ) / screenShape;\n\n  gl_Position = vec4(startPoint.xy + startPoint.w * offset, startPoint.zw);\n\n  worldPosition = position;\n  pixelArcLength = arcLength;\n  fragColor = color;\n}\n"]),at=tt(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3      clipBounds[2];\nuniform sampler2D dashTexture;\nuniform float     dashScale;\nuniform float     opacity;\n\nvarying vec3    worldPosition;\nvarying float   pixelArcLength;\nvarying vec4    fragColor;\n\nvoid main() {\n  if (\n    outOfRange(clipBounds[0], clipBounds[1], worldPosition) ||\n    fragColor.a * opacity == 0.\n  ) discard;\n\n  float dashWeight = texture2D(dashTexture, vec2(dashScale * pixelArcLength, 0)).r;\n  if(dashWeight < 0.5) {\n    discard;\n  }\n  gl_FragColor = fragColor * opacity;\n}\n"]),it=tt(["precision highp float;\n#define GLSLIFY 1\n\n#define FLOAT_MAX  1.70141184e38\n#define FLOAT_MIN  1.17549435e-38\n\n// https://github.com/mikolalysenko/glsl-read-float/blob/master/index.glsl\nvec4 packFloat(float v) {\n  float av = abs(v);\n\n  //Handle special cases\n  if(av < FLOAT_MIN) {\n    return vec4(0.0, 0.0, 0.0, 0.0);\n  } else if(v > FLOAT_MAX) {\n    return vec4(127.0, 128.0, 0.0, 0.0) / 255.0;\n  } else if(v < -FLOAT_MAX) {\n    return vec4(255.0, 128.0, 0.0, 0.0) / 255.0;\n  }\n\n  vec4 c = vec4(0,0,0,0);\n\n  //Compute exponent and mantissa\n  float e = floor(log2(av));\n  float m = av * pow(2.0, -e) - 1.0;\n\n  //Unpack mantissa\n  c[1] = floor(128.0 * m);\n  m -= c[1] / 128.0;\n  c[2] = floor(32768.0 * m);\n  m -= c[2] / 32768.0;\n  c[3] = floor(8388608.0 * m);\n\n  //Unpack exponent\n  float ebias = e + 127.0;\n  c[0] = floor(ebias / 2.0);\n  ebias -= c[0] * 2.0;\n  c[1] += floor(ebias) * 128.0;\n\n  //Unpack sign bit\n  c[0] += 128.0 * step(0.0, -v);\n\n  //Scale back to range\n  return c / 255.0;\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform float pickId;\nuniform vec3 clipBounds[2];\n\nvarying vec3 worldPosition;\nvarying float pixelArcLength;\nvarying vec4 fragColor;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], worldPosition)) discard;\n\n  gl_FragColor = vec4(pickId/255.0, packFloat(pixelArcLength).xyz);\n}"]),ot=[{name:"position",type:"vec3"},{name:"nextPosition",type:"vec3"},{name:"arcLength",type:"float"},{name:"lineWidth",type:"float"},{name:"color",type:"vec4"}];Qe.createShader=function(Ne){return rt(Ne,nt,at,null,ot)},Qe.createPickShader=function(Ne){return rt(Ne,nt,it,null,ot)}},{"gl-shader":335,glslify:276}],275:[function(Ne,Ge,Qe){"use strict";Ge.exports=createLinePlot;var tt=Ne("gl-buffer"),rt=Ne("gl-vao"),nt=Ne("gl-texture2d"),at=new Uint8Array(4),it=new Float32Array(at.buffer);function unpackFloat(Ne,Ge,Qe,tt){return at[0]=tt,at[1]=Qe,at[2]=Ge,at[3]=Ne,it[0]}var ot=Ne("binary-search-bounds"),dt=Ne("ndarray"),ht=Ne("./lib/shaders"),Dt=ht.createShader,Ot=ht.createPickShader,Rt=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function distance(Ne,Ge){for(var Qe=0,tt=0;tt<3;++tt){var rt=Ne[tt]-Ge[tt];Qe+=rt*rt}return Math.sqrt(Qe)}function filterClipBounds(Ne){for(var Ge=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],Qe=0;Qe<3;++Qe)Ge[0][Qe]=Math.max(Ne[0][Qe],Ge[0][Qe]),Ge[1][Qe]=Math.min(Ne[1][Qe],Ge[1][Qe]);return Ge}function PickResult(Ne,Ge,Qe,tt){this.arcLength=Ne,this.position=Ge,this.index=Qe,this.dataCoordinate=tt}function LinePlot(Ne,Ge,Qe,tt,rt,nt){this.gl=Ne,this.shader=Ge,this.pickShader=Qe,this.buffer=tt,this.vao=rt,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.points=[],this.arcLength=[],this.vertexCount=0,this.bounds=[[0,0,0],[0,0,0]],this.pickId=0,this.lineWidth=1,this.texture=nt,this.dashScale=1,this.opacity=1,this.hasAlpha=!1,this.dirty=!0,this.pixelRatio=1}var Zt=LinePlot.prototype;function createLinePlot(Ne){var Ge=Ne.gl||Ne.scene&&Ne.scene.gl,Qe=Dt(Ge);Qe.attributes.position.location=0,Qe.attributes.nextPosition.location=1,Qe.attributes.arcLength.location=2,Qe.attributes.lineWidth.location=3,Qe.attributes.color.location=4;var at=Ot(Ge);at.attributes.position.location=0,at.attributes.nextPosition.location=1,at.attributes.arcLength.location=2,at.attributes.lineWidth.location=3,at.attributes.color.location=4;for(var it=tt(Ge),ot=rt(Ge,[{buffer:it,size:3,offset:0,stride:48},{buffer:it,size:3,offset:12,stride:48},{buffer:it,size:1,offset:24,stride:48},{buffer:it,size:1,offset:28,stride:48},{buffer:it,size:4,offset:32,stride:48}]),ht=dt(new Array(1024),[256,1,4]),Rt=0;Rt<1024;++Rt)ht.data[Rt]=255;var Zt=nt(Ge,ht);Zt.wrap=Ge.REPEAT;var er=new LinePlot(Ge,Qe,at,it,ot,Zt);return er.update(Ne),er}Zt.isTransparent=function(){return this.hasAlpha},Zt.isOpaque=function(){return!this.hasAlpha},Zt.pickSlots=1,Zt.setPickBase=function(Ne){this.pickId=Ne},Zt.drawTransparent=Zt.draw=function(Ne){if(this.vertexCount){var Ge=this.gl,Qe=this.shader,tt=this.vao;Qe.bind(),Qe.uniforms={model:Ne.model||Rt,view:Ne.view||Rt,projection:Ne.projection||Rt,clipBounds:filterClipBounds(this.clipBounds),dashTexture:this.texture.bind(),dashScale:this.dashScale/this.arcLength[this.arcLength.length-1],opacity:this.opacity,screenShape:[Ge.drawingBufferWidth,Ge.drawingBufferHeight],pixelRatio:this.pixelRatio},tt.bind(),tt.draw(Ge.TRIANGLE_STRIP,this.vertexCount),tt.unbind()}},Zt.drawPick=function(Ne){if(this.vertexCount){var Ge=this.gl,Qe=this.pickShader,tt=this.vao;Qe.bind(),Qe.uniforms={model:Ne.model||Rt,view:Ne.view||Rt,projection:Ne.projection||Rt,pickId:this.pickId,clipBounds:filterClipBounds(this.clipBounds),screenShape:[Ge.drawingBufferWidth,Ge.drawingBufferHeight],pixelRatio:this.pixelRatio},tt.bind(),tt.draw(Ge.TRIANGLE_STRIP,this.vertexCount),tt.unbind()}},Zt.update=function(Ne){var Ge,Qe;this.dirty=!0;var tt=!!Ne.connectGaps;"dashScale"in Ne&&(this.dashScale=Ne.dashScale),this.hasAlpha=!1,"opacity"in Ne&&(this.opacity=+Ne.opacity,this.opacity<1&&(this.hasAlpha=!0));var rt=[],nt=[],at=[],it=0,ht=0,Dt=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],Ot=Ne.position||Ne.positions;if(Ot){var Rt=Ne.color||Ne.colors||[0,0,0,1],Zt=Ne.lineWidth||1,er=!1;e:for(Ge=1;Ge<Ot.length;++Ge){var dr,mr,xr,br=Ot[Ge-1],Ar=Ot[Ge];for(nt.push(it),at.push(br.slice()),Qe=0;Qe<3;++Qe){if(isNaN(br[Qe])||isNaN(Ar[Qe])||!isFinite(br[Qe])||!isFinite(Ar[Qe])){if(!tt&&rt.length>0){for(var en=0;en<24;++en)rt.push(rt[rt.length-12]);ht+=2,er=!0}continue e}Dt[0][Qe]=Math.min(Dt[0][Qe],br[Qe],Ar[Qe]),Dt[1][Qe]=Math.max(Dt[1][Qe],br[Qe],Ar[Qe])}Array.isArray(Rt[0])?(dr=Rt.length>Ge-1?Rt[Ge-1]:Rt.length>0?Rt[Rt.length-1]:[0,0,0,1],mr=Rt.length>Ge?Rt[Ge]:Rt.length>0?Rt[Rt.length-1]:[0,0,0,1]):dr=mr=Rt,3===dr.length&&(dr=[dr[0],dr[1],dr[2],1]),3===mr.length&&(mr=[mr[0],mr[1],mr[2],1]),!this.hasAlpha&&dr[3]<1&&(this.hasAlpha=!0),xr=Array.isArray(Zt)?Zt.length>Ge-1?Zt[Ge-1]:Zt.length>0?Zt[Zt.length-1]:[0,0,0,1]:Zt;var mn=it;if(it+=distance(br,Ar),er){for(Qe=0;Qe<2;++Qe)rt.push(br[0],br[1],br[2],Ar[0],Ar[1],Ar[2],mn,xr,dr[0],dr[1],dr[2],dr[3]);ht+=2,er=!1}rt.push(br[0],br[1],br[2],Ar[0],Ar[1],Ar[2],mn,xr,dr[0],dr[1],dr[2],dr[3],br[0],br[1],br[2],Ar[0],Ar[1],Ar[2],mn,-xr,dr[0],dr[1],dr[2],dr[3],Ar[0],Ar[1],Ar[2],br[0],br[1],br[2],it,-xr,mr[0],mr[1],mr[2],mr[3],Ar[0],Ar[1],Ar[2],br[0],br[1],br[2],it,xr,mr[0],mr[1],mr[2],mr[3]),ht+=4}}if(this.buffer.update(rt),nt.push(it),at.push(Ot[Ot.length-1].slice()),this.bounds=Dt,this.vertexCount=ht,this.points=at,this.arcLength=nt,"dashes"in Ne){var xn=Ne.dashes.slice();for(xn.unshift(0),Ge=1;Ge<xn.length;++Ge)xn[Ge]=xn[Ge-1]+xn[Ge];var kn=dt(new Array(1024),[256,1,4]);for(Ge=0;Ge<256;++Ge){for(Qe=0;Qe<4;++Qe)kn.set(Ge,0,Qe,0);1&ot.le(xn,xn[xn.length-1]*Ge/255)?kn.set(Ge,0,0,0):kn.set(Ge,0,0,255)}this.texture.setPixels(kn)}},Zt.dispose=function(){this.shader.dispose(),this.vao.dispose(),this.buffer.dispose()},Zt.pick=function(Ne){if(!Ne)return null;if(Ne.id!==this.pickId)return null;var Ge=unpackFloat(Ne.value[0],Ne.value[1],Ne.value[2],0),Qe=ot.le(this.arcLength,Ge);if(Qe<0)return null;if(Qe===this.arcLength.length-1)return new PickResult(this.arcLength[this.arcLength.length-1],this.points[this.points.length-1].slice(),Qe);for(var tt=this.points[Qe],rt=this.points[Math.min(Qe+1,this.points.length-1)],nt=(Ge-this.arcLength[Qe])/(this.arcLength[Qe+1]-this.arcLength[Qe]),at=1-nt,it=[0,0,0],dt=0;dt<3;++dt)it[dt]=at*tt[dt]+nt*rt[dt];var ht=Math.min(nt<.5?Qe:Qe+1,this.points.length-1);return new PickResult(Ge,it,ht,this.points[ht])}},{"./lib/shaders":274,"binary-search-bounds":96,"gl-buffer":259,"gl-texture2d":353,"gl-vao":358,ndarray:495}],276:[function(Ne,Ge,Qe){arguments[4][257][0].apply(Qe,arguments)},{dup:257}],277:[function(Ne,Ge,Qe){function adjoint(Ne,Ge){var Qe=Ge[0],tt=Ge[1],rt=Ge[2],nt=Ge[3],at=Ge[4],it=Ge[5],ot=Ge[6],dt=Ge[7],ht=Ge[8],Dt=Ge[9],Ot=Ge[10],Rt=Ge[11],Zt=Ge[12],er=Ge[13],dr=Ge[14],mr=Ge[15];return Ne[0]=it*(Ot*mr-Rt*dr)-Dt*(ot*mr-dt*dr)+er*(ot*Rt-dt*Ot),Ne[1]=-(tt*(Ot*mr-Rt*dr)-Dt*(rt*mr-nt*dr)+er*(rt*Rt-nt*Ot)),Ne[2]=tt*(ot*mr-dt*dr)-it*(rt*mr-nt*dr)+er*(rt*dt-nt*ot),Ne[3]=-(tt*(ot*Rt-dt*Ot)-it*(rt*Rt-nt*Ot)+Dt*(rt*dt-nt*ot)),Ne[4]=-(at*(Ot*mr-Rt*dr)-ht*(ot*mr-dt*dr)+Zt*(ot*Rt-dt*Ot)),Ne[5]=Qe*(Ot*mr-Rt*dr)-ht*(rt*mr-nt*dr)+Zt*(rt*Rt-nt*Ot),Ne[6]=-(Qe*(ot*mr-dt*dr)-at*(rt*mr-nt*dr)+Zt*(rt*dt-nt*ot)),Ne[7]=Qe*(ot*Rt-dt*Ot)-at*(rt*Rt-nt*Ot)+ht*(rt*dt-nt*ot),Ne[8]=at*(Dt*mr-Rt*er)-ht*(it*mr-dt*er)+Zt*(it*Rt-dt*Dt),Ne[9]=-(Qe*(Dt*mr-Rt*er)-ht*(tt*mr-nt*er)+Zt*(tt*Rt-nt*Dt)),Ne[10]=Qe*(it*mr-dt*er)-at*(tt*mr-nt*er)+Zt*(tt*dt-nt*it),Ne[11]=-(Qe*(it*Rt-dt*Dt)-at*(tt*Rt-nt*Dt)+ht*(tt*dt-nt*it)),Ne[12]=-(at*(Dt*dr-Ot*er)-ht*(it*dr-ot*er)+Zt*(it*Ot-ot*Dt)),Ne[13]=Qe*(Dt*dr-Ot*er)-ht*(tt*dr-rt*er)+Zt*(tt*Ot-rt*Dt),Ne[14]=-(Qe*(it*dr-ot*er)-at*(tt*dr-rt*er)+Zt*(tt*ot-rt*it)),Ne[15]=Qe*(it*Ot-ot*Dt)-at*(tt*Ot-rt*Dt)+ht*(tt*ot-rt*it),Ne}Ge.exports=adjoint},{}],278:[function(Ne,Ge,Qe){function clone(Ne){var Ge=new Float32Array(16);return Ge[0]=Ne[0],Ge[1]=Ne[1],Ge[2]=Ne[2],Ge[3]=Ne[3],Ge[4]=Ne[4],Ge[5]=Ne[5],Ge[6]=Ne[6],Ge[7]=Ne[7],Ge[8]=Ne[8],Ge[9]=Ne[9],Ge[10]=Ne[10],Ge[11]=Ne[11],Ge[12]=Ne[12],Ge[13]=Ne[13],Ge[14]=Ne[14],Ge[15]=Ne[15],Ge}Ge.exports=clone},{}],279:[function(Ne,Ge,Qe){function copy(Ne,Ge){return Ne[0]=Ge[0],Ne[1]=Ge[1],Ne[2]=Ge[2],Ne[3]=Ge[3],Ne[4]=Ge[4],Ne[5]=Ge[5],Ne[6]=Ge[6],Ne[7]=Ge[7],Ne[8]=Ge[8],Ne[9]=Ge[9],Ne[10]=Ge[10],Ne[11]=Ge[11],Ne[12]=Ge[12],Ne[13]=Ge[13],Ne[14]=Ge[14],Ne[15]=Ge[15],Ne}Ge.exports=copy},{}],280:[function(Ne,Ge,Qe){function create(){var Ne=new Float32Array(16);return Ne[0]=1,Ne[1]=0,Ne[2]=0,Ne[3]=0,Ne[4]=0,Ne[5]=1,Ne[6]=0,Ne[7]=0,Ne[8]=0,Ne[9]=0,Ne[10]=1,Ne[11]=0,Ne[12]=0,Ne[13]=0,Ne[14]=0,Ne[15]=1,Ne}Ge.exports=create},{}],281:[function(Ne,Ge,Qe){function determinant(Ne){var Ge=Ne[0],Qe=Ne[1],tt=Ne[2],rt=Ne[3],nt=Ne[4],at=Ne[5],it=Ne[6],ot=Ne[7],dt=Ne[8],ht=Ne[9],Dt=Ne[10],Ot=Ne[11],Rt=Ne[12],Zt=Ne[13],er=Ne[14],dr=Ne[15];return(Ge*at-Qe*nt)*(Dt*dr-Ot*er)-(Ge*it-tt*nt)*(ht*dr-Ot*Zt)+(Ge*ot-rt*nt)*(ht*er-Dt*Zt)+(Qe*it-tt*at)*(dt*dr-Ot*Rt)-(Qe*ot-rt*at)*(dt*er-Dt*Rt)+(tt*ot-rt*it)*(dt*Zt-ht*Rt)}Ge.exports=determinant},{}],282:[function(Ne,Ge,Qe){function fromQuat(Ne,Ge){var Qe=Ge[0],tt=Ge[1],rt=Ge[2],nt=Ge[3],at=Qe+Qe,it=tt+tt,ot=rt+rt,dt=Qe*at,ht=tt*at,Dt=tt*it,Ot=rt*at,Rt=rt*it,Zt=rt*ot,er=nt*at,dr=nt*it,mr=nt*ot;return Ne[0]=1-Dt-Zt,Ne[1]=ht+mr,Ne[2]=Ot-dr,Ne[3]=0,Ne[4]=ht-mr,Ne[5]=1-dt-Zt,Ne[6]=Rt+er,Ne[7]=0,Ne[8]=Ot+dr,Ne[9]=Rt-er,Ne[10]=1-dt-Dt,Ne[11]=0,Ne[12]=0,Ne[13]=0,Ne[14]=0,Ne[15]=1,Ne}Ge.exports=fromQuat},{}],283:[function(Ne,Ge,Qe){function fromRotation(Ne,Ge,Qe){var tt,rt,nt,at=Qe[0],it=Qe[1],ot=Qe[2],dt=Math.sqrt(at*at+it*it+ot*ot);return Math.abs(dt)<1e-6?null:(at*=dt=1/dt,it*=dt,ot*=dt,tt=Math.sin(Ge),nt=1-(rt=Math.cos(Ge)),Ne[0]=at*at*nt+rt,Ne[1]=it*at*nt+ot*tt,Ne[2]=ot*at*nt-it*tt,Ne[3]=0,Ne[4]=at*it*nt-ot*tt,Ne[5]=it*it*nt+rt,Ne[6]=ot*it*nt+at*tt,Ne[7]=0,Ne[8]=at*ot*nt+it*tt,Ne[9]=it*ot*nt-at*tt,Ne[10]=ot*ot*nt+rt,Ne[11]=0,Ne[12]=0,Ne[13]=0,Ne[14]=0,Ne[15]=1,Ne)}Ge.exports=fromRotation},{}],284:[function(Ne,Ge,Qe){function fromRotationTranslation(Ne,Ge,Qe){var tt=Ge[0],rt=Ge[1],nt=Ge[2],at=Ge[3],it=tt+tt,ot=rt+rt,dt=nt+nt,ht=tt*it,Dt=tt*ot,Ot=tt*dt,Rt=rt*ot,Zt=rt*dt,er=nt*dt,dr=at*it,mr=at*ot,xr=at*dt;return Ne[0]=1-(Rt+er),Ne[1]=Dt+xr,Ne[2]=Ot-mr,Ne[3]=0,Ne[4]=Dt-xr,Ne[5]=1-(ht+er),Ne[6]=Zt+dr,Ne[7]=0,Ne[8]=Ot+mr,Ne[9]=Zt-dr,Ne[10]=1-(ht+Rt),Ne[11]=0,Ne[12]=Qe[0],Ne[13]=Qe[1],Ne[14]=Qe[2],Ne[15]=1,Ne}Ge.exports=fromRotationTranslation},{}],285:[function(Ne,Ge,Qe){function fromScaling(Ne,Ge){return Ne[0]=Ge[0],Ne[1]=0,Ne[2]=0,Ne[3]=0,Ne[4]=0,Ne[5]=Ge[1],Ne[6]=0,Ne[7]=0,Ne[8]=0,Ne[9]=0,Ne[10]=Ge[2],Ne[11]=0,Ne[12]=0,Ne[13]=0,Ne[14]=0,Ne[15]=1,Ne}Ge.exports=fromScaling},{}],286:[function(Ne,Ge,Qe){function fromTranslation(Ne,Ge){return Ne[0]=1,Ne[1]=0,Ne[2]=0,Ne[3]=0,Ne[4]=0,Ne[5]=1,Ne[6]=0,Ne[7]=0,Ne[8]=0,Ne[9]=0,Ne[10]=1,Ne[11]=0,Ne[12]=Ge[0],Ne[13]=Ge[1],Ne[14]=Ge[2],Ne[15]=1,Ne}Ge.exports=fromTranslation},{}],287:[function(Ne,Ge,Qe){function fromXRotation(Ne,Ge){var Qe=Math.sin(Ge),tt=Math.cos(Ge);return Ne[0]=1,Ne[1]=0,Ne[2]=0,Ne[3]=0,Ne[4]=0,Ne[5]=tt,Ne[6]=Qe,Ne[7]=0,Ne[8]=0,Ne[9]=-Qe,Ne[10]=tt,Ne[11]=0,Ne[12]=0,Ne[13]=0,Ne[14]=0,Ne[15]=1,Ne}Ge.exports=fromXRotation},{}],288:[function(Ne,Ge,Qe){function fromYRotation(Ne,Ge){var Qe=Math.sin(Ge),tt=Math.cos(Ge);return Ne[0]=tt,Ne[1]=0,Ne[2]=-Qe,Ne[3]=0,Ne[4]=0,Ne[5]=1,Ne[6]=0,Ne[7]=0,Ne[8]=Qe,Ne[9]=0,Ne[10]=tt,Ne[11]=0,Ne[12]=0,Ne[13]=0,Ne[14]=0,Ne[15]=1,Ne}Ge.exports=fromYRotation},{}],289:[function(Ne,Ge,Qe){function fromZRotation(Ne,Ge){var Qe=Math.sin(Ge),tt=Math.cos(Ge);return Ne[0]=tt,Ne[1]=Qe,Ne[2]=0,Ne[3]=0,Ne[4]=-Qe,Ne[5]=tt,Ne[6]=0,Ne[7]=0,Ne[8]=0,Ne[9]=0,Ne[10]=1,Ne[11]=0,Ne[12]=0,Ne[13]=0,Ne[14]=0,Ne[15]=1,Ne}Ge.exports=fromZRotation},{}],290:[function(Ne,Ge,Qe){function frustum(Ne,Ge,Qe,tt,rt,nt,at){var it=1/(Qe-Ge),ot=1/(rt-tt),dt=1/(nt-at);return Ne[0]=2*nt*it,Ne[1]=0,Ne[2]=0,Ne[3]=0,Ne[4]=0,Ne[5]=2*nt*ot,Ne[6]=0,Ne[7]=0,Ne[8]=(Qe+Ge)*it,Ne[9]=(rt+tt)*ot,Ne[10]=(at+nt)*dt,Ne[11]=-1,Ne[12]=0,Ne[13]=0,Ne[14]=at*nt*2*dt,Ne[15]=0,Ne}Ge.exports=frustum},{}],291:[function(Ne,Ge,Qe){function identity(Ne){return Ne[0]=1,Ne[1]=0,Ne[2]=0,Ne[3]=0,Ne[4]=0,Ne[5]=1,Ne[6]=0,Ne[7]=0,Ne[8]=0,Ne[9]=0,Ne[10]=1,Ne[11]=0,Ne[12]=0,Ne[13]=0,Ne[14]=0,Ne[15]=1,Ne}Ge.exports=identity},{}],292:[function(Ne,Ge,Qe){Ge.exports={create:Ne("./create"),clone:Ne("./clone"),copy:Ne("./copy"),identity:Ne("./identity"),transpose:Ne("./transpose"),invert:Ne("./invert"),adjoint:Ne("./adjoint"),determinant:Ne("./determinant"),multiply:Ne("./multiply"),translate:Ne("./translate"),scale:Ne("./scale"),rotate:Ne("./rotate"),rotateX:Ne("./rotateX"),rotateY:Ne("./rotateY"),rotateZ:Ne("./rotateZ"),fromRotation:Ne("./fromRotation"),fromRotationTranslation:Ne("./fromRotationTranslation"),fromScaling:Ne("./fromScaling"),fromTranslation:Ne("./fromTranslation"),fromXRotation:Ne("./fromXRotation"),fromYRotation:Ne("./fromYRotation"),fromZRotation:Ne("./fromZRotation"),fromQuat:Ne("./fromQuat"),frustum:Ne("./frustum"),perspective:Ne("./perspective"),perspectiveFromFieldOfView:Ne("./perspectiveFromFieldOfView"),ortho:Ne("./ortho"),lookAt:Ne("./lookAt"),str:Ne("./str")}},{"./adjoint":277,"./clone":278,"./copy":279,"./create":280,"./determinant":281,"./fromQuat":282,"./fromRotation":283,"./fromRotationTranslation":284,"./fromScaling":285,"./fromTranslation":286,"./fromXRotation":287,"./fromYRotation":288,"./fromZRotation":289,"./frustum":290,"./identity":291,"./invert":293,"./lookAt":294,"./multiply":295,"./ortho":296,"./perspective":297,"./perspectiveFromFieldOfView":298,"./rotate":299,"./rotateX":300,"./rotateY":301,"./rotateZ":302,"./scale":303,"./str":304,"./translate":305,"./transpose":306}],293:[function(Ne,Ge,Qe){function invert(Ne,Ge){var Qe=Ge[0],tt=Ge[1],rt=Ge[2],nt=Ge[3],at=Ge[4],it=Ge[5],ot=Ge[6],dt=Ge[7],ht=Ge[8],Dt=Ge[9],Ot=Ge[10],Rt=Ge[11],Zt=Ge[12],er=Ge[13],dr=Ge[14],mr=Ge[15],xr=Qe*it-tt*at,br=Qe*ot-rt*at,Ar=Qe*dt-nt*at,en=tt*ot-rt*it,mn=tt*dt-nt*it,xn=rt*dt-nt*ot,kn=ht*er-Dt*Zt,Cn=ht*dr-Ot*Zt,En=ht*mr-Rt*Zt,Pn=Dt*dr-Ot*er,Dn=Dt*mr-Rt*er,In=Ot*mr-Rt*dr,zn=xr*In-br*Dn+Ar*Pn+en*En-mn*Cn+xn*kn;return zn?(zn=1/zn,Ne[0]=(it*In-ot*Dn+dt*Pn)*zn,Ne[1]=(rt*Dn-tt*In-nt*Pn)*zn,Ne[2]=(er*xn-dr*mn+mr*en)*zn,Ne[3]=(Ot*mn-Dt*xn-Rt*en)*zn,Ne[4]=(ot*En-at*In-dt*Cn)*zn,Ne[5]=(Qe*In-rt*En+nt*Cn)*zn,Ne[6]=(dr*Ar-Zt*xn-mr*br)*zn,Ne[7]=(ht*xn-Ot*Ar+Rt*br)*zn,Ne[8]=(at*Dn-it*En+dt*kn)*zn,Ne[9]=(tt*En-Qe*Dn-nt*kn)*zn,Ne[10]=(Zt*mn-er*Ar+mr*xr)*zn,Ne[11]=(Dt*Ar-ht*mn-Rt*xr)*zn,Ne[12]=(it*Cn-at*Pn-ot*kn)*zn,Ne[13]=(Qe*Pn-tt*Cn+rt*kn)*zn,Ne[14]=(er*br-Zt*en-dr*xr)*zn,Ne[15]=(ht*en-Dt*br+Ot*xr)*zn,Ne):null}Ge.exports=invert},{}],294:[function(Ne,Ge,Qe){var tt=Ne("./identity");function lookAt(Ne,Ge,Qe,rt){var nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt,er=Ge[0],dr=Ge[1],mr=Ge[2],xr=rt[0],br=rt[1],Ar=rt[2],en=Qe[0],mn=Qe[1],xn=Qe[2];return Math.abs(er-en)<1e-6&&Math.abs(dr-mn)<1e-6&&Math.abs(mr-xn)<1e-6?tt(Ne):(Dt=er-en,Ot=dr-mn,Rt=mr-xn,nt=br*(Rt*=Zt=1/Math.sqrt(Dt*Dt+Ot*Ot+Rt*Rt))-Ar*(Ot*=Zt),at=Ar*(Dt*=Zt)-xr*Rt,it=xr*Ot-br*Dt,(Zt=Math.sqrt(nt*nt+at*at+it*it))?(nt*=Zt=1/Zt,at*=Zt,it*=Zt):(nt=0,at=0,it=0),ot=Ot*it-Rt*at,dt=Rt*nt-Dt*it,ht=Dt*at-Ot*nt,(Zt=Math.sqrt(ot*ot+dt*dt+ht*ht))?(ot*=Zt=1/Zt,dt*=Zt,ht*=Zt):(ot=0,dt=0,ht=0),Ne[0]=nt,Ne[1]=ot,Ne[2]=Dt,Ne[3]=0,Ne[4]=at,Ne[5]=dt,Ne[6]=Ot,Ne[7]=0,Ne[8]=it,Ne[9]=ht,Ne[10]=Rt,Ne[11]=0,Ne[12]=-(nt*er+at*dr+it*mr),Ne[13]=-(ot*er+dt*dr+ht*mr),Ne[14]=-(Dt*er+Ot*dr+Rt*mr),Ne[15]=1,Ne)}Ge.exports=lookAt},{"./identity":291}],295:[function(Ne,Ge,Qe){function multiply(Ne,Ge,Qe){var tt=Ge[0],rt=Ge[1],nt=Ge[2],at=Ge[3],it=Ge[4],ot=Ge[5],dt=Ge[6],ht=Ge[7],Dt=Ge[8],Ot=Ge[9],Rt=Ge[10],Zt=Ge[11],er=Ge[12],dr=Ge[13],mr=Ge[14],xr=Ge[15],br=Qe[0],Ar=Qe[1],en=Qe[2],mn=Qe[3];return Ne[0]=br*tt+Ar*it+en*Dt+mn*er,Ne[1]=br*rt+Ar*ot+en*Ot+mn*dr,Ne[2]=br*nt+Ar*dt+en*Rt+mn*mr,Ne[3]=br*at+Ar*ht+en*Zt+mn*xr,br=Qe[4],Ar=Qe[5],en=Qe[6],mn=Qe[7],Ne[4]=br*tt+Ar*it+en*Dt+mn*er,Ne[5]=br*rt+Ar*ot+en*Ot+mn*dr,Ne[6]=br*nt+Ar*dt+en*Rt+mn*mr,Ne[7]=br*at+Ar*ht+en*Zt+mn*xr,br=Qe[8],Ar=Qe[9],en=Qe[10],mn=Qe[11],Ne[8]=br*tt+Ar*it+en*Dt+mn*er,Ne[9]=br*rt+Ar*ot+en*Ot+mn*dr,Ne[10]=br*nt+Ar*dt+en*Rt+mn*mr,Ne[11]=br*at+Ar*ht+en*Zt+mn*xr,br=Qe[12],Ar=Qe[13],en=Qe[14],mn=Qe[15],Ne[12]=br*tt+Ar*it+en*Dt+mn*er,Ne[13]=br*rt+Ar*ot+en*Ot+mn*dr,Ne[14]=br*nt+Ar*dt+en*Rt+mn*mr,Ne[15]=br*at+Ar*ht+en*Zt+mn*xr,Ne}Ge.exports=multiply},{}],296:[function(Ne,Ge,Qe){function ortho(Ne,Ge,Qe,tt,rt,nt,at){var it=1/(Ge-Qe),ot=1/(tt-rt),dt=1/(nt-at);return Ne[0]=-2*it,Ne[1]=0,Ne[2]=0,Ne[3]=0,Ne[4]=0,Ne[5]=-2*ot,Ne[6]=0,Ne[7]=0,Ne[8]=0,Ne[9]=0,Ne[10]=2*dt,Ne[11]=0,Ne[12]=(Ge+Qe)*it,Ne[13]=(rt+tt)*ot,Ne[14]=(at+nt)*dt,Ne[15]=1,Ne}Ge.exports=ortho},{}],297:[function(Ne,Ge,Qe){function perspective(Ne,Ge,Qe,tt,rt){var nt=1/Math.tan(Ge/2),at=1/(tt-rt);return Ne[0]=nt/Qe,Ne[1]=0,Ne[2]=0,Ne[3]=0,Ne[4]=0,Ne[5]=nt,Ne[6]=0,Ne[7]=0,Ne[8]=0,Ne[9]=0,Ne[10]=(rt+tt)*at,Ne[11]=-1,Ne[12]=0,Ne[13]=0,Ne[14]=2*rt*tt*at,Ne[15]=0,Ne}Ge.exports=perspective},{}],298:[function(Ne,Ge,Qe){function perspectiveFromFieldOfView(Ne,Ge,Qe,tt){var rt=Math.tan(Ge.upDegrees*Math.PI/180),nt=Math.tan(Ge.downDegrees*Math.PI/180),at=Math.tan(Ge.leftDegrees*Math.PI/180),it=Math.tan(Ge.rightDegrees*Math.PI/180),ot=2/(at+it),dt=2/(rt+nt);return Ne[0]=ot,Ne[1]=0,Ne[2]=0,Ne[3]=0,Ne[4]=0,Ne[5]=dt,Ne[6]=0,Ne[7]=0,Ne[8]=-(at-it)*ot*.5,Ne[9]=(rt-nt)*dt*.5,Ne[10]=tt/(Qe-tt),Ne[11]=-1,Ne[12]=0,Ne[13]=0,Ne[14]=tt*Qe/(Qe-tt),Ne[15]=0,Ne}Ge.exports=perspectiveFromFieldOfView},{}],299:[function(Ne,Ge,Qe){function rotate(Ne,Ge,Qe,tt){var rt,nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt,er,dr,mr,xr,br,Ar,en,mn,xn,kn,Cn,En,Pn,Dn=tt[0],In=tt[1],zn=tt[2],Bn=Math.sqrt(Dn*Dn+In*In+zn*zn);return Math.abs(Bn)<1e-6?null:(Dn*=Bn=1/Bn,In*=Bn,zn*=Bn,rt=Math.sin(Qe),at=1-(nt=Math.cos(Qe)),it=Ge[0],ot=Ge[1],dt=Ge[2],ht=Ge[3],Dt=Ge[4],Ot=Ge[5],Rt=Ge[6],Zt=Ge[7],er=Ge[8],dr=Ge[9],mr=Ge[10],xr=Ge[11],br=Dn*Dn*at+nt,Ar=In*Dn*at+zn*rt,en=zn*Dn*at-In*rt,mn=Dn*In*at-zn*rt,xn=In*In*at+nt,kn=zn*In*at+Dn*rt,Cn=Dn*zn*at+In*rt,En=In*zn*at-Dn*rt,Pn=zn*zn*at+nt,Ne[0]=it*br+Dt*Ar+er*en,Ne[1]=ot*br+Ot*Ar+dr*en,Ne[2]=dt*br+Rt*Ar+mr*en,Ne[3]=ht*br+Zt*Ar+xr*en,Ne[4]=it*mn+Dt*xn+er*kn,Ne[5]=ot*mn+Ot*xn+dr*kn,Ne[6]=dt*mn+Rt*xn+mr*kn,Ne[7]=ht*mn+Zt*xn+xr*kn,Ne[8]=it*Cn+Dt*En+er*Pn,Ne[9]=ot*Cn+Ot*En+dr*Pn,Ne[10]=dt*Cn+Rt*En+mr*Pn,Ne[11]=ht*Cn+Zt*En+xr*Pn,Ge!==Ne&&(Ne[12]=Ge[12],Ne[13]=Ge[13],Ne[14]=Ge[14],Ne[15]=Ge[15]),Ne)}Ge.exports=rotate},{}],300:[function(Ne,Ge,Qe){function rotateX(Ne,Ge,Qe){var tt=Math.sin(Qe),rt=Math.cos(Qe),nt=Ge[4],at=Ge[5],it=Ge[6],ot=Ge[7],dt=Ge[8],ht=Ge[9],Dt=Ge[10],Ot=Ge[11];return Ge!==Ne&&(Ne[0]=Ge[0],Ne[1]=Ge[1],Ne[2]=Ge[2],Ne[3]=Ge[3],Ne[12]=Ge[12],Ne[13]=Ge[13],Ne[14]=Ge[14],Ne[15]=Ge[15]),Ne[4]=nt*rt+dt*tt,Ne[5]=at*rt+ht*tt,Ne[6]=it*rt+Dt*tt,Ne[7]=ot*rt+Ot*tt,Ne[8]=dt*rt-nt*tt,Ne[9]=ht*rt-at*tt,Ne[10]=Dt*rt-it*tt,Ne[11]=Ot*rt-ot*tt,Ne}Ge.exports=rotateX},{}],301:[function(Ne,Ge,Qe){function rotateY(Ne,Ge,Qe){var tt=Math.sin(Qe),rt=Math.cos(Qe),nt=Ge[0],at=Ge[1],it=Ge[2],ot=Ge[3],dt=Ge[8],ht=Ge[9],Dt=Ge[10],Ot=Ge[11];return Ge!==Ne&&(Ne[4]=Ge[4],Ne[5]=Ge[5],Ne[6]=Ge[6],Ne[7]=Ge[7],Ne[12]=Ge[12],Ne[13]=Ge[13],Ne[14]=Ge[14],Ne[15]=Ge[15]),Ne[0]=nt*rt-dt*tt,Ne[1]=at*rt-ht*tt,Ne[2]=it*rt-Dt*tt,Ne[3]=ot*rt-Ot*tt,Ne[8]=nt*tt+dt*rt,Ne[9]=at*tt+ht*rt,Ne[10]=it*tt+Dt*rt,Ne[11]=ot*tt+Ot*rt,Ne}Ge.exports=rotateY},{}],302:[function(Ne,Ge,Qe){function rotateZ(Ne,Ge,Qe){var tt=Math.sin(Qe),rt=Math.cos(Qe),nt=Ge[0],at=Ge[1],it=Ge[2],ot=Ge[3],dt=Ge[4],ht=Ge[5],Dt=Ge[6],Ot=Ge[7];return Ge!==Ne&&(Ne[8]=Ge[8],Ne[9]=Ge[9],Ne[10]=Ge[10],Ne[11]=Ge[11],Ne[12]=Ge[12],Ne[13]=Ge[13],Ne[14]=Ge[14],Ne[15]=Ge[15]),Ne[0]=nt*rt+dt*tt,Ne[1]=at*rt+ht*tt,Ne[2]=it*rt+Dt*tt,Ne[3]=ot*rt+Ot*tt,Ne[4]=dt*rt-nt*tt,Ne[5]=ht*rt-at*tt,Ne[6]=Dt*rt-it*tt,Ne[7]=Ot*rt-ot*tt,Ne}Ge.exports=rotateZ},{}],303:[function(Ne,Ge,Qe){function scale(Ne,Ge,Qe){var tt=Qe[0],rt=Qe[1],nt=Qe[2];return Ne[0]=Ge[0]*tt,Ne[1]=Ge[1]*tt,Ne[2]=Ge[2]*tt,Ne[3]=Ge[3]*tt,Ne[4]=Ge[4]*rt,Ne[5]=Ge[5]*rt,Ne[6]=Ge[6]*rt,Ne[7]=Ge[7]*rt,Ne[8]=Ge[8]*nt,Ne[9]=Ge[9]*nt,Ne[10]=Ge[10]*nt,Ne[11]=Ge[11]*nt,Ne[12]=Ge[12],Ne[13]=Ge[13],Ne[14]=Ge[14],Ne[15]=Ge[15],Ne}Ge.exports=scale},{}],304:[function(Ne,Ge,Qe){function str(Ne){return"mat4("+Ne[0]+", "+Ne[1]+", "+Ne[2]+", "+Ne[3]+", "+Ne[4]+", "+Ne[5]+", "+Ne[6]+", "+Ne[7]+", "+Ne[8]+", "+Ne[9]+", "+Ne[10]+", "+Ne[11]+", "+Ne[12]+", "+Ne[13]+", "+Ne[14]+", "+Ne[15]+")"}Ge.exports=str},{}],305:[function(Ne,Ge,Qe){function translate(Ne,Ge,Qe){var tt,rt,nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt,er=Qe[0],dr=Qe[1],mr=Qe[2];return Ge===Ne?(Ne[12]=Ge[0]*er+Ge[4]*dr+Ge[8]*mr+Ge[12],Ne[13]=Ge[1]*er+Ge[5]*dr+Ge[9]*mr+Ge[13],Ne[14]=Ge[2]*er+Ge[6]*dr+Ge[10]*mr+Ge[14],Ne[15]=Ge[3]*er+Ge[7]*dr+Ge[11]*mr+Ge[15]):(tt=Ge[0],rt=Ge[1],nt=Ge[2],at=Ge[3],it=Ge[4],ot=Ge[5],dt=Ge[6],ht=Ge[7],Dt=Ge[8],Ot=Ge[9],Rt=Ge[10],Zt=Ge[11],Ne[0]=tt,Ne[1]=rt,Ne[2]=nt,Ne[3]=at,Ne[4]=it,Ne[5]=ot,Ne[6]=dt,Ne[7]=ht,Ne[8]=Dt,Ne[9]=Ot,Ne[10]=Rt,Ne[11]=Zt,Ne[12]=tt*er+it*dr+Dt*mr+Ge[12],Ne[13]=rt*er+ot*dr+Ot*mr+Ge[13],Ne[14]=nt*er+dt*dr+Rt*mr+Ge[14],Ne[15]=at*er+ht*dr+Zt*mr+Ge[15]),Ne}Ge.exports=translate},{}],306:[function(Ne,Ge,Qe){function transpose(Ne,Ge){if(Ne===Ge){var Qe=Ge[1],tt=Ge[2],rt=Ge[3],nt=Ge[6],at=Ge[7],it=Ge[11];Ne[1]=Ge[4],Ne[2]=Ge[8],Ne[3]=Ge[12],Ne[4]=Qe,Ne[6]=Ge[9],Ne[7]=Ge[13],Ne[8]=tt,Ne[9]=nt,Ne[11]=Ge[14],Ne[12]=rt,Ne[13]=at,Ne[14]=it}else Ne[0]=Ge[0],Ne[1]=Ge[4],Ne[2]=Ge[8],Ne[3]=Ge[12],Ne[4]=Ge[1],Ne[5]=Ge[5],Ne[6]=Ge[9],Ne[7]=Ge[13],Ne[8]=Ge[2],Ne[9]=Ge[6],Ne[10]=Ge[10],Ne[11]=Ge[14],Ne[12]=Ge[3],Ne[13]=Ge[7],Ne[14]=Ge[11],Ne[15]=Ge[15];return Ne}Ge.exports=transpose},{}],307:[function(Ne,Ge,Qe){"use strict";var tt=Ne("barycentric"),rt=Ne("polytope-closest-point/lib/closest_point_2d.js");function xformMatrix(Ne,Ge){for(var Qe=[0,0,0,0],tt=0;tt<4;++tt)for(var rt=0;rt<4;++rt)Qe[rt]+=Ne[4*tt+rt]*Ge[tt];return Qe}function projectVertex(Ne,Ge,Qe,tt,rt){for(var nt=xformMatrix(tt,xformMatrix(Qe,xformMatrix(Ge,[Ne[0],Ne[1],Ne[2],1]))),at=0;at<3;++at)nt[at]/=nt[3];return[.5*rt[0]*(1+nt[0]),.5*rt[1]*(1-nt[1])]}function barycentricCoord(Ne,Ge){if(2===Ne.length){for(var Qe=0,nt=0,at=0;at<2;++at)Qe+=Math.pow(Ge[at]-Ne[0][at],2),nt+=Math.pow(Ge[at]-Ne[1][at],2);return(Qe=Math.sqrt(Qe))+(nt=Math.sqrt(nt))<1e-6?[1,0]:[nt/(Qe+nt),Qe/(nt+Qe)]}if(3===Ne.length){var it=[0,0];return rt(Ne[0],Ne[1],Ne[2],Ge,it),tt(Ne,it)}return[]}function interpolate(Ne,Ge){for(var Qe=[0,0,0],tt=0;tt<Ne.length;++tt)for(var rt=Ne[tt],nt=Ge[tt],at=0;at<3;++at)Qe[at]+=nt*rt[at];return Qe}function closestPointToPickLocation(Ne,Ge,Qe,tt,rt,nt){if(1===Ne.length)return[0,Ne[0].slice()];for(var at=new Array(Ne.length),it=0;it<Ne.length;++it)at[it]=projectVertex(Ne[it],Qe,tt,rt,nt);var ot=0,dt=1/0;for(it=0;it<at.length;++it){for(var ht=0,Dt=0;Dt<2;++Dt)ht+=Math.pow(at[it][Dt]-Ge[Dt],2);ht<dt&&(dt=ht,ot=it)}var Ot=barycentricCoord(at,Ge),Rt=0;for(it=0;it<3;++it){if(Ot[it]<-.001||Ot[it]>1.0001)return null;Rt+=Ot[it]}return Math.abs(Rt-1)>.001?null:[ot,interpolate(Ne,Ot),Ot]}Ge.exports=closestPointToPickLocation},{barycentric:78,"polytope-closest-point/lib/closest_point_2d.js":525}],308:[function(Ne,Ge,Qe){var tt=Ne("glslify"),rt=tt(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position, normal;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model\n           , view\n           , projection\n           , inverseModel;\nuniform vec3 eyePosition\n           , lightPosition;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvec4 project(vec3 p) {\n  return projection * view * model * vec4(p, 1.0);\n}\n\nvoid main() {\n  gl_Position      = project(position);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * vec4(position , 1.0);\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal  = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  f_color          = color;\n  f_data           = position;\n  f_uv             = uv;\n}\n"]),nt=tt(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\n//#pragma glslify: beckmann = require(glsl-specular-beckmann) // used in gl-surface3d\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness\n            , fresnel\n            , kambient\n            , kdiffuse\n            , kspecular;\nuniform sampler2D texture;\n\nvarying vec3 f_normal\n           , f_lightDirection\n           , f_eyeDirection\n           , f_data;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (f_color.a == 0.0 ||\n    outOfRange(clipBounds[0], clipBounds[1], f_data)\n  ) discard;\n\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  //float specular = max(0.0, beckmann(L, V, N, roughness)); // used in gl-surface3d\n\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = vec4(f_color.rgb, 1.0) * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * f_color.a;\n}\n"]),at=tt(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\n\nuniform mat4 model, view, projection;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_color = color;\n  f_data  = position;\n  f_uv    = uv;\n}"]),it=tt(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec3 f_data;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_data)) discard;\n\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]),ot=tt(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 uv;\nattribute float pointSize;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0.0, 0.0 ,0.0 ,0.0);\n  } else {\n    gl_Position = projection * view * model * vec4(position, 1.0);\n  }\n  gl_PointSize = pointSize;\n  f_color = color;\n  f_uv = uv;\n}"]),dt=tt(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  vec2 pointR = gl_PointCoord.xy - vec2(0.5, 0.5);\n  if(dot(pointR, pointR) > 0.25) {\n    discard;\n  }\n  gl_FragColor = f_color * texture2D(texture, f_uv) * opacity;\n}"]),ht=tt(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n  f_id        = id;\n  f_position  = position;\n}"]),Dt=tt(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]),Ot=tt(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3  position;\nattribute float pointSize;\nattribute vec4  id;\n\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0.0, 0.0, 0.0, 0.0);\n  } else {\n    gl_Position  = projection * view * model * vec4(position, 1.0);\n    gl_PointSize = pointSize;\n  }\n  f_id         = id;\n  f_position   = position;\n}"]),Rt=tt(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec3 position;\n\nuniform mat4 model, view, projection;\n\nvoid main() {\n  gl_Position = projection * view * model * vec4(position, 1.0);\n}"]),Zt=tt(["precision highp float;\n#define GLSLIFY 1\n\nuniform vec3 contourColor;\n\nvoid main() {\n  gl_FragColor = vec4(contourColor, 1.0);\n}\n"]);Qe.meshShader={vertex:rt,fragment:nt,attributes:[{name:"position",type:"vec3"},{name:"normal",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},Qe.wireShader={vertex:at,fragment:it,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"}]},Qe.pointShader={vertex:ot,fragment:dt,attributes:[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"pointSize",type:"float"}]},Qe.pickShader={vertex:ht,fragment:Dt,attributes:[{name:"position",type:"vec3"},{name:"id",type:"vec4"}]},Qe.pointPickShader={vertex:Ot,fragment:Dt,attributes:[{name:"position",type:"vec3"},{name:"pointSize",type:"float"},{name:"id",type:"vec4"}]},Qe.contourShader={vertex:Rt,fragment:Zt,attributes:[{name:"position",type:"vec3"}]}},{glslify:310}],309:[function(Ne,Ge,Qe){"use strict";var tt=1e-6,rt=1e-6,nt=Ne("gl-shader"),at=Ne("gl-buffer"),it=Ne("gl-vao"),ot=Ne("gl-texture2d"),dt=Ne("normals"),ht=Ne("gl-mat4/multiply"),Dt=Ne("gl-mat4/invert"),Ot=Ne("ndarray"),Rt=Ne("colormap"),Zt=Ne("simplicial-complex-contour"),er=Ne("typedarray-pool"),dr=Ne("./lib/shaders"),mr=Ne("./lib/closest-point"),xr=dr.meshShader,br=dr.wireShader,Ar=dr.pointShader,en=dr.pickShader,mn=dr.pointPickShader,xn=dr.contourShader,kn=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function SimplicialMesh(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt,er,dr,mr,xr,br,Ar,en,mn,xn,Cn,En,Pn){this.gl=Ne,this.pixelRatio=1,this.cells=[],this.positions=[],this.intensity=[],this.texture=Ge,this.dirty=!0,this.triShader=Qe,this.lineShader=tt,this.pointShader=rt,this.pickShader=nt,this.pointPickShader=at,this.contourShader=it,this.trianglePositions=ot,this.triangleColors=ht,this.triangleNormals=Ot,this.triangleUVs=Dt,this.triangleIds=dt,this.triangleVAO=Rt,this.triangleCount=0,this.lineWidth=1,this.edgePositions=Zt,this.edgeColors=dr,this.edgeUVs=mr,this.edgeIds=er,this.edgeVAO=xr,this.edgeCount=0,this.pointPositions=br,this.pointColors=en,this.pointUVs=mn,this.pointSizes=xn,this.pointIds=Ar,this.pointVAO=Cn,this.pointCount=0,this.contourLineWidth=1,this.contourPositions=En,this.contourVAO=Pn,this.contourCount=0,this.contourColor=[0,0,0],this.contourEnable=!0,this.pickVertex=!0,this.pickId=1,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.lightPosition=[1e5,1e5,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.opacity=1,this.hasAlpha=!1,this.opacityscale=!1,this._model=kn,this._view=kn,this._projection=kn,this._resolution=[1,1]}var Cn=SimplicialMesh.prototype;function getOpacityFromScale(Ne,Ge){if(!Ge)return 1;if(!Ge.length)return 1;for(var Qe=0;Qe<Ge.length;++Qe){if(Ge.length<2)return 1;if(Ge[Qe][0]===Ne)return Ge[Qe][1];if(Ge[Qe][0]>Ne&&Qe>0){var tt=(Ge[Qe][0]-Ne)/(Ge[Qe][0]-Ge[Qe-1][0]);return Ge[Qe][1]*(1-tt)+tt*Ge[Qe-1][1]}}return 1}function genColormap(Ne,Ge){for(var Qe=Rt({colormap:Ne,nshades:256,format:"rgba"}),tt=new Uint8Array(1024),rt=0;rt<256;++rt){for(var nt=Qe[rt],at=0;at<3;++at)tt[4*rt+at]=nt[at];tt[4*rt+3]=Ge?255*getOpacityFromScale(rt/255,Ge):255*nt[3]}return Ot(tt,[256,256,4],[4,0,1])}function takeZComponent(Ne){for(var Ge=Ne.length,Qe=new Array(Ge),tt=0;tt<Ge;++tt)Qe[tt]=Ne[tt][2];return Qe}function createMeshShader(Ne){var Ge=nt(Ne,xr.vertex,xr.fragment);return Ge.attributes.position.location=0,Ge.attributes.color.location=2,Ge.attributes.uv.location=3,Ge.attributes.normal.location=4,Ge}function createWireShader(Ne){var Ge=nt(Ne,br.vertex,br.fragment);return Ge.attributes.position.location=0,Ge.attributes.color.location=2,Ge.attributes.uv.location=3,Ge}function createPointShader(Ne){var Ge=nt(Ne,Ar.vertex,Ar.fragment);return Ge.attributes.position.location=0,Ge.attributes.color.location=2,Ge.attributes.uv.location=3,Ge.attributes.pointSize.location=4,Ge}function createPickShader(Ne){var Ge=nt(Ne,en.vertex,en.fragment);return Ge.attributes.position.location=0,Ge.attributes.id.location=1,Ge}function createPointPickShader(Ne){var Ge=nt(Ne,mn.vertex,mn.fragment);return Ge.attributes.position.location=0,Ge.attributes.id.location=1,Ge.attributes.pointSize.location=4,Ge}function createContourShader(Ne){var Ge=nt(Ne,xn.vertex,xn.fragment);return Ge.attributes.position.location=0,Ge}function createSimplicialMesh(Ne,Ge){if(1===arguments.length&&(Ne=(Ge=Ne).gl),!(Ne.getExtension("OES_standard_derivatives")||Ne.getExtension("MOZ_OES_standard_derivatives")||Ne.getExtension("WEBKIT_OES_standard_derivatives")))throw new Error("derivatives not supported");var Qe=createMeshShader(Ne),tt=createWireShader(Ne),rt=createPointShader(Ne),nt=createPickShader(Ne),dt=createPointPickShader(Ne),ht=createContourShader(Ne),Dt=ot(Ne,Ot(new Uint8Array([255,255,255,255]),[1,1,4]));Dt.generateMipmap(),Dt.minFilter=Ne.LINEAR_MIPMAP_LINEAR,Dt.magFilter=Ne.LINEAR;var Rt=at(Ne),Zt=at(Ne),er=at(Ne),dr=at(Ne),mr=at(Ne),xr=it(Ne,[{buffer:Rt,type:Ne.FLOAT,size:3},{buffer:mr,type:Ne.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:Zt,type:Ne.FLOAT,size:4},{buffer:er,type:Ne.FLOAT,size:2},{buffer:dr,type:Ne.FLOAT,size:3}]),br=at(Ne),Ar=at(Ne),en=at(Ne),mn=at(Ne),xn=it(Ne,[{buffer:br,type:Ne.FLOAT,size:3},{buffer:mn,type:Ne.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:Ar,type:Ne.FLOAT,size:4},{buffer:en,type:Ne.FLOAT,size:2}]),kn=at(Ne),Cn=at(Ne),En=at(Ne),Pn=at(Ne),Dn=at(Ne),In=it(Ne,[{buffer:kn,type:Ne.FLOAT,size:3},{buffer:Dn,type:Ne.UNSIGNED_BYTE,size:4,normalized:!0},{buffer:Cn,type:Ne.FLOAT,size:4},{buffer:En,type:Ne.FLOAT,size:2},{buffer:Pn,type:Ne.FLOAT,size:1}]),zn=at(Ne),Bn=new SimplicialMesh(Ne,Dt,Qe,tt,rt,nt,dt,ht,Rt,mr,Zt,er,dr,xr,br,mn,Ar,en,xn,kn,Dn,Cn,En,Pn,In,zn,it(Ne,[{buffer:zn,type:Ne.FLOAT,size:3}]));return Bn.update(Ge),Bn}Cn.isOpaque=function(){return!this.hasAlpha},Cn.isTransparent=function(){return this.hasAlpha},Cn.pickSlots=1,Cn.setPickBase=function(Ne){this.pickId=Ne},Cn.highlight=function(Ne){if(Ne&&this.contourEnable){for(var Ge=Zt(this.cells,this.intensity,Ne.intensity),Qe=Ge.cells,tt=Ge.vertexIds,rt=Ge.vertexWeights,nt=Qe.length,at=er.mallocFloat32(6*nt),it=0,ot=0;ot<nt;++ot)for(var dt=Qe[ot],ht=0;ht<2;++ht){var Dt=dt[0];2===dt.length&&(Dt=dt[ht]);for(var Ot=tt[Dt][0],Rt=tt[Dt][1],dr=rt[Dt],mr=1-dr,xr=this.positions[Ot],br=this.positions[Rt],Ar=0;Ar<3;++Ar)at[it++]=dr*xr[Ar]+mr*br[Ar]}this.contourCount=it/3|0,this.contourPositions.update(at.subarray(0,it)),er.free(at)}else this.contourCount=0},Cn.update=function(Ne){Ne=Ne||{};var Ge=this.gl;this.dirty=!0,"contourEnable"in Ne&&(this.contourEnable=Ne.contourEnable),"contourColor"in Ne&&(this.contourColor=Ne.contourColor),"lineWidth"in Ne&&(this.lineWidth=Ne.lineWidth),"lightPosition"in Ne&&(this.lightPosition=Ne.lightPosition),this.hasAlpha=!1,"opacity"in Ne&&(this.opacity=Ne.opacity,this.opacity<1&&(this.hasAlpha=!0)),"opacityscale"in Ne&&(this.opacityscale=Ne.opacityscale,this.hasAlpha=!0),"ambient"in Ne&&(this.ambientLight=Ne.ambient),"diffuse"in Ne&&(this.diffuseLight=Ne.diffuse),"specular"in Ne&&(this.specularLight=Ne.specular),"roughness"in Ne&&(this.roughness=Ne.roughness),"fresnel"in Ne&&(this.fresnel=Ne.fresnel),Ne.texture?(this.texture.dispose(),this.texture=ot(Ge,Ne.texture)):Ne.colormap&&(this.texture.shape=[256,256],this.texture.minFilter=Ge.LINEAR_MIPMAP_LINEAR,this.texture.magFilter=Ge.LINEAR,this.texture.setPixels(genColormap(Ne.colormap,this.opacityscale)),this.texture.generateMipmap());var Qe=Ne.cells,nt=Ne.positions;if(nt&&Qe){var at=[],it=[],ht=[],Dt=[],Ot=[],Rt=[],Zt=[],er=[],dr=[],mr=[],xr=[],br=[],Ar=[],en=[];this.cells=Qe,this.positions=nt;var mn=Ne.vertexNormals,xn=Ne.cellNormals,kn=void 0===Ne.vertexNormalsEpsilon?tt:Ne.vertexNormalsEpsilon,Cn=void 0===Ne.faceNormalsEpsilon?rt:Ne.faceNormalsEpsilon;Ne.useFacetNormals&&!xn&&(xn=dt.faceNormals(Qe,nt,Cn)),xn||mn||(mn=dt.vertexNormals(Qe,nt,kn));var En=Ne.vertexColors,Pn=Ne.cellColors,Dn=Ne.meshColor||[1,1,1,1],In=Ne.vertexUVs,zn=Ne.vertexIntensity,Bn=Ne.cellUVs,Vn=Ne.cellIntensity,Hn=1/0,qn=-1/0;if(!In&&!Bn)if(zn)if(Ne.vertexIntensityBounds)Hn=+Ne.vertexIntensityBounds[0],qn=+Ne.vertexIntensityBounds[1];else for(var Yn=0;Yn<zn.length;++Yn){var $n=zn[Yn];Hn=Math.min(Hn,$n),qn=Math.max(qn,$n)}else if(Vn)if(Ne.cellIntensityBounds)Hn=+Ne.cellIntensityBounds[0],qn=+Ne.cellIntensityBounds[1];else for(Yn=0;Yn<Vn.length;++Yn)$n=Vn[Yn],Hn=Math.min(Hn,$n),qn=Math.max(qn,$n);else for(Yn=0;Yn<nt.length;++Yn)$n=nt[Yn][2],Hn=Math.min(Hn,$n),qn=Math.max(qn,$n);this.intensity=zn||Vn||takeZComponent(nt),this.pickVertex=!(Vn||Pn);var ra=Ne.pointSizes,oa=Ne.pointSize||1;for(this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],Yn=0;Yn<nt.length;++Yn)for(var pa=nt[Yn],ga=0;ga<3;++ga)!isNaN(pa[ga])&&isFinite(pa[ga])&&(this.bounds[0][ga]=Math.min(this.bounds[0][ga],pa[ga]),this.bounds[1][ga]=Math.max(this.bounds[1][ga],pa[ga]));var ma=0,_a=0,Va=0;e:for(Yn=0;Yn<Qe.length;++Yn){var Wa=Qe[Yn];switch(Wa.length){case 1:for(pa=nt[ti=Wa[0]],ga=0;ga<3;++ga)if(isNaN(pa[ga])||!isFinite(pa[ga]))continue e;mr.push(pa[0],pa[1],pa[2]),ni=En?En[ti]:Pn?Pn[Yn]:Dn,this.opacityscale&&zn?it.push(ni[0],ni[1],ni[2],this.opacity*getOpacityFromScale((zn[ti]-Hn)/(qn-Hn),this.opacityscale)):3===ni.length?xr.push(ni[0],ni[1],ni[2],this.opacity):(xr.push(ni[0],ni[1],ni[2],ni[3]*this.opacity),ni[3]<1&&(this.hasAlpha=!0)),di=In?In[ti]:zn?[(zn[ti]-Hn)/(qn-Hn),0]:Bn?Bn[Yn]:Vn?[(Vn[Yn]-Hn)/(qn-Hn),0]:[(pa[2]-Hn)/(qn-Hn),0],br.push(di[0],di[1]),ra?Ar.push(ra[ti]):Ar.push(oa),en.push(Yn),Va+=1;break;case 2:for(ga=0;ga<2;++ga){pa=nt[ti=Wa[ga]];for(var Qa=0;Qa<3;++Qa)if(isNaN(pa[Qa])||!isFinite(pa[Qa]))continue e}for(ga=0;ga<2;++ga)pa=nt[ti=Wa[ga]],Rt.push(pa[0],pa[1],pa[2]),ni=En?En[ti]:Pn?Pn[Yn]:Dn,this.opacityscale&&zn?it.push(ni[0],ni[1],ni[2],this.opacity*getOpacityFromScale((zn[ti]-Hn)/(qn-Hn),this.opacityscale)):3===ni.length?Zt.push(ni[0],ni[1],ni[2],this.opacity):(Zt.push(ni[0],ni[1],ni[2],ni[3]*this.opacity),ni[3]<1&&(this.hasAlpha=!0)),di=In?In[ti]:zn?[(zn[ti]-Hn)/(qn-Hn),0]:Bn?Bn[Yn]:Vn?[(Vn[Yn]-Hn)/(qn-Hn),0]:[(pa[2]-Hn)/(qn-Hn),0],er.push(di[0],di[1]),dr.push(Yn);_a+=1;break;case 3:for(ga=0;ga<3;++ga)for(pa=nt[ti=Wa[ga]],Qa=0;Qa<3;++Qa)if(isNaN(pa[Qa])||!isFinite(pa[Qa]))continue e;for(ga=0;ga<3;++ga){var ti,ni,di,ji;pa=nt[ti=Wa[2-ga]],at.push(pa[0],pa[1],pa[2]),(ni=En?En[ti]:Pn?Pn[Yn]:Dn)?this.opacityscale&&zn?it.push(ni[0],ni[1],ni[2],this.opacity*getOpacityFromScale((zn[ti]-Hn)/(qn-Hn),this.opacityscale)):3===ni.length?it.push(ni[0],ni[1],ni[2],this.opacity):(it.push(ni[0],ni[1],ni[2],ni[3]*this.opacity),ni[3]<1&&(this.hasAlpha=!0)):it.push(.5,.5,.5,1),di=In?In[ti]:zn?[(zn[ti]-Hn)/(qn-Hn),0]:Bn?Bn[Yn]:Vn?[(Vn[Yn]-Hn)/(qn-Hn),0]:[(pa[2]-Hn)/(qn-Hn),0],Dt.push(di[0],di[1]),ji=mn?mn[ti]:xn[Yn],ht.push(ji[0],ji[1],ji[2]),Ot.push(Yn)}ma+=1}}this.pointCount=Va,this.edgeCount=_a,this.triangleCount=ma,this.pointPositions.update(mr),this.pointColors.update(xr),this.pointUVs.update(br),this.pointSizes.update(Ar),this.pointIds.update(new Uint32Array(en)),this.edgePositions.update(Rt),this.edgeColors.update(Zt),this.edgeUVs.update(er),this.edgeIds.update(new Uint32Array(dr)),this.trianglePositions.update(at),this.triangleColors.update(it),this.triangleUVs.update(Dt),this.triangleNormals.update(ht),this.triangleIds.update(new Uint32Array(Ot))}},Cn.drawTransparent=Cn.draw=function(Ne){Ne=Ne||{};for(var Ge=this.gl,Qe=Ne.model||kn,tt=Ne.view||kn,rt=Ne.projection||kn,nt=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],at=0;at<3;++at)nt[0][at]=Math.max(nt[0][at],this.clipBounds[0][at]),nt[1][at]=Math.min(nt[1][at],this.clipBounds[1][at]);var it={model:Qe,view:tt,projection:rt,inverseModel:kn.slice(),clipBounds:nt,kambient:this.ambientLight,kdiffuse:this.diffuseLight,kspecular:this.specularLight,roughness:this.roughness,fresnel:this.fresnel,eyePosition:[0,0,0],lightPosition:[0,0,0],contourColor:this.contourColor,texture:0};it.inverseModel=Dt(it.inverseModel,it.model),Ge.disable(Ge.CULL_FACE),this.texture.bind(0);var ot=new Array(16);for(ht(ot,it.view,it.model),ht(ot,it.projection,ot),Dt(ot,ot),at=0;at<3;++at)it.eyePosition[at]=ot[12+at]/ot[15];var dt,Ot=ot[15];for(at=0;at<3;++at)Ot+=this.lightPosition[at]*ot[4*at+3];for(at=0;at<3;++at){for(var Rt=ot[12+at],Zt=0;Zt<3;++Zt)Rt+=ot[4*Zt+at]*this.lightPosition[Zt];it.lightPosition[at]=Rt/Ot}this.triangleCount>0&&((dt=this.triShader).bind(),dt.uniforms=it,this.triangleVAO.bind(),Ge.drawArrays(Ge.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&this.lineWidth>0&&((dt=this.lineShader).bind(),dt.uniforms=it,this.edgeVAO.bind(),Ge.lineWidth(this.lineWidth*this.pixelRatio),Ge.drawArrays(Ge.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((dt=this.pointShader).bind(),dt.uniforms=it,this.pointVAO.bind(),Ge.drawArrays(Ge.POINTS,0,this.pointCount),this.pointVAO.unbind()),this.contourEnable&&this.contourCount>0&&this.contourLineWidth>0&&((dt=this.contourShader).bind(),dt.uniforms=it,this.contourVAO.bind(),Ge.drawArrays(Ge.LINES,0,this.contourCount),this.contourVAO.unbind())},Cn.drawPick=function(Ne){Ne=Ne||{};for(var Ge=this.gl,Qe=Ne.model||kn,tt=Ne.view||kn,rt=Ne.projection||kn,nt=[[-1e6,-1e6,-1e6],[1e6,1e6,1e6]],at=0;at<3;++at)nt[0][at]=Math.max(nt[0][at],this.clipBounds[0][at]),nt[1][at]=Math.min(nt[1][at],this.clipBounds[1][at]);this._model=[].slice.call(Qe),this._view=[].slice.call(tt),this._projection=[].slice.call(rt),this._resolution=[Ge.drawingBufferWidth,Ge.drawingBufferHeight];var it,ot={model:Qe,view:tt,projection:rt,clipBounds:nt,pickId:this.pickId/255};(it=this.pickShader).bind(),it.uniforms=ot,this.triangleCount>0&&(this.triangleVAO.bind(),Ge.drawArrays(Ge.TRIANGLES,0,3*this.triangleCount),this.triangleVAO.unbind()),this.edgeCount>0&&(this.edgeVAO.bind(),Ge.lineWidth(this.lineWidth*this.pixelRatio),Ge.drawArrays(Ge.LINES,0,2*this.edgeCount),this.edgeVAO.unbind()),this.pointCount>0&&((it=this.pointPickShader).bind(),it.uniforms=ot,this.pointVAO.bind(),Ge.drawArrays(Ge.POINTS,0,this.pointCount),this.pointVAO.unbind())},Cn.pick=function(Ne){if(!Ne)return null;if(Ne.id!==this.pickId)return null;for(var Ge=Ne.value[0]+256*Ne.value[1]+65536*Ne.value[2],Qe=this.cells[Ge],tt=this.positions,rt=new Array(Qe.length),nt=0;nt<Qe.length;++nt)rt[nt]=tt[Qe[nt]];var at=Ne.coord[0],it=Ne.coord[1];if(!this.pickVertex){var ot=this.positions[Qe[0]],dt=this.positions[Qe[1]],ht=this.positions[Qe[2]],Dt=[(ot[0]+dt[0]+ht[0])/3,(ot[1]+dt[1]+ht[1])/3,(ot[2]+dt[2]+ht[2])/3];return{_cellCenter:!0,position:[at,it],index:Ge,cell:Qe,cellId:Ge,intensity:this.intensity[Ge],dataCoordinate:Dt}}var Ot=mr(rt,[at*this.pixelRatio,this._resolution[1]-it*this.pixelRatio],this._model,this._view,this._projection,this._resolution);if(!Ot)return null;var Rt=Ot[2],Zt=0;for(nt=0;nt<Qe.length;++nt)Zt+=Rt[nt]*this.intensity[Qe[nt]];return{position:Ot[1],index:Qe[Ot[0]],cell:Qe,cellId:Ge,intensity:Zt,dataCoordinate:this.positions[Qe[Ot[0]]]}},Cn.dispose=function(){this.texture.dispose(),this.triShader.dispose(),this.lineShader.dispose(),this.pointShader.dispose(),this.pickShader.dispose(),this.pointPickShader.dispose(),this.triangleVAO.dispose(),this.trianglePositions.dispose(),this.triangleColors.dispose(),this.triangleUVs.dispose(),this.triangleNormals.dispose(),this.triangleIds.dispose(),this.edgeVAO.dispose(),this.edgePositions.dispose(),this.edgeColors.dispose(),this.edgeUVs.dispose(),this.edgeIds.dispose(),this.pointVAO.dispose(),this.pointPositions.dispose(),this.pointColors.dispose(),this.pointUVs.dispose(),this.pointSizes.dispose(),this.pointIds.dispose(),this.contourVAO.dispose(),this.contourPositions.dispose(),this.contourShader.dispose()},Ge.exports=createSimplicialMesh},{"./lib/closest-point":307,"./lib/shaders":308,colormap:131,"gl-buffer":259,"gl-mat4/invert":293,"gl-mat4/multiply":295,"gl-shader":335,"gl-texture2d":353,"gl-vao":358,ndarray:495,normals:498,"simplicial-complex-contour":556,"typedarray-pool":595}],310:[function(Ne,Ge,Qe){arguments[4][257][0].apply(Qe,arguments)},{dup:257}],311:[function(Ne,Ge,Qe){"use strict";Ge.exports=createBoxes;var tt=Ne("gl-buffer"),rt=Ne("gl-shader"),nt=Ne("./shaders");function Boxes(Ne,Ge,Qe){this.plot=Ne,this.vbo=Ge,this.shader=Qe}var at,it,ot=Boxes.prototype;function createBoxes(Ne){var Ge=Ne.gl;return new Boxes(Ne,tt(Ge,[0,0,0,1,1,0,1,1]),rt(Ge,nt.boxVert,nt.lineFrag))}ot.bind=function(){var Ne=this.shader;this.vbo.bind(),this.shader.bind(),Ne.attributes.coord.pointer(),Ne.uniforms.screenBox=this.plot.screenBox},ot.drawBox=(at=[0,0],it=[0,0],function(Ne,Ge,Qe,tt,rt){var nt=this.plot,ot=this.shader,dt=nt.gl;at[0]=Ne,at[1]=Ge,it[0]=Qe,it[1]=tt,ot.uniforms.lo=at,ot.uniforms.hi=it,ot.uniforms.color=rt,dt.drawArrays(dt.TRIANGLE_STRIP,0,4)}),ot.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":314,"gl-buffer":259,"gl-shader":335}],312:[function(Ne,Ge,Qe){"use strict";Ge.exports=createGrid;var tt=Ne("gl-buffer"),rt=Ne("gl-shader"),nt=Ne("binary-search-bounds"),at=Ne("./shaders");function Grid(Ne,Ge,Qe,tt){this.plot=Ne,this.vbo=Ge,this.shader=Qe,this.tickShader=tt,this.ticks=[[],[]]}function compareTickNum(Ne,Ge){return Ne-Ge}var it,ot,dt,ht,Dt,Ot=Grid.prototype;function createGrid(Ne){var Ge=Ne.gl;return new Grid(Ne,tt(Ge),rt(Ge,at.gridVert,at.gridFrag),rt(Ge,at.tickVert,at.gridFrag))}Ot.draw=(it=[0,0],ot=[0,0],dt=[0,0],function(){for(var Ne=this.plot,Ge=this.vbo,Qe=this.shader,tt=this.ticks,rt=Ne.gl,nt=Ne._tickBounds,at=Ne.dataBox,ht=Ne.viewBox,Dt=Ne.gridLineWidth,Ot=Ne.gridLineColor,Rt=Ne.gridLineEnable,Zt=Ne.pixelRatio,er=0;er<2;++er){var dr=nt[er],mr=nt[er+2]-dr,xr=.5*(at[er+2]+at[er]),br=at[er+2]-at[er];ot[er]=2*mr/br,it[er]=2*(dr-xr)/br}Qe.bind(),Ge.bind(),Qe.attributes.dataCoord.pointer(),Qe.uniforms.dataShift=it,Qe.uniforms.dataScale=ot;var Ar=0;for(er=0;er<2;++er){dt[0]=dt[1]=0,dt[er]=1,Qe.uniforms.dataAxis=dt,Qe.uniforms.lineWidth=Dt[er]/(ht[er+2]-ht[er])*Zt,Qe.uniforms.color=Ot[er];var en=6*tt[er].length;Rt[er]&&en&&rt.drawArrays(rt.TRIANGLES,Ar,en),Ar+=en}}),Ot.drawTickMarks=function(){var Ne=[0,0],Ge=[0,0],Qe=[1,0],tt=[0,1],rt=[0,0],at=[0,0];return function(){for(var it=this.plot,ot=this.vbo,dt=this.tickShader,ht=this.ticks,Dt=it.gl,Ot=it._tickBounds,Rt=it.dataBox,Zt=it.viewBox,er=it.pixelRatio,dr=it.screenBox,mr=dr[2]-dr[0],xr=dr[3]-dr[1],br=Zt[2]-Zt[0],Ar=Zt[3]-Zt[1],en=0;en<2;++en){var mn=Ot[en],xn=Ot[en+2]-mn,kn=.5*(Rt[en+2]+Rt[en]),Cn=Rt[en+2]-Rt[en];Ge[en]=2*xn/Cn,Ne[en]=2*(mn-kn)/Cn}Ge[0]*=br/mr,Ne[0]*=br/mr,Ge[1]*=Ar/xr,Ne[1]*=Ar/xr,dt.bind(),ot.bind(),dt.attributes.dataCoord.pointer();var En=dt.uniforms;En.dataShift=Ne,En.dataScale=Ge;var Pn=it.tickMarkLength,Dn=it.tickMarkWidth,In=it.tickMarkColor,zn=0,Bn=6*ht[0].length,Vn=Math.min(nt.ge(ht[0],(Rt[0]-Ot[0])/(Ot[2]-Ot[0]),compareTickNum),ht[0].length),Hn=Math.min(nt.gt(ht[0],(Rt[2]-Ot[0])/(Ot[2]-Ot[0]),compareTickNum),ht[0].length),qn=zn+6*Vn,Yn=6*Math.max(0,Hn-Vn),$n=Math.min(nt.ge(ht[1],(Rt[1]-Ot[1])/(Ot[3]-Ot[1]),compareTickNum),ht[1].length),ra=Math.min(nt.gt(ht[1],(Rt[3]-Ot[1])/(Ot[3]-Ot[1]),compareTickNum),ht[1].length),oa=Bn+6*$n,pa=6*Math.max(0,ra-$n);rt[0]=2*(Zt[0]-Pn[1])/mr-1,rt[1]=(Zt[3]+Zt[1])/xr-1,at[0]=Pn[1]*er/mr,at[1]=Dn[1]*er/xr,pa&&(En.color=In[1],En.tickScale=at,En.dataAxis=tt,En.screenOffset=rt,Dt.drawArrays(Dt.TRIANGLES,oa,pa)),rt[0]=(Zt[2]+Zt[0])/mr-1,rt[1]=2*(Zt[1]-Pn[0])/xr-1,at[0]=Dn[0]*er/mr,at[1]=Pn[0]*er/xr,Yn&&(En.color=In[0],En.tickScale=at,En.dataAxis=Qe,En.screenOffset=rt,Dt.drawArrays(Dt.TRIANGLES,qn,Yn)),rt[0]=2*(Zt[2]+Pn[3])/mr-1,rt[1]=(Zt[3]+Zt[1])/xr-1,at[0]=Pn[3]*er/mr,at[1]=Dn[3]*er/xr,pa&&(En.color=In[3],En.tickScale=at,En.dataAxis=tt,En.screenOffset=rt,Dt.drawArrays(Dt.TRIANGLES,oa,pa)),rt[0]=(Zt[2]+Zt[0])/mr-1,rt[1]=2*(Zt[3]+Pn[2])/xr-1,at[0]=Dn[2]*er/mr,at[1]=Pn[2]*er/xr,Yn&&(En.color=In[2],En.tickScale=at,En.dataAxis=Qe,En.screenOffset=rt,Dt.drawArrays(Dt.TRIANGLES,qn,Yn))}}(),Ot.update=(ht=[1,1,-1,-1,1,-1],Dt=[1,-1,1,1,-1,-1],function(Ne){for(var Ge=Ne.ticks,Qe=Ne.bounds,tt=new Float32Array(18*(Ge[0].length+Ge[1].length)),rt=(this.plot.zeroLineEnable,0),nt=[[],[]],at=0;at<2;++at)for(var it=nt[at],ot=Ge[at],dt=Qe[at],Ot=Qe[at+2],Rt=0;Rt<ot.length;++Rt){var Zt=(ot[Rt].x-dt)/(Ot-dt);it.push(Zt);for(var er=0;er<6;++er)tt[rt++]=Zt,tt[rt++]=ht[er],tt[rt++]=Dt[er]}this.ticks=nt,this.vbo.update(tt)}),Ot.dispose=function(){this.vbo.dispose(),this.shader.dispose(),this.tickShader.dispose()}},{"./shaders":314,"binary-search-bounds":96,"gl-buffer":259,"gl-shader":335}],313:[function(Ne,Ge,Qe){"use strict";Ge.exports=createLines;var tt=Ne("gl-buffer"),rt=Ne("gl-shader"),nt=Ne("./shaders");function Lines(Ne,Ge,Qe){this.plot=Ne,this.vbo=Ge,this.shader=Qe}var at,it,ot=Lines.prototype;function createLines(Ne){var Ge=Ne.gl;return new Lines(Ne,tt(Ge,[-1,-1,-1,1,1,-1,1,1]),rt(Ge,nt.lineVert,nt.lineFrag))}ot.bind=function(){var Ne=this.shader;this.vbo.bind(),this.shader.bind(),Ne.attributes.coord.pointer(),Ne.uniforms.screenBox=this.plot.screenBox},ot.drawLine=(at=[0,0],it=[0,0],function(Ne,Ge,Qe,tt,rt,nt){var ot=this.plot,dt=this.shader,ht=ot.gl;at[0]=Ne,at[1]=Ge,it[0]=Qe,it[1]=tt,dt.uniforms.start=at,dt.uniforms.end=it,dt.uniforms.width=rt*ot.pixelRatio,dt.uniforms.color=nt,ht.drawArrays(ht.TRIANGLE_STRIP,0,4)}),ot.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":314,"gl-buffer":259,"gl-shader":335}],314:[function(Ne,Ge,Qe){"use strict";var tt=Ne("glslify"),rt=tt(["precision lowp float;\n#define GLSLIFY 1\nuniform vec4 color;\nvoid main() {\n  gl_FragColor = vec4(color.xyz * color.w, color.w);\n}\n"]);Ge.exports={lineVert:tt(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 start, end;\nuniform float width;\n\nvec2 perp(vec2 v) {\n  return vec2(v.y, -v.x);\n}\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  vec2 delta = normalize(perp(start - end));\n  vec2 offset = mix(start, end, 0.5 * (coord.y+1.0));\n  gl_Position = vec4(screen(offset + 0.5 * width * delta * coord.x), 0, 1);\n}\n"]),lineFrag:rt,textVert:tt(["#define GLSLIFY 1\nattribute vec3 textCoordinate;\n\nuniform vec2 dataScale, dataShift, dataAxis, screenOffset, textScale;\nuniform float angle;\n\nvoid main() {\n  float dataOffset  = textCoordinate.z;\n  vec2 glyphOffset  = textCoordinate.xy;\n  mat2 glyphMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));\n  vec2 screenCoordinate = dataAxis * (dataScale * dataOffset + dataShift) +\n    glyphMatrix * glyphOffset * textScale + screenOffset;\n  gl_Position = vec4(screenCoordinate, 0, 1);\n}\n"]),textFrag:rt,gridVert:tt(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale;\nuniform float lineWidth;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  pos += 10.0 * dataCoord.y * vec2(dataAxis.y, -dataAxis.x) + dataCoord.z * lineWidth;\n  gl_Position = vec4(pos, 0, 1);\n}\n"]),gridFrag:rt,boxVert:tt(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 coord;\n\nuniform vec4 screenBox;\nuniform vec2 lo, hi;\n\nvec2 screen(vec2 v) {\n  return 2.0 * (v - screenBox.xy) / (screenBox.zw - screenBox.xy) - 1.0;\n}\n\nvoid main() {\n  gl_Position = vec4(screen(mix(lo, hi, coord)), 0, 1);\n}\n"]),tickVert:tt(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 dataCoord;\n\nuniform vec2 dataAxis, dataShift, dataScale, screenOffset, tickScale;\n\nvoid main() {\n  vec2 pos = dataAxis * (dataScale * dataCoord.x + dataShift);\n  gl_Position = vec4(pos + tickScale*dataCoord.yz + screenOffset, 0, 1);\n}\n"])}},{glslify:316}],315:[function(Ne,Ge,Qe){"use strict";Ge.exports=createTextElements;var tt=Ne("gl-buffer"),rt=Ne("gl-shader"),nt=Ne("text-cache"),at=Ne("binary-search-bounds"),it=Ne("./shaders");function TextElements(Ne,Ge,Qe){this.plot=Ne,this.vbo=Ge,this.shader=Qe,this.tickOffset=[[],[]],this.tickX=[[],[]],this.labelOffset=[0,0],this.labelCount=[0,0]}var ot,dt,ht,Dt,Ot,Rt,Zt=TextElements.prototype;function createTextElements(Ne){var Ge=Ne.gl;return new TextElements(Ne,tt(Ge),rt(Ge,it.textVert,it.textFrag))}Zt.drawTicks=(ot=[0,0],dt=[0,0],ht=[0,0],function(Ne){var Ge=this.plot,Qe=this.shader,tt=this.tickX[Ne],rt=this.tickOffset[Ne],nt=Ge.gl,it=Ge.viewBox,Dt=Ge.dataBox,Ot=Ge.screenBox,Rt=Ge.pixelRatio,Zt=Ge.tickEnable,er=Ge.tickPad,dr=Ge.tickColor,mr=Ge.tickAngle,xr=Ge.labelEnable,br=Ge.labelPad,Ar=Ge.labelColor,en=Ge.labelAngle,mn=this.labelOffset[Ne],xn=this.labelCount[Ne],kn=at.lt(tt,Dt[Ne]),Cn=at.le(tt,Dt[Ne+2]);ot[0]=ot[1]=0,ot[Ne]=1,dt[Ne]=(it[2+Ne]+it[Ne])/(Ot[2+Ne]-Ot[Ne])-1;var En=2/Ot[2+(1^Ne)]-Ot[1^Ne];dt[1^Ne]=En*it[1^Ne]-1,Zt[Ne]&&(dt[1^Ne]-=En*Rt*er[Ne],kn<Cn&&rt[Cn]>rt[kn]&&(Qe.uniforms.dataAxis=ot,Qe.uniforms.screenOffset=dt,Qe.uniforms.color=dr[Ne],Qe.uniforms.angle=mr[Ne],nt.drawArrays(nt.TRIANGLES,rt[kn],rt[Cn]-rt[kn]))),xr[Ne]&&xn&&(dt[1^Ne]-=En*Rt*br[Ne],Qe.uniforms.dataAxis=ht,Qe.uniforms.screenOffset=dt,Qe.uniforms.color=Ar[Ne],Qe.uniforms.angle=en[Ne],nt.drawArrays(nt.TRIANGLES,mn,xn)),dt[1^Ne]=En*it[2+(1^Ne)]-1,Zt[Ne+2]&&(dt[1^Ne]+=En*Rt*er[Ne+2],kn<Cn&&rt[Cn]>rt[kn]&&(Qe.uniforms.dataAxis=ot,Qe.uniforms.screenOffset=dt,Qe.uniforms.color=dr[Ne+2],Qe.uniforms.angle=mr[Ne+2],nt.drawArrays(nt.TRIANGLES,rt[kn],rt[Cn]-rt[kn]))),xr[Ne+2]&&xn&&(dt[1^Ne]+=En*Rt*br[Ne+2],Qe.uniforms.dataAxis=ht,Qe.uniforms.screenOffset=dt,Qe.uniforms.color=Ar[Ne+2],Qe.uniforms.angle=en[Ne+2],nt.drawArrays(nt.TRIANGLES,mn,xn))}),Zt.drawTitle=function(){var Ne=[0,0],Ge=[0,0];return function(){var Qe=this.plot,tt=this.shader,rt=Qe.gl,nt=Qe.screenBox,at=Qe.titleCenter,it=Qe.titleAngle,ot=Qe.titleColor,dt=Qe.pixelRatio;if(this.titleCount){for(var ht=0;ht<2;++ht)Ge[ht]=2*(at[ht]*dt-nt[ht])/(nt[2+ht]-nt[ht])-1;tt.bind(),tt.uniforms.dataAxis=Ne,tt.uniforms.screenOffset=Ge,tt.uniforms.angle=it,tt.uniforms.color=ot,rt.drawArrays(rt.TRIANGLES,this.titleOffset,this.titleCount)}}}(),Zt.bind=(Dt=[0,0],Ot=[0,0],Rt=[0,0],function(){var Ne=this.plot,Ge=this.shader,Qe=Ne._tickBounds,tt=Ne.dataBox,rt=Ne.screenBox,nt=Ne.viewBox;Ge.bind();for(var at=0;at<2;++at){var it=Qe[at],ot=Qe[at+2]-it,dt=.5*(tt[at+2]+tt[at]),ht=tt[at+2]-tt[at],Zt=nt[at],er=nt[at+2]-Zt,dr=rt[at],mr=rt[at+2]-dr;Ot[at]=2*ot/ht*er/mr,Dt[at]=2*(it-dt)/ht*er/mr}Rt[1]=2*Ne.pixelRatio/(rt[3]-rt[1]),Rt[0]=Rt[1]*(rt[3]-rt[1])/(rt[2]-rt[0]),Ge.uniforms.dataScale=Ot,Ge.uniforms.dataShift=Dt,Ge.uniforms.textScale=Rt,this.vbo.bind(),Ge.attributes.textCoordinate.pointer()}),Zt.update=function(Ne){var Ge,Qe,tt,rt,at,it=[],ot=Ne.ticks,dt=Ne.bounds;for(at=0;at<2;++at){var ht=[Math.floor(it.length/3)],Dt=[-1/0],Ot=ot[at];for(Ge=0;Ge<Ot.length;++Ge){var Rt=Ot[Ge],Zt=Rt.x,er=Rt.text,dr=Rt.font||"sans-serif";rt=Rt.fontSize||12;for(var mr=1/(dt[at+2]-dt[at]),xr=dt[at],br=er.split("\n"),Ar=0;Ar<br.length;Ar++)for(tt=nt(dr,br[Ar]).data,Qe=0;Qe<tt.length;Qe+=2)it.push(tt[Qe]*rt,-tt[Qe+1]*rt-Ar*rt*1.2,(Zt-xr)*mr);ht.push(Math.floor(it.length/3)),Dt.push(Zt)}this.tickOffset[at]=ht,this.tickX[at]=Dt}for(at=0;at<2;++at){for(this.labelOffset[at]=Math.floor(it.length/3),tt=nt(Ne.labelFont[at],Ne.labels[at],{textAlign:"center"}).data,rt=Ne.labelSize[at],Ge=0;Ge<tt.length;Ge+=2)it.push(tt[Ge]*rt,-tt[Ge+1]*rt,0);this.labelCount[at]=Math.floor(it.length/3)-this.labelOffset[at]}for(this.titleOffset=Math.floor(it.length/3),tt=nt(Ne.titleFont,Ne.title).data,rt=Ne.titleSize,Ge=0;Ge<tt.length;Ge+=2)it.push(tt[Ge]*rt,-tt[Ge+1]*rt,0);this.titleCount=Math.floor(it.length/3)-this.titleOffset,this.vbo.update(it)},Zt.dispose=function(){this.vbo.dispose(),this.shader.dispose()}},{"./shaders":314,"binary-search-bounds":96,"gl-buffer":259,"gl-shader":335,"text-cache":575}],316:[function(Ne,Ge,Qe){arguments[4][257][0].apply(Qe,arguments)},{dup:257}],317:[function(Ne,Ge,Qe){"use strict";Ge.exports=createGLPlot2D;var tt=Ne("gl-select-static"),rt=Ne("./lib/grid"),nt=Ne("./lib/text"),at=Ne("./lib/line"),it=Ne("./lib/box");function GLPlot2D(Ne,Ge){this.gl=Ne,this.pickBuffer=Ge,this.screenBox=[0,0,Ne.drawingBufferWidth,Ne.drawingBufferHeight],this.viewBox=[0,0,0,0],this.dataBox=[-10,-10,10,10],this.gridLineEnable=[!0,!0],this.gridLineWidth=[1,1],this.gridLineColor=[[0,0,0,1],[0,0,0,1]],this.pixelRatio=1,this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickEnable=[!0,!0,!0,!0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[15,15,15,15],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelEnable=[!0,!0,!0,!0],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.titleCenter=[0,0],this.titleEnable=!0,this.titleAngle=0,this.titleColor=[0,0,0,1],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[4,4],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderLineEnable=[!0,!0,!0,!0],this.borderLineWidth=[2,2,2,2],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.grid=null,this.text=null,this.line=null,this.box=null,this.objects=[],this.overlays=[],this._tickBounds=[1/0,1/0,-1/0,-1/0],this.static=!1,this.dirty=!1,this.pickDirty=!1,this.pickDelay=120,this.pickRadius=10,this._pickTimeout=null,this._drawPick=this.drawPick.bind(this),this._depthCounter=0}var ot=GLPlot2D.prototype;function deepClone(Ne){for(var Ge=Ne.slice(),Qe=0;Qe<Ge.length;++Qe)Ge[Qe]=Ge[Qe].slice();return Ge}function compareTicks(Ne,Ge){return Ne.x-Ge.x}function createGLPlot2D(Ne){var Ge=Ne.gl,Qe=new GLPlot2D(Ge,tt(Ge,[Ge.drawingBufferWidth,Ge.drawingBufferHeight]));return Qe.grid=rt(Qe),Qe.text=nt(Qe),Qe.line=at(Qe),Qe.box=it(Qe),Qe.update(Ne),Qe}ot.setDirty=function(){this.dirty=this.pickDirty=!0},ot.setOverlayDirty=function(){this.dirty=!0},ot.nextDepthValue=function(){return this._depthCounter++/65536},ot.draw=function(){var Ne=this.gl,Ge=this.screenBox,Qe=this.viewBox,tt=this.dataBox,rt=this.pixelRatio,nt=this.grid,at=this.line,it=this.text,ot=this.objects;if(this._depthCounter=0,this.pickDirty&&(this._pickTimeout&&clearTimeout(this._pickTimeout),this.pickDirty=!1,this._pickTimeout=setTimeout(this._drawPick,this.pickDelay)),this.dirty){if(this.dirty=!1,Ne.bindFramebuffer(Ne.FRAMEBUFFER,null),Ne.enable(Ne.SCISSOR_TEST),Ne.disable(Ne.DEPTH_TEST),Ne.depthFunc(Ne.LESS),Ne.depthMask(!1),Ne.enable(Ne.BLEND),Ne.blendEquation(Ne.FUNC_ADD,Ne.FUNC_ADD),Ne.blendFunc(Ne.ONE,Ne.ONE_MINUS_SRC_ALPHA),this.borderColor){Ne.scissor(Ge[0],Ge[1],Ge[2]-Ge[0],Ge[3]-Ge[1]);var dt=this.borderColor;Ne.clearColor(dt[0]*dt[3],dt[1]*dt[3],dt[2]*dt[3],dt[3]),Ne.clear(Ne.COLOR_BUFFER_BIT|Ne.DEPTH_BUFFER_BIT)}Ne.scissor(Qe[0],Qe[1],Qe[2]-Qe[0],Qe[3]-Qe[1]),Ne.viewport(Qe[0],Qe[1],Qe[2]-Qe[0],Qe[3]-Qe[1]);var ht=this.backgroundColor;Ne.clearColor(ht[0]*ht[3],ht[1]*ht[3],ht[2]*ht[3],ht[3]),Ne.clear(Ne.COLOR_BUFFER_BIT),nt.draw();var Dt=this.zeroLineEnable,Ot=this.zeroLineColor,Rt=this.zeroLineWidth;if(Dt[0]||Dt[1]){at.bind();for(var Zt=0;Zt<2;++Zt)if(Dt[Zt]&&tt[Zt]<=0&&tt[Zt+2]>=0){var er=Ge[Zt]-tt[Zt]*(Ge[Zt+2]-Ge[Zt])/(tt[Zt+2]-tt[Zt]);0===Zt?at.drawLine(er,Ge[1],er,Ge[3],Rt[Zt],Ot[Zt]):at.drawLine(Ge[0],er,Ge[2],er,Rt[Zt],Ot[Zt])}}for(Zt=0;Zt<ot.length;++Zt)ot[Zt].draw();Ne.viewport(Ge[0],Ge[1],Ge[2]-Ge[0],Ge[3]-Ge[1]),Ne.scissor(Ge[0],Ge[1],Ge[2]-Ge[0],Ge[3]-Ge[1]),this.grid.drawTickMarks(),at.bind();var dr=this.borderLineEnable,mr=this.borderLineWidth,xr=this.borderLineColor;for(dr[1]&&at.drawLine(Qe[0],Qe[1]-.5*mr[1]*rt,Qe[0],Qe[3]+.5*mr[3]*rt,mr[1],xr[1]),dr[0]&&at.drawLine(Qe[0]-.5*mr[0]*rt,Qe[1],Qe[2]+.5*mr[2]*rt,Qe[1],mr[0],xr[0]),dr[3]&&at.drawLine(Qe[2],Qe[1]-.5*mr[1]*rt,Qe[2],Qe[3]+.5*mr[3]*rt,mr[3],xr[3]),dr[2]&&at.drawLine(Qe[0]-.5*mr[0]*rt,Qe[3],Qe[2]+.5*mr[2]*rt,Qe[3],mr[2],xr[2]),it.bind(),Zt=0;Zt<2;++Zt)it.drawTicks(Zt);this.titleEnable&&it.drawTitle();var br=this.overlays;for(Zt=0;Zt<br.length;++Zt)br[Zt].draw();Ne.disable(Ne.SCISSOR_TEST),Ne.disable(Ne.BLEND),Ne.depthMask(!0)}},ot.drawPick=function(){if(!this.static){var Ne=this.pickBuffer;this.gl,this._pickTimeout=null,Ne.begin();for(var Ge=1,Qe=this.objects,tt=0;tt<Qe.length;++tt)Ge=Qe[tt].drawPick(Ge);Ne.end()}},ot.pick=function(Ne,Ge){if(!this.static){var Qe=this.pixelRatio,tt=this.pickPixelRatio,rt=this.viewBox,nt=0|Math.round((Ne-rt[0]/Qe)*tt),at=0|Math.round((Ge-rt[1]/Qe)*tt),it=this.pickBuffer.query(nt,at,this.pickRadius);if(!it)return null;for(var ot=it.id+(it.value[0]<<8)+(it.value[1]<<16)+(it.value[2]<<24),dt=this.objects,ht=0;ht<dt.length;++ht){var Dt=dt[ht].pick(nt,at,ot);if(Dt)return Dt}return null}},ot.setScreenBox=function(Ne){var Ge=this.screenBox,Qe=this.pixelRatio;Ge[0]=0|Math.round(Ne[0]*Qe),Ge[1]=0|Math.round(Ne[1]*Qe),Ge[2]=0|Math.round(Ne[2]*Qe),Ge[3]=0|Math.round(Ne[3]*Qe),this.setDirty()},ot.setDataBox=function(Ne){var Ge=this.dataBox;(Ge[0]!==Ne[0]||Ge[1]!==Ne[1]||Ge[2]!==Ne[2]||Ge[3]!==Ne[3])&&(Ge[0]=Ne[0],Ge[1]=Ne[1],Ge[2]=Ne[2],Ge[3]=Ne[3],this.setDirty())},ot.setViewBox=function(Ne){var Ge=this.pixelRatio,Qe=this.viewBox;Qe[0]=0|Math.round(Ne[0]*Ge),Qe[1]=0|Math.round(Ne[1]*Ge),Qe[2]=0|Math.round(Ne[2]*Ge),Qe[3]=0|Math.round(Ne[3]*Ge);var tt=this.pickPixelRatio;this.pickBuffer.shape=[0|Math.round((Ne[2]-Ne[0])*tt),0|Math.round((Ne[3]-Ne[1])*tt)],this.setDirty()},ot.update=function(Ne){Ne=Ne||{};var Ge=this.gl;this.pixelRatio=Ne.pixelRatio||1;var Qe=this.pixelRatio;this.pickPixelRatio=Math.max(Qe,1),this.setScreenBox(Ne.screenBox||[0,0,Ge.drawingBufferWidth/Qe,Ge.drawingBufferHeight/Qe]),this.screenBox,this.setViewBox(Ne.viewBox||[.125*(this.screenBox[2]-this.screenBox[0])/Qe,.125*(this.screenBox[3]-this.screenBox[1])/Qe,.875*(this.screenBox[2]-this.screenBox[0])/Qe,.875*(this.screenBox[3]-this.screenBox[1])/Qe]);var tt=this.viewBox,rt=(tt[2]-tt[0])/(tt[3]-tt[1]);this.setDataBox(Ne.dataBox||[-10,-10/rt,10,10/rt]),this.borderColor=!1!==Ne.borderColor&&(Ne.borderColor||[0,0,0,0]).slice(),this.backgroundColor=(Ne.backgroundColor||[0,0,0,0]).slice(),this.gridLineEnable=(Ne.gridLineEnable||[!0,!0]).slice(),this.gridLineWidth=(Ne.gridLineWidth||[1,1]).slice(),this.gridLineColor=deepClone(Ne.gridLineColor||[[.5,.5,.5,1],[.5,.5,.5,1]]),this.zeroLineEnable=(Ne.zeroLineEnable||[!0,!0]).slice(),this.zeroLineWidth=(Ne.zeroLineWidth||[4,4]).slice(),this.zeroLineColor=deepClone(Ne.zeroLineColor||[[0,0,0,1],[0,0,0,1]]),this.tickMarkLength=(Ne.tickMarkLength||[0,0,0,0]).slice(),this.tickMarkWidth=(Ne.tickMarkWidth||[0,0,0,0]).slice(),this.tickMarkColor=deepClone(Ne.tickMarkColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.titleCenter=(Ne.titleCenter||[.5*(tt[0]+tt[2])/Qe,(tt[3]+120)/Qe]).slice(),this.titleEnable=!("titleEnable"in Ne)||!!Ne.titleEnable,this.titleAngle=Ne.titleAngle||0,this.titleColor=(Ne.titleColor||[0,0,0,1]).slice(),this.labelPad=(Ne.labelPad||[15,15,15,15]).slice(),this.labelAngle=(Ne.labelAngle||[0,Math.PI/2,0,3*Math.PI/2]).slice(),this.labelEnable=(Ne.labelEnable||[!0,!0,!0,!0]).slice(),this.labelColor=deepClone(Ne.labelColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.tickPad=(Ne.tickPad||[15,15,15,15]).slice(),this.tickAngle=(Ne.tickAngle||[0,0,0,0]).slice(),this.tickEnable=(Ne.tickEnable||[!0,!0,!0,!0]).slice(),this.tickColor=deepClone(Ne.tickColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]),this.borderLineEnable=(Ne.borderLineEnable||[!0,!0,!0,!0]).slice(),this.borderLineWidth=(Ne.borderLineWidth||[2,2,2,2]).slice(),this.borderLineColor=deepClone(Ne.borderLineColor||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]);var nt=Ne.ticks||[[],[]],at=this._tickBounds;at[0]=at[1]=1/0,at[2]=at[3]=-1/0;for(var it=0;it<2;++it){var ot=nt[it].slice(0);0!==ot.length&&(ot.sort(compareTicks),at[it]=Math.min(at[it],ot[0].x),at[it+2]=Math.max(at[it+2],ot[ot.length-1].x))}this.grid.update({bounds:at,ticks:nt}),this.text.update({bounds:at,ticks:nt,labels:Ne.labels||["x","y"],labelSize:Ne.labelSize||[12,12],labelFont:Ne.labelFont||["sans-serif","sans-serif"],title:Ne.title||"",titleSize:Ne.titleSize||18,titleFont:Ne.titleFont||"sans-serif"}),this.static=!!Ne.static,this.setDirty()},ot.dispose=function(){this.box.dispose(),this.grid.dispose(),this.text.dispose(),this.line.dispose();for(var Ne=this.objects.length-1;Ne>=0;--Ne)this.objects[Ne].dispose();for(this.objects.length=0,Ne=this.overlays.length-1;Ne>=0;--Ne)this.overlays[Ne].dispose();this.overlays.length=0,this.gl=null},ot.addObject=function(Ne){this.objects.indexOf(Ne)<0&&(this.objects.push(Ne),this.setDirty())},ot.removeObject=function(Ne){for(var Ge=this.objects,Qe=0;Qe<Ge.length;++Qe)if(Ge[Qe]===Ne){Ge.splice(Qe,1),this.setDirty();break}},ot.addOverlay=function(Ne){this.overlays.indexOf(Ne)<0&&(this.overlays.push(Ne),this.setOverlayDirty())},ot.removeOverlay=function(Ne){for(var Ge=this.overlays,Qe=0;Qe<Ge.length;++Qe)if(Ge[Qe]===Ne){Ge.splice(Qe,1),this.setOverlayDirty();break}}},{"./lib/box":311,"./lib/grid":312,"./lib/line":313,"./lib/text":315,"gl-select-static":334}],318:[function(Ne,Ge,Qe){"use strict";Ge.exports=createCamera;var tt=Ne("right-now"),rt=Ne("3d-view"),nt=Ne("mouse-change"),at=Ne("mouse-wheel"),it=Ne("mouse-event-offset"),ot=Ne("has-passive-events");function createCamera(Ne,Ge){Ne=Ne||document.body;var Qe=[.01,1/0];"distanceLimits"in(Ge=Ge||{})&&(Qe[0]=Ge.distanceLimits[0],Qe[1]=Ge.distanceLimits[1]),"zoomMin"in Ge&&(Qe[0]=Ge.zoomMin),"zoomMax"in Ge&&(Qe[1]=Ge.zoomMax);var dt=rt({center:Ge.center||[0,0,0],up:Ge.up||[0,1,0],eye:Ge.eye||[0,0,10],mode:Ge.mode||"orbit",distanceLimits:Qe}),ht=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Dt=0,Ot=Ne.clientWidth,Rt=Ne.clientHeight,Zt={keyBindingMode:"rotate",enableWheel:!0,view:dt,element:Ne,delay:Ge.delay||16,rotateSpeed:Ge.rotateSpeed||1,zoomSpeed:Ge.zoomSpeed||1,translateSpeed:Ge.translateSpeed||1,flipX:!!Ge.flipX,flipY:!!Ge.flipY,modes:dt.modes,_ortho:Ge._ortho||Ge.projection&&"orthographic"===Ge.projection.type||!1,tick:function(){var Ge=tt(),Qe=this.delay,rt=Ge-2*Qe;dt.idle(Ge-Qe),dt.recalcMatrix(rt),dt.flush(Ge-(100+2*Qe));for(var nt=!0,at=dt.computedMatrix,it=0;it<16;++it)nt=nt&&ht[it]===at[it],ht[it]=at[it];var ot=Ne.clientWidth===Ot&&Ne.clientHeight===Rt;return Ot=Ne.clientWidth,Rt=Ne.clientHeight,nt?!ot:(Dt=Math.exp(dt.computedRadius[0]),!0)},lookAt:function(Ne,Ge,Qe){dt.lookAt(dt.lastT(),Ne,Ge,Qe)},rotate:function(Ne,Ge,Qe){dt.rotate(dt.lastT(),Ne,Ge,Qe)},pan:function(Ne,Ge,Qe){dt.pan(dt.lastT(),Ne,Ge,Qe)},translate:function(Ne,Ge,Qe){dt.translate(dt.lastT(),Ne,Ge,Qe)}};return Object.defineProperties(Zt,{matrix:{get:function(){return dt.computedMatrix},set:function(Ne){return dt.setMatrix(dt.lastT(),Ne),dt.computedMatrix},enumerable:!0},mode:{get:function(){return dt.getMode()},set:function(Ne){var Ge=dt.computedUp.slice(),Qe=dt.computedEye.slice(),rt=dt.computedCenter.slice();if(dt.setMode(Ne),"turntable"===Ne){var nt=tt();dt._active.lookAt(nt,Qe,rt,Ge),dt._active.lookAt(nt+500,Qe,rt,[0,0,1]),dt._active.flush(nt)}return dt.getMode()},enumerable:!0},center:{get:function(){return dt.computedCenter},set:function(Ne){return dt.lookAt(dt.lastT(),null,Ne),dt.computedCenter},enumerable:!0},eye:{get:function(){return dt.computedEye},set:function(Ne){return dt.lookAt(dt.lastT(),Ne),dt.computedEye},enumerable:!0},up:{get:function(){return dt.computedUp},set:function(Ne){return dt.lookAt(dt.lastT(),null,null,Ne),dt.computedUp},enumerable:!0},distance:{get:function(){return Dt},set:function(Ne){return dt.setDistance(dt.lastT(),Ne),Ne},enumerable:!0},distanceLimits:{get:function(){return dt.getDistanceLimits(Qe)},set:function(Ne){return dt.setDistanceLimits(Ne),Ne},enumerable:!0}}),Ne.addEventListener("contextmenu",(function(Ne){return Ne.preventDefault(),!1})),Zt._lastX=-1,Zt._lastY=-1,Zt._lastMods={shift:!1,control:!1,alt:!1,meta:!1},Zt.enableMouseListeners=function(){function handleInteraction(Ge,Qe,rt,nt){var at=Zt.keyBindingMode;if(!1!==at){var it="rotate"===at,ot="pan"===at,ht="zoom"===at,Ot=!!nt.control,Rt=!!nt.alt,er=!!nt.shift,dr=!!(1&Ge),mr=!!(2&Ge),xr=!!(4&Ge),br=1/Ne.clientHeight,Ar=br*(Qe-Zt._lastX),en=br*(rt-Zt._lastY),mn=Zt.flipX?1:-1,xn=Zt.flipY?1:-1,kn=Math.PI*Zt.rotateSpeed,Cn=tt();if(-1!==Zt._lastX&&-1!==Zt._lastY&&((it&&dr&&!Ot&&!Rt&&!er||dr&&!Ot&&!Rt&&er)&&dt.rotate(Cn,mn*kn*Ar,-xn*kn*en,0),(ot&&dr&&!Ot&&!Rt&&!er||mr||dr&&Ot&&!Rt&&!er)&&dt.pan(Cn,-Zt.translateSpeed*Ar*Dt,Zt.translateSpeed*en*Dt,0),ht&&dr&&!Ot&&!Rt&&!er||xr||dr&&!Ot&&Rt&&!er)){var En=-Zt.zoomSpeed*en/window.innerHeight*(Cn-dt.lastT())*100;dt.pan(Cn,0,0,Dt*(Math.exp(En)-1))}return Zt._lastX=Qe,Zt._lastY=rt,Zt._lastMods=nt,!0}}Zt.mouseListener=nt(Ne,handleInteraction),Ne.addEventListener("touchstart",(function(Ge){var Qe=it(Ge.changedTouches[0],Ne);handleInteraction(0,Qe[0],Qe[1],Zt._lastMods),handleInteraction(1,Qe[0],Qe[1],Zt._lastMods)}),!!ot&&{passive:!0}),Ne.addEventListener("touchmove",(function(Ge){var Qe=it(Ge.changedTouches[0],Ne);handleInteraction(1,Qe[0],Qe[1],Zt._lastMods),Ge.preventDefault()}),!!ot&&{passive:!1}),Ne.addEventListener("touchend",(function(Ne){handleInteraction(0,Zt._lastX,Zt._lastY,Zt._lastMods)}),!!ot&&{passive:!0}),Zt.wheelListener=at(Ne,(function(Ne,Ge){if(!1!==Zt.keyBindingMode&&Zt.enableWheel){var Qe=Zt.flipX?1:-1,rt=Zt.flipY?1:-1,nt=tt();if(Math.abs(Ne)>Math.abs(Ge))dt.rotate(nt,0,0,-Ne*Qe*Math.PI*Zt.rotateSpeed/window.innerWidth);else if(!Zt._ortho){var at=-Zt.zoomSpeed*rt*Ge/window.innerHeight*(nt-dt.lastT())/20;dt.pan(nt,0,0,Dt*(Math.exp(at)-1))}}}),!0)},Zt.enableMouseListeners(),Zt}},{"3d-view":54,"has-passive-events":441,"mouse-change":483,"mouse-event-offset":484,"mouse-wheel":486,"right-now":542}],319:[function(Ne,Ge,Qe){var tt=Ne("glslify"),rt=Ne("gl-shader"),nt=tt(["precision mediump float;\n#define GLSLIFY 1\nattribute vec2 position;\nvarying vec2 uv;\nvoid main() {\n  uv = position;\n  gl_Position = vec4(position, 0, 1);\n}"]),at=tt(["precision mediump float;\n#define GLSLIFY 1\n\nuniform sampler2D accumBuffer;\nvarying vec2 uv;\n\nvoid main() {\n  vec4 accum = texture2D(accumBuffer, 0.5 * (uv + 1.0));\n  gl_FragColor = min(vec4(1,1,1,1), accum);\n}"]);Ge.exports=function(Ne){return rt(Ne,nt,at,null,[{name:"position",type:"vec2"}])}},{"gl-shader":335,glslify:320}],320:[function(Ne,Ge,Qe){arguments[4][257][0].apply(Qe,arguments)},{dup:257}],321:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./camera.js"),rt=Ne("gl-axes3d"),nt=Ne("gl-axes3d/properties"),at=Ne("gl-spikes3d"),it=Ne("gl-select-static"),ot=Ne("gl-fbo"),dt=Ne("a-big-triangle"),ht=Ne("mouse-change"),Dt=Ne("gl-mat4/perspective"),Ot=Ne("gl-mat4/ortho"),Rt=Ne("./lib/shader"),Zt=Ne("is-mobile")({tablet:!0,featureDetect:!0});function MouseSelect(){this.mouse=[-1,-1],this.screen=null,this.distance=1/0,this.index=null,this.dataCoordinate=null,this.dataPosition=null,this.object=null,this.data=null}function getContext(Ne,Ge){var Qe=null;try{(Qe=Ne.getContext("webgl",Ge))||(Qe=Ne.getContext("experimental-webgl",Ge))}catch(Ne){return null}return Qe}function roundUpPow10(Ne){var Ge=Math.round(Math.log(Math.abs(Ne))/Math.log(10));if(Ge<0){var Qe=Math.round(Math.pow(10,-Ge));return Math.ceil(Ne*Qe)/Qe}return Ge>0?(Qe=Math.round(Math.pow(10,Ge)),Math.ceil(Ne/Qe)*Qe):Math.ceil(Ne)}function defaultBool(Ne){return"boolean"!=typeof Ne||Ne}function createScene(Ne){(Ne=Ne||{}).camera=Ne.camera||{};var Ge=Ne.canvas;Ge||(Ge=document.createElement("canvas"),Ne.container?Ne.container.appendChild(Ge):document.body.appendChild(Ge));var Qe=Ne.gl;if(Qe||(Ne.glOptions&&(Zt=!!Ne.glOptions.preserveDrawingBuffer),Qe=getContext(Ge,Ne.glOptions||{premultipliedAlpha:!0,antialias:!0,preserveDrawingBuffer:Zt})),!Qe)throw new Error("webgl not supported");var Dt=Ne.bounds||[[-10,-10,-10],[10,10,10]],Ot=new MouseSelect,er=ot(Qe,Qe.drawingBufferWidth,Qe.drawingBufferHeight,{preferFloat:!Zt}),dr=Rt(Qe),mr=Ne.cameraObject&&!0===Ne.cameraObject._ortho||Ne.camera.projection&&"orthographic"===Ne.camera.projection.type||!1,xr={eye:Ne.camera.eye||[2,0,0],center:Ne.camera.center||[0,0,0],up:Ne.camera.up||[0,1,0],zoomMin:Ne.camera.zoomMax||.1,zoomMax:Ne.camera.zoomMin||100,mode:Ne.camera.mode||"turntable",_ortho:mr},br=Ne.axes||{},Ar=rt(Qe,br);Ar.enable=!br.disable;var en=Ne.spikes||{},mn=at(Qe,en),xn=[],kn=[],Cn=[],En=[],Pn=!0,Dn=!0,In={view:null,projection:new Array(16),model:new Array(16),_ortho:!1},zn=(Dn=!0,[Qe.drawingBufferWidth,Qe.drawingBufferHeight]),Bn=Ne.cameraObject||tt(Ge,xr),Vn={gl:Qe,contextLost:!1,pixelRatio:Ne.pixelRatio||1,canvas:Ge,selection:Ot,camera:Bn,axes:Ar,axesPixels:null,spikes:mn,bounds:Dt,objects:xn,shape:zn,aspect:Ne.aspectRatio||[1,1,1],pickRadius:Ne.pickRadius||10,zNear:Ne.zNear||.01,zFar:Ne.zFar||1e3,fovy:Ne.fovy||Math.PI/4,clearColor:Ne.clearColor||[0,0,0,0],autoResize:defaultBool(Ne.autoResize),autoBounds:defaultBool(Ne.autoBounds),autoScale:!!Ne.autoScale,autoCenter:defaultBool(Ne.autoCenter),clipToBounds:defaultBool(Ne.clipToBounds),snapToData:!!Ne.snapToData,onselect:Ne.onselect||null,onrender:Ne.onrender||null,onclick:Ne.onclick||null,cameraParams:In,oncontextloss:null,mouseListener:null,_stopped:!1,getAspectratio:function(){return{x:this.aspect[0],y:this.aspect[1],z:this.aspect[2]}},setAspectratio:function(Ne){this.aspect[0]=Ne.x,this.aspect[1]=Ne.y,this.aspect[2]=Ne.z,Dn=!0},setBounds:function(Ne,Ge){this.bounds[0][Ne]=Ge.min,this.bounds[1][Ne]=Ge.max},setClearColor:function(Ne){this.clearColor=Ne},clearRGBA:function(){this.gl.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT)}},Hn=[Qe.drawingBufferWidth/Vn.pixelRatio|0,Qe.drawingBufferHeight/Vn.pixelRatio|0];function resizeListener(){if(!Vn._stopped&&Vn.autoResize){var Ne=Ge.parentNode,Qe=1,tt=1;Ne&&Ne!==document.body?(Qe=Ne.clientWidth,tt=Ne.clientHeight):(Qe=window.innerWidth,tt=window.innerHeight);var rt=0|Math.ceil(Qe*Vn.pixelRatio),nt=0|Math.ceil(tt*Vn.pixelRatio);if(rt!==Ge.width||nt!==Ge.height){Ge.width=rt,Ge.height=nt;var at=Ge.style;at.position=at.position||"absolute",at.left="0px",at.top="0px",at.width=Qe+"px",at.height=tt+"px",Pn=!0}}}function reallocPickIds(){for(var Ne=xn.length,Ge=En.length,tt=0;tt<Ge;++tt)Cn[tt]=0;e:for(tt=0;tt<Ne;++tt){var rt=xn[tt],nt=rt.pickSlots;if(nt){for(var at=0;at<Ge;++at)if(Cn[at]+nt<255){kn[tt]=at,rt.setPickBase(Cn[at]+1),Cn[at]+=nt;continue e}var ot=it(Qe,zn);kn[tt]=Ge,En.push(ot),Cn.push(nt),rt.setPickBase(1),Ge+=1}else kn[tt]=-1}for(;Ge>0&&0===Cn[Ge-1];)Cn.pop(),En.pop().dispose()}function checkContextLoss(){if(Vn.contextLost)return!0;Qe.isContextLost()&&(Vn.contextLost=!0,Vn.mouseListener.enabled=!1,Vn.selection.object=null,Vn.oncontextloss&&Vn.oncontextloss())}function renderPick(){if(!checkContextLoss()){Qe.colorMask(!0,!0,!0,!0),Qe.depthMask(!0),Qe.disable(Qe.BLEND),Qe.enable(Qe.DEPTH_TEST),Qe.depthFunc(Qe.LEQUAL);for(var Ne=xn.length,Ge=En.length,tt=0;tt<Ge;++tt){var rt=En[tt];rt.shape=Hn,rt.begin();for(var nt=0;nt<Ne;++nt)if(kn[nt]===tt){var at=xn[nt];at.drawPick&&(at.pixelRatio=1,at.drawPick(In))}rt.end()}}}Vn.autoResize&&resizeListener(),window.addEventListener("resize",resizeListener),Vn.update=function(Ne){Vn._stopped||(Ne=Ne||{},Pn=!0,Dn=!0)},Vn.add=function(Ne){Vn._stopped||(Ne.axes=Ar,xn.push(Ne),kn.push(-1),Pn=!0,Dn=!0,reallocPickIds())},Vn.remove=function(Ne){if(!Vn._stopped){var Ge=xn.indexOf(Ne);Ge<0||(xn.splice(Ge,1),kn.pop(),Pn=!0,Dn=!0,reallocPickIds())}},Vn.dispose=function(){if(!Vn._stopped&&(Vn._stopped=!0,window.removeEventListener("resize",resizeListener),Ge.removeEventListener("webglcontextlost",checkContextLoss),Vn.mouseListener.enabled=!1,!Vn.contextLost)){Ar.dispose(),mn.dispose();for(var Ne=0;Ne<xn.length;++Ne)xn[Ne].dispose();for(er.dispose(),Ne=0;Ne<En.length;++Ne)En[Ne].dispose();dr.dispose(),Qe=null,Ar=null,mn=null,xn=[]}},Vn._mouseRotating=!1,Vn._prevButtons=0,Vn.enableMouseListeners=function(){Vn.mouseListener=ht(Ge,(function(Ne,Ge,Qe){if(!Vn._stopped){var tt=En.length,rt=xn.length,nt=Ot.object;Ot.distance=1/0,Ot.mouse[0]=Ge,Ot.mouse[1]=Qe,Ot.object=null,Ot.screen=null,Ot.dataCoordinate=Ot.dataPosition=null;var at=!1;if(Ne&&Vn._prevButtons)Vn._mouseRotating=!0;else{Vn._mouseRotating&&(Dn=!0),Vn._mouseRotating=!1;for(var it=0;it<tt;++it){var ot=En[it].query(Ge,Hn[1]-Qe-1,Vn.pickRadius);if(ot){if(ot.distance>Ot.distance)continue;for(var dt=0;dt<rt;++dt){var ht=xn[dt];if(kn[dt]===it){var Dt=ht.pick(ot);Dt&&(Ot.buttons=Ne,Ot.screen=ot.coord,Ot.distance=ot.distance,Ot.object=ht,Ot.index=Dt.distance,Ot.dataPosition=Dt.position,Ot.dataCoordinate=Dt.dataCoordinate,Ot.data=Dt,at=!0)}}}}}nt&&nt!==Ot.object&&(nt.highlight&&nt.highlight(null),Pn=!0),Ot.object&&(Ot.object.highlight&&Ot.object.highlight(Ot.data),Pn=!0),(at=at||Ot.object!==nt)&&Vn.onselect&&Vn.onselect(Ot),1&Ne&&!(1&Vn._prevButtons)&&Vn.onclick&&Vn.onclick(Ot),Vn._prevButtons=Ne}}))},Ge.addEventListener("webglcontextlost",checkContextLoss);var qn=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],Yn=[qn[0].slice(),qn[1].slice()];function redraw(){if(!checkContextLoss()){resizeListener();var Ne=Vn.camera.tick();In.view=Vn.camera.matrix,Pn=Pn||Ne,Dn=Dn||Ne,Ar.pixelRatio=Vn.pixelRatio,mn.pixelRatio=Vn.pixelRatio;var Ge=xn.length,tt=qn[0],rt=qn[1];tt[0]=tt[1]=tt[2]=1/0,rt[0]=rt[1]=rt[2]=-1/0;for(var at=0;at<Ge;++at){(En=xn[at]).pixelRatio=Vn.pixelRatio,En.axes=Vn.axes,Pn=Pn||!!En.dirty,Dn=Dn||!!En.dirty;var it=En.bounds;if(it)for(var ot=it[0],ht=it[1],Dt=0;Dt<3;++Dt)tt[Dt]=Math.min(tt[Dt],ot[Dt]),rt[Dt]=Math.max(rt[Dt],ht[Dt])}var Rt=Vn.bounds;if(Vn.autoBounds)for(Dt=0;Dt<3;++Dt){if(rt[Dt]<tt[Dt])tt[Dt]=-1,rt[Dt]=1;else{tt[Dt]===rt[Dt]&&(tt[Dt]-=1,rt[Dt]+=1);var Zt=.05*(rt[Dt]-tt[Dt]);tt[Dt]=tt[Dt]-Zt,rt[Dt]=rt[Dt]+Zt}Rt[0][Dt]=tt[Dt],Rt[1][Dt]=rt[Dt]}var xr=!1;for(Dt=0;Dt<3;++Dt)xr=xr||Yn[0][Dt]!==Rt[0][Dt]||Yn[1][Dt]!==Rt[1][Dt],Yn[0][Dt]=Rt[0][Dt],Yn[1][Dt]=Rt[1][Dt];if(Dn=Dn||xr,Pn=Pn||xr){if(xr){var br=[0,0,0];for(at=0;at<3;++at)br[at]=roundUpPow10((Rt[1][at]-Rt[0][at])/10);Ar.autoTicks?Ar.update({bounds:Rt,tickSpacing:br}):Ar.update({bounds:Rt})}var en=Qe.drawingBufferWidth,kn=Qe.drawingBufferHeight;for(zn[0]=en,zn[1]=kn,Hn[0]=0|Math.max(en/Vn.pixelRatio,1),Hn[1]=0|Math.max(kn/Vn.pixelRatio,1),calcCameraParams(Vn,mr),at=0;at<Ge;++at)(En=xn[at]).axesBounds=Rt,Vn.clipToBounds&&(En.clipBounds=Rt);Ot.object&&(Vn.snapToData?mn.position=Ot.dataCoordinate:mn.position=Ot.dataPosition,mn.bounds=Rt),Dn&&(Dn=!1,renderPick()),Vn.axesPixels=nt(Vn.axes,In,en,kn),Vn.onrender&&Vn.onrender(),Qe.bindFramebuffer(Qe.FRAMEBUFFER,null),Qe.viewport(0,0,en,kn),Vn.clearRGBA(),Qe.depthMask(!0),Qe.colorMask(!0,!0,!0,!0),Qe.enable(Qe.DEPTH_TEST),Qe.depthFunc(Qe.LEQUAL),Qe.disable(Qe.BLEND),Qe.disable(Qe.CULL_FACE);var Cn=!1;for(Ar.enable&&(Cn=Cn||Ar.isTransparent(),Ar.draw(In)),mn.axes=Ar,Ot.object&&mn.draw(In),Qe.disable(Qe.CULL_FACE),at=0;at<Ge;++at)(En=xn[at]).axes=Ar,En.pixelRatio=Vn.pixelRatio,En.isOpaque&&En.isOpaque()&&En.draw(In),En.isTransparent&&En.isTransparent()&&(Cn=!0);if(Cn){for(er.shape=zn,er.bind(),Qe.clear(Qe.DEPTH_BUFFER_BIT),Qe.colorMask(!1,!1,!1,!1),Qe.depthMask(!0),Qe.depthFunc(Qe.LESS),Ar.enable&&Ar.isTransparent()&&Ar.drawTransparent(In),at=0;at<Ge;++at)(En=xn[at]).isOpaque&&En.isOpaque()&&En.draw(In);for(Qe.enable(Qe.BLEND),Qe.blendEquation(Qe.FUNC_ADD),Qe.blendFunc(Qe.ONE,Qe.ONE_MINUS_SRC_ALPHA),Qe.colorMask(!0,!0,!0,!0),Qe.depthMask(!1),Qe.clearColor(0,0,0,0),Qe.clear(Qe.COLOR_BUFFER_BIT),Ar.isTransparent()&&Ar.drawTransparent(In),at=0;at<Ge;++at){var En;(En=xn[at]).isTransparent&&En.isTransparent()&&En.drawTransparent(In)}Qe.bindFramebuffer(Qe.FRAMEBUFFER,null),Qe.blendFunc(Qe.ONE,Qe.ONE_MINUS_SRC_ALPHA),Qe.disable(Qe.DEPTH_TEST),dr.bind(),er.color[0].bind(0),dr.uniforms.accumBuffer=0,dt(Qe),Qe.disable(Qe.BLEND)}for(Pn=!1,at=0;at<Ge;++at)xn[at].dirty=!1}}}function render(){Vn._stopped||Vn.contextLost||(redraw(),requestAnimationFrame(render))}return Vn.enableMouseListeners(),render(),Vn.redraw=function(){Vn._stopped||(Pn=!0,redraw())},Vn}function calcCameraParams(Ne,Ge){var Qe=Ne.bounds,tt=Ne.cameraParams,rt=tt.projection,nt=tt.model,at=Ne.gl.drawingBufferWidth,it=Ne.gl.drawingBufferHeight,ot=Ne.zNear,dt=Ne.zFar,ht=Ne.fovy,Rt=at/it;Ge?(Ot(rt,-Rt,Rt,-1,1,ot,dt),tt._ortho=!0):(Dt(rt,ht,Rt,ot,dt),tt._ortho=!1);for(var Zt=0;Zt<16;++Zt)nt[Zt]=0;nt[15]=1;var er=0;for(Zt=0;Zt<3;++Zt)er=Math.max(er,Qe[1][Zt]-Qe[0][Zt]);for(Zt=0;Zt<3;++Zt)Ne.autoScale?nt[5*Zt]=Ne.aspect[Zt]/(Qe[1][Zt]-Qe[0][Zt]):nt[5*Zt]=1/er,Ne.autoCenter&&(nt[12+Zt]=.5*-nt[5*Zt]*(Qe[0][Zt]+Qe[1][Zt]))}Ge.exports={createScene:createScene,createCamera:tt}},{"./camera.js":318,"./lib/shader":319,"a-big-triangle":64,"gl-axes3d":250,"gl-axes3d/properties":258,"gl-fbo":269,"gl-mat4/ortho":296,"gl-mat4/perspective":297,"gl-select-static":334,"gl-spikes3d":345,"is-mobile":467,"mouse-change":483}],322:[function(Ne,Ge,Qe){var tt=Ne("glslify");Qe.pointVertex=tt(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform float pointCloud;\n\nhighp float rand(vec2 co) {\n  highp float a = 12.9898;\n  highp float b = 78.233;\n  highp float c = 43758.5453;\n  highp float d = dot(co.xy, vec2(a, b));\n  highp float e = mod(d, 3.14);\n  return fract(sin(e) * c);\n}\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n    // if we don't jitter the point size a bit, overall point cloud\n    // saturation 'jumps' on zooming, which is disturbing and confusing\n  gl_PointSize = pointSize * ((19.5 + rand(position)) / 20.0);\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    // get the same square surface as circle would be\n    gl_PointSize *= 0.886;\n  }\n}"]),Qe.pointFragment=tt(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color, borderColor;\nuniform float centerFraction;\nuniform float pointCloud;\n\nvoid main() {\n  float radius;\n  vec4 baseColor;\n  if(pointCloud != 0.0) { // pointCloud is truthy\n    if(centerFraction == 1.0) {\n      gl_FragColor = color;\n    } else {\n      gl_FragColor = mix(borderColor, color, centerFraction);\n    }\n  } else {\n    radius = length(2.0 * gl_PointCoord.xy - 1.0);\n    if(radius > 1.0) {\n      discard;\n    }\n    baseColor = mix(borderColor, color, step(radius, centerFraction));\n    gl_FragColor = vec4(baseColor.rgb * baseColor.a, baseColor.a);\n  }\n}\n"]),Qe.pickVertex=tt(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 position;\nattribute vec4 pickId;\n\nuniform mat3 matrix;\nuniform float pointSize;\nuniform vec4 pickOffset;\n\nvarying vec4 fragId;\n\nvoid main() {\n  vec3 hgPosition = matrix * vec3(position, 1);\n  gl_Position  = vec4(hgPosition.xy, 0, hgPosition.z);\n  gl_PointSize = pointSize;\n\n  vec4 id = pickId + pickOffset;\n  id.y += floor(id.x / 256.0);\n  id.x -= floor(id.x / 256.0) * 256.0;\n\n  id.z += floor(id.y / 256.0);\n  id.y -= floor(id.y / 256.0) * 256.0;\n\n  id.w += floor(id.z / 256.0);\n  id.z -= floor(id.z / 256.0) * 256.0;\n\n  fragId = id;\n}\n"]),Qe.pickFragment=tt(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragId;\n\nvoid main() {\n  float radius = length(2.0 * gl_PointCoord.xy - 1.0);\n  if(radius > 1.0) {\n    discard;\n  }\n  gl_FragColor = fragId / 255.0;\n}\n"])},{glslify:323}],323:[function(Ne,Ge,Qe){arguments[4][257][0].apply(Qe,arguments)},{dup:257}],324:[function(Ne,Ge,Qe){"use strict";var tt=Ne("gl-shader"),rt=Ne("gl-buffer"),nt=Ne("typedarray-pool"),at=Ne("./lib/shader");function Pointcloud2D(Ne,Ge,Qe,tt,rt){this.plot=Ne,this.offsetBuffer=Ge,this.pickBuffer=Qe,this.shader=tt,this.pickShader=rt,this.sizeMin=.5,this.sizeMinCap=2,this.sizeMax=20,this.areaRatio=1,this.pointCount=0,this.color=[1,0,0,1],this.borderColor=[0,0,0,1],this.blend=!1,this.pickOffset=0,this.points=null}Ge.exports=createPointcloud2D;var it,ot,dt=Pointcloud2D.prototype;function count(Ne,Ge){var Qe,tt=0,rt=Ne.length>>>1;for(Qe=0;Qe<rt;Qe++){var nt=Ne[2*Qe],at=Ne[2*Qe+1];nt>=Ge[0]&&nt<=Ge[2]&&at>=Ge[1]&&at<=Ge[3]&&tt++}return tt}function createPointcloud2D(Ne,Ge){var Qe=Ne.gl,nt=new Pointcloud2D(Ne,rt(Qe),rt(Qe),tt(Qe,at.pointVertex,at.pointFragment),tt(Qe,at.pickVertex,at.pickFragment));return nt.update(Ge),Ne.addObject(nt),nt}dt.dispose=function(){this.shader.dispose(),this.pickShader.dispose(),this.offsetBuffer.dispose(),this.pickBuffer.dispose(),this.plot.removeObject(this)},dt.update=function(Ne){var Ge;function dflt(Ge,Qe){return Ge in Ne?Ne[Ge]:Qe}Ne=Ne||{},this.sizeMin=dflt("sizeMin",.5),this.sizeMax=dflt("sizeMax",20),this.color=dflt("color",[1,0,0,1]).slice(),this.areaRatio=dflt("areaRatio",1),this.borderColor=dflt("borderColor",[0,0,0,1]).slice(),this.blend=dflt("blend",!1);var Qe=Ne.positions.length>>>1,tt=Ne.positions instanceof Float32Array,rt=Ne.idToIndex instanceof Int32Array&&Ne.idToIndex.length>=Qe,at=Ne.positions,it=tt?at:nt.mallocFloat32(at.length),ot=rt?Ne.idToIndex:nt.mallocInt32(Qe);if(tt||it.set(at),!rt)for(it.set(at),Ge=0;Ge<Qe;Ge++)ot[Ge]=Ge;this.points=at,this.offsetBuffer.update(it),this.pickBuffer.update(ot),tt||nt.free(it),rt||nt.free(ot),this.pointCount=Qe,this.pickOffset=0},dt.unifiedDraw=(it=[1,0,0,0,1,0,0,0,1],ot=[0,0,0,0],function(Ne){var Ge=void 0!==Ne,Qe=Ge?this.pickShader:this.shader,tt=this.plot.gl,rt=this.plot.dataBox;if(0===this.pointCount)return Ne;var nt=rt[2]-rt[0],at=rt[3]-rt[1],dt=count(this.points,rt),ht=this.plot.pickPixelRatio*Math.max(Math.min(this.sizeMinCap,this.sizeMin),Math.min(this.sizeMax,this.sizeMax/Math.pow(dt,.33333)));it[0]=2/nt,it[4]=2/at,it[6]=-2*rt[0]/nt-1,it[7]=-2*rt[1]/at-1,this.offsetBuffer.bind(),Qe.bind(),Qe.attributes.position.pointer(),Qe.uniforms.matrix=it,Qe.uniforms.color=this.color,Qe.uniforms.borderColor=this.borderColor,Qe.uniforms.pointCloud=ht<5,Qe.uniforms.pointSize=ht,Qe.uniforms.centerFraction=Math.min(1,Math.max(0,Math.sqrt(1-this.areaRatio))),Ge&&(ot[0]=255&Ne,ot[1]=Ne>>8&255,ot[2]=Ne>>16&255,ot[3]=Ne>>24&255,this.pickBuffer.bind(),Qe.attributes.pickId.pointer(tt.UNSIGNED_BYTE),Qe.uniforms.pickOffset=ot,this.pickOffset=Ne);var Dt=tt.getParameter(tt.BLEND),Ot=tt.getParameter(tt.DITHER);return Dt&&!this.blend&&tt.disable(tt.BLEND),Ot&&tt.disable(tt.DITHER),tt.drawArrays(tt.POINTS,0,this.pointCount),Dt&&!this.blend&&tt.enable(tt.BLEND),Ot&&tt.enable(tt.DITHER),Ne+this.pointCount}),dt.draw=dt.unifiedDraw,dt.drawPick=dt.unifiedDraw,dt.pick=function(Ne,Ge,Qe){var tt=this.pickOffset,rt=this.pointCount;if(Qe<tt||Qe>=tt+rt)return null;var nt=Qe-tt,at=this.points;return{object:this,pointId:nt,dataCoord:[at[2*nt],at[2*nt+1]]}}},{"./lib/shader":322,"gl-buffer":259,"gl-shader":335,"typedarray-pool":595}],325:[function(Ne,Ge,Qe){function slerp(Ne,Ge,Qe,tt){var rt,nt,at,it,ot,dt=Ge[0],ht=Ge[1],Dt=Ge[2],Ot=Ge[3],Rt=Qe[0],Zt=Qe[1],er=Qe[2],dr=Qe[3];return(nt=dt*Rt+ht*Zt+Dt*er+Ot*dr)<0&&(nt=-nt,Rt=-Rt,Zt=-Zt,er=-er,dr=-dr),1-nt>1e-6?(rt=Math.acos(nt),at=Math.sin(rt),it=Math.sin((1-tt)*rt)/at,ot=Math.sin(tt*rt)/at):(it=1-tt,ot=tt),Ne[0]=it*dt+ot*Rt,Ne[1]=it*ht+ot*Zt,Ne[2]=it*Dt+ot*er,Ne[3]=it*Ot+ot*dr,Ne}Ge.exports=slerp},{}],326:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne){return Ne||0===Ne?Ne.toString():""}},{}],327:[function(Ne,Ge,Qe){"use strict";var tt=Ne("vectorize-text");Ge.exports=getGlyph;var rt={};function getGlyph(Ne,Ge,Qe){var nt=rt[Ge];if(nt||(nt=rt[Ge]={}),Ne in nt)return nt[Ne];var at={textAlign:"center",textBaseline:"middle",lineHeight:1,font:Ge,lineSpacing:1.25,styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0},triangles:!0},it=tt(Ne,at);at.triangles=!1;var ot,dt,ht=tt(Ne,at);if(Qe&&1!==Qe){for(ot=0;ot<it.positions.length;++ot)for(dt=0;dt<it.positions[ot].length;++dt)it.positions[ot][dt]/=Qe;for(ot=0;ot<ht.positions.length;++ot)for(dt=0;dt<ht.positions[ot].length;++dt)ht.positions[ot][dt]/=Qe}var Dt=[[1/0,1/0],[-1/0,-1/0]],Ot=ht.positions.length;for(ot=0;ot<Ot;++ot){var Rt=ht.positions[ot];for(dt=0;dt<2;++dt)Dt[0][dt]=Math.min(Dt[0][dt],Rt[dt]),Dt[1][dt]=Math.max(Dt[1][dt],Rt[dt])}return nt[Ne]=[it,ht,Dt]}},{"vectorize-text":600}],328:[function(Ne,Ge,Qe){var tt=Ne("gl-shader"),rt=Ne("glslify"),nt=rt(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform vec4 highlightId;\nuniform float highlightScale;\nuniform mat4 model, view, projection;\nuniform vec3 clipBounds[2];\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = 1.0;\n    if(distance(highlightId, id) < 0.0001) {\n      scale = highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1);\n    vec4 viewPosition = view * worldPosition;\n    viewPosition = viewPosition / viewPosition.w;\n    vec4 clipPosition = projection * (viewPosition + scale * vec4(glyph.x, -glyph.y, 0, 0));\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]),at=rt(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float highlightScale, pixelRatio;\nuniform vec4 highlightId;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float scale = pixelRatio;\n    if(distance(highlightId.bgr, id.bgr) < 0.001) {\n      scale *= highlightScale;\n    }\n\n    vec4 worldPosition = model * vec4(position, 1.0);\n    vec4 viewPosition = view * worldPosition;\n    vec4 clipPosition = projection * viewPosition;\n    clipPosition /= clipPosition.w;\n\n    gl_Position = clipPosition + vec4(screenSize * scale * vec2(glyph.x, -glyph.y), 0.0, 0.0);\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = position;\n  }\n}"]),it=rt(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nattribute vec3 position;\nattribute vec4 color;\nattribute vec2 glyph;\nattribute vec4 id;\n\nuniform float highlightScale;\nuniform vec4 highlightId;\nuniform vec3 axes[2];\nuniform mat4 model, view, projection;\nuniform vec2 screenSize;\nuniform vec3 clipBounds[2];\nuniform float scale, pixelRatio;\n\nvarying vec4 interpColor;\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], position)) {\n\n    gl_Position = vec4(0,0,0,0);\n  } else {\n    float lscale = pixelRatio * scale;\n    if(distance(highlightId, id) < 0.0001) {\n      lscale *= highlightScale;\n    }\n\n    vec4 clipCenter   = projection * view * model * vec4(position, 1);\n    vec3 dataPosition = position + 0.5*lscale*(axes[0] * glyph.x + axes[1] * glyph.y) * clipCenter.w * screenSize.y;\n    vec4 clipPosition = projection * view * model * vec4(dataPosition, 1);\n\n    gl_Position = clipPosition;\n    interpColor = color;\n    pickId = id;\n    dataCoordinate = dataPosition;\n  }\n}\n"]),ot=rt(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 fragClipBounds[2];\nuniform float opacity;\n\nvarying vec4 interpColor;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (\n    outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate) ||\n    interpColor.a * opacity == 0.\n  ) discard;\n  gl_FragColor = interpColor * opacity;\n}\n"]),dt=rt(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 fragClipBounds[2];\nuniform float pickGroup;\n\nvarying vec4 pickId;\nvarying vec3 dataCoordinate;\n\nvoid main() {\n  if (outOfRange(fragClipBounds[0], fragClipBounds[1], dataCoordinate)) discard;\n\n  gl_FragColor = vec4(pickGroup, pickId.bgr);\n}"]),ht=[{name:"position",type:"vec3"},{name:"color",type:"vec4"},{name:"glyph",type:"vec2"},{name:"id",type:"vec4"}],Dt={vertex:nt,fragment:ot,attributes:ht},Ot={vertex:at,fragment:ot,attributes:ht},Rt={vertex:it,fragment:ot,attributes:ht},Zt={vertex:nt,fragment:dt,attributes:ht},er={vertex:at,fragment:dt,attributes:ht},dr={vertex:it,fragment:dt,attributes:ht};function createShader(Ne,Ge){var Qe=tt(Ne,Ge),rt=Qe.attributes;return rt.position.location=0,rt.color.location=1,rt.glyph.location=2,rt.id.location=3,Qe}Qe.createPerspective=function(Ne){return createShader(Ne,Dt)},Qe.createOrtho=function(Ne){return createShader(Ne,Ot)},Qe.createProject=function(Ne){return createShader(Ne,Rt)},Qe.createPickPerspective=function(Ne){return createShader(Ne,Zt)},Qe.createPickOrtho=function(Ne){return createShader(Ne,er)},Qe.createPickProject=function(Ne){return createShader(Ne,dr)}},{"gl-shader":335,glslify:329}],329:[function(Ne,Ge,Qe){arguments[4][257][0].apply(Qe,arguments)},{dup:257}],330:[function(Ne,Ge,Qe){"use strict";var tt=Ne("is-string-blank"),rt=Ne("gl-buffer"),nt=Ne("gl-vao"),at=Ne("typedarray-pool"),it=Ne("gl-mat4/multiply"),ot=Ne("./lib/shaders"),dt=Ne("./lib/glyphs"),ht=Ne("./lib/get-simple-string"),Dt=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function transformMat4(Ne,Ge){var Qe=Ne[0],tt=Ne[1],rt=Ne[2],nt=Ne[3];return Ne[0]=Ge[0]*Qe+Ge[4]*tt+Ge[8]*rt+Ge[12]*nt,Ne[1]=Ge[1]*Qe+Ge[5]*tt+Ge[9]*rt+Ge[13]*nt,Ne[2]=Ge[2]*Qe+Ge[6]*tt+Ge[10]*rt+Ge[14]*nt,Ne[3]=Ge[3]*Qe+Ge[7]*tt+Ge[11]*rt+Ge[15]*nt,Ne}function project(Ne,Ge,Qe,tt){return transformMat4(tt,tt,Qe),transformMat4(tt,tt,Ge),transformMat4(tt,tt,Ne)}function ScatterPlotPickResult(Ne,Ge){this.index=Ne,this.dataCoordinate=this.position=Ge}function fixOpacity(Ne){return!0===Ne||Ne>1?1:Ne}function PointCloud(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt){this.gl=Ne,this.pixelRatio=1,this.shader=Ge,this.orthoShader=Qe,this.projectShader=tt,this.pointBuffer=rt,this.colorBuffer=nt,this.glyphBuffer=at,this.idBuffer=it,this.vao=ot,this.vertexCount=0,this.lineVertexCount=0,this.opacity=1,this.hasAlpha=!1,this.lineWidth=0,this.projectScale=[2/3,2/3,2/3],this.projectOpacity=[1,1,1],this.projectHasAlpha=!1,this.pickId=0,this.pickPerspectiveShader=dt,this.pickOrthoShader=ht,this.pickProjectShader=Dt,this.points=[],this._selectResult=new ScatterPlotPickResult(0,[0,0,0]),this.useOrtho=!0,this.bounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.axesProject=[!0,!0,!0],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.highlightId=[1,1,1,1],this.highlightScale=2,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.dirty=!0}Ge.exports=createPointCloud;var Ot=PointCloud.prototype;Ot.pickSlots=1,Ot.setPickBase=function(Ne){this.pickId=Ne},Ot.isTransparent=function(){if(this.hasAlpha)return!0;for(var Ne=0;Ne<3;++Ne)if(this.axesProject[Ne]&&this.projectHasAlpha)return!0;return!1},Ot.isOpaque=function(){if(!this.hasAlpha)return!0;for(var Ne=0;Ne<3;++Ne)if(this.axesProject[Ne]&&!this.projectHasAlpha)return!0;return!1};var Rt=[0,0],Zt=[0,0,0],er=[0,0,0],dr=[0,0,0,1],mr=[0,0,0,1],xr=Dt.slice(),br=[0,0,0],Ar=[[0,0,0],[0,0,0]];function zeroVec(Ne){return Ne[0]=Ne[1]=Ne[2]=0,Ne}function augment(Ne,Ge){return Ne[0]=Ge[0],Ne[1]=Ge[1],Ne[2]=Ge[2],Ne[3]=1,Ne}function setComponent(Ne,Ge,Qe,tt){return Ne[0]=Ge[0],Ne[1]=Ge[1],Ne[2]=Ge[2],Ne[Qe]=tt,Ne}function getClipBounds(Ne){for(var Ge=Ar,Qe=0;Qe<2;++Qe)for(var tt=0;tt<3;++tt)Ge[Qe][tt]=Math.max(Math.min(Ne[Qe][tt],1e8),-1e8);return Ge}function drawProject(Ne,Ge,Qe,tt){var rt,nt=Ge.axesProject,at=Ge.gl,ot=Ne.uniforms,dt=Qe.model||Dt,ht=Qe.view||Dt,Ot=Qe.projection||Dt,Ar=Ge.axesBounds,en=getClipBounds(Ge.clipBounds);rt=Ge.axes&&Ge.axes.lastCubeProps?Ge.axes.lastCubeProps.axis:[1,1,1],Rt[0]=2/at.drawingBufferWidth,Rt[1]=2/at.drawingBufferHeight,Ne.bind(),ot.view=ht,ot.projection=Ot,ot.screenSize=Rt,ot.highlightId=Ge.highlightId,ot.highlightScale=Ge.highlightScale,ot.clipBounds=en,ot.pickGroup=Ge.pickId/255,ot.pixelRatio=tt;for(var mn=0;mn<3;++mn)if(nt[mn]){ot.scale=Ge.projectScale[mn],ot.opacity=Ge.projectOpacity[mn];for(var xn=xr,kn=0;kn<16;++kn)xn[kn]=0;for(kn=0;kn<4;++kn)xn[5*kn]=1;xn[5*mn]=0,rt[mn]<0?xn[12+mn]=Ar[0][mn]:xn[12+mn]=Ar[1][mn],it(xn,dt,xn),ot.model=xn;var Cn=(mn+1)%3,En=(mn+2)%3,Pn=zeroVec(Zt),Dn=zeroVec(er);Pn[Cn]=1,Dn[En]=1;var In=project(Ot,ht,dt,augment(dr,Pn)),zn=project(Ot,ht,dt,augment(mr,Dn));if(Math.abs(In[1])>Math.abs(zn[1])){var Bn=In;In=zn,zn=Bn,Bn=Pn,Pn=Dn,Dn=Bn;var Vn=Cn;Cn=En,En=Vn}In[0]<0&&(Pn[Cn]=-1),zn[1]>0&&(Dn[En]=-1);var Hn=0,qn=0;for(kn=0;kn<4;++kn)Hn+=Math.pow(dt[4*Cn+kn],2),qn+=Math.pow(dt[4*En+kn],2);Pn[Cn]/=Math.sqrt(Hn),Dn[En]/=Math.sqrt(qn),ot.axes[0]=Pn,ot.axes[1]=Dn,ot.fragClipBounds[0]=setComponent(br,en[0],mn,-1e8),ot.fragClipBounds[1]=setComponent(br,en[1],mn,1e8),Ge.vao.bind(),Ge.vao.draw(at.TRIANGLES,Ge.vertexCount),Ge.lineWidth>0&&(at.lineWidth(Ge.lineWidth*tt),Ge.vao.draw(at.LINES,Ge.lineVertexCount,Ge.vertexCount)),Ge.vao.unbind()}}var en=[[-1e8,-1e8,-1e8],[1e8,1e8,1e8]];function drawFull(Ne,Ge,Qe,tt,rt,nt,at){var it=Qe.gl;if((nt===Qe.projectHasAlpha||at)&&drawProject(Ge,Qe,tt,rt),nt===Qe.hasAlpha||at){Ne.bind();var ot=Ne.uniforms;ot.model=tt.model||Dt,ot.view=tt.view||Dt,ot.projection=tt.projection||Dt,Rt[0]=2/it.drawingBufferWidth,Rt[1]=2/it.drawingBufferHeight,ot.screenSize=Rt,ot.highlightId=Qe.highlightId,ot.highlightScale=Qe.highlightScale,ot.fragClipBounds=en,ot.clipBounds=Qe.axes.bounds,ot.opacity=Qe.opacity,ot.pickGroup=Qe.pickId/255,ot.pixelRatio=rt,Qe.vao.bind(),Qe.vao.draw(it.TRIANGLES,Qe.vertexCount),Qe.lineWidth>0&&(it.lineWidth(Qe.lineWidth*rt),Qe.vao.draw(it.LINES,Qe.lineVertexCount,Qe.vertexCount)),Qe.vao.unbind()}}function get_glyphData(Ne,Ge,Qe,rt){var nt;nt=Array.isArray(Ne)?Ge<Ne.length?Ne[Ge]:void 0:Ne,nt=ht(nt);var at=!0;tt(nt)&&(nt="â¼",at=!1);var it=dt(nt,Qe,rt);return{mesh:it[0],lines:it[1],bounds:it[2],visible:at}}function createPointCloud(Ne){var Ge=Ne.gl,Qe=ot.createPerspective(Ge),tt=ot.createOrtho(Ge),at=ot.createProject(Ge),it=ot.createPickPerspective(Ge),dt=ot.createPickOrtho(Ge),ht=ot.createPickProject(Ge),Dt=rt(Ge),Ot=rt(Ge),Rt=rt(Ge),Zt=rt(Ge),er=new PointCloud(Ge,Qe,tt,at,Dt,Ot,Rt,Zt,nt(Ge,[{buffer:Dt,size:3,type:Ge.FLOAT},{buffer:Ot,size:4,type:Ge.FLOAT},{buffer:Rt,size:2,type:Ge.FLOAT},{buffer:Zt,size:4,type:Ge.UNSIGNED_BYTE,normalized:!0}]),it,dt,ht);return er.update(Ne),er}Ot.draw=function(Ne){drawFull(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,Ne,this.pixelRatio,!1,!1)},Ot.drawTransparent=function(Ne){drawFull(this.useOrtho?this.orthoShader:this.shader,this.projectShader,this,Ne,this.pixelRatio,!0,!1)},Ot.drawPick=function(Ne){drawFull(this.useOrtho?this.pickOrthoShader:this.pickPerspectiveShader,this.pickProjectShader,this,Ne,1,!0,!0)},Ot.pick=function(Ne){if(!Ne)return null;if(Ne.id!==this.pickId)return null;var Ge=Ne.value[2]+(Ne.value[1]<<8)+(Ne.value[0]<<16);if(Ge>=this.pointCount||Ge<0)return null;var Qe=this.points[Ge],tt=this._selectResult;tt.index=Ge;for(var rt=0;rt<3;++rt)tt.position[rt]=tt.dataCoordinate[rt]=Qe[rt];return tt},Ot.highlight=function(Ne){if(Ne){var Ge=Ne.index,Qe=255&Ge,tt=Ge>>8&255,rt=Ge>>16&255;this.highlightId=[Qe/255,tt/255,rt/255,0]}else this.highlightId=[1,1,1,1]},Ot.update=function(Ne){if("perspective"in(Ne=Ne||{})&&(this.useOrtho=!Ne.perspective),"orthographic"in Ne&&(this.useOrtho=!!Ne.orthographic),"lineWidth"in Ne&&(this.lineWidth=Ne.lineWidth),"project"in Ne)if(Array.isArray(Ne.project))this.axesProject=Ne.project;else{var Ge=!!Ne.project;this.axesProject=[Ge,Ge,Ge]}if("projectScale"in Ne)if(Array.isArray(Ne.projectScale))this.projectScale=Ne.projectScale.slice();else{var Qe=+Ne.projectScale;this.projectScale=[Qe,Qe,Qe]}if(this.projectHasAlpha=!1,"projectOpacity"in Ne){Array.isArray(Ne.projectOpacity)?this.projectOpacity=Ne.projectOpacity.slice():(Qe=+Ne.projectOpacity,this.projectOpacity=[Qe,Qe,Qe]);for(var tt=0;tt<3;++tt)this.projectOpacity[tt]=fixOpacity(this.projectOpacity[tt]),this.projectOpacity[tt]<1&&(this.projectHasAlpha=!0)}this.hasAlpha=!1,"opacity"in Ne&&(this.opacity=fixOpacity(Ne.opacity),this.opacity<1&&(this.hasAlpha=!0)),this.dirty=!0;var rt,nt,it=Ne.position,ot=Ne.font||"normal",dt=Ne.alignment||[0,0];if(2===dt.length)rt=dt[0],nt=dt[1];else for(rt=[],nt=[],tt=0;tt<dt.length;++tt)rt[tt]=dt[tt][0],nt[tt]=dt[tt][1];var ht=[1/0,1/0,1/0],Dt=[-1/0,-1/0,-1/0],Ot=Ne.glyph,Rt=Ne.color,Zt=Ne.size,er=Ne.angle,dr=Ne.lineColor,mr=-1,xr=0,br=0,Ar=0;if(it.length){Ar=it.length;e:for(tt=0;tt<Ar;++tt){for(var en=it[tt],mn=0;mn<3;++mn)if(isNaN(en[mn])||!isFinite(en[mn]))continue e;var xn=(ra=get_glyphData(Ot,tt,ot,this.pixelRatio)).mesh,kn=ra.lines,Cn=ra.bounds;xr+=3*xn.cells.length,br+=2*kn.edges.length}}var En=xr+br,Pn=at.mallocFloat(3*En),Dn=at.mallocFloat(4*En),In=at.mallocFloat(2*En),zn=at.mallocUint32(En);if(En>0){var Bn=0,Vn=xr,Hn=[0,0,0,1],qn=[0,0,0,1],Yn=Array.isArray(Rt)&&Array.isArray(Rt[0]),$n=Array.isArray(dr)&&Array.isArray(dr[0]);e:for(tt=0;tt<Ar;++tt){for(mr+=1,en=it[tt],mn=0;mn<3;++mn){if(isNaN(en[mn])||!isFinite(en[mn]))continue e;Dt[mn]=Math.max(Dt[mn],en[mn]),ht[mn]=Math.min(ht[mn],en[mn])}xn=(ra=get_glyphData(Ot,tt,ot,this.pixelRatio)).mesh,kn=ra.lines,Cn=ra.bounds;var ra,oa=ra.visible;if(oa)if(Array.isArray(Rt)){if(3===(pa=Yn?tt<Rt.length?Rt[tt]:[0,0,0,0]:Rt).length){for(mn=0;mn<3;++mn)Hn[mn]=pa[mn];Hn[3]=1}else if(4===pa.length){for(mn=0;mn<4;++mn)Hn[mn]=pa[mn];!this.hasAlpha&&pa[3]<1&&(this.hasAlpha=!0)}}else Hn[0]=Hn[1]=Hn[2]=0,Hn[3]=1;else Hn=[1,1,1,0];if(oa)if(Array.isArray(dr)){var pa;if(3===(pa=$n?tt<dr.length?dr[tt]:[0,0,0,0]:dr).length){for(mn=0;mn<3;++mn)qn[mn]=pa[mn];qn[mn]=1}else if(4===pa.length){for(mn=0;mn<4;++mn)qn[mn]=pa[mn];!this.hasAlpha&&pa[3]<1&&(this.hasAlpha=!0)}}else qn[0]=qn[1]=qn[2]=0,qn[3]=1;else qn=[1,1,1,0];var ga=.5;oa?Array.isArray(Zt)?ga=tt<Zt.length?+Zt[tt]:12:Zt?ga=+Zt:this.useOrtho&&(ga=12):ga=0;var ma=0;Array.isArray(er)?ma=tt<er.length?+er[tt]:0:er&&(ma=+er);var _a=Math.cos(ma),Va=Math.sin(ma);for(en=it[tt],mn=0;mn<3;++mn)Dt[mn]=Math.max(Dt[mn],en[mn]),ht[mn]=Math.min(ht[mn],en[mn]);var Wa=rt,Qa=nt;Wa=0,Array.isArray(rt)?Wa=tt<rt.length?rt[tt]:0:rt&&(Wa=rt),Qa=0,Array.isArray(nt)?Qa=tt<nt.length?nt[tt]:0:nt&&(Qa=nt);var ti=[Wa*=Wa>0?1-Cn[0][0]:Wa<0?1+Cn[1][0]:1,Qa*=Qa>0?1-Cn[0][1]:Qa<0?1+Cn[1][1]:1],ni=xn.cells||[],di=xn.positions||[];for(mn=0;mn<ni.length;++mn)for(var ji=ni[mn],Hi=0;Hi<3;++Hi){for(var Yi=0;Yi<3;++Yi)Pn[3*Bn+Yi]=en[Yi];for(Yi=0;Yi<4;++Yi)Dn[4*Bn+Yi]=Hn[Yi];zn[Bn]=mr;var uo=di[ji[Hi]];In[2*Bn]=ga*(_a*uo[0]-Va*uo[1]+ti[0]),In[2*Bn+1]=ga*(Va*uo[0]+_a*uo[1]+ti[1]),Bn+=1}for(ni=kn.edges,di=kn.positions,mn=0;mn<ni.length;++mn)for(ji=ni[mn],Hi=0;Hi<2;++Hi){for(Yi=0;Yi<3;++Yi)Pn[3*Vn+Yi]=en[Yi];for(Yi=0;Yi<4;++Yi)Dn[4*Vn+Yi]=qn[Yi];zn[Vn]=mr,uo=di[ji[Hi]],In[2*Vn]=ga*(_a*uo[0]-Va*uo[1]+ti[0]),In[2*Vn+1]=ga*(Va*uo[0]+_a*uo[1]+ti[1]),Vn+=1}}}this.bounds=[ht,Dt],this.points=it,this.pointCount=it.length,this.vertexCount=xr,this.lineVertexCount=br,this.pointBuffer.update(Pn),this.colorBuffer.update(Dn),this.glyphBuffer.update(In),this.idBuffer.update(zn),at.free(Pn),at.free(Dn),at.free(In),at.free(zn)},Ot.dispose=function(){this.shader.dispose(),this.orthoShader.dispose(),this.pickPerspectiveShader.dispose(),this.pickOrthoShader.dispose(),this.vao.dispose(),this.pointBuffer.dispose(),this.colorBuffer.dispose(),this.glyphBuffer.dispose(),this.idBuffer.dispose()}},{"./lib/get-simple-string":326,"./lib/glyphs":327,"./lib/shaders":328,"gl-buffer":259,"gl-mat4/multiply":295,"gl-vao":358,"is-string-blank":470,"typedarray-pool":595}],331:[function(Ne,Ge,Qe){"use strict";var tt=Ne("glslify");Qe.boxVertex=tt(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec2 vertex;\n\nuniform vec2 cornerA, cornerB;\n\nvoid main() {\n  gl_Position = vec4(mix(cornerA, cornerB, vertex), 0, 1);\n}\n"]),Qe.boxFragment=tt(["precision mediump float;\n#define GLSLIFY 1\n\nuniform vec4 color;\n\nvoid main() {\n  gl_FragColor = color;\n}\n"])},{glslify:332}],332:[function(Ne,Ge,Qe){arguments[4][257][0].apply(Qe,arguments)},{dup:257}],333:[function(Ne,Ge,Qe){"use strict";var tt=Ne("gl-shader"),rt=Ne("gl-buffer"),nt=Ne("./lib/shaders");function SelectBox(Ne,Ge,Qe){this.plot=Ne,this.boxBuffer=Ge,this.boxShader=Qe,this.enabled=!0,this.selectBox=[1/0,1/0,-1/0,-1/0],this.borderColor=[0,0,0,1],this.innerFill=!1,this.innerColor=[0,0,0,.25],this.outerFill=!0,this.outerColor=[0,0,0,.5],this.borderWidth=10}Ge.exports=createSelectBox;var at=SelectBox.prototype;function createSelectBox(Ne,Ge){var Qe=Ne.gl,at=new SelectBox(Ne,rt(Qe,[0,0,0,1,1,0,1,1]),tt(Qe,nt.boxVertex,nt.boxFragment));return at.update(Ge),Ne.addOverlay(at),at}at.draw=function(){if(this.enabled){var Ne=this.plot,Ge=this.selectBox,Qe=this.borderWidth,tt=(this.innerFill,this.innerColor),rt=(this.outerFill,this.outerColor),nt=this.borderColor,at=Ne.box,it=Ne.screenBox,ot=Ne.dataBox,dt=Ne.viewBox,ht=Ne.pixelRatio,Dt=(Ge[0]-ot[0])*(dt[2]-dt[0])/(ot[2]-ot[0])+dt[0],Ot=(Ge[1]-ot[1])*(dt[3]-dt[1])/(ot[3]-ot[1])+dt[1],Rt=(Ge[2]-ot[0])*(dt[2]-dt[0])/(ot[2]-ot[0])+dt[0],Zt=(Ge[3]-ot[1])*(dt[3]-dt[1])/(ot[3]-ot[1])+dt[1];if(Dt=Math.max(Dt,dt[0]),Ot=Math.max(Ot,dt[1]),Rt=Math.min(Rt,dt[2]),Zt=Math.min(Zt,dt[3]),!(Rt<Dt||Zt<Ot)){at.bind();var er=it[2]-it[0],dr=it[3]-it[1];if(this.outerFill&&(at.drawBox(0,0,er,Ot,rt),at.drawBox(0,Ot,Dt,Zt,rt),at.drawBox(0,Zt,er,dr,rt),at.drawBox(Rt,Ot,er,Zt,rt)),this.innerFill&&at.drawBox(Dt,Ot,Rt,Zt,tt),Qe>0){var mr=Qe*ht;at.drawBox(Dt-mr,Ot-mr,Rt+mr,Ot+mr,nt),at.drawBox(Dt-mr,Zt-mr,Rt+mr,Zt+mr,nt),at.drawBox(Dt-mr,Ot-mr,Dt+mr,Zt+mr,nt),at.drawBox(Rt-mr,Ot-mr,Rt+mr,Zt+mr,nt)}}}},at.update=function(Ne){Ne=Ne||{},this.innerFill=!!Ne.innerFill,this.outerFill=!!Ne.outerFill,this.innerColor=(Ne.innerColor||[0,0,0,.5]).slice(),this.outerColor=(Ne.outerColor||[0,0,0,.5]).slice(),this.borderColor=(Ne.borderColor||[0,0,0,1]).slice(),this.borderWidth=Ne.borderWidth||0,this.selectBox=(Ne.selectBox||this.selectBox).slice()},at.dispose=function(){this.boxBuffer.dispose(),this.boxShader.dispose(),this.plot.removeOverlay(this)}},{"./lib/shaders":331,"gl-buffer":259,"gl-shader":335}],334:[function(Ne,Ge,Qe){"use strict";Ge.exports=createSelectBuffer;var tt=Ne("gl-fbo"),rt=Ne("typedarray-pool"),nt=Ne("ndarray"),at=Ne("bit-twiddle").nextPow2,selectRange=function(Ne,Ge,Qe){for(var tt=1e8,rt=-1,nt=-1,at=Ne.shape[0],it=Ne.shape[1],ot=0;ot<at;ot++)for(var dt=0;dt<it;dt++){var ht=Ne.get(ot,dt,0),Dt=Ne.get(ot,dt,1),Ot=Ne.get(ot,dt,2),Rt=Ne.get(ot,dt,3);if(ht<255||Dt<255||Ot<255||Rt<255){var Zt=Ge-ot,er=Qe-dt,dr=Zt*Zt+er*er;dr<tt&&(tt=dr,rt=ot,nt=dt)}}return[rt,nt,tt]};function SelectResult(Ne,Ge,Qe,tt,rt){this.coord=[Ne,Ge],this.id=Qe,this.value=tt,this.distance=rt}function SelectBuffer(Ne,Ge,Qe){this.gl=Ne,this.fbo=Ge,this.buffer=Qe,this._readTimeout=null;var tt=this;this._readCallback=function(){tt.gl&&(Ge.bind(),Ne.readPixels(0,0,Ge.shape[0],Ge.shape[1],Ne.RGBA,Ne.UNSIGNED_BYTE,tt.buffer),tt._readTimeout=null)}}var it=SelectBuffer.prototype;function createSelectBuffer(Ne,Ge){var Qe=Ge[0],nt=Ge[1];return new SelectBuffer(Ne,tt(Ne,Qe,nt,{}),rt.mallocUint8(Qe*nt*4))}Object.defineProperty(it,"shape",{get:function(){return this.gl?this.fbo.shape.slice():[0,0]},set:function(Ne){if(this.gl){this.fbo.shape=Ne;var Ge=this.fbo.shape[0],Qe=this.fbo.shape[1];if(Qe*Ge*4>this.buffer.length){rt.free(this.buffer);for(var tt=this.buffer=rt.mallocUint8(at(Qe*Ge*4)),nt=0;nt<Qe*Ge*4;++nt)tt[nt]=255}return Ne}}}),it.begin=function(){var Ne=this.gl;this.shape,Ne&&(this.fbo.bind(),Ne.clearColor(1,1,1,1),Ne.clear(Ne.COLOR_BUFFER_BIT|Ne.DEPTH_BUFFER_BIT))},it.end=function(){var Ne=this.gl;Ne&&(Ne.bindFramebuffer(Ne.FRAMEBUFFER,null),this._readTimeout||clearTimeout(this._readTimeout),this._readTimeout=setTimeout(this._readCallback,1))},it.query=function(Ne,Ge,Qe){if(!this.gl)return null;var tt=this.fbo.shape.slice();Ne|=0,Ge|=0,"number"!=typeof Qe&&(Qe=1);var rt=0|Math.min(Math.max(Ne-Qe,0),tt[0]),at=0|Math.min(Math.max(Ne+Qe,0),tt[0]),it=0|Math.min(Math.max(Ge-Qe,0),tt[1]),ot=0|Math.min(Math.max(Ge+Qe,0),tt[1]);if(at<=rt||ot<=it)return null;var dt=[at-rt,ot-it],ht=nt(this.buffer,[dt[0],dt[1],4],[4,4*tt[0],1],4*(rt+tt[0]*it)),Dt=selectRange(ht.hi(dt[0],dt[1],1),Qe,Qe),Ot=Dt[0],Rt=Dt[1];return Ot<0||Math.pow(this.radius,2)<Dt[2]?null:new SelectResult(Ot+rt|0,Rt+it|0,ht.get(Ot,Rt,0),[ht.get(Ot,Rt,1),ht.get(Ot,Rt,2),ht.get(Ot,Rt,3)],Math.sqrt(Dt[2]))},it.dispose=function(){this.gl&&(this.fbo.dispose(),rt.free(this.buffer),this.gl=null,this._readTimeout&&clearTimeout(this._readTimeout))}},{"bit-twiddle":97,"gl-fbo":269,ndarray:495,"typedarray-pool":595}],335:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./lib/create-uniforms"),rt=Ne("./lib/create-attributes"),nt=Ne("./lib/reflect"),at=Ne("./lib/shader-cache"),it=Ne("./lib/runtime-reflect"),ot=Ne("./lib/GLError");function Shader(Ne){this.gl=Ne,this.gl.lastAttribCount=0,this._vref=this._fref=this._relink=this.vertShader=this.fragShader=this.program=this.attributes=this.uniforms=this.types=null}var dt=Shader.prototype;function compareAttributes(Ne,Ge){return Ne.name<Ge.name?-1:1}function createShader(Ne,Ge,Qe,tt,rt){var nt=new Shader(Ne);return nt.update(Ge,Qe,tt,rt),nt}dt.bind=function(){var Ne;this.program||this._relink();var Ge=this.gl.getProgramParameter(this.program,this.gl.ACTIVE_ATTRIBUTES),Qe=this.gl.lastAttribCount;if(Ge>Qe)for(Ne=Qe;Ne<Ge;Ne++)this.gl.enableVertexAttribArray(Ne);else if(Qe>Ge)for(Ne=Ge;Ne<Qe;Ne++)this.gl.disableVertexAttribArray(Ne);this.gl.lastAttribCount=Ge,this.gl.useProgram(this.program)},dt.dispose=function(){for(var Ne=this.gl.lastAttribCount,Ge=0;Ge<Ne;Ge++)this.gl.disableVertexAttribArray(Ge);this.gl.lastAttribCount=0,this._fref&&this._fref.dispose(),this._vref&&this._vref.dispose(),this.attributes=this.types=this.vertShader=this.fragShader=this.program=this._relink=this._fref=this._vref=null},dt.update=function(Ne,Ge,Qe,dt){if(!Ge||1===arguments.length){var ht=Ne;Ne=ht.vertex,Ge=ht.fragment,Qe=ht.uniforms,dt=ht.attributes}var Dt=this,Ot=Dt.gl,Rt=Dt._vref;Dt._vref=at.shader(Ot,Ot.VERTEX_SHADER,Ne),Rt&&Rt.dispose(),Dt.vertShader=Dt._vref.shader;var Zt=this._fref;if(Dt._fref=at.shader(Ot,Ot.FRAGMENT_SHADER,Ge),Zt&&Zt.dispose(),Dt.fragShader=Dt._fref.shader,!Qe||!dt){var er=Ot.createProgram();if(Ot.attachShader(er,Dt.fragShader),Ot.attachShader(er,Dt.vertShader),Ot.linkProgram(er),!Ot.getProgramParameter(er,Ot.LINK_STATUS)){var dr=Ot.getProgramInfoLog(er);throw new ot(dr,"Error linking program:"+dr)}Qe=Qe||it.uniforms(Ot,er),dt=dt||it.attributes(Ot,er),Ot.deleteProgram(er)}(dt=dt.slice()).sort(compareAttributes);var mr,xr=[],br=[],Ar=[];for(mr=0;mr<dt.length;++mr){var en=dt[mr];if(en.type.indexOf("mat")>=0){for(var mn=0|en.type.charAt(en.type.length-1),xn=new Array(mn),kn=0;kn<mn;++kn)xn[kn]=Ar.length,br.push(en.name+"["+kn+"]"),"number"==typeof en.location?Ar.push(en.location+kn):Array.isArray(en.location)&&en.location.length===mn&&"number"==typeof en.location[kn]?Ar.push(0|en.location[kn]):Ar.push(-1);xr.push({name:en.name,type:en.type,locations:xn})}else xr.push({name:en.name,type:en.type,locations:[Ar.length]}),br.push(en.name),"number"==typeof en.location?Ar.push(0|en.location):Ar.push(-1)}var Cn=0;for(mr=0;mr<Ar.length;++mr)if(Ar[mr]<0){for(;Ar.indexOf(Cn)>=0;)Cn+=1;Ar[mr]=Cn}var En=new Array(Qe.length);function relink(){Dt.program=at.program(Ot,Dt._vref,Dt._fref,br,Ar);for(var Ne=0;Ne<Qe.length;++Ne)En[Ne]=Ot.getUniformLocation(Dt.program,Qe[Ne].name)}relink(),Dt._relink=relink,Dt.types={uniforms:nt(Qe),attributes:nt(dt)},Dt.attributes=rt(Ot,Dt,xr,Ar),Object.defineProperty(Dt,"uniforms",tt(Ot,Dt,Qe,En))},Ge.exports=createShader},{"./lib/GLError":336,"./lib/create-attributes":337,"./lib/create-uniforms":338,"./lib/reflect":339,"./lib/runtime-reflect":340,"./lib/shader-cache":341}],336:[function(Ne,Ge,Qe){function GLError(Ne,Ge,Qe){this.shortMessage=Ge||"",this.longMessage=Qe||"",this.rawError=Ne||"",this.message="gl-shader: "+(Ge||Ne||"")+(Qe?"\n"+Qe:""),this.stack=(new Error).stack}GLError.prototype=new Error,GLError.prototype.name="GLError",GLError.prototype.constructor=GLError,Ge.exports=GLError},{}],337:[function(Ne,Ge,Qe){"use strict";Ge.exports=createAttributeWrapper;var tt=Ne("./GLError");function ShaderAttribute(Ne,Ge,Qe,tt,rt,nt){this._gl=Ne,this._wrapper=Ge,this._index=Qe,this._locations=tt,this._dimension=rt,this._constFunc=nt}var rt=ShaderAttribute.prototype;function addVectorAttribute(Ne,Ge,Qe,tt,rt,nt,at){for(var it=["gl","v"],ot=[],dt=0;dt<rt;++dt)it.push("x"+dt),ot.push("x"+dt);it.push("if(x0.length===void 0){return gl.vertexAttrib"+rt+"f(v,"+ot.join()+")}else{return gl.vertexAttrib"+rt+"fv(v,x0)}");var ht=Function.apply(null,it),Dt=new ShaderAttribute(Ne,Ge,Qe,tt,rt,ht);Object.defineProperty(nt,at,{set:function(Ge){return Ne.disableVertexAttribArray(tt[Qe]),ht(Ne,tt[Qe],Ge),Ge},get:function(){return Dt},enumerable:!0})}function addMatrixAttribute(Ne,Ge,Qe,tt,rt,nt,at){for(var it=new Array(rt),ot=new Array(rt),dt=0;dt<rt;++dt)addVectorAttribute(Ne,Ge,Qe[dt],tt,rt,it,dt),ot[dt]=it[dt];Object.defineProperty(it,"location",{set:function(Ne){if(Array.isArray(Ne))for(var Ge=0;Ge<rt;++Ge)ot[Ge].location=Ne[Ge];else for(Ge=0;Ge<rt;++Ge)ot[Ge].location=Ne+Ge;return Ne},get:function(){for(var Ne=new Array(rt),Ge=0;Ge<rt;++Ge)Ne[Ge]=tt[Qe[Ge]];return Ne},enumerable:!0}),it.pointer=function(Ge,nt,at,it){Ge=Ge||Ne.FLOAT,nt=!!nt,at=at||rt*rt,it=it||0;for(var ot=0;ot<rt;++ot){var dt=tt[Qe[ot]];Ne.vertexAttribPointer(dt,rt,Ge,nt,at,it+ot*rt),Ne.enableVertexAttribArray(dt)}};var ht=new Array(rt),Dt=Ne["vertexAttrib"+rt+"fv"];Object.defineProperty(nt,at,{set:function(Ge){for(var nt=0;nt<rt;++nt){var at=tt[Qe[nt]];if(Ne.disableVertexAttribArray(at),Array.isArray(Ge[0]))Dt.call(Ne,at,Ge[nt]);else{for(var it=0;it<rt;++it)ht[it]=Ge[rt*nt+it];Dt.call(Ne,at,ht)}}return Ge},get:function(){return it},enumerable:!0})}function createAttributeWrapper(Ne,Ge,Qe,rt){for(var nt={},at=0,it=Qe.length;at<it;++at){var ot=Qe[at],dt=ot.name,ht=ot.type,Dt=ot.locations;switch(ht){case"bool":case"int":case"float":addVectorAttribute(Ne,Ge,Dt[0],rt,1,nt,dt);break;default:if(ht.indexOf("vec")>=0){if((Ot=ht.charCodeAt(ht.length-1)-48)<2||Ot>4)throw new tt("","Invalid data type for attribute "+dt+": "+ht);addVectorAttribute(Ne,Ge,Dt[0],rt,Ot,nt,dt)}else{if(!(ht.indexOf("mat")>=0))throw new tt("","Unknown data type for attribute "+dt+": "+ht);var Ot;if((Ot=ht.charCodeAt(ht.length-1)-48)<2||Ot>4)throw new tt("","Invalid data type for attribute "+dt+": "+ht);addMatrixAttribute(Ne,Ge,Dt,rt,Ot,nt,dt)}}}return nt}rt.pointer=function(Ne,Ge,Qe,tt){var rt=this,nt=rt._gl,at=rt._locations[rt._index];nt.vertexAttribPointer(at,rt._dimension,Ne||nt.FLOAT,!!Ge,Qe||0,tt||0),nt.enableVertexAttribArray(at)},rt.set=function(Ne,Ge,Qe,tt){return this._constFunc(this._locations[this._index],Ne,Ge,Qe,tt)},Object.defineProperty(rt,"location",{get:function(){return this._locations[this._index]},set:function(Ne){return Ne!==this._locations[this._index]&&(this._locations[this._index]=0|Ne,this._wrapper.program=null),0|Ne}})},{"./GLError":336}],338:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./reflect"),rt=Ne("./GLError");function identity(Ne){return new Function("y","return function(){return y}")(Ne)}function makeVector(Ne,Ge){for(var Qe=new Array(Ne),tt=0;tt<Ne;++tt)Qe[tt]=Ge;return Qe}function createUniformWrapper(Ne,Ge,Qe,nt){function makeGetter(Qe){return new Function("gl","wrapper","locations","return function(){return gl.getUniform(wrapper.program,locations["+Qe+"])}")(Ne,Ge,nt)}function makePropSetter(Ne,Ge,Qe){switch(Qe){case"bool":case"int":case"sampler2D":case"samplerCube":return"gl.uniform1i(locations["+Ge+"],obj"+Ne+")";case"float":return"gl.uniform1f(locations["+Ge+"],obj"+Ne+")";default:var tt=Qe.indexOf("vec");if(!(0<=tt&&tt<=1&&Qe.length===4+tt)){if(0===Qe.indexOf("mat")&&4===Qe.length){var nt;if((nt=Qe.charCodeAt(Qe.length-1)-48)<2||nt>4)throw new rt("","Invalid uniform dimension type for matrix "+name+": "+Qe);return"gl.uniformMatrix"+nt+"fv(locations["+Ge+"],false,obj"+Ne+")"}throw new rt("","Unknown uniform data type for "+name+": "+Qe)}if((nt=Qe.charCodeAt(Qe.length-1)-48)<2||nt>4)throw new rt("","Invalid data type");switch(Qe.charAt(0)){case"b":case"i":return"gl.uniform"+nt+"iv(locations["+Ge+"],obj"+Ne+")";case"v":return"gl.uniform"+nt+"fv(locations["+Ge+"],obj"+Ne+")";default:throw new rt("","Unrecognized data type for vector "+name+": "+Qe)}}}function enumerateIndices(Ne,Ge){if("object"!=typeof Ge)return[[Ne,Ge]];var Qe=[];for(var tt in Ge){var rt=Ge[tt],nt=Ne;parseInt(tt)+""===tt?nt+="["+tt+"]":nt+="."+tt,"object"==typeof rt?Qe.push.apply(Qe,enumerateIndices(nt,rt)):Qe.push([nt,rt])}return Qe}function makeSetter(Ge){for(var tt=["return function updateProperty(obj){"],rt=enumerateIndices("",Ge),at=0;at<rt.length;++at){var it=rt[at],ot=it[0],dt=it[1];nt[dt]&&tt.push(makePropSetter(ot,dt,Qe[dt].type))}return tt.push("return obj}"),new Function("gl","locations",tt.join("\n"))(Ne,nt)}function defaultValue(Ne){switch(Ne){case"bool":return!1;case"int":case"sampler2D":case"samplerCube":case"float":return 0;default:var Ge=Ne.indexOf("vec");if(0<=Ge&&Ge<=1&&Ne.length===4+Ge){if((Qe=Ne.charCodeAt(Ne.length-1)-48)<2||Qe>4)throw new rt("","Invalid data type");return"b"===Ne.charAt(0)?makeVector(Qe,!1):makeVector(Qe,0)}if(0===Ne.indexOf("mat")&&4===Ne.length){var Qe;if((Qe=Ne.charCodeAt(Ne.length-1)-48)<2||Qe>4)throw new rt("","Invalid uniform dimension type for matrix "+name+": "+Ne);return makeVector(Qe*Qe,0)}throw new rt("","Unknown uniform data type for "+name+": "+Ne)}}function storeProperty(Ne,Ge,tt){if("object"==typeof tt){var rt=processObject(tt);Object.defineProperty(Ne,Ge,{get:identity(rt),set:makeSetter(tt),enumerable:!0,configurable:!1})}else nt[tt]?Object.defineProperty(Ne,Ge,{get:makeGetter(tt),set:makeSetter(tt),enumerable:!0,configurable:!1}):Ne[Ge]=defaultValue(Qe[tt].type)}function processObject(Ne){var Ge;if(Array.isArray(Ne)){Ge=new Array(Ne.length);for(var Qe=0;Qe<Ne.length;++Qe)storeProperty(Ge,Qe,Ne[Qe])}else for(var tt in Ge={},Ne)storeProperty(Ge,tt,Ne[tt]);return Ge}var at=tt(Qe,!0);return{get:identity(processObject(at)),set:makeSetter(at),enumerable:!0,configurable:!0}}Ge.exports=createUniformWrapper},{"./GLError":336,"./reflect":339}],339:[function(Ne,Ge,Qe){"use strict";function makeReflectTypes(Ne,Ge){for(var Qe={},tt=0;tt<Ne.length;++tt)for(var rt=Ne[tt].name.split("."),nt=Qe,at=0;at<rt.length;++at){var it=rt[at].split("[");if(it.length>1){it[0]in nt||(nt[it[0]]=[]),nt=nt[it[0]];for(var ot=1;ot<it.length;++ot){var dt=parseInt(it[ot]);ot<it.length-1||at<rt.length-1?(dt in nt||(ot<it.length-1?nt[dt]=[]:nt[dt]={}),nt=nt[dt]):nt[dt]=Ge?tt:Ne[tt].type}}else at<rt.length-1?(it[0]in nt||(nt[it[0]]={}),nt=nt[it[0]]):nt[it[0]]=Ge?tt:Ne[tt].type}return Qe}Ge.exports=makeReflectTypes},{}],340:[function(Ne,Ge,Qe){"use strict";Qe.uniforms=runtimeUniforms,Qe.attributes=runtimeAttributes;var tt={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube"},rt=null;function getType(Ne,Ge){if(!rt){var Qe=Object.keys(tt);rt={};for(var nt=0;nt<Qe.length;++nt){var at=Qe[nt];rt[Ne[at]]=tt[at]}}return rt[Ge]}function runtimeUniforms(Ne,Ge){for(var Qe=Ne.getProgramParameter(Ge,Ne.ACTIVE_UNIFORMS),tt=[],rt=0;rt<Qe;++rt){var nt=Ne.getActiveUniform(Ge,rt);if(nt){var at=getType(Ne,nt.type);if(nt.size>1)for(var it=0;it<nt.size;++it)tt.push({name:nt.name.replace("[0]","["+it+"]"),type:at});else tt.push({name:nt.name,type:at})}}return tt}function runtimeAttributes(Ne,Ge){for(var Qe=Ne.getProgramParameter(Ge,Ne.ACTIVE_ATTRIBUTES),tt=[],rt=0;rt<Qe;++rt){var nt=Ne.getActiveAttrib(Ge,rt);nt&&tt.push({name:nt.name,type:getType(Ne,nt.type)})}return tt}},{}],341:[function(Ne,Ge,Qe){"use strict";Qe.shader=getShaderReference,Qe.program=createProgram;var tt=Ne("./GLError"),rt=Ne("gl-format-compiler-error"),nt=new("undefined"==typeof WeakMap?Ne("weakmap-shim"):WeakMap),at=0;function ShaderReference(Ne,Ge,Qe,tt,rt,nt,at){this.id=Ne,this.src=Ge,this.type=Qe,this.shader=tt,this.count=nt,this.programs=[],this.cache=at}function ContextCache(Ne){this.gl=Ne,this.shaders=[{},{}],this.programs={}}ShaderReference.prototype.dispose=function(){if(0==--this.count){for(var Ne=this.cache,Ge=Ne.gl,Qe=this.programs,tt=0,rt=Qe.length;tt<rt;++tt){var nt=Ne.programs[Qe[tt]];nt&&(delete Ne.programs[tt],Ge.deleteProgram(nt))}Ge.deleteShader(this.shader),delete Ne.shaders[this.type===Ge.FRAGMENT_SHADER|0][this.src]}};var it=ContextCache.prototype;function compileShader(Ne,Ge,Qe){var nt=Ne.createShader(Ge);if(Ne.shaderSource(nt,Qe),Ne.compileShader(nt),!Ne.getShaderParameter(nt,Ne.COMPILE_STATUS)){var at=Ne.getShaderInfoLog(nt);try{var it=rt(at,Qe,Ge)}catch(Ne){throw console.warn("Failed to format compiler error: "+Ne),new tt(at,"Error compiling shader:\n"+at)}throw new tt(at,it.short,it.long)}return nt}function linkProgram(Ne,Ge,Qe,rt,nt){var at=Ne.createProgram();Ne.attachShader(at,Ge),Ne.attachShader(at,Qe);for(var it=0;it<rt.length;++it)Ne.bindAttribLocation(at,nt[it],rt[it]);if(Ne.linkProgram(at),!Ne.getProgramParameter(at,Ne.LINK_STATUS)){var ot=Ne.getProgramInfoLog(at);throw new tt(ot,"Error linking program: "+ot)}return at}function getCache(Ne){var Ge=nt.get(Ne);return Ge||(Ge=new ContextCache(Ne),nt.set(Ne,Ge)),Ge}function getShaderReference(Ne,Ge,Qe){return getCache(Ne).getShaderReference(Ge,Qe)}function createProgram(Ne,Ge,Qe,tt,rt){return getCache(Ne).getProgram(Ge,Qe,tt,rt)}it.getShaderReference=function(Ne,Ge){var Qe=this.gl,tt=this.shaders[Ne===Qe.FRAGMENT_SHADER|0],rt=tt[Ge];if(rt&&Qe.isShader(rt.shader))rt.count+=1;else{var nt=compileShader(Qe,Ne,Ge);rt=tt[Ge]=new ShaderReference(at++,Ge,Ne,nt,[],1,this)}return rt},it.getProgram=function(Ne,Ge,Qe,tt){var rt=[Ne.id,Ge.id,Qe.join(":"),tt.join(":")].join("@"),nt=this.programs[rt];return nt&&this.gl.isProgram(nt)||(this.programs[rt]=nt=linkProgram(this.gl,Ne.shader,Ge.shader,Qe,tt),Ne.programs.push(rt),Ge.programs.push(rt)),nt}},{"./GLError":336,"gl-format-compiler-error":270,"weakmap-shim":605}],342:[function(Ne,Ge,Qe){"use strict";function GLSpikes2D(Ne){this.plot=Ne,this.enable=[!0,!0,!1,!1],this.width=[1,1,1,1],this.color=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.center=[1/0,1/0]}Ge.exports=createSpikes2D;var tt=GLSpikes2D.prototype;function createSpikes2D(Ne,Ge){var Qe=new GLSpikes2D(Ne);return Qe.update(Ge),Ne.addOverlay(Qe),Qe}tt.update=function(Ne){Ne=Ne||{},this.enable=(Ne.enable||[!0,!0,!1,!1]).slice(),this.width=(Ne.width||[1,1,1,1]).slice(),this.color=(Ne.color||[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]]).map((function(Ne){return Ne.slice()})),this.center=(Ne.center||[1/0,1/0]).slice(),this.plot.setOverlayDirty()},tt.draw=function(){var Ne=this.enable,Ge=this.width,Qe=this.color,tt=this.center,rt=this.plot,nt=rt.line,at=rt.dataBox,it=rt.viewBox;if(nt.bind(),at[0]<=tt[0]&&tt[0]<=at[2]&&at[1]<=tt[1]&&tt[1]<=at[3]){var ot=it[0]+(tt[0]-at[0])/(at[2]-at[0])*(it[2]-it[0]),dt=it[1]+(tt[1]-at[1])/(at[3]-at[1])*(it[3]-it[1]);Ne[0]&&nt.drawLine(ot,dt,it[0],dt,Ge[0],Qe[0]),Ne[1]&&nt.drawLine(ot,dt,ot,it[1],Ge[1],Qe[1]),Ne[2]&&nt.drawLine(ot,dt,it[2],dt,Ge[2],Qe[2]),Ne[3]&&nt.drawLine(ot,dt,ot,it[3],Ge[3],Qe[3])}},tt.dispose=function(){this.plot.removeOverlay(this)}},{}],343:[function(Ne,Ge,Qe){arguments[4][257][0].apply(Qe,arguments)},{dup:257}],344:[function(Ne,Ge,Qe){"use strict";var tt=Ne("glslify"),rt=Ne("gl-shader"),nt=tt(["precision mediump float;\n#define GLSLIFY 1\n\nattribute vec3 position, color;\nattribute float weight;\n\nuniform mat4 model, view, projection;\nuniform vec3 coordinates[3];\nuniform vec4 colors[3];\nuniform vec2 screenShape;\nuniform float lineWidth;\n\nvarying vec4 fragColor;\n\nvoid main() {\n  vec3 vertexPosition = mix(coordinates[0],\n    mix(coordinates[2], coordinates[1], 0.5 * (position + 1.0)), abs(position));\n\n  vec4 clipPos = projection * view * model * vec4(vertexPosition, 1.0);\n  vec2 clipOffset = (projection * view * model * vec4(color, 0.0)).xy;\n  vec2 delta = weight * clipOffset * screenShape;\n  vec2 lineOffset = normalize(vec2(delta.y, -delta.x)) / screenShape;\n\n  gl_Position   = vec4(clipPos.xy + clipPos.w * 0.5 * lineWidth * lineOffset, clipPos.z, clipPos.w);\n  fragColor     = color.x * colors[0] + color.y * colors[1] + color.z * colors[2];\n}\n"]),at=tt(["precision mediump float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n  gl_FragColor = fragColor;\n}"]);Ge.exports=function(Ne){return rt(Ne,nt,at,null,[{name:"position",type:"vec3"},{name:"color",type:"vec3"},{name:"weight",type:"float"}])}},{"gl-shader":335,glslify:343}],345:[function(Ne,Ge,Qe){"use strict";var tt=Ne("gl-buffer"),rt=Ne("gl-vao"),nt=Ne("./shaders/index");Ge.exports=createSpikes;var at=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];function AxisSpikes(Ne,Ge,Qe,tt){this.gl=Ne,this.buffer=Ge,this.vao=Qe,this.shader=tt,this.pixelRatio=1,this.bounds=[[-1e3,-1e3,-1e3],[1e3,1e3,1e3]],this.position=[0,0,0],this.lineWidth=[2,2,2],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.enabled=[!0,!0,!0],this.drawSides=[!0,!0,!0],this.axes=null}var it=AxisSpikes.prototype,ot=[0,0,0],dt=[0,0,0],ht=[0,0];function createSpikes(Ne,Ge){var Qe=[];function line(Ne,Ge,tt,rt,nt,at){var it=[Ne,Ge,tt,0,0,0,1];it[rt+3]=1,it[rt]=nt,Qe.push.apply(Qe,it),it[6]=-1,Qe.push.apply(Qe,it),it[rt]=at,Qe.push.apply(Qe,it),Qe.push.apply(Qe,it),it[6]=1,Qe.push.apply(Qe,it),it[rt]=nt,Qe.push.apply(Qe,it)}line(0,0,0,0,0,1),line(0,0,0,1,0,1),line(0,0,0,2,0,1),line(1,0,0,1,-1,1),line(1,0,0,2,-1,1),line(0,1,0,0,-1,1),line(0,1,0,2,-1,1),line(0,0,1,0,-1,1),line(0,0,1,1,-1,1);var at=tt(Ne,Qe),it=rt(Ne,[{type:Ne.FLOAT,buffer:at,size:3,offset:0,stride:28},{type:Ne.FLOAT,buffer:at,size:3,offset:12,stride:28},{type:Ne.FLOAT,buffer:at,size:1,offset:24,stride:28}]),ot=nt(Ne);ot.attributes.position.location=0,ot.attributes.color.location=1,ot.attributes.weight.location=2;var dt=new AxisSpikes(Ne,at,it,ot);return dt.update(Ge),dt}it.isTransparent=function(){return!1},it.drawTransparent=function(Ne){},it.draw=function(Ne){var Ge=this.gl,Qe=this.vao,tt=this.shader;Qe.bind(),tt.bind();var rt,nt=Ne.model||at,it=Ne.view||at,Dt=Ne.projection||at;this.axes&&(rt=this.axes.lastCubeProps.axis);for(var Ot=ot,Rt=dt,Zt=0;Zt<3;++Zt)rt&&rt[Zt]<0?(Ot[Zt]=this.bounds[0][Zt],Rt[Zt]=this.bounds[1][Zt]):(Ot[Zt]=this.bounds[1][Zt],Rt[Zt]=this.bounds[0][Zt]);for(ht[0]=Ge.drawingBufferWidth,ht[1]=Ge.drawingBufferHeight,tt.uniforms.model=nt,tt.uniforms.view=it,tt.uniforms.projection=Dt,tt.uniforms.coordinates=[this.position,Ot,Rt],tt.uniforms.colors=this.colors,tt.uniforms.screenShape=ht,Zt=0;Zt<3;++Zt)tt.uniforms.lineWidth=this.lineWidth[Zt]*this.pixelRatio,this.enabled[Zt]&&(Qe.draw(Ge.TRIANGLES,6,6*Zt),this.drawSides[Zt]&&Qe.draw(Ge.TRIANGLES,12,18+12*Zt));Qe.unbind()},it.update=function(Ne){Ne&&("bounds"in Ne&&(this.bounds=Ne.bounds),"position"in Ne&&(this.position=Ne.position),"lineWidth"in Ne&&(this.lineWidth=Ne.lineWidth),"colors"in Ne&&(this.colors=Ne.colors),"enabled"in Ne&&(this.enabled=Ne.enabled),"drawSides"in Ne&&(this.drawSides=Ne.drawSides))},it.dispose=function(){this.vao.dispose(),this.buffer.dispose(),this.shader.dispose()}},{"./shaders/index":344,"gl-buffer":259,"gl-vao":358}],346:[function(Ne,Ge,Qe){var tt=Ne("glslify"),rt=tt(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 color, position;\nattribute vec2 uv;\n\nuniform float vectorScale, tubeScale;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 eyePosition, lightPosition;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  // Scale the vector magnitude to stay constant with\n  // model & view changes.\n  vec3 normal;\n  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * tubePosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  f_lightDirection = lightPosition - cameraCoordinate.xyz;\n  f_eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  f_normal = normalize((vec4(normal, 0.0) * inverseModel).xyz);\n\n  // vec4 m_position  = model * vec4(tubePosition, 1.0);\n  vec4 t_position  = view * tubePosition;\n  gl_Position      = projection * t_position;\n\n  f_color          = color;\n  f_data           = tubePosition.xyz;\n  f_position       = position.xyz;\n  f_uv             = uv;\n}\n"]),nt=tt(["#extension GL_OES_standard_derivatives : enable\n\nprecision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat cookTorranceSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness,\n  float fresnel) {\n\n  float VdotN = max(dot(viewDirection, surfaceNormal), 0.0);\n  float LdotN = max(dot(lightDirection, surfaceNormal), 0.0);\n\n  //Half angle vector\n  vec3 H = normalize(lightDirection + viewDirection);\n\n  //Geometric term\n  float NdotH = max(dot(surfaceNormal, H), 0.0);\n  float VdotH = max(dot(viewDirection, H), 0.000001);\n  float LdotH = max(dot(lightDirection, H), 0.000001);\n  float G1 = (2.0 * NdotH * VdotN) / VdotH;\n  float G2 = (2.0 * NdotH * LdotN) / LdotH;\n  float G = min(1.0, min(G1, G2));\n  \n  //Distribution term\n  float D = beckmannDistribution(NdotH, roughness);\n\n  //Fresnel term\n  float F = pow(1.0 - VdotN, fresnel);\n\n  //Multiply terms and done\n  return  G * F * D / max(3.14159265 * VdotN, 0.000001);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform sampler2D texture;\n\nvarying vec3 f_normal, f_lightDirection, f_eyeDirection, f_data, f_position;\nvarying vec4 f_color;\nvarying vec2 f_uv;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n  vec3 N = normalize(f_normal);\n  vec3 L = normalize(f_lightDirection);\n  vec3 V = normalize(f_eyeDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = min(1.0, max(0.0, cookTorranceSpecular(L, V, N, roughness, fresnel)));\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  vec4 surfaceColor = f_color * texture2D(texture, f_uv);\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = litColor * opacity;\n}\n"]),at=tt(["precision highp float;\n\nprecision highp float;\n#define GLSLIFY 1\n\nvec3 getOrthogonalVector(vec3 v) {\n  // Return up-vector for only-z vector.\n  // Return ax + by + cz = 0, a point that lies on the plane that has v as a normal and that isn't (0,0,0).\n  // From the above if-statement we have ||a|| > 0  U  ||b|| > 0.\n  // Assign z = 0, x = -b, y = a:\n  // a*-b + b*a + c*0 = -ba + ba + 0 = 0\n  if (v.x*v.x > v.z*v.z || v.y*v.y > v.z*v.z) {\n    return normalize(vec3(-v.y, v.x, 0.0));\n  } else {\n    return normalize(vec3(0.0, v.z, -v.y));\n  }\n}\n\n// Calculate the tube vertex and normal at the given index.\n//\n// The returned vertex is for a tube ring with its center at origin, radius of length(d), pointing in the direction of d.\n//\n// Each tube segment is made up of a ring of vertices.\n// These vertices are used to make up the triangles of the tube by connecting them together in the vertex array.\n// The indexes of tube segments run from 0 to 8.\n//\nvec3 getTubePosition(vec3 d, float index, out vec3 normal) {\n  float segmentCount = 8.0;\n\n  float angle = 2.0 * 3.14159 * (index / segmentCount);\n\n  vec3 u = getOrthogonalVector(d);\n  vec3 v = normalize(cross(u, d));\n\n  vec3 x = u * cos(angle) * length(d);\n  vec3 y = v * sin(angle) * length(d);\n  vec3 v3 = x + y;\n\n  normal = normalize(v3);\n\n  return v3;\n}\n\nattribute vec4 vector;\nattribute vec4 position;\nattribute vec4 id;\n\nuniform mat4 model, view, projection;\nuniform float tubeScale;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  vec3 normal;\n  vec3 XYZ = getTubePosition(mat3(model) * (tubeScale * vector.w * normalize(vector.xyz)), position.w, normal);\n  vec4 tubePosition = model * vec4(position.xyz, 1.0) + vec4(XYZ, 0.0);\n\n  gl_Position = projection * view * tubePosition;\n  f_id        = id;\n  f_position  = position.xyz;\n}\n"]),it=tt(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3  clipBounds[2];\nuniform float pickId;\n\nvarying vec3 f_position;\nvarying vec4 f_id;\n\nvoid main() {\n  if (outOfRange(clipBounds[0], clipBounds[1], f_position)) discard;\n\n  gl_FragColor = vec4(pickId, f_id.xyz);\n}"]);Qe.meshShader={vertex:rt,fragment:nt,attributes:[{name:"position",type:"vec4"},{name:"color",type:"vec4"},{name:"uv",type:"vec2"},{name:"vector",type:"vec4"}]},Qe.pickShader={vertex:at,fragment:it,attributes:[{name:"position",type:"vec4"},{name:"id",type:"vec4"},{name:"vector",type:"vec4"}]}},{glslify:347}],347:[function(Ne,Ge,Qe){arguments[4][257][0].apply(Qe,arguments)},{dup:257}],348:[function(Ne,Ge,Qe){"use strict";var tt=Ne("gl-vec3"),rt=Ne("gl-vec4"),nt=["xyz","xzy","yxz","yzx","zxy","zyx"],streamToTube=function(Ne,Ge,Qe,nt){for(var at=Ne.points,it=Ne.velocities,ot=Ne.divergences,dt=[],ht=[],Dt=[],Ot=[],Rt=[],Zt=[],er=0,dr=0,mr=rt.create(),xr=rt.create(),br=8,Ar=0;Ar<at.length;Ar++){var en=at[Ar],mn=it[Ar],xn=ot[Ar];0===Ge&&(xn=.05*Qe),dr=tt.length(mn)/nt,mr=rt.create(),tt.copy(mr,mn),mr[3]=xn;for(var kn=0;kn<br;kn++)Rt[kn]=[en[0],en[1],en[2],kn];if(Ot.length>0)for(kn=0;kn<br;kn++){var Cn=(kn+1)%br;dt.push(Ot[kn],Rt[kn],Rt[Cn],Rt[Cn],Ot[Cn],Ot[kn]),Dt.push(xr,mr,mr,mr,xr,xr),Zt.push(er,dr,dr,dr,er,er);var En=dt.length;ht.push([En-6,En-5,En-4],[En-3,En-2,En-1])}var Pn=Ot;Ot=Rt,Rt=Pn;var Dn=xr;xr=mr,mr=Dn;var In=er;er=dr,dr=In}return{positions:dt,cells:ht,vectors:Dt,vertexIntensity:Zt}},createTubes=function(Ne,Ge,Qe,rt){for(var nt=0,at=0;at<Ne.length;at++)for(var it=Ne[at].velocities,ot=0;ot<it.length;ot++)nt=Math.max(nt,tt.length(it[ot]));var dt=Ne.map((function(Ne){return streamToTube(Ne,Qe,rt,nt)})),ht=[],Dt=[],Ot=[],Rt=[];for(at=0;at<dt.length;at++){var Zt=dt[at],er=ht.length;for(ht=ht.concat(Zt.positions),Ot=Ot.concat(Zt.vectors),Rt=Rt.concat(Zt.vertexIntensity),ot=0;ot<Zt.cells.length;ot++){var dr=Zt.cells[ot],mr=[];Dt.push(mr);for(var xr=0;xr<dr.length;xr++)mr.push(dr[xr]+er)}}return{positions:ht,cells:Dt,vectors:Ot,vertexIntensity:Rt,colormap:Ge}},findLastSmallerIndex=function(Ne,Ge){var Qe,tt=Ne.length;for(Qe=0;Qe<tt;Qe++){var rt=Ne[Qe];if(rt===Ge)return Qe;if(rt>Ge)return Qe-1}return Qe},clamp=function(Ne,Ge,Qe){return Ne<Ge?Ge:Ne>Qe?Qe:Ne},sampleMeshgrid=function(Ne,Ge,Qe){var rt=Ge.vectors,nt=Ge.meshgrid,at=Ne[0],it=Ne[1],ot=Ne[2],dt=nt[0].length,ht=nt[1].length,Dt=nt[2].length,Ot=findLastSmallerIndex(nt[0],at),Rt=findLastSmallerIndex(nt[1],it),Zt=findLastSmallerIndex(nt[2],ot),er=Ot+1,dr=Rt+1,mr=Zt+1;if(Ot=clamp(Ot,0,dt-1),er=clamp(er,0,dt-1),Rt=clamp(Rt,0,ht-1),dr=clamp(dr,0,ht-1),Zt=clamp(Zt,0,Dt-1),mr=clamp(mr,0,Dt-1),Ot<0||Rt<0||Zt<0||er>dt-1||dr>ht-1||mr>Dt-1)return tt.create();var xr,br,Ar,en,mn,xn,kn=nt[0][Ot],Cn=nt[0][er],En=nt[1][Rt],Pn=nt[1][dr],Dn=nt[2][Zt],In=(at-kn)/(Cn-kn),zn=(it-En)/(Pn-En),Bn=(ot-Dn)/(nt[2][mr]-Dn);switch(isFinite(In)||(In=.5),isFinite(zn)||(zn=.5),isFinite(Bn)||(Bn=.5),Qe.reversedX&&(Ot=dt-1-Ot,er=dt-1-er),Qe.reversedY&&(Rt=ht-1-Rt,dr=ht-1-dr),Qe.reversedZ&&(Zt=Dt-1-Zt,mr=Dt-1-mr),Qe.filled){case 5:mn=Zt,xn=mr,Ar=Rt*Dt,en=dr*Dt,xr=Ot*Dt*ht,br=er*Dt*ht;break;case 4:mn=Zt,xn=mr,xr=Ot*Dt,br=er*Dt,Ar=Rt*Dt*dt,en=dr*Dt*dt;break;case 3:Ar=Rt,en=dr,mn=Zt*ht,xn=mr*ht,xr=Ot*ht*Dt,br=er*ht*Dt;break;case 2:Ar=Rt,en=dr,xr=Ot*ht,br=er*ht,mn=Zt*ht*dt,xn=mr*ht*dt;break;case 1:xr=Ot,br=er,mn=Zt*dt,xn=mr*dt,Ar=Rt*dt*Dt,en=dr*dt*Dt;break;default:xr=Ot,br=er,Ar=Rt*dt,en=dr*dt,mn=Zt*dt*ht,xn=mr*dt*ht}var Vn=rt[xr+Ar+mn],Hn=rt[xr+Ar+xn],qn=rt[xr+en+mn],Yn=rt[xr+en+xn],$n=rt[br+Ar+mn],ra=rt[br+Ar+xn],oa=rt[br+en+mn],pa=rt[br+en+xn],ga=tt.create(),ma=tt.create(),_a=tt.create(),Va=tt.create();tt.lerp(ga,Vn,$n,In),tt.lerp(ma,Hn,ra,In),tt.lerp(_a,qn,oa,In),tt.lerp(Va,Yn,pa,In);var Wa=tt.create(),Qa=tt.create();tt.lerp(Wa,ga,_a,zn),tt.lerp(Qa,ma,Va,zn);var ti=tt.create();return tt.lerp(ti,Wa,Qa,Bn),ti},findMinSeparation=function(Ne){var Ge=1/0;Ne.sort((function(Ne,Ge){return Ne-Ge}));for(var Qe=Ne.length,tt=1;tt<Qe;tt++){var rt=Math.abs(Ne[tt]-Ne[tt-1]);rt<Ge&&(Ge=rt)}return Ge},calculateMinPositionDistance=function(Ne){for(var Ge=[],Qe=[],tt=[],rt={},nt={},at={},it=Ne.length,ot=0;ot<it;ot++){var dt=Ne[ot],ht=dt[0],Dt=dt[1],Ot=dt[2];rt[ht]||(Ge.push(ht),rt[ht]=!0),nt[Dt]||(Qe.push(Dt),nt[Dt]=!0),at[Ot]||(tt.push(Ot),at[Ot]=!0)}var Rt=findMinSeparation(Ge),Zt=findMinSeparation(Qe),er=findMinSeparation(tt),dr=Math.min(Rt,Zt,er);return isFinite(dr)?dr:1};Ge.exports=function(Ne,Ge){var Qe=Ne.startingPositions,rt=Ne.maxLength||1e3,at=Ne.tubeSize||1,it=Ne.absoluteTubeSize,ot=Ne.gridFill||"+x+y+z",dt={};-1!==ot.indexOf("-x")&&(dt.reversedX=!0),-1!==ot.indexOf("-y")&&(dt.reversedY=!0),-1!==ot.indexOf("-z")&&(dt.reversedZ=!0),dt.filled=nt.indexOf(ot.replace(/-/g,"").replace(/\+/g,""));var ht=Ne.getVelocity||function(Ge){return sampleMeshgrid(Ge,Ne,dt)},Dt=Ne.getDivergence||function(Ne,Ge){var Qe=tt.create(),rt=1e-4;tt.add(Qe,Ne,[rt,0,0]);var nt=ht(Qe);tt.subtract(nt,nt,Ge),tt.scale(nt,nt,1/rt),tt.add(Qe,Ne,[0,rt,0]);var at=ht(Qe);tt.subtract(at,at,Ge),tt.scale(at,at,1/rt),tt.add(Qe,Ne,[0,0,rt]);var it=ht(Qe);return tt.subtract(it,it,Ge),tt.scale(it,it,1/rt),tt.add(Qe,nt,at),tt.add(Qe,Qe,it),Qe},Ot=[],Rt=Ge[0][0],Zt=Ge[0][1],er=Ge[0][2],dr=Ge[1][0],mr=Ge[1][1],xr=Ge[1][2],inBounds=function(Ne){var Ge=Ne[0],Qe=Ne[1],tt=Ne[2];return!(Ge<Rt||Ge>dr||Qe<Zt||Qe>mr||tt<er||tt>xr)},br=10*tt.distance(Ge[0],Ge[1])/rt,Ar=br*br,en=1,mn=0,xn=Qe.length;xn>1&&(en=calculateMinPositionDistance(Qe));for(var kn=0;kn<xn;kn++){var Cn=tt.create();tt.copy(Cn,Qe[kn]);var En=[Cn],Pn=[],Dn=ht(Cn),In=Cn;Pn.push(Dn);var zn=[],Bn=Dt(Cn,Dn),Vn=tt.length(Bn);isFinite(Vn)&&Vn>mn&&(mn=Vn),zn.push(Vn),Ot.push({points:En,velocities:Pn,divergences:zn});for(var Hn=0;Hn<100*rt&&En.length<rt&&inBounds(Cn);){Hn++;var qn=tt.clone(Dn),Yn=tt.squaredLength(qn);if(0===Yn)break;Yn>Ar&&tt.scale(qn,qn,br/Math.sqrt(Yn)),tt.add(qn,qn,Cn),Dn=ht(qn),tt.squaredDistance(In,qn)-Ar>-1e-4*Ar&&(En.push(qn),In=qn,Pn.push(Dn),Bn=Dt(qn,Dn),Vn=tt.length(Bn),isFinite(Vn)&&Vn>mn&&(mn=Vn),zn.push(Vn)),Cn=qn}}var $n=createTubes(Ot,Ne.colormap,mn,en);return it?$n.tubeScale=it:(0===mn&&(mn=1),$n.tubeScale=.5*at*en/mn),$n};var at=Ne("./lib/shaders"),it=Ne("gl-cone3d").createMesh;Ge.exports.createTubeMesh=function(Ne,Ge){return it(Ne,Ge,{shaders:at,traceType:"streamtube"})}},{"./lib/shaders":346,"gl-cone3d":260,"gl-vec3":377,"gl-vec4":413}],349:[function(Ne,Ge,Qe){var tt=Ne("gl-shader"),rt=Ne("glslify"),nt=rt(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute vec3 f;\nattribute vec3 normal;\n\nuniform vec3 objectOffset;\nuniform mat4 model, view, projection, inverseModel;\nuniform vec3 lightPosition, eyePosition;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 localCoordinate = vec3(uv.zw, f.x);\n  worldCoordinate = objectOffset + localCoordinate;\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n  vec4 clipPosition = projection * view * worldPosition;\n  gl_Position = clipPosition;\n  kill = f.y;\n  value = f.z;\n  planeCoordinate = uv.xy;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Lighting geometry parameters\n  vec4 cameraCoordinate = view * worldPosition;\n  cameraCoordinate.xyz /= cameraCoordinate.w;\n  lightDirection = lightPosition - cameraCoordinate.xyz;\n  eyeDirection   = eyePosition - cameraCoordinate.xyz;\n  surfaceNormal  = normalize((vec4(normal,0) * inverseModel).xyz);\n}\n"]),at=rt(["precision highp float;\n#define GLSLIFY 1\n\nfloat beckmannDistribution(float x, float roughness) {\n  float NdotH = max(x, 0.0001);\n  float cos2Alpha = NdotH * NdotH;\n  float tan2Alpha = (cos2Alpha - 1.0) / cos2Alpha;\n  float roughness2 = roughness * roughness;\n  float denom = 3.141592653589793 * roughness2 * cos2Alpha * cos2Alpha;\n  return exp(tan2Alpha / roughness2) / denom;\n}\n\nfloat beckmannSpecular(\n  vec3 lightDirection,\n  vec3 viewDirection,\n  vec3 surfaceNormal,\n  float roughness) {\n  return beckmannDistribution(dot(surfaceNormal, normalize(lightDirection + viewDirection)), roughness);\n}\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec3 lowerBound, upperBound;\nuniform float contourTint;\nuniform vec4 contourColor;\nuniform sampler2D colormap;\nuniform vec3 clipBounds[2];\nuniform float roughness, fresnel, kambient, kdiffuse, kspecular, opacity;\nuniform float vertexColor;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  if (\n    kill > 0.0 ||\n    vColor.a == 0.0 ||\n    outOfRange(clipBounds[0], clipBounds[1], worldCoordinate)\n  ) discard;\n\n  vec3 N = normalize(surfaceNormal);\n  vec3 V = normalize(eyeDirection);\n  vec3 L = normalize(lightDirection);\n\n  if(gl_FrontFacing) {\n    N = -N;\n  }\n\n  float specular = max(beckmannSpecular(L, V, N, roughness), 0.);\n  float diffuse  = min(kambient + kdiffuse * max(dot(N, L), 0.0), 1.0);\n\n  //decide how to interpolate color â in vertex or in fragment\n  vec4 surfaceColor =\n    step(vertexColor, .5) * texture2D(colormap, vec2(value, value)) +\n    step(.5, vertexColor) * vColor;\n\n  vec4 litColor = surfaceColor.a * vec4(diffuse * surfaceColor.rgb + kspecular * vec3(1,1,1) * specular,  1.0);\n\n  gl_FragColor = mix(litColor, contourColor, contourTint) * opacity;\n}\n"]),it=rt(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec4 uv;\nattribute float f;\n\nuniform vec3 objectOffset;\nuniform mat3 permutation;\nuniform mat4 model, view, projection;\nuniform float height, zOffset;\nuniform sampler2D colormap;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 lightDirection, eyeDirection, surfaceNormal;\nvarying vec4 vColor;\n\nvoid main() {\n  vec3 dataCoordinate = permutation * vec3(uv.xy, height);\n  worldCoordinate = objectOffset + dataCoordinate;\n  vec4 worldPosition = model * vec4(worldCoordinate, 1.0);\n\n  vec4 clipPosition = projection * view * worldPosition;\n  clipPosition.z += zOffset;\n\n  gl_Position = clipPosition;\n  value = f + objectOffset.z;\n  kill = -1.0;\n  planeCoordinate = uv.zw;\n\n  vColor = texture2D(colormap, vec2(value, value));\n\n  //Don't do lighting for contours\n  surfaceNormal   = vec3(1,0,0);\n  eyeDirection    = vec3(0,1,0);\n  lightDirection  = vec3(0,0,1);\n}\n"]),ot=rt(["precision highp float;\n#define GLSLIFY 1\n\nbool outOfRange(float a, float b, float p) {\n  return ((p > max(a, b)) || \n          (p < min(a, b)));\n}\n\nbool outOfRange(vec2 a, vec2 b, vec2 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y));\n}\n\nbool outOfRange(vec3 a, vec3 b, vec3 p) {\n  return (outOfRange(a.x, b.x, p.x) ||\n          outOfRange(a.y, b.y, p.y) ||\n          outOfRange(a.z, b.z, p.z));\n}\n\nbool outOfRange(vec4 a, vec4 b, vec4 p) {\n  return outOfRange(a.xyz, b.xyz, p.xyz);\n}\n\nuniform vec2 shape;\nuniform vec3 clipBounds[2];\nuniform float pickId;\n\nvarying float value, kill;\nvarying vec3 worldCoordinate;\nvarying vec2 planeCoordinate;\nvarying vec3 surfaceNormal;\n\nvec2 splitFloat(float v) {\n  float vh = 255.0 * v;\n  float upper = floor(vh);\n  float lower = fract(vh);\n  return vec2(upper / 255.0, floor(lower * 16.0) / 16.0);\n}\n\nvoid main() {\n  if ((kill > 0.0) ||\n      (outOfRange(clipBounds[0], clipBounds[1], worldCoordinate))) discard;\n\n  vec2 ux = splitFloat(planeCoordinate.x / shape.x);\n  vec2 uy = splitFloat(planeCoordinate.y / shape.y);\n  gl_FragColor = vec4(pickId, ux.x, uy.x, ux.y + (uy.y/16.0));\n}\n"]);Qe.createShader=function(Ne){var Ge=tt(Ne,nt,at,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return Ge.attributes.uv.location=0,Ge.attributes.f.location=1,Ge.attributes.normal.location=2,Ge},Qe.createPickShader=function(Ne){var Ge=tt(Ne,nt,ot,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return Ge.attributes.uv.location=0,Ge.attributes.f.location=1,Ge.attributes.normal.location=2,Ge},Qe.createContourShader=function(Ne){var Ge=tt(Ne,it,at,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return Ge.attributes.uv.location=0,Ge.attributes.f.location=1,Ge},Qe.createPickContourShader=function(Ne){var Ge=tt(Ne,it,ot,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return Ge.attributes.uv.location=0,Ge.attributes.f.location=1,Ge}},{"gl-shader":335,glslify:350}],350:[function(Ne,Ge,Qe){arguments[4][257][0].apply(Qe,arguments)},{dup:257}],351:[function(Ne,Ge,Qe){"use strict";Ge.exports=createSurfacePlot;var tt=Ne("bit-twiddle"),rt=Ne("gl-buffer"),nt=Ne("gl-vao"),at=Ne("gl-texture2d"),it=Ne("typedarray-pool"),ot=Ne("colormap"),dt=Ne("ndarray-ops"),ht=Ne("ndarray-pack"),Dt=Ne("ndarray"),Ot=Ne("surface-nets"),Rt=Ne("gl-mat4/multiply"),Zt=Ne("gl-mat4/invert"),er=Ne("binary-search-bounds"),dr=Ne("ndarray-gradient"),mr=Ne("./lib/shaders"),xr=mr.createShader,br=mr.createContourShader,Ar=mr.createPickShader,en=mr.createPickContourShader,mn=40,xn=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],kn=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],Cn=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];function SurfacePickResult(Ne,Ge,Qe,tt,rt){this.position=Ne,this.index=Ge,this.uv=Qe,this.level=tt,this.dataCoordinate=rt}!function(){for(var Ne=0;Ne<3;++Ne){var Ge=Cn[Ne],Qe=(Ne+2)%3;Ge[(Ne+1)%3+0]=1,Ge[Qe+3]=1,Ge[Ne+6]=1}}();var En=256;function SurfacePlot(Ne,Ge,Qe,tt,rt,nt,at,ot,dt,ht,Ot,Rt,Zt,er,dr){this.gl=Ne,this.shape=Ge,this.bounds=Qe,this.objectOffset=dr,this.intensityBounds=[],this._shader=tt,this._pickShader=rt,this._coordinateBuffer=nt,this._vao=at,this._colorMap=ot,this._contourShader=dt,this._contourPickShader=ht,this._contourBuffer=Ot,this._contourVAO=Rt,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new SurfacePickResult([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=Zt,this._dynamicVAO=er,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[Dt(it.mallocFloat(1024),[0,0]),Dt(it.mallocFloat(1024),[0,0]),Dt(it.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.snapToData=!1,this.pixelRatio=1,this.opacity=1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}var Pn=SurfacePlot.prototype;function getOpacityFromScale(Ne,Ge){if(!Ge)return 1;if(!Ge.length)return 1;for(var Qe=0;Qe<Ge.length;++Qe){if(Ge.length<2)return 1;if(Ge[Qe][0]===Ne)return Ge[Qe][1];if(Ge[Qe][0]>Ne&&Qe>0){var tt=(Ge[Qe][0]-Ne)/(Ge[Qe][0]-Ge[Qe-1][0]);return Ge[Qe][1]*(1-tt)+tt*Ge[Qe-1][1]}}return 1}Pn.genColormap=function(Ne,Ge){var Qe=!1,tt=ht([ot({colormap:Ne,nshades:En,format:"rgba"}).map((function(Ne,tt){var rt=Ge?getOpacityFromScale(tt/255,Ge):Ne[3];return rt<1&&(Qe=!0),[Ne[0],Ne[1],Ne[2],255*rt]}))]);return dt.divseq(tt,255),this.hasAlphaScale=Qe,tt},Pn.isTransparent=function(){return this.opacity<1||this.hasAlphaScale},Pn.isOpaque=function(){return!this.isTransparent()},Pn.pickSlots=1,Pn.setPickBase=function(Ne){this.pickId=Ne};var Dn=[0,0,0],In={showSurface:!1,showContour:!1,projections:[xn.slice(),xn.slice(),xn.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function computeProjectionData(Ne,Ge){var Qe,tt,rt,nt=Ge.axes&&Ge.axes.lastCubeProps.axis||Dn,at=Ge.showSurface,it=Ge.showContour;for(Qe=0;Qe<3;++Qe)for(at=at||Ge.surfaceProject[Qe],tt=0;tt<3;++tt)it=it||Ge.contourProject[Qe][tt];for(Qe=0;Qe<3;++Qe){var ot=In.projections[Qe];for(tt=0;tt<16;++tt)ot[tt]=0;for(tt=0;tt<4;++tt)ot[5*tt]=1;ot[5*Qe]=0,ot[12+Qe]=Ge.axesBounds[+(nt[Qe]>0)][Qe],Rt(ot,Ne.model,ot);var dt=In.clipBounds[Qe];for(rt=0;rt<2;++rt)for(tt=0;tt<3;++tt)dt[rt][tt]=Ne.clipBounds[rt][tt];dt[0][Qe]=-1e8,dt[1][Qe]=1e8}return In.showSurface=at,In.showContour=it,In}var zn={model:xn,view:xn,projection:xn,inverseModel:xn.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},Bn=xn.slice(),Vn=[1,0,0,0,1,0,0,0,1];function drawCore(Ne,Ge){Ne=Ne||{};var Qe=this.gl;Qe.disable(Qe.CULL_FACE),this._colorMap.bind(0);var tt=zn;tt.model=Ne.model||xn,tt.view=Ne.view||xn,tt.projection=Ne.projection||xn,tt.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],tt.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],tt.objectOffset=this.objectOffset,tt.contourColor=this.contourColor[0],tt.inverseModel=Zt(tt.inverseModel,tt.model);for(var rt=0;rt<2;++rt)for(var nt=tt.clipBounds[rt],at=0;at<3;++at)nt[at]=Math.min(Math.max(this.clipBounds[rt][at],-1e8),1e8);tt.kambient=this.ambientLight,tt.kdiffuse=this.diffuseLight,tt.kspecular=this.specularLight,tt.roughness=this.roughness,tt.fresnel=this.fresnel,tt.opacity=this.opacity,tt.height=0,tt.permutation=Vn,tt.vertexColor=this.vertexColor;var it=Bn;for(Rt(it,tt.view,tt.model),Rt(it,tt.projection,it),Zt(it,it),rt=0;rt<3;++rt)tt.eyePosition[rt]=it[12+rt]/it[15];var ot=it[15];for(rt=0;rt<3;++rt)ot+=this.lightPosition[rt]*it[4*rt+3];for(rt=0;rt<3;++rt){var dt=it[12+rt];for(at=0;at<3;++at)dt+=it[4*at+rt]*this.lightPosition[at];tt.lightPosition[rt]=dt/ot}var ht=computeProjectionData(tt,this);if(ht.showSurface){for(this._shader.bind(),this._shader.uniforms=tt,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw(Qe.TRIANGLES,this._vertexCount),rt=0;rt<3;++rt)this.surfaceProject[rt]&&this.vertexCount&&(this._shader.uniforms.model=ht.projections[rt],this._shader.uniforms.clipBounds=ht.clipBounds[rt],this._vao.draw(Qe.TRIANGLES,this._vertexCount));this._vao.unbind()}if(ht.showContour){var Dt=this._contourShader;tt.kambient=1,tt.kdiffuse=0,tt.kspecular=0,tt.opacity=1,Dt.bind(),Dt.uniforms=tt;var Ot=this._contourVAO;for(Ot.bind(),rt=0;rt<3;++rt)for(Dt.uniforms.permutation=Cn[rt],Qe.lineWidth(this.contourWidth[rt]*this.pixelRatio),at=0;at<this.contourLevels[rt].length;++at)at===this.highlightLevel[rt]?(Dt.uniforms.contourColor=this.highlightColor[rt],Dt.uniforms.contourTint=this.highlightTint[rt]):0!==at&&at-1!==this.highlightLevel[rt]||(Dt.uniforms.contourColor=this.contourColor[rt],Dt.uniforms.contourTint=this.contourTint[rt]),this._contourCounts[rt][at]&&(Dt.uniforms.height=this.contourLevels[rt][at],Ot.draw(Qe.LINES,this._contourCounts[rt][at],this._contourOffsets[rt][at]));for(rt=0;rt<3;++rt)for(Dt.uniforms.model=ht.projections[rt],Dt.uniforms.clipBounds=ht.clipBounds[rt],at=0;at<3;++at)if(this.contourProject[rt][at]){Dt.uniforms.permutation=Cn[at],Qe.lineWidth(this.contourWidth[at]*this.pixelRatio);for(var er=0;er<this.contourLevels[at].length;++er)er===this.highlightLevel[at]?(Dt.uniforms.contourColor=this.highlightColor[at],Dt.uniforms.contourTint=this.highlightTint[at]):0!==er&&er-1!==this.highlightLevel[at]||(Dt.uniforms.contourColor=this.contourColor[at],Dt.uniforms.contourTint=this.contourTint[at]),this._contourCounts[at][er]&&(Dt.uniforms.height=this.contourLevels[at][er],Ot.draw(Qe.LINES,this._contourCounts[at][er],this._contourOffsets[at][er]))}for(Ot.unbind(),(Ot=this._dynamicVAO).bind(),rt=0;rt<3;++rt)if(0!==this._dynamicCounts[rt])for(Dt.uniforms.model=tt.model,Dt.uniforms.clipBounds=tt.clipBounds,Dt.uniforms.permutation=Cn[rt],Qe.lineWidth(this.dynamicWidth[rt]*this.pixelRatio),Dt.uniforms.contourColor=this.dynamicColor[rt],Dt.uniforms.contourTint=this.dynamicTint[rt],Dt.uniforms.height=this.dynamicLevel[rt],Ot.draw(Qe.LINES,this._dynamicCounts[rt],this._dynamicOffsets[rt]),at=0;at<3;++at)this.contourProject[at][rt]&&(Dt.uniforms.model=ht.projections[at],Dt.uniforms.clipBounds=ht.clipBounds[at],Ot.draw(Qe.LINES,this._dynamicCounts[rt],this._dynamicOffsets[rt]));Ot.unbind()}}Pn.draw=function(Ne){return drawCore.call(this,Ne,!1)},Pn.drawTransparent=function(Ne){return drawCore.call(this,Ne,!0)};var Hn={model:xn,view:xn,projection:xn,inverseModel:xn,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};function handleArray(Ne,Ge){return Array.isArray(Ne)?[Ge(Ne[0]),Ge(Ne[1]),Ge(Ne[2])]:[Ge(Ne),Ge(Ne),Ge(Ne)]}function toColor(Ne){return Array.isArray(Ne)?3===Ne.length?[Ne[0],Ne[1],Ne[2],1]:[Ne[0],Ne[1],Ne[2],Ne[3]]:[0,0,0,1]}function handleColor(Ne){if(Array.isArray(Ne)){if(Array.isArray(Ne))return[toColor(Ne[0]),toColor(Ne[1]),toColor(Ne[2])];var Ge=toColor(Ne);return[Ge.slice(),Ge.slice(),Ge.slice()]}}function createSurfacePlot(Ne){var Ge=Ne.gl,Qe=xr(Ge),tt=Ar(Ge),it=br(Ge),ot=en(Ge),dt=rt(Ge),ht=nt(Ge,[{buffer:dt,size:4,stride:mn,offset:0},{buffer:dt,size:3,stride:mn,offset:16},{buffer:dt,size:3,stride:mn,offset:28}]),Dt=rt(Ge),Ot=nt(Ge,[{buffer:Dt,size:4,stride:20,offset:0},{buffer:Dt,size:1,stride:20,offset:16}]),Rt=rt(Ge),Zt=nt(Ge,[{buffer:Rt,size:2,type:Ge.FLOAT}]),er=at(Ge,1,En,Ge.RGBA,Ge.UNSIGNED_BYTE);er.minFilter=Ge.LINEAR,er.magFilter=Ge.LINEAR;var dr=new SurfacePlot(Ge,[0,0],[[0,0,0],[0,0,0]],Qe,tt,dt,ht,er,it,ot,Dt,Ot,Rt,Zt,[0,0,0]),mr={levels:[[],[],[]]};for(var xn in Ne)mr[xn]=Ne[xn];return mr.colormap=mr.colormap||"jet",dr.update(mr),dr}Pn.drawPick=function(Ne){Ne=Ne||{};var Ge=this.gl;Ge.disable(Ge.CULL_FACE);var Qe=Hn;Qe.model=Ne.model||xn,Qe.view=Ne.view||xn,Qe.projection=Ne.projection||xn,Qe.shape=this._field[2].shape,Qe.pickId=this.pickId/255,Qe.lowerBound=this.bounds[0],Qe.upperBound=this.bounds[1],Qe.objectOffset=this.objectOffset,Qe.permutation=Vn;for(var tt=0;tt<2;++tt)for(var rt=Qe.clipBounds[tt],nt=0;nt<3;++nt)rt[nt]=Math.min(Math.max(this.clipBounds[tt][nt],-1e8),1e8);var at=computeProjectionData(Qe,this);if(at.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=Qe,this._vao.bind(),this._vao.draw(Ge.TRIANGLES,this._vertexCount),tt=0;tt<3;++tt)this.surfaceProject[tt]&&(this._pickShader.uniforms.model=at.projections[tt],this._pickShader.uniforms.clipBounds=at.clipBounds[tt],this._vao.draw(Ge.TRIANGLES,this._vertexCount));this._vao.unbind()}if(at.showContour){var it=this._contourPickShader;it.bind(),it.uniforms=Qe;var ot=this._contourVAO;for(ot.bind(),nt=0;nt<3;++nt)for(Ge.lineWidth(this.contourWidth[nt]*this.pixelRatio),it.uniforms.permutation=Cn[nt],tt=0;tt<this.contourLevels[nt].length;++tt)this._contourCounts[nt][tt]&&(it.uniforms.height=this.contourLevels[nt][tt],ot.draw(Ge.LINES,this._contourCounts[nt][tt],this._contourOffsets[nt][tt]));for(tt=0;tt<3;++tt)for(it.uniforms.model=at.projections[tt],it.uniforms.clipBounds=at.clipBounds[tt],nt=0;nt<3;++nt)if(this.contourProject[tt][nt]){it.uniforms.permutation=Cn[nt],Ge.lineWidth(this.contourWidth[nt]*this.pixelRatio);for(var dt=0;dt<this.contourLevels[nt].length;++dt)this._contourCounts[nt][dt]&&(it.uniforms.height=this.contourLevels[nt][dt],ot.draw(Ge.LINES,this._contourCounts[nt][dt],this._contourOffsets[nt][dt]))}ot.unbind()}},Pn.pick=function(Ne){if(!Ne)return null;if(Ne.id!==this.pickId)return null;var Ge=this._field[2].shape,Qe=this._pickResult,tt=Ge[0]*(Ne.value[0]+(Ne.value[2]>>4)/16)/255,rt=Math.floor(tt),nt=tt-rt,at=Ge[1]*(Ne.value[1]+(15&Ne.value[2])/16)/255,it=Math.floor(at),ot=at-it;rt+=1,it+=1;var dt=Qe.position;dt[0]=dt[1]=dt[2]=0;for(var ht=0;ht<2;++ht)for(var Dt=ht?nt:1-nt,Ot=0;Ot<2;++Ot)for(var Rt=rt+ht,Zt=it+Ot,dr=Dt*(Ot?ot:1-ot),mr=0;mr<3;++mr)dt[mr]+=this._field[mr].get(Rt,Zt)*dr;for(var xr=this._pickResult.level,br=0;br<3;++br)if(xr[br]=er.le(this.contourLevels[br],dt[br]),xr[br]<0)this.contourLevels[br].length>0&&(xr[br]=0);else if(xr[br]<this.contourLevels[br].length-1){var Ar=this.contourLevels[br][xr[br]],en=this.contourLevels[br][xr[br]+1];Math.abs(Ar-dt[br])>Math.abs(en-dt[br])&&(xr[br]+=1)}for(Qe.index[0]=nt<.5?rt:rt+1,Qe.index[1]=ot<.5?it:it+1,Qe.uv[0]=tt/Ge[0],Qe.uv[1]=at/Ge[1],mr=0;mr<3;++mr)Qe.dataCoordinate[mr]=this._field[mr].get(Qe.index[0],Qe.index[1]);return Qe},Pn.padField=function(Ne,Ge){var Qe=Ge.shape.slice(),tt=Ne.shape.slice();dt.assign(Ne.lo(1,1).hi(Qe[0],Qe[1]),Ge),dt.assign(Ne.lo(1).hi(Qe[0],1),Ge.hi(Qe[0],1)),dt.assign(Ne.lo(1,tt[1]-1).hi(Qe[0],1),Ge.lo(0,Qe[1]-1).hi(Qe[0],1)),dt.assign(Ne.lo(0,1).hi(1,Qe[1]),Ge.hi(1)),dt.assign(Ne.lo(tt[0]-1,1).hi(1,Qe[1]),Ge.lo(Qe[0]-1)),Ne.set(0,0,Ge.get(0,0)),Ne.set(0,tt[1]-1,Ge.get(0,Qe[1]-1)),Ne.set(tt[0]-1,0,Ge.get(Qe[0]-1,0)),Ne.set(tt[0]-1,tt[1]-1,Ge.get(Qe[0]-1,Qe[1]-1))},Pn.update=function(Ne){Ne=Ne||{},this.objectOffset=Ne.objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in Ne&&(this.contourWidth=handleArray(Ne.contourWidth,Number)),"showContour"in Ne&&(this.showContour=handleArray(Ne.showContour,Boolean)),"showSurface"in Ne&&(this.showSurface=!!Ne.showSurface),"contourTint"in Ne&&(this.contourTint=handleArray(Ne.contourTint,Boolean)),"contourColor"in Ne&&(this.contourColor=handleColor(Ne.contourColor)),"contourProject"in Ne&&(this.contourProject=handleArray(Ne.contourProject,(function(Ne){return handleArray(Ne,Boolean)}))),"surfaceProject"in Ne&&(this.surfaceProject=Ne.surfaceProject),"dynamicColor"in Ne&&(this.dynamicColor=handleColor(Ne.dynamicColor)),"dynamicTint"in Ne&&(this.dynamicTint=handleArray(Ne.dynamicTint,Number)),"dynamicWidth"in Ne&&(this.dynamicWidth=handleArray(Ne.dynamicWidth,Number)),"opacity"in Ne&&(this.opacity=Ne.opacity),"opacityscale"in Ne&&(this.opacityscale=Ne.opacityscale),"colorBounds"in Ne&&(this.colorBounds=Ne.colorBounds),"vertexColor"in Ne&&(this.vertexColor=Ne.vertexColor?1:0),"colormap"in Ne&&this._colorMap.setPixels(this.genColormap(Ne.colormap,this.opacityscale));var Ge=Ne.field||Ne.coords&&Ne.coords[2]||null,Qe=!1;if(Ge||(Ge=this._field[2].shape[0]||this._field[2].shape[2]?this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):this._field[2].hi(0,0)),"field"in Ne||"coords"in Ne){var rt=(Ge.shape[0]+2)*(Ge.shape[1]+2);rt>this._field[2].data.length&&(it.freeFloat(this._field[2].data),this._field[2].data=it.mallocFloat(tt.nextPow2(rt))),this._field[2]=Dt(this._field[2].data,[Ge.shape[0]+2,Ge.shape[1]+2]),this.padField(this._field[2],Ge),this.shape=Ge.shape.slice();for(var nt=this.shape,at=0;at<2;++at)this._field[2].size>this._field[at].data.length&&(it.freeFloat(this._field[at].data),this._field[at].data=it.mallocFloat(this._field[2].size)),this._field[at]=Dt(this._field[at].data,[nt[0]+2,nt[1]+2]);if(Ne.coords){var ot=Ne.coords;if(!Array.isArray(ot)||3!==ot.length)throw new Error("gl-surface: invalid coordinates for x/y");for(at=0;at<2;++at){var dt=ot[at];for(mr=0;mr<2;++mr)if(dt.shape[mr]!==nt[mr])throw new Error("gl-surface: coords have incorrect shape");this.padField(this._field[at],dt)}}else if(Ne.ticks){var ht=Ne.ticks;if(!Array.isArray(ht)||2!==ht.length)throw new Error("gl-surface: invalid ticks");for(at=0;at<2;++at){var Rt=ht[at];if((Array.isArray(Rt)||Rt.length)&&(Rt=Dt(Rt)),Rt.shape[0]!==nt[at])throw new Error("gl-surface: invalid tick length");var Zt=Dt(Rt.data,nt);Zt.stride[at]=Rt.stride[0],Zt.stride[1^at]=0,this.padField(this._field[at],Zt)}}else{for(at=0;at<2;++at){var er=[0,0];er[at]=1,this._field[at]=Dt(this._field[at].data,[nt[0]+2,nt[1]+2],er,0)}this._field[0].set(0,0,0);for(var mr=0;mr<nt[0];++mr)this._field[0].set(mr+1,0,mr);for(this._field[0].set(nt[0]+1,0,nt[0]-1),this._field[1].set(0,0,0),mr=0;mr<nt[1];++mr)this._field[1].set(0,mr+1,mr);this._field[1].set(0,nt[1]+1,nt[1]-1)}var xr=this._field,br=Dt(it.mallocFloat(3*xr[2].size*2),[3,nt[0]+2,nt[1]+2,2]);for(at=0;at<3;++at)dr(br.pick(at),xr[at],"mirror");var Ar=Dt(it.mallocFloat(3*xr[2].size),[nt[0]+2,nt[1]+2,3]);for(at=0;at<nt[0]+2;++at)for(mr=0;mr<nt[1]+2;++mr){var en=br.get(0,at,mr,0),mn=br.get(0,at,mr,1),xn=br.get(1,at,mr,0),Cn=br.get(1,at,mr,1),En=br.get(2,at,mr,0),Pn=br.get(2,at,mr,1),Dn=xn*Pn-Cn*En,In=En*mn-Pn*en,zn=en*Cn-mn*xn,Bn=Math.sqrt(Dn*Dn+In*In+zn*zn);Bn<1e-8?(Bn=Math.max(Math.abs(Dn),Math.abs(In),Math.abs(zn)))<1e-8?(zn=1,In=Dn=0,Bn=1):Bn=1/Bn:Bn=1/Math.sqrt(Bn),Ar.set(at,mr,0,Dn*Bn),Ar.set(at,mr,1,In*Bn),Ar.set(at,mr,2,zn*Bn)}it.free(br.data);var Vn=[1/0,1/0,1/0],Hn=[-1/0,-1/0,-1/0],qn=1/0,Yn=-1/0,$n=(nt[0]-1)*(nt[1]-1)*6,ra=it.mallocFloat(tt.nextPow2(10*$n)),oa=0,pa=0;for(at=0;at<nt[0]-1;++at)e:for(mr=0;mr<nt[1]-1;++mr){for(var ga=0;ga<2;++ga)for(var ma=0;ma<2;++ma)for(var _a=0;_a<3;++_a){var Va=this._field[_a].get(1+at+ga,1+mr+ma);if(isNaN(Va)||!isFinite(Va))continue e}for(_a=0;_a<6;++_a){var Wa=at+kn[_a][0],Qa=mr+kn[_a][1],ti=this._field[0].get(Wa+1,Qa+1),ni=this._field[1].get(Wa+1,Qa+1);Va=this._field[2].get(Wa+1,Qa+1),Dn=Ar.get(Wa+1,Qa+1,0),In=Ar.get(Wa+1,Qa+1,1),zn=Ar.get(Wa+1,Qa+1,2),Ne.intensity&&(di=Ne.intensity.get(Wa,Qa));var di=Ne.intensity?Ne.intensity.get(Wa,Qa):Va+this.objectOffset[2];ra[oa++]=Wa,ra[oa++]=Qa,ra[oa++]=ti,ra[oa++]=ni,ra[oa++]=Va,ra[oa++]=0,ra[oa++]=di,ra[oa++]=Dn,ra[oa++]=In,ra[oa++]=zn,Vn[0]=Math.min(Vn[0],ti+this.objectOffset[0]),Vn[1]=Math.min(Vn[1],ni+this.objectOffset[1]),Vn[2]=Math.min(Vn[2],Va+this.objectOffset[2]),qn=Math.min(qn,di),Hn[0]=Math.max(Hn[0],ti+this.objectOffset[0]),Hn[1]=Math.max(Hn[1],ni+this.objectOffset[1]),Hn[2]=Math.max(Hn[2],Va+this.objectOffset[2]),Yn=Math.max(Yn,di),pa+=1}}for(Ne.intensityBounds&&(qn=+Ne.intensityBounds[0],Yn=+Ne.intensityBounds[1]),at=6;at<oa;at+=10)ra[at]=(ra[at]-qn)/(Yn-qn);this._vertexCount=pa,this._coordinateBuffer.update(ra.subarray(0,oa)),it.freeFloat(ra),it.free(Ar.data),this.bounds=[Vn,Hn],this.intensity=Ne.intensity||this._field[2],this.intensityBounds[0]===qn&&this.intensityBounds[1]===Yn||(Qe=!0),this.intensityBounds=[qn,Yn]}if("levels"in Ne){var ji=Ne.levels;for(ji=Array.isArray(ji[0])?ji.slice():[[],[],ji],at=0;at<3;++at)ji[at]=ji[at].slice(),ji[at].sort((function(Ne,Ge){return Ne-Ge}));for(at=0;at<3;++at)for(mr=0;mr<ji[at].length;++mr)ji[at][mr]-=this.objectOffset[at];e:for(at=0;at<3;++at){if(ji[at].length!==this.contourLevels[at].length){Qe=!0;break}for(mr=0;mr<ji[at].length;++mr)if(ji[at][mr]!==this.contourLevels[at][mr]){Qe=!0;break e}}this.contourLevels=ji}if(Qe){xr=this._field,nt=this.shape;for(var Hi=[],Yi=0;Yi<3;++Yi){var uo=this.contourLevels[Yi],go=[],ns=[],as=[0,0,0];for(at=0;at<uo.length;++at){var is=Ot(this._field[Yi],uo[at]);go.push(Hi.length/5|0),pa=0;e:for(mr=0;mr<is.cells.length;++mr){var os=is.cells[mr];for(_a=0;_a<2;++_a){var ss=is.positions[os[_a]],cs=ss[0],ds=0|Math.floor(cs),ms=cs-ds,vs=ss[1],_s=0|Math.floor(vs),ws=vs-_s,Ts=!1;t:for(var ks=0;ks<3;++ks){as[ks]=0;var Cs=(Yi+ks+1)%3;for(ga=0;ga<2;++ga){var Es=ga?ms:1-ms;for(Wa=0|Math.min(Math.max(ds+ga,0),nt[0]),ma=0;ma<2;++ma){var Ls=ma?ws:1-ws;if(Qa=0|Math.min(Math.max(_s+ma,0),nt[1]),Va=ks<2?this._field[Cs].get(Wa,Qa):(this.intensity.get(Wa,Qa)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(Va)||isNaN(Va)){Ts=!0;break t}var Ps=Es*Ls;as[ks]+=Ps*Va}}}if(Ts){if(_a>0){for(var Ds=0;Ds<5;++Ds)Hi.pop();pa-=1}continue e}Hi.push(as[0],as[1],ss[0],ss[1],as[2]),pa+=1}}ns.push(pa)}this._contourOffsets[Yi]=go,this._contourCounts[Yi]=ns}var Is=it.mallocFloat(Hi.length);for(at=0;at<Hi.length;++at)Is[at]=Hi[at];this._contourBuffer.update(Is),it.freeFloat(Is)}},Pn.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var Ne=0;Ne<3;++Ne)it.freeFloat(this._field[Ne].data)},Pn.highlight=function(Ne){var Ge,Qe;if(!Ne)return this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],void(this.highlightLevel=[-1,-1,-1]);for(Ge=0;Ge<3;++Ge)this.enableHighlight[Ge]?this.highlightLevel[Ge]=Ne.level[Ge]:this.highlightLevel[Ge]=-1;for(Qe=this.snapToData?Ne.dataCoordinate:Ne.position,Ge=0;Ge<3;++Ge)Qe[Ge]-=this.objectOffset[Ge];if(this.enableDynamic[0]&&Qe[0]!==this.dynamicLevel[0]||this.enableDynamic[1]&&Qe[1]!==this.dynamicLevel[1]||this.enableDynamic[2]&&Qe[2]!==this.dynamicLevel[2]){for(var tt=0,rt=this.shape,nt=it.mallocFloat(12*rt[0]*rt[1]),at=0;at<3;++at)if(this.enableDynamic[at]){this.dynamicLevel[at]=Qe[at];var ot=(at+1)%3,dt=(at+2)%3,ht=this._field[at],Dt=this._field[ot],Rt=this._field[dt],Zt=Ot(ht,Qe[at]),er=Zt.cells,dr=Zt.positions;for(this._dynamicOffsets[at]=tt,Ge=0;Ge<er.length;++Ge)for(var mr=er[Ge],xr=0;xr<2;++xr){var br=dr[mr[xr]],Ar=+br[0],en=0|Ar,mn=0|Math.min(en+1,rt[0]),xn=Ar-en,kn=1-xn,Cn=+br[1],En=0|Cn,Pn=0|Math.min(En+1,rt[1]),Dn=Cn-En,In=1-Dn,zn=kn*In,Bn=kn*Dn,Vn=xn*In,Hn=xn*Dn,qn=zn*Dt.get(en,En)+Bn*Dt.get(en,Pn)+Vn*Dt.get(mn,En)+Hn*Dt.get(mn,Pn),Yn=zn*Rt.get(en,En)+Bn*Rt.get(en,Pn)+Vn*Rt.get(mn,En)+Hn*Rt.get(mn,Pn);if(isNaN(qn)||isNaN(Yn)){xr&&(tt-=1);break}nt[2*tt+0]=qn,nt[2*tt+1]=Yn,tt+=1}this._dynamicCounts[at]=tt-this._dynamicOffsets[at]}else this.dynamicLevel[at]=NaN,this._dynamicCounts[at]=0;this._dynamicBuffer.update(nt.subarray(0,2*tt)),it.freeFloat(nt)}}},{"./lib/shaders":349,"binary-search-bounds":96,"bit-twiddle":97,colormap:131,"gl-buffer":259,"gl-mat4/invert":293,"gl-mat4/multiply":295,"gl-texture2d":353,"gl-vao":358,ndarray:495,"ndarray-gradient":488,"ndarray-ops":490,"ndarray-pack":491,"surface-nets":570,"typedarray-pool":595}],352:[function(Ne,Ge,Qe){"use strict";var tt=Ne("css-font"),rt=Ne("pick-by-alias"),nt=Ne("regl"),at=Ne("gl-util/context"),it=Ne("es6-weak-map"),ot=Ne("color-normalize"),dt=Ne("font-atlas"),ht=Ne("typedarray-pool"),Dt=Ne("parse-rect"),Ot=Ne("is-plain-obj"),Rt=Ne("parse-unit"),Zt=Ne("to-px"),er=Ne("detect-kerning"),dr=Ne("object-assign"),mr=Ne("font-measure"),xr=Ne("flatten-vertex-data"),br=Ne("bit-twiddle").nextPow2,Ar=new it,en=!1;if(document.body){var mn=document.body.appendChild(document.createElement("div"));mn.style.font="italic small-caps bold condensed 16px/2 cursive",getComputedStyle(mn).fontStretch&&(en=!0),document.body.removeChild(mn)}var GlText=function(Ne){isRegl(Ne)?(Ne={regl:Ne},this.gl=Ne.regl._gl):this.gl=at(Ne),this.shader=Ar.get(this.gl),this.shader?this.regl=this.shader.regl:this.regl=Ne.regl||nt({gl:this.gl}),this.charBuffer=this.regl.buffer({type:"uint8",usage:"stream"}),this.sizeBuffer=this.regl.buffer({type:"float",usage:"stream"}),this.shader||(this.shader=this.createShader(),Ar.set(this.gl,this.shader)),this.batch=[],this.fontSize=[],this.font=[],this.fontAtlas=[],this.draw=this.shader.draw.bind(this),this.render=function(){this.regl._refresh(),this.draw(this.batch)},this.canvas=this.gl.canvas,this.update(Ot(Ne)?Ne:{})};function isRegl(Ne){return"function"==typeof Ne&&Ne._gl&&Ne.prop&&Ne.texture&&Ne.buffer}GlText.prototype.createShader=function(){var Ne=this.regl,Ge=Ne({blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},stencil:{enable:!1},depth:{enable:!1},count:Ne.prop("count"),offset:Ne.prop("offset"),attributes:{charOffset:{offset:4,stride:8,buffer:Ne.this("sizeBuffer")},width:{offset:0,stride:8,buffer:Ne.this("sizeBuffer")},char:Ne.this("charBuffer"),position:Ne.this("position")},uniforms:{atlasSize:function(Ne,Ge){return[Ge.atlas.width,Ge.atlas.height]},atlasDim:function(Ne,Ge){return[Ge.atlas.cols,Ge.atlas.rows]},atlas:function(Ne,Ge){return Ge.atlas.texture},charStep:function(Ne,Ge){return Ge.atlas.step},em:function(Ne,Ge){return Ge.atlas.em},color:Ne.prop("color"),opacity:Ne.prop("opacity"),viewport:Ne.this("viewportArray"),scale:Ne.this("scale"),align:Ne.prop("align"),baseline:Ne.prop("baseline"),translate:Ne.this("translate"),positionOffset:Ne.prop("positionOffset")},primitive:"points",viewport:Ne.this("viewport"),vert:"\n\t\t\tprecision highp float;\n\t\t\tattribute float width, charOffset, char;\n\t\t\tattribute vec2 position;\n\t\t\tuniform float fontSize, charStep, em, align, baseline;\n\t\t\tuniform vec4 viewport;\n\t\t\tuniform vec4 color;\n\t\t\tuniform vec2 atlasSize, atlasDim, scale, translate, positionOffset;\n\t\t\tvarying vec2 charCoord, charId;\n\t\t\tvarying float charWidth;\n\t\t\tvarying vec4 fontColor;\n\t\t\tvoid main () {\n\t\t\t\t"+(GlText.normalViewport?"":"vec2 positionOffset = vec2(positionOffset.x,- positionOffset.y);")+"\n\n\t\t\t\tvec2 offset = floor(em * (vec2(align + charOffset, baseline)\n\t\t\t\t\t+ positionOffset))\n\t\t\t\t\t/ (viewport.zw * scale.xy);\n\n\t\t\t\tvec2 position = (position + translate) * scale;\n\t\t\t\tposition += offset * scale;\n\n\t\t\t\t"+(GlText.normalViewport?"position.y = 1. - position.y;":"")+"\n\n\t\t\t\tcharCoord = position * viewport.zw + viewport.xy;\n\n\t\t\t\tgl_Position = vec4(position * 2. - 1., 0, 1);\n\n\t\t\t\tgl_PointSize = charStep;\n\n\t\t\t\tcharId.x = mod(char, atlasDim.x);\n\t\t\t\tcharId.y = floor(char / atlasDim.x);\n\n\t\t\t\tcharWidth = width * em;\n\n\t\t\t\tfontColor = color / 255.;\n\t\t\t}",frag:"\n\t\t\tprecision highp float;\n\t\t\tuniform sampler2D atlas;\n\t\t\tuniform float fontSize, charStep, opacity;\n\t\t\tuniform vec2 atlasSize;\n\t\t\tuniform vec4 viewport;\n\t\t\tvarying vec4 fontColor;\n\t\t\tvarying vec2 charCoord, charId;\n\t\t\tvarying float charWidth;\n\n\t\t\tfloat lightness(vec4 color) {\n\t\t\t\treturn color.r * 0.299 + color.g * 0.587 + color.b * 0.114;\n\t\t\t}\n\n\t\t\tvoid main () {\n\t\t\t\tvec2 uv = gl_FragCoord.xy - charCoord + charStep * .5;\n\t\t\t\tfloat halfCharStep = floor(charStep * .5 + .5);\n\n\t\t\t\t// invert y and shift by 1px (FF expecially needs that)\n\t\t\t\tuv.y = charStep - uv.y;\n\n\t\t\t\t// ignore points outside of character bounding box\n\t\t\t\tfloat halfCharWidth = ceil(charWidth * .5);\n\t\t\t\tif (floor(uv.x) > halfCharStep + halfCharWidth ||\n\t\t\t\t\tfloor(uv.x) < halfCharStep - halfCharWidth) return;\n\n\t\t\t\tuv += charId * charStep;\n\t\t\t\tuv = uv / atlasSize;\n\n\t\t\t\tvec4 color = fontColor;\n\t\t\t\tvec4 mask = texture2D(atlas, uv);\n\n\t\t\t\tfloat maskY = lightness(mask);\n\t\t\t\t// float colorY = lightness(color);\n\t\t\t\tcolor.a *= maskY;\n\t\t\t\tcolor.a *= opacity;\n\n\t\t\t\t// color.a += .1;\n\n\t\t\t\t// antialiasing, see yiq color space y-channel formula\n\t\t\t\t// color.rgb += (1. - color.rgb) * (1. - mask.rgb);\n\n\t\t\t\tgl_FragColor = color;\n\t\t\t}"});return{regl:Ne,draw:Ge,atlas:{}}},GlText.prototype.update=function(Ne){var Ge=this;if("string"==typeof Ne)Ne={text:Ne};else if(!Ne)return;null!=(Ne=rt(Ne,{position:"position positions coord coords coordinates",font:"font fontFace fontface typeface cssFont css-font family fontFamily",fontSize:"fontSize fontsize size font-size",text:"text texts chars characters value values symbols",align:"align alignment textAlign textbaseline",baseline:"baseline textBaseline textbaseline",direction:"dir direction textDirection",color:"color colour fill fill-color fillColor textColor textcolor",kerning:"kerning kern",range:"range dataBox",viewport:"vp viewport viewBox viewbox viewPort",opacity:"opacity alpha transparency visible visibility opaque",offset:"offset positionOffset padding shift indent indentation"},!0)).opacity&&(Array.isArray(Ne.opacity)?this.opacity=Ne.opacity.map((function(Ne){return parseFloat(Ne)})):this.opacity=parseFloat(Ne.opacity)),null!=Ne.viewport&&(this.viewport=Dt(Ne.viewport),GlText.normalViewport&&(this.viewport.y=this.canvas.height-this.viewport.y-this.viewport.height),this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),null==this.viewport&&(this.viewport={x:0,y:0,width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight},this.viewportArray=[this.viewport.x,this.viewport.y,this.viewport.width,this.viewport.height]),null!=Ne.kerning&&(this.kerning=Ne.kerning),null!=Ne.offset&&("number"==typeof Ne.offset&&(Ne.offset=[Ne.offset,0]),this.positionOffset=xr(Ne.offset)),Ne.direction&&(this.direction=Ne.direction),Ne.range&&(this.range=Ne.range,this.scale=[1/(Ne.range[2]-Ne.range[0]),1/(Ne.range[3]-Ne.range[1])],this.translate=[-Ne.range[0],-Ne.range[1]]),Ne.scale&&(this.scale=Ne.scale),Ne.translate&&(this.translate=Ne.translate),this.scale||(this.scale=[1/this.viewport.width,1/this.viewport.height]),this.translate||(this.translate=[0,0]),this.font.length||Ne.font||(Ne.font=GlText.baseFontSize+"px sans-serif");var Qe,nt=!1,at=!1;if(Ne.font&&(Array.isArray(Ne.font)?Ne.font:[Ne.font]).forEach((function(Ne,Qe){if("string"==typeof Ne)try{Ne=tt.parse(Ne)}catch(Ge){Ne=tt.parse(GlText.baseFontSize+"px "+Ne)}else Ne=tt.parse(tt.stringify(Ne));var rt=tt.stringify({size:GlText.baseFontSize,family:Ne.family,stretch:en?Ne.stretch:void 0,variant:Ne.variant,weight:Ne.weight,style:Ne.style}),it=Rt(Ne.size),ot=Math.round(it[0]*Zt(it[1]));if(ot!==Ge.fontSize[Qe]&&(at=!0,Ge.fontSize[Qe]=ot),!(Ge.font[Qe]&&rt==Ge.font[Qe].baseString||(nt=!0,Ge.font[Qe]=GlText.fonts[rt],Ge.font[Qe]))){var dt=Ne.family.join(", "),ht=[Ne.style];Ne.style!=Ne.variant&&ht.push(Ne.variant),Ne.variant!=Ne.weight&&ht.push(Ne.weight),en&&Ne.weight!=Ne.stretch&&ht.push(Ne.stretch),Ge.font[Qe]={baseString:rt,family:dt,weight:Ne.weight,stretch:Ne.stretch,style:Ne.style,variant:Ne.variant,width:{},kerning:{},metrics:mr(dt,{origin:"top",fontSize:GlText.baseFontSize,fontStyle:ht.join(" ")})},GlText.fonts[rt]=Ge.font[Qe]}})),(nt||at)&&this.font.forEach((function(Qe,rt){var nt=tt.stringify({size:Ge.fontSize[rt],family:Qe.family,stretch:en?Qe.stretch:void 0,variant:Qe.variant,weight:Qe.weight,style:Qe.style});if(Ge.fontAtlas[rt]=Ge.shader.atlas[nt],!Ge.fontAtlas[rt]){var at=Qe.metrics;Ge.shader.atlas[nt]=Ge.fontAtlas[rt]={fontString:nt,step:2*Math.ceil(Ge.fontSize[rt]*at.bottom*.5),em:Ge.fontSize[rt],cols:0,rows:0,height:0,width:0,chars:[],ids:{},texture:Ge.regl.texture()}}null==Ne.text&&(Ne.text=Ge.text)})),"string"==typeof Ne.text&&Ne.position&&Ne.position.length>2){for(var it=Array(.5*Ne.position.length),Ot=0;Ot<it.length;Ot++)it[Ot]=Ne.text;Ne.text=it}if(null!=Ne.text||nt){if(this.textOffsets=[0],Array.isArray(Ne.text)){this.count=Ne.text[0].length,this.counts=[this.count];for(var Ar=1;Ar<Ne.text.length;Ar++)this.textOffsets[Ar]=this.textOffsets[Ar-1]+Ne.text[Ar-1].length,this.count+=Ne.text[Ar].length,this.counts.push(Ne.text[Ar].length);this.text=Ne.text.join("")}else this.text=Ne.text,this.count=this.text.length,this.counts=[this.count];Qe=[],this.font.forEach((function(Ne,tt){GlText.atlasContext.font=Ne.baseString;for(var rt=Ge.fontAtlas[tt],nt=0;nt<Ge.text.length;nt++){var at=Ge.text.charAt(nt);if(null==rt.ids[at]&&(rt.ids[at]=rt.chars.length,rt.chars.push(at),Qe.push(at)),null==Ne.width[at]&&(Ne.width[at]=GlText.atlasContext.measureText(at).width/GlText.baseFontSize,Ge.kerning)){var it=[];for(var ot in Ne.width)it.push(ot+at,at+ot);dr(Ne.kerning,er(Ne.family,{pairs:it}))}}}))}if(Ne.position)if(Ne.position.length>2){for(var mn=!Ne.position[0].length,xn=ht.mallocFloat(2*this.count),kn=0,Cn=0;kn<this.counts.length;kn++){var En=this.counts[kn];if(mn)for(var Pn=0;Pn<En;Pn++)xn[Cn++]=Ne.position[2*kn],xn[Cn++]=Ne.position[2*kn+1];else for(var Dn=0;Dn<En;Dn++)xn[Cn++]=Ne.position[kn][0],xn[Cn++]=Ne.position[kn][1]}this.position.call?this.position({type:"float",data:xn}):this.position=this.regl.buffer({type:"float",data:xn}),ht.freeFloat(xn)}else this.position.destroy&&this.position.destroy(),this.position={constant:Ne.position};if(Ne.text||nt){var In=ht.mallocUint8(this.count),zn=ht.mallocFloat(2*this.count);this.textWidth=[];for(var Bn=0,Vn=0;Bn<this.counts.length;Bn++){for(var Hn=this.counts[Bn],qn=this.font[Bn]||this.font[0],Yn=this.fontAtlas[Bn]||this.fontAtlas[0],$n=0;$n<Hn;$n++){var ra=this.text.charAt(Vn),oa=this.text.charAt(Vn-1);if(In[Vn]=Yn.ids[ra],zn[2*Vn]=qn.width[ra],$n){var pa=zn[2*Vn-2],ga=zn[2*Vn],ma=zn[2*Vn-1]+.5*pa+.5*ga;if(this.kerning){var _a=qn.kerning[oa+ra];_a&&(ma+=.001*_a)}zn[2*Vn+1]=ma}else zn[2*Vn+1]=.5*zn[2*Vn];Vn++}this.textWidth.push(zn.length?.5*zn[2*Vn-2]+zn[2*Vn-1]:0)}Ne.align||(Ne.align=this.align),this.charBuffer({data:In,type:"uint8",usage:"stream"}),this.sizeBuffer({data:zn,type:"float",usage:"stream"}),ht.freeUint8(In),ht.freeFloat(zn),Qe.length&&this.font.forEach((function(Ne,Qe){var tt=Ge.fontAtlas[Qe],rt=tt.step,nt=Math.floor(GlText.maxAtlasSize/rt),at=Math.min(nt,tt.chars.length),it=Math.ceil(tt.chars.length/at),ot=br(at*rt),ht=br(it*rt);tt.width=ot,tt.height=ht,tt.rows=it,tt.cols=at,tt.em&&tt.texture({data:dt({canvas:GlText.atlasCanvas,font:tt.fontString,chars:tt.chars,shape:[ot,ht],step:[rt,rt]})})}))}if(Ne.align&&(this.align=Ne.align,this.alignOffset=this.textWidth.map((function(Ne,Qe){var tt=Array.isArray(Ge.align)?Ge.align.length>1?Ge.align[Qe]:Ge.align[0]:Ge.align;if("number"==typeof tt)return tt;switch(tt){case"right":case"end":return-Ne;case"center":case"centre":case"middle":return.5*-Ne}return 0}))),null==this.baseline&&null==Ne.baseline&&(Ne.baseline=0),null!=Ne.baseline&&(this.baseline=Ne.baseline,Array.isArray(this.baseline)||(this.baseline=[this.baseline]),this.baselineOffset=this.baseline.map((function(Ne,Qe){var tt=(Ge.font[Qe]||Ge.font[0]).metrics,rt=0;return rt+=.5*tt.bottom,rt+="number"==typeof Ne?Ne-tt.baseline:-tt[Ne],GlText.normalViewport||(rt*=-1),rt}))),null!=Ne.color)if(Ne.color||(Ne.color="transparent"),"string"!=typeof Ne.color&&isNaN(Ne.color)){var Va;if("number"==typeof Ne.color[0]&&Ne.color.length>this.counts.length){var Wa=Ne.color.length;Va=ht.mallocUint8(Wa);for(var Qa=(Ne.color.subarray||Ne.color.slice).bind(Ne.color),ti=0;ti<Wa;ti+=4)Va.set(ot(Qa(ti,ti+4),"uint8"),ti)}else{var ni=Ne.color.length;Va=ht.mallocUint8(4*ni);for(var di=0;di<ni;di++)Va.set(ot(Ne.color[di]||0,"uint8"),4*di)}this.color=Va}else this.color=ot(Ne.color,"uint8");if(Ne.position||Ne.text||Ne.color||Ne.baseline||Ne.align||Ne.font||Ne.offset||Ne.opacity)if(this.color.length>4||this.baselineOffset.length>1||this.align&&this.align.length>1||this.fontAtlas.length>1||this.positionOffset.length>2){var ji=Math.max(.5*this.position.length||0,.25*this.color.length||0,this.baselineOffset.length||0,this.alignOffset.length||0,this.font.length||0,this.opacity.length||0,.5*this.positionOffset.length||0);this.batch=Array(ji);for(var Hi=0;Hi<this.batch.length;Hi++)this.batch[Hi]={count:this.counts.length>1?this.counts[Hi]:this.counts[0],offset:this.textOffsets.length>1?this.textOffsets[Hi]:this.textOffsets[0],color:this.color?this.color.length<=4?this.color:this.color.subarray(4*Hi,4*Hi+4):[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[Hi]:this.opacity,baseline:null!=this.baselineOffset[Hi]?this.baselineOffset[Hi]:this.baselineOffset[0],align:this.align?null!=this.alignOffset[Hi]?this.alignOffset[Hi]:this.alignOffset[0]:0,atlas:this.fontAtlas[Hi]||this.fontAtlas[0],positionOffset:this.positionOffset.length>2?this.positionOffset.subarray(2*Hi,2*Hi+2):this.positionOffset}}else this.count?this.batch=[{count:this.count,offset:0,color:this.color||[0,0,0,255],opacity:Array.isArray(this.opacity)?this.opacity[0]:this.opacity,baseline:this.baselineOffset[0],align:this.alignOffset?this.alignOffset[0]:0,atlas:this.fontAtlas[0],positionOffset:this.positionOffset}]:this.batch=[]},GlText.prototype.destroy=function(){},GlText.prototype.kerning=!0,GlText.prototype.position={constant:new Float32Array(2)},GlText.prototype.translate=null,GlText.prototype.scale=null,GlText.prototype.font=null,GlText.prototype.text="",GlText.prototype.positionOffset=[0,0],GlText.prototype.opacity=1,GlText.prototype.color=new Uint8Array([0,0,0,255]),GlText.prototype.alignOffset=[0,0],GlText.normalViewport=!1,GlText.maxAtlasSize=1024,GlText.atlasCanvas=document.createElement("canvas"),GlText.atlasContext=GlText.atlasCanvas.getContext("2d",{alpha:!1}),GlText.baseFontSize=64,GlText.fonts={},Ge.exports=GlText},{"bit-twiddle":97,"color-normalize":125,"css-font":144,"detect-kerning":172,"es6-weak-map":233,"flatten-vertex-data":244,"font-atlas":245,"font-measure":246,"gl-util/context":354,"is-plain-obj":469,"object-assign":499,"parse-rect":504,"parse-unit":506,"pick-by-alias":511,regl:540,"to-px":578,"typedarray-pool":595}],353:[function(Ne,Ge,Qe){"use strict";var tt=Ne("ndarray"),rt=Ne("ndarray-ops"),nt=Ne("typedarray-pool");Ge.exports=createTexture2D;var at=null,it=null,ot=null;function lazyInitLinearTypes(Ne){at=[Ne.LINEAR,Ne.NEAREST_MIPMAP_LINEAR,Ne.LINEAR_MIPMAP_NEAREST,Ne.LINEAR_MIPMAP_NEAREST],it=[Ne.NEAREST,Ne.LINEAR,Ne.NEAREST_MIPMAP_NEAREST,Ne.NEAREST_MIPMAP_LINEAR,Ne.LINEAR_MIPMAP_NEAREST,Ne.LINEAR_MIPMAP_LINEAR],ot=[Ne.REPEAT,Ne.CLAMP_TO_EDGE,Ne.MIRRORED_REPEAT]}function acceptTextureDOM(Ne){return"undefined"!=typeof HTMLCanvasElement&&Ne instanceof HTMLCanvasElement||"undefined"!=typeof HTMLImageElement&&Ne instanceof HTMLImageElement||"undefined"!=typeof HTMLVideoElement&&Ne instanceof HTMLVideoElement||"undefined"!=typeof ImageData&&Ne instanceof ImageData}var convertFloatToUint8=function(Ne,Ge){rt.muls(Ne,Ge,255)};function reshapeTexture(Ne,Ge,Qe){var tt=Ne.gl,rt=tt.getParameter(tt.MAX_TEXTURE_SIZE);if(Ge<0||Ge>rt||Qe<0||Qe>rt)throw new Error("gl-texture2d: Invalid texture size");return Ne._shape=[Ge,Qe],Ne.bind(),tt.texImage2D(tt.TEXTURE_2D,0,Ne.format,Ge,Qe,0,Ne.format,Ne.type,null),Ne._mipLevels=[0],Ne}function Texture2D(Ne,Ge,Qe,tt,rt,nt){this.gl=Ne,this.handle=Ge,this.format=rt,this.type=nt,this._shape=[Qe,tt],this._mipLevels=[0],this._magFilter=Ne.NEAREST,this._minFilter=Ne.NEAREST,this._wrapS=Ne.CLAMP_TO_EDGE,this._wrapT=Ne.CLAMP_TO_EDGE,this._anisoSamples=1;var at=this,it=[this._wrapS,this._wrapT];Object.defineProperties(it,[{get:function(){return at._wrapS},set:function(Ne){return at.wrapS=Ne}},{get:function(){return at._wrapT},set:function(Ne){return at.wrapT=Ne}}]),this._wrapVector=it;var ot=[this._shape[0],this._shape[1]];Object.defineProperties(ot,[{get:function(){return at._shape[0]},set:function(Ne){return at.width=Ne}},{get:function(){return at._shape[1]},set:function(Ne){return at.height=Ne}}]),this._shapeVector=ot}var dt=Texture2D.prototype;function isPacked(Ne,Ge){return 3===Ne.length?1===Ge[2]&&Ge[1]===Ne[0]*Ne[2]&&Ge[0]===Ne[2]:1===Ge[0]&&Ge[1]===Ne[0]}function texSubImageArray(Ne,Ge,Qe,at,it,ot,dt,ht){var Dt=ht.dtype,Ot=ht.shape.slice();if(Ot.length<2||Ot.length>3)throw new Error("gl-texture2d: Invalid ndarray, must be 2d or 3d");var Rt=0,Zt=0,er=isPacked(Ot,ht.stride.slice());if("float32"===Dt?Rt=Ne.FLOAT:"float64"===Dt?(Rt=Ne.FLOAT,er=!1,Dt="float32"):"uint8"===Dt?Rt=Ne.UNSIGNED_BYTE:(Rt=Ne.UNSIGNED_BYTE,er=!1,Dt="uint8"),2===Ot.length)Zt=Ne.LUMINANCE,Ot=[Ot[0],Ot[1],1],ht=tt(ht.data,Ot,[ht.stride[0],ht.stride[1],1],ht.offset);else{if(3!==Ot.length)throw new Error("gl-texture2d: Invalid shape for texture");if(1===Ot[2])Zt=Ne.ALPHA;else if(2===Ot[2])Zt=Ne.LUMINANCE_ALPHA;else if(3===Ot[2])Zt=Ne.RGB;else{if(4!==Ot[2])throw new Error("gl-texture2d: Invalid shape for pixel coords");Zt=Ne.RGBA}Ot[2]}if(Zt!==Ne.LUMINANCE&&Zt!==Ne.ALPHA||it!==Ne.LUMINANCE&&it!==Ne.ALPHA||(Zt=it),Zt!==it)throw new Error("gl-texture2d: Incompatible texture format for setPixels");var dr=ht.size,mr=dt.indexOf(at)<0;if(mr&&dt.push(at),Rt===ot&&er)0===ht.offset&&ht.data.length===dr?mr?Ne.texImage2D(Ne.TEXTURE_2D,at,it,Ot[0],Ot[1],0,it,ot,ht.data):Ne.texSubImage2D(Ne.TEXTURE_2D,at,Ge,Qe,Ot[0],Ot[1],it,ot,ht.data):mr?Ne.texImage2D(Ne.TEXTURE_2D,at,it,Ot[0],Ot[1],0,it,ot,ht.data.subarray(ht.offset,ht.offset+dr)):Ne.texSubImage2D(Ne.TEXTURE_2D,at,Ge,Qe,Ot[0],Ot[1],it,ot,ht.data.subarray(ht.offset,ht.offset+dr));else{var xr;xr=ot===Ne.FLOAT?nt.mallocFloat32(dr):nt.mallocUint8(dr);var br=tt(xr,Ot,[Ot[2],Ot[2]*Ot[0],1]);Rt===Ne.FLOAT&&ot===Ne.UNSIGNED_BYTE?convertFloatToUint8(br,ht):rt.assign(br,ht),mr?Ne.texImage2D(Ne.TEXTURE_2D,at,it,Ot[0],Ot[1],0,it,ot,xr.subarray(0,dr)):Ne.texSubImage2D(Ne.TEXTURE_2D,at,Ge,Qe,Ot[0],Ot[1],it,ot,xr.subarray(0,dr)),ot===Ne.FLOAT?nt.freeFloat32(xr):nt.freeUint8(xr)}}function initTexture(Ne){var Ge=Ne.createTexture();return Ne.bindTexture(Ne.TEXTURE_2D,Ge),Ne.texParameteri(Ne.TEXTURE_2D,Ne.TEXTURE_MIN_FILTER,Ne.NEAREST),Ne.texParameteri(Ne.TEXTURE_2D,Ne.TEXTURE_MAG_FILTER,Ne.NEAREST),Ne.texParameteri(Ne.TEXTURE_2D,Ne.TEXTURE_WRAP_S,Ne.CLAMP_TO_EDGE),Ne.texParameteri(Ne.TEXTURE_2D,Ne.TEXTURE_WRAP_T,Ne.CLAMP_TO_EDGE),Ge}function createTextureShape(Ne,Ge,Qe,tt,rt){var nt=Ne.getParameter(Ne.MAX_TEXTURE_SIZE);if(Ge<0||Ge>nt||Qe<0||Qe>nt)throw new Error("gl-texture2d: Invalid texture shape");if(rt===Ne.FLOAT&&!Ne.getExtension("OES_texture_float"))throw new Error("gl-texture2d: Floating point textures not supported on this platform");var at=initTexture(Ne);return Ne.texImage2D(Ne.TEXTURE_2D,0,tt,Ge,Qe,0,tt,rt,null),new Texture2D(Ne,at,Ge,Qe,tt,rt)}function createTextureDOM(Ne,Ge,Qe,tt,rt,nt){var at=initTexture(Ne);return Ne.texImage2D(Ne.TEXTURE_2D,0,rt,rt,nt,Ge),new Texture2D(Ne,at,Qe,tt,rt,nt)}function createTextureArray(Ne,Ge){var Qe=Ge.dtype,at=Ge.shape.slice(),it=Ne.getParameter(Ne.MAX_TEXTURE_SIZE);if(at[0]<0||at[0]>it||at[1]<0||at[1]>it)throw new Error("gl-texture2d: Invalid texture size");var ot=isPacked(at,Ge.stride.slice()),dt=0;"float32"===Qe?dt=Ne.FLOAT:"float64"===Qe?(dt=Ne.FLOAT,ot=!1,Qe="float32"):"uint8"===Qe?dt=Ne.UNSIGNED_BYTE:(dt=Ne.UNSIGNED_BYTE,ot=!1,Qe="uint8");var ht,Dt,Ot=0;if(2===at.length)Ot=Ne.LUMINANCE,at=[at[0],at[1],1],Ge=tt(Ge.data,at,[Ge.stride[0],Ge.stride[1],1],Ge.offset);else{if(3!==at.length)throw new Error("gl-texture2d: Invalid shape for texture");if(1===at[2])Ot=Ne.ALPHA;else if(2===at[2])Ot=Ne.LUMINANCE_ALPHA;else if(3===at[2])Ot=Ne.RGB;else{if(4!==at[2])throw new Error("gl-texture2d: Invalid shape for pixel coords");Ot=Ne.RGBA}}dt!==Ne.FLOAT||Ne.getExtension("OES_texture_float")||(dt=Ne.UNSIGNED_BYTE,ot=!1);var Rt=Ge.size;if(ot)ht=0===Ge.offset&&Ge.data.length===Rt?Ge.data:Ge.data.subarray(Ge.offset,Ge.offset+Rt);else{var Zt=[at[2],at[2]*at[0],1];Dt=nt.malloc(Rt,Qe);var er=tt(Dt,at,Zt,0);"float32"!==Qe&&"float64"!==Qe||dt!==Ne.UNSIGNED_BYTE?rt.assign(er,Ge):convertFloatToUint8(er,Ge),ht=Dt.subarray(0,Rt)}var dr=initTexture(Ne);return Ne.texImage2D(Ne.TEXTURE_2D,0,Ot,at[0],at[1],0,Ot,dt,ht),ot||nt.free(Dt),new Texture2D(Ne,dr,at[0],at[1],Ot,dt)}function createTexture2D(Ne){if(arguments.length<=1)throw new Error("gl-texture2d: Missing arguments for texture2d constructor");if(at||lazyInitLinearTypes(Ne),"number"==typeof arguments[1])return createTextureShape(Ne,arguments[1],arguments[2],arguments[3]||Ne.RGBA,arguments[4]||Ne.UNSIGNED_BYTE);if(Array.isArray(arguments[1]))return createTextureShape(Ne,0|arguments[1][0],0|arguments[1][1],arguments[2]||Ne.RGBA,arguments[3]||Ne.UNSIGNED_BYTE);if("object"==typeof arguments[1]){var Ge=arguments[1],Qe=acceptTextureDOM(Ge)?Ge:Ge.raw;if(Qe)return createTextureDOM(Ne,Qe,0|Ge.width,0|Ge.height,arguments[2]||Ne.RGBA,arguments[3]||Ne.UNSIGNED_BYTE);if(Ge.shape&&Ge.data&&Ge.stride)return createTextureArray(Ne,Ge)}throw new Error("gl-texture2d: Invalid arguments for texture2d constructor")}Object.defineProperties(dt,{minFilter:{get:function(){return this._minFilter},set:function(Ne){this.bind();var Ge=this.gl;if(this.type===Ge.FLOAT&&at.indexOf(Ne)>=0&&(Ge.getExtension("OES_texture_float_linear")||(Ne=Ge.NEAREST)),it.indexOf(Ne)<0)throw new Error("gl-texture2d: Unknown filter mode "+Ne);return Ge.texParameteri(Ge.TEXTURE_2D,Ge.TEXTURE_MIN_FILTER,Ne),this._minFilter=Ne}},magFilter:{get:function(){return this._magFilter},set:function(Ne){this.bind();var Ge=this.gl;if(this.type===Ge.FLOAT&&at.indexOf(Ne)>=0&&(Ge.getExtension("OES_texture_float_linear")||(Ne=Ge.NEAREST)),it.indexOf(Ne)<0)throw new Error("gl-texture2d: Unknown filter mode "+Ne);return Ge.texParameteri(Ge.TEXTURE_2D,Ge.TEXTURE_MAG_FILTER,Ne),this._magFilter=Ne}},mipSamples:{get:function(){return this._anisoSamples},set:function(Ne){var Ge=this._anisoSamples;if(this._anisoSamples=0|Math.max(Ne,1),Ge!==this._anisoSamples){var Qe=this.gl.getExtension("EXT_texture_filter_anisotropic");Qe&&this.gl.texParameterf(this.gl.TEXTURE_2D,Qe.TEXTURE_MAX_ANISOTROPY_EXT,this._anisoSamples)}return this._anisoSamples}},wrapS:{get:function(){return this._wrapS},set:function(Ne){if(this.bind(),ot.indexOf(Ne)<0)throw new Error("gl-texture2d: Unknown wrap mode "+Ne);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,Ne),this._wrapS=Ne}},wrapT:{get:function(){return this._wrapT},set:function(Ne){if(this.bind(),ot.indexOf(Ne)<0)throw new Error("gl-texture2d: Unknown wrap mode "+Ne);return this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,Ne),this._wrapT=Ne}},wrap:{get:function(){return this._wrapVector},set:function(Ne){if(Array.isArray(Ne)||(Ne=[Ne,Ne]),2!==Ne.length)throw new Error("gl-texture2d: Must specify wrap mode for rows and columns");for(var Ge=0;Ge<2;++Ge)if(ot.indexOf(Ne[Ge])<0)throw new Error("gl-texture2d: Unknown wrap mode "+Ne);this._wrapS=Ne[0],this._wrapT=Ne[1];var Qe=this.gl;return this.bind(),Qe.texParameteri(Qe.TEXTURE_2D,Qe.TEXTURE_WRAP_S,this._wrapS),Qe.texParameteri(Qe.TEXTURE_2D,Qe.TEXTURE_WRAP_T,this._wrapT),Ne}},shape:{get:function(){return this._shapeVector},set:function(Ne){if(Array.isArray(Ne)){if(2!==Ne.length)throw new Error("gl-texture2d: Invalid texture shape")}else Ne=[0|Ne,0|Ne];return reshapeTexture(this,0|Ne[0],0|Ne[1]),[0|Ne[0],0|Ne[1]]}},width:{get:function(){return this._shape[0]},set:function(Ne){return reshapeTexture(this,Ne|=0,this._shape[1]),Ne}},height:{get:function(){return this._shape[1]},set:function(Ne){return Ne|=0,reshapeTexture(this,this._shape[0],Ne),Ne}}}),dt.bind=function(Ne){var Ge=this.gl;return void 0!==Ne&&Ge.activeTexture(Ge.TEXTURE0+(0|Ne)),Ge.bindTexture(Ge.TEXTURE_2D,this.handle),void 0!==Ne?0|Ne:Ge.getParameter(Ge.ACTIVE_TEXTURE)-Ge.TEXTURE0},dt.dispose=function(){this.gl.deleteTexture(this.handle)},dt.generateMipmap=function(){this.bind(),this.gl.generateMipmap(this.gl.TEXTURE_2D);for(var Ne=Math.min(this._shape[0],this._shape[1]),Ge=0;Ne>0;++Ge,Ne>>>=1)this._mipLevels.indexOf(Ge)<0&&this._mipLevels.push(Ge)},dt.setPixels=function(Ne,Ge,Qe,tt){var rt=this.gl;this.bind(),Array.isArray(Ge)?(tt=Qe,Qe=0|Ge[1],Ge=0|Ge[0]):(Ge=Ge||0,Qe=Qe||0),tt=tt||0;var nt=acceptTextureDOM(Ne)?Ne:Ne.raw;if(nt)this._mipLevels.indexOf(tt)<0?(rt.texImage2D(rt.TEXTURE_2D,0,this.format,this.format,this.type,nt),this._mipLevels.push(tt)):rt.texSubImage2D(rt.TEXTURE_2D,tt,Ge,Qe,this.format,this.type,nt);else{if(!(Ne.shape&&Ne.stride&&Ne.data))throw new Error("gl-texture2d: Unsupported data type");if(Ne.shape.length<2||Ge+Ne.shape[1]>this._shape[1]>>>tt||Qe+Ne.shape[0]>this._shape[0]>>>tt||Ge<0||Qe<0)throw new Error("gl-texture2d: Texture dimensions are out of bounds");texSubImageArray(rt,Ge,Qe,tt,this.format,this.type,this._mipLevels,Ne)}}},{ndarray:495,"ndarray-ops":490,"typedarray-pool":595}],354:[function(Ne,Ge,tt){(function(Qe){(function(){"use strict";var tt=Ne("pick-by-alias");function resize(Ne){if(Ne.container)if(Ne.container==document.body)document.body.style.width||(Ne.canvas.width=Ne.width||Ne.pixelRatio*Qe.innerWidth),document.body.style.height||(Ne.canvas.height=Ne.height||Ne.pixelRatio*Qe.innerHeight);else{var Ge=Ne.container.getBoundingClientRect();Ne.canvas.width=Ne.width||Ge.right-Ge.left,Ne.canvas.height=Ne.height||Ge.bottom-Ge.top}}function isCanvas(Ne){return"function"==typeof Ne.getContext&&"width"in Ne&&"height"in Ne}function isElement(Ne){return"string"==typeof Ne.nodeName&&"function"==typeof Ne.appendChild&&"function"==typeof Ne.getBoundingClientRect}function isContext(Ne){return"function"==typeof Ne.drawArrays||"function"==typeof Ne.drawElements}function createCanvas(){var Ne=document.createElement("canvas");return Ne.style.position="absolute",Ne.style.top=0,Ne.style.left=0,Ne}Ge.exports=function(Ne){if(Ne?"string"==typeof Ne&&(Ne={container:Ne}):Ne={},(Ne=isCanvas(Ne)||isElement(Ne)?{container:Ne}:isContext(Ne)?{gl:Ne}:tt(Ne,{container:"container target element el canvas holder parent parentNode wrapper use ref root node",gl:"gl context webgl glContext",attrs:"attributes attrs contextAttributes",pixelRatio:"pixelRatio pxRatio px ratio pxratio pixelratio",width:"w width",height:"h height"},!0)).pixelRatio||(Ne.pixelRatio=Qe.pixelRatio||1),Ne.gl)return Ne.gl;if(Ne.canvas&&(Ne.container=Ne.canvas.parentNode),Ne.container){if("string"==typeof Ne.container){var Ge=document.querySelector(Ne.container);if(!Ge)throw Error("Element "+Ne.container+" is not found");Ne.container=Ge}isCanvas(Ne.container)?(Ne.canvas=Ne.container,Ne.container=Ne.canvas.parentNode):Ne.canvas||(Ne.canvas=createCanvas(),Ne.container.appendChild(Ne.canvas),resize(Ne))}else if(!Ne.canvas){if("undefined"==typeof document)throw Error("Not DOM environment. Use headless-gl.");Ne.container=document.body||document.documentElement,Ne.canvas=createCanvas(),Ne.container.appendChild(Ne.canvas),resize(Ne)}if(!Ne.gl)try{Ne.gl=Ne.canvas.getContext("webgl",Ne.attrs)}catch(Ge){try{Ne.gl=Ne.canvas.getContext("experimental-webgl",Ne.attrs)}catch(Ge){Ne.gl=Ne.canvas.getContext("webgl-experimental",Ne.attrs)}}return Ne.gl}}).call(this)}).call(this,void 0!==Qe.g?Qe.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"pick-by-alias":511}],355:[function(Ne,Ge,Qe){"use strict";function doBind(Ne,Ge,Qe){Ge?Ge.bind():Ne.bindBuffer(Ne.ELEMENT_ARRAY_BUFFER,null);var tt=0|Ne.getParameter(Ne.MAX_VERTEX_ATTRIBS);if(Qe){if(Qe.length>tt)throw new Error("gl-vao: Too many vertex attributes");for(var rt=0;rt<Qe.length;++rt){var nt=Qe[rt];if(nt.buffer){var at=nt.buffer,it=nt.size||4,ot=nt.type||Ne.FLOAT,dt=!!nt.normalized,ht=nt.stride||0,Dt=nt.offset||0;at.bind(),Ne.enableVertexAttribArray(rt),Ne.vertexAttribPointer(rt,it,ot,dt,ht,Dt)}else{if("number"==typeof nt)Ne.vertexAttrib1f(rt,nt);else if(1===nt.length)Ne.vertexAttrib1f(rt,nt[0]);else if(2===nt.length)Ne.vertexAttrib2f(rt,nt[0],nt[1]);else if(3===nt.length)Ne.vertexAttrib3f(rt,nt[0],nt[1],nt[2]);else{if(4!==nt.length)throw new Error("gl-vao: Invalid vertex attribute");Ne.vertexAttrib4f(rt,nt[0],nt[1],nt[2],nt[3])}Ne.disableVertexAttribArray(rt)}}for(;rt<tt;++rt)Ne.disableVertexAttribArray(rt)}else for(Ne.bindBuffer(Ne.ARRAY_BUFFER,null),rt=0;rt<tt;++rt)Ne.disableVertexAttribArray(rt)}Ge.exports=doBind},{}],356:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./do-bind.js");function VAOEmulated(Ne){this.gl=Ne,this._elements=null,this._attributes=null,this._elementsType=Ne.UNSIGNED_SHORT}function createVAOEmulated(Ne){return new VAOEmulated(Ne)}VAOEmulated.prototype.bind=function(){tt(this.gl,this._elements,this._attributes)},VAOEmulated.prototype.update=function(Ne,Ge,Qe){this._elements=Ge,this._attributes=Ne,this._elementsType=Qe||this.gl.UNSIGNED_SHORT},VAOEmulated.prototype.dispose=function(){},VAOEmulated.prototype.unbind=function(){},VAOEmulated.prototype.draw=function(Ne,Ge,Qe){Qe=Qe||0;var tt=this.gl;this._elements?tt.drawElements(Ne,Ge,this._elementsType,Qe):tt.drawArrays(Ne,Qe,Ge)},Ge.exports=createVAOEmulated},{"./do-bind.js":355}],357:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./do-bind.js");function VertexAttribute(Ne,Ge,Qe,tt,rt,nt){this.location=Ne,this.dimension=Ge,this.a=Qe,this.b=tt,this.c=rt,this.d=nt}function VAONative(Ne,Ge,Qe){this.gl=Ne,this._ext=Ge,this.handle=Qe,this._attribs=[],this._useElements=!1,this._elementsType=Ne.UNSIGNED_SHORT}function createVAONative(Ne,Ge){return new VAONative(Ne,Ge,Ge.createVertexArrayOES())}VertexAttribute.prototype.bind=function(Ne){switch(this.dimension){case 1:Ne.vertexAttrib1f(this.location,this.a);break;case 2:Ne.vertexAttrib2f(this.location,this.a,this.b);break;case 3:Ne.vertexAttrib3f(this.location,this.a,this.b,this.c);break;case 4:Ne.vertexAttrib4f(this.location,this.a,this.b,this.c,this.d)}},VAONative.prototype.bind=function(){this._ext.bindVertexArrayOES(this.handle);for(var Ne=0;Ne<this._attribs.length;++Ne)this._attribs[Ne].bind(this.gl)},VAONative.prototype.unbind=function(){this._ext.bindVertexArrayOES(null)},VAONative.prototype.dispose=function(){this._ext.deleteVertexArrayOES(this.handle)},VAONative.prototype.update=function(Ne,Ge,Qe){if(this.bind(),tt(this.gl,Ge,Ne),this.unbind(),this._attribs.length=0,Ne)for(var rt=0;rt<Ne.length;++rt){var nt=Ne[rt];"number"==typeof nt?this._attribs.push(new VertexAttribute(rt,1,nt)):Array.isArray(nt)&&this._attribs.push(new VertexAttribute(rt,nt.length,nt[0],nt[1],nt[2],nt[3]))}this._useElements=!!Ge,this._elementsType=Qe||this.gl.UNSIGNED_SHORT},VAONative.prototype.draw=function(Ne,Ge,Qe){Qe=Qe||0;var tt=this.gl;this._useElements?tt.drawElements(Ne,Ge,this._elementsType,Qe):tt.drawArrays(Ne,Qe,Ge)},Ge.exports=createVAONative},{"./do-bind.js":355}],358:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./lib/vao-native.js"),rt=Ne("./lib/vao-emulated.js");function ExtensionShim(Ne){this.bindVertexArrayOES=Ne.bindVertexArray.bind(Ne),this.createVertexArrayOES=Ne.createVertexArray.bind(Ne),this.deleteVertexArrayOES=Ne.deleteVertexArray.bind(Ne)}function createVAO(Ne,Ge,Qe,nt){var at,it=Ne.createVertexArray?new ExtensionShim(Ne):Ne.getExtension("OES_vertex_array_object");return(at=it?tt(Ne,it):rt(Ne)).update(Ge,Qe,nt),at}Ge.exports=createVAO},{"./lib/vao-emulated.js":356,"./lib/vao-native.js":357}],359:[function(Ne,Ge,Qe){function add(Ne,Ge,Qe){return Ne[0]=Ge[0]+Qe[0],Ne[1]=Ge[1]+Qe[1],Ne[2]=Ge[2]+Qe[2],Ne}Ge.exports=add},{}],360:[function(Ne,Ge,Qe){Ge.exports=angle;var tt=Ne("./fromValues"),rt=Ne("./normalize"),nt=Ne("./dot");function angle(Ne,Ge){var Qe=tt(Ne[0],Ne[1],Ne[2]),at=tt(Ge[0],Ge[1],Ge[2]);rt(Qe,Qe),rt(at,at);var it=nt(Qe,at);return it>1?0:Math.acos(it)}},{"./dot":370,"./fromValues":376,"./normalize":387}],361:[function(Ne,Ge,Qe){function ceil(Ne,Ge){return Ne[0]=Math.ceil(Ge[0]),Ne[1]=Math.ceil(Ge[1]),Ne[2]=Math.ceil(Ge[2]),Ne}Ge.exports=ceil},{}],362:[function(Ne,Ge,Qe){function clone(Ne){var Ge=new Float32Array(3);return Ge[0]=Ne[0],Ge[1]=Ne[1],Ge[2]=Ne[2],Ge}Ge.exports=clone},{}],363:[function(Ne,Ge,Qe){function copy(Ne,Ge){return Ne[0]=Ge[0],Ne[1]=Ge[1],Ne[2]=Ge[2],Ne}Ge.exports=copy},{}],364:[function(Ne,Ge,Qe){function create(){var Ne=new Float32Array(3);return Ne[0]=0,Ne[1]=0,Ne[2]=0,Ne}Ge.exports=create},{}],365:[function(Ne,Ge,Qe){function cross(Ne,Ge,Qe){var tt=Ge[0],rt=Ge[1],nt=Ge[2],at=Qe[0],it=Qe[1],ot=Qe[2];return Ne[0]=rt*ot-nt*it,Ne[1]=nt*at-tt*ot,Ne[2]=tt*it-rt*at,Ne}Ge.exports=cross},{}],366:[function(Ne,Ge,Qe){Ge.exports=Ne("./distance")},{"./distance":367}],367:[function(Ne,Ge,Qe){function distance(Ne,Ge){var Qe=Ge[0]-Ne[0],tt=Ge[1]-Ne[1],rt=Ge[2]-Ne[2];return Math.sqrt(Qe*Qe+tt*tt+rt*rt)}Ge.exports=distance},{}],368:[function(Ne,Ge,Qe){Ge.exports=Ne("./divide")},{"./divide":369}],369:[function(Ne,Ge,Qe){function divide(Ne,Ge,Qe){return Ne[0]=Ge[0]/Qe[0],Ne[1]=Ge[1]/Qe[1],Ne[2]=Ge[2]/Qe[2],Ne}Ge.exports=divide},{}],370:[function(Ne,Ge,Qe){function dot(Ne,Ge){return Ne[0]*Ge[0]+Ne[1]*Ge[1]+Ne[2]*Ge[2]}Ge.exports=dot},{}],371:[function(Ne,Ge,Qe){Ge.exports=1e-6},{}],372:[function(Ne,Ge,Qe){Ge.exports=equals;var tt=Ne("./epsilon");function equals(Ne,Ge){var Qe=Ne[0],rt=Ne[1],nt=Ne[2],at=Ge[0],it=Ge[1],ot=Ge[2];return Math.abs(Qe-at)<=tt*Math.max(1,Math.abs(Qe),Math.abs(at))&&Math.abs(rt-it)<=tt*Math.max(1,Math.abs(rt),Math.abs(it))&&Math.abs(nt-ot)<=tt*Math.max(1,Math.abs(nt),Math.abs(ot))}},{"./epsilon":371}],373:[function(Ne,Ge,Qe){function exactEquals(Ne,Ge){return Ne[0]===Ge[0]&&Ne[1]===Ge[1]&&Ne[2]===Ge[2]}Ge.exports=exactEquals},{}],374:[function(Ne,Ge,Qe){function floor(Ne,Ge){return Ne[0]=Math.floor(Ge[0]),Ne[1]=Math.floor(Ge[1]),Ne[2]=Math.floor(Ge[2]),Ne}Ge.exports=floor},{}],375:[function(Ne,Ge,Qe){Ge.exports=forEach;var tt=Ne("./create")();function forEach(Ne,Ge,Qe,rt,nt,at){var it,ot;for(Ge||(Ge=3),Qe||(Qe=0),ot=rt?Math.min(rt*Ge+Qe,Ne.length):Ne.length,it=Qe;it<ot;it+=Ge)tt[0]=Ne[it],tt[1]=Ne[it+1],tt[2]=Ne[it+2],nt(tt,tt,at),Ne[it]=tt[0],Ne[it+1]=tt[1],Ne[it+2]=tt[2];return Ne}},{"./create":364}],376:[function(Ne,Ge,Qe){function fromValues(Ne,Ge,Qe){var tt=new Float32Array(3);return tt[0]=Ne,tt[1]=Ge,tt[2]=Qe,tt}Ge.exports=fromValues},{}],377:[function(Ne,Ge,Qe){Ge.exports={EPSILON:Ne("./epsilon"),create:Ne("./create"),clone:Ne("./clone"),angle:Ne("./angle"),fromValues:Ne("./fromValues"),copy:Ne("./copy"),set:Ne("./set"),equals:Ne("./equals"),exactEquals:Ne("./exactEquals"),add:Ne("./add"),subtract:Ne("./subtract"),sub:Ne("./sub"),multiply:Ne("./multiply"),mul:Ne("./mul"),divide:Ne("./divide"),div:Ne("./div"),min:Ne("./min"),max:Ne("./max"),floor:Ne("./floor"),ceil:Ne("./ceil"),round:Ne("./round"),scale:Ne("./scale"),scaleAndAdd:Ne("./scaleAndAdd"),distance:Ne("./distance"),dist:Ne("./dist"),squaredDistance:Ne("./squaredDistance"),sqrDist:Ne("./sqrDist"),length:Ne("./length"),len:Ne("./len"),squaredLength:Ne("./squaredLength"),sqrLen:Ne("./sqrLen"),negate:Ne("./negate"),inverse:Ne("./inverse"),normalize:Ne("./normalize"),dot:Ne("./dot"),cross:Ne("./cross"),lerp:Ne("./lerp"),random:Ne("./random"),transformMat4:Ne("./transformMat4"),transformMat3:Ne("./transformMat3"),transformQuat:Ne("./transformQuat"),rotateX:Ne("./rotateX"),rotateY:Ne("./rotateY"),rotateZ:Ne("./rotateZ"),forEach:Ne("./forEach")}},{"./add":359,"./angle":360,"./ceil":361,"./clone":362,"./copy":363,"./create":364,"./cross":365,"./dist":366,"./distance":367,"./div":368,"./divide":369,"./dot":370,"./epsilon":371,"./equals":372,"./exactEquals":373,"./floor":374,"./forEach":375,"./fromValues":376,"./inverse":378,"./len":379,"./length":380,"./lerp":381,"./max":382,"./min":383,"./mul":384,"./multiply":385,"./negate":386,"./normalize":387,"./random":388,"./rotateX":389,"./rotateY":390,"./rotateZ":391,"./round":392,"./scale":393,"./scaleAndAdd":394,"./set":395,"./sqrDist":396,"./sqrLen":397,"./squaredDistance":398,"./squaredLength":399,"./sub":400,"./subtract":401,"./transformMat3":402,"./transformMat4":403,"./transformQuat":404}],378:[function(Ne,Ge,Qe){function inverse(Ne,Ge){return Ne[0]=1/Ge[0],Ne[1]=1/Ge[1],Ne[2]=1/Ge[2],Ne}Ge.exports=inverse},{}],379:[function(Ne,Ge,Qe){Ge.exports=Ne("./length")},{"./length":380}],380:[function(Ne,Ge,Qe){function length(Ne){var Ge=Ne[0],Qe=Ne[1],tt=Ne[2];return Math.sqrt(Ge*Ge+Qe*Qe+tt*tt)}Ge.exports=length},{}],381:[function(Ne,Ge,Qe){function lerp(Ne,Ge,Qe,tt){var rt=Ge[0],nt=Ge[1],at=Ge[2];return Ne[0]=rt+tt*(Qe[0]-rt),Ne[1]=nt+tt*(Qe[1]-nt),Ne[2]=at+tt*(Qe[2]-at),Ne}Ge.exports=lerp},{}],382:[function(Ne,Ge,Qe){function max(Ne,Ge,Qe){return Ne[0]=Math.max(Ge[0],Qe[0]),Ne[1]=Math.max(Ge[1],Qe[1]),Ne[2]=Math.max(Ge[2],Qe[2]),Ne}Ge.exports=max},{}],383:[function(Ne,Ge,Qe){function min(Ne,Ge,Qe){return Ne[0]=Math.min(Ge[0],Qe[0]),Ne[1]=Math.min(Ge[1],Qe[1]),Ne[2]=Math.min(Ge[2],Qe[2]),Ne}Ge.exports=min},{}],384:[function(Ne,Ge,Qe){Ge.exports=Ne("./multiply")},{"./multiply":385}],385:[function(Ne,Ge,Qe){function multiply(Ne,Ge,Qe){return Ne[0]=Ge[0]*Qe[0],Ne[1]=Ge[1]*Qe[1],Ne[2]=Ge[2]*Qe[2],Ne}Ge.exports=multiply},{}],386:[function(Ne,Ge,Qe){function negate(Ne,Ge){return Ne[0]=-Ge[0],Ne[1]=-Ge[1],Ne[2]=-Ge[2],Ne}Ge.exports=negate},{}],387:[function(Ne,Ge,Qe){function normalize(Ne,Ge){var Qe=Ge[0],tt=Ge[1],rt=Ge[2],nt=Qe*Qe+tt*tt+rt*rt;return nt>0&&(nt=1/Math.sqrt(nt),Ne[0]=Ge[0]*nt,Ne[1]=Ge[1]*nt,Ne[2]=Ge[2]*nt),Ne}Ge.exports=normalize},{}],388:[function(Ne,Ge,Qe){function random(Ne,Ge){Ge=Ge||1;var Qe=2*Math.random()*Math.PI,tt=2*Math.random()-1,rt=Math.sqrt(1-tt*tt)*Ge;return Ne[0]=Math.cos(Qe)*rt,Ne[1]=Math.sin(Qe)*rt,Ne[2]=tt*Ge,Ne}Ge.exports=random},{}],389:[function(Ne,Ge,Qe){function rotateX(Ne,Ge,Qe,tt){var rt=Qe[1],nt=Qe[2],at=Ge[1]-rt,it=Ge[2]-nt,ot=Math.sin(tt),dt=Math.cos(tt);return Ne[0]=Ge[0],Ne[1]=rt+at*dt-it*ot,Ne[2]=nt+at*ot+it*dt,Ne}Ge.exports=rotateX},{}],390:[function(Ne,Ge,Qe){function rotateY(Ne,Ge,Qe,tt){var rt=Qe[0],nt=Qe[2],at=Ge[0]-rt,it=Ge[2]-nt,ot=Math.sin(tt),dt=Math.cos(tt);return Ne[0]=rt+it*ot+at*dt,Ne[1]=Ge[1],Ne[2]=nt+it*dt-at*ot,Ne}Ge.exports=rotateY},{}],391:[function(Ne,Ge,Qe){function rotateZ(Ne,Ge,Qe,tt){var rt=Qe[0],nt=Qe[1],at=Ge[0]-rt,it=Ge[1]-nt,ot=Math.sin(tt),dt=Math.cos(tt);return Ne[0]=rt+at*dt-it*ot,Ne[1]=nt+at*ot+it*dt,Ne[2]=Ge[2],Ne}Ge.exports=rotateZ},{}],392:[function(Ne,Ge,Qe){function round(Ne,Ge){return Ne[0]=Math.round(Ge[0]),Ne[1]=Math.round(Ge[1]),Ne[2]=Math.round(Ge[2]),Ne}Ge.exports=round},{}],393:[function(Ne,Ge,Qe){function scale(Ne,Ge,Qe){return Ne[0]=Ge[0]*Qe,Ne[1]=Ge[1]*Qe,Ne[2]=Ge[2]*Qe,Ne}Ge.exports=scale},{}],394:[function(Ne,Ge,Qe){function scaleAndAdd(Ne,Ge,Qe,tt){return Ne[0]=Ge[0]+Qe[0]*tt,Ne[1]=Ge[1]+Qe[1]*tt,Ne[2]=Ge[2]+Qe[2]*tt,Ne}Ge.exports=scaleAndAdd},{}],395:[function(Ne,Ge,Qe){function set(Ne,Ge,Qe,tt){return Ne[0]=Ge,Ne[1]=Qe,Ne[2]=tt,Ne}Ge.exports=set},{}],396:[function(Ne,Ge,Qe){Ge.exports=Ne("./squaredDistance")},{"./squaredDistance":398}],397:[function(Ne,Ge,Qe){Ge.exports=Ne("./squaredLength")},{"./squaredLength":399}],398:[function(Ne,Ge,Qe){function squaredDistance(Ne,Ge){var Qe=Ge[0]-Ne[0],tt=Ge[1]-Ne[1],rt=Ge[2]-Ne[2];return Qe*Qe+tt*tt+rt*rt}Ge.exports=squaredDistance},{}],399:[function(Ne,Ge,Qe){function squaredLength(Ne){var Ge=Ne[0],Qe=Ne[1],tt=Ne[2];return Ge*Ge+Qe*Qe+tt*tt}Ge.exports=squaredLength},{}],400:[function(Ne,Ge,Qe){Ge.exports=Ne("./subtract")},{"./subtract":401}],401:[function(Ne,Ge,Qe){function subtract(Ne,Ge,Qe){return Ne[0]=Ge[0]-Qe[0],Ne[1]=Ge[1]-Qe[1],Ne[2]=Ge[2]-Qe[2],Ne}Ge.exports=subtract},{}],402:[function(Ne,Ge,Qe){function transformMat3(Ne,Ge,Qe){var tt=Ge[0],rt=Ge[1],nt=Ge[2];return Ne[0]=tt*Qe[0]+rt*Qe[3]+nt*Qe[6],Ne[1]=tt*Qe[1]+rt*Qe[4]+nt*Qe[7],Ne[2]=tt*Qe[2]+rt*Qe[5]+nt*Qe[8],Ne}Ge.exports=transformMat3},{}],403:[function(Ne,Ge,Qe){function transformMat4(Ne,Ge,Qe){var tt=Ge[0],rt=Ge[1],nt=Ge[2],at=Qe[3]*tt+Qe[7]*rt+Qe[11]*nt+Qe[15];return at=at||1,Ne[0]=(Qe[0]*tt+Qe[4]*rt+Qe[8]*nt+Qe[12])/at,Ne[1]=(Qe[1]*tt+Qe[5]*rt+Qe[9]*nt+Qe[13])/at,Ne[2]=(Qe[2]*tt+Qe[6]*rt+Qe[10]*nt+Qe[14])/at,Ne}Ge.exports=transformMat4},{}],404:[function(Ne,Ge,Qe){function transformQuat(Ne,Ge,Qe){var tt=Ge[0],rt=Ge[1],nt=Ge[2],at=Qe[0],it=Qe[1],ot=Qe[2],dt=Qe[3],ht=dt*tt+it*nt-ot*rt,Dt=dt*rt+ot*tt-at*nt,Ot=dt*nt+at*rt-it*tt,Rt=-at*tt-it*rt-ot*nt;return Ne[0]=ht*dt+Rt*-at+Dt*-ot-Ot*-it,Ne[1]=Dt*dt+Rt*-it+Ot*-at-ht*-ot,Ne[2]=Ot*dt+Rt*-ot+ht*-it-Dt*-at,Ne}Ge.exports=transformQuat},{}],405:[function(Ne,Ge,Qe){function add(Ne,Ge,Qe){return Ne[0]=Ge[0]+Qe[0],Ne[1]=Ge[1]+Qe[1],Ne[2]=Ge[2]+Qe[2],Ne[3]=Ge[3]+Qe[3],Ne}Ge.exports=add},{}],406:[function(Ne,Ge,Qe){function clone(Ne){var Ge=new Float32Array(4);return Ge[0]=Ne[0],Ge[1]=Ne[1],Ge[2]=Ne[2],Ge[3]=Ne[3],Ge}Ge.exports=clone},{}],407:[function(Ne,Ge,Qe){function copy(Ne,Ge){return Ne[0]=Ge[0],Ne[1]=Ge[1],Ne[2]=Ge[2],Ne[3]=Ge[3],Ne}Ge.exports=copy},{}],408:[function(Ne,Ge,Qe){function create(){var Ne=new Float32Array(4);return Ne[0]=0,Ne[1]=0,Ne[2]=0,Ne[3]=0,Ne}Ge.exports=create},{}],409:[function(Ne,Ge,Qe){function distance(Ne,Ge){var Qe=Ge[0]-Ne[0],tt=Ge[1]-Ne[1],rt=Ge[2]-Ne[2],nt=Ge[3]-Ne[3];return Math.sqrt(Qe*Qe+tt*tt+rt*rt+nt*nt)}Ge.exports=distance},{}],410:[function(Ne,Ge,Qe){function divide(Ne,Ge,Qe){return Ne[0]=Ge[0]/Qe[0],Ne[1]=Ge[1]/Qe[1],Ne[2]=Ge[2]/Qe[2],Ne[3]=Ge[3]/Qe[3],Ne}Ge.exports=divide},{}],411:[function(Ne,Ge,Qe){function dot(Ne,Ge){return Ne[0]*Ge[0]+Ne[1]*Ge[1]+Ne[2]*Ge[2]+Ne[3]*Ge[3]}Ge.exports=dot},{}],412:[function(Ne,Ge,Qe){function fromValues(Ne,Ge,Qe,tt){var rt=new Float32Array(4);return rt[0]=Ne,rt[1]=Ge,rt[2]=Qe,rt[3]=tt,rt}Ge.exports=fromValues},{}],413:[function(Ne,Ge,Qe){Ge.exports={create:Ne("./create"),clone:Ne("./clone"),fromValues:Ne("./fromValues"),copy:Ne("./copy"),set:Ne("./set"),add:Ne("./add"),subtract:Ne("./subtract"),multiply:Ne("./multiply"),divide:Ne("./divide"),min:Ne("./min"),max:Ne("./max"),scale:Ne("./scale"),scaleAndAdd:Ne("./scaleAndAdd"),distance:Ne("./distance"),squaredDistance:Ne("./squaredDistance"),length:Ne("./length"),squaredLength:Ne("./squaredLength"),negate:Ne("./negate"),inverse:Ne("./inverse"),normalize:Ne("./normalize"),dot:Ne("./dot"),lerp:Ne("./lerp"),random:Ne("./random"),transformMat4:Ne("./transformMat4"),transformQuat:Ne("./transformQuat")}},{"./add":405,"./clone":406,"./copy":407,"./create":408,"./distance":409,"./divide":410,"./dot":411,"./fromValues":412,"./inverse":414,"./length":415,"./lerp":416,"./max":417,"./min":418,"./multiply":419,"./negate":420,"./normalize":421,"./random":422,"./scale":423,"./scaleAndAdd":424,"./set":425,"./squaredDistance":426,"./squaredLength":427,"./subtract":428,"./transformMat4":429,"./transformQuat":430}],414:[function(Ne,Ge,Qe){function inverse(Ne,Ge){return Ne[0]=1/Ge[0],Ne[1]=1/Ge[1],Ne[2]=1/Ge[2],Ne[3]=1/Ge[3],Ne}Ge.exports=inverse},{}],415:[function(Ne,Ge,Qe){function length(Ne){var Ge=Ne[0],Qe=Ne[1],tt=Ne[2],rt=Ne[3];return Math.sqrt(Ge*Ge+Qe*Qe+tt*tt+rt*rt)}Ge.exports=length},{}],416:[function(Ne,Ge,Qe){function lerp(Ne,Ge,Qe,tt){var rt=Ge[0],nt=Ge[1],at=Ge[2],it=Ge[3];return Ne[0]=rt+tt*(Qe[0]-rt),Ne[1]=nt+tt*(Qe[1]-nt),Ne[2]=at+tt*(Qe[2]-at),Ne[3]=it+tt*(Qe[3]-it),Ne}Ge.exports=lerp},{}],417:[function(Ne,Ge,Qe){function max(Ne,Ge,Qe){return Ne[0]=Math.max(Ge[0],Qe[0]),Ne[1]=Math.max(Ge[1],Qe[1]),Ne[2]=Math.max(Ge[2],Qe[2]),Ne[3]=Math.max(Ge[3],Qe[3]),Ne}Ge.exports=max},{}],418:[function(Ne,Ge,Qe){function min(Ne,Ge,Qe){return Ne[0]=Math.min(Ge[0],Qe[0]),Ne[1]=Math.min(Ge[1],Qe[1]),Ne[2]=Math.min(Ge[2],Qe[2]),Ne[3]=Math.min(Ge[3],Qe[3]),Ne}Ge.exports=min},{}],419:[function(Ne,Ge,Qe){function multiply(Ne,Ge,Qe){return Ne[0]=Ge[0]*Qe[0],Ne[1]=Ge[1]*Qe[1],Ne[2]=Ge[2]*Qe[2],Ne[3]=Ge[3]*Qe[3],Ne}Ge.exports=multiply},{}],420:[function(Ne,Ge,Qe){function negate(Ne,Ge){return Ne[0]=-Ge[0],Ne[1]=-Ge[1],Ne[2]=-Ge[2],Ne[3]=-Ge[3],Ne}Ge.exports=negate},{}],421:[function(Ne,Ge,Qe){function normalize(Ne,Ge){var Qe=Ge[0],tt=Ge[1],rt=Ge[2],nt=Ge[3],at=Qe*Qe+tt*tt+rt*rt+nt*nt;return at>0&&(at=1/Math.sqrt(at),Ne[0]=Qe*at,Ne[1]=tt*at,Ne[2]=rt*at,Ne[3]=nt*at),Ne}Ge.exports=normalize},{}],422:[function(Ne,Ge,Qe){var tt=Ne("./normalize"),rt=Ne("./scale");function random(Ne,Ge){return Ge=Ge||1,Ne[0]=Math.random(),Ne[1]=Math.random(),Ne[2]=Math.random(),Ne[3]=Math.random(),tt(Ne,Ne),rt(Ne,Ne,Ge),Ne}Ge.exports=random},{"./normalize":421,"./scale":423}],423:[function(Ne,Ge,Qe){function scale(Ne,Ge,Qe){return Ne[0]=Ge[0]*Qe,Ne[1]=Ge[1]*Qe,Ne[2]=Ge[2]*Qe,Ne[3]=Ge[3]*Qe,Ne}Ge.exports=scale},{}],424:[function(Ne,Ge,Qe){function scaleAndAdd(Ne,Ge,Qe,tt){return Ne[0]=Ge[0]+Qe[0]*tt,Ne[1]=Ge[1]+Qe[1]*tt,Ne[2]=Ge[2]+Qe[2]*tt,Ne[3]=Ge[3]+Qe[3]*tt,Ne}Ge.exports=scaleAndAdd},{}],425:[function(Ne,Ge,Qe){function set(Ne,Ge,Qe,tt,rt){return Ne[0]=Ge,Ne[1]=Qe,Ne[2]=tt,Ne[3]=rt,Ne}Ge.exports=set},{}],426:[function(Ne,Ge,Qe){function squaredDistance(Ne,Ge){var Qe=Ge[0]-Ne[0],tt=Ge[1]-Ne[1],rt=Ge[2]-Ne[2],nt=Ge[3]-Ne[3];return Qe*Qe+tt*tt+rt*rt+nt*nt}Ge.exports=squaredDistance},{}],427:[function(Ne,Ge,Qe){function squaredLength(Ne){var Ge=Ne[0],Qe=Ne[1],tt=Ne[2],rt=Ne[3];return Ge*Ge+Qe*Qe+tt*tt+rt*rt}Ge.exports=squaredLength},{}],428:[function(Ne,Ge,Qe){function subtract(Ne,Ge,Qe){return Ne[0]=Ge[0]-Qe[0],Ne[1]=Ge[1]-Qe[1],Ne[2]=Ge[2]-Qe[2],Ne[3]=Ge[3]-Qe[3],Ne}Ge.exports=subtract},{}],429:[function(Ne,Ge,Qe){function transformMat4(Ne,Ge,Qe){var tt=Ge[0],rt=Ge[1],nt=Ge[2],at=Ge[3];return Ne[0]=Qe[0]*tt+Qe[4]*rt+Qe[8]*nt+Qe[12]*at,Ne[1]=Qe[1]*tt+Qe[5]*rt+Qe[9]*nt+Qe[13]*at,Ne[2]=Qe[2]*tt+Qe[6]*rt+Qe[10]*nt+Qe[14]*at,Ne[3]=Qe[3]*tt+Qe[7]*rt+Qe[11]*nt+Qe[15]*at,Ne}Ge.exports=transformMat4},{}],430:[function(Ne,Ge,Qe){function transformQuat(Ne,Ge,Qe){var tt=Ge[0],rt=Ge[1],nt=Ge[2],at=Qe[0],it=Qe[1],ot=Qe[2],dt=Qe[3],ht=dt*tt+it*nt-ot*rt,Dt=dt*rt+ot*tt-at*nt,Ot=dt*nt+at*rt-it*tt,Rt=-at*tt-it*rt-ot*nt;return Ne[0]=ht*dt+Rt*-at+Dt*-ot-Ot*-it,Ne[1]=Dt*dt+Rt*-it+Ot*-at-ht*-ot,Ne[2]=Ot*dt+Rt*-ot+ht*-it-Dt*-at,Ne[3]=Ge[3],Ne}Ge.exports=transformQuat},{}],431:[function(Ne,Ge,Qe){var tt=Ne("glsl-tokenizer"),rt=Ne("atob-lite");function getName(Ne){for(var Ge=Array.isArray(Ne)?Ne:tt(Ne),Qe=0;Qe<Ge.length;Qe++){var nt=Ge[Qe];if("preprocessor"===nt.type){var at=nt.data.match(/\#define\s+SHADER_NAME(_B64)?\s+(.+)$/);if(at&&at[2]){var it=at[1],ot=at[2];return(it?rt(ot):ot).trim()}}}}Ge.exports=getName},{"atob-lite":77,"glsl-tokenizer":438}],432:[function(Ne,Ge,Qe){Ge.exports=tokenize;var tt=Ne("./lib/literals"),rt=Ne("./lib/operators"),nt=Ne("./lib/builtins"),at=Ne("./lib/literals-300es"),it=Ne("./lib/builtins-300es"),ot=999,dt=9999,ht=0,Dt=1,Ot=2,Rt=3,Zt=4,er=5,dr=6,mr=7,xr=8,br=9,Ar=10,en=11,mn=["block-comment","line-comment","preprocessor","operator","integer","float","ident","builtin","keyword","whitespace","eof","integer"];function tokenize(Ne){var Ge,Qe,xn,kn=0,Cn=0,En=ot,Pn=[],Dn=[],In=1,zn=0,Bn=0,Vn=!1,Hn=!1,qn="",Yn=nt,$n=tt;"300 es"===(Ne=Ne||{}).version&&(Yn=it,$n=at);var ra={},oa={};for(kn=0;kn<Yn.length;kn++)ra[Yn[kn]]=!0;for(kn=0;kn<$n.length;kn++)oa[$n[kn]]=!0;return function(Ne){return Dn=[],null!==Ne?write(Ne):end()};function token(Ne){Ne.length&&Dn.push({type:mn[En],data:Ne,position:Bn,line:In,column:zn})}function write(Ne){var Qe;for(kn=0,Ne.toString&&(Ne=Ne.toString()),qn+=Ne.replace(/\r\n/g,"\n"),xn=qn.length;Ge=qn[kn],kn<xn;){switch(Qe=kn,En){case ht:kn=block_comment();break;case Dt:kn=line_comment();break;case Ot:kn=preprocessor();break;case Rt:kn=operator();break;case Zt:kn=integer();break;case en:kn=hex();break;case er:kn=decimal();break;case dt:kn=readtoken();break;case br:kn=whitespace();break;case ot:kn=normal()}Qe!==kn&&("\n"===qn[Qe]?(zn=0,++In):++zn)}return Cn+=kn,qn=qn.slice(kn),Dn}function end(Ne){return Pn.length&&token(Pn.join("")),En=Ar,token("(eof)"),Dn}function normal(){return Pn=Pn.length?[]:Pn,"/"===Qe&&"*"===Ge?(Bn=Cn+kn-1,En=ht,Qe=Ge,kn+1):"/"===Qe&&"/"===Ge?(Bn=Cn+kn-1,En=Dt,Qe=Ge,kn+1):"#"===Ge?(En=Ot,Bn=Cn+kn,kn):/\s/.test(Ge)?(En=br,Bn=Cn+kn,kn):(Vn=/\d/.test(Ge),Hn=/[^\w_]/.test(Ge),Bn=Cn+kn,En=Vn?Zt:Hn?Rt:dt,kn)}function whitespace(){return/[^\s]/g.test(Ge)?(token(Pn.join("")),En=ot,kn):(Pn.push(Ge),Qe=Ge,kn+1)}function preprocessor(){return"\r"!==Ge&&"\n"!==Ge||"\\"===Qe?(Pn.push(Ge),Qe=Ge,kn+1):(token(Pn.join("")),En=ot,kn)}function line_comment(){return preprocessor()}function block_comment(){return"/"===Ge&&"*"===Qe?(Pn.push(Ge),token(Pn.join("")),En=ot,kn+1):(Pn.push(Ge),Qe=Ge,kn+1)}function operator(){if("."===Qe&&/\d/.test(Ge))return En=er,kn;if("/"===Qe&&"*"===Ge)return En=ht,kn;if("/"===Qe&&"/"===Ge)return En=Dt,kn;if("."===Ge&&Pn.length){for(;determine_operator(Pn););return En=er,kn}if(";"===Ge||")"===Ge||"("===Ge){if(Pn.length)for(;determine_operator(Pn););return token(Ge),En=ot,kn+1}var Ne=2===Pn.length&&"="!==Ge;if(/[\w_\d\s]/.test(Ge)||Ne){for(;determine_operator(Pn););return En=ot,kn}return Pn.push(Ge),Qe=Ge,kn+1}function determine_operator(Ne){for(var Ge,Qe,tt=0;;){if(Ge=rt.indexOf(Ne.slice(0,Ne.length+tt).join("")),Qe=rt[Ge],-1===Ge){if(tt--+Ne.length>0)continue;Qe=Ne.slice(0,1).join("")}return token(Qe),Bn+=Qe.length,(Pn=Pn.slice(Qe.length)).length}}function hex(){return/[^a-fA-F0-9]/.test(Ge)?(token(Pn.join("")),En=ot,kn):(Pn.push(Ge),Qe=Ge,kn+1)}function integer(){return"."===Ge||/[eE]/.test(Ge)?(Pn.push(Ge),En=er,Qe=Ge,kn+1):"x"===Ge&&1===Pn.length&&"0"===Pn[0]?(En=en,Pn.push(Ge),Qe=Ge,kn+1):/[^\d]/.test(Ge)?(token(Pn.join("")),En=ot,kn):(Pn.push(Ge),Qe=Ge,kn+1)}function decimal(){return"f"===Ge&&(Pn.push(Ge),Qe=Ge,kn+=1),/[eE]/.test(Ge)?(Pn.push(Ge),Qe=Ge,kn+1):("-"!==Ge&&"+"!==Ge||!/[eE]/.test(Qe))&&/[^\d]/.test(Ge)?(token(Pn.join("")),En=ot,kn):(Pn.push(Ge),Qe=Ge,kn+1)}function readtoken(){if(/[^\d\w_]/.test(Ge)){var Ne=Pn.join("");return En=oa[Ne]?xr:ra[Ne]?mr:dr,token(Pn.join("")),En=ot,kn}return Pn.push(Ge),Qe=Ge,kn+1}}},{"./lib/builtins":434,"./lib/builtins-300es":433,"./lib/literals":436,"./lib/literals-300es":435,"./lib/operators":437}],433:[function(Ne,Ge,Qe){var tt=Ne("./builtins");tt=tt.slice().filter((function(Ne){return!/^(gl\_|texture)/.test(Ne)})),Ge.exports=tt.concat(["gl_VertexID","gl_InstanceID","gl_Position","gl_PointSize","gl_FragCoord","gl_FrontFacing","gl_FragDepth","gl_PointCoord","gl_MaxVertexAttribs","gl_MaxVertexUniformVectors","gl_MaxVertexOutputVectors","gl_MaxFragmentInputVectors","gl_MaxVertexTextureImageUnits","gl_MaxCombinedTextureImageUnits","gl_MaxTextureImageUnits","gl_MaxFragmentUniformVectors","gl_MaxDrawBuffers","gl_MinProgramTexelOffset","gl_MaxProgramTexelOffset","gl_DepthRangeParameters","gl_DepthRange","trunc","round","roundEven","isnan","isinf","floatBitsToInt","floatBitsToUint","intBitsToFloat","uintBitsToFloat","packSnorm2x16","unpackSnorm2x16","packUnorm2x16","unpackUnorm2x16","packHalf2x16","unpackHalf2x16","outerProduct","transpose","determinant","inverse","texture","textureSize","textureProj","textureLod","textureOffset","texelFetch","texelFetchOffset","textureProjOffset","textureLodOffset","textureProjLod","textureProjLodOffset","textureGrad","textureGradOffset","textureProjGrad","textureProjGradOffset"])},{"./builtins":434}],434:[function(Ne,Ge,Qe){Ge.exports=["abs","acos","all","any","asin","atan","ceil","clamp","cos","cross","dFdx","dFdy","degrees","distance","dot","equal","exp","exp2","faceforward","floor","fract","gl_BackColor","gl_BackLightModelProduct","gl_BackLightProduct","gl_BackMaterial","gl_BackSecondaryColor","gl_ClipPlane","gl_ClipVertex","gl_Color","gl_DepthRange","gl_DepthRangeParameters","gl_EyePlaneQ","gl_EyePlaneR","gl_EyePlaneS","gl_EyePlaneT","gl_Fog","gl_FogCoord","gl_FogFragCoord","gl_FogParameters","gl_FragColor","gl_FragCoord","gl_FragData","gl_FragDepth","gl_FragDepthEXT","gl_FrontColor","gl_FrontFacing","gl_FrontLightModelProduct","gl_FrontLightProduct","gl_FrontMaterial","gl_FrontSecondaryColor","gl_LightModel","gl_LightModelParameters","gl_LightModelProducts","gl_LightProducts","gl_LightSource","gl_LightSourceParameters","gl_MaterialParameters","gl_MaxClipPlanes","gl_MaxCombinedTextureImageUnits","gl_MaxDrawBuffers","gl_MaxFragmentUniformComponents","gl_MaxLights","gl_MaxTextureCoords","gl_MaxTextureImageUnits","gl_MaxTextureUnits","gl_MaxVaryingFloats","gl_MaxVertexAttribs","gl_MaxVertexTextureImageUnits","gl_MaxVertexUniformComponents","gl_ModelViewMatrix","gl_ModelViewMatrixInverse","gl_ModelViewMatrixInverseTranspose","gl_ModelViewMatrixTranspose","gl_ModelViewProjectionMatrix","gl_ModelViewProjectionMatrixInverse","gl_ModelViewProjectionMatrixInverseTranspose","gl_ModelViewProjectionMatrixTranspose","gl_MultiTexCoord0","gl_MultiTexCoord1","gl_MultiTexCoord2","gl_MultiTexCoord3","gl_MultiTexCoord4","gl_MultiTexCoord5","gl_MultiTexCoord6","gl_MultiTexCoord7","gl_Normal","gl_NormalMatrix","gl_NormalScale","gl_ObjectPlaneQ","gl_ObjectPlaneR","gl_ObjectPlaneS","gl_ObjectPlaneT","gl_Point","gl_PointCoord","gl_PointParameters","gl_PointSize","gl_Position","gl_ProjectionMatrix","gl_ProjectionMatrixInverse","gl_ProjectionMatrixInverseTranspose","gl_ProjectionMatrixTranspose","gl_SecondaryColor","gl_TexCoord","gl_TextureEnvColor","gl_TextureMatrix","gl_TextureMatrixInverse","gl_TextureMatrixInverseTranspose","gl_TextureMatrixTranspose","gl_Vertex","greaterThan","greaterThanEqual","inversesqrt","length","lessThan","lessThanEqual","log","log2","matrixCompMult","max","min","mix","mod","normalize","not","notEqual","pow","radians","reflect","refract","sign","sin","smoothstep","sqrt","step","tan","texture2D","texture2DLod","texture2DProj","texture2DProjLod","textureCube","textureCubeLod","texture2DLodEXT","texture2DProjLodEXT","textureCubeLodEXT","texture2DGradEXT","texture2DProjGradEXT","textureCubeGradEXT"]},{}],435:[function(Ne,Ge,Qe){var tt=Ne("./literals");Ge.exports=tt.slice().concat(["layout","centroid","smooth","case","mat2x2","mat2x3","mat2x4","mat3x2","mat3x3","mat3x4","mat4x2","mat4x3","mat4x4","uvec2","uvec3","uvec4","samplerCubeShadow","sampler2DArray","sampler2DArrayShadow","isampler2D","isampler3D","isamplerCube","isampler2DArray","usampler2D","usampler3D","usamplerCube","usampler2DArray","coherent","restrict","readonly","writeonly","resource","atomic_uint","noperspective","patch","sample","subroutine","common","partition","active","filter","image1D","image2D","image3D","imageCube","iimage1D","iimage2D","iimage3D","iimageCube","uimage1D","uimage2D","uimage3D","uimageCube","image1DArray","image2DArray","iimage1DArray","iimage2DArray","uimage1DArray","uimage2DArray","image1DShadow","image2DShadow","image1DArrayShadow","image2DArrayShadow","imageBuffer","iimageBuffer","uimageBuffer","sampler1DArray","sampler1DArrayShadow","isampler1D","isampler1DArray","usampler1D","usampler1DArray","isampler2DRect","usampler2DRect","samplerBuffer","isamplerBuffer","usamplerBuffer","sampler2DMS","isampler2DMS","usampler2DMS","sampler2DMSArray","isampler2DMSArray","usampler2DMSArray"])},{"./literals":436}],436:[function(Ne,Ge,Qe){Ge.exports=["precision","highp","mediump","lowp","attribute","const","uniform","varying","break","continue","do","for","while","if","else","in","out","inout","float","int","uint","void","bool","true","false","discard","return","mat2","mat3","mat4","vec2","vec3","vec4","ivec2","ivec3","ivec4","bvec2","bvec3","bvec4","sampler1D","sampler2D","sampler3D","samplerCube","sampler1DShadow","sampler2DShadow","struct","asm","class","union","enum","typedef","template","this","packed","goto","switch","default","inline","noinline","volatile","public","static","extern","external","interface","long","short","double","half","fixed","unsigned","input","output","hvec2","hvec3","hvec4","dvec2","dvec3","dvec4","fvec2","fvec3","fvec4","sampler2DRect","sampler3DRect","sampler2DRectShadow","sizeof","cast","namespace","using"]},{}],437:[function(Ne,Ge,Qe){Ge.exports=["<<=",">>=","++","--","<<",">>","<=",">=","==","!=","&&","||","+=","-=","*=","/=","%=","&=","^^","^=","|=","(",")","[","]",".","!","~","*","/","%","+","-","<",">","&","^","|","?",":","=",",",";","{","}"]},{}],438:[function(Ne,Ge,Qe){var tt=Ne("./index");function tokenizeString(Ne,Ge){var Qe=tt(Ge),rt=[];return rt=(rt=rt.concat(Qe(Ne))).concat(Qe(null))}Ge.exports=tokenizeString},{"./index":432}],439:[function(Ne,Ge,Qe){arguments[4][257][0].apply(Qe,arguments)},{dup:257}],440:[function(Ne,Ge,tt){(function(Qe){(function(){"use strict";var tt,rt=Ne("is-browser");tt="function"==typeof Qe.matchMedia?!Qe.matchMedia("(hover: none)").matches:rt,Ge.exports=tt}).call(this)}).call(this,void 0!==Qe.g?Qe.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"is-browser":464}],441:[function(Ne,Ge,Qe){"use strict";var tt=Ne("is-browser");function detect(){var Ne=!1;try{var Ge=Object.defineProperty({},"passive",{get:function(){Ne=!0}});window.addEventListener("test",null,Ge),window.removeEventListener("test",null,Ge)}catch(Ge){Ne=!1}return Ne}Ge.exports=tt&&detect()},{"is-browser":464}],442:[function(Ne,Ge,Qe){Qe.read=function(Ne,Ge,Qe,tt,rt){var nt,at,it=8*rt-tt-1,ot=(1<<it)-1,dt=ot>>1,ht=-7,Dt=Qe?rt-1:0,Ot=Qe?-1:1,Rt=Ne[Ge+Dt];for(Dt+=Ot,nt=Rt&(1<<-ht)-1,Rt>>=-ht,ht+=it;ht>0;nt=256*nt+Ne[Ge+Dt],Dt+=Ot,ht-=8);for(at=nt&(1<<-ht)-1,nt>>=-ht,ht+=tt;ht>0;at=256*at+Ne[Ge+Dt],Dt+=Ot,ht-=8);if(0===nt)nt=1-dt;else{if(nt===ot)return at?NaN:1/0*(Rt?-1:1);at+=Math.pow(2,tt),nt-=dt}return(Rt?-1:1)*at*Math.pow(2,nt-tt)},Qe.write=function(Ne,Ge,Qe,tt,rt,nt){var at,it,ot,dt=8*nt-rt-1,ht=(1<<dt)-1,Dt=ht>>1,Ot=23===rt?Math.pow(2,-24)-Math.pow(2,-77):0,Rt=tt?0:nt-1,Zt=tt?1:-1,er=Ge<0||0===Ge&&1/Ge<0?1:0;for(Ge=Math.abs(Ge),isNaN(Ge)||Ge===1/0?(it=isNaN(Ge)?1:0,at=ht):(at=Math.floor(Math.log(Ge)/Math.LN2),Ge*(ot=Math.pow(2,-at))<1&&(at--,ot*=2),(Ge+=at+Dt>=1?Ot/ot:Ot*Math.pow(2,1-Dt))*ot>=2&&(at++,ot/=2),at+Dt>=ht?(it=0,at=ht):at+Dt>=1?(it=(Ge*ot-1)*Math.pow(2,rt),at+=Dt):(it=Ge*Math.pow(2,Dt-1)*Math.pow(2,rt),at=0));rt>=8;Ne[Qe+Rt]=255&it,Rt+=Zt,it/=256,rt-=8);for(at=at<<rt|it,dt+=rt;dt>0;Ne[Qe+Rt]=255&at,Rt+=Zt,at/=256,dt-=8);Ne[Qe+Rt-Zt]|=128*er}},{}],443:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./types");Ge.exports=function(Ne,Ge){var Qe;for(Qe in tt)if(tt[Qe].detect(Ne,Ge))return Qe}},{"./types":446}],444:[function(Ne,Ge,Qe){(function(Qe){(function(){"use strict";var tt=Ne("fs"),rt=Ne("path"),nt=Ne("./types"),at=Ne("./detector"),it=524288;function lookup(Ne,Ge){var Qe=at(Ne,Ge);if(Qe in nt){var tt=nt[Qe].calculate(Ne,Ge);if(!1!==tt)return tt.type=Qe,tt}throw new TypeError("unsupported file type: "+Qe+" (file: "+Ge+")")}function asyncFileToBuffer(Ne,Ge){tt.open(Ne,"r",(function(rt,nt){if(rt)return Ge(rt);tt.fstat(nt,(function(rt,at){if(rt)return Ge(rt);var ot=at.size;if(ot<=0)return Ge(new Error("File size is not greater than 0 ââ "+Ne));var dt=Math.min(ot,it),ht=Qe.alloc(dt);tt.read(nt,ht,0,dt,0,(function(Ne){if(Ne)return Ge(Ne);tt.close(nt,(function(Ne){Ge(Ne,ht)}))}))}))}))}function syncFileToBuffer(Ne){var Ge=tt.openSync(Ne,"r"),rt=tt.fstatSync(Ge).size,nt=Math.min(rt,it),at=Qe.alloc(nt);return tt.readSync(Ge,at,0,nt,0),tt.closeSync(Ge),at}Ge.exports=function(Ne,Ge){if(Qe.isBuffer(Ne))return lookup(Ne);if("string"!=typeof Ne)throw new TypeError("invalid invocation");var tt=rt.resolve(Ne);if("function"!=typeof Ge)return lookup(syncFileToBuffer(tt),tt);asyncFileToBuffer(tt,(function(Ne,Qe){if(Ne)return Ge(Ne);var rt;try{rt=lookup(Qe,tt)}catch(Ge){Ne=Ge}Ge(Ne,rt)}))},Ge.exports.types=Object.keys(nt)}).call(this)}).call(this,Ne("buffer").Buffer)},{"./detector":443,"./types":446,buffer:111,fs:109,path:507}],445:[function(Ne,Ge,Qe){"use strict";function readUInt(Ne,Ge,Qe,tt){return Qe=Qe||0,Ne["readUInt"+Ge+(tt?"BE":"LE")].call(Ne,Qe)}Ge.exports=readUInt},{}],446:[function(Ne,Ge,Qe){"use strict";var tt={bmp:Ne("./types/bmp"),cur:Ne("./types/cur"),dds:Ne("./types/dds"),gif:Ne("./types/gif"),icns:Ne("./types/icns"),ico:Ne("./types/ico"),jpg:Ne("./types/jpg"),png:Ne("./types/png"),psd:Ne("./types/psd"),svg:Ne("./types/svg"),tiff:Ne("./types/tiff"),webp:Ne("./types/webp")};Ge.exports=tt},{"./types/bmp":447,"./types/cur":448,"./types/dds":449,"./types/gif":450,"./types/icns":451,"./types/ico":452,"./types/jpg":453,"./types/png":454,"./types/psd":455,"./types/svg":456,"./types/tiff":457,"./types/webp":458}],447:[function(Ne,Ge,Qe){"use strict";function isBMP(Ne){return"BM"===Ne.toString("ascii",0,2)}function calculate(Ne){return{width:Ne.readUInt32LE(18),height:Math.abs(Ne.readInt32LE(22))}}Ge.exports={detect:isBMP,calculate:calculate}},{}],448:[function(Ne,Ge,Qe){"use strict";var tt=2;function isCUR(Ne){return 0===Ne.readUInt16LE(0)&&Ne.readUInt16LE(2)===tt}Ge.exports={detect:isCUR,calculate:Ne("./ico").calculate}},{"./ico":452}],449:[function(Ne,Ge,Qe){"use strict";function isDDS(Ne){return 542327876===Ne.readUInt32LE(0)}function calculate(Ne){return{height:Ne.readUInt32LE(12),width:Ne.readUInt32LE(16)}}Ge.exports={detect:isDDS,calculate:calculate}},{}],450:[function(Ne,Ge,Qe){"use strict";var tt=/^GIF8[79]a/;function isGIF(Ne){var Ge=Ne.toString("ascii",0,6);return tt.test(Ge)}function calculate(Ne){return{width:Ne.readUInt16LE(6),height:Ne.readUInt16LE(8)}}Ge.exports={detect:isGIF,calculate:calculate}},{}],451:[function(Ne,Ge,Qe){"use strict";var tt=8,rt=4,nt=4;function isICNS(Ne){return"icns"===Ne.toString("ascii",0,4)}var at={ICON:32,"ICN#":32,"icm#":16,icm4:16,icm8:16,"ics#":16,ics4:16,ics8:16,is32:16,s8mk:16,icp4:16,icl4:32,icl8:32,il32:32,l8mk:32,icp5:32,ic11:32,ich4:48,ich8:48,ih32:48,h8mk:48,icp6:64,ic12:32,it32:128,t8mk:128,ic07:128,ic08:256,ic13:256,ic09:512,ic14:512,ic10:1024};function readImageHeader(Ne,Ge){var Qe=Ge+nt;return[Ne.toString("ascii",Ge,Qe),Ne.readUInt32BE(Qe)]}function getImageSize(Ne){var Ge=at[Ne];return{width:Ge,height:Ge,type:Ne}}function calculate(Ne){var Ge,Qe,nt,at=Ne.length,it=tt,ot=Ne.readUInt32BE(rt);if(Qe=getImageSize((Ge=readImageHeader(Ne,it))[0]),(it+=Ge[1])===ot)return Qe;for(nt={width:Qe.width,height:Qe.height,images:[Qe]};it<ot&&it<at;)Qe=getImageSize((Ge=readImageHeader(Ne,it))[0]),it+=Ge[1],nt.images.push(Qe);return nt}Ge.exports={detect:isICNS,calculate:calculate}},{}],452:[function(Ne,Ge,Qe){"use strict";var tt=1,rt=6,nt=16;function isICO(Ne){return 0===Ne.readUInt16LE(0)&&Ne.readUInt16LE(2)===tt}function getSizeFromOffset(Ne,Ge){var Qe=Ne.readUInt8(Ge);return 0===Qe?256:Qe}function getImageSize(Ne,Ge){var Qe=rt+Ge*nt;return{width:getSizeFromOffset(Ne,Qe),height:getSizeFromOffset(Ne,Qe+1)}}function calculate(Ne){var Ge,Qe=Ne.readUInt16LE(4),tt=getImageSize(Ne,0);if(1===Qe)return tt;for(tt.images=[{width:tt.width,height:tt.height}],Ge=1;Ge<Qe;Ge+=1)tt.images.push(getImageSize(Ne,Ge));return tt}Ge.exports={detect:isICO,calculate:calculate}},{}],453:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../readUInt");function isJPG(Ne){return"ffd8"===Ne.toString("hex",0,2)}function isEXIF(Ne){return"45786966"===Ne.toString("hex",2,6)}function extractSize(Ne,Ge){return{height:Ne.readUInt16BE(Ge),width:Ne.readUInt16BE(Ge+2)}}var rt=2,nt=6,at=2,it="4d4d",ot="4949",dt=12,ht=2;function validateExifBlock(Ne,Ge){var Qe=Ne.slice(rt,Ge),tt=Qe.toString("hex",nt,nt+at),dt=tt===it;if(dt||tt===ot)return extractOrientation(Qe,dt)}function extractOrientation(Ne,Ge){for(var Qe,rt,at=nt+8,it=tt(Ne,16,at,Ge),ot=0;ot<it;ot++){if(rt=(Qe=at+ht+ot*dt)+dt,Qe>Ne.length)return;var Dt=Ne.slice(Qe,rt);if(274===tt(Dt,16,0,Ge)){if(3!==tt(Dt,16,2,Ge))return;if(1!==tt(Dt,32,4,Ge))return;return tt(Dt,16,8,Ge)}}}function validateBuffer(Ne,Ge){if(Ge>Ne.length)throw new TypeError("Corrupt JPG, exceeded buffer limits");if(255!==Ne[Ge])throw new TypeError("Invalid JPG, marker table corrupted")}function calculate(Ne){var Ge,Qe,tt;for(Ne=Ne.slice(4);Ne.length;){if(Qe=Ne.readUInt16BE(0),isEXIF(Ne)&&(Ge=validateExifBlock(Ne,Qe)),validateBuffer(Ne,Qe),192===(tt=Ne[Qe+1])||193===tt||194===tt){var rt=extractSize(Ne,Qe+5);return Ge?{width:rt.width,height:rt.height,orientation:Ge}:rt}Ne=Ne.slice(Qe+2)}throw new TypeError("Invalid JPG, no size found")}Ge.exports={detect:isJPG,calculate:calculate}},{"../readUInt":445}],454:[function(Ne,Ge,Qe){"use strict";var tt="PNG\r\n\n",rt="IHDR",nt="CgBI";function isPNG(Ne){if(tt===Ne.toString("ascii",1,8)){var Ge=Ne.toString("ascii",12,16);if(Ge===nt&&(Ge=Ne.toString("ascii",28,32)),Ge!==rt)throw new TypeError("invalid png");return!0}}function calculate(Ne){return Ne.toString("ascii",12,16)===nt?{width:Ne.readUInt32BE(32),height:Ne.readUInt32BE(36)}:{width:Ne.readUInt32BE(16),height:Ne.readUInt32BE(20)}}Ge.exports={detect:isPNG,calculate:calculate}},{}],455:[function(Ne,Ge,Qe){"use strict";function isPSD(Ne){return"8BPS"===Ne.toString("ascii",0,4)}function calculate(Ne){return{width:Ne.readUInt32BE(18),height:Ne.readUInt32BE(14)}}Ge.exports={detect:isPSD,calculate:calculate}},{}],456:[function(Ne,Ge,Qe){"use strict";var tt=/<svg\s([^>"']|"[^"]*"|'[^']*')*>/;function isSVG(Ne){return tt.test(Ne)}var rt={root:tt,width:/\swidth=(['"])([^%]+?)\1/,height:/\sheight=(['"])([^%]+?)\1/,viewbox:/\sviewBox=(['"])(.+?)\1/},nt={cm:96/2.54,mm:96/2.54/10,m:96/2.54*100,pt:96/72,pc:96/72/12,em:16,ex:8};function parseLength(Ne){var Ge=/([0-9.]+)([a-z]*)/.exec(Ne);if(Ge)return Math.round(parseFloat(Ge[1])*(nt[Ge[2]]||1))}function parseViewbox(Ne){var Ge=Ne.split(" ");return{width:parseLength(Ge[2]),height:parseLength(Ge[3])}}function parseAttributes(Ne){var Ge=Ne.match(rt.width),Qe=Ne.match(rt.height),tt=Ne.match(rt.viewbox);return{width:Ge&&parseLength(Ge[2]),height:Qe&&parseLength(Qe[2]),viewbox:tt&&parseViewbox(tt[2])}}function calculateByDimensions(Ne){return{width:Ne.width,height:Ne.height}}function calculateByViewbox(Ne){var Ge=Ne.viewbox.width/Ne.viewbox.height;return Ne.width?{width:Ne.width,height:Math.floor(Ne.width/Ge)}:Ne.height?{width:Math.floor(Ne.height*Ge),height:Ne.height}:{width:Ne.viewbox.width,height:Ne.viewbox.height}}function calculate(Ne){var Ge=Ne.toString("utf8").match(rt.root);if(Ge){var Qe=parseAttributes(Ge[0]);if(Qe.width&&Qe.height)return calculateByDimensions(Qe);if(Qe.viewbox)return calculateByViewbox(Qe)}throw new TypeError("invalid svg")}Ge.exports={detect:isSVG,calculate:calculate}},{}],457:[function(Ne,Ge,Qe){(function(Qe){(function(){"use strict";var tt=Ne("fs"),rt=Ne("../readUInt");function isTIFF(Ne){var Ge=Ne.toString("hex",0,4);return"49492a00"===Ge||"4d4d002a"===Ge}function readIFD(Ne,Ge,nt){var at=rt(Ne,32,4,nt),it=1024,ot=tt.statSync(Ge).size;at+it>ot&&(it=ot-at-10);var dt=Qe.alloc(it),ht=tt.openSync(Ge,"r");return tt.readSync(ht,dt,0,it,at),dt.slice(2)}function readValue(Ne,Ge){var Qe=rt(Ne,16,8,Ge);return(rt(Ne,16,10,Ge)<<16)+Qe}function nextTag(Ne){if(Ne.length>24)return Ne.slice(12)}function extractTags(Ne,Ge){for(var Qe,tt,nt,at={};Ne&&Ne.length&&(Qe=rt(Ne,16,0,Ge),tt=rt(Ne,16,2,Ge),nt=rt(Ne,32,4,Ge),0!==Qe);)1!==nt||3!==tt&&4!==tt||(at[Qe]=readValue(Ne,Ge)),Ne=nextTag(Ne);return at}function determineEndianness(Ne){var Ge=Ne.toString("ascii",0,2);return"II"===Ge?"LE":"MM"===Ge?"BE":void 0}function calculate(Ne,Ge){if(!Ge)throw new TypeError("Tiff doesn't support buffer");var Qe="BE"===determineEndianness(Ne),tt=extractTags(readIFD(Ne,Ge,Qe),Qe),rt=tt[256],nt=tt[257];if(!rt||!nt)throw new TypeError("Invalid Tiff, missing tags");return{width:rt,height:nt}}Ge.exports={detect:isTIFF,calculate:calculate}}).call(this)}).call(this,Ne("buffer").Buffer)},{"../readUInt":445,buffer:111,fs:109}],458:[function(Ne,Ge,Qe){"use strict";function isWebP(Ne){var Ge="RIFF"===Ne.toString("ascii",0,4),Qe="WEBP"===Ne.toString("ascii",8,12),tt="VP8"===Ne.toString("ascii",12,15);return Ge&&Qe&&tt}function calculate(Ne){var Ge=Ne.toString("ascii",12,16);if(Ne=Ne.slice(20,30),"VP8X"===Ge){var Qe=Ne[0];return!(0!=(192&Qe)||0!=(1&Qe))&&calculateExtended(Ne)}if("VP8 "===Ge&&47!==Ne[0])return calculateLossy(Ne);var tt=Ne.toString("hex",3,6);return"VP8L"===Ge&&"9d012a"!==tt&&calculateLossless(Ne)}function calculateExtended(Ne){return{width:1+Ne.readUIntLE(4,3),height:1+Ne.readUIntLE(7,3)}}function calculateLossless(Ne){return{width:1+((63&Ne[2])<<8|Ne[1]),height:1+((15&Ne[4])<<10|Ne[3]<<2|(192&Ne[2])>>6)}}function calculateLossy(Ne){return{width:16383&Ne.readInt16LE(6),height:16383&Ne.readInt16LE(8)}}Ge.exports={detect:isWebP,calculate:calculate}},{}],459:[function(Ne,Ge,Qe){"use strict";Ge.exports=incrementalConvexHull;var tt=Ne("robust-orientation"),rt=Ne("simplicial-complex").compareCells;function Simplex(Ne,Ge,Qe){this.vertices=Ne,this.adjacent=Ge,this.boundary=Qe,this.lastVisited=-1}function GlueFacet(Ne,Ge,Qe){this.vertices=Ne,this.cell=Ge,this.index=Qe}function compareGlue(Ne,Ge){return rt(Ne.vertices,Ge.vertices)}function bakeOrient(Ne){for(var Ge=["function orient(){var tuple=this.tuple;return test("],Qe=0;Qe<=Ne;++Qe)Qe>0&&Ge.push(","),Ge.push("tuple[",Qe,"]");Ge.push(")}return orient");var rt=new Function("test",Ge.join("")),nt=tt[Ne+1];return nt||(nt=tt),rt(nt)}Simplex.prototype.flip=function(){var Ne=this.vertices[0];this.vertices[0]=this.vertices[1],this.vertices[1]=Ne;var Ge=this.adjacent[0];this.adjacent[0]=this.adjacent[1],this.adjacent[1]=Ge};var nt=[];function Triangulation(Ne,Ge,Qe){this.dimension=Ne,this.vertices=Ge,this.simplices=Qe,this.interior=Qe.filter((function(Ne){return!Ne.boundary})),this.tuple=new Array(Ne+1);for(var tt=0;tt<=Ne;++tt)this.tuple[tt]=this.vertices[tt];var rt=nt[Ne];rt||(rt=nt[Ne]=bakeOrient(Ne)),this.orient=rt}var at=Triangulation.prototype;function incrementalConvexHull(Ne,Ge){var Qe=Ne.length;if(0===Qe)throw new Error("Must have at least d+1 points");var rt=Ne[0].length;if(Qe<=rt)throw new Error("Must input at least d+1 points");var nt=Ne.slice(0,rt+1),at=tt.apply(void 0,nt);if(0===at)throw new Error("Input not in general position");for(var it=new Array(rt+1),ot=0;ot<=rt;++ot)it[ot]=ot;at<0&&(it[0]=1,it[1]=0);var dt=new Simplex(it,new Array(rt+1),!1),ht=dt.adjacent,Dt=new Array(rt+2);for(ot=0;ot<=rt;++ot){for(var Ot=it.slice(),Rt=0;Rt<=rt;++Rt)Rt===ot&&(Ot[Rt]=-1);var Zt=Ot[0];Ot[0]=Ot[1],Ot[1]=Zt;var er=new Simplex(Ot,new Array(rt+1),!0);ht[ot]=er,Dt[ot]=er}for(Dt[rt+1]=dt,ot=0;ot<=rt;++ot){Ot=ht[ot].vertices;var dr=ht[ot].adjacent;for(Rt=0;Rt<=rt;++Rt){var mr=Ot[Rt];if(mr<0)dr[Rt]=dt;else for(var xr=0;xr<=rt;++xr)ht[xr].vertices.indexOf(mr)<0&&(dr[Rt]=ht[xr])}}var br=new Triangulation(rt,nt,Dt),Ar=!!Ge;for(ot=rt+1;ot<Qe;++ot)br.insert(Ne[ot],Ar);return br.boundary()}at.handleBoundaryDegeneracy=function(Ne,Ge){var Qe=this.dimension,tt=this.vertices.length-1,rt=this.tuple,nt=this.vertices,at=[Ne];for(Ne.lastVisited=-tt;at.length>0;){(Ne=at.pop()).vertices;for(var it=Ne.adjacent,ot=0;ot<=Qe;++ot){var dt=it[ot];if(dt.boundary&&!(dt.lastVisited<=-tt)){for(var ht=dt.vertices,Dt=0;Dt<=Qe;++Dt){var Ot=ht[Dt];rt[Dt]=Ot<0?Ge:nt[Ot]}var Rt=this.orient();if(Rt>0)return dt;dt.lastVisited=-tt,0===Rt&&at.push(dt)}}}return null},at.walk=function(Ne,Ge){var Qe=this.vertices.length-1,tt=this.dimension,rt=this.vertices,nt=this.tuple,at=Ge?this.interior.length*Math.random()|0:this.interior.length-1,it=this.interior[at];e:for(;!it.boundary;){for(var ot=it.vertices,dt=it.adjacent,ht=0;ht<=tt;++ht)nt[ht]=rt[ot[ht]];for(it.lastVisited=Qe,ht=0;ht<=tt;++ht){var Dt=dt[ht];if(!(Dt.lastVisited>=Qe)){var Ot=nt[ht];nt[ht]=Ne;var Rt=this.orient();if(nt[ht]=Ot,Rt<0){it=Dt;continue e}Dt.boundary?Dt.lastVisited=-Qe:Dt.lastVisited=Qe}}return}return it},at.addPeaks=function(Ne,Ge){var Qe=this.vertices.length-1,tt=this.dimension,rt=this.vertices,nt=this.tuple,at=this.interior,it=this.simplices,ot=[Ge];Ge.lastVisited=Qe,Ge.vertices[Ge.vertices.indexOf(-1)]=Qe,Ge.boundary=!1,at.push(Ge);for(var dt=[];ot.length>0;){var ht=(Ge=ot.pop()).vertices,Dt=Ge.adjacent,Ot=ht.indexOf(Qe);if(!(Ot<0))for(var Rt=0;Rt<=tt;++Rt)if(Rt!==Ot){var Zt=Dt[Rt];if(Zt.boundary&&!(Zt.lastVisited>=Qe)){var er=Zt.vertices;if(Zt.lastVisited!==-Qe){for(var dr=0,mr=0;mr<=tt;++mr)er[mr]<0?(dr=mr,nt[mr]=Ne):nt[mr]=rt[er[mr]];if(this.orient()>0){er[dr]=Qe,Zt.boundary=!1,at.push(Zt),ot.push(Zt),Zt.lastVisited=Qe;continue}Zt.lastVisited=-Qe}var xr=Zt.adjacent,br=ht.slice(),Ar=Dt.slice(),en=new Simplex(br,Ar,!0);it.push(en);var mn=xr.indexOf(Ge);if(!(mn<0))for(xr[mn]=en,Ar[Ot]=Zt,br[Rt]=-1,Ar[Rt]=Ge,Dt[Rt]=en,en.flip(),mr=0;mr<=tt;++mr){var xn=br[mr];if(!(xn<0||xn===Qe)){for(var kn=new Array(tt-1),Cn=0,En=0;En<=tt;++En){var Pn=br[En];Pn<0||En===mr||(kn[Cn++]=Pn)}dt.push(new GlueFacet(kn,en,mr))}}}}}for(dt.sort(compareGlue),Rt=0;Rt+1<dt.length;Rt+=2){var Dn=dt[Rt],In=dt[Rt+1],zn=Dn.index,Bn=In.index;zn<0||Bn<0||(Dn.cell.adjacent[Dn.index]=In.cell,In.cell.adjacent[In.index]=Dn.cell)}},at.insert=function(Ne,Ge){var Qe=this.vertices;Qe.push(Ne);var tt=this.walk(Ne,Ge);if(tt){for(var rt=this.dimension,nt=this.tuple,at=0;at<=rt;++at){var it=tt.vertices[at];nt[at]=it<0?Ne:Qe[it]}var ot=this.orient(nt);ot<0||(0!==ot||(tt=this.handleBoundaryDegeneracy(tt,Ne)))&&this.addPeaks(Ne,tt)}},at.boundary=function(){for(var Ne=this.dimension,Ge=[],Qe=this.simplices,tt=Qe.length,rt=0;rt<tt;++rt){var nt=Qe[rt];if(nt.boundary){for(var at=new Array(Ne),it=nt.vertices,ot=0,dt=0,ht=0;ht<=Ne;++ht)it[ht]>=0?at[ot++]=it[ht]:dt=1&ht;if(dt===(1&Ne)){var Dt=at[0];at[0]=at[1],at[1]=Dt}Ge.push(at)}}return Ge}},{"robust-orientation":548,"simplicial-complex":558}],460:[function(Ne,Ge,Qe){"use strict";var tt=Ne("binary-search-bounds"),rt=0,nt=1,at=2;function IntervalTreeNode(Ne,Ge,Qe,tt,rt){this.mid=Ne,this.left=Ge,this.right=Qe,this.leftPoints=tt,this.rightPoints=rt,this.count=(Ge?Ge.count:0)+(Qe?Qe.count:0)+tt.length}Ge.exports=createWrapper;var it=IntervalTreeNode.prototype;function copy(Ne,Ge){Ne.mid=Ge.mid,Ne.left=Ge.left,Ne.right=Ge.right,Ne.leftPoints=Ge.leftPoints,Ne.rightPoints=Ge.rightPoints,Ne.count=Ge.count}function rebuild(Ne,Ge){var Qe=createIntervalTree(Ge);Ne.mid=Qe.mid,Ne.left=Qe.left,Ne.right=Qe.right,Ne.leftPoints=Qe.leftPoints,Ne.rightPoints=Qe.rightPoints,Ne.count=Qe.count}function rebuildWithInterval(Ne,Ge){var Qe=Ne.intervals([]);Qe.push(Ge),rebuild(Ne,Qe)}function rebuildWithoutInterval(Ne,Ge){var Qe=Ne.intervals([]),tt=Qe.indexOf(Ge);return tt<0?rt:(Qe.splice(tt,1),rebuild(Ne,Qe),nt)}function reportLeftRange(Ne,Ge,Qe){for(var tt=0;tt<Ne.length&&Ne[tt][0]<=Ge;++tt){var rt=Qe(Ne[tt]);if(rt)return rt}}function reportRightRange(Ne,Ge,Qe){for(var tt=Ne.length-1;tt>=0&&Ne[tt][1]>=Ge;--tt){var rt=Qe(Ne[tt]);if(rt)return rt}}function reportRange(Ne,Ge){for(var Qe=0;Qe<Ne.length;++Qe){var tt=Ge(Ne[Qe]);if(tt)return tt}}function compareNumbers(Ne,Ge){return Ne-Ge}function compareBegin(Ne,Ge){var Qe=Ne[0]-Ge[0];return Qe||Ne[1]-Ge[1]}function compareEnd(Ne,Ge){var Qe=Ne[1]-Ge[1];return Qe||Ne[0]-Ge[0]}function createIntervalTree(Ne){if(0===Ne.length)return null;for(var Ge=[],Qe=0;Qe<Ne.length;++Qe)Ge.push(Ne[Qe][0],Ne[Qe][1]);Ge.sort(compareNumbers);var tt=Ge[Ge.length>>1],rt=[],nt=[],at=[];for(Qe=0;Qe<Ne.length;++Qe){var it=Ne[Qe];it[1]<tt?rt.push(it):tt<it[0]?nt.push(it):at.push(it)}var ot=at,dt=at.slice();return ot.sort(compareBegin),dt.sort(compareEnd),new IntervalTreeNode(tt,createIntervalTree(rt),createIntervalTree(nt),ot,dt)}function IntervalTree(Ne){this.root=Ne}it.intervals=function(Ne){return Ne.push.apply(Ne,this.leftPoints),this.left&&this.left.intervals(Ne),this.right&&this.right.intervals(Ne),Ne},it.insert=function(Ne){var Ge=this.count-this.leftPoints.length;if(this.count+=1,Ne[1]<this.mid)this.left?4*(this.left.count+1)>3*(Ge+1)?rebuildWithInterval(this,Ne):this.left.insert(Ne):this.left=createIntervalTree([Ne]);else if(Ne[0]>this.mid)this.right?4*(this.right.count+1)>3*(Ge+1)?rebuildWithInterval(this,Ne):this.right.insert(Ne):this.right=createIntervalTree([Ne]);else{var Qe=tt.ge(this.leftPoints,Ne,compareBegin),rt=tt.ge(this.rightPoints,Ne,compareEnd);this.leftPoints.splice(Qe,0,Ne),this.rightPoints.splice(rt,0,Ne)}},it.remove=function(Ne){var Ge=this.count-this.leftPoints;if(Ne[1]<this.mid)return this.left?4*(this.right?this.right.count:0)>3*(Ge-1)?rebuildWithoutInterval(this,Ne):(dt=this.left.remove(Ne))===at?(this.left=null,this.count-=1,nt):(dt===nt&&(this.count-=1),dt):rt;if(Ne[0]>this.mid)return this.right?4*(this.left?this.left.count:0)>3*(Ge-1)?rebuildWithoutInterval(this,Ne):(dt=this.right.remove(Ne))===at?(this.right=null,this.count-=1,nt):(dt===nt&&(this.count-=1),dt):rt;if(1===this.count)return this.leftPoints[0]===Ne?at:rt;if(1===this.leftPoints.length&&this.leftPoints[0]===Ne){if(this.left&&this.right){for(var Qe=this,it=this.left;it.right;)Qe=it,it=it.right;if(Qe===this)it.right=this.right;else{var ot=this.left,dt=this.right;Qe.count-=it.count,Qe.right=it.left,it.left=ot,it.right=dt}copy(this,it),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?copy(this,this.left):copy(this,this.right);return nt}for(ot=tt.ge(this.leftPoints,Ne,compareBegin);ot<this.leftPoints.length&&this.leftPoints[ot][0]===Ne[0];++ot)if(this.leftPoints[ot]===Ne)for(this.count-=1,this.leftPoints.splice(ot,1),dt=tt.ge(this.rightPoints,Ne,compareEnd);dt<this.rightPoints.length&&this.rightPoints[dt][1]===Ne[1];++dt)if(this.rightPoints[dt]===Ne)return this.rightPoints.splice(dt,1),nt;return rt},it.queryPoint=function(Ne,Ge){return Ne<this.mid?this.left&&(Qe=this.left.queryPoint(Ne,Ge))?Qe:reportLeftRange(this.leftPoints,Ne,Ge):Ne>this.mid?this.right&&(Qe=this.right.queryPoint(Ne,Ge))?Qe:reportRightRange(this.rightPoints,Ne,Ge):reportRange(this.leftPoints,Ge);var Qe},it.queryInterval=function(Ne,Ge,Qe){var tt;return Ne<this.mid&&this.left&&(tt=this.left.queryInterval(Ne,Ge,Qe))||Ge>this.mid&&this.right&&(tt=this.right.queryInterval(Ne,Ge,Qe))?tt:Ge<this.mid?reportLeftRange(this.leftPoints,Ge,Qe):Ne>this.mid?reportRightRange(this.rightPoints,Ne,Qe):reportRange(this.leftPoints,Qe)};var ot=IntervalTree.prototype;function createWrapper(Ne){return Ne&&0!==Ne.length?new IntervalTree(createIntervalTree(Ne)):new IntervalTree(null)}ot.insert=function(Ne){this.root?this.root.insert(Ne):this.root=new IntervalTreeNode(Ne[0],null,null,[Ne],[Ne])},ot.remove=function(Ne){if(this.root){var Ge=this.root.remove(Ne);return Ge===at&&(this.root=null),Ge!==rt}return!1},ot.queryPoint=function(Ne,Ge){if(this.root)return this.root.queryPoint(Ne,Ge)},ot.queryInterval=function(Ne,Ge,Qe){if(Ne<=Ge&&this.root)return this.root.queryInterval(Ne,Ge,Qe)},Object.defineProperty(ot,"count",{get:function(){return this.root?this.root.count:0}}),Object.defineProperty(ot,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}})},{"binary-search-bounds":461}],461:[function(Ne,Ge,Qe){arguments[4][243][0].apply(Qe,arguments)},{dup:243}],462:[function(Ne,Ge,Qe){"use strict";function invertPermutation(Ne,Ge){Ge=Ge||new Array(Ne.length);for(var Qe=0;Qe<Ne.length;++Qe)Ge[Ne[Qe]]=Qe;return Ge}Ge.exports=invertPermutation},{}],463:[function(Ne,Ge,Qe){"use strict";function iota(Ne){for(var Ge=new Array(Ne),Qe=0;Qe<Ne;++Qe)Ge[Qe]=Qe;return Ge}Ge.exports=iota},{}],464:[function(Ne,Ge,Qe){Ge.exports=!0},{}],465:[function(Ne,Ge,Qe){function isBuffer(Ne){return!!Ne.constructor&&"function"==typeof Ne.constructor.isBuffer&&Ne.constructor.isBuffer(Ne)}function isSlowBuffer(Ne){return"function"==typeof Ne.readFloatLE&&"function"==typeof Ne.slice&&isBuffer(Ne.slice(0,0))}Ge.exports=function(Ne){return null!=Ne&&(isBuffer(Ne)||isSlowBuffer(Ne)||!!Ne._isBuffer)}},{}],466:[function(Ne,Ge,Qe){"use strict";Ge.exports="undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion))},{}],467:[function(Ne,Ge,Qe){"use strict";Ge.exports=isMobile,Ge.exports.isMobile=isMobile,Ge.exports.default=isMobile;var tt=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i,rt=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series[46]0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i;function isMobile(Ne){Ne||(Ne={});var Ge=Ne.ua;if(Ge||"undefined"==typeof navigator||(Ge=navigator.userAgent),Ge&&Ge.headers&&"string"==typeof Ge.headers["user-agent"]&&(Ge=Ge.headers["user-agent"]),"string"!=typeof Ge)return!1;var Qe=Ne.tablet?rt.test(Ge):tt.test(Ge);return!Qe&&Ne.tablet&&Ne.featureDetect&&navigator&&navigator.maxTouchPoints>1&&-1!==Ge.indexOf("Macintosh")&&-1!==Ge.indexOf("Safari")&&(Qe=!0),Qe}},{}],468:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne){var Ge=typeof Ne;return null!==Ne&&("object"===Ge||"function"===Ge)}},{}],469:[function(Ne,Ge,Qe){"use strict";var tt=Object.prototype.toString;Ge.exports=function(Ne){var Ge;return"[object Object]"===tt.call(Ne)&&(null===(Ge=Object.getPrototypeOf(Ne))||Ge===Object.getPrototypeOf({}))}},{}],470:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne){for(var Ge,Qe=Ne.length,tt=0;tt<Qe;tt++)if(((Ge=Ne.charCodeAt(tt))<9||Ge>13)&&32!==Ge&&133!==Ge&&160!==Ge&&5760!==Ge&&6158!==Ge&&(Ge<8192||Ge>8205)&&8232!==Ge&&8233!==Ge&&8239!==Ge&&8287!==Ge&&8288!==Ge&&12288!==Ge&&65279!==Ge)return!1;return!0}},{}],471:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne){return"string"==typeof Ne&&(Ne=Ne.trim(),!!(/^[mzlhvcsqta]\s*[-+.0-9][^mlhvzcsqta]+/i.test(Ne)&&/[\dz]$/i.test(Ne)&&Ne.length>4))}},{}],472:[function(Ne,Ge,Qe){function lerp(Ne,Ge,Qe){return Ne*(1-Qe)+Ge*Qe}Ge.exports=lerp},{}],473:[function(Ne,Ge,Qe){var rt,nt;rt=this,nt=function(){"use strict";var Ne,Ge,Qe;function define(tt,rt){if(Ne)if(Ge){var nt="var sharedChunk = {}; ("+Ne+")(sharedChunk); ("+Ge+")(sharedChunk);",at={};Ne(at),(Qe=rt(at)).workerUrl=window.URL.createObjectURL(new Blob([nt],{type:"text/javascript"}))}else Ge=rt;else Ne=rt}return define(["exports"],(function(Ne){function e(Ne,Ge){return Ne(Ge={exports:{}},Ge.exports),Ge.exports}var Ge=n;function n(Ne,Ge,Qe,tt){this.cx=3*Ne,this.bx=3*(Qe-Ne)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*Ge,this.by=3*(tt-Ge)-this.cy,this.ay=1-this.cy-this.by,this.p1x=Ne,this.p1y=tt,this.p2x=Qe,this.p2y=tt}n.prototype.sampleCurveX=function(Ne){return((this.ax*Ne+this.bx)*Ne+this.cx)*Ne},n.prototype.sampleCurveY=function(Ne){return((this.ay*Ne+this.by)*Ne+this.cy)*Ne},n.prototype.sampleCurveDerivativeX=function(Ne){return(3*this.ax*Ne+2*this.bx)*Ne+this.cx},n.prototype.solveCurveX=function(Ne,Ge){var Qe,tt,rt,nt,at;for(void 0===Ge&&(Ge=1e-6),rt=Ne,at=0;at<8;at++){if(nt=this.sampleCurveX(rt)-Ne,Math.abs(nt)<Ge)return rt;var it=this.sampleCurveDerivativeX(rt);if(Math.abs(it)<1e-6)break;rt-=nt/it}if((rt=Ne)<(Qe=0))return Qe;if(rt>(tt=1))return tt;for(;Qe<tt;){if(nt=this.sampleCurveX(rt),Math.abs(nt-Ne)<Ge)return rt;Ne>nt?Qe=rt:tt=rt,rt=.5*(tt-Qe)+Qe}return rt},n.prototype.solve=function(Ne,Ge){return this.sampleCurveY(this.solveCurveX(Ne,Ge))};var Qe=a;function a(Ne,Ge){this.x=Ne,this.y=Ge}function o(Ne,Qe,tt,rt){var nt=new Ge(Ne,Qe,tt,rt);return function(Ne){return nt.solve(Ne)}}a.prototype={clone:function(){return new a(this.x,this.y)},add:function(Ne){return this.clone()._add(Ne)},sub:function(Ne){return this.clone()._sub(Ne)},multByPoint:function(Ne){return this.clone()._multByPoint(Ne)},divByPoint:function(Ne){return this.clone()._divByPoint(Ne)},mult:function(Ne){return this.clone()._mult(Ne)},div:function(Ne){return this.clone()._div(Ne)},rotate:function(Ne){return this.clone()._rotate(Ne)},rotateAround:function(Ne,Ge){return this.clone()._rotateAround(Ne,Ge)},matMult:function(Ne){return this.clone()._matMult(Ne)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(Ne){return this.x===Ne.x&&this.y===Ne.y},dist:function(Ne){return Math.sqrt(this.distSqr(Ne))},distSqr:function(Ne){var Ge=Ne.x-this.x,Qe=Ne.y-this.y;return Ge*Ge+Qe*Qe},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(Ne){return Math.atan2(this.y-Ne.y,this.x-Ne.x)},angleWith:function(Ne){return this.angleWithSep(Ne.x,Ne.y)},angleWithSep:function(Ne,Ge){return Math.atan2(this.x*Ge-this.y*Ne,this.x*Ne+this.y*Ge)},_matMult:function(Ne){var Ge=Ne[2]*this.x+Ne[3]*this.y;return this.x=Ne[0]*this.x+Ne[1]*this.y,this.y=Ge,this},_add:function(Ne){return this.x+=Ne.x,this.y+=Ne.y,this},_sub:function(Ne){return this.x-=Ne.x,this.y-=Ne.y,this},_mult:function(Ne){return this.x*=Ne,this.y*=Ne,this},_div:function(Ne){return this.x/=Ne,this.y/=Ne,this},_multByPoint:function(Ne){return this.x*=Ne.x,this.y*=Ne.y,this},_divByPoint:function(Ne){return this.x/=Ne.x,this.y/=Ne.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var Ne=this.y;return this.y=this.x,this.x=-Ne,this},_rotate:function(Ne){var Ge=Math.cos(Ne),Qe=Math.sin(Ne),tt=Qe*this.x+Ge*this.y;return this.x=Ge*this.x-Qe*this.y,this.y=tt,this},_rotateAround:function(Ne,Ge){var Qe=Math.cos(Ne),tt=Math.sin(Ne),rt=Ge.y+tt*(this.x-Ge.x)+Qe*(this.y-Ge.y);return this.x=Ge.x+Qe*(this.x-Ge.x)-tt*(this.y-Ge.y),this.y=rt,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},a.convert=function(Ne){return Ne instanceof a?Ne:Array.isArray(Ne)?new a(Ne[0],Ne[1]):Ne};var tt=o(.25,.1,.25,1);function u(Ne,Ge,Qe){return Math.min(Qe,Math.max(Ge,Ne))}function l(Ne,Ge,Qe){var tt=Qe-Ge,rt=((Ne-Ge)%tt+tt)%tt+Ge;return rt===Ge?Qe:rt}function p(Ne){for(var Ge=[],Qe=arguments.length-1;Qe-- >0;)Ge[Qe]=arguments[Qe+1];for(var tt=0,rt=Ge;tt<rt.length;tt+=1){var nt=rt[tt];for(var at in nt)Ne[at]=nt[at]}return Ne}var rt=1;function h(){return rt++}function f(){return function t(Ne){return Ne?(Ne^16*Math.random()>>Ne/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function y(Ne){return!!Ne&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(Ne)}function d(Ne,Ge){Ne.forEach((function(Ne){Ge[Ne]&&(Ge[Ne]=Ge[Ne].bind(Ge))}))}function m(Ne,Ge){return-1!==Ne.indexOf(Ge,Ne.length-Ge.length)}function v(Ne,Ge,Qe){var tt={};for(var rt in Ne)tt[rt]=Ge.call(Qe||this,Ne[rt],rt,Ne);return tt}function g(Ne,Ge,Qe){var tt={};for(var rt in Ne)Ge.call(Qe||this,Ne[rt],rt,Ne)&&(tt[rt]=Ne[rt]);return tt}function x(Ne){return Array.isArray(Ne)?Ne.map(x):"object"==typeof Ne&&Ne?v(Ne,x):Ne}var nt={};function w(Ne){nt[Ne]||("undefined"!=typeof console&&console.warn(Ne),nt[Ne]=!0)}function _(Ne,Ge,Qe){return(Qe.y-Ne.y)*(Ge.x-Ne.x)>(Ge.y-Ne.y)*(Qe.x-Ne.x)}function A(Ne){for(var Ge=0,Qe=0,tt=Ne.length,rt=tt-1,nt=void 0,at=void 0;Qe<tt;rt=Qe++)Ge+=((at=Ne[rt]).x-(nt=Ne[Qe]).x)*(nt.y+at.y);return Ge}function S(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function k(Ne){var Ge={};if(Ne.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(function(Ne,Qe,tt,rt){var nt=tt||rt;return Ge[Qe]=!nt||nt.toLowerCase(),""})),Ge["max-age"]){var Qe=parseInt(Ge["max-age"],10);isNaN(Qe)?delete Ge["max-age"]:Ge["max-age"]=Qe}return Ge}var at=null;function z(Ne){if(null==at){var Ge=Ne.navigator?Ne.navigator.userAgent:null;at=!!Ne.safari||!(!Ge||!(/\b(iPad|iPhone|iPod)\b/.test(Ge)||Ge.match("Safari")&&!Ge.match("Chrome")))}return at}function C(Ne){try{var Ge=self[Ne];return Ge.setItem("_mapbox_test_",1),Ge.removeItem("_mapbox_test_"),!0}catch(Ne){return!1}}var it,ot,dt,ht,Dt=self.performance&&self.performance.now?self.performance.now.bind(self.performance):Date.now.bind(Date),Ot=self.requestAnimationFrame||self.mozRequestAnimationFrame||self.webkitRequestAnimationFrame||self.msRequestAnimationFrame,Rt=self.cancelAnimationFrame||self.mozCancelAnimationFrame||self.webkitCancelAnimationFrame||self.msCancelAnimationFrame,Zt={now:Dt,frame:function(Ne){var Ge=Ot(Ne);return{cancel:function(){return Rt(Ge)}}},getImageData:function(Ne,Ge){void 0===Ge&&(Ge=0);var Qe=self.document.createElement("canvas"),tt=Qe.getContext("2d");if(!tt)throw new Error("failed to create canvas 2d context");return Qe.width=Ne.width,Qe.height=Ne.height,tt.drawImage(Ne,0,0,Ne.width,Ne.height),tt.getImageData(-Ge,-Ge,Ne.width+2*Ge,Ne.height+2*Ge)},resolveURL:function(Ne){return it||(it=self.document.createElement("a")),it.href=Ne,it.href},hardwareConcurrency:self.navigator.hardwareConcurrency||4,get devicePixelRatio(){return self.devicePixelRatio},get prefersReducedMotion(){return!!self.matchMedia&&(null==ot&&(ot=self.matchMedia("(prefers-reduced-motion: reduce)")),ot.matches)}},er={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},dr={supported:!1,testSupport:function(Ne){!mr&&ht&&(xr?j(Ne):dt=Ne)}},mr=!1,xr=!1;function j(Ne){var Ge=Ne.createTexture();Ne.bindTexture(Ne.TEXTURE_2D,Ge);try{if(Ne.texImage2D(Ne.TEXTURE_2D,0,Ne.RGBA,Ne.RGBA,Ne.UNSIGNED_BYTE,ht),Ne.isContextLost())return;dr.supported=!0}catch(Ne){}Ne.deleteTexture(Ge),mr=!0}self.document&&((ht=self.document.createElement("img")).onload=function(){dt&&j(dt),dt=null,xr=!0},ht.onerror=function(){mr=!0,dt=null},ht.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var br="01",N=function(Ne,Ge){this._transformRequestFn=Ne,this._customAccessToken=Ge,this._createSkuToken()};function K(Ne){return 0===Ne.indexOf("mapbox:")}N.prototype._createSkuToken=function(){var Ne=function(){for(var Ne="",Ge=0;Ge<10;Ge++)Ne+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",br,Ne].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=Ne.token,this._skuTokenExpiresAt=Ne.tokenExpiresAt},N.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},N.prototype.transformRequest=function(Ne,Ge){return this._transformRequestFn&&this._transformRequestFn(Ne,Ge)||{url:Ne}},N.prototype.normalizeStyleURL=function(Ne,Ge){if(!K(Ne))return Ne;var Qe=J(Ne);return Qe.path="/styles/v1"+Qe.path,this._makeAPIURL(Qe,this._customAccessToken||Ge)},N.prototype.normalizeGlyphsURL=function(Ne,Ge){if(!K(Ne))return Ne;var Qe=J(Ne);return Qe.path="/fonts/v1"+Qe.path,this._makeAPIURL(Qe,this._customAccessToken||Ge)},N.prototype.normalizeSourceURL=function(Ne,Ge){if(!K(Ne))return Ne;var Qe=J(Ne);return Qe.path="/v4/"+Qe.authority+".json",Qe.params.push("secure"),this._makeAPIURL(Qe,this._customAccessToken||Ge)},N.prototype.normalizeSpriteURL=function(Ne,Ge,Qe,tt){var rt=J(Ne);return K(Ne)?(rt.path="/styles/v1"+rt.path+"/sprite"+Ge+Qe,this._makeAPIURL(rt,this._customAccessToken||tt)):(rt.path+=""+Ge+Qe,H(rt))},N.prototype.normalizeTileURL=function(Ne,Ge){if(this._isSkuTokenExpired()&&this._createSkuToken(),Ne&&!K(Ne))return Ne;var Qe=J(Ne);Qe.path=Qe.path.replace(/(\.(png|jpg)\d*)(?=$)/,(Zt.devicePixelRatio>=2||512===Ge?"@2x":"")+(dr.supported?".webp":"$1")),Qe.path=Qe.path.replace(/^.+\/v4\//,"/"),Qe.path="/v4"+Qe.path;var tt=this._customAccessToken||function(Ne){for(var Ge=0,Qe=Ne;Ge<Qe.length;Ge+=1){var tt=Qe[Ge].match(/^access_token=(.*)$/);if(tt)return tt[1]}return null}(Qe.params)||er.ACCESS_TOKEN;return er.REQUIRE_ACCESS_TOKEN&&tt&&this._skuToken&&Qe.params.push("sku="+this._skuToken),this._makeAPIURL(Qe,tt)},N.prototype.canonicalizeTileURL=function(Ne,Ge){var Qe=J(Ne);if(!Qe.path.match(/(^\/v4\/)/)||!Qe.path.match(/\.[\w]+$/))return Ne;var tt="mapbox://tiles/";tt+=Qe.path.replace("/v4/","");var rt=Qe.params;return Ge&&(rt=rt.filter((function(Ne){return!Ne.match(/^access_token=/)}))),rt.length&&(tt+="?"+rt.join("&")),tt},N.prototype.canonicalizeTileset=function(Ne,Ge){for(var Qe=!!Ge&&K(Ge),tt=[],rt=0,nt=Ne.tiles||[];rt<nt.length;rt+=1){var at=nt[rt];Z(at)?tt.push(this.canonicalizeTileURL(at,Qe)):tt.push(at)}return tt},N.prototype._makeAPIURL=function(Ne,Ge){var Qe="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",tt=J(er.API_URL);if(Ne.protocol=tt.protocol,Ne.authority=tt.authority,"/"!==tt.path&&(Ne.path=""+tt.path+Ne.path),!er.REQUIRE_ACCESS_TOKEN)return H(Ne);if(!(Ge=Ge||er.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+Qe);if("s"===Ge[0])throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+Qe);return Ne.params=Ne.params.filter((function(Ne){return-1===Ne.indexOf("access_token")})),Ne.params.push("access_token="+Ge),H(Ne)};var Ar=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Z(Ne){return Ar.test(Ne)}var en=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function J(Ne){var Ge=Ne.match(en);if(!Ge)throw new Error("Unable to parse URL object");return{protocol:Ge[1],authority:Ge[2],path:Ge[3]||"/",params:Ge[4]?Ge[4].split("&"):[]}}function H(Ne){var Ge=Ne.params.length?"?"+Ne.params.join("&"):"";return Ne.protocol+"://"+Ne.authority+Ne.path+Ge}function Y(Ne){if(!Ne)return null;var Ge=Ne.split(".");if(!Ge||3!==Ge.length)return null;try{return JSON.parse(decodeURIComponent(self.atob(Ge[1]).split("").map((function(Ne){return"%"+("00"+Ne.charCodeAt(0).toString(16)).slice(-2)})).join("")))}catch(Ne){return null}}var $=function(Ne){this.type=Ne,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};$.prototype.getStorageKey=function(Ne){var Ge,Qe=Y(er.ACCESS_TOKEN);return Ge=Qe&&Qe.u?self.btoa(encodeURIComponent(Qe.u).replace(/%([0-9A-F]{2})/g,(function(Ne,Ge){return String.fromCharCode(Number("0x"+Ge))}))):er.ACCESS_TOKEN||"",Ne?"mapbox.eventData."+Ne+":"+Ge:"mapbox.eventData:"+Ge},$.prototype.fetchEventData=function(){var Ne=C("localStorage"),Ge=this.getStorageKey(),Qe=this.getStorageKey("uuid");if(Ne)try{var tt=self.localStorage.getItem(Ge);tt&&(this.eventData=JSON.parse(tt));var rt=self.localStorage.getItem(Qe);rt&&(this.anonId=rt)}catch(Ne){w("Unable to read from LocalStorage")}},$.prototype.saveEventData=function(){var Ne=C("localStorage"),Ge=this.getStorageKey(),Qe=this.getStorageKey("uuid");if(Ne)try{self.localStorage.setItem(Qe,this.anonId),Object.keys(this.eventData).length>=1&&self.localStorage.setItem(Ge,JSON.stringify(this.eventData))}catch(Ne){w("Unable to write to LocalStorage")}},$.prototype.processRequests=function(Ne){},$.prototype.postEvent=function(Ne,Ge,Qe,tt){var rt=this;if(er.EVENTS_URL){var nt=J(er.EVENTS_URL);nt.params.push("access_token="+(tt||er.ACCESS_TOKEN||""));var at={event:this.type,created:new Date(Ne).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.10.1",skuId:br,userId:this.anonId},it=Ge?p(at,Ge):at,ot={url:H(nt),headers:{"Content-Type":"text/plain"},body:JSON.stringify([it])};this.pendingRequest=xt(ot,(function(Ne){rt.pendingRequest=null,Qe(Ne),rt.saveEventData(),rt.processRequests(tt)}))}},$.prototype.queueRequest=function(Ne,Ge){this.queue.push(Ne),this.processRequests(Ge)};var mn,xn,kn=function(Ne){function e(){Ne.call(this,"map.load"),this.success={},this.skuToken=""}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.postMapLoadEvent=function(Ne,Ge,Qe,tt){this.skuToken=Qe,(er.EVENTS_URL&&tt||er.ACCESS_TOKEN&&Array.isArray(Ne)&&Ne.some((function(Ne){return K(Ne)||Z(Ne)})))&&this.queueRequest({id:Ge,timestamp:Date.now()},tt)},e.prototype.processRequests=function(Ne){var Ge=this;if(!this.pendingRequest&&0!==this.queue.length){var Qe=this.queue.shift(),tt=Qe.id,rt=Qe.timestamp;tt&&this.success[tt]||(this.anonId||this.fetchEventData(),y(this.anonId)||(this.anonId=f()),this.postEvent(rt,{skuToken:this.skuToken},(function(Ne){Ne||tt&&(Ge.success[tt]=!0)}),Ne))}},e}($),Cn=new(function(Ne){function e(Ge){Ne.call(this,"appUserTurnstile"),this._customAccessToken=Ge}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.postTurnstileEvent=function(Ne,Ge){er.EVENTS_URL&&er.ACCESS_TOKEN&&Array.isArray(Ne)&&Ne.some((function(Ne){return K(Ne)||Z(Ne)}))&&this.queueRequest(Date.now(),Ge)},e.prototype.processRequests=function(Ne){var Ge=this;if(!this.pendingRequest&&0!==this.queue.length){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var Qe=Y(er.ACCESS_TOKEN),tt=Qe?Qe.u:er.ACCESS_TOKEN,rt=tt!==this.eventData.tokenU;y(this.anonId)||(this.anonId=f(),rt=!0);var nt=this.queue.shift();if(this.eventData.lastSuccess){var at=new Date(this.eventData.lastSuccess),it=new Date(nt),ot=(nt-this.eventData.lastSuccess)/864e5;rt=rt||ot>=1||ot<-1||at.getDate()!==it.getDate()}else rt=!0;if(!rt)return this.processRequests();this.postEvent(nt,{"enabled.telemetry":!1},(function(Ne){Ne||(Ge.eventData.lastSuccess=nt,Ge.eventData.tokenU=tt)}),Ne)}},e}($)),En=Cn.postTurnstileEvent.bind(Cn),Pn=new kn,Dn=Pn.postMapLoadEvent.bind(Pn),In=500,zn=50;function st(){self.caches&&!mn&&(mn=self.caches.open("mapbox-tiles"))}function ut(Ne){var Ge=Ne.indexOf("?");return Ge<0?Ne:Ne.slice(0,Ge)}var Bn,Vn=1/0;function ct(){return null==Bn&&(Bn=self.OffscreenCanvas&&new self.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof self.createImageBitmap),Bn}var Hn={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(Hn);var qn,Yn,$n=function(Ne){function e(Ge,Qe,tt){401===Qe&&Z(tt)&&(Ge+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),Ne.call(this,Ge),this.status=Qe,this.url=tt,this.name=this.constructor.name,this.message=Ge}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},e}(Error),ra=S()?function(){return self.worker&&self.worker.referrer}:function(){return("blob:"===self.location.protocol?self.parent:self).location.href},vt=function(Ne,Ge){if(!(/^file:/.test(Qe=Ne.url)||/^file:/.test(ra())&&!/^\w+:/.test(Qe))){if(self.fetch&&self.Request&&self.AbortController&&self.Request.prototype.hasOwnProperty("signal"))return function(Ne,Ge){var Qe,tt=new self.AbortController,rt=new self.Request(Ne.url,{method:Ne.method||"GET",body:Ne.body,credentials:Ne.credentials,headers:Ne.headers,referrer:ra(),signal:tt.signal}),nt=!1,at=!1,it=(Qe=rt.url).indexOf("sku=")>0&&Z(Qe);"json"===Ne.type&&rt.headers.set("Accept","application/json");var u=function(Qe,tt,nt){if(!at){if(Qe&&"SecurityError"!==Qe.message&&w(Qe),tt&&nt)return l(tt);var ot=Date.now();self.fetch(rt).then((function(Qe){if(Qe.ok){var tt=it?Qe.clone():null;return l(Qe,tt,ot)}return Ge(new $n(Qe.statusText,Qe.status,Ne.url))})).catch((function(Ne){20!==Ne.code&&Ge(new Error(Ne.message))}))}},l=function(Qe,tt,it){("arrayBuffer"===Ne.type?Qe.arrayBuffer():"json"===Ne.type?Qe.json():Qe.text()).then((function(Ne){at||(tt&&it&&function(Ne,Ge,Qe){if(st(),mn){var tt={status:Ge.status,statusText:Ge.statusText,headers:new self.Headers};Ge.headers.forEach((function(Ne,Ge){return tt.headers.set(Ge,Ne)}));var rt=k(Ge.headers.get("Cache-Control")||"");rt["no-store"]||(rt["max-age"]&&tt.headers.set("Expires",new Date(Qe+1e3*rt["max-age"]).toUTCString()),new Date(tt.headers.get("Expires")).getTime()-Qe<42e4||function(Ne,Ge){if(void 0===xn)try{new Response(new ReadableStream),xn=!0}catch(Ne){xn=!1}xn?Ge(Ne.body):Ne.blob().then(Ge)}(Ge,(function(Ge){var Qe=new self.Response(Ge,tt);st(),mn&&mn.then((function(Ge){return Ge.put(ut(Ne.url),Qe)})).catch((function(Ne){return w(Ne.message)}))})))}}(rt,tt,it),nt=!0,Ge(null,Ne,Qe.headers.get("Cache-Control"),Qe.headers.get("Expires")))})).catch((function(Ne){at||Ge(new Error(Ne.message))}))};return it?function(Ne,Ge){if(st(),!mn)return Ge(null);var Qe=ut(Ne.url);mn.then((function(Ne){Ne.match(Qe).then((function(tt){var rt=function(Ne){if(!Ne)return!1;var Ge=new Date(Ne.headers.get("Expires")||0),Qe=k(Ne.headers.get("Cache-Control")||"");return Ge>Date.now()&&!Qe["no-cache"]}(tt);Ne.delete(Qe),rt&&Ne.put(Qe,tt.clone()),Ge(null,tt,rt)})).catch(Ge)})).catch(Ge)}(rt,u):u(null,null),{cancel:function(){at=!0,nt||tt.abort()}}}(Ne,Ge);if(S()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",Ne,Ge,void 0,!0)}var Qe;return function(Ne,Ge){var Qe=new self.XMLHttpRequest;for(var tt in Qe.open(Ne.method||"GET",Ne.url,!0),"arrayBuffer"===Ne.type&&(Qe.responseType="arraybuffer"),Ne.headers)Qe.setRequestHeader(tt,Ne.headers[tt]);return"json"===Ne.type&&(Qe.responseType="text",Qe.setRequestHeader("Accept","application/json")),Qe.withCredentials="include"===Ne.credentials,Qe.onerror=function(){Ge(new Error(Qe.statusText))},Qe.onload=function(){if((Qe.status>=200&&Qe.status<300||0===Qe.status)&&null!==Qe.response){var tt=Qe.response;if("json"===Ne.type)try{tt=JSON.parse(Qe.response)}catch(Ne){return Ge(Ne)}Ge(null,tt,Qe.getResponseHeader("Cache-Control"),Qe.getResponseHeader("Expires"))}else Ge(new $n(Qe.statusText,Qe.status,Ne.url))},Qe.send(Ne.body),{cancel:function(){return Qe.abort()}}}(Ne,Ge)},gt=function(Ne,Ge){return vt(p(Ne,{type:"arrayBuffer"}),Ge)},xt=function(Ne,Ge){return vt(p(Ne,{method:"POST"}),Ge)};qn=[],Yn=0;var bt=function(Ne,Ge){if(dr.supported&&(Ne.headers||(Ne.headers={}),Ne.headers.accept="image/webp,*/*"),Yn>=er.MAX_PARALLEL_IMAGE_REQUESTS){var Qe={requestParameters:Ne,callback:Ge,cancelled:!1,cancel:function(){this.cancelled=!0}};return qn.push(Qe),Qe}Yn++;var tt=!1,i=function(){if(!tt)for(tt=!0,Yn--;qn.length&&Yn<er.MAX_PARALLEL_IMAGE_REQUESTS;){var Ne=qn.shift();Ne.cancelled||(Ne.cancel=bt(Ne.requestParameters,Ne.callback).cancel)}},rt=gt(Ne,(function(Ne,Qe,tt,rt){i(),Ne?Ge(Ne):Qe&&(ct()?function(Ne,Ge){var Qe=new self.Blob([new Uint8Array(Ne)],{type:"image/png"});self.createImageBitmap(Qe).then((function(Ne){Ge(null,Ne)})).catch((function(Ne){Ge(new Error("Could not load image because of "+Ne.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))}))}(Qe,Ge):function(Ne,Ge,Qe,tt){var rt=new self.Image,nt=self.URL;rt.onload=function(){Ge(null,rt),nt.revokeObjectURL(rt.src)},rt.onerror=function(){return Ge(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var at=new self.Blob([new Uint8Array(Ne)],{type:"image/png"});rt.cacheControl=Qe,rt.expires=tt,rt.src=Ne.byteLength?nt.createObjectURL(at):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}(Qe,Ge,tt,rt))}));return{cancel:function(){rt.cancel(),i()}}};function wt(Ne,Ge,Qe){Qe[Ne]&&-1!==Qe[Ne].indexOf(Ge)||(Qe[Ne]=Qe[Ne]||[],Qe[Ne].push(Ge))}function _t(Ne,Ge,Qe){if(Qe&&Qe[Ne]){var tt=Qe[Ne].indexOf(Ge);-1!==tt&&Qe[Ne].splice(tt,1)}}var At=function(Ne,Ge){void 0===Ge&&(Ge={}),p(this,Ge),this.type=Ne},oa=function(Ne){function e(Ge,Qe){void 0===Qe&&(Qe={}),Ne.call(this,"error",p({error:Ge},Qe))}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e}(At),kt=function(){};kt.prototype.on=function(Ne,Ge){return this._listeners=this._listeners||{},wt(Ne,Ge,this._listeners),this},kt.prototype.off=function(Ne,Ge){return _t(Ne,Ge,this._listeners),_t(Ne,Ge,this._oneTimeListeners),this},kt.prototype.once=function(Ne,Ge){return this._oneTimeListeners=this._oneTimeListeners||{},wt(Ne,Ge,this._oneTimeListeners),this},kt.prototype.fire=function(Ne,Ge){"string"==typeof Ne&&(Ne=new At(Ne,Ge||{}));var Qe=Ne.type;if(this.listens(Qe)){Ne.target=this;for(var tt=0,rt=this._listeners&&this._listeners[Qe]?this._listeners[Qe].slice():[];tt<rt.length;tt+=1)rt[tt].call(this,Ne);for(var nt=0,at=this._oneTimeListeners&&this._oneTimeListeners[Qe]?this._oneTimeListeners[Qe].slice():[];nt<at.length;nt+=1){var it=at[nt];_t(Qe,it,this._oneTimeListeners),it.call(this,Ne)}var ot=this._eventedParent;ot&&(p(Ne,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),ot.fire(Ne))}else Ne instanceof oa&&console.error(Ne.error);return this},kt.prototype.listens=function(Ne){return this._listeners&&this._listeners[Ne]&&this._listeners[Ne].length>0||this._oneTimeListeners&&this._oneTimeListeners[Ne]&&this._oneTimeListeners[Ne].length>0||this._eventedParent&&this._eventedParent.listens(Ne)},kt.prototype.setEventedParent=function(Ne,Ge){return this._eventedParent=Ne,this._eventedParentData=Ge,this};var pa={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},expression_name:{type:"enum",values:{let:{group:"Variable binding"},var:{group:"Variable binding"},literal:{group:"Types"},array:{group:"Types"},at:{group:"Lookup"},in:{group:"Lookup"},"index-of":{group:"Lookup"},slice:{group:"Lookup"},case:{group:"Decision"},match:{group:"Decision"},coalesce:{group:"Decision"},step:{group:"Ramps, scales, curves"},interpolate:{group:"Ramps, scales, curves"},"interpolate-hcl":{group:"Ramps, scales, curves"},"interpolate-lab":{group:"Ramps, scales, curves"},ln2:{group:"Math"},pi:{group:"Math"},e:{group:"Math"},typeof:{group:"Types"},string:{group:"Types"},number:{group:"Types"},boolean:{group:"Types"},object:{group:"Types"},collator:{group:"Types"},format:{group:"Types"},image:{group:"Types"},"number-format":{group:"Types"},"to-string":{group:"Types"},"to-number":{group:"Types"},"to-boolean":{group:"Types"},"to-rgba":{group:"Color"},"to-color":{group:"Types"},rgb:{group:"Color"},rgba:{group:"Color"},get:{group:"Lookup"},has:{group:"Lookup"},length:{group:"Lookup"},properties:{group:"Feature data"},"feature-state":{group:"Feature data"},"geometry-type":{group:"Feature data"},id:{group:"Feature data"},zoom:{group:"Zoom"},"heatmap-density":{group:"Heatmap"},"line-progress":{group:"Feature data"},accumulated:{group:"Feature data"},"+":{group:"Math"},"*":{group:"Math"},"-":{group:"Math"},"/":{group:"Math"},"%":{group:"Math"},"^":{group:"Math"},sqrt:{group:"Math"},log10:{group:"Math"},ln:{group:"Math"},log2:{group:"Math"},sin:{group:"Math"},cos:{group:"Math"},tan:{group:"Math"},asin:{group:"Math"},acos:{group:"Math"},atan:{group:"Math"},min:{group:"Math"},max:{group:"Math"},round:{group:"Math"},abs:{group:"Math"},ceil:{group:"Math"},floor:{group:"Math"},distance:{group:"Math"},"==":{group:"Decision"},"!=":{group:"Decision"},">":{group:"Decision"},"<":{group:"Decision"},">=":{group:"Decision"},"<=":{group:"Decision"},all:{group:"Decision"},any:{group:"Decision"},"!":{group:"Decision"},within:{group:"Decision"},"is-supported-script":{group:"String"},upcase:{group:"String"},downcase:{group:"String"},concat:{group:"String"},"resolved-locale":{group:"String"}}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},zt=function(Ne,Ge,Qe,tt){this.message=(Ne?Ne+": ":"")+Qe,tt&&(this.identifier=tt),null!=Ge&&Ge.__line__&&(this.line=Ge.__line__)};function Ct(Ne){var Ge=Ne.value;return Ge?[new zt(Ne.key,Ge,"constants have been deprecated as of v8")]:[]}function Mt(Ne){for(var Ge=[],Qe=arguments.length-1;Qe-- >0;)Ge[Qe]=arguments[Qe+1];for(var tt=0,rt=Ge;tt<rt.length;tt+=1){var nt=rt[tt];for(var at in nt)Ne[at]=nt[at]}return Ne}function Et(Ne){return Ne instanceof Number||Ne instanceof String||Ne instanceof Boolean?Ne.valueOf():Ne}function Tt(Ne){if(Array.isArray(Ne))return Ne.map(Tt);if(Ne instanceof Object&&!(Ne instanceof Number||Ne instanceof String||Ne instanceof Boolean)){var Ge={};for(var Qe in Ne)Ge[Qe]=Tt(Ne[Qe]);return Ge}return Et(Ne)}var ga=function(Ne){function e(Ge,Qe){Ne.call(this,Qe),this.message=Qe,this.key=Ge}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e}(Error),Bt=function(Ne,Ge){void 0===Ge&&(Ge=[]),this.parent=Ne,this.bindings={};for(var Qe=0,tt=Ge;Qe<tt.length;Qe+=1){var rt=tt[Qe];this.bindings[rt[0]]=rt[1]}};Bt.prototype.concat=function(Ne){return new Bt(this,Ne)},Bt.prototype.get=function(Ne){if(this.bindings[Ne])return this.bindings[Ne];if(this.parent)return this.parent.get(Ne);throw new Error(Ne+" not found in scope.")},Bt.prototype.has=function(Ne){return!!this.bindings[Ne]||!!this.parent&&this.parent.has(Ne)};var ma={kind:"null"},_a={kind:"number"},Va={kind:"string"},Wa={kind:"boolean"},Qa={kind:"color"},ti={kind:"object"},ni={kind:"value"},di={kind:"collator"},ji={kind:"formatted"},Hi={kind:"resolvedImage"};function Kt(Ne,Ge){return{kind:"array",itemType:Ne,N:Ge}}function Gt(Ne){if("array"===Ne.kind){var Ge=Gt(Ne.itemType);return"number"==typeof Ne.N?"array<"+Ge+", "+Ne.N+">":"value"===Ne.itemType.kind?"array":"array<"+Ge+">"}return Ne.kind}var Yi=[ma,_a,Va,Wa,Qa,ji,ti,Kt(ni),Hi];function Xt(Ne,Ge){if("error"===Ge.kind)return null;if("array"===Ne.kind){if("array"===Ge.kind&&(0===Ge.N&&"value"===Ge.itemType.kind||!Xt(Ne.itemType,Ge.itemType))&&("number"!=typeof Ne.N||Ne.N===Ge.N))return null}else{if(Ne.kind===Ge.kind)return null;if("value"===Ne.kind)for(var Qe=0,tt=Yi;Qe<tt.length;Qe+=1)if(!Xt(tt[Qe],Ge))return null}return"Expected "+Gt(Ne)+" but found "+Gt(Ge)+" instead."}function Jt(Ne,Ge){return Ge.some((function(Ge){return Ge.kind===Ne.kind}))}function Ht(Ne,Ge){return Ge.some((function(Ge){return"null"===Ge?null===Ne:"array"===Ge?Array.isArray(Ne):"object"===Ge?Ne&&!Array.isArray(Ne)&&"object"==typeof Ne:Ge===typeof Ne}))}var uo=e((function(Ne,Ge){var Qe={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function n(Ne){return(Ne=Math.round(Ne))<0?0:Ne>255?255:Ne}function i(Ne){return n("%"===Ne[Ne.length-1]?parseFloat(Ne)/100*255:parseInt(Ne))}function a(Ne){return(Ge="%"===Ne[Ne.length-1]?parseFloat(Ne)/100:parseFloat(Ne))<0?0:Ge>1?1:Ge;var Ge}function o(Ne,Ge,Qe){return Qe<0?Qe+=1:Qe>1&&(Qe-=1),6*Qe<1?Ne+(Ge-Ne)*Qe*6:2*Qe<1?Ge:3*Qe<2?Ne+(Ge-Ne)*(2/3-Qe)*6:Ne}try{Ge.parseCSSColor=function(Ne){var Ge,tt=Ne.replace(/ /g,"").toLowerCase();if(tt in Qe)return Qe[tt].slice();if("#"===tt[0])return 4===tt.length?(Ge=parseInt(tt.substr(1),16))>=0&&Ge<=4095?[(3840&Ge)>>4|(3840&Ge)>>8,240&Ge|(240&Ge)>>4,15&Ge|(15&Ge)<<4,1]:null:7===tt.length&&(Ge=parseInt(tt.substr(1),16))>=0&&Ge<=16777215?[(16711680&Ge)>>16,(65280&Ge)>>8,255&Ge,1]:null;var rt=tt.indexOf("("),nt=tt.indexOf(")");if(-1!==rt&&nt+1===tt.length){var at=tt.substr(0,rt),it=tt.substr(rt+1,nt-(rt+1)).split(","),ot=1;switch(at){case"rgba":if(4!==it.length)return null;ot=a(it.pop());case"rgb":return 3!==it.length?null:[i(it[0]),i(it[1]),i(it[2]),ot];case"hsla":if(4!==it.length)return null;ot=a(it.pop());case"hsl":if(3!==it.length)return null;var dt=(parseFloat(it[0])%360+360)%360/360,ht=a(it[1]),Dt=a(it[2]),Ot=Dt<=.5?Dt*(ht+1):Dt+ht-Dt*ht,Rt=2*Dt-Ot;return[n(255*o(Rt,Ot,dt+1/3)),n(255*o(Rt,Ot,dt)),n(255*o(Rt,Ot,dt-1/3)),ot];default:return null}}return null}}catch(Ne){}})).parseCSSColor,$t=function(Ne,Ge,Qe,tt){void 0===tt&&(tt=1),this.r=Ne,this.g=Ge,this.b=Qe,this.a=tt};$t.parse=function(Ne){if(Ne){if(Ne instanceof $t)return Ne;if("string"==typeof Ne){var Ge=uo(Ne);if(Ge)return new $t(Ge[0]/255*Ge[3],Ge[1]/255*Ge[3],Ge[2]/255*Ge[3],Ge[3])}}},$t.prototype.toString=function(){var Ne=this.toArray(),Ge=Ne[1],Qe=Ne[2],tt=Ne[3];return"rgba("+Math.round(Ne[0])+","+Math.round(Ge)+","+Math.round(Qe)+","+tt+")"},$t.prototype.toArray=function(){var Ne=this.a;return 0===Ne?[0,0,0,0]:[255*this.r/Ne,255*this.g/Ne,255*this.b/Ne,Ne]},$t.black=new $t(0,0,0,1),$t.white=new $t(1,1,1,1),$t.transparent=new $t(0,0,0,0),$t.red=new $t(1,0,0,1);var Wt=function(Ne,Ge,Qe){this.sensitivity=Ne?Ge?"variant":"case":Ge?"accent":"base",this.locale=Qe,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Wt.prototype.compare=function(Ne,Ge){return this.collator.compare(Ne,Ge)},Wt.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Qt=function(Ne,Ge,Qe,tt,rt){this.text=Ne,this.image=Ge,this.scale=Qe,this.fontStack=tt,this.textColor=rt},te=function(Ne){this.sections=Ne};te.fromString=function(Ne){return new te([new Qt(Ne,null,null,null,null)])},te.prototype.isEmpty=function(){return 0===this.sections.length||!this.sections.some((function(Ne){return 0!==Ne.text.length||Ne.image&&0!==Ne.image.name.length}))},te.factory=function(Ne){return Ne instanceof te?Ne:te.fromString(Ne)},te.prototype.toString=function(){return 0===this.sections.length?"":this.sections.map((function(Ne){return Ne.text})).join("")},te.prototype.serialize=function(){for(var Ne=["format"],Ge=0,Qe=this.sections;Ge<Qe.length;Ge+=1){var tt=Qe[Ge];if(tt.image)Ne.push(["image",tt.image.name]);else{Ne.push(tt.text);var rt={};tt.fontStack&&(rt["text-font"]=["literal",tt.fontStack.split(",")]),tt.scale&&(rt["font-scale"]=tt.scale),tt.textColor&&(rt["text-color"]=["rgba"].concat(tt.textColor.toArray())),Ne.push(rt)}}return Ne};var ee=function(Ne){this.name=Ne.name,this.available=Ne.available};function re(Ne,Ge,Qe,tt){return"number"==typeof Ne&&Ne>=0&&Ne<=255&&"number"==typeof Ge&&Ge>=0&&Ge<=255&&"number"==typeof Qe&&Qe>=0&&Qe<=255?void 0===tt||"number"==typeof tt&&tt>=0&&tt<=1?null:"Invalid rgba value ["+[Ne,Ge,Qe,tt].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+("number"==typeof tt?[Ne,Ge,Qe,tt]:[Ne,Ge,Qe]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function ne(Ne){if(null===Ne)return!0;if("string"==typeof Ne)return!0;if("boolean"==typeof Ne)return!0;if("number"==typeof Ne)return!0;if(Ne instanceof $t)return!0;if(Ne instanceof Wt)return!0;if(Ne instanceof te)return!0;if(Ne instanceof ee)return!0;if(Array.isArray(Ne)){for(var Ge=0,Qe=Ne;Ge<Qe.length;Ge+=1)if(!ne(Qe[Ge]))return!1;return!0}if("object"==typeof Ne){for(var tt in Ne)if(!ne(Ne[tt]))return!1;return!0}return!1}function ie(Ne){if(null===Ne)return ma;if("string"==typeof Ne)return Va;if("boolean"==typeof Ne)return Wa;if("number"==typeof Ne)return _a;if(Ne instanceof $t)return Qa;if(Ne instanceof Wt)return di;if(Ne instanceof te)return ji;if(Ne instanceof ee)return Hi;if(Array.isArray(Ne)){for(var Ge,Qe=Ne.length,tt=0,rt=Ne;tt<rt.length;tt+=1){var nt=ie(rt[tt]);if(Ge){if(Ge===nt)continue;Ge=ni;break}Ge=nt}return Kt(Ge||ni,Qe)}return ti}function ae(Ne){var Ge=typeof Ne;return null===Ne?"":"string"===Ge||"number"===Ge||"boolean"===Ge?String(Ne):Ne instanceof $t||Ne instanceof te||Ne instanceof ee?Ne.toString():JSON.stringify(Ne)}ee.prototype.toString=function(){return this.name},ee.fromString=function(Ne){return Ne?new ee({name:Ne,available:!1}):null},ee.prototype.serialize=function(){return["image",this.name]};var oe=function(Ne,Ge){this.type=Ne,this.value=Ge};oe.parse=function(Ne,Ge){if(2!==Ne.length)return Ge.error("'literal' expression requires exactly one argument, but found "+(Ne.length-1)+" instead.");if(!ne(Ne[1]))return Ge.error("invalid value");var Qe=Ne[1],tt=ie(Qe),rt=Ge.expectedType;return"array"!==tt.kind||0!==tt.N||!rt||"array"!==rt.kind||"number"==typeof rt.N&&0!==rt.N||(tt=rt),new oe(tt,Qe)},oe.prototype.evaluate=function(){return this.value},oe.prototype.eachChild=function(){},oe.prototype.outputDefined=function(){return!0},oe.prototype.serialize=function(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof $t?["rgba"].concat(this.value.toArray()):this.value instanceof te?this.value.serialize():this.value};var se=function(Ne){this.name="ExpressionEvaluationError",this.message=Ne};se.prototype.toJSON=function(){return this.message};var go={string:Va,number:_a,boolean:Wa,object:ti},le=function(Ne,Ge){this.type=Ne,this.args=Ge};le.parse=function(Ne,Ge){if(Ne.length<2)return Ge.error("Expected at least one argument.");var Qe,tt=1,rt=Ne[0];if("array"===rt){var nt,at;if(Ne.length>2){var it=Ne[1];if("string"!=typeof it||!(it in go)||"object"===it)return Ge.error('The item type argument of "array" must be one of string, number, boolean',1);nt=go[it],tt++}else nt=ni;if(Ne.length>3){if(null!==Ne[2]&&("number"!=typeof Ne[2]||Ne[2]<0||Ne[2]!==Math.floor(Ne[2])))return Ge.error('The length argument to "array" must be a positive integer literal',2);at=Ne[2],tt++}Qe=Kt(nt,at)}else Qe=go[rt];for(var ot=[];tt<Ne.length;tt++){var dt=Ge.parse(Ne[tt],tt,ni);if(!dt)return null;ot.push(dt)}return new le(Qe,ot)},le.prototype.evaluate=function(Ne){for(var Ge=0;Ge<this.args.length;Ge++){var Qe=this.args[Ge].evaluate(Ne);if(!Xt(this.type,ie(Qe)))return Qe;if(Ge===this.args.length-1)throw new se("Expected value to be of type "+Gt(this.type)+", but found "+Gt(ie(Qe))+" instead.")}return null},le.prototype.eachChild=function(Ne){this.args.forEach(Ne)},le.prototype.outputDefined=function(){return this.args.every((function(Ne){return Ne.outputDefined()}))},le.prototype.serialize=function(){var Ne=this.type,Ge=[Ne.kind];if("array"===Ne.kind){var Qe=Ne.itemType;if("string"===Qe.kind||"number"===Qe.kind||"boolean"===Qe.kind){Ge.push(Qe.kind);var tt=Ne.N;("number"==typeof tt||this.args.length>1)&&Ge.push(tt)}}return Ge.concat(this.args.map((function(Ne){return Ne.serialize()})))};var pe=function(Ne){this.type=ji,this.sections=Ne};pe.parse=function(Ne,Ge){if(Ne.length<2)return Ge.error("Expected at least one argument.");var Qe=Ne[1];if(!Array.isArray(Qe)&&"object"==typeof Qe)return Ge.error("First argument must be an image or text section.");for(var tt=[],rt=!1,nt=1;nt<=Ne.length-1;++nt){var at=Ne[nt];if(rt&&"object"==typeof at&&!Array.isArray(at)){rt=!1;var it=null;if(at["font-scale"]&&!(it=Ge.parse(at["font-scale"],1,_a)))return null;var ot=null;if(at["text-font"]&&!(ot=Ge.parse(at["text-font"],1,Kt(Va))))return null;var dt=null;if(at["text-color"]&&!(dt=Ge.parse(at["text-color"],1,Qa)))return null;var ht=tt[tt.length-1];ht.scale=it,ht.font=ot,ht.textColor=dt}else{var Dt=Ge.parse(Ne[nt],1,ni);if(!Dt)return null;var Ot=Dt.type.kind;if("string"!==Ot&&"value"!==Ot&&"null"!==Ot&&"resolvedImage"!==Ot)return Ge.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");rt=!0,tt.push({content:Dt,scale:null,font:null,textColor:null})}}return new pe(tt)},pe.prototype.evaluate=function(Ne){return new te(this.sections.map((function(Ge){var Qe=Ge.content.evaluate(Ne);return ie(Qe)===Hi?new Qt("",Qe,null,null,null):new Qt(ae(Qe),null,Ge.scale?Ge.scale.evaluate(Ne):null,Ge.font?Ge.font.evaluate(Ne).join(","):null,Ge.textColor?Ge.textColor.evaluate(Ne):null)})))},pe.prototype.eachChild=function(Ne){for(var Ge=0,Qe=this.sections;Ge<Qe.length;Ge+=1){var tt=Qe[Ge];Ne(tt.content),tt.scale&&Ne(tt.scale),tt.font&&Ne(tt.font),tt.textColor&&Ne(tt.textColor)}},pe.prototype.outputDefined=function(){return!1},pe.prototype.serialize=function(){for(var Ne=["format"],Ge=0,Qe=this.sections;Ge<Qe.length;Ge+=1){var tt=Qe[Ge];Ne.push(tt.content.serialize());var rt={};tt.scale&&(rt["font-scale"]=tt.scale.serialize()),tt.font&&(rt["text-font"]=tt.font.serialize()),tt.textColor&&(rt["text-color"]=tt.textColor.serialize()),Ne.push(rt)}return Ne};var ce=function(Ne){this.type=Hi,this.input=Ne};ce.parse=function(Ne,Ge){if(2!==Ne.length)return Ge.error("Expected two arguments.");var Qe=Ge.parse(Ne[1],1,Va);return Qe?new ce(Qe):Ge.error("No image name provided.")},ce.prototype.evaluate=function(Ne){var Ge=this.input.evaluate(Ne),Qe=ee.fromString(Ge);return Qe&&Ne.availableImages&&(Qe.available=Ne.availableImages.indexOf(Ge)>-1),Qe},ce.prototype.eachChild=function(Ne){Ne(this.input)},ce.prototype.outputDefined=function(){return!1},ce.prototype.serialize=function(){return["image",this.input.serialize()]};var ns={"to-boolean":Wa,"to-color":Qa,"to-number":_a,"to-string":Va},fe=function(Ne,Ge){this.type=Ne,this.args=Ge};fe.parse=function(Ne,Ge){if(Ne.length<2)return Ge.error("Expected at least one argument.");var Qe=Ne[0];if(("to-boolean"===Qe||"to-string"===Qe)&&2!==Ne.length)return Ge.error("Expected one argument.");for(var tt=ns[Qe],rt=[],nt=1;nt<Ne.length;nt++){var at=Ge.parse(Ne[nt],nt,ni);if(!at)return null;rt.push(at)}return new fe(tt,rt)},fe.prototype.evaluate=function(Ne){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(Ne));if("color"===this.type.kind){for(var Ge,Qe,tt=0,rt=this.args;tt<rt.length;tt+=1){if(Qe=null,(Ge=rt[tt].evaluate(Ne))instanceof $t)return Ge;if("string"==typeof Ge){var nt=Ne.parseColor(Ge);if(nt)return nt}else if(Array.isArray(Ge)&&!(Qe=Ge.length<3||Ge.length>4?"Invalid rbga value "+JSON.stringify(Ge)+": expected an array containing either three or four numeric values.":re(Ge[0],Ge[1],Ge[2],Ge[3])))return new $t(Ge[0]/255,Ge[1]/255,Ge[2]/255,Ge[3])}throw new se(Qe||"Could not parse color from value '"+("string"==typeof Ge?Ge:String(JSON.stringify(Ge)))+"'")}if("number"===this.type.kind){for(var at=null,it=0,ot=this.args;it<ot.length;it+=1){if(null===(at=ot[it].evaluate(Ne)))return 0;var dt=Number(at);if(!isNaN(dt))return dt}throw new se("Could not convert "+JSON.stringify(at)+" to number.")}return"formatted"===this.type.kind?te.fromString(ae(this.args[0].evaluate(Ne))):"resolvedImage"===this.type.kind?ee.fromString(ae(this.args[0].evaluate(Ne))):ae(this.args[0].evaluate(Ne))},fe.prototype.eachChild=function(Ne){this.args.forEach(Ne)},fe.prototype.outputDefined=function(){return this.args.every((function(Ne){return Ne.outputDefined()}))},fe.prototype.serialize=function(){if("formatted"===this.type.kind)return new pe([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new ce(this.args[0]).serialize();var Ne=["to-"+this.type.kind];return this.eachChild((function(Ge){Ne.push(Ge.serialize())})),Ne};var as=["Unknown","Point","LineString","Polygon"],de=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};de.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},de.prototype.geometryType=function(){return this.feature?"number"==typeof this.feature.type?as[this.feature.type]:this.feature.type:null},de.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},de.prototype.canonicalID=function(){return this.canonical},de.prototype.properties=function(){return this.feature&&this.feature.properties||{}},de.prototype.parseColor=function(Ne){var Ge=this._parseColorCache[Ne];return Ge||(Ge=this._parseColorCache[Ne]=$t.parse(Ne)),Ge};var me=function(Ne,Ge,Qe,tt){this.name=Ne,this.type=Ge,this._evaluate=Qe,this.args=tt};me.prototype.evaluate=function(Ne){return this._evaluate(Ne,this.args)},me.prototype.eachChild=function(Ne){this.args.forEach(Ne)},me.prototype.outputDefined=function(){return!1},me.prototype.serialize=function(){return[this.name].concat(this.args.map((function(Ne){return Ne.serialize()})))},me.parse=function(Ne,Ge){var Qe,tt=Ne[0],rt=me.definitions[tt];if(!rt)return Ge.error('Unknown expression "'+tt+'". If you wanted a literal array, use ["literal", [...]].',0);for(var nt=Array.isArray(rt)?rt[0]:rt.type,at=Array.isArray(rt)?[[rt[1],rt[2]]]:rt.overloads,it=at.filter((function(Ge){var Qe=Ge[0];return!Array.isArray(Qe)||Qe.length===Ne.length-1})),ot=null,dt=0,ht=it;dt<ht.length;dt+=1){var Dt=ht[dt],Ot=Dt[0],Rt=Dt[1];ot=new Re(Ge.registry,Ge.path,null,Ge.scope);for(var Zt=[],er=!1,dr=1;dr<Ne.length;dr++){var mr=Ne[dr],xr=Array.isArray(Ot)?Ot[dr-1]:Ot.type,br=ot.parse(mr,1+Zt.length,xr);if(!br){er=!0;break}Zt.push(br)}if(!er)if(Array.isArray(Ot)&&Ot.length!==Zt.length)ot.error("Expected "+Ot.length+" arguments, but found "+Zt.length+" instead.");else{for(var Ar=0;Ar<Zt.length;Ar++){var en=Array.isArray(Ot)?Ot[Ar]:Ot.type,mn=Zt[Ar];ot.concat(Ar+1).checkSubtype(en,mn.type)}if(0===ot.errors.length)return new me(tt,nt,Rt,Zt)}}if(1===it.length)(Qe=Ge.errors).push.apply(Qe,ot.errors);else{for(var xn=(it.length?it:at).map((function(Ne){var Ge;return Ge=Ne[0],Array.isArray(Ge)?"("+Ge.map(Gt).join(", ")+")":"("+Gt(Ge.type)+"...)"})).join(" | "),kn=[],Cn=1;Cn<Ne.length;Cn++){var En=Ge.parse(Ne[Cn],1+kn.length);if(!En)return null;kn.push(Gt(En.type))}Ge.error("Expected arguments of type "+xn+", but found ("+kn.join(", ")+") instead.")}return null},me.register=function(Ne,Ge){for(var Qe in me.definitions=Ge,Ge)Ne[Qe]=me};var ve=function(Ne,Ge,Qe){this.type=di,this.locale=Qe,this.caseSensitive=Ne,this.diacriticSensitive=Ge};function ge(Ne,Ge){Ne[0]=Math.min(Ne[0],Ge[0]),Ne[1]=Math.min(Ne[1],Ge[1]),Ne[2]=Math.max(Ne[2],Ge[0]),Ne[3]=Math.max(Ne[3],Ge[1])}function xe(Ne,Ge){return!(Ne[0]<=Ge[0]||Ne[2]>=Ge[2]||Ne[1]<=Ge[1]||Ne[3]>=Ge[3])}function be(Ne,Ge){var Qe=(180+Ne[0])/360,tt=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+Ne[1]*Math.PI/360)))/360,rt=Math.pow(2,Ge.z);return[Math.round(Qe*rt*8192),Math.round(tt*rt*8192)]}function we(Ne,Ge,Qe){return Ge[1]>Ne[1]!=Qe[1]>Ne[1]&&Ne[0]<(Qe[0]-Ge[0])*(Ne[1]-Ge[1])/(Qe[1]-Ge[1])+Ge[0]}function _e(Ne,Ge){for(var Qe,tt,rt,nt,at,it,ot,dt=!1,ht=0,Dt=Ge.length;ht<Dt;ht++)for(var Ot=Ge[ht],Rt=0,Zt=Ot.length;Rt<Zt-1;Rt++){if((nt=(Qe=Ne)[0]-(tt=Ot[Rt])[0])*(ot=Qe[1]-(rt=Ot[Rt+1])[1])-(it=Qe[0]-rt[0])*(at=Qe[1]-tt[1])==0&&nt*it<=0&&at*ot<=0)return!1;we(Ne,Ot[Rt],Ot[Rt+1])&&(dt=!dt)}return dt}function Ae(Ne,Ge){for(var Qe=0;Qe<Ge.length;Qe++)if(_e(Ne,Ge[Qe]))return!0;return!1}function Se(Ne,Ge,Qe,tt){var rt=tt[0]-Qe[0],nt=tt[1]-Qe[1],at=(Ne[0]-Qe[0])*nt-rt*(Ne[1]-Qe[1]),it=(Ge[0]-Qe[0])*nt-rt*(Ge[1]-Qe[1]);return at>0&&it<0||at<0&&it>0}function ke(Ne,Ge,Qe){for(var tt=0,rt=Qe;tt<rt.length;tt+=1)for(var nt=rt[tt],at=0;at<nt.length-1;++at)if(0!=(Dt=[(ht=nt[at+1])[0]-(dt=nt[at])[0],ht[1]-dt[1]])[0]*(Ot=[(ot=Ge)[0]-(it=Ne)[0],ot[1]-it[1]])[1]-Dt[1]*Ot[0]&&Se(it,ot,dt,ht)&&Se(dt,ht,it,ot))return!0;var it,ot,dt,ht,Dt,Ot;return!1}function Ie(Ne,Ge){for(var Qe=0;Qe<Ne.length;++Qe)if(!_e(Ne[Qe],Ge))return!1;for(var tt=0;tt<Ne.length-1;++tt)if(ke(Ne[tt],Ne[tt+1],Ge))return!1;return!0}function ze(Ne,Ge){for(var Qe=0;Qe<Ge.length;Qe++)if(Ie(Ne,Ge[Qe]))return!0;return!1}function Ce(Ne,Ge,Qe){for(var tt=[],rt=0;rt<Ne.length;rt++){for(var nt=[],at=0;at<Ne[rt].length;at++){var it=be(Ne[rt][at],Qe);ge(Ge,it),nt.push(it)}tt.push(nt)}return tt}function Me(Ne,Ge,Qe){for(var tt=[],rt=0;rt<Ne.length;rt++){var nt=Ce(Ne[rt],Ge,Qe);tt.push(nt)}return tt}function Ee(Ne,Ge,Qe,tt){if(Ne[0]<Qe[0]||Ne[0]>Qe[2]){var rt=.5*tt,nt=Ne[0]-Qe[0]>rt?-tt:Qe[0]-Ne[0]>rt?tt:0;0===nt&&(nt=Ne[0]-Qe[2]>rt?-tt:Qe[2]-Ne[0]>rt?tt:0),Ne[0]+=nt}ge(Ge,Ne)}function Te(Ne,Ge,Qe,tt){for(var rt=8192*Math.pow(2,tt.z),nt=[8192*tt.x,8192*tt.y],at=[],it=0,ot=Ne;it<ot.length;it+=1)for(var dt=0,ht=ot[it];dt<ht.length;dt+=1){var Dt=ht[dt],Ot=[Dt.x+nt[0],Dt.y+nt[1]];Ee(Ot,Ge,Qe,rt),at.push(Ot)}return at}function Pe(Ne,Ge,Qe,tt){for(var rt,nt=8192*Math.pow(2,tt.z),at=[8192*tt.x,8192*tt.y],it=[],ot=0,dt=Ne;ot<dt.length;ot+=1){for(var ht=[],Dt=0,Ot=dt[ot];Dt<Ot.length;Dt+=1){var Rt=Ot[Dt],Zt=[Rt.x+at[0],Rt.y+at[1]];ge(Ge,Zt),ht.push(Zt)}it.push(ht)}if(Ge[2]-Ge[0]<=nt/2){(rt=Ge)[0]=rt[1]=1/0,rt[2]=rt[3]=-1/0;for(var er=0,dr=it;er<dr.length;er+=1)for(var mr=0,xr=dr[er];mr<xr.length;mr+=1)Ee(xr[mr],Ge,Qe,nt)}return it}ve.parse=function(Ne,Ge){if(2!==Ne.length)return Ge.error("Expected one argument.");var Qe=Ne[1];if("object"!=typeof Qe||Array.isArray(Qe))return Ge.error("Collator options argument must be an object.");var tt=Ge.parse(void 0!==Qe["case-sensitive"]&&Qe["case-sensitive"],1,Wa);if(!tt)return null;var rt=Ge.parse(void 0!==Qe["diacritic-sensitive"]&&Qe["diacritic-sensitive"],1,Wa);if(!rt)return null;var nt=null;return Qe.locale&&!(nt=Ge.parse(Qe.locale,1,Va))?null:new ve(tt,rt,nt)},ve.prototype.evaluate=function(Ne){return new Wt(this.caseSensitive.evaluate(Ne),this.diacriticSensitive.evaluate(Ne),this.locale?this.locale.evaluate(Ne):null)},ve.prototype.eachChild=function(Ne){Ne(this.caseSensitive),Ne(this.diacriticSensitive),this.locale&&Ne(this.locale)},ve.prototype.outputDefined=function(){return!1},ve.prototype.serialize=function(){var Ne={};return Ne["case-sensitive"]=this.caseSensitive.serialize(),Ne["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(Ne.locale=this.locale.serialize()),["collator",Ne]};var Be=function(Ne,Ge){this.type=Wa,this.geojson=Ne,this.geometries=Ge};function Ve(Ne){if(Ne instanceof me){if("get"===Ne.name&&1===Ne.args.length)return!1;if("feature-state"===Ne.name)return!1;if("has"===Ne.name&&1===Ne.args.length)return!1;if("properties"===Ne.name||"geometry-type"===Ne.name||"id"===Ne.name)return!1;if(/^filter-/.test(Ne.name))return!1}if(Ne instanceof Be)return!1;var Ge=!0;return Ne.eachChild((function(Ne){Ge&&!Ve(Ne)&&(Ge=!1)})),Ge}function Fe(Ne){if(Ne instanceof me&&"feature-state"===Ne.name)return!1;var Ge=!0;return Ne.eachChild((function(Ne){Ge&&!Fe(Ne)&&(Ge=!1)})),Ge}function De(Ne,Ge){if(Ne instanceof me&&Ge.indexOf(Ne.name)>=0)return!1;var Qe=!0;return Ne.eachChild((function(Ne){Qe&&!De(Ne,Ge)&&(Qe=!1)})),Qe}Be.parse=function(Ne,Ge){if(2!==Ne.length)return Ge.error("'within' expression requires exactly one argument, but found "+(Ne.length-1)+" instead.");if(ne(Ne[1])){var Qe=Ne[1];if("FeatureCollection"===Qe.type)for(var tt=0;tt<Qe.features.length;++tt){var rt=Qe.features[tt].geometry.type;if("Polygon"===rt||"MultiPolygon"===rt)return new Be(Qe,Qe.features[tt].geometry)}else if("Feature"===Qe.type){var nt=Qe.geometry.type;if("Polygon"===nt||"MultiPolygon"===nt)return new Be(Qe,Qe.geometry)}else if("Polygon"===Qe.type||"MultiPolygon"===Qe.type)return new Be(Qe,Qe)}return Ge.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Be.prototype.evaluate=function(Ne){if(null!=Ne.geometry()&&null!=Ne.canonicalID()){if("Point"===Ne.geometryType())return function(Ne,Ge){var Qe=[1/0,1/0,-1/0,-1/0],tt=[1/0,1/0,-1/0,-1/0],rt=Ne.canonicalID();if("Polygon"===Ge.type){var nt=Ce(Ge.coordinates,tt,rt),at=Te(Ne.geometry(),Qe,tt,rt);if(!xe(Qe,tt))return!1;for(var it=0,ot=at;it<ot.length;it+=1)if(!_e(ot[it],nt))return!1}if("MultiPolygon"===Ge.type){var dt=Me(Ge.coordinates,tt,rt),ht=Te(Ne.geometry(),Qe,tt,rt);if(!xe(Qe,tt))return!1;for(var Dt=0,Ot=ht;Dt<Ot.length;Dt+=1)if(!Ae(Ot[Dt],dt))return!1}return!0}(Ne,this.geometries);if("LineString"===Ne.geometryType())return function(Ne,Ge){var Qe=[1/0,1/0,-1/0,-1/0],tt=[1/0,1/0,-1/0,-1/0],rt=Ne.canonicalID();if("Polygon"===Ge.type){var nt=Ce(Ge.coordinates,tt,rt),at=Pe(Ne.geometry(),Qe,tt,rt);if(!xe(Qe,tt))return!1;for(var it=0,ot=at;it<ot.length;it+=1)if(!Ie(ot[it],nt))return!1}if("MultiPolygon"===Ge.type){var dt=Me(Ge.coordinates,tt,rt),ht=Pe(Ne.geometry(),Qe,tt,rt);if(!xe(Qe,tt))return!1;for(var Dt=0,Ot=ht;Dt<Ot.length;Dt+=1)if(!ze(Ot[Dt],dt))return!1}return!0}(Ne,this.geometries)}return!1},Be.prototype.eachChild=function(){},Be.prototype.outputDefined=function(){return!0},Be.prototype.serialize=function(){return["within",this.geojson]};var Le=function(Ne,Ge){this.type=Ge.type,this.name=Ne,this.boundExpression=Ge};Le.parse=function(Ne,Ge){if(2!==Ne.length||"string"!=typeof Ne[1])return Ge.error("'var' expression requires exactly one string literal argument.");var Qe=Ne[1];return Ge.scope.has(Qe)?new Le(Qe,Ge.scope.get(Qe)):Ge.error('Unknown variable "'+Qe+'". Make sure "'+Qe+'" has been bound in an enclosing "let" expression before using it.',1)},Le.prototype.evaluate=function(Ne){return this.boundExpression.evaluate(Ne)},Le.prototype.eachChild=function(){},Le.prototype.outputDefined=function(){return!1},Le.prototype.serialize=function(){return["var",this.name]};var Re=function(Ne,Ge,Qe,tt,rt){void 0===Ge&&(Ge=[]),void 0===tt&&(tt=new Bt),void 0===rt&&(rt=[]),this.registry=Ne,this.path=Ge,this.key=Ge.map((function(Ne){return"["+Ne+"]"})).join(""),this.scope=tt,this.errors=rt,this.expectedType=Qe};function Oe(Ne,Ge){for(var Qe,tt=Ne.length-1,rt=0,nt=tt,at=0;rt<=nt;)if((Qe=Ne[at=Math.floor((rt+nt)/2)])<=Ge){if(at===tt||Ge<Ne[at+1])return at;rt=at+1}else{if(!(Qe>Ge))throw new se("Input is not a number.");nt=at-1}return 0}Re.prototype.parse=function(Ne,Ge,Qe,tt,rt){return void 0===rt&&(rt={}),Ge?this.concat(Ge,Qe,tt)._parse(Ne,rt):this._parse(Ne,rt)},Re.prototype._parse=function(Ne,Ge){function r(Ne,Ge,Qe){return"assert"===Qe?new le(Ge,[Ne]):"coerce"===Qe?new fe(Ge,[Ne]):Ne}if(null!==Ne&&"string"!=typeof Ne&&"boolean"!=typeof Ne&&"number"!=typeof Ne||(Ne=["literal",Ne]),Array.isArray(Ne)){if(0===Ne.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var Qe=Ne[0];if("string"!=typeof Qe)return this.error("Expression name must be a string, but found "+typeof Qe+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var tt=this.registry[Qe];if(tt){var rt=tt.parse(Ne,this);if(!rt)return null;if(this.expectedType){var nt=this.expectedType,at=rt.type;if("string"!==nt.kind&&"number"!==nt.kind&&"boolean"!==nt.kind&&"object"!==nt.kind&&"array"!==nt.kind||"value"!==at.kind)if("color"!==nt.kind&&"formatted"!==nt.kind&&"resolvedImage"!==nt.kind||"value"!==at.kind&&"string"!==at.kind){if(this.checkSubtype(nt,at))return null}else rt=r(rt,nt,Ge.typeAnnotation||"coerce");else rt=r(rt,nt,Ge.typeAnnotation||"assert")}if(!(rt instanceof oe)&&"resolvedImage"!==rt.type.kind&&function t(Ne){if(Ne instanceof Le)return t(Ne.boundExpression);if(Ne instanceof me&&"error"===Ne.name)return!1;if(Ne instanceof ve)return!1;if(Ne instanceof Be)return!1;var Ge=Ne instanceof fe||Ne instanceof le,Qe=!0;return Ne.eachChild((function(Ne){Qe=Ge?Qe&&t(Ne):Qe&&Ne instanceof oe})),!!Qe&&Ve(Ne)&&De(Ne,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(rt)){var it=new de;try{rt=new oe(rt.type,rt.evaluate(it))}catch(Ne){return this.error(Ne.message),null}}return rt}return this.error('Unknown expression "'+Qe+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(void 0===Ne?"'undefined' value invalid. Use null instead.":"object"==typeof Ne?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof Ne+" instead.")},Re.prototype.concat=function(Ne,Ge,Qe){var tt="number"==typeof Ne?this.path.concat(Ne):this.path,rt=Qe?this.scope.concat(Qe):this.scope;return new Re(this.registry,tt,Ge||null,rt,this.errors)},Re.prototype.error=function(Ne){for(var Ge=[],Qe=arguments.length-1;Qe-- >0;)Ge[Qe]=arguments[Qe+1];var tt=""+this.key+Ge.map((function(Ne){return"["+Ne+"]"})).join("");this.errors.push(new ga(tt,Ne))},Re.prototype.checkSubtype=function(Ne,Ge){var Qe=Xt(Ne,Ge);return Qe&&this.error(Qe),Qe};var Ue=function(Ne,Ge,Qe){this.type=Ne,this.input=Ge,this.labels=[],this.outputs=[];for(var tt=0,rt=Qe;tt<rt.length;tt+=1){var nt=rt[tt],at=nt[1];this.labels.push(nt[0]),this.outputs.push(at)}};function je(Ne,Ge,Qe){return Ne*(1-Qe)+Ge*Qe}Ue.parse=function(Ne,Ge){if(Ne.length-1<4)return Ge.error("Expected at least 4 arguments, but found only "+(Ne.length-1)+".");if((Ne.length-1)%2!=0)return Ge.error("Expected an even number of arguments.");var Qe=Ge.parse(Ne[1],1,_a);if(!Qe)return null;var tt=[],rt=null;Ge.expectedType&&"value"!==Ge.expectedType.kind&&(rt=Ge.expectedType);for(var nt=1;nt<Ne.length;nt+=2){var at=1===nt?-1/0:Ne[nt],it=Ne[nt+1],ot=nt,dt=nt+1;if("number"!=typeof at)return Ge.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ot);if(tt.length&&tt[tt.length-1][0]>=at)return Ge.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',ot);var ht=Ge.parse(it,dt,rt);if(!ht)return null;rt=rt||ht.type,tt.push([at,ht])}return new Ue(rt,Qe,tt)},Ue.prototype.evaluate=function(Ne){var Ge=this.labels,Qe=this.outputs;if(1===Ge.length)return Qe[0].evaluate(Ne);var tt=this.input.evaluate(Ne);if(tt<=Ge[0])return Qe[0].evaluate(Ne);var rt=Ge.length;return tt>=Ge[rt-1]?Qe[rt-1].evaluate(Ne):Qe[Oe(Ge,tt)].evaluate(Ne)},Ue.prototype.eachChild=function(Ne){Ne(this.input);for(var Ge=0,Qe=this.outputs;Ge<Qe.length;Ge+=1)Ne(Qe[Ge])},Ue.prototype.outputDefined=function(){return this.outputs.every((function(Ne){return Ne.outputDefined()}))},Ue.prototype.serialize=function(){for(var Ne=["step",this.input.serialize()],Ge=0;Ge<this.labels.length;Ge++)Ge>0&&Ne.push(this.labels[Ge]),Ne.push(this.outputs[Ge].serialize());return Ne};var is=Object.freeze({__proto__:null,number:je,color:function(Ne,Ge,Qe){return new $t(je(Ne.r,Ge.r,Qe),je(Ne.g,Ge.g,Qe),je(Ne.b,Ge.b,Qe),je(Ne.a,Ge.a,Qe))},array:function(Ne,Ge,Qe){return Ne.map((function(Ne,tt){return je(Ne,Ge[tt],Qe)}))}}),os=6/29*3*(6/29),ss=Math.PI/180,cs=180/Math.PI;function Ze(Ne){return Ne>.008856451679035631?Math.pow(Ne,1/3):Ne/os+4/29}function Xe(Ne){return Ne>6/29?Ne*Ne*Ne:os*(Ne-4/29)}function Je(Ne){return 255*(Ne<=.0031308?12.92*Ne:1.055*Math.pow(Ne,1/2.4)-.055)}function He(Ne){return(Ne/=255)<=.04045?Ne/12.92:Math.pow((Ne+.055)/1.055,2.4)}function Ye(Ne){var Ge=He(Ne.r),Qe=He(Ne.g),tt=He(Ne.b),rt=Ze((.4124564*Ge+.3575761*Qe+.1804375*tt)/.95047),nt=Ze((.2126729*Ge+.7151522*Qe+.072175*tt)/1);return{l:116*nt-16,a:500*(rt-nt),b:200*(nt-Ze((.0193339*Ge+.119192*Qe+.9503041*tt)/1.08883)),alpha:Ne.a}}function $e(Ne){var Ge=(Ne.l+16)/116,Qe=isNaN(Ne.a)?Ge:Ge+Ne.a/500,tt=isNaN(Ne.b)?Ge:Ge-Ne.b/200;return Ge=1*Xe(Ge),Qe=.95047*Xe(Qe),tt=1.08883*Xe(tt),new $t(Je(3.2404542*Qe-1.5371385*Ge-.4985314*tt),Je(-.969266*Qe+1.8760108*Ge+.041556*tt),Je(.0556434*Qe-.2040259*Ge+1.0572252*tt),Ne.alpha)}function We(Ne,Ge,Qe){var tt=Ge-Ne;return Ne+Qe*(tt>180||tt<-180?tt-360*Math.round(tt/360):tt)}var ds={forward:Ye,reverse:$e,interpolate:function(Ne,Ge,Qe){return{l:je(Ne.l,Ge.l,Qe),a:je(Ne.a,Ge.a,Qe),b:je(Ne.b,Ge.b,Qe),alpha:je(Ne.alpha,Ge.alpha,Qe)}}},ms={forward:function(Ne){var Ge=Ye(Ne),Qe=Ge.l,tt=Ge.a,rt=Ge.b,nt=Math.atan2(rt,tt)*cs;return{h:nt<0?nt+360:nt,c:Math.sqrt(tt*tt+rt*rt),l:Qe,alpha:Ne.a}},reverse:function(Ne){var Ge=Ne.h*ss,Qe=Ne.c;return $e({l:Ne.l,a:Math.cos(Ge)*Qe,b:Math.sin(Ge)*Qe,alpha:Ne.alpha})},interpolate:function(Ne,Ge,Qe){return{h:We(Ne.h,Ge.h,Qe),c:je(Ne.c,Ge.c,Qe),l:je(Ne.l,Ge.l,Qe),alpha:je(Ne.alpha,Ge.alpha,Qe)}}},vs=Object.freeze({__proto__:null,lab:ds,hcl:ms}),rr=function(Ne,Ge,Qe,tt,rt){this.type=Ne,this.operator=Ge,this.interpolation=Qe,this.input=tt,this.labels=[],this.outputs=[];for(var nt=0,at=rt;nt<at.length;nt+=1){var it=at[nt],ot=it[1];this.labels.push(it[0]),this.outputs.push(ot)}};function nr(Ne,Ge,Qe,tt){var rt=tt-Qe,nt=Ne-Qe;return 0===rt?0:1===Ge?nt/rt:(Math.pow(Ge,nt)-1)/(Math.pow(Ge,rt)-1)}rr.interpolationFactor=function(Ne,Qe,tt,rt){var nt=0;if("exponential"===Ne.name)nt=nr(Qe,Ne.base,tt,rt);else if("linear"===Ne.name)nt=nr(Qe,1,tt,rt);else if("cubic-bezier"===Ne.name){var at=Ne.controlPoints;nt=new Ge(at[0],at[1],at[2],at[3]).solve(nr(Qe,1,tt,rt))}return nt},rr.parse=function(Ne,Ge){var Qe=Ne[0],tt=Ne[1],rt=Ne[2],nt=Ne.slice(3);if(!Array.isArray(tt)||0===tt.length)return Ge.error("Expected an interpolation type expression.",1);if("linear"===tt[0])tt={name:"linear"};else if("exponential"===tt[0]){var at=tt[1];if("number"!=typeof at)return Ge.error("Exponential interpolation requires a numeric base.",1,1);tt={name:"exponential",base:at}}else{if("cubic-bezier"!==tt[0])return Ge.error("Unknown interpolation type "+String(tt[0]),1,0);var it=tt.slice(1);if(4!==it.length||it.some((function(Ne){return"number"!=typeof Ne||Ne<0||Ne>1})))return Ge.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);tt={name:"cubic-bezier",controlPoints:it}}if(Ne.length-1<4)return Ge.error("Expected at least 4 arguments, but found only "+(Ne.length-1)+".");if((Ne.length-1)%2!=0)return Ge.error("Expected an even number of arguments.");if(!(rt=Ge.parse(rt,2,_a)))return null;var ot=[],dt=null;"interpolate-hcl"===Qe||"interpolate-lab"===Qe?dt=Qa:Ge.expectedType&&"value"!==Ge.expectedType.kind&&(dt=Ge.expectedType);for(var ht=0;ht<nt.length;ht+=2){var Dt=nt[ht],Ot=nt[ht+1],Rt=ht+3,Zt=ht+4;if("number"!=typeof Dt)return Ge.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',Rt);if(ot.length&&ot[ot.length-1][0]>=Dt)return Ge.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',Rt);var er=Ge.parse(Ot,Zt,dt);if(!er)return null;dt=dt||er.type,ot.push([Dt,er])}return"number"===dt.kind||"color"===dt.kind||"array"===dt.kind&&"number"===dt.itemType.kind&&"number"==typeof dt.N?new rr(dt,Qe,tt,rt,ot):Ge.error("Type "+Gt(dt)+" is not interpolatable.")},rr.prototype.evaluate=function(Ne){var Ge=this.labels,Qe=this.outputs;if(1===Ge.length)return Qe[0].evaluate(Ne);var tt=this.input.evaluate(Ne);if(tt<=Ge[0])return Qe[0].evaluate(Ne);var rt=Ge.length;if(tt>=Ge[rt-1])return Qe[rt-1].evaluate(Ne);var nt=Oe(Ge,tt),at=rr.interpolationFactor(this.interpolation,tt,Ge[nt],Ge[nt+1]),it=Qe[nt].evaluate(Ne),ot=Qe[nt+1].evaluate(Ne);return"interpolate"===this.operator?is[this.type.kind.toLowerCase()](it,ot,at):"interpolate-hcl"===this.operator?ms.reverse(ms.interpolate(ms.forward(it),ms.forward(ot),at)):ds.reverse(ds.interpolate(ds.forward(it),ds.forward(ot),at))},rr.prototype.eachChild=function(Ne){Ne(this.input);for(var Ge=0,Qe=this.outputs;Ge<Qe.length;Ge+=1)Ne(Qe[Ge])},rr.prototype.outputDefined=function(){return this.outputs.every((function(Ne){return Ne.outputDefined()}))},rr.prototype.serialize=function(){var Ne;Ne="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var Ge=[this.operator,Ne,this.input.serialize()],Qe=0;Qe<this.labels.length;Qe++)Ge.push(this.labels[Qe],this.outputs[Qe].serialize());return Ge};var ir=function(Ne,Ge){this.type=Ne,this.args=Ge};ir.parse=function(Ne,Ge){if(Ne.length<2)return Ge.error("Expectected at least one argument.");var Qe=null,tt=Ge.expectedType;tt&&"value"!==tt.kind&&(Qe=tt);for(var rt=[],nt=0,at=Ne.slice(1);nt<at.length;nt+=1){var it=Ge.parse(at[nt],1+rt.length,Qe,void 0,{typeAnnotation:"omit"});if(!it)return null;Qe=Qe||it.type,rt.push(it)}var ot=tt&&rt.some((function(Ne){return Xt(tt,Ne.type)}));return new ir(ot?ni:Qe,rt)},ir.prototype.evaluate=function(Ne){for(var Ge,Qe=null,tt=0,rt=0,nt=this.args;rt<nt.length&&(tt++,(Qe=nt[rt].evaluate(Ne))&&Qe instanceof ee&&!Qe.available&&(Ge||(Ge=Qe.name),Qe=null,tt===this.args.length&&(Qe=Ge)),null===Qe);rt+=1);return Qe},ir.prototype.eachChild=function(Ne){this.args.forEach(Ne)},ir.prototype.outputDefined=function(){return this.args.every((function(Ne){return Ne.outputDefined()}))},ir.prototype.serialize=function(){var Ne=["coalesce"];return this.eachChild((function(Ge){Ne.push(Ge.serialize())})),Ne};var ar=function(Ne,Ge){this.type=Ge.type,this.bindings=[].concat(Ne),this.result=Ge};ar.prototype.evaluate=function(Ne){return this.result.evaluate(Ne)},ar.prototype.eachChild=function(Ne){for(var Ge=0,Qe=this.bindings;Ge<Qe.length;Ge+=1)Ne(Qe[Ge][1]);Ne(this.result)},ar.parse=function(Ne,Ge){if(Ne.length<4)return Ge.error("Expected at least 3 arguments, but found "+(Ne.length-1)+" instead.");for(var Qe=[],tt=1;tt<Ne.length-1;tt+=2){var rt=Ne[tt];if("string"!=typeof rt)return Ge.error("Expected string, but found "+typeof rt+" instead.",tt);if(/[^a-zA-Z0-9_]/.test(rt))return Ge.error("Variable names must contain only alphanumeric characters or '_'.",tt);var nt=Ge.parse(Ne[tt+1],tt+1);if(!nt)return null;Qe.push([rt,nt])}var at=Ge.parse(Ne[Ne.length-1],Ne.length-1,Ge.expectedType,Qe);return at?new ar(Qe,at):null},ar.prototype.outputDefined=function(){return this.result.outputDefined()},ar.prototype.serialize=function(){for(var Ne=["let"],Ge=0,Qe=this.bindings;Ge<Qe.length;Ge+=1){var tt=Qe[Ge];Ne.push(tt[0],tt[1].serialize())}return Ne.push(this.result.serialize()),Ne};var or=function(Ne,Ge,Qe){this.type=Ne,this.index=Ge,this.input=Qe};or.parse=function(Ne,Ge){if(3!==Ne.length)return Ge.error("Expected 2 arguments, but found "+(Ne.length-1)+" instead.");var Qe=Ge.parse(Ne[1],1,_a),tt=Ge.parse(Ne[2],2,Kt(Ge.expectedType||ni));return Qe&&tt?new or(tt.type.itemType,Qe,tt):null},or.prototype.evaluate=function(Ne){var Ge=this.index.evaluate(Ne),Qe=this.input.evaluate(Ne);if(Ge<0)throw new se("Array index out of bounds: "+Ge+" < 0.");if(Ge>=Qe.length)throw new se("Array index out of bounds: "+Ge+" > "+(Qe.length-1)+".");if(Ge!==Math.floor(Ge))throw new se("Array index must be an integer, but found "+Ge+" instead.");return Qe[Ge]},or.prototype.eachChild=function(Ne){Ne(this.index),Ne(this.input)},or.prototype.outputDefined=function(){return!1},or.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var sr=function(Ne,Ge){this.type=Wa,this.needle=Ne,this.haystack=Ge};sr.parse=function(Ne,Ge){if(3!==Ne.length)return Ge.error("Expected 2 arguments, but found "+(Ne.length-1)+" instead.");var Qe=Ge.parse(Ne[1],1,ni),tt=Ge.parse(Ne[2],2,ni);return Qe&&tt?Jt(Qe.type,[Wa,Va,_a,ma,ni])?new sr(Qe,tt):Ge.error("Expected first argument to be of type boolean, string, number or null, but found "+Gt(Qe.type)+" instead"):null},sr.prototype.evaluate=function(Ne){var Ge=this.needle.evaluate(Ne),Qe=this.haystack.evaluate(Ne);if(!Qe)return!1;if(!Ht(Ge,["boolean","string","number","null"]))throw new se("Expected first argument to be of type boolean, string, number or null, but found "+Gt(ie(Ge))+" instead.");if(!Ht(Qe,["string","array"]))throw new se("Expected second argument to be of type array or string, but found "+Gt(ie(Qe))+" instead.");return Qe.indexOf(Ge)>=0},sr.prototype.eachChild=function(Ne){Ne(this.needle),Ne(this.haystack)},sr.prototype.outputDefined=function(){return!0},sr.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var ur=function(Ne,Ge,Qe){this.type=_a,this.needle=Ne,this.haystack=Ge,this.fromIndex=Qe};ur.parse=function(Ne,Ge){if(Ne.length<=2||Ne.length>=5)return Ge.error("Expected 3 or 4 arguments, but found "+(Ne.length-1)+" instead.");var Qe=Ge.parse(Ne[1],1,ni),tt=Ge.parse(Ne[2],2,ni);if(!Qe||!tt)return null;if(!Jt(Qe.type,[Wa,Va,_a,ma,ni]))return Ge.error("Expected first argument to be of type boolean, string, number or null, but found "+Gt(Qe.type)+" instead");if(4===Ne.length){var rt=Ge.parse(Ne[3],3,_a);return rt?new ur(Qe,tt,rt):null}return new ur(Qe,tt)},ur.prototype.evaluate=function(Ne){var Ge=this.needle.evaluate(Ne),Qe=this.haystack.evaluate(Ne);if(!Ht(Ge,["boolean","string","number","null"]))throw new se("Expected first argument to be of type boolean, string, number or null, but found "+Gt(ie(Ge))+" instead.");if(!Ht(Qe,["string","array"]))throw new se("Expected second argument to be of type array or string, but found "+Gt(ie(Qe))+" instead.");if(this.fromIndex){var tt=this.fromIndex.evaluate(Ne);return Qe.indexOf(Ge,tt)}return Qe.indexOf(Ge)},ur.prototype.eachChild=function(Ne){Ne(this.needle),Ne(this.haystack),this.fromIndex&&Ne(this.fromIndex)},ur.prototype.outputDefined=function(){return!1},ur.prototype.serialize=function(){if(null!=this.fromIndex&&void 0!==this.fromIndex){var Ne=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),Ne]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var lr=function(Ne,Ge,Qe,tt,rt,nt){this.inputType=Ne,this.type=Ge,this.input=Qe,this.cases=tt,this.outputs=rt,this.otherwise=nt};lr.parse=function(Ne,Ge){if(Ne.length<5)return Ge.error("Expected at least 4 arguments, but found only "+(Ne.length-1)+".");if(Ne.length%2!=1)return Ge.error("Expected an even number of arguments.");var Qe,tt;Ge.expectedType&&"value"!==Ge.expectedType.kind&&(tt=Ge.expectedType);for(var rt={},nt=[],at=2;at<Ne.length-1;at+=2){var it=Ne[at],ot=Ne[at+1];Array.isArray(it)||(it=[it]);var dt=Ge.concat(at);if(0===it.length)return dt.error("Expected at least one branch label.");for(var ht=0,Dt=it;ht<Dt.length;ht+=1){var Ot=Dt[ht];if("number"!=typeof Ot&&"string"!=typeof Ot)return dt.error("Branch labels must be numbers or strings.");if("number"==typeof Ot&&Math.abs(Ot)>Number.MAX_SAFE_INTEGER)return dt.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if("number"==typeof Ot&&Math.floor(Ot)!==Ot)return dt.error("Numeric branch labels must be integer values.");if(Qe){if(dt.checkSubtype(Qe,ie(Ot)))return null}else Qe=ie(Ot);if(void 0!==rt[String(Ot)])return dt.error("Branch labels must be unique.");rt[String(Ot)]=nt.length}var Rt=Ge.parse(ot,at,tt);if(!Rt)return null;tt=tt||Rt.type,nt.push(Rt)}var Zt=Ge.parse(Ne[1],1,ni);if(!Zt)return null;var er=Ge.parse(Ne[Ne.length-1],Ne.length-1,tt);return er?"value"!==Zt.type.kind&&Ge.concat(1).checkSubtype(Qe,Zt.type)?null:new lr(Qe,tt,Zt,rt,nt,er):null},lr.prototype.evaluate=function(Ne){var Ge=this.input.evaluate(Ne);return(ie(Ge)===this.inputType&&this.outputs[this.cases[Ge]]||this.otherwise).evaluate(Ne)},lr.prototype.eachChild=function(Ne){Ne(this.input),this.outputs.forEach(Ne),Ne(this.otherwise)},lr.prototype.outputDefined=function(){return this.outputs.every((function(Ne){return Ne.outputDefined()}))&&this.otherwise.outputDefined()},lr.prototype.serialize=function(){for(var Ne=this,Ge=["match",this.input.serialize()],Qe=[],tt={},rt=0,nt=Object.keys(this.cases).sort();rt<nt.length;rt+=1){var at=nt[rt];void 0===(ht=tt[this.cases[at]])?(tt[this.cases[at]]=Qe.length,Qe.push([this.cases[at],[at]])):Qe[ht][1].push(at)}for(var s=function(Ge){return"number"===Ne.inputType.kind?Number(Ge):Ge},it=0,ot=Qe;it<ot.length;it+=1){var dt=ot[it],ht=dt[0],Dt=dt[1];Ge.push(1===Dt.length?s(Dt[0]):Dt.map(s)),Ge.push(this.outputs[outputIndex$1].serialize())}return Ge.push(this.otherwise.serialize()),Ge};var pr=function(Ne,Ge,Qe){this.type=Ne,this.branches=Ge,this.otherwise=Qe};pr.parse=function(Ne,Ge){if(Ne.length<4)return Ge.error("Expected at least 3 arguments, but found only "+(Ne.length-1)+".");if(Ne.length%2!=0)return Ge.error("Expected an odd number of arguments.");var Qe;Ge.expectedType&&"value"!==Ge.expectedType.kind&&(Qe=Ge.expectedType);for(var tt=[],rt=1;rt<Ne.length-1;rt+=2){var nt=Ge.parse(Ne[rt],rt,Wa);if(!nt)return null;var at=Ge.parse(Ne[rt+1],rt+1,Qe);if(!at)return null;tt.push([nt,at]),Qe=Qe||at.type}var it=Ge.parse(Ne[Ne.length-1],Ne.length-1,Qe);return it?new pr(Qe,tt,it):null},pr.prototype.evaluate=function(Ne){for(var Ge=0,Qe=this.branches;Ge<Qe.length;Ge+=1){var tt=Qe[Ge],rt=tt[1];if(tt[0].evaluate(Ne))return rt.evaluate(Ne)}return this.otherwise.evaluate(Ne)},pr.prototype.eachChild=function(Ne){for(var Ge=0,Qe=this.branches;Ge<Qe.length;Ge+=1){var tt=Qe[Ge],rt=tt[1];Ne(tt[0]),Ne(rt)}Ne(this.otherwise)},pr.prototype.outputDefined=function(){return this.branches.every((function(Ne){return Ne[1].outputDefined()}))&&this.otherwise.outputDefined()},pr.prototype.serialize=function(){var Ne=["case"];return this.eachChild((function(Ge){Ne.push(Ge.serialize())})),Ne};var cr=function(Ne,Ge,Qe,tt){this.type=Ne,this.input=Ge,this.beginIndex=Qe,this.endIndex=tt};function hr(Ne,Ge){return"=="===Ne||"!="===Ne?"boolean"===Ge.kind||"string"===Ge.kind||"number"===Ge.kind||"null"===Ge.kind||"value"===Ge.kind:"string"===Ge.kind||"number"===Ge.kind||"value"===Ge.kind}function fr(Ne,Ge,Qe,tt){return 0===tt.compare(Ge,Qe)}function yr(Ne,Ge,Qe){var tt="=="!==Ne&&"!="!==Ne;return function(){function i(Ne,Ge,Qe){this.type=Wa,this.lhs=Ne,this.rhs=Ge,this.collator=Qe,this.hasUntypedArgument="value"===Ne.type.kind||"value"===Ge.type.kind}return i.parse=function(Ne,Ge){if(3!==Ne.length&&4!==Ne.length)return Ge.error("Expected two or three arguments.");var Qe=Ne[0],rt=Ge.parse(Ne[1],1,ni);if(!rt)return null;if(!hr(Qe,rt.type))return Ge.concat(1).error('"'+Qe+"\" comparisons are not supported for type '"+Gt(rt.type)+"'.");var nt=Ge.parse(Ne[2],2,ni);if(!nt)return null;if(!hr(Qe,nt.type))return Ge.concat(2).error('"'+Qe+"\" comparisons are not supported for type '"+Gt(nt.type)+"'.");if(rt.type.kind!==nt.type.kind&&"value"!==rt.type.kind&&"value"!==nt.type.kind)return Ge.error("Cannot compare types '"+Gt(rt.type)+"' and '"+Gt(nt.type)+"'.");tt&&("value"===rt.type.kind&&"value"!==nt.type.kind?rt=new le(nt.type,[rt]):"value"!==rt.type.kind&&"value"===nt.type.kind&&(nt=new le(rt.type,[nt])));var at=null;if(4===Ne.length){if("string"!==rt.type.kind&&"string"!==nt.type.kind&&"value"!==rt.type.kind&&"value"!==nt.type.kind)return Ge.error("Cannot use collator to compare non-string types.");if(!(at=Ge.parse(Ne[3],3,di)))return null}return new i(rt,nt,at)},i.prototype.evaluate=function(rt){var nt=this.lhs.evaluate(rt),at=this.rhs.evaluate(rt);if(tt&&this.hasUntypedArgument){var it=ie(nt),ot=ie(at);if(it.kind!==ot.kind||"string"!==it.kind&&"number"!==it.kind)throw new se('Expected arguments for "'+Ne+'" to be (string, string) or (number, number), but found ('+it.kind+", "+ot.kind+") instead.")}if(this.collator&&!tt&&this.hasUntypedArgument){var dt=ie(nt),ht=ie(at);if("string"!==dt.kind||"string"!==ht.kind)return Ge(rt,nt,at)}return this.collator?Qe(rt,nt,at,this.collator.evaluate(rt)):Ge(rt,nt,at)},i.prototype.eachChild=function(Ne){Ne(this.lhs),Ne(this.rhs),this.collator&&Ne(this.collator)},i.prototype.outputDefined=function(){return!0},i.prototype.serialize=function(){var Ge=[Ne];return this.eachChild((function(Ne){Ge.push(Ne.serialize())})),Ge},i}()}cr.parse=function(Ne,Ge){if(Ne.length<=2||Ne.length>=5)return Ge.error("Expected 3 or 4 arguments, but found "+(Ne.length-1)+" instead.");var Qe=Ge.parse(Ne[1],1,ni),tt=Ge.parse(Ne[2],2,_a);if(!Qe||!tt)return null;if(!Jt(Qe.type,[Kt(ni),Va,ni]))return Ge.error("Expected first argument to be of type array or string, but found "+Gt(Qe.type)+" instead");if(4===Ne.length){var rt=Ge.parse(Ne[3],3,_a);return rt?new cr(Qe.type,Qe,tt,rt):null}return new cr(Qe.type,Qe,tt)},cr.prototype.evaluate=function(Ne){var Ge=this.input.evaluate(Ne),Qe=this.beginIndex.evaluate(Ne);if(!Ht(Ge,["string","array"]))throw new se("Expected first argument to be of type array or string, but found "+Gt(ie(Ge))+" instead.");if(this.endIndex){var tt=this.endIndex.evaluate(Ne);return Ge.slice(Qe,tt)}return Ge.slice(Qe)},cr.prototype.eachChild=function(Ne){Ne(this.input),Ne(this.beginIndex),this.endIndex&&Ne(this.endIndex)},cr.prototype.outputDefined=function(){return!1},cr.prototype.serialize=function(){if(null!=this.endIndex&&void 0!==this.endIndex){var Ne=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),Ne]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var _s=yr("==",(function(Ne,Ge,Qe){return Ge===Qe}),fr),ws=yr("!=",(function(Ne,Ge,Qe){return Ge!==Qe}),(function(Ne,Ge,Qe,tt){return!fr(0,Ge,Qe,tt)})),Ts=yr("<",(function(Ne,Ge,Qe){return Ge<Qe}),(function(Ne,Ge,Qe,tt){return tt.compare(Ge,Qe)<0})),ks=yr(">",(function(Ne,Ge,Qe){return Ge>Qe}),(function(Ne,Ge,Qe,tt){return tt.compare(Ge,Qe)>0})),Cs=yr("<=",(function(Ne,Ge,Qe){return Ge<=Qe}),(function(Ne,Ge,Qe,tt){return tt.compare(Ge,Qe)<=0})),Es=yr(">=",(function(Ne,Ge,Qe){return Ge>=Qe}),(function(Ne,Ge,Qe,tt){return tt.compare(Ge,Qe)>=0})),wr=function(Ne,Ge,Qe,tt,rt){this.type=Va,this.number=Ne,this.locale=Ge,this.currency=Qe,this.minFractionDigits=tt,this.maxFractionDigits=rt};wr.parse=function(Ne,Ge){if(3!==Ne.length)return Ge.error("Expected two arguments.");var Qe=Ge.parse(Ne[1],1,_a);if(!Qe)return null;var tt=Ne[2];if("object"!=typeof tt||Array.isArray(tt))return Ge.error("NumberFormat options argument must be an object.");var rt=null;if(tt.locale&&!(rt=Ge.parse(tt.locale,1,Va)))return null;var nt=null;if(tt.currency&&!(nt=Ge.parse(tt.currency,1,Va)))return null;var at=null;if(tt["min-fraction-digits"]&&!(at=Ge.parse(tt["min-fraction-digits"],1,_a)))return null;var it=null;return tt["max-fraction-digits"]&&!(it=Ge.parse(tt["max-fraction-digits"],1,_a))?null:new wr(Qe,rt,nt,at,it)},wr.prototype.evaluate=function(Ne){return new Intl.NumberFormat(this.locale?this.locale.evaluate(Ne):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(Ne):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(Ne):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(Ne):void 0}).format(this.number.evaluate(Ne))},wr.prototype.eachChild=function(Ne){Ne(this.number),this.locale&&Ne(this.locale),this.currency&&Ne(this.currency),this.minFractionDigits&&Ne(this.minFractionDigits),this.maxFractionDigits&&Ne(this.maxFractionDigits)},wr.prototype.outputDefined=function(){return!1},wr.prototype.serialize=function(){var Ne={};return this.locale&&(Ne.locale=this.locale.serialize()),this.currency&&(Ne.currency=this.currency.serialize()),this.minFractionDigits&&(Ne["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(Ne["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),Ne]};var _r=function(Ne){this.type=_a,this.input=Ne};_r.parse=function(Ne,Ge){if(2!==Ne.length)return Ge.error("Expected 1 argument, but found "+(Ne.length-1)+" instead.");var Qe=Ge.parse(Ne[1],1);return Qe?"array"!==Qe.type.kind&&"string"!==Qe.type.kind&&"value"!==Qe.type.kind?Ge.error("Expected argument of type string or array, but found "+Gt(Qe.type)+" instead."):new _r(Qe):null},_r.prototype.evaluate=function(Ne){var Ge=this.input.evaluate(Ne);if("string"==typeof Ge)return Ge.length;if(Array.isArray(Ge))return Ge.length;throw new se("Expected value to be of type string or array, but found "+Gt(ie(Ge))+" instead.")},_r.prototype.eachChild=function(Ne){Ne(this.input)},_r.prototype.outputDefined=function(){return!1},_r.prototype.serialize=function(){var Ne=["length"];return this.eachChild((function(Ge){Ne.push(Ge.serialize())})),Ne};var Ls={"==":_s,"!=":ws,">":ks,"<":Ts,">=":Es,"<=":Cs,array:le,at:or,boolean:le,case:pr,coalesce:ir,collator:ve,format:pe,image:ce,in:sr,"index-of":ur,interpolate:rr,"interpolate-hcl":rr,"interpolate-lab":rr,length:_r,let:ar,literal:oe,match:lr,number:le,"number-format":wr,object:le,slice:cr,step:Ue,string:le,"to-boolean":fe,"to-color":fe,"to-number":fe,"to-string":fe,var:Le,within:Be};function Sr(Ne,Ge){var Qe=Ge[0],tt=Ge[1],rt=Ge[2],nt=Ge[3];Qe=Qe.evaluate(Ne),tt=tt.evaluate(Ne),rt=rt.evaluate(Ne);var at=nt?nt.evaluate(Ne):1,it=re(Qe,tt,rt,at);if(it)throw new se(it);return new $t(Qe/255*at,tt/255*at,rt/255*at,at)}function kr(Ne,Ge){return Ne in Ge}function Ir(Ne,Ge){var Qe=Ge[Ne];return void 0===Qe?null:Qe}function zr(Ne){return{type:Ne}}function Cr(Ne){return{result:"success",value:Ne}}function Mr(Ne){return{result:"error",value:Ne}}function Er(Ne){return"data-driven"===Ne["property-type"]||"cross-faded-data-driven"===Ne["property-type"]}function Tr(Ne){return!!Ne.expression&&Ne.expression.parameters.indexOf("zoom")>-1}function Pr(Ne){return!!Ne.expression&&Ne.expression.interpolated}function Br(Ne){return Ne instanceof Number?"number":Ne instanceof String?"string":Ne instanceof Boolean?"boolean":Array.isArray(Ne)?"array":null===Ne?"null":typeof Ne}function Vr(Ne){return"object"==typeof Ne&&null!==Ne&&!Array.isArray(Ne)}function Fr(Ne){return Ne}function Dr(Ne,Ge,Qe){return void 0!==Ne?Ne:void 0!==Ge?Ge:void 0!==Qe?Qe:void 0}function Lr(Ne,Ge,Qe,tt,rt){return Dr(typeof Qe===rt?tt[Qe]:void 0,Ne.default,Ge.default)}function Rr(Ne,Ge,Qe){if("number"!==Br(Qe))return Dr(Ne.default,Ge.default);var tt=Ne.stops.length;if(1===tt)return Ne.stops[0][1];if(Qe<=Ne.stops[0][0])return Ne.stops[0][1];if(Qe>=Ne.stops[tt-1][0])return Ne.stops[tt-1][1];var rt=Oe(Ne.stops.map((function(Ne){return Ne[0]})),Qe);return Ne.stops[rt][1]}function Or(Ne,Ge,Qe){var tt=void 0!==Ne.base?Ne.base:1;if("number"!==Br(Qe))return Dr(Ne.default,Ge.default);var rt=Ne.stops.length;if(1===rt)return Ne.stops[0][1];if(Qe<=Ne.stops[0][0])return Ne.stops[0][1];if(Qe>=Ne.stops[rt-1][0])return Ne.stops[rt-1][1];var nt=Oe(Ne.stops.map((function(Ne){return Ne[0]})),Qe),at=function(Ne,Ge,Qe,tt){var rt=tt-Qe,nt=Ne-Qe;return 0===rt?0:1===Ge?nt/rt:(Math.pow(Ge,nt)-1)/(Math.pow(Ge,rt)-1)}(Qe,tt,Ne.stops[nt][0],Ne.stops[nt+1][0]),it=Ne.stops[nt][1],ot=Ne.stops[nt+1][1],dt=is[Ge.type]||Fr;if(Ne.colorSpace&&"rgb"!==Ne.colorSpace){var ht=vs[Ne.colorSpace];dt=function(Ne,Ge){return ht.reverse(ht.interpolate(ht.forward(Ne),ht.forward(Ge),at))}}return"function"==typeof it.evaluate?{evaluate:function(){for(var Ne=[],Ge=arguments.length;Ge--;)Ne[Ge]=arguments[Ge];var Qe=it.evaluate.apply(void 0,Ne),tt=ot.evaluate.apply(void 0,Ne);if(void 0!==Qe&&void 0!==tt)return dt(Qe,tt,at)}}:dt(it,ot,at)}function Ur(Ne,Ge,Qe){return"color"===Ge.type?Qe=$t.parse(Qe):"formatted"===Ge.type?Qe=te.fromString(Qe.toString()):"resolvedImage"===Ge.type?Qe=ee.fromString(Qe.toString()):Br(Qe)===Ge.type||"enum"===Ge.type&&Ge.values[Qe]||(Qe=void 0),Dr(Qe,Ne.default,Ge.default)}me.register(Ls,{error:[{kind:"error"},[Va],function(Ne,Ge){throw new se(Ge[0].evaluate(Ne))}],typeof:[Va,[ni],function(Ne,Ge){return Gt(ie(Ge[0].evaluate(Ne)))}],"to-rgba":[Kt(_a,4),[Qa],function(Ne,Ge){return Ge[0].evaluate(Ne).toArray()}],rgb:[Qa,[_a,_a,_a],Sr],rgba:[Qa,[_a,_a,_a,_a],Sr],has:{type:Wa,overloads:[[[Va],function(Ne,Ge){return kr(Ge[0].evaluate(Ne),Ne.properties())}],[[Va,ti],function(Ne,Ge){var Qe=Ge[1];return kr(Ge[0].evaluate(Ne),Qe.evaluate(Ne))}]]},get:{type:ni,overloads:[[[Va],function(Ne,Ge){return Ir(Ge[0].evaluate(Ne),Ne.properties())}],[[Va,ti],function(Ne,Ge){var Qe=Ge[1];return Ir(Ge[0].evaluate(Ne),Qe.evaluate(Ne))}]]},"feature-state":[ni,[Va],function(Ne,Ge){return Ir(Ge[0].evaluate(Ne),Ne.featureState||{})}],properties:[ti,[],function(Ne){return Ne.properties()}],"geometry-type":[Va,[],function(Ne){return Ne.geometryType()}],id:[ni,[],function(Ne){return Ne.id()}],zoom:[_a,[],function(Ne){return Ne.globals.zoom}],"heatmap-density":[_a,[],function(Ne){return Ne.globals.heatmapDensity||0}],"line-progress":[_a,[],function(Ne){return Ne.globals.lineProgress||0}],accumulated:[ni,[],function(Ne){return void 0===Ne.globals.accumulated?null:Ne.globals.accumulated}],"+":[_a,zr(_a),function(Ne,Ge){for(var Qe=0,tt=0,rt=Ge;tt<rt.length;tt+=1)Qe+=rt[tt].evaluate(Ne);return Qe}],"*":[_a,zr(_a),function(Ne,Ge){for(var Qe=1,tt=0,rt=Ge;tt<rt.length;tt+=1)Qe*=rt[tt].evaluate(Ne);return Qe}],"-":{type:_a,overloads:[[[_a,_a],function(Ne,Ge){var Qe=Ge[1];return Ge[0].evaluate(Ne)-Qe.evaluate(Ne)}],[[_a],function(Ne,Ge){return-Ge[0].evaluate(Ne)}]]},"/":[_a,[_a,_a],function(Ne,Ge){var Qe=Ge[1];return Ge[0].evaluate(Ne)/Qe.evaluate(Ne)}],"%":[_a,[_a,_a],function(Ne,Ge){var Qe=Ge[1];return Ge[0].evaluate(Ne)%Qe.evaluate(Ne)}],ln2:[_a,[],function(){return Math.LN2}],pi:[_a,[],function(){return Math.PI}],e:[_a,[],function(){return Math.E}],"^":[_a,[_a,_a],function(Ne,Ge){var Qe=Ge[1];return Math.pow(Ge[0].evaluate(Ne),Qe.evaluate(Ne))}],sqrt:[_a,[_a],function(Ne,Ge){return Math.sqrt(Ge[0].evaluate(Ne))}],log10:[_a,[_a],function(Ne,Ge){return Math.log(Ge[0].evaluate(Ne))/Math.LN10}],ln:[_a,[_a],function(Ne,Ge){return Math.log(Ge[0].evaluate(Ne))}],log2:[_a,[_a],function(Ne,Ge){return Math.log(Ge[0].evaluate(Ne))/Math.LN2}],sin:[_a,[_a],function(Ne,Ge){return Math.sin(Ge[0].evaluate(Ne))}],cos:[_a,[_a],function(Ne,Ge){return Math.cos(Ge[0].evaluate(Ne))}],tan:[_a,[_a],function(Ne,Ge){return Math.tan(Ge[0].evaluate(Ne))}],asin:[_a,[_a],function(Ne,Ge){return Math.asin(Ge[0].evaluate(Ne))}],acos:[_a,[_a],function(Ne,Ge){return Math.acos(Ge[0].evaluate(Ne))}],atan:[_a,[_a],function(Ne,Ge){return Math.atan(Ge[0].evaluate(Ne))}],min:[_a,zr(_a),function(Ne,Ge){return Math.min.apply(Math,Ge.map((function(Ge){return Ge.evaluate(Ne)})))}],max:[_a,zr(_a),function(Ne,Ge){return Math.max.apply(Math,Ge.map((function(Ge){return Ge.evaluate(Ne)})))}],abs:[_a,[_a],function(Ne,Ge){return Math.abs(Ge[0].evaluate(Ne))}],round:[_a,[_a],function(Ne,Ge){var Qe=Ge[0].evaluate(Ne);return Qe<0?-Math.round(-Qe):Math.round(Qe)}],floor:[_a,[_a],function(Ne,Ge){return Math.floor(Ge[0].evaluate(Ne))}],ceil:[_a,[_a],function(Ne,Ge){return Math.ceil(Ge[0].evaluate(Ne))}],"filter-==":[Wa,[Va,ni],function(Ne,Ge){var Qe=Ge[0],tt=Ge[1];return Ne.properties()[Qe.value]===tt.value}],"filter-id-==":[Wa,[ni],function(Ne,Ge){var Qe=Ge[0];return Ne.id()===Qe.value}],"filter-type-==":[Wa,[Va],function(Ne,Ge){var Qe=Ge[0];return Ne.geometryType()===Qe.value}],"filter-<":[Wa,[Va,ni],function(Ne,Ge){var Qe=Ge[0],tt=Ge[1],rt=Ne.properties()[Qe.value],nt=tt.value;return typeof rt==typeof nt&&rt<nt}],"filter-id-<":[Wa,[ni],function(Ne,Ge){var Qe=Ge[0],tt=Ne.id(),rt=Qe.value;return typeof tt==typeof rt&&tt<rt}],"filter->":[Wa,[Va,ni],function(Ne,Ge){var Qe=Ge[0],tt=Ge[1],rt=Ne.properties()[Qe.value],nt=tt.value;return typeof rt==typeof nt&&rt>nt}],"filter-id->":[Wa,[ni],function(Ne,Ge){var Qe=Ge[0],tt=Ne.id(),rt=Qe.value;return typeof tt==typeof rt&&tt>rt}],"filter-<=":[Wa,[Va,ni],function(Ne,Ge){var Qe=Ge[0],tt=Ge[1],rt=Ne.properties()[Qe.value],nt=tt.value;return typeof rt==typeof nt&&rt<=nt}],"filter-id-<=":[Wa,[ni],function(Ne,Ge){var Qe=Ge[0],tt=Ne.id(),rt=Qe.value;return typeof tt==typeof rt&&tt<=rt}],"filter->=":[Wa,[Va,ni],function(Ne,Ge){var Qe=Ge[0],tt=Ge[1],rt=Ne.properties()[Qe.value],nt=tt.value;return typeof rt==typeof nt&&rt>=nt}],"filter-id->=":[Wa,[ni],function(Ne,Ge){var Qe=Ge[0],tt=Ne.id(),rt=Qe.value;return typeof tt==typeof rt&&tt>=rt}],"filter-has":[Wa,[ni],function(Ne,Ge){return Ge[0].value in Ne.properties()}],"filter-has-id":[Wa,[],function(Ne){return null!==Ne.id()&&void 0!==Ne.id()}],"filter-type-in":[Wa,[Kt(Va)],function(Ne,Ge){return Ge[0].value.indexOf(Ne.geometryType())>=0}],"filter-id-in":[Wa,[Kt(ni)],function(Ne,Ge){return Ge[0].value.indexOf(Ne.id())>=0}],"filter-in-small":[Wa,[Va,Kt(ni)],function(Ne,Ge){var Qe=Ge[0];return Ge[1].value.indexOf(Ne.properties()[Qe.value])>=0}],"filter-in-large":[Wa,[Va,Kt(ni)],function(Ne,Ge){var Qe=Ge[0],tt=Ge[1];return function(Ne,Ge,Qe,tt){for(;Qe<=tt;){var rt=Qe+tt>>1;if(Ge[rt]===Ne)return!0;Ge[rt]>Ne?tt=rt-1:Qe=rt+1}return!1}(Ne.properties()[Qe.value],tt.value,0,tt.value.length-1)}],all:{type:Wa,overloads:[[[Wa,Wa],function(Ne,Ge){var Qe=Ge[1];return Ge[0].evaluate(Ne)&&Qe.evaluate(Ne)}],[zr(Wa),function(Ne,Ge){for(var Qe=0,tt=Ge;Qe<tt.length;Qe+=1)if(!tt[Qe].evaluate(Ne))return!1;return!0}]]},any:{type:Wa,overloads:[[[Wa,Wa],function(Ne,Ge){var Qe=Ge[1];return Ge[0].evaluate(Ne)||Qe.evaluate(Ne)}],[zr(Wa),function(Ne,Ge){for(var Qe=0,tt=Ge;Qe<tt.length;Qe+=1)if(tt[Qe].evaluate(Ne))return!0;return!1}]]},"!":[Wa,[Wa],function(Ne,Ge){return!Ge[0].evaluate(Ne)}],"is-supported-script":[Wa,[Va],function(Ne,Ge){var Qe=Ne.globals&&Ne.globals.isSupportedScript;return!Qe||Qe(Ge[0].evaluate(Ne))}],upcase:[Va,[Va],function(Ne,Ge){return Ge[0].evaluate(Ne).toUpperCase()}],downcase:[Va,[Va],function(Ne,Ge){return Ge[0].evaluate(Ne).toLowerCase()}],concat:[Va,zr(ni),function(Ne,Ge){return Ge.map((function(Ge){return ae(Ge.evaluate(Ne))})).join("")}],"resolved-locale":[Va,[di],function(Ne,Ge){return Ge[0].evaluate(Ne).resolvedLocale()}]});var jr=function(Ne,Ge){this.expression=Ne,this._warningHistory={},this._evaluator=new de,this._defaultValue=Ge?function(Ne){return"color"===Ne.type&&Vr(Ne.default)?new $t(0,0,0,0):"color"===Ne.type?$t.parse(Ne.default)||null:void 0===Ne.default?null:Ne.default}(Ge):null,this._enumValues=Ge&&"enum"===Ge.type?Ge.values:null};function qr(Ne){return Array.isArray(Ne)&&Ne.length>0&&"string"==typeof Ne[0]&&Ne[0]in Ls}function Nr(Ne,Ge){var Qe=new Re(Ls,[],Ge?function(Ne){var Ge={color:Qa,string:Va,number:_a,enum:Va,boolean:Wa,formatted:ji,resolvedImage:Hi};return"array"===Ne.type?Kt(Ge[Ne.value]||ni,Ne.length):Ge[Ne.type]}(Ge):void 0),tt=Qe.parse(Ne,void 0,void 0,void 0,Ge&&"string"===Ge.type?{typeAnnotation:"coerce"}:void 0);return tt?Cr(new jr(tt,Ge)):Mr(Qe.errors)}jr.prototype.evaluateWithoutErrorHandling=function(Ne,Ge,Qe,tt,rt,nt){return this._evaluator.globals=Ne,this._evaluator.feature=Ge,this._evaluator.featureState=Qe,this._evaluator.canonical=tt,this._evaluator.availableImages=rt||null,this._evaluator.formattedSection=nt,this.expression.evaluate(this._evaluator)},jr.prototype.evaluate=function(Ne,Ge,Qe,tt,rt,nt){this._evaluator.globals=Ne,this._evaluator.feature=Ge||null,this._evaluator.featureState=Qe||null,this._evaluator.canonical=tt,this._evaluator.availableImages=rt||null,this._evaluator.formattedSection=nt||null;try{var at=this.expression.evaluate(this._evaluator);if(null==at||"number"==typeof at&&at!=at)return this._defaultValue;if(this._enumValues&&!(at in this._enumValues))throw new se("Expected value to be one of "+Object.keys(this._enumValues).map((function(Ne){return JSON.stringify(Ne)})).join(", ")+", but found "+JSON.stringify(at)+" instead.");return at}catch(Ne){return this._warningHistory[Ne.message]||(this._warningHistory[Ne.message]=!0,"undefined"!=typeof console&&console.warn(Ne.message)),this._defaultValue}};var Kr=function(Ne,Ge){this.kind=Ne,this._styleExpression=Ge,this.isStateDependent="constant"!==Ne&&!Fe(Ge.expression)};Kr.prototype.evaluateWithoutErrorHandling=function(Ne,Ge,Qe,tt,rt,nt){return this._styleExpression.evaluateWithoutErrorHandling(Ne,Ge,Qe,tt,rt,nt)},Kr.prototype.evaluate=function(Ne,Ge,Qe,tt,rt,nt){return this._styleExpression.evaluate(Ne,Ge,Qe,tt,rt,nt)};var Gr=function(Ne,Ge,Qe,tt){this.kind=Ne,this.zoomStops=Qe,this._styleExpression=Ge,this.isStateDependent="camera"!==Ne&&!Fe(Ge.expression),this.interpolationType=tt};function Zr(Ne,Ge){if("error"===(Ne=Nr(Ne,Ge)).result)return Ne;var Qe=Ne.value.expression,tt=Ve(Qe);if(!tt&&!Er(Ge))return Mr([new ga("","data expressions not supported")]);var rt=De(Qe,["zoom"]);if(!rt&&!Tr(Ge))return Mr([new ga("","zoom expressions not supported")]);var nt=function t(Ne){var Ge=null;if(Ne instanceof ar)Ge=t(Ne.result);else if(Ne instanceof ir)for(var Qe=0,tt=Ne.args;Qe<tt.length&&!(Ge=t(tt[Qe]));Qe+=1);else(Ne instanceof Ue||Ne instanceof rr)&&Ne.input instanceof me&&"zoom"===Ne.input.name&&(Ge=Ne);return Ge instanceof ga||Ne.eachChild((function(Ne){var Qe=t(Ne);Qe instanceof ga?Ge=Qe:!Ge&&Qe?Ge=new ga("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):Ge&&Qe&&Ge!==Qe&&(Ge=new ga("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),Ge}(Qe);return nt||rt?nt instanceof ga?Mr([nt]):nt instanceof rr&&!Pr(Ge)?Mr([new ga("",'"interpolate" expressions cannot be used with this property')]):Cr(nt?new Gr(tt?"camera":"composite",Ne.value,nt.labels,nt instanceof rr?nt.interpolation:void 0):new Kr(tt?"constant":"source",Ne.value)):Mr([new ga("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}Gr.prototype.evaluateWithoutErrorHandling=function(Ne,Ge,Qe,tt,rt,nt){return this._styleExpression.evaluateWithoutErrorHandling(Ne,Ge,Qe,tt,rt,nt)},Gr.prototype.evaluate=function(Ne,Ge,Qe,tt,rt,nt){return this._styleExpression.evaluate(Ne,Ge,Qe,tt,rt,nt)},Gr.prototype.interpolationFactor=function(Ne,Ge,Qe){return this.interpolationType?rr.interpolationFactor(this.interpolationType,Ne,Ge,Qe):0};var Xr=function(Ne,Ge){this._parameters=Ne,this._specification=Ge,Mt(this,function t(Ne,Ge){var Qe,tt,rt,nt="color"===Ge.type,at=Ne.stops&&"object"==typeof Ne.stops[0][0],it=at||!(at||void 0!==Ne.property),ot=Ne.type||(Pr(Ge)?"exponential":"interval");if(nt&&((Ne=Mt({},Ne)).stops&&(Ne.stops=Ne.stops.map((function(Ne){return[Ne[0],$t.parse(Ne[1])]}))),Ne.default=$t.parse(Ne.default?Ne.default:Ge.default)),Ne.colorSpace&&"rgb"!==Ne.colorSpace&&!vs[Ne.colorSpace])throw new Error("Unknown color space: "+Ne.colorSpace);if("exponential"===ot)Qe=Or;else if("interval"===ot)Qe=Rr;else if("categorical"===ot){Qe=Lr,tt=Object.create(null);for(var dt=0,ht=Ne.stops;dt<ht.length;dt+=1){var Dt=ht[dt];tt[Dt[0]]=Dt[1]}rt=typeof Ne.stops[0][0]}else{if("identity"!==ot)throw new Error('Unknown function type "'+ot+'"');Qe=Ur}if(at){for(var Ot={},Rt=[],Zt=0;Zt<Ne.stops.length;Zt++){var er=Ne.stops[Zt],dr=er[0].zoom;void 0===Ot[dr]&&(Ot[dr]={zoom:dr,type:Ne.type,property:Ne.property,default:Ne.default,stops:[]},Rt.push(dr)),Ot[dr].stops.push([er[0].value,er[1]])}for(var mr=[],xr=0,br=Rt;xr<br.length;xr+=1){var Ar=br[xr];mr.push([Ot[Ar].zoom,t(Ot[Ar],Ge)])}var en={name:"linear"};return{kind:"composite",interpolationType:en,interpolationFactor:rr.interpolationFactor.bind(void 0,en),zoomStops:mr.map((function(Ne){return Ne[0]})),evaluate:function(Qe,tt){var rt=Qe.zoom;return Or({stops:mr,base:Ne.base},Ge,rt).evaluate(rt,tt)}}}if(it){var mn="exponential"===ot?{name:"exponential",base:void 0!==Ne.base?Ne.base:1}:null;return{kind:"camera",interpolationType:mn,interpolationFactor:rr.interpolationFactor.bind(void 0,mn),zoomStops:Ne.stops.map((function(Ne){return Ne[0]})),evaluate:function(nt){return Qe(Ne,Ge,nt.zoom,tt,rt)}}}return{kind:"source",evaluate:function(nt,at){var it=at&&at.properties?at.properties[Ne.property]:void 0;return void 0===it?Dr(Ne.default,Ge.default):Qe(Ne,Ge,it,tt,rt)}}}(this._parameters,this._specification))};function Jr(Ne){var Ge=Ne.key,Qe=Ne.value,tt=Ne.valueSpec||{},rt=Ne.objectElementValidators||{},nt=Ne.style,at=Ne.styleSpec,it=[],ot=Br(Qe);if("object"!==ot)return[new zt(Ge,Qe,"object expected, "+ot+" found")];for(var dt in Qe){var ht=dt.split(".")[0],Dt=tt[ht]||tt["*"],Ot=void 0;if(rt[ht])Ot=rt[ht];else if(tt[ht])Ot=bn;else if(rt["*"])Ot=rt["*"];else{if(!tt["*"]){it.push(new zt(Ge,Qe[dt],'unknown property "'+dt+'"'));continue}Ot=bn}it=it.concat(Ot({key:(Ge?Ge+".":Ge)+dt,value:Qe[dt],valueSpec:Dt,style:nt,styleSpec:at,object:Qe,objectKey:dt},Qe))}for(var Rt in tt)rt[Rt]||tt[Rt].required&&void 0===tt[Rt].default&&void 0===Qe[Rt]&&it.push(new zt(Ge,Qe,'missing required property "'+Rt+'"'));return it}function Hr(Ne){var Ge=Ne.value,Qe=Ne.valueSpec,tt=Ne.style,rt=Ne.styleSpec,nt=Ne.key,at=Ne.arrayElementValidator||bn;if("array"!==Br(Ge))return[new zt(nt,Ge,"array expected, "+Br(Ge)+" found")];if(Qe.length&&Ge.length!==Qe.length)return[new zt(nt,Ge,"array length "+Qe.length+" expected, length "+Ge.length+" found")];if(Qe["min-length"]&&Ge.length<Qe["min-length"])return[new zt(nt,Ge,"array length at least "+Qe["min-length"]+" expected, length "+Ge.length+" found")];var it={type:Qe.value,values:Qe.values};rt.$version<7&&(it.function=Qe.function),"object"===Br(Qe.value)&&(it=Qe.value);for(var ot=[],dt=0;dt<Ge.length;dt++)ot=ot.concat(at({array:Ge,arrayIndex:dt,value:Ge[dt],valueSpec:it,style:tt,styleSpec:rt,key:nt+"["+dt+"]"}));return ot}function Yr(Ne){var Ge=Ne.key,Qe=Ne.value,tt=Ne.valueSpec,rt=Br(Qe);return"number"===rt&&Qe!=Qe&&(rt="NaN"),"number"!==rt?[new zt(Ge,Qe,"number expected, "+rt+" found")]:"minimum"in tt&&Qe<tt.minimum?[new zt(Ge,Qe,Qe+" is less than the minimum value "+tt.minimum)]:"maximum"in tt&&Qe>tt.maximum?[new zt(Ge,Qe,Qe+" is greater than the maximum value "+tt.maximum)]:[]}function $r(Ne){var Ge,Qe,tt,rt=Ne.valueSpec,nt=Et(Ne.value.type),at={},it="categorical"!==nt&&void 0===Ne.value.property,ot=!it,dt="array"===Br(Ne.value.stops)&&"array"===Br(Ne.value.stops[0])&&"object"===Br(Ne.value.stops[0][0]),ht=Jr({key:Ne.key,value:Ne.value,valueSpec:Ne.styleSpec.function,style:Ne.style,styleSpec:Ne.styleSpec,objectElementValidators:{stops:function(Ne){if("identity"===nt)return[new zt(Ne.key,Ne.value,'identity function may not have a "stops" property')];var Ge=[],Qe=Ne.value;return Ge=Ge.concat(Hr({key:Ne.key,value:Qe,valueSpec:Ne.valueSpec,style:Ne.style,styleSpec:Ne.styleSpec,arrayElementValidator:c})),"array"===Br(Qe)&&0===Qe.length&&Ge.push(new zt(Ne.key,Qe,"array must have at least one stop")),Ge},default:function(Ne){return bn({key:Ne.key,value:Ne.value,valueSpec:rt,style:Ne.style,styleSpec:Ne.styleSpec})}}});return"identity"===nt&&it&&ht.push(new zt(Ne.key,Ne.value,'missing required property "property"')),"identity"===nt||Ne.value.stops||ht.push(new zt(Ne.key,Ne.value,'missing required property "stops"')),"exponential"===nt&&Ne.valueSpec.expression&&!Pr(Ne.valueSpec)&&ht.push(new zt(Ne.key,Ne.value,"exponential functions not supported")),Ne.styleSpec.$version>=8&&(ot&&!Er(Ne.valueSpec)?ht.push(new zt(Ne.key,Ne.value,"property functions not supported")):it&&!Tr(Ne.valueSpec)&&ht.push(new zt(Ne.key,Ne.value,"zoom functions not supported"))),"categorical"!==nt&&!dt||void 0!==Ne.value.property||ht.push(new zt(Ne.key,Ne.value,'"property" property is required')),ht;function c(Ne){var Ge=[],nt=Ne.value,it=Ne.key;if("array"!==Br(nt))return[new zt(it,nt,"array expected, "+Br(nt)+" found")];if(2!==nt.length)return[new zt(it,nt,"array length 2 expected, length "+nt.length+" found")];if(dt){if("object"!==Br(nt[0]))return[new zt(it,nt,"object expected, "+Br(nt[0])+" found")];if(void 0===nt[0].zoom)return[new zt(it,nt,"object stop key must have zoom")];if(void 0===nt[0].value)return[new zt(it,nt,"object stop key must have value")];if(tt&&tt>Et(nt[0].zoom))return[new zt(it,nt[0].zoom,"stop zoom values must appear in ascending order")];Et(nt[0].zoom)!==tt&&(tt=Et(nt[0].zoom),Qe=void 0,at={}),Ge=Ge.concat(Jr({key:it+"[0]",value:nt[0],valueSpec:{zoom:{}},style:Ne.style,styleSpec:Ne.styleSpec,objectElementValidators:{zoom:Yr,value:h}}))}else Ge=Ge.concat(h({key:it+"[0]",value:nt[0],valueSpec:{},style:Ne.style,styleSpec:Ne.styleSpec},nt));return qr(Tt(nt[1]))?Ge.concat([new zt(it+"[1]",nt[1],"expressions are not allowed in function stops.")]):Ge.concat(bn({key:it+"[1]",value:nt[1],valueSpec:rt,style:Ne.style,styleSpec:Ne.styleSpec}))}function h(Ne,tt){var it=Br(Ne.value),ot=Et(Ne.value),dt=null!==Ne.value?Ne.value:tt;if(Ge){if(it!==Ge)return[new zt(Ne.key,dt,it+" stop domain type must match previous stop domain type "+Ge)]}else Ge=it;if("number"!==it&&"string"!==it&&"boolean"!==it)return[new zt(Ne.key,dt,"stop domain value must be a number, string, or boolean")];if("number"!==it&&"categorical"!==nt){var ht="number expected, "+it+" found";return Er(rt)&&void 0===nt&&(ht+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new zt(Ne.key,dt,ht)]}return"categorical"!==nt||"number"!==it||isFinite(ot)&&Math.floor(ot)===ot?"categorical"!==nt&&"number"===it&&void 0!==Qe&&ot<Qe?[new zt(Ne.key,dt,"stop domain values must appear in ascending order")]:(Qe=ot,"categorical"===nt&&ot in at?[new zt(Ne.key,dt,"stop domain values must be unique")]:(at[ot]=!0,[])):[new zt(Ne.key,dt,"integer expected, found "+ot)]}}function Wr(Ne){var Ge=("property"===Ne.expressionContext?Zr:Nr)(Tt(Ne.value),Ne.valueSpec);if("error"===Ge.result)return Ge.value.map((function(Ge){return new zt(""+Ne.key+Ge.key,Ne.value,Ge.message)}));var Qe=Ge.value.expression||Ge.value._styleExpression.expression;if("property"===Ne.expressionContext&&"text-font"===Ne.propertyKey&&!Qe.outputDefined())return[new zt(Ne.key,Ne.value,'Invalid data expression for "'+Ne.propertyKey+'". Output values must be contained as literals within the expression.')];if("property"===Ne.expressionContext&&"layout"===Ne.propertyType&&!Fe(Qe))return[new zt(Ne.key,Ne.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===Ne.expressionContext&&!Fe(Qe))return[new zt(Ne.key,Ne.value,'"feature-state" data expressions are not supported with filters.')];if(Ne.expressionContext&&0===Ne.expressionContext.indexOf("cluster")){if(!De(Qe,["zoom","feature-state"]))return[new zt(Ne.key,Ne.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===Ne.expressionContext&&!Ve(Qe))return[new zt(Ne.key,Ne.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Qr(Ne){var Ge=Ne.key,Qe=Ne.value,tt=Ne.valueSpec,rt=[];return Array.isArray(tt.values)?-1===tt.values.indexOf(Et(Qe))&&rt.push(new zt(Ge,Qe,"expected one of ["+tt.values.join(", ")+"], "+JSON.stringify(Qe)+" found")):-1===Object.keys(tt.values).indexOf(Et(Qe))&&rt.push(new zt(Ge,Qe,"expected one of ["+Object.keys(tt.values).join(", ")+"], "+JSON.stringify(Qe)+" found")),rt}function tn(Ne){if(!0===Ne||!1===Ne)return!0;if(!Array.isArray(Ne)||0===Ne.length)return!1;switch(Ne[0]){case"has":return Ne.length>=2&&"$id"!==Ne[1]&&"$type"!==Ne[1];case"in":return Ne.length>=3&&("string"!=typeof Ne[1]||Array.isArray(Ne[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==Ne.length||Array.isArray(Ne[1])||Array.isArray(Ne[2]);case"any":case"all":for(var Ge=0,Qe=Ne.slice(1);Ge<Qe.length;Ge+=1){var tt=Qe[Ge];if(!tn(tt)&&"boolean"!=typeof tt)return!1}return!0;default:return!0}}Xr.deserialize=function(Ne){return new Xr(Ne._parameters,Ne._specification)},Xr.serialize=function(Ne){return{_parameters:Ne._parameters,_specification:Ne._specification}};var Ps={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function rn(Ne){if(null==Ne)return{filter:function(){return!0},needGeometry:!1};tn(Ne)||(Ne=an(Ne));var Ge=Nr(Ne,Ps);if("error"===Ge.result)throw new Error(Ge.value.map((function(Ne){return Ne.key+": "+Ne.message})).join(", "));return{filter:function(Ne,Qe,tt){return Ge.value.evaluate(Ne,Qe,{},tt)},needGeometry:function t(Ne){if(!Array.isArray(Ne))return!1;if("within"===Ne[0])return!0;for(var Ge=1;Ge<Ne.length;Ge++)if(t(Ne[Ge]))return!0;return!1}(Ne)}}function nn(Ne,Ge){return Ne<Ge?-1:Ne>Ge?1:0}function an(Ne){if(!Ne)return!0;var Ge,Qe=Ne[0];return Ne.length<=1?"any"!==Qe:"=="===Qe?on(Ne[1],Ne[2],"=="):"!="===Qe?ln(on(Ne[1],Ne[2],"==")):"<"===Qe||">"===Qe||"<="===Qe||">="===Qe?on(Ne[1],Ne[2],Qe):"any"===Qe?(Ge=Ne.slice(1),["any"].concat(Ge.map(an))):"all"===Qe?["all"].concat(Ne.slice(1).map(an)):"none"===Qe?["all"].concat(Ne.slice(1).map(an).map(ln)):"in"===Qe?sn(Ne[1],Ne.slice(2)):"!in"===Qe?ln(sn(Ne[1],Ne.slice(2))):"has"===Qe?un(Ne[1]):"!has"===Qe?ln(un(Ne[1])):"within"!==Qe||Ne}function on(Ne,Ge,Qe){switch(Ne){case"$type":return["filter-type-"+Qe,Ge];case"$id":return["filter-id-"+Qe,Ge];default:return["filter-"+Qe,Ne,Ge]}}function sn(Ne,Ge){if(0===Ge.length)return!1;switch(Ne){case"$type":return["filter-type-in",["literal",Ge]];case"$id":return["filter-id-in",["literal",Ge]];default:return Ge.length>200&&!Ge.some((function(Ne){return typeof Ne!=typeof Ge[0]}))?["filter-in-large",Ne,["literal",Ge.sort(nn)]]:["filter-in-small",Ne,["literal",Ge]]}}function un(Ne){switch(Ne){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",Ne]}}function ln(Ne){return["!",Ne]}function pn(Ne){return tn(Tt(Ne.value))?Wr(Mt({},Ne,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(Ne){var Ge=Ne.value,Qe=Ne.key;if("array"!==Br(Ge))return[new zt(Qe,Ge,"array expected, "+Br(Ge)+" found")];var tt,rt=Ne.styleSpec,nt=[];if(Ge.length<1)return[new zt(Qe,Ge,"filter array must have at least 1 element")];switch(nt=nt.concat(Qr({key:Qe+"[0]",value:Ge[0],valueSpec:rt.filter_operator,style:Ne.style,styleSpec:Ne.styleSpec})),Et(Ge[0])){case"<":case"<=":case">":case">=":Ge.length>=2&&"$type"===Et(Ge[1])&&nt.push(new zt(Qe,Ge,'"$type" cannot be use with operator "'+Ge[0]+'"'));case"==":case"!=":3!==Ge.length&&nt.push(new zt(Qe,Ge,'filter array for operator "'+Ge[0]+'" must have 3 elements'));case"in":case"!in":Ge.length>=2&&"string"!==(tt=Br(Ge[1]))&&nt.push(new zt(Qe+"[1]",Ge[1],"string expected, "+tt+" found"));for(var at=2;at<Ge.length;at++)tt=Br(Ge[at]),"$type"===Et(Ge[1])?nt=nt.concat(Qr({key:Qe+"["+at+"]",value:Ge[at],valueSpec:rt.geometry_type,style:Ne.style,styleSpec:Ne.styleSpec})):"string"!==tt&&"number"!==tt&&"boolean"!==tt&&nt.push(new zt(Qe+"["+at+"]",Ge[at],"string, number, or boolean expected, "+tt+" found"));break;case"any":case"all":case"none":for(var it=1;it<Ge.length;it++)nt=nt.concat(t({key:Qe+"["+it+"]",value:Ge[it],style:Ne.style,styleSpec:Ne.styleSpec}));break;case"has":case"!has":tt=Br(Ge[1]),2!==Ge.length?nt.push(new zt(Qe,Ge,'filter array for "'+Ge[0]+'" operator must have 2 elements')):"string"!==tt&&nt.push(new zt(Qe+"[1]",Ge[1],"string expected, "+tt+" found"));break;case"within":tt=Br(Ge[1]),2!==Ge.length?nt.push(new zt(Qe,Ge,'filter array for "'+Ge[0]+'" operator must have 2 elements')):"object"!==tt&&nt.push(new zt(Qe+"[1]",Ge[1],"object expected, "+tt+" found"))}return nt}(Ne)}function cn(Ne,Ge){var Qe=Ne.key,tt=Ne.style,rt=Ne.styleSpec,nt=Ne.value,at=Ne.objectKey,it=rt[Ge+"_"+Ne.layerType];if(!it)return[];var ot=at.match(/^(.*)-transition$/);if("paint"===Ge&&ot&&it[ot[1]]&&it[ot[1]].transition)return bn({key:Qe,value:nt,valueSpec:rt.transition,style:tt,styleSpec:rt});var dt,ht=Ne.valueSpec||it[at];if(!ht)return[new zt(Qe,nt,'unknown property "'+at+'"')];if("string"===Br(nt)&&Er(ht)&&!ht.tokens&&(dt=/^{([^}]+)}$/.exec(nt)))return[new zt(Qe,nt,'"'+at+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(dt[1])+" }`.")];var Dt=[];return"symbol"===Ne.layerType&&("text-field"===at&&tt&&!tt.glyphs&&Dt.push(new zt(Qe,nt,'use of "text-field" requires a style "glyphs" property')),"text-font"===at&&Vr(Tt(nt))&&"identity"===Et(nt.type)&&Dt.push(new zt(Qe,nt,'"text-font" does not support identity functions'))),Dt.concat(bn({key:Ne.key,value:nt,valueSpec:ht,style:tt,styleSpec:rt,expressionContext:"property",propertyType:Ge,propertyKey:at}))}function hn(Ne){return cn(Ne,"paint")}function fn(Ne){return cn(Ne,"layout")}function yn(Ne){var Ge=[],Qe=Ne.value,tt=Ne.key,rt=Ne.style,nt=Ne.styleSpec;Qe.type||Qe.ref||Ge.push(new zt(tt,Qe,'either "type" or "ref" is required'));var at,it=Et(Qe.type),ot=Et(Qe.ref);if(Qe.id)for(var dt=Et(Qe.id),ht=0;ht<Ne.arrayIndex;ht++){var Dt=rt.layers[ht];Et(Dt.id)===dt&&Ge.push(new zt(tt,Qe.id,'duplicate layer id "'+Qe.id+'", previously used at line '+Dt.id.__line__))}if("ref"in Qe)["type","source","source-layer","filter","layout"].forEach((function(Ne){Ne in Qe&&Ge.push(new zt(tt,Qe[Ne],'"'+Ne+'" is prohibited for ref layers'))})),rt.layers.forEach((function(Ne){Et(Ne.id)===ot&&(at=Ne)})),at?at.ref?Ge.push(new zt(tt,Qe.ref,"ref cannot reference another ref layer")):it=Et(at.type):Ge.push(new zt(tt,Qe.ref,'ref layer "'+ot+'" not found'));else if("background"!==it)if(Qe.source){var Ot=rt.sources&&rt.sources[Qe.source],Rt=Ot&&Et(Ot.type);Ot?"vector"===Rt&&"raster"===it?Ge.push(new zt(tt,Qe.source,'layer "'+Qe.id+'" requires a raster source')):"raster"===Rt&&"raster"!==it?Ge.push(new zt(tt,Qe.source,'layer "'+Qe.id+'" requires a vector source')):"vector"!==Rt||Qe["source-layer"]?"raster-dem"===Rt&&"hillshade"!==it?Ge.push(new zt(tt,Qe.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==it||!Qe.paint||!Qe.paint["line-gradient"]||"geojson"===Rt&&Ot.lineMetrics||Ge.push(new zt(tt,Qe,'layer "'+Qe.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):Ge.push(new zt(tt,Qe,'layer "'+Qe.id+'" must specify a "source-layer"')):Ge.push(new zt(tt,Qe.source,'source "'+Qe.source+'" not found'))}else Ge.push(new zt(tt,Qe,'missing required property "source"'));return Ge=Ge.concat(Jr({key:tt,value:Qe,valueSpec:nt.layer,style:Ne.style,styleSpec:Ne.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return bn({key:tt+".type",value:Qe.type,valueSpec:nt.layer.type,style:Ne.style,styleSpec:Ne.styleSpec,object:Qe,objectKey:"type"})},filter:pn,layout:function(Ne){return Jr({layer:Qe,key:Ne.key,value:Ne.value,style:Ne.style,styleSpec:Ne.styleSpec,objectElementValidators:{"*":function(Ne){return fn(Mt({layerType:it},Ne))}}})},paint:function(Ne){return Jr({layer:Qe,key:Ne.key,value:Ne.value,style:Ne.style,styleSpec:Ne.styleSpec,objectElementValidators:{"*":function(Ne){return hn(Mt({layerType:it},Ne))}}})}}}))}function dn(Ne){var Ge=Ne.value,Qe=Ne.key,tt=Br(Ge);return"string"!==tt?[new zt(Qe,Ge,"string expected, "+tt+" found")]:[]}var Ds={promoteId:function(Ne){var Ge=Ne.key,Qe=Ne.value;if("string"===Br(Qe))return dn({key:Ge,value:Qe});var tt=[];for(var rt in Qe)tt.push.apply(tt,dn({key:Ge+"."+rt,value:Qe[rt]}));return tt}};function vn(Ne){var Ge=Ne.value,Qe=Ne.key,tt=Ne.styleSpec,rt=Ne.style;if(!Ge.type)return[new zt(Qe,Ge,'"type" is required')];var nt,at=Et(Ge.type);switch(at){case"vector":case"raster":case"raster-dem":return Jr({key:Qe,value:Ge,valueSpec:tt["source_"+at.replace("-","_")],style:Ne.style,styleSpec:tt,objectElementValidators:Ds});case"geojson":if(nt=Jr({key:Qe,value:Ge,valueSpec:tt.source_geojson,style:rt,styleSpec:tt,objectElementValidators:Ds}),Ge.cluster)for(var it in Ge.clusterProperties){var ot=Ge.clusterProperties[it],dt=ot[0],ht="string"==typeof dt?[dt,["accumulated"],["get",it]]:dt;nt.push.apply(nt,Wr({key:Qe+"."+it+".map",value:ot[1],expressionContext:"cluster-map"})),nt.push.apply(nt,Wr({key:Qe+"."+it+".reduce",value:ht,expressionContext:"cluster-reduce"}))}return nt;case"video":return Jr({key:Qe,value:Ge,valueSpec:tt.source_video,style:rt,styleSpec:tt});case"image":return Jr({key:Qe,value:Ge,valueSpec:tt.source_image,style:rt,styleSpec:tt});case"canvas":return[new zt(Qe,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Qr({key:Qe+".type",value:Ge.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:rt,styleSpec:tt})}}function gn(Ne){var Ge=Ne.value,Qe=Ne.styleSpec,tt=Qe.light,rt=Ne.style,nt=[],at=Br(Ge);if(void 0===Ge)return nt;if("object"!==at)return nt.concat([new zt("light",Ge,"object expected, "+at+" found")]);for(var it in Ge){var ot=it.match(/^(.*)-transition$/);nt=nt.concat(ot&&tt[ot[1]]&&tt[ot[1]].transition?bn({key:it,value:Ge[it],valueSpec:Qe.transition,style:rt,styleSpec:Qe}):tt[it]?bn({key:it,value:Ge[it],valueSpec:tt[it],style:rt,styleSpec:Qe}):[new zt(it,Ge[it],'unknown property "'+it+'"')])}return nt}var Is={"*":function(){return[]},array:Hr,boolean:function(Ne){var Ge=Ne.value,Qe=Ne.key,tt=Br(Ge);return"boolean"!==tt?[new zt(Qe,Ge,"boolean expected, "+tt+" found")]:[]},number:Yr,color:function(Ne){var Ge=Ne.key,Qe=Ne.value,tt=Br(Qe);return"string"!==tt?[new zt(Ge,Qe,"color expected, "+tt+" found")]:null===uo(Qe)?[new zt(Ge,Qe,'color expected, "'+Qe+'" found')]:[]},constants:Ct,enum:Qr,filter:pn,function:$r,layer:yn,object:Jr,source:vn,light:gn,string:dn,formatted:function(Ne){return 0===dn(Ne).length?[]:Wr(Ne)},resolvedImage:function(Ne){return 0===dn(Ne).length?[]:Wr(Ne)}};function bn(Ne){var Ge=Ne.value,Qe=Ne.valueSpec,tt=Ne.styleSpec;return Qe.expression&&Vr(Et(Ge))?$r(Ne):Qe.expression&&qr(Tt(Ge))?Wr(Ne):Qe.type&&Is[Qe.type]?Is[Qe.type](Ne):Jr(Mt({},Ne,{valueSpec:Qe.type?tt[Qe.type]:Qe}))}function wn(Ne){var Ge=Ne.value,Qe=Ne.key,tt=dn(Ne);return tt.length||(-1===Ge.indexOf("{fontstack}")&&tt.push(new zt(Qe,Ge,'"glyphs" url must include a "{fontstack}" token')),-1===Ge.indexOf("{range}")&&tt.push(new zt(Qe,Ge,'"glyphs" url must include a "{range}" token'))),tt}function _n(Ne,Ge){void 0===Ge&&(Ge=pa);var Qe=[];return Qe=Qe.concat(bn({key:"",value:Ne,valueSpec:Ge.$root,styleSpec:Ge,style:Ne,objectElementValidators:{glyphs:wn,"*":function(){return[]}}})),Ne.constants&&(Qe=Qe.concat(Ct({key:"constants",value:Ne.constants,style:Ne,styleSpec:Ge}))),An(Qe)}function An(Ne){return[].concat(Ne).sort((function(Ne,Ge){return Ne.line-Ge.line}))}function Sn(Ne){return function(){for(var Ge=[],Qe=arguments.length;Qe--;)Ge[Qe]=arguments[Qe];return An(Ne.apply(this,Ge))}}_n.source=Sn(vn),_n.light=Sn(gn),_n.layer=Sn(yn),_n.filter=Sn(pn),_n.paintProperty=Sn(hn),_n.layoutProperty=Sn(fn);var Os=_n,zs=Os.light,Rs=Os.paintProperty,Bs=Os.layoutProperty;function Mn(Ne,Ge){var Qe=!1;if(Ge&&Ge.length)for(var tt=0,rt=Ge;tt<rt.length;tt+=1)Ne.fire(new oa(new Error(rt[tt].message))),Qe=!0;return Qe}var Fs=Tn;function Tn(Ne,Ge,Qe){var tt=this.cells=[];if(Ne instanceof ArrayBuffer){this.arrayBuffer=Ne;var rt=new Int32Array(this.arrayBuffer);Ne=rt[0],this.d=(Ge=rt[1])+2*(Qe=rt[2]);for(var nt=0;nt<this.d*this.d;nt++){var at=rt[3+nt],it=rt[3+nt+1];tt.push(at===it?null:rt.subarray(at,it))}var ot=rt[3+tt.length+1];this.keys=rt.subarray(rt[3+tt.length],ot),this.bboxes=rt.subarray(ot),this.insert=this._insertReadonly}else{this.d=Ge+2*Qe;for(var dt=0;dt<this.d*this.d;dt++)tt.push([]);this.keys=[],this.bboxes=[]}this.n=Ge,this.extent=Ne,this.padding=Qe,this.scale=Ge/Ne,this.uid=0;var ht=Qe/Ge*Ne;this.min=-ht,this.max=Ne+ht}Tn.prototype.insert=function(Ne,Ge,Qe,tt,rt){this._forEachCell(Ge,Qe,tt,rt,this._insertCell,this.uid++),this.keys.push(Ne),this.bboxes.push(Ge),this.bboxes.push(Qe),this.bboxes.push(tt),this.bboxes.push(rt)},Tn.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Tn.prototype._insertCell=function(Ne,Ge,Qe,tt,rt,nt){this.cells[rt].push(nt)},Tn.prototype.query=function(Ne,Ge,Qe,tt,rt){var nt=this.min,at=this.max;if(Ne<=nt&&Ge<=nt&&at<=Qe&&at<=tt&&!rt)return Array.prototype.slice.call(this.keys);var it=[];return this._forEachCell(Ne,Ge,Qe,tt,this._queryCell,it,{},rt),it},Tn.prototype._queryCell=function(Ne,Ge,Qe,tt,rt,nt,at,it){var ot=this.cells[rt];if(null!==ot)for(var dt=this.keys,ht=this.bboxes,Dt=0;Dt<ot.length;Dt++){var Ot=ot[Dt];if(void 0===at[Ot]){var Rt=4*Ot;(it?it(ht[Rt+0],ht[Rt+1],ht[Rt+2],ht[Rt+3]):Ne<=ht[Rt+2]&&Ge<=ht[Rt+3]&&Qe>=ht[Rt+0]&&tt>=ht[Rt+1])?(at[Ot]=!0,nt.push(dt[Ot])):at[Ot]=!1}}},Tn.prototype._forEachCell=function(Ne,Ge,Qe,tt,rt,nt,at,it){for(var ot=this._convertToCellCoord(Ne),dt=this._convertToCellCoord(Ge),ht=this._convertToCellCoord(Qe),Dt=this._convertToCellCoord(tt),Ot=ot;Ot<=ht;Ot++)for(var Rt=dt;Rt<=Dt;Rt++){var Zt=this.d*Rt+Ot;if((!it||it(this._convertFromCellCoord(Ot),this._convertFromCellCoord(Rt),this._convertFromCellCoord(Ot+1),this._convertFromCellCoord(Rt+1)))&&rt.call(this,Ne,Ge,Qe,tt,Zt,nt,at,it))return}},Tn.prototype._convertFromCellCoord=function(Ne){return(Ne-this.padding)/this.scale},Tn.prototype._convertToCellCoord=function(Ne){return Math.max(0,Math.min(this.d-1,Math.floor(Ne*this.scale)+this.padding))},Tn.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var Ne=this.cells,Ge=3+this.cells.length+1+1,Qe=0,tt=0;tt<this.cells.length;tt++)Qe+=this.cells[tt].length;var rt=new Int32Array(Ge+Qe+this.keys.length+this.bboxes.length);rt[0]=this.extent,rt[1]=this.n,rt[2]=this.padding;for(var nt=Ge,at=0;at<Ne.length;at++){var it=Ne[at];rt[3+at]=nt,rt.set(it,nt),nt+=it.length}return rt[3+Ne.length]=nt,rt.set(this.keys,nt),rt[3+Ne.length+1]=nt+=this.keys.length,rt.set(this.bboxes,nt),nt+=this.bboxes.length,rt.buffer};var js=self.ImageData,Zs=self.ImageBitmap,Ks={};function Fn(Ne,Ge,Qe){void 0===Qe&&(Qe={}),Object.defineProperty(Ge,"_classRegistryKey",{value:Ne,writeable:!1}),Ks[Ne]={klass:Ge,omit:Qe.omit||[],shallow:Qe.shallow||[]}}for(var al in Fn("Object",Object),Fs.serialize=function(Ne,Ge){var Qe=Ne.toArrayBuffer();return Ge&&Ge.push(Qe),{buffer:Qe}},Fs.deserialize=function(Ne){return new Fs(Ne.buffer)},Fn("Grid",Fs),Fn("Color",$t),Fn("Error",Error),Fn("ResolvedImage",ee),Fn("StylePropertyFunction",Xr),Fn("StyleExpression",jr,{omit:["_evaluator"]}),Fn("ZoomDependentExpression",Gr),Fn("ZoomConstantExpression",Kr),Fn("CompoundExpression",me,{omit:["_evaluate"]}),Ls)Ls[al]._classRegistryKey||Fn("Expression_"+al,Ls[al]);function Ln(Ne){return Ne&&"undefined"!=typeof ArrayBuffer&&(Ne instanceof ArrayBuffer||Ne.constructor&&"ArrayBuffer"===Ne.constructor.name)}function Rn(Ne){return Zs&&Ne instanceof Zs}function On(Ne,Ge){if(null==Ne||"boolean"==typeof Ne||"number"==typeof Ne||"string"==typeof Ne||Ne instanceof Boolean||Ne instanceof Number||Ne instanceof String||Ne instanceof Date||Ne instanceof RegExp)return Ne;if(Ln(Ne)||Rn(Ne))return Ge&&Ge.push(Ne),Ne;if(ArrayBuffer.isView(Ne)){var Qe=Ne;return Ge&&Ge.push(Qe.buffer),Qe}if(Ne instanceof js)return Ge&&Ge.push(Ne.data.buffer),Ne;if(Array.isArray(Ne)){for(var tt=[],rt=0,nt=Ne;rt<nt.length;rt+=1)tt.push(On(nt[rt],Ge));return tt}if("object"==typeof Ne){var at=Ne.constructor,it=at._classRegistryKey;if(!it)throw new Error("can't serialize object of unregistered class");var ot=at.serialize?at.serialize(Ne,Ge):{};if(!at.serialize){for(var dt in Ne)if(Ne.hasOwnProperty(dt)&&!(Ks[it].omit.indexOf(dt)>=0)){var ht=Ne[dt];ot[dt]=Ks[it].shallow.indexOf(dt)>=0?ht:On(ht,Ge)}Ne instanceof Error&&(ot.message=Ne.message)}if(ot.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==it&&(ot.$name=it),ot}throw new Error("can't serialize object of type "+typeof Ne)}function Un(Ne){if(null==Ne||"boolean"==typeof Ne||"number"==typeof Ne||"string"==typeof Ne||Ne instanceof Boolean||Ne instanceof Number||Ne instanceof String||Ne instanceof Date||Ne instanceof RegExp||Ln(Ne)||Rn(Ne)||ArrayBuffer.isView(Ne)||Ne instanceof js)return Ne;if(Array.isArray(Ne))return Ne.map(Un);if("object"==typeof Ne){var Ge=Ne.$name||"Object",Qe=Ks[Ge].klass;if(!Qe)throw new Error("can't deserialize unregistered class "+Ge);if(Qe.deserialize)return Qe.deserialize(Ne);for(var tt=Object.create(Qe.prototype),rt=0,nt=Object.keys(Ne);rt<nt.length;rt+=1){var at=nt[rt];if("$name"!==at){var it=Ne[at];tt[at]=Ks[Ge].shallow.indexOf(at)>=0?it:Un(it)}}return tt}throw new Error("can't deserialize object of type "+typeof Ne)}var jn=function(){this.first=!0};jn.prototype.update=function(Ne,Ge){var Qe=Math.floor(Ne);return this.first?(this.first=!1,this.lastIntegerZoom=Qe,this.lastIntegerZoomTime=0,this.lastZoom=Ne,this.lastFloorZoom=Qe,!0):(this.lastFloorZoom>Qe?(this.lastIntegerZoom=Qe+1,this.lastIntegerZoomTime=Ge):this.lastFloorZoom<Qe&&(this.lastIntegerZoom=Qe,this.lastIntegerZoomTime=Ge),Ne!==this.lastZoom&&(this.lastZoom=Ne,this.lastFloorZoom=Qe,!0))};var il={"Latin-1 Supplement":function(Ne){return Ne>=128&&Ne<=255},Arabic:function(Ne){return Ne>=1536&&Ne<=1791},"Arabic Supplement":function(Ne){return Ne>=1872&&Ne<=1919},"Arabic Extended-A":function(Ne){return Ne>=2208&&Ne<=2303},"Hangul Jamo":function(Ne){return Ne>=4352&&Ne<=4607},"Unified Canadian Aboriginal Syllabics":function(Ne){return Ne>=5120&&Ne<=5759},Khmer:function(Ne){return Ne>=6016&&Ne<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(Ne){return Ne>=6320&&Ne<=6399},"General Punctuation":function(Ne){return Ne>=8192&&Ne<=8303},"Letterlike Symbols":function(Ne){return Ne>=8448&&Ne<=8527},"Number Forms":function(Ne){return Ne>=8528&&Ne<=8591},"Miscellaneous Technical":function(Ne){return Ne>=8960&&Ne<=9215},"Control Pictures":function(Ne){return Ne>=9216&&Ne<=9279},"Optical Character Recognition":function(Ne){return Ne>=9280&&Ne<=9311},"Enclosed Alphanumerics":function(Ne){return Ne>=9312&&Ne<=9471},"Geometric Shapes":function(Ne){return Ne>=9632&&Ne<=9727},"Miscellaneous Symbols":function(Ne){return Ne>=9728&&Ne<=9983},"Miscellaneous Symbols and Arrows":function(Ne){return Ne>=11008&&Ne<=11263},"CJK Radicals Supplement":function(Ne){return Ne>=11904&&Ne<=12031},"Kangxi Radicals":function(Ne){return Ne>=12032&&Ne<=12255},"Ideographic Description Characters":function(Ne){return Ne>=12272&&Ne<=12287},"CJK Symbols and Punctuation":function(Ne){return Ne>=12288&&Ne<=12351},Hiragana:function(Ne){return Ne>=12352&&Ne<=12447},Katakana:function(Ne){return Ne>=12448&&Ne<=12543},Bopomofo:function(Ne){return Ne>=12544&&Ne<=12591},"Hangul Compatibility Jamo":function(Ne){return Ne>=12592&&Ne<=12687},Kanbun:function(Ne){return Ne>=12688&&Ne<=12703},"Bopomofo Extended":function(Ne){return Ne>=12704&&Ne<=12735},"CJK Strokes":function(Ne){return Ne>=12736&&Ne<=12783},"Katakana Phonetic Extensions":function(Ne){return Ne>=12784&&Ne<=12799},"Enclosed CJK Letters and Months":function(Ne){return Ne>=12800&&Ne<=13055},"CJK Compatibility":function(Ne){return Ne>=13056&&Ne<=13311},"CJK Unified Ideographs Extension A":function(Ne){return Ne>=13312&&Ne<=19903},"Yijing Hexagram Symbols":function(Ne){return Ne>=19904&&Ne<=19967},"CJK Unified Ideographs":function(Ne){return Ne>=19968&&Ne<=40959},"Yi Syllables":function(Ne){return Ne>=40960&&Ne<=42127},"Yi Radicals":function(Ne){return Ne>=42128&&Ne<=42191},"Hangul Jamo Extended-A":function(Ne){return Ne>=43360&&Ne<=43391},"Hangul Syllables":function(Ne){return Ne>=44032&&Ne<=55215},"Hangul Jamo Extended-B":function(Ne){return Ne>=55216&&Ne<=55295},"Private Use Area":function(Ne){return Ne>=57344&&Ne<=63743},"CJK Compatibility Ideographs":function(Ne){return Ne>=63744&&Ne<=64255},"Arabic Presentation Forms-A":function(Ne){return Ne>=64336&&Ne<=65023},"Vertical Forms":function(Ne){return Ne>=65040&&Ne<=65055},"CJK Compatibility Forms":function(Ne){return Ne>=65072&&Ne<=65103},"Small Form Variants":function(Ne){return Ne>=65104&&Ne<=65135},"Arabic Presentation Forms-B":function(Ne){return Ne>=65136&&Ne<=65279},"Halfwidth and Fullwidth Forms":function(Ne){return Ne>=65280&&Ne<=65519}};function Nn(Ne){for(var Ge=0,Qe=Ne;Ge<Qe.length;Ge+=1)if(Kn(Qe[Ge].charCodeAt(0)))return!0;return!1}function Kn(Ne){return!(746!==Ne&&747!==Ne&&(Ne<4352||!(il["Bopomofo Extended"](Ne)||il.Bopomofo(Ne)||il["CJK Compatibility Forms"](Ne)&&!(Ne>=65097&&Ne<=65103)||il["CJK Compatibility Ideographs"](Ne)||il["CJK Compatibility"](Ne)||il["CJK Radicals Supplement"](Ne)||il["CJK Strokes"](Ne)||!(!il["CJK Symbols and Punctuation"](Ne)||Ne>=12296&&Ne<=12305||Ne>=12308&&Ne<=12319||12336===Ne)||il["CJK Unified Ideographs Extension A"](Ne)||il["CJK Unified Ideographs"](Ne)||il["Enclosed CJK Letters and Months"](Ne)||il["Hangul Compatibility Jamo"](Ne)||il["Hangul Jamo Extended-A"](Ne)||il["Hangul Jamo Extended-B"](Ne)||il["Hangul Jamo"](Ne)||il["Hangul Syllables"](Ne)||il.Hiragana(Ne)||il["Ideographic Description Characters"](Ne)||il.Kanbun(Ne)||il["Kangxi Radicals"](Ne)||il["Katakana Phonetic Extensions"](Ne)||il.Katakana(Ne)&&12540!==Ne||!(!il["Halfwidth and Fullwidth Forms"](Ne)||65288===Ne||65289===Ne||65293===Ne||Ne>=65306&&Ne<=65310||65339===Ne||65341===Ne||65343===Ne||Ne>=65371&&Ne<=65503||65507===Ne||Ne>=65512&&Ne<=65519)||!(!il["Small Form Variants"](Ne)||Ne>=65112&&Ne<=65118||Ne>=65123&&Ne<=65126)||il["Unified Canadian Aboriginal Syllabics"](Ne)||il["Unified Canadian Aboriginal Syllabics Extended"](Ne)||il["Vertical Forms"](Ne)||il["Yijing Hexagram Symbols"](Ne)||il["Yi Syllables"](Ne)||il["Yi Radicals"](Ne))))}function Gn(Ne){return!(Kn(Ne)||function(Ne){return!!(il["Latin-1 Supplement"](Ne)&&(167===Ne||169===Ne||174===Ne||177===Ne||188===Ne||189===Ne||190===Ne||215===Ne||247===Ne)||il["General Punctuation"](Ne)&&(8214===Ne||8224===Ne||8225===Ne||8240===Ne||8241===Ne||8251===Ne||8252===Ne||8258===Ne||8263===Ne||8264===Ne||8265===Ne||8273===Ne)||il["Letterlike Symbols"](Ne)||il["Number Forms"](Ne)||il["Miscellaneous Technical"](Ne)&&(Ne>=8960&&Ne<=8967||Ne>=8972&&Ne<=8991||Ne>=8996&&Ne<=9e3||9003===Ne||Ne>=9085&&Ne<=9114||Ne>=9150&&Ne<=9165||9167===Ne||Ne>=9169&&Ne<=9179||Ne>=9186&&Ne<=9215)||il["Control Pictures"](Ne)&&9251!==Ne||il["Optical Character Recognition"](Ne)||il["Enclosed Alphanumerics"](Ne)||il["Geometric Shapes"](Ne)||il["Miscellaneous Symbols"](Ne)&&!(Ne>=9754&&Ne<=9759)||il["Miscellaneous Symbols and Arrows"](Ne)&&(Ne>=11026&&Ne<=11055||Ne>=11088&&Ne<=11097||Ne>=11192&&Ne<=11243)||il["CJK Symbols and Punctuation"](Ne)||il.Katakana(Ne)||il["Private Use Area"](Ne)||il["CJK Compatibility Forms"](Ne)||il["Small Form Variants"](Ne)||il["Halfwidth and Fullwidth Forms"](Ne)||8734===Ne||8756===Ne||8757===Ne||Ne>=9984&&Ne<=10087||Ne>=10102&&Ne<=10131||65532===Ne||65533===Ne)}(Ne))}function Zn(Ne){return Ne>=1424&&Ne<=2303||il["Arabic Presentation Forms-A"](Ne)||il["Arabic Presentation Forms-B"](Ne)}function Xn(Ne,Ge){return!(!Ge&&Zn(Ne)||Ne>=2304&&Ne<=3583||Ne>=3840&&Ne<=4255||il.Khmer(Ne))}function Jn(Ne){for(var Ge=0,Qe=Ne;Ge<Qe.length;Ge+=1)if(Zn(Qe[Ge].charCodeAt(0)))return!0;return!1}var fl=null,dl="unavailable",hl=null,Wn=function(Ne){Ne&&"string"==typeof Ne&&Ne.indexOf("NetworkError")>-1&&(dl="error"),fl&&fl(Ne)};function Qn(){gl.fire(new At("pluginStateChange",{pluginStatus:dl,pluginURL:hl}))}var gl=new kt,ei=function(){return dl},ri=function(){if("deferred"!==dl||!hl)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");dl="loading",Qn(),hl&&gt({url:hl},(function(Ne){Ne?Wn(Ne):(dl="loaded",Qn())}))},ml={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return"loaded"===dl||null!=ml.applyArabicShaping},isLoading:function(){return"loading"===dl},setState:function(Ne){dl=Ne.pluginStatus,hl=Ne.pluginURL},isParsed:function(){return null!=ml.applyArabicShaping&&null!=ml.processBidirectionalText&&null!=ml.processStyledBidirectionalText},getPluginURL:function(){return hl}},ii=function(Ne,Ge){this.zoom=Ne,Ge?(this.now=Ge.now,this.fadeDuration=Ge.fadeDuration,this.zoomHistory=Ge.zoomHistory,this.transition=Ge.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new jn,this.transition={})};ii.prototype.isSupportedScript=function(Ne){return function(Ne,Ge){for(var Qe=0,tt=Ne;Qe<tt.length;Qe+=1)if(!Xn(tt[Qe].charCodeAt(0),Ge))return!1;return!0}(Ne,ml.isLoaded())},ii.prototype.crossFadingFactor=function(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},ii.prototype.getCrossfadeParameters=function(){var Ne=this.zoom,Ge=Ne-Math.floor(Ne),Qe=this.crossFadingFactor();return Ne>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:Ge+(1-Ge)*Qe}:{fromScale:.5,toScale:1,t:1-(1-Qe)*Ge}};var ai=function(Ne,Ge){this.property=Ne,this.value=Ge,this.expression=function(Ne,Ge){if(Vr(Ne))return new Xr(Ne,Ge);if(qr(Ne)){var Qe=Zr(Ne,Ge);if("error"===Qe.result)throw new Error(Qe.value.map((function(Ne){return Ne.key+": "+Ne.message})).join(", "));return Qe.value}var tt=Ne;return"string"==typeof Ne&&"color"===Ge.type&&(tt=$t.parse(Ne)),{kind:"constant",evaluate:function(){return tt}}}(void 0===Ge?Ne.specification.default:Ge,Ne.specification)};ai.prototype.isDataDriven=function(){return"source"===this.expression.kind||"composite"===this.expression.kind},ai.prototype.possiblyEvaluate=function(Ne,Ge,Qe){return this.property.possiblyEvaluate(this,Ne,Ge,Qe)};var oi=function(Ne){this.property=Ne,this.value=new ai(Ne,void 0)};oi.prototype.transitioned=function(Ne,Ge){return new ui(this.property,this.value,Ge,p({},Ne.transition,this.transition),Ne.now)},oi.prototype.untransitioned=function(){return new ui(this.property,this.value,null,{},0)};var si=function(Ne){this._properties=Ne,this._values=Object.create(Ne.defaultTransitionablePropertyValues)};si.prototype.getValue=function(Ne){return x(this._values[Ne].value.value)},si.prototype.setValue=function(Ne,Ge){this._values.hasOwnProperty(Ne)||(this._values[Ne]=new oi(this._values[Ne].property)),this._values[Ne].value=new ai(this._values[Ne].property,null===Ge?void 0:x(Ge))},si.prototype.getTransition=function(Ne){return x(this._values[Ne].transition)},si.prototype.setTransition=function(Ne,Ge){this._values.hasOwnProperty(Ne)||(this._values[Ne]=new oi(this._values[Ne].property)),this._values[Ne].transition=x(Ge)||void 0},si.prototype.serialize=function(){for(var Ne={},Ge=0,Qe=Object.keys(this._values);Ge<Qe.length;Ge+=1){var tt=Qe[Ge],rt=this.getValue(tt);void 0!==rt&&(Ne[tt]=rt);var nt=this.getTransition(tt);void 0!==nt&&(Ne[tt+"-transition"]=nt)}return Ne},si.prototype.transitioned=function(Ne,Ge){for(var Qe=new li(this._properties),tt=0,rt=Object.keys(this._values);tt<rt.length;tt+=1){var nt=rt[tt];Qe._values[nt]=this._values[nt].transitioned(Ne,Ge._values[nt])}return Qe},si.prototype.untransitioned=function(){for(var Ne=new li(this._properties),Ge=0,Qe=Object.keys(this._values);Ge<Qe.length;Ge+=1){var tt=Qe[Ge];Ne._values[tt]=this._values[tt].untransitioned()}return Ne};var ui=function(Ne,Ge,Qe,tt,rt){this.property=Ne,this.value=Ge,this.begin=rt+tt.delay||0,this.end=this.begin+tt.duration||0,Ne.specification.transition&&(tt.delay||tt.duration)&&(this.prior=Qe)};ui.prototype.possiblyEvaluate=function(Ne,Ge,Qe){var tt=Ne.now||0,rt=this.value.possiblyEvaluate(Ne,Ge,Qe),nt=this.prior;if(nt){if(tt>this.end)return this.prior=null,rt;if(this.value.isDataDriven())return this.prior=null,rt;if(tt<this.begin)return nt.possiblyEvaluate(Ne,Ge,Qe);var at=(tt-this.begin)/(this.end-this.begin);return this.property.interpolate(nt.possiblyEvaluate(Ne,Ge,Qe),rt,function(Ne){if(Ne<=0)return 0;if(Ne>=1)return 1;var Ge=Ne*Ne,Qe=Ge*Ne;return 4*(Ne<.5?Qe:3*(Ne-Ge)+Qe-.75)}(at))}return rt};var li=function(Ne){this._properties=Ne,this._values=Object.create(Ne.defaultTransitioningPropertyValues)};li.prototype.possiblyEvaluate=function(Ne,Ge,Qe){for(var tt=new hi(this._properties),rt=0,nt=Object.keys(this._values);rt<nt.length;rt+=1){var at=nt[rt];tt._values[at]=this._values[at].possiblyEvaluate(Ne,Ge,Qe)}return tt},li.prototype.hasTransition=function(){for(var Ne=0,Ge=Object.keys(this._values);Ne<Ge.length;Ne+=1)if(this._values[Ge[Ne]].prior)return!0;return!1};var pi=function(Ne){this._properties=Ne,this._values=Object.create(Ne.defaultPropertyValues)};pi.prototype.getValue=function(Ne){return x(this._values[Ne].value)},pi.prototype.setValue=function(Ne,Ge){this._values[Ne]=new ai(this._values[Ne].property,null===Ge?void 0:x(Ge))},pi.prototype.serialize=function(){for(var Ne={},Ge=0,Qe=Object.keys(this._values);Ge<Qe.length;Ge+=1){var tt=Qe[Ge],rt=this.getValue(tt);void 0!==rt&&(Ne[tt]=rt)}return Ne},pi.prototype.possiblyEvaluate=function(Ne,Ge,Qe){for(var tt=new hi(this._properties),rt=0,nt=Object.keys(this._values);rt<nt.length;rt+=1){var at=nt[rt];tt._values[at]=this._values[at].possiblyEvaluate(Ne,Ge,Qe)}return tt};var ci=function(Ne,Ge,Qe){this.property=Ne,this.value=Ge,this.parameters=Qe};ci.prototype.isConstant=function(){return"constant"===this.value.kind},ci.prototype.constantOr=function(Ne){return"constant"===this.value.kind?this.value.value:Ne},ci.prototype.evaluate=function(Ne,Ge,Qe,tt){return this.property.evaluate(this.value,this.parameters,Ne,Ge,Qe,tt)};var hi=function(Ne){this._properties=Ne,this._values=Object.create(Ne.defaultPossiblyEvaluatedValues)};hi.prototype.get=function(Ne){return this._values[Ne]};var fi=function(Ne){this.specification=Ne};fi.prototype.possiblyEvaluate=function(Ne,Ge){return Ne.expression.evaluate(Ge)},fi.prototype.interpolate=function(Ne,Ge,Qe){var tt=is[this.specification.type];return tt?tt(Ne,Ge,Qe):Ne};var yi=function(Ne,Ge){this.specification=Ne,this.overrides=Ge};yi.prototype.possiblyEvaluate=function(Ne,Ge,Qe,tt){return new ci(this,"constant"===Ne.expression.kind||"camera"===Ne.expression.kind?{kind:"constant",value:Ne.expression.evaluate(Ge,null,{},Qe,tt)}:Ne.expression,Ge)},yi.prototype.interpolate=function(Ne,Ge,Qe){if("constant"!==Ne.value.kind||"constant"!==Ge.value.kind)return Ne;if(void 0===Ne.value.value||void 0===Ge.value.value)return new ci(this,{kind:"constant",value:void 0},Ne.parameters);var tt=is[this.specification.type];return tt?new ci(this,{kind:"constant",value:tt(Ne.value.value,Ge.value.value,Qe)},Ne.parameters):Ne},yi.prototype.evaluate=function(Ne,Ge,Qe,tt,rt,nt){return"constant"===Ne.kind?Ne.value:Ne.evaluate(Ge,Qe,tt,rt,nt)};var vl=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(Ne,Ge,Qe,tt){if(void 0===Ne.value)return new ci(this,{kind:"constant",value:void 0},Ge);if("constant"===Ne.expression.kind){var rt=Ne.expression.evaluate(Ge,null,{},Qe,tt),nt="resolvedImage"===Ne.property.specification.type&&"string"!=typeof rt?rt.name:rt,at=this._calculate(nt,nt,nt,Ge);return new ci(this,{kind:"constant",value:at},Ge)}if("camera"===Ne.expression.kind){var it=this._calculate(Ne.expression.evaluate({zoom:Ge.zoom-1}),Ne.expression.evaluate({zoom:Ge.zoom}),Ne.expression.evaluate({zoom:Ge.zoom+1}),Ge);return new ci(this,{kind:"constant",value:it},Ge)}return new ci(this,Ne.expression,Ge)},e.prototype.evaluate=function(Ne,Ge,Qe,tt,rt,nt){if("source"===Ne.kind){var at=Ne.evaluate(Ge,Qe,tt,rt,nt);return this._calculate(at,at,at,Ge)}return"composite"===Ne.kind?this._calculate(Ne.evaluate({zoom:Math.floor(Ge.zoom)-1},Qe,tt),Ne.evaluate({zoom:Math.floor(Ge.zoom)},Qe,tt),Ne.evaluate({zoom:Math.floor(Ge.zoom)+1},Qe,tt),Ge):Ne.value},e.prototype._calculate=function(Ne,Ge,Qe,tt){return tt.zoom>tt.zoomHistory.lastIntegerZoom?{from:Ne,to:Ge}:{from:Qe,to:Ge}},e.prototype.interpolate=function(Ne){return Ne},e}(yi),mi=function(Ne){this.specification=Ne};mi.prototype.possiblyEvaluate=function(Ne,Ge,Qe,tt){if(void 0!==Ne.value){if("constant"===Ne.expression.kind){var rt=Ne.expression.evaluate(Ge,null,{},Qe,tt);return this._calculate(rt,rt,rt,Ge)}return this._calculate(Ne.expression.evaluate(new ii(Math.floor(Ge.zoom-1),Ge)),Ne.expression.evaluate(new ii(Math.floor(Ge.zoom),Ge)),Ne.expression.evaluate(new ii(Math.floor(Ge.zoom+1),Ge)),Ge)}},mi.prototype._calculate=function(Ne,Ge,Qe,tt){return tt.zoom>tt.zoomHistory.lastIntegerZoom?{from:Ne,to:Ge}:{from:Qe,to:Ge}},mi.prototype.interpolate=function(Ne){return Ne};var vi=function(Ne){this.specification=Ne};vi.prototype.possiblyEvaluate=function(Ne,Ge,Qe,tt){return!!Ne.expression.evaluate(Ge,null,{},Qe,tt)},vi.prototype.interpolate=function(){return!1};var gi=function(Ne){for(var Ge in this.properties=Ne,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],Ne){var Qe=Ne[Ge];Qe.specification.overridable&&this.overridableProperties.push(Ge);var tt=this.defaultPropertyValues[Ge]=new ai(Qe,void 0),rt=this.defaultTransitionablePropertyValues[Ge]=new oi(Qe);this.defaultTransitioningPropertyValues[Ge]=rt.untransitioned(),this.defaultPossiblyEvaluatedValues[Ge]=tt.possiblyEvaluate({})}};Fn("DataDrivenProperty",yi),Fn("DataConstantProperty",fi),Fn("CrossFadedDataDrivenProperty",vl),Fn("CrossFadedProperty",mi),Fn("ColorRampProperty",vi);var xl=function(Ne){function e(Ge,Qe){if(Ne.call(this),this.id=Ge.id,this.type=Ge.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},"custom"!==Ge.type&&(this.metadata=Ge.metadata,this.minzoom=Ge.minzoom,this.maxzoom=Ge.maxzoom,"background"!==Ge.type&&(this.source=Ge.source,this.sourceLayer=Ge["source-layer"],this.filter=Ge.filter),Qe.layout&&(this._unevaluatedLayout=new pi(Qe.layout)),Qe.paint)){for(var tt in this._transitionablePaint=new si(Qe.paint),Ge.paint)this.setPaintProperty(tt,Ge.paint[tt],{validate:!1});for(var rt in Ge.layout)this.setLayoutProperty(rt,Ge.layout[rt],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new hi(Qe.paint)}}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},e.prototype.getLayoutProperty=function(Ne){return"visibility"===Ne?this.visibility:this._unevaluatedLayout.getValue(Ne)},e.prototype.setLayoutProperty=function(Ne,Ge,Qe){void 0===Qe&&(Qe={}),null!=Ge&&this._validate(Bs,"layers."+this.id+".layout."+Ne,Ne,Ge,Qe)||("visibility"!==Ne?this._unevaluatedLayout.setValue(Ne,Ge):this.visibility=Ge)},e.prototype.getPaintProperty=function(Ne){return m(Ne,"-transition")?this._transitionablePaint.getTransition(Ne.slice(0,-"-transition".length)):this._transitionablePaint.getValue(Ne)},e.prototype.setPaintProperty=function(Ne,Ge,Qe){if(void 0===Qe&&(Qe={}),null!=Ge&&this._validate(Rs,"layers."+this.id+".paint."+Ne,Ne,Ge,Qe))return!1;if(m(Ne,"-transition"))return this._transitionablePaint.setTransition(Ne.slice(0,-"-transition".length),Ge||void 0),!1;var tt=this._transitionablePaint._values[Ne],rt="cross-faded-data-driven"===tt.property.specification["property-type"],nt=tt.value.isDataDriven(),at=tt.value;this._transitionablePaint.setValue(Ne,Ge),this._handleSpecialPaintPropertyUpdate(Ne);var it=this._transitionablePaint._values[Ne].value;return it.isDataDriven()||nt||rt||this._handleOverridablePaintPropertyUpdate(Ne,at,it)},e.prototype._handleSpecialPaintPropertyUpdate=function(Ne){},e.prototype._handleOverridablePaintPropertyUpdate=function(Ne,Ge,Qe){return!1},e.prototype.isHidden=function(Ne){return!!(this.minzoom&&Ne<this.minzoom)||!!(this.maxzoom&&Ne>=this.maxzoom)||"none"===this.visibility},e.prototype.updateTransitions=function(Ne){this._transitioningPaint=this._transitionablePaint.transitioned(Ne,this._transitioningPaint)},e.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},e.prototype.recalculate=function(Ne,Ge){Ne.getCrossfadeParameters&&(this._crossfadeParameters=Ne.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(Ne,void 0,Ge)),this.paint=this._transitioningPaint.possiblyEvaluate(Ne,void 0,Ge)},e.prototype.serialize=function(){var Ne={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(Ne.layout=Ne.layout||{},Ne.layout.visibility=this.visibility),g(Ne,(function(Ne,Ge){return!(void 0===Ne||"layout"===Ge&&!Object.keys(Ne).length||"paint"===Ge&&!Object.keys(Ne).length)}))},e.prototype._validate=function(Ne,Ge,Qe,tt,rt){return void 0===rt&&(rt={}),(!rt||!1!==rt.validate)&&Mn(this,Ne.call(Os,{key:Ge,layerType:this.type,objectKey:Qe,value:tt,styleSpec:pa,style:{glyphs:!0,sprite:!0}}))},e.prototype.is3D=function(){return!1},e.prototype.isTileClipped=function(){return!1},e.prototype.hasOffscreenPass=function(){return!1},e.prototype.resize=function(){},e.prototype.isStateDependent=function(){for(var Ne in this.paint._values){var Ge=this.paint.get(Ne);if(Ge instanceof ci&&Er(Ge.property.specification)&&("source"===Ge.value.kind||"composite"===Ge.value.kind)&&Ge.value.isStateDependent)return!0}return!1},e}(kt),bl={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},wi=function(Ne,Ge){this._structArray=Ne,this._pos1=Ge*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},_i=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Ai(Ne,Ge){void 0===Ge&&(Ge=1);var Qe=0,tt=0;return{members:Ne.map((function(Ne){var rt=bl[Ne.type].BYTES_PER_ELEMENT,nt=Qe=Si(Qe,Math.max(Ge,rt)),at=Ne.components||1;return tt=Math.max(tt,rt),Qe+=rt*at,{name:Ne.name,type:Ne.type,components:at,offset:nt}})),size:Si(Qe,Math.max(tt,Ge)),alignment:Ge}}function Si(Ne,Ge){return Math.ceil(Ne/Ge)*Ge}_i.serialize=function(Ne,Ge){return Ne._trim(),Ge&&(Ne.isTransferred=!0,Ge.push(Ne.arrayBuffer)),{length:Ne.length,arrayBuffer:Ne.arrayBuffer}},_i.deserialize=function(Ne){var Ge=Object.create(this.prototype);return Ge.arrayBuffer=Ne.arrayBuffer,Ge.length=Ne.length,Ge.capacity=Ne.arrayBuffer.byteLength/Ge.bytesPerElement,Ge._refreshViews(),Ge},_i.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},_i.prototype.clear=function(){this.length=0},_i.prototype.resize=function(Ne){this.reserve(Ne),this.length=Ne},_i.prototype.reserve=function(Ne){if(Ne>this.capacity){this.capacity=Math.max(Ne,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var Ge=this.uint8;this._refreshViews(),Ge&&this.uint8.set(Ge)}},_i.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var _l=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(Ne,Ge){var Qe=this.length;return this.resize(Qe+1),this.emplace(Qe,Ne,Ge)},e.prototype.emplace=function(Ne,Ge,Qe){var tt=2*Ne;return this.int16[tt+0]=Ge,this.int16[tt+1]=Qe,Ne},e}(_i);_l.prototype.bytesPerElement=4,Fn("StructArrayLayout2i4",_l);var wl=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(Ne,Ge,Qe,tt){var rt=this.length;return this.resize(rt+1),this.emplace(rt,Ne,Ge,Qe,tt)},e.prototype.emplace=function(Ne,Ge,Qe,tt,rt){var nt=4*Ne;return this.int16[nt+0]=Ge,this.int16[nt+1]=Qe,this.int16[nt+2]=tt,this.int16[nt+3]=rt,Ne},e}(_i);wl.prototype.bytesPerElement=8,Fn("StructArrayLayout4i8",wl);var kl=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(Ne,Ge,Qe,tt,rt,nt){var at=this.length;return this.resize(at+1),this.emplace(at,Ne,Ge,Qe,tt,rt,nt)},e.prototype.emplace=function(Ne,Ge,Qe,tt,rt,nt,at){var it=6*Ne;return this.int16[it+0]=Ge,this.int16[it+1]=Qe,this.int16[it+2]=tt,this.int16[it+3]=rt,this.int16[it+4]=nt,this.int16[it+5]=at,Ne},e}(_i);kl.prototype.bytesPerElement=12,Fn("StructArrayLayout2i4i12",kl);var Al=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(Ne,Ge,Qe,tt,rt,nt){var at=this.length;return this.resize(at+1),this.emplace(at,Ne,Ge,Qe,tt,rt,nt)},e.prototype.emplace=function(Ne,Ge,Qe,tt,rt,nt,at){var it=4*Ne,ot=8*Ne;return this.int16[it+0]=Ge,this.int16[it+1]=Qe,this.uint8[ot+4]=tt,this.uint8[ot+5]=rt,this.uint8[ot+6]=nt,this.uint8[ot+7]=at,Ne},e}(_i);Al.prototype.bytesPerElement=8,Fn("StructArrayLayout2i4ub8",Al);var Sl=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt){var ht=this.length;return this.resize(ht+1),this.emplace(ht,Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt)},e.prototype.emplace=function(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht){var Dt=9*Ne,Ot=18*Ne;return this.uint16[Dt+0]=Ge,this.uint16[Dt+1]=Qe,this.uint16[Dt+2]=tt,this.uint16[Dt+3]=rt,this.uint16[Dt+4]=nt,this.uint16[Dt+5]=at,this.uint16[Dt+6]=it,this.uint16[Dt+7]=ot,this.uint8[Ot+16]=dt,this.uint8[Ot+17]=ht,Ne},e}(_i);Sl.prototype.bytesPerElement=18,Fn("StructArrayLayout8ui2ub18",Sl);var Il=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt){var Ot=this.length;return this.resize(Ot+1),this.emplace(Ot,Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt)},e.prototype.emplace=function(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt,Ot){var Rt=12*Ne;return this.int16[Rt+0]=Ge,this.int16[Rt+1]=Qe,this.int16[Rt+2]=tt,this.int16[Rt+3]=rt,this.uint16[Rt+4]=nt,this.uint16[Rt+5]=at,this.uint16[Rt+6]=it,this.uint16[Rt+7]=ot,this.int16[Rt+8]=dt,this.int16[Rt+9]=ht,this.int16[Rt+10]=Dt,this.int16[Rt+11]=Ot,Ne},e}(_i);Il.prototype.bytesPerElement=24,Fn("StructArrayLayout4i4ui4i24",Il);var Bl=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(Ne,Ge,Qe){var tt=this.length;return this.resize(tt+1),this.emplace(tt,Ne,Ge,Qe)},e.prototype.emplace=function(Ne,Ge,Qe,tt){var rt=3*Ne;return this.float32[rt+0]=Ge,this.float32[rt+1]=Qe,this.float32[rt+2]=tt,Ne},e}(_i);Bl.prototype.bytesPerElement=12,Fn("StructArrayLayout3f12",Bl);var Xl=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(Ne){var Ge=this.length;return this.resize(Ge+1),this.emplace(Ge,Ne)},e.prototype.emplace=function(Ne,Ge){return this.uint32[1*Ne+0]=Ge,Ne},e}(_i);Xl.prototype.bytesPerElement=4,Fn("StructArrayLayout1ul4",Xl);var ec=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(Ne,Ge,Qe,tt,rt,nt,at,it,ot){var dt=this.length;return this.resize(dt+1),this.emplace(dt,Ne,Ge,Qe,tt,rt,nt,at,it,ot)},e.prototype.emplace=function(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt){var ht=10*Ne,Dt=5*Ne;return this.int16[ht+0]=Ge,this.int16[ht+1]=Qe,this.int16[ht+2]=tt,this.int16[ht+3]=rt,this.int16[ht+4]=nt,this.int16[ht+5]=at,this.uint32[Dt+3]=it,this.uint16[ht+8]=ot,this.uint16[ht+9]=dt,Ne},e}(_i);ec.prototype.bytesPerElement=20,Fn("StructArrayLayout6i1ul2ui20",ec);var tc=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(Ne,Ge,Qe,tt,rt,nt){var at=this.length;return this.resize(at+1),this.emplace(at,Ne,Ge,Qe,tt,rt,nt)},e.prototype.emplace=function(Ne,Ge,Qe,tt,rt,nt,at){var it=6*Ne;return this.int16[it+0]=Ge,this.int16[it+1]=Qe,this.int16[it+2]=tt,this.int16[it+3]=rt,this.int16[it+4]=nt,this.int16[it+5]=at,Ne},e}(_i);tc.prototype.bytesPerElement=12,Fn("StructArrayLayout2i2i2i12",tc);var rc=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(Ne,Ge,Qe,tt,rt){var nt=this.length;return this.resize(nt+1),this.emplace(nt,Ne,Ge,Qe,tt,rt)},e.prototype.emplace=function(Ne,Ge,Qe,tt,rt,nt){var at=4*Ne,it=8*Ne;return this.float32[at+0]=Ge,this.float32[at+1]=Qe,this.float32[at+2]=tt,this.int16[it+6]=rt,this.int16[it+7]=nt,Ne},e}(_i);rc.prototype.bytesPerElement=16,Fn("StructArrayLayout2f1f2i16",rc);var nc=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(Ne,Ge,Qe,tt){var rt=this.length;return this.resize(rt+1),this.emplace(rt,Ne,Ge,Qe,tt)},e.prototype.emplace=function(Ne,Ge,Qe,tt,rt){var nt=12*Ne,at=3*Ne;return this.uint8[nt+0]=Ge,this.uint8[nt+1]=Qe,this.float32[at+1]=tt,this.float32[at+2]=rt,Ne},e}(_i);nc.prototype.bytesPerElement=12,Fn("StructArrayLayout2ub2f12",nc);var ac=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(Ne,Ge,Qe){var tt=this.length;return this.resize(tt+1),this.emplace(tt,Ne,Ge,Qe)},e.prototype.emplace=function(Ne,Ge,Qe,tt){var rt=3*Ne;return this.uint16[rt+0]=Ge,this.uint16[rt+1]=Qe,this.uint16[rt+2]=tt,Ne},e}(_i);ac.prototype.bytesPerElement=6,Fn("StructArrayLayout3ui6",ac);var ic=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt,er,dr){var mr=this.length;return this.resize(mr+1),this.emplace(mr,Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt,er,dr)},e.prototype.emplace=function(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt,er,dr,mr){var xr=24*Ne,br=12*Ne,Ar=48*Ne;return this.int16[xr+0]=Ge,this.int16[xr+1]=Qe,this.uint16[xr+2]=tt,this.uint16[xr+3]=rt,this.uint32[br+2]=nt,this.uint32[br+3]=at,this.uint32[br+4]=it,this.uint16[xr+10]=ot,this.uint16[xr+11]=dt,this.uint16[xr+12]=ht,this.float32[br+7]=Dt,this.float32[br+8]=Ot,this.uint8[Ar+36]=Rt,this.uint8[Ar+37]=Zt,this.uint8[Ar+38]=er,this.uint32[br+10]=dr,this.int16[xr+22]=mr,Ne},e}(_i);ic.prototype.bytesPerElement=48,Fn("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",ic);var oc=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt,er,dr,mr,xr,br,Ar,en,mn,xn,kn,Cn,En,Pn){var Dn=this.length;return this.resize(Dn+1),this.emplace(Dn,Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt,er,dr,mr,xr,br,Ar,en,mn,xn,kn,Cn,En,Pn)},e.prototype.emplace=function(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt,er,dr,mr,xr,br,Ar,en,mn,xn,kn,Cn,En,Pn,Dn){var In=34*Ne,zn=17*Ne;return this.int16[In+0]=Ge,this.int16[In+1]=Qe,this.int16[In+2]=tt,this.int16[In+3]=rt,this.int16[In+4]=nt,this.int16[In+5]=at,this.int16[In+6]=it,this.int16[In+7]=ot,this.uint16[In+8]=dt,this.uint16[In+9]=ht,this.uint16[In+10]=Dt,this.uint16[In+11]=Ot,this.uint16[In+12]=Rt,this.uint16[In+13]=Zt,this.uint16[In+14]=er,this.uint16[In+15]=dr,this.uint16[In+16]=mr,this.uint16[In+17]=xr,this.uint16[In+18]=br,this.uint16[In+19]=Ar,this.uint16[In+20]=en,this.uint16[In+21]=mn,this.uint16[In+22]=xn,this.uint32[zn+12]=kn,this.float32[zn+13]=Cn,this.float32[zn+14]=En,this.float32[zn+15]=Pn,this.float32[zn+16]=Dn,Ne},e}(_i);oc.prototype.bytesPerElement=68,Fn("StructArrayLayout8i15ui1ul4f68",oc);var sc=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(Ne){var Ge=this.length;return this.resize(Ge+1),this.emplace(Ge,Ne)},e.prototype.emplace=function(Ne,Ge){return this.float32[1*Ne+0]=Ge,Ne},e}(_i);sc.prototype.bytesPerElement=4,Fn("StructArrayLayout1f4",sc);var lc=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(Ne,Ge,Qe){var tt=this.length;return this.resize(tt+1),this.emplace(tt,Ne,Ge,Qe)},e.prototype.emplace=function(Ne,Ge,Qe,tt){var rt=3*Ne;return this.int16[rt+0]=Ge,this.int16[rt+1]=Qe,this.int16[rt+2]=tt,Ne},e}(_i);lc.prototype.bytesPerElement=6,Fn("StructArrayLayout3i6",lc);var cc=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(Ne,Ge,Qe){var tt=this.length;return this.resize(tt+1),this.emplace(tt,Ne,Ge,Qe)},e.prototype.emplace=function(Ne,Ge,Qe,tt){var rt=4*Ne;return this.uint32[2*Ne+0]=Ge,this.uint16[rt+2]=Qe,this.uint16[rt+3]=tt,Ne},e}(_i);cc.prototype.bytesPerElement=8,Fn("StructArrayLayout1ul2ui8",cc);var uc=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(Ne,Ge){var Qe=this.length;return this.resize(Qe+1),this.emplace(Qe,Ne,Ge)},e.prototype.emplace=function(Ne,Ge,Qe){var tt=2*Ne;return this.uint16[tt+0]=Ge,this.uint16[tt+1]=Qe,Ne},e}(_i);uc.prototype.bytesPerElement=4,Fn("StructArrayLayout2ui4",uc);var fc=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},e.prototype.emplaceBack=function(Ne){var Ge=this.length;return this.resize(Ge+1),this.emplace(Ge,Ne)},e.prototype.emplace=function(Ne,Ge){return this.uint16[1*Ne+0]=Ge,Ne},e}(_i);fc.prototype.bytesPerElement=2,Fn("StructArrayLayout1ui2",fc);var pc=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(Ne,Ge){var Qe=this.length;return this.resize(Qe+1),this.emplace(Qe,Ne,Ge)},e.prototype.emplace=function(Ne,Ge,Qe){var tt=2*Ne;return this.float32[tt+0]=Ge,this.float32[tt+1]=Qe,Ne},e}(_i);pc.prototype.bytesPerElement=8,Fn("StructArrayLayout2f8",pc);var dc=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},e.prototype.emplaceBack=function(Ne,Ge,Qe,tt){var rt=this.length;return this.resize(rt+1),this.emplace(rt,Ne,Ge,Qe,tt)},e.prototype.emplace=function(Ne,Ge,Qe,tt,rt){var nt=4*Ne;return this.float32[nt+0]=Ge,this.float32[nt+1]=Qe,this.float32[nt+2]=tt,this.float32[nt+3]=rt,Ne},e}(_i);dc.prototype.bytesPerElement=16,Fn("StructArrayLayout4f16",dc);var hc=function(Ne){function e(){Ne.apply(this,arguments)}Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e;var Ge={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return Ge.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},Ge.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},Ge.x1.get=function(){return this._structArray.int16[this._pos2+2]},Ge.y1.get=function(){return this._structArray.int16[this._pos2+3]},Ge.x2.get=function(){return this._structArray.int16[this._pos2+4]},Ge.y2.get=function(){return this._structArray.int16[this._pos2+5]},Ge.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},Ge.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},Ge.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},Ge.anchorPoint.get=function(){return new Qe(this.anchorPointX,this.anchorPointY)},Object.defineProperties(e.prototype,Ge),e}(wi);hc.prototype.size=20;var gc=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.get=function(Ne){return new hc(this,Ne)},e}(ec);Fn("CollisionBoxArray",gc);var mc=function(Ne){function e(){Ne.apply(this,arguments)}Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e;var Ge={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return Ge.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},Ge.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},Ge.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},Ge.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},Ge.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},Ge.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},Ge.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},Ge.segment.get=function(){return this._structArray.uint16[this._pos2+10]},Ge.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},Ge.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},Ge.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},Ge.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},Ge.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},Ge.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},Ge.placedOrientation.set=function(Ne){this._structArray.uint8[this._pos1+37]=Ne},Ge.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},Ge.hidden.set=function(Ne){this._structArray.uint8[this._pos1+38]=Ne},Ge.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},Ge.crossTileID.set=function(Ne){this._structArray.uint32[this._pos4+10]=Ne},Ge.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(e.prototype,Ge),e}(wi);mc.prototype.size=48;var vc=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.get=function(Ne){return new mc(this,Ne)},e}(ic);Fn("PlacedSymbolArray",vc);var yc=function(Ne){function e(){Ne.apply(this,arguments)}Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e;var Ge={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return Ge.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},Ge.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},Ge.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},Ge.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},Ge.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},Ge.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},Ge.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},Ge.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},Ge.key.get=function(){return this._structArray.uint16[this._pos2+8]},Ge.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},Ge.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},Ge.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},Ge.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},Ge.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},Ge.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},Ge.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},Ge.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},Ge.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},Ge.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},Ge.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},Ge.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},Ge.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},Ge.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},Ge.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},Ge.crossTileID.set=function(Ne){this._structArray.uint32[this._pos4+12]=Ne},Ge.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},Ge.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},Ge.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},Ge.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(e.prototype,Ge),e}(wi);yc.prototype.size=68;var xc=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.get=function(Ne){return new yc(this,Ne)},e}(oc);Fn("SymbolInstanceArray",xc);var bc=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getoffsetX=function(Ne){return this.float32[1*Ne+0]},e}(sc);Fn("GlyphOffsetArray",bc);var _c=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getx=function(Ne){return this.int16[3*Ne+0]},e.prototype.gety=function(Ne){return this.int16[3*Ne+1]},e.prototype.gettileUnitDistanceFromAnchor=function(Ne){return this.int16[3*Ne+2]},e}(lc);Fn("SymbolLineVertexArray",_c);var wc=function(Ne){function e(){Ne.apply(this,arguments)}Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e;var Ge={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return Ge.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},Ge.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},Ge.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(e.prototype,Ge),e}(wi);wc.prototype.size=8;var Tc=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.get=function(Ne){return new wc(this,Ne)},e}(cc);Fn("FeatureIndexArray",Tc);var kc=Ai([{name:"a_pos",components:2,type:"Int16"}],4).members,ia=function(Ne){void 0===Ne&&(Ne=[]),this.segments=Ne};function aa(Ne,Ge){return 256*(Ne=u(Math.floor(Ne),0,255))+u(Math.floor(Ge),0,255)}ia.prototype.prepareSegment=function(Ne,Ge,Qe,tt){var rt=this.segments[this.segments.length-1];return Ne>ia.MAX_VERTEX_ARRAY_LENGTH&&w("Max vertices per segment is "+ia.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+Ne),(!rt||rt.vertexLength+Ne>ia.MAX_VERTEX_ARRAY_LENGTH||rt.sortKey!==tt)&&(rt={vertexOffset:Ge.length,primitiveOffset:Qe.length,vertexLength:0,primitiveLength:0},void 0!==tt&&(rt.sortKey=tt),this.segments.push(rt)),rt},ia.prototype.get=function(){return this.segments},ia.prototype.destroy=function(){for(var Ne=0,Ge=this.segments;Ne<Ge.length;Ne+=1){var Qe=Ge[Ne];for(var tt in Qe.vaos)Qe.vaos[tt].destroy()}},ia.simpleSegment=function(Ne,Ge,Qe,tt){return new ia([{vertexOffset:Ne,primitiveOffset:Ge,vertexLength:Qe,primitiveLength:tt,vaos:{},sortKey:0}])},ia.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Fn("SegmentVector",ia);var Ac=Ai([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint8"},{name:"a_pixel_ratio_to",components:1,type:"Uint8"}]),Mc=e((function(Ne){Ne.exports=function(Ne,Ge){var Qe,tt,rt,nt,at,it,ot,dt;for(tt=Ne.length-(Qe=3&Ne.length),rt=Ge,at=3432918353,it=461845907,dt=0;dt<tt;)ot=255&Ne.charCodeAt(dt)|(255&Ne.charCodeAt(++dt))<<8|(255&Ne.charCodeAt(++dt))<<16|(255&Ne.charCodeAt(++dt))<<24,++dt,rt=27492+(65535&(nt=5*(65535&(rt=(rt^=ot=(65535&(ot=(ot=(65535&ot)*at+(((ot>>>16)*at&65535)<<16)&4294967295)<<15|ot>>>17))*it+(((ot>>>16)*it&65535)<<16)&4294967295)<<13|rt>>>19))+((5*(rt>>>16)&65535)<<16)&4294967295))+((58964+(nt>>>16)&65535)<<16);switch(ot=0,Qe){case 3:ot^=(255&Ne.charCodeAt(dt+2))<<16;case 2:ot^=(255&Ne.charCodeAt(dt+1))<<8;case 1:rt^=ot=(65535&(ot=(ot=(65535&(ot^=255&Ne.charCodeAt(dt)))*at+(((ot>>>16)*at&65535)<<16)&4294967295)<<15|ot>>>17))*it+(((ot>>>16)*it&65535)<<16)&4294967295}return rt^=Ne.length,rt=2246822507*(65535&(rt^=rt>>>16))+((2246822507*(rt>>>16)&65535)<<16)&4294967295,rt=3266489909*(65535&(rt^=rt>>>13))+((3266489909*(rt>>>16)&65535)<<16)&4294967295,(rt^=rt>>>16)>>>0}})),Sc=e((function(Ne){Ne.exports=function(Ne,Ge){for(var Qe,tt=Ne.length,rt=Ge^tt,nt=0;tt>=4;)Qe=1540483477*(65535&(Qe=255&Ne.charCodeAt(nt)|(255&Ne.charCodeAt(++nt))<<8|(255&Ne.charCodeAt(++nt))<<16|(255&Ne.charCodeAt(++nt))<<24))+((1540483477*(Qe>>>16)&65535)<<16),rt=1540483477*(65535&rt)+((1540483477*(rt>>>16)&65535)<<16)^(Qe=1540483477*(65535&(Qe^=Qe>>>24))+((1540483477*(Qe>>>16)&65535)<<16)),tt-=4,++nt;switch(tt){case 3:rt^=(255&Ne.charCodeAt(nt+2))<<16;case 2:rt^=(255&Ne.charCodeAt(nt+1))<<8;case 1:rt=1540483477*(65535&(rt^=255&Ne.charCodeAt(nt)))+((1540483477*(rt>>>16)&65535)<<16)}return rt=1540483477*(65535&(rt^=rt>>>13))+((1540483477*(rt>>>16)&65535)<<16),(rt^=rt>>>15)>>>0}})),Cc=Mc,Ec=Sc;Cc.murmur3=Mc,Cc.murmur2=Ec;var ca=function(){this.ids=[],this.positions=[],this.indexed=!1};ca.prototype.add=function(Ne,Ge,Qe,tt){this.ids.push(fa(Ne)),this.positions.push(Ge,Qe,tt)},ca.prototype.getPositions=function(Ne){for(var Ge=fa(Ne),Qe=0,tt=this.ids.length-1;Qe<tt;){var rt=Qe+tt>>1;this.ids[rt]>=Ge?tt=rt:Qe=rt+1}for(var nt=[];this.ids[Qe]===Ge;)nt.push({index:this.positions[3*Qe],start:this.positions[3*Qe+1],end:this.positions[3*Qe+2]}),Qe++;return nt},ca.serialize=function(Ne,Ge){var Qe=new Float64Array(Ne.ids),tt=new Uint32Array(Ne.positions);return function t(Ne,Ge,Qe,tt){for(;Qe<tt;){for(var rt=Ne[Qe+tt>>1],nt=Qe-1,at=tt+1;;){do{nt++}while(Ne[nt]<rt);do{at--}while(Ne[at]>rt);if(nt>=at)break;ya(Ne,nt,at),ya(Ge,3*nt,3*at),ya(Ge,3*nt+1,3*at+1),ya(Ge,3*nt+2,3*at+2)}at-Qe<tt-at?(t(Ne,Ge,Qe,at),Qe=at+1):(t(Ne,Ge,at+1,tt),tt=at)}}(Qe,tt,0,Qe.length-1),Ge&&Ge.push(Qe.buffer,tt.buffer),{ids:Qe,positions:tt}},ca.deserialize=function(Ne){var Ge=new ca;return Ge.ids=Ne.ids,Ge.positions=Ne.positions,Ge.indexed=!0,Ge};var Lc=Math.pow(2,53)-1;function fa(Ne){var Ge=+Ne;return!isNaN(Ge)&&Ge<=Lc?Ge:Cc(String(Ne))}function ya(Ne,Ge,Qe){var tt=Ne[Ge];Ne[Ge]=Ne[Qe],Ne[Qe]=tt}Fn("FeaturePositionMap",ca);var da=function(Ne,Ge){this.gl=Ne.gl,this.location=Ge},Pc=function(Ne){function e(Ge,Qe){Ne.call(this,Ge,Qe),this.current=0}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.set=function(Ne){this.current!==Ne&&(this.current=Ne,this.gl.uniform1i(this.location,Ne))},e}(da),Dc=function(Ne){function e(Ge,Qe){Ne.call(this,Ge,Qe),this.current=0}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.set=function(Ne){this.current!==Ne&&(this.current=Ne,this.gl.uniform1f(this.location,Ne))},e}(da),Ic=function(Ne){function e(Ge,Qe){Ne.call(this,Ge,Qe),this.current=[0,0]}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.set=function(Ne){Ne[0]===this.current[0]&&Ne[1]===this.current[1]||(this.current=Ne,this.gl.uniform2f(this.location,Ne[0],Ne[1]))},e}(da),Oc=function(Ne){function e(Ge,Qe){Ne.call(this,Ge,Qe),this.current=[0,0,0]}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.set=function(Ne){Ne[0]===this.current[0]&&Ne[1]===this.current[1]&&Ne[2]===this.current[2]||(this.current=Ne,this.gl.uniform3f(this.location,Ne[0],Ne[1],Ne[2]))},e}(da),zc=function(Ne){function e(Ge,Qe){Ne.call(this,Ge,Qe),this.current=[0,0,0,0]}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.set=function(Ne){Ne[0]===this.current[0]&&Ne[1]===this.current[1]&&Ne[2]===this.current[2]&&Ne[3]===this.current[3]||(this.current=Ne,this.gl.uniform4f(this.location,Ne[0],Ne[1],Ne[2],Ne[3]))},e}(da),Rc=function(Ne){function e(Ge,Qe){Ne.call(this,Ge,Qe),this.current=$t.transparent}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.set=function(Ne){Ne.r===this.current.r&&Ne.g===this.current.g&&Ne.b===this.current.b&&Ne.a===this.current.a||(this.current=Ne,this.gl.uniform4f(this.location,Ne.r,Ne.g,Ne.b,Ne.a))},e}(da),Bc=new Float32Array(16),Fc=function(Ne){function e(Ge,Qe){Ne.call(this,Ge,Qe),this.current=Bc}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.set=function(Ne){if(Ne[12]!==this.current[12]||Ne[0]!==this.current[0])return this.current=Ne,void this.gl.uniformMatrix4fv(this.location,!1,Ne);for(var Ge=1;Ge<16;Ge++)if(Ne[Ge]!==this.current[Ge]){this.current=Ne,this.gl.uniformMatrix4fv(this.location,!1,Ne);break}},e}(da);function Sa(Ne){return[aa(255*Ne.r,255*Ne.g),aa(255*Ne.b,255*Ne.a)]}var ka=function(Ne,Ge,Qe){this.value=Ne,this.uniformNames=Ge.map((function(Ne){return"u_"+Ne})),this.type=Qe};ka.prototype.setUniform=function(Ne,Ge,Qe){Ne.set(Qe.constantOr(this.value))},ka.prototype.getBinding=function(Ne,Ge,Qe){return"color"===this.type?new Rc(Ne,Ge):new Dc(Ne,Ge)};var Ia=function(Ne,Ge){this.uniformNames=Ge.map((function(Ne){return"u_"+Ne})),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Ia.prototype.setConstantPatternPositions=function(Ne,Ge){this.pixelRatioFrom=Ge.pixelRatio,this.pixelRatioTo=Ne.pixelRatio,this.patternFrom=Ge.tlbr,this.patternTo=Ne.tlbr},Ia.prototype.setUniform=function(Ne,Ge,Qe,tt){var rt="u_pattern_to"===tt?this.patternTo:"u_pattern_from"===tt?this.patternFrom:"u_pixel_ratio_to"===tt?this.pixelRatioTo:"u_pixel_ratio_from"===tt?this.pixelRatioFrom:null;rt&&Ne.set(rt)},Ia.prototype.getBinding=function(Ne,Ge,Qe){return"u_pattern"===Qe.substr(0,9)?new zc(Ne,Ge):new Dc(Ne,Ge)};var za=function(Ne,Ge,Qe,tt){this.expression=Ne,this.type=Qe,this.maxValue=0,this.paintVertexAttributes=Ge.map((function(Ne){return{name:"a_"+Ne,type:"Float32",components:"color"===Qe?2:1,offset:0}})),this.paintVertexArray=new tt};za.prototype.populatePaintArray=function(Ne,Ge,Qe,tt,rt){var nt=this.paintVertexArray.length,at=this.expression.evaluate(new ii(0),Ge,{},tt,[],rt);this.paintVertexArray.resize(Ne),this._setPaintValue(nt,Ne,at)},za.prototype.updatePaintArray=function(Ne,Ge,Qe,tt){var rt=this.expression.evaluate({zoom:0},Qe,tt);this._setPaintValue(Ne,Ge,rt)},za.prototype._setPaintValue=function(Ne,Ge,Qe){if("color"===this.type)for(var tt=Sa(Qe),rt=Ne;rt<Ge;rt++)this.paintVertexArray.emplace(rt,tt[0],tt[1]);else{for(var nt=Ne;nt<Ge;nt++)this.paintVertexArray.emplace(nt,Qe);this.maxValue=Math.max(this.maxValue,Math.abs(Qe))}},za.prototype.upload=function(Ne){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=Ne.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},za.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var Ca=function(Ne,Ge,Qe,tt,rt,nt){this.expression=Ne,this.uniformNames=Ge.map((function(Ne){return"u_"+Ne+"_t"})),this.type=Qe,this.useIntegerZoom=tt,this.zoom=rt,this.maxValue=0,this.paintVertexAttributes=Ge.map((function(Ne){return{name:"a_"+Ne,type:"Float32",components:"color"===Qe?4:2,offset:0}})),this.paintVertexArray=new nt};Ca.prototype.populatePaintArray=function(Ne,Ge,Qe,tt,rt){var nt=this.expression.evaluate(new ii(this.zoom),Ge,{},tt,[],rt),at=this.expression.evaluate(new ii(this.zoom+1),Ge,{},tt,[],rt),it=this.paintVertexArray.length;this.paintVertexArray.resize(Ne),this._setPaintValue(it,Ne,nt,at)},Ca.prototype.updatePaintArray=function(Ne,Ge,Qe,tt){var rt=this.expression.evaluate({zoom:this.zoom},Qe,tt),nt=this.expression.evaluate({zoom:this.zoom+1},Qe,tt);this._setPaintValue(Ne,Ge,rt,nt)},Ca.prototype._setPaintValue=function(Ne,Ge,Qe,tt){if("color"===this.type)for(var rt=Sa(Qe),nt=Sa(tt),at=Ne;at<Ge;at++)this.paintVertexArray.emplace(at,rt[0],rt[1],nt[0],nt[1]);else{for(var it=Ne;it<Ge;it++)this.paintVertexArray.emplace(it,Qe,tt);this.maxValue=Math.max(this.maxValue,Math.abs(Qe),Math.abs(tt))}},Ca.prototype.upload=function(Ne){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=Ne.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Ca.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},Ca.prototype.setUniform=function(Ne,Ge){var Qe=this.useIntegerZoom?Math.floor(Ge.zoom):Ge.zoom,tt=u(this.expression.interpolationFactor(Qe,this.zoom,this.zoom+1),0,1);Ne.set(tt)},Ca.prototype.getBinding=function(Ne,Ge,Qe){return new Dc(Ne,Ge)};var Ma=function(Ne,Ge,Qe,tt,rt,nt){this.expression=Ne,this.type=Ge,this.useIntegerZoom=Qe,this.zoom=tt,this.layerId=nt,this.zoomInPaintVertexArray=new rt,this.zoomOutPaintVertexArray=new rt};Ma.prototype.populatePaintArray=function(Ne,Ge,Qe){var tt=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(Ne),this.zoomOutPaintVertexArray.resize(Ne),this._setPaintValues(tt,Ne,Ge.patterns&&Ge.patterns[this.layerId],Qe)},Ma.prototype.updatePaintArray=function(Ne,Ge,Qe,tt,rt){this._setPaintValues(Ne,Ge,Qe.patterns&&Qe.patterns[this.layerId],rt)},Ma.prototype._setPaintValues=function(Ne,Ge,Qe,tt){if(tt&&Qe){var rt=tt[Qe.min],nt=tt[Qe.mid],at=tt[Qe.max];if(rt&&nt&&at)for(var it=Ne;it<Ge;it++)this.zoomInPaintVertexArray.emplace(it,nt.tl[0],nt.tl[1],nt.br[0],nt.br[1],rt.tl[0],rt.tl[1],rt.br[0],rt.br[1],nt.pixelRatio,rt.pixelRatio),this.zoomOutPaintVertexArray.emplace(it,nt.tl[0],nt.tl[1],nt.br[0],nt.br[1],at.tl[0],at.tl[1],at.br[0],at.br[1],nt.pixelRatio,at.pixelRatio)}},Ma.prototype.upload=function(Ne){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=Ne.createVertexBuffer(this.zoomInPaintVertexArray,Ac.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=Ne.createVertexBuffer(this.zoomOutPaintVertexArray,Ac.members,this.expression.isStateDependent))},Ma.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Ea=function(Ne,Ge,Qe,tt){this.binders={},this.layoutAttributes=tt,this._buffers=[];var rt=[];for(var nt in Ne.paint._values)if(Qe(nt)){var at=Ne.paint.get(nt);if(at instanceof ci&&Er(at.property.specification)){var it=Pa(nt,Ne.type),ot=at.value,dt=at.property.specification.type,ht=at.property.useIntegerZoom,Dt=at.property.specification["property-type"],Ot="cross-faded"===Dt||"cross-faded-data-driven"===Dt;if("constant"===ot.kind)this.binders[nt]=Ot?new Ia(ot.value,it):new ka(ot.value,it,dt),rt.push("/u_"+nt);else if("source"===ot.kind||Ot){var Rt=Ba(nt,dt,"source");this.binders[nt]=Ot?new Ma(ot,dt,ht,Ge,Rt,Ne.id):new za(ot,it,dt,Rt),rt.push("/a_"+nt)}else{var Zt=Ba(nt,dt,"composite");this.binders[nt]=new Ca(ot,it,dt,ht,Ge,Zt),rt.push("/z_"+nt)}}}this.cacheKey=rt.sort().join("")};Ea.prototype.getMaxValue=function(Ne){var Ge=this.binders[Ne];return Ge instanceof za||Ge instanceof Ca?Ge.maxValue:0},Ea.prototype.populatePaintArrays=function(Ne,Ge,Qe,tt,rt){for(var nt in this.binders){var at=this.binders[nt];(at instanceof za||at instanceof Ca||at instanceof Ma)&&at.populatePaintArray(Ne,Ge,Qe,tt,rt)}},Ea.prototype.setConstantPatternPositions=function(Ne,Ge){for(var Qe in this.binders){var tt=this.binders[Qe];tt instanceof Ia&&tt.setConstantPatternPositions(Ne,Ge)}},Ea.prototype.updatePaintArrays=function(Ne,Ge,Qe,tt,rt){var nt=!1;for(var at in Ne)for(var it=0,ot=Ge.getPositions(at);it<ot.length;it+=1){var dt=ot[it],ht=Qe.feature(dt.index);for(var Dt in this.binders){var Ot=this.binders[Dt];if((Ot instanceof za||Ot instanceof Ca||Ot instanceof Ma)&&!0===Ot.expression.isStateDependent){var Rt=tt.paint.get(Dt);Ot.expression=Rt.value,Ot.updatePaintArray(dt.start,dt.end,ht,Ne[at],rt),nt=!0}}}return nt},Ea.prototype.defines=function(){var Ne=[];for(var Ge in this.binders){var Qe=this.binders[Ge];(Qe instanceof ka||Qe instanceof Ia)&&Ne.push.apply(Ne,Qe.uniformNames.map((function(Ne){return"#define HAS_UNIFORM_"+Ne})))}return Ne},Ea.prototype.getPaintVertexBuffers=function(){return this._buffers},Ea.prototype.getUniforms=function(Ne,Ge){var Qe=[];for(var tt in this.binders){var rt=this.binders[tt];if(rt instanceof ka||rt instanceof Ia||rt instanceof Ca)for(var nt=0,at=rt.uniformNames;nt<at.length;nt+=1){var it=at[nt];if(Ge[it]){var ot=rt.getBinding(Ne,Ge[it],it);Qe.push({name:it,property:tt,binding:ot})}}}return Qe},Ea.prototype.setUniforms=function(Ne,Ge,Qe,tt){for(var rt=0,nt=Ge;rt<nt.length;rt+=1){var at=nt[rt],it=at.name,ot=at.property;this.binders[ot].setUniform(at.binding,tt,Qe.get(ot),it)}},Ea.prototype.updatePaintBuffers=function(Ne){for(var Ge in this._buffers=[],this.binders){var Qe=this.binders[Ge];if(Ne&&Qe instanceof Ma){var tt=2===Ne.fromScale?Qe.zoomInPaintVertexBuffer:Qe.zoomOutPaintVertexBuffer;tt&&this._buffers.push(tt)}else(Qe instanceof za||Qe instanceof Ca)&&Qe.paintVertexBuffer&&this._buffers.push(Qe.paintVertexBuffer)}},Ea.prototype.upload=function(Ne){for(var Ge in this.binders){var Qe=this.binders[Ge];(Qe instanceof za||Qe instanceof Ca||Qe instanceof Ma)&&Qe.upload(Ne)}this.updatePaintBuffers()},Ea.prototype.destroy=function(){for(var Ne in this.binders){var Ge=this.binders[Ne];(Ge instanceof za||Ge instanceof Ca||Ge instanceof Ma)&&Ge.destroy()}};var Ta=function(Ne,Ge,Qe,tt){void 0===tt&&(tt=function(){return!0}),this.programConfigurations={};for(var rt=0,nt=Ge;rt<nt.length;rt+=1){var at=nt[rt];this.programConfigurations[at.id]=new Ea(at,Qe,tt,Ne)}this.needsUpload=!1,this._featureMap=new ca,this._bufferOffset=0};function Pa(Ne,Ge){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[Ne]||[Ne.replace(Ge+"-","").replace(/-/g,"_")]}function Ba(Ne,Ge,Qe){var tt={color:{source:pc,composite:dc},number:{source:sc,composite:pc}},rt=function(Ne){return{"line-pattern":{source:Sl,composite:Sl},"fill-pattern":{source:Sl,composite:Sl},"fill-extrusion-pattern":{source:Sl,composite:Sl}}[Ne]}(Ne);return rt&&rt[Qe]||tt[Ge][Qe]}Ta.prototype.populatePaintArrays=function(Ne,Ge,Qe,tt,rt,nt){for(var at in this.programConfigurations)this.programConfigurations[at].populatePaintArrays(Ne,Ge,tt,rt,nt);void 0!==Ge.id&&this._featureMap.add(Ge.id,Qe,this._bufferOffset,Ne),this._bufferOffset=Ne,this.needsUpload=!0},Ta.prototype.updatePaintArrays=function(Ne,Ge,Qe,tt){for(var rt=0,nt=Qe;rt<nt.length;rt+=1){var at=nt[rt];this.needsUpload=this.programConfigurations[at.id].updatePaintArrays(Ne,this._featureMap,Ge,at,tt)||this.needsUpload}},Ta.prototype.get=function(Ne){return this.programConfigurations[Ne]},Ta.prototype.upload=function(Ne){if(this.needsUpload){for(var Ge in this.programConfigurations)this.programConfigurations[Ge].upload(Ne);this.needsUpload=!1}},Ta.prototype.destroy=function(){for(var Ne in this.programConfigurations)this.programConfigurations[Ne].destroy()},Fn("ConstantBinder",ka),Fn("CrossFadedConstantBinder",Ia),Fn("SourceExpressionBinder",za),Fn("CrossFadedCompositeBinder",Ma),Fn("CompositeExpressionBinder",Ca),Fn("ProgramConfiguration",Ea,{omit:["_buffers"]}),Fn("ProgramConfigurationSet",Ta);var Nc={min:-1*Math.pow(2,14),max:Math.pow(2,14)-1};function Fa(Ne){for(var Ge=8192/Ne.extent,Qe=Ne.loadGeometry(),tt=0;tt<Qe.length;tt++)for(var rt=Qe[tt],nt=0;nt<rt.length;nt++){var at=rt[nt];at.x=Math.round(at.x*Ge),at.y=Math.round(at.y*Ge),(at.x<Nc.min||at.x>Nc.max||at.y<Nc.min||at.y>Nc.max)&&(w("Geometry exceeds allowed extent, reduce your vector tile buffer size"),at.x=u(at.x,Nc.min,Nc.max),at.y=u(at.y,Nc.min,Nc.max))}return Qe}function Da(Ne,Ge,Qe,tt,rt){Ne.emplaceBack(2*Ge+(tt+1)/2,2*Qe+(rt+1)/2)}var La=function(Ne){this.zoom=Ne.zoom,this.overscaling=Ne.overscaling,this.layers=Ne.layers,this.layerIds=this.layers.map((function(Ne){return Ne.id})),this.index=Ne.index,this.hasPattern=!1,this.layoutVertexArray=new _l,this.indexArray=new ac,this.segments=new ia,this.programConfigurations=new Ta(kc,Ne.layers,Ne.zoom),this.stateDependentLayerIds=this.layers.filter((function(Ne){return Ne.isStateDependent()})).map((function(Ne){return Ne.id}))};function Ra(Ne,Ge){for(var Qe=0;Qe<Ne.length;Qe++)if(Xa(Ge,Ne[Qe]))return!0;for(var tt=0;tt<Ge.length;tt++)if(Xa(Ne,Ge[tt]))return!0;return!!qa(Ne,Ge)}function Oa(Ne,Ge,Qe){return!!Xa(Ne,Ge)||!!Ka(Ge,Ne,Qe)}function Ua(Ne,Ge){if(1===Ne.length)return Za(Ge,Ne[0]);for(var Qe=0;Qe<Ge.length;Qe++)for(var tt=Ge[Qe],rt=0;rt<tt.length;rt++)if(Xa(Ne,tt[rt]))return!0;for(var nt=0;nt<Ne.length;nt++)if(Za(Ge,Ne[nt]))return!0;for(var at=0;at<Ge.length;at++)if(qa(Ne,Ge[at]))return!0;return!1}function ja(Ne,Ge,Qe){if(Ne.length>1){if(qa(Ne,Ge))return!0;for(var tt=0;tt<Ge.length;tt++)if(Ka(Ge[tt],Ne,Qe))return!0}for(var rt=0;rt<Ne.length;rt++)if(Ka(Ne[rt],Ge,Qe))return!0;return!1}function qa(Ne,Ge){if(0===Ne.length||0===Ge.length)return!1;for(var Qe=0;Qe<Ne.length-1;Qe++)for(var tt=Ne[Qe],rt=Ne[Qe+1],nt=0;nt<Ge.length-1;nt++)if(Na(tt,rt,Ge[nt],Ge[nt+1]))return!0;return!1}function Na(Ne,Ge,Qe,tt){return _(Ne,Qe,tt)!==_(Ge,Qe,tt)&&_(Ne,Ge,Qe)!==_(Ne,Ge,tt)}function Ka(Ne,Ge,Qe){var tt=Qe*Qe;if(1===Ge.length)return Ne.distSqr(Ge[0])<tt;for(var rt=1;rt<Ge.length;rt++)if(Ga(Ne,Ge[rt-1],Ge[rt])<tt)return!0;return!1}function Ga(Ne,Ge,Qe){var tt=Ge.distSqr(Qe);if(0===tt)return Ne.distSqr(Ge);var rt=((Ne.x-Ge.x)*(Qe.x-Ge.x)+(Ne.y-Ge.y)*(Qe.y-Ge.y))/tt;return Ne.distSqr(rt<0?Ge:rt>1?Qe:Qe.sub(Ge)._mult(rt)._add(Ge))}function Za(Ne,Ge){for(var Qe,tt,rt,nt=!1,at=0;at<Ne.length;at++)for(var it=0,ot=(Qe=Ne[at]).length-1;it<Qe.length;ot=it++)(tt=Qe[it]).y>Ge.y!=(rt=Qe[ot]).y>Ge.y&&Ge.x<(rt.x-tt.x)*(Ge.y-tt.y)/(rt.y-tt.y)+tt.x&&(nt=!nt);return nt}function Xa(Ne,Ge){for(var Qe=!1,tt=0,rt=Ne.length-1;tt<Ne.length;rt=tt++){var nt=Ne[tt],at=Ne[rt];nt.y>Ge.y!=at.y>Ge.y&&Ge.x<(at.x-nt.x)*(Ge.y-nt.y)/(at.y-nt.y)+nt.x&&(Qe=!Qe)}return Qe}function Ja(Ne,Ge,Qe){var tt=Qe[0],rt=Qe[2];if(Ne.x<tt.x&&Ge.x<tt.x||Ne.x>rt.x&&Ge.x>rt.x||Ne.y<tt.y&&Ge.y<tt.y||Ne.y>rt.y&&Ge.y>rt.y)return!1;var nt=_(Ne,Ge,Qe[0]);return nt!==_(Ne,Ge,Qe[1])||nt!==_(Ne,Ge,Qe[2])||nt!==_(Ne,Ge,Qe[3])}function Ha(Ne,Ge,Qe){var tt=Ge.paint.get(Ne).value;return"constant"===tt.kind?tt.value:Qe.programConfigurations.get(Ge.id).getMaxValue(Ne)}function Ya(Ne){return Math.sqrt(Ne[0]*Ne[0]+Ne[1]*Ne[1])}function $a(Ne,Ge,tt,rt,nt){if(!Ge[0]&&!Ge[1])return Ne;var at=Qe.convert(Ge)._mult(nt);"viewport"===tt&&at._rotate(-rt);for(var it=[],ot=0;ot<Ne.length;ot++)it.push(Ne[ot].sub(at));return it}La.prototype.populate=function(Ne,Ge,Qe){var tt=this.layers[0],rt=[],nt=null;"circle"===tt.type&&(nt=tt.layout.get("circle-sort-key"));for(var at=0,it=Ne;at<it.length;at+=1){var ot=it[at],dt=ot.feature,ht=ot.id,Dt=ot.index,Ot=ot.sourceLayerIndex,Rt=this.layers[0]._featureFilter.needGeometry,Zt={type:dt.type,id:ht,properties:dt.properties,geometry:Rt?Fa(dt):[]};if(this.layers[0]._featureFilter.filter(new ii(this.zoom),Zt,Qe)){Rt||(Zt.geometry=Fa(dt));var er=nt?nt.evaluate(Zt,{},Qe):void 0;rt.push({id:ht,properties:dt.properties,type:dt.type,sourceLayerIndex:Ot,index:Dt,geometry:Zt.geometry,patterns:{},sortKey:er})}}nt&&rt.sort((function(Ne,Ge){return Ne.sortKey-Ge.sortKey}));for(var dr=0,mr=rt;dr<mr.length;dr+=1){var xr=mr[dr],br=xr.geometry,Ar=xr.index,en=xr.sourceLayerIndex,mn=Ne[Ar].feature;this.addFeature(xr,br,Ar,Qe),Ge.featureIndex.insert(mn,br,Ar,en,this.index)}},La.prototype.update=function(Ne,Ge,Qe){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(Ne,Ge,this.stateDependentLayers,Qe)},La.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},La.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},La.prototype.upload=function(Ne){this.uploaded||(this.layoutVertexBuffer=Ne.createVertexBuffer(this.layoutVertexArray,kc),this.indexBuffer=Ne.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(Ne),this.uploaded=!0},La.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},La.prototype.addFeature=function(Ne,Ge,Qe,tt){for(var rt=0,nt=Ge;rt<nt.length;rt+=1)for(var at=0,it=nt[rt];at<it.length;at+=1){var ot=it[at],dt=ot.x,ht=ot.y;if(!(dt<0||dt>=8192||ht<0||ht>=8192)){var Dt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,Ne.sortKey),Ot=Dt.vertexLength;Da(this.layoutVertexArray,dt,ht,-1,-1),Da(this.layoutVertexArray,dt,ht,1,-1),Da(this.layoutVertexArray,dt,ht,1,1),Da(this.layoutVertexArray,dt,ht,-1,1),this.indexArray.emplaceBack(Ot,Ot+1,Ot+2),this.indexArray.emplaceBack(Ot,Ot+3,Ot+2),Dt.vertexLength+=4,Dt.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,Ne,Qe,{},tt)},Fn("CircleBucket",La,{omit:["layers"]});var jc=new gi({"circle-sort-key":new yi(pa.layout_circle["circle-sort-key"])}),Vc={paint:new gi({"circle-radius":new yi(pa.paint_circle["circle-radius"]),"circle-color":new yi(pa.paint_circle["circle-color"]),"circle-blur":new yi(pa.paint_circle["circle-blur"]),"circle-opacity":new yi(pa.paint_circle["circle-opacity"]),"circle-translate":new fi(pa.paint_circle["circle-translate"]),"circle-translate-anchor":new fi(pa.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new fi(pa.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new fi(pa.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new yi(pa.paint_circle["circle-stroke-width"]),"circle-stroke-color":new yi(pa.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new yi(pa.paint_circle["circle-stroke-opacity"])}),layout:jc},Uc="undefined"!=typeof Float32Array?Float32Array:Array;function eo(Ne){return Ne[0]=1,Ne[1]=0,Ne[2]=0,Ne[3]=0,Ne[4]=0,Ne[5]=1,Ne[6]=0,Ne[7]=0,Ne[8]=0,Ne[9]=0,Ne[10]=1,Ne[11]=0,Ne[12]=0,Ne[13]=0,Ne[14]=0,Ne[15]=1,Ne}function ro(Ne,Ge,Qe){var tt=Ge[0],rt=Ge[1],nt=Ge[2],at=Ge[3],it=Ge[4],ot=Ge[5],dt=Ge[6],ht=Ge[7],Dt=Ge[8],Ot=Ge[9],Rt=Ge[10],Zt=Ge[11],er=Ge[12],dr=Ge[13],mr=Ge[14],xr=Ge[15],br=Qe[0],Ar=Qe[1],en=Qe[2],mn=Qe[3];return Ne[0]=br*tt+Ar*it+en*Dt+mn*er,Ne[1]=br*rt+Ar*ot+en*Ot+mn*dr,Ne[2]=br*nt+Ar*dt+en*Rt+mn*mr,Ne[3]=br*at+Ar*ht+en*Zt+mn*xr,Ne[4]=(br=Qe[4])*tt+(Ar=Qe[5])*it+(en=Qe[6])*Dt+(mn=Qe[7])*er,Ne[5]=br*rt+Ar*ot+en*Ot+mn*dr,Ne[6]=br*nt+Ar*dt+en*Rt+mn*mr,Ne[7]=br*at+Ar*ht+en*Zt+mn*xr,Ne[8]=(br=Qe[8])*tt+(Ar=Qe[9])*it+(en=Qe[10])*Dt+(mn=Qe[11])*er,Ne[9]=br*rt+Ar*ot+en*Ot+mn*dr,Ne[10]=br*nt+Ar*dt+en*Rt+mn*mr,Ne[11]=br*at+Ar*ht+en*Zt+mn*xr,Ne[12]=(br=Qe[12])*tt+(Ar=Qe[13])*it+(en=Qe[14])*Dt+(mn=Qe[15])*er,Ne[13]=br*rt+Ar*ot+en*Ot+mn*dr,Ne[14]=br*nt+Ar*dt+en*Rt+mn*mr,Ne[15]=br*at+Ar*ht+en*Zt+mn*xr,Ne}Math.hypot||(Math.hypot=function(){for(var Ne=arguments,Ge=0,Qe=arguments.length;Qe--;)Ge+=Ne[Qe]*Ne[Qe];return Math.sqrt(Ge)});var Hc,qc=ro;function ao(Ne,Ge,Qe){var tt=Ge[0],rt=Ge[1],nt=Ge[2],at=Ge[3];return Ne[0]=Qe[0]*tt+Qe[4]*rt+Qe[8]*nt+Qe[12]*at,Ne[1]=Qe[1]*tt+Qe[5]*rt+Qe[9]*nt+Qe[13]*at,Ne[2]=Qe[2]*tt+Qe[6]*rt+Qe[10]*nt+Qe[14]*at,Ne[3]=Qe[3]*tt+Qe[7]*rt+Qe[11]*nt+Qe[15]*at,Ne}Hc=new Uc(3),Uc!=Float32Array&&(Hc[0]=0,Hc[1]=0,Hc[2]=0),function(){var Ne=new Uc(4);Uc!=Float32Array&&(Ne[0]=0,Ne[1]=0,Ne[2]=0,Ne[3]=0)}();var Gc=(function(){var Ne=new Uc(2);Uc!=Float32Array&&(Ne[0]=0,Ne[1]=0)}(),function(Ne){function e(Ge){Ne.call(this,Ge,Vc)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.createBucket=function(Ne){return new La(Ne)},e.prototype.queryRadius=function(Ne){var Ge=Ne;return Ha("circle-radius",this,Ge)+Ha("circle-stroke-width",this,Ge)+Ya(this.paint.get("circle-translate"))},e.prototype.queryIntersectsFeature=function(Ne,Ge,Qe,tt,rt,nt,at,it){for(var ot=$a(Ne,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),nt.angle,at),dt=this.paint.get("circle-radius").evaluate(Ge,Qe)+this.paint.get("circle-stroke-width").evaluate(Ge,Qe),ht="map"===this.paint.get("circle-pitch-alignment"),Dt=ht?ot:function(Ne,Ge){return Ne.map((function(Ne){return so(Ne,Ge)}))}(ot,it),Ot=ht?dt*at:dt,Rt=0,Zt=tt;Rt<Zt.length;Rt+=1)for(var er=0,dr=Zt[Rt];er<dr.length;er+=1){var mr=dr[er],xr=ht?mr:so(mr,it),br=Ot,Ar=ao([],[mr.x,mr.y,0,1],it);if("viewport"===this.paint.get("circle-pitch-scale")&&"map"===this.paint.get("circle-pitch-alignment")?br*=Ar[3]/nt.cameraToCenterDistance:"map"===this.paint.get("circle-pitch-scale")&&"viewport"===this.paint.get("circle-pitch-alignment")&&(br*=nt.cameraToCenterDistance/Ar[3]),Oa(Dt,xr,br))return!0}return!1},e}(xl));function so(Ne,Ge){var tt=ao([],[Ne.x,Ne.y,0,1],Ge);return new Qe(tt[0]/tt[3],tt[1]/tt[3])}var Yc=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e}(La);function lo(Ne,Ge,Qe,tt){var rt=Ge.width,nt=Ge.height;if(tt){if(tt instanceof Uint8ClampedArray)tt=new Uint8Array(tt.buffer);else if(tt.length!==rt*nt*Qe)throw new RangeError("mismatched image size")}else tt=new Uint8Array(rt*nt*Qe);return Ne.width=rt,Ne.height=nt,Ne.data=tt,Ne}function po(Ne,Ge,Qe){var tt=Ge.width,rt=Ge.height;if(tt!==Ne.width||rt!==Ne.height){var nt=lo({},{width:tt,height:rt},Qe);co(Ne,nt,{x:0,y:0},{x:0,y:0},{width:Math.min(Ne.width,tt),height:Math.min(Ne.height,rt)},Qe),Ne.width=tt,Ne.height=rt,Ne.data=nt.data}}function co(Ne,Ge,Qe,tt,rt,nt){if(0===rt.width||0===rt.height)return Ge;if(rt.width>Ne.width||rt.height>Ne.height||Qe.x>Ne.width-rt.width||Qe.y>Ne.height-rt.height)throw new RangeError("out of range source coordinates for image copy");if(rt.width>Ge.width||rt.height>Ge.height||tt.x>Ge.width-rt.width||tt.y>Ge.height-rt.height)throw new RangeError("out of range destination coordinates for image copy");for(var at=Ne.data,it=Ge.data,ot=0;ot<rt.height;ot++)for(var dt=((Qe.y+ot)*Ne.width+Qe.x)*nt,ht=((tt.y+ot)*Ge.width+tt.x)*nt,Dt=0;Dt<rt.width*nt;Dt++)it[ht+Dt]=at[dt+Dt];return Ge}Fn("HeatmapBucket",Yc,{omit:["layers"]});var ho=function(Ne,Ge){lo(this,Ne,1,Ge)};ho.prototype.resize=function(Ne){po(this,Ne,1)},ho.prototype.clone=function(){return new ho({width:this.width,height:this.height},new Uint8Array(this.data))},ho.copy=function(Ne,Ge,Qe,tt,rt){co(Ne,Ge,Qe,tt,rt,1)};var fo=function(Ne,Ge){lo(this,Ne,4,Ge)};fo.prototype.resize=function(Ne){po(this,Ne,4)},fo.prototype.replace=function(Ne,Ge){Ge?this.data.set(Ne):this.data=Ne instanceof Uint8ClampedArray?new Uint8Array(Ne.buffer):Ne},fo.prototype.clone=function(){return new fo({width:this.width,height:this.height},new Uint8Array(this.data))},fo.copy=function(Ne,Ge,Qe,tt,rt){co(Ne,Ge,Qe,tt,rt,4)},Fn("AlphaImage",ho),Fn("RGBAImage",fo);var Wc={paint:new gi({"heatmap-radius":new yi(pa.paint_heatmap["heatmap-radius"]),"heatmap-weight":new yi(pa.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new fi(pa.paint_heatmap["heatmap-intensity"]),"heatmap-color":new vi(pa.paint_heatmap["heatmap-color"]),"heatmap-opacity":new fi(pa.paint_heatmap["heatmap-opacity"])})};function mo(Ne,Ge){for(var Qe=new Uint8Array(1024),tt={},rt=0,nt=0;rt<256;rt++,nt+=4){tt[Ge]=rt/255;var at=Ne.evaluate(tt);Qe[nt+0]=Math.floor(255*at.r/at.a),Qe[nt+1]=Math.floor(255*at.g/at.a),Qe[nt+2]=Math.floor(255*at.b/at.a),Qe[nt+3]=Math.floor(255*at.a)}return new fo({width:256,height:1},Qe)}var Xc=function(Ne){function e(Ge){Ne.call(this,Ge,Wc),this._updateColorRamp()}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.createBucket=function(Ne){return new Yc(Ne)},e.prototype._handleSpecialPaintPropertyUpdate=function(Ne){"heatmap-color"===Ne&&this._updateColorRamp()},e.prototype._updateColorRamp=function(){this.colorRamp=mo(this._transitionablePaint._values["heatmap-color"].value.expression,"heatmapDensity"),this.colorRampTexture=null},e.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility},e}(xl),Zc={paint:new gi({"hillshade-illumination-direction":new fi(pa.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new fi(pa.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new fi(pa.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new fi(pa.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new fi(pa.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new fi(pa.paint_hillshade["hillshade-accent-color"])})},Jc=function(Ne){function e(Ge){Ne.call(this,Ge,Zc)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.hasOffscreenPass=function(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility},e}(xl),Kc=Ai([{name:"a_pos",components:2,type:"Int16"}],4).members,$c=Ao,Qc=Ao;function Ao(Ne,Ge,Qe){Qe=Qe||2;var tt,rt,nt,at,it,ot,dt,ht=Ge&&Ge.length,Dt=ht?Ge[0]*Qe:Ne.length,Ot=So(Ne,0,Dt,Qe,!0),Rt=[];if(!Ot||Ot.next===Ot.prev)return Rt;if(ht&&(Ot=function(Ne,Ge,Qe,tt){var rt,nt,at,it=[];for(rt=0,nt=Ge.length;rt<nt;rt++)(at=So(Ne,Ge[rt]*tt,rt<nt-1?Ge[rt+1]*tt:Ne.length,tt,!1))===at.next&&(at.steiner=!0),it.push(Fo(at));for(it.sort(To),rt=0;rt<it.length;rt++)Po(it[rt],Qe),Qe=ko(Qe,Qe.next);return Qe}(Ne,Ge,Ot,Qe)),Ne.length>80*Qe){tt=nt=Ne[0],rt=at=Ne[1];for(var Zt=Qe;Zt<Dt;Zt+=Qe)(it=Ne[Zt])<tt&&(tt=it),(ot=Ne[Zt+1])<rt&&(rt=ot),it>nt&&(nt=it),ot>at&&(at=ot);dt=0!==(dt=Math.max(nt-tt,at-rt))?1/dt:0}return Io(Ot,Rt,Qe,tt,rt,dt),Rt}function So(Ne,Ge,Qe,tt,rt){var nt,at;if(rt===Jo(Ne,Ge,Qe,tt)>0)for(nt=Ge;nt<Qe;nt+=tt)at=Go(nt,Ne[nt],Ne[nt+1],at);else for(nt=Qe-tt;nt>=Ge;nt-=tt)at=Go(nt,Ne[nt],Ne[nt+1],at);return at&&Oo(at,at.next)&&(Zo(at),at=at.next),at}function ko(Ne,Ge){if(!Ne)return Ne;Ge||(Ge=Ne);var Qe,tt=Ne;do{if(Qe=!1,tt.steiner||!Oo(tt,tt.next)&&0!==Ro(tt.prev,tt,tt.next))tt=tt.next;else{if(Zo(tt),(tt=Ge=tt.prev)===tt.next)break;Qe=!0}}while(Qe||tt!==Ge);return Ge}function Io(Ne,Ge,Qe,tt,rt,nt,at){if(Ne){!at&&nt&&function(Ne,Ge,Qe,tt){var rt=Ne;do{null===rt.z&&(rt.z=Vo(rt.x,rt.y,Ge,Qe,tt)),rt.prevZ=rt.prev,rt.nextZ=rt.next,rt=rt.next}while(rt!==Ne);rt.prevZ.nextZ=null,rt.prevZ=null,function(Ne){var Ge,Qe,tt,rt,nt,at,it,ot,dt=1;do{for(Qe=Ne,Ne=null,nt=null,at=0;Qe;){for(at++,tt=Qe,it=0,Ge=0;Ge<dt&&(it++,tt=tt.nextZ);Ge++);for(ot=dt;it>0||ot>0&&tt;)0!==it&&(0===ot||!tt||Qe.z<=tt.z)?(rt=Qe,Qe=Qe.nextZ,it--):(rt=tt,tt=tt.nextZ,ot--),nt?nt.nextZ=rt:Ne=rt,rt.prevZ=nt,nt=rt;Qe=tt}nt.nextZ=null,dt*=2}while(at>1)}(rt)}(Ne,tt,rt,nt);for(var it,ot,dt=Ne;Ne.prev!==Ne.next;)if(it=Ne.prev,ot=Ne.next,nt?Co(Ne,tt,rt,nt):zo(Ne))Ge.push(it.i/Qe),Ge.push(Ne.i/Qe),Ge.push(ot.i/Qe),Zo(Ne),Ne=ot.next,dt=ot.next;else if((Ne=ot)===dt){at?1===at?Io(Ne=Mo(ko(Ne),Ge,Qe),Ge,Qe,tt,rt,nt,2):2===at&&Eo(Ne,Ge,Qe,tt,rt,nt):Io(ko(Ne),Ge,Qe,tt,rt,nt,1);break}}}function zo(Ne){var Ge=Ne.prev,Qe=Ne,tt=Ne.next;if(Ro(Ge,Qe,tt)>=0)return!1;for(var rt=Ne.next.next;rt!==Ne.prev;){if(Do(Ge.x,Ge.y,Qe.x,Qe.y,tt.x,tt.y,rt.x,rt.y)&&Ro(rt.prev,rt,rt.next)>=0)return!1;rt=rt.next}return!0}function Co(Ne,Ge,Qe,tt){var rt=Ne.prev,nt=Ne,at=Ne.next;if(Ro(rt,nt,at)>=0)return!1;for(var it=rt.x>nt.x?rt.x>at.x?rt.x:at.x:nt.x>at.x?nt.x:at.x,ot=rt.y>nt.y?rt.y>at.y?rt.y:at.y:nt.y>at.y?nt.y:at.y,dt=Vo(rt.x<nt.x?rt.x<at.x?rt.x:at.x:nt.x<at.x?nt.x:at.x,rt.y<nt.y?rt.y<at.y?rt.y:at.y:nt.y<at.y?nt.y:at.y,Ge,Qe,tt),ht=Vo(it,ot,Ge,Qe,tt),Dt=Ne.prevZ,Ot=Ne.nextZ;Dt&&Dt.z>=dt&&Ot&&Ot.z<=ht;){if(Dt!==Ne.prev&&Dt!==Ne.next&&Do(rt.x,rt.y,nt.x,nt.y,at.x,at.y,Dt.x,Dt.y)&&Ro(Dt.prev,Dt,Dt.next)>=0)return!1;if(Dt=Dt.prevZ,Ot!==Ne.prev&&Ot!==Ne.next&&Do(rt.x,rt.y,nt.x,nt.y,at.x,at.y,Ot.x,Ot.y)&&Ro(Ot.prev,Ot,Ot.next)>=0)return!1;Ot=Ot.nextZ}for(;Dt&&Dt.z>=dt;){if(Dt!==Ne.prev&&Dt!==Ne.next&&Do(rt.x,rt.y,nt.x,nt.y,at.x,at.y,Dt.x,Dt.y)&&Ro(Dt.prev,Dt,Dt.next)>=0)return!1;Dt=Dt.prevZ}for(;Ot&&Ot.z<=ht;){if(Ot!==Ne.prev&&Ot!==Ne.next&&Do(rt.x,rt.y,nt.x,nt.y,at.x,at.y,Ot.x,Ot.y)&&Ro(Ot.prev,Ot,Ot.next)>=0)return!1;Ot=Ot.nextZ}return!0}function Mo(Ne,Ge,Qe){var tt=Ne;do{var rt=tt.prev,nt=tt.next.next;!Oo(rt,nt)&&Uo(rt,tt,tt.next,nt)&&No(rt,nt)&&No(nt,rt)&&(Ge.push(rt.i/Qe),Ge.push(tt.i/Qe),Ge.push(nt.i/Qe),Zo(tt),Zo(tt.next),tt=Ne=nt),tt=tt.next}while(tt!==Ne);return ko(tt)}function Eo(Ne,Ge,Qe,tt,rt,nt){var at=Ne;do{for(var it=at.next.next;it!==at.prev;){if(at.i!==it.i&&Lo(at,it)){var ot=Ko(at,it);return at=ko(at,at.next),ot=ko(ot,ot.next),Io(at,Ge,Qe,tt,rt,nt),void Io(ot,Ge,Qe,tt,rt,nt)}it=it.next}at=at.next}while(at!==Ne)}function To(Ne,Ge){return Ne.x-Ge.x}function Po(Ne,Ge){if(Ge=function(Ne,Ge){var Qe,tt=Ge,rt=Ne.x,nt=Ne.y,at=-1/0;do{if(nt<=tt.y&&nt>=tt.next.y&&tt.next.y!==tt.y){var it=tt.x+(nt-tt.y)*(tt.next.x-tt.x)/(tt.next.y-tt.y);if(it<=rt&&it>at){if(at=it,it===rt){if(nt===tt.y)return tt;if(nt===tt.next.y)return tt.next}Qe=tt.x<tt.next.x?tt:tt.next}}tt=tt.next}while(tt!==Ge);if(!Qe)return null;if(rt===at)return Qe;var ot,dt=Qe,ht=Qe.x,Dt=Qe.y,Ot=1/0;tt=Qe;do{rt>=tt.x&&tt.x>=ht&&rt!==tt.x&&Do(nt<Dt?rt:at,nt,ht,Dt,nt<Dt?at:rt,nt,tt.x,tt.y)&&(ot=Math.abs(nt-tt.y)/(rt-tt.x),No(tt,Ne)&&(ot<Ot||ot===Ot&&(tt.x>Qe.x||tt.x===Qe.x&&Bo(Qe,tt)))&&(Qe=tt,Ot=ot)),tt=tt.next}while(tt!==dt);return Qe}(Ne,Ge)){var Qe=Ko(Ge,Ne);ko(Ge,Ge.next),ko(Qe,Qe.next)}}function Bo(Ne,Ge){return Ro(Ne.prev,Ne,Ge.prev)<0&&Ro(Ge.next,Ne,Ne.next)<0}function Vo(Ne,Ge,Qe,tt,rt){return(Ne=1431655765&((Ne=858993459&((Ne=252645135&((Ne=16711935&((Ne=32767*(Ne-Qe)*rt)|Ne<<8))|Ne<<4))|Ne<<2))|Ne<<1))|(Ge=1431655765&((Ge=858993459&((Ge=252645135&((Ge=16711935&((Ge=32767*(Ge-tt)*rt)|Ge<<8))|Ge<<4))|Ge<<2))|Ge<<1))<<1}function Fo(Ne){var Ge=Ne,Qe=Ne;do{(Ge.x<Qe.x||Ge.x===Qe.x&&Ge.y<Qe.y)&&(Qe=Ge),Ge=Ge.next}while(Ge!==Ne);return Qe}function Do(Ne,Ge,Qe,tt,rt,nt,at,it){return(rt-at)*(Ge-it)-(Ne-at)*(nt-it)>=0&&(Ne-at)*(tt-it)-(Qe-at)*(Ge-it)>=0&&(Qe-at)*(nt-it)-(rt-at)*(tt-it)>=0}function Lo(Ne,Ge){return Ne.next.i!==Ge.i&&Ne.prev.i!==Ge.i&&!function(Ne,Ge){var Qe=Ne;do{if(Qe.i!==Ne.i&&Qe.next.i!==Ne.i&&Qe.i!==Ge.i&&Qe.next.i!==Ge.i&&Uo(Qe,Qe.next,Ne,Ge))return!0;Qe=Qe.next}while(Qe!==Ne);return!1}(Ne,Ge)&&(No(Ne,Ge)&&No(Ge,Ne)&&function(Ne,Ge){var Qe=Ne,tt=!1,rt=(Ne.x+Ge.x)/2,nt=(Ne.y+Ge.y)/2;do{Qe.y>nt!=Qe.next.y>nt&&Qe.next.y!==Qe.y&&rt<(Qe.next.x-Qe.x)*(nt-Qe.y)/(Qe.next.y-Qe.y)+Qe.x&&(tt=!tt),Qe=Qe.next}while(Qe!==Ne);return tt}(Ne,Ge)&&(Ro(Ne.prev,Ne,Ge.prev)||Ro(Ne,Ge.prev,Ge))||Oo(Ne,Ge)&&Ro(Ne.prev,Ne,Ne.next)>0&&Ro(Ge.prev,Ge,Ge.next)>0)}function Ro(Ne,Ge,Qe){return(Ge.y-Ne.y)*(Qe.x-Ge.x)-(Ge.x-Ne.x)*(Qe.y-Ge.y)}function Oo(Ne,Ge){return Ne.x===Ge.x&&Ne.y===Ge.y}function Uo(Ne,Ge,Qe,tt){var rt=qo(Ro(Ne,Ge,Qe)),nt=qo(Ro(Ne,Ge,tt)),at=qo(Ro(Qe,tt,Ne)),it=qo(Ro(Qe,tt,Ge));return rt!==nt&&at!==it||!(0!==rt||!jo(Ne,Qe,Ge))||!(0!==nt||!jo(Ne,tt,Ge))||!(0!==at||!jo(Qe,Ne,tt))||!(0!==it||!jo(Qe,Ge,tt))}function jo(Ne,Ge,Qe){return Ge.x<=Math.max(Ne.x,Qe.x)&&Ge.x>=Math.min(Ne.x,Qe.x)&&Ge.y<=Math.max(Ne.y,Qe.y)&&Ge.y>=Math.min(Ne.y,Qe.y)}function qo(Ne){return Ne>0?1:Ne<0?-1:0}function No(Ne,Ge){return Ro(Ne.prev,Ne,Ne.next)<0?Ro(Ne,Ge,Ne.next)>=0&&Ro(Ne,Ne.prev,Ge)>=0:Ro(Ne,Ge,Ne.prev)<0||Ro(Ne,Ne.next,Ge)<0}function Ko(Ne,Ge){var Qe=new Xo(Ne.i,Ne.x,Ne.y),tt=new Xo(Ge.i,Ge.x,Ge.y),rt=Ne.next,nt=Ge.prev;return Ne.next=Ge,Ge.prev=Ne,Qe.next=rt,rt.prev=Qe,tt.next=Qe,Qe.prev=tt,nt.next=tt,tt.prev=nt,tt}function Go(Ne,Ge,Qe,tt){var rt=new Xo(Ne,Ge,Qe);return tt?(rt.next=tt.next,rt.prev=tt,tt.next.prev=rt,tt.next=rt):(rt.prev=rt,rt.next=rt),rt}function Zo(Ne){Ne.next.prev=Ne.prev,Ne.prev.next=Ne.next,Ne.prevZ&&(Ne.prevZ.nextZ=Ne.nextZ),Ne.nextZ&&(Ne.nextZ.prevZ=Ne.prevZ)}function Xo(Ne,Ge,Qe){this.i=Ne,this.x=Ge,this.y=Qe,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Jo(Ne,Ge,Qe,tt){for(var rt=0,nt=Ge,at=Qe-tt;nt<Qe;nt+=tt)rt+=(Ne[at]-Ne[nt])*(Ne[nt+1]+Ne[at+1]),at=nt;return rt}function Ho(Ne,Ge,Qe,tt,rt){!function t(Ne,Ge,Qe,tt,rt){for(;tt>Qe;){if(tt-Qe>600){var nt=tt-Qe+1,at=Ge-Qe+1,it=Math.log(nt),ot=.5*Math.exp(2*it/3),dt=.5*Math.sqrt(it*ot*(nt-ot)/nt)*(at-nt/2<0?-1:1);t(Ne,Ge,Math.max(Qe,Math.floor(Ge-at*ot/nt+dt)),Math.min(tt,Math.floor(Ge+(nt-at)*ot/nt+dt)),rt)}var ht=Ne[Ge],Dt=Qe,Ot=tt;for(Yo(Ne,Qe,Ge),rt(Ne[tt],ht)>0&&Yo(Ne,Qe,tt);Dt<Ot;){for(Yo(Ne,Dt,Ot),Dt++,Ot--;rt(Ne[Dt],ht)<0;)Dt++;for(;rt(Ne[Ot],ht)>0;)Ot--}0===rt(Ne[Qe],ht)?Yo(Ne,Qe,Ot):Yo(Ne,++Ot,tt),Ot<=Ge&&(Qe=Ot+1),Ge<=Ot&&(tt=Ot-1)}}(Ne,Ge,Qe||0,tt||Ne.length-1,rt||$o)}function Yo(Ne,Ge,Qe){var tt=Ne[Ge];Ne[Ge]=Ne[Qe],Ne[Qe]=tt}function $o(Ne,Ge){return Ne<Ge?-1:Ne>Ge?1:0}function Wo(Ne,Ge){var Qe=Ne.length;if(Qe<=1)return[Ne];for(var tt,rt,nt=[],at=0;at<Qe;at++){var it=A(Ne[at]);0!==it&&(Ne[at].area=Math.abs(it),void 0===rt&&(rt=it<0),rt===it<0?(tt&&nt.push(tt),tt=[Ne[at]]):tt.push(Ne[at]))}if(tt&&nt.push(tt),Ge>1)for(var ot=0;ot<nt.length;ot++)nt[ot].length<=Ge||(Ho(nt[ot],Ge,1,nt[ot].length-1,Qo),nt[ot]=nt[ot].slice(0,Ge));return nt}function Qo(Ne,Ge){return Ge.area-Ne.area}function ts(Ne,Ge,Qe){for(var tt=Qe.patternDependencies,rt=!1,nt=0,at=Ge;nt<at.length;nt+=1){var it=at[nt].paint.get(Ne+"-pattern");it.isConstant()||(rt=!0);var ot=it.constantOr(null);ot&&(rt=!0,tt[ot.to]=!0,tt[ot.from]=!0)}return rt}function es(Ne,Ge,Qe,tt,rt){for(var nt=rt.patternDependencies,at=0,it=Ge;at<it.length;at+=1){var ot=it[at],dt=ot.paint.get(Ne+"-pattern").value;if("constant"!==dt.kind){var ht=dt.evaluate({zoom:tt-1},Qe,{},rt.availableImages),Dt=dt.evaluate({zoom:tt},Qe,{},rt.availableImages),Ot=dt.evaluate({zoom:tt+1},Qe,{},rt.availableImages);Dt=Dt&&Dt.name?Dt.name:Dt,Ot=Ot&&Ot.name?Ot.name:Ot,nt[ht=ht&&ht.name?ht.name:ht]=!0,nt[Dt]=!0,nt[Ot]=!0,Qe.patterns[ot.id]={min:ht,mid:Dt,max:Ot}}}return Qe}Ao.deviation=function(Ne,Ge,Qe,tt){var rt=Ge&&Ge.length,nt=Math.abs(Jo(Ne,0,rt?Ge[0]*Qe:Ne.length,Qe));if(rt)for(var at=0,it=Ge.length;at<it;at++)nt-=Math.abs(Jo(Ne,Ge[at]*Qe,at<it-1?Ge[at+1]*Qe:Ne.length,Qe));var ot=0;for(at=0;at<tt.length;at+=3){var dt=tt[at]*Qe,ht=tt[at+1]*Qe,Dt=tt[at+2]*Qe;ot+=Math.abs((Ne[dt]-Ne[Dt])*(Ne[ht+1]-Ne[dt+1])-(Ne[dt]-Ne[ht])*(Ne[Dt+1]-Ne[dt+1]))}return 0===nt&&0===ot?0:Math.abs((ot-nt)/nt)},Ao.flatten=function(Ne){for(var Ge=Ne[0][0].length,Qe={vertices:[],holes:[],dimensions:Ge},tt=0,rt=0;rt<Ne.length;rt++){for(var nt=0;nt<Ne[rt].length;nt++)for(var at=0;at<Ge;at++)Qe.vertices.push(Ne[rt][nt][at]);rt>0&&Qe.holes.push(tt+=Ne[rt-1].length)}return Qe},$c.default=Qc;var rs=function(Ne){this.zoom=Ne.zoom,this.overscaling=Ne.overscaling,this.layers=Ne.layers,this.layerIds=this.layers.map((function(Ne){return Ne.id})),this.index=Ne.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new _l,this.indexArray=new ac,this.indexArray2=new uc,this.programConfigurations=new Ta(Kc,Ne.layers,Ne.zoom),this.segments=new ia,this.segments2=new ia,this.stateDependentLayerIds=this.layers.filter((function(Ne){return Ne.isStateDependent()})).map((function(Ne){return Ne.id}))};rs.prototype.populate=function(Ne,Ge,Qe){this.hasPattern=ts("fill",this.layers,Ge);for(var tt=this.layers[0].layout.get("fill-sort-key"),rt=[],nt=0,at=Ne;nt<at.length;nt+=1){var it=at[nt],ot=it.feature,dt=it.id,ht=it.index,Dt=it.sourceLayerIndex,Ot=this.layers[0]._featureFilter.needGeometry,Rt={type:ot.type,id:dt,properties:ot.properties,geometry:Ot?Fa(ot):[]};if(this.layers[0]._featureFilter.filter(new ii(this.zoom),Rt,Qe)){Ot||(Rt.geometry=Fa(ot));var Zt=tt?tt.evaluate(Rt,{},Qe,Ge.availableImages):void 0;rt.push({id:dt,properties:ot.properties,type:ot.type,sourceLayerIndex:Dt,index:ht,geometry:Rt.geometry,patterns:{},sortKey:Zt})}}tt&&rt.sort((function(Ne,Ge){return Ne.sortKey-Ge.sortKey}));for(var er=0,dr=rt;er<dr.length;er+=1){var mr=dr[er],xr=mr.geometry,br=mr.index,Ar=mr.sourceLayerIndex;if(this.hasPattern){var en=es("fill",this.layers,mr,this.zoom,Ge);this.patternFeatures.push(en)}else this.addFeature(mr,xr,br,Qe,{});Ge.featureIndex.insert(Ne[br].feature,xr,br,Ar,this.index)}},rs.prototype.update=function(Ne,Ge,Qe){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(Ne,Ge,this.stateDependentLayers,Qe)},rs.prototype.addFeatures=function(Ne,Ge,Qe){for(var tt=0,rt=this.patternFeatures;tt<rt.length;tt+=1){var nt=rt[tt];this.addFeature(nt,nt.geometry,nt.index,Ge,Qe)}},rs.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},rs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},rs.prototype.upload=function(Ne){this.uploaded||(this.layoutVertexBuffer=Ne.createVertexBuffer(this.layoutVertexArray,Kc),this.indexBuffer=Ne.createIndexBuffer(this.indexArray),this.indexBuffer2=Ne.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(Ne),this.uploaded=!0},rs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},rs.prototype.addFeature=function(Ne,Ge,Qe,tt,rt){for(var nt=0,at=Wo(Ge,500);nt<at.length;nt+=1){for(var it=at[nt],ot=0,dt=0,ht=it;dt<ht.length;dt+=1)ot+=ht[dt].length;for(var Dt=this.segments.prepareSegment(ot,this.layoutVertexArray,this.indexArray),Ot=Dt.vertexLength,Rt=[],Zt=[],er=0,dr=it;er<dr.length;er+=1){var mr=dr[er];if(0!==mr.length){mr!==it[0]&&Zt.push(Rt.length/2);var xr=this.segments2.prepareSegment(mr.length,this.layoutVertexArray,this.indexArray2),br=xr.vertexLength;this.layoutVertexArray.emplaceBack(mr[0].x,mr[0].y),this.indexArray2.emplaceBack(br+mr.length-1,br),Rt.push(mr[0].x),Rt.push(mr[0].y);for(var Ar=1;Ar<mr.length;Ar++)this.layoutVertexArray.emplaceBack(mr[Ar].x,mr[Ar].y),this.indexArray2.emplaceBack(br+Ar-1,br+Ar),Rt.push(mr[Ar].x),Rt.push(mr[Ar].y);xr.vertexLength+=mr.length,xr.primitiveLength+=mr.length}}for(var en=$c(Rt,Zt),mn=0;mn<en.length;mn+=3)this.indexArray.emplaceBack(Ot+en[mn],Ot+en[mn+1],Ot+en[mn+2]);Dt.vertexLength+=ot,Dt.primitiveLength+=en.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,Ne,Qe,rt,tt)},Fn("FillBucket",rs,{omit:["layers","patternFeatures"]});var fu=new gi({"fill-sort-key":new yi(pa.layout_fill["fill-sort-key"])}),du={paint:new gi({"fill-antialias":new fi(pa.paint_fill["fill-antialias"]),"fill-opacity":new yi(pa.paint_fill["fill-opacity"]),"fill-color":new yi(pa.paint_fill["fill-color"]),"fill-outline-color":new yi(pa.paint_fill["fill-outline-color"]),"fill-translate":new fi(pa.paint_fill["fill-translate"]),"fill-translate-anchor":new fi(pa.paint_fill["fill-translate-anchor"]),"fill-pattern":new vl(pa.paint_fill["fill-pattern"])}),layout:fu},xu=function(Ne){function e(Ge){Ne.call(this,Ge,du)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.recalculate=function(Ge,Qe){Ne.prototype.recalculate.call(this,Ge,Qe);var tt=this.paint._values["fill-outline-color"];"constant"===tt.value.kind&&void 0===tt.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},e.prototype.createBucket=function(Ne){return new rs(Ne)},e.prototype.queryRadius=function(){return Ya(this.paint.get("fill-translate"))},e.prototype.queryIntersectsFeature=function(Ne,Ge,Qe,tt,rt,nt,at){return Ua($a(Ne,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),nt.angle,at),tt)},e.prototype.isTileClipped=function(){return!0},e}(xl),bu=Ai([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Mu=us;function us(Ne,Ge,Qe,tt,rt){this.properties={},this.extent=Qe,this.type=0,this._pbf=Ne,this._geometry=-1,this._keys=tt,this._values=rt,Ne.readFields(ls,this,Ge)}function ls(Ne,Ge,Qe){1==Ne?Ge.id=Qe.readVarint():2==Ne?function(Ne,Ge){for(var Qe=Ne.readVarint()+Ne.pos;Ne.pos<Qe;){var tt=Ge._keys[Ne.readVarint()],rt=Ge._values[Ne.readVarint()];Ge.properties[tt]=rt}}(Qe,Ge):3==Ne?Ge.type=Qe.readVarint():4==Ne&&(Ge._geometry=Qe.pos)}function ps(Ne){for(var Ge,Qe,tt=0,rt=0,nt=Ne.length,at=nt-1;rt<nt;at=rt++)tt+=((Qe=Ne[at]).x-(Ge=Ne[rt]).x)*(Ge.y+Qe.y);return tt}us.types=["Unknown","Point","LineString","Polygon"],us.prototype.loadGeometry=function(){var Ne=this._pbf;Ne.pos=this._geometry;for(var Ge,tt=Ne.readVarint()+Ne.pos,rt=1,nt=0,at=0,it=0,ot=[];Ne.pos<tt;){if(nt<=0){var dt=Ne.readVarint();rt=7&dt,nt=dt>>3}if(nt--,1===rt||2===rt)at+=Ne.readSVarint(),it+=Ne.readSVarint(),1===rt&&(Ge&&ot.push(Ge),Ge=[]),Ge.push(new Qe(at,it));else{if(7!==rt)throw new Error("unknown command "+rt);Ge&&Ge.push(Ge[0].clone())}}return Ge&&ot.push(Ge),ot},us.prototype.bbox=function(){var Ne=this._pbf;Ne.pos=this._geometry;for(var Ge=Ne.readVarint()+Ne.pos,Qe=1,tt=0,rt=0,nt=0,at=1/0,it=-1/0,ot=1/0,dt=-1/0;Ne.pos<Ge;){if(tt<=0){var ht=Ne.readVarint();Qe=7&ht,tt=ht>>3}if(tt--,1===Qe||2===Qe)(rt+=Ne.readSVarint())<at&&(at=rt),rt>it&&(it=rt),(nt+=Ne.readSVarint())<ot&&(ot=nt),nt>dt&&(dt=nt);else if(7!==Qe)throw new Error("unknown command "+Qe)}return[at,ot,it,dt]},us.prototype.toGeoJSON=function(Ne,Ge,Qe){var tt,rt,nt=this.extent*Math.pow(2,Qe),at=this.extent*Ne,it=this.extent*Ge,ot=this.loadGeometry(),dt=us.types[this.type];function p(Ne){for(var Ge=0;Ge<Ne.length;Ge++){var Qe=Ne[Ge];Ne[Ge]=[360*(Qe.x+at)/nt-180,360/Math.PI*Math.atan(Math.exp((180-360*(Qe.y+it)/nt)*Math.PI/180))-90]}}switch(this.type){case 1:var ht=[];for(tt=0;tt<ot.length;tt++)ht[tt]=ot[tt][0];p(ot=ht);break;case 2:for(tt=0;tt<ot.length;tt++)p(ot[tt]);break;case 3:for(ot=function(Ne){var Ge=Ne.length;if(Ge<=1)return[Ne];for(var Qe,tt,rt=[],nt=0;nt<Ge;nt++){var at=ps(Ne[nt]);0!==at&&(void 0===tt&&(tt=at<0),tt===at<0?(Qe&&rt.push(Qe),Qe=[Ne[nt]]):Qe.push(Ne[nt]))}return Qe&&rt.push(Qe),rt}(ot),tt=0;tt<ot.length;tt++)for(rt=0;rt<ot[tt].length;rt++)p(ot[tt][rt])}1===ot.length?ot=ot[0]:dt="Multi"+dt;var Dt={type:"Feature",geometry:{type:dt,coordinates:ot},properties:this.properties};return"id"in this&&(Dt.id=this.id),Dt};var Bu=hs;function hs(Ne,Ge){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=Ne,this._keys=[],this._values=[],this._features=[],Ne.readFields(fs,this,Ge),this.length=this._features.length}function fs(Ne,Ge,Qe){15===Ne?Ge.version=Qe.readVarint():1===Ne?Ge.name=Qe.readString():5===Ne?Ge.extent=Qe.readVarint():2===Ne?Ge._features.push(Qe.pos):3===Ne?Ge._keys.push(Qe.readString()):4===Ne&&Ge._values.push(function(Ne){for(var Ge=null,Qe=Ne.readVarint()+Ne.pos;Ne.pos<Qe;){var tt=Ne.readVarint()>>3;Ge=1===tt?Ne.readString():2===tt?Ne.readFloat():3===tt?Ne.readDouble():4===tt?Ne.readVarint64():5===tt?Ne.readVarint():6===tt?Ne.readSVarint():7===tt?Ne.readBoolean():null}return Ge}(Qe))}function ys(Ne,Ge,Qe){if(3===Ne){var tt=new Bu(Qe,Qe.readVarint()+Qe.pos);tt.length&&(Ge[tt.name]=tt)}}hs.prototype.feature=function(Ne){if(Ne<0||Ne>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[Ne];var Ge=this._pbf.readVarint()+this._pbf.pos;return new Mu(this._pbf,Ge,this.extent,this._keys,this._values)};var Wu={VectorTile:function(Ne,Ge){this.layers=Ne.readFields(ys,{},Ge)},VectorTileFeature:Mu,VectorTileLayer:Bu},ef=Wu.VectorTileFeature.types,tf=Math.pow(2,13);function gs(Ne,Ge,Qe,tt,rt,nt,at,it){Ne.emplaceBack(Ge,Qe,2*Math.floor(tt*tf)+at,rt*tf*2,nt*tf*2,Math.round(it))}var xs=function(Ne){this.zoom=Ne.zoom,this.overscaling=Ne.overscaling,this.layers=Ne.layers,this.layerIds=this.layers.map((function(Ne){return Ne.id})),this.index=Ne.index,this.hasPattern=!1,this.layoutVertexArray=new kl,this.indexArray=new ac,this.programConfigurations=new Ta(bu,Ne.layers,Ne.zoom),this.segments=new ia,this.stateDependentLayerIds=this.layers.filter((function(Ne){return Ne.isStateDependent()})).map((function(Ne){return Ne.id}))};function bs(Ne,Ge){return Ne.x===Ge.x&&(Ne.x<0||Ne.x>8192)||Ne.y===Ge.y&&(Ne.y<0||Ne.y>8192)}xs.prototype.populate=function(Ne,Ge,Qe){this.features=[],this.hasPattern=ts("fill-extrusion",this.layers,Ge);for(var tt=0,rt=Ne;tt<rt.length;tt+=1){var nt=rt[tt],at=nt.feature,it=nt.id,ot=nt.index,dt=nt.sourceLayerIndex,ht=this.layers[0]._featureFilter.needGeometry,Dt={type:at.type,id:it,properties:at.properties,geometry:ht?Fa(at):[]};if(this.layers[0]._featureFilter.filter(new ii(this.zoom),Dt,Qe)){var Ot={id:it,sourceLayerIndex:dt,index:ot,geometry:ht?Dt.geometry:Fa(at),properties:at.properties,type:at.type,patterns:{}};void 0!==at.id&&(Ot.id=at.id),this.hasPattern?this.features.push(es("fill-extrusion",this.layers,Ot,this.zoom,Ge)):this.addFeature(Ot,Ot.geometry,ot,Qe,{}),Ge.featureIndex.insert(at,Ot.geometry,ot,dt,this.index,!0)}}},xs.prototype.addFeatures=function(Ne,Ge,Qe){for(var tt=0,rt=this.features;tt<rt.length;tt+=1){var nt=rt[tt];this.addFeature(nt,nt.geometry,nt.index,Ge,Qe)}},xs.prototype.update=function(Ne,Ge,Qe){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(Ne,Ge,this.stateDependentLayers,Qe)},xs.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},xs.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},xs.prototype.upload=function(Ne){this.uploaded||(this.layoutVertexBuffer=Ne.createVertexBuffer(this.layoutVertexArray,bu),this.indexBuffer=Ne.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(Ne),this.uploaded=!0},xs.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},xs.prototype.addFeature=function(Ne,Ge,Qe,tt,rt){for(var nt=0,at=Wo(Ge,500);nt<at.length;nt+=1){for(var it=at[nt],ot=0,dt=0,ht=it;dt<ht.length;dt+=1)ot+=ht[dt].length;for(var Dt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),Ot=0,Rt=it;Ot<Rt.length;Ot+=1){var Zt=Rt[Ot];if(0!==Zt.length&&!((Vn=Zt).every((function(Ne){return Ne.x<0}))||Vn.every((function(Ne){return Ne.x>8192}))||Vn.every((function(Ne){return Ne.y<0}))||Vn.every((function(Ne){return Ne.y>8192}))))for(var er=0,dr=0;dr<Zt.length;dr++){var mr=Zt[dr];if(dr>=1){var xr=Zt[dr-1];if(!bs(mr,xr)){Dt.vertexLength+4>ia.MAX_VERTEX_ARRAY_LENGTH&&(Dt=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var br=mr.sub(xr)._perp()._unit(),Ar=xr.dist(mr);er+Ar>32768&&(er=0),gs(this.layoutVertexArray,mr.x,mr.y,br.x,br.y,0,0,er),gs(this.layoutVertexArray,mr.x,mr.y,br.x,br.y,0,1,er),gs(this.layoutVertexArray,xr.x,xr.y,br.x,br.y,0,0,er+=Ar),gs(this.layoutVertexArray,xr.x,xr.y,br.x,br.y,0,1,er);var en=Dt.vertexLength;this.indexArray.emplaceBack(en,en+2,en+1),this.indexArray.emplaceBack(en+1,en+2,en+3),Dt.vertexLength+=4,Dt.primitiveLength+=2}}}}if(Dt.vertexLength+ot>ia.MAX_VERTEX_ARRAY_LENGTH&&(Dt=this.segments.prepareSegment(ot,this.layoutVertexArray,this.indexArray)),"Polygon"===ef[Ne.type]){for(var mn=[],xn=[],kn=Dt.vertexLength,Cn=0,En=it;Cn<En.length;Cn+=1){var Pn=En[Cn];if(0!==Pn.length){Pn!==it[0]&&xn.push(mn.length/2);for(var Dn=0;Dn<Pn.length;Dn++){var In=Pn[Dn];gs(this.layoutVertexArray,In.x,In.y,0,0,1,1,0),mn.push(In.x),mn.push(In.y)}}}for(var zn=$c(mn,xn),Bn=0;Bn<zn.length;Bn+=3)this.indexArray.emplaceBack(kn+zn[Bn],kn+zn[Bn+2],kn+zn[Bn+1]);Dt.primitiveLength+=zn.length/3,Dt.vertexLength+=ot}}var Vn;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,Ne,Qe,rt,tt)},Fn("FillExtrusionBucket",xs,{omit:["layers","features"]});var rf={paint:new gi({"fill-extrusion-opacity":new fi(pa["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new yi(pa["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new fi(pa["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new fi(pa["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new vl(pa["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new yi(pa["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new yi(pa["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new fi(pa["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},nf=function(Ne){function e(Ge){Ne.call(this,Ge,rf)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.createBucket=function(Ne){return new xs(Ne)},e.prototype.queryRadius=function(){return Ya(this.paint.get("fill-extrusion-translate"))},e.prototype.is3D=function(){return!0},e.prototype.queryIntersectsFeature=function(Ne,Ge,tt,rt,nt,at,it,ot){var dt=$a(Ne,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),at.angle,it),ht=this.paint.get("fill-extrusion-height").evaluate(Ge,tt),Dt=this.paint.get("fill-extrusion-base").evaluate(Ge,tt),Ot=function(Ne,Ge,tt,rt){for(var nt=[],at=0,it=Ne;at<it.length;at+=1){var ot=it[at],dt=[ot.x,ot.y,0,1];ao(dt,dt,Ge),nt.push(new Qe(dt[0]/dt[3],dt[1]/dt[3]))}return nt}(dt,ot),Rt=function(Ne,Ge,tt,rt){for(var nt=[],at=[],it=rt[8]*Ge,ot=rt[9]*Ge,dt=rt[10]*Ge,ht=rt[11]*Ge,Dt=rt[8]*tt,Ot=rt[9]*tt,Rt=rt[10]*tt,Zt=rt[11]*tt,er=0,dr=Ne;er<dr.length;er+=1){for(var mr=[],xr=[],br=0,Ar=dr[er];br<Ar.length;br+=1){var en=Ar[br],mn=en.x,xn=en.y,kn=rt[0]*mn+rt[4]*xn+rt[12],Cn=rt[1]*mn+rt[5]*xn+rt[13],En=rt[2]*mn+rt[6]*xn+rt[14],Pn=rt[3]*mn+rt[7]*xn+rt[15],Dn=En+dt,In=Pn+ht,zn=kn+Dt,Bn=Cn+Ot,Vn=En+Rt,Hn=Pn+Zt,qn=new Qe((kn+it)/In,(Cn+ot)/In);qn.z=Dn/In,mr.push(qn);var Yn=new Qe(zn/Hn,Bn/Hn);Yn.z=Vn/Hn,xr.push(Yn)}nt.push(mr),at.push(xr)}return[nt,at]}(rt,Dt,ht,ot);return function(Ne,Ge,Qe){var tt=1/0;Ua(Qe,Ge)&&(tt=Ss(Qe,Ge[0]));for(var rt=0;rt<Ge.length;rt++)for(var nt=Ge[rt],at=Ne[rt],it=0;it<nt.length-1;it++){var ot=nt[it],dt=[ot,nt[it+1],at[it+1],at[it],ot];Ra(Qe,dt)&&(tt=Math.min(tt,Ss(Qe,dt)))}return tt!==1/0&&tt}(Rt[0],Rt[1],Ot)},e}(xl);function As(Ne,Ge){return Ne.x*Ge.x+Ne.y*Ge.y}function Ss(Ne,Ge){if(1===Ne.length){for(var Qe,tt=0,rt=Ge[tt++];!Qe||rt.equals(Qe);)if(!(Qe=Ge[tt++]))return 1/0;for(;tt<Ge.length;tt++){var nt=Ge[tt],at=Ne[0],it=Qe.sub(rt),ot=nt.sub(rt),dt=at.sub(rt),ht=As(it,it),Dt=As(it,ot),Ot=As(ot,ot),Rt=As(dt,it),Zt=As(dt,ot),er=ht*Ot-Dt*Dt,dr=(Ot*Rt-Dt*Zt)/er,mr=(ht*Zt-Dt*Rt)/er,xr=rt.z*(1-dr-mr)+Qe.z*dr+nt.z*mr;if(isFinite(xr))return xr}return 1/0}for(var br=1/0,Ar=0,en=Ge;Ar<en.length;Ar+=1)br=Math.min(br,en[Ar].z);return br}var af=Ai([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,of=Wu.VectorTileFeature.types,sf=Math.cos(Math.PI/180*37.5),lf=Math.pow(2,14)/.5,Ms=function(Ne){this.zoom=Ne.zoom,this.overscaling=Ne.overscaling,this.layers=Ne.layers,this.layerIds=this.layers.map((function(Ne){return Ne.id})),this.index=Ne.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Al,this.indexArray=new ac,this.programConfigurations=new Ta(af,Ne.layers,Ne.zoom),this.segments=new ia,this.stateDependentLayerIds=this.layers.filter((function(Ne){return Ne.isStateDependent()})).map((function(Ne){return Ne.id}))};Ms.prototype.populate=function(Ne,Ge,Qe){this.hasPattern=ts("line",this.layers,Ge);for(var tt=this.layers[0].layout.get("line-sort-key"),rt=[],nt=0,at=Ne;nt<at.length;nt+=1){var it=at[nt],ot=it.feature,dt=it.id,ht=it.index,Dt=it.sourceLayerIndex,Ot=this.layers[0]._featureFilter.needGeometry,Rt={type:ot.type,id:dt,properties:ot.properties,geometry:Ot?Fa(ot):[]};if(this.layers[0]._featureFilter.filter(new ii(this.zoom),Rt,Qe)){Ot||(Rt.geometry=Fa(ot));var Zt=tt?tt.evaluate(Rt,{},Qe):void 0;rt.push({id:dt,properties:ot.properties,type:ot.type,sourceLayerIndex:Dt,index:ht,geometry:Rt.geometry,patterns:{},sortKey:Zt})}}tt&&rt.sort((function(Ne,Ge){return Ne.sortKey-Ge.sortKey}));for(var er=0,dr=rt;er<dr.length;er+=1){var mr=dr[er],xr=mr.geometry,br=mr.index,Ar=mr.sourceLayerIndex;if(this.hasPattern){var en=es("line",this.layers,mr,this.zoom,Ge);this.patternFeatures.push(en)}else this.addFeature(mr,xr,br,Qe,{});Ge.featureIndex.insert(Ne[br].feature,xr,br,Ar,this.index)}},Ms.prototype.update=function(Ne,Ge,Qe){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(Ne,Ge,this.stateDependentLayers,Qe)},Ms.prototype.addFeatures=function(Ne,Ge,Qe){for(var tt=0,rt=this.patternFeatures;tt<rt.length;tt+=1){var nt=rt[tt];this.addFeature(nt,nt.geometry,nt.index,Ge,Qe)}},Ms.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length},Ms.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ms.prototype.upload=function(Ne){this.uploaded||(this.layoutVertexBuffer=Ne.createVertexBuffer(this.layoutVertexArray,af),this.indexBuffer=Ne.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(Ne),this.uploaded=!0},Ms.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ms.prototype.addFeature=function(Ne,Ge,Qe,tt,rt){for(var nt=this.layers[0].layout,at=nt.get("line-join").evaluate(Ne,{}),it=nt.get("line-cap"),ot=nt.get("line-miter-limit"),dt=nt.get("line-round-limit"),ht=0,Dt=Ge;ht<Dt.length;ht+=1)this.addLine(Dt[ht],Ne,at,it,ot,dt);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,Ne,Qe,rt,tt)},Ms.prototype.addLine=function(Ne,Ge,Qe,tt,rt,nt){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,Ge.properties&&Ge.properties.hasOwnProperty("mapbox_clip_start")&&Ge.properties.hasOwnProperty("mapbox_clip_end")){this.clipStart=+Ge.properties.mapbox_clip_start,this.clipEnd=+Ge.properties.mapbox_clip_end;for(var at=0;at<Ne.length-1;at++)this.totalDistance+=Ne[at].dist(Ne[at+1]);this.updateScaledDistance()}for(var it="Polygon"===of[Ge.type],ot=Ne.length;ot>=2&&Ne[ot-1].equals(Ne[ot-2]);)ot--;for(var dt=0;dt<ot-1&&Ne[dt].equals(Ne[dt+1]);)dt++;if(!(ot<(it?3:2))){"bevel"===Qe&&(rt=1.05);var ht,Dt=this.overscaling<=16?122880/(512*this.overscaling):0,Ot=this.segments.prepareSegment(10*ot,this.layoutVertexArray,this.indexArray),Rt=void 0,Zt=void 0,er=void 0,dr=void 0;this.e1=this.e2=-1,it&&(dr=Ne[dt].sub(ht=Ne[ot-2])._unit()._perp());for(var mr=dt;mr<ot;mr++)if(!(Zt=mr===ot-1?it?Ne[dt+1]:void 0:Ne[mr+1])||!Ne[mr].equals(Zt)){dr&&(er=dr),ht&&(Rt=ht),ht=Ne[mr],dr=Zt?Zt.sub(ht)._unit()._perp():er;var xr=(er=er||dr).add(dr);0===xr.x&&0===xr.y||xr._unit();var br=er.x*dr.x+er.y*dr.y,Ar=xr.x*dr.x+xr.y*dr.y,en=0!==Ar?1/Ar:1/0,mn=2*Math.sqrt(2-2*Ar),xn=Ar<sf&&Rt&&Zt,kn=er.x*dr.y-er.y*dr.x>0;if(xn&&mr>dt){var Cn=ht.dist(Rt);if(Cn>2*Dt){var En=ht.sub(ht.sub(Rt)._mult(Dt/Cn)._round());this.updateDistance(Rt,En),this.addCurrentVertex(En,er,0,0,Ot),Rt=En}}var Pn=Rt&&Zt,Dn=Pn?Qe:it?"butt":tt;if(Pn&&"round"===Dn&&(en<nt?Dn="miter":en<=2&&(Dn="fakeround")),"miter"===Dn&&en>rt&&(Dn="bevel"),"bevel"===Dn&&(en>2&&(Dn="flipbevel"),en<rt&&(Dn="miter")),Rt&&this.updateDistance(Rt,ht),"miter"===Dn)xr._mult(en),this.addCurrentVertex(ht,xr,0,0,Ot);else if("flipbevel"===Dn){if(en>100)xr=dr.mult(-1);else{var In=en*er.add(dr).mag()/er.sub(dr).mag();xr._perp()._mult(In*(kn?-1:1))}this.addCurrentVertex(ht,xr,0,0,Ot),this.addCurrentVertex(ht,xr.mult(-1),0,0,Ot)}else if("bevel"===Dn||"fakeround"===Dn){var zn=-Math.sqrt(en*en-1),Bn=kn?zn:0,Vn=kn?0:zn;if(Rt&&this.addCurrentVertex(ht,er,Bn,Vn,Ot),"fakeround"===Dn)for(var Hn=Math.round(180*mn/Math.PI/20),qn=1;qn<Hn;qn++){var Yn=qn/Hn;if(.5!==Yn){var $n=Yn-.5;Yn+=Yn*$n*(Yn-1)*((1.0904+br*(br*(3.55645-1.43519*br)-3.2452))*$n*$n+(.848013+br*(.215638*br-1.06021)))}var ra=dr.sub(er)._mult(Yn)._add(er)._unit()._mult(kn?-1:1);this.addHalfVertex(ht,ra.x,ra.y,!1,kn,0,Ot)}Zt&&this.addCurrentVertex(ht,dr,-Bn,-Vn,Ot)}else if("butt"===Dn)this.addCurrentVertex(ht,xr,0,0,Ot);else if("square"===Dn){var oa=Rt?1:-1;this.addCurrentVertex(ht,xr,oa,oa,Ot)}else"round"===Dn&&(Rt&&(this.addCurrentVertex(ht,er,0,0,Ot),this.addCurrentVertex(ht,er,1,1,Ot,!0)),Zt&&(this.addCurrentVertex(ht,dr,-1,-1,Ot,!0),this.addCurrentVertex(ht,dr,0,0,Ot)));if(xn&&mr<ot-1){var pa=ht.dist(Zt);if(pa>2*Dt){var ga=ht.add(Zt.sub(ht)._mult(Dt/pa)._round());this.updateDistance(ht,ga),this.addCurrentVertex(ga,dr,0,0,Ot),ht=ga}}}}},Ms.prototype.addCurrentVertex=function(Ne,Ge,Qe,tt,rt,nt){void 0===nt&&(nt=!1);var at=Ge.y*tt-Ge.x,it=-Ge.y-Ge.x*tt;this.addHalfVertex(Ne,Ge.x+Ge.y*Qe,Ge.y-Ge.x*Qe,nt,!1,Qe,rt),this.addHalfVertex(Ne,at,it,nt,!0,-tt,rt),this.distance>lf/2&&0===this.totalDistance&&(this.distance=0,this.addCurrentVertex(Ne,Ge,Qe,tt,rt,nt))},Ms.prototype.addHalfVertex=function(Ne,Ge,Qe,tt,rt,nt,at){var it=.5*this.scaledDistance;this.layoutVertexArray.emplaceBack((Ne.x<<1)+(tt?1:0),(Ne.y<<1)+(rt?1:0),Math.round(63*Ge)+128,Math.round(63*Qe)+128,1+(0===nt?0:nt<0?-1:1)|(63&it)<<2,it>>6);var ot=at.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,ot),at.primitiveLength++),rt?this.e2=ot:this.e1=ot},Ms.prototype.updateScaledDistance=function(){this.scaledDistance=this.totalDistance>0?(this.clipStart+(this.clipEnd-this.clipStart)*this.distance/this.totalDistance)*(lf-1):this.distance},Ms.prototype.updateDistance=function(Ne,Ge){this.distance+=Ne.dist(Ge),this.updateScaledDistance()},Fn("LineBucket",Ms,{omit:["layers","patternFeatures"]});var cf=new gi({"line-cap":new fi(pa.layout_line["line-cap"]),"line-join":new yi(pa.layout_line["line-join"]),"line-miter-limit":new fi(pa.layout_line["line-miter-limit"]),"line-round-limit":new fi(pa.layout_line["line-round-limit"]),"line-sort-key":new yi(pa.layout_line["line-sort-key"])}),uf={paint:new gi({"line-opacity":new yi(pa.paint_line["line-opacity"]),"line-color":new yi(pa.paint_line["line-color"]),"line-translate":new fi(pa.paint_line["line-translate"]),"line-translate-anchor":new fi(pa.paint_line["line-translate-anchor"]),"line-width":new yi(pa.paint_line["line-width"]),"line-gap-width":new yi(pa.paint_line["line-gap-width"]),"line-offset":new yi(pa.paint_line["line-offset"]),"line-blur":new yi(pa.paint_line["line-blur"]),"line-dasharray":new mi(pa.paint_line["line-dasharray"]),"line-pattern":new vl(pa.paint_line["line-pattern"]),"line-gradient":new vi(pa.paint_line["line-gradient"])}),layout:cf},ff=new(function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.possiblyEvaluate=function(Ge,Qe){return Qe=new ii(Math.floor(Qe.zoom),{now:Qe.now,fadeDuration:Qe.fadeDuration,zoomHistory:Qe.zoomHistory,transition:Qe.transition}),Ne.prototype.possiblyEvaluate.call(this,Ge,Qe)},e.prototype.evaluate=function(Ge,Qe,tt,rt){return Qe=p({},Qe,{zoom:Math.floor(Qe.zoom)}),Ne.prototype.evaluate.call(this,Ge,Qe,tt,rt)},e}(yi))(uf.paint.properties["line-width"].specification);ff.useIntegerZoom=!0;var pf=function(Ne){function e(Ge){Ne.call(this,Ge,uf)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype._handleSpecialPaintPropertyUpdate=function(Ne){"line-gradient"===Ne&&this._updateGradient()},e.prototype._updateGradient=function(){this.gradient=mo(this._transitionablePaint._values["line-gradient"].value.expression,"lineProgress"),this.gradientTexture=null},e.prototype.recalculate=function(Ge,Qe){Ne.prototype.recalculate.call(this,Ge,Qe),this.paint._values["line-floorwidth"]=ff.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,Ge)},e.prototype.createBucket=function(Ne){return new Ms(Ne)},e.prototype.queryRadius=function(Ne){var Ge=Ne,Qe=Vs(Ha("line-width",this,Ge),Ha("line-gap-width",this,Ge)),tt=Ha("line-offset",this,Ge);return Qe/2+Math.abs(tt)+Ya(this.paint.get("line-translate"))},e.prototype.queryIntersectsFeature=function(Ne,Ge,tt,rt,nt,at,it){var ot=$a(Ne,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),at.angle,it),dt=it/2*Vs(this.paint.get("line-width").evaluate(Ge,tt),this.paint.get("line-gap-width").evaluate(Ge,tt)),ht=this.paint.get("line-offset").evaluate(Ge,tt);return ht&&(rt=function(Ne,Ge){for(var tt=[],rt=new Qe(0,0),nt=0;nt<Ne.length;nt++){for(var at=Ne[nt],it=[],ot=0;ot<at.length;ot++){var dt=at[ot],ht=at[ot+1],Dt=0===ot?rt:dt.sub(at[ot-1])._unit()._perp(),Ot=ot===at.length-1?rt:ht.sub(dt)._unit()._perp(),Rt=Dt._add(Ot)._unit();Rt._mult(1/(Rt.x*Ot.x+Rt.y*Ot.y)),it.push(Rt._mult(Ge)._add(dt))}tt.push(it)}return tt}(rt,ht*it)),function(Ne,Ge,Qe){for(var tt=0;tt<Ge.length;tt++){var rt=Ge[tt];if(Ne.length>=3)for(var nt=0;nt<rt.length;nt++)if(Xa(Ne,rt[nt]))return!0;if(ja(Ne,rt,Qe))return!0}return!1}(ot,rt,dt)},e.prototype.isTileClipped=function(){return!0},e}(xl);function Vs(Ne,Ge){return Ge>0?Ge+2*Ne:Ne}var df=Ai([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),hf=Ai([{name:"a_projected_pos",components:3,type:"Float32"}],4),gf=(Ai([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Ai([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),mf=(Ai([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Ai([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),vf=Ai([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Us(Ne,Ge,Qe){return Ne.sections.forEach((function(Ne){Ne.text=function(Ne,Ge,Qe){var tt=Ge.layout.get("text-transform").evaluate(Qe,{});return"uppercase"===tt?Ne=Ne.toLocaleUpperCase():"lowercase"===tt&&(Ne=Ne.toLocaleLowerCase()),ml.applyArabicShaping&&(Ne=ml.applyArabicShaping(Ne)),Ne}(Ne.text,Ge,Qe)})),Ne}Ai([{name:"triangle",components:3,type:"Uint16"}]),Ai([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Ai([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ai([{type:"Float32",name:"offsetX"}]),Ai([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var yf={"!":"ï¸","#":"ï¼",$:"ï¼","%":"ï¼","&":"ï¼","(":"ï¸µ",")":"ï¸¶","*":"ï¼","+":"ï¼",",":"ï¸","-":"ï¸²",".":"ã»","/":"ï¼",":":"ï¸",";":"ï¸","<":"ï¸¿","=":"ï¼",">":"ï¹","?":"ï¸","@":"ï¼ ","[":"ï¹","\\":"ï¼¼","]":"ï¹","^":"ï¼¾",_:"ï¸³","`":"ï½","{":"ï¸·","|":"â","}":"ï¸¸","~":"ï½","Â¢":"ï¿ ","Â£":"ï¿¡","Â¥":"ï¿¥","Â¦":"ï¿¤","Â¬":"ï¿¢","Â¯":"ï¿£","â":"ï¸²","â":"ï¸±","â":"ï¹","â":"ï¹","â":"ï¹","â":"ï¹","â¦":"ï¸","â§":"ã»","â©":"ï¿¦","ã":"ï¸","ã":"ï¸","ã":"ï¸¿","ã":"ï¹","ã":"ï¸½","ã":"ï¸¾","ã":"ï¹","ã":"ï¹","ã":"ï¹","ã":"ï¹","ã":"ï¸»","ã":"ï¸¼","ã":"ï¸¹","ã":"ï¸º","ã":"ï¸","ã":"ï¸","ï¼":"ï¸","ï¼":"ï¸µ","ï¼":"ï¸¶","ï¼":"ï¸","ï¼":"ï¸²","ï¼":"ã»","ï¼":"ï¸","ï¼":"ï¸","ï¼":"ï¸¿","ï¼":"ï¹","ï¼":"ï¸","ï¼»":"ï¹","ï¼½":"ï¹","ï¼¿":"ï¸³","ï½":"ï¸·","ï½":"â","ï½":"ï¸¸","ï½":"ï¸µ","ï½ ":"ï¸¶","ï½¡":"ï¸","ï½¢":"ï¹","ï½£":"ï¹"},qs=function(Ne,Ge,Qe,tt,rt){var nt,at,it=8*rt-tt-1,ot=(1<<it)-1,dt=ot>>1,ht=-7,Dt=Qe?rt-1:0,Ot=Qe?-1:1,Rt=Ne[Ge+Dt];for(Dt+=Ot,nt=Rt&(1<<-ht)-1,Rt>>=-ht,ht+=it;ht>0;nt=256*nt+Ne[Ge+Dt],Dt+=Ot,ht-=8);for(at=nt&(1<<-ht)-1,nt>>=-ht,ht+=tt;ht>0;at=256*at+Ne[Ge+Dt],Dt+=Ot,ht-=8);if(0===nt)nt=1-dt;else{if(nt===ot)return at?NaN:1/0*(Rt?-1:1);at+=Math.pow(2,tt),nt-=dt}return(Rt?-1:1)*at*Math.pow(2,nt-tt)},Ns=function(Ne,Ge,Qe,tt,rt,nt){var at,it,ot,dt=8*nt-rt-1,ht=(1<<dt)-1,Dt=ht>>1,Ot=23===rt?Math.pow(2,-24)-Math.pow(2,-77):0,Rt=tt?0:nt-1,Zt=tt?1:-1,er=Ge<0||0===Ge&&1/Ge<0?1:0;for(Ge=Math.abs(Ge),isNaN(Ge)||Ge===1/0?(it=isNaN(Ge)?1:0,at=ht):(at=Math.floor(Math.log(Ge)/Math.LN2),Ge*(ot=Math.pow(2,-at))<1&&(at--,ot*=2),(Ge+=at+Dt>=1?Ot/ot:Ot*Math.pow(2,1-Dt))*ot>=2&&(at++,ot/=2),at+Dt>=ht?(it=0,at=ht):at+Dt>=1?(it=(Ge*ot-1)*Math.pow(2,rt),at+=Dt):(it=Ge*Math.pow(2,Dt-1)*Math.pow(2,rt),at=0));rt>=8;Ne[Qe+Rt]=255&it,Rt+=Zt,it/=256,rt-=8);for(at=at<<rt|it,dt+=rt;dt>0;Ne[Qe+Rt]=255&at,Rt+=Zt,at/=256,dt-=8);Ne[Qe+Rt-Zt]|=128*er},xf=Gs;function Gs(Ne){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(Ne)?Ne:new Uint8Array(Ne||0),this.pos=0,this.type=0,this.length=this.buf.length}Gs.Varint=0,Gs.Fixed64=1,Gs.Bytes=2,Gs.Fixed32=5;var bf="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Xs(Ne){return Ne.type===Gs.Bytes?Ne.readVarint()+Ne.pos:Ne.pos+1}function Js(Ne,Ge,Qe){return Qe?4294967296*Ge+(Ne>>>0):4294967296*(Ge>>>0)+(Ne>>>0)}function Hs(Ne,Ge,Qe){var tt=Ge<=16383?1:Ge<=2097151?2:Ge<=268435455?3:Math.floor(Math.log(Ge)/(7*Math.LN2));Qe.realloc(tt);for(var rt=Qe.pos-1;rt>=Ne;rt--)Qe.buf[rt+tt]=Qe.buf[rt]}function Ys(Ne,Ge){for(var Qe=0;Qe<Ne.length;Qe++)Ge.writeVarint(Ne[Qe])}function $s(Ne,Ge){for(var Qe=0;Qe<Ne.length;Qe++)Ge.writeSVarint(Ne[Qe])}function Ws(Ne,Ge){for(var Qe=0;Qe<Ne.length;Qe++)Ge.writeFloat(Ne[Qe])}function Qs(Ne,Ge){for(var Qe=0;Qe<Ne.length;Qe++)Ge.writeDouble(Ne[Qe])}function tu(Ne,Ge){for(var Qe=0;Qe<Ne.length;Qe++)Ge.writeBoolean(Ne[Qe])}function eu(Ne,Ge){for(var Qe=0;Qe<Ne.length;Qe++)Ge.writeFixed32(Ne[Qe])}function ru(Ne,Ge){for(var Qe=0;Qe<Ne.length;Qe++)Ge.writeSFixed32(Ne[Qe])}function nu(Ne,Ge){for(var Qe=0;Qe<Ne.length;Qe++)Ge.writeFixed64(Ne[Qe])}function iu(Ne,Ge){for(var Qe=0;Qe<Ne.length;Qe++)Ge.writeSFixed64(Ne[Qe])}function au(Ne,Ge){return(Ne[Ge]|Ne[Ge+1]<<8|Ne[Ge+2]<<16)+16777216*Ne[Ge+3]}function ou(Ne,Ge,Qe){Ne[Qe]=Ge,Ne[Qe+1]=Ge>>>8,Ne[Qe+2]=Ge>>>16,Ne[Qe+3]=Ge>>>24}function su(Ne,Ge){return(Ne[Ge]|Ne[Ge+1]<<8|Ne[Ge+2]<<16)+(Ne[Ge+3]<<24)}function uu(Ne,Ge,Qe){1===Ne&&Qe.readMessage(lu,Ge)}function lu(Ne,Ge,Qe){if(3===Ne){var tt=Qe.readMessage(pu,{}),rt=tt.width,nt=tt.height,at=tt.left,it=tt.top,ot=tt.advance;Ge.push({id:tt.id,bitmap:new ho({width:rt+6,height:nt+6},tt.bitmap),metrics:{width:rt,height:nt,left:at,top:it,advance:ot}})}}function pu(Ne,Ge,Qe){1===Ne?Ge.id=Qe.readVarint():2===Ne?Ge.bitmap=Qe.readBytes():3===Ne?Ge.width=Qe.readVarint():4===Ne?Ge.height=Qe.readVarint():5===Ne?Ge.left=Qe.readSVarint():6===Ne?Ge.top=Qe.readSVarint():7===Ne&&(Ge.advance=Qe.readVarint())}function cu(Ne){for(var Ge=0,Qe=0,tt=0,rt=Ne;tt<rt.length;tt+=1){var nt=rt[tt];Ge+=nt.w*nt.h,Qe=Math.max(Qe,nt.w)}Ne.sort((function(Ne,Ge){return Ge.h-Ne.h}));for(var at=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(Ge/.95)),Qe),h:1/0}],it=0,ot=0,dt=0,ht=Ne;dt<ht.length;dt+=1)for(var Dt=ht[dt],Ot=at.length-1;Ot>=0;Ot--){var Rt=at[Ot];if(!(Dt.w>Rt.w||Dt.h>Rt.h)){if(Dt.x=Rt.x,Dt.y=Rt.y,ot=Math.max(ot,Dt.y+Dt.h),it=Math.max(it,Dt.x+Dt.w),Dt.w===Rt.w&&Dt.h===Rt.h){var Zt=at.pop();Ot<at.length&&(at[Ot]=Zt)}else Dt.h===Rt.h?(Rt.x+=Dt.w,Rt.w-=Dt.w):Dt.w===Rt.w?(Rt.y+=Dt.h,Rt.h-=Dt.h):(at.push({x:Rt.x+Dt.w,y:Rt.y,w:Rt.w-Dt.w,h:Dt.h}),Rt.y+=Dt.h,Rt.h-=Dt.h);break}}return{w:it,h:ot,fill:Ge/(it*ot)||0}}Gs.prototype={destroy:function(){this.buf=null},readFields:function(Ne,Ge,Qe){for(Qe=Qe||this.length;this.pos<Qe;){var tt=this.readVarint(),rt=tt>>3,nt=this.pos;this.type=7&tt,Ne(rt,Ge,this),this.pos===nt&&this.skip(tt)}return Ge},readMessage:function(Ne,Ge){return this.readFields(Ne,Ge,this.readVarint()+this.pos)},readFixed32:function(){var Ne=au(this.buf,this.pos);return this.pos+=4,Ne},readSFixed32:function(){var Ne=su(this.buf,this.pos);return this.pos+=4,Ne},readFixed64:function(){var Ne=au(this.buf,this.pos)+4294967296*au(this.buf,this.pos+4);return this.pos+=8,Ne},readSFixed64:function(){var Ne=au(this.buf,this.pos)+4294967296*su(this.buf,this.pos+4);return this.pos+=8,Ne},readFloat:function(){var Ne=qs(this.buf,this.pos,!0,23,4);return this.pos+=4,Ne},readDouble:function(){var Ne=qs(this.buf,this.pos,!0,52,8);return this.pos+=8,Ne},readVarint:function(Ne){var Ge,Qe,tt=this.buf;return Ge=127&(Qe=tt[this.pos++]),Qe<128?Ge:(Ge|=(127&(Qe=tt[this.pos++]))<<7,Qe<128?Ge:(Ge|=(127&(Qe=tt[this.pos++]))<<14,Qe<128?Ge:(Ge|=(127&(Qe=tt[this.pos++]))<<21,Qe<128?Ge:function(Ne,Ge,Qe){var tt,rt,nt=Qe.buf;if(tt=(112&(rt=nt[Qe.pos++]))>>4,rt<128)return Js(Ne,tt,Ge);if(tt|=(127&(rt=nt[Qe.pos++]))<<3,rt<128)return Js(Ne,tt,Ge);if(tt|=(127&(rt=nt[Qe.pos++]))<<10,rt<128)return Js(Ne,tt,Ge);if(tt|=(127&(rt=nt[Qe.pos++]))<<17,rt<128)return Js(Ne,tt,Ge);if(tt|=(127&(rt=nt[Qe.pos++]))<<24,rt<128)return Js(Ne,tt,Ge);if(tt|=(1&(rt=nt[Qe.pos++]))<<31,rt<128)return Js(Ne,tt,Ge);throw new Error("Expected varint not more than 10 bytes")}(Ge|=(15&(Qe=tt[this.pos]))<<28,Ne,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var Ne=this.readVarint();return Ne%2==1?(Ne+1)/-2:Ne/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var Ne=this.readVarint()+this.pos,Ge=this.pos;return this.pos=Ne,Ne-Ge>=12&&bf?function(Ne,Ge,Qe){return bf.decode(Ne.subarray(Ge,Qe))}(this.buf,Ge,Ne):function(Ne,Ge,Qe){for(var tt="",rt=Ge;rt<Qe;){var nt,at,it,ot=Ne[rt],dt=null,ht=ot>239?4:ot>223?3:ot>191?2:1;if(rt+ht>Qe)break;1===ht?ot<128&&(dt=ot):2===ht?128==(192&(nt=Ne[rt+1]))&&(dt=(31&ot)<<6|63&nt)<=127&&(dt=null):3===ht?(at=Ne[rt+2],128==(192&(nt=Ne[rt+1]))&&128==(192&at)&&((dt=(15&ot)<<12|(63&nt)<<6|63&at)<=2047||dt>=55296&&dt<=57343)&&(dt=null)):4===ht&&(at=Ne[rt+2],it=Ne[rt+3],128==(192&(nt=Ne[rt+1]))&&128==(192&at)&&128==(192&it)&&((dt=(15&ot)<<18|(63&nt)<<12|(63&at)<<6|63&it)<=65535||dt>=1114112)&&(dt=null)),null===dt?(dt=65533,ht=1):dt>65535&&(dt-=65536,tt+=String.fromCharCode(dt>>>10&1023|55296),dt=56320|1023&dt),tt+=String.fromCharCode(dt),rt+=ht}return tt}(this.buf,Ge,Ne)},readBytes:function(){var Ne=this.readVarint()+this.pos,Ge=this.buf.subarray(this.pos,Ne);return this.pos=Ne,Ge},readPackedVarint:function(Ne,Ge){if(this.type!==Gs.Bytes)return Ne.push(this.readVarint(Ge));var Qe=Xs(this);for(Ne=Ne||[];this.pos<Qe;)Ne.push(this.readVarint(Ge));return Ne},readPackedSVarint:function(Ne){if(this.type!==Gs.Bytes)return Ne.push(this.readSVarint());var Ge=Xs(this);for(Ne=Ne||[];this.pos<Ge;)Ne.push(this.readSVarint());return Ne},readPackedBoolean:function(Ne){if(this.type!==Gs.Bytes)return Ne.push(this.readBoolean());var Ge=Xs(this);for(Ne=Ne||[];this.pos<Ge;)Ne.push(this.readBoolean());return Ne},readPackedFloat:function(Ne){if(this.type!==Gs.Bytes)return Ne.push(this.readFloat());var Ge=Xs(this);for(Ne=Ne||[];this.pos<Ge;)Ne.push(this.readFloat());return Ne},readPackedDouble:function(Ne){if(this.type!==Gs.Bytes)return Ne.push(this.readDouble());var Ge=Xs(this);for(Ne=Ne||[];this.pos<Ge;)Ne.push(this.readDouble());return Ne},readPackedFixed32:function(Ne){if(this.type!==Gs.Bytes)return Ne.push(this.readFixed32());var Ge=Xs(this);for(Ne=Ne||[];this.pos<Ge;)Ne.push(this.readFixed32());return Ne},readPackedSFixed32:function(Ne){if(this.type!==Gs.Bytes)return Ne.push(this.readSFixed32());var Ge=Xs(this);for(Ne=Ne||[];this.pos<Ge;)Ne.push(this.readSFixed32());return Ne},readPackedFixed64:function(Ne){if(this.type!==Gs.Bytes)return Ne.push(this.readFixed64());var Ge=Xs(this);for(Ne=Ne||[];this.pos<Ge;)Ne.push(this.readFixed64());return Ne},readPackedSFixed64:function(Ne){if(this.type!==Gs.Bytes)return Ne.push(this.readSFixed64());var Ge=Xs(this);for(Ne=Ne||[];this.pos<Ge;)Ne.push(this.readSFixed64());return Ne},skip:function(Ne){var Ge=7&Ne;if(Ge===Gs.Varint)for(;this.buf[this.pos++]>127;);else if(Ge===Gs.Bytes)this.pos=this.readVarint()+this.pos;else if(Ge===Gs.Fixed32)this.pos+=4;else{if(Ge!==Gs.Fixed64)throw new Error("Unimplemented type: "+Ge);this.pos+=8}},writeTag:function(Ne,Ge){this.writeVarint(Ne<<3|Ge)},realloc:function(Ne){for(var Ge=this.length||16;Ge<this.pos+Ne;)Ge*=2;if(Ge!==this.length){var Qe=new Uint8Array(Ge);Qe.set(this.buf),this.buf=Qe,this.length=Ge}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(Ne){this.realloc(4),ou(this.buf,Ne,this.pos),this.pos+=4},writeSFixed32:function(Ne){this.realloc(4),ou(this.buf,Ne,this.pos),this.pos+=4},writeFixed64:function(Ne){this.realloc(8),ou(this.buf,-1&Ne,this.pos),ou(this.buf,Math.floor(Ne*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(Ne){this.realloc(8),ou(this.buf,-1&Ne,this.pos),ou(this.buf,Math.floor(Ne*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(Ne){(Ne=+Ne||0)>268435455||Ne<0?function(Ne,Ge){var Qe,tt;if(Ne>=0?(Qe=Ne%4294967296|0,tt=Ne/4294967296|0):(tt=~(-Ne/4294967296),4294967295^(Qe=~(-Ne%4294967296))?Qe=Qe+1|0:(Qe=0,tt=tt+1|0)),Ne>=0x10000000000000000||Ne<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");Ge.realloc(10),function(Ne,Ge,Qe){Qe.buf[Qe.pos++]=127&Ne|128,Ne>>>=7,Qe.buf[Qe.pos++]=127&Ne|128,Ne>>>=7,Qe.buf[Qe.pos++]=127&Ne|128,Ne>>>=7,Qe.buf[Qe.pos++]=127&Ne|128,Qe.buf[Qe.pos]=127&(Ne>>>=7)}(Qe,0,Ge),function(Ne,Ge){var Qe=(7&Ne)<<4;Ge.buf[Ge.pos++]|=Qe|((Ne>>>=3)?128:0),Ne&&(Ge.buf[Ge.pos++]=127&Ne|((Ne>>>=7)?128:0),Ne&&(Ge.buf[Ge.pos++]=127&Ne|((Ne>>>=7)?128:0),Ne&&(Ge.buf[Ge.pos++]=127&Ne|((Ne>>>=7)?128:0),Ne&&(Ge.buf[Ge.pos++]=127&Ne|((Ne>>>=7)?128:0),Ne&&(Ge.buf[Ge.pos++]=127&Ne)))))}(tt,Ge)}(Ne,this):(this.realloc(4),this.buf[this.pos++]=127&Ne|(Ne>127?128:0),Ne<=127||(this.buf[this.pos++]=127&(Ne>>>=7)|(Ne>127?128:0),Ne<=127||(this.buf[this.pos++]=127&(Ne>>>=7)|(Ne>127?128:0),Ne<=127||(this.buf[this.pos++]=Ne>>>7&127))))},writeSVarint:function(Ne){this.writeVarint(Ne<0?2*-Ne-1:2*Ne)},writeBoolean:function(Ne){this.writeVarint(Boolean(Ne))},writeString:function(Ne){Ne=String(Ne),this.realloc(4*Ne.length),this.pos++;var Ge=this.pos;this.pos=function(Ne,Ge,Qe){for(var tt,rt,nt=0;nt<Ge.length;nt++){if((tt=Ge.charCodeAt(nt))>55295&&tt<57344){if(!rt){tt>56319||nt+1===Ge.length?(Ne[Qe++]=239,Ne[Qe++]=191,Ne[Qe++]=189):rt=tt;continue}if(tt<56320){Ne[Qe++]=239,Ne[Qe++]=191,Ne[Qe++]=189,rt=tt;continue}tt=rt-55296<<10|tt-56320|65536,rt=null}else rt&&(Ne[Qe++]=239,Ne[Qe++]=191,Ne[Qe++]=189,rt=null);tt<128?Ne[Qe++]=tt:(tt<2048?Ne[Qe++]=tt>>6|192:(tt<65536?Ne[Qe++]=tt>>12|224:(Ne[Qe++]=tt>>18|240,Ne[Qe++]=tt>>12&63|128),Ne[Qe++]=tt>>6&63|128),Ne[Qe++]=63&tt|128)}return Qe}(this.buf,Ne,this.pos);var Qe=this.pos-Ge;Qe>=128&&Hs(Ge,Qe,this),this.pos=Ge-1,this.writeVarint(Qe),this.pos+=Qe},writeFloat:function(Ne){this.realloc(4),Ns(this.buf,Ne,this.pos,!0,23,4),this.pos+=4},writeDouble:function(Ne){this.realloc(8),Ns(this.buf,Ne,this.pos,!0,52,8),this.pos+=8},writeBytes:function(Ne){var Ge=Ne.length;this.writeVarint(Ge),this.realloc(Ge);for(var Qe=0;Qe<Ge;Qe++)this.buf[this.pos++]=Ne[Qe]},writeRawMessage:function(Ne,Ge){this.pos++;var Qe=this.pos;Ne(Ge,this);var tt=this.pos-Qe;tt>=128&&Hs(Qe,tt,this),this.pos=Qe-1,this.writeVarint(tt),this.pos+=tt},writeMessage:function(Ne,Ge,Qe){this.writeTag(Ne,Gs.Bytes),this.writeRawMessage(Ge,Qe)},writePackedVarint:function(Ne,Ge){Ge.length&&this.writeMessage(Ne,Ys,Ge)},writePackedSVarint:function(Ne,Ge){Ge.length&&this.writeMessage(Ne,$s,Ge)},writePackedBoolean:function(Ne,Ge){Ge.length&&this.writeMessage(Ne,tu,Ge)},writePackedFloat:function(Ne,Ge){Ge.length&&this.writeMessage(Ne,Ws,Ge)},writePackedDouble:function(Ne,Ge){Ge.length&&this.writeMessage(Ne,Qs,Ge)},writePackedFixed32:function(Ne,Ge){Ge.length&&this.writeMessage(Ne,eu,Ge)},writePackedSFixed32:function(Ne,Ge){Ge.length&&this.writeMessage(Ne,ru,Ge)},writePackedFixed64:function(Ne,Ge){Ge.length&&this.writeMessage(Ne,nu,Ge)},writePackedSFixed64:function(Ne,Ge){Ge.length&&this.writeMessage(Ne,iu,Ge)},writeBytesField:function(Ne,Ge){this.writeTag(Ne,Gs.Bytes),this.writeBytes(Ge)},writeFixed32Field:function(Ne,Ge){this.writeTag(Ne,Gs.Fixed32),this.writeFixed32(Ge)},writeSFixed32Field:function(Ne,Ge){this.writeTag(Ne,Gs.Fixed32),this.writeSFixed32(Ge)},writeFixed64Field:function(Ne,Ge){this.writeTag(Ne,Gs.Fixed64),this.writeFixed64(Ge)},writeSFixed64Field:function(Ne,Ge){this.writeTag(Ne,Gs.Fixed64),this.writeSFixed64(Ge)},writeVarintField:function(Ne,Ge){this.writeTag(Ne,Gs.Varint),this.writeVarint(Ge)},writeSVarintField:function(Ne,Ge){this.writeTag(Ne,Gs.Varint),this.writeSVarint(Ge)},writeStringField:function(Ne,Ge){this.writeTag(Ne,Gs.Bytes),this.writeString(Ge)},writeFloatField:function(Ne,Ge){this.writeTag(Ne,Gs.Fixed32),this.writeFloat(Ge)},writeDoubleField:function(Ne,Ge){this.writeTag(Ne,Gs.Fixed64),this.writeDouble(Ge)},writeBooleanField:function(Ne,Ge){this.writeVarintField(Ne,Boolean(Ge))}};var hu=function(Ne,Ge){var Qe=Ge.pixelRatio,tt=Ge.version,rt=Ge.stretchX,nt=Ge.stretchY,at=Ge.content;this.paddedRect=Ne,this.pixelRatio=Qe,this.stretchX=rt,this.stretchY=nt,this.content=at,this.version=tt},_f={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};_f.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},_f.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},_f.tlbr.get=function(){return this.tl.concat(this.br)},_f.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(hu.prototype,_f);var yu=function(Ne,Ge){var Qe={},tt={};this.haveRenderCallbacks=[];var rt=[];this.addImages(Ne,Qe,rt),this.addImages(Ge,tt,rt);var nt=cu(rt),at=new fo({width:nt.w||1,height:nt.h||1});for(var it in Ne){var ot=Ne[it],dt=Qe[it].paddedRect;fo.copy(ot.data,at,{x:0,y:0},{x:dt.x+1,y:dt.y+1},ot.data)}for(var ht in Ge){var Dt=Ge[ht],Ot=tt[ht].paddedRect,Rt=Ot.x+1,Zt=Ot.y+1,er=Dt.data.width,dr=Dt.data.height;fo.copy(Dt.data,at,{x:0,y:0},{x:Rt,y:Zt},Dt.data),fo.copy(Dt.data,at,{x:0,y:dr-1},{x:Rt,y:Zt-1},{width:er,height:1}),fo.copy(Dt.data,at,{x:0,y:0},{x:Rt,y:Zt+dr},{width:er,height:1}),fo.copy(Dt.data,at,{x:er-1,y:0},{x:Rt-1,y:Zt},{width:1,height:dr}),fo.copy(Dt.data,at,{x:0,y:0},{x:Rt+er,y:Zt},{width:1,height:dr})}this.image=at,this.iconPositions=Qe,this.patternPositions=tt};yu.prototype.addImages=function(Ne,Ge,Qe){for(var tt in Ne){var rt=Ne[tt],nt={x:0,y:0,w:rt.data.width+2,h:rt.data.height+2};Qe.push(nt),Ge[tt]=new hu(nt,rt),rt.hasRenderCallback&&this.haveRenderCallbacks.push(tt)}},yu.prototype.patchUpdatedImages=function(Ne,Ge){for(var Qe in Ne.dispatchRenderCallbacks(this.haveRenderCallbacks),Ne.updatedImages)this.patchUpdatedImage(this.iconPositions[Qe],Ne.getImage(Qe),Ge),this.patchUpdatedImage(this.patternPositions[Qe],Ne.getImage(Qe),Ge)},yu.prototype.patchUpdatedImage=function(Ne,Ge,Qe){if(Ne&&Ge&&Ne.version!==Ge.version){Ne.version=Ge.version;var tt=Ne.tl;Qe.update(Ge.data,void 0,{x:tt[0],y:tt[1]})}},Fn("ImagePosition",hu),Fn("ImageAtlas",yu);var wf={horizontal:1,vertical:2,horizontalOnly:3},mu=function(){this.scale=1,this.fontStack="",this.imageName=null};mu.forText=function(Ne,Ge){var Qe=new mu;return Qe.scale=Ne||1,Qe.fontStack=Ge,Qe},mu.forImage=function(Ne){var Ge=new mu;return Ge.imageName=Ne,Ge};var vu=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function gu(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt,er){var dr,mr=vu.fromFeature(Ne,rt);Dt===wf.vertical&&mr.verticalizePunctuation();var xr=ml.processBidirectionalText,br=ml.processStyledBidirectionalText;if(xr&&1===mr.sections.length){dr=[];for(var Ar=0,en=xr(mr.toString(),ku(mr,dt,nt,Ge,tt,Rt,Zt));Ar<en.length;Ar+=1){var mn=en[Ar],xn=new vu;xn.text=mn,xn.sections=mr.sections;for(var kn=0;kn<mn.length;kn++)xn.sectionIndex.push(0);dr.push(xn)}}else if(br){dr=[];for(var Cn=0,En=br(mr.text,mr.sectionIndex,ku(mr,dt,nt,Ge,tt,Rt,Zt));Cn<En.length;Cn+=1){var Pn=En[Cn],Dn=new vu;Dn.text=Pn[0],Dn.sectionIndex=Pn[1],Dn.sections=mr.sections,dr.push(Dn)}}else dr=function(Ne,Ge){for(var Qe=[],tt=Ne.text,rt=0,nt=0,at=Ge;nt<at.length;nt+=1){var it=at[nt];Qe.push(Ne.substring(rt,it)),rt=it}return rt<tt.length&&Qe.push(Ne.substring(rt,tt.length)),Qe}(mr,ku(mr,dt,nt,Ge,tt,Rt,Zt));var In=[],zn={positionedLines:In,text:mr.toString(),top:ht[1],bottom:ht[1],left:ht[0],right:ht[0],writingMode:Dt,iconsInText:!1,verticalizable:!1};return function(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt){for(var Ot=0,Rt=-17,Zt=0,er=0,dr="right"===it?1:"left"===it?0:.5,mr=0,xr=0,br=rt;xr<br.length;xr+=1){var Ar=br[xr];Ar.trim();var en=Ar.getMaxScale(),mn=24*(en-1),xn={positionedGlyphs:[],lineOffset:0};Ne.positionedLines[mr]=xn;var kn=xn.positionedGlyphs,Cn=0;if(Ar.length()){for(var En=0;En<Ar.length();En++){var Pn=Ar.getSection(En),Dn=Ar.getSectionIndex(En),In=Ar.getCharCode(En),zn=0,Bn=null,Vn=null,Hn=null,qn=24,Yn=!(ot===wf.horizontal||!ht&&!Kn(In)||ht&&(Tf[In]||(Wa=In,il.Arabic(Wa)||il["Arabic Supplement"](Wa)||il["Arabic Extended-A"](Wa)||il["Arabic Presentation Forms-A"](Wa)||il["Arabic Presentation Forms-B"](Wa))));if(Pn.imageName){var $n=tt[Pn.imageName];if(!$n)continue;Hn=Pn.imageName,Ne.iconsInText=Ne.iconsInText||!0,Vn=$n.paddedRect;var ra=$n.displaySize;Pn.scale=24*Pn.scale/Dt,zn=mn+(24-ra[1]*Pn.scale),qn=(Bn={width:ra[0],height:ra[1],left:1,top:-3,advance:Yn?ra[1]:ra[0]}).advance;var oa=Yn?ra[0]*Pn.scale-24*en:ra[1]*Pn.scale-24*en;oa>0&&oa>Cn&&(Cn=oa)}else{var pa=Qe[Pn.fontStack],ga=pa&&pa[In];if(ga&&ga.rect)Vn=ga.rect,Bn=ga.metrics;else{var ma=Ge[Pn.fontStack],_a=ma&&ma[In];if(!_a)continue;Bn=_a.metrics}zn=24*(en-Pn.scale)}Yn?(Ne.verticalizable=!0,kn.push({glyph:In,imageName:Hn,x:Ot,y:Rt+zn,vertical:Yn,scale:Pn.scale,fontStack:Pn.fontStack,sectionIndex:Dn,metrics:Bn,rect:Vn}),Ot+=qn*Pn.scale+dt):(kn.push({glyph:In,imageName:Hn,x:Ot,y:Rt+zn,vertical:Yn,scale:Pn.scale,fontStack:Pn.fontStack,sectionIndex:Dn,metrics:Bn,rect:Vn}),Ot+=Bn.advance*Pn.scale+dt)}0!==kn.length&&(Zt=Math.max(Ot-dt,Zt),zu(kn,0,kn.length-1,dr,Cn)),Ot=0;var Va=nt*en+Cn;xn.lineOffset=Math.max(Cn,mn),Rt+=Va,er=Math.max(Va,er),++mr}else Rt+=nt,++mr}var Wa,Qa=Rt- -17,ti=Iu(at),ni=ti.horizontalAlign,di=ti.verticalAlign;(function(Ne,Ge,Qe,tt,rt,nt,at,it,ot){var dt,ht=(Ge-Qe)*rt;dt=nt!==at?-it*tt- -17:(-tt*ot+.5)*at;for(var Dt=0,Ot=Ne;Dt<Ot.length;Dt+=1)for(var Rt=0,Zt=Ot[Dt].positionedGlyphs;Rt<Zt.length;Rt+=1){var er=Zt[Rt];er.x+=ht,er.y+=dt}})(Ne.positionedLines,dr,ni,di,Zt,er,nt,Qa,rt.length),Ne.top+=-di*Qa,Ne.bottom=Ne.top+Qa,Ne.left+=-ni*Zt,Ne.right=Ne.left+Zt}(zn,Ge,Qe,tt,dr,at,it,ot,Dt,dt,Ot,er),!function(Ne){for(var Ge=0,Qe=Ne;Ge<Qe.length;Ge+=1)if(0!==Qe[Ge].positionedGlyphs.length)return!1;return!0}(In)&&zn}vu.fromFeature=function(Ne,Ge){for(var Qe=new vu,tt=0;tt<Ne.sections.length;tt++){var rt=Ne.sections[tt];rt.image?Qe.addImageSection(rt):Qe.addTextSection(rt,Ge)}return Qe},vu.prototype.length=function(){return this.text.length},vu.prototype.getSection=function(Ne){return this.sections[this.sectionIndex[Ne]]},vu.prototype.getSectionIndex=function(Ne){return this.sectionIndex[Ne]},vu.prototype.getCharCode=function(Ne){return this.text.charCodeAt(Ne)},vu.prototype.verticalizePunctuation=function(){this.text=function(Ne){for(var Ge="",Qe=0;Qe<Ne.length;Qe++){var tt=Ne.charCodeAt(Qe+1)||null,rt=Ne.charCodeAt(Qe-1)||null;Ge+=tt&&Gn(tt)&&!yf[Ne[Qe+1]]||rt&&Gn(rt)&&!yf[Ne[Qe-1]]||!yf[Ne[Qe]]?Ne[Qe]:yf[Ne[Qe]]}return Ge}(this.text)},vu.prototype.trim=function(){for(var Ne=0,Ge=0;Ge<this.text.length&&Tf[this.text.charCodeAt(Ge)];Ge++)Ne++;for(var Qe=this.text.length,tt=this.text.length-1;tt>=0&&tt>=Ne&&Tf[this.text.charCodeAt(tt)];tt--)Qe--;this.text=this.text.substring(Ne,Qe),this.sectionIndex=this.sectionIndex.slice(Ne,Qe)},vu.prototype.substring=function(Ne,Ge){var Qe=new vu;return Qe.text=this.text.substring(Ne,Ge),Qe.sectionIndex=this.sectionIndex.slice(Ne,Ge),Qe.sections=this.sections,Qe},vu.prototype.toString=function(){return this.text},vu.prototype.getMaxScale=function(){var Ne=this;return this.sectionIndex.reduce((function(Ge,Qe){return Math.max(Ge,Ne.sections[Qe].scale)}),0)},vu.prototype.addTextSection=function(Ne,Ge){this.text+=Ne.text,this.sections.push(mu.forText(Ne.scale,Ne.fontStack||Ge));for(var Qe=this.sections.length-1,tt=0;tt<Ne.text.length;++tt)this.sectionIndex.push(Qe)},vu.prototype.addImageSection=function(Ne){var Ge=Ne.image?Ne.image.name:"";if(0!==Ge.length){var Qe=this.getNextImageSectionCharCode();Qe?(this.text+=String.fromCharCode(Qe),this.sections.push(mu.forImage(Ge)),this.sectionIndex.push(this.sections.length-1)):w("Reached maximum number of images 6401")}else w("Can't add FormattedSection with an empty image.")},vu.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Tf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},kf={};function wu(Ne,Ge,Qe,tt,rt,nt){if(Ge.imageName){var at=tt[Ge.imageName];return at?at.displaySize[0]*Ge.scale*24/nt+rt:0}var it=Qe[Ge.fontStack],ot=it&&it[Ne];return ot?ot.metrics.advance*Ge.scale+rt:0}function _u(Ne,Ge,Qe,tt){var rt=Math.pow(Ne-Ge,2);return tt?Ne<Ge?rt/2:2*rt:rt+Math.abs(Qe)*Qe}function Au(Ne,Ge,Qe){var tt=0;return 10===Ne&&(tt-=1e4),Qe&&(tt+=150),40!==Ne&&65288!==Ne||(tt+=50),41!==Ge&&65289!==Ge||(tt+=50),tt}function Su(Ne,Ge,Qe,tt,rt,nt){for(var at=null,it=_u(Ge,Qe,rt,nt),ot=0,dt=tt;ot<dt.length;ot+=1){var ht=dt[ot],Dt=_u(Ge-ht.x,Qe,rt,nt)+ht.badness;Dt<=it&&(at=ht,it=Dt)}return{index:Ne,x:Ge,priorBreak:at,badness:it}}function ku(Ne,Ge,Qe,tt,rt,nt,at){if("point"!==nt)return[];if(!Ne)return[];for(var it,ot=[],dt=function(Ne,Ge,Qe,tt,rt,nt){for(var at=0,it=0;it<Ne.length();it++){var ot=Ne.getSection(it);at+=wu(Ne.getCharCode(it),ot,tt,rt,Ge,nt)}return at/Math.max(1,Math.ceil(at/Qe))}(Ne,Ge,Qe,tt,rt,at),ht=Ne.text.indexOf("â")>=0,Dt=0,Ot=0;Ot<Ne.length();Ot++){var Rt=Ne.getSection(Ot),Zt=Ne.getCharCode(Ot);if(Tf[Zt]||(Dt+=wu(Zt,Rt,tt,rt,Ge,at)),Ot<Ne.length()-1){var er=!((it=Zt)<11904||!(il["Bopomofo Extended"](it)||il.Bopomofo(it)||il["CJK Compatibility Forms"](it)||il["CJK Compatibility Ideographs"](it)||il["CJK Compatibility"](it)||il["CJK Radicals Supplement"](it)||il["CJK Strokes"](it)||il["CJK Symbols and Punctuation"](it)||il["CJK Unified Ideographs Extension A"](it)||il["CJK Unified Ideographs"](it)||il["Enclosed CJK Letters and Months"](it)||il["Halfwidth and Fullwidth Forms"](it)||il.Hiragana(it)||il["Ideographic Description Characters"](it)||il["Kangxi Radicals"](it)||il["Katakana Phonetic Extensions"](it)||il.Katakana(it)||il["Vertical Forms"](it)||il["Yi Radicals"](it)||il["Yi Syllables"](it)));(kf[Zt]||er||Rt.imageName)&&ot.push(Su(Ot+1,Dt,dt,ot,Au(Zt,Ne.getCharCode(Ot+1),er&&ht),!1))}}return function t(Ne){return Ne?t(Ne.priorBreak).concat(Ne.index):[]}(Su(Ne.length(),Dt,dt,ot,0,!0))}function Iu(Ne){var Ge=.5,Qe=.5;switch(Ne){case"right":case"top-right":case"bottom-right":Ge=1;break;case"left":case"top-left":case"bottom-left":Ge=0}switch(Ne){case"bottom":case"bottom-right":case"bottom-left":Qe=1;break;case"top":case"top-right":case"top-left":Qe=0}return{horizontalAlign:Ge,verticalAlign:Qe}}function zu(Ne,Ge,Qe,tt,rt){if(tt||rt)for(var nt=Ne[Qe],at=(Ne[Qe].x+nt.metrics.advance*nt.scale)*tt,it=Ge;it<=Qe;it++)Ne[it].x-=at,Ne[it].y+=rt}function Cu(Ne,Ge,Qe,tt,rt,nt){var at,it=Ne.image;if(it.content){var ot=it.content,dt=it.pixelRatio||1;at=[ot[0]/dt,ot[1]/dt,it.displaySize[0]-ot[2]/dt,it.displaySize[1]-ot[3]/dt]}var ht,Dt,Ot,Rt,Zt=Ge.left*nt,er=Ge.right*nt;"width"===Qe||"both"===Qe?(Rt=rt[0]+Zt-tt[3],Dt=rt[0]+er+tt[1]):Dt=(Rt=rt[0]+(Zt+er-it.displaySize[0])/2)+it.displaySize[0];var dr=Ge.top*nt,mr=Ge.bottom*nt;return"height"===Qe||"both"===Qe?(ht=rt[1]+dr-tt[0],Ot=rt[1]+mr+tt[2]):Ot=(ht=rt[1]+(dr+mr-it.displaySize[1])/2)+it.displaySize[1],{image:it,top:ht,right:Dt,bottom:Ot,left:Rt,collisionPadding:at}}kf[10]=!0,kf[32]=!0,kf[38]=!0,kf[40]=!0,kf[41]=!0,kf[43]=!0,kf[45]=!0,kf[47]=!0,kf[173]=!0,kf[183]=!0,kf[8203]=!0,kf[8208]=!0,kf[8211]=!0,kf[8231]=!0;var Af=function(Ne){function e(Ge,Qe,tt,rt){Ne.call(this,Ge,Qe),this.angle=tt,void 0!==rt&&(this.segment=rt)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.clone=function(){return new e(this.x,this.y,this.angle,this.segment)},e}(Qe);function Eu(Ne,Ge){var Qe=Ge.expression;if("constant"===Qe.kind)return{kind:"constant",layoutSize:Qe.evaluate(new ii(Ne+1))};if("source"===Qe.kind)return{kind:"source"};for(var tt=Qe.zoomStops,rt=Qe.interpolationType,nt=0;nt<tt.length&&tt[nt]<=Ne;)nt++;for(var at=nt=Math.max(0,nt-1);at<tt.length&&tt[at]<Ne+1;)at++;at=Math.min(tt.length-1,at);var it=tt[nt],ot=tt[at];return"composite"===Qe.kind?{kind:"composite",minZoom:it,maxZoom:ot,interpolationType:rt}:{kind:"camera",minZoom:it,maxZoom:ot,minSize:Qe.evaluate(new ii(it)),maxSize:Qe.evaluate(new ii(ot)),interpolationType:rt}}function Tu(Ne,Ge,Qe){var tt=Ge.uSize,rt=Qe.lowerSize;return"source"===Ne.kind?rt/128:"composite"===Ne.kind?je(rt/128,Qe.upperSize/128,Ge.uSizeT):tt}function Pu(Ne,Ge){var Qe=0,tt=0;if("constant"===Ne.kind)tt=Ne.layoutSize;else if("source"!==Ne.kind){var rt=Ne.interpolationType,nt=rt?u(rr.interpolationFactor(rt,Ge,Ne.minZoom,Ne.maxZoom),0,1):0;"camera"===Ne.kind?tt=je(Ne.minSize,Ne.maxSize,nt):Qe=nt}return{uSizeT:Qe,uSize:tt}}Fn("Anchor",Af);var Mf=Object.freeze({__proto__:null,getSizeData:Eu,evaluateSizeForFeature:Tu,evaluateSizeForZoom:Pu,SIZE_PACK_FACTOR:128});function Vu(Ne,Ge,Qe,tt,rt){if(void 0===Ge.segment)return!0;for(var nt=Ge,at=Ge.segment+1,it=0;it>-Qe/2;){if(--at<0)return!1;it-=Ne[at].dist(nt),nt=Ne[at]}it+=Ne[at].dist(Ne[at+1]),at++;for(var ot=[],dt=0;it<Qe/2;){var ht=Ne[at],Dt=Ne[at+1];if(!Dt)return!1;var Ot=Ne[at-1].angleTo(ht)-ht.angleTo(Dt);for(Ot=Math.abs((Ot+3*Math.PI)%(2*Math.PI)-Math.PI),ot.push({distance:it,angleDelta:Ot}),dt+=Ot;it-ot[0].distance>tt;)dt-=ot.shift().angleDelta;if(dt>rt)return!1;at++,it+=ht.dist(Dt)}return!0}function Fu(Ne){for(var Ge=0,Qe=0;Qe<Ne.length-1;Qe++)Ge+=Ne[Qe].dist(Ne[Qe+1]);return Ge}function Du(Ne,Ge,Qe){return Ne?.6*Ge*Qe:0}function Lu(Ne,Ge){return Math.max(Ne?Ne.right-Ne.left:0,Ge?Ge.right-Ge.left:0)}function Ru(Ne,Ge,Qe,tt,rt,nt){for(var at=Du(Qe,rt,nt),it=Lu(Qe,tt)*nt,ot=0,dt=Fu(Ne)/2,ht=0;ht<Ne.length-1;ht++){var Dt=Ne[ht],Ot=Ne[ht+1],Rt=Dt.dist(Ot);if(ot+Rt>dt){var Zt=(dt-ot)/Rt,er=je(Dt.x,Ot.x,Zt),dr=je(Dt.y,Ot.y,Zt),mr=new Af(er,dr,Ot.angleTo(Dt),ht);return mr._round(),!at||Vu(Ne,mr,it,at,Ge)?mr:void 0}ot+=Rt}}function Ou(Ne,Ge,Qe,tt,rt,nt,at,it,ot){var dt=Du(tt,nt,at),ht=Lu(tt,rt),Dt=ht*at,Ot=0===Ne[0].x||Ne[0].x===ot||0===Ne[0].y||Ne[0].y===ot;return Ge-Dt<Ge/4&&(Ge=Dt+Ge/4),function t(Ne,Ge,Qe,tt,rt,nt,at,it,ot){for(var dt=nt/2,ht=Fu(Ne),Dt=0,Ot=Ge-Qe,Rt=[],Zt=0;Zt<Ne.length-1;Zt++){for(var er=Ne[Zt],dr=Ne[Zt+1],mr=er.dist(dr),xr=dr.angleTo(er);Ot+Qe<Dt+mr;){var br=((Ot+=Qe)-Dt)/mr,Ar=je(er.x,dr.x,br),en=je(er.y,dr.y,br);if(Ar>=0&&Ar<ot&&en>=0&&en<ot&&Ot-dt>=0&&Ot+dt<=ht){var mn=new Af(Ar,en,xr,Zt);mn._round(),tt&&!Vu(Ne,mn,nt,tt,rt)||Rt.push(mn)}}Dt+=mr}return it||Rt.length||at||(Rt=t(Ne,Dt/2,Qe,tt,rt,nt,at,!0,ot)),Rt}(Ne,Ot?Ge/2*it%Ge:(ht/2+2*nt)*at*it%Ge,Ge,dt,Qe,Dt,Ot,!1,ot)}function Uu(Ne,Ge,tt,rt,nt){for(var at=[],it=0;it<Ne.length;it++)for(var ot=Ne[it],dt=void 0,ht=0;ht<ot.length-1;ht++){var Dt=ot[ht],Ot=ot[ht+1];Dt.x<Ge&&Ot.x<Ge||(Dt.x<Ge?Dt=new Qe(Ge,Dt.y+(Ge-Dt.x)/(Ot.x-Dt.x)*(Ot.y-Dt.y))._round():Ot.x<Ge&&(Ot=new Qe(Ge,Dt.y+(Ge-Dt.x)/(Ot.x-Dt.x)*(Ot.y-Dt.y))._round()),Dt.y<tt&&Ot.y<tt||(Dt.y<tt?Dt=new Qe(Dt.x+(tt-Dt.y)/(Ot.y-Dt.y)*(Ot.x-Dt.x),tt)._round():Ot.y<tt&&(Ot=new Qe(Dt.x+(tt-Dt.y)/(Ot.y-Dt.y)*(Ot.x-Dt.x),tt)._round()),Dt.x>=rt&&Ot.x>=rt||(Dt.x>=rt?Dt=new Qe(rt,Dt.y+(rt-Dt.x)/(Ot.x-Dt.x)*(Ot.y-Dt.y))._round():Ot.x>=rt&&(Ot=new Qe(rt,Dt.y+(rt-Dt.x)/(Ot.x-Dt.x)*(Ot.y-Dt.y))._round()),Dt.y>=nt&&Ot.y>=nt||(Dt.y>=nt?Dt=new Qe(Dt.x+(nt-Dt.y)/(Ot.y-Dt.y)*(Ot.x-Dt.x),nt)._round():Ot.y>=nt&&(Ot=new Qe(Dt.x+(nt-Dt.y)/(Ot.y-Dt.y)*(Ot.x-Dt.x),nt)._round()),dt&&Dt.equals(dt[dt.length-1])||at.push(dt=[Dt]),dt.push(Ot)))))}return at}function ju(Ne,Ge,tt,rt){var nt=[],at=Ne.image,it=at.pixelRatio,ot=at.paddedRect.w-2,dt=at.paddedRect.h-2,ht=Ne.right-Ne.left,Dt=Ne.bottom-Ne.top,Ot=at.stretchX||[[0,ot]],Rt=at.stretchY||[[0,dt]],y=function(Ne,Ge){return Ne+Ge[1]-Ge[0]},Zt=Ot.reduce(y,0),er=Rt.reduce(y,0),dr=ot-Zt,mr=dt-er,xr=0,br=Zt,Ar=0,en=er,mn=0,xn=dr,kn=0,Cn=mr;if(at.content&&rt){var En=at.content;xr=qu(Ot,0,En[0]),Ar=qu(Rt,0,En[1]),br=qu(Ot,En[0],En[2]),en=qu(Rt,En[1],En[3]),mn=En[0]-xr,kn=En[1]-Ar,xn=En[2]-En[0]-br,Cn=En[3]-En[1]-en}var C=function(rt,nt,ot,dt){var Ot=Ku(rt.stretch-xr,br,ht,Ne.left),Rt=Gu(rt.fixed-mn,xn,rt.stretch,Zt),dr=Ku(nt.stretch-Ar,en,Dt,Ne.top),mr=Gu(nt.fixed-kn,Cn,nt.stretch,er),En=Ku(ot.stretch-xr,br,ht,Ne.left),Pn=Gu(ot.fixed-mn,xn,ot.stretch,Zt),Dn=Ku(dt.stretch-Ar,en,Dt,Ne.top),In=Gu(dt.fixed-kn,Cn,dt.stretch,er),zn=new Qe(Ot,dr),Bn=new Qe(En,dr),Vn=new Qe(En,Dn),Hn=new Qe(Ot,Dn),qn=new Qe(Rt/it,mr/it),Yn=new Qe(Pn/it,In/it),$n=Ge*Math.PI/180;if($n){var ra=Math.sin($n),oa=Math.cos($n),pa=[oa,-ra,ra,oa];zn._matMult(pa),Bn._matMult(pa),Hn._matMult(pa),Vn._matMult(pa)}var ga=rt.stretch+rt.fixed,ma=nt.stretch+nt.fixed;return{tl:zn,tr:Bn,bl:Hn,br:Vn,tex:{x:at.paddedRect.x+1+ga,y:at.paddedRect.y+1+ma,w:ot.stretch+ot.fixed-ga,h:dt.stretch+dt.fixed-ma},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:qn,pixelOffsetBR:Yn,minFontScaleX:xn/it/ht,minFontScaleY:Cn/it/Dt,isSDF:tt}};if(rt&&(at.stretchX||at.stretchY))for(var Pn=Nu(Ot,dr,Zt),Dn=Nu(Rt,mr,er),In=0;In<Pn.length-1;In++)for(var zn=Pn[In],Bn=Pn[In+1],Vn=0;Vn<Dn.length-1;Vn++)nt.push(C(zn,Dn[Vn],Bn,Dn[Vn+1]));else nt.push(C({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:ot+1},{fixed:0,stretch:dt+1}));return nt}function qu(Ne,Ge,Qe){for(var tt=0,rt=0,nt=Ne;rt<nt.length;rt+=1){var at=nt[rt];tt+=Math.max(Ge,Math.min(Qe,at[1]))-Math.max(Ge,Math.min(Qe,at[0]))}return tt}function Nu(Ne,Ge,Qe){for(var tt=[{fixed:-1,stretch:0}],rt=0,nt=Ne;rt<nt.length;rt+=1){var at=nt[rt],it=at[0],ot=at[1],dt=tt[tt.length-1];tt.push({fixed:it-dt.stretch,stretch:dt.stretch}),tt.push({fixed:it-dt.stretch,stretch:dt.stretch+(ot-it)})}return tt.push({fixed:Ge+1,stretch:Qe}),tt}function Ku(Ne,Ge,Qe,tt){return Ne/Ge*Qe+tt}function Gu(Ne,Ge,Qe,tt){return Ne-Ge*Qe/tt}var Zu=function(Ne,Ge,tt,rt,nt,at,it,ot,dt,ht){if(this.boxStartIndex=Ne.length,dt){var Dt=at.top,Ot=at.bottom,Rt=at.collisionPadding;Rt&&(Dt-=Rt[1],Ot+=Rt[3]);var Zt=Ot-Dt;Zt>0&&(Zt=Math.max(10,Zt),this.circleDiameter=Zt)}else{var er=at.top*it-ot,dr=at.bottom*it+ot,mr=at.left*it-ot,xr=at.right*it+ot,br=at.collisionPadding;if(br&&(mr-=br[0]*it,er-=br[1]*it,xr+=br[2]*it,dr+=br[3]*it),ht){var Ar=new Qe(mr,er),en=new Qe(xr,er),mn=new Qe(mr,dr),xn=new Qe(xr,dr),kn=ht*Math.PI/180;Ar._rotate(kn),en._rotate(kn),mn._rotate(kn),xn._rotate(kn),mr=Math.min(Ar.x,en.x,mn.x,xn.x),xr=Math.max(Ar.x,en.x,mn.x,xn.x),er=Math.min(Ar.y,en.y,mn.y,xn.y),dr=Math.max(Ar.y,en.y,mn.y,xn.y)}Ne.emplaceBack(Ge.x,Ge.y,mr,er,xr,dr,tt,rt,nt)}this.boxEndIndex=Ne.length},Xu=function(Ne,Ge){if(void 0===Ne&&(Ne=[]),void 0===Ge&&(Ge=Ju),this.data=Ne,this.length=this.data.length,this.compare=Ge,this.length>0)for(var Qe=(this.length>>1)-1;Qe>=0;Qe--)this._down(Qe)};function Ju(Ne,Ge){return Ne<Ge?-1:Ne>Ge?1:0}function Hu(Ne,Ge,tt){void 0===Ge&&(Ge=1),void 0===tt&&(tt=!1);for(var rt=1/0,nt=1/0,at=-1/0,it=-1/0,ot=Ne[0],dt=0;dt<ot.length;dt++){var ht=ot[dt];(!dt||ht.x<rt)&&(rt=ht.x),(!dt||ht.y<nt)&&(nt=ht.y),(!dt||ht.x>at)&&(at=ht.x),(!dt||ht.y>it)&&(it=ht.y)}var Dt=Math.min(at-rt,it-nt),Ot=Dt/2,Rt=new Xu([],Yu);if(0===Dt)return new Qe(rt,nt);for(var Zt=rt;Zt<at;Zt+=Dt)for(var er=nt;er<it;er+=Dt)Rt.push(new $u(Zt+Ot,er+Ot,Ot,Ne));for(var dr=function(Ne){for(var Ge=0,Qe=0,tt=0,rt=Ne[0],nt=0,at=rt.length,it=at-1;nt<at;it=nt++){var ot=rt[nt],dt=rt[it],ht=ot.x*dt.y-dt.x*ot.y;Qe+=(ot.x+dt.x)*ht,tt+=(ot.y+dt.y)*ht,Ge+=3*ht}return new $u(Qe/Ge,tt/Ge,0,Ne)}(Ne),mr=Rt.length;Rt.length;){var xr=Rt.pop();(xr.d>dr.d||!dr.d)&&(dr=xr,tt&&console.log("found best %d after %d probes",Math.round(1e4*xr.d)/1e4,mr)),xr.max-dr.d<=Ge||(Rt.push(new $u(xr.p.x-(Ot=xr.h/2),xr.p.y-Ot,Ot,Ne)),Rt.push(new $u(xr.p.x+Ot,xr.p.y-Ot,Ot,Ne)),Rt.push(new $u(xr.p.x-Ot,xr.p.y+Ot,Ot,Ne)),Rt.push(new $u(xr.p.x+Ot,xr.p.y+Ot,Ot,Ne)),mr+=4)}return tt&&(console.log("num probes: "+mr),console.log("best distance: "+dr.d)),dr.p}function Yu(Ne,Ge){return Ge.max-Ne.max}function $u(Ne,Ge,tt,rt){this.p=new Qe(Ne,Ge),this.h=tt,this.d=function(Ne,Ge){for(var Qe=!1,tt=1/0,rt=0;rt<Ge.length;rt++)for(var nt=Ge[rt],at=0,it=nt.length,ot=it-1;at<it;ot=at++){var dt=nt[at],ht=nt[ot];dt.y>Ne.y!=ht.y>Ne.y&&Ne.x<(ht.x-dt.x)*(Ne.y-dt.y)/(ht.y-dt.y)+dt.x&&(Qe=!Qe),tt=Math.min(tt,Ga(Ne,dt,ht))}return(Qe?1:-1)*Math.sqrt(tt)}(this.p,rt),this.max=this.d+this.h*Math.SQRT2}Xu.prototype.push=function(Ne){this.data.push(Ne),this.length++,this._up(this.length-1)},Xu.prototype.pop=function(){if(0!==this.length){var Ne=this.data[0],Ge=this.data.pop();return this.length--,this.length>0&&(this.data[0]=Ge,this._down(0)),Ne}},Xu.prototype.peek=function(){return this.data[0]},Xu.prototype._up=function(Ne){for(var Ge=this.data,Qe=this.compare,tt=Ge[Ne];Ne>0;){var rt=Ne-1>>1,nt=Ge[rt];if(Qe(tt,nt)>=0)break;Ge[Ne]=nt,Ne=rt}Ge[Ne]=tt},Xu.prototype._down=function(Ne){for(var Ge=this.data,Qe=this.compare,tt=this.length>>1,rt=Ge[Ne];Ne<tt;){var nt=1+(Ne<<1),at=Ge[nt],it=nt+1;if(it<this.length&&Qe(Ge[it],at)<0&&(nt=it,at=Ge[it]),Qe(at,rt)>=0)break;Ge[Ne]=at,Ne=nt}Ge[Ne]=rt};var Sf=Number.POSITIVE_INFINITY;function Qu(Ne,Ge){return Ge[1]!==Sf?function(Ne,Ge,Qe){var tt=0,rt=0;switch(Ge=Math.abs(Ge),Qe=Math.abs(Qe),Ne){case"top-right":case"top-left":case"top":rt=Qe-7;break;case"bottom-right":case"bottom-left":case"bottom":rt=7-Qe}switch(Ne){case"top-right":case"bottom-right":case"right":tt=-Ge;break;case"top-left":case"bottom-left":case"left":tt=Ge}return[tt,rt]}(Ne,Ge[0],Ge[1]):function(Ne,Ge){var Qe=0,tt=0;Ge<0&&(Ge=0);var rt=Ge/Math.sqrt(2);switch(Ne){case"top-right":case"top-left":tt=rt-7;break;case"bottom-right":case"bottom-left":tt=7-rt;break;case"bottom":tt=7-Ge;break;case"top":tt=Ge-7}switch(Ne){case"top-right":case"bottom-right":Qe=-rt;break;case"top-left":case"bottom-left":Qe=rt;break;case"left":Qe=Ge;break;case"right":Qe=-Ge}return[Qe,tt]}(Ne,Ge[0])}function tl(Ne){switch(Ne){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function el(Ne,Ge,tt,rt,nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt,er){var dr=function(Ne,Ge,tt,rt,nt,at,it,ot){for(var dt=rt.layout.get("text-rotate").evaluate(at,{})*Math.PI/180,ht=[],Dt=0,Ot=Ge.positionedLines;Dt<Ot.length;Dt+=1)for(var Rt=Ot[Dt],Zt=0,er=Rt.positionedGlyphs;Zt<er.length;Zt+=1){var dr=er[Zt];if(dr.rect){var mr=dr.rect||{},xr=4,br=!0,Ar=1,en=0,mn=(nt||ot)&&dr.vertical,xn=dr.metrics.advance*dr.scale/2;if(ot&&Ge.verticalizable&&(en=Rt.lineOffset/2-(dr.imageName?-(24-dr.metrics.width*dr.scale)/2:24*(dr.scale-1))),dr.imageName){var kn=it[dr.imageName];br=kn.sdf,xr=1/(Ar=kn.pixelRatio)}var Cn=nt?[dr.x+xn,dr.y]:[0,0],En=nt?[0,0]:[dr.x+xn+tt[0],dr.y+tt[1]-en],Pn=[0,0];mn&&(Pn=En,En=[0,0]);var Dn=(dr.metrics.left-xr)*dr.scale-xn+En[0],In=(-dr.metrics.top-xr)*dr.scale+En[1],zn=Dn+mr.w*dr.scale/Ar,Bn=In+mr.h*dr.scale/Ar,Vn=new Qe(Dn,In),Hn=new Qe(zn,In),qn=new Qe(Dn,Bn),Yn=new Qe(zn,Bn);if(mn){var $n=new Qe(-xn,xn- -17),ra=-Math.PI/2,oa=12-xn,pa=new Qe(22-oa,-(dr.imageName?oa:0)),ga=new(Function.prototype.bind.apply(Qe,[null].concat(Pn)));Vn._rotateAround(ra,$n)._add(pa)._add(ga),Hn._rotateAround(ra,$n)._add(pa)._add(ga),qn._rotateAround(ra,$n)._add(pa)._add(ga),Yn._rotateAround(ra,$n)._add(pa)._add(ga)}if(dt){var ma=Math.sin(dt),_a=Math.cos(dt),Va=[_a,-ma,ma,_a];Vn._matMult(Va),Hn._matMult(Va),qn._matMult(Va),Yn._matMult(Va)}var Wa=new Qe(0,0),Qa=new Qe(0,0);ht.push({tl:Vn,tr:Hn,bl:qn,br:Yn,tex:mr,writingMode:Ge.writingMode,glyphOffset:Cn,sectionIndex:dr.sectionIndex,isSDF:br,pixelOffsetTL:Wa,pixelOffsetBR:Qa,minFontScaleX:0,minFontScaleY:0})}}return ht}(0,tt,ot,nt,at,it,rt,Ne.allowVerticalPlacement),mr=Ne.textSizeData,xr=null;"source"===mr.kind?(xr=[128*nt.layout.get("text-size").evaluate(it,{})])[0]>32640&&w(Ne.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):"composite"===mr.kind&&((xr=[128*Zt.compositeTextSizes[0].evaluate(it,{},er),128*Zt.compositeTextSizes[1].evaluate(it,{},er)])[0]>32640||xr[1]>32640)&&w(Ne.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),Ne.addSymbols(Ne.text,dr,xr,ot,at,it,ht,Ge,dt.lineStartIndex,dt.lineLength,Rt,er);for(var br=0,Ar=Dt;br<Ar.length;br+=1)Ot[Ar[br]]=Ne.text.placedSymbolArray.length-1;return 4*dr.length}function rl(Ne){for(var Ge in Ne)return Ne[Ge];return null}function nl(Ne,Ge,Qe,tt){var rt=Ne.compareText;if(Ge in rt){for(var nt=rt[Ge],at=nt.length-1;at>=0;at--)if(tt.dist(nt[at])<Qe)return!0}else rt[Ge]=[];return rt[Ge].push(tt),!1}var Cf=Wu.VectorTileFeature.types,Ef=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function ol(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt,Ot){var Rt=it?Math.min(32640,Math.round(it[0])):0,Zt=it?Math.min(32640,Math.round(it[1])):0;Ne.emplaceBack(Ge,Qe,Math.round(32*tt),Math.round(32*rt),nt,at,(Rt<<1)+(ot?1:0),Zt,16*dt,16*ht,256*Dt,256*Ot)}function sl(Ne,Ge,Qe){Ne.emplaceBack(Ge.x,Ge.y,Qe),Ne.emplaceBack(Ge.x,Ge.y,Qe),Ne.emplaceBack(Ge.x,Ge.y,Qe),Ne.emplaceBack(Ge.x,Ge.y,Qe)}function ul(Ne){for(var Ge=0,Qe=Ne.sections;Ge<Qe.length;Ge+=1)if(Jn(Qe[Ge].text))return!0;return!1}var ll=function(Ne){this.layoutVertexArray=new Il,this.indexArray=new ac,this.programConfigurations=Ne,this.segments=new ia,this.dynamicLayoutVertexArray=new Bl,this.opacityVertexArray=new Xl,this.placedSymbolArray=new vc};ll.prototype.isEmpty=function(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length},ll.prototype.upload=function(Ne,Ge,Qe,tt){this.isEmpty()||(Qe&&(this.layoutVertexBuffer=Ne.createVertexBuffer(this.layoutVertexArray,df.members),this.indexBuffer=Ne.createIndexBuffer(this.indexArray,Ge),this.dynamicLayoutVertexBuffer=Ne.createVertexBuffer(this.dynamicLayoutVertexArray,hf.members,!0),this.opacityVertexBuffer=Ne.createVertexBuffer(this.opacityVertexArray,Ef,!0),this.opacityVertexBuffer.itemSize=1),(Qe||tt)&&this.programConfigurations.upload(Ne))},ll.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},Fn("SymbolBuffers",ll);var pl=function(Ne,Ge,Qe){this.layoutVertexArray=new Ne,this.layoutAttributes=Ge,this.indexArray=new Qe,this.segments=new ia,this.collisionVertexArray=new nc};pl.prototype.upload=function(Ne){this.layoutVertexBuffer=Ne.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=Ne.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=Ne.createVertexBuffer(this.collisionVertexArray,gf.members,!0)},pl.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},Fn("CollisionBuffers",pl);var cl=function(Ne){this.collisionBoxArray=Ne.collisionBoxArray,this.zoom=Ne.zoom,this.overscaling=Ne.overscaling,this.layers=Ne.layers,this.layerIds=this.layers.map((function(Ne){return Ne.id})),this.index=Ne.index,this.pixelRatio=Ne.pixelRatio,this.sourceLayerIndex=Ne.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=eo([]),this.placementViewportMatrix=eo([]);var Ge=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Eu(this.zoom,Ge["text-size"]),this.iconSizeData=Eu(this.zoom,Ge["icon-size"]);var Qe=this.layers[0].layout,tt=Qe.get("symbol-sort-key"),rt=Qe.get("symbol-z-order");this.sortFeaturesByKey="viewport-y"!==rt&&void 0!==tt.constantOr(1),this.sortFeaturesByY=("viewport-y"===rt||"auto"===rt&&!this.sortFeaturesByKey)&&(Qe.get("text-allow-overlap")||Qe.get("icon-allow-overlap")||Qe.get("text-ignore-placement")||Qe.get("icon-ignore-placement")),"point"===Qe.get("symbol-placement")&&(this.writingModes=Qe.get("text-writing-mode").map((function(Ne){return wf[Ne]}))),this.stateDependentLayerIds=this.layers.filter((function(Ne){return Ne.isStateDependent()})).map((function(Ne){return Ne.id})),this.sourceID=Ne.sourceID};cl.prototype.createArrays=function(){this.text=new ll(new Ta(df.members,this.layers,this.zoom,(function(Ne){return/^text/.test(Ne)}))),this.icon=new ll(new Ta(df.members,this.layers,this.zoom,(function(Ne){return/^icon/.test(Ne)}))),this.glyphOffsetArray=new bc,this.lineVertexArray=new _c,this.symbolInstances=new xc},cl.prototype.calculateGlyphDependencies=function(Ne,Ge,Qe,tt,rt){for(var nt=0;nt<Ne.length;nt++)if(Ge[Ne.charCodeAt(nt)]=!0,(Qe||tt)&&rt){var at=yf[Ne.charAt(nt)];at&&(Ge[at.charCodeAt(0)]=!0)}},cl.prototype.populate=function(Ne,Ge,Qe){var tt=this.layers[0],rt=tt.layout,nt=rt.get("text-font"),at=rt.get("text-field"),it=rt.get("icon-image"),ot=("constant"!==at.value.kind||at.value.value instanceof te&&!at.value.value.isEmpty()||at.value.value.toString().length>0)&&("constant"!==nt.value.kind||nt.value.value.length>0),dt="constant"!==it.value.kind||!!it.value.value||Object.keys(it.parameters).length>0,ht=rt.get("symbol-sort-key");if(this.features=[],ot||dt){for(var Dt=Ge.iconDependencies,Ot=Ge.glyphDependencies,Rt=Ge.availableImages,Zt=new ii(this.zoom),er=0,dr=Ne;er<dr.length;er+=1){var mr=dr[er],xr=mr.feature,br=mr.id,Ar=mr.index,en=mr.sourceLayerIndex,mn=tt._featureFilter.needGeometry,xn={type:xr.type,id:br,properties:xr.properties,geometry:mn?Fa(xr):[]};if(tt._featureFilter.filter(Zt,xn,Qe)){mn||(xn.geometry=Fa(xr));var kn=void 0;if(ot){var Cn=tt.getValueAndResolveTokens("text-field",xn,Qe,Rt),En=te.factory(Cn);ul(En)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===ei()||this.hasRTLText&&ml.isParsed())&&(kn=Us(En,tt,xn))}var Pn=void 0;if(dt){var Dn=tt.getValueAndResolveTokens("icon-image",xn,Qe,Rt);Pn=Dn instanceof ee?Dn:ee.fromString(Dn)}if(kn||Pn){var In=this.sortFeaturesByKey?ht.evaluate(xn,{},Qe):void 0,zn={id:br,text:kn,icon:Pn,index:Ar,sourceLayerIndex:en,geometry:Fa(xr),properties:xr.properties,type:Cf[xr.type],sortKey:In};if(this.features.push(zn),Pn&&(Dt[Pn.name]=!0),kn){var Bn=nt.evaluate(xn,{},Qe).join(","),Vn="map"===rt.get("text-rotation-alignment")&&"point"!==rt.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(wf.vertical)>=0;for(var Hn=0,qn=kn.sections;Hn<qn.length;Hn+=1){var Yn=qn[Hn];if(Yn.image)Dt[Yn.image.name]=!0;else{var $n=Nn(kn.toString()),ra=Yn.fontStack||Bn,oa=Ot[ra]=Ot[ra]||{};this.calculateGlyphDependencies(Yn.text,oa,Vn,this.allowVerticalPlacement,$n)}}}}}}"line"===rt.get("symbol-placement")&&(this.features=function(Ne){var Ge={},Qe={},tt=[],rt=0;function a(Ge){tt.push(Ne[Ge]),rt++}function o(Ne,Ge,rt){var nt=Qe[Ne];return delete Qe[Ne],Qe[Ge]=nt,tt[nt].geometry[0].pop(),tt[nt].geometry[0]=tt[nt].geometry[0].concat(rt[0]),nt}function s(Ne,Qe,rt){var nt=Ge[Qe];return delete Ge[Qe],Ge[Ne]=nt,tt[nt].geometry[0].shift(),tt[nt].geometry[0]=rt[0].concat(tt[nt].geometry[0]),nt}function u(Ne,Ge,Qe){var tt=Qe?Ge[0][Ge[0].length-1]:Ge[0][0];return Ne+":"+tt.x+":"+tt.y}for(var nt=0;nt<Ne.length;nt++){var at=Ne[nt],it=at.geometry,ot=at.text?at.text.toString():null;if(ot){var dt=u(ot,it),ht=u(ot,it,!0);if(dt in Qe&&ht in Ge&&Qe[dt]!==Ge[ht]){var Dt=s(dt,ht,it),Ot=o(dt,ht,tt[Dt].geometry);delete Ge[dt],delete Qe[ht],Qe[u(ot,tt[Ot].geometry,!0)]=Ot,tt[Dt].geometry=null}else dt in Qe?o(dt,ht,it):ht in Ge?s(dt,ht,it):(a(nt),Ge[dt]=rt-1,Qe[ht]=rt-1)}else a(nt)}return tt.filter((function(Ne){return Ne.geometry}))}(this.features)),this.sortFeaturesByKey&&this.features.sort((function(Ne,Ge){return Ne.sortKey-Ge.sortKey}))}},cl.prototype.update=function(Ne,Ge,Qe){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(Ne,Ge,this.layers,Qe),this.icon.programConfigurations.updatePaintArrays(Ne,Ge,this.layers,Qe))},cl.prototype.isEmpty=function(){return 0===this.symbolInstances.length&&!this.hasRTLText},cl.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},cl.prototype.upload=function(Ne){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(Ne),this.iconCollisionBox.upload(Ne)),this.text.upload(Ne,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(Ne,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},cl.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},cl.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},cl.prototype.addToLineVertexArray=function(Ne,Ge){var Qe=this.lineVertexArray.length;if(void 0!==Ne.segment){for(var tt=Ne.dist(Ge[Ne.segment+1]),rt=Ne.dist(Ge[Ne.segment]),nt={},at=Ne.segment+1;at<Ge.length;at++)nt[at]={x:Ge[at].x,y:Ge[at].y,tileUnitDistanceFromAnchor:tt},at<Ge.length-1&&(tt+=Ge[at+1].dist(Ge[at]));for(var it=Ne.segment||0;it>=0;it--)nt[it]={x:Ge[it].x,y:Ge[it].y,tileUnitDistanceFromAnchor:rt},it>0&&(rt+=Ge[it-1].dist(Ge[it]));for(var ot=0;ot<Ge.length;ot++){var dt=nt[ot];this.lineVertexArray.emplaceBack(dt.x,dt.y,dt.tileUnitDistanceFromAnchor)}}return{lineStartIndex:Qe,lineLength:this.lineVertexArray.length-Qe}},cl.prototype.addSymbols=function(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt){for(var Ot=Ne.indexArray,Rt=Ne.layoutVertexArray,Zt=Ne.segments.prepareSegment(4*Ge.length,Rt,Ot,nt.sortKey),er=this.glyphOffsetArray.length,dr=Zt.vertexLength,mr=this.allowVerticalPlacement&&at===wf.vertical?Math.PI/2:0,xr=nt.text&&nt.text.sections,br=0;br<Ge.length;br++){var Ar=Ge[br],en=Ar.tl,mn=Ar.tr,xn=Ar.bl,kn=Ar.br,Cn=Ar.tex,En=Ar.pixelOffsetTL,Pn=Ar.pixelOffsetBR,Dn=Ar.minFontScaleX,In=Ar.minFontScaleY,zn=Ar.glyphOffset,Bn=Ar.isSDF,Vn=Ar.sectionIndex,Hn=Zt.vertexLength,qn=zn[1];ol(Rt,it.x,it.y,en.x,qn+en.y,Cn.x,Cn.y,Qe,Bn,En.x,En.y,Dn,In),ol(Rt,it.x,it.y,mn.x,qn+mn.y,Cn.x+Cn.w,Cn.y,Qe,Bn,Pn.x,En.y,Dn,In),ol(Rt,it.x,it.y,xn.x,qn+xn.y,Cn.x,Cn.y+Cn.h,Qe,Bn,En.x,Pn.y,Dn,In),ol(Rt,it.x,it.y,kn.x,qn+kn.y,Cn.x+Cn.w,Cn.y+Cn.h,Qe,Bn,Pn.x,Pn.y,Dn,In),sl(Ne.dynamicLayoutVertexArray,it,mr),Ot.emplaceBack(Hn,Hn+1,Hn+2),Ot.emplaceBack(Hn+1,Hn+2,Hn+3),Zt.vertexLength+=4,Zt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(zn[0]),br!==Ge.length-1&&Vn===Ge[br+1].sectionIndex||Ne.programConfigurations.populatePaintArrays(Rt.length,nt,nt.index,{},Dt,xr&&xr[Vn])}Ne.placedSymbolArray.emplaceBack(it.x,it.y,er,this.glyphOffsetArray.length-er,dr,ot,dt,it.segment,Qe?Qe[0]:0,Qe?Qe[1]:0,tt[0],tt[1],at,0,!1,0,ht)},cl.prototype._addCollisionDebugVertex=function(Ne,Ge,Qe,tt,rt,nt){return Ge.emplaceBack(0,0),Ne.emplaceBack(Qe.x,Qe.y,tt,rt,Math.round(nt.x),Math.round(nt.y))},cl.prototype.addCollisionDebugVertices=function(Ne,Ge,tt,rt,nt,at,it){var ot=nt.segments.prepareSegment(4,nt.layoutVertexArray,nt.indexArray),dt=ot.vertexLength,ht=nt.layoutVertexArray,Dt=nt.collisionVertexArray,Ot=it.anchorX,Rt=it.anchorY;this._addCollisionDebugVertex(ht,Dt,at,Ot,Rt,new Qe(Ne,Ge)),this._addCollisionDebugVertex(ht,Dt,at,Ot,Rt,new Qe(tt,Ge)),this._addCollisionDebugVertex(ht,Dt,at,Ot,Rt,new Qe(tt,rt)),this._addCollisionDebugVertex(ht,Dt,at,Ot,Rt,new Qe(Ne,rt)),ot.vertexLength+=4;var Zt=nt.indexArray;Zt.emplaceBack(dt,dt+1),Zt.emplaceBack(dt+1,dt+2),Zt.emplaceBack(dt+2,dt+3),Zt.emplaceBack(dt+3,dt),ot.primitiveLength+=4},cl.prototype.addDebugCollisionBoxes=function(Ne,Ge,Qe,tt){for(var rt=Ne;rt<Ge;rt++){var nt=this.collisionBoxArray.get(rt);this.addCollisionDebugVertices(nt.x1,nt.y1,nt.x2,nt.y2,tt?this.textCollisionBox:this.iconCollisionBox,nt.anchorPoint,Qe)}},cl.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new pl(tc,mf.members,uc),this.iconCollisionBox=new pl(tc,mf.members,uc);for(var Ne=0;Ne<this.symbolInstances.length;Ne++){var Ge=this.symbolInstances.get(Ne);this.addDebugCollisionBoxes(Ge.textBoxStartIndex,Ge.textBoxEndIndex,Ge,!0),this.addDebugCollisionBoxes(Ge.verticalTextBoxStartIndex,Ge.verticalTextBoxEndIndex,Ge,!0),this.addDebugCollisionBoxes(Ge.iconBoxStartIndex,Ge.iconBoxEndIndex,Ge,!1),this.addDebugCollisionBoxes(Ge.verticalIconBoxStartIndex,Ge.verticalIconBoxEndIndex,Ge,!1)}},cl.prototype._deserializeCollisionBoxesForSymbol=function(Ne,Ge,Qe,tt,rt,nt,at,it,ot){for(var dt={},ht=Ge;ht<Qe;ht++){var Dt=Ne.get(ht);dt.textBox={x1:Dt.x1,y1:Dt.y1,x2:Dt.x2,y2:Dt.y2,anchorPointX:Dt.anchorPointX,anchorPointY:Dt.anchorPointY},dt.textFeatureIndex=Dt.featureIndex;break}for(var Ot=tt;Ot<rt;Ot++){var Rt=Ne.get(Ot);dt.verticalTextBox={x1:Rt.x1,y1:Rt.y1,x2:Rt.x2,y2:Rt.y2,anchorPointX:Rt.anchorPointX,anchorPointY:Rt.anchorPointY},dt.verticalTextFeatureIndex=Rt.featureIndex;break}for(var Zt=nt;Zt<at;Zt++){var er=Ne.get(Zt);dt.iconBox={x1:er.x1,y1:er.y1,x2:er.x2,y2:er.y2,anchorPointX:er.anchorPointX,anchorPointY:er.anchorPointY},dt.iconFeatureIndex=er.featureIndex;break}for(var dr=it;dr<ot;dr++){var mr=Ne.get(dr);dt.verticalIconBox={x1:mr.x1,y1:mr.y1,x2:mr.x2,y2:mr.y2,anchorPointX:mr.anchorPointX,anchorPointY:mr.anchorPointY},dt.verticalIconFeatureIndex=mr.featureIndex;break}return dt},cl.prototype.deserializeCollisionBoxes=function(Ne){this.collisionArrays=[];for(var Ge=0;Ge<this.symbolInstances.length;Ge++){var Qe=this.symbolInstances.get(Ge);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(Ne,Qe.textBoxStartIndex,Qe.textBoxEndIndex,Qe.verticalTextBoxStartIndex,Qe.verticalTextBoxEndIndex,Qe.iconBoxStartIndex,Qe.iconBoxEndIndex,Qe.verticalIconBoxStartIndex,Qe.verticalIconBoxEndIndex))}},cl.prototype.hasTextData=function(){return this.text.segments.get().length>0},cl.prototype.hasIconData=function(){return this.icon.segments.get().length>0},cl.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},cl.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},cl.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},cl.prototype.addIndicesForPlacedSymbol=function(Ne,Ge){for(var Qe=Ne.placedSymbolArray.get(Ge),tt=Qe.vertexStartIndex+4*Qe.numGlyphs,rt=Qe.vertexStartIndex;rt<tt;rt+=4)Ne.indexArray.emplaceBack(rt,rt+1,rt+2),Ne.indexArray.emplaceBack(rt+1,rt+2,rt+3)},cl.prototype.getSortedSymbolIndexes=function(Ne){if(this.sortedAngle===Ne&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;for(var Ge=Math.sin(Ne),Qe=Math.cos(Ne),tt=[],rt=[],nt=[],at=0;at<this.symbolInstances.length;++at){nt.push(at);var it=this.symbolInstances.get(at);tt.push(0|Math.round(Ge*it.anchorX+Qe*it.anchorY)),rt.push(it.featureIndex)}return nt.sort((function(Ne,Ge){return tt[Ne]-tt[Ge]||rt[Ge]-rt[Ne]})),nt},cl.prototype.addToSortKeyRanges=function(Ne,Ge){var Qe=this.sortKeyRanges[this.sortKeyRanges.length-1];Qe&&Qe.sortKey===Ge?Qe.symbolInstanceEnd=Ne+1:this.sortKeyRanges.push({sortKey:Ge,symbolInstanceStart:Ne,symbolInstanceEnd:Ne+1})},cl.prototype.sortFeatures=function(Ne){var Ge=this;if(this.sortFeaturesByY&&this.sortedAngle!==Ne&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(Ne),this.sortedAngle=Ne,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var Qe=0,tt=this.symbolInstanceIndexes;Qe<tt.length;Qe+=1){var rt=this.symbolInstances.get(tt[Qe]);this.featureSortOrder.push(rt.featureIndex),[rt.rightJustifiedTextSymbolIndex,rt.centerJustifiedTextSymbolIndex,rt.leftJustifiedTextSymbolIndex].forEach((function(Ne,Qe,tt){Ne>=0&&tt.indexOf(Ne)===Qe&&Ge.addIndicesForPlacedSymbol(Ge.text,Ne)})),rt.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,rt.verticalPlacedTextSymbolIndex),rt.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,rt.placedIconSymbolIndex),rt.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,rt.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},Fn("SymbolBucket",cl,{omit:["layers","collisionBoxArray","features","compareText"]}),cl.MAX_GLYPHS=65535,cl.addDynamicAttributes=sl;var Lf=new gi({"symbol-placement":new fi(pa.layout_symbol["symbol-placement"]),"symbol-spacing":new fi(pa.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new fi(pa.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new yi(pa.layout_symbol["symbol-sort-key"]),"symbol-z-order":new fi(pa.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new fi(pa.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new fi(pa.layout_symbol["icon-ignore-placement"]),"icon-optional":new fi(pa.layout_symbol["icon-optional"]),"icon-rotation-alignment":new fi(pa.layout_symbol["icon-rotation-alignment"]),"icon-size":new yi(pa.layout_symbol["icon-size"]),"icon-text-fit":new fi(pa.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new fi(pa.layout_symbol["icon-text-fit-padding"]),"icon-image":new yi(pa.layout_symbol["icon-image"]),"icon-rotate":new yi(pa.layout_symbol["icon-rotate"]),"icon-padding":new fi(pa.layout_symbol["icon-padding"]),"icon-keep-upright":new fi(pa.layout_symbol["icon-keep-upright"]),"icon-offset":new yi(pa.layout_symbol["icon-offset"]),"icon-anchor":new yi(pa.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new fi(pa.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new fi(pa.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new fi(pa.layout_symbol["text-rotation-alignment"]),"text-field":new yi(pa.layout_symbol["text-field"]),"text-font":new yi(pa.layout_symbol["text-font"]),"text-size":new yi(pa.layout_symbol["text-size"]),"text-max-width":new yi(pa.layout_symbol["text-max-width"]),"text-line-height":new fi(pa.layout_symbol["text-line-height"]),"text-letter-spacing":new yi(pa.layout_symbol["text-letter-spacing"]),"text-justify":new yi(pa.layout_symbol["text-justify"]),"text-radial-offset":new yi(pa.layout_symbol["text-radial-offset"]),"text-variable-anchor":new fi(pa.layout_symbol["text-variable-anchor"]),"text-anchor":new yi(pa.layout_symbol["text-anchor"]),"text-max-angle":new fi(pa.layout_symbol["text-max-angle"]),"text-writing-mode":new fi(pa.layout_symbol["text-writing-mode"]),"text-rotate":new yi(pa.layout_symbol["text-rotate"]),"text-padding":new fi(pa.layout_symbol["text-padding"]),"text-keep-upright":new fi(pa.layout_symbol["text-keep-upright"]),"text-transform":new yi(pa.layout_symbol["text-transform"]),"text-offset":new yi(pa.layout_symbol["text-offset"]),"text-allow-overlap":new fi(pa.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new fi(pa.layout_symbol["text-ignore-placement"]),"text-optional":new fi(pa.layout_symbol["text-optional"])}),Pf={paint:new gi({"icon-opacity":new yi(pa.paint_symbol["icon-opacity"]),"icon-color":new yi(pa.paint_symbol["icon-color"]),"icon-halo-color":new yi(pa.paint_symbol["icon-halo-color"]),"icon-halo-width":new yi(pa.paint_symbol["icon-halo-width"]),"icon-halo-blur":new yi(pa.paint_symbol["icon-halo-blur"]),"icon-translate":new fi(pa.paint_symbol["icon-translate"]),"icon-translate-anchor":new fi(pa.paint_symbol["icon-translate-anchor"]),"text-opacity":new yi(pa.paint_symbol["text-opacity"]),"text-color":new yi(pa.paint_symbol["text-color"],{runtimeType:Qa,getOverride:function(Ne){return Ne.textColor},hasOverride:function(Ne){return!!Ne.textColor}}),"text-halo-color":new yi(pa.paint_symbol["text-halo-color"]),"text-halo-width":new yi(pa.paint_symbol["text-halo-width"]),"text-halo-blur":new yi(pa.paint_symbol["text-halo-blur"]),"text-translate":new fi(pa.paint_symbol["text-translate"]),"text-translate-anchor":new fi(pa.paint_symbol["text-translate-anchor"])}),layout:Lf},yl=function(Ne){this.type=Ne.property.overrides?Ne.property.overrides.runtimeType:ma,this.defaultValue=Ne};yl.prototype.evaluate=function(Ne){if(Ne.formattedSection){var Ge=this.defaultValue.property.overrides;if(Ge&&Ge.hasOverride(Ne.formattedSection))return Ge.getOverride(Ne.formattedSection)}return Ne.feature&&Ne.featureState?this.defaultValue.evaluate(Ne.feature,Ne.featureState):this.defaultValue.property.specification.default},yl.prototype.eachChild=function(Ne){this.defaultValue.isConstant()||Ne(this.defaultValue.value._styleExpression.expression)},yl.prototype.outputDefined=function(){return!1},yl.prototype.serialize=function(){return null},Fn("FormatSectionOverride",yl,{omit:["defaultValue"]});var Df=function(Ne){function e(Ge){Ne.call(this,Ge,Pf)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.recalculate=function(Ge,Qe){if(Ne.prototype.recalculate.call(this,Ge,Qe),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),"point"===this.layout.get("symbol-placement")){var tt=this.layout.get("text-writing-mode");if(tt){for(var rt=[],nt=0,at=tt;nt<at.length;nt+=1){var it=at[nt];rt.indexOf(it)<0&&rt.push(it)}this.layout._values["text-writing-mode"]=rt}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},e.prototype.getValueAndResolveTokens=function(Ne,Ge,Qe,tt){var rt=this.layout.get(Ne).evaluate(Ge,{},Qe,tt),nt=this._unevaluatedLayout._values[Ne];return nt.isDataDriven()||qr(nt.value)||!rt?rt:function(Ne,Ge){return Ge.replace(/{([^{}]+)}/g,(function(Ge,Qe){return Qe in Ne?String(Ne[Qe]):""}))}(Ge.properties,rt)},e.prototype.createBucket=function(Ne){return new cl(Ne)},e.prototype.queryRadius=function(){return 0},e.prototype.queryIntersectsFeature=function(){return!1},e.prototype._setPaintOverrides=function(){for(var Ne=0,Ge=Pf.paint.overridableProperties;Ne<Ge.length;Ne+=1){var Qe=Ge[Ne];if(e.hasPaintOverride(this.layout,Qe)){var tt,rt=this.paint.get(Qe),nt=new yl(rt),at=new jr(nt,rt.property.specification);tt="constant"===rt.value.kind||"source"===rt.value.kind?new Kr("source",at):new Gr("composite",at,rt.value.zoomStops,rt.value._interpolationType),this.paint._values[Qe]=new ci(rt.property,tt,rt.parameters)}}},e.prototype._handleOverridablePaintPropertyUpdate=function(Ne,Ge,Qe){return!(!this.layout||Ge.isDataDriven()||Qe.isDataDriven())&&e.hasPaintOverride(this.layout,Ne)},e.hasPaintOverride=function(Ne,Ge){var Qe=Ne.get("text-field"),tt=Pf.paint.properties[Ge],rt=!1,a=function(Ne){for(var Ge=0,Qe=Ne;Ge<Qe.length;Ge+=1)if(tt.overrides&&tt.overrides.hasOverride(Qe[Ge]))return void(rt=!0)};if("constant"===Qe.value.kind&&Qe.value.value instanceof te)a(Qe.value.value.sections);else if("source"===Qe.value.kind){var o=function(Ne){rt||(Ne instanceof oe&&ie(Ne.value)===ji?a(Ne.value.sections):Ne instanceof pe?a(Ne.sections):Ne.eachChild(o))},nt=Qe.value;nt._styleExpression&&o(nt._styleExpression.expression)}return rt},e}(xl),If={paint:new gi({"background-color":new fi(pa.paint_background["background-color"]),"background-pattern":new mi(pa.paint_background["background-pattern"]),"background-opacity":new fi(pa.paint_background["background-opacity"])})},Of=function(Ne){function e(Ge){Ne.call(this,Ge,If)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e}(xl),zf={paint:new gi({"raster-opacity":new fi(pa.paint_raster["raster-opacity"]),"raster-hue-rotate":new fi(pa.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new fi(pa.paint_raster["raster-brightness-min"]),"raster-brightness-max":new fi(pa.paint_raster["raster-brightness-max"]),"raster-saturation":new fi(pa.paint_raster["raster-saturation"]),"raster-contrast":new fi(pa.paint_raster["raster-contrast"]),"raster-resampling":new fi(pa.paint_raster["raster-resampling"]),"raster-fade-duration":new fi(pa.paint_raster["raster-fade-duration"])})},Rf=function(Ne){function e(Ge){Ne.call(this,Ge,zf)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e}(xl),Bf=function(Ne){function e(Ge){Ne.call(this,Ge,{}),this.implementation=Ge}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.is3D=function(){return"3d"===this.implementation.renderingMode},e.prototype.hasOffscreenPass=function(){return void 0!==this.implementation.prerender},e.prototype.recalculate=function(){},e.prototype.updateTransitions=function(){},e.prototype.hasTransition=function(){},e.prototype.serialize=function(){},e.prototype.onAdd=function(Ne){this.implementation.onAdd&&this.implementation.onAdd(Ne,Ne.painter.context.gl)},e.prototype.onRemove=function(Ne){this.implementation.onRemove&&this.implementation.onRemove(Ne,Ne.painter.context.gl)},e}(xl),Ff={circle:Gc,heatmap:Xc,hillshade:Jc,fill:xu,"fill-extrusion":nf,line:pf,symbol:Df,background:Of,raster:Rf},Nf=self.HTMLImageElement,jf=self.HTMLCanvasElement,Vf=self.HTMLVideoElement,Uf=self.ImageData,Hf=self.ImageBitmap,zl=function(Ne,Ge,Qe,tt){this.context=Ne,this.format=Qe,this.texture=Ne.gl.createTexture(),this.update(Ge,tt)};zl.prototype.update=function(Ne,Ge,Qe){var tt=Ne.width,rt=Ne.height,nt=!(this.size&&this.size[0]===tt&&this.size[1]===rt||Qe),at=this.context,it=at.gl;if(this.useMipmap=Boolean(Ge&&Ge.useMipmap),it.bindTexture(it.TEXTURE_2D,this.texture),at.pixelStoreUnpackFlipY.set(!1),at.pixelStoreUnpack.set(1),at.pixelStoreUnpackPremultiplyAlpha.set(this.format===it.RGBA&&(!Ge||!1!==Ge.premultiply)),nt)this.size=[tt,rt],Ne instanceof Nf||Ne instanceof jf||Ne instanceof Vf||Ne instanceof Uf||Hf&&Ne instanceof Hf?it.texImage2D(it.TEXTURE_2D,0,this.format,this.format,it.UNSIGNED_BYTE,Ne):it.texImage2D(it.TEXTURE_2D,0,this.format,tt,rt,0,this.format,it.UNSIGNED_BYTE,Ne.data);else{var ot=Qe||{x:0,y:0},dt=ot.x,ht=ot.y;Ne instanceof Nf||Ne instanceof jf||Ne instanceof Vf||Ne instanceof Uf||Hf&&Ne instanceof Hf?it.texSubImage2D(it.TEXTURE_2D,0,dt,ht,it.RGBA,it.UNSIGNED_BYTE,Ne):it.texSubImage2D(it.TEXTURE_2D,0,dt,ht,tt,rt,it.RGBA,it.UNSIGNED_BYTE,Ne.data)}this.useMipmap&&this.isSizePowerOfTwo()&&it.generateMipmap(it.TEXTURE_2D)},zl.prototype.bind=function(Ne,Ge,Qe){var tt=this.context.gl;tt.bindTexture(tt.TEXTURE_2D,this.texture),Qe!==tt.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(Qe=tt.LINEAR),Ne!==this.filter&&(tt.texParameteri(tt.TEXTURE_2D,tt.TEXTURE_MAG_FILTER,Ne),tt.texParameteri(tt.TEXTURE_2D,tt.TEXTURE_MIN_FILTER,Qe||Ne),this.filter=Ne),Ge!==this.wrap&&(tt.texParameteri(tt.TEXTURE_2D,tt.TEXTURE_WRAP_S,Ge),tt.texParameteri(tt.TEXTURE_2D,tt.TEXTURE_WRAP_T,Ge),this.wrap=Ge)},zl.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},zl.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var Cl=function(Ne){var Ge=this;this._callback=Ne,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){Ge._triggered=!1,Ge._callback()})};Cl.prototype.trigger=function(){var Ne=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((function(){Ne._triggered=!1,Ne._callback()}),0))},Cl.prototype.remove=function(){delete this._channel,this._callback=function(){}};var Ml=function(Ne,Ge,Qe){this.target=Ne,this.parent=Ge,this.mapId=Qe,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},d(["receive","process"],this),this.invoker=new Cl(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=S()?Ne:self};function El(Ne,Ge,Qe){var tt=2*Math.PI*6378137/256/Math.pow(2,Qe);return[Ne*tt-2*Math.PI*6378137/2,Ge*tt-2*Math.PI*6378137/2]}Ml.prototype.send=function(Ne,Ge,Qe,tt,rt){var nt=this;void 0===rt&&(rt=!1);var at=Math.round(1e18*Math.random()).toString(36).substring(0,10);Qe&&(this.callbacks[at]=Qe);var it=z(this.globalScope)?void 0:[];return this.target.postMessage({id:at,type:Ne,hasCallback:!!Qe,targetMapId:tt,mustQueue:rt,sourceMapId:this.mapId,data:On(Ge,it)},it),{cancel:function(){Qe&&delete nt.callbacks[at],nt.target.postMessage({id:at,type:"<cancel>",targetMapId:tt,sourceMapId:nt.mapId})}}},Ml.prototype.receive=function(Ne){var Ge=Ne.data,Qe=Ge.id;if(Qe&&(!Ge.targetMapId||this.mapId===Ge.targetMapId))if("<cancel>"===Ge.type){delete this.tasks[Qe];var tt=this.cancelCallbacks[Qe];delete this.cancelCallbacks[Qe],tt&&tt()}else S()||Ge.mustQueue?(this.tasks[Qe]=Ge,this.taskQueue.push(Qe),this.invoker.trigger()):this.processTask(Qe,Ge)},Ml.prototype.process=function(){if(this.taskQueue.length){var Ne=this.taskQueue.shift(),Ge=this.tasks[Ne];delete this.tasks[Ne],this.taskQueue.length&&this.invoker.trigger(),Ge&&this.processTask(Ne,Ge)}},Ml.prototype.processTask=function(Ne,Ge){var Qe=this;if("<response>"===Ge.type){var tt=this.callbacks[Ne];delete this.callbacks[Ne],tt&&(Ge.error?tt(Un(Ge.error)):tt(null,Un(Ge.data)))}else{var rt=!1,nt=z(this.globalScope)?void 0:[],at=Ge.hasCallback?function(Ge,tt){rt=!0,delete Qe.cancelCallbacks[Ne],Qe.target.postMessage({id:Ne,type:"<response>",sourceMapId:Qe.mapId,error:Ge?On(Ge):null,data:On(tt,nt)},nt)}:function(Ne){rt=!0},it=null,ot=Un(Ge.data);if(this.parent[Ge.type])it=this.parent[Ge.type](Ge.sourceMapId,ot,at);else if(this.parent.getWorkerSource){var dt=Ge.type.split(".");it=this.parent.getWorkerSource(Ge.sourceMapId,dt[0],ot.source)[dt[1]](ot,at)}else at(new Error("Could not find function "+Ge.type));!rt&&it&&it.cancel&&(this.cancelCallbacks[Ne]=it.cancel)}},Ml.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Tl=function(Ne,Ge){Ne&&(Ge?this.setSouthWest(Ne).setNorthEast(Ge):4===Ne.length?this.setSouthWest([Ne[0],Ne[1]]).setNorthEast([Ne[2],Ne[3]]):this.setSouthWest(Ne[0]).setNorthEast(Ne[1]))};Tl.prototype.setNorthEast=function(Ne){return this._ne=Ne instanceof Pl?new Pl(Ne.lng,Ne.lat):Pl.convert(Ne),this},Tl.prototype.setSouthWest=function(Ne){return this._sw=Ne instanceof Pl?new Pl(Ne.lng,Ne.lat):Pl.convert(Ne),this},Tl.prototype.extend=function(Ne){var Ge,Qe,tt=this._sw,rt=this._ne;if(Ne instanceof Pl)Ge=Ne,Qe=Ne;else{if(!(Ne instanceof Tl))return Array.isArray(Ne)?4===Ne.length||Ne.every(Array.isArray)?this.extend(Tl.convert(Ne)):this.extend(Pl.convert(Ne)):this;if(Qe=Ne._ne,!(Ge=Ne._sw)||!Qe)return this}return tt||rt?(tt.lng=Math.min(Ge.lng,tt.lng),tt.lat=Math.min(Ge.lat,tt.lat),rt.lng=Math.max(Qe.lng,rt.lng),rt.lat=Math.max(Qe.lat,rt.lat)):(this._sw=new Pl(Ge.lng,Ge.lat),this._ne=new Pl(Qe.lng,Qe.lat)),this},Tl.prototype.getCenter=function(){return new Pl((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Tl.prototype.getSouthWest=function(){return this._sw},Tl.prototype.getNorthEast=function(){return this._ne},Tl.prototype.getNorthWest=function(){return new Pl(this.getWest(),this.getNorth())},Tl.prototype.getSouthEast=function(){return new Pl(this.getEast(),this.getSouth())},Tl.prototype.getWest=function(){return this._sw.lng},Tl.prototype.getSouth=function(){return this._sw.lat},Tl.prototype.getEast=function(){return this._ne.lng},Tl.prototype.getNorth=function(){return this._ne.lat},Tl.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Tl.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Tl.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Tl.prototype.contains=function(Ne){var Ge=Pl.convert(Ne),Qe=Ge.lng,tt=Ge.lat,rt=this._sw.lng<=Qe&&Qe<=this._ne.lng;return this._sw.lng>this._ne.lng&&(rt=this._sw.lng>=Qe&&Qe>=this._ne.lng),this._sw.lat<=tt&&tt<=this._ne.lat&&rt},Tl.convert=function(Ne){return!Ne||Ne instanceof Tl?Ne:new Tl(Ne)};var Pl=function(Ne,Ge){if(isNaN(Ne)||isNaN(Ge))throw new Error("Invalid LngLat object: ("+Ne+", "+Ge+")");if(this.lng=+Ne,this.lat=+Ge,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Pl.prototype.wrap=function(){return new Pl(l(this.lng,-180,180),this.lat)},Pl.prototype.toArray=function(){return[this.lng,this.lat]},Pl.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Pl.prototype.distanceTo=function(Ne){var Ge=Math.PI/180,Qe=this.lat*Ge,tt=Ne.lat*Ge,rt=Math.sin(Qe)*Math.sin(tt)+Math.cos(Qe)*Math.cos(tt)*Math.cos((Ne.lng-this.lng)*Ge);return 6371008.8*Math.acos(Math.min(rt,1))},Pl.prototype.toBounds=function(Ne){void 0===Ne&&(Ne=0);var Ge=360*Ne/40075017,Qe=Ge/Math.cos(Math.PI/180*this.lat);return new Tl(new Pl(this.lng-Qe,this.lat-Ge),new Pl(this.lng+Qe,this.lat+Ge))},Pl.convert=function(Ne){if(Ne instanceof Pl)return Ne;if(Array.isArray(Ne)&&(2===Ne.length||3===Ne.length))return new Pl(Number(Ne[0]),Number(Ne[1]));if(!Array.isArray(Ne)&&"object"==typeof Ne&&null!==Ne)return new Pl(Number("lng"in Ne?Ne.lng:Ne.lon),Number(Ne.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var qf=2*Math.PI*6371008.8;function Vl(Ne){return qf*Math.cos(Ne*Math.PI/180)}function Fl(Ne){return(180+Ne)/360}function Dl(Ne){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+Ne*Math.PI/360)))/360}function Ll(Ne,Ge){return Ne/Vl(Ge)}function Rl(Ne){return 360/Math.PI*Math.atan(Math.exp((180-360*Ne)*Math.PI/180))-90}var Ol=function(Ne,Ge,Qe){void 0===Qe&&(Qe=0),this.x=+Ne,this.y=+Ge,this.z=+Qe};Ol.fromLngLat=function(Ne,Ge){void 0===Ge&&(Ge=0);var Qe=Pl.convert(Ne);return new Ol(Fl(Qe.lng),Dl(Qe.lat),Ll(Ge,Qe.lat))},Ol.prototype.toLngLat=function(){return new Pl(360*this.x-180,Rl(this.y))},Ol.prototype.toAltitude=function(){return this.z*Vl(Rl(this.y))},Ol.prototype.meterInMercatorCoordinateUnits=function(){return 1/qf*(Ne=Rl(this.y),1/Math.cos(Ne*Math.PI/180));var Ne};var Ul=function(Ne,Ge,Qe){this.z=Ne,this.x=Ge,this.y=Qe,this.key=Nl(0,Ne,Ne,Ge,Qe)};Ul.prototype.equals=function(Ne){return this.z===Ne.z&&this.x===Ne.x&&this.y===Ne.y},Ul.prototype.url=function(Ne,Ge){var Qe,tt,rt,nt,at,it=(tt=this.y,rt=this.z,nt=El(256*(Qe=this.x),256*(tt=Math.pow(2,rt)-tt-1),rt),at=El(256*(Qe+1),256*(tt+1),rt),nt[0]+","+nt[1]+","+at[0]+","+at[1]),ot=function(Ne,Ge,Qe){for(var tt,rt="",nt=Ne;nt>0;nt--)rt+=(Ge&(tt=1<<nt-1)?1:0)+(Qe&tt?2:0);return rt}(this.z,this.x,this.y);return Ne[(this.x+this.y)%Ne.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===Ge?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",ot).replace("{bbox-epsg-3857}",it)},Ul.prototype.getTilePoint=function(Ne){var Ge=Math.pow(2,this.z);return new Qe(8192*(Ne.x*Ge-this.x),8192*(Ne.y*Ge-this.y))},Ul.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var jl=function(Ne,Ge){this.wrap=Ne,this.canonical=Ge,this.key=Nl(Ne,Ge.z,Ge.z,Ge.x,Ge.y)},ql=function(Ne,Ge,Qe,tt,rt){this.overscaledZ=Ne,this.wrap=Ge,this.canonical=new Ul(Qe,+tt,+rt),this.key=Nl(Ge,Ne,Qe,tt,rt)};function Nl(Ne,Ge,Qe,tt,rt){(Ne*=2)<0&&(Ne=-1*Ne-1);var nt=1<<Qe;return(nt*nt*Ne+nt*rt+tt).toString(36)+Qe.toString(36)+Ge.toString(36)}ql.prototype.equals=function(Ne){return this.overscaledZ===Ne.overscaledZ&&this.wrap===Ne.wrap&&this.canonical.equals(Ne.canonical)},ql.prototype.scaledTo=function(Ne){var Ge=this.canonical.z-Ne;return Ne>this.canonical.z?new ql(Ne,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ql(Ne,this.wrap,Ne,this.canonical.x>>Ge,this.canonical.y>>Ge)},ql.prototype.calculateScaledKey=function(Ne,Ge){var Qe=this.canonical.z-Ne;return Ne>this.canonical.z?Nl(this.wrap*+Ge,Ne,this.canonical.z,this.canonical.x,this.canonical.y):Nl(this.wrap*+Ge,Ne,Ne,this.canonical.x>>Qe,this.canonical.y>>Qe)},ql.prototype.isChildOf=function(Ne){if(Ne.wrap!==this.wrap)return!1;var Ge=this.canonical.z-Ne.canonical.z;return 0===Ne.overscaledZ||Ne.overscaledZ<this.overscaledZ&&Ne.canonical.x===this.canonical.x>>Ge&&Ne.canonical.y===this.canonical.y>>Ge},ql.prototype.children=function(Ne){if(this.overscaledZ>=Ne)return[new ql(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var Ge=this.canonical.z+1,Qe=2*this.canonical.x,tt=2*this.canonical.y;return[new ql(Ge,this.wrap,Ge,Qe,tt),new ql(Ge,this.wrap,Ge,Qe+1,tt),new ql(Ge,this.wrap,Ge,Qe,tt+1),new ql(Ge,this.wrap,Ge,Qe+1,tt+1)]},ql.prototype.isLessThan=function(Ne){return this.wrap<Ne.wrap||!(this.wrap>Ne.wrap)&&(this.overscaledZ<Ne.overscaledZ||!(this.overscaledZ>Ne.overscaledZ)&&(this.canonical.x<Ne.canonical.x||!(this.canonical.x>Ne.canonical.x)&&this.canonical.y<Ne.canonical.y))},ql.prototype.wrapped=function(){return new ql(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},ql.prototype.unwrapTo=function(Ne){return new ql(this.overscaledZ,Ne,this.canonical.z,this.canonical.x,this.canonical.y)},ql.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},ql.prototype.toUnwrapped=function(){return new jl(this.wrap,this.canonical)},ql.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},ql.prototype.getTilePoint=function(Ne){return this.canonical.getTilePoint(new Ol(Ne.x-this.wrap,Ne.y))},Fn("CanonicalTileID",Ul),Fn("OverscaledTileID",ql,{omit:["posMatrix"]});var Kl=function(Ne,Ge,Qe){if(this.uid=Ne,Ge.height!==Ge.width)throw new RangeError("DEM tiles must be square");if(Qe&&"mapbox"!==Qe&&"terrarium"!==Qe)return w('"'+Qe+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=Ge.height;var tt=this.dim=Ge.height-2;this.data=new Uint32Array(Ge.data.buffer),this.encoding=Qe||"mapbox";for(var rt=0;rt<tt;rt++)this.data[this._idx(-1,rt)]=this.data[this._idx(0,rt)],this.data[this._idx(tt,rt)]=this.data[this._idx(tt-1,rt)],this.data[this._idx(rt,-1)]=this.data[this._idx(rt,0)],this.data[this._idx(rt,tt)]=this.data[this._idx(rt,tt-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(tt,-1)]=this.data[this._idx(tt-1,0)],this.data[this._idx(-1,tt)]=this.data[this._idx(0,tt-1)],this.data[this._idx(tt,tt)]=this.data[this._idx(tt-1,tt-1)]};Kl.prototype.get=function(Ne,Ge){var Qe=new Uint8Array(this.data.buffer),tt=4*this._idx(Ne,Ge);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(Qe[tt],Qe[tt+1],Qe[tt+2])},Kl.prototype.getUnpackVector=function(){return"terrarium"===this.encoding?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},Kl.prototype._idx=function(Ne,Ge){if(Ne<-1||Ne>=this.dim+1||Ge<-1||Ge>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(Ge+1)*this.stride+(Ne+1)},Kl.prototype._unpackMapbox=function(Ne,Ge,Qe){return(256*Ne*256+256*Ge+Qe)/10-1e4},Kl.prototype._unpackTerrarium=function(Ne,Ge,Qe){return 256*Ne+Ge+Qe/256-32768},Kl.prototype.getPixels=function(){return new fo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},Kl.prototype.backfillBorder=function(Ne,Ge,Qe){if(this.dim!==Ne.dim)throw new Error("dem dimension mismatch");var tt=Ge*this.dim,rt=Ge*this.dim+this.dim,nt=Qe*this.dim,at=Qe*this.dim+this.dim;switch(Ge){case-1:tt=rt-1;break;case 1:rt=tt+1}switch(Qe){case-1:nt=at-1;break;case 1:at=nt+1}for(var it=-Ge*this.dim,ot=-Qe*this.dim,dt=nt;dt<at;dt++)for(var ht=tt;ht<rt;ht++)this.data[this._idx(ht,dt)]=Ne.data[this._idx(ht+it,dt+ot)]},Fn("DEMData",Kl);var Gl=function(Ne){this._stringToNumber={},this._numberToString=[];for(var Ge=0;Ge<Ne.length;Ge++){var Qe=Ne[Ge];this._stringToNumber[Qe]=Ge,this._numberToString[Ge]=Qe}};Gl.prototype.encode=function(Ne){return this._stringToNumber[Ne]},Gl.prototype.decode=function(Ne){return this._numberToString[Ne]};var Zl=function(Ne,Ge,Qe,tt,rt){this.type="Feature",this._vectorTileFeature=Ne,Ne._z=Ge,Ne._x=Qe,Ne._y=tt,this.properties=Ne.properties,this.id=rt},Gf={geometry:{configurable:!0}};Gf.geometry.get=function(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},Gf.geometry.set=function(Ne){this._geometry=Ne},Zl.prototype.toJSON=function(){var Ne={geometry:this.geometry};for(var Ge in this)"_geometry"!==Ge&&"_vectorTileFeature"!==Ge&&(Ne[Ge]=this[Ge]);return Ne},Object.defineProperties(Zl.prototype,Gf);var Jl=function(){this.state={},this.stateChanges={},this.deletedStates={}};Jl.prototype.updateState=function(Ne,Ge,Qe){var tt=String(Ge);if(this.stateChanges[Ne]=this.stateChanges[Ne]||{},this.stateChanges[Ne][tt]=this.stateChanges[Ne][tt]||{},p(this.stateChanges[Ne][tt],Qe),null===this.deletedStates[Ne])for(var rt in this.deletedStates[Ne]={},this.state[Ne])rt!==tt&&(this.deletedStates[Ne][rt]=null);else if(this.deletedStates[Ne]&&null===this.deletedStates[Ne][tt])for(var nt in this.deletedStates[Ne][tt]={},this.state[Ne][tt])Qe[nt]||(this.deletedStates[Ne][tt][nt]=null);else for(var at in Qe)this.deletedStates[Ne]&&this.deletedStates[Ne][tt]&&null===this.deletedStates[Ne][tt][at]&&delete this.deletedStates[Ne][tt][at]},Jl.prototype.removeFeatureState=function(Ne,Ge,Qe){if(null!==this.deletedStates[Ne]){var tt=String(Ge);if(this.deletedStates[Ne]=this.deletedStates[Ne]||{},Qe&&void 0!==Ge)null!==this.deletedStates[Ne][tt]&&(this.deletedStates[Ne][tt]=this.deletedStates[Ne][tt]||{},this.deletedStates[Ne][tt][Qe]=null);else if(void 0!==Ge)if(this.stateChanges[Ne]&&this.stateChanges[Ne][tt])for(Qe in this.deletedStates[Ne][tt]={},this.stateChanges[Ne][tt])this.deletedStates[Ne][tt][Qe]=null;else this.deletedStates[Ne][tt]=null;else this.deletedStates[Ne]=null}},Jl.prototype.getState=function(Ne,Ge){var Qe=String(Ge),tt=p({},(this.state[Ne]||{})[Qe],(this.stateChanges[Ne]||{})[Qe]);if(null===this.deletedStates[Ne])return{};if(this.deletedStates[Ne]){var rt=this.deletedStates[Ne][Ge];if(null===rt)return{};for(var nt in rt)delete tt[nt]}return tt},Jl.prototype.initializeTileState=function(Ne,Ge){Ne.setFeatureState(this.state,Ge)},Jl.prototype.coalesceChanges=function(Ne,Ge){var Qe={};for(var tt in this.stateChanges){this.state[tt]=this.state[tt]||{};var rt={};for(var nt in this.stateChanges[tt])this.state[tt][nt]||(this.state[tt][nt]={}),p(this.state[tt][nt],this.stateChanges[tt][nt]),rt[nt]=this.state[tt][nt];Qe[tt]=rt}for(var at in this.deletedStates){this.state[at]=this.state[at]||{};var it={};if(null===this.deletedStates[at])for(var ot in this.state[at])it[ot]={},this.state[at][ot]={};else for(var dt in this.deletedStates[at]){if(null===this.deletedStates[at][dt])this.state[at][dt]={};else for(var ht=0,Dt=Object.keys(this.deletedStates[at][dt]);ht<Dt.length;ht+=1)delete this.state[at][dt][Dt[ht]];it[dt]=this.state[at][dt]}Qe[at]=Qe[at]||{},p(Qe[at],it)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(Qe).length)for(var Ot in Ne)Ne[Ot].setFeatureState(Qe,Ge)};var Hl=function(Ne,Ge){this.tileID=Ne,this.x=Ne.canonical.x,this.y=Ne.canonical.y,this.z=Ne.canonical.z,this.grid=new Fs(8192,16,0),this.grid3D=new Fs(8192,16,0),this.featureIndexArray=new Tc,this.promoteId=Ge};function Yl(Ne,Ge,Qe,tt,rt){return v(Ne,(function(Ne,nt){var at=Ge instanceof hi?Ge.get(nt):null;return at&&at.evaluate?at.evaluate(Qe,tt,rt):at}))}function $l(Ne){for(var Ge=1/0,Qe=1/0,tt=-1/0,rt=-1/0,nt=0,at=Ne;nt<at.length;nt+=1){var it=at[nt];Ge=Math.min(Ge,it.x),Qe=Math.min(Qe,it.y),tt=Math.max(tt,it.x),rt=Math.max(rt,it.y)}return{minX:Ge,minY:Qe,maxX:tt,maxY:rt}}function Wl(Ne,Ge){return Ge-Ne}Hl.prototype.insert=function(Ne,Ge,Qe,tt,rt,nt){var at=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(Qe,tt,rt);for(var it=nt?this.grid3D:this.grid,ot=0;ot<Ge.length;ot++){for(var dt=Ge[ot],ht=[1/0,1/0,-1/0,-1/0],Dt=0;Dt<dt.length;Dt++){var Ot=dt[Dt];ht[0]=Math.min(ht[0],Ot.x),ht[1]=Math.min(ht[1],Ot.y),ht[2]=Math.max(ht[2],Ot.x),ht[3]=Math.max(ht[3],Ot.y)}ht[0]<8192&&ht[1]<8192&&ht[2]>=0&&ht[3]>=0&&it.insert(at,ht[0],ht[1],ht[2],ht[3])}},Hl.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new Wu.VectorTile(new xf(this.rawTileData)).layers,this.sourceLayerCoder=new Gl(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},Hl.prototype.query=function(Ne,Ge,tt,rt){var nt=this;this.loadVTLayers();for(var at=Ne.params||{},it=8192/Ne.tileSize/Ne.scale,ot=rn(at.filter),dt=Ne.queryGeometry,ht=Ne.queryPadding*it,Dt=$l(dt),Ot=this.grid.query(Dt.minX-ht,Dt.minY-ht,Dt.maxX+ht,Dt.maxY+ht),Rt=$l(Ne.cameraQueryGeometry),Zt=this.grid3D.query(Rt.minX-ht,Rt.minY-ht,Rt.maxX+ht,Rt.maxY+ht,(function(Ge,tt,rt,nt){return function(Ne,Ge,tt,rt,nt){for(var at=0,it=Ne;at<it.length;at+=1){var ot=it[at];if(Ge<=ot.x&&tt<=ot.y&&rt>=ot.x&&nt>=ot.y)return!0}var dt=[new Qe(Ge,tt),new Qe(Ge,nt),new Qe(rt,nt),new Qe(rt,tt)];if(Ne.length>2)for(var ht=0,Dt=dt;ht<Dt.length;ht+=1)if(Xa(Ne,Dt[ht]))return!0;for(var Ot=0;Ot<Ne.length-1;Ot++)if(Ja(Ne[Ot],Ne[Ot+1],dt))return!0;return!1}(Ne.cameraQueryGeometry,Ge-ht,tt-ht,rt+ht,nt+ht)})),er=0,dr=Zt;er<dr.length;er+=1)Ot.push(dr[er]);Ot.sort(Wl);for(var mr,xr={},x=function(Qe){var ht=Ot[Qe];if(ht!==mr){mr=ht;var Dt=nt.featureIndexArray.get(ht),Rt=null;nt.loadMatchingFeature(xr,Dt.bucketIndex,Dt.sourceLayerIndex,Dt.featureIndex,ot,at.layers,at.availableImages,Ge,tt,rt,(function(Ge,Qe,tt){return Rt||(Rt=Fa(Ge)),Qe.queryIntersectsFeature(dt,Ge,tt,Rt,nt.z,Ne.transform,it,Ne.pixelPosMatrix)}))}},br=0;br<Ot.length;br++)x(br);return xr},Hl.prototype.loadMatchingFeature=function(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht){var Dt=this.bucketLayerIDs[Ge];if(!nt||function(Ne,Ge){for(var Qe=0;Qe<Ne.length;Qe++)if(Ge.indexOf(Ne[Qe])>=0)return!0;return!1}(nt,Dt)){var Ot=this.sourceLayerCoder.decode(Qe),Rt=this.vtLayers[Ot].feature(tt);if(rt.filter(new ii(this.tileID.overscaledZ),Rt))for(var Zt=this.getId(Rt,Ot),er=0;er<Dt.length;er++){var dr=Dt[er];if(!(nt&&nt.indexOf(dr)<0)){var mr=it[dr];if(mr){var xr={};void 0!==Zt&&dt&&(xr=dt.getState(mr.sourceLayer||"_geojsonTileLayer",Zt));var br=ot[dr];br.paint=Yl(br.paint,mr.paint,Rt,xr,at),br.layout=Yl(br.layout,mr.layout,Rt,xr,at);var Ar=!ht||ht(Rt,mr,xr);if(Ar){var en=new Zl(Rt,this.z,this.x,this.y,Zt);en.layer=br;var mn=Ne[dr];void 0===mn&&(mn=Ne[dr]=[]),mn.push({featureIndex:tt,feature:en,intersectionZ:Ar})}}}}}},Hl.prototype.lookupSymbolFeatures=function(Ne,Ge,Qe,tt,rt,nt,at,it){var ot={};this.loadVTLayers();for(var dt=rn(rt),ht=0,Dt=Ne;ht<Dt.length;ht+=1)this.loadMatchingFeature(ot,Qe,tt,Dt[ht],dt,nt,at,it,Ge);return ot},Hl.prototype.hasLayer=function(Ne){for(var Ge=0,Qe=this.bucketLayerIDs;Ge<Qe.length;Ge+=1)for(var tt=0,rt=Qe[Ge];tt<rt.length;tt+=1)if(Ne===rt[tt])return!0;return!1},Hl.prototype.getId=function(Ne,Ge){var Qe=Ne.id;return this.promoteId&&"boolean"==typeof(Qe=Ne.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[Ge]])&&(Qe=Number(Qe)),Qe},Fn("FeatureIndex",Hl,{omit:["rawTileData","sourceLayerCoder"]});var Ql=function(Ne,Ge){this.tileID=Ne,this.uid=h(),this.uses=0,this.tileSize=Ge,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};Ql.prototype.registerFadeDuration=function(Ne){var Ge=Ne+this.timeAdded;Ge<Zt.now()||this.fadeEndTime&&Ge<this.fadeEndTime||(this.fadeEndTime=Ge)},Ql.prototype.wasRequested=function(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state},Ql.prototype.loadVectorData=function(Ne,Ge,Qe){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",Ne){for(var tt in Ne.featureIndex&&(this.latestFeatureIndex=Ne.featureIndex,Ne.rawTileData?(this.latestRawTileData=Ne.rawTileData,this.latestFeatureIndex.rawTileData=Ne.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=Ne.collisionBoxArray,this.buckets=function(Ne,Ge){var Qe={};if(!Ge)return Qe;for(var n=function(){var Ne=rt[tt],nt=Ne.layerIds.map((function(Ne){return Ge.getLayer(Ne)})).filter(Boolean);if(0!==nt.length){Ne.layers=nt,Ne.stateDependentLayerIds&&(Ne.stateDependentLayers=Ne.stateDependentLayerIds.map((function(Ne){return nt.filter((function(Ge){return Ge.id===Ne}))[0]})));for(var at=0,it=nt;at<it.length;at+=1)Qe[it[at].id]=Ne}},tt=0,rt=Ne;tt<rt.length;tt+=1)n();return Qe}(Ne.buckets,Ge.style),this.hasSymbolBuckets=!1,this.buckets){var rt=this.buckets[tt];if(rt instanceof cl){if(this.hasSymbolBuckets=!0,!Qe)break;rt.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var nt in this.buckets){var at=this.buckets[nt];if(at instanceof cl&&at.hasRTLText){this.hasRTLText=!0,ml.isLoading()||ml.isLoaded()||"deferred"!==ei()||ri();break}}for(var it in this.queryPadding=0,this.buckets){var ot=this.buckets[it];this.queryPadding=Math.max(this.queryPadding,Ge.style.getLayer(it).queryRadius(ot))}Ne.imageAtlas&&(this.imageAtlas=Ne.imageAtlas),Ne.glyphAtlasImage&&(this.glyphAtlasImage=Ne.glyphAtlasImage)}else this.collisionBoxArray=new gc},Ql.prototype.unloadVectorData=function(){for(var Ne in this.buckets)this.buckets[Ne].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},Ql.prototype.getBucket=function(Ne){return this.buckets[Ne.id]},Ql.prototype.upload=function(Ne){for(var Ge in this.buckets){var Qe=this.buckets[Ge];Qe.uploadPending()&&Qe.upload(Ne)}var tt=Ne.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new zl(Ne,this.imageAtlas.image,tt.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new zl(Ne,this.glyphAtlasImage,tt.ALPHA),this.glyphAtlasImage=null)},Ql.prototype.prepare=function(Ne){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(Ne,this.imageAtlasTexture)},Ql.prototype.queryRenderedFeatures=function(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:tt,cameraQueryGeometry:rt,scale:nt,tileSize:this.tileSize,pixelPosMatrix:dt,transform:it,params:at,queryPadding:this.queryPadding*ot},Ne,Ge,Qe):{}},Ql.prototype.querySourceFeatures=function(Ne,Ge){var Qe=this.latestFeatureIndex;if(Qe&&Qe.rawTileData){var tt=Qe.loadVTLayers(),rt=Ge?Ge.sourceLayer:"",nt=tt._geojsonTileLayer||tt[rt];if(nt)for(var at=rn(Ge&&Ge.filter),it=this.tileID.canonical,ot=it.z,dt=it.x,ht=it.y,Dt={z:ot,x:dt,y:ht},Ot=0;Ot<nt.length;Ot++){var Rt=nt.feature(Ot);if(at.filter(new ii(this.tileID.overscaledZ),Rt)){var Zt=Qe.getId(Rt,rt),er=new Zl(Rt,ot,dt,ht,Zt);er.tile=Dt,Ne.push(er)}}}},Ql.prototype.hasData=function(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state},Ql.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},Ql.prototype.setExpiryData=function(Ne){var Ge=this.expirationTime;if(Ne.cacheControl){var Qe=k(Ne.cacheControl);Qe["max-age"]&&(this.expirationTime=Date.now()+1e3*Qe["max-age"])}else Ne.expires&&(this.expirationTime=new Date(Ne.expires).getTime());if(this.expirationTime){var tt=Date.now(),rt=!1;if(this.expirationTime>tt)rt=!1;else if(Ge)if(this.expirationTime<Ge)rt=!0;else{var nt=this.expirationTime-Ge;nt?this.expirationTime=tt+Math.max(nt,3e4):rt=!0}else rt=!0;rt?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},Ql.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)},Ql.prototype.setFeatureState=function(Ne,Ge){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&0!==Object.keys(Ne).length){var Qe=this.latestFeatureIndex.loadVTLayers();for(var tt in this.buckets)if(Ge.style.hasLayer(tt)){var rt=this.buckets[tt],nt=rt.layers[0].sourceLayer||"_geojsonTileLayer",at=Qe[nt],it=Ne[nt];if(at&&it&&0!==Object.keys(it).length){rt.update(it,at,this.imageAtlas&&this.imageAtlas.patternPositions||{});var ot=Ge&&Ge.style&&Ge.style.getLayer(tt);ot&&(this.queryPadding=Math.max(this.queryPadding,ot.queryRadius(rt)))}}}},Ql.prototype.holdingForFade=function(){return void 0!==this.symbolFadeHoldUntil},Ql.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Zt.now()},Ql.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},Ql.prototype.setHoldDuration=function(Ne){this.symbolFadeHoldUntil=Zt.now()+Ne},Ql.prototype.setDependencies=function(Ne,Ge){for(var Qe={},tt=0,rt=Ge;tt<rt.length;tt+=1)Qe[rt[tt]]=!0;this.dependencies[Ne]=Qe},Ql.prototype.hasDependency=function(Ne,Ge){for(var Qe=0,tt=Ne;Qe<tt.length;Qe+=1){var rt=this.dependencies[tt[Qe]];if(rt)for(var nt=0,at=Ge;nt<at.length;nt+=1)if(rt[at[nt]])return!0}return!1};var Yf=self.performance,ep=function(Ne){this._marks={start:[Ne.url,"start"].join("#"),end:[Ne.url,"end"].join("#"),measure:Ne.url.toString()},Yf.mark(this._marks.start)};ep.prototype.finish=function(){Yf.mark(this._marks.end);var Ne=Yf.getEntriesByName(this._marks.measure);return 0===Ne.length&&(Yf.measure(this._marks.measure,this._marks.start,this._marks.end),Ne=Yf.getEntriesByName(this._marks.measure),Yf.clearMarks(this._marks.start),Yf.clearMarks(this._marks.end),Yf.clearMeasures(this._marks.measure)),Ne},Ne.Actor=Ml,Ne.AlphaImage=ho,Ne.CanonicalTileID=Ul,Ne.CollisionBoxArray=gc,Ne.Color=$t,Ne.DEMData=Kl,Ne.DataConstantProperty=fi,Ne.DictionaryCoder=Gl,Ne.EXTENT=8192,Ne.ErrorEvent=oa,Ne.EvaluationParameters=ii,Ne.Event=At,Ne.Evented=kt,Ne.FeatureIndex=Hl,Ne.FillBucket=rs,Ne.FillExtrusionBucket=xs,Ne.ImageAtlas=yu,Ne.ImagePosition=hu,Ne.LineBucket=Ms,Ne.LngLat=Pl,Ne.LngLatBounds=Tl,Ne.MercatorCoordinate=Ol,Ne.ONE_EM=24,Ne.OverscaledTileID=ql,Ne.Point=Qe,Ne.Point$1=Qe,Ne.Properties=gi,Ne.Protobuf=xf,Ne.RGBAImage=fo,Ne.RequestManager=N,Ne.RequestPerformance=ep,Ne.ResourceType=Hn,Ne.SegmentVector=ia,Ne.SourceFeatureState=Jl,Ne.StructArrayLayout1ui2=fc,Ne.StructArrayLayout2f1f2i16=rc,Ne.StructArrayLayout2i4=_l,Ne.StructArrayLayout3ui6=ac,Ne.StructArrayLayout4i8=wl,Ne.SymbolBucket=cl,Ne.Texture=zl,Ne.Tile=Ql,Ne.Transitionable=si,Ne.Uniform1f=Dc,Ne.Uniform1i=Pc,Ne.Uniform2f=Ic,Ne.Uniform3f=Oc,Ne.Uniform4f=zc,Ne.UniformColor=Rc,Ne.UniformMatrix4f=Fc,Ne.UnwrappedTileID=jl,Ne.ValidationError=zt,Ne.WritingMode=wf,Ne.ZoomHistory=jn,Ne.add=function(Ne,Ge,Qe){return Ne[0]=Ge[0]+Qe[0],Ne[1]=Ge[1]+Qe[1],Ne[2]=Ge[2]+Qe[2],Ne},Ne.addDynamicAttributes=sl,Ne.asyncAll=function(Ne,Ge,Qe){if(!Ne.length)return Qe(null,[]);var tt=Ne.length,rt=new Array(Ne.length),nt=null;Ne.forEach((function(Ne,at){Ge(Ne,(function(Ne,Ge){Ne&&(nt=Ne),rt[at]=Ge,0==--tt&&Qe(nt,rt)}))}))},Ne.bezier=o,Ne.bindAll=d,Ne.browser=Zt,Ne.cacheEntryPossiblyAdded=function(Ne){++Vn>zn&&(Ne.getActor().send("enforceCacheSizeLimit",In),Vn=0)},Ne.clamp=u,Ne.clearTileCache=function(Ne){var Ge=self.caches.delete("mapbox-tiles");Ne&&Ge.catch(Ne).then((function(){return Ne()}))},Ne.clipLine=Uu,Ne.clone=function(Ne){var Ge=new Uc(16);return Ge[0]=Ne[0],Ge[1]=Ne[1],Ge[2]=Ne[2],Ge[3]=Ne[3],Ge[4]=Ne[4],Ge[5]=Ne[5],Ge[6]=Ne[6],Ge[7]=Ne[7],Ge[8]=Ne[8],Ge[9]=Ne[9],Ge[10]=Ne[10],Ge[11]=Ne[11],Ge[12]=Ne[12],Ge[13]=Ne[13],Ge[14]=Ne[14],Ge[15]=Ne[15],Ge},Ne.clone$1=x,Ne.clone$2=function(Ne){var Ge=new Uc(3);return Ge[0]=Ne[0],Ge[1]=Ne[1],Ge[2]=Ne[2],Ge},Ne.collisionCircleLayout=vf,Ne.config=er,Ne.create=function(){var Ne=new Uc(16);return Uc!=Float32Array&&(Ne[1]=0,Ne[2]=0,Ne[3]=0,Ne[4]=0,Ne[6]=0,Ne[7]=0,Ne[8]=0,Ne[9]=0,Ne[11]=0,Ne[12]=0,Ne[13]=0,Ne[14]=0),Ne[0]=1,Ne[5]=1,Ne[10]=1,Ne[15]=1,Ne},Ne.create$1=function(){var Ne=new Uc(9);return Uc!=Float32Array&&(Ne[1]=0,Ne[2]=0,Ne[3]=0,Ne[5]=0,Ne[6]=0,Ne[7]=0),Ne[0]=1,Ne[4]=1,Ne[8]=1,Ne},Ne.create$2=function(){var Ne=new Uc(4);return Uc!=Float32Array&&(Ne[1]=0,Ne[2]=0),Ne[0]=1,Ne[3]=1,Ne},Ne.createCommonjsModule=e,Ne.createExpression=Nr,Ne.createLayout=Ai,Ne.createStyleLayer=function(Ne){return"custom"===Ne.type?new Bf(Ne):new Ff[Ne.type](Ne)},Ne.cross=function(Ne,Ge,Qe){var tt=Ge[0],rt=Ge[1],nt=Ge[2],at=Qe[0],it=Qe[1],ot=Qe[2];return Ne[0]=rt*ot-nt*it,Ne[1]=nt*at-tt*ot,Ne[2]=tt*it-rt*at,Ne},Ne.deepEqual=function t(Ne,Ge){if(Array.isArray(Ne)){if(!Array.isArray(Ge)||Ne.length!==Ge.length)return!1;for(var Qe=0;Qe<Ne.length;Qe++)if(!t(Ne[Qe],Ge[Qe]))return!1;return!0}if("object"==typeof Ne&&null!==Ne&&null!==Ge){if("object"!=typeof Ge)return!1;if(Object.keys(Ne).length!==Object.keys(Ge).length)return!1;for(var tt in Ne)if(!t(Ne[tt],Ge[tt]))return!1;return!0}return Ne===Ge},Ne.dot=function(Ne,Ge){return Ne[0]*Ge[0]+Ne[1]*Ge[1]+Ne[2]*Ge[2]},Ne.dot$1=function(Ne,Ge){return Ne[0]*Ge[0]+Ne[1]*Ge[1]+Ne[2]*Ge[2]+Ne[3]*Ge[3]},Ne.ease=tt,Ne.emitValidationErrors=Mn,Ne.endsWith=m,Ne.enforceCacheSizeLimit=function(Ne){st(),mn&&mn.then((function(Ge){Ge.keys().then((function(Qe){for(var tt=0;tt<Qe.length-Ne;tt++)Ge.delete(Qe[tt])}))}))},Ne.evaluateSizeForFeature=Tu,Ne.evaluateSizeForZoom=Pu,Ne.evaluateVariableOffset=Qu,Ne.evented=gl,Ne.extend=p,Ne.featureFilter=rn,Ne.filterObject=g,Ne.fromRotation=function(Ne,Ge){var Qe=Math.sin(Ge),tt=Math.cos(Ge);return Ne[0]=tt,Ne[1]=Qe,Ne[2]=0,Ne[3]=-Qe,Ne[4]=tt,Ne[5]=0,Ne[6]=0,Ne[7]=0,Ne[8]=1,Ne},Ne.getAnchorAlignment=Iu,Ne.getAnchorJustification=tl,Ne.getArrayBuffer=gt,Ne.getImage=bt,Ne.getJSON=function(Ne,Ge){return vt(p(Ne,{type:"json"}),Ge)},Ne.getRTLTextPluginStatus=ei,Ne.getReferrer=ra,Ne.getVideo=function(Ne,Ge){var Qe,tt,rt=self.document.createElement("video");rt.muted=!0,rt.onloadstart=function(){Ge(null,rt)};for(var nt=0;nt<Ne.length;nt++){var at=self.document.createElement("source");Qe=Ne[nt],tt=void 0,(tt=self.document.createElement("a")).href=Qe,(tt.protocol!==self.document.location.protocol||tt.host!==self.document.location.host)&&(rt.crossOrigin="Anonymous"),at.src=Ne[nt],rt.appendChild(at)}return{cancel:function(){}}},Ne.identity=eo,Ne.invert=function(Ne,Ge){var Qe=Ge[0],tt=Ge[1],rt=Ge[2],nt=Ge[3],at=Ge[4],it=Ge[5],ot=Ge[6],dt=Ge[7],ht=Ge[8],Dt=Ge[9],Ot=Ge[10],Rt=Ge[11],Zt=Ge[12],er=Ge[13],dr=Ge[14],mr=Ge[15],xr=Qe*it-tt*at,br=Qe*ot-rt*at,Ar=Qe*dt-nt*at,en=tt*ot-rt*it,mn=tt*dt-nt*it,xn=rt*dt-nt*ot,kn=ht*er-Dt*Zt,Cn=ht*dr-Ot*Zt,En=ht*mr-Rt*Zt,Pn=Dt*dr-Ot*er,Dn=Dt*mr-Rt*er,In=Ot*mr-Rt*dr,zn=xr*In-br*Dn+Ar*Pn+en*En-mn*Cn+xn*kn;return zn?(Ne[0]=(it*In-ot*Dn+dt*Pn)*(zn=1/zn),Ne[1]=(rt*Dn-tt*In-nt*Pn)*zn,Ne[2]=(er*xn-dr*mn+mr*en)*zn,Ne[3]=(Ot*mn-Dt*xn-Rt*en)*zn,Ne[4]=(ot*En-at*In-dt*Cn)*zn,Ne[5]=(Qe*In-rt*En+nt*Cn)*zn,Ne[6]=(dr*Ar-Zt*xn-mr*br)*zn,Ne[7]=(ht*xn-Ot*Ar+Rt*br)*zn,Ne[8]=(at*Dn-it*En+dt*kn)*zn,Ne[9]=(tt*En-Qe*Dn-nt*kn)*zn,Ne[10]=(Zt*mn-er*Ar+mr*xr)*zn,Ne[11]=(Dt*Ar-ht*mn-Rt*xr)*zn,Ne[12]=(it*Cn-at*Pn-ot*kn)*zn,Ne[13]=(Qe*Pn-tt*Cn+rt*kn)*zn,Ne[14]=(er*br-Zt*en-dr*xr)*zn,Ne[15]=(ht*en-Dt*br+Ot*xr)*zn,Ne):null},Ne.isChar=il,Ne.isMapboxURL=K,Ne.keysDifference=function(Ne,Ge){var Qe=[];for(var tt in Ne)tt in Ge||Qe.push(tt);return Qe},Ne.makeRequest=vt,Ne.mapObject=v,Ne.mercatorXfromLng=Fl,Ne.mercatorYfromLat=Dl,Ne.mercatorZfromAltitude=Ll,Ne.mul=qc,Ne.multiply=ro,Ne.mvt=Wu,Ne.normalize=function(Ne,Ge){var Qe=Ge[0],tt=Ge[1],rt=Ge[2],nt=Qe*Qe+tt*tt+rt*rt;return nt>0&&(nt=1/Math.sqrt(nt)),Ne[0]=Ge[0]*nt,Ne[1]=Ge[1]*nt,Ne[2]=Ge[2]*nt,Ne},Ne.number=je,Ne.offscreenCanvasSupported=ct,Ne.ortho=function(Ne,Ge,Qe,tt,rt,nt,at){var it=1/(Ge-Qe),ot=1/(tt-rt),dt=1/(nt-at);return Ne[0]=-2*it,Ne[1]=0,Ne[2]=0,Ne[3]=0,Ne[4]=0,Ne[5]=-2*ot,Ne[6]=0,Ne[7]=0,Ne[8]=0,Ne[9]=0,Ne[10]=2*dt,Ne[11]=0,Ne[12]=(Ge+Qe)*it,Ne[13]=(rt+tt)*ot,Ne[14]=(at+nt)*dt,Ne[15]=1,Ne},Ne.parseGlyphPBF=function(Ne){return new xf(Ne).readFields(uu,[])},Ne.pbf=xf,Ne.performSymbolLayout=function(Ne,Ge,Qe,tt,rt,nt,at){Ne.createArrays(),Ne.tilePixelRatio=8192/(512*Ne.overscaling),Ne.compareText={},Ne.iconsNeedLinear=!1;var it=Ne.layers[0].layout,ot=Ne.layers[0]._unevaluatedLayout._values,dt={};if("composite"===Ne.textSizeData.kind){var ht=Ne.textSizeData,Dt=ht.maxZoom;dt.compositeTextSizes=[ot["text-size"].possiblyEvaluate(new ii(ht.minZoom),at),ot["text-size"].possiblyEvaluate(new ii(Dt),at)]}if("composite"===Ne.iconSizeData.kind){var Ot=Ne.iconSizeData,Rt=Ot.maxZoom;dt.compositeIconSizes=[ot["icon-size"].possiblyEvaluate(new ii(Ot.minZoom),at),ot["icon-size"].possiblyEvaluate(new ii(Rt),at)]}dt.layoutTextSize=ot["text-size"].possiblyEvaluate(new ii(Ne.zoom+1),at),dt.layoutIconSize=ot["icon-size"].possiblyEvaluate(new ii(Ne.zoom+1),at),dt.textMaxSize=ot["text-size"].possiblyEvaluate(new ii(18));for(var Zt=24*it.get("text-line-height"),er="map"===it.get("text-rotation-alignment")&&"point"!==it.get("symbol-placement"),dr=it.get("text-keep-upright"),mr=it.get("text-size"),g=function(){var nt=br[xr],ot=it.get("text-font").evaluate(nt,{},at).join(","),ht=mr.evaluate(nt,{},at),Dt=dt.layoutTextSize.evaluate(nt,{},at),Ot=dt.layoutIconSize.evaluate(nt,{},at),Rt={horizontal:{},vertical:void 0},Ar=nt.text,en=[0,0];if(Ar){var mn=Ar.toString(),xn=24*it.get("text-letter-spacing").evaluate(nt,{},at),kn=function(Ne){for(var Ge=0,Qe=Ne;Ge<Qe.length;Ge+=1)if(tt=Qe[Ge].charCodeAt(0),il.Arabic(tt)||il["Arabic Supplement"](tt)||il["Arabic Extended-A"](tt)||il["Arabic Presentation Forms-A"](tt)||il["Arabic Presentation Forms-B"](tt))return!1;var tt;return!0}(mn)?xn:0,Cn=it.get("text-anchor").evaluate(nt,{},at),En=it.get("text-variable-anchor");if(!En){var Pn=it.get("text-radial-offset").evaluate(nt,{},at);en=Pn?Qu(Cn,[24*Pn,Sf]):it.get("text-offset").evaluate(nt,{},at).map((function(Ne){return 24*Ne}))}var Dn=er?"center":it.get("text-justify").evaluate(nt,{},at),In=it.get("symbol-placement"),zn="point"===In?24*it.get("text-max-width").evaluate(nt,{},at):0,P=function(){Ne.allowVerticalPlacement&&Nn(mn)&&(Rt.vertical=gu(Ar,Ge,Qe,rt,ot,zn,Zt,Cn,"left",kn,en,wf.vertical,!0,In,Dt,ht))};if(!er&&En){for(var Bn="auto"===Dn?En.map((function(Ne){return tl(Ne)})):[Dn],Vn=!1,Hn=0;Hn<Bn.length;Hn++){var qn=Bn[Hn];if(!Rt.horizontal[qn])if(Vn)Rt.horizontal[qn]=Rt.horizontal[0];else{var Yn=gu(Ar,Ge,Qe,rt,ot,zn,Zt,"center",qn,kn,en,wf.horizontal,!1,In,Dt,ht);Yn&&(Rt.horizontal[qn]=Yn,Vn=1===Yn.positionedLines.length)}}P()}else{"auto"===Dn&&(Dn=tl(Cn));var $n=gu(Ar,Ge,Qe,rt,ot,zn,Zt,Cn,Dn,kn,en,wf.horizontal,!1,In,Dt,ht);$n&&(Rt.horizontal[Dn]=$n),P(),Nn(mn)&&er&&dr&&(Rt.vertical=gu(Ar,Ge,Qe,rt,ot,zn,Zt,Cn,Dn,kn,en,wf.vertical,!1,In,Dt,ht))}}var ra=void 0,oa=!1;if(nt.icon&&nt.icon.name){var pa=tt[nt.icon.name];pa&&(ra=function(Ne,Ge,Qe){var tt=Iu(Qe),rt=Ge[0]-Ne.displaySize[0]*tt.horizontalAlign,nt=Ge[1]-Ne.displaySize[1]*tt.verticalAlign;return{image:Ne,top:nt,bottom:nt+Ne.displaySize[1],left:rt,right:rt+Ne.displaySize[0]}}(rt[nt.icon.name],it.get("icon-offset").evaluate(nt,{},at),it.get("icon-anchor").evaluate(nt,{},at)),oa=pa.sdf,void 0===Ne.sdfIcons?Ne.sdfIcons=pa.sdf:Ne.sdfIcons!==pa.sdf&&w("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(pa.pixelRatio!==Ne.pixelRatio||0!==it.get("icon-rotate").constantOr(1))&&(Ne.iconsNeedLinear=!0))}var ga=rl(Rt.horizontal)||Rt.vertical;Ne.iconsInText=!!ga&&ga.iconsInText,(ga||ra)&&function(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht){var Dt=nt.textMaxSize.evaluate(Ge,{});void 0===Dt&&(Dt=at);var Ot,Rt=Ne.layers[0].layout,Zt=Rt.get("icon-offset").evaluate(Ge,{},ht),er=rl(Qe.horizontal),dr=at/24,mr=Ne.tilePixelRatio*dr,xr=Ne.tilePixelRatio*Dt/24,br=Ne.tilePixelRatio*it,Ar=Ne.tilePixelRatio*Rt.get("symbol-spacing"),en=Rt.get("text-padding")*Ne.tilePixelRatio,mn=Rt.get("icon-padding")*Ne.tilePixelRatio,xn=Rt.get("text-max-angle")/180*Math.PI,kn="map"===Rt.get("text-rotation-alignment")&&"point"!==Rt.get("symbol-placement"),Cn="map"===Rt.get("icon-rotation-alignment")&&"point"!==Rt.get("symbol-placement"),En=Rt.get("symbol-placement"),Pn=Ar/2,Dn=Rt.get("icon-text-fit");tt&&"none"!==Dn&&(Ne.allowVerticalPlacement&&Qe.vertical&&(Ot=Cu(tt,Qe.vertical,Dn,Rt.get("icon-text-fit-padding"),Zt,dr)),er&&(tt=Cu(tt,er,Dn,Rt.get("icon-text-fit-padding"),Zt,dr)));var E=function(it,Dt){Dt.x<0||Dt.x>=8192||Dt.y<0||Dt.y>=8192||function(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt,er,dr,mr,xr,br,Ar,en,mn,xn,kn){var Cn,En,Pn,Dn,In,zn=Ne.addToLineVertexArray(Ge,Qe),Bn=0,Vn=0,Hn=0,qn=0,Yn=-1,$n=-1,ra={},oa=Cc(""),pa=0,ga=0;if(void 0===it._unevaluatedLayout.getValue("text-radial-offset")?(pa=(Cn=it.layout.get("text-offset").evaluate(Ar,{},xn).map((function(Ne){return 24*Ne})))[0],ga=Cn[1]):(pa=24*it.layout.get("text-radial-offset").evaluate(Ar,{},xn),ga=Sf),Ne.allowVerticalPlacement&&tt.vertical){var ma=it.layout.get("text-rotate").evaluate(Ar,{},xn)+90;Dn=new Zu(ot,Ge,dt,ht,Dt,tt.vertical,Ot,Rt,Zt,ma),at&&(In=new Zu(ot,Ge,dt,ht,Dt,at,dr,mr,Zt,ma))}if(rt){var _a=it.layout.get("icon-rotate").evaluate(Ar,{}),Va="none"!==it.layout.get("icon-text-fit"),Wa=ju(rt,_a,mn,Va),Qa=at?ju(at,_a,mn,Va):void 0;Pn=new Zu(ot,Ge,dt,ht,Dt,rt,dr,mr,!1,_a),Bn=4*Wa.length;var ti=Ne.iconSizeData,ni=null;"source"===ti.kind?(ni=[128*it.layout.get("icon-size").evaluate(Ar,{})])[0]>32640&&w(Ne.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):"composite"===ti.kind&&((ni=[128*en.compositeIconSizes[0].evaluate(Ar,{},xn),128*en.compositeIconSizes[1].evaluate(Ar,{},xn)])[0]>32640||ni[1]>32640)&&w(Ne.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),Ne.addSymbols(Ne.icon,Wa,ni,br,xr,Ar,!1,Ge,zn.lineStartIndex,zn.lineLength,-1,xn),Yn=Ne.icon.placedSymbolArray.length-1,Qa&&(Vn=4*Qa.length,Ne.addSymbols(Ne.icon,Qa,ni,br,xr,Ar,wf.vertical,Ge,zn.lineStartIndex,zn.lineLength,-1,xn),$n=Ne.icon.placedSymbolArray.length-1)}for(var di in tt.horizontal){var ji=tt.horizontal[di];if(!En){oa=Cc(ji.text);var Hi=it.layout.get("text-rotate").evaluate(Ar,{},xn);En=new Zu(ot,Ge,dt,ht,Dt,ji,Ot,Rt,Zt,Hi)}var Yi=1===ji.positionedLines.length;if(Hn+=el(Ne,Ge,ji,nt,it,Zt,Ar,er,zn,tt.vertical?wf.horizontal:wf.horizontalOnly,Yi?Object.keys(tt.horizontal):[di],ra,Yn,en,xn),Yi)break}tt.vertical&&(qn+=el(Ne,Ge,tt.vertical,nt,it,Zt,Ar,er,zn,wf.vertical,["vertical"],ra,$n,en,xn));var uo=En?En.boxStartIndex:Ne.collisionBoxArray.length,go=En?En.boxEndIndex:Ne.collisionBoxArray.length,ns=Dn?Dn.boxStartIndex:Ne.collisionBoxArray.length,as=Dn?Dn.boxEndIndex:Ne.collisionBoxArray.length,is=Pn?Pn.boxStartIndex:Ne.collisionBoxArray.length,os=Pn?Pn.boxEndIndex:Ne.collisionBoxArray.length,ss=In?In.boxStartIndex:Ne.collisionBoxArray.length,cs=In?In.boxEndIndex:Ne.collisionBoxArray.length,ds=-1,ut=function(Ne,Ge){return Ne&&Ne.circleDiameter?Math.max(Ne.circleDiameter,Ge):Ge};ds=ut(En,ds),ds=ut(Dn,ds),ds=ut(Pn,ds);var ms=(ds=ut(In,ds))>-1?1:0;ms&&(ds*=kn/24),Ne.glyphOffsetArray.length>=cl.MAX_GLYPHS&&w("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Ar.sortKey&&Ne.addToSortKeyRanges(Ne.symbolInstances.length,Ar.sortKey),Ne.symbolInstances.emplaceBack(Ge.x,Ge.y,ra.right>=0?ra.right:-1,ra.center>=0?ra.center:-1,ra.left>=0?ra.left:-1,ra.vertical||-1,Yn,$n,oa,uo,go,ns,as,is,os,ss,cs,dt,Hn,qn,Bn,Vn,ms,0,Ot,pa,ga,ds)}(Ne,Dt,it,Qe,tt,rt,Ot,Ne.layers[0],Ne.collisionBoxArray,Ge.index,Ge.sourceLayerIndex,Ne.index,mr,en,kn,ot,br,mn,Cn,Zt,Ge,nt,dt,ht,at)};if("line"===En)for(var In=0,zn=Uu(Ge.geometry,0,0,8192,8192);In<zn.length;In+=1)for(var Bn=zn[In],Vn=0,Hn=Ou(Bn,Ar,xn,Qe.vertical||er,tt,24,xr,Ne.overscaling,8192);Vn<Hn.length;Vn+=1){var qn=Hn[Vn];er&&nl(Ne,er.text,Pn,qn)||E(Bn,qn)}else if("line-center"===En)for(var Yn=0,$n=Ge.geometry;Yn<$n.length;Yn+=1){var ra=$n[Yn];if(ra.length>1){var oa=Ru(ra,xn,Qe.vertical||er,tt,24,xr);oa&&E(ra,oa)}}else if("Polygon"===Ge.type)for(var pa=0,ga=Wo(Ge.geometry,0);pa<ga.length;pa+=1){var ma=ga[pa],_a=Hu(ma,16);E(ma[0],new Af(_a.x,_a.y,0))}else if("LineString"===Ge.type)for(var Va=0,Wa=Ge.geometry;Va<Wa.length;Va+=1){var Qa=Wa[Va];E(Qa,new Af(Qa[0].x,Qa[0].y,0))}else if("Point"===Ge.type)for(var ti=0,ni=Ge.geometry;ti<ni.length;ti+=1)for(var di=0,ji=ni[ti];di<ji.length;di+=1){var Hi=ji[di];E([Hi],new Af(Hi.x,Hi.y,0))}}(Ne,nt,Rt,ra,tt,dt,Dt,Ot,en,oa,at)},xr=0,br=Ne.features;xr<br.length;xr+=1)g();nt&&Ne.generateCollisionDebugBuffers()},Ne.perspective=function(Ne,Ge,Qe,tt,rt){var nt,at=1/Math.tan(Ge/2);return Ne[0]=at/Qe,Ne[1]=0,Ne[2]=0,Ne[3]=0,Ne[4]=0,Ne[5]=at,Ne[6]=0,Ne[7]=0,Ne[8]=0,Ne[9]=0,Ne[11]=-1,Ne[12]=0,Ne[13]=0,Ne[15]=0,null!=rt&&rt!==1/0?(Ne[10]=(rt+tt)*(nt=1/(tt-rt)),Ne[14]=2*rt*tt*nt):(Ne[10]=-1,Ne[14]=-2*tt),Ne},Ne.pick=function(Ne,Ge){for(var Qe={},tt=0;tt<Ge.length;tt++){var rt=Ge[tt];rt in Ne&&(Qe[rt]=Ne[rt])}return Qe},Ne.plugin=ml,Ne.polygonIntersectsPolygon=Ra,Ne.postMapLoadEvent=Dn,Ne.postTurnstileEvent=En,Ne.potpack=cu,Ne.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],Ne.register=Fn,Ne.registerForPluginStateChange=function(Ne){return Ne({pluginStatus:dl,pluginURL:hl}),gl.on("pluginStateChange",Ne),Ne},Ne.rotate=function(Ne,Ge,Qe){var tt=Ge[0],rt=Ge[1],nt=Ge[2],at=Ge[3],it=Math.sin(Qe),ot=Math.cos(Qe);return Ne[0]=tt*ot+nt*it,Ne[1]=rt*ot+at*it,Ne[2]=tt*-it+nt*ot,Ne[3]=rt*-it+at*ot,Ne},Ne.rotateX=function(Ne,Ge,Qe){var tt=Math.sin(Qe),rt=Math.cos(Qe),nt=Ge[4],at=Ge[5],it=Ge[6],ot=Ge[7],dt=Ge[8],ht=Ge[9],Dt=Ge[10],Ot=Ge[11];return Ge!==Ne&&(Ne[0]=Ge[0],Ne[1]=Ge[1],Ne[2]=Ge[2],Ne[3]=Ge[3],Ne[12]=Ge[12],Ne[13]=Ge[13],Ne[14]=Ge[14],Ne[15]=Ge[15]),Ne[4]=nt*rt+dt*tt,Ne[5]=at*rt+ht*tt,Ne[6]=it*rt+Dt*tt,Ne[7]=ot*rt+Ot*tt,Ne[8]=dt*rt-nt*tt,Ne[9]=ht*rt-at*tt,Ne[10]=Dt*rt-it*tt,Ne[11]=Ot*rt-ot*tt,Ne},Ne.rotateZ=function(Ne,Ge,Qe){var tt=Math.sin(Qe),rt=Math.cos(Qe),nt=Ge[0],at=Ge[1],it=Ge[2],ot=Ge[3],dt=Ge[4],ht=Ge[5],Dt=Ge[6],Ot=Ge[7];return Ge!==Ne&&(Ne[8]=Ge[8],Ne[9]=Ge[9],Ne[10]=Ge[10],Ne[11]=Ge[11],Ne[12]=Ge[12],Ne[13]=Ge[13],Ne[14]=Ge[14],Ne[15]=Ge[15]),Ne[0]=nt*rt+dt*tt,Ne[1]=at*rt+ht*tt,Ne[2]=it*rt+Dt*tt,Ne[3]=ot*rt+Ot*tt,Ne[4]=dt*rt-nt*tt,Ne[5]=ht*rt-at*tt,Ne[6]=Dt*rt-it*tt,Ne[7]=Ot*rt-ot*tt,Ne},Ne.scale=function(Ne,Ge,Qe){var tt=Qe[0],rt=Qe[1],nt=Qe[2];return Ne[0]=Ge[0]*tt,Ne[1]=Ge[1]*tt,Ne[2]=Ge[2]*tt,Ne[3]=Ge[3]*tt,Ne[4]=Ge[4]*rt,Ne[5]=Ge[5]*rt,Ne[6]=Ge[6]*rt,Ne[7]=Ge[7]*rt,Ne[8]=Ge[8]*nt,Ne[9]=Ge[9]*nt,Ne[10]=Ge[10]*nt,Ne[11]=Ge[11]*nt,Ne[12]=Ge[12],Ne[13]=Ge[13],Ne[14]=Ge[14],Ne[15]=Ge[15],Ne},Ne.scale$1=function(Ne,Ge,Qe){return Ne[0]=Ge[0]*Qe,Ne[1]=Ge[1]*Qe,Ne[2]=Ge[2]*Qe,Ne[3]=Ge[3]*Qe,Ne},Ne.scale$2=function(Ne,Ge,Qe){return Ne[0]=Ge[0]*Qe,Ne[1]=Ge[1]*Qe,Ne[2]=Ge[2]*Qe,Ne},Ne.setCacheLimits=function(Ne,Ge){In=Ne,zn=Ge},Ne.setRTLTextPlugin=function(Ne,Ge,Qe){if(void 0===Qe&&(Qe=!1),"deferred"===dl||"loading"===dl||"loaded"===dl)throw new Error("setRTLTextPlugin cannot be called multiple times.");hl=Zt.resolveURL(Ne),dl="deferred",fl=Ge,Qn(),Qe||ri()},Ne.sphericalToCartesian=function(Ne){var Ge=Ne[0],Qe=Ne[1],tt=Ne[2];return Qe+=90,Qe*=Math.PI/180,tt*=Math.PI/180,{x:Ge*Math.cos(Qe)*Math.sin(tt),y:Ge*Math.sin(Qe)*Math.sin(tt),z:Ge*Math.cos(tt)}},Ne.sqrLen=function(Ne){var Ge=Ne[0],Qe=Ne[1];return Ge*Ge+Qe*Qe},Ne.styleSpec=pa,Ne.sub=function(Ne,Ge,Qe){return Ne[0]=Ge[0]-Qe[0],Ne[1]=Ge[1]-Qe[1],Ne[2]=Ge[2]-Qe[2],Ne},Ne.symbolSize=Mf,Ne.transformMat3=function(Ne,Ge,Qe){var tt=Ge[0],rt=Ge[1],nt=Ge[2];return Ne[0]=tt*Qe[0]+rt*Qe[3]+nt*Qe[6],Ne[1]=tt*Qe[1]+rt*Qe[4]+nt*Qe[7],Ne[2]=tt*Qe[2]+rt*Qe[5]+nt*Qe[8],Ne},Ne.transformMat4=ao,Ne.translate=function(Ne,Ge,Qe){var tt,rt,nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt,er=Qe[0],dr=Qe[1],mr=Qe[2];return Ge===Ne?(Ne[12]=Ge[0]*er+Ge[4]*dr+Ge[8]*mr+Ge[12],Ne[13]=Ge[1]*er+Ge[5]*dr+Ge[9]*mr+Ge[13],Ne[14]=Ge[2]*er+Ge[6]*dr+Ge[10]*mr+Ge[14],Ne[15]=Ge[3]*er+Ge[7]*dr+Ge[11]*mr+Ge[15]):(rt=Ge[1],nt=Ge[2],at=Ge[3],it=Ge[4],ot=Ge[5],dt=Ge[6],ht=Ge[7],Dt=Ge[8],Ot=Ge[9],Rt=Ge[10],Zt=Ge[11],Ne[0]=tt=Ge[0],Ne[1]=rt,Ne[2]=nt,Ne[3]=at,Ne[4]=it,Ne[5]=ot,Ne[6]=dt,Ne[7]=ht,Ne[8]=Dt,Ne[9]=Ot,Ne[10]=Rt,Ne[11]=Zt,Ne[12]=tt*er+it*dr+Dt*mr+Ge[12],Ne[13]=rt*er+ot*dr+Ot*mr+Ge[13],Ne[14]=nt*er+dt*dr+Rt*mr+Ge[14],Ne[15]=at*er+ht*dr+Zt*mr+Ge[15]),Ne},Ne.triggerPluginCompletionEvent=Wn,Ne.uniqueId=h,Ne.validateCustomStyleLayer=function(Ne){var Ge=[],Qe=Ne.id;return void 0===Qe&&Ge.push({message:"layers."+Qe+': missing required property "id"'}),void 0===Ne.render&&Ge.push({message:"layers."+Qe+': missing required method "render"'}),Ne.renderingMode&&"2d"!==Ne.renderingMode&&"3d"!==Ne.renderingMode&&Ge.push({message:"layers."+Qe+': property "renderingMode" must be either "2d" or "3d"'}),Ge},Ne.validateLight=zs,Ne.validateStyle=Os,Ne.values=function(Ne){var Ge=[];for(var Qe in Ne)Ge.push(Ne[Qe]);return Ge},Ne.vectorTile=Wu,Ne.version="1.10.1",Ne.warnOnce=w,Ne.webpSupported=dr,Ne.window=self,Ne.wrap=l})),define(["./shared"],(function(Ne){function t(Ne){var Ge=typeof Ne;if("number"===Ge||"boolean"===Ge||"string"===Ge||null==Ne)return JSON.stringify(Ne);if(Array.isArray(Ne)){for(var Qe="[",tt=0,rt=Ne;tt<rt.length;tt+=1)Qe+=t(rt[tt])+",";return Qe+"]"}for(var nt=Object.keys(Ne).sort(),at="{",it=0;it<nt.length;it++)at+=JSON.stringify(nt[it])+":"+t(Ne[nt[it]])+",";return at+"}"}function r(Ge){for(var Qe="",tt=0,rt=Ne.refProperties;tt<rt.length;tt+=1)Qe+="/"+t(Ge[rt[tt]]);return Qe}var i=function(Ne){this.keyCache={},Ne&&this.replace(Ne)};i.prototype.replace=function(Ne){this._layerConfigs={},this._layers={},this.update(Ne,[])},i.prototype.update=function(Ge,Qe){for(var tt=this,rt=0,nt=Ge;rt<nt.length;rt+=1){var at=nt[rt];this._layerConfigs[at.id]=at;var it=this._layers[at.id]=Ne.createStyleLayer(at);it._featureFilter=Ne.featureFilter(it.filter),this.keyCache[at.id]&&delete this.keyCache[at.id]}for(var ot=0,dt=Qe;ot<dt.length;ot+=1){var ht=dt[ot];delete this.keyCache[ht],delete this._layerConfigs[ht],delete this._layers[ht]}this.familiesBySource={};for(var Dt=0,Ot=function(Ne,Ge){for(var Qe={},tt=0;tt<Ne.length;tt++){var rt=Ge&&Ge[Ne[tt].id]||r(Ne[tt]);Ge&&(Ge[Ne[tt].id]=rt);var nt=Qe[rt];nt||(nt=Qe[rt]=[]),nt.push(Ne[tt])}var at=[];for(var it in Qe)at.push(Qe[it]);return at}(Ne.values(this._layerConfigs),this.keyCache);Dt<Ot.length;Dt+=1){var Rt=Ot[Dt].map((function(Ne){return tt._layers[Ne.id]})),Zt=Rt[0];if("none"!==Zt.visibility){var er=Zt.source||"",dr=this.familiesBySource[er];dr||(dr=this.familiesBySource[er]={});var mr=Zt.sourceLayer||"_geojsonTileLayer",xr=dr[mr];xr||(xr=dr[mr]=[]),xr.push(Rt)}}};var o=function(Ge){var Qe={},tt=[];for(var rt in Ge){var nt=Ge[rt],at=Qe[rt]={};for(var it in nt){var ot=nt[+it];if(ot&&0!==ot.bitmap.width&&0!==ot.bitmap.height){var dt={x:0,y:0,w:ot.bitmap.width+2,h:ot.bitmap.height+2};tt.push(dt),at[it]={rect:dt,metrics:ot.metrics}}}}var ht=Ne.potpack(tt),Dt=new Ne.AlphaImage({width:ht.w||1,height:ht.h||1});for(var Ot in Ge){var Rt=Ge[Ot];for(var Zt in Rt){var er=Rt[+Zt];if(er&&0!==er.bitmap.width&&0!==er.bitmap.height){var dr=Qe[Ot][Zt].rect;Ne.AlphaImage.copy(er.bitmap,Dt,{x:0,y:0},{x:dr.x+1,y:dr.y+1},er.bitmap)}}}this.image=Dt,this.positions=Qe};Ne.register("GlyphAtlas",o);var n=function(Ge){this.tileID=new Ne.OverscaledTileID(Ge.tileID.overscaledZ,Ge.tileID.wrap,Ge.tileID.canonical.z,Ge.tileID.canonical.x,Ge.tileID.canonical.y),this.uid=Ge.uid,this.zoom=Ge.zoom,this.pixelRatio=Ge.pixelRatio,this.tileSize=Ge.tileSize,this.source=Ge.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Ge.showCollisionBoxes,this.collectResourceTiming=!!Ge.collectResourceTiming,this.returnDependencies=!!Ge.returnDependencies,this.promoteId=Ge.promoteId};function s(Ge,Qe,tt){for(var rt=new Ne.EvaluationParameters(Qe),nt=0,at=Ge;nt<at.length;nt+=1)at[nt].recalculate(rt,tt)}function a(Ge,Qe){var tt=Ne.getArrayBuffer(Ge.request,(function(Ge,tt,rt,nt){Ge?Qe(Ge):tt&&Qe(null,{vectorTile:new Ne.vectorTile.VectorTile(new Ne.pbf(tt)),rawData:tt,cacheControl:rt,expires:nt})}));return function(){tt.cancel(),Qe()}}n.prototype.parse=function(Ge,Qe,tt,rt,nt){var at=this;this.status="parsing",this.data=Ge,this.collisionBoxArray=new Ne.CollisionBoxArray;var it=new Ne.DictionaryCoder(Object.keys(Ge.layers).sort()),ot=new Ne.FeatureIndex(this.tileID,this.promoteId);ot.bucketLayerIDs=[];var dt,ht,Dt,Ot,Rt={},Zt={featureIndex:ot,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:tt},er=Qe.familiesBySource[this.source];for(var dr in er){var mr=Ge.layers[dr];if(mr){1===mr.version&&Ne.warnOnce('Vector tile source "'+this.source+'" layer "'+dr+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var xr=it.encode(dr),br=[],Ar=0;Ar<mr.length;Ar++){var en=mr.feature(Ar),mn=ot.getId(en,dr);br.push({feature:en,id:mn,index:Ar,sourceLayerIndex:xr})}for(var xn=0,kn=er[dr];xn<kn.length;xn+=1){var Cn=kn[xn],En=Cn[0];En.minzoom&&this.zoom<Math.floor(En.minzoom)||En.maxzoom&&this.zoom>=En.maxzoom||"none"!==En.visibility&&(s(Cn,this.zoom,tt),(Rt[En.id]=En.createBucket({index:ot.bucketLayerIDs.length,layers:Cn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:xr,sourceID:this.source})).populate(br,Zt,this.tileID.canonical),ot.bucketLayerIDs.push(Cn.map((function(Ne){return Ne.id}))))}}}var Pn=Ne.mapObject(Zt.glyphDependencies,(function(Ne){return Object.keys(Ne).map(Number)}));Object.keys(Pn).length?rt.send("getGlyphs",{uid:this.uid,stacks:Pn},(function(Ne,Ge){dt||(dt=Ne,ht=Ge,O.call(at))})):ht={};var Dn=Object.keys(Zt.iconDependencies);Dn.length?rt.send("getImages",{icons:Dn,source:this.source,tileID:this.tileID,type:"icons"},(function(Ne,Ge){dt||(dt=Ne,Dt=Ge,O.call(at))})):Dt={};var In=Object.keys(Zt.patternDependencies);function O(){if(dt)return nt(dt);if(ht&&Dt&&Ot){var Ge=new o(ht),Qe=new Ne.ImageAtlas(Dt,Ot);for(var rt in Rt){var at=Rt[rt];at instanceof Ne.SymbolBucket?(s(at.layers,this.zoom,tt),Ne.performSymbolLayout(at,ht,Ge.positions,Dt,Qe.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):at.hasPattern&&(at instanceof Ne.LineBucket||at instanceof Ne.FillBucket||at instanceof Ne.FillExtrusionBucket)&&(s(at.layers,this.zoom,tt),at.addFeatures(Zt,this.tileID.canonical,Qe.patternPositions))}this.status="done",nt(null,{buckets:Ne.values(Rt).filter((function(Ne){return!Ne.isEmpty()})),featureIndex:ot,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ge.image,imageAtlas:Qe,glyphMap:this.returnDependencies?ht:null,iconMap:this.returnDependencies?Dt:null,glyphPositions:this.returnDependencies?Ge.positions:null})}}In.length?rt.send("getImages",{icons:In,source:this.source,tileID:this.tileID,type:"patterns"},(function(Ne,Ge){dt||(dt=Ne,Ot=Ge,O.call(at))})):Ot={},O.call(this)};var l=function(Ne,Ge,Qe,tt){this.actor=Ne,this.layerIndex=Ge,this.availableImages=Qe,this.loadVectorData=tt||a,this.loading={},this.loaded={}};l.prototype.loadTile=function(Ge,Qe){var tt=this,rt=Ge.uid;this.loading||(this.loading={});var nt=!!(Ge&&Ge.request&&Ge.request.collectResourceTiming)&&new Ne.RequestPerformance(Ge.request),at=this.loading[rt]=new n(Ge);at.abort=this.loadVectorData(Ge,(function(Ge,it){if(delete tt.loading[rt],Ge||!it)return at.status="done",tt.loaded[rt]=at,Qe(Ge);var ot=it.rawData,dt={};it.expires&&(dt.expires=it.expires),it.cacheControl&&(dt.cacheControl=it.cacheControl);var ht={};if(nt){var Dt=nt.finish();Dt&&(ht.resourceTiming=JSON.parse(JSON.stringify(Dt)))}at.vectorTile=it.vectorTile,at.parse(it.vectorTile,tt.layerIndex,tt.availableImages,tt.actor,(function(Ge,tt){if(Ge||!tt)return Qe(Ge);Qe(null,Ne.extend({rawTileData:ot.slice(0)},tt,dt,ht))})),tt.loaded=tt.loaded||{},tt.loaded[rt]=at}))},l.prototype.reloadTile=function(Ne,Ge){var Qe=this,tt=this.loaded,rt=Ne.uid,nt=this;if(tt&&tt[rt]){var at=tt[rt];at.showCollisionBoxes=Ne.showCollisionBoxes;var a=function(Ne,tt){var rt=at.reloadCallback;rt&&(delete at.reloadCallback,at.parse(at.vectorTile,nt.layerIndex,Qe.availableImages,nt.actor,rt)),Ge(Ne,tt)};"parsing"===at.status?at.reloadCallback=a:"done"===at.status&&(at.vectorTile?at.parse(at.vectorTile,this.layerIndex,this.availableImages,this.actor,a):a())}},l.prototype.abortTile=function(Ne,Ge){var Qe=this.loading,tt=Ne.uid;Qe&&Qe[tt]&&Qe[tt].abort&&(Qe[tt].abort(),delete Qe[tt]),Ge()},l.prototype.removeTile=function(Ne,Ge){var Qe=this.loaded,tt=Ne.uid;Qe&&Qe[tt]&&delete Qe[tt],Ge()};var Ge=Ne.window.ImageBitmap,h=function(){this.loaded={}};function c(Ne,Ge){if(0!==Ne.length){p(Ne[0],Ge);for(var Qe=1;Qe<Ne.length;Qe++)p(Ne[Qe],!Ge)}}function p(Ne,Ge){for(var Qe=0,tt=0,rt=Ne.length,nt=rt-1;tt<rt;nt=tt++)Qe+=(Ne[tt][0]-Ne[nt][0])*(Ne[nt][1]+Ne[tt][1]);Qe>=0!=!!Ge&&Ne.reverse()}h.prototype.loadTile=function(Qe,tt){var rt=Qe.uid,nt=Qe.encoding,at=Qe.rawImageData,it=Ge&&at instanceof Ge?this.getImageData(at):at,ot=new Ne.DEMData(rt,it,nt);this.loaded=this.loaded||{},this.loaded[rt]=ot,tt(null,ot)},h.prototype.getImageData=function(Ge){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Ge.width,Ge.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=Ge.width,this.offscreenCanvas.height=Ge.height,this.offscreenCanvasContext.drawImage(Ge,0,0,Ge.width,Ge.height);var Qe=this.offscreenCanvasContext.getImageData(-1,-1,Ge.width+2,Ge.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new Ne.RGBAImage({width:Qe.width,height:Qe.height},Qe.data)},h.prototype.removeTile=function(Ne){var Ge=this.loaded,Qe=Ne.uid;Ge&&Ge[Qe]&&delete Ge[Qe]};var Qe=Ne.vectorTile.VectorTileFeature.prototype.toGeoJSON,d=function(Ge){this._feature=Ge,this.extent=Ne.EXTENT,this.type=Ge.type,this.properties=Ge.tags,"id"in Ge&&!isNaN(Ge.id)&&(this.id=parseInt(Ge.id,10))};d.prototype.loadGeometry=function(){if(1===this._feature.type){for(var Ge=[],Qe=0,tt=this._feature.geometry;Qe<tt.length;Qe+=1){var rt=tt[Qe];Ge.push([new Ne.Point$1(rt[0],rt[1])])}return Ge}for(var nt=[],at=0,it=this._feature.geometry;at<it.length;at+=1){for(var ot=[],dt=0,ht=it[at];dt<ht.length;dt+=1){var Dt=ht[dt];ot.push(new Ne.Point$1(Dt[0],Dt[1]))}nt.push(ot)}return nt},d.prototype.toGeoJSON=function(Ne,Ge,tt){return Qe.call(this,Ne,Ge,tt)};var g=function(Ge){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=Ne.EXTENT,this.length=Ge.length,this._features=Ge};g.prototype.feature=function(Ne){return new d(this._features[Ne])};var tt=Ne.vectorTile.VectorTileFeature,rt=y;function y(Ne,Ge){this.options=Ge||{},this.features=Ne,this.length=Ne.length}function x(Ne,Ge){this.id="number"==typeof Ne.id?Ne.id:void 0,this.type=Ne.type,this.rawGeometry=1===Ne.type?[Ne.geometry]:Ne.geometry,this.properties=Ne.tags,this.extent=Ge||4096}y.prototype.feature=function(Ne){return new x(this.features[Ne],this.options.extent)},x.prototype.loadGeometry=function(){var Ge=this.rawGeometry;this.geometry=[];for(var Qe=0;Qe<Ge.length;Qe++){for(var tt=Ge[Qe],rt=[],nt=0;nt<tt.length;nt++)rt.push(new Ne.Point$1(tt[nt][0],tt[nt][1]));this.geometry.push(rt)}return this.geometry},x.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ne=this.geometry,Ge=1/0,Qe=-1/0,tt=1/0,rt=-1/0,nt=0;nt<Ne.length;nt++)for(var at=Ne[nt],it=0;it<at.length;it++){var ot=at[it];Ge=Math.min(Ge,ot.x),Qe=Math.max(Qe,ot.x),tt=Math.min(tt,ot.y),rt=Math.max(rt,ot.y)}return[Ge,tt,Qe,rt]},x.prototype.toGeoJSON=tt.prototype.toGeoJSON;var nt=I,at=rt;function I(Ge){var Qe=new Ne.pbf;return function(Ne,Ge){for(var Qe in Ne.layers)Ge.writeMessage(3,M,Ne.layers[Qe])}(Ge,Qe),Qe.finish()}function M(Ne,Ge){var Qe;Ge.writeVarintField(15,Ne.version||1),Ge.writeStringField(1,Ne.name||""),Ge.writeVarintField(5,Ne.extent||4096);var tt={keys:[],values:[],keycache:{},valuecache:{}};for(Qe=0;Qe<Ne.length;Qe++)tt.feature=Ne.feature(Qe),Ge.writeMessage(2,b,tt);var rt=tt.keys;for(Qe=0;Qe<rt.length;Qe++)Ge.writeStringField(3,rt[Qe]);var nt=tt.values;for(Qe=0;Qe<nt.length;Qe++)Ge.writeMessage(4,C,nt[Qe])}function b(Ne,Ge){var Qe=Ne.feature;void 0!==Qe.id&&Ge.writeVarintField(1,Qe.id),Ge.writeMessage(2,_,Ne),Ge.writeVarintField(3,Qe.type),Ge.writeMessage(4,T,Qe)}function _(Ne,Ge){var Qe=Ne.feature,tt=Ne.keys,rt=Ne.values,nt=Ne.keycache,at=Ne.valuecache;for(var it in Qe.properties){var ot=nt[it];void 0===ot&&(tt.push(it),nt[it]=ot=tt.length-1),Ge.writeVarint(ot);var dt=Qe.properties[it],ht=typeof dt;"string"!==ht&&"boolean"!==ht&&"number"!==ht&&(dt=JSON.stringify(dt));var Dt=ht+":"+dt,Ot=at[Dt];void 0===Ot&&(rt.push(dt),at[Dt]=Ot=rt.length-1),Ge.writeVarint(Ot)}}function k(Ne,Ge){return(Ge<<3)+(7&Ne)}function P(Ne){return Ne<<1^Ne>>31}function T(Ne,Ge){for(var Qe=Ne.loadGeometry(),tt=Ne.type,rt=0,nt=0,at=Qe.length,it=0;it<at;it++){var ot=Qe[it],dt=1;1===tt&&(dt=ot.length),Ge.writeVarint(k(1,dt));for(var ht=3===tt?ot.length-1:ot.length,Dt=0;Dt<ht;Dt++){1===Dt&&1!==tt&&Ge.writeVarint(k(2,ht-1));var Ot=ot[Dt].x-rt,Rt=ot[Dt].y-nt;Ge.writeVarint(P(Ot)),Ge.writeVarint(P(Rt)),rt+=Ot,nt+=Rt}3===tt&&Ge.writeVarint(k(7,1))}}function C(Ne,Ge){var Qe=typeof Ne;"string"===Qe?Ge.writeStringField(1,Ne):"boolean"===Qe?Ge.writeBooleanField(7,Ne):"number"===Qe&&(Ne%1!=0?Ge.writeDoubleField(3,Ne):Ne<0?Ge.writeSVarintField(6,Ne):Ge.writeVarintField(5,Ne))}function D(Ne,Ge,Qe,tt){L(Ne,Qe,tt),L(Ge,2*Qe,2*tt),L(Ge,2*Qe+1,2*tt+1)}function L(Ne,Ge,Qe){var tt=Ne[Ge];Ne[Ge]=Ne[Qe],Ne[Qe]=tt}function O(Ne,Ge,Qe,tt){var rt=Ne-Qe,nt=Ge-tt;return rt*rt+nt*nt}nt.fromVectorTileJs=I,nt.fromGeojsonVt=function(Ne,Ge){Ge=Ge||{};var Qe={};for(var tt in Ne)Qe[tt]=new rt(Ne[tt].features,Ge),Qe[tt].name=tt,Qe[tt].version=Ge.version,Qe[tt].extent=Ge.extent;return I({layers:Qe})},nt.GeoJSONWrapper=at;var z=function(Ne){return Ne[0]},E=function(Ne){return Ne[1]},F=function(Ne,Ge,Qe,tt,rt){void 0===Ge&&(Ge=z),void 0===Qe&&(Qe=E),void 0===tt&&(tt=64),void 0===rt&&(rt=Float64Array),this.nodeSize=tt,this.points=Ne;for(var nt=Ne.length<65536?Uint16Array:Uint32Array,at=this.ids=new nt(Ne.length),it=this.coords=new rt(2*Ne.length),ot=0;ot<Ne.length;ot++)at[ot]=ot,it[2*ot]=Ge(Ne[ot]),it[2*ot+1]=Qe(Ne[ot]);!function e(Ne,Ge,Qe,tt,rt,nt){if(!(rt-tt<=Qe)){var at=tt+rt>>1;!function e(Ne,Ge,Qe,tt,rt,nt){for(;rt>tt;){if(rt-tt>600){var at=rt-tt+1,it=Qe-tt+1,ot=Math.log(at),dt=.5*Math.exp(2*ot/3),ht=.5*Math.sqrt(ot*dt*(at-dt)/at)*(it-at/2<0?-1:1);e(Ne,Ge,Qe,Math.max(tt,Math.floor(Qe-it*dt/at+ht)),Math.min(rt,Math.floor(Qe+(at-it)*dt/at+ht)),nt)}var Dt=Ge[2*Qe+nt],Ot=tt,Rt=rt;for(D(Ne,Ge,tt,Qe),Ge[2*rt+nt]>Dt&&D(Ne,Ge,tt,rt);Ot<Rt;){for(D(Ne,Ge,Ot,Rt),Ot++,Rt--;Ge[2*Ot+nt]<Dt;)Ot++;for(;Ge[2*Rt+nt]>Dt;)Rt--}Ge[2*tt+nt]===Dt?D(Ne,Ge,tt,Rt):D(Ne,Ge,++Rt,rt),Rt<=Qe&&(tt=Rt+1),Qe<=Rt&&(rt=Rt-1)}}(Ne,Ge,at,tt,rt,nt%2),e(Ne,Ge,Qe,tt,at-1,nt+1),e(Ne,Ge,Qe,at+1,rt,nt+1)}}(at,it,tt,0,at.length-1,0)};F.prototype.range=function(Ne,Ge,Qe,tt){return function(Ne,Ge,Qe,tt,rt,nt,at){for(var it,ot,dt=[0,Ne.length-1,0],ht=[];dt.length;){var Dt=dt.pop(),Ot=dt.pop(),Rt=dt.pop();if(Ot-Rt<=at)for(var Zt=Rt;Zt<=Ot;Zt++)ot=Ge[2*Zt+1],(it=Ge[2*Zt])>=Qe&&it<=rt&&ot>=tt&&ot<=nt&&ht.push(Ne[Zt]);else{var er=Math.floor((Rt+Ot)/2);ot=Ge[2*er+1],(it=Ge[2*er])>=Qe&&it<=rt&&ot>=tt&&ot<=nt&&ht.push(Ne[er]);var dr=(Dt+1)%2;(0===Dt?Qe<=it:tt<=ot)&&(dt.push(Rt),dt.push(er-1),dt.push(dr)),(0===Dt?rt>=it:nt>=ot)&&(dt.push(er+1),dt.push(Ot),dt.push(dr))}}return ht}(this.ids,this.coords,Ne,Ge,Qe,tt,this.nodeSize)},F.prototype.within=function(Ne,Ge,Qe){return function(Ne,Ge,Qe,tt,rt,nt){for(var at=[0,Ne.length-1,0],it=[],ot=rt*rt;at.length;){var dt=at.pop(),ht=at.pop(),Dt=at.pop();if(ht-Dt<=nt)for(var Ot=Dt;Ot<=ht;Ot++)O(Ge[2*Ot],Ge[2*Ot+1],Qe,tt)<=ot&&it.push(Ne[Ot]);else{var Rt=Math.floor((Dt+ht)/2),Zt=Ge[2*Rt],er=Ge[2*Rt+1];O(Zt,er,Qe,tt)<=ot&&it.push(Ne[Rt]);var dr=(dt+1)%2;(0===dt?Qe-rt<=Zt:tt-rt<=er)&&(at.push(Dt),at.push(Rt-1),at.push(dr)),(0===dt?Qe+rt>=Zt:tt+rt>=er)&&(at.push(Rt+1),at.push(ht),at.push(dr))}}return it}(this.ids,this.coords,Ne,Ge,Qe,this.nodeSize)};var it={minZoom:0,maxZoom:16,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Ne){return Ne}},J=function(Ne){this.options=V(Object.create(it),Ne),this.trees=new Array(this.options.maxZoom+1)};function Z(Ne,Ge,Qe,tt,rt){return{x:Ne,y:Ge,zoom:1/0,id:Qe,parentId:-1,numPoints:tt,properties:rt}}function A(Ne,Ge){var Qe=Ne.geometry.coordinates,tt=Qe[1];return{x:Y(Qe[0]),y:j(tt),zoom:1/0,index:Ge,parentId:-1}}function B(Ne){return{type:"Feature",id:Ne.id,properties:G(Ne),geometry:{type:"Point",coordinates:[(tt=Ne.x,360*(tt-.5)),(Ge=Ne.y,Qe=(180-360*Ge)*Math.PI/180,360*Math.atan(Math.exp(Qe))/Math.PI-90)]}};var Ge,Qe,tt}function G(Ne){var Ge=Ne.numPoints,Qe=Ge>=1e4?Math.round(Ge/1e3)+"k":Ge>=1e3?Math.round(Ge/100)/10+"k":Ge;return V(V({},Ne.properties),{cluster:!0,cluster_id:Ne.id,point_count:Ge,point_count_abbreviated:Qe})}function Y(Ne){return Ne/360+.5}function j(Ne){var Ge=Math.sin(Ne*Math.PI/180),Qe=.5-.25*Math.log((1+Ge)/(1-Ge))/Math.PI;return Qe<0?0:Qe>1?1:Qe}function V(Ne,Ge){for(var Qe in Ge)Ne[Qe]=Ge[Qe];return Ne}function X(Ne){return Ne.x}function W(Ne){return Ne.y}function R(Ne,Ge,Qe,tt,rt,nt){var at=rt-Qe,it=nt-tt;if(0!==at||0!==it){var ot=((Ne-Qe)*at+(Ge-tt)*it)/(at*at+it*it);ot>1?(Qe=rt,tt=nt):ot>0&&(Qe+=at*ot,tt+=it*ot)}return(at=Ne-Qe)*at+(it=Ge-tt)*it}function q(Ne,Ge,Qe,tt){var rt={id:void 0===Ne?null:Ne,type:Ge,geometry:Qe,tags:tt,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ne){var Ge=Ne.geometry,Qe=Ne.type;if("Point"===Qe||"MultiPoint"===Qe||"LineString"===Qe)U(Ne,Ge);else if("Polygon"===Qe||"MultiLineString"===Qe)for(var tt=0;tt<Ge.length;tt++)U(Ne,Ge[tt]);else if("MultiPolygon"===Qe)for(tt=0;tt<Ge.length;tt++)for(var rt=0;rt<Ge[tt].length;rt++)U(Ne,Ge[tt][rt])}(rt),rt}function U(Ne,Ge){for(var Qe=0;Qe<Ge.length;Qe+=3)Ne.minX=Math.min(Ne.minX,Ge[Qe]),Ne.minY=Math.min(Ne.minY,Ge[Qe+1]),Ne.maxX=Math.max(Ne.maxX,Ge[Qe]),Ne.maxY=Math.max(Ne.maxY,Ge[Qe+1])}function $(Ne,Ge,Qe,tt){if(Ge.geometry){var rt=Ge.geometry.coordinates,nt=Ge.geometry.type,at=Math.pow(Qe.tolerance/((1<<Qe.maxZoom)*Qe.extent),2),it=[],ot=Ge.id;if(Qe.promoteId?ot=Ge.properties[Qe.promoteId]:Qe.generateId&&(ot=tt||0),"Point"===nt)H(rt,it);else if("MultiPoint"===nt)for(var dt=0;dt<rt.length;dt++)H(rt[dt],it);else if("LineString"===nt)K(rt,it,at,!1);else if("MultiLineString"===nt){if(Qe.lineMetrics){for(dt=0;dt<rt.length;dt++)K(rt[dt],it=[],at,!1),Ne.push(q(ot,"LineString",it,Ge.properties));return}Q(rt,it,at,!1)}else if("Polygon"===nt)Q(rt,it,at,!0);else{if("MultiPolygon"!==nt){if("GeometryCollection"===nt){for(dt=0;dt<Ge.geometry.geometries.length;dt++)$(Ne,{id:ot,geometry:Ge.geometry.geometries[dt],properties:Ge.properties},Qe,tt);return}throw new Error("Input data is not a valid GeoJSON object.")}for(dt=0;dt<rt.length;dt++){var ht=[];Q(rt[dt],ht,at,!0),it.push(ht)}}Ne.push(q(ot,nt,it,Ge.properties))}}function H(Ne,Ge){Ge.push(ee(Ne[0])),Ge.push(te(Ne[1])),Ge.push(0)}function K(Ne,Ge,Qe,tt){for(var rt,nt,at=0,it=0;it<Ne.length;it++){var ot=ee(Ne[it][0]),dt=te(Ne[it][1]);Ge.push(ot),Ge.push(dt),Ge.push(0),it>0&&(at+=tt?(rt*dt-ot*nt)/2:Math.sqrt(Math.pow(ot-rt,2)+Math.pow(dt-nt,2))),rt=ot,nt=dt}var ht=Ge.length-3;Ge[2]=1,function e(Ne,Ge,Qe,tt){for(var rt,nt=tt,at=Qe-Ge>>1,it=Qe-Ge,ot=Ne[Ge],dt=Ne[Ge+1],ht=Ne[Qe],Dt=Ne[Qe+1],Ot=Ge+3;Ot<Qe;Ot+=3){var Rt=R(Ne[Ot],Ne[Ot+1],ot,dt,ht,Dt);if(Rt>nt)rt=Ot,nt=Rt;else if(Rt===nt){var Zt=Math.abs(Ot-at);Zt<it&&(rt=Ot,it=Zt)}}nt>tt&&(rt-Ge>3&&e(Ne,Ge,rt,tt),Ne[rt+2]=nt,Qe-rt>3&&e(Ne,rt,Qe,tt))}(Ge,0,ht,Qe),Ge[ht+2]=1,Ge.size=Math.abs(at),Ge.start=0,Ge.end=Ge.size}function Q(Ne,Ge,Qe,tt){for(var rt=0;rt<Ne.length;rt++){var nt=[];K(Ne[rt],nt,Qe,tt),Ge.push(nt)}}function ee(Ne){return Ne/360+.5}function te(Ne){var Ge=Math.sin(Ne*Math.PI/180),Qe=.5-.25*Math.log((1+Ge)/(1-Ge))/Math.PI;return Qe<0?0:Qe>1?1:Qe}function re(Ne,Ge,Qe,tt,rt,nt,at,it){if(tt/=Ge,nt>=(Qe/=Ge)&&at<tt)return Ne;if(at<Qe||nt>=tt)return null;for(var ot=[],dt=0;dt<Ne.length;dt++){var ht=Ne[dt],Dt=ht.geometry,Ot=ht.type,Rt=0===rt?ht.minX:ht.minY,Zt=0===rt?ht.maxX:ht.maxY;if(Rt>=Qe&&Zt<tt)ot.push(ht);else if(!(Zt<Qe||Rt>=tt)){var er=[];if("Point"===Ot||"MultiPoint"===Ot)ie(Dt,er,Qe,tt,rt);else if("LineString"===Ot)oe(Dt,er,Qe,tt,rt,!1,it.lineMetrics);else if("MultiLineString"===Ot)se(Dt,er,Qe,tt,rt,!1);else if("Polygon"===Ot)se(Dt,er,Qe,tt,rt,!0);else if("MultiPolygon"===Ot)for(var dr=0;dr<Dt.length;dr++){var mr=[];se(Dt[dr],mr,Qe,tt,rt,!0),mr.length&&er.push(mr)}if(er.length){if(it.lineMetrics&&"LineString"===Ot){for(dr=0;dr<er.length;dr++)ot.push(q(ht.id,Ot,er[dr],ht.tags));continue}"LineString"!==Ot&&"MultiLineString"!==Ot||(1===er.length?(Ot="LineString",er=er[0]):Ot="MultiLineString"),"Point"!==Ot&&"MultiPoint"!==Ot||(Ot=3===er.length?"Point":"MultiPoint"),ot.push(q(ht.id,Ot,er,ht.tags))}}}return ot.length?ot:null}function ie(Ne,Ge,Qe,tt,rt){for(var nt=0;nt<Ne.length;nt+=3){var at=Ne[nt+rt];at>=Qe&&at<=tt&&(Ge.push(Ne[nt]),Ge.push(Ne[nt+1]),Ge.push(Ne[nt+2]))}}function oe(Ne,Ge,Qe,tt,rt,nt,at){for(var it,ot,dt=ne(Ne),ht=0===rt?le:ue,Dt=Ne.start,Ot=0;Ot<Ne.length-3;Ot+=3){var Rt=Ne[Ot],Zt=Ne[Ot+1],er=Ne[Ot+2],dr=Ne[Ot+3],mr=Ne[Ot+4],xr=0===rt?Rt:Zt,br=0===rt?dr:mr,Ar=!1;at&&(it=Math.sqrt(Math.pow(Rt-dr,2)+Math.pow(Zt-mr,2))),xr<Qe?br>Qe&&(ot=ht(dt,Rt,Zt,dr,mr,Qe),at&&(dt.start=Dt+it*ot)):xr>tt?br<tt&&(ot=ht(dt,Rt,Zt,dr,mr,tt),at&&(dt.start=Dt+it*ot)):ae(dt,Rt,Zt,er),br<Qe&&xr>=Qe&&(ot=ht(dt,Rt,Zt,dr,mr,Qe),Ar=!0),br>tt&&xr<=tt&&(ot=ht(dt,Rt,Zt,dr,mr,tt),Ar=!0),!nt&&Ar&&(at&&(dt.end=Dt+it*ot),Ge.push(dt),dt=ne(Ne)),at&&(Dt+=it)}var en=Ne.length-3;Rt=Ne[en],Zt=Ne[en+1],er=Ne[en+2],(xr=0===rt?Rt:Zt)>=Qe&&xr<=tt&&ae(dt,Rt,Zt,er),en=dt.length-3,nt&&en>=3&&(dt[en]!==dt[0]||dt[en+1]!==dt[1])&&ae(dt,dt[0],dt[1],dt[2]),dt.length&&Ge.push(dt)}function ne(Ne){var Ge=[];return Ge.size=Ne.size,Ge.start=Ne.start,Ge.end=Ne.end,Ge}function se(Ne,Ge,Qe,tt,rt,nt){for(var at=0;at<Ne.length;at++)oe(Ne[at],Ge,Qe,tt,rt,nt,!1)}function ae(Ne,Ge,Qe,tt){Ne.push(Ge),Ne.push(Qe),Ne.push(tt)}function le(Ne,Ge,Qe,tt,rt,nt){var at=(nt-Ge)/(tt-Ge);return Ne.push(nt),Ne.push(Qe+(rt-Qe)*at),Ne.push(1),at}function ue(Ne,Ge,Qe,tt,rt,nt){var at=(nt-Qe)/(rt-Qe);return Ne.push(Ge+(tt-Ge)*at),Ne.push(nt),Ne.push(1),at}function he(Ne,Ge){for(var Qe=[],tt=0;tt<Ne.length;tt++){var rt,nt=Ne[tt],at=nt.type;if("Point"===at||"MultiPoint"===at||"LineString"===at)rt=ce(nt.geometry,Ge);else if("MultiLineString"===at||"Polygon"===at){rt=[];for(var it=0;it<nt.geometry.length;it++)rt.push(ce(nt.geometry[it],Ge))}else if("MultiPolygon"===at)for(rt=[],it=0;it<nt.geometry.length;it++){for(var ot=[],dt=0;dt<nt.geometry[it].length;dt++)ot.push(ce(nt.geometry[it][dt],Ge));rt.push(ot)}Qe.push(q(nt.id,at,rt,nt.tags))}return Qe}function ce(Ne,Ge){var Qe=[];Qe.size=Ne.size,void 0!==Ne.start&&(Qe.start=Ne.start,Qe.end=Ne.end);for(var tt=0;tt<Ne.length;tt+=3)Qe.push(Ne[tt]+Ge,Ne[tt+1],Ne[tt+2]);return Qe}function pe(Ne,Ge){if(Ne.transformed)return Ne;var Qe,tt,rt,nt=1<<Ne.z,at=Ne.x,it=Ne.y;for(Qe=0;Qe<Ne.features.length;Qe++){var ot=Ne.features[Qe],dt=ot.geometry,ht=ot.type;if(ot.geometry=[],1===ht)for(tt=0;tt<dt.length;tt+=2)ot.geometry.push(fe(dt[tt],dt[tt+1],Ge,nt,at,it));else for(tt=0;tt<dt.length;tt++){var Dt=[];for(rt=0;rt<dt[tt].length;rt+=2)Dt.push(fe(dt[tt][rt],dt[tt][rt+1],Ge,nt,at,it));ot.geometry.push(Dt)}}return Ne.transformed=!0,Ne}function fe(Ne,Ge,Qe,tt,rt,nt){return[Math.round(Qe*(Ne*tt-rt)),Math.round(Qe*(Ge*tt-nt))]}function de(Ne,Ge,Qe,tt,rt){for(var nt=Ge===rt.maxZoom?0:rt.tolerance/((1<<Ge)*rt.extent),at={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Qe,y:tt,z:Ge,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},it=0;it<Ne.length;it++){at.numFeatures++,ge(at,Ne[it],nt,rt);var ot=Ne[it].minX,dt=Ne[it].minY,ht=Ne[it].maxX,Dt=Ne[it].maxY;ot<at.minX&&(at.minX=ot),dt<at.minY&&(at.minY=dt),ht>at.maxX&&(at.maxX=ht),Dt>at.maxY&&(at.maxY=Dt)}return at}function ge(Ne,Ge,Qe,tt){var rt=Ge.geometry,nt=Ge.type,at=[];if("Point"===nt||"MultiPoint"===nt)for(var it=0;it<rt.length;it+=3)at.push(rt[it]),at.push(rt[it+1]),Ne.numPoints++,Ne.numSimplified++;else if("LineString"===nt)ve(at,rt,Ne,Qe,!1,!1);else if("MultiLineString"===nt||"Polygon"===nt)for(it=0;it<rt.length;it++)ve(at,rt[it],Ne,Qe,"Polygon"===nt,0===it);else if("MultiPolygon"===nt)for(var ot=0;ot<rt.length;ot++){var dt=rt[ot];for(it=0;it<dt.length;it++)ve(at,dt[it],Ne,Qe,!0,0===it)}if(at.length){var ht=Ge.tags||null;if("LineString"===nt&&tt.lineMetrics){for(var Dt in ht={},Ge.tags)ht[Dt]=Ge.tags[Dt];ht.mapbox_clip_start=rt.start/rt.size,ht.mapbox_clip_end=rt.end/rt.size}var Ot={geometry:at,type:"Polygon"===nt||"MultiPolygon"===nt?3:"LineString"===nt||"MultiLineString"===nt?2:1,tags:ht};null!==Ge.id&&(Ot.id=Ge.id),Ne.features.push(Ot)}}function ve(Ne,Ge,Qe,tt,rt,nt){var at=tt*tt;if(tt>0&&Ge.size<(rt?at:tt))Qe.numPoints+=Ge.length/3;else{for(var it=[],ot=0;ot<Ge.length;ot+=3)(0===tt||Ge[ot+2]>at)&&(Qe.numSimplified++,it.push(Ge[ot]),it.push(Ge[ot+1])),Qe.numPoints++;rt&&function(Ne,Ge){for(var Qe=0,tt=0,rt=Ne.length,nt=rt-2;tt<rt;nt=tt,tt+=2)Qe+=(Ne[tt]-Ne[nt])*(Ne[tt+1]+Ne[nt+1]);if(Qe>0===Ge)for(tt=0,rt=Ne.length;tt<rt/2;tt+=2){var at=Ne[tt],it=Ne[tt+1];Ne[tt]=Ne[rt-2-tt],Ne[tt+1]=Ne[rt-1-tt],Ne[rt-2-tt]=at,Ne[rt-1-tt]=it}}(it,nt),Ne.push(it)}}function me(Ne,Ge){var Qe=(Ge=this.options=function(Ne,Ge){for(var Qe in Ge)Ne[Qe]=Ge[Qe];return Ne}(Object.create(this.options),Ge)).debug;if(Qe&&console.time("preprocess data"),Ge.maxZoom<0||Ge.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Ge.promoteId&&Ge.generateId)throw new Error("promoteId and generateId cannot be used together.");var tt=function(Ne,Ge){var Qe=[];if("FeatureCollection"===Ne.type)for(var tt=0;tt<Ne.features.length;tt++)$(Qe,Ne.features[tt],Ge,tt);else $(Qe,"Feature"===Ne.type?Ne:{geometry:Ne},Ge);return Qe}(Ne,Ge);this.tiles={},this.tileCoords=[],Qe&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Ge.indexMaxZoom,Ge.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(tt=function(Ne,Ge){var Qe=Ge.buffer/Ge.extent,tt=Ne,rt=re(Ne,1,-1-Qe,Qe,0,-1,2,Ge),nt=re(Ne,1,1-Qe,2+Qe,0,-1,2,Ge);return(rt||nt)&&(tt=re(Ne,1,-Qe,1+Qe,0,-1,2,Ge)||[],rt&&(tt=he(rt,1).concat(tt)),nt&&(tt=tt.concat(he(nt,-1)))),tt}(tt,Ge)).length&&this.splitTile(tt,0,0,0),Qe&&(tt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ye(Ne,Ge,Qe){return 32*((1<<Ne)*Qe+Ge)+Ne}function xe(Ne,Ge){var Qe=Ne.tileID.canonical;if(!this._geoJSONIndex)return Ge(null,null);var tt=this._geoJSONIndex.getTile(Qe.z,Qe.x,Qe.y);if(!tt)return Ge(null,null);var rt=new g(tt.features),at=nt(rt);0===at.byteOffset&&at.byteLength===at.buffer.byteLength||(at=new Uint8Array(at)),Ge(null,{vectorTile:rt,rawData:at.buffer})}J.prototype.load=function(Ne){var Ge=this.options,Qe=Ge.log,tt=Ge.minZoom,rt=Ge.maxZoom,nt=Ge.nodeSize;Qe&&console.time("total time");var at="prepare "+Ne.length+" points";Qe&&console.time(at),this.points=Ne;for(var it=[],ot=0;ot<Ne.length;ot++)Ne[ot].geometry&&it.push(A(Ne[ot],ot));this.trees[rt+1]=new F(it,X,W,nt,Float32Array),Qe&&console.timeEnd(at);for(var dt=rt;dt>=tt;dt--){var ht=+Date.now();it=this._cluster(it,dt),this.trees[dt]=new F(it,X,W,nt,Float32Array),Qe&&console.log("z%d: %d clusters in %dms",dt,it.length,+Date.now()-ht)}return Qe&&console.timeEnd("total time"),this},J.prototype.getClusters=function(Ne,Ge){var Qe=((Ne[0]+180)%360+360)%360-180,tt=Math.max(-90,Math.min(90,Ne[1])),rt=180===Ne[2]?180:((Ne[2]+180)%360+360)%360-180,nt=Math.max(-90,Math.min(90,Ne[3]));if(Ne[2]-Ne[0]>=360)Qe=-180,rt=180;else if(Qe>rt){var at=this.getClusters([Qe,tt,180,nt],Ge),it=this.getClusters([-180,tt,rt,nt],Ge);return at.concat(it)}for(var ot=this.trees[this._limitZoom(Ge)],dt=[],ht=0,Dt=ot.range(Y(Qe),j(nt),Y(rt),j(tt));ht<Dt.length;ht+=1){var Ot=ot.points[Dt[ht]];dt.push(Ot.numPoints?B(Ot):this.points[Ot.index])}return dt},J.prototype.getChildren=function(Ne){var Ge=this._getOriginId(Ne),Qe=this._getOriginZoom(Ne),tt="No cluster with the specified id.",rt=this.trees[Qe];if(!rt)throw new Error(tt);var nt=rt.points[Ge];if(!nt)throw new Error(tt);for(var at=this.options.radius/(this.options.extent*Math.pow(2,Qe-1)),it=[],ot=0,dt=rt.within(nt.x,nt.y,at);ot<dt.length;ot+=1){var ht=rt.points[dt[ot]];ht.parentId===Ne&&it.push(ht.numPoints?B(ht):this.points[ht.index])}if(0===it.length)throw new Error(tt);return it},J.prototype.getLeaves=function(Ne,Ge,Qe){var tt=[];return this._appendLeaves(tt,Ne,Ge=Ge||10,Qe=Qe||0,0),tt},J.prototype.getTile=function(Ne,Ge,Qe){var tt=this.trees[this._limitZoom(Ne)],rt=Math.pow(2,Ne),nt=this.options,at=nt.radius/nt.extent,it=(Qe-at)/rt,ot=(Qe+1+at)/rt,dt={features:[]};return this._addTileFeatures(tt.range((Ge-at)/rt,it,(Ge+1+at)/rt,ot),tt.points,Ge,Qe,rt,dt),0===Ge&&this._addTileFeatures(tt.range(1-at/rt,it,1,ot),tt.points,rt,Qe,rt,dt),Ge===rt-1&&this._addTileFeatures(tt.range(0,it,at/rt,ot),tt.points,-1,Qe,rt,dt),dt.features.length?dt:null},J.prototype.getClusterExpansionZoom=function(Ne){for(var Ge=this._getOriginZoom(Ne)-1;Ge<=this.options.maxZoom;){var Qe=this.getChildren(Ne);if(Ge++,1!==Qe.length)break;Ne=Qe[0].properties.cluster_id}return Ge},J.prototype._appendLeaves=function(Ne,Ge,Qe,tt,rt){for(var nt=0,at=this.getChildren(Ge);nt<at.length;nt+=1){var it=at[nt],ot=it.properties;if(ot&&ot.cluster?rt+ot.point_count<=tt?rt+=ot.point_count:rt=this._appendLeaves(Ne,ot.cluster_id,Qe,tt,rt):rt<tt?rt++:Ne.push(it),Ne.length===Qe)break}return rt},J.prototype._addTileFeatures=function(Ne,Ge,Qe,tt,rt,nt){for(var at=0,it=Ne;at<it.length;at+=1){var ot=Ge[it[at]],dt=ot.numPoints,ht={type:1,geometry:[[Math.round(this.options.extent*(ot.x*rt-Qe)),Math.round(this.options.extent*(ot.y*rt-tt))]],tags:dt?G(ot):this.points[ot.index].properties},Dt=void 0;dt?Dt=ot.id:this.options.generateId?Dt=ot.index:this.points[ot.index].id&&(Dt=this.points[ot.index].id),void 0!==Dt&&(ht.id=Dt),nt.features.push(ht)}},J.prototype._limitZoom=function(Ne){return Math.max(this.options.minZoom,Math.min(Ne,this.options.maxZoom+1))},J.prototype._cluster=function(Ne,Ge){for(var Qe=[],tt=this.options,rt=tt.reduce,nt=tt.radius/(tt.extent*Math.pow(2,Ge)),at=0;at<Ne.length;at++){var it=Ne[at];if(!(it.zoom<=Ge)){it.zoom=Ge;for(var ot=this.trees[Ge+1],dt=ot.within(it.x,it.y,nt),ht=it.numPoints||1,Dt=it.x*ht,Ot=it.y*ht,Rt=rt&&ht>1?this._map(it,!0):null,Zt=(at<<5)+(Ge+1)+this.points.length,er=0,dr=dt;er<dr.length;er+=1){var mr=ot.points[dr[er]];if(!(mr.zoom<=Ge)){mr.zoom=Ge;var xr=mr.numPoints||1;Dt+=mr.x*xr,Ot+=mr.y*xr,ht+=xr,mr.parentId=Zt,rt&&(Rt||(Rt=this._map(it,!0)),rt(Rt,this._map(mr)))}}1===ht?Qe.push(it):(it.parentId=Zt,Qe.push(Z(Dt/ht,Ot/ht,Zt,ht,Rt)))}}return Qe},J.prototype._getOriginId=function(Ne){return Ne-this.points.length>>5},J.prototype._getOriginZoom=function(Ne){return(Ne-this.points.length)%32},J.prototype._map=function(Ne,Ge){if(Ne.numPoints)return Ge?V({},Ne.properties):Ne.properties;var Qe=this.points[Ne.index].properties,tt=this.options.map(Qe);return Ge&&tt===Qe?V({},tt):tt},me.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},me.prototype.splitTile=function(Ne,Ge,Qe,tt,rt,nt,at){for(var it=[Ne,Ge,Qe,tt],ot=this.options,dt=ot.debug;it.length;){tt=it.pop(),Qe=it.pop(),Ge=it.pop(),Ne=it.pop();var ht=1<<Ge,Dt=ye(Ge,Qe,tt),Ot=this.tiles[Dt];if(!Ot&&(dt>1&&console.time("creation"),Ot=this.tiles[Dt]=de(Ne,Ge,Qe,tt,ot),this.tileCoords.push({z:Ge,x:Qe,y:tt}),dt)){dt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Ge,Qe,tt,Ot.numFeatures,Ot.numPoints,Ot.numSimplified),console.timeEnd("creation"));var Rt="z"+Ge;this.stats[Rt]=(this.stats[Rt]||0)+1,this.total++}if(Ot.source=Ne,rt){if(Ge===ot.maxZoom||Ge===rt)continue;var Zt=1<<rt-Ge;if(Qe!==Math.floor(nt/Zt)||tt!==Math.floor(at/Zt))continue}else if(Ge===ot.indexMaxZoom||Ot.numPoints<=ot.indexMaxPoints)continue;if(Ot.source=null,0!==Ne.length){dt>1&&console.time("clipping");var er,dr,mr,xr,br,Ar,en=.5*ot.buffer/ot.extent,mn=.5-en,xn=.5+en,kn=1+en;er=dr=mr=xr=null,br=re(Ne,ht,Qe-en,Qe+xn,0,Ot.minX,Ot.maxX,ot),Ar=re(Ne,ht,Qe+mn,Qe+kn,0,Ot.minX,Ot.maxX,ot),Ne=null,br&&(er=re(br,ht,tt-en,tt+xn,1,Ot.minY,Ot.maxY,ot),dr=re(br,ht,tt+mn,tt+kn,1,Ot.minY,Ot.maxY,ot),br=null),Ar&&(mr=re(Ar,ht,tt-en,tt+xn,1,Ot.minY,Ot.maxY,ot),xr=re(Ar,ht,tt+mn,tt+kn,1,Ot.minY,Ot.maxY,ot),Ar=null),dt>1&&console.timeEnd("clipping"),it.push(er||[],Ge+1,2*Qe,2*tt),it.push(dr||[],Ge+1,2*Qe,2*tt+1),it.push(mr||[],Ge+1,2*Qe+1,2*tt),it.push(xr||[],Ge+1,2*Qe+1,2*tt+1)}}},me.prototype.getTile=function(Ne,Ge,Qe){var tt=this.options,rt=tt.extent,nt=tt.debug;if(Ne<0||Ne>24)return null;var at=1<<Ne,it=ye(Ne,Ge=(Ge%at+at)%at,Qe);if(this.tiles[it])return pe(this.tiles[it],rt);nt>1&&console.log("drilling down to z%d-%d-%d",Ne,Ge,Qe);for(var ot,dt=Ne,ht=Ge,Dt=Qe;!ot&&dt>0;)dt--,ht=Math.floor(ht/2),Dt=Math.floor(Dt/2),ot=this.tiles[ye(dt,ht,Dt)];return ot&&ot.source?(nt>1&&console.log("found parent tile z%d-%d-%d",dt,ht,Dt),nt>1&&console.time("drilling down"),this.splitTile(ot.source,dt,ht,Dt,Ne,Ge,Qe),nt>1&&console.timeEnd("drilling down"),this.tiles[it]?pe(this.tiles[it],rt):null):null};var ot=function(Ge){function r(Ne,Qe,tt,rt){Ge.call(this,Ne,Qe,tt,xe),rt&&(this.loadGeoJSON=rt)}return Ge&&(r.__proto__=Ge),(r.prototype=Object.create(Ge&&Ge.prototype)).constructor=r,r.prototype.loadData=function(Ne,Ge){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=Ge,this._pendingLoadDataParams=Ne,this._state&&"Idle"!==this._state?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},r.prototype._loadData=function(){var Ge=this;if(this._pendingCallback&&this._pendingLoadDataParams){var Qe=this._pendingCallback,tt=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var rt=!!(tt&&tt.request&&tt.request.collectResourceTiming)&&new Ne.RequestPerformance(tt.request);this.loadGeoJSON(tt,(function(nt,at){if(nt||!at)return Qe(nt);if("object"!=typeof at)return Qe(new Error("Input data given to '"+tt.source+"' is not a valid GeoJSON object."));!function e(Ne,Ge){var Qe,tt=Ne&&Ne.type;if("FeatureCollection"===tt)for(Qe=0;Qe<Ne.features.length;Qe++)e(Ne.features[Qe],Ge);else if("GeometryCollection"===tt)for(Qe=0;Qe<Ne.geometries.length;Qe++)e(Ne.geometries[Qe],Ge);else if("Feature"===tt)e(Ne.geometry,Ge);else if("Polygon"===tt)c(Ne.coordinates,Ge);else if("MultiPolygon"===tt)for(Qe=0;Qe<Ne.coordinates.length;Qe++)c(Ne.coordinates[Qe],Ge);return Ne}(at,!0);try{Ge._geoJSONIndex=tt.cluster?new J(function(Ge){var Qe=Ge.superclusterOptions,tt=Ge.clusterProperties;if(!tt||!Qe)return Qe;for(var rt={},nt={},at={accumulated:null,zoom:0},it={properties:null},ot=Object.keys(tt),dt=0,ht=ot;dt<ht.length;dt+=1){var Dt=ht[dt],Ot=tt[Dt],Rt=Ot[0],Zt=Ne.createExpression(Ot[1]),er=Ne.createExpression("string"==typeof Rt?[Rt,["accumulated"],["get",Dt]]:Rt);rt[Dt]=Zt.value,nt[Dt]=er.value}return Qe.map=function(Ne){it.properties=Ne;for(var Ge={},Qe=0,tt=ot;Qe<tt.length;Qe+=1){var nt=tt[Qe];Ge[nt]=rt[nt].evaluate(at,it)}return Ge},Qe.reduce=function(Ne,Ge){it.properties=Ge;for(var Qe=0,tt=ot;Qe<tt.length;Qe+=1){var rt=tt[Qe];at.accumulated=Ne[rt],Ne[rt]=nt[rt].evaluate(at,it)}},Qe}(tt)).load(at.features):function(Ne,Ge){return new me(Ne,Ge)}(at,tt.geojsonVtOptions)}catch(nt){return Qe(nt)}Ge.loaded={};var it={};if(rt){var ot=rt.finish();ot&&(it.resourceTiming={},it.resourceTiming[tt.source]=JSON.parse(JSON.stringify(ot)))}Qe(null,it)}))}},r.prototype.coalesce=function(){"Coalescing"===this._state?this._state="Idle":"NeedsLoadData"===this._state&&(this._state="Coalescing",this._loadData())},r.prototype.reloadTile=function(Ne,Qe){var tt=this.loaded;return tt&&tt[Ne.uid]?Ge.prototype.reloadTile.call(this,Ne,Qe):this.loadTile(Ne,Qe)},r.prototype.loadGeoJSON=function(Ge,Qe){if(Ge.request)Ne.getJSON(Ge.request,Qe);else{if("string"!=typeof Ge.data)return Qe(new Error("Input data given to '"+Ge.source+"' is not a valid GeoJSON object."));try{return Qe(null,JSON.parse(Ge.data))}catch(Ne){return Qe(new Error("Input data given to '"+Ge.source+"' is not a valid GeoJSON object."))}}},r.prototype.removeSource=function(Ne,Ge){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),Ge()},r.prototype.getClusterExpansionZoom=function(Ne,Ge){try{Ge(null,this._geoJSONIndex.getClusterExpansionZoom(Ne.clusterId))}catch(Ne){Ge(Ne)}},r.prototype.getClusterChildren=function(Ne,Ge){try{Ge(null,this._geoJSONIndex.getChildren(Ne.clusterId))}catch(Ne){Ge(Ne)}},r.prototype.getClusterLeaves=function(Ne,Ge){try{Ge(null,this._geoJSONIndex.getLeaves(Ne.clusterId,Ne.limit,Ne.offset))}catch(Ne){Ge(Ne)}},r}(l),Se=function(Ge){var Qe=this;this.self=Ge,this.actor=new Ne.Actor(Ge,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:l,geojson:ot},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(Ne,Ge){if(Qe.workerSourceTypes[Ne])throw new Error('Worker source with name "'+Ne+'" already registered.');Qe.workerSourceTypes[Ne]=Ge},this.self.registerRTLTextPlugin=function(Ge){if(Ne.plugin.isParsed())throw new Error("RTL text plugin already registered.");Ne.plugin.applyArabicShaping=Ge.applyArabicShaping,Ne.plugin.processBidirectionalText=Ge.processBidirectionalText,Ne.plugin.processStyledBidirectionalText=Ge.processStyledBidirectionalText}};return Se.prototype.setReferrer=function(Ne,Ge){this.referrer=Ge},Se.prototype.setImages=function(Ne,Ge,Qe){for(var tt in this.availableImages[Ne]=Ge,this.workerSources[Ne]){var rt=this.workerSources[Ne][tt];for(var nt in rt)rt[nt].availableImages=Ge}Qe()},Se.prototype.setLayers=function(Ne,Ge,Qe){this.getLayerIndex(Ne).replace(Ge),Qe()},Se.prototype.updateLayers=function(Ne,Ge,Qe){this.getLayerIndex(Ne).update(Ge.layers,Ge.removedIds),Qe()},Se.prototype.loadTile=function(Ne,Ge,Qe){this.getWorkerSource(Ne,Ge.type,Ge.source).loadTile(Ge,Qe)},Se.prototype.loadDEMTile=function(Ne,Ge,Qe){this.getDEMWorkerSource(Ne,Ge.source).loadTile(Ge,Qe)},Se.prototype.reloadTile=function(Ne,Ge,Qe){this.getWorkerSource(Ne,Ge.type,Ge.source).reloadTile(Ge,Qe)},Se.prototype.abortTile=function(Ne,Ge,Qe){this.getWorkerSource(Ne,Ge.type,Ge.source).abortTile(Ge,Qe)},Se.prototype.removeTile=function(Ne,Ge,Qe){this.getWorkerSource(Ne,Ge.type,Ge.source).removeTile(Ge,Qe)},Se.prototype.removeDEMTile=function(Ne,Ge){this.getDEMWorkerSource(Ne,Ge.source).removeTile(Ge)},Se.prototype.removeSource=function(Ne,Ge,Qe){if(this.workerSources[Ne]&&this.workerSources[Ne][Ge.type]&&this.workerSources[Ne][Ge.type][Ge.source]){var tt=this.workerSources[Ne][Ge.type][Ge.source];delete this.workerSources[Ne][Ge.type][Ge.source],void 0!==tt.removeSource?tt.removeSource(Ge,Qe):Qe()}},Se.prototype.loadWorkerSource=function(Ne,Ge,Qe){try{this.self.importScripts(Ge.url),Qe()}catch(Ne){Qe(Ne.toString())}},Se.prototype.syncRTLPluginState=function(Ge,Qe,tt){try{Ne.plugin.setState(Qe);var rt=Ne.plugin.getPluginURL();if(Ne.plugin.isLoaded()&&!Ne.plugin.isParsed()&&null!=rt){this.self.importScripts(rt);var nt=Ne.plugin.isParsed();tt(nt?void 0:new Error("RTL Text Plugin failed to import scripts from "+rt),nt)}}catch(Ne){tt(Ne.toString())}},Se.prototype.getAvailableImages=function(Ne){var Ge=this.availableImages[Ne];return Ge||(Ge=[]),Ge},Se.prototype.getLayerIndex=function(Ne){var Ge=this.layerIndexes[Ne];return Ge||(Ge=this.layerIndexes[Ne]=new i),Ge},Se.prototype.getWorkerSource=function(Ne,Ge,Qe){var tt=this;return this.workerSources[Ne]||(this.workerSources[Ne]={}),this.workerSources[Ne][Ge]||(this.workerSources[Ne][Ge]={}),this.workerSources[Ne][Ge][Qe]||(this.workerSources[Ne][Ge][Qe]=new this.workerSourceTypes[Ge]({send:function(Ge,Qe,rt){tt.actor.send(Ge,Qe,rt,Ne)}},this.getLayerIndex(Ne),this.getAvailableImages(Ne))),this.workerSources[Ne][Ge][Qe]},Se.prototype.getDEMWorkerSource=function(Ne,Ge){return this.demWorkerSources[Ne]||(this.demWorkerSources[Ne]={}),this.demWorkerSources[Ne][Ge]||(this.demWorkerSources[Ne][Ge]=new h),this.demWorkerSources[Ne][Ge]},Se.prototype.enforceCacheSizeLimit=function(Ge,Qe){Ne.enforceCacheSizeLimit(Qe)},"undefined"!=typeof WorkerGlobalScope&&void 0!==Ne.window&&Ne.window instanceof WorkerGlobalScope&&(Ne.window.worker=new Se(Ne.window)),Se})),define(["./shared"],(function(Ne){var Ge=Ne.createCommonjsModule((function(Ne){function e(Ne){return!i(Ne)}function i(Ne){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var Ne,Ge,Qe=new Blob([""],{type:"text/javascript"}),tt=URL.createObjectURL(Qe);try{Ge=new Worker(tt),Ne=!0}catch(Ge){Ne=!1}return Ge&&Ge.terminate(),URL.revokeObjectURL(tt),Ne}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var Ne=document.createElement("canvas");Ne.width=Ne.height=1;var Ge=Ne.getContext("2d");if(!Ge)return!1;var Qe=Ge.getImageData(0,0,1,1);return Qe&&Qe.width===Ne.width}()?(void 0===Ge[Qe=Ne&&Ne.failIfMajorPerformanceCaveat]&&(Ge[Qe]=function(Ne){var Ge=function(Ne){var Ge=document.createElement("canvas"),Qe=Object.create(e.webGLContextAttributes);return Qe.failIfMajorPerformanceCaveat=Ne,Ge.probablySupportsContext?Ge.probablySupportsContext("webgl",Qe)||Ge.probablySupportsContext("experimental-webgl",Qe):Ge.supportsContext?Ge.supportsContext("webgl",Qe)||Ge.supportsContext("experimental-webgl",Qe):Ge.getContext("webgl",Qe)||Ge.getContext("experimental-webgl",Qe)}(Ne);if(!Ge)return!1;var Qe=Ge.createShader(Ge.VERTEX_SHADER);return!(!Qe||Ge.isContextLost())&&(Ge.shaderSource(Qe,"void main() {}"),Ge.compileShader(Qe),!0===Ge.getShaderParameter(Qe,Ge.COMPILE_STATUS))}(Qe)),Ge[Qe]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var Qe}Ne.exports?Ne.exports=e:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=e,window.mapboxgl.notSupportedReason=i);var Ge={};e.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}})),Qe={create:function(Ge,Qe,tt){var rt=Ne.window.document.createElement(Ge);return void 0!==Qe&&(rt.className=Qe),tt&&tt.appendChild(rt),rt},createNS:function(Ge,Qe){return Ne.window.document.createElementNS(Ge,Qe)}},tt=Ne.window.document.documentElement.style;function r(Ne){if(!tt)return Ne[0];for(var Ge=0;Ge<Ne.length;Ge++)if(Ne[Ge]in tt)return Ne[Ge];return Ne[0]}var rt,nt=r(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);Qe.disableDrag=function(){tt&&nt&&(rt=tt[nt],tt[nt]="none")},Qe.enableDrag=function(){tt&&nt&&(tt[nt]=rt)};var at=r(["transform","WebkitTransform"]);Qe.setTransform=function(Ne,Ge){Ne.style[at]=Ge};var it=!1;try{var ot=Object.defineProperty({},"passive",{get:function(){it=!0}});Ne.window.addEventListener("test",ot,ot),Ne.window.removeEventListener("test",ot,ot)}catch(Ne){it=!1}Qe.addEventListener=function(Ne,Ge,Qe,tt){void 0===tt&&(tt={}),Ne.addEventListener(Ge,Qe,"passive"in tt&&it?tt:tt.capture)},Qe.removeEventListener=function(Ne,Ge,Qe,tt){void 0===tt&&(tt={}),Ne.removeEventListener(Ge,Qe,"passive"in tt&&it?tt:tt.capture)};var u=function(Ge){Ge.preventDefault(),Ge.stopPropagation(),Ne.window.removeEventListener("click",u,!0)};function h(Ne){var Ge=Ne.userImage;return!!(Ge&&Ge.render&&Ge.render())&&(Ne.data.replace(new Uint8Array(Ge.data.buffer)),!0)}Qe.suppressClick=function(){Ne.window.addEventListener("click",u,!0),Ne.window.setTimeout((function(){Ne.window.removeEventListener("click",u,!0)}),0)},Qe.mousePos=function(Ge,Qe){var tt=Ge.getBoundingClientRect();return new Ne.Point(Qe.clientX-tt.left-Ge.clientLeft,Qe.clientY-tt.top-Ge.clientTop)},Qe.touchPos=function(Ge,Qe){for(var tt=Ge.getBoundingClientRect(),rt=[],nt=0;nt<Qe.length;nt++)rt.push(new Ne.Point(Qe[nt].clientX-tt.left-Ge.clientLeft,Qe[nt].clientY-tt.top-Ge.clientTop));return rt},Qe.mouseButton=function(Ge){return void 0!==Ne.window.InstallTrigger&&2===Ge.button&&Ge.ctrlKey&&Ne.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:Ge.button},Qe.remove=function(Ne){Ne.parentNode&&Ne.parentNode.removeChild(Ne)};var dt=function(Ge){function i(){Ge.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new Ne.RGBAImage({width:1,height:1}),this.dirty=!0}return Ge&&(i.__proto__=Ge),(i.prototype=Object.create(Ge&&Ge.prototype)).constructor=i,i.prototype.isLoaded=function(){return this.loaded},i.prototype.setLoaded=function(Ne){if(this.loaded!==Ne&&(this.loaded=Ne,Ne)){for(var Ge=0,Qe=this.requestors;Ge<Qe.length;Ge+=1){var tt=Qe[Ge];this._notify(tt.ids,tt.callback)}this.requestors=[]}},i.prototype.getImage=function(Ne){return this.images[Ne]},i.prototype.addImage=function(Ne,Ge){this._validate(Ne,Ge)&&(this.images[Ne]=Ge)},i.prototype._validate=function(Ge,Qe){var tt=!0;return this._validateStretch(Qe.stretchX,Qe.data&&Qe.data.width)||(this.fire(new Ne.ErrorEvent(new Error('Image "'+Ge+'" has invalid "stretchX" value'))),tt=!1),this._validateStretch(Qe.stretchY,Qe.data&&Qe.data.height)||(this.fire(new Ne.ErrorEvent(new Error('Image "'+Ge+'" has invalid "stretchY" value'))),tt=!1),this._validateContent(Qe.content,Qe)||(this.fire(new Ne.ErrorEvent(new Error('Image "'+Ge+'" has invalid "content" value'))),tt=!1),tt},i.prototype._validateStretch=function(Ne,Ge){if(!Ne)return!0;for(var Qe=0,tt=0,rt=Ne;tt<rt.length;tt+=1){var nt=rt[tt];if(nt[0]<Qe||nt[1]<nt[0]||Ge<nt[1])return!1;Qe=nt[1]}return!0},i.prototype._validateContent=function(Ne,Ge){return!(Ne&&(4!==Ne.length||Ne[0]<0||Ge.data.width<Ne[0]||Ne[1]<0||Ge.data.height<Ne[1]||Ne[2]<0||Ge.data.width<Ne[2]||Ne[3]<0||Ge.data.height<Ne[3]||Ne[2]<Ne[0]||Ne[3]<Ne[1]))},i.prototype.updateImage=function(Ne,Ge){Ge.version=this.images[Ne].version+1,this.images[Ne]=Ge,this.updatedImages[Ne]=!0},i.prototype.removeImage=function(Ne){var Ge=this.images[Ne];delete this.images[Ne],delete this.patterns[Ne],Ge.userImage&&Ge.userImage.onRemove&&Ge.userImage.onRemove()},i.prototype.listImages=function(){return Object.keys(this.images)},i.prototype.getImages=function(Ne,Ge){var Qe=!0;if(!this.isLoaded())for(var tt=0,rt=Ne;tt<rt.length;tt+=1)this.images[rt[tt]]||(Qe=!1);this.isLoaded()||Qe?this._notify(Ne,Ge):this.requestors.push({ids:Ne,callback:Ge})},i.prototype._notify=function(Ge,Qe){for(var tt={},rt=0,nt=Ge;rt<nt.length;rt+=1){var at=nt[rt];this.images[at]||this.fire(new Ne.Event("styleimagemissing",{id:at}));var it=this.images[at];it?tt[at]={data:it.data.clone(),pixelRatio:it.pixelRatio,sdf:it.sdf,version:it.version,stretchX:it.stretchX,stretchY:it.stretchY,content:it.content,hasRenderCallback:Boolean(it.userImage&&it.userImage.render)}:Ne.warnOnce('Image "'+at+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}Qe(null,tt)},i.prototype.getPixelSize=function(){var Ne=this.atlasImage;return{width:Ne.width,height:Ne.height}},i.prototype.getPattern=function(Ge){var Qe=this.patterns[Ge],tt=this.getImage(Ge);if(!tt)return null;if(Qe&&Qe.position.version===tt.version)return Qe.position;if(Qe)Qe.position.version=tt.version;else{var rt={w:tt.data.width+2,h:tt.data.height+2,x:0,y:0},nt=new Ne.ImagePosition(rt,tt);this.patterns[Ge]={bin:rt,position:nt}}return this._updatePatternAtlas(),this.patterns[Ge].position},i.prototype.bind=function(Ge){var Qe=Ge.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new Ne.Texture(Ge,this.atlasImage,Qe.RGBA),this.atlasTexture.bind(Qe.LINEAR,Qe.CLAMP_TO_EDGE)},i.prototype._updatePatternAtlas=function(){var Ge=[];for(var Qe in this.patterns)Ge.push(this.patterns[Qe].bin);var tt=Ne.potpack(Ge),rt=tt.w,nt=tt.h,at=this.atlasImage;for(var it in at.resize({width:rt||1,height:nt||1}),this.patterns){var ot=this.patterns[it].bin,dt=ot.x+1,ht=ot.y+1,Dt=this.images[it].data,Ot=Dt.width,Rt=Dt.height;Ne.RGBAImage.copy(Dt,at,{x:0,y:0},{x:dt,y:ht},{width:Ot,height:Rt}),Ne.RGBAImage.copy(Dt,at,{x:0,y:Rt-1},{x:dt,y:ht-1},{width:Ot,height:1}),Ne.RGBAImage.copy(Dt,at,{x:0,y:0},{x:dt,y:ht+Rt},{width:Ot,height:1}),Ne.RGBAImage.copy(Dt,at,{x:Ot-1,y:0},{x:dt-1,y:ht},{width:1,height:Rt}),Ne.RGBAImage.copy(Dt,at,{x:0,y:0},{x:dt+Ot,y:ht},{width:1,height:Rt})}this.dirty=!0},i.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},i.prototype.dispatchRenderCallbacks=function(Ne){for(var Ge=0,Qe=Ne;Ge<Qe.length;Ge+=1){var tt=Qe[Ge];if(!this.callbackDispatchedThisFrame[tt]){this.callbackDispatchedThisFrame[tt]=!0;var rt=this.images[tt];h(rt)&&this.updateImage(tt,rt)}}},i}(Ne.Evented),ht=m,Dt=m,Ot=1e20;function m(Ne,Ge,Qe,tt,rt,nt){this.fontSize=Ne||24,this.buffer=void 0===Ge?3:Ge,this.cutoff=tt||.25,this.fontFamily=rt||"sans-serif",this.fontWeight=nt||"normal",this.radius=Qe||8;var at=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=at,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(at*at),this.gridInner=new Float64Array(at*at),this.f=new Float64Array(at),this.d=new Float64Array(at),this.z=new Float64Array(at+1),this.v=new Int16Array(at),this.middle=Math.round(at/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function g(Ne,Ge,Qe,tt,rt,nt,at){for(var it=0;it<Ge;it++){for(var ot=0;ot<Qe;ot++)tt[ot]=Ne[ot*Ge+it];for(v(tt,rt,nt,at,Qe),ot=0;ot<Qe;ot++)Ne[ot*Ge+it]=rt[ot]}for(ot=0;ot<Qe;ot++){for(it=0;it<Ge;it++)tt[it]=Ne[ot*Ge+it];for(v(tt,rt,nt,at,Ge),it=0;it<Ge;it++)Ne[ot*Ge+it]=Math.sqrt(rt[it])}}function v(Ne,Ge,Qe,tt,rt){Qe[0]=0,tt[0]=-Ot,tt[1]=+Ot;for(var nt=1,at=0;nt<rt;nt++){for(var it=(Ne[nt]+nt*nt-(Ne[Qe[at]]+Qe[at]*Qe[at]))/(2*nt-2*Qe[at]);it<=tt[at];)at--,it=(Ne[nt]+nt*nt-(Ne[Qe[at]]+Qe[at]*Qe[at]))/(2*nt-2*Qe[at]);Qe[++at]=nt,tt[at]=it,tt[at+1]=+Ot}for(nt=0,at=0;nt<rt;nt++){for(;tt[at+1]<nt;)at++;Ge[nt]=(nt-Qe[at])*(nt-Qe[at])+Ne[Qe[at]]}}m.prototype.draw=function(Ne){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(Ne,this.buffer,this.middle);for(var Ge=this.ctx.getImageData(0,0,this.size,this.size),Qe=new Uint8ClampedArray(this.size*this.size),tt=0;tt<this.size*this.size;tt++){var rt=Ge.data[4*tt+3]/255;this.gridOuter[tt]=1===rt?0:0===rt?Ot:Math.pow(Math.max(0,.5-rt),2),this.gridInner[tt]=1===rt?Ot:0===rt?0:Math.pow(Math.max(0,rt-.5),2)}for(g(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),g(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),tt=0;tt<this.size*this.size;tt++)Qe[tt]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[tt]-this.gridInner[tt])/this.radius+this.cutoff))));return Qe},ht.default=Dt;var y=function(Ne,Ge){this.requestManager=Ne,this.localIdeographFontFamily=Ge,this.entries={}};y.prototype.setURL=function(Ne){this.url=Ne},y.prototype.getGlyphs=function(Ge,Qe){var tt=this,rt=[];for(var nt in Ge)for(var at=0,it=Ge[nt];at<it.length;at+=1)rt.push({stack:nt,id:it[at]});Ne.asyncAll(rt,(function(Ne,Ge){var Qe=Ne.stack,rt=Ne.id,nt=tt.entries[Qe];nt||(nt=tt.entries[Qe]={glyphs:{},requests:{},ranges:{}});var at=nt.glyphs[rt];if(void 0===at){if(at=tt._tinySDF(nt,Qe,rt))return nt.glyphs[rt]=at,void Ge(null,{stack:Qe,id:rt,glyph:at});var it=Math.floor(rt/256);if(256*it>65535)Ge(new Error("glyphs > 65535 not supported"));else if(nt.ranges[it])Ge(null,{stack:Qe,id:rt,glyph:at});else{var ot=nt.requests[it];ot||(ot=nt.requests[it]=[],y.loadGlyphRange(Qe,it,tt.url,tt.requestManager,(function(Ne,Ge){if(Ge){for(var Qe in Ge)tt._doesCharSupportLocalGlyph(+Qe)||(nt.glyphs[+Qe]=Ge[+Qe]);nt.ranges[it]=!0}for(var rt=0,at=ot;rt<at.length;rt+=1)(0,at[rt])(Ne,Ge);delete nt.requests[it]}))),ot.push((function(Ne,tt){Ne?Ge(Ne):tt&&Ge(null,{stack:Qe,id:rt,glyph:tt[rt]||null})}))}}else Ge(null,{stack:Qe,id:rt,glyph:at})}),(function(Ne,Ge){if(Ne)Qe(Ne);else if(Ge){for(var tt={},rt=0,nt=Ge;rt<nt.length;rt+=1){var at=nt[rt],it=at.stack,ot=at.id,dt=at.glyph;(tt[it]||(tt[it]={}))[ot]=dt&&{id:dt.id,bitmap:dt.bitmap.clone(),metrics:dt.metrics}}Qe(null,tt)}}))},y.prototype._doesCharSupportLocalGlyph=function(Ge){return!!this.localIdeographFontFamily&&(Ne.isChar["CJK Unified Ideographs"](Ge)||Ne.isChar["Hangul Syllables"](Ge)||Ne.isChar.Hiragana(Ge)||Ne.isChar.Katakana(Ge))},y.prototype._tinySDF=function(Ge,Qe,tt){var rt=this.localIdeographFontFamily;if(rt&&this._doesCharSupportLocalGlyph(tt)){var nt=Ge.tinySDF;if(!nt){var at="400";/bold/i.test(Qe)?at="900":/medium/i.test(Qe)?at="500":/light/i.test(Qe)&&(at="200"),nt=Ge.tinySDF=new y.TinySDF(24,3,8,.25,rt,at)}return{id:tt,bitmap:new Ne.AlphaImage({width:30,height:30},nt.draw(String.fromCharCode(tt))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},y.loadGlyphRange=function(Ge,Qe,tt,rt,nt){var at=256*Qe,it=at+255,ot=rt.transformRequest(rt.normalizeGlyphsURL(tt).replace("{fontstack}",Ge).replace("{range}",at+"-"+it),Ne.ResourceType.Glyphs);Ne.getArrayBuffer(ot,(function(Ge,Qe){if(Ge)nt(Ge);else if(Qe){for(var tt={},rt=0,at=Ne.parseGlyphPBF(Qe);rt<at.length;rt+=1){var it=at[rt];tt[it.id]=it}nt(null,tt)}}))},y.TinySDF=ht;var x=function(){this.specification=Ne.styleSpec.light.position};x.prototype.possiblyEvaluate=function(Ge,Qe){return Ne.sphericalToCartesian(Ge.expression.evaluate(Qe))},x.prototype.interpolate=function(Ge,Qe,tt){return{x:Ne.number(Ge.x,Qe.x,tt),y:Ne.number(Ge.y,Qe.y,tt),z:Ne.number(Ge.z,Qe.z,tt)}};var Rt=new Ne.Properties({anchor:new Ne.DataConstantProperty(Ne.styleSpec.light.anchor),position:new x,color:new Ne.DataConstantProperty(Ne.styleSpec.light.color),intensity:new Ne.DataConstantProperty(Ne.styleSpec.light.intensity)}),Zt=function(Ge){function i(Qe){Ge.call(this),this._transitionable=new Ne.Transitionable(Rt),this.setLight(Qe),this._transitioning=this._transitionable.untransitioned()}return Ge&&(i.__proto__=Ge),(i.prototype=Object.create(Ge&&Ge.prototype)).constructor=i,i.prototype.getLight=function(){return this._transitionable.serialize()},i.prototype.setLight=function(Ge,Qe){if(void 0===Qe&&(Qe={}),!this._validate(Ne.validateLight,Ge,Qe))for(var tt in Ge){var rt=Ge[tt];Ne.endsWith(tt,"-transition")?this._transitionable.setTransition(tt.slice(0,-"-transition".length),rt):this._transitionable.setValue(tt,rt)}},i.prototype.updateTransitions=function(Ne){this._transitioning=this._transitionable.transitioned(Ne,this._transitioning)},i.prototype.hasTransition=function(){return this._transitioning.hasTransition()},i.prototype.recalculate=function(Ne){this.properties=this._transitioning.possiblyEvaluate(Ne)},i.prototype._validate=function(Ge,Qe,tt){return(!tt||!1!==tt.validate)&&Ne.emitValidationErrors(this,Ge.call(Ne.validateStyle,Ne.extend({value:Qe,style:{glyphs:!0,sprite:!0},styleSpec:Ne.styleSpec})))},i}(Ne.Evented),T=function(Ne,Ge){this.width=Ne,this.height=Ge,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};T.prototype.getDash=function(Ne,Ge){var Qe=Ne.join(",")+String(Ge);return this.dashEntry[Qe]||(this.dashEntry[Qe]=this.addDash(Ne,Ge)),this.dashEntry[Qe]},T.prototype.getDashRanges=function(Ne,Ge,Qe){var tt=[],rt=Ne.length%2==1?-Ne[Ne.length-1]*Qe:0,nt=Ne[0]*Qe,at=!0;tt.push({left:rt,right:nt,isDash:at,zeroLength:0===Ne[0]});for(var it=Ne[0],ot=1;ot<Ne.length;ot++){var dt=Ne[ot];tt.push({left:rt=it*Qe,right:nt=(it+=dt)*Qe,isDash:at=!at,zeroLength:0===dt})}return tt},T.prototype.addRoundDash=function(Ne,Ge,Qe){for(var tt=Ge/2,rt=-Qe;rt<=Qe;rt++)for(var nt=this.width*(this.nextRow+Qe+rt),at=0,it=Ne[at],ot=0;ot<this.width;ot++){ot/it.right>1&&(it=Ne[++at]);var dt=Math.abs(ot-it.left),ht=Math.abs(ot-it.right),Dt=Math.min(dt,ht),Ot=void 0,Rt=rt/Qe*(tt+1);if(it.isDash){var Zt=tt-Math.abs(Rt);Ot=Math.sqrt(Dt*Dt+Zt*Zt)}else Ot=tt-Math.sqrt(Dt*Dt+Rt*Rt);this.data[nt+ot]=Math.max(0,Math.min(255,Ot+128))}},T.prototype.addRegularDash=function(Ne){for(var Ge=Ne.length-1;Ge>=0;--Ge){var Qe=Ne[Ge],tt=Ne[Ge+1];Qe.zeroLength?Ne.splice(Ge,1):tt&&tt.isDash===Qe.isDash&&(tt.left=Qe.left,Ne.splice(Ge,1))}var rt=Ne[0],nt=Ne[Ne.length-1];rt.isDash===nt.isDash&&(rt.left=nt.left-this.width,nt.right=rt.right+this.width);for(var at=this.width*this.nextRow,it=0,ot=Ne[it],dt=0;dt<this.width;dt++){dt/ot.right>1&&(ot=Ne[++it]);var ht=Math.abs(dt-ot.left),Dt=Math.abs(dt-ot.right),Ot=Math.min(ht,Dt);this.data[at+dt]=Math.max(0,Math.min(255,(ot.isDash?Ot:-Ot)+128))}},T.prototype.addDash=function(Ge,Qe){var tt=Qe?7:0,rt=2*tt+1;if(this.nextRow+rt>this.height)return Ne.warnOnce("LineAtlas out of space"),null;for(var nt=0,at=0;at<Ge.length;at++)nt+=Ge[at];if(0!==nt){var it=this.width/nt,ot=this.getDashRanges(Ge,this.width,it);Qe?this.addRoundDash(ot,it,tt):this.addRegularDash(ot)}var dt={y:(this.nextRow+tt+.5)/this.height,height:2*tt/this.height,width:nt};return this.nextRow+=rt,this.dirty=!0,dt},T.prototype.bind=function(Ne){var Ge=Ne.gl;this.texture?(Ge.bindTexture(Ge.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,Ge.texSubImage2D(Ge.TEXTURE_2D,0,0,0,this.width,this.height,Ge.ALPHA,Ge.UNSIGNED_BYTE,this.data))):(this.texture=Ge.createTexture(),Ge.bindTexture(Ge.TEXTURE_2D,this.texture),Ge.texParameteri(Ge.TEXTURE_2D,Ge.TEXTURE_WRAP_S,Ge.REPEAT),Ge.texParameteri(Ge.TEXTURE_2D,Ge.TEXTURE_WRAP_T,Ge.REPEAT),Ge.texParameteri(Ge.TEXTURE_2D,Ge.TEXTURE_MIN_FILTER,Ge.LINEAR),Ge.texParameteri(Ge.TEXTURE_2D,Ge.TEXTURE_MAG_FILTER,Ge.LINEAR),Ge.texImage2D(Ge.TEXTURE_2D,0,Ge.ALPHA,this.width,this.height,0,Ge.ALPHA,Ge.UNSIGNED_BYTE,this.data))};var er=function e(Ge,Qe){this.workerPool=Ge,this.actors=[],this.currentActor=0,this.id=Ne.uniqueId();for(var tt=this.workerPool.acquire(this.id),rt=0;rt<tt.length;rt++){var nt=new e.Actor(tt[rt],Qe,this.id);nt.name="Worker "+rt,this.actors.push(nt)}};function I(Ge,Qe,tt){var r=function(rt,nt){if(rt)return tt(rt);if(nt){var at=Ne.pick(Ne.extend(nt,Ge),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);nt.vector_layers&&(at.vectorLayers=nt.vector_layers,at.vectorLayerIds=at.vectorLayers.map((function(Ne){return Ne.id}))),at.tiles=Qe.canonicalizeTileset(at,Ge.url),tt(null,at)}};return Ge.url?Ne.getJSON(Qe.transformRequest(Qe.normalizeSourceURL(Ge.url),Ne.ResourceType.Source),r):Ne.browser.frame((function(){return r(null,Ge)}))}er.prototype.broadcast=function(Ge,Qe,tt){Ne.asyncAll(this.actors,(function(Ne,tt){Ne.send(Ge,Qe,tt)}),tt=tt||function(){})},er.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},er.prototype.remove=function(){this.actors.forEach((function(Ne){Ne.remove()})),this.actors=[],this.workerPool.release(this.id)},er.Actor=Ne.Actor;var P=function(Ge,Qe,tt){this.bounds=Ne.LngLatBounds.convert(this.validateBounds(Ge)),this.minzoom=Qe||0,this.maxzoom=tt||24};P.prototype.validateBounds=function(Ne){return Array.isArray(Ne)&&4===Ne.length?[Math.max(-180,Ne[0]),Math.max(-90,Ne[1]),Math.min(180,Ne[2]),Math.min(90,Ne[3])]:[-180,-90,180,90]},P.prototype.contains=function(Ge){var Qe=Math.pow(2,Ge.z),tt=Math.floor(Ne.mercatorXfromLng(this.bounds.getWest())*Qe),rt=Math.floor(Ne.mercatorYfromLat(this.bounds.getNorth())*Qe),nt=Math.ceil(Ne.mercatorXfromLng(this.bounds.getEast())*Qe),at=Math.ceil(Ne.mercatorYfromLat(this.bounds.getSouth())*Qe);return Ge.x>=tt&&Ge.x<nt&&Ge.y>=rt&&Ge.y<at};var dr=function(Ge){function i(Qe,tt,rt,nt){if(Ge.call(this),this.id=Qe,this.dispatcher=rt,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,Ne.extend(this,Ne.pick(tt,["url","scheme","tileSize","promoteId"])),this._options=Ne.extend({type:"vector"},tt),this._collectResourceTiming=tt.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(nt)}return Ge&&(i.__proto__=Ge),(i.prototype=Object.create(Ge&&Ge.prototype)).constructor=i,i.prototype.load=function(){var Ge=this;this._loaded=!1,this.fire(new Ne.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=I(this._options,this.map._requestManager,(function(Qe,tt){Ge._tileJSONRequest=null,Ge._loaded=!0,Qe?Ge.fire(new Ne.ErrorEvent(Qe)):tt&&(Ne.extend(Ge,tt),tt.bounds&&(Ge.tileBounds=new P(tt.bounds,Ge.minzoom,Ge.maxzoom)),Ne.postTurnstileEvent(tt.tiles,Ge.map._requestManager._customAccessToken),Ne.postMapLoadEvent(tt.tiles,Ge.map._getMapId(),Ge.map._requestManager._skuToken,Ge.map._requestManager._customAccessToken),Ge.fire(new Ne.Event("data",{dataType:"source",sourceDataType:"metadata"})),Ge.fire(new Ne.Event("data",{dataType:"source",sourceDataType:"content"})))}))},i.prototype.loaded=function(){return this._loaded},i.prototype.hasTile=function(Ne){return!this.tileBounds||this.tileBounds.contains(Ne.canonical)},i.prototype.onAdd=function(Ne){this.map=Ne,this.load()},i.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},i.prototype.serialize=function(){return Ne.extend({},this._options)},i.prototype.loadTile=function(Ge,Qe){var tt=this.map._requestManager.normalizeTileURL(Ge.tileID.canonical.url(this.tiles,this.scheme)),rt={request:this.map._requestManager.transformRequest(tt,Ne.ResourceType.Tile),uid:Ge.uid,tileID:Ge.tileID,zoom:Ge.tileID.overscaledZ,tileSize:this.tileSize*Ge.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:Ne.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function a(tt,rt){return delete Ge.request,Ge.aborted?Qe(null):tt&&404!==tt.status?Qe(tt):(rt&&rt.resourceTiming&&(Ge.resourceTiming=rt.resourceTiming),this.map._refreshExpiredTiles&&rt&&Ge.setExpiryData(rt),Ge.loadVectorData(rt,this.map.painter),Ne.cacheEntryPossiblyAdded(this.dispatcher),Qe(null),void(Ge.reloadCallback&&(this.loadTile(Ge,Ge.reloadCallback),Ge.reloadCallback=null)))}rt.request.collectResourceTiming=this._collectResourceTiming,Ge.actor&&"expired"!==Ge.state?"loading"===Ge.state?Ge.reloadCallback=Qe:Ge.request=Ge.actor.send("reloadTile",rt,a.bind(this)):(Ge.actor=this.dispatcher.getActor(),Ge.request=Ge.actor.send("loadTile",rt,a.bind(this)))},i.prototype.abortTile=function(Ne){Ne.request&&(Ne.request.cancel(),delete Ne.request),Ne.actor&&Ne.actor.send("abortTile",{uid:Ne.uid,type:this.type,source:this.id},void 0)},i.prototype.unloadTile=function(Ne){Ne.unloadVectorData(),Ne.actor&&Ne.actor.send("removeTile",{uid:Ne.uid,type:this.type,source:this.id},void 0)},i.prototype.hasTransition=function(){return!1},i}(Ne.Evented),mr=function(Ge){function i(Qe,tt,rt,nt){Ge.call(this),this.id=Qe,this.dispatcher=rt,this.setEventedParent(nt),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=Ne.extend({type:"raster"},tt),Ne.extend(this,Ne.pick(tt,["url","scheme","tileSize"]))}return Ge&&(i.__proto__=Ge),(i.prototype=Object.create(Ge&&Ge.prototype)).constructor=i,i.prototype.load=function(){var Ge=this;this._loaded=!1,this.fire(new Ne.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=I(this._options,this.map._requestManager,(function(Qe,tt){Ge._tileJSONRequest=null,Ge._loaded=!0,Qe?Ge.fire(new Ne.ErrorEvent(Qe)):tt&&(Ne.extend(Ge,tt),tt.bounds&&(Ge.tileBounds=new P(tt.bounds,Ge.minzoom,Ge.maxzoom)),Ne.postTurnstileEvent(tt.tiles),Ne.postMapLoadEvent(tt.tiles,Ge.map._getMapId(),Ge.map._requestManager._skuToken),Ge.fire(new Ne.Event("data",{dataType:"source",sourceDataType:"metadata"})),Ge.fire(new Ne.Event("data",{dataType:"source",sourceDataType:"content"})))}))},i.prototype.loaded=function(){return this._loaded},i.prototype.onAdd=function(Ne){this.map=Ne,this.load()},i.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},i.prototype.serialize=function(){return Ne.extend({},this._options)},i.prototype.hasTile=function(Ne){return!this.tileBounds||this.tileBounds.contains(Ne.canonical)},i.prototype.loadTile=function(Ge,Qe){var tt=this,rt=this.map._requestManager.normalizeTileURL(Ge.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);Ge.request=Ne.getImage(this.map._requestManager.transformRequest(rt,Ne.ResourceType.Tile),(function(rt,nt){if(delete Ge.request,Ge.aborted)Ge.state="unloaded",Qe(null);else if(rt)Ge.state="errored",Qe(rt);else if(nt){tt.map._refreshExpiredTiles&&Ge.setExpiryData(nt),delete nt.cacheControl,delete nt.expires;var at=tt.map.painter.context,it=at.gl;Ge.texture=tt.map.painter.getTileTexture(nt.width),Ge.texture?Ge.texture.update(nt,{useMipmap:!0}):(Ge.texture=new Ne.Texture(at,nt,it.RGBA,{useMipmap:!0}),Ge.texture.bind(it.LINEAR,it.CLAMP_TO_EDGE,it.LINEAR_MIPMAP_NEAREST),at.extTextureFilterAnisotropic&&it.texParameterf(it.TEXTURE_2D,at.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,at.extTextureFilterAnisotropicMax)),Ge.state="loaded",Ne.cacheEntryPossiblyAdded(tt.dispatcher),Qe(null)}}))},i.prototype.abortTile=function(Ne,Ge){Ne.request&&(Ne.request.cancel(),delete Ne.request),Ge()},i.prototype.unloadTile=function(Ne,Ge){Ne.texture&&this.map.painter.saveTileTexture(Ne.texture),Ge()},i.prototype.hasTransition=function(){return!1},i}(Ne.Evented),xr=function(Ge){function i(Qe,tt,rt,nt){Ge.call(this,Qe,tt,rt,nt),this.type="raster-dem",this.maxzoom=22,this._options=Ne.extend({type:"raster-dem"},tt),this.encoding=tt.encoding||"mapbox"}return Ge&&(i.__proto__=Ge),(i.prototype=Object.create(Ge&&Ge.prototype)).constructor=i,i.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},i.prototype.loadTile=function(Ge,Qe){var tt=this.map._requestManager.normalizeTileURL(Ge.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function r(Ne,tt){Ne&&(Ge.state="errored",Qe(Ne)),tt&&(Ge.dem=tt,Ge.needsHillshadePrepare=!0,Ge.state="loaded",Qe(null))}Ge.request=Ne.getImage(this.map._requestManager.transformRequest(tt,Ne.ResourceType.Tile),function(tt,rt){if(delete Ge.request,Ge.aborted)Ge.state="unloaded",Qe(null);else if(tt)Ge.state="errored",Qe(tt);else if(rt){this.map._refreshExpiredTiles&&Ge.setExpiryData(rt),delete rt.cacheControl,delete rt.expires;var nt=Ne.window.ImageBitmap&&rt instanceof Ne.window.ImageBitmap&&Ne.offscreenCanvasSupported()?rt:Ne.browser.getImageData(rt,1),at={uid:Ge.uid,coord:Ge.tileID,source:this.id,rawImageData:nt,encoding:this.encoding};Ge.actor&&"expired"!==Ge.state||(Ge.actor=this.dispatcher.getActor(),Ge.actor.send("loadDEMTile",at,r.bind(this)))}}.bind(this)),Ge.neighboringTiles=this._getNeighboringTiles(Ge.tileID)},i.prototype._getNeighboringTiles=function(Ge){var Qe=Ge.canonical,tt=Math.pow(2,Qe.z),rt=(Qe.x-1+tt)%tt,nt=0===Qe.x?Ge.wrap-1:Ge.wrap,at=(Qe.x+1+tt)%tt,it=Qe.x+1===tt?Ge.wrap+1:Ge.wrap,ot={};return ot[new Ne.OverscaledTileID(Ge.overscaledZ,nt,Qe.z,rt,Qe.y).key]={backfilled:!1},ot[new Ne.OverscaledTileID(Ge.overscaledZ,it,Qe.z,at,Qe.y).key]={backfilled:!1},Qe.y>0&&(ot[new Ne.OverscaledTileID(Ge.overscaledZ,nt,Qe.z,rt,Qe.y-1).key]={backfilled:!1},ot[new Ne.OverscaledTileID(Ge.overscaledZ,Ge.wrap,Qe.z,Qe.x,Qe.y-1).key]={backfilled:!1},ot[new Ne.OverscaledTileID(Ge.overscaledZ,it,Qe.z,at,Qe.y-1).key]={backfilled:!1}),Qe.y+1<tt&&(ot[new Ne.OverscaledTileID(Ge.overscaledZ,nt,Qe.z,rt,Qe.y+1).key]={backfilled:!1},ot[new Ne.OverscaledTileID(Ge.overscaledZ,Ge.wrap,Qe.z,Qe.x,Qe.y+1).key]={backfilled:!1},ot[new Ne.OverscaledTileID(Ge.overscaledZ,it,Qe.z,at,Qe.y+1).key]={backfilled:!1}),ot},i.prototype.unloadTile=function(Ne){Ne.demTexture&&this.map.painter.saveTileTexture(Ne.demTexture),Ne.fbo&&(Ne.fbo.destroy(),delete Ne.fbo),Ne.dem&&delete Ne.dem,delete Ne.neighboringTiles,Ne.state="unloaded",Ne.actor&&Ne.actor.send("removeDEMTile",{uid:Ne.uid,source:this.id})},i}(mr),br=function(Ge){function i(Qe,tt,rt,nt){Ge.call(this),this.id=Qe,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=rt.getActor(),this.setEventedParent(nt),this._data=tt.data,this._options=Ne.extend({},tt),this._collectResourceTiming=tt.collectResourceTiming,this._resourceTiming=[],void 0!==tt.maxzoom&&(this.maxzoom=tt.maxzoom),tt.type&&(this.type=tt.type),tt.attribution&&(this.attribution=tt.attribution),this.promoteId=tt.promoteId;var at=Ne.EXTENT/this.tileSize;this.workerOptions=Ne.extend({source:this.id,cluster:tt.cluster||!1,geojsonVtOptions:{buffer:(void 0!==tt.buffer?tt.buffer:128)*at,tolerance:(void 0!==tt.tolerance?tt.tolerance:.375)*at,extent:Ne.EXTENT,maxZoom:this.maxzoom,lineMetrics:tt.lineMetrics||!1,generateId:tt.generateId||!1},superclusterOptions:{maxZoom:void 0!==tt.clusterMaxZoom?Math.min(tt.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,extent:Ne.EXTENT,radius:(tt.clusterRadius||50)*at,log:!1,generateId:tt.generateId||!1},clusterProperties:tt.clusterProperties},tt.workerOptions)}return Ge&&(i.__proto__=Ge),(i.prototype=Object.create(Ge&&Ge.prototype)).constructor=i,i.prototype.load=function(){var Ge=this;this.fire(new Ne.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(Qe){if(Qe)Ge.fire(new Ne.ErrorEvent(Qe));else{var tt={dataType:"source",sourceDataType:"metadata"};Ge._collectResourceTiming&&Ge._resourceTiming&&Ge._resourceTiming.length>0&&(tt.resourceTiming=Ge._resourceTiming,Ge._resourceTiming=[]),Ge.fire(new Ne.Event("data",tt))}}))},i.prototype.onAdd=function(Ne){this.map=Ne,this.load()},i.prototype.setData=function(Ge){var Qe=this;return this._data=Ge,this.fire(new Ne.Event("dataloading",{dataType:"source"})),this._updateWorkerData((function(Ge){if(Ge)Qe.fire(new Ne.ErrorEvent(Ge));else{var tt={dataType:"source",sourceDataType:"content"};Qe._collectResourceTiming&&Qe._resourceTiming&&Qe._resourceTiming.length>0&&(tt.resourceTiming=Qe._resourceTiming,Qe._resourceTiming=[]),Qe.fire(new Ne.Event("data",tt))}})),this},i.prototype.getClusterExpansionZoom=function(Ne,Ge){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:Ne,source:this.id},Ge),this},i.prototype.getClusterChildren=function(Ne,Ge){return this.actor.send("geojson.getClusterChildren",{clusterId:Ne,source:this.id},Ge),this},i.prototype.getClusterLeaves=function(Ne,Ge,Qe,tt){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:Ne,limit:Ge,offset:Qe},tt),this},i.prototype._updateWorkerData=function(Ge){var Qe=this;this._loaded=!1;var tt=Ne.extend({},this.workerOptions),rt=this._data;"string"==typeof rt?(tt.request=this.map._requestManager.transformRequest(Ne.browser.resolveURL(rt),Ne.ResourceType.Source),tt.request.collectResourceTiming=this._collectResourceTiming):tt.data=JSON.stringify(rt),this.actor.send(this.type+".loadData",tt,(function(Ne,rt){Qe._removed||rt&&rt.abandoned||(Qe._loaded=!0,rt&&rt.resourceTiming&&rt.resourceTiming[Qe.id]&&(Qe._resourceTiming=rt.resourceTiming[Qe.id].slice(0)),Qe.actor.send(Qe.type+".coalesce",{source:tt.source},null),Ge(Ne))}))},i.prototype.loaded=function(){return this._loaded},i.prototype.loadTile=function(Ge,Qe){var tt=this,rt=Ge.actor?"reloadTile":"loadTile";Ge.actor=this.actor,Ge.request=this.actor.send(rt,{type:this.type,uid:Ge.uid,tileID:Ge.tileID,zoom:Ge.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:Ne.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(function(Ne,nt){return delete Ge.request,Ge.unloadVectorData(),Ge.aborted?Qe(null):Ne?Qe(Ne):(Ge.loadVectorData(nt,tt.map.painter,"reloadTile"===rt),Qe(null))}))},i.prototype.abortTile=function(Ne){Ne.request&&(Ne.request.cancel(),delete Ne.request),Ne.aborted=!0},i.prototype.unloadTile=function(Ne){Ne.unloadVectorData(),this.actor.send("removeTile",{uid:Ne.uid,type:this.type,source:this.id})},i.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},i.prototype.serialize=function(){return Ne.extend({},this._options,{type:this.type,data:this._data})},i.prototype.hasTransition=function(){return!1},i}(Ne.Evented),Ar=Ne.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),en=function(Ge){function i(Ne,Qe,tt,rt){Ge.call(this),this.id=Ne,this.dispatcher=tt,this.coordinates=Qe.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(rt),this.options=Qe}return Ge&&(i.__proto__=Ge),(i.prototype=Object.create(Ge&&Ge.prototype)).constructor=i,i.prototype.load=function(Ge,Qe){var tt=this;this._loaded=!1,this.fire(new Ne.Event("dataloading",{dataType:"source"})),this.url=this.options.url,Ne.getImage(this.map._requestManager.transformRequest(this.url,Ne.ResourceType.Image),(function(rt,nt){tt._loaded=!0,rt?tt.fire(new Ne.ErrorEvent(rt)):nt&&(tt.image=nt,Ge&&(tt.coordinates=Ge),Qe&&Qe(),tt._finishLoading())}))},i.prototype.loaded=function(){return this._loaded},i.prototype.updateImage=function(Ne){var Ge=this;return this.image&&Ne.url?(this.options.url=Ne.url,this.load(Ne.coordinates,(function(){Ge.texture=null})),this):this},i.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Ne.Event("data",{dataType:"source",sourceDataType:"metadata"})))},i.prototype.onAdd=function(Ne){this.map=Ne,this.load()},i.prototype.setCoordinates=function(Ge){var Qe=this;this.coordinates=Ge;var tt=Ge.map(Ne.MercatorCoordinate.fromLngLat);this.tileID=function(Ge){for(var Qe=1/0,tt=1/0,rt=-1/0,nt=-1/0,at=0,it=Ge;at<it.length;at+=1){var ot=it[at];Qe=Math.min(Qe,ot.x),tt=Math.min(tt,ot.y),rt=Math.max(rt,ot.x),nt=Math.max(nt,ot.y)}var dt=Math.max(rt-Qe,nt-tt),ht=Math.max(0,Math.floor(-Math.log(dt)/Math.LN2)),Dt=Math.pow(2,ht);return new Ne.CanonicalTileID(ht,Math.floor((Qe+rt)/2*Dt),Math.floor((tt+nt)/2*Dt))}(tt),this.minzoom=this.maxzoom=this.tileID.z;var rt=tt.map((function(Ne){return Qe.tileID.getTilePoint(Ne)._round()}));return this._boundsArray=new Ne.StructArrayLayout4i8,this._boundsArray.emplaceBack(rt[0].x,rt[0].y,0,0),this._boundsArray.emplaceBack(rt[1].x,rt[1].y,Ne.EXTENT,0),this._boundsArray.emplaceBack(rt[3].x,rt[3].y,0,Ne.EXTENT),this._boundsArray.emplaceBack(rt[2].x,rt[2].y,Ne.EXTENT,Ne.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new Ne.Event("data",{dataType:"source",sourceDataType:"content"})),this},i.prototype.prepare=function(){if(0!==Object.keys(this.tiles).length&&this.image){var Ge=this.map.painter.context,Qe=Ge.gl;for(var tt in this.boundsBuffer||(this.boundsBuffer=Ge.createVertexBuffer(this._boundsArray,Ar.members)),this.boundsSegments||(this.boundsSegments=Ne.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new Ne.Texture(Ge,this.image,Qe.RGBA),this.texture.bind(Qe.LINEAR,Qe.CLAMP_TO_EDGE)),this.tiles){var rt=this.tiles[tt];"loaded"!==rt.state&&(rt.state="loaded",rt.texture=this.texture)}}},i.prototype.loadTile=function(Ne,Ge){this.tileID&&this.tileID.equals(Ne.tileID.canonical)?(this.tiles[String(Ne.tileID.wrap)]=Ne,Ne.buckets={},Ge(null)):(Ne.state="errored",Ge(null))},i.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},i.prototype.hasTransition=function(){return!1},i}(Ne.Evented),mn=function(Ge){function i(Ne,Qe,tt,rt){Ge.call(this,Ne,Qe,tt,rt),this.roundZoom=!0,this.type="video",this.options=Qe}return Ge&&(i.__proto__=Ge),(i.prototype=Object.create(Ge&&Ge.prototype)).constructor=i,i.prototype.load=function(){var Ge=this;this._loaded=!1;var Qe=this.options;this.urls=[];for(var tt=0,rt=Qe.urls;tt<rt.length;tt+=1)this.urls.push(this.map._requestManager.transformRequest(rt[tt],Ne.ResourceType.Source).url);Ne.getVideo(this.urls,(function(Qe,tt){Ge._loaded=!0,Qe?Ge.fire(new Ne.ErrorEvent(Qe)):tt&&(Ge.video=tt,Ge.video.loop=!0,Ge.video.addEventListener("playing",(function(){Ge.map.triggerRepaint()})),Ge.map&&Ge.video.play(),Ge._finishLoading())}))},i.prototype.pause=function(){this.video&&this.video.pause()},i.prototype.play=function(){this.video&&this.video.play()},i.prototype.seek=function(Ge){if(this.video){var Qe=this.video.seekable;Ge<Qe.start(0)||Ge>Qe.end(0)?this.fire(new Ne.ErrorEvent(new Ne.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+Qe.start(0)+" and "+Qe.end(0)+"-second mark."))):this.video.currentTime=Ge}},i.prototype.getVideo=function(){return this.video},i.prototype.onAdd=function(Ne){this.map||(this.map=Ne,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},i.prototype.prepare=function(){if(!(0===Object.keys(this.tiles).length||this.video.readyState<2)){var Ge=this.map.painter.context,Qe=Ge.gl;for(var tt in this.boundsBuffer||(this.boundsBuffer=Ge.createVertexBuffer(this._boundsArray,Ar.members)),this.boundsSegments||(this.boundsSegments=Ne.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(Qe.LINEAR,Qe.CLAMP_TO_EDGE),Qe.texSubImage2D(Qe.TEXTURE_2D,0,0,0,Qe.RGBA,Qe.UNSIGNED_BYTE,this.video)):(this.texture=new Ne.Texture(Ge,this.video,Qe.RGBA),this.texture.bind(Qe.LINEAR,Qe.CLAMP_TO_EDGE)),this.tiles){var rt=this.tiles[tt];"loaded"!==rt.state&&(rt.state="loaded",rt.texture=this.texture)}}},i.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},i.prototype.hasTransition=function(){return this.video&&!this.video.paused},i}(en),xn=function(Ge){function i(Qe,tt,rt,nt){Ge.call(this,Qe,tt,rt,nt),tt.coordinates?Array.isArray(tt.coordinates)&&4===tt.coordinates.length&&!tt.coordinates.some((function(Ne){return!Array.isArray(Ne)||2!==Ne.length||Ne.some((function(Ne){return"number"!=typeof Ne}))}))||this.fire(new Ne.ErrorEvent(new Ne.ValidationError("sources."+Qe,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new Ne.ErrorEvent(new Ne.ValidationError("sources."+Qe,null,'missing required property "coordinates"'))),tt.animate&&"boolean"!=typeof tt.animate&&this.fire(new Ne.ErrorEvent(new Ne.ValidationError("sources."+Qe,null,'optional "animate" property must be a boolean value'))),tt.canvas?"string"==typeof tt.canvas||tt.canvas instanceof Ne.window.HTMLCanvasElement||this.fire(new Ne.ErrorEvent(new Ne.ValidationError("sources."+Qe,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new Ne.ErrorEvent(new Ne.ValidationError("sources."+Qe,null,'missing required property "canvas"'))),this.options=tt,this.animate=void 0===tt.animate||tt.animate}return Ge&&(i.__proto__=Ge),(i.prototype=Object.create(Ge&&Ge.prototype)).constructor=i,i.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof Ne.window.HTMLCanvasElement?this.options.canvas:Ne.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new Ne.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},i.prototype.getCanvas=function(){return this.canvas},i.prototype.onAdd=function(Ne){this.map=Ne,this.load(),this.canvas&&this.animate&&this.play()},i.prototype.onRemove=function(){this.pause()},i.prototype.prepare=function(){var Ge=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,Ge=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,Ge=!0),!this._hasInvalidDimensions()&&0!==Object.keys(this.tiles).length){var Qe=this.map.painter.context,tt=Qe.gl;for(var rt in this.boundsBuffer||(this.boundsBuffer=Qe.createVertexBuffer(this._boundsArray,Ar.members)),this.boundsSegments||(this.boundsSegments=Ne.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(Ge||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Ne.Texture(Qe,this.canvas,tt.RGBA,{premultiply:!0}),this.tiles){var nt=this.tiles[rt];"loaded"!==nt.state&&(nt.state="loaded",nt.texture=this.texture)}}},i.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},i.prototype.hasTransition=function(){return this._playing},i.prototype._hasInvalidDimensions=function(){for(var Ne=0,Ge=[this.canvas.width,this.canvas.height];Ne<Ge.length;Ne+=1){var Qe=Ge[Ne];if(isNaN(Qe)||Qe<=0)return!0}return!1},i}(en),kn={vector:dr,raster:mr,"raster-dem":xr,geojson:br,video:mn,image:en,canvas:xn};function B(Ge,Qe){var tt=Ne.identity([]);return Ne.translate(tt,tt,[1,1,0]),Ne.scale(tt,tt,[.5*Ge.width,.5*Ge.height,1]),Ne.multiply(tt,tt,Ge.calculatePosMatrix(Qe.toUnwrapped()))}function O(Ne,Ge,Qe,tt,rt,nt){var at=function(Ne,Ge,Qe){if(Ne)for(var tt=0,rt=Ne;tt<rt.length;tt+=1){var nt=Ge[rt[tt]];if(nt&&nt.source===Qe&&"fill-extrusion"===nt.type)return!0}else for(var at in Ge){var it=Ge[at];if(it.source===Qe&&"fill-extrusion"===it.type)return!0}return!1}(rt&&rt.layers,Ge,Ne.id),it=nt.maxPitchScaleFactor(),ot=Ne.tilesIn(tt,it,at);ot.sort(F);for(var dt=[],ht=0,Dt=ot;ht<Dt.length;ht+=1){var Ot=Dt[ht];dt.push({wrappedTileID:Ot.tileID.wrapped().key,queryResults:Ot.tile.queryRenderedFeatures(Ge,Qe,Ne._state,Ot.queryGeometry,Ot.cameraQueryGeometry,Ot.scale,rt,nt,it,B(Ne.transform,Ot.tileID))})}var Rt=function(Ne){for(var Ge={},Qe={},tt=0,rt=Ne;tt<rt.length;tt+=1){var nt=rt[tt],at=nt.queryResults,it=nt.wrappedTileID,ot=Qe[it]=Qe[it]||{};for(var dt in at)for(var ht=at[dt],Dt=ot[dt]=ot[dt]||{},Ot=Ge[dt]=Ge[dt]||[],Rt=0,Zt=ht;Rt<Zt.length;Rt+=1){var er=Zt[Rt];Dt[er.featureIndex]||(Dt[er.featureIndex]=!0,Ot.push(er))}}return Ge}(dt);for(var Zt in Rt)Rt[Zt].forEach((function(Ge){var Qe=Ge.feature,tt=Ne.getFeatureState(Qe.layer["source-layer"],Qe.id);Qe.source=Qe.layer.source,Qe.layer["source-layer"]&&(Qe.sourceLayer=Qe.layer["source-layer"]),Qe.state=tt}));return Rt}function F(Ne,Ge){var Qe=Ne.tileID,tt=Ge.tileID;return Qe.overscaledZ-tt.overscaledZ||Qe.canonical.y-tt.canonical.y||Qe.wrap-tt.wrap||Qe.canonical.x-tt.canonical.x}var U=function(Ne,Ge){this.max=Ne,this.onRemove=Ge,this.reset()};U.prototype.reset=function(){for(var Ne in this.data)for(var Ge=0,Qe=this.data[Ne];Ge<Qe.length;Ge+=1){var tt=Qe[Ge];tt.timeout&&clearTimeout(tt.timeout),this.onRemove(tt.value)}return this.data={},this.order=[],this},U.prototype.add=function(Ne,Ge,Qe){var tt=this,rt=Ne.wrapped().key;void 0===this.data[rt]&&(this.data[rt]=[]);var nt={value:Ge,timeout:void 0};if(void 0!==Qe&&(nt.timeout=setTimeout((function(){tt.remove(Ne,nt)}),Qe)),this.data[rt].push(nt),this.order.push(rt),this.order.length>this.max){var at=this._getAndRemoveByKey(this.order[0]);at&&this.onRemove(at)}return this},U.prototype.has=function(Ne){return Ne.wrapped().key in this.data},U.prototype.getAndRemove=function(Ne){return this.has(Ne)?this._getAndRemoveByKey(Ne.wrapped().key):null},U.prototype._getAndRemoveByKey=function(Ne){var Ge=this.data[Ne].shift();return Ge.timeout&&clearTimeout(Ge.timeout),0===this.data[Ne].length&&delete this.data[Ne],this.order.splice(this.order.indexOf(Ne),1),Ge.value},U.prototype.getByKey=function(Ne){var Ge=this.data[Ne];return Ge?Ge[0].value:null},U.prototype.get=function(Ne){return this.has(Ne)?this.data[Ne.wrapped().key][0].value:null},U.prototype.remove=function(Ne,Ge){if(!this.has(Ne))return this;var Qe=Ne.wrapped().key,tt=void 0===Ge?0:this.data[Qe].indexOf(Ge),rt=this.data[Qe][tt];return this.data[Qe].splice(tt,1),rt.timeout&&clearTimeout(rt.timeout),0===this.data[Qe].length&&delete this.data[Qe],this.onRemove(rt.value),this.order.splice(this.order.indexOf(Qe),1),this},U.prototype.setMaxSize=function(Ne){for(this.max=Ne;this.order.length>this.max;){var Ge=this._getAndRemoveByKey(this.order[0]);Ge&&this.onRemove(Ge)}return this},U.prototype.filter=function(Ne){var Ge=[];for(var Qe in this.data)for(var tt=0,rt=this.data[Qe];tt<rt.length;tt+=1){var nt=rt[tt];Ne(nt.value)||Ge.push(nt)}for(var at=0,it=Ge;at<it.length;at+=1){var ot=it[at];this.remove(ot.value.tileID,ot)}};var N=function(Ne,Ge,Qe){this.context=Ne;var tt=Ne.gl;this.buffer=tt.createBuffer(),this.dynamicDraw=Boolean(Qe),this.context.unbindVAO(),Ne.bindElementBuffer.set(this.buffer),tt.bufferData(tt.ELEMENT_ARRAY_BUFFER,Ge.arrayBuffer,this.dynamicDraw?tt.DYNAMIC_DRAW:tt.STATIC_DRAW),this.dynamicDraw||delete Ge.arrayBuffer};N.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},N.prototype.updateData=function(Ne){var Ge=this.context.gl;this.context.unbindVAO(),this.bind(),Ge.bufferSubData(Ge.ELEMENT_ARRAY_BUFFER,0,Ne.arrayBuffer)},N.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Cn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},j=function(Ne,Ge,Qe,tt){this.length=Ge.length,this.attributes=Qe,this.itemSize=Ge.bytesPerElement,this.dynamicDraw=tt,this.context=Ne;var rt=Ne.gl;this.buffer=rt.createBuffer(),Ne.bindVertexBuffer.set(this.buffer),rt.bufferData(rt.ARRAY_BUFFER,Ge.arrayBuffer,this.dynamicDraw?rt.DYNAMIC_DRAW:rt.STATIC_DRAW),this.dynamicDraw||delete Ge.arrayBuffer};j.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},j.prototype.updateData=function(Ne){var Ge=this.context.gl;this.bind(),Ge.bufferSubData(Ge.ARRAY_BUFFER,0,Ne.arrayBuffer)},j.prototype.enableAttributes=function(Ne,Ge){for(var Qe=0;Qe<this.attributes.length;Qe++){var tt=Ge.attributes[this.attributes[Qe].name];void 0!==tt&&Ne.enableVertexAttribArray(tt)}},j.prototype.setVertexAttribPointers=function(Ne,Ge,Qe){for(var tt=0;tt<this.attributes.length;tt++){var rt=this.attributes[tt],nt=Ge.attributes[rt.name];void 0!==nt&&Ne.vertexAttribPointer(nt,rt.components,Ne[Cn[rt.type]],!1,this.itemSize,rt.offset+this.itemSize*(Qe||0))}},j.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var q=function(Ne){this.gl=Ne.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};q.prototype.get=function(){return this.current},q.prototype.set=function(Ne){},q.prototype.getDefault=function(){return this.default},q.prototype.setDefault=function(){this.set(this.default)};var En=function(Ge){function i(){Ge.apply(this,arguments)}return Ge&&(i.__proto__=Ge),(i.prototype=Object.create(Ge&&Ge.prototype)).constructor=i,i.prototype.getDefault=function(){return Ne.Color.transparent},i.prototype.set=function(Ne){var Ge=this.current;(Ne.r!==Ge.r||Ne.g!==Ge.g||Ne.b!==Ge.b||Ne.a!==Ge.a||this.dirty)&&(this.gl.clearColor(Ne.r,Ne.g,Ne.b,Ne.a),this.current=Ne,this.dirty=!1)},i}(q),Pn=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return 1},e.prototype.set=function(Ne){(Ne!==this.current||this.dirty)&&(this.gl.clearDepth(Ne),this.current=Ne,this.dirty=!1)},e}(q),Dn=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return 0},e.prototype.set=function(Ne){(Ne!==this.current||this.dirty)&&(this.gl.clearStencil(Ne),this.current=Ne,this.dirty=!1)},e}(q),In=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return[!0,!0,!0,!0]},e.prototype.set=function(Ne){var Ge=this.current;(Ne[0]!==Ge[0]||Ne[1]!==Ge[1]||Ne[2]!==Ge[2]||Ne[3]!==Ge[3]||this.dirty)&&(this.gl.colorMask(Ne[0],Ne[1],Ne[2],Ne[3]),this.current=Ne,this.dirty=!1)},e}(q),zn=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return!0},e.prototype.set=function(Ne){(Ne!==this.current||this.dirty)&&(this.gl.depthMask(Ne),this.current=Ne,this.dirty=!1)},e}(q),Bn=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return 255},e.prototype.set=function(Ne){(Ne!==this.current||this.dirty)&&(this.gl.stencilMask(Ne),this.current=Ne,this.dirty=!1)},e}(q),Vn=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},e.prototype.set=function(Ne){var Ge=this.current;(Ne.func!==Ge.func||Ne.ref!==Ge.ref||Ne.mask!==Ge.mask||this.dirty)&&(this.gl.stencilFunc(Ne.func,Ne.ref,Ne.mask),this.current=Ne,this.dirty=!1)},e}(q),Hn=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){var Ne=this.gl;return[Ne.KEEP,Ne.KEEP,Ne.KEEP]},e.prototype.set=function(Ne){var Ge=this.current;(Ne[0]!==Ge[0]||Ne[1]!==Ge[1]||Ne[2]!==Ge[2]||this.dirty)&&(this.gl.stencilOp(Ne[0],Ne[1],Ne[2]),this.current=Ne,this.dirty=!1)},e}(q),qn=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(Ne){if(Ne!==this.current||this.dirty){var Ge=this.gl;Ne?Ge.enable(Ge.STENCIL_TEST):Ge.disable(Ge.STENCIL_TEST),this.current=Ne,this.dirty=!1}},e}(q),Yn=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return[0,1]},e.prototype.set=function(Ne){var Ge=this.current;(Ne[0]!==Ge[0]||Ne[1]!==Ge[1]||this.dirty)&&(this.gl.depthRange(Ne[0],Ne[1]),this.current=Ne,this.dirty=!1)},e}(q),$n=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(Ne){if(Ne!==this.current||this.dirty){var Ge=this.gl;Ne?Ge.enable(Ge.DEPTH_TEST):Ge.disable(Ge.DEPTH_TEST),this.current=Ne,this.dirty=!1}},e}(q),ra=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.LESS},e.prototype.set=function(Ne){(Ne!==this.current||this.dirty)&&(this.gl.depthFunc(Ne),this.current=Ne,this.dirty=!1)},e}(q),oa=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(Ne){if(Ne!==this.current||this.dirty){var Ge=this.gl;Ne?Ge.enable(Ge.BLEND):Ge.disable(Ge.BLEND),this.current=Ne,this.dirty=!1}},e}(q),pa=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){var Ne=this.gl;return[Ne.ONE,Ne.ZERO]},e.prototype.set=function(Ne){var Ge=this.current;(Ne[0]!==Ge[0]||Ne[1]!==Ge[1]||this.dirty)&&(this.gl.blendFunc(Ne[0],Ne[1]),this.current=Ne,this.dirty=!1)},e}(q),ga=function(Ge){function i(){Ge.apply(this,arguments)}return Ge&&(i.__proto__=Ge),(i.prototype=Object.create(Ge&&Ge.prototype)).constructor=i,i.prototype.getDefault=function(){return Ne.Color.transparent},i.prototype.set=function(Ne){var Ge=this.current;(Ne.r!==Ge.r||Ne.g!==Ge.g||Ne.b!==Ge.b||Ne.a!==Ge.a||this.dirty)&&(this.gl.blendColor(Ne.r,Ne.g,Ne.b,Ne.a),this.current=Ne,this.dirty=!1)},i}(q),ma=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.FUNC_ADD},e.prototype.set=function(Ne){(Ne!==this.current||this.dirty)&&(this.gl.blendEquation(Ne),this.current=Ne,this.dirty=!1)},e}(q),_a=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(Ne){if(Ne!==this.current||this.dirty){var Ge=this.gl;Ne?Ge.enable(Ge.CULL_FACE):Ge.disable(Ge.CULL_FACE),this.current=Ne,this.dirty=!1}},e}(q),Va=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.BACK},e.prototype.set=function(Ne){(Ne!==this.current||this.dirty)&&(this.gl.cullFace(Ne),this.current=Ne,this.dirty=!1)},e}(q),Wa=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.CCW},e.prototype.set=function(Ne){(Ne!==this.current||this.dirty)&&(this.gl.frontFace(Ne),this.current=Ne,this.dirty=!1)},e}(q),Qa=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(Ne){(Ne!==this.current||this.dirty)&&(this.gl.useProgram(Ne),this.current=Ne,this.dirty=!1)},e}(q),ti=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return this.gl.TEXTURE0},e.prototype.set=function(Ne){(Ne!==this.current||this.dirty)&&(this.gl.activeTexture(Ne),this.current=Ne,this.dirty=!1)},e}(q),ni=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){var Ne=this.gl;return[0,0,Ne.drawingBufferWidth,Ne.drawingBufferHeight]},e.prototype.set=function(Ne){var Ge=this.current;(Ne[0]!==Ge[0]||Ne[1]!==Ge[1]||Ne[2]!==Ge[2]||Ne[3]!==Ge[3]||this.dirty)&&(this.gl.viewport(Ne[0],Ne[1],Ne[2],Ne[3]),this.current=Ne,this.dirty=!1)},e}(q),di=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(Ne){if(Ne!==this.current||this.dirty){var Ge=this.gl;Ge.bindFramebuffer(Ge.FRAMEBUFFER,Ne),this.current=Ne,this.dirty=!1}},e}(q),ji=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(Ne){if(Ne!==this.current||this.dirty){var Ge=this.gl;Ge.bindRenderbuffer(Ge.RENDERBUFFER,Ne),this.current=Ne,this.dirty=!1}},e}(q),Hi=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(Ne){if(Ne!==this.current||this.dirty){var Ge=this.gl;Ge.bindTexture(Ge.TEXTURE_2D,Ne),this.current=Ne,this.dirty=!1}},e}(q),Yi=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(Ne){if(Ne!==this.current||this.dirty){var Ge=this.gl;Ge.bindBuffer(Ge.ARRAY_BUFFER,Ne),this.current=Ne,this.dirty=!1}},e}(q),uo=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(Ne){var Ge=this.gl;Ge.bindBuffer(Ge.ELEMENT_ARRAY_BUFFER,Ne),this.current=Ne,this.dirty=!1},e}(q),go=function(Ne){function e(Ge){Ne.call(this,Ge),this.vao=Ge.extVertexArrayObject}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e.prototype.set=function(Ne){this.vao&&(Ne!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(Ne),this.current=Ne,this.dirty=!1)},e}(q),ns=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return 4},e.prototype.set=function(Ne){if(Ne!==this.current||this.dirty){var Ge=this.gl;Ge.pixelStorei(Ge.UNPACK_ALIGNMENT,Ne),this.current=Ne,this.dirty=!1}},e}(q),as=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(Ne){if(Ne!==this.current||this.dirty){var Ge=this.gl;Ge.pixelStorei(Ge.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Ne),this.current=Ne,this.dirty=!1}},e}(q),is=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return!1},e.prototype.set=function(Ne){if(Ne!==this.current||this.dirty){var Ge=this.gl;Ge.pixelStorei(Ge.UNPACK_FLIP_Y_WEBGL,Ne),this.current=Ne,this.dirty=!1}},e}(q),os=function(Ne){function e(Ge,Qe){Ne.call(this,Ge),this.context=Ge,this.parent=Qe}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.getDefault=function(){return null},e}(q),ss=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.setDirty=function(){this.dirty=!0},e.prototype.set=function(Ne){if(Ne!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var Ge=this.gl;Ge.framebufferTexture2D(Ge.FRAMEBUFFER,Ge.COLOR_ATTACHMENT0,Ge.TEXTURE_2D,Ne,0),this.current=Ne,this.dirty=!1}},e}(os),cs=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.set=function(Ne){if(Ne!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var Ge=this.gl;Ge.framebufferRenderbuffer(Ge.FRAMEBUFFER,Ge.DEPTH_ATTACHMENT,Ge.RENDERBUFFER,Ne),this.current=Ne,this.dirty=!1}},e}(os),Et=function(Ne,Ge,Qe,tt){this.context=Ne,this.width=Ge,this.height=Qe;var rt=this.framebuffer=Ne.gl.createFramebuffer();this.colorAttachment=new ss(Ne,rt),tt&&(this.depthAttachment=new cs(Ne,rt))};Et.prototype.destroy=function(){var Ne=this.context.gl,Ge=this.colorAttachment.get();if(Ge&&Ne.deleteTexture(Ge),this.depthAttachment){var Qe=this.depthAttachment.get();Qe&&Ne.deleteRenderbuffer(Qe)}Ne.deleteFramebuffer(this.framebuffer)};var It=function(Ne,Ge,Qe){this.func=Ne,this.mask=Ge,this.range=Qe};It.ReadOnly=!1,It.ReadWrite=!0,It.disabled=new It(519,It.ReadOnly,[0,1]);var Pt=function(Ne,Ge,Qe,tt,rt,nt){this.test=Ne,this.ref=Ge,this.mask=Qe,this.fail=tt,this.depthFail=rt,this.pass=nt};Pt.disabled=new Pt({func:519,mask:0},0,0,7680,7680,7680);var St=function(Ne,Ge,Qe){this.blendFunction=Ne,this.blendColor=Ge,this.mask=Qe};St.disabled=new St(St.Replace=[1,0],Ne.Color.transparent,[!1,!1,!1,!1]),St.unblended=new St(St.Replace,Ne.Color.transparent,[!0,!0,!0,!0]),St.alphaBlended=new St([1,771],Ne.Color.transparent,[!0,!0,!0,!0]);var Ct=function(Ne,Ge,Qe){this.enable=Ne,this.mode=Ge,this.frontFace=Qe};Ct.disabled=new Ct(!1,1029,2305),Ct.backCCW=new Ct(!0,1029,2305);var zt=function(Ne){this.gl=Ne,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new En(this),this.clearDepth=new Pn(this),this.clearStencil=new Dn(this),this.colorMask=new In(this),this.depthMask=new zn(this),this.stencilMask=new Bn(this),this.stencilFunc=new Vn(this),this.stencilOp=new Hn(this),this.stencilTest=new qn(this),this.depthRange=new Yn(this),this.depthTest=new $n(this),this.depthFunc=new ra(this),this.blend=new oa(this),this.blendFunc=new pa(this),this.blendColor=new ga(this),this.blendEquation=new ma(this),this.cullFace=new _a(this),this.cullFaceSide=new Va(this),this.frontFace=new Wa(this),this.program=new Qa(this),this.activeTexture=new ti(this),this.viewport=new ni(this),this.bindFramebuffer=new di(this),this.bindRenderbuffer=new ji(this),this.bindTexture=new Hi(this),this.bindVertexBuffer=new Yi(this),this.bindElementBuffer=new uo(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new go(this),this.pixelStoreUnpack=new ns(this),this.pixelStoreUnpackPremultiplyAlpha=new as(this),this.pixelStoreUnpackFlipY=new is(this),this.extTextureFilterAnisotropic=Ne.getExtension("EXT_texture_filter_anisotropic")||Ne.getExtension("MOZ_EXT_texture_filter_anisotropic")||Ne.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=Ne.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=Ne.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(Ne.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=Ne.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=Ne.getExtension("EXT_disjoint_timer_query")};zt.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},zt.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},zt.prototype.createIndexBuffer=function(Ne,Ge){return new N(this,Ne,Ge)},zt.prototype.createVertexBuffer=function(Ne,Ge,Qe){return new j(this,Ne,Ge,Qe)},zt.prototype.createRenderbuffer=function(Ne,Ge,Qe){var tt=this.gl,rt=tt.createRenderbuffer();return this.bindRenderbuffer.set(rt),tt.renderbufferStorage(tt.RENDERBUFFER,Ne,Ge,Qe),this.bindRenderbuffer.set(null),rt},zt.prototype.createFramebuffer=function(Ne,Ge,Qe){return new Et(this,Ne,Ge,Qe)},zt.prototype.clear=function(Ne){var Ge=Ne.color,Qe=Ne.depth,tt=this.gl,rt=0;Ge&&(rt|=tt.COLOR_BUFFER_BIT,this.clearColor.set(Ge),this.colorMask.set([!0,!0,!0,!0])),void 0!==Qe&&(rt|=tt.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(Qe),this.depthMask.set(!0)),tt.clear(rt)},zt.prototype.setCullFace=function(Ne){!1===Ne.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(Ne.mode),this.frontFace.set(Ne.frontFace))},zt.prototype.setDepthMode=function(Ne){Ne.func!==this.gl.ALWAYS||Ne.mask?(this.depthTest.set(!0),this.depthFunc.set(Ne.func),this.depthMask.set(Ne.mask),this.depthRange.set(Ne.range)):this.depthTest.set(!1)},zt.prototype.setStencilMode=function(Ne){Ne.test.func!==this.gl.ALWAYS||Ne.mask?(this.stencilTest.set(!0),this.stencilMask.set(Ne.mask),this.stencilOp.set([Ne.fail,Ne.depthFail,Ne.pass]),this.stencilFunc.set({func:Ne.test.func,ref:Ne.ref,mask:Ne.test.mask})):this.stencilTest.set(!1)},zt.prototype.setColorMode=function(Ge){Ne.deepEqual(Ge.blendFunction,St.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(Ge.blendFunction),this.blendColor.set(Ge.blendColor)),this.colorMask.set(Ge.mask)},zt.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var ds=function(Ge){function i(Qe,tt,rt){var nt=this;Ge.call(this),this.id=Qe,this.dispatcher=rt,this.on("data",(function(Ne){"source"===Ne.dataType&&"metadata"===Ne.sourceDataType&&(nt._sourceLoaded=!0),nt._sourceLoaded&&!nt._paused&&"source"===Ne.dataType&&"content"===Ne.sourceDataType&&(nt.reload(),nt.transform&&nt.update(nt.transform))})),this.on("error",(function(){nt._sourceErrored=!0})),this._source=function(Ge,Qe,tt,rt){var nt=new kn[Qe.type](Ge,Qe,tt,rt);if(nt.id!==Ge)throw new Error("Expected Source id to be "+Ge+" instead of "+nt.id);return Ne.bindAll(["load","abort","unload","serialize","prepare"],nt),nt}(Qe,tt,rt,this),this._tiles={},this._cache=new U(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new Ne.SourceFeatureState}return Ge&&(i.__proto__=Ge),(i.prototype=Object.create(Ge&&Ge.prototype)).constructor=i,i.prototype.onAdd=function(Ne){this.map=Ne,this._maxTileCacheSize=Ne?Ne._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(Ne)},i.prototype.onRemove=function(Ne){this._source&&this._source.onRemove&&this._source.onRemove(Ne)},i.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(var Ne in this._tiles){var Ge=this._tiles[Ne];if("loaded"!==Ge.state&&"errored"!==Ge.state)return!1}return!0},i.prototype.getSource=function(){return this._source},i.prototype.pause=function(){this._paused=!0},i.prototype.resume=function(){if(this._paused){var Ne=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,Ne&&this.reload(),this.transform&&this.update(this.transform)}},i.prototype._loadTile=function(Ne,Ge){return this._source.loadTile(Ne,Ge)},i.prototype._unloadTile=function(Ne){if(this._source.unloadTile)return this._source.unloadTile(Ne,(function(){}))},i.prototype._abortTile=function(Ne){if(this._source.abortTile)return this._source.abortTile(Ne,(function(){}))},i.prototype.serialize=function(){return this._source.serialize()},i.prototype.prepare=function(Ne){for(var Ge in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var Qe=this._tiles[Ge];Qe.upload(Ne),Qe.prepare(this.map.style.imageManager)}},i.prototype.getIds=function(){return Ne.values(this._tiles).map((function(Ne){return Ne.tileID})).sort(Mt).map((function(Ne){return Ne.key}))},i.prototype.getRenderableIds=function(Ge){var Qe=this,tt=[];for(var rt in this._tiles)this._isIdRenderable(rt,Ge)&&tt.push(this._tiles[rt]);return Ge?tt.sort((function(Ge,tt){var rt=Ge.tileID,nt=tt.tileID,at=new Ne.Point(rt.canonical.x,rt.canonical.y)._rotate(Qe.transform.angle),it=new Ne.Point(nt.canonical.x,nt.canonical.y)._rotate(Qe.transform.angle);return rt.overscaledZ-nt.overscaledZ||it.y-at.y||it.x-at.x})).map((function(Ne){return Ne.tileID.key})):tt.map((function(Ne){return Ne.tileID})).sort(Mt).map((function(Ne){return Ne.key}))},i.prototype.hasRenderableParent=function(Ne){var Ge=this.findLoadedParent(Ne,0);return!!Ge&&this._isIdRenderable(Ge.tileID.key)},i.prototype._isIdRenderable=function(Ne,Ge){return this._tiles[Ne]&&this._tiles[Ne].hasData()&&!this._coveredTiles[Ne]&&(Ge||!this._tiles[Ne].holdingForFade())},i.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else for(var Ne in this._cache.reset(),this._tiles)"errored"!==this._tiles[Ne].state&&this._reloadTile(Ne,"reloading")},i.prototype._reloadTile=function(Ne,Ge){var Qe=this._tiles[Ne];Qe&&("loading"!==Qe.state&&(Qe.state=Ge),this._loadTile(Qe,this._tileLoaded.bind(this,Qe,Ne,Ge)))},i.prototype._tileLoaded=function(Ge,Qe,tt,rt){if(rt)return Ge.state="errored",void(404!==rt.status?this._source.fire(new Ne.ErrorEvent(rt,{tile:Ge})):this.update(this.transform));Ge.timeAdded=Ne.browser.now(),"expired"===tt&&(Ge.refreshedUponExpiration=!0),this._setTileReloadTimer(Qe,Ge),"raster-dem"===this.getSource().type&&Ge.dem&&this._backfillDEM(Ge),this._state.initializeTileState(Ge,this.map?this.map.painter:null),this._source.fire(new Ne.Event("data",{dataType:"source",tile:Ge,coord:Ge.tileID}))},i.prototype._backfillDEM=function(Ne){for(var Ge=this.getRenderableIds(),Qe=0;Qe<Ge.length;Qe++){var tt=Ge[Qe];if(Ne.neighboringTiles&&Ne.neighboringTiles[tt]){var rt=this.getTileByID(tt);a(Ne,rt),a(rt,Ne)}}function a(Ne,Ge){Ne.needsHillshadePrepare=!0;var Qe=Ge.tileID.canonical.x-Ne.tileID.canonical.x,tt=Ge.tileID.canonical.y-Ne.tileID.canonical.y,rt=Math.pow(2,Ne.tileID.canonical.z),nt=Ge.tileID.key;0===Qe&&0===tt||Math.abs(tt)>1||(Math.abs(Qe)>1&&(1===Math.abs(Qe+rt)?Qe+=rt:1===Math.abs(Qe-rt)&&(Qe-=rt)),Ge.dem&&Ne.dem&&(Ne.dem.backfillBorder(Ge.dem,Qe,tt),Ne.neighboringTiles&&Ne.neighboringTiles[nt]&&(Ne.neighboringTiles[nt].backfilled=!0)))}},i.prototype.getTile=function(Ne){return this.getTileByID(Ne.key)},i.prototype.getTileByID=function(Ne){return this._tiles[Ne]},i.prototype._retainLoadedChildren=function(Ne,Ge,Qe,tt){for(var rt in this._tiles){var nt=this._tiles[rt];if(!(tt[rt]||!nt.hasData()||nt.tileID.overscaledZ<=Ge||nt.tileID.overscaledZ>Qe)){for(var at=nt.tileID;nt&&nt.tileID.overscaledZ>Ge+1;){var it=nt.tileID.scaledTo(nt.tileID.overscaledZ-1);(nt=this._tiles[it.key])&&nt.hasData()&&(at=it)}for(var ot=at;ot.overscaledZ>Ge;)if(Ne[(ot=ot.scaledTo(ot.overscaledZ-1)).key]){tt[at.key]=at;break}}}},i.prototype.findLoadedParent=function(Ne,Ge){if(Ne.key in this._loadedParentTiles){var Qe=this._loadedParentTiles[Ne.key];return Qe&&Qe.tileID.overscaledZ>=Ge?Qe:null}for(var tt=Ne.overscaledZ-1;tt>=Ge;tt--){var rt=Ne.scaledTo(tt),nt=this._getLoadedTile(rt);if(nt)return nt}},i.prototype._getLoadedTile=function(Ne){var Ge=this._tiles[Ne.key];return Ge&&Ge.hasData()?Ge:this._cache.getByKey(Ne.wrapped().key)},i.prototype.updateCacheSize=function(Ne){var Ge=Math.ceil(Ne.width/this._source.tileSize)+1,Qe=Math.ceil(Ne.height/this._source.tileSize)+1,tt=Math.floor(Ge*Qe*5),rt="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,tt):tt;this._cache.setMaxSize(rt)},i.prototype.handleWrapJump=function(Ne){var Ge=Math.round((Ne-(void 0===this._prevLng?Ne:this._prevLng))/360);if(this._prevLng=Ne,Ge){var Qe={};for(var tt in this._tiles){var rt=this._tiles[tt];rt.tileID=rt.tileID.unwrapTo(rt.tileID.wrap+Ge),Qe[rt.tileID.key]=rt}for(var nt in this._tiles=Qe,this._timers)clearTimeout(this._timers[nt]),delete this._timers[nt];for(var at in this._tiles)this._setTileReloadTimer(at,this._tiles[at])}},i.prototype.update=function(Ge){var Qe=this;if(this.transform=Ge,this._sourceLoaded&&!this._paused){var tt;this.updateCacheSize(Ge),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?tt=Ge.getVisibleUnwrappedCoordinates(this._source.tileID).map((function(Ge){return new Ne.OverscaledTileID(Ge.canonical.z,Ge.wrap,Ge.canonical.z,Ge.canonical.x,Ge.canonical.y)})):(tt=Ge.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(tt=tt.filter((function(Ne){return Qe._source.hasTile(Ne)})))):tt=[];var rt=Ge.coveringZoomLevel(this._source),nt=Math.max(rt-i.maxOverzooming,this._source.minzoom),at=Math.max(rt+i.maxUnderzooming,this._source.minzoom),it=this._updateRetainedTiles(tt,rt);if(Lt(this._source.type)){for(var ot={},dt={},ht=0,Dt=Object.keys(it);ht<Dt.length;ht+=1){var Ot=Dt[ht],Rt=it[Ot],Zt=this._tiles[Ot];if(Zt&&!(Zt.fadeEndTime&&Zt.fadeEndTime<=Ne.browser.now())){var er=this.findLoadedParent(Rt,nt);er&&(this._addTile(er.tileID),ot[er.tileID.key]=er.tileID),dt[Ot]=Rt}}for(var dr in this._retainLoadedChildren(dt,rt,at,it),ot)it[dr]||(this._coveredTiles[dr]=!0,it[dr]=ot[dr])}for(var mr in it)this._tiles[mr].clearFadeHold();for(var xr=0,br=Ne.keysDifference(this._tiles,it);xr<br.length;xr+=1){var Ar=br[xr],en=this._tiles[Ar];en.hasSymbolBuckets&&!en.holdingForFade()?en.setHoldDuration(this.map._fadeDuration):en.hasSymbolBuckets&&!en.symbolFadeFinished()||this._removeTile(Ar)}this._updateLoadedParentTileCache()}},i.prototype.releaseSymbolFadeTiles=function(){for(var Ne in this._tiles)this._tiles[Ne].holdingForFade()&&this._removeTile(Ne)},i.prototype._updateRetainedTiles=function(Ne,Ge){for(var Qe={},tt={},rt=Math.max(Ge-i.maxOverzooming,this._source.minzoom),nt=Math.max(Ge+i.maxUnderzooming,this._source.minzoom),at={},it=0,ot=Ne;it<ot.length;it+=1){var dt=ot[it],ht=this._addTile(dt);Qe[dt.key]=dt,ht.hasData()||Ge<this._source.maxzoom&&(at[dt.key]=dt)}this._retainLoadedChildren(at,Ge,nt,Qe);for(var Dt=0,Ot=Ne;Dt<Ot.length;Dt+=1){var Rt=Ot[Dt],Zt=this._tiles[Rt.key];if(!Zt.hasData()){if(Ge+1>this._source.maxzoom){var er=Rt.children(this._source.maxzoom)[0],dr=this.getTile(er);if(dr&&dr.hasData()){Qe[er.key]=er;continue}}else{var mr=Rt.children(this._source.maxzoom);if(Qe[mr[0].key]&&Qe[mr[1].key]&&Qe[mr[2].key]&&Qe[mr[3].key])continue}for(var xr=Zt.wasRequested(),br=Rt.overscaledZ-1;br>=rt;--br){var Ar=Rt.scaledTo(br);if(tt[Ar.key])break;if(tt[Ar.key]=!0,!(Zt=this.getTile(Ar))&&xr&&(Zt=this._addTile(Ar)),Zt&&(Qe[Ar.key]=Ar,xr=Zt.wasRequested(),Zt.hasData()))break}}}return Qe},i.prototype._updateLoadedParentTileCache=function(){for(var Ne in this._loadedParentTiles={},this._tiles){for(var Ge=[],Qe=void 0,tt=this._tiles[Ne].tileID;tt.overscaledZ>0;){if(tt.key in this._loadedParentTiles){Qe=this._loadedParentTiles[tt.key];break}Ge.push(tt.key);var rt=tt.scaledTo(tt.overscaledZ-1);if(Qe=this._getLoadedTile(rt))break;tt=rt}for(var nt=0,at=Ge;nt<at.length;nt+=1)this._loadedParentTiles[at[nt]]=Qe}},i.prototype._addTile=function(Ge){var Qe=this._tiles[Ge.key];if(Qe)return Qe;(Qe=this._cache.getAndRemove(Ge))&&(this._setTileReloadTimer(Ge.key,Qe),Qe.tileID=Ge,this._state.initializeTileState(Qe,this.map?this.map.painter:null),this._cacheTimers[Ge.key]&&(clearTimeout(this._cacheTimers[Ge.key]),delete this._cacheTimers[Ge.key],this._setTileReloadTimer(Ge.key,Qe)));var tt=Boolean(Qe);return tt||(Qe=new Ne.Tile(Ge,this._source.tileSize*Ge.overscaleFactor()),this._loadTile(Qe,this._tileLoaded.bind(this,Qe,Ge.key,Qe.state))),Qe?(Qe.uses++,this._tiles[Ge.key]=Qe,tt||this._source.fire(new Ne.Event("dataloading",{tile:Qe,coord:Qe.tileID,dataType:"source"})),Qe):null},i.prototype._setTileReloadTimer=function(Ne,Ge){var Qe=this;Ne in this._timers&&(clearTimeout(this._timers[Ne]),delete this._timers[Ne]);var tt=Ge.getExpiryTimeout();tt&&(this._timers[Ne]=setTimeout((function(){Qe._reloadTile(Ne,"expired"),delete Qe._timers[Ne]}),tt))},i.prototype._removeTile=function(Ne){var Ge=this._tiles[Ne];Ge&&(Ge.uses--,delete this._tiles[Ne],this._timers[Ne]&&(clearTimeout(this._timers[Ne]),delete this._timers[Ne]),Ge.uses>0||(Ge.hasData()&&"reloading"!==Ge.state?this._cache.add(Ge.tileID,Ge,Ge.getExpiryTimeout()):(Ge.aborted=!0,this._abortTile(Ge),this._unloadTile(Ge))))},i.prototype.clearTiles=function(){for(var Ne in this._shouldReloadOnResume=!1,this._paused=!1,this._tiles)this._removeTile(Ne);this._cache.reset()},i.prototype.tilesIn=function(Ge,Qe,tt){var rt=this,nt=[],at=this.transform;if(!at)return nt;for(var it=tt?at.getCameraQueryGeometry(Ge):Ge,ot=Ge.map((function(Ne){return at.pointCoordinate(Ne)})),dt=it.map((function(Ne){return at.pointCoordinate(Ne)})),ht=this.getIds(),Dt=1/0,Ot=1/0,Rt=-1/0,Zt=-1/0,er=0,dr=dt;er<dr.length;er+=1){var mr=dr[er];Dt=Math.min(Dt,mr.x),Ot=Math.min(Ot,mr.y),Rt=Math.max(Rt,mr.x),Zt=Math.max(Zt,mr.y)}for(var v=function(Ge){var tt=rt._tiles[ht[Ge]];if(!tt.holdingForFade()){var it=tt.tileID,er=Math.pow(2,at.zoom-tt.tileID.overscaledZ),dr=Qe*tt.queryPadding*Ne.EXTENT/tt.tileSize/er,mr=[it.getTilePoint(new Ne.MercatorCoordinate(Dt,Ot)),it.getTilePoint(new Ne.MercatorCoordinate(Rt,Zt))];if(mr[0].x-dr<Ne.EXTENT&&mr[0].y-dr<Ne.EXTENT&&mr[1].x+dr>=0&&mr[1].y+dr>=0){var xr=ot.map((function(Ne){return it.getTilePoint(Ne)})),br=dt.map((function(Ne){return it.getTilePoint(Ne)}));nt.push({tile:tt,tileID:it,queryGeometry:xr,cameraQueryGeometry:br,scale:er})}}},xr=0;xr<ht.length;xr++)v(xr);return nt},i.prototype.getVisibleCoordinates=function(Ne){for(var Ge=this,Qe=this.getRenderableIds(Ne).map((function(Ne){return Ge._tiles[Ne].tileID})),tt=0,rt=Qe;tt<rt.length;tt+=1){var nt=rt[tt];nt.posMatrix=this.transform.calculatePosMatrix(nt.toUnwrapped())}return Qe},i.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(Lt(this._source.type))for(var Ge in this._tiles){var Qe=this._tiles[Ge];if(void 0!==Qe.fadeEndTime&&Qe.fadeEndTime>=Ne.browser.now())return!0}return!1},i.prototype.setFeatureState=function(Ne,Ge,Qe){this._state.updateState(Ne=Ne||"_geojsonTileLayer",Ge,Qe)},i.prototype.removeFeatureState=function(Ne,Ge,Qe){this._state.removeFeatureState(Ne=Ne||"_geojsonTileLayer",Ge,Qe)},i.prototype.getFeatureState=function(Ne,Ge){return this._state.getState(Ne=Ne||"_geojsonTileLayer",Ge)},i.prototype.setDependencies=function(Ne,Ge,Qe){var tt=this._tiles[Ne];tt&&tt.setDependencies(Ge,Qe)},i.prototype.reloadTilesForDependencies=function(Ne,Ge){for(var Qe in this._tiles)this._tiles[Qe].hasDependency(Ne,Ge)&&this._reloadTile(Qe,"reloading");this._cache.filter((function(Qe){return!Qe.hasDependency(Ne,Ge)}))},i}(Ne.Evented);function Mt(Ne,Ge){var Qe=Math.abs(2*Ne.wrap)-+(Ne.wrap<0),tt=Math.abs(2*Ge.wrap)-+(Ge.wrap<0);return Ne.overscaledZ-Ge.overscaledZ||tt-Qe||Ge.canonical.y-Ne.canonical.y||Ge.canonical.x-Ne.canonical.x}function Lt(Ne){return"raster"===Ne||"image"===Ne||"video"===Ne}function At(){return new Ne.window.Worker($c.workerUrl)}ds.maxOverzooming=10,ds.maxUnderzooming=3;var ms="mapboxgl_preloaded_worker_pool",kt=function(){this.active={}};kt.prototype.acquire=function(Ne){if(!this.workers)for(this.workers=[];this.workers.length<kt.workerCount;)this.workers.push(new At);return this.active[Ne]=!0,this.workers.slice()},kt.prototype.release=function(Ne){delete this.active[Ne],0===this.numActive()&&(this.workers.forEach((function(Ne){Ne.terminate()})),this.workers=null)},kt.prototype.isPreloaded=function(){return!!this.active[ms]},kt.prototype.numActive=function(){return Object.keys(this.active).length};var vs,_s=Math.floor(Ne.browser.hardwareConcurrency/2);function Ft(){return vs||(vs=new kt),vs}function Ut(Ge,Qe){var tt={};for(var rt in Ge)"ref"!==rt&&(tt[rt]=Ge[rt]);return Ne.refProperties.forEach((function(Ne){Ne in Qe&&(tt[Ne]=Qe[Ne])})),tt}function Nt(Ne){Ne=Ne.slice();for(var Ge=Object.create(null),Qe=0;Qe<Ne.length;Qe++)Ge[Ne[Qe].id]=Ne[Qe];for(var tt=0;tt<Ne.length;tt++)"ref"in Ne[tt]&&(Ne[tt]=Ut(Ne[tt],Ge[Ne[tt].ref]));return Ne}kt.workerCount=Math.max(Math.min(_s,6),1);var ws={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function jt(Ne,Ge,Qe){Qe.push({command:ws.addSource,args:[Ne,Ge[Ne]]})}function qt(Ne,Ge,Qe){Ge.push({command:ws.removeSource,args:[Ne]}),Qe[Ne]=!0}function Vt(Ne,Ge,Qe,tt){qt(Ne,Qe,tt),jt(Ne,Ge,Qe)}function Gt(Ge,Qe,tt){var rt;for(rt in Ge[tt])if(Ge[tt].hasOwnProperty(rt)&&"data"!==rt&&!Ne.deepEqual(Ge[tt][rt],Qe[tt][rt]))return!1;for(rt in Qe[tt])if(Qe[tt].hasOwnProperty(rt)&&"data"!==rt&&!Ne.deepEqual(Ge[tt][rt],Qe[tt][rt]))return!1;return!0}function Wt(Ge,Qe,tt,rt,nt,at){var it;for(it in Qe=Qe||{},Ge=Ge||{})Ge.hasOwnProperty(it)&&(Ne.deepEqual(Ge[it],Qe[it])||tt.push({command:at,args:[rt,it,Qe[it],nt]}));for(it in Qe)Qe.hasOwnProperty(it)&&!Ge.hasOwnProperty(it)&&(Ne.deepEqual(Ge[it],Qe[it])||tt.push({command:at,args:[rt,it,Qe[it],nt]}))}function Xt(Ne){return Ne.id}function Ht(Ne,Ge){return Ne[Ge.id]=Ge,Ne}var Kt=function(Ne,Ge){this.reset(Ne,Ge)};Kt.prototype.reset=function(Ne,Ge){this.points=Ne||[],this._distances=[0];for(var Qe=1;Qe<this.points.length;Qe++)this._distances[Qe]=this._distances[Qe-1]+this.points[Qe].dist(this.points[Qe-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(Ge||0,.5*this.length),this.paddedLength=this.length-2*this.padding},Kt.prototype.lerp=function(Ge){if(1===this.points.length)return this.points[0];Ge=Ne.clamp(Ge,0,1);for(var Qe=1,tt=this._distances[Qe],rt=Ge*this.paddedLength+this.padding;tt<rt&&Qe<this._distances.length;)tt=this._distances[++Qe];var nt=Qe-1,at=this._distances[nt],it=tt-at,ot=it>0?(rt-at)/it:0;return this.points[nt].mult(1-ot).add(this.points[Qe].mult(ot))};var Yt=function(Ne,Ge,Qe){var tt=this.boxCells=[],rt=this.circleCells=[];this.xCellCount=Math.ceil(Ne/Qe),this.yCellCount=Math.ceil(Ge/Qe);for(var nt=0;nt<this.xCellCount*this.yCellCount;nt++)tt.push([]),rt.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=Ne,this.height=Ge,this.xScale=this.xCellCount/Ne,this.yScale=this.yCellCount/Ge,this.boxUid=0,this.circleUid=0};function Jt(Ge,Qe,tt,rt,nt){var at=Ne.create();return Qe?(Ne.scale(at,at,[1/nt,1/nt,1]),tt||Ne.rotateZ(at,at,rt.angle)):Ne.multiply(at,rt.labelPlaneMatrix,Ge),at}function Qt(Ge,Qe,tt,rt,nt){if(Qe){var at=Ne.clone(Ge);return Ne.scale(at,at,[nt,nt,1]),tt||Ne.rotateZ(at,at,-rt.angle),at}return rt.glCoordMatrix}function $t(Ge,Qe){var tt=[Ge.x,Ge.y,0,1];ue(tt,tt,Qe);var rt=tt[3];return{point:new Ne.Point(tt[0]/rt,tt[1]/rt),signedDistanceFromCamera:rt}}function te(Ne,Ge){return.5+Ne/Ge*.5}function ee(Ne,Ge){var Qe=Ne[0]/Ne[3],tt=Ne[1]/Ne[3];return Qe>=-Ge[0]&&Qe<=Ge[0]&&tt>=-Ge[1]&&tt<=Ge[1]}function ie(Ge,Qe,tt,rt,nt,at,it,ot){var dt=rt?Ge.textSizeData:Ge.iconSizeData,ht=Ne.evaluateSizeForZoom(dt,tt.transform.zoom),Dt=[256/tt.width*2+1,256/tt.height*2+1],Ot=rt?Ge.text.dynamicLayoutVertexArray:Ge.icon.dynamicLayoutVertexArray;Ot.clear();for(var Rt=Ge.lineVertexArray,Zt=rt?Ge.text.placedSymbolArray:Ge.icon.placedSymbolArray,er=tt.transform.width/tt.transform.height,dr=!1,mr=0;mr<Zt.length;mr++){var xr=Zt.get(mr);if(xr.hidden||xr.writingMode===Ne.WritingMode.vertical&&!dr)ce(xr.numGlyphs,Ot);else{dr=!1;var br=[xr.anchorX,xr.anchorY,0,1];if(Ne.transformMat4(br,br,Qe),ee(br,Dt)){var Ar=te(tt.transform.cameraToCenterDistance,br[3]),en=Ne.evaluateSizeForFeature(dt,ht,xr),mn=it?en/Ar:en*Ar,xn=new Ne.Point(xr.anchorX,xr.anchorY),kn=$t(xn,nt).point,Cn={},En=ae(xr,mn,!1,ot,Qe,nt,at,Ge.glyphOffsetArray,Rt,Ot,kn,xn,Cn,er);dr=En.useVertical,(En.notEnoughRoom||dr||En.needsFlipping&&ae(xr,mn,!0,ot,Qe,nt,at,Ge.glyphOffsetArray,Rt,Ot,kn,xn,Cn,er).notEnoughRoom)&&ce(xr.numGlyphs,Ot)}else ce(xr.numGlyphs,Ot)}}rt?Ge.text.dynamicLayoutVertexBuffer.updateData(Ot):Ge.icon.dynamicLayoutVertexBuffer.updateData(Ot)}function oe(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht){var Dt=it.glyphStartIndex+it.numGlyphs,Ot=it.lineStartIndex,Rt=it.lineStartIndex+it.lineLength,Zt=Ge.getoffsetX(it.glyphStartIndex),er=Ge.getoffsetX(Dt-1),dr=se(Ne*Zt,Qe,tt,rt,nt,at,it.segment,Ot,Rt,ot,dt,ht);if(!dr)return null;var mr=se(Ne*er,Qe,tt,rt,nt,at,it.segment,Ot,Rt,ot,dt,ht);return mr?{first:dr,last:mr}:null}function re(Ge,Qe,tt,rt){return Ge===Ne.WritingMode.horizontal&&Math.abs(tt.y-Qe.y)>Math.abs(tt.x-Qe.x)*rt?{useVertical:!0}:(Ge===Ne.WritingMode.vertical?Qe.y<tt.y:Qe.x>tt.x)?{needsFlipping:!0}:null}function ae(Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt){var er,dr=Qe/24,mr=Ge.lineOffsetX*dr,xr=Ge.lineOffsetY*dr;if(Ge.numGlyphs>1){var br=Ge.glyphStartIndex+Ge.numGlyphs,Ar=Ge.lineStartIndex,en=Ge.lineStartIndex+Ge.lineLength,mn=oe(dr,ot,mr,xr,tt,Dt,Ot,Ge,dt,at,Rt);if(!mn)return{notEnoughRoom:!0};var xn=$t(mn.first.point,it).point,kn=$t(mn.last.point,it).point;if(rt&&!tt){var Cn=re(Ge.writingMode,xn,kn,Zt);if(Cn)return Cn}er=[mn.first];for(var En=Ge.glyphStartIndex+1;En<br-1;En++)er.push(se(dr*ot.getoffsetX(En),mr,xr,tt,Dt,Ot,Ge.segment,Ar,en,dt,at,Rt));er.push(mn.last)}else{if(rt&&!tt){var Pn=$t(Ot,nt).point,Dn=Ge.lineStartIndex+Ge.segment+1,In=new Ne.Point(dt.getx(Dn),dt.gety(Dn)),zn=$t(In,nt),Bn=zn.signedDistanceFromCamera>0?zn.point:ne(Ot,In,Pn,1,nt),Vn=re(Ge.writingMode,Pn,Bn,Zt);if(Vn)return Vn}var Hn=se(dr*ot.getoffsetX(Ge.glyphStartIndex),mr,xr,tt,Dt,Ot,Ge.segment,Ge.lineStartIndex,Ge.lineStartIndex+Ge.lineLength,dt,at,Rt);if(!Hn)return{notEnoughRoom:!0};er=[Hn]}for(var qn=0,Yn=er;qn<Yn.length;qn+=1){var $n=Yn[qn];Ne.addDynamicAttributes(ht,$n.point,$n.angle)}return{}}function ne(Ne,Ge,Qe,tt,rt){var nt=$t(Ne.add(Ne.sub(Ge)._unit()),rt).point,at=Qe.sub(nt);return Qe.add(at._mult(tt/at.mag()))}function se(Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt,Ot){var Rt=rt?Ge-Qe:Ge+Qe,Zt=Rt>0?1:-1,er=0;rt&&(Zt*=-1,er=Math.PI),Zt<0&&(er+=Math.PI);for(var dr=Zt>0?ot+it:ot+it+1,mr=nt,xr=nt,br=0,Ar=0,en=Math.abs(Rt),mn=[];br+Ar<=en;){if((dr+=Zt)<ot||dr>=dt)return null;if(xr=mr,mn.push(mr),void 0===(mr=Ot[dr])){var xn=new Ne.Point(ht.getx(dr),ht.gety(dr)),kn=$t(xn,Dt);if(kn.signedDistanceFromCamera>0)mr=Ot[dr]=kn.point;else{var Cn=dr-Zt;mr=ne(0===br?at:new Ne.Point(ht.getx(Cn),ht.gety(Cn)),xn,xr,en-br+1,Dt)}}br+=Ar,Ar=xr.dist(mr)}var En=(en-br)/Ar,Pn=mr.sub(xr),Dn=Pn.mult(En)._add(xr);Dn._add(Pn._unit()._perp()._mult(tt*Zt));var In=er+Math.atan2(mr.y-xr.y,mr.x-xr.x);return mn.push(Dn),{point:Dn,angle:In,path:mn}}Yt.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},Yt.prototype.insert=function(Ne,Ge,Qe,tt,rt){this._forEachCell(Ge,Qe,tt,rt,this._insertBoxCell,this.boxUid++),this.boxKeys.push(Ne),this.bboxes.push(Ge),this.bboxes.push(Qe),this.bboxes.push(tt),this.bboxes.push(rt)},Yt.prototype.insertCircle=function(Ne,Ge,Qe,tt){this._forEachCell(Ge-tt,Qe-tt,Ge+tt,Qe+tt,this._insertCircleCell,this.circleUid++),this.circleKeys.push(Ne),this.circles.push(Ge),this.circles.push(Qe),this.circles.push(tt)},Yt.prototype._insertBoxCell=function(Ne,Ge,Qe,tt,rt,nt){this.boxCells[rt].push(nt)},Yt.prototype._insertCircleCell=function(Ne,Ge,Qe,tt,rt,nt){this.circleCells[rt].push(nt)},Yt.prototype._query=function(Ne,Ge,Qe,tt,rt,nt){if(Qe<0||Ne>this.width||tt<0||Ge>this.height)return!rt&&[];var at=[];if(Ne<=0&&Ge<=0&&this.width<=Qe&&this.height<=tt){if(rt)return!0;for(var it=0;it<this.boxKeys.length;it++)at.push({key:this.boxKeys[it],x1:this.bboxes[4*it],y1:this.bboxes[4*it+1],x2:this.bboxes[4*it+2],y2:this.bboxes[4*it+3]});for(var ot=0;ot<this.circleKeys.length;ot++){var dt=this.circles[3*ot],ht=this.circles[3*ot+1],Dt=this.circles[3*ot+2];at.push({key:this.circleKeys[ot],x1:dt-Dt,y1:ht-Dt,x2:dt+Dt,y2:ht+Dt})}return nt?at.filter(nt):at}return this._forEachCell(Ne,Ge,Qe,tt,this._queryCell,at,{hitTest:rt,seenUids:{box:{},circle:{}}},nt),rt?at.length>0:at},Yt.prototype._queryCircle=function(Ne,Ge,Qe,tt,rt){var nt=Ne-Qe,at=Ne+Qe,it=Ge-Qe,ot=Ge+Qe;if(at<0||nt>this.width||ot<0||it>this.height)return!tt&&[];var dt=[];return this._forEachCell(nt,it,at,ot,this._queryCellCircle,dt,{hitTest:tt,circle:{x:Ne,y:Ge,radius:Qe},seenUids:{box:{},circle:{}}},rt),tt?dt.length>0:dt},Yt.prototype.query=function(Ne,Ge,Qe,tt,rt){return this._query(Ne,Ge,Qe,tt,!1,rt)},Yt.prototype.hitTest=function(Ne,Ge,Qe,tt,rt){return this._query(Ne,Ge,Qe,tt,!0,rt)},Yt.prototype.hitTestCircle=function(Ne,Ge,Qe,tt){return this._queryCircle(Ne,Ge,Qe,!0,tt)},Yt.prototype._queryCell=function(Ne,Ge,Qe,tt,rt,nt,at,it){var ot=at.seenUids,dt=this.boxCells[rt];if(null!==dt)for(var ht=this.bboxes,Dt=0,Ot=dt;Dt<Ot.length;Dt+=1){var Rt=Ot[Dt];if(!ot.box[Rt]){ot.box[Rt]=!0;var Zt=4*Rt;if(Ne<=ht[Zt+2]&&Ge<=ht[Zt+3]&&Qe>=ht[Zt+0]&&tt>=ht[Zt+1]&&(!it||it(this.boxKeys[Rt]))){if(at.hitTest)return nt.push(!0),!0;nt.push({key:this.boxKeys[Rt],x1:ht[Zt],y1:ht[Zt+1],x2:ht[Zt+2],y2:ht[Zt+3]})}}}var er=this.circleCells[rt];if(null!==er)for(var dr=this.circles,mr=0,xr=er;mr<xr.length;mr+=1){var br=xr[mr];if(!ot.circle[br]){ot.circle[br]=!0;var Ar=3*br;if(this._circleAndRectCollide(dr[Ar],dr[Ar+1],dr[Ar+2],Ne,Ge,Qe,tt)&&(!it||it(this.circleKeys[br]))){if(at.hitTest)return nt.push(!0),!0;var en=dr[Ar],mn=dr[Ar+1],xn=dr[Ar+2];nt.push({key:this.circleKeys[br],x1:en-xn,y1:mn-xn,x2:en+xn,y2:mn+xn})}}}},Yt.prototype._queryCellCircle=function(Ne,Ge,Qe,tt,rt,nt,at,it){var ot=at.circle,dt=at.seenUids,ht=this.boxCells[rt];if(null!==ht)for(var Dt=this.bboxes,Ot=0,Rt=ht;Ot<Rt.length;Ot+=1){var Zt=Rt[Ot];if(!dt.box[Zt]){dt.box[Zt]=!0;var er=4*Zt;if(this._circleAndRectCollide(ot.x,ot.y,ot.radius,Dt[er+0],Dt[er+1],Dt[er+2],Dt[er+3])&&(!it||it(this.boxKeys[Zt])))return nt.push(!0),!0}}var dr=this.circleCells[rt];if(null!==dr)for(var mr=this.circles,xr=0,br=dr;xr<br.length;xr+=1){var Ar=br[xr];if(!dt.circle[Ar]){dt.circle[Ar]=!0;var en=3*Ar;if(this._circlesCollide(mr[en],mr[en+1],mr[en+2],ot.x,ot.y,ot.radius)&&(!it||it(this.circleKeys[Ar])))return nt.push(!0),!0}}},Yt.prototype._forEachCell=function(Ne,Ge,Qe,tt,rt,nt,at,it){for(var ot=this._convertToXCellCoord(Ne),dt=this._convertToYCellCoord(Ge),ht=this._convertToXCellCoord(Qe),Dt=this._convertToYCellCoord(tt),Ot=ot;Ot<=ht;Ot++)for(var Rt=dt;Rt<=Dt;Rt++)if(rt.call(this,Ne,Ge,Qe,tt,this.xCellCount*Rt+Ot,nt,at,it))return},Yt.prototype._convertToXCellCoord=function(Ne){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(Ne*this.xScale)))},Yt.prototype._convertToYCellCoord=function(Ne){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(Ne*this.yScale)))},Yt.prototype._circlesCollide=function(Ne,Ge,Qe,tt,rt,nt){var at=tt-Ne,it=rt-Ge,ot=Qe+nt;return ot*ot>at*at+it*it},Yt.prototype._circleAndRectCollide=function(Ne,Ge,Qe,tt,rt,nt,at){var it=(nt-tt)/2,ot=Math.abs(Ne-(tt+it));if(ot>it+Qe)return!1;var dt=(at-rt)/2,ht=Math.abs(Ge-(rt+dt));if(ht>dt+Qe)return!1;if(ot<=it||ht<=dt)return!0;var Dt=ot-it,Ot=ht-dt;return Dt*Dt+Ot*Ot<=Qe*Qe};var Ts=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ce(Ne,Ge){for(var Qe=0;Qe<Ne;Qe++){var tt=Ge.length;Ge.resize(tt+4),Ge.float32.set(Ts,3*tt)}}function ue(Ne,Ge,Qe){var tt=Ge[0],rt=Ge[1];return Ne[0]=Qe[0]*tt+Qe[4]*rt+Qe[12],Ne[1]=Qe[1]*tt+Qe[5]*rt+Qe[13],Ne[3]=Qe[3]*tt+Qe[7]*rt+Qe[15],Ne}var he=function(Ne,Ge,Qe){void 0===Ge&&(Ge=new Yt(Ne.width+200,Ne.height+200,25)),void 0===Qe&&(Qe=new Yt(Ne.width+200,Ne.height+200,25)),this.transform=Ne,this.grid=Ge,this.ignoredGrid=Qe,this.pitchfactor=Math.cos(Ne._pitch)*Ne.cameraToCenterDistance,this.screenRightBoundary=Ne.width+100,this.screenBottomBoundary=Ne.height+100,this.gridRightBoundary=Ne.width+200,this.gridBottomBoundary=Ne.height+200};function pe(Ge,Qe,tt){return Qe*(Ne.EXTENT/(Ge.tileSize*Math.pow(2,tt-Ge.tileID.overscaledZ)))}he.prototype.placeCollisionBox=function(Ne,Ge,Qe,tt,rt){var nt=this.projectAndGetPerspectiveRatio(tt,Ne.anchorPointX,Ne.anchorPointY),at=Qe*nt.perspectiveRatio,it=Ne.x1*at+nt.point.x,ot=Ne.y1*at+nt.point.y,dt=Ne.x2*at+nt.point.x,ht=Ne.y2*at+nt.point.y;return!this.isInsideGrid(it,ot,dt,ht)||!Ge&&this.grid.hitTest(it,ot,dt,ht,rt)?{box:[],offscreen:!1}:{box:[it,ot,dt,ht],offscreen:this.isOffscreen(it,ot,dt,ht)}},he.prototype.placeCollisionCircles=function(Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt,Ot,Rt){var Zt=[],er=new Ne.Point(Qe.anchorX,Qe.anchorY),dr=$t(er,at),mr=te(this.transform.cameraToCenterDistance,dr.signedDistanceFromCamera),xr=(ht?nt/mr:nt*mr)/Ne.ONE_EM,br=$t(er,it).point,Ar=oe(xr,rt,Qe.lineOffsetX*xr,Qe.lineOffsetY*xr,!1,br,er,Qe,tt,it,{}),en=!1,mn=!1,xn=!0;if(Ar){for(var kn=.5*Ot*mr+Rt,Cn=new Ne.Point(-100,-100),En=new Ne.Point(this.screenRightBoundary,this.screenBottomBoundary),Pn=new Kt,Dn=Ar.first,In=Ar.last,zn=[],Bn=Dn.path.length-1;Bn>=1;Bn--)zn.push(Dn.path[Bn]);for(var Vn=1;Vn<In.path.length;Vn++)zn.push(In.path[Vn]);var Hn=2.5*kn;if(ot){var qn=zn.map((function(Ne){return $t(Ne,ot)}));zn=qn.some((function(Ne){return Ne.signedDistanceFromCamera<=0}))?[]:qn.map((function(Ne){return Ne.point}))}var Yn=[];if(zn.length>0){for(var $n=zn[0].clone(),ra=zn[0].clone(),oa=1;oa<zn.length;oa++)$n.x=Math.min($n.x,zn[oa].x),$n.y=Math.min($n.y,zn[oa].y),ra.x=Math.max(ra.x,zn[oa].x),ra.y=Math.max(ra.y,zn[oa].y);Yn=$n.x>=Cn.x&&ra.x<=En.x&&$n.y>=Cn.y&&ra.y<=En.y?[zn]:ra.x<Cn.x||$n.x>En.x||ra.y<Cn.y||$n.y>En.y?[]:Ne.clipLine([zn],Cn.x,Cn.y,En.x,En.y)}for(var pa=0,ga=Yn;pa<ga.length;pa+=1){var ma;Pn.reset(ga[pa],.25*kn),ma=Pn.length<=.5*kn?1:Math.ceil(Pn.paddedLength/Hn)+1;for(var _a=0;_a<ma;_a++){var Va=_a/Math.max(ma-1,1),Wa=Pn.lerp(Va),Qa=Wa.x+100,ti=Wa.y+100;Zt.push(Qa,ti,kn,0);var ni=Qa-kn,di=ti-kn,ji=Qa+kn,Hi=ti+kn;if(xn=xn&&this.isOffscreen(ni,di,ji,Hi),mn=mn||this.isInsideGrid(ni,di,ji,Hi),!Ge&&this.grid.hitTestCircle(Qa,ti,kn,Dt)&&(en=!0,!dt))return{circles:[],offscreen:!1,collisionDetected:en}}}}return{circles:!dt&&en||!mn?[]:Zt,offscreen:xn,collisionDetected:en}},he.prototype.queryRenderedSymbols=function(Ge){if(0===Ge.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};for(var Qe=[],tt=1/0,rt=1/0,nt=-1/0,at=-1/0,it=0,ot=Ge;it<ot.length;it+=1){var dt=ot[it],ht=new Ne.Point(dt.x+100,dt.y+100);tt=Math.min(tt,ht.x),rt=Math.min(rt,ht.y),nt=Math.max(nt,ht.x),at=Math.max(at,ht.y),Qe.push(ht)}for(var Dt={},Ot={},Rt=0,Zt=this.grid.query(tt,rt,nt,at).concat(this.ignoredGrid.query(tt,rt,nt,at));Rt<Zt.length;Rt+=1){var er=Zt[Rt],dr=er.key;if(void 0===Dt[dr.bucketInstanceId]&&(Dt[dr.bucketInstanceId]={}),!Dt[dr.bucketInstanceId][dr.featureIndex]){var mr=[new Ne.Point(er.x1,er.y1),new Ne.Point(er.x2,er.y1),new Ne.Point(er.x2,er.y2),new Ne.Point(er.x1,er.y2)];Ne.polygonIntersectsPolygon(Qe,mr)&&(Dt[dr.bucketInstanceId][dr.featureIndex]=!0,void 0===Ot[dr.bucketInstanceId]&&(Ot[dr.bucketInstanceId]=[]),Ot[dr.bucketInstanceId].push(dr.featureIndex))}}return Ot},he.prototype.insertCollisionBox=function(Ne,Ge,Qe,tt,rt){(Ge?this.ignoredGrid:this.grid).insert({bucketInstanceId:Qe,featureIndex:tt,collisionGroupID:rt},Ne[0],Ne[1],Ne[2],Ne[3])},he.prototype.insertCollisionCircles=function(Ne,Ge,Qe,tt,rt){for(var nt=Ge?this.ignoredGrid:this.grid,at={bucketInstanceId:Qe,featureIndex:tt,collisionGroupID:rt},it=0;it<Ne.length;it+=4)nt.insertCircle(at,Ne[it],Ne[it+1],Ne[it+2])},he.prototype.projectAndGetPerspectiveRatio=function(Ge,Qe,tt){var rt=[Qe,tt,0,1];return ue(rt,rt,Ge),{point:new Ne.Point((rt[0]/rt[3]+1)/2*this.transform.width+100,(-rt[1]/rt[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/rt[3]*.5}},he.prototype.isOffscreen=function(Ne,Ge,Qe,tt){return Qe<100||Ne>=this.screenRightBoundary||tt<100||Ge>this.screenBottomBoundary},he.prototype.isInsideGrid=function(Ne,Ge,Qe,tt){return Qe>=0&&Ne<this.gridRightBoundary&&tt>=0&&Ge<this.gridBottomBoundary},he.prototype.getViewportMatrix=function(){var Ge=Ne.identity([]);return Ne.translate(Ge,Ge,[-100,-100,0]),Ge};var de=function(Ne,Ge,Qe,tt){this.opacity=Ne?Math.max(0,Math.min(1,Ne.opacity+(Ne.placed?Ge:-Ge))):tt&&Qe?1:0,this.placed=Qe};de.prototype.isHidden=function(){return 0===this.opacity&&!this.placed};var _e=function(Ne,Ge,Qe,tt,rt){this.text=new de(Ne?Ne.text:null,Ge,Qe,rt),this.icon=new de(Ne?Ne.icon:null,Ge,tt,rt)};_e.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var fe=function(Ne,Ge,Qe){this.text=Ne,this.icon=Ge,this.skipFade=Qe},me=function(){this.invProjMatrix=Ne.create(),this.viewportMatrix=Ne.create(),this.circles=[]},ge=function(Ne,Ge,Qe,tt,rt){this.bucketInstanceId=Ne,this.featureIndex=Ge,this.sourceLayerIndex=Qe,this.bucketIndex=tt,this.tileID=rt},ve=function(Ne){this.crossSourceCollisions=Ne,this.maxGroupID=0,this.collisionGroups={}};function ye(Ge,Qe,tt,rt,nt){var at=Ne.getAnchorAlignment(Ge),it=-(at.horizontalAlign-.5)*Qe,ot=-(at.verticalAlign-.5)*tt,dt=Ne.evaluateVariableOffset(Ge,rt);return new Ne.Point(it+dt[0]*nt,ot+dt[1]*nt)}function xe(Ge,Qe,tt,rt,nt,at){var it=Ge.x1,ot=Ge.x2,dt=Ge.y1,ht=Ge.y2,Dt=Ge.anchorPointX,Ot=Ge.anchorPointY,Rt=new Ne.Point(Qe,tt);return rt&&Rt._rotate(nt?at:-at),{x1:it+Rt.x,y1:dt+Rt.y,x2:ot+Rt.x,y2:ht+Rt.y,anchorPointX:Dt,anchorPointY:Ot}}ve.prototype.get=function(Ne){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[Ne]){var Ge=++this.maxGroupID;this.collisionGroups[Ne]={ID:Ge,predicate:function(Ne){return Ne.collisionGroupID===Ge}}}return this.collisionGroups[Ne]};var be=function(Ne,Ge,Qe,tt){this.transform=Ne.clone(),this.collisionIndex=new he(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=Ge,this.retainedQueryData={},this.collisionGroups=new ve(Qe),this.collisionCircleArrays={},this.prevPlacement=tt,tt&&(tt.prevPlacement=void 0),this.placedOrientations={}};function we(Ne,Ge,Qe,tt,rt){Ne.emplaceBack(Ge?1:0,Qe?1:0,tt||0,rt||0),Ne.emplaceBack(Ge?1:0,Qe?1:0,tt||0,rt||0),Ne.emplaceBack(Ge?1:0,Qe?1:0,tt||0,rt||0),Ne.emplaceBack(Ge?1:0,Qe?1:0,tt||0,rt||0)}be.prototype.getBucketParts=function(Ge,Qe,tt,rt){var nt=tt.getBucket(Qe),at=tt.latestFeatureIndex;if(nt&&at&&Qe.id===nt.layerIds[0]){var it=tt.collisionBoxArray,ot=nt.layers[0].layout,dt=Math.pow(2,this.transform.zoom-tt.tileID.overscaledZ),ht=tt.tileSize/Ne.EXTENT,Dt=this.transform.calculatePosMatrix(tt.tileID.toUnwrapped()),Ot="map"===ot.get("text-pitch-alignment"),Rt="map"===ot.get("text-rotation-alignment"),Zt=pe(tt,1,this.transform.zoom),er=Jt(Dt,Ot,Rt,this.transform,Zt),dr=null;if(Ot){var mr=Qt(Dt,Ot,Rt,this.transform,Zt);dr=Ne.multiply([],this.transform.labelPlaneMatrix,mr)}this.retainedQueryData[nt.bucketInstanceId]=new ge(nt.bucketInstanceId,at,nt.sourceLayerIndex,nt.index,tt.tileID);var xr={bucket:nt,layout:ot,posMatrix:Dt,textLabelPlaneMatrix:er,labelToScreenMatrix:dr,scale:dt,textPixelRatio:ht,holdingForFade:tt.holdingForFade(),collisionBoxArray:it,partiallyEvaluatedTextSize:Ne.evaluateSizeForZoom(nt.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(nt.sourceID)};if(rt)for(var br=0,Ar=nt.sortKeyRanges;br<Ar.length;br+=1){var en=Ar[br];Ge.push({sortKey:en.sortKey,symbolInstanceStart:en.symbolInstanceStart,symbolInstanceEnd:en.symbolInstanceEnd,parameters:xr})}else Ge.push({symbolInstanceStart:0,symbolInstanceEnd:nt.symbolInstances.length,parameters:xr})}},be.prototype.attemptAnchorPlacement=function(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt){var er,dr=[Dt.textOffset0,Dt.textOffset1],mr=ye(Ne,Qe,tt,dr,rt),xr=this.collisionIndex.placeCollisionBox(xe(Ge,mr.x,mr.y,nt,at,this.transform.angle),ht,it,ot,dt.predicate);if(!Zt||0!==this.collisionIndex.placeCollisionBox(xe(Zt,mr.x,mr.y,nt,at,this.transform.angle),ht,it,ot,dt.predicate).box.length)return xr.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[Dt.crossTileID]&&this.prevPlacement.placements[Dt.crossTileID]&&this.prevPlacement.placements[Dt.crossTileID].text&&(er=this.prevPlacement.variableOffsets[Dt.crossTileID].anchor),this.variableOffsets[Dt.crossTileID]={textOffset:dr,width:Qe,height:tt,anchor:Ne,textBoxScale:rt,prevAnchor:er},this.markUsedJustification(Ot,Ne,Dt,Rt),Ot.allowVerticalPlacement&&(this.markUsedOrientation(Ot,Rt,Dt),this.placedOrientations[Dt.crossTileID]=Rt),{shift:mr,placedGlyphBoxes:xr}):void 0},be.prototype.placeLayerBucketPart=function(Ge,Qe,tt){var rt=this,nt=Ge.parameters,at=nt.bucket,it=nt.layout,ot=nt.posMatrix,dt=nt.textLabelPlaneMatrix,ht=nt.labelToScreenMatrix,Dt=nt.textPixelRatio,Ot=nt.holdingForFade,Rt=nt.collisionBoxArray,Zt=nt.partiallyEvaluatedTextSize,er=nt.collisionGroup,dr=it.get("text-optional"),mr=it.get("icon-optional"),xr=it.get("text-allow-overlap"),br=it.get("icon-allow-overlap"),Ar="map"===it.get("text-rotation-alignment"),en="map"===it.get("text-pitch-alignment"),mn="none"!==it.get("icon-text-fit"),xn="viewport-y"===it.get("symbol-z-order"),kn=xr&&(br||!at.hasIconData()||mr),Cn=br&&(xr||!at.hasTextData()||dr);!at.collisionArrays&&Rt&&at.deserializeCollisionBoxes(Rt);var P=function(Ge,nt){if(!Qe[Ge.crossTileID])if(Ot)rt.placements[Ge.crossTileID]=new fe(!1,!1,!1);else{var Rt,xn=!1,En=!1,Pn=!0,Dn=null,In={box:null,offscreen:null},zn={box:null,offscreen:null},Bn=null,Vn=null,Hn=0,qn=0,Yn=0;nt.textFeatureIndex?Hn=nt.textFeatureIndex:Ge.useRuntimeCollisionCircles&&(Hn=Ge.featureIndex),nt.verticalTextFeatureIndex&&(qn=nt.verticalTextFeatureIndex);var $n=nt.textBox;if($n){var O=function(Qe){var tt=Ne.WritingMode.horizontal;if(at.allowVerticalPlacement&&!Qe&&rt.prevPlacement){var nt=rt.prevPlacement.placedOrientations[Ge.crossTileID];nt&&(rt.placedOrientations[Ge.crossTileID]=nt,rt.markUsedOrientation(at,tt=nt,Ge))}return tt},F=function(Qe,tt){if(at.allowVerticalPlacement&&Ge.numVerticalGlyphVertices>0&&nt.verticalTextBox)for(var rt=0,it=at.writingModes;rt<it.length&&(it[rt]===Ne.WritingMode.vertical?(In=tt(),zn=In):In=Qe(),!(In&&In.box&&In.box.length));rt+=1);else In=Qe()};if(it.get("text-variable-anchor")){var ra=it.get("text-variable-anchor");if(rt.prevPlacement&&rt.prevPlacement.variableOffsets[Ge.crossTileID]){var oa=rt.prevPlacement.variableOffsets[Ge.crossTileID];ra.indexOf(oa.anchor)>0&&(ra=ra.filter((function(Ne){return Ne!==oa.anchor}))).unshift(oa.anchor)}var Z=function(Ne,Qe,tt){for(var nt=Ne.x2-Ne.x1,it=Ne.y2-Ne.y1,dt=Ge.textBoxScale,ht=mn&&!br?Qe:null,Ot={box:[],offscreen:!1},Rt=xr?2*ra.length:ra.length,Zt=0;Zt<Rt;++Zt){var dr=rt.attemptAnchorPlacement(ra[Zt%ra.length],Ne,nt,it,dt,Ar,en,Dt,ot,er,Zt>=ra.length,Ge,at,tt,ht);if(dr&&(Ot=dr.placedGlyphBoxes)&&Ot.box&&Ot.box.length){xn=!0,Dn=dr.shift;break}}return Ot};F((function(){return Z($n,nt.iconBox,Ne.WritingMode.horizontal)}),(function(){var Qe=nt.verticalTextBox;return at.allowVerticalPlacement&&!(In&&In.box&&In.box.length)&&Ge.numVerticalGlyphVertices>0&&Qe?Z(Qe,nt.verticalIconBox,Ne.WritingMode.vertical):{box:null,offscreen:null}})),In&&(xn=In.box,Pn=In.offscreen);var pa=O(In&&In.box);if(!xn&&rt.prevPlacement){var ga=rt.prevPlacement.variableOffsets[Ge.crossTileID];ga&&(rt.variableOffsets[Ge.crossTileID]=ga,rt.markUsedJustification(at,ga.anchor,Ge,pa))}}else{var V=function(Ne,Qe){var tt=rt.collisionIndex.placeCollisionBox(Ne,xr,Dt,ot,er.predicate);return tt&&tt.box&&tt.box.length&&(rt.markUsedOrientation(at,Qe,Ge),rt.placedOrientations[Ge.crossTileID]=Qe),tt};F((function(){return V($n,Ne.WritingMode.horizontal)}),(function(){var Qe=nt.verticalTextBox;return at.allowVerticalPlacement&&Ge.numVerticalGlyphVertices>0&&Qe?V(Qe,Ne.WritingMode.vertical):{box:null,offscreen:null}})),O(In&&In.box&&In.box.length)}}if(xn=(Rt=In)&&Rt.box&&Rt.box.length>0,Pn=Rt&&Rt.offscreen,Ge.useRuntimeCollisionCircles){var ma=at.text.placedSymbolArray.get(Ge.centerJustifiedTextSymbolIndex),_a=Ne.evaluateSizeForFeature(at.textSizeData,Zt,ma),Va=it.get("text-padding");Bn=rt.collisionIndex.placeCollisionCircles(xr,ma,at.lineVertexArray,at.glyphOffsetArray,_a,ot,dt,ht,tt,en,er.predicate,Ge.collisionCircleDiameter,Va),xn=xr||Bn.circles.length>0&&!Bn.collisionDetected,Pn=Pn&&Bn.offscreen}if(nt.iconFeatureIndex&&(Yn=nt.iconFeatureIndex),nt.iconBox){var H=function(Ne){var Ge=mn&&Dn?xe(Ne,Dn.x,Dn.y,Ar,en,rt.transform.angle):Ne;return rt.collisionIndex.placeCollisionBox(Ge,br,Dt,ot,er.predicate)};En=zn&&zn.box&&zn.box.length&&nt.verticalIconBox?(Vn=H(nt.verticalIconBox)).box.length>0:(Vn=H(nt.iconBox)).box.length>0,Pn=Pn&&Vn.offscreen}var Wa=dr||0===Ge.numHorizontalGlyphVertices&&0===Ge.numVerticalGlyphVertices,Qa=mr||0===Ge.numIconVertices;if(Wa||Qa?Qa?Wa||(En=En&&xn):xn=En&&xn:En=xn=En&&xn,xn&&Rt&&Rt.box&&rt.collisionIndex.insertCollisionBox(Rt.box,it.get("text-ignore-placement"),at.bucketInstanceId,zn&&zn.box&&qn?qn:Hn,er.ID),En&&Vn&&rt.collisionIndex.insertCollisionBox(Vn.box,it.get("icon-ignore-placement"),at.bucketInstanceId,Yn,er.ID),Bn&&(xn&&rt.collisionIndex.insertCollisionCircles(Bn.circles,it.get("text-ignore-placement"),at.bucketInstanceId,Hn,er.ID),tt)){var ti=at.bucketInstanceId,ni=rt.collisionCircleArrays[ti];void 0===ni&&(ni=rt.collisionCircleArrays[ti]=new me);for(var di=0;di<Bn.circles.length;di+=4)ni.circles.push(Bn.circles[di+0]),ni.circles.push(Bn.circles[di+1]),ni.circles.push(Bn.circles[di+2]),ni.circles.push(Bn.collisionDetected?1:0)}rt.placements[Ge.crossTileID]=new fe(xn||kn,En||Cn,Pn||at.justReloaded),Qe[Ge.crossTileID]=!0}};if(xn)for(var En=at.getSortedSymbolIndexes(this.transform.angle),Pn=En.length-1;Pn>=0;--Pn){var Dn=En[Pn];P(at.symbolInstances.get(Dn),at.collisionArrays[Dn])}else for(var In=Ge.symbolInstanceStart;In<Ge.symbolInstanceEnd;In++)P(at.symbolInstances.get(In),at.collisionArrays[In]);if(tt&&at.bucketInstanceId in this.collisionCircleArrays){var zn=this.collisionCircleArrays[at.bucketInstanceId];Ne.invert(zn.invProjMatrix,ot),zn.viewportMatrix=this.collisionIndex.getViewportMatrix()}at.justReloaded=!1},be.prototype.markUsedJustification=function(Ge,Qe,tt,rt){var nt;nt=rt===Ne.WritingMode.vertical?tt.verticalPlacedTextSymbolIndex:{left:tt.leftJustifiedTextSymbolIndex,center:tt.centerJustifiedTextSymbolIndex,right:tt.rightJustifiedTextSymbolIndex}[Ne.getAnchorJustification(Qe)];for(var at=0,it=[tt.leftJustifiedTextSymbolIndex,tt.centerJustifiedTextSymbolIndex,tt.rightJustifiedTextSymbolIndex,tt.verticalPlacedTextSymbolIndex];at<it.length;at+=1){var ot=it[at];ot>=0&&(Ge.text.placedSymbolArray.get(ot).crossTileID=nt>=0&&ot!==nt?0:tt.crossTileID)}},be.prototype.markUsedOrientation=function(Ge,Qe,tt){for(var rt=Qe===Ne.WritingMode.horizontal||Qe===Ne.WritingMode.horizontalOnly?Qe:0,nt=Qe===Ne.WritingMode.vertical?Qe:0,at=0,it=[tt.leftJustifiedTextSymbolIndex,tt.centerJustifiedTextSymbolIndex,tt.rightJustifiedTextSymbolIndex];at<it.length;at+=1)Ge.text.placedSymbolArray.get(it[at]).placedOrientation=rt;tt.verticalPlacedTextSymbolIndex&&(Ge.text.placedSymbolArray.get(tt.verticalPlacedTextSymbolIndex).placedOrientation=nt)},be.prototype.commit=function(Ne){this.commitTime=Ne,this.zoomAtLastRecencyCheck=this.transform.zoom;var Ge=this.prevPlacement,Qe=!1;this.prevZoomAdjustment=Ge?Ge.zoomAdjustment(this.transform.zoom):0;var tt=Ge?Ge.symbolFadeChange(Ne):1,rt=Ge?Ge.opacities:{},nt=Ge?Ge.variableOffsets:{},at=Ge?Ge.placedOrientations:{};for(var it in this.placements){var ot=this.placements[it],dt=rt[it];dt?(this.opacities[it]=new _e(dt,tt,ot.text,ot.icon),Qe=Qe||ot.text!==dt.text.placed||ot.icon!==dt.icon.placed):(this.opacities[it]=new _e(null,tt,ot.text,ot.icon,ot.skipFade),Qe=Qe||ot.text||ot.icon)}for(var ht in rt){var Dt=rt[ht];if(!this.opacities[ht]){var Ot=new _e(Dt,tt,!1,!1);Ot.isHidden()||(this.opacities[ht]=Ot,Qe=Qe||Dt.text.placed||Dt.icon.placed)}}for(var Rt in nt)this.variableOffsets[Rt]||!this.opacities[Rt]||this.opacities[Rt].isHidden()||(this.variableOffsets[Rt]=nt[Rt]);for(var Zt in at)this.placedOrientations[Zt]||!this.opacities[Zt]||this.opacities[Zt].isHidden()||(this.placedOrientations[Zt]=at[Zt]);Qe?this.lastPlacementChangeTime=Ne:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=Ge?Ge.lastPlacementChangeTime:Ne)},be.prototype.updateLayerOpacities=function(Ne,Ge){for(var Qe={},tt=0,rt=Ge;tt<rt.length;tt+=1){var nt=rt[tt],at=nt.getBucket(Ne);at&&nt.latestFeatureIndex&&Ne.id===at.layerIds[0]&&this.updateBucketOpacities(at,Qe,nt.collisionBoxArray)}},be.prototype.updateBucketOpacities=function(Ge,Qe,tt){var rt=this;Ge.hasTextData()&&Ge.text.opacityVertexArray.clear(),Ge.hasIconData()&&Ge.icon.opacityVertexArray.clear(),Ge.hasIconCollisionBoxData()&&Ge.iconCollisionBox.collisionVertexArray.clear(),Ge.hasTextCollisionBoxData()&&Ge.textCollisionBox.collisionVertexArray.clear();var nt=Ge.layers[0].layout,at=new _e(null,0,!1,!1,!0),it=nt.get("text-allow-overlap"),ot=nt.get("icon-allow-overlap"),dt=nt.get("text-variable-anchor"),ht="map"===nt.get("text-rotation-alignment"),Dt="map"===nt.get("text-pitch-alignment"),Ot="none"!==nt.get("icon-text-fit"),Rt=new _e(null,0,it&&(ot||!Ge.hasIconData()||nt.get("icon-optional")),ot&&(it||!Ge.hasTextData()||nt.get("text-optional")),!0);!Ge.collisionArrays&&tt&&(Ge.hasIconCollisionBoxData()||Ge.hasTextCollisionBoxData())&&Ge.deserializeCollisionBoxes(tt);for(var _=function(Ne,Ge,Qe){for(var tt=0;tt<Ge/4;tt++)Ne.opacityVertexArray.emplaceBack(Qe)},f=function(tt){var nt=Ge.symbolInstances.get(tt),it=nt.numHorizontalGlyphVertices,ot=nt.numVerticalGlyphVertices,Zt=nt.crossTileID,er=rt.opacities[Zt];Qe[Zt]?er=at:er||(rt.opacities[Zt]=er=Rt),Qe[Zt]=!0;var dr=nt.numIconVertices>0,mr=rt.placedOrientations[nt.crossTileID],xr=mr===Ne.WritingMode.vertical,br=mr===Ne.WritingMode.horizontal||mr===Ne.WritingMode.horizontalOnly;if(it>0||ot>0){var Ar=De(er.text);_(Ge.text,it,xr?Os:Ar),_(Ge.text,ot,br?Os:Ar);var en=er.text.isHidden();[nt.rightJustifiedTextSymbolIndex,nt.centerJustifiedTextSymbolIndex,nt.leftJustifiedTextSymbolIndex].forEach((function(Ne){Ne>=0&&(Ge.text.placedSymbolArray.get(Ne).hidden=en||xr?1:0)})),nt.verticalPlacedTextSymbolIndex>=0&&(Ge.text.placedSymbolArray.get(nt.verticalPlacedTextSymbolIndex).hidden=en||br?1:0);var mn=rt.variableOffsets[nt.crossTileID];mn&&rt.markUsedJustification(Ge,mn.anchor,nt,mr);var xn=rt.placedOrientations[nt.crossTileID];xn&&(rt.markUsedJustification(Ge,"left",nt,xn),rt.markUsedOrientation(Ge,xn,nt))}if(dr){var kn=De(er.icon),Cn=!(Ot&&nt.verticalPlacedIconSymbolIndex&&xr);nt.placedIconSymbolIndex>=0&&(_(Ge.icon,nt.numIconVertices,Cn?kn:Os),Ge.icon.placedSymbolArray.get(nt.placedIconSymbolIndex).hidden=er.icon.isHidden()),nt.verticalPlacedIconSymbolIndex>=0&&(_(Ge.icon,nt.numVerticalIconVertices,Cn?Os:kn),Ge.icon.placedSymbolArray.get(nt.verticalPlacedIconSymbolIndex).hidden=er.icon.isHidden())}if(Ge.hasIconCollisionBoxData()||Ge.hasTextCollisionBoxData()){var En=Ge.collisionArrays[tt];if(En){var Pn=new Ne.Point(0,0);if(En.textBox||En.verticalTextBox){var Dn=!0;if(dt){var In=rt.variableOffsets[Zt];In?(Pn=ye(In.anchor,In.width,In.height,In.textOffset,In.textBoxScale),ht&&Pn._rotate(Dt?rt.transform.angle:-rt.transform.angle)):Dn=!1}En.textBox&&we(Ge.textCollisionBox.collisionVertexArray,er.text.placed,!Dn||xr,Pn.x,Pn.y),En.verticalTextBox&&we(Ge.textCollisionBox.collisionVertexArray,er.text.placed,!Dn||br,Pn.x,Pn.y)}var zn=Boolean(!br&&En.verticalIconBox);En.iconBox&&we(Ge.iconCollisionBox.collisionVertexArray,er.icon.placed,zn,Ot?Pn.x:0,Ot?Pn.y:0),En.verticalIconBox&&we(Ge.iconCollisionBox.collisionVertexArray,er.icon.placed,!zn,Ot?Pn.x:0,Ot?Pn.y:0)}}},Zt=0;Zt<Ge.symbolInstances.length;Zt++)f(Zt);if(Ge.sortFeatures(this.transform.angle),this.retainedQueryData[Ge.bucketInstanceId]&&(this.retainedQueryData[Ge.bucketInstanceId].featureSortOrder=Ge.featureSortOrder),Ge.hasTextData()&&Ge.text.opacityVertexBuffer&&Ge.text.opacityVertexBuffer.updateData(Ge.text.opacityVertexArray),Ge.hasIconData()&&Ge.icon.opacityVertexBuffer&&Ge.icon.opacityVertexBuffer.updateData(Ge.icon.opacityVertexArray),Ge.hasIconCollisionBoxData()&&Ge.iconCollisionBox.collisionVertexBuffer&&Ge.iconCollisionBox.collisionVertexBuffer.updateData(Ge.iconCollisionBox.collisionVertexArray),Ge.hasTextCollisionBoxData()&&Ge.textCollisionBox.collisionVertexBuffer&&Ge.textCollisionBox.collisionVertexBuffer.updateData(Ge.textCollisionBox.collisionVertexArray),Ge.bucketInstanceId in this.collisionCircleArrays){var er=this.collisionCircleArrays[Ge.bucketInstanceId];Ge.placementInvProjMatrix=er.invProjMatrix,Ge.placementViewportMatrix=er.viewportMatrix,Ge.collisionCircleArray=er.circles,delete this.collisionCircleArrays[Ge.bucketInstanceId]}},be.prototype.symbolFadeChange=function(Ne){return 0===this.fadeDuration?1:(Ne-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},be.prototype.zoomAdjustment=function(Ne){return Math.max(0,(this.transform.zoom-Ne)/1.5)},be.prototype.hasTransitions=function(Ne){return this.stale||Ne-this.lastPlacementChangeTime<this.fadeDuration},be.prototype.stillRecent=function(Ne,Ge){var Qe=this.zoomAtLastRecencyCheck===Ge?1-this.zoomAdjustment(Ge):1;return this.zoomAtLastRecencyCheck=Ge,this.commitTime+this.fadeDuration*Qe>Ne},be.prototype.setStale=function(){this.stale=!0};var ks=Math.pow(2,25),Cs=Math.pow(2,24),Es=Math.pow(2,17),Ls=Math.pow(2,16),Ps=Math.pow(2,9),Ds=Math.pow(2,8),Is=Math.pow(2,1);function De(Ne){if(0===Ne.opacity&&!Ne.placed)return 0;if(1===Ne.opacity&&Ne.placed)return 4294967295;var Ge=Ne.placed?1:0,Qe=Math.floor(127*Ne.opacity);return Qe*ks+Ge*Cs+Qe*Es+Ge*Ls+Qe*Ps+Ge*Ds+Qe*Is+Ge}var Os=0,Le=function(Ne){this._sortAcrossTiles="viewport-y"!==Ne.layout.get("symbol-z-order")&&void 0!==Ne.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Le.prototype.continuePlacement=function(Ne,Ge,Qe,tt,rt){for(var nt=this._bucketParts;this._currentTileIndex<Ne.length;)if(Ge.getBucketParts(nt,tt,Ne[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,rt())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,nt.sort((function(Ne,Ge){return Ne.sortKey-Ge.sortKey})));this._currentPartIndex<nt.length;)if(Ge.placeLayerBucketPart(nt[this._currentPartIndex],this._seenCrossTileIDs,Qe),this._currentPartIndex++,rt())return!0;return!1};var Ae=function(Ne,Ge,Qe,tt,rt,nt,at){this.placement=new be(Ne,rt,nt,at),this._currentPlacementIndex=Ge.length-1,this._forceFullPlacement=Qe,this._showCollisionBoxes=tt,this._done=!1};Ae.prototype.isDone=function(){return this._done},Ae.prototype.continuePlacement=function(Ge,Qe,tt){for(var rt=this,nt=Ne.browser.now(),n=function(){var Ge=Ne.browser.now()-nt;return!rt._forceFullPlacement&&Ge>2};this._currentPlacementIndex>=0;){var at=Qe[Ge[this._currentPlacementIndex]],it=this.placement.collisionIndex.transform.zoom;if("symbol"===at.type&&(!at.minzoom||at.minzoom<=it)&&(!at.maxzoom||at.maxzoom>it)){if(this._inProgressLayer||(this._inProgressLayer=new Le(at)),this._inProgressLayer.continuePlacement(tt[at.source],this.placement,this._showCollisionBoxes,at,n))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},Ae.prototype.commit=function(Ne){return this.placement.commit(Ne),this.placement};var zs=512/Ne.EXTENT/2,ke=function(Ne,Ge,Qe){this.tileID=Ne,this.indexedSymbolInstances={},this.bucketInstanceId=Qe;for(var tt=0;tt<Ge.length;tt++){var rt=Ge.get(tt),nt=rt.key;this.indexedSymbolInstances[nt]||(this.indexedSymbolInstances[nt]=[]),this.indexedSymbolInstances[nt].push({crossTileID:rt.crossTileID,coord:this.getScaledCoordinates(rt,Ne)})}};ke.prototype.getScaledCoordinates=function(Ge,Qe){var tt=zs/Math.pow(2,Qe.canonical.z-this.tileID.canonical.z);return{x:Math.floor((Qe.canonical.x*Ne.EXTENT+Ge.anchorX)*tt),y:Math.floor((Qe.canonical.y*Ne.EXTENT+Ge.anchorY)*tt)}},ke.prototype.findMatches=function(Ne,Ge,Qe){for(var tt=this.tileID.canonical.z<Ge.canonical.z?1:Math.pow(2,this.tileID.canonical.z-Ge.canonical.z),rt=0;rt<Ne.length;rt++){var nt=Ne.get(rt);if(!nt.crossTileID){var at=this.indexedSymbolInstances[nt.key];if(at)for(var it=this.getScaledCoordinates(nt,Ge),ot=0,dt=at;ot<dt.length;ot+=1){var ht=dt[ot];if(Math.abs(ht.coord.x-it.x)<=tt&&Math.abs(ht.coord.y-it.y)<=tt&&!Qe[ht.crossTileID]){Qe[ht.crossTileID]=!0,nt.crossTileID=ht.crossTileID;break}}}}};var Be=function(){this.maxCrossTileID=0};Be.prototype.generate=function(){return++this.maxCrossTileID};var Oe=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};Oe.prototype.handleWrapJump=function(Ne){var Ge=Math.round((Ne-this.lng)/360);if(0!==Ge)for(var Qe in this.indexes){var tt=this.indexes[Qe],rt={};for(var nt in tt){var at=tt[nt];at.tileID=at.tileID.unwrapTo(at.tileID.wrap+Ge),rt[at.tileID.key]=at}this.indexes[Qe]=rt}this.lng=Ne},Oe.prototype.addBucket=function(Ne,Ge,Qe){if(this.indexes[Ne.overscaledZ]&&this.indexes[Ne.overscaledZ][Ne.key]){if(this.indexes[Ne.overscaledZ][Ne.key].bucketInstanceId===Ge.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(Ne.overscaledZ,this.indexes[Ne.overscaledZ][Ne.key])}for(var tt=0;tt<Ge.symbolInstances.length;tt++)Ge.symbolInstances.get(tt).crossTileID=0;this.usedCrossTileIDs[Ne.overscaledZ]||(this.usedCrossTileIDs[Ne.overscaledZ]={});var rt=this.usedCrossTileIDs[Ne.overscaledZ];for(var nt in this.indexes){var at=this.indexes[nt];if(Number(nt)>Ne.overscaledZ)for(var it in at){var ot=at[it];ot.tileID.isChildOf(Ne)&&ot.findMatches(Ge.symbolInstances,Ne,rt)}else{var dt=at[Ne.scaledTo(Number(nt)).key];dt&&dt.findMatches(Ge.symbolInstances,Ne,rt)}}for(var ht=0;ht<Ge.symbolInstances.length;ht++){var Dt=Ge.symbolInstances.get(ht);Dt.crossTileID||(Dt.crossTileID=Qe.generate(),rt[Dt.crossTileID]=!0)}return void 0===this.indexes[Ne.overscaledZ]&&(this.indexes[Ne.overscaledZ]={}),this.indexes[Ne.overscaledZ][Ne.key]=new ke(Ne,Ge.symbolInstances,Ge.bucketInstanceId),!0},Oe.prototype.removeBucketCrossTileIDs=function(Ne,Ge){for(var Qe in Ge.indexedSymbolInstances)for(var tt=0,rt=Ge.indexedSymbolInstances[Qe];tt<rt.length;tt+=1)delete this.usedCrossTileIDs[Ne][rt[tt].crossTileID]},Oe.prototype.removeStaleBuckets=function(Ne){var Ge=!1;for(var Qe in this.indexes){var tt=this.indexes[Qe];for(var rt in tt)Ne[tt[rt].bucketInstanceId]||(this.removeBucketCrossTileIDs(Qe,tt[rt]),delete tt[rt],Ge=!0)}return Ge};var Fe=function(){this.layerIndexes={},this.crossTileIDs=new Be,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Fe.prototype.addLayer=function(Ne,Ge,Qe){var tt=this.layerIndexes[Ne.id];void 0===tt&&(tt=this.layerIndexes[Ne.id]=new Oe);var rt=!1,nt={};tt.handleWrapJump(Qe);for(var at=0,it=Ge;at<it.length;at+=1){var ot=it[at],dt=ot.getBucket(Ne);dt&&Ne.id===dt.layerIds[0]&&(dt.bucketInstanceId||(dt.bucketInstanceId=++this.maxBucketInstanceId),tt.addBucket(ot.tileID,dt,this.crossTileIDs)&&(rt=!0),nt[dt.bucketInstanceId]=!0)}return tt.removeStaleBuckets(nt)&&(rt=!0),rt},Fe.prototype.pruneUnusedLayers=function(Ne){var Ge={};for(var Qe in Ne.forEach((function(Ne){Ge[Ne]=!0})),this.layerIndexes)Ge[Qe]||delete this.layerIndexes[Qe]};var Ue=function(Ge,Qe){return Ne.emitValidationErrors(Ge,Qe&&Qe.filter((function(Ne){return"source.canvas"!==Ne.identifier})))},Rs=Ne.pick(ws,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Bs=Ne.pick(ws,["setCenter","setZoom","setBearing","setPitch"]),Fs=function(){var Ge={},Qe=Ne.styleSpec.$version;for(var tt in Ne.styleSpec.$root){var rt,nt=Ne.styleSpec.$root[tt];nt.required&&null!=(rt="version"===tt?Qe:"array"===nt.type?[]:{})&&(Ge[tt]=rt)}return Ge}(),js=function(Ge){function i(Qe,tt){var rt=this;void 0===tt&&(tt={}),Ge.call(this),this.map=Qe,this.dispatcher=new er(Ft(),this),this.imageManager=new dt,this.imageManager.setEventedParent(this),this.glyphManager=new y(Qe._requestManager,tt.localIdeographFontFamily),this.lineAtlas=new T(256,512),this.crossTileSymbolIndex=new Fe,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new Ne.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",Ne.getReferrer());var nt=this;this._rtlTextPluginCallback=i.registerForPluginStateChange((function(Ge){nt.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:Ge.pluginStatus,pluginURL:Ge.pluginURL},(function(Ge,Qe){if(Ne.triggerPluginCompletionEvent(Ge),Qe&&Qe.every((function(Ne){return Ne})))for(var tt in nt.sourceCaches)nt.sourceCaches[tt].reload()}))})),this.on("data",(function(Ne){if("source"===Ne.dataType&&"metadata"===Ne.sourceDataType){var Ge=rt.sourceCaches[Ne.sourceId];if(Ge){var Qe=Ge.getSource();if(Qe&&Qe.vectorLayerIds)for(var tt in rt._layers){var nt=rt._layers[tt];nt.source===Qe.id&&rt._validateLayer(nt)}}}}))}return Ge&&(i.__proto__=Ge),(i.prototype=Object.create(Ge&&Ge.prototype)).constructor=i,i.prototype.loadURL=function(Ge,Qe){var tt=this;void 0===Qe&&(Qe={}),this.fire(new Ne.Event("dataloading",{dataType:"style"}));var rt="boolean"==typeof Qe.validate?Qe.validate:!Ne.isMapboxURL(Ge);Ge=this.map._requestManager.normalizeStyleURL(Ge,Qe.accessToken);var nt=this.map._requestManager.transformRequest(Ge,Ne.ResourceType.Style);this._request=Ne.getJSON(nt,(function(Ge,Qe){tt._request=null,Ge?tt.fire(new Ne.ErrorEvent(Ge)):Qe&&tt._load(Qe,rt)}))},i.prototype.loadJSON=function(Ge,Qe){var tt=this;void 0===Qe&&(Qe={}),this.fire(new Ne.Event("dataloading",{dataType:"style"})),this._request=Ne.browser.frame((function(){tt._request=null,tt._load(Ge,!1!==Qe.validate)}))},i.prototype.loadEmpty=function(){this.fire(new Ne.Event("dataloading",{dataType:"style"})),this._load(Fs,!1)},i.prototype._load=function(Ge,Qe){if(!Qe||!Ue(this,Ne.validateStyle(Ge))){for(var tt in this._loaded=!0,this.stylesheet=Ge,Ge.sources)this.addSource(tt,Ge.sources[tt],{validate:!1});Ge.sprite?this._loadSprite(Ge.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(Ge.glyphs);var rt=Nt(this.stylesheet.layers);this._order=rt.map((function(Ne){return Ne.id})),this._layers={},this._serializedLayers={};for(var nt=0,at=rt;nt<at.length;nt+=1){var it=at[nt];(it=Ne.createStyleLayer(it)).setEventedParent(this,{layer:{id:it.id}}),this._layers[it.id]=it,this._serializedLayers[it.id]=it.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Zt(this.stylesheet.light),this.fire(new Ne.Event("data",{dataType:"style"})),this.fire(new Ne.Event("style.load"))}},i.prototype._loadSprite=function(Ge){var Qe=this;this._spriteRequest=function(Ge,Qe,tt){var rt,nt,at,it=Ne.browser.devicePixelRatio>1?"@2x":"",ot=Ne.getJSON(Qe.transformRequest(Qe.normalizeSpriteURL(Ge,it,".json"),Ne.ResourceType.SpriteJSON),(function(Ne,Ge){ot=null,at||(at=Ne,rt=Ge,u())})),dt=Ne.getImage(Qe.transformRequest(Qe.normalizeSpriteURL(Ge,it,".png"),Ne.ResourceType.SpriteImage),(function(Ne,Ge){dt=null,at||(at=Ne,nt=Ge,u())}));function u(){if(at)tt(at);else if(rt&&nt){var Ge=Ne.browser.getImageData(nt),Qe={};for(var it in rt){var ot=rt[it],dt=ot.width,ht=ot.height,Dt=ot.x,Ot=ot.y,Rt=ot.sdf,Zt=ot.pixelRatio,er=ot.stretchX,dr=ot.stretchY,mr=ot.content,xr=new Ne.RGBAImage({width:dt,height:ht});Ne.RGBAImage.copy(Ge,xr,{x:Dt,y:Ot},{x:0,y:0},{width:dt,height:ht}),Qe[it]={data:xr,pixelRatio:Zt,sdf:Rt,stretchX:er,stretchY:dr,content:mr}}tt(null,Qe)}}return{cancel:function(){ot&&(ot.cancel(),ot=null),dt&&(dt.cancel(),dt=null)}}}(Ge,this.map._requestManager,(function(Ge,tt){if(Qe._spriteRequest=null,Ge)Qe.fire(new Ne.ErrorEvent(Ge));else if(tt)for(var rt in tt)Qe.imageManager.addImage(rt,tt[rt]);Qe.imageManager.setLoaded(!0),Qe._availableImages=Qe.imageManager.listImages(),Qe.dispatcher.broadcast("setImages",Qe._availableImages),Qe.fire(new Ne.Event("data",{dataType:"style"}))}))},i.prototype._validateLayer=function(Ge){var Qe=this.sourceCaches[Ge.source];if(Qe){var tt=Ge.sourceLayer;if(tt){var rt=Qe.getSource();("geojson"===rt.type||rt.vectorLayerIds&&-1===rt.vectorLayerIds.indexOf(tt))&&this.fire(new Ne.ErrorEvent(new Error('Source layer "'+tt+'" does not exist on source "'+rt.id+'" as specified by style layer "'+Ge.id+'"')))}}},i.prototype.loaded=function(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(var Ne in this.sourceCaches)if(!this.sourceCaches[Ne].loaded())return!1;return!!this.imageManager.isLoaded()},i.prototype._serializeLayers=function(Ne){for(var Ge=[],Qe=0,tt=Ne;Qe<tt.length;Qe+=1){var rt=this._layers[tt[Qe]];"custom"!==rt.type&&Ge.push(rt.serialize())}return Ge},i.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var Ne in this.sourceCaches)if(this.sourceCaches[Ne].hasTransition())return!0;for(var Ge in this._layers)if(this._layers[Ge].hasTransition())return!0;return!1},i.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},i.prototype.update=function(Ge){if(this._loaded){var Qe=this._changed;if(this._changed){var tt=Object.keys(this._updatedLayers),rt=Object.keys(this._removedLayers);for(var nt in(tt.length||rt.length)&&this._updateWorkerLayers(tt,rt),this._updatedSources){var at=this._updatedSources[nt];"reload"===at?this._reloadSource(nt):"clear"===at&&this._clearSource(nt)}for(var it in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[it].updateTransitions(Ge);this.light.updateTransitions(Ge),this._resetUpdates()}for(var ot in this.sourceCaches)this.sourceCaches[ot].used=!1;for(var dt=0,ht=this._order;dt<ht.length;dt+=1){var Dt=this._layers[ht[dt]];Dt.recalculate(Ge,this._availableImages),!Dt.isHidden(Ge.zoom)&&Dt.source&&(this.sourceCaches[Dt.source].used=!0)}this.light.recalculate(Ge),this.z=Ge.zoom,Qe&&this.fire(new Ne.Event("data",{dataType:"style"}))}},i.prototype._updateTilesForChangedImages=function(){var Ne=Object.keys(this._changedImages);if(Ne.length){for(var Ge in this.sourceCaches)this.sourceCaches[Ge].reloadTilesForDependencies(["icons","patterns"],Ne);this._changedImages={}}},i.prototype._updateWorkerLayers=function(Ne,Ge){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(Ne),removedIds:Ge})},i.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},i.prototype.setState=function(Ge){var Qe=this;if(this._checkLoaded(),Ue(this,Ne.validateStyle(Ge)))return!1;(Ge=Ne.clone$1(Ge)).layers=Nt(Ge.layers);var tt=function(Ge,Qe){if(!Ge)return[{command:ws.setStyle,args:[Qe]}];var tt=[];try{if(!Ne.deepEqual(Ge.version,Qe.version))return[{command:ws.setStyle,args:[Qe]}];Ne.deepEqual(Ge.center,Qe.center)||tt.push({command:ws.setCenter,args:[Qe.center]}),Ne.deepEqual(Ge.zoom,Qe.zoom)||tt.push({command:ws.setZoom,args:[Qe.zoom]}),Ne.deepEqual(Ge.bearing,Qe.bearing)||tt.push({command:ws.setBearing,args:[Qe.bearing]}),Ne.deepEqual(Ge.pitch,Qe.pitch)||tt.push({command:ws.setPitch,args:[Qe.pitch]}),Ne.deepEqual(Ge.sprite,Qe.sprite)||tt.push({command:ws.setSprite,args:[Qe.sprite]}),Ne.deepEqual(Ge.glyphs,Qe.glyphs)||tt.push({command:ws.setGlyphs,args:[Qe.glyphs]}),Ne.deepEqual(Ge.transition,Qe.transition)||tt.push({command:ws.setTransition,args:[Qe.transition]}),Ne.deepEqual(Ge.light,Qe.light)||tt.push({command:ws.setLight,args:[Qe.light]});var rt={},nt=[];!function(Ge,Qe,tt,rt){var nt;for(nt in Qe=Qe||{},Ge=Ge||{})Ge.hasOwnProperty(nt)&&(Qe.hasOwnProperty(nt)||qt(nt,tt,rt));for(nt in Qe)Qe.hasOwnProperty(nt)&&(Ge.hasOwnProperty(nt)?Ne.deepEqual(Ge[nt],Qe[nt])||("geojson"===Ge[nt].type&&"geojson"===Qe[nt].type&&Gt(Ge,Qe,nt)?tt.push({command:ws.setGeoJSONSourceData,args:[nt,Qe[nt].data]}):Vt(nt,Qe,tt,rt)):jt(nt,Qe,tt))}(Ge.sources,Qe.sources,nt,rt);var at=[];Ge.layers&&Ge.layers.forEach((function(Ne){rt[Ne.source]?tt.push({command:ws.removeLayer,args:[Ne.id]}):at.push(Ne)})),tt=tt.concat(nt),function(Ge,Qe,tt){Qe=Qe||[];var rt,nt,at,it,ot,dt,ht,Dt=(Ge=Ge||[]).map(Xt),Ot=Qe.map(Xt),Rt=Ge.reduce(Ht,{}),Zt=Qe.reduce(Ht,{}),er=Dt.slice(),dr=Object.create(null);for(rt=0,nt=0;rt<Dt.length;rt++)Zt.hasOwnProperty(at=Dt[rt])?nt++:(tt.push({command:ws.removeLayer,args:[at]}),er.splice(er.indexOf(at,nt),1));for(rt=0,nt=0;rt<Ot.length;rt++)er[er.length-1-rt]!==(at=Ot[Ot.length-1-rt])&&(Rt.hasOwnProperty(at)?(tt.push({command:ws.removeLayer,args:[at]}),er.splice(er.lastIndexOf(at,er.length-nt),1)):nt++,tt.push({command:ws.addLayer,args:[Zt[at],dt=er[er.length-rt]]}),er.splice(er.length-rt,0,at),dr[at]=!0);for(rt=0;rt<Ot.length;rt++)if(it=Rt[at=Ot[rt]],ot=Zt[at],!dr[at]&&!Ne.deepEqual(it,ot))if(Ne.deepEqual(it.source,ot.source)&&Ne.deepEqual(it["source-layer"],ot["source-layer"])&&Ne.deepEqual(it.type,ot.type)){for(ht in Wt(it.layout,ot.layout,tt,at,null,ws.setLayoutProperty),Wt(it.paint,ot.paint,tt,at,null,ws.setPaintProperty),Ne.deepEqual(it.filter,ot.filter)||tt.push({command:ws.setFilter,args:[at,ot.filter]}),Ne.deepEqual(it.minzoom,ot.minzoom)&&Ne.deepEqual(it.maxzoom,ot.maxzoom)||tt.push({command:ws.setLayerZoomRange,args:[at,ot.minzoom,ot.maxzoom]}),it)it.hasOwnProperty(ht)&&"layout"!==ht&&"paint"!==ht&&"filter"!==ht&&"metadata"!==ht&&"minzoom"!==ht&&"maxzoom"!==ht&&(0===ht.indexOf("paint.")?Wt(it[ht],ot[ht],tt,at,ht.slice(6),ws.setPaintProperty):Ne.deepEqual(it[ht],ot[ht])||tt.push({command:ws.setLayerProperty,args:[at,ht,ot[ht]]}));for(ht in ot)ot.hasOwnProperty(ht)&&!it.hasOwnProperty(ht)&&"layout"!==ht&&"paint"!==ht&&"filter"!==ht&&"metadata"!==ht&&"minzoom"!==ht&&"maxzoom"!==ht&&(0===ht.indexOf("paint.")?Wt(it[ht],ot[ht],tt,at,ht.slice(6),ws.setPaintProperty):Ne.deepEqual(it[ht],ot[ht])||tt.push({command:ws.setLayerProperty,args:[at,ht,ot[ht]]}))}else tt.push({command:ws.removeLayer,args:[at]}),dt=er[er.lastIndexOf(at)+1],tt.push({command:ws.addLayer,args:[ot,dt]})}(at,Qe.layers,tt)}catch(Ne){console.warn("Unable to compute style diff:",Ne),tt=[{command:ws.setStyle,args:[Qe]}]}return tt}(this.serialize(),Ge).filter((function(Ne){return!(Ne.command in Bs)}));if(0===tt.length)return!1;var rt=tt.filter((function(Ne){return!(Ne.command in Rs)}));if(rt.length>0)throw new Error("Unimplemented: "+rt.map((function(Ne){return Ne.command})).join(", ")+".");return tt.forEach((function(Ne){"setTransition"!==Ne.command&&Qe[Ne.command].apply(Qe,Ne.args)})),this.stylesheet=Ge,!0},i.prototype.addImage=function(Ge,Qe){if(this.getImage(Ge))return this.fire(new Ne.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(Ge,Qe),this._availableImages=this.imageManager.listImages(),this._changedImages[Ge]=!0,this._changed=!0,this.fire(new Ne.Event("data",{dataType:"style"}))},i.prototype.updateImage=function(Ne,Ge){this.imageManager.updateImage(Ne,Ge)},i.prototype.getImage=function(Ne){return this.imageManager.getImage(Ne)},i.prototype.removeImage=function(Ge){if(!this.getImage(Ge))return this.fire(new Ne.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(Ge),this._availableImages=this.imageManager.listImages(),this._changedImages[Ge]=!0,this._changed=!0,this.fire(new Ne.Event("data",{dataType:"style"}))},i.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},i.prototype.addSource=function(Ge,Qe,tt){var rt=this;if(void 0===tt&&(tt={}),this._checkLoaded(),void 0!==this.sourceCaches[Ge])throw new Error("There is already a source with this ID");if(!Qe.type)throw new Error("The type property must be defined, but the only the following properties were given: "+Object.keys(Qe).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(Qe.type)>=0&&this._validate(Ne.validateStyle.source,"sources."+Ge,Qe,null,tt))){this.map&&this.map._collectResourceTiming&&(Qe.collectResourceTiming=!0);var nt=this.sourceCaches[Ge]=new ds(Ge,Qe,this.dispatcher);nt.style=this,nt.setEventedParent(this,(function(){return{isSourceLoaded:rt.loaded(),source:nt.serialize(),sourceId:Ge}})),nt.onAdd(this.map),this._changed=!0}},i.prototype.removeSource=function(Ge){if(this._checkLoaded(),void 0===this.sourceCaches[Ge])throw new Error("There is no source with this ID");for(var Qe in this._layers)if(this._layers[Qe].source===Ge)return this.fire(new Ne.ErrorEvent(new Error('Source "'+Ge+'" cannot be removed while layer "'+Qe+'" is using it.')));var tt=this.sourceCaches[Ge];delete this.sourceCaches[Ge],delete this._updatedSources[Ge],tt.fire(new Ne.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:Ge})),tt.setEventedParent(null),tt.clearTiles(),tt.onRemove&&tt.onRemove(this.map),this._changed=!0},i.prototype.setGeoJSONSourceData=function(Ne,Ge){this._checkLoaded(),this.sourceCaches[Ne].getSource().setData(Ge),this._changed=!0},i.prototype.getSource=function(Ne){return this.sourceCaches[Ne]&&this.sourceCaches[Ne].getSource()},i.prototype.addLayer=function(Ge,Qe,tt){void 0===tt&&(tt={}),this._checkLoaded();var rt=Ge.id;if(this.getLayer(rt))this.fire(new Ne.ErrorEvent(new Error('Layer with id "'+rt+'" already exists on this map')));else{var nt;if("custom"===Ge.type){if(Ue(this,Ne.validateCustomStyleLayer(Ge)))return;nt=Ne.createStyleLayer(Ge)}else{if("object"==typeof Ge.source&&(this.addSource(rt,Ge.source),Ge=Ne.clone$1(Ge),Ge=Ne.extend(Ge,{source:rt})),this._validate(Ne.validateStyle.layer,"layers."+rt,Ge,{arrayIndex:-1},tt))return;nt=Ne.createStyleLayer(Ge),this._validateLayer(nt),nt.setEventedParent(this,{layer:{id:rt}}),this._serializedLayers[nt.id]=nt.serialize()}var at=Qe?this._order.indexOf(Qe):this._order.length;if(Qe&&-1===at)this.fire(new Ne.ErrorEvent(new Error('Layer with id "'+Qe+'" does not exist on this map.')));else{if(this._order.splice(at,0,rt),this._layerOrderChanged=!0,this._layers[rt]=nt,this._removedLayers[rt]&&nt.source&&"custom"!==nt.type){var it=this._removedLayers[rt];delete this._removedLayers[rt],it.type!==nt.type?this._updatedSources[nt.source]="clear":(this._updatedSources[nt.source]="reload",this.sourceCaches[nt.source].pause())}this._updateLayer(nt),nt.onAdd&&nt.onAdd(this.map)}}},i.prototype.moveLayer=function(Ge,Qe){if(this._checkLoaded(),this._changed=!0,this._layers[Ge]){if(Ge!==Qe){var tt=this._order.indexOf(Ge);this._order.splice(tt,1);var rt=Qe?this._order.indexOf(Qe):this._order.length;Qe&&-1===rt?this.fire(new Ne.ErrorEvent(new Error('Layer with id "'+Qe+'" does not exist on this map.'))):(this._order.splice(rt,0,Ge),this._layerOrderChanged=!0)}}else this.fire(new Ne.ErrorEvent(new Error("The layer '"+Ge+"' does not exist in the map's style and cannot be moved.")))},i.prototype.removeLayer=function(Ge){this._checkLoaded();var Qe=this._layers[Ge];if(Qe){Qe.setEventedParent(null);var tt=this._order.indexOf(Ge);this._order.splice(tt,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[Ge]=Qe,delete this._layers[Ge],delete this._serializedLayers[Ge],delete this._updatedLayers[Ge],delete this._updatedPaintProps[Ge],Qe.onRemove&&Qe.onRemove(this.map)}else this.fire(new Ne.ErrorEvent(new Error("The layer '"+Ge+"' does not exist in the map's style and cannot be removed.")))},i.prototype.getLayer=function(Ne){return this._layers[Ne]},i.prototype.hasLayer=function(Ne){return Ne in this._layers},i.prototype.setLayerZoomRange=function(Ge,Qe,tt){this._checkLoaded();var rt=this.getLayer(Ge);rt?rt.minzoom===Qe&&rt.maxzoom===tt||(null!=Qe&&(rt.minzoom=Qe),null!=tt&&(rt.maxzoom=tt),this._updateLayer(rt)):this.fire(new Ne.ErrorEvent(new Error("The layer '"+Ge+"' does not exist in the map's style and cannot have zoom extent.")))},i.prototype.setFilter=function(Ge,Qe,tt){void 0===tt&&(tt={}),this._checkLoaded();var rt=this.getLayer(Ge);if(rt){if(!Ne.deepEqual(rt.filter,Qe))return null==Qe?(rt.filter=void 0,void this._updateLayer(rt)):void(this._validate(Ne.validateStyle.filter,"layers."+rt.id+".filter",Qe,null,tt)||(rt.filter=Ne.clone$1(Qe),this._updateLayer(rt)))}else this.fire(new Ne.ErrorEvent(new Error("The layer '"+Ge+"' does not exist in the map's style and cannot be filtered.")))},i.prototype.getFilter=function(Ge){return Ne.clone$1(this.getLayer(Ge).filter)},i.prototype.setLayoutProperty=function(Ge,Qe,tt,rt){void 0===rt&&(rt={}),this._checkLoaded();var nt=this.getLayer(Ge);nt?Ne.deepEqual(nt.getLayoutProperty(Qe),tt)||(nt.setLayoutProperty(Qe,tt,rt),this._updateLayer(nt)):this.fire(new Ne.ErrorEvent(new Error("The layer '"+Ge+"' does not exist in the map's style and cannot be styled.")))},i.prototype.getLayoutProperty=function(Ge,Qe){var tt=this.getLayer(Ge);if(tt)return tt.getLayoutProperty(Qe);this.fire(new Ne.ErrorEvent(new Error("The layer '"+Ge+"' does not exist in the map's style.")))},i.prototype.setPaintProperty=function(Ge,Qe,tt,rt){void 0===rt&&(rt={}),this._checkLoaded();var nt=this.getLayer(Ge);nt?Ne.deepEqual(nt.getPaintProperty(Qe),tt)||(nt.setPaintProperty(Qe,tt,rt)&&this._updateLayer(nt),this._changed=!0,this._updatedPaintProps[Ge]=!0):this.fire(new Ne.ErrorEvent(new Error("The layer '"+Ge+"' does not exist in the map's style and cannot be styled.")))},i.prototype.getPaintProperty=function(Ne,Ge){return this.getLayer(Ne).getPaintProperty(Ge)},i.prototype.setFeatureState=function(Ge,Qe){this._checkLoaded();var tt=Ge.source,rt=Ge.sourceLayer,nt=this.sourceCaches[tt];if(void 0!==nt){var at=nt.getSource().type;"geojson"===at&&rt?this.fire(new Ne.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):"vector"!==at||rt?(void 0===Ge.id&&this.fire(new Ne.ErrorEvent(new Error("The feature id parameter must be provided."))),nt.setFeatureState(rt,Ge.id,Qe)):this.fire(new Ne.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new Ne.ErrorEvent(new Error("The source '"+tt+"' does not exist in the map's style.")))},i.prototype.removeFeatureState=function(Ge,Qe){this._checkLoaded();var tt=Ge.source,rt=this.sourceCaches[tt];if(void 0!==rt){var nt=rt.getSource().type,at="vector"===nt?Ge.sourceLayer:void 0;"vector"!==nt||at?Qe&&"string"!=typeof Ge.id&&"number"!=typeof Ge.id?this.fire(new Ne.ErrorEvent(new Error("A feature id is requred to remove its specific state property."))):rt.removeFeatureState(at,Ge.id,Qe):this.fire(new Ne.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new Ne.ErrorEvent(new Error("The source '"+tt+"' does not exist in the map's style.")))},i.prototype.getFeatureState=function(Ge){this._checkLoaded();var Qe=Ge.source,tt=Ge.sourceLayer,rt=this.sourceCaches[Qe];if(void 0!==rt){if("vector"!==rt.getSource().type||tt)return void 0===Ge.id&&this.fire(new Ne.ErrorEvent(new Error("The feature id parameter must be provided."))),rt.getFeatureState(tt,Ge.id);this.fire(new Ne.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new Ne.ErrorEvent(new Error("The source '"+Qe+"' does not exist in the map's style.")))},i.prototype.getTransition=function(){return Ne.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},i.prototype.serialize=function(){return Ne.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:Ne.mapObject(this.sourceCaches,(function(Ne){return Ne.serialize()})),layers:this._serializeLayers(this._order)},(function(Ne){return void 0!==Ne}))},i.prototype._updateLayer=function(Ne){this._updatedLayers[Ne.id]=!0,Ne.source&&!this._updatedSources[Ne.source]&&"raster"!==this.sourceCaches[Ne.source].getSource().type&&(this._updatedSources[Ne.source]="reload",this.sourceCaches[Ne.source].pause()),this._changed=!0},i.prototype._flattenAndSortRenderedFeatures=function(Ne){for(var Ge=this,i=function(Ne){return"fill-extrusion"===Ge._layers[Ne].type},Qe={},tt=[],rt=this._order.length-1;rt>=0;rt--){var nt=this._order[rt];if(i(nt)){Qe[nt]=rt;for(var at=0,it=Ne;at<it.length;at+=1){var ot=it[at][nt];if(ot)for(var dt=0,ht=ot;dt<ht.length;dt+=1)tt.push(ht[dt])}}}tt.sort((function(Ne,Ge){return Ge.intersectionZ-Ne.intersectionZ}));for(var Dt=[],Ot=this._order.length-1;Ot>=0;Ot--){var Rt=this._order[Ot];if(i(Rt))for(var Zt=tt.length-1;Zt>=0;Zt--){var er=tt[Zt].feature;if(Qe[er.layer.id]<Ot)break;Dt.push(er),tt.pop()}else for(var dr=0,mr=Ne;dr<mr.length;dr+=1){var xr=mr[dr][Rt];if(xr)for(var br=0,Ar=xr;br<Ar.length;br+=1)Dt.push(Ar[br].feature)}}return Dt},i.prototype.queryRenderedFeatures=function(Ge,Qe,tt){Qe&&Qe.filter&&this._validate(Ne.validateStyle.filter,"queryRenderedFeatures.filter",Qe.filter,null,Qe);var rt={};if(Qe&&Qe.layers){if(!Array.isArray(Qe.layers))return this.fire(new Ne.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var nt=0,at=Qe.layers;nt<at.length;nt+=1){var it=at[nt],ot=this._layers[it];if(!ot)return this.fire(new Ne.ErrorEvent(new Error("The layer '"+it+"' does not exist in the map's style and cannot be queried for features."))),[];rt[ot.source]=!0}}var dt=[];for(var ht in Qe.availableImages=this._availableImages,this.sourceCaches)Qe.layers&&!rt[ht]||dt.push(O(this.sourceCaches[ht],this._layers,this._serializedLayers,Ge,Qe,tt));return this.placement&&dt.push(function(Ne,Ge,Qe,tt,rt,nt,at){for(var it={},ot=nt.queryRenderedSymbols(tt),dt=[],ht=0,Dt=Object.keys(ot).map(Number);ht<Dt.length;ht+=1)dt.push(at[Dt[ht]]);dt.sort(F);for(var p=function(){var Qe=Rt[Ot],tt=Qe.featureIndex.lookupSymbolFeatures(ot[Qe.bucketInstanceId],Ge,Qe.bucketIndex,Qe.sourceLayerIndex,rt.filter,rt.layers,rt.availableImages,Ne);for(var nt in tt){var at=it[nt]=it[nt]||[],dt=tt[nt];dt.sort((function(Ne,Ge){var tt=Qe.featureSortOrder;if(tt){var rt=tt.indexOf(Ne.featureIndex);return tt.indexOf(Ge.featureIndex)-rt}return Ge.featureIndex-Ne.featureIndex}));for(var ht=0,Dt=dt;ht<Dt.length;ht+=1)at.push(Dt[ht])}},Ot=0,Rt=dt;Ot<Rt.length;Ot+=1)p();var f=function(Ge){it[Ge].forEach((function(tt){var rt=tt.feature,nt=Qe[Ne[Ge].source].getFeatureState(rt.layer["source-layer"],rt.id);rt.source=rt.layer.source,rt.layer["source-layer"]&&(rt.sourceLayer=rt.layer["source-layer"]),rt.state=nt}))};for(var Zt in it)f(Zt);return it}(this._layers,this._serializedLayers,this.sourceCaches,Ge,Qe,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(dt)},i.prototype.querySourceFeatures=function(Ge,Qe){Qe&&Qe.filter&&this._validate(Ne.validateStyle.filter,"querySourceFeatures.filter",Qe.filter,null,Qe);var tt=this.sourceCaches[Ge];return tt?function(Ne,Ge){for(var Qe=Ne.getRenderableIds().map((function(Ge){return Ne.getTileByID(Ge)})),tt=[],rt={},nt=0;nt<Qe.length;nt++){var at=Qe[nt],it=at.tileID.canonical.key;rt[it]||(rt[it]=!0,at.querySourceFeatures(tt,Ge))}return tt}(tt,Qe):[]},i.prototype.addSourceType=function(Ne,Ge,Qe){return i.getSourceType(Ne)?Qe(new Error('A source type called "'+Ne+'" already exists.')):(i.setSourceType(Ne,Ge),Ge.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:Ne,url:Ge.workerSourceURL},Qe):Qe(null,null))},i.prototype.getLight=function(){return this.light.getLight()},i.prototype.setLight=function(Ge,Qe){void 0===Qe&&(Qe={}),this._checkLoaded();var tt=this.light.getLight(),rt=!1;for(var nt in Ge)if(!Ne.deepEqual(Ge[nt],tt[nt])){rt=!0;break}if(rt){var at={now:Ne.browser.now(),transition:Ne.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(Ge,Qe),this.light.updateTransitions(at)}},i.prototype._validate=function(Ge,Qe,tt,rt,nt){return void 0===nt&&(nt={}),(!nt||!1!==nt.validate)&&Ue(this,Ge.call(Ne.validateStyle,Ne.extend({key:Qe,style:this.serialize(),value:tt,styleSpec:Ne.styleSpec},rt)))},i.prototype._remove=function(){for(var Ge in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),Ne.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[Ge].setEventedParent(null);for(var Qe in this.sourceCaches)this.sourceCaches[Qe].clearTiles(),this.sourceCaches[Qe].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},i.prototype._clearSource=function(Ne){this.sourceCaches[Ne].clearTiles()},i.prototype._reloadSource=function(Ne){this.sourceCaches[Ne].resume(),this.sourceCaches[Ne].reload()},i.prototype._updateSources=function(Ne){for(var Ge in this.sourceCaches)this.sourceCaches[Ge].update(Ne)},i.prototype._generateCollisionBoxes=function(){for(var Ne in this.sourceCaches)this._reloadSource(Ne)},i.prototype._updatePlacement=function(Ge,Qe,tt,rt,nt){void 0===nt&&(nt=!1);for(var at=!1,it=!1,ot={},dt=0,ht=this._order;dt<ht.length;dt+=1){var Dt=this._layers[ht[dt]];if("symbol"===Dt.type){if(!ot[Dt.source]){var Ot=this.sourceCaches[Dt.source];ot[Dt.source]=Ot.getRenderableIds(!0).map((function(Ne){return Ot.getTileByID(Ne)})).sort((function(Ne,Ge){return Ge.tileID.overscaledZ-Ne.tileID.overscaledZ||(Ne.tileID.isLessThan(Ge.tileID)?-1:1)}))}var Rt=this.crossTileSymbolIndex.addLayer(Dt,ot[Dt.source],Ge.center.lng);at=at||Rt}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((nt=nt||this._layerOrderChanged||0===tt)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Ne.browser.now(),Ge.zoom))&&(this.pauseablePlacement=new Ae(Ge,this._order,nt,Qe,tt,rt,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,ot),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Ne.browser.now()),it=!0),at&&this.pauseablePlacement.placement.setStale()),it||at)for(var Zt=0,er=this._order;Zt<er.length;Zt+=1){var dr=this._layers[er[Zt]];"symbol"===dr.type&&this.placement.updateLayerOpacities(dr,ot[dr.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Ne.browser.now())},i.prototype._releaseSymbolFadeTiles=function(){for(var Ne in this.sourceCaches)this.sourceCaches[Ne].releaseSymbolFadeTiles()},i.prototype.getImages=function(Ne,Ge,Qe){this.imageManager.getImages(Ge.icons,Qe),this._updateTilesForChangedImages();var tt=this.sourceCaches[Ge.source];tt&&tt.setDependencies(Ge.tileID.key,Ge.type,Ge.icons)},i.prototype.getGlyphs=function(Ne,Ge,Qe){this.glyphManager.getGlyphs(Ge.stacks,Qe)},i.prototype.getResource=function(Ge,Qe,tt){return Ne.makeRequest(Qe,tt)},i}(Ne.Evented);js.getSourceType=function(Ne){return kn[Ne]},js.setSourceType=function(Ne,Ge){kn[Ne]=Ge},js.registerForPluginStateChange=Ne.registerForPluginStateChange;var Zs=Ne.createLayout([{name:"a_pos",type:"Int16",components:2}]),Ks=gi("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}"),al=gi("uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),il=gi("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),fl=gi("varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}"),dl=gi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),hl=gi("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}"),gl=gi("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),ml=gi("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),vl=gi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),xl=gi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),bl=gi("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_FragColor=color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);}"),_l=gi("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),wl=gi("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}"),kl=gi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}"),Al=gi("varying vec4 v_color;void main() {gl_FragColor=v_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}"),Sl=gi("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0\n? a_pos\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}"),Il=gi("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform float u_maxzoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggeration=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/ pow(2.0,(u_zoom-u_maxzoom)*exaggeration+19.2562-u_zoom);gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Bl=gi("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;\n#define PI 3.141592653589793\nvoid main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),Xl=gi("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),ec=gi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,vec2(v_lineprogress,0.5));gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define MAX_LINE_DISTANCE 32767.0\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_lineprogress;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_lineprogress=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0/MAX_LINE_DISTANCE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}"),tc=gi("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}"),rc=gi("uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\n#define LINE_DISTANCE_SCALE 2.0\nattribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}"),nc=gi("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),ac=gi("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}"),ic=gi("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),oc=gi("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}");function gi(Ne,Ge){var Qe=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,tt={};return{fragmentSource:Ne=Ne.replace(Qe,(function(Ne,Ge,Qe,rt,nt){return tt[nt]=!0,"define"===Ge?"\n#ifndef HAS_UNIFORM_u_"+nt+"\nvarying "+Qe+" "+rt+" "+nt+";\n#else\nuniform "+Qe+" "+rt+" u_"+nt+";\n#endif\n":"\n#ifdef HAS_UNIFORM_u_"+nt+"\n    "+Qe+" "+rt+" "+nt+" = u_"+nt+";\n#endif\n"})),vertexSource:Ge=Ge.replace(Qe,(function(Ne,Ge,Qe,rt,nt){var at="float"===rt?"vec2":"vec4",it=nt.match(/color/)?"color":at;return tt[nt]?"define"===Ge?"\n#ifndef HAS_UNIFORM_u_"+nt+"\nuniform lowp float u_"+nt+"_t;\nattribute "+Qe+" "+at+" a_"+nt+";\nvarying "+Qe+" "+rt+" "+nt+";\n#else\nuniform "+Qe+" "+rt+" u_"+nt+";\n#endif\n":"vec4"===it?"\n#ifndef HAS_UNIFORM_u_"+nt+"\n    "+nt+" = a_"+nt+";\n#else\n    "+Qe+" "+rt+" "+nt+" = u_"+nt+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+nt+"\n    "+nt+" = unpack_mix_"+it+"(a_"+nt+", u_"+nt+"_t);\n#else\n    "+Qe+" "+rt+" "+nt+" = u_"+nt+";\n#endif\n":"define"===Ge?"\n#ifndef HAS_UNIFORM_u_"+nt+"\nuniform lowp float u_"+nt+"_t;\nattribute "+Qe+" "+at+" a_"+nt+";\n#else\nuniform "+Qe+" "+rt+" u_"+nt+";\n#endif\n":"vec4"===it?"\n#ifndef HAS_UNIFORM_u_"+nt+"\n    "+Qe+" "+rt+" "+nt+" = a_"+nt+";\n#else\n    "+Qe+" "+rt+" "+nt+" = u_"+nt+";\n#endif\n":"\n#ifndef HAS_UNIFORM_u_"+nt+"\n    "+Qe+" "+rt+" "+nt+" = unpack_mix_"+it+"(a_"+nt+", u_"+nt+"_t);\n#else\n    "+Qe+" "+rt+" "+nt+" = u_"+nt+";\n#endif\n"}))}}var sc=Object.freeze({__proto__:null,prelude:Ks,background:al,backgroundPattern:il,circle:fl,clippingMask:dl,heatmap:hl,heatmapTexture:gl,collisionBox:ml,collisionCircle:vl,debug:xl,fill:bl,fillOutline:_l,fillOutlinePattern:wl,fillPattern:kl,fillExtrusion:Al,fillExtrusionPattern:Sl,hillshadePrepare:Il,hillshade:Bl,line:Xl,lineGradient:ec,linePattern:tc,lineSDF:rc,raster:nc,symbolIcon:ac,symbolSDF:ic,symbolTextAndIcon:oc}),yi=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};yi.prototype.bind=function(Ne,Ge,Qe,tt,rt,nt,at,it){this.context=Ne;for(var ot=this.boundPaintVertexBuffers.length!==tt.length,dt=0;!ot&&dt<tt.length;dt++)this.boundPaintVertexBuffers[dt]!==tt[dt]&&(ot=!0);Ne.extVertexArrayObject&&this.vao&&this.boundProgram===Ge&&this.boundLayoutVertexBuffer===Qe&&!ot&&this.boundIndexBuffer===rt&&this.boundVertexOffset===nt&&this.boundDynamicVertexBuffer===at&&this.boundDynamicVertexBuffer2===it?(Ne.bindVertexArrayOES.set(this.vao),at&&at.bind(),rt&&rt.dynamicDraw&&rt.bind(),it&&it.bind()):this.freshBind(Ge,Qe,tt,rt,nt,at,it)},yi.prototype.freshBind=function(Ne,Ge,Qe,tt,rt,nt,at){var it,ot=Ne.numAttributes,dt=this.context,ht=dt.gl;if(dt.extVertexArrayObject)this.vao&&this.destroy(),this.vao=dt.extVertexArrayObject.createVertexArrayOES(),dt.bindVertexArrayOES.set(this.vao),it=0,this.boundProgram=Ne,this.boundLayoutVertexBuffer=Ge,this.boundPaintVertexBuffers=Qe,this.boundIndexBuffer=tt,this.boundVertexOffset=rt,this.boundDynamicVertexBuffer=nt,this.boundDynamicVertexBuffer2=at;else{it=dt.currentNumAttributes||0;for(var Dt=ot;Dt<it;Dt++)ht.disableVertexAttribArray(Dt)}Ge.enableAttributes(ht,Ne);for(var Ot=0,Rt=Qe;Ot<Rt.length;Ot+=1)Rt[Ot].enableAttributes(ht,Ne);nt&&nt.enableAttributes(ht,Ne),at&&at.enableAttributes(ht,Ne),Ge.bind(),Ge.setVertexAttribPointers(ht,Ne,rt);for(var Zt=0,er=Qe;Zt<er.length;Zt+=1){var dr=er[Zt];dr.bind(),dr.setVertexAttribPointers(ht,Ne,rt)}nt&&(nt.bind(),nt.setVertexAttribPointers(ht,Ne,rt)),tt&&tt.bind(),at&&(at.bind(),at.setVertexAttribPointers(ht,Ne,rt)),dt.currentNumAttributes=ot},yi.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var xi=function(Ne,Ge,Qe,tt,rt){var nt=Ne.gl;this.program=nt.createProgram();var at=Qe?Qe.defines():[];rt&&at.push("#define OVERDRAW_INSPECTOR;");var it=at.concat(Ks.fragmentSource,Ge.fragmentSource).join("\n"),ot=at.concat(Ks.vertexSource,Ge.vertexSource).join("\n"),dt=nt.createShader(nt.FRAGMENT_SHADER);if(nt.isContextLost())this.failedToCreate=!0;else{nt.shaderSource(dt,it),nt.compileShader(dt),nt.attachShader(this.program,dt);var ht=nt.createShader(nt.VERTEX_SHADER);if(nt.isContextLost())this.failedToCreate=!0;else{nt.shaderSource(ht,ot),nt.compileShader(ht),nt.attachShader(this.program,ht);for(var Dt=Qe?Qe.layoutAttributes:[],Ot=0;Ot<Dt.length;Ot++)nt.bindAttribLocation(this.program,Ot,Dt[Ot].name);nt.linkProgram(this.program),nt.deleteShader(ht),nt.deleteShader(dt),this.numAttributes=nt.getProgramParameter(this.program,nt.ACTIVE_ATTRIBUTES),this.attributes={};for(var Rt={},Zt=0;Zt<this.numAttributes;Zt++){var er=nt.getActiveAttrib(this.program,Zt);er&&(this.attributes[er.name]=nt.getAttribLocation(this.program,er.name))}for(var dr=nt.getProgramParameter(this.program,nt.ACTIVE_UNIFORMS),mr=0;mr<dr;mr++){var xr=nt.getActiveUniform(this.program,mr);xr&&(Rt[xr.name]=nt.getUniformLocation(this.program,xr.name))}this.fixedUniforms=tt(Ne,Rt),this.binderUniforms=Qe?Qe.getUniforms(Ne,Rt):[]}}};function bi(Ne,Ge,Qe){var tt=1/pe(Qe,1,Ge.transform.tileZoom),rt=Math.pow(2,Qe.tileID.overscaledZ),nt=Qe.tileSize*Math.pow(2,Ge.transform.tileZoom)/rt,at=nt*(Qe.tileID.canonical.x+Qe.tileID.wrap*rt),it=nt*Qe.tileID.canonical.y;return{u_image:0,u_texsize:Qe.imageAtlasTexture.size,u_scale:[tt,Ne.fromScale,Ne.toScale],u_fade:Ne.t,u_pixel_coord_upper:[at>>16,it>>16],u_pixel_coord_lower:[65535&at,65535&it]}}xi.prototype.draw=function(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt,er){var dr,mr=Ne.gl;if(!this.failedToCreate){for(var xr in Ne.program.set(this.program),Ne.setDepthMode(Qe),Ne.setStencilMode(tt),Ne.setColorMode(rt),Ne.setCullFace(nt),this.fixedUniforms)this.fixedUniforms[xr].set(at[xr]);Rt&&Rt.setUniforms(Ne,this.binderUniforms,Dt,{zoom:Ot});for(var br=(dr={},dr[mr.LINES]=2,dr[mr.TRIANGLES]=3,dr[mr.LINE_STRIP]=1,dr)[Ge],Ar=0,en=ht.get();Ar<en.length;Ar+=1){var mn=en[Ar],xn=mn.vaos||(mn.vaos={});(xn[it]||(xn[it]=new yi)).bind(Ne,this,ot,Rt?Rt.getPaintVertexBuffers():[],dt,mn.vertexOffset,Zt,er),mr.drawElements(Ge,mn.primitiveLength*br,mr.UNSIGNED_SHORT,mn.primitiveOffset*br*2)}}};var wi=function(Ge,Qe,tt,rt){var nt=Qe.style.light,at=nt.properties.get("position"),it=[at.x,at.y,at.z],ot=Ne.create$1();"viewport"===nt.properties.get("anchor")&&Ne.fromRotation(ot,-Qe.transform.angle),Ne.transformMat3(it,it,ot);var dt=nt.properties.get("color");return{u_matrix:Ge,u_lightpos:it,u_lightintensity:nt.properties.get("intensity"),u_lightcolor:[dt.r,dt.g,dt.b],u_vertical_gradient:+tt,u_opacity:rt}},Ti=function(Ge,Qe,tt,rt,nt,at,it){return Ne.extend(wi(Ge,Qe,tt,rt),bi(at,Qe,it),{u_height_factor:-Math.pow(2,nt.overscaledZ)/it.tileSize/8})},Ei=function(Ne){return{u_matrix:Ne}},Ii=function(Ge,Qe,tt,rt){return Ne.extend(Ei(Ge),bi(tt,Qe,rt))},Pi=function(Ne,Ge){return{u_matrix:Ne,u_world:Ge}},Si=function(Ge,Qe,tt,rt,nt){return Ne.extend(Ii(Ge,Qe,tt,rt),{u_world:nt})},Ci=function(Ge,Qe,tt,rt){var nt,at,it=Ge.transform;if("map"===rt.paint.get("circle-pitch-alignment")){var ot=pe(tt,1,it.zoom);nt=!0,at=[ot,ot]}else nt=!1,at=it.pixelsToGLUnits;return{u_camera_to_center_distance:it.cameraToCenterDistance,u_scale_with_map:+("map"===rt.paint.get("circle-pitch-scale")),u_matrix:Ge.translatePosMatrix(Qe.posMatrix,tt,rt.paint.get("circle-translate"),rt.paint.get("circle-translate-anchor")),u_pitch_with_map:+nt,u_device_pixel_ratio:Ne.browser.devicePixelRatio,u_extrude_scale:at}},zi=function(Ne,Ge,Qe){var tt=pe(Qe,1,Ge.zoom),rt=Math.pow(2,Ge.zoom-Qe.tileID.overscaledZ),nt=Qe.tileID.overscaleFactor();return{u_matrix:Ne,u_camera_to_center_distance:Ge.cameraToCenterDistance,u_pixels_to_tile_units:tt,u_extrude_scale:[Ge.pixelsToGLUnits[0]/(tt*rt),Ge.pixelsToGLUnits[1]/(tt*rt)],u_overscale_factor:nt}},Di=function(Ne,Ge,Qe){return{u_matrix:Ne,u_inv_matrix:Ge,u_camera_to_center_distance:Qe.cameraToCenterDistance,u_viewport_size:[Qe.width,Qe.height]}},Mi=function(Ne,Ge,Qe){return void 0===Qe&&(Qe=1),{u_matrix:Ne,u_color:Ge,u_overlay:0,u_overlay_scale:Qe}},Li=function(Ne){return{u_matrix:Ne}},Ai=function(Ne,Ge,Qe,tt){return{u_matrix:Ne,u_extrude_scale:pe(Ge,1,Qe),u_intensity:tt}},Ri=function(Ge,Qe,tt){var rt=Ge.transform;return{u_matrix:Ui(Ge,Qe,tt),u_ratio:1/pe(Qe,1,rt.zoom),u_device_pixel_ratio:Ne.browser.devicePixelRatio,u_units_to_pixels:[1/rt.pixelsToGLUnits[0],1/rt.pixelsToGLUnits[1]]}},ki=function(Ge,Qe,tt){return Ne.extend(Ri(Ge,Qe,tt),{u_image:0})},Bi=function(Ge,Qe,tt,rt){var nt=Ge.transform,at=Fi(Qe,nt);return{u_matrix:Ui(Ge,Qe,tt),u_texsize:Qe.imageAtlasTexture.size,u_ratio:1/pe(Qe,1,nt.zoom),u_device_pixel_ratio:Ne.browser.devicePixelRatio,u_image:0,u_scale:[at,rt.fromScale,rt.toScale],u_fade:rt.t,u_units_to_pixels:[1/nt.pixelsToGLUnits[0],1/nt.pixelsToGLUnits[1]]}},Oi=function(Ge,Qe,tt,rt,nt){var at=Ge.lineAtlas,it=Fi(Qe,Ge.transform),ot="round"===tt.layout.get("line-cap"),dt=at.getDash(rt.from,ot),ht=at.getDash(rt.to,ot),Dt=dt.width*nt.fromScale,Ot=ht.width*nt.toScale;return Ne.extend(Ri(Ge,Qe,tt),{u_patternscale_a:[it/Dt,-dt.height/2],u_patternscale_b:[it/Ot,-ht.height/2],u_sdfgamma:at.width/(256*Math.min(Dt,Ot)*Ne.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:dt.y,u_tex_y_b:ht.y,u_mix:nt.t})};function Fi(Ne,Ge){return 1/pe(Ne,1,Ge.tileZoom)}function Ui(Ne,Ge,Qe){return Ne.translatePosMatrix(Ge.tileID.posMatrix,Ge,Qe.paint.get("line-translate"),Qe.paint.get("line-translate-anchor"))}var Ni=function(Ne,Ge,Qe,tt,rt){return{u_matrix:Ne,u_tl_parent:Ge,u_scale_parent:Qe,u_buffer_scale:1,u_fade_t:tt.mix,u_opacity:tt.opacity*rt.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:rt.paint.get("raster-brightness-min"),u_brightness_high:rt.paint.get("raster-brightness-max"),u_saturation_factor:(at=rt.paint.get("raster-saturation"),at>0?1-1/(1.001-at):-at),u_contrast_factor:(nt=rt.paint.get("raster-contrast"),nt>0?1/(1-nt):1+nt),u_spin_weights:Zi(rt.paint.get("raster-hue-rotate"))};var nt,at};function Zi(Ne){Ne*=Math.PI/180;var Ge=Math.sin(Ne),Qe=Math.cos(Ne);return[(2*Qe+1)/3,(-Math.sqrt(3)*Ge-Qe+1)/3,(Math.sqrt(3)*Ge-Qe+1)/3]}var lc,qi=function(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt){var ht=rt.transform;return{u_is_size_zoom_constant:+("constant"===Ne||"source"===Ne),u_is_size_feature_constant:+("constant"===Ne||"camera"===Ne),u_size_t:Ge?Ge.uSizeT:0,u_size:Ge?Ge.uSize:0,u_camera_to_center_distance:ht.cameraToCenterDistance,u_pitch:ht.pitch/360*2*Math.PI,u_rotate_symbol:+Qe,u_aspect_ratio:ht.width/ht.height,u_fade_change:rt.options.fadeDuration?rt.symbolFadeChange:1,u_matrix:nt,u_label_plane_matrix:at,u_coord_matrix:it,u_is_text:+ot,u_pitch_with_map:+tt,u_texsize:dt,u_texture:0}},Vi=function(Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt){var Ot=nt.transform;return Ne.extend(qi(Ge,Qe,tt,rt,nt,at,it,ot,dt,ht),{u_gamma_scale:rt?Math.cos(Ot._pitch)*Ot.cameraToCenterDistance:1,u_device_pixel_ratio:Ne.browser.devicePixelRatio,u_is_halo:+Dt})},Gi=function(Ge,Qe,tt,rt,nt,at,it,ot,dt,ht){return Ne.extend(Vi(Ge,Qe,tt,rt,nt,at,it,ot,!0,dt,!0),{u_texsize_icon:ht,u_texture_icon:1})},Wi=function(Ne,Ge,Qe){return{u_matrix:Ne,u_opacity:Ge,u_color:Qe}},Xi=function(Ge,Qe,tt,rt,nt,at){return Ne.extend(function(Ne,Ge,Qe,tt){var rt=Qe.imageManager.getPattern(Ne.from.toString()),nt=Qe.imageManager.getPattern(Ne.to.toString()),at=Qe.imageManager.getPixelSize(),it=at.width,ot=at.height,dt=Math.pow(2,tt.tileID.overscaledZ),ht=tt.tileSize*Math.pow(2,Qe.transform.tileZoom)/dt,Dt=ht*(tt.tileID.canonical.x+tt.tileID.wrap*dt),Ot=ht*tt.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:rt.tl,u_pattern_br_a:rt.br,u_pattern_tl_b:nt.tl,u_pattern_br_b:nt.br,u_texsize:[it,ot],u_mix:Ge.t,u_pattern_size_a:rt.displaySize,u_pattern_size_b:nt.displaySize,u_scale_a:Ge.fromScale,u_scale_b:Ge.toScale,u_tile_units_to_pixels:1/pe(tt,1,Qe.transform.tileZoom),u_pixel_coord_upper:[Dt>>16,Ot>>16],u_pixel_coord_lower:[65535&Dt,65535&Ot]}}(rt,at,tt,nt),{u_matrix:Ge,u_opacity:Qe})},cc={fillExtrusion:function(Ge,Qe){return{u_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_matrix),u_lightpos:new Ne.Uniform3f(Ge,Qe.u_lightpos),u_lightintensity:new Ne.Uniform1f(Ge,Qe.u_lightintensity),u_lightcolor:new Ne.Uniform3f(Ge,Qe.u_lightcolor),u_vertical_gradient:new Ne.Uniform1f(Ge,Qe.u_vertical_gradient),u_opacity:new Ne.Uniform1f(Ge,Qe.u_opacity)}},fillExtrusionPattern:function(Ge,Qe){return{u_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_matrix),u_lightpos:new Ne.Uniform3f(Ge,Qe.u_lightpos),u_lightintensity:new Ne.Uniform1f(Ge,Qe.u_lightintensity),u_lightcolor:new Ne.Uniform3f(Ge,Qe.u_lightcolor),u_vertical_gradient:new Ne.Uniform1f(Ge,Qe.u_vertical_gradient),u_height_factor:new Ne.Uniform1f(Ge,Qe.u_height_factor),u_image:new Ne.Uniform1i(Ge,Qe.u_image),u_texsize:new Ne.Uniform2f(Ge,Qe.u_texsize),u_pixel_coord_upper:new Ne.Uniform2f(Ge,Qe.u_pixel_coord_upper),u_pixel_coord_lower:new Ne.Uniform2f(Ge,Qe.u_pixel_coord_lower),u_scale:new Ne.Uniform3f(Ge,Qe.u_scale),u_fade:new Ne.Uniform1f(Ge,Qe.u_fade),u_opacity:new Ne.Uniform1f(Ge,Qe.u_opacity)}},fill:function(Ge,Qe){return{u_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_matrix)}},fillPattern:function(Ge,Qe){return{u_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_matrix),u_image:new Ne.Uniform1i(Ge,Qe.u_image),u_texsize:new Ne.Uniform2f(Ge,Qe.u_texsize),u_pixel_coord_upper:new Ne.Uniform2f(Ge,Qe.u_pixel_coord_upper),u_pixel_coord_lower:new Ne.Uniform2f(Ge,Qe.u_pixel_coord_lower),u_scale:new Ne.Uniform3f(Ge,Qe.u_scale),u_fade:new Ne.Uniform1f(Ge,Qe.u_fade)}},fillOutline:function(Ge,Qe){return{u_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_matrix),u_world:new Ne.Uniform2f(Ge,Qe.u_world)}},fillOutlinePattern:function(Ge,Qe){return{u_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_matrix),u_world:new Ne.Uniform2f(Ge,Qe.u_world),u_image:new Ne.Uniform1i(Ge,Qe.u_image),u_texsize:new Ne.Uniform2f(Ge,Qe.u_texsize),u_pixel_coord_upper:new Ne.Uniform2f(Ge,Qe.u_pixel_coord_upper),u_pixel_coord_lower:new Ne.Uniform2f(Ge,Qe.u_pixel_coord_lower),u_scale:new Ne.Uniform3f(Ge,Qe.u_scale),u_fade:new Ne.Uniform1f(Ge,Qe.u_fade)}},circle:function(Ge,Qe){return{u_camera_to_center_distance:new Ne.Uniform1f(Ge,Qe.u_camera_to_center_distance),u_scale_with_map:new Ne.Uniform1i(Ge,Qe.u_scale_with_map),u_pitch_with_map:new Ne.Uniform1i(Ge,Qe.u_pitch_with_map),u_extrude_scale:new Ne.Uniform2f(Ge,Qe.u_extrude_scale),u_device_pixel_ratio:new Ne.Uniform1f(Ge,Qe.u_device_pixel_ratio),u_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_matrix)}},collisionBox:function(Ge,Qe){return{u_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_matrix),u_camera_to_center_distance:new Ne.Uniform1f(Ge,Qe.u_camera_to_center_distance),u_pixels_to_tile_units:new Ne.Uniform1f(Ge,Qe.u_pixels_to_tile_units),u_extrude_scale:new Ne.Uniform2f(Ge,Qe.u_extrude_scale),u_overscale_factor:new Ne.Uniform1f(Ge,Qe.u_overscale_factor)}},collisionCircle:function(Ge,Qe){return{u_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_matrix),u_inv_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_inv_matrix),u_camera_to_center_distance:new Ne.Uniform1f(Ge,Qe.u_camera_to_center_distance),u_viewport_size:new Ne.Uniform2f(Ge,Qe.u_viewport_size)}},debug:function(Ge,Qe){return{u_color:new Ne.UniformColor(Ge,Qe.u_color),u_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_matrix),u_overlay:new Ne.Uniform1i(Ge,Qe.u_overlay),u_overlay_scale:new Ne.Uniform1f(Ge,Qe.u_overlay_scale)}},clippingMask:function(Ge,Qe){return{u_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_matrix)}},heatmap:function(Ge,Qe){return{u_extrude_scale:new Ne.Uniform1f(Ge,Qe.u_extrude_scale),u_intensity:new Ne.Uniform1f(Ge,Qe.u_intensity),u_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_matrix)}},heatmapTexture:function(Ge,Qe){return{u_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_matrix),u_world:new Ne.Uniform2f(Ge,Qe.u_world),u_image:new Ne.Uniform1i(Ge,Qe.u_image),u_color_ramp:new Ne.Uniform1i(Ge,Qe.u_color_ramp),u_opacity:new Ne.Uniform1f(Ge,Qe.u_opacity)}},hillshade:function(Ge,Qe){return{u_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_matrix),u_image:new Ne.Uniform1i(Ge,Qe.u_image),u_latrange:new Ne.Uniform2f(Ge,Qe.u_latrange),u_light:new Ne.Uniform2f(Ge,Qe.u_light),u_shadow:new Ne.UniformColor(Ge,Qe.u_shadow),u_highlight:new Ne.UniformColor(Ge,Qe.u_highlight),u_accent:new Ne.UniformColor(Ge,Qe.u_accent)}},hillshadePrepare:function(Ge,Qe){return{u_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_matrix),u_image:new Ne.Uniform1i(Ge,Qe.u_image),u_dimension:new Ne.Uniform2f(Ge,Qe.u_dimension),u_zoom:new Ne.Uniform1f(Ge,Qe.u_zoom),u_maxzoom:new Ne.Uniform1f(Ge,Qe.u_maxzoom),u_unpack:new Ne.Uniform4f(Ge,Qe.u_unpack)}},line:function(Ge,Qe){return{u_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_matrix),u_ratio:new Ne.Uniform1f(Ge,Qe.u_ratio),u_device_pixel_ratio:new Ne.Uniform1f(Ge,Qe.u_device_pixel_ratio),u_units_to_pixels:new Ne.Uniform2f(Ge,Qe.u_units_to_pixels)}},lineGradient:function(Ge,Qe){return{u_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_matrix),u_ratio:new Ne.Uniform1f(Ge,Qe.u_ratio),u_device_pixel_ratio:new Ne.Uniform1f(Ge,Qe.u_device_pixel_ratio),u_units_to_pixels:new Ne.Uniform2f(Ge,Qe.u_units_to_pixels),u_image:new Ne.Uniform1i(Ge,Qe.u_image)}},linePattern:function(Ge,Qe){return{u_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_matrix),u_texsize:new Ne.Uniform2f(Ge,Qe.u_texsize),u_ratio:new Ne.Uniform1f(Ge,Qe.u_ratio),u_device_pixel_ratio:new Ne.Uniform1f(Ge,Qe.u_device_pixel_ratio),u_image:new Ne.Uniform1i(Ge,Qe.u_image),u_units_to_pixels:new Ne.Uniform2f(Ge,Qe.u_units_to_pixels),u_scale:new Ne.Uniform3f(Ge,Qe.u_scale),u_fade:new Ne.Uniform1f(Ge,Qe.u_fade)}},lineSDF:function(Ge,Qe){return{u_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_matrix),u_ratio:new Ne.Uniform1f(Ge,Qe.u_ratio),u_device_pixel_ratio:new Ne.Uniform1f(Ge,Qe.u_device_pixel_ratio),u_units_to_pixels:new Ne.Uniform2f(Ge,Qe.u_units_to_pixels),u_patternscale_a:new Ne.Uniform2f(Ge,Qe.u_patternscale_a),u_patternscale_b:new Ne.Uniform2f(Ge,Qe.u_patternscale_b),u_sdfgamma:new Ne.Uniform1f(Ge,Qe.u_sdfgamma),u_image:new Ne.Uniform1i(Ge,Qe.u_image),u_tex_y_a:new Ne.Uniform1f(Ge,Qe.u_tex_y_a),u_tex_y_b:new Ne.Uniform1f(Ge,Qe.u_tex_y_b),u_mix:new Ne.Uniform1f(Ge,Qe.u_mix)}},raster:function(Ge,Qe){return{u_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_matrix),u_tl_parent:new Ne.Uniform2f(Ge,Qe.u_tl_parent),u_scale_parent:new Ne.Uniform1f(Ge,Qe.u_scale_parent),u_buffer_scale:new Ne.Uniform1f(Ge,Qe.u_buffer_scale),u_fade_t:new Ne.Uniform1f(Ge,Qe.u_fade_t),u_opacity:new Ne.Uniform1f(Ge,Qe.u_opacity),u_image0:new Ne.Uniform1i(Ge,Qe.u_image0),u_image1:new Ne.Uniform1i(Ge,Qe.u_image1),u_brightness_low:new Ne.Uniform1f(Ge,Qe.u_brightness_low),u_brightness_high:new Ne.Uniform1f(Ge,Qe.u_brightness_high),u_saturation_factor:new Ne.Uniform1f(Ge,Qe.u_saturation_factor),u_contrast_factor:new Ne.Uniform1f(Ge,Qe.u_contrast_factor),u_spin_weights:new Ne.Uniform3f(Ge,Qe.u_spin_weights)}},symbolIcon:function(Ge,Qe){return{u_is_size_zoom_constant:new Ne.Uniform1i(Ge,Qe.u_is_size_zoom_constant),u_is_size_feature_constant:new Ne.Uniform1i(Ge,Qe.u_is_size_feature_constant),u_size_t:new Ne.Uniform1f(Ge,Qe.u_size_t),u_size:new Ne.Uniform1f(Ge,Qe.u_size),u_camera_to_center_distance:new Ne.Uniform1f(Ge,Qe.u_camera_to_center_distance),u_pitch:new Ne.Uniform1f(Ge,Qe.u_pitch),u_rotate_symbol:new Ne.Uniform1i(Ge,Qe.u_rotate_symbol),u_aspect_ratio:new Ne.Uniform1f(Ge,Qe.u_aspect_ratio),u_fade_change:new Ne.Uniform1f(Ge,Qe.u_fade_change),u_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_matrix),u_label_plane_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_label_plane_matrix),u_coord_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_coord_matrix),u_is_text:new Ne.Uniform1i(Ge,Qe.u_is_text),u_pitch_with_map:new Ne.Uniform1i(Ge,Qe.u_pitch_with_map),u_texsize:new Ne.Uniform2f(Ge,Qe.u_texsize),u_texture:new Ne.Uniform1i(Ge,Qe.u_texture)}},symbolSDF:function(Ge,Qe){return{u_is_size_zoom_constant:new Ne.Uniform1i(Ge,Qe.u_is_size_zoom_constant),u_is_size_feature_constant:new Ne.Uniform1i(Ge,Qe.u_is_size_feature_constant),u_size_t:new Ne.Uniform1f(Ge,Qe.u_size_t),u_size:new Ne.Uniform1f(Ge,Qe.u_size),u_camera_to_center_distance:new Ne.Uniform1f(Ge,Qe.u_camera_to_center_distance),u_pitch:new Ne.Uniform1f(Ge,Qe.u_pitch),u_rotate_symbol:new Ne.Uniform1i(Ge,Qe.u_rotate_symbol),u_aspect_ratio:new Ne.Uniform1f(Ge,Qe.u_aspect_ratio),u_fade_change:new Ne.Uniform1f(Ge,Qe.u_fade_change),u_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_matrix),u_label_plane_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_label_plane_matrix),u_coord_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_coord_matrix),u_is_text:new Ne.Uniform1i(Ge,Qe.u_is_text),u_pitch_with_map:new Ne.Uniform1i(Ge,Qe.u_pitch_with_map),u_texsize:new Ne.Uniform2f(Ge,Qe.u_texsize),u_texture:new Ne.Uniform1i(Ge,Qe.u_texture),u_gamma_scale:new Ne.Uniform1f(Ge,Qe.u_gamma_scale),u_device_pixel_ratio:new Ne.Uniform1f(Ge,Qe.u_device_pixel_ratio),u_is_halo:new Ne.Uniform1i(Ge,Qe.u_is_halo)}},symbolTextAndIcon:function(Ge,Qe){return{u_is_size_zoom_constant:new Ne.Uniform1i(Ge,Qe.u_is_size_zoom_constant),u_is_size_feature_constant:new Ne.Uniform1i(Ge,Qe.u_is_size_feature_constant),u_size_t:new Ne.Uniform1f(Ge,Qe.u_size_t),u_size:new Ne.Uniform1f(Ge,Qe.u_size),u_camera_to_center_distance:new Ne.Uniform1f(Ge,Qe.u_camera_to_center_distance),u_pitch:new Ne.Uniform1f(Ge,Qe.u_pitch),u_rotate_symbol:new Ne.Uniform1i(Ge,Qe.u_rotate_symbol),u_aspect_ratio:new Ne.Uniform1f(Ge,Qe.u_aspect_ratio),u_fade_change:new Ne.Uniform1f(Ge,Qe.u_fade_change),u_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_matrix),u_label_plane_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_label_plane_matrix),u_coord_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_coord_matrix),u_is_text:new Ne.Uniform1i(Ge,Qe.u_is_text),u_pitch_with_map:new Ne.Uniform1i(Ge,Qe.u_pitch_with_map),u_texsize:new Ne.Uniform2f(Ge,Qe.u_texsize),u_texsize_icon:new Ne.Uniform2f(Ge,Qe.u_texsize_icon),u_texture:new Ne.Uniform1i(Ge,Qe.u_texture),u_texture_icon:new Ne.Uniform1i(Ge,Qe.u_texture_icon),u_gamma_scale:new Ne.Uniform1f(Ge,Qe.u_gamma_scale),u_device_pixel_ratio:new Ne.Uniform1f(Ge,Qe.u_device_pixel_ratio),u_is_halo:new Ne.Uniform1i(Ge,Qe.u_is_halo)}},background:function(Ge,Qe){return{u_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_matrix),u_opacity:new Ne.Uniform1f(Ge,Qe.u_opacity),u_color:new Ne.UniformColor(Ge,Qe.u_color)}},backgroundPattern:function(Ge,Qe){return{u_matrix:new Ne.UniformMatrix4f(Ge,Qe.u_matrix),u_opacity:new Ne.Uniform1f(Ge,Qe.u_opacity),u_image:new Ne.Uniform1i(Ge,Qe.u_image),u_pattern_tl_a:new Ne.Uniform2f(Ge,Qe.u_pattern_tl_a),u_pattern_br_a:new Ne.Uniform2f(Ge,Qe.u_pattern_br_a),u_pattern_tl_b:new Ne.Uniform2f(Ge,Qe.u_pattern_tl_b),u_pattern_br_b:new Ne.Uniform2f(Ge,Qe.u_pattern_br_b),u_texsize:new Ne.Uniform2f(Ge,Qe.u_texsize),u_mix:new Ne.Uniform1f(Ge,Qe.u_mix),u_pattern_size_a:new Ne.Uniform2f(Ge,Qe.u_pattern_size_a),u_pattern_size_b:new Ne.Uniform2f(Ge,Qe.u_pattern_size_b),u_scale_a:new Ne.Uniform1f(Ge,Qe.u_scale_a),u_scale_b:new Ne.Uniform1f(Ge,Qe.u_scale_b),u_pixel_coord_upper:new Ne.Uniform2f(Ge,Qe.u_pixel_coord_upper),u_pixel_coord_lower:new Ne.Uniform2f(Ge,Qe.u_pixel_coord_lower),u_tile_units_to_pixels:new Ne.Uniform1f(Ge,Qe.u_tile_units_to_pixels)}}};function Ki(Ge,Qe,tt,rt,nt,at,it){for(var ot=Ge.context,dt=ot.gl,ht=Ge.useProgram("collisionBox"),Dt=[],Ot=0,Rt=0,Zt=0;Zt<rt.length;Zt++){var er=rt[Zt],dr=Qe.getTile(er),mr=dr.getBucket(tt);if(mr){var xr=er.posMatrix;0===nt[0]&&0===nt[1]||(xr=Ge.translatePosMatrix(er.posMatrix,dr,nt,at));var br=it?mr.textCollisionBox:mr.iconCollisionBox,Ar=mr.collisionCircleArray;if(Ar.length>0){var en=Ne.create(),mn=xr;Ne.mul(en,mr.placementInvProjMatrix,Ge.transform.glCoordMatrix),Ne.mul(en,en,mr.placementViewportMatrix),Dt.push({circleArray:Ar,circleOffset:Rt,transform:mn,invTransform:en}),Rt=Ot+=Ar.length/4}br&&ht.draw(ot,dt.LINES,It.disabled,Pt.disabled,Ge.colorModeForRenderPass(),Ct.disabled,zi(xr,Ge.transform,dr),tt.id,br.layoutVertexBuffer,br.indexBuffer,br.segments,null,Ge.transform.zoom,null,null,br.collisionVertexBuffer)}}if(it&&Dt.length){var xn=Ge.useProgram("collisionCircle"),kn=new Ne.StructArrayLayout2f1f2i16;kn.resize(4*Ot),kn._trim();for(var Cn=0,En=0,Pn=Dt;En<Pn.length;En+=1)for(var Dn=Pn[En],In=0;In<Dn.circleArray.length/4;In++){var zn=4*In,Bn=Dn.circleArray[zn+0],Vn=Dn.circleArray[zn+1],Hn=Dn.circleArray[zn+2],qn=Dn.circleArray[zn+3];kn.emplace(Cn++,Bn,Vn,Hn,qn,0),kn.emplace(Cn++,Bn,Vn,Hn,qn,1),kn.emplace(Cn++,Bn,Vn,Hn,qn,2),kn.emplace(Cn++,Bn,Vn,Hn,qn,3)}(!lc||lc.length<2*Ot)&&(lc=function(Ge){var Qe=2*Ge,tt=new Ne.StructArrayLayout3ui6;tt.resize(Qe),tt._trim();for(var rt=0;rt<Qe;rt++){var nt=6*rt;tt.uint16[nt+0]=4*rt+0,tt.uint16[nt+1]=4*rt+1,tt.uint16[nt+2]=4*rt+2,tt.uint16[nt+3]=4*rt+2,tt.uint16[nt+4]=4*rt+3,tt.uint16[nt+5]=4*rt+0}return tt}(Ot));for(var Yn=ot.createIndexBuffer(lc,!0),$n=ot.createVertexBuffer(kn,Ne.collisionCircleLayout.members,!0),ra=0,oa=Dt;ra<oa.length;ra+=1){var pa=oa[ra],ga=Di(pa.transform,pa.invTransform,Ge.transform);xn.draw(ot,dt.TRIANGLES,It.disabled,Pt.disabled,Ge.colorModeForRenderPass(),Ct.disabled,ga,tt.id,$n,Yn,Ne.SegmentVector.simpleSegment(0,2*pa.circleOffset,pa.circleArray.length,pa.circleArray.length/2),null,Ge.transform.zoom,null,null,null)}$n.destroy(),Yn.destroy()}}var uc=Ne.identity(new Float32Array(16));function Ji(Ge,Qe,tt,rt,nt,at){var it=Ne.getAnchorAlignment(Ge),ot=-(it.horizontalAlign-.5)*Qe,dt=-(it.verticalAlign-.5)*tt,ht=Ne.evaluateVariableOffset(Ge,rt);return new Ne.Point((ot/nt+ht[0])*at,(dt/nt+ht[1])*at)}function Qi(Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt){var Ot=Ge.text.placedSymbolArray,Rt=Ge.text.dynamicLayoutVertexArray,Zt=Ge.icon.dynamicLayoutVertexArray,er={};Rt.clear();for(var dr=0;dr<Ot.length;dr++){var mr=Ot.get(dr),xr=mr.hidden||!mr.crossTileID||Ge.allowVerticalPlacement&&!mr.placedOrientation?null:rt[mr.crossTileID];if(xr){var br=new Ne.Point(mr.anchorX,mr.anchorY),Ar=$t(br,tt?ot:it),en=te(at.cameraToCenterDistance,Ar.signedDistanceFromCamera),mn=nt.evaluateSizeForFeature(Ge.textSizeData,ht,mr)*en/Ne.ONE_EM;tt&&(mn*=Ge.tilePixelRatio/dt);for(var xn=Ji(xr.anchor,xr.width,xr.height,xr.textOffset,xr.textBoxScale,mn),kn=tt?$t(br.add(xn),it).point:Ar.point.add(Qe?xn.rotate(-at.angle):xn),Cn=Ge.allowVerticalPlacement&&mr.placedOrientation===Ne.WritingMode.vertical?Math.PI/2:0,En=0;En<mr.numGlyphs;En++)Ne.addDynamicAttributes(Rt,kn,Cn);Dt&&mr.associatedIconIndex>=0&&(er[mr.associatedIconIndex]={shiftedAnchor:kn,angle:Cn})}else ce(mr.numGlyphs,Rt)}if(Dt){Zt.clear();for(var Pn=Ge.icon.placedSymbolArray,Dn=0;Dn<Pn.length;Dn++){var In=Pn.get(Dn);if(In.hidden)ce(In.numGlyphs,Zt);else{var zn=er[Dn];if(zn)for(var Bn=0;Bn<In.numGlyphs;Bn++)Ne.addDynamicAttributes(Zt,zn.shiftedAnchor,zn.angle);else ce(In.numGlyphs,Zt)}}Ge.icon.dynamicLayoutVertexBuffer.updateData(Zt)}Ge.text.dynamicLayoutVertexBuffer.updateData(Rt)}function $i(Ne,Ge,Qe){return Qe.iconsInText&&Ge?"symbolTextAndIcon":Ne?"symbolSDF":"symbolIcon"}function to(Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt,Ot){for(var Rt=Ge.context,Zt=Rt.gl,er=Ge.transform,dr="map"===ot,mr="map"===dt,xr=dr&&"point"!==tt.layout.get("symbol-placement"),br=dr&&!mr&&!xr,Ar=void 0!==tt.layout.get("symbol-sort-key").constantOr(1),en=Ge.depthModeForSublayer(0,It.ReadOnly),mn=tt.layout.get("text-variable-anchor"),xn=[],kn=0,Cn=rt;kn<Cn.length;kn+=1){var En=Cn[kn],Pn=Qe.getTile(En),Dn=Pn.getBucket(tt);if(Dn){var In=nt?Dn.text:Dn.icon;if(In&&In.segments.get().length){var zn=In.programConfigurations.get(tt.id),Bn=nt||Dn.sdfIcons,Vn=nt?Dn.textSizeData:Dn.iconSizeData,Hn=mr||0!==er.pitch,qn=Ge.useProgram($i(Bn,nt,Dn),zn),Yn=Ne.evaluateSizeForZoom(Vn,er.zoom),$n=void 0,ra=[0,0],oa=void 0,pa=void 0,ga=null,ma=void 0;if(nt)oa=Pn.glyphAtlasTexture,pa=Zt.LINEAR,$n=Pn.glyphAtlasTexture.size,Dn.iconsInText&&(ra=Pn.imageAtlasTexture.size,ga=Pn.imageAtlasTexture,ma=Hn||Ge.options.rotating||Ge.options.zooming||"composite"===Vn.kind||"camera"===Vn.kind?Zt.LINEAR:Zt.NEAREST);else{var _a=1!==tt.layout.get("icon-size").constantOr(0)||Dn.iconsNeedLinear;oa=Pn.imageAtlasTexture,pa=Bn||Ge.options.rotating||Ge.options.zooming||_a||Hn?Zt.LINEAR:Zt.NEAREST,$n=Pn.imageAtlasTexture.size}var Va=pe(Pn,1,Ge.transform.zoom),Wa=Jt(En.posMatrix,mr,dr,Ge.transform,Va),Qa=Qt(En.posMatrix,mr,dr,Ge.transform,Va),ti=mn&&Dn.hasTextData(),ni="none"!==tt.layout.get("icon-text-fit")&&ti&&Dn.hasIconData();xr&&ie(Dn,En.posMatrix,Ge,nt,Wa,Qa,mr,ht);var di=Ge.translatePosMatrix(En.posMatrix,Pn,at,it),ji=xr||nt&&mn||ni?uc:Wa,Hi=Ge.translatePosMatrix(Qa,Pn,at,it,!0),Yi=Bn&&0!==tt.paint.get(nt?"text-halo-width":"icon-halo-width").constantOr(1),uo={program:qn,buffers:In,uniformValues:Bn?Dn.iconsInText?Gi(Vn.kind,Yn,br,mr,Ge,di,ji,Hi,$n,ra):Vi(Vn.kind,Yn,br,mr,Ge,di,ji,Hi,nt,$n,!0):qi(Vn.kind,Yn,br,mr,Ge,di,ji,Hi,nt,$n),atlasTexture:oa,atlasTextureIcon:ga,atlasInterpolation:pa,atlasInterpolationIcon:ma,isSDF:Bn,hasHalo:Yi};if(Ar)for(var go=0,ns=In.segments.get();go<ns.length;go+=1){var as=ns[go];xn.push({segments:new Ne.SegmentVector([as]),sortKey:as.sortKey,state:uo})}else xn.push({segments:In.segments,sortKey:0,state:uo})}}}Ar&&xn.sort((function(Ne,Ge){return Ne.sortKey-Ge.sortKey}));for(var is=0,os=xn;is<os.length;is+=1){var ss=os[is],cs=ss.state;if(Rt.activeTexture.set(Zt.TEXTURE0),cs.atlasTexture.bind(cs.atlasInterpolation,Zt.CLAMP_TO_EDGE),cs.atlasTextureIcon&&(Rt.activeTexture.set(Zt.TEXTURE1),cs.atlasTextureIcon&&cs.atlasTextureIcon.bind(cs.atlasInterpolationIcon,Zt.CLAMP_TO_EDGE)),cs.isSDF){var ds=cs.uniformValues;cs.hasHalo&&(ds.u_is_halo=1,eo(cs.buffers,ss.segments,tt,Ge,cs.program,en,Dt,Ot,ds)),ds.u_is_halo=0}eo(cs.buffers,ss.segments,tt,Ge,cs.program,en,Dt,Ot,cs.uniformValues)}}function eo(Ne,Ge,Qe,tt,rt,nt,at,it,ot){var dt=tt.context;rt.draw(dt,dt.gl.TRIANGLES,nt,at,it,Ct.disabled,ot,Qe.id,Ne.layoutVertexBuffer,Ne.indexBuffer,Ge,Qe.paint,tt.transform.zoom,Ne.programConfigurations.get(Qe.id),Ne.dynamicLayoutVertexBuffer,Ne.opacityVertexBuffer)}function io(Ne,Ge,Qe,tt,rt,nt,at){var it,ot,dt,ht,Dt,Ot=Ne.context.gl,Rt=Qe.paint.get("fill-pattern"),Zt=Rt&&Rt.constantOr(1),er=Qe.getCrossfadeParameters();at?(ot=Zt&&!Qe.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",it=Ot.LINES):(ot=Zt?"fillPattern":"fill",it=Ot.TRIANGLES);for(var dr=0,mr=tt;dr<mr.length;dr+=1){var xr=mr[dr],br=Ge.getTile(xr);if(!Zt||br.patternsLoaded()){var Ar=br.getBucket(Qe);if(Ar){var en=Ar.programConfigurations.get(Qe.id),mn=Ne.useProgram(ot,en);Zt&&(Ne.context.activeTexture.set(Ot.TEXTURE0),br.imageAtlasTexture.bind(Ot.LINEAR,Ot.CLAMP_TO_EDGE),en.updatePaintBuffers(er));var xn=Rt.constantOr(null);if(xn&&br.imageAtlas){var kn=br.imageAtlas,Cn=kn.patternPositions[xn.to.toString()],En=kn.patternPositions[xn.from.toString()];Cn&&En&&en.setConstantPatternPositions(Cn,En)}var Pn=Ne.translatePosMatrix(xr.posMatrix,br,Qe.paint.get("fill-translate"),Qe.paint.get("fill-translate-anchor"));if(at){ht=Ar.indexBuffer2,Dt=Ar.segments2;var Dn=[Ot.drawingBufferWidth,Ot.drawingBufferHeight];dt="fillOutlinePattern"===ot&&Zt?Si(Pn,Ne,er,br,Dn):Pi(Pn,Dn)}else ht=Ar.indexBuffer,Dt=Ar.segments,dt=Zt?Ii(Pn,Ne,er,br):Ei(Pn);mn.draw(Ne.context,it,rt,Ne.stencilModeForClipping(xr),nt,Ct.disabled,dt,Qe.id,Ar.layoutVertexBuffer,ht,Dt,Qe.paint,Ne.transform.zoom,en)}}}}function oo(Ne,Ge,Qe,tt,rt,nt,at){for(var it=Ne.context,ot=it.gl,dt=Qe.paint.get("fill-extrusion-pattern"),ht=dt.constantOr(1),Dt=Qe.getCrossfadeParameters(),Ot=Qe.paint.get("fill-extrusion-opacity"),Rt=0,Zt=tt;Rt<Zt.length;Rt+=1){var er=Zt[Rt],dr=Ge.getTile(er),mr=dr.getBucket(Qe);if(mr){var xr=mr.programConfigurations.get(Qe.id),br=Ne.useProgram(ht?"fillExtrusionPattern":"fillExtrusion",xr);ht&&(Ne.context.activeTexture.set(ot.TEXTURE0),dr.imageAtlasTexture.bind(ot.LINEAR,ot.CLAMP_TO_EDGE),xr.updatePaintBuffers(Dt));var Ar=dt.constantOr(null);if(Ar&&dr.imageAtlas){var en=dr.imageAtlas,mn=en.patternPositions[Ar.to.toString()],xn=en.patternPositions[Ar.from.toString()];mn&&xn&&xr.setConstantPatternPositions(mn,xn)}var kn=Ne.translatePosMatrix(er.posMatrix,dr,Qe.paint.get("fill-extrusion-translate"),Qe.paint.get("fill-extrusion-translate-anchor")),Cn=Qe.paint.get("fill-extrusion-vertical-gradient"),En=ht?Ti(kn,Ne,Cn,Ot,er,Dt,dr):wi(kn,Ne,Cn,Ot);br.draw(it,it.gl.TRIANGLES,rt,nt,at,Ct.backCCW,En,Qe.id,mr.layoutVertexBuffer,mr.indexBuffer,mr.segments,Qe.paint,Ne.transform.zoom,xr)}}}function ro(Ge,Qe,tt,rt,nt,at){var it=Ge.context,ot=it.gl,dt=Qe.fbo;if(dt){var ht=Ge.useProgram("hillshade");it.activeTexture.set(ot.TEXTURE0),ot.bindTexture(ot.TEXTURE_2D,dt.colorAttachment.get());var Dt=function(Ge,Qe,tt){var rt=tt.paint.get("hillshade-shadow-color"),nt=tt.paint.get("hillshade-highlight-color"),at=tt.paint.get("hillshade-accent-color"),it=tt.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===tt.paint.get("hillshade-illumination-anchor")&&(it-=Ge.transform.angle);var ot,dt,ht,Dt=!Ge.options.moving;return{u_matrix:Ge.transform.calculatePosMatrix(Qe.tileID.toUnwrapped(),Dt),u_image:0,u_latrange:(ot=Qe.tileID,dt=Math.pow(2,ot.canonical.z),ht=ot.canonical.y,[new Ne.MercatorCoordinate(0,ht/dt).toLngLat().lat,new Ne.MercatorCoordinate(0,(ht+1)/dt).toLngLat().lat]),u_light:[tt.paint.get("hillshade-exaggeration"),it],u_shadow:rt,u_highlight:nt,u_accent:at}}(Ge,Qe,tt);ht.draw(it,ot.TRIANGLES,rt,nt,at,Ct.disabled,Dt,tt.id,Ge.rasterBoundsBuffer,Ge.quadTriangleIndexBuffer,Ge.rasterBoundsSegments)}}function ao(Ge,Qe,tt,rt,nt,at,it){var ot=Ge.context,dt=ot.gl,ht=Qe.dem;if(ht&&ht.data){var Dt=ht.dim,Ot=ht.stride,Rt=ht.getPixels();if(ot.activeTexture.set(dt.TEXTURE1),ot.pixelStoreUnpackPremultiplyAlpha.set(!1),Qe.demTexture=Qe.demTexture||Ge.getTileTexture(Ot),Qe.demTexture){var Zt=Qe.demTexture;Zt.update(Rt,{premultiply:!1}),Zt.bind(dt.NEAREST,dt.CLAMP_TO_EDGE)}else Qe.demTexture=new Ne.Texture(ot,Rt,dt.RGBA,{premultiply:!1}),Qe.demTexture.bind(dt.NEAREST,dt.CLAMP_TO_EDGE);ot.activeTexture.set(dt.TEXTURE0);var er=Qe.fbo;if(!er){var dr=new Ne.Texture(ot,{width:Dt,height:Dt,data:null},dt.RGBA);dr.bind(dt.LINEAR,dt.CLAMP_TO_EDGE),(er=Qe.fbo=ot.createFramebuffer(Dt,Dt,!0)).colorAttachment.set(dr.texture)}ot.bindFramebuffer.set(er.framebuffer),ot.viewport.set([0,0,Dt,Dt]),Ge.useProgram("hillshadePrepare").draw(ot,dt.TRIANGLES,nt,at,it,Ct.disabled,function(Ge,Qe,tt){var rt=Qe.stride,nt=Ne.create();return Ne.ortho(nt,0,Ne.EXTENT,-Ne.EXTENT,0,0,1),Ne.translate(nt,nt,[0,-Ne.EXTENT,0]),{u_matrix:nt,u_image:1,u_dimension:[rt,rt],u_zoom:Ge.overscaledZ,u_maxzoom:tt,u_unpack:Qe.getUnpackVector()}}(Qe.tileID,ht,rt),tt.id,Ge.rasterBoundsBuffer,Ge.quadTriangleIndexBuffer,Ge.rasterBoundsSegments),Qe.needsHillshadePrepare=!1}}function no(Ge,Qe,tt,rt,nt){var at=rt.paint.get("raster-fade-duration");if(at>0){var it=Ne.browser.now(),ot=(it-Ge.timeAdded)/at,dt=Qe?(it-Qe.timeAdded)/at:-1,ht=tt.getSource(),Dt=nt.coveringZoomLevel({tileSize:ht.tileSize,roundZoom:ht.roundZoom}),Ot=!Qe||Math.abs(Qe.tileID.overscaledZ-Dt)>Math.abs(Ge.tileID.overscaledZ-Dt),Rt=Ot&&Ge.refreshedUponExpiration?1:Ne.clamp(Ot?ot:1-dt,0,1);return Ge.refreshedUponExpiration&&ot>=1&&(Ge.refreshedUponExpiration=!1),Qe?{opacity:1,mix:1-Rt}:{opacity:Rt,mix:0}}return{opacity:1,mix:0}}var fc=new Ne.Color(1,0,0,1),pc=new Ne.Color(0,1,0,1),dc=new Ne.Color(0,0,1,1),hc=new Ne.Color(1,0,1,1),gc=new Ne.Color(0,1,1,1);function po(Ne,Ge,Qe,tt){fo(Ne,0,Ge+Qe/2,Ne.transform.width,Qe,tt)}function _o(Ne,Ge,Qe,tt){fo(Ne,Ge-Qe/2,0,Qe,Ne.transform.height,tt)}function fo(Ge,Qe,tt,rt,nt,at){var it=Ge.context,ot=it.gl;ot.enable(ot.SCISSOR_TEST),ot.scissor(Qe*Ne.browser.devicePixelRatio,tt*Ne.browser.devicePixelRatio,rt*Ne.browser.devicePixelRatio,nt*Ne.browser.devicePixelRatio),it.clear({color:at}),ot.disable(ot.SCISSOR_TEST)}function mo(Ge,Qe,tt){var rt=Ge.context,nt=rt.gl,at=tt.posMatrix,it=Ge.useProgram("debug"),ot=It.disabled,dt=Pt.disabled,ht=Ge.colorModeForRenderPass();rt.activeTexture.set(nt.TEXTURE0),Ge.emptyTexture.bind(nt.LINEAR,nt.CLAMP_TO_EDGE),it.draw(rt,nt.LINE_STRIP,ot,dt,ht,Ct.disabled,Mi(at,Ne.Color.red),"$debug",Ge.debugBuffer,Ge.tileBorderIndexBuffer,Ge.debugSegments);var Dt=Qe.getTileByID(tt.key).latestRawTileData,Ot=Math.floor((Dt&&Dt.byteLength||0)/1024),Rt=Qe.getTile(tt).tileSize,Zt=512/Math.min(Rt,512)*(tt.overscaledZ/Ge.transform.zoom)*.5,er=tt.canonical.toString();tt.overscaledZ!==tt.canonical.z&&(er+=" => "+tt.overscaledZ),function(Ne,Ge){Ne.initDebugOverlayCanvas();var Qe=Ne.debugOverlayCanvas,tt=Ne.context.gl,rt=Ne.debugOverlayCanvas.getContext("2d");rt.clearRect(0,0,Qe.width,Qe.height),rt.shadowColor="white",rt.shadowBlur=2,rt.lineWidth=1.5,rt.strokeStyle="white",rt.textBaseline="top",rt.font="bold 36px Open Sans, sans-serif",rt.fillText(Ge,5,5),rt.strokeText(Ge,5,5),Ne.debugOverlayTexture.update(Qe),Ne.debugOverlayTexture.bind(tt.LINEAR,tt.CLAMP_TO_EDGE)}(Ge,er+" "+Ot+"kb"),it.draw(rt,nt.TRIANGLES,ot,dt,St.alphaBlended,Ct.disabled,Mi(at,Ne.Color.transparent,Zt),"$debug",Ge.debugBuffer,Ge.quadTriangleIndexBuffer,Ge.debugSegments)}var mc={symbol:function(Ge,Qe,tt,rt,nt){if("translucent"===Ge.renderPass){var at=Pt.disabled,it=Ge.colorModeForRenderPass();tt.layout.get("text-variable-anchor")&&function(Ge,Qe,tt,rt,nt,at,it){for(var ot=Qe.transform,dt="map"===nt,ht="map"===at,Dt=0,Ot=Ge;Dt<Ot.length;Dt+=1){var Rt=Ot[Dt],Zt=rt.getTile(Rt),er=Zt.getBucket(tt);if(er&&er.text&&er.text.segments.get().length){var dr=Ne.evaluateSizeForZoom(er.textSizeData,ot.zoom),mr=pe(Zt,1,Qe.transform.zoom),xr=Jt(Rt.posMatrix,ht,dt,Qe.transform,mr),br="none"!==tt.layout.get("icon-text-fit")&&er.hasIconData();if(dr){var Ar=Math.pow(2,ot.zoom-Zt.tileID.overscaledZ);Qi(er,dt,ht,it,Ne.symbolSize,ot,xr,Rt.posMatrix,Ar,dr,br)}}}}(rt,Ge,tt,Qe,tt.layout.get("text-rotation-alignment"),tt.layout.get("text-pitch-alignment"),nt),0!==tt.paint.get("icon-opacity").constantOr(1)&&to(Ge,Qe,tt,rt,!1,tt.paint.get("icon-translate"),tt.paint.get("icon-translate-anchor"),tt.layout.get("icon-rotation-alignment"),tt.layout.get("icon-pitch-alignment"),tt.layout.get("icon-keep-upright"),at,it),0!==tt.paint.get("text-opacity").constantOr(1)&&to(Ge,Qe,tt,rt,!0,tt.paint.get("text-translate"),tt.paint.get("text-translate-anchor"),tt.layout.get("text-rotation-alignment"),tt.layout.get("text-pitch-alignment"),tt.layout.get("text-keep-upright"),at,it),Qe.map.showCollisionBoxes&&(Ki(Ge,Qe,tt,rt,tt.paint.get("text-translate"),tt.paint.get("text-translate-anchor"),!0),Ki(Ge,Qe,tt,rt,tt.paint.get("icon-translate"),tt.paint.get("icon-translate-anchor"),!1))}},circle:function(Ge,Qe,tt,rt){if("translucent"===Ge.renderPass){var nt=tt.paint.get("circle-opacity"),at=tt.paint.get("circle-stroke-width"),it=tt.paint.get("circle-stroke-opacity"),ot=void 0!==tt.layout.get("circle-sort-key").constantOr(1);if(0!==nt.constantOr(1)||0!==at.constantOr(1)&&0!==it.constantOr(1)){for(var dt=Ge.context,ht=dt.gl,Dt=Ge.depthModeForSublayer(0,It.ReadOnly),Ot=Pt.disabled,Rt=Ge.colorModeForRenderPass(),Zt=[],er=0;er<rt.length;er++){var dr=rt[er],mr=Qe.getTile(dr),xr=mr.getBucket(tt);if(xr){var br=xr.programConfigurations.get(tt.id),Ar={programConfiguration:br,program:Ge.useProgram("circle",br),layoutVertexBuffer:xr.layoutVertexBuffer,indexBuffer:xr.indexBuffer,uniformValues:Ci(Ge,dr,mr,tt)};if(ot)for(var en=0,mn=xr.segments.get();en<mn.length;en+=1){var xn=mn[en];Zt.push({segments:new Ne.SegmentVector([xn]),sortKey:xn.sortKey,state:Ar})}else Zt.push({segments:xr.segments,sortKey:0,state:Ar})}}ot&&Zt.sort((function(Ne,Ge){return Ne.sortKey-Ge.sortKey}));for(var kn=0,Cn=Zt;kn<Cn.length;kn+=1){var En=Cn[kn],Pn=En.state;Pn.program.draw(dt,ht.TRIANGLES,Dt,Ot,Rt,Ct.disabled,Pn.uniformValues,tt.id,Pn.layoutVertexBuffer,Pn.indexBuffer,En.segments,tt.paint,Ge.transform.zoom,Pn.programConfiguration)}}}},heatmap:function(Ge,Qe,tt,rt){if(0!==tt.paint.get("heatmap-opacity"))if("offscreen"===Ge.renderPass){var nt=Ge.context,at=nt.gl,it=Pt.disabled,ot=new St([at.ONE,at.ONE],Ne.Color.transparent,[!0,!0,!0,!0]);!function(Ne,Ge,Qe){var tt=Ne.gl;Ne.activeTexture.set(tt.TEXTURE1),Ne.viewport.set([0,0,Ge.width/4,Ge.height/4]);var rt=Qe.heatmapFbo;if(rt)tt.bindTexture(tt.TEXTURE_2D,rt.colorAttachment.get()),Ne.bindFramebuffer.set(rt.framebuffer);else{var nt=tt.createTexture();tt.bindTexture(tt.TEXTURE_2D,nt),tt.texParameteri(tt.TEXTURE_2D,tt.TEXTURE_WRAP_S,tt.CLAMP_TO_EDGE),tt.texParameteri(tt.TEXTURE_2D,tt.TEXTURE_WRAP_T,tt.CLAMP_TO_EDGE),tt.texParameteri(tt.TEXTURE_2D,tt.TEXTURE_MIN_FILTER,tt.LINEAR),tt.texParameteri(tt.TEXTURE_2D,tt.TEXTURE_MAG_FILTER,tt.LINEAR),rt=Qe.heatmapFbo=Ne.createFramebuffer(Ge.width/4,Ge.height/4,!1),function(Ne,Ge,Qe,tt){var rt=Ne.gl;rt.texImage2D(rt.TEXTURE_2D,0,rt.RGBA,Ge.width/4,Ge.height/4,0,rt.RGBA,Ne.extRenderToTextureHalfFloat?Ne.extTextureHalfFloat.HALF_FLOAT_OES:rt.UNSIGNED_BYTE,null),tt.colorAttachment.set(Qe)}(Ne,Ge,nt,rt)}}(nt,Ge,tt),nt.clear({color:Ne.Color.transparent});for(var dt=0;dt<rt.length;dt++){var ht=rt[dt];if(!Qe.hasRenderableParent(ht)){var Dt=Qe.getTile(ht),Ot=Dt.getBucket(tt);if(Ot){var Rt=Ot.programConfigurations.get(tt.id);Ge.useProgram("heatmap",Rt).draw(nt,at.TRIANGLES,It.disabled,it,ot,Ct.disabled,Ai(ht.posMatrix,Dt,Ge.transform.zoom,tt.paint.get("heatmap-intensity")),tt.id,Ot.layoutVertexBuffer,Ot.indexBuffer,Ot.segments,tt.paint,Ge.transform.zoom,Rt)}}}nt.viewport.set([0,0,Ge.width,Ge.height])}else"translucent"===Ge.renderPass&&(Ge.context.setColorMode(Ge.colorModeForRenderPass()),function(Ge,Qe){var tt=Ge.context,rt=tt.gl,nt=Qe.heatmapFbo;if(nt){tt.activeTexture.set(rt.TEXTURE0),rt.bindTexture(rt.TEXTURE_2D,nt.colorAttachment.get()),tt.activeTexture.set(rt.TEXTURE1);var at=Qe.colorRampTexture;at||(at=Qe.colorRampTexture=new Ne.Texture(tt,Qe.colorRamp,rt.RGBA)),at.bind(rt.LINEAR,rt.CLAMP_TO_EDGE),Ge.useProgram("heatmapTexture").draw(tt,rt.TRIANGLES,It.disabled,Pt.disabled,Ge.colorModeForRenderPass(),Ct.disabled,function(Ge,Qe,tt,rt){var nt=Ne.create();Ne.ortho(nt,0,Ge.width,Ge.height,0,0,1);var at=Ge.context.gl;return{u_matrix:nt,u_world:[at.drawingBufferWidth,at.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:Qe.paint.get("heatmap-opacity")}}(Ge,Qe),Qe.id,Ge.viewportBuffer,Ge.quadTriangleIndexBuffer,Ge.viewportSegments,Qe.paint,Ge.transform.zoom)}}(Ge,tt))},line:function(Ge,Qe,tt,rt){if("translucent"===Ge.renderPass){var nt=tt.paint.get("line-opacity"),at=tt.paint.get("line-width");if(0!==nt.constantOr(1)&&0!==at.constantOr(1)){var it=Ge.depthModeForSublayer(0,It.ReadOnly),ot=Ge.colorModeForRenderPass(),dt=tt.paint.get("line-dasharray"),ht=tt.paint.get("line-pattern"),Dt=ht.constantOr(1),Ot=tt.paint.get("line-gradient"),Rt=tt.getCrossfadeParameters(),Zt=Dt?"linePattern":dt?"lineSDF":Ot?"lineGradient":"line",er=Ge.context,dr=er.gl,mr=!0;if(Ot){er.activeTexture.set(dr.TEXTURE0);var xr=tt.gradientTexture;if(!tt.gradient)return;xr||(xr=tt.gradientTexture=new Ne.Texture(er,tt.gradient,dr.RGBA)),xr.bind(dr.LINEAR,dr.CLAMP_TO_EDGE)}for(var br=0,Ar=rt;br<Ar.length;br+=1){var en=Ar[br],mn=Qe.getTile(en);if(!Dt||mn.patternsLoaded()){var xn=mn.getBucket(tt);if(xn){var kn=xn.programConfigurations.get(tt.id),Cn=Ge.context.program.get(),En=Ge.useProgram(Zt,kn),Pn=mr||En.program!==Cn,Dn=ht.constantOr(null);if(Dn&&mn.imageAtlas){var In=mn.imageAtlas,zn=In.patternPositions[Dn.to.toString()],Bn=In.patternPositions[Dn.from.toString()];zn&&Bn&&kn.setConstantPatternPositions(zn,Bn)}var Vn=Dt?Bi(Ge,mn,tt,Rt):dt?Oi(Ge,mn,tt,dt,Rt):Ot?ki(Ge,mn,tt):Ri(Ge,mn,tt);Dt?(er.activeTexture.set(dr.TEXTURE0),mn.imageAtlasTexture.bind(dr.LINEAR,dr.CLAMP_TO_EDGE),kn.updatePaintBuffers(Rt)):dt&&(Pn||Ge.lineAtlas.dirty)&&(er.activeTexture.set(dr.TEXTURE0),Ge.lineAtlas.bind(er)),En.draw(er,dr.TRIANGLES,it,Ge.stencilModeForClipping(en),ot,Ct.disabled,Vn,tt.id,xn.layoutVertexBuffer,xn.indexBuffer,xn.segments,tt.paint,Ge.transform.zoom,kn),mr=!1}}}}}},fill:function(Ge,Qe,tt,rt){var nt=tt.paint.get("fill-color"),at=tt.paint.get("fill-opacity");if(0!==at.constantOr(1)){var it=Ge.colorModeForRenderPass(),ot=tt.paint.get("fill-pattern"),dt=Ge.opaquePassEnabledForLayer()&&!ot.constantOr(1)&&1===nt.constantOr(Ne.Color.transparent).a&&1===at.constantOr(0)?"opaque":"translucent";if(Ge.renderPass===dt){var ht=Ge.depthModeForSublayer(1,"opaque"===Ge.renderPass?It.ReadWrite:It.ReadOnly);io(Ge,Qe,tt,rt,ht,it,!1)}if("translucent"===Ge.renderPass&&tt.paint.get("fill-antialias")){var Dt=Ge.depthModeForSublayer(tt.getPaintProperty("fill-outline-color")?2:0,It.ReadOnly);io(Ge,Qe,tt,rt,Dt,it,!0)}}},"fill-extrusion":function(Ne,Ge,Qe,tt){var rt=Qe.paint.get("fill-extrusion-opacity");if(0!==rt&&"translucent"===Ne.renderPass){var nt=new It(Ne.context.gl.LEQUAL,It.ReadWrite,Ne.depthRangeFor3D);if(1!==rt||Qe.paint.get("fill-extrusion-pattern").constantOr(1))oo(Ne,Ge,Qe,tt,nt,Pt.disabled,St.disabled),oo(Ne,Ge,Qe,tt,nt,Ne.stencilModeFor3D(),Ne.colorModeForRenderPass());else{var at=Ne.colorModeForRenderPass();oo(Ne,Ge,Qe,tt,nt,Pt.disabled,at)}}},hillshade:function(Ne,Ge,Qe,tt){if("offscreen"===Ne.renderPass||"translucent"===Ne.renderPass){for(var rt=Ne.context,nt=Ge.getSource().maxzoom,at=Ne.depthModeForSublayer(0,It.ReadOnly),it=Ne.colorModeForRenderPass(),ot="translucent"===Ne.renderPass?Ne.stencilConfigForOverlap(tt):[{},tt],dt=ot[0],ht=0,Dt=ot[1];ht<Dt.length;ht+=1){var Ot=Dt[ht],Rt=Ge.getTile(Ot);Rt.needsHillshadePrepare&&"offscreen"===Ne.renderPass?ao(Ne,Rt,Qe,nt,at,Pt.disabled,it):"translucent"===Ne.renderPass&&ro(Ne,Rt,Qe,at,dt[Ot.overscaledZ],it)}rt.viewport.set([0,0,Ne.width,Ne.height])}},raster:function(Ne,Ge,Qe,tt){if("translucent"===Ne.renderPass&&0!==Qe.paint.get("raster-opacity")&&tt.length)for(var rt=Ne.context,nt=rt.gl,at=Ge.getSource(),it=Ne.useProgram("raster"),ot=Ne.colorModeForRenderPass(),dt=at instanceof en?[{},tt]:Ne.stencilConfigForOverlap(tt),ht=dt[0],Dt=dt[1],Ot=Dt[Dt.length-1].overscaledZ,Rt=!Ne.options.moving,Zt=0,er=Dt;Zt<er.length;Zt+=1){var dr=er[Zt],mr=Ne.depthModeForSublayer(dr.overscaledZ-Ot,1===Qe.paint.get("raster-opacity")?It.ReadWrite:It.ReadOnly,nt.LESS),xr=Ge.getTile(dr),br=Ne.transform.calculatePosMatrix(dr.toUnwrapped(),Rt);xr.registerFadeDuration(Qe.paint.get("raster-fade-duration"));var Ar=Ge.findLoadedParent(dr,0),mn=no(xr,Ar,Ge,Qe,Ne.transform),xn=void 0,kn=void 0,Cn="nearest"===Qe.paint.get("raster-resampling")?nt.NEAREST:nt.LINEAR;rt.activeTexture.set(nt.TEXTURE0),xr.texture.bind(Cn,nt.CLAMP_TO_EDGE,nt.LINEAR_MIPMAP_NEAREST),rt.activeTexture.set(nt.TEXTURE1),Ar?(Ar.texture.bind(Cn,nt.CLAMP_TO_EDGE,nt.LINEAR_MIPMAP_NEAREST),xn=Math.pow(2,Ar.tileID.overscaledZ-xr.tileID.overscaledZ),kn=[xr.tileID.canonical.x*xn%1,xr.tileID.canonical.y*xn%1]):xr.texture.bind(Cn,nt.CLAMP_TO_EDGE,nt.LINEAR_MIPMAP_NEAREST);var En=Ni(br,kn||[0,0],xn||1,mn,Qe);at instanceof en?it.draw(rt,nt.TRIANGLES,mr,Pt.disabled,ot,Ct.disabled,En,Qe.id,at.boundsBuffer,Ne.quadTriangleIndexBuffer,at.boundsSegments):it.draw(rt,nt.TRIANGLES,mr,ht[dr.overscaledZ],ot,Ct.disabled,En,Qe.id,Ne.rasterBoundsBuffer,Ne.quadTriangleIndexBuffer,Ne.rasterBoundsSegments)}},background:function(Ne,Ge,Qe){var tt=Qe.paint.get("background-color"),rt=Qe.paint.get("background-opacity");if(0!==rt){var nt=Ne.context,at=nt.gl,it=Ne.transform,ot=it.tileSize,dt=Qe.paint.get("background-pattern");if(!Ne.isPatternMissing(dt)){var ht=!dt&&1===tt.a&&1===rt&&Ne.opaquePassEnabledForLayer()?"opaque":"translucent";if(Ne.renderPass===ht){var Dt=Pt.disabled,Ot=Ne.depthModeForSublayer(0,"opaque"===ht?It.ReadWrite:It.ReadOnly),Rt=Ne.colorModeForRenderPass(),Zt=Ne.useProgram(dt?"backgroundPattern":"background"),er=it.coveringTiles({tileSize:ot});dt&&(nt.activeTexture.set(at.TEXTURE0),Ne.imageManager.bind(Ne.context));for(var dr=Qe.getCrossfadeParameters(),mr=0,xr=er;mr<xr.length;mr+=1){var br=xr[mr],Ar=Ne.transform.calculatePosMatrix(br.toUnwrapped()),en=dt?Xi(Ar,rt,Ne,dt,{tileID:br,tileSize:ot},dr):Wi(Ar,rt,tt);Zt.draw(nt,at.TRIANGLES,Ot,Dt,Rt,Ct.disabled,en,Qe.id,Ne.tileExtentBuffer,Ne.quadTriangleIndexBuffer,Ne.tileExtentSegments)}}}}},debug:function(Ne,Ge,Qe){for(var tt=0;tt<Qe.length;tt++)mo(Ne,Ge,Qe[tt])},custom:function(Ne,Ge,Qe){var tt=Ne.context,rt=Qe.implementation;if("offscreen"===Ne.renderPass){var nt=rt.prerender;nt&&(Ne.setCustomLayerDefaults(),tt.setColorMode(Ne.colorModeForRenderPass()),nt.call(rt,tt.gl,Ne.transform.customLayerMatrix()),tt.setDirty(),Ne.setBaseState())}else if("translucent"===Ne.renderPass){Ne.setCustomLayerDefaults(),tt.setColorMode(Ne.colorModeForRenderPass()),tt.setStencilMode(Pt.disabled);var at="3d"===rt.renderingMode?new It(Ne.context.gl.LEQUAL,It.ReadWrite,Ne.depthRangeFor3D):Ne.depthModeForSublayer(0,It.ReadOnly);tt.setDepthMode(at),rt.render(tt.gl,Ne.transform.customLayerMatrix()),tt.setDirty(),Ne.setBaseState(),tt.bindFramebuffer.set(null)}}},vo=function(Ne,Ge){this.context=new zt(Ne),this.transform=Ge,this._tileTextures={},this.setup(),this.numSublayers=ds.maxUnderzooming+ds.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Fe,this.gpuTimers={}};vo.prototype.resize=function(Ge,Qe){if(this.width=Ge*Ne.browser.devicePixelRatio,this.height=Qe*Ne.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var tt=0,rt=this.style._order;tt<rt.length;tt+=1)this.style._layers[rt[tt]].resize()},vo.prototype.setup=function(){var Ge=this.context,Qe=new Ne.StructArrayLayout2i4;Qe.emplaceBack(0,0),Qe.emplaceBack(Ne.EXTENT,0),Qe.emplaceBack(0,Ne.EXTENT),Qe.emplaceBack(Ne.EXTENT,Ne.EXTENT),this.tileExtentBuffer=Ge.createVertexBuffer(Qe,Zs.members),this.tileExtentSegments=Ne.SegmentVector.simpleSegment(0,0,4,2);var tt=new Ne.StructArrayLayout2i4;tt.emplaceBack(0,0),tt.emplaceBack(Ne.EXTENT,0),tt.emplaceBack(0,Ne.EXTENT),tt.emplaceBack(Ne.EXTENT,Ne.EXTENT),this.debugBuffer=Ge.createVertexBuffer(tt,Zs.members),this.debugSegments=Ne.SegmentVector.simpleSegment(0,0,4,5);var rt=new Ne.StructArrayLayout4i8;rt.emplaceBack(0,0,0,0),rt.emplaceBack(Ne.EXTENT,0,Ne.EXTENT,0),rt.emplaceBack(0,Ne.EXTENT,0,Ne.EXTENT),rt.emplaceBack(Ne.EXTENT,Ne.EXTENT,Ne.EXTENT,Ne.EXTENT),this.rasterBoundsBuffer=Ge.createVertexBuffer(rt,Ar.members),this.rasterBoundsSegments=Ne.SegmentVector.simpleSegment(0,0,4,2);var nt=new Ne.StructArrayLayout2i4;nt.emplaceBack(0,0),nt.emplaceBack(1,0),nt.emplaceBack(0,1),nt.emplaceBack(1,1),this.viewportBuffer=Ge.createVertexBuffer(nt,Zs.members),this.viewportSegments=Ne.SegmentVector.simpleSegment(0,0,4,2);var at=new Ne.StructArrayLayout1ui2;at.emplaceBack(0),at.emplaceBack(1),at.emplaceBack(3),at.emplaceBack(2),at.emplaceBack(0),this.tileBorderIndexBuffer=Ge.createIndexBuffer(at);var it=new Ne.StructArrayLayout3ui6;it.emplaceBack(0,1,2),it.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=Ge.createIndexBuffer(it),this.emptyTexture=new Ne.Texture(Ge,{width:1,height:1,data:new Uint8Array([0,0,0,0])},Ge.gl.RGBA);var ot=this.context.gl;this.stencilClearMode=new Pt({func:ot.ALWAYS,mask:0},0,255,ot.ZERO,ot.ZERO,ot.ZERO)},vo.prototype.clearStencil=function(){var Ge=this.context,Qe=Ge.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var tt=Ne.create();Ne.ortho(tt,0,this.width,this.height,0,0,1),Ne.scale(tt,tt,[Qe.drawingBufferWidth,Qe.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(Ge,Qe.TRIANGLES,It.disabled,this.stencilClearMode,St.disabled,Ct.disabled,Li(tt),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},vo.prototype._renderTileClippingMasks=function(Ne,Ge){if(this.currentStencilSource!==Ne.source&&Ne.isTileClipped()&&Ge&&Ge.length){this.currentStencilSource=Ne.source;var Qe=this.context,tt=Qe.gl;this.nextStencilID+Ge.length>256&&this.clearStencil(),Qe.setColorMode(St.disabled),Qe.setDepthMode(It.disabled);var rt=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var nt=0,at=Ge;nt<at.length;nt+=1){var it=at[nt],ot=this._tileClippingMaskIDs[it.key]=this.nextStencilID++;rt.draw(Qe,tt.TRIANGLES,It.disabled,new Pt({func:tt.ALWAYS,mask:0},ot,255,tt.KEEP,tt.KEEP,tt.REPLACE),St.disabled,Ct.disabled,Li(it.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},vo.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var Ne=this.nextStencilID++,Ge=this.context.gl;return new Pt({func:Ge.NOTEQUAL,mask:255},Ne,255,Ge.KEEP,Ge.KEEP,Ge.REPLACE)},vo.prototype.stencilModeForClipping=function(Ne){var Ge=this.context.gl;return new Pt({func:Ge.EQUAL,mask:255},this._tileClippingMaskIDs[Ne.key],0,Ge.KEEP,Ge.KEEP,Ge.REPLACE)},vo.prototype.stencilConfigForOverlap=function(Ne){var Ge,Qe=this.context.gl,tt=Ne.sort((function(Ne,Ge){return Ge.overscaledZ-Ne.overscaledZ})),rt=tt[tt.length-1].overscaledZ,nt=tt[0].overscaledZ-rt+1;if(nt>1){this.currentStencilSource=void 0,this.nextStencilID+nt>256&&this.clearStencil();for(var at={},it=0;it<nt;it++)at[it+rt]=new Pt({func:Qe.GEQUAL,mask:255},it+this.nextStencilID,255,Qe.KEEP,Qe.KEEP,Qe.REPLACE);return this.nextStencilID+=nt,[at,tt]}return[(Ge={},Ge[rt]=Pt.disabled,Ge),tt]},vo.prototype.colorModeForRenderPass=function(){var Ge=this.context.gl;return this._showOverdrawInspector?new St([Ge.CONSTANT_COLOR,Ge.ONE],new Ne.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?St.unblended:St.alphaBlended},vo.prototype.depthModeForSublayer=function(Ne,Ge,Qe){if(!this.opaquePassEnabledForLayer())return It.disabled;var tt=1-((1+this.currentLayer)*this.numSublayers+Ne)*this.depthEpsilon;return new It(Qe||this.context.gl.LEQUAL,Ge,[tt,tt])},vo.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},vo.prototype.render=function(Ge,Qe){var tt=this;this.style=Ge,this.options=Qe,this.lineAtlas=Ge.lineAtlas,this.imageManager=Ge.imageManager,this.glyphManager=Ge.glyphManager,this.symbolFadeChange=Ge.placement.symbolFadeChange(Ne.browser.now()),this.imageManager.beginFrame();var rt=this.style._order,nt=this.style.sourceCaches;for(var at in nt){var it=nt[at];it.used&&it.prepare(this.context)}var ot,dt,ht={},Dt={},Ot={};for(var Rt in nt){var Zt=nt[Rt];ht[Rt]=Zt.getVisibleCoordinates(),Dt[Rt]=ht[Rt].slice().reverse(),Ot[Rt]=Zt.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var er=0;er<rt.length;er++)if(this.style._layers[rt[er]].is3D()){this.opaquePassCutoff=er;break}this.renderPass="offscreen";for(var dr=0,mr=rt;dr<mr.length;dr+=1){var xr=this.style._layers[mr[dr]];if(xr.hasOffscreenPass()&&!xr.isHidden(this.transform.zoom)){var br=Dt[xr.source];("custom"===xr.type||br.length)&&this.renderLayer(this,nt[xr.source],xr,br)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:Qe.showOverdrawInspector?Ne.Color.black:Ne.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=Qe.showOverdrawInspector,this.depthRangeFor3D=[0,1-(Ge._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=rt.length-1;this.currentLayer>=0;this.currentLayer--){var Ar=this.style._layers[rt[this.currentLayer]],en=nt[Ar.source],mn=ht[Ar.source];this._renderTileClippingMasks(Ar,mn),this.renderLayer(this,en,Ar,mn)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<rt.length;this.currentLayer++){var xn=this.style._layers[rt[this.currentLayer]],kn=nt[xn.source],Cn=("symbol"===xn.type?Ot:Dt)[xn.source];this._renderTileClippingMasks(xn,ht[xn.source]),this.renderLayer(this,kn,xn,Cn)}this.options.showTileBoundaries&&(Ne.values(this.style._layers).forEach((function(Ne){Ne.source&&!Ne.isHidden(tt.transform.zoom)&&(Ne.source!==(dt&&dt.id)&&(dt=tt.style.sourceCaches[Ne.source]),(!ot||ot.getSource().maxzoom<dt.getSource().maxzoom)&&(ot=dt))})),ot&&mc.debug(this,ot,ot.getVisibleCoordinates())),this.options.showPadding&&function(Ne){var Ge=Ne.transform.padding;po(Ne,Ne.transform.height-(Ge.top||0),3,fc),po(Ne,Ge.bottom||0,3,pc),_o(Ne,Ge.left||0,3,dc),_o(Ne,Ne.transform.width-(Ge.right||0),3,hc);var Qe=Ne.transform.centerPoint;!function(Ne,Ge,Qe,tt){fo(Ne,Ge-1,Qe-10,2,20,tt),fo(Ne,Ge-10,Qe-1,20,2,tt)}(Ne,Qe.x,Ne.transform.height-Qe.y,gc)}(this),this.context.setDefault()},vo.prototype.renderLayer=function(Ne,Ge,Qe,tt){Qe.isHidden(this.transform.zoom)||("background"===Qe.type||"custom"===Qe.type||tt.length)&&(this.id=Qe.id,this.gpuTimingStart(Qe),mc[Qe.type](Ne,Ge,Qe,tt,this.style.placement.variableOffsets),this.gpuTimingEnd())},vo.prototype.gpuTimingStart=function(Ne){if(this.options.gpuTiming){var Ge=this.context.extTimerQuery,Qe=this.gpuTimers[Ne.id];Qe||(Qe=this.gpuTimers[Ne.id]={calls:0,cpuTime:0,query:Ge.createQueryEXT()}),Qe.calls++,Ge.beginQueryEXT(Ge.TIME_ELAPSED_EXT,Qe.query)}},vo.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var Ne=this.context.extTimerQuery;Ne.endQueryEXT(Ne.TIME_ELAPSED_EXT)}},vo.prototype.collectGpuTimers=function(){var Ne=this.gpuTimers;return this.gpuTimers={},Ne},vo.prototype.queryGpuTimers=function(Ne){var Ge={};for(var Qe in Ne){var tt=Ne[Qe],rt=this.context.extTimerQuery,nt=rt.getQueryObjectEXT(tt.query,rt.QUERY_RESULT_EXT)/1e6;rt.deleteQueryEXT(tt.query),Ge[Qe]=nt}return Ge},vo.prototype.translatePosMatrix=function(Ge,Qe,tt,rt,nt){if(!tt[0]&&!tt[1])return Ge;var at=nt?"map"===rt?this.transform.angle:0:"viewport"===rt?-this.transform.angle:0;if(at){var it=Math.sin(at),ot=Math.cos(at);tt=[tt[0]*ot-tt[1]*it,tt[0]*it+tt[1]*ot]}var dt=[nt?tt[0]:pe(Qe,tt[0],this.transform.zoom),nt?tt[1]:pe(Qe,tt[1],this.transform.zoom),0],ht=new Float32Array(16);return Ne.translate(ht,Ge,dt),ht},vo.prototype.saveTileTexture=function(Ne){var Ge=this._tileTextures[Ne.size[0]];Ge?Ge.push(Ne):this._tileTextures[Ne.size[0]]=[Ne]},vo.prototype.getTileTexture=function(Ne){var Ge=this._tileTextures[Ne];return Ge&&Ge.length>0?Ge.pop():null},vo.prototype.isPatternMissing=function(Ne){if(!Ne)return!1;if(!Ne.from||!Ne.to)return!0;var Ge=this.imageManager.getPattern(Ne.from.toString()),Qe=this.imageManager.getPattern(Ne.to.toString());return!Ge||!Qe},vo.prototype.useProgram=function(Ne,Ge){this.cache=this.cache||{};var Qe=""+Ne+(Ge?Ge.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[Qe]||(this.cache[Qe]=new xi(this.context,sc[Ne],Ge,cc[Ne],this._showOverdrawInspector)),this.cache[Qe]},vo.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},vo.prototype.setBaseState=function(){var Ne=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(Ne.FUNC_ADD)},vo.prototype.initDebugOverlayCanvas=function(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=Ne.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Ne.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},vo.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var yo=function(Ne,Ge){this.points=Ne,this.planes=Ge};yo.fromInvProjectionMatrix=function(Ge,Qe,tt){var rt=Math.pow(2,tt),nt=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((function(Qe){return Ne.transformMat4([],Qe,Ge)})).map((function(Ge){return Ne.scale$1([],Ge,1/Ge[3]/Qe*rt)})),at=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((function(Ge){var Qe=Ne.sub([],nt[Ge[0]],nt[Ge[1]]),tt=Ne.sub([],nt[Ge[2]],nt[Ge[1]]),rt=Ne.normalize([],Ne.cross([],Qe,tt)),at=-Ne.dot(rt,nt[Ge[1]]);return rt.concat(at)}));return new yo(nt,at)};var xo=function(Ge,Qe){this.min=Ge,this.max=Qe,this.center=Ne.scale$2([],Ne.add([],this.min,this.max),.5)};xo.prototype.quadrant=function(Ge){for(var Qe=[Ge%2==0,Ge<2],tt=Ne.clone$2(this.min),rt=Ne.clone$2(this.max),nt=0;nt<Qe.length;nt++)tt[nt]=Qe[nt]?this.min[nt]:this.center[nt],rt[nt]=Qe[nt]?this.center[nt]:this.max[nt];return rt[2]=this.max[2],new xo(tt,rt)},xo.prototype.distanceX=function(Ne){return Math.max(Math.min(this.max[0],Ne[0]),this.min[0])-Ne[0]},xo.prototype.distanceY=function(Ne){return Math.max(Math.min(this.max[1],Ne[1]),this.min[1])-Ne[1]},xo.prototype.intersects=function(Ge){for(var Qe=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],tt=!0,rt=0;rt<Ge.planes.length;rt++){for(var nt=Ge.planes[rt],at=0,it=0;it<Qe.length;it++)at+=Ne.dot$1(nt,Qe[it])>=0;if(0===at)return 0;at!==Qe.length&&(tt=!1)}if(tt)return 2;for(var ot=0;ot<3;ot++){for(var dt=Number.MAX_VALUE,ht=-Number.MAX_VALUE,Dt=0;Dt<Ge.points.length;Dt++){var Ot=Ge.points[Dt][ot]-this.min[ot];dt=Math.min(dt,Ot),ht=Math.max(ht,Ot)}if(ht<0||dt>this.max[ot]-this.min[ot])return 0}return 1};var bo=function(Ne,Ge,Qe,tt){if(void 0===Ne&&(Ne=0),void 0===Ge&&(Ge=0),void 0===Qe&&(Qe=0),void 0===tt&&(tt=0),isNaN(Ne)||Ne<0||isNaN(Ge)||Ge<0||isNaN(Qe)||Qe<0||isNaN(tt)||tt<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=Ne,this.bottom=Ge,this.left=Qe,this.right=tt};bo.prototype.interpolate=function(Ge,Qe,tt){return null!=Qe.top&&null!=Ge.top&&(this.top=Ne.number(Ge.top,Qe.top,tt)),null!=Qe.bottom&&null!=Ge.bottom&&(this.bottom=Ne.number(Ge.bottom,Qe.bottom,tt)),null!=Qe.left&&null!=Ge.left&&(this.left=Ne.number(Ge.left,Qe.left,tt)),null!=Qe.right&&null!=Ge.right&&(this.right=Ne.number(Ge.right,Qe.right,tt)),this},bo.prototype.getCenter=function(Ge,Qe){var tt=Ne.clamp((this.left+Ge-this.right)/2,0,Ge),rt=Ne.clamp((this.top+Qe-this.bottom)/2,0,Qe);return new Ne.Point(tt,rt)},bo.prototype.equals=function(Ne){return this.top===Ne.top&&this.bottom===Ne.bottom&&this.left===Ne.left&&this.right===Ne.right},bo.prototype.clone=function(){return new bo(this.top,this.bottom,this.left,this.right)},bo.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var wo=function(Ge,Qe,tt,rt,nt){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===nt||nt,this._minZoom=Ge||0,this._maxZoom=Qe||22,this._minPitch=null==tt?0:tt,this._maxPitch=null==rt?60:rt,this.setMaxBounds(),this.width=0,this.height=0,this._center=new Ne.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new bo,this._posMatrixCache={},this._alignedPosMatrixCache={}},vc={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};wo.prototype.clone=function(){var Ne=new wo(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return Ne.tileSize=this.tileSize,Ne.latRange=this.latRange,Ne.width=this.width,Ne.height=this.height,Ne._center=this._center,Ne.zoom=this.zoom,Ne.angle=this.angle,Ne._fov=this._fov,Ne._pitch=this._pitch,Ne._unmodified=this._unmodified,Ne._edgeInsets=this._edgeInsets.clone(),Ne._calcMatrices(),Ne},vc.minZoom.get=function(){return this._minZoom},vc.minZoom.set=function(Ne){this._minZoom!==Ne&&(this._minZoom=Ne,this.zoom=Math.max(this.zoom,Ne))},vc.maxZoom.get=function(){return this._maxZoom},vc.maxZoom.set=function(Ne){this._maxZoom!==Ne&&(this._maxZoom=Ne,this.zoom=Math.min(this.zoom,Ne))},vc.minPitch.get=function(){return this._minPitch},vc.minPitch.set=function(Ne){this._minPitch!==Ne&&(this._minPitch=Ne,this.pitch=Math.max(this.pitch,Ne))},vc.maxPitch.get=function(){return this._maxPitch},vc.maxPitch.set=function(Ne){this._maxPitch!==Ne&&(this._maxPitch=Ne,this.pitch=Math.min(this.pitch,Ne))},vc.renderWorldCopies.get=function(){return this._renderWorldCopies},vc.renderWorldCopies.set=function(Ne){void 0===Ne?Ne=!0:null===Ne&&(Ne=!1),this._renderWorldCopies=Ne},vc.worldSize.get=function(){return this.tileSize*this.scale},vc.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},vc.size.get=function(){return new Ne.Point(this.width,this.height)},vc.bearing.get=function(){return-this.angle/Math.PI*180},vc.bearing.set=function(Ge){var Qe=-Ne.wrap(Ge,-180,180)*Math.PI/180;this.angle!==Qe&&(this._unmodified=!1,this.angle=Qe,this._calcMatrices(),this.rotationMatrix=Ne.create$2(),Ne.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},vc.pitch.get=function(){return this._pitch/Math.PI*180},vc.pitch.set=function(Ge){var Qe=Ne.clamp(Ge,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==Qe&&(this._unmodified=!1,this._pitch=Qe,this._calcMatrices())},vc.fov.get=function(){return this._fov/Math.PI*180},vc.fov.set=function(Ne){Ne=Math.max(.01,Math.min(60,Ne)),this._fov!==Ne&&(this._unmodified=!1,this._fov=Ne/180*Math.PI,this._calcMatrices())},vc.zoom.get=function(){return this._zoom},vc.zoom.set=function(Ne){var Ge=Math.min(Math.max(Ne,this.minZoom),this.maxZoom);this._zoom!==Ge&&(this._unmodified=!1,this._zoom=Ge,this.scale=this.zoomScale(Ge),this.tileZoom=Math.floor(Ge),this.zoomFraction=Ge-this.tileZoom,this._constrain(),this._calcMatrices())},vc.center.get=function(){return this._center},vc.center.set=function(Ne){Ne.lat===this._center.lat&&Ne.lng===this._center.lng||(this._unmodified=!1,this._center=Ne,this._constrain(),this._calcMatrices())},vc.padding.get=function(){return this._edgeInsets.toJSON()},vc.padding.set=function(Ne){this._edgeInsets.equals(Ne)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,Ne,1),this._calcMatrices())},vc.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},wo.prototype.isPaddingEqual=function(Ne){return this._edgeInsets.equals(Ne)},wo.prototype.interpolatePadding=function(Ne,Ge,Qe){this._unmodified=!1,this._edgeInsets.interpolate(Ne,Ge,Qe),this._constrain(),this._calcMatrices()},wo.prototype.coveringZoomLevel=function(Ne){var Ge=(Ne.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/Ne.tileSize));return Math.max(0,Ge)},wo.prototype.getVisibleUnwrappedCoordinates=function(Ge){var Qe=[new Ne.UnwrappedTileID(0,Ge)];if(this._renderWorldCopies)for(var tt=this.pointCoordinate(new Ne.Point(0,0)),rt=this.pointCoordinate(new Ne.Point(this.width,0)),nt=this.pointCoordinate(new Ne.Point(this.width,this.height)),at=this.pointCoordinate(new Ne.Point(0,this.height)),it=Math.floor(Math.min(tt.x,rt.x,nt.x,at.x)),ot=Math.floor(Math.max(tt.x,rt.x,nt.x,at.x)),dt=it-1;dt<=ot+1;dt++)0!==dt&&Qe.push(new Ne.UnwrappedTileID(dt,Ge));return Qe},wo.prototype.coveringTiles=function(Ge){var Qe=this.coveringZoomLevel(Ge),tt=Qe;if(void 0!==Ge.minzoom&&Qe<Ge.minzoom)return[];void 0!==Ge.maxzoom&&Qe>Ge.maxzoom&&(Qe=Ge.maxzoom);var rt=Ne.MercatorCoordinate.fromLngLat(this.center),nt=Math.pow(2,Qe),at=[nt*rt.x,nt*rt.y,0],it=yo.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,Qe),ot=Ge.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(ot=Qe);var c=function(Ne){return{aabb:new xo([Ne*nt,0,0],[(Ne+1)*nt,nt,0]),zoom:0,x:0,y:0,wrap:Ne,fullyVisible:!1}},dt=[],ht=[],Dt=Qe,Ot=Ge.reparseOverscaled?tt:Qe;if(this._renderWorldCopies)for(var Rt=1;Rt<=3;Rt++)dt.push(c(-Rt)),dt.push(c(Rt));for(dt.push(c(0));dt.length>0;){var Zt=dt.pop(),er=Zt.x,dr=Zt.y,mr=Zt.fullyVisible;if(!mr){var xr=Zt.aabb.intersects(it);if(0===xr)continue;mr=2===xr}var br=Zt.aabb.distanceX(at),Ar=Zt.aabb.distanceY(at),en=Math.max(Math.abs(br),Math.abs(Ar));if(Zt.zoom===Dt||en>3+(1<<Dt-Zt.zoom)-2&&Zt.zoom>=ot)ht.push({tileID:new Ne.OverscaledTileID(Zt.zoom===Dt?Ot:Zt.zoom,Zt.wrap,Zt.zoom,er,dr),distanceSq:Ne.sqrLen([at[0]-.5-er,at[1]-.5-dr])});else for(var mn=0;mn<4;mn++){var xn=(er<<1)+mn%2,kn=(dr<<1)+(mn>>1);dt.push({aabb:Zt.aabb.quadrant(mn),zoom:Zt.zoom+1,x:xn,y:kn,wrap:Zt.wrap,fullyVisible:mr})}}return ht.sort((function(Ne,Ge){return Ne.distanceSq-Ge.distanceSq})).map((function(Ne){return Ne.tileID}))},wo.prototype.resize=function(Ne,Ge){this.width=Ne,this.height=Ge,this.pixelsToGLUnits=[2/Ne,-2/Ge],this._constrain(),this._calcMatrices()},vc.unmodified.get=function(){return this._unmodified},wo.prototype.zoomScale=function(Ne){return Math.pow(2,Ne)},wo.prototype.scaleZoom=function(Ne){return Math.log(Ne)/Math.LN2},wo.prototype.project=function(Ge){var Qe=Ne.clamp(Ge.lat,-this.maxValidLatitude,this.maxValidLatitude);return new Ne.Point(Ne.mercatorXfromLng(Ge.lng)*this.worldSize,Ne.mercatorYfromLat(Qe)*this.worldSize)},wo.prototype.unproject=function(Ge){return new Ne.MercatorCoordinate(Ge.x/this.worldSize,Ge.y/this.worldSize).toLngLat()},vc.point.get=function(){return this.project(this.center)},wo.prototype.setLocationAtPoint=function(Ge,Qe){var tt=this.pointCoordinate(Qe),rt=this.pointCoordinate(this.centerPoint),nt=this.locationCoordinate(Ge),at=new Ne.MercatorCoordinate(nt.x-(tt.x-rt.x),nt.y-(tt.y-rt.y));this.center=this.coordinateLocation(at),this._renderWorldCopies&&(this.center=this.center.wrap())},wo.prototype.locationPoint=function(Ne){return this.coordinatePoint(this.locationCoordinate(Ne))},wo.prototype.pointLocation=function(Ne){return this.coordinateLocation(this.pointCoordinate(Ne))},wo.prototype.locationCoordinate=function(Ge){return Ne.MercatorCoordinate.fromLngLat(Ge)},wo.prototype.coordinateLocation=function(Ne){return Ne.toLngLat()},wo.prototype.pointCoordinate=function(Ge){var Qe=[Ge.x,Ge.y,0,1],tt=[Ge.x,Ge.y,1,1];Ne.transformMat4(Qe,Qe,this.pixelMatrixInverse),Ne.transformMat4(tt,tt,this.pixelMatrixInverse);var rt=Qe[3],nt=tt[3],at=Qe[1]/rt,it=tt[1]/nt,ot=Qe[2]/rt,dt=tt[2]/nt,ht=ot===dt?0:(0-ot)/(dt-ot);return new Ne.MercatorCoordinate(Ne.number(Qe[0]/rt,tt[0]/nt,ht)/this.worldSize,Ne.number(at,it,ht)/this.worldSize)},wo.prototype.coordinatePoint=function(Ge){var Qe=[Ge.x*this.worldSize,Ge.y*this.worldSize,0,1];return Ne.transformMat4(Qe,Qe,this.pixelMatrix),new Ne.Point(Qe[0]/Qe[3],Qe[1]/Qe[3])},wo.prototype.getBounds=function(){return(new Ne.LngLatBounds).extend(this.pointLocation(new Ne.Point(0,0))).extend(this.pointLocation(new Ne.Point(this.width,0))).extend(this.pointLocation(new Ne.Point(this.width,this.height))).extend(this.pointLocation(new Ne.Point(0,this.height)))},wo.prototype.getMaxBounds=function(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new Ne.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},wo.prototype.setMaxBounds=function(Ne){Ne?(this.lngRange=[Ne.getWest(),Ne.getEast()],this.latRange=[Ne.getSouth(),Ne.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},wo.prototype.calculatePosMatrix=function(Ge,Qe){void 0===Qe&&(Qe=!1);var tt=Ge.key,rt=Qe?this._alignedPosMatrixCache:this._posMatrixCache;if(rt[tt])return rt[tt];var nt=Ge.canonical,at=this.worldSize/this.zoomScale(nt.z),it=nt.x+Math.pow(2,nt.z)*Ge.wrap,ot=Ne.identity(new Float64Array(16));return Ne.translate(ot,ot,[it*at,nt.y*at,0]),Ne.scale(ot,ot,[at/Ne.EXTENT,at/Ne.EXTENT,1]),Ne.multiply(ot,Qe?this.alignedProjMatrix:this.projMatrix,ot),rt[tt]=new Float32Array(ot),rt[tt]},wo.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},wo.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var Ge,Qe,tt,rt,nt=-90,at=90,it=-180,ot=180,dt=this.size,ht=this._unmodified;if(this.latRange){var Dt=this.latRange;nt=Ne.mercatorYfromLat(Dt[1])*this.worldSize,Ge=(at=Ne.mercatorYfromLat(Dt[0])*this.worldSize)-nt<dt.y?dt.y/(at-nt):0}if(this.lngRange){var Ot=this.lngRange;it=Ne.mercatorXfromLng(Ot[0])*this.worldSize,Qe=(ot=Ne.mercatorXfromLng(Ot[1])*this.worldSize)-it<dt.x?dt.x/(ot-it):0}var Rt=this.point,Zt=Math.max(Qe||0,Ge||0);if(Zt)return this.center=this.unproject(new Ne.Point(Qe?(ot+it)/2:Rt.x,Ge?(at+nt)/2:Rt.y)),this.zoom+=this.scaleZoom(Zt),this._unmodified=ht,void(this._constraining=!1);if(this.latRange){var er=Rt.y,dr=dt.y/2;er-dr<nt&&(rt=nt+dr),er+dr>at&&(rt=at-dr)}if(this.lngRange){var mr=Rt.x,xr=dt.x/2;mr-xr<it&&(tt=it+xr),mr+xr>ot&&(tt=ot-xr)}void 0===tt&&void 0===rt||(this.center=this.unproject(new Ne.Point(void 0!==tt?tt:Rt.x,void 0!==rt?rt:Rt.y))),this._unmodified=ht,this._constraining=!1}},wo.prototype._calcMatrices=function(){if(this.height){var Ge=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var Qe=Math.PI/2+this._pitch,tt=this._fov*(.5+Ge.y/this.height),rt=Math.sin(tt)*this.cameraToCenterDistance/Math.sin(Ne.clamp(Math.PI-Qe-tt,.01,Math.PI-.01)),nt=this.point,at=nt.x,it=nt.y,ot=1.01*(Math.cos(Math.PI/2-this._pitch)*rt+this.cameraToCenterDistance),dt=this.height/50,ht=new Float64Array(16);Ne.perspective(ht,this._fov,this.width/this.height,dt,ot),ht[8]=2*-Ge.x/this.width,ht[9]=2*Ge.y/this.height,Ne.scale(ht,ht,[1,-1,1]),Ne.translate(ht,ht,[0,0,-this.cameraToCenterDistance]),Ne.rotateX(ht,ht,this._pitch),Ne.rotateZ(ht,ht,this.angle),Ne.translate(ht,ht,[-at,-it,0]),this.mercatorMatrix=Ne.scale([],ht,[this.worldSize,this.worldSize,this.worldSize]),Ne.scale(ht,ht,[1,1,Ne.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=ht,this.invProjMatrix=Ne.invert([],this.projMatrix);var Dt=this.width%2/2,Ot=this.height%2/2,Rt=Math.cos(this.angle),Zt=Math.sin(this.angle),er=at-Math.round(at)+Rt*Dt+Zt*Ot,dr=it-Math.round(it)+Rt*Ot+Zt*Dt,mr=new Float64Array(ht);if(Ne.translate(mr,mr,[er>.5?er-1:er,dr>.5?dr-1:dr,0]),this.alignedProjMatrix=mr,ht=Ne.create(),Ne.scale(ht,ht,[this.width/2,-this.height/2,1]),Ne.translate(ht,ht,[1,-1,0]),this.labelPlaneMatrix=ht,ht=Ne.create(),Ne.scale(ht,ht,[1,-1,1]),Ne.translate(ht,ht,[-1,-1,0]),Ne.scale(ht,ht,[2/this.width,2/this.height,1]),this.glCoordMatrix=ht,this.pixelMatrix=Ne.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(ht=Ne.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=ht,this._posMatrixCache={},this._alignedPosMatrixCache={}}},wo.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var Ge=this.pointCoordinate(new Ne.Point(0,0)),Qe=[Ge.x*this.worldSize,Ge.y*this.worldSize,0,1];return Ne.transformMat4(Qe,Qe,this.pixelMatrix)[3]/this.cameraToCenterDistance},wo.prototype.getCameraPoint=function(){var Ge=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new Ne.Point(0,Ge))},wo.prototype.getCameraQueryGeometry=function(Ge){var Qe=this.getCameraPoint();if(1===Ge.length)return[Ge[0],Qe];for(var tt=Qe.x,rt=Qe.y,nt=Qe.x,at=Qe.y,it=0,ot=Ge;it<ot.length;it+=1){var dt=ot[it];tt=Math.min(tt,dt.x),rt=Math.min(rt,dt.y),nt=Math.max(nt,dt.x),at=Math.max(at,dt.y)}return[new Ne.Point(tt,rt),new Ne.Point(nt,rt),new Ne.Point(nt,at),new Ne.Point(tt,at),new Ne.Point(tt,rt)]},Object.defineProperties(wo.prototype,vc);var Eo=function(Ge){var Qe,tt,rt,nt;this._hashName=Ge&&encodeURIComponent(Ge),Ne.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(Qe=this._updateHashUnthrottled.bind(this),tt=!1,rt=null,nt=function(){rt=null,tt&&(Qe(),rt=setTimeout(nt,300),tt=!1)},function(){return tt=!0,rt||nt(),rt})};Eo.prototype.addTo=function(Ge){return this._map=Ge,Ne.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},Eo.prototype.remove=function(){return Ne.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},Eo.prototype.getHashString=function(Ge){var Qe=this._map.getCenter(),tt=Math.round(100*this._map.getZoom())/100,rt=Math.ceil((tt*Math.LN2+Math.log(512/360/.5))/Math.LN10),nt=Math.pow(10,rt),at=Math.round(Qe.lng*nt)/nt,it=Math.round(Qe.lat*nt)/nt,ot=this._map.getBearing(),dt=this._map.getPitch(),ht="";if(ht+=Ge?"/"+at+"/"+it+"/"+tt:tt+"/"+it+"/"+at,(ot||dt)&&(ht+="/"+Math.round(10*ot)/10),dt&&(ht+="/"+Math.round(dt)),this._hashName){var Dt=this._hashName,Ot=!1,Rt=Ne.window.location.hash.slice(1).split("&").map((function(Ne){var Ge=Ne.split("=")[0];return Ge===Dt?(Ot=!0,Ge+"="+ht):Ne})).filter((function(Ne){return Ne}));return Ot||Rt.push(Dt+"="+ht),"#"+Rt.join("&")}return"#"+ht},Eo.prototype._getCurrentHash=function(){var Ge,Qe=this,tt=Ne.window.location.hash.replace("#","");return this._hashName?(tt.split("&").map((function(Ne){return Ne.split("=")})).forEach((function(Ne){Ne[0]===Qe._hashName&&(Ge=Ne)})),(Ge&&Ge[1]||"").split("/")):tt.split("/")},Eo.prototype._onHashChange=function(){var Ne=this._getCurrentHash();if(Ne.length>=3&&!Ne.some((function(Ne){return isNaN(Ne)}))){var Ge=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(Ne[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+Ne[2],+Ne[1]],zoom:+Ne[0],bearing:Ge,pitch:+(Ne[4]||0)}),!0}return!1},Eo.prototype._updateHashUnthrottled=function(){var Ge=this.getHashString();try{Ne.window.history.replaceState(Ne.window.history.state,"",Ge)}catch(Ne){}};var yc={linearity:.3,easing:Ne.bezier(0,0,.3,1)},xc=Ne.extend({deceleration:2500,maxSpeed:1400},yc),bc=Ne.extend({deceleration:20,maxSpeed:1400},yc),_c=Ne.extend({deceleration:1e3,maxSpeed:360},yc),wc=Ne.extend({deceleration:1e3,maxSpeed:90},yc),Do=function(Ne){this._map=Ne,this.clear()};function Mo(Ne,Ge){(!Ne.duration||Ne.duration<Ge.duration)&&(Ne.duration=Ge.duration,Ne.easing=Ge.easing)}function Lo(Ge,Qe,tt){var rt=tt.maxSpeed,nt=tt.linearity,at=tt.deceleration,it=Ne.clamp(Ge*nt/(Qe/1e3),-rt,rt),ot=Math.abs(it)/(at*nt);return{easing:tt.easing,duration:1e3*ot,amount:it*(ot/2)}}Do.prototype.clear=function(){this._inertiaBuffer=[]},Do.prototype.record=function(Ge){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Ne.browser.now(),settings:Ge})},Do.prototype._drainInertiaBuffer=function(){for(var Ge=this._inertiaBuffer,Qe=Ne.browser.now();Ge.length>0&&Qe-Ge[0].time>160;)Ge.shift()},Do.prototype._onMoveEnd=function(Ge){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var Qe={zoom:0,bearing:0,pitch:0,pan:new Ne.Point(0,0),pinchAround:void 0,around:void 0},tt=0,rt=this._inertiaBuffer;tt<rt.length;tt+=1){var nt=rt[tt].settings;Qe.zoom+=nt.zoomDelta||0,Qe.bearing+=nt.bearingDelta||0,Qe.pitch+=nt.pitchDelta||0,nt.panDelta&&Qe.pan._add(nt.panDelta),nt.around&&(Qe.around=nt.around),nt.pinchAround&&(Qe.pinchAround=nt.pinchAround)}var at=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,it={};if(Qe.pan.mag()){var ot=Lo(Qe.pan.mag(),at,Ne.extend({},xc,Ge||{}));it.offset=Qe.pan.mult(ot.amount/Qe.pan.mag()),it.center=this._map.transform.center,Mo(it,ot)}if(Qe.zoom){var dt=Lo(Qe.zoom,at,bc);it.zoom=this._map.transform.zoom+dt.amount,Mo(it,dt)}if(Qe.bearing){var ht=Lo(Qe.bearing,at,_c);it.bearing=this._map.transform.bearing+Ne.clamp(ht.amount,-179,179),Mo(it,ht)}if(Qe.pitch){var Dt=Lo(Qe.pitch,at,wc);it.pitch=this._map.transform.pitch+Dt.amount,Mo(it,Dt)}if(it.zoom||it.bearing){var Ot=void 0===Qe.pinchAround?Qe.around:Qe.pinchAround;it.around=Ot?this._map.unproject(Ot):this._map.getCenter()}return this.clear(),Ne.extend(it,{noMoveStart:!0})}};var Tc=function(Ge){function o(tt,rt,nt,at){void 0===at&&(at={});var it=Qe.mousePos(rt.getCanvasContainer(),nt),ot=rt.unproject(it);Ge.call(this,tt,Ne.extend({point:it,lngLat:ot,originalEvent:nt},at)),this._defaultPrevented=!1,this.target=rt}Ge&&(o.__proto__=Ge),(o.prototype=Object.create(Ge&&Ge.prototype)).constructor=o;var tt={defaultPrevented:{configurable:!0}};return o.prototype.preventDefault=function(){this._defaultPrevented=!0},tt.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(o.prototype,tt),o}(Ne.Event),kc=function(Ge){function o(tt,rt,nt){var at="touchend"===tt?nt.changedTouches:nt.touches,it=Qe.touchPos(rt.getCanvasContainer(),at),ot=it.map((function(Ne){return rt.unproject(Ne)})),dt=it.reduce((function(Ne,Ge,Qe,tt){return Ne.add(Ge.div(tt.length))}),new Ne.Point(0,0)),ht=rt.unproject(dt);Ge.call(this,tt,{points:it,point:dt,lngLats:ot,lngLat:ht,originalEvent:nt}),this._defaultPrevented=!1}Ge&&(o.__proto__=Ge),(o.prototype=Object.create(Ge&&Ge.prototype)).constructor=o;var tt={defaultPrevented:{configurable:!0}};return o.prototype.preventDefault=function(){this._defaultPrevented=!0},tt.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(o.prototype,tt),o}(Ne.Event),Ac=function(Ne){function e(Ge,Qe,tt){Ne.call(this,Ge,{originalEvent:tt}),this._defaultPrevented=!1}Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e;var Ge={defaultPrevented:{configurable:!0}};return e.prototype.preventDefault=function(){this._defaultPrevented=!0},Ge.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(e.prototype,Ge),e}(Ne.Event),Bo=function(Ne,Ge){this._map=Ne,this._clickTolerance=Ge.clickTolerance};Bo.prototype.reset=function(){delete this._mousedownPos},Bo.prototype.wheel=function(Ne){return this._firePreventable(new Ac(Ne.type,this._map,Ne))},Bo.prototype.mousedown=function(Ne,Ge){return this._mousedownPos=Ge,this._firePreventable(new Tc(Ne.type,this._map,Ne))},Bo.prototype.mouseup=function(Ne){this._map.fire(new Tc(Ne.type,this._map,Ne))},Bo.prototype.click=function(Ne,Ge){this._mousedownPos&&this._mousedownPos.dist(Ge)>=this._clickTolerance||this._map.fire(new Tc(Ne.type,this._map,Ne))},Bo.prototype.dblclick=function(Ne){return this._firePreventable(new Tc(Ne.type,this._map,Ne))},Bo.prototype.mouseover=function(Ne){this._map.fire(new Tc(Ne.type,this._map,Ne))},Bo.prototype.mouseout=function(Ne){this._map.fire(new Tc(Ne.type,this._map,Ne))},Bo.prototype.touchstart=function(Ne){return this._firePreventable(new kc(Ne.type,this._map,Ne))},Bo.prototype.touchmove=function(Ne){this._map.fire(new kc(Ne.type,this._map,Ne))},Bo.prototype.touchend=function(Ne){this._map.fire(new kc(Ne.type,this._map,Ne))},Bo.prototype.touchcancel=function(Ne){this._map.fire(new kc(Ne.type,this._map,Ne))},Bo.prototype._firePreventable=function(Ne){if(this._map.fire(Ne),Ne.defaultPrevented)return{}},Bo.prototype.isEnabled=function(){return!0},Bo.prototype.isActive=function(){return!1},Bo.prototype.enable=function(){},Bo.prototype.disable=function(){};var Oo=function(Ne){this._map=Ne};Oo.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},Oo.prototype.mousemove=function(Ne){this._map.fire(new Tc(Ne.type,this._map,Ne))},Oo.prototype.mousedown=function(){this._delayContextMenu=!0},Oo.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Tc("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},Oo.prototype.contextmenu=function(Ne){this._delayContextMenu?this._contextMenuEvent=Ne:this._map.fire(new Tc(Ne.type,this._map,Ne)),this._map.listens("contextmenu")&&Ne.preventDefault()},Oo.prototype.isEnabled=function(){return!0},Oo.prototype.isActive=function(){return!1},Oo.prototype.enable=function(){},Oo.prototype.disable=function(){};var Fo=function(Ne,Ge){this._map=Ne,this._el=Ne.getCanvasContainer(),this._container=Ne.getContainer(),this._clickTolerance=Ge.clickTolerance||1};function Uo(Ne,Ge){for(var Qe={},tt=0;tt<Ne.length;tt++)Qe[Ne[tt].identifier]=Ge[tt];return Qe}Fo.prototype.isEnabled=function(){return!!this._enabled},Fo.prototype.isActive=function(){return!!this._active},Fo.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},Fo.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},Fo.prototype.mousedown=function(Ne,Ge){this.isEnabled()&&Ne.shiftKey&&0===Ne.button&&(Qe.disableDrag(),this._startPos=this._lastPos=Ge,this._active=!0)},Fo.prototype.mousemoveWindow=function(Ne,Ge){if(this._active){var tt=Ge;if(!(this._lastPos.equals(tt)||!this._box&&tt.dist(this._startPos)<this._clickTolerance)){var rt=this._startPos;this._lastPos=tt,this._box||(this._box=Qe.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",Ne));var nt=Math.min(rt.x,tt.x),at=Math.max(rt.x,tt.x),it=Math.min(rt.y,tt.y),ot=Math.max(rt.y,tt.y);Qe.setTransform(this._box,"translate("+nt+"px,"+it+"px)"),this._box.style.width=at-nt+"px",this._box.style.height=ot-it+"px"}}},Fo.prototype.mouseupWindow=function(Ge,tt){var rt=this;if(this._active&&0===Ge.button){var nt=this._startPos,at=tt;if(this.reset(),Qe.suppressClick(),nt.x!==at.x||nt.y!==at.y)return this._map.fire(new Ne.Event("boxzoomend",{originalEvent:Ge})),{cameraAnimation:function(Ne){return Ne.fitScreenCoordinates(nt,at,rt._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",Ge)}},Fo.prototype.keydown=function(Ne){this._active&&27===Ne.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",Ne))},Fo.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(Qe.remove(this._box),this._box=null),Qe.enableDrag(),delete this._startPos,delete this._lastPos},Fo.prototype._fireEvent=function(Ge,Qe){return this._map.fire(new Ne.Event(Ge,{originalEvent:Qe}))};var No=function(Ne){this.reset(),this.numTouches=Ne.numTouches};No.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},No.prototype.touchstart=function(Ge,Qe,tt){(this.centroid||tt.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=Ge.timeStamp),tt.length===this.numTouches&&(this.centroid=function(Ge){for(var Qe=new Ne.Point(0,0),tt=0,rt=Ge;tt<rt.length;tt+=1)Qe._add(rt[tt]);return Qe.div(Ge.length)}(Qe),this.touches=Uo(tt,Qe)))},No.prototype.touchmove=function(Ne,Ge,Qe){if(!this.aborted&&this.centroid){var tt=Uo(Qe,Ge);for(var rt in this.touches){var nt=tt[rt];(!nt||nt.dist(this.touches[rt])>30)&&(this.aborted=!0)}}},No.prototype.touchend=function(Ne,Ge,Qe){if((!this.centroid||Ne.timeStamp-this.startTime>500)&&(this.aborted=!0),0===Qe.length){var tt=!this.aborted&&this.centroid;if(this.reset(),tt)return tt}};var Zo=function(Ne){this.singleTap=new No(Ne),this.numTaps=Ne.numTaps,this.reset()};Zo.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Zo.prototype.touchstart=function(Ne,Ge,Qe){this.singleTap.touchstart(Ne,Ge,Qe)},Zo.prototype.touchmove=function(Ne,Ge,Qe){this.singleTap.touchmove(Ne,Ge,Qe)},Zo.prototype.touchend=function(Ne,Ge,Qe){var tt=this.singleTap.touchend(Ne,Ge,Qe);if(tt){var rt=Ne.timeStamp-this.lastTime<500,nt=!this.lastTap||this.lastTap.dist(tt)<30;if(rt&&nt||this.reset(),this.count++,this.lastTime=Ne.timeStamp,this.lastTap=tt,this.count===this.numTaps)return this.reset(),tt}};var jo=function(){this._zoomIn=new Zo({numTouches:1,numTaps:2}),this._zoomOut=new Zo({numTouches:2,numTaps:1}),this.reset()};jo.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},jo.prototype.touchstart=function(Ne,Ge,Qe){this._zoomIn.touchstart(Ne,Ge,Qe),this._zoomOut.touchstart(Ne,Ge,Qe)},jo.prototype.touchmove=function(Ne,Ge,Qe){this._zoomIn.touchmove(Ne,Ge,Qe),this._zoomOut.touchmove(Ne,Ge,Qe)},jo.prototype.touchend=function(Ne,Ge,Qe){var tt=this,rt=this._zoomIn.touchend(Ne,Ge,Qe),nt=this._zoomOut.touchend(Ne,Ge,Qe);return rt?(this._active=!0,Ne.preventDefault(),setTimeout((function(){return tt.reset()}),0),{cameraAnimation:function(Ge){return Ge.easeTo({duration:300,zoom:Ge.getZoom()+1,around:Ge.unproject(rt)},{originalEvent:Ne})}}):nt?(this._active=!0,Ne.preventDefault(),setTimeout((function(){return tt.reset()}),0),{cameraAnimation:function(Ge){return Ge.easeTo({duration:300,zoom:Ge.getZoom()-1,around:Ge.unproject(nt)},{originalEvent:Ne})}}):void 0},jo.prototype.touchcancel=function(){this.reset()},jo.prototype.enable=function(){this._enabled=!0},jo.prototype.disable=function(){this._enabled=!1,this.reset()},jo.prototype.isEnabled=function(){return this._enabled},jo.prototype.isActive=function(){return this._active};var qo=function(Ne){this.reset(),this._clickTolerance=Ne.clickTolerance||1};qo.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},qo.prototype._correctButton=function(Ne,Ge){return!1},qo.prototype._move=function(Ne,Ge){return{}},qo.prototype.mousedown=function(Ne,Ge){if(!this._lastPoint){var tt=Qe.mouseButton(Ne);this._correctButton(Ne,tt)&&(this._lastPoint=Ge,this._eventButton=tt)}},qo.prototype.mousemoveWindow=function(Ne,Ge){var Qe=this._lastPoint;if(Qe&&(Ne.preventDefault(),this._moved||!(Ge.dist(Qe)<this._clickTolerance)))return this._moved=!0,this._lastPoint=Ge,this._move(Qe,Ge)},qo.prototype.mouseupWindow=function(Ne){Qe.mouseButton(Ne)===this._eventButton&&(this._moved&&Qe.suppressClick(),this.reset())},qo.prototype.enable=function(){this._enabled=!0},qo.prototype.disable=function(){this._enabled=!1,this.reset()},qo.prototype.isEnabled=function(){return this._enabled},qo.prototype.isActive=function(){return this._active};var Mc=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.mousedown=function(Ge,Qe){Ne.prototype.mousedown.call(this,Ge,Qe),this._lastPoint&&(this._active=!0)},e.prototype._correctButton=function(Ne,Ge){return 0===Ge&&!Ne.ctrlKey},e.prototype._move=function(Ne,Ge){return{around:Ge,panDelta:Ge.sub(Ne)}},e}(qo),Sc=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype._correctButton=function(Ne,Ge){return 0===Ge&&Ne.ctrlKey||2===Ge},e.prototype._move=function(Ne,Ge){var Qe=.8*(Ge.x-Ne.x);if(Qe)return this._active=!0,{bearingDelta:Qe}},e.prototype.contextmenu=function(Ne){Ne.preventDefault()},e}(qo),Cc=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype._correctButton=function(Ne,Ge){return 0===Ge&&Ne.ctrlKey||2===Ge},e.prototype._move=function(Ne,Ge){var Qe=-.5*(Ge.y-Ne.y);if(Qe)return this._active=!0,{pitchDelta:Qe}},e.prototype.contextmenu=function(Ne){Ne.preventDefault()},e}(qo),Xo=function(Ne){this._minTouches=1,this._clickTolerance=Ne.clickTolerance||1,this.reset()};Xo.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new Ne.Point(0,0)},Xo.prototype.touchstart=function(Ne,Ge,Qe){return this._calculateTransform(Ne,Ge,Qe)},Xo.prototype.touchmove=function(Ne,Ge,Qe){if(this._active)return Ne.preventDefault(),this._calculateTransform(Ne,Ge,Qe)},Xo.prototype.touchend=function(Ne,Ge,Qe){this._calculateTransform(Ne,Ge,Qe),this._active&&Qe.length<this._minTouches&&this.reset()},Xo.prototype.touchcancel=function(){this.reset()},Xo.prototype._calculateTransform=function(Ge,Qe,tt){tt.length>0&&(this._active=!0);var rt=Uo(tt,Qe),nt=new Ne.Point(0,0),at=new Ne.Point(0,0),it=0;for(var ot in rt){var dt=rt[ot],ht=this._touches[ot];ht&&(nt._add(dt),at._add(dt.sub(ht)),it++,rt[ot]=dt)}if(this._touches=rt,!(it<this._minTouches)&&at.mag()){var Dt=at.div(it);if(this._sum._add(Dt),!(this._sum.mag()<this._clickTolerance))return{around:nt.div(it),panDelta:Dt}}},Xo.prototype.enable=function(){this._enabled=!0},Xo.prototype.disable=function(){this._enabled=!1,this.reset()},Xo.prototype.isEnabled=function(){return this._enabled},Xo.prototype.isActive=function(){return this._active};var Ho=function(){this.reset()};function Ko(Ne,Ge,Qe){for(var tt=0;tt<Ne.length;tt++)if(Ne[tt].identifier===Qe)return Ge[tt]}function Yo(Ne,Ge){return Math.log(Ne/Ge)/Math.LN2}Ho.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},Ho.prototype._start=function(Ne){},Ho.prototype._move=function(Ne,Ge,Qe){return{}},Ho.prototype.touchstart=function(Ne,Ge,Qe){this._firstTwoTouches||Qe.length<2||(this._firstTwoTouches=[Qe[0].identifier,Qe[1].identifier],this._start([Ge[0],Ge[1]]))},Ho.prototype.touchmove=function(Ne,Ge,Qe){if(this._firstTwoTouches){Ne.preventDefault();var tt=this._firstTwoTouches,rt=tt[1],nt=Ko(Qe,Ge,tt[0]),at=Ko(Qe,Ge,rt);if(nt&&at){var it=this._aroundCenter?null:nt.add(at).div(2);return this._move([nt,at],it,Ne)}}},Ho.prototype.touchend=function(Ne,Ge,tt){if(this._firstTwoTouches){var rt=this._firstTwoTouches,nt=rt[1],at=Ko(tt,Ge,rt[0]),it=Ko(tt,Ge,nt);at&&it||(this._active&&Qe.suppressClick(),this.reset())}},Ho.prototype.touchcancel=function(){this.reset()},Ho.prototype.enable=function(Ne){this._enabled=!0,this._aroundCenter=!!Ne&&"center"===Ne.around},Ho.prototype.disable=function(){this._enabled=!1,this.reset()},Ho.prototype.isEnabled=function(){return this._enabled},Ho.prototype.isActive=function(){return this._active};var Ec=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.reset=function(){Ne.prototype.reset.call(this),delete this._distance,delete this._startDistance},e.prototype._start=function(Ne){this._startDistance=this._distance=Ne[0].dist(Ne[1])},e.prototype._move=function(Ne,Ge){var Qe=this._distance;if(this._distance=Ne[0].dist(Ne[1]),this._active||!(Math.abs(Yo(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Yo(this._distance,Qe),pinchAround:Ge}},e}(Ho);function Qo(Ne,Ge){return 180*Ne.angleWith(Ge)/Math.PI}var Lc=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.reset=function(){Ne.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},e.prototype._start=function(Ne){this._startVector=this._vector=Ne[0].sub(Ne[1]),this._minDiameter=Ne[0].dist(Ne[1])},e.prototype._move=function(Ne,Ge){var Qe=this._vector;if(this._vector=Ne[0].sub(Ne[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Qo(this._vector,Qe),pinchAround:Ge}},e.prototype._isBelowThreshold=function(Ne){this._minDiameter=Math.min(this._minDiameter,Ne.mag());var Ge=25/(Math.PI*this._minDiameter)*360,Qe=Qo(Ne,this._startVector);return Math.abs(Qe)<Ge},e}(Ho);function tr(Ne){return Math.abs(Ne.y)>Math.abs(Ne.x)}var Pc=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e.prototype.reset=function(){Ne.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},e.prototype._start=function(Ne){this._lastPoints=Ne,tr(Ne[0].sub(Ne[1]))&&(this._valid=!1)},e.prototype._move=function(Ne,Ge,Qe){var tt=Ne[0].sub(this._lastPoints[0]),rt=Ne[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(tt,rt,Qe.timeStamp),this._valid)return this._lastPoints=Ne,this._active=!0,{pitchDelta:(tt.y+rt.y)/2*-.5}},e.prototype.gestureBeginsVertically=function(Ne,Ge,Qe){if(void 0!==this._valid)return this._valid;var tt=Ne.mag()>=2,rt=Ge.mag()>=2;if(tt||rt){if(!tt||!rt)return void 0===this._firstMove&&(this._firstMove=Qe),Qe-this._firstMove<100&&void 0;var nt=Ne.y>0==Ge.y>0;return tr(Ne)&&tr(Ge)&&nt}},e}(Ho),Dc={panStep:100,bearingStep:15,pitchStep:10},or=function(){var Ne=Dc;this._panStep=Ne.panStep,this._bearingStep=Ne.bearingStep,this._pitchStep=Ne.pitchStep};function rr(Ne){return Ne*(2-Ne)}or.prototype.reset=function(){this._active=!1},or.prototype.keydown=function(Ne){var Ge=this;if(!(Ne.altKey||Ne.ctrlKey||Ne.metaKey)){var Qe=0,tt=0,rt=0,nt=0,at=0;switch(Ne.keyCode){case 61:case 107:case 171:case 187:Qe=1;break;case 189:case 109:case 173:Qe=-1;break;case 37:Ne.shiftKey?tt=-1:(Ne.preventDefault(),nt=-1);break;case 39:Ne.shiftKey?tt=1:(Ne.preventDefault(),nt=1);break;case 38:Ne.shiftKey?rt=1:(Ne.preventDefault(),at=-1);break;case 40:Ne.shiftKey?rt=-1:(Ne.preventDefault(),at=1);break;default:return}return{cameraAnimation:function(it){var ot=it.getZoom();it.easeTo({duration:300,easeId:"keyboardHandler",easing:rr,zoom:Qe?Math.round(ot)+Qe*(Ne.shiftKey?2:1):ot,bearing:it.getBearing()+tt*Ge._bearingStep,pitch:it.getPitch()+rt*Ge._pitchStep,offset:[-nt*Ge._panStep,-at*Ge._panStep],center:it.getCenter()},{originalEvent:Ne})}}}},or.prototype.enable=function(){this._enabled=!0},or.prototype.disable=function(){this._enabled=!1,this.reset()},or.prototype.isEnabled=function(){return this._enabled},or.prototype.isActive=function(){return this._active};var ar=function(Ge,Qe){this._map=Ge,this._el=Ge.getCanvasContainer(),this._handler=Qe,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,Ne.bindAll(["_onWheel","_onTimeout","_onScrollFrame","_onScrollFinished"],this)};ar.prototype.setZoomRate=function(Ne){this._defaultZoomRate=Ne},ar.prototype.setWheelZoomRate=function(Ne){this._wheelZoomRate=Ne},ar.prototype.isEnabled=function(){return!!this._enabled},ar.prototype.isActive=function(){return!!this._active||void 0!==this._finishTimeout},ar.prototype.isZooming=function(){return!!this._zooming},ar.prototype.enable=function(Ne){this.isEnabled()||(this._enabled=!0,this._aroundCenter=Ne&&"center"===Ne.around)},ar.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},ar.prototype.wheel=function(Ge){if(this.isEnabled()){var Qe=Ge.deltaMode===Ne.window.WheelEvent.DOM_DELTA_LINE?40*Ge.deltaY:Ge.deltaY,tt=Ne.browser.now(),rt=tt-(this._lastWheelEventTime||0);this._lastWheelEventTime=tt,0!==Qe&&Qe%4.000244140625==0?this._type="wheel":0!==Qe&&Math.abs(Qe)<4?this._type="trackpad":rt>400?(this._type=null,this._lastValue=Qe,this._timeout=setTimeout(this._onTimeout,40,Ge)):this._type||(this._type=Math.abs(rt*Qe)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,Qe+=this._lastValue)),Ge.shiftKey&&Qe&&(Qe/=4),this._type&&(this._lastWheelEvent=Ge,this._delta-=Qe,this._active||this._start(Ge)),Ge.preventDefault()}},ar.prototype._onTimeout=function(Ne){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(Ne)},ar.prototype._start=function(Ge){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var tt=Qe.mousePos(this._el,Ge);this._around=Ne.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(tt)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},ar.prototype.renderFrame=function(){return this._onScrollFrame()},ar.prototype._onScrollFrame=function(){var Ge=this;if(this._frameId&&(this._frameId=null,this.isActive())){var Qe=this._map.transform;if(0!==this._delta){var tt="wheel"===this._type&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,rt=2/(1+Math.exp(-Math.abs(this._delta*tt)));this._delta<0&&0!==rt&&(rt=1/rt);var nt="number"==typeof this._targetZoom?Qe.zoomScale(this._targetZoom):Qe.scale;this._targetZoom=Math.min(Qe.maxZoom,Math.max(Qe.minZoom,Qe.scaleZoom(nt*rt))),"wheel"===this._type&&(this._startZoom=Qe.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var at,it="number"==typeof this._targetZoom?this._targetZoom:Qe.zoom,ot=this._startZoom,dt=this._easing,ht=!1;if("wheel"===this._type&&ot&&dt){var Dt=Math.min((Ne.browser.now()-this._lastWheelEventTime)/200,1),Ot=dt(Dt);at=Ne.number(ot,it,Ot),Dt<1?this._frameId||(this._frameId=!0):ht=!0}else at=it,ht=!0;return this._active=!0,ht&&(this._active=!1,this._finishTimeout=setTimeout((function(){Ge._zooming=!1,Ge._handler._triggerRenderFrame(),delete Ge._targetZoom,delete Ge._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!ht,zoomDelta:at-Qe.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},ar.prototype._smoothOutEasing=function(Ge){var Qe=Ne.ease;if(this._prevEase){var tt=this._prevEase,rt=(Ne.browser.now()-tt.start)/tt.duration,nt=tt.easing(rt+.01)-tt.easing(rt),at=.27/Math.sqrt(nt*nt+1e-4)*.01,it=Math.sqrt(.0729-at*at);Qe=Ne.bezier(at,it,.25,1)}return this._prevEase={start:Ne.browser.now(),duration:Ge,easing:Qe},Qe},ar.prototype.reset=function(){this._active=!1};var nr=function(Ne,Ge){this._clickZoom=Ne,this._tapZoom=Ge};nr.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},nr.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},nr.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},nr.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var sr=function(){this.reset()};sr.prototype.reset=function(){this._active=!1},sr.prototype.dblclick=function(Ne,Ge){return Ne.preventDefault(),{cameraAnimation:function(Qe){Qe.easeTo({duration:300,zoom:Qe.getZoom()+(Ne.shiftKey?-1:1),around:Qe.unproject(Ge)},{originalEvent:Ne})}}},sr.prototype.enable=function(){this._enabled=!0},sr.prototype.disable=function(){this._enabled=!1,this.reset()},sr.prototype.isEnabled=function(){return this._enabled},sr.prototype.isActive=function(){return this._active};var lr=function(){this._tap=new Zo({numTouches:1,numTaps:1}),this.reset()};lr.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},lr.prototype.touchstart=function(Ne,Ge,Qe){this._swipePoint||(this._tapTime&&Ne.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?Qe.length>0&&(this._swipePoint=Ge[0],this._swipeTouch=Qe[0].identifier):this._tap.touchstart(Ne,Ge,Qe))},lr.prototype.touchmove=function(Ne,Ge,Qe){if(this._tapTime){if(this._swipePoint){if(Qe[0].identifier!==this._swipeTouch)return;var tt=Ge[0],rt=tt.y-this._swipePoint.y;return this._swipePoint=tt,Ne.preventDefault(),this._active=!0,{zoomDelta:rt/128}}}else this._tap.touchmove(Ne,Ge,Qe)},lr.prototype.touchend=function(Ne,Ge,Qe){this._tapTime?this._swipePoint&&0===Qe.length&&this.reset():this._tap.touchend(Ne,Ge,Qe)&&(this._tapTime=Ne.timeStamp)},lr.prototype.touchcancel=function(){this.reset()},lr.prototype.enable=function(){this._enabled=!0},lr.prototype.disable=function(){this._enabled=!1,this.reset()},lr.prototype.isEnabled=function(){return this._enabled},lr.prototype.isActive=function(){return this._active};var cr=function(Ne,Ge,Qe){this._el=Ne,this._mousePan=Ge,this._touchPan=Qe};cr.prototype.enable=function(Ne){this._inertiaOptions=Ne||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},cr.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},cr.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},cr.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var ur=function(Ne,Ge,Qe){this._pitchWithRotate=Ne.pitchWithRotate,this._mouseRotate=Ge,this._mousePitch=Qe};ur.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},ur.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},ur.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},ur.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var hr=function(Ne,Ge,Qe,tt){this._el=Ne,this._touchZoom=Ge,this._touchRotate=Qe,this._tapDragZoom=tt,this._rotationDisabled=!1,this._enabled=!0};hr.prototype.enable=function(Ne){this._touchZoom.enable(Ne),this._rotationDisabled||this._touchRotate.enable(Ne),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},hr.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},hr.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},hr.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},hr.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},hr.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var pr=function(Ne){return Ne.zoom||Ne.drag||Ne.pitch||Ne.rotate},Ic=function(Ne){function e(){Ne.apply(this,arguments)}return Ne&&(e.__proto__=Ne),(e.prototype=Object.create(Ne&&Ne.prototype)).constructor=e,e}(Ne.Event);function _r(Ne){return Ne.panDelta&&Ne.panDelta.mag()||Ne.zoomDelta||Ne.bearingDelta||Ne.pitchDelta}var fr=function(Ge,tt){this._map=Ge,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Do(Ge),this._bearingSnap=tt.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(tt),Ne.bindAll(["handleEvent","handleWindowEvent"],this);var rt=this._el;this._listeners=[[rt,"touchstart",{passive:!1}],[rt,"touchmove",{passive:!1}],[rt,"touchend",void 0],[rt,"touchcancel",void 0],[rt,"mousedown",void 0],[rt,"mousemove",void 0],[rt,"mouseup",void 0],[Ne.window.document,"mousemove",{capture:!0}],[Ne.window.document,"mouseup",void 0],[rt,"mouseover",void 0],[rt,"mouseout",void 0],[rt,"dblclick",void 0],[rt,"click",void 0],[rt,"keydown",{capture:!1}],[rt,"keyup",void 0],[rt,"wheel",{passive:!1}],[rt,"contextmenu",void 0],[Ne.window,"blur",void 0]];for(var nt=0,at=this._listeners;nt<at.length;nt+=1){var it=at[nt],ot=it[0];Qe.addEventListener(ot,it[1],ot===Ne.window.document?this.handleWindowEvent:this.handleEvent,it[2])}};fr.prototype.destroy=function(){for(var Ge=0,tt=this._listeners;Ge<tt.length;Ge+=1){var rt=tt[Ge],nt=rt[0];Qe.removeEventListener(nt,rt[1],nt===Ne.window.document?this.handleWindowEvent:this.handleEvent,rt[2])}},fr.prototype._addDefaultHandlers=function(Ne){var Ge=this._map,Qe=Ge.getCanvasContainer();this._add("mapEvent",new Bo(Ge,Ne));var tt=Ge.boxZoom=new Fo(Ge,Ne);this._add("boxZoom",tt);var rt=new jo,nt=new sr;Ge.doubleClickZoom=new nr(nt,rt),this._add("tapZoom",rt),this._add("clickZoom",nt);var at=new lr;this._add("tapDragZoom",at);var it=Ge.touchPitch=new Pc;this._add("touchPitch",it);var ot=new Sc(Ne),dt=new Cc(Ne);Ge.dragRotate=new ur(Ne,ot,dt),this._add("mouseRotate",ot,["mousePitch"]),this._add("mousePitch",dt,["mouseRotate"]);var ht=new Mc(Ne),Dt=new Xo(Ne);Ge.dragPan=new cr(Qe,ht,Dt),this._add("mousePan",ht),this._add("touchPan",Dt,["touchZoom","touchRotate"]);var Ot=new Lc,Rt=new Ec;Ge.touchZoomRotate=new hr(Qe,Rt,Ot,at),this._add("touchRotate",Ot,["touchPan","touchZoom"]),this._add("touchZoom",Rt,["touchPan","touchRotate"]);var Zt=Ge.scrollZoom=new ar(Ge,this);this._add("scrollZoom",Zt,["mousePan"]);var er=Ge.keyboard=new or;this._add("keyboard",er),this._add("blockableMapEvent",new Oo(Ge));for(var dr=0,mr=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];dr<mr.length;dr+=1){var xr=mr[dr];Ne.interactive&&Ne[xr]&&Ge[xr].enable(Ne[xr])}},fr.prototype._add=function(Ne,Ge,Qe){this._handlers.push({handlerName:Ne,handler:Ge,allowed:Qe}),this._handlersById[Ne]=Ge},fr.prototype.stop=function(){if(!this._updatingCamera){for(var Ne=0,Ge=this._handlers;Ne<Ge.length;Ne+=1)Ge[Ne].handler.reset();this._inertia.clear(),this._fireEvents({},{}),this._changes=[]}},fr.prototype.isActive=function(){for(var Ne=0,Ge=this._handlers;Ne<Ge.length;Ne+=1)if(Ge[Ne].handler.isActive())return!0;return!1},fr.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},fr.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},fr.prototype.isMoving=function(){return Boolean(pr(this._eventsInProgress))||this.isZooming()},fr.prototype._blockedByActive=function(Ne,Ge,Qe){for(var tt in Ne)if(tt!==Qe&&(!Ge||Ge.indexOf(tt)<0))return!0;return!1},fr.prototype.handleWindowEvent=function(Ne){this.handleEvent(Ne,Ne.type+"Window")},fr.prototype._getMapTouches=function(Ne){for(var Ge=[],Qe=0,tt=Ne;Qe<tt.length;Qe+=1){var rt=tt[Qe];this._el.contains(rt.target)&&Ge.push(rt)}return Ge},fr.prototype.handleEvent=function(Ne,Ge){if("blur"!==Ne.type){this._updatingCamera=!0;for(var tt="renderFrame"===Ne.type?void 0:Ne,rt={needsRenderFrame:!1},nt={},at={},it=Ne.touches?this._getMapTouches(Ne.touches):void 0,ot=it?Qe.touchPos(this._el,it):Qe.mousePos(this._el,Ne),dt=0,ht=this._handlers;dt<ht.length;dt+=1){var Dt=ht[dt],Ot=Dt.handlerName,Rt=Dt.handler,Zt=Dt.allowed;if(Rt.isEnabled()){var er=void 0;this._blockedByActive(at,Zt,Ot)?Rt.reset():Rt[Ge||Ne.type]&&(er=Rt[Ge||Ne.type](Ne,ot,it),this.mergeHandlerResult(rt,nt,er,Ot,tt),er&&er.needsRenderFrame&&this._triggerRenderFrame()),(er||Rt.isActive())&&(at[Ot]=Rt)}}var dr={};for(var mr in this._previousActiveHandlers)at[mr]||(dr[mr]=tt);this._previousActiveHandlers=at,(Object.keys(dr).length||_r(rt))&&(this._changes.push([rt,nt,dr]),this._triggerRenderFrame()),(Object.keys(at).length||_r(rt))&&this._map._stop(!0),this._updatingCamera=!1;var xr=rt.cameraAnimation;xr&&(this._inertia.clear(),this._fireEvents({},{}),this._changes=[],xr(this._map))}else this.stop()},fr.prototype.mergeHandlerResult=function(Ge,Qe,tt,rt,nt){if(tt){Ne.extend(Ge,tt);var at={handlerName:rt,originalEvent:tt.originalEvent||nt};void 0!==tt.zoomDelta&&(Qe.zoom=at),void 0!==tt.panDelta&&(Qe.drag=at),void 0!==tt.pitchDelta&&(Qe.pitch=at),void 0!==tt.bearingDelta&&(Qe.rotate=at)}},fr.prototype._applyChanges=function(){for(var Ge={},Qe={},tt={},rt=0,nt=this._changes;rt<nt.length;rt+=1){var at=nt[rt],it=at[0],ot=at[1],dt=at[2];it.panDelta&&(Ge.panDelta=(Ge.panDelta||new Ne.Point(0,0))._add(it.panDelta)),it.zoomDelta&&(Ge.zoomDelta=(Ge.zoomDelta||0)+it.zoomDelta),it.bearingDelta&&(Ge.bearingDelta=(Ge.bearingDelta||0)+it.bearingDelta),it.pitchDelta&&(Ge.pitchDelta=(Ge.pitchDelta||0)+it.pitchDelta),void 0!==it.around&&(Ge.around=it.around),void 0!==it.pinchAround&&(Ge.pinchAround=it.pinchAround),it.noInertia&&(Ge.noInertia=it.noInertia),Ne.extend(Qe,ot),Ne.extend(tt,dt)}this._updateMapTransform(Ge,Qe,tt),this._changes=[]},fr.prototype._updateMapTransform=function(Ne,Ge,Qe){var tt=this._map,rt=tt.transform;if(!_r(Ne))return this._fireEvents(Ge,Qe);var nt=Ne.panDelta,at=Ne.zoomDelta,it=Ne.bearingDelta,ot=Ne.pitchDelta,dt=Ne.around,ht=Ne.pinchAround;void 0!==ht&&(dt=ht),tt._stop(!0),dt=dt||tt.transform.centerPoint;var Dt=rt.pointLocation(nt?dt.sub(nt):dt);it&&(rt.bearing+=it),ot&&(rt.pitch+=ot),at&&(rt.zoom+=at),rt.setLocationAtPoint(Dt,dt),this._map._update(),Ne.noInertia||this._inertia.record(Ne),this._fireEvents(Ge,Qe)},fr.prototype._fireEvents=function(Ge,Qe){var tt=this,rt=pr(this._eventsInProgress),nt=pr(Ge),at={};for(var it in Ge)this._eventsInProgress[it]||(at[it+"start"]=Ge[it].originalEvent),this._eventsInProgress[it]=Ge[it];for(var ot in!rt&&nt&&this._fireEvent("movestart",nt.originalEvent),at)this._fireEvent(ot,at[ot]);for(var dt in Ge.rotate&&(this._bearingChanged=!0),nt&&this._fireEvent("move",nt.originalEvent),Ge)this._fireEvent(dt,Ge[dt].originalEvent);var ht,Dt={};for(var Ot in this._eventsInProgress){var Rt=this._eventsInProgress[Ot],Zt=Rt.handlerName,er=Rt.originalEvent;this._handlersById[Zt].isActive()||(delete this._eventsInProgress[Ot],Dt[Ot+"end"]=ht=Qe[Zt]||er)}for(var dr in Dt)this._fireEvent(dr,Dt[dr]);var mr=pr(this._eventsInProgress);if((rt||nt)&&!mr){this._updatingCamera=!0;var xr=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),y=function(Ne){return 0!==Ne&&-tt._bearingSnap<Ne&&Ne<tt._bearingSnap};xr?(y(xr.bearing||this._map.getBearing())&&(xr.bearing=0),this._map.easeTo(xr,{originalEvent:ht})):(this._map.fire(new Ne.Event("moveend",{originalEvent:ht})),y(this._map.getBearing())&&this._map.resetNorth()),this._bearingChanged=!1,this._updatingCamera=!1}},fr.prototype._fireEvent=function(Ge,Qe){this._map.fire(new Ne.Event(Ge,Qe?{originalEvent:Qe}:{}))},fr.prototype._triggerRenderFrame=function(){var Ne=this;void 0===this._frameId&&(this._frameId=this._map._requestRenderFrame((function(Ge){delete Ne._frameId,Ne.handleEvent(new Ic("renderFrame",{timeStamp:Ge})),Ne._applyChanges()})))};var Oc=function(Ge){function i(Qe,tt){Ge.call(this),this._moving=!1,this._zooming=!1,this.transform=Qe,this._bearingSnap=tt.bearingSnap,Ne.bindAll(["_renderFrameCallback"],this)}return Ge&&(i.__proto__=Ge),(i.prototype=Object.create(Ge&&Ge.prototype)).constructor=i,i.prototype.getCenter=function(){return new Ne.LngLat(this.transform.center.lng,this.transform.center.lat)},i.prototype.setCenter=function(Ne,Ge){return this.jumpTo({center:Ne},Ge)},i.prototype.panBy=function(Ge,Qe,tt){return Ge=Ne.Point.convert(Ge).mult(-1),this.panTo(this.transform.center,Ne.extend({offset:Ge},Qe),tt)},i.prototype.panTo=function(Ge,Qe,tt){return this.easeTo(Ne.extend({center:Ge},Qe),tt)},i.prototype.getZoom=function(){return this.transform.zoom},i.prototype.setZoom=function(Ne,Ge){return this.jumpTo({zoom:Ne},Ge),this},i.prototype.zoomTo=function(Ge,Qe,tt){return this.easeTo(Ne.extend({zoom:Ge},Qe),tt)},i.prototype.zoomIn=function(Ne,Ge){return this.zoomTo(this.getZoom()+1,Ne,Ge),this},i.prototype.zoomOut=function(Ne,Ge){return this.zoomTo(this.getZoom()-1,Ne,Ge),this},i.prototype.getBearing=function(){return this.transform.bearing},i.prototype.setBearing=function(Ne,Ge){return this.jumpTo({bearing:Ne},Ge),this},i.prototype.getPadding=function(){return this.transform.padding},i.prototype.setPadding=function(Ne,Ge){return this.jumpTo({padding:Ne},Ge),this},i.prototype.rotateTo=function(Ge,Qe,tt){return this.easeTo(Ne.extend({bearing:Ge},Qe),tt)},i.prototype.resetNorth=function(Ge,Qe){return this.rotateTo(0,Ne.extend({duration:1e3},Ge),Qe),this},i.prototype.resetNorthPitch=function(Ge,Qe){return this.easeTo(Ne.extend({bearing:0,pitch:0,duration:1e3},Ge),Qe),this},i.prototype.snapToNorth=function(Ne,Ge){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(Ne,Ge):this},i.prototype.getPitch=function(){return this.transform.pitch},i.prototype.setPitch=function(Ne,Ge){return this.jumpTo({pitch:Ne},Ge),this},i.prototype.cameraForBounds=function(Ge,Qe){return Ge=Ne.LngLatBounds.convert(Ge),this._cameraForBoxAndBearing(Ge.getNorthWest(),Ge.getSouthEast(),0,Qe)},i.prototype._cameraForBoxAndBearing=function(Ge,Qe,tt,rt){var nt={top:0,bottom:0,right:0,left:0};if("number"==typeof(rt=Ne.extend({padding:nt,offset:[0,0],maxZoom:this.transform.maxZoom},rt)).padding){var at=rt.padding;rt.padding={top:at,bottom:at,right:at,left:at}}rt.padding=Ne.extend(nt,rt.padding);var it=this.transform,ot=it.padding,dt=it.project(Ne.LngLat.convert(Ge)),ht=it.project(Ne.LngLat.convert(Qe)),Dt=dt.rotate(-tt*Math.PI/180),Ot=ht.rotate(-tt*Math.PI/180),Rt=new Ne.Point(Math.max(Dt.x,Ot.x),Math.max(Dt.y,Ot.y)),Zt=new Ne.Point(Math.min(Dt.x,Ot.x),Math.min(Dt.y,Ot.y)),er=Rt.sub(Zt),dr=(it.width-(ot.left+ot.right+rt.padding.left+rt.padding.right))/er.x,mr=(it.height-(ot.top+ot.bottom+rt.padding.top+rt.padding.bottom))/er.y;if(!(mr<0||dr<0)){var xr=Math.min(it.scaleZoom(it.scale*Math.min(dr,mr)),rt.maxZoom),br=Ne.Point.convert(rt.offset),Ar=new Ne.Point(br.x+(rt.padding.left-rt.padding.right)/2,br.y+(rt.padding.top-rt.padding.bottom)/2).mult(it.scale/it.zoomScale(xr));return{center:it.unproject(dt.add(ht).div(2).sub(Ar)),zoom:xr,bearing:tt}}Ne.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},i.prototype.fitBounds=function(Ne,Ge,Qe){return this._fitInternal(this.cameraForBounds(Ne,Ge),Ge,Qe)},i.prototype.fitScreenCoordinates=function(Ge,Qe,tt,rt,nt){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(Ne.Point.convert(Ge)),this.transform.pointLocation(Ne.Point.convert(Qe)),tt,rt),rt,nt)},i.prototype._fitInternal=function(Ge,Qe,tt){return Ge?(delete(Qe=Ne.extend(Ge,Qe)).padding,Qe.linear?this.easeTo(Qe,tt):this.flyTo(Qe,tt)):this},i.prototype.jumpTo=function(Ge,Qe){this.stop();var tt=this.transform,rt=!1,nt=!1,at=!1;return"zoom"in Ge&&tt.zoom!==+Ge.zoom&&(rt=!0,tt.zoom=+Ge.zoom),void 0!==Ge.center&&(tt.center=Ne.LngLat.convert(Ge.center)),"bearing"in Ge&&tt.bearing!==+Ge.bearing&&(nt=!0,tt.bearing=+Ge.bearing),"pitch"in Ge&&tt.pitch!==+Ge.pitch&&(at=!0,tt.pitch=+Ge.pitch),null==Ge.padding||tt.isPaddingEqual(Ge.padding)||(tt.padding=Ge.padding),this.fire(new Ne.Event("movestart",Qe)).fire(new Ne.Event("move",Qe)),rt&&this.fire(new Ne.Event("zoomstart",Qe)).fire(new Ne.Event("zoom",Qe)).fire(new Ne.Event("zoomend",Qe)),nt&&this.fire(new Ne.Event("rotatestart",Qe)).fire(new Ne.Event("rotate",Qe)).fire(new Ne.Event("rotateend",Qe)),at&&this.fire(new Ne.Event("pitchstart",Qe)).fire(new Ne.Event("pitch",Qe)).fire(new Ne.Event("pitchend",Qe)),this.fire(new Ne.Event("moveend",Qe))},i.prototype.easeTo=function(Ge,Qe){var tt=this;this._stop(!1,Ge.easeId),(!1===(Ge=Ne.extend({offset:[0,0],duration:500,easing:Ne.ease},Ge)).animate||!Ge.essential&&Ne.browser.prefersReducedMotion)&&(Ge.duration=0);var rt=this.transform,nt=this.getZoom(),at=this.getBearing(),it=this.getPitch(),ot=this.getPadding(),dt="zoom"in Ge?+Ge.zoom:nt,ht="bearing"in Ge?this._normalizeBearing(Ge.bearing,at):at,Dt="pitch"in Ge?+Ge.pitch:it,Ot="padding"in Ge?Ge.padding:rt.padding,Rt=Ne.Point.convert(Ge.offset),Zt=rt.centerPoint.add(Rt),er=rt.pointLocation(Zt),dr=Ne.LngLat.convert(Ge.center||er);this._normalizeCenter(dr);var mr,xr,br=rt.project(er),Ar=rt.project(dr).sub(br),en=rt.zoomScale(dt-nt);Ge.around&&(mr=Ne.LngLat.convert(Ge.around),xr=rt.locationPoint(mr));var mn={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||dt!==nt,this._rotating=this._rotating||at!==ht,this._pitching=this._pitching||Dt!==it,this._padding=!rt.isPaddingEqual(Ot),this._easeId=Ge.easeId,this._prepareEase(Qe,Ge.noMoveStart,mn),clearTimeout(this._easeEndTimeoutID),this._ease((function(Ge){if(tt._zooming&&(rt.zoom=Ne.number(nt,dt,Ge)),tt._rotating&&(rt.bearing=Ne.number(at,ht,Ge)),tt._pitching&&(rt.pitch=Ne.number(it,Dt,Ge)),tt._padding&&(rt.interpolatePadding(ot,Ot,Ge),Zt=rt.centerPoint.add(Rt)),mr)rt.setLocationAtPoint(mr,xr);else{var er=rt.zoomScale(rt.zoom-nt),dr=dt>nt?Math.min(2,en):Math.max(.5,en),mn=Math.pow(dr,1-Ge),xn=rt.unproject(br.add(Ar.mult(Ge*mn)).mult(er));rt.setLocationAtPoint(rt.renderWorldCopies?xn.wrap():xn,Zt)}tt._fireMoveEvents(Qe)}),(function(Ne){tt._afterEase(Qe,Ne)}),Ge),this},i.prototype._prepareEase=function(Ge,Qe,tt){void 0===tt&&(tt={}),this._moving=!0,Qe||tt.moving||this.fire(new Ne.Event("movestart",Ge)),this._zooming&&!tt.zooming&&this.fire(new Ne.Event("zoomstart",Ge)),this._rotating&&!tt.rotating&&this.fire(new Ne.Event("rotatestart",Ge)),this._pitching&&!tt.pitching&&this.fire(new Ne.Event("pitchstart",Ge))},i.prototype._fireMoveEvents=function(Ge){this.fire(new Ne.Event("move",Ge)),this._zooming&&this.fire(new Ne.Event("zoom",Ge)),this._rotating&&this.fire(new Ne.Event("rotate",Ge)),this._pitching&&this.fire(new Ne.Event("pitch",Ge))},i.prototype._afterEase=function(Ge,Qe){if(!this._easeId||!Qe||this._easeId!==Qe){delete this._easeId;var tt=this._zooming,rt=this._rotating,nt=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,tt&&this.fire(new Ne.Event("zoomend",Ge)),rt&&this.fire(new Ne.Event("rotateend",Ge)),nt&&this.fire(new Ne.Event("pitchend",Ge)),this.fire(new Ne.Event("moveend",Ge))}},i.prototype.flyTo=function(Ge,Qe){var tt=this;if(!Ge.essential&&Ne.browser.prefersReducedMotion){var rt=Ne.pick(Ge,["center","zoom","bearing","pitch","around"]);return this.jumpTo(rt,Qe)}this.stop(),Ge=Ne.extend({offset:[0,0],speed:1.2,curve:1.42,easing:Ne.ease},Ge);var nt=this.transform,at=this.getZoom(),it=this.getBearing(),ot=this.getPitch(),dt=this.getPadding(),ht="zoom"in Ge?Ne.clamp(+Ge.zoom,nt.minZoom,nt.maxZoom):at,Dt="bearing"in Ge?this._normalizeBearing(Ge.bearing,it):it,Ot="pitch"in Ge?+Ge.pitch:ot,Rt="padding"in Ge?Ge.padding:nt.padding,Zt=nt.zoomScale(ht-at),er=Ne.Point.convert(Ge.offset),dr=nt.centerPoint.add(er),mr=nt.pointLocation(dr),xr=Ne.LngLat.convert(Ge.center||mr);this._normalizeCenter(xr);var br=nt.project(mr),Ar=nt.project(xr).sub(br),en=Ge.curve,mn=Math.max(nt.width,nt.height),xn=mn/Zt,kn=Ar.mag();if("minZoom"in Ge){var Cn=Ne.clamp(Math.min(Ge.minZoom,at,ht),nt.minZoom,nt.maxZoom),En=mn/nt.zoomScale(Cn-at);en=Math.sqrt(En/kn*2)}var Pn=en*en;function C(Ne){var Ge=(xn*xn-mn*mn+(Ne?-1:1)*Pn*Pn*kn*kn)/(2*(Ne?xn:mn)*Pn*kn);return Math.log(Math.sqrt(Ge*Ge+1)-Ge)}function z(Ne){return(Math.exp(Ne)-Math.exp(-Ne))/2}function D(Ne){return(Math.exp(Ne)+Math.exp(-Ne))/2}var Dn=C(0),L=function(Ne){return D(Dn)/D(Dn+en*Ne)},A=function(Ne){return mn*((D(Dn)*(z(Ge=Dn+en*Ne)/D(Ge))-z(Dn))/Pn)/kn;var Ge},In=(C(1)-Dn)/en;if(Math.abs(kn)<1e-6||!isFinite(In)){if(Math.abs(mn-xn)<1e-6)return this.easeTo(Ge,Qe);var zn=xn<mn?-1:1;In=Math.abs(Math.log(xn/mn))/en,A=function(){return 0},L=function(Ne){return Math.exp(zn*en*Ne)}}return Ge.duration="duration"in Ge?+Ge.duration:1e3*In/("screenSpeed"in Ge?+Ge.screenSpeed/en:+Ge.speed),Ge.maxDuration&&Ge.duration>Ge.maxDuration&&(Ge.duration=0),this._zooming=!0,this._rotating=it!==Dt,this._pitching=Ot!==ot,this._padding=!nt.isPaddingEqual(Rt),this._prepareEase(Qe,!1),this._ease((function(Ge){var rt=Ge*In,Zt=1/L(rt);nt.zoom=1===Ge?ht:at+nt.scaleZoom(Zt),tt._rotating&&(nt.bearing=Ne.number(it,Dt,Ge)),tt._pitching&&(nt.pitch=Ne.number(ot,Ot,Ge)),tt._padding&&(nt.interpolatePadding(dt,Rt,Ge),dr=nt.centerPoint.add(er));var mr=1===Ge?xr:nt.unproject(br.add(Ar.mult(A(rt))).mult(Zt));nt.setLocationAtPoint(nt.renderWorldCopies?mr.wrap():mr,dr),tt._fireMoveEvents(Qe)}),(function(){return tt._afterEase(Qe)}),Ge),this},i.prototype.isEasing=function(){return!!this._easeFrameId},i.prototype.stop=function(){return this._stop()},i.prototype._stop=function(Ne,Ge){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var Qe=this._onEaseEnd;delete this._onEaseEnd,Qe.call(this,Ge)}if(!Ne){var tt=this.handlers;tt&&tt.stop()}return this},i.prototype._ease=function(Ge,Qe,tt){!1===tt.animate||0===tt.duration?(Ge(1),Qe()):(this._easeStart=Ne.browser.now(),this._easeOptions=tt,this._onEaseFrame=Ge,this._onEaseEnd=Qe,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},i.prototype._renderFrameCallback=function(){var Ge=Math.min((Ne.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(Ge)),Ge<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},i.prototype._normalizeBearing=function(Ge,Qe){Ge=Ne.wrap(Ge,-180,180);var tt=Math.abs(Ge-Qe);return Math.abs(Ge-360-Qe)<tt&&(Ge-=360),Math.abs(Ge+360-Qe)<tt&&(Ge+=360),Ge},i.prototype._normalizeCenter=function(Ne){var Ge=this.transform;if(Ge.renderWorldCopies&&!Ge.lngRange){var Qe=Ne.lng-Ge.center.lng;Ne.lng+=Qe>180?-360:Qe<-180?360:0}},i}(Ne.Evented),gr=function(Ge){void 0===Ge&&(Ge={}),this.options=Ge,Ne.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};gr.prototype.getDefaultPosition=function(){return"bottom-right"},gr.prototype.onAdd=function(Ne){var Ge=this.options&&this.options.compact;return this._map=Ne,this._container=Qe.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=Qe.create("div","mapboxgl-ctrl-attrib-inner",this._container),Ge&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===Ge&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},gr.prototype.onRemove=function(){Qe.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},gr.prototype._updateEditLink=function(){var Ge=this._editLink;Ge||(Ge=this._editLink=this._container.querySelector(".mapbox-improve-map"));var Qe=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||Ne.config.ACCESS_TOKEN}];if(Ge){var tt=Qe.reduce((function(Ne,Ge,tt){return Ge.value&&(Ne+=Ge.key+"="+Ge.value+(tt<Qe.length-1?"&":"")),Ne}),"?");Ge.href=Ne.config.FEEDBACK_URL+"/"+tt+(this._map._hash?this._map._hash.getHashString(!0):""),Ge.rel="noopener nofollow"}},gr.prototype._updateData=function(Ne){!Ne||"metadata"!==Ne.sourceDataType&&"style"!==Ne.dataType||(this._updateAttributions(),this._updateEditLink())},gr.prototype._updateAttributions=function(){if(this._map.style){var Ne=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?Ne=Ne.concat(this.options.customAttribution.map((function(Ne){return"string"!=typeof Ne?"":Ne}))):"string"==typeof this.options.customAttribution&&Ne.push(this.options.customAttribution)),this._map.style.stylesheet){var Ge=this._map.style.stylesheet;this.styleOwner=Ge.owner,this.styleId=Ge.id}var Qe=this._map.style.sourceCaches;for(var tt in Qe){var rt=Qe[tt];if(rt.used){var nt=rt.getSource();nt.attribution&&Ne.indexOf(nt.attribution)<0&&Ne.push(nt.attribution)}}Ne.sort((function(Ne,Ge){return Ne.length-Ge.length}));var at=(Ne=Ne.filter((function(Ge,Qe){for(var tt=Qe+1;tt<Ne.length;tt++)if(Ne[tt].indexOf(Ge)>=0)return!1;return!0}))).join(" | ");at!==this._attribHTML&&(this._attribHTML=at,Ne.length?(this._innerContainer.innerHTML=at,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},gr.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var vr=function(){Ne.bindAll(["_updateLogo"],this),Ne.bindAll(["_updateCompact"],this)};vr.prototype.onAdd=function(Ne){this._map=Ne,this._container=Qe.create("div","mapboxgl-ctrl");var Ge=Qe.create("a","mapboxgl-ctrl-logo");return Ge.target="_blank",Ge.rel="noopener nofollow",Ge.href="https://www.mapbox.com/",Ge.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),Ge.setAttribute("rel","noopener nofollow"),this._container.appendChild(Ge),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},vr.prototype.onRemove=function(){Qe.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},vr.prototype.getDefaultPosition=function(){return"bottom-left"},vr.prototype._updateLogo=function(Ne){Ne&&"metadata"!==Ne.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")},vr.prototype._logoRequired=function(){if(this._map.style){var Ne=this._map.style.sourceCaches;for(var Ge in Ne)if(Ne[Ge].getSource().mapbox_logo)return!0;return!1}},vr.prototype._updateCompact=function(){var Ne=this._container.children;if(Ne.length){var Ge=Ne[0];this._map.getCanvasContainer().offsetWidth<250?Ge.classList.add("mapboxgl-compact"):Ge.classList.remove("mapboxgl-compact")}};var yr=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};yr.prototype.add=function(Ne){var Ge=++this._id;return this._queue.push({callback:Ne,id:Ge,cancelled:!1}),Ge},yr.prototype.remove=function(Ne){for(var Ge=this._currentlyRunning,Qe=0,tt=Ge?this._queue.concat(Ge):this._queue;Qe<tt.length;Qe+=1){var rt=tt[Qe];if(rt.id===Ne)return void(rt.cancelled=!0)}},yr.prototype.run=function(Ne){void 0===Ne&&(Ne=0);var Ge=this._currentlyRunning=this._queue;this._queue=[];for(var Qe=0,tt=Ge;Qe<tt.length;Qe+=1){var rt=tt[Qe];if(!rt.cancelled&&(rt.callback(Ne),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},yr.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var zc={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Rc=Ne.window.HTMLImageElement,Bc=Ne.window.HTMLElement,Fc=Ne.window.ImageBitmap,Nc={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},jc=function(tt){function r(Ge){var Qe=this;if(null!=(Ge=Ne.extend({},Nc,Ge)).minZoom&&null!=Ge.maxZoom&&Ge.minZoom>Ge.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=Ge.minPitch&&null!=Ge.maxPitch&&Ge.minPitch>Ge.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=Ge.minPitch&&Ge.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=Ge.maxPitch&&Ge.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var rt=new wo(Ge.minZoom,Ge.maxZoom,Ge.minPitch,Ge.maxPitch,Ge.renderWorldCopies);if(tt.call(this,rt,Ge),this._interactive=Ge.interactive,this._maxTileCacheSize=Ge.maxTileCacheSize,this._failIfMajorPerformanceCaveat=Ge.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=Ge.preserveDrawingBuffer,this._antialias=Ge.antialias,this._trackResize=Ge.trackResize,this._bearingSnap=Ge.bearingSnap,this._refreshExpiredTiles=Ge.refreshExpiredTiles,this._fadeDuration=Ge.fadeDuration,this._crossSourceCollisions=Ge.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=Ge.collectResourceTiming,this._renderTaskQueue=new yr,this._controls=[],this._mapId=Ne.uniqueId(),this._locale=Ne.extend({},zc,Ge.locale),this._requestManager=new Ne.RequestManager(Ge.transformRequest,Ge.accessToken),"string"==typeof Ge.container){if(this._container=Ne.window.document.getElementById(Ge.container),!this._container)throw new Error("Container '"+Ge.container+"' not found.")}else{if(!(Ge.container instanceof Bc))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=Ge.container}if(Ge.maxBounds&&this.setMaxBounds(Ge.maxBounds),Ne.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",(function(){return Qe._update(!1)})),this.on("moveend",(function(){return Qe._update(!1)})),this.on("zoom",(function(){return Qe._update(!0)})),void 0!==Ne.window&&(Ne.window.addEventListener("online",this._onWindowOnline,!1),Ne.window.addEventListener("resize",this._onWindowResize,!1)),this.handlers=new fr(this,Ge),this._hash=Ge.hash&&new Eo("string"==typeof Ge.hash&&Ge.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:Ge.center,zoom:Ge.zoom,bearing:Ge.bearing,pitch:Ge.pitch}),Ge.bounds&&(this.resize(),this.fitBounds(Ge.bounds,Ne.extend({},Ge.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=Ge.localIdeographFontFamily,Ge.style&&this.setStyle(Ge.style,{localIdeographFontFamily:Ge.localIdeographFontFamily}),Ge.attributionControl&&this.addControl(new gr({customAttribution:Ge.customAttribution})),this.addControl(new vr,Ge.logoPosition),this.on("style.load",(function(){Qe.transform.unmodified&&Qe.jumpTo(Qe.style.stylesheet)})),this.on("data",(function(Ge){Qe._update("style"===Ge.dataType),Qe.fire(new Ne.Event(Ge.dataType+"data",Ge))})),this.on("dataloading",(function(Ge){Qe.fire(new Ne.Event(Ge.dataType+"dataloading",Ge))}))}tt&&(r.__proto__=tt),(r.prototype=Object.create(tt&&tt.prototype)).constructor=r;var rt={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return r.prototype._getMapId=function(){return this._mapId},r.prototype.addControl=function(Ge,Qe){if(void 0===Qe&&Ge.getDefaultPosition&&(Qe=Ge.getDefaultPosition()),void 0===Qe&&(Qe="top-right"),!Ge||!Ge.onAdd)return this.fire(new Ne.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var tt=Ge.onAdd(this);this._controls.push(Ge);var rt=this._controlPositions[Qe];return-1!==Qe.indexOf("bottom")?rt.insertBefore(tt,rt.firstChild):rt.appendChild(tt),this},r.prototype.removeControl=function(Ge){if(!Ge||!Ge.onRemove)return this.fire(new Ne.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var Qe=this._controls.indexOf(Ge);return Qe>-1&&this._controls.splice(Qe,1),Ge.onRemove(this),this},r.prototype.resize=function(Ge){var Qe=this._containerDimensions(),tt=Qe[0],rt=Qe[1];this._resizeCanvas(tt,rt),this.transform.resize(tt,rt),this.painter.resize(tt,rt);var nt=!this._moving;return nt&&(this.stop(),this.fire(new Ne.Event("movestart",Ge)).fire(new Ne.Event("move",Ge))),this.fire(new Ne.Event("resize",Ge)),nt&&this.fire(new Ne.Event("moveend",Ge)),this},r.prototype.getBounds=function(){return this.transform.getBounds()},r.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},r.prototype.setMaxBounds=function(Ge){return this.transform.setMaxBounds(Ne.LngLatBounds.convert(Ge)),this._update()},r.prototype.setMinZoom=function(Ne){if((Ne=null==Ne?-2:Ne)>=-2&&Ne<=this.transform.maxZoom)return this.transform.minZoom=Ne,this._update(),this.getZoom()<Ne&&this.setZoom(Ne),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},r.prototype.getMinZoom=function(){return this.transform.minZoom},r.prototype.setMaxZoom=function(Ne){if((Ne=null==Ne?22:Ne)>=this.transform.minZoom)return this.transform.maxZoom=Ne,this._update(),this.getZoom()>Ne&&this.setZoom(Ne),this;throw new Error("maxZoom must be greater than the current minZoom")},r.prototype.getMaxZoom=function(){return this.transform.maxZoom},r.prototype.setMinPitch=function(Ne){if((Ne=null==Ne?0:Ne)<0)throw new Error("minPitch must be greater than or equal to 0");if(Ne>=0&&Ne<=this.transform.maxPitch)return this.transform.minPitch=Ne,this._update(),this.getPitch()<Ne&&this.setPitch(Ne),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},r.prototype.getMinPitch=function(){return this.transform.minPitch},r.prototype.setMaxPitch=function(Ne){if((Ne=null==Ne?60:Ne)>60)throw new Error("maxPitch must be less than or equal to 60");if(Ne>=this.transform.minPitch)return this.transform.maxPitch=Ne,this._update(),this.getPitch()>Ne&&this.setPitch(Ne),this;throw new Error("maxPitch must be greater than the current minPitch")},r.prototype.getMaxPitch=function(){return this.transform.maxPitch},r.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},r.prototype.setRenderWorldCopies=function(Ne){return this.transform.renderWorldCopies=Ne,this._update()},r.prototype.project=function(Ge){return this.transform.locationPoint(Ne.LngLat.convert(Ge))},r.prototype.unproject=function(Ge){return this.transform.pointLocation(Ne.Point.convert(Ge))},r.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},r.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},r.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},r.prototype._createDelegatedListener=function(Ne,Ge,Qe){var tt,rt=this;if("mouseenter"===Ne||"mouseover"===Ne){var nt=!1;return{layer:Ge,listener:Qe,delegates:{mousemove:function(tt){var at=rt.getLayer(Ge)?rt.queryRenderedFeatures(tt.point,{layers:[Ge]}):[];at.length?nt||(nt=!0,Qe.call(rt,new Tc(Ne,rt,tt.originalEvent,{features:at}))):nt=!1},mouseout:function(){nt=!1}}}}if("mouseleave"===Ne||"mouseout"===Ne){var at=!1;return{layer:Ge,listener:Qe,delegates:{mousemove:function(tt){(rt.getLayer(Ge)?rt.queryRenderedFeatures(tt.point,{layers:[Ge]}):[]).length?at=!0:at&&(at=!1,Qe.call(rt,new Tc(Ne,rt,tt.originalEvent)))},mouseout:function(Ge){at&&(at=!1,Qe.call(rt,new Tc(Ne,rt,Ge.originalEvent)))}}}}return{layer:Ge,listener:Qe,delegates:(tt={},tt[Ne]=function(Ne){var tt=rt.getLayer(Ge)?rt.queryRenderedFeatures(Ne.point,{layers:[Ge]}):[];tt.length&&(Ne.features=tt,Qe.call(rt,Ne),delete Ne.features)},tt)}},r.prototype.on=function(Ne,Ge,Qe){if(void 0===Qe)return tt.prototype.on.call(this,Ne,Ge);var rt=this._createDelegatedListener(Ne,Ge,Qe);for(var nt in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[Ne]=this._delegatedListeners[Ne]||[],this._delegatedListeners[Ne].push(rt),rt.delegates)this.on(nt,rt.delegates[nt]);return this},r.prototype.once=function(Ne,Ge,Qe){if(void 0===Qe)return tt.prototype.once.call(this,Ne,Ge);var rt=this._createDelegatedListener(Ne,Ge,Qe);for(var nt in rt.delegates)this.once(nt,rt.delegates[nt]);return this},r.prototype.off=function(Ne,Ge,Qe){var rt=this;return void 0===Qe?tt.prototype.off.call(this,Ne,Ge):(this._delegatedListeners&&this._delegatedListeners[Ne]&&function(tt){for(var nt=tt[Ne],at=0;at<nt.length;at++){var it=nt[at];if(it.layer===Ge&&it.listener===Qe){for(var ot in it.delegates)rt.off(ot,it.delegates[ot]);return nt.splice(at,1),rt}}}(this._delegatedListeners),this)},r.prototype.queryRenderedFeatures=function(Ge,Qe){if(!this.style)return[];var tt;if(void 0!==Qe||void 0===Ge||Ge instanceof Ne.Point||Array.isArray(Ge)||(Qe=Ge,Ge=void 0),Qe=Qe||{},(Ge=Ge||[[0,0],[this.transform.width,this.transform.height]])instanceof Ne.Point||"number"==typeof Ge[0])tt=[Ne.Point.convert(Ge)];else{var rt=Ne.Point.convert(Ge[0]),nt=Ne.Point.convert(Ge[1]);tt=[rt,new Ne.Point(nt.x,rt.y),nt,new Ne.Point(rt.x,nt.y),rt]}return this.style.queryRenderedFeatures(tt,Qe,this.transform)},r.prototype.querySourceFeatures=function(Ne,Ge){return this.style.querySourceFeatures(Ne,Ge)},r.prototype.setStyle=function(Ge,Qe){return!1!==(Qe=Ne.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},Qe)).diff&&Qe.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&Ge?(this._diffStyle(Ge,Qe),this):(this._localIdeographFontFamily=Qe.localIdeographFontFamily,this._updateStyle(Ge,Qe))},r.prototype._getUIString=function(Ne){var Ge=this._locale[Ne];if(null==Ge)throw new Error("Missing UI string '"+Ne+"'");return Ge},r.prototype._updateStyle=function(Ne,Ge){return this.style&&(this.style.setEventedParent(null),this.style._remove()),Ne?(this.style=new js(this,Ge||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof Ne?this.style.loadURL(Ne):this.style.loadJSON(Ne),this):(delete this.style,this)},r.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new js(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},r.prototype._diffStyle=function(Ge,Qe){var tt=this;if("string"==typeof Ge){var rt=this._requestManager.normalizeStyleURL(Ge),nt=this._requestManager.transformRequest(rt,Ne.ResourceType.Style);Ne.getJSON(nt,(function(Ge,rt){Ge?tt.fire(new Ne.ErrorEvent(Ge)):rt&&tt._updateDiff(rt,Qe)}))}else"object"==typeof Ge&&this._updateDiff(Ge,Qe)},r.prototype._updateDiff=function(Ge,Qe){try{this.style.setState(Ge)&&this._update(!0)}catch(tt){Ne.warnOnce("Unable to perform style diff: "+(tt.message||tt.error||tt)+".  Rebuilding the style from scratch."),this._updateStyle(Ge,Qe)}},r.prototype.getStyle=function(){if(this.style)return this.style.serialize()},r.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():Ne.warnOnce("There is no style added to the map.")},r.prototype.addSource=function(Ne,Ge){return this._lazyInitEmptyStyle(),this.style.addSource(Ne,Ge),this._update(!0)},r.prototype.isSourceLoaded=function(Ge){var Qe=this.style&&this.style.sourceCaches[Ge];if(void 0!==Qe)return Qe.loaded();this.fire(new Ne.ErrorEvent(new Error("There is no source with ID '"+Ge+"'")))},r.prototype.areTilesLoaded=function(){var Ne=this.style&&this.style.sourceCaches;for(var Ge in Ne){var Qe=Ne[Ge]._tiles;for(var tt in Qe){var rt=Qe[tt];if("loaded"!==rt.state&&"errored"!==rt.state)return!1}}return!0},r.prototype.addSourceType=function(Ne,Ge,Qe){return this._lazyInitEmptyStyle(),this.style.addSourceType(Ne,Ge,Qe)},r.prototype.removeSource=function(Ne){return this.style.removeSource(Ne),this._update(!0)},r.prototype.getSource=function(Ne){return this.style.getSource(Ne)},r.prototype.addImage=function(Ge,Qe,tt){void 0===tt&&(tt={});var rt=tt.pixelRatio;void 0===rt&&(rt=1);var nt=tt.sdf;void 0===nt&&(nt=!1);var at=tt.stretchX,it=tt.stretchY,ot=tt.content;if(this._lazyInitEmptyStyle(),Qe instanceof Rc||Fc&&Qe instanceof Fc){var dt=Ne.browser.getImageData(Qe);this.style.addImage(Ge,{data:new Ne.RGBAImage({width:dt.width,height:dt.height},dt.data),pixelRatio:rt,stretchX:at,stretchY:it,content:ot,sdf:nt,version:0})}else{if(void 0===Qe.width||void 0===Qe.height)return this.fire(new Ne.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var ht=Qe;this.style.addImage(Ge,{data:new Ne.RGBAImage({width:Qe.width,height:Qe.height},new Uint8Array(Qe.data)),pixelRatio:rt,stretchX:at,stretchY:it,content:ot,sdf:nt,version:0,userImage:ht}),ht.onAdd&&ht.onAdd(this,Ge)}},r.prototype.updateImage=function(Ge,Qe){var tt=this.style.getImage(Ge);if(!tt)return this.fire(new Ne.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var rt=Qe instanceof Rc||Fc&&Qe instanceof Fc?Ne.browser.getImageData(Qe):Qe,nt=rt.width,at=rt.height,it=rt.data;return void 0===nt||void 0===at?this.fire(new Ne.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):nt!==tt.data.width||at!==tt.data.height?this.fire(new Ne.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(tt.data.replace(it,!(Qe instanceof Rc||Fc&&Qe instanceof Fc)),void this.style.updateImage(Ge,tt))},r.prototype.hasImage=function(Ge){return Ge?!!this.style.getImage(Ge):(this.fire(new Ne.ErrorEvent(new Error("Missing required image id"))),!1)},r.prototype.removeImage=function(Ne){this.style.removeImage(Ne)},r.prototype.loadImage=function(Ge,Qe){Ne.getImage(this._requestManager.transformRequest(Ge,Ne.ResourceType.Image),Qe)},r.prototype.listImages=function(){return this.style.listImages()},r.prototype.addLayer=function(Ne,Ge){return this._lazyInitEmptyStyle(),this.style.addLayer(Ne,Ge),this._update(!0)},r.prototype.moveLayer=function(Ne,Ge){return this.style.moveLayer(Ne,Ge),this._update(!0)},r.prototype.removeLayer=function(Ne){return this.style.removeLayer(Ne),this._update(!0)},r.prototype.getLayer=function(Ne){return this.style.getLayer(Ne)},r.prototype.setLayerZoomRange=function(Ne,Ge,Qe){return this.style.setLayerZoomRange(Ne,Ge,Qe),this._update(!0)},r.prototype.setFilter=function(Ne,Ge,Qe){return void 0===Qe&&(Qe={}),this.style.setFilter(Ne,Ge,Qe),this._update(!0)},r.prototype.getFilter=function(Ne){return this.style.getFilter(Ne)},r.prototype.setPaintProperty=function(Ne,Ge,Qe,tt){return void 0===tt&&(tt={}),this.style.setPaintProperty(Ne,Ge,Qe,tt),this._update(!0)},r.prototype.getPaintProperty=function(Ne,Ge){return this.style.getPaintProperty(Ne,Ge)},r.prototype.setLayoutProperty=function(Ne,Ge,Qe,tt){return void 0===tt&&(tt={}),this.style.setLayoutProperty(Ne,Ge,Qe,tt),this._update(!0)},r.prototype.getLayoutProperty=function(Ne,Ge){return this.style.getLayoutProperty(Ne,Ge)},r.prototype.setLight=function(Ne,Ge){return void 0===Ge&&(Ge={}),this._lazyInitEmptyStyle(),this.style.setLight(Ne,Ge),this._update(!0)},r.prototype.getLight=function(){return this.style.getLight()},r.prototype.setFeatureState=function(Ne,Ge){return this.style.setFeatureState(Ne,Ge),this._update()},r.prototype.removeFeatureState=function(Ne,Ge){return this.style.removeFeatureState(Ne,Ge),this._update()},r.prototype.getFeatureState=function(Ne){return this.style.getFeatureState(Ne)},r.prototype.getContainer=function(){return this._container},r.prototype.getCanvasContainer=function(){return this._canvasContainer},r.prototype.getCanvas=function(){return this._canvas},r.prototype._containerDimensions=function(){var Ne=0,Ge=0;return this._container&&(Ne=this._container.clientWidth||400,Ge=this._container.clientHeight||300),[Ne,Ge]},r.prototype._detectMissingCSS=function(){"rgb(250, 128, 114)"!==Ne.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&Ne.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")},r.prototype._setupContainer=function(){var Ne=this._container;Ne.classList.add("mapboxgl-map"),(this._missingCSSCanary=Qe.create("div","mapboxgl-canary",Ne)).style.visibility="hidden",this._detectMissingCSS();var Ge=this._canvasContainer=Qe.create("div","mapboxgl-canvas-container",Ne);this._interactive&&Ge.classList.add("mapboxgl-interactive"),this._canvas=Qe.create("canvas","mapboxgl-canvas",Ge),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var tt=this._containerDimensions();this._resizeCanvas(tt[0],tt[1]);var rt=this._controlContainer=Qe.create("div","mapboxgl-control-container",Ne),nt=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((function(Ne){nt[Ne]=Qe.create("div","mapboxgl-ctrl-"+Ne,rt)}))},r.prototype._resizeCanvas=function(Ge,Qe){var tt=Ne.browser.devicePixelRatio||1;this._canvas.width=tt*Ge,this._canvas.height=tt*Qe,this._canvas.style.width=Ge+"px",this._canvas.style.height=Qe+"px"},r.prototype._setupPainter=function(){var Qe=Ne.extend({},Ge.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),tt=this._canvas.getContext("webgl",Qe)||this._canvas.getContext("experimental-webgl",Qe);tt?(this.painter=new vo(tt,this.transform),Ne.webpSupported.testSupport(tt)):this.fire(new Ne.ErrorEvent(new Error("Failed to initialize WebGL")))},r.prototype._contextLost=function(Ge){Ge.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new Ne.Event("webglcontextlost",{originalEvent:Ge}))},r.prototype._contextRestored=function(Ge){this._setupPainter(),this.resize(),this._update(),this.fire(new Ne.Event("webglcontextrestored",{originalEvent:Ge}))},r.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},r.prototype._update=function(Ne){return this.style?(this._styleDirty=this._styleDirty||Ne,this._sourcesDirty=!0,this.triggerRepaint(),this):this},r.prototype._requestRenderFrame=function(Ne){return this._update(),this._renderTaskQueue.add(Ne)},r.prototype._cancelRenderFrame=function(Ne){this._renderTaskQueue.remove(Ne)},r.prototype._render=function(Ge){var Qe,tt=this,rt=0,nt=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(Qe=nt.createQueryEXT(),nt.beginQueryEXT(nt.TIME_ELAPSED_EXT,Qe),rt=Ne.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(Ge),!this._removed){var at=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var it=this.transform.zoom,ot=Ne.browser.now();this.style.zoomHistory.update(it,ot);var dt=new Ne.EvaluationParameters(it,{now:ot,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),ht=dt.crossFadingFactor();1===ht&&ht===this._crossFadingFactor||(at=!0,this._crossFadingFactor=ht),this.style.update(dt)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new Ne.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new Ne.Event("load"))),this.style&&(this.style.hasTransitions()||at)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Dt=Ne.browser.now()-rt;nt.endQueryEXT(nt.TIME_ELAPSED_EXT,Qe),setTimeout((function(){var Ge=nt.getQueryObjectEXT(Qe,nt.QUERY_RESULT_EXT)/1e6;nt.deleteQueryEXT(Qe),tt.fire(new Ne.Event("gpu-timing-frame",{cpuTime:Dt,gpuTime:Ge}))}),50)}if(this.listens("gpu-timing-layer")){var Ot=this.painter.collectGpuTimers();setTimeout((function(){var Ge=tt.painter.queryGpuTimers(Ot);tt.fire(new Ne.Event("gpu-timing-layer",{layerTimes:Ge}))}),50)}return this._sourcesDirty||this._styleDirty||this._placementDirty||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&(this._fullyLoaded||(this._fullyLoaded=!0),this.fire(new Ne.Event("idle"))),this}},r.prototype.remove=function(){this._hash&&this._hash.remove();for(var Ge=0,Qe=this._controls;Ge<Qe.length;Ge+=1)Qe[Ge].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==Ne.window&&(Ne.window.removeEventListener("resize",this._onWindowResize,!1),Ne.window.removeEventListener("online",this._onWindowOnline,!1));var tt=this.painter.context.gl.getExtension("WEBGL_lose_context");tt&&tt.loseContext(),Pr(this._canvasContainer),Pr(this._controlContainer),Pr(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new Ne.Event("remove"))},r.prototype.triggerRepaint=function(){var Ge=this;this.style&&!this._frame&&(this._frame=Ne.browser.frame((function(Ne){Ge._frame=null,Ge._render(Ne)})))},r.prototype._onWindowOnline=function(){this._update()},r.prototype._onWindowResize=function(Ne){this._trackResize&&this.resize({originalEvent:Ne})._update()},rt.showTileBoundaries.get=function(){return!!this._showTileBoundaries},rt.showTileBoundaries.set=function(Ne){this._showTileBoundaries!==Ne&&(this._showTileBoundaries=Ne,this._update())},rt.showPadding.get=function(){return!!this._showPadding},rt.showPadding.set=function(Ne){this._showPadding!==Ne&&(this._showPadding=Ne,this._update())},rt.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},rt.showCollisionBoxes.set=function(Ne){this._showCollisionBoxes!==Ne&&(this._showCollisionBoxes=Ne,Ne?this.style._generateCollisionBoxes():this._update())},rt.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},rt.showOverdrawInspector.set=function(Ne){this._showOverdrawInspector!==Ne&&(this._showOverdrawInspector=Ne,this._update())},rt.repaint.get=function(){return!!this._repaint},rt.repaint.set=function(Ne){this._repaint!==Ne&&(this._repaint=Ne,this.triggerRepaint())},rt.vertices.get=function(){return!!this._vertices},rt.vertices.set=function(Ne){this._vertices=Ne,this._update()},r.prototype._setCacheLimits=function(Ge,Qe){Ne.setCacheLimits(Ge,Qe)},rt.version.get=function(){return Ne.version},Object.defineProperties(r.prototype,rt),r}(Oc);function Pr(Ne){Ne.parentNode&&Ne.parentNode.removeChild(Ne)}var Vc={showCompass:!0,showZoom:!0,visualizePitch:!1},Cr=function(Ge){var tt=this;this.options=Ne.extend({},Vc,Ge),this._container=Qe.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(function(Ne){return Ne.preventDefault()})),this.options.showZoom&&(Ne.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(function(Ne){return tt._map.zoomIn({},{originalEvent:Ne})})),Qe.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(function(Ne){return tt._map.zoomOut({},{originalEvent:Ne})})),Qe.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(Ne.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(function(Ne){tt.options.visualizePitch?tt._map.resetNorthPitch({},{originalEvent:Ne}):tt._map.resetNorth({},{originalEvent:Ne})})),this._compassIcon=Qe.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};Cr.prototype._updateZoomButtons=function(){var Ne=this._map.getZoom();this._zoomInButton.disabled=Ne===this._map.getMaxZoom(),this._zoomOutButton.disabled=Ne===this._map.getMinZoom()},Cr.prototype._rotateCompassArrow=function(){var Ne=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=Ne},Cr.prototype.onAdd=function(Ne){return this._map=Ne,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new zr(this._map,this._compass,this.options.visualizePitch)),this._container},Cr.prototype.onRemove=function(){Qe.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},Cr.prototype._createButton=function(Ne,Ge){var tt=Qe.create("button",Ne,this._container);return tt.type="button",tt.addEventListener("click",Ge),tt},Cr.prototype._setButtonTitle=function(Ne,Ge){var Qe=this._map._getUIString("NavigationControl."+Ge);Ne.title=Qe,Ne.setAttribute("aria-label",Qe)};var zr=function(Ge,tt,rt){void 0===rt&&(rt=!1),this._clickTolerance=10,this.element=tt,this.mouseRotate=new Sc({clickTolerance:Ge.dragRotate._mouseRotate._clickTolerance}),this.map=Ge,rt&&(this.mousePitch=new Cc({clickTolerance:Ge.dragRotate._mousePitch._clickTolerance})),Ne.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),Qe.addEventListener(tt,"mousedown",this.mousedown),Qe.addEventListener(tt,"touchstart",this.touchstart,{passive:!1}),Qe.addEventListener(tt,"touchmove",this.touchmove),Qe.addEventListener(tt,"touchend",this.touchend),Qe.addEventListener(tt,"touchcancel",this.reset)};function Dr(Ge,Qe,tt){if(Ge=new Ne.LngLat(Ge.lng,Ge.lat),Qe){var rt=new Ne.LngLat(Ge.lng-360,Ge.lat),nt=new Ne.LngLat(Ge.lng+360,Ge.lat),at=tt.locationPoint(Ge).distSqr(Qe);tt.locationPoint(rt).distSqr(Qe)<at?Ge=rt:tt.locationPoint(nt).distSqr(Qe)<at&&(Ge=nt)}for(;Math.abs(Ge.lng-tt.center.lng)>180;){var it=tt.locationPoint(Ge);if(it.x>=0&&it.y>=0&&it.x<=tt.width&&it.y<=tt.height)break;Ge.lng>tt.center.lng?Ge.lng-=360:Ge.lng+=360}return Ge}zr.prototype.down=function(Ne,Ge){this.mouseRotate.mousedown(Ne,Ge),this.mousePitch&&this.mousePitch.mousedown(Ne,Ge),Qe.disableDrag()},zr.prototype.move=function(Ne,Ge){var Qe=this.map,tt=this.mouseRotate.mousemoveWindow(Ne,Ge);if(tt&&tt.bearingDelta&&Qe.setBearing(Qe.getBearing()+tt.bearingDelta),this.mousePitch){var rt=this.mousePitch.mousemoveWindow(Ne,Ge);rt&&rt.pitchDelta&&Qe.setPitch(Qe.getPitch()+rt.pitchDelta)}},zr.prototype.off=function(){var Ne=this.element;Qe.removeEventListener(Ne,"mousedown",this.mousedown),Qe.removeEventListener(Ne,"touchstart",this.touchstart,{passive:!1}),Qe.removeEventListener(Ne,"touchmove",this.touchmove),Qe.removeEventListener(Ne,"touchend",this.touchend),Qe.removeEventListener(Ne,"touchcancel",this.reset),this.offTemp()},zr.prototype.offTemp=function(){Qe.enableDrag(),Qe.removeEventListener(Ne.window,"mousemove",this.mousemove),Qe.removeEventListener(Ne.window,"mouseup",this.mouseup)},zr.prototype.mousedown=function(Ge){this.down(Ne.extend({},Ge,{ctrlKey:!0,preventDefault:function(){return Ge.preventDefault()}}),Qe.mousePos(this.element,Ge)),Qe.addEventListener(Ne.window,"mousemove",this.mousemove),Qe.addEventListener(Ne.window,"mouseup",this.mouseup)},zr.prototype.mousemove=function(Ne){this.move(Ne,Qe.mousePos(this.element,Ne))},zr.prototype.mouseup=function(Ne){this.mouseRotate.mouseupWindow(Ne),this.mousePitch&&this.mousePitch.mouseupWindow(Ne),this.offTemp()},zr.prototype.touchstart=function(Ne){1!==Ne.targetTouches.length?this.reset():(this._startPos=this._lastPos=Qe.touchPos(this.element,Ne.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return Ne.preventDefault()}},this._startPos))},zr.prototype.touchmove=function(Ne){1!==Ne.targetTouches.length?this.reset():(this._lastPos=Qe.touchPos(this.element,Ne.targetTouches)[0],this.move({preventDefault:function(){return Ne.preventDefault()}},this._lastPos))},zr.prototype.touchend=function(Ne){0===Ne.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},zr.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Uc={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Lr(Ne,Ge,Qe){var tt=Ne.classList;for(var rt in Uc)tt.remove("mapboxgl-"+Qe+"-anchor-"+rt);tt.add("mapboxgl-"+Qe+"-anchor-"+Ge)}var Hc,qc=function(Ge){function o(tt,rt){var nt=this;if(Ge.call(this),(tt instanceof Ne.window.HTMLElement||rt)&&(tt=Ne.extend({element:tt},rt)),Ne.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=tt&&tt.anchor||"center",this._color=tt&&tt.color||"#3FB1CE",this._draggable=tt&&tt.draggable||!1,this._state="inactive",this._rotation=tt&&tt.rotation||0,this._rotationAlignment=tt&&tt.rotationAlignment||"auto",this._pitchAlignment=tt&&tt.pitchAlignment&&"auto"!==tt.pitchAlignment?tt.pitchAlignment:this._rotationAlignment,tt&&tt.element)this._element=tt.element,this._offset=Ne.Point.convert(tt&&tt.offset||[0,0]);else{this._defaultMarker=!0,this._element=Qe.create("div"),this._element.setAttribute("aria-label","Map marker");var at=Qe.createNS("http://www.w3.org/2000/svg","svg");at.setAttributeNS(null,"display","block"),at.setAttributeNS(null,"height","41px"),at.setAttributeNS(null,"width","27px"),at.setAttributeNS(null,"viewBox","0 0 27 41");var it=Qe.createNS("http://www.w3.org/2000/svg","g");it.setAttributeNS(null,"stroke","none"),it.setAttributeNS(null,"stroke-width","1"),it.setAttributeNS(null,"fill","none"),it.setAttributeNS(null,"fill-rule","evenodd");var ot=Qe.createNS("http://www.w3.org/2000/svg","g");ot.setAttributeNS(null,"fill-rule","nonzero");var dt=Qe.createNS("http://www.w3.org/2000/svg","g");dt.setAttributeNS(null,"transform","translate(3.0, 29.0)"),dt.setAttributeNS(null,"fill","#000000");for(var ht=0,Dt=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];ht<Dt.length;ht+=1){var Ot=Dt[ht],Rt=Qe.createNS("http://www.w3.org/2000/svg","ellipse");Rt.setAttributeNS(null,"opacity","0.04"),Rt.setAttributeNS(null,"cx","10.5"),Rt.setAttributeNS(null,"cy","5.80029008"),Rt.setAttributeNS(null,"rx",Ot.rx),Rt.setAttributeNS(null,"ry",Ot.ry),dt.appendChild(Rt)}var Zt=Qe.createNS("http://www.w3.org/2000/svg","g");Zt.setAttributeNS(null,"fill",this._color);var er=Qe.createNS("http://www.w3.org/2000/svg","path");er.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Zt.appendChild(er);var dr=Qe.createNS("http://www.w3.org/2000/svg","g");dr.setAttributeNS(null,"opacity","0.25"),dr.setAttributeNS(null,"fill","#000000");var mr=Qe.createNS("http://www.w3.org/2000/svg","path");mr.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),dr.appendChild(mr);var xr=Qe.createNS("http://www.w3.org/2000/svg","g");xr.setAttributeNS(null,"transform","translate(6.0, 7.0)"),xr.setAttributeNS(null,"fill","#FFFFFF");var br=Qe.createNS("http://www.w3.org/2000/svg","g");br.setAttributeNS(null,"transform","translate(8.0, 8.0)");var Ar=Qe.createNS("http://www.w3.org/2000/svg","circle");Ar.setAttributeNS(null,"fill","#000000"),Ar.setAttributeNS(null,"opacity","0.25"),Ar.setAttributeNS(null,"cx","5.5"),Ar.setAttributeNS(null,"cy","5.5"),Ar.setAttributeNS(null,"r","5.4999962");var en=Qe.createNS("http://www.w3.org/2000/svg","circle");en.setAttributeNS(null,"fill","#FFFFFF"),en.setAttributeNS(null,"cx","5.5"),en.setAttributeNS(null,"cy","5.5"),en.setAttributeNS(null,"r","5.4999962"),br.appendChild(Ar),br.appendChild(en),ot.appendChild(dt),ot.appendChild(Zt),ot.appendChild(dr),ot.appendChild(xr),ot.appendChild(br),at.appendChild(ot),this._element.appendChild(at),this._offset=Ne.Point.convert(tt&&tt.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(function(Ne){Ne.preventDefault()})),this._element.addEventListener("mousedown",(function(Ne){Ne.preventDefault()})),this._element.addEventListener("focus",(function(){var Ne=nt._map.getContainer();Ne.scrollTop=0,Ne.scrollLeft=0})),Lr(this._element,this._anchor,"marker"),this._popup=null}return Ge&&(o.__proto__=Ge),(o.prototype=Object.create(Ge&&Ge.prototype)).constructor=o,o.prototype.addTo=function(Ne){return this.remove(),this._map=Ne,Ne.getCanvasContainer().appendChild(this._element),Ne.on("move",this._update),Ne.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},o.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),Qe.remove(this._element),this._popup&&this._popup.remove(),this},o.prototype.getLngLat=function(){return this._lngLat},o.prototype.setLngLat=function(Ge){return this._lngLat=Ne.LngLat.convert(Ge),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},o.prototype.getElement=function(){return this._element},o.prototype.setPopup=function(Ne){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),Ne){if(!("offset"in Ne.options)){var Ge=Math.sqrt(Math.pow(13.5,2)/2);Ne.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[Ge,-1*(24.6+Ge)],"bottom-right":[-Ge,-1*(24.6+Ge)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=Ne,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},o.prototype._onKeyPress=function(Ne){var Ge=Ne.code,Qe=Ne.charCode||Ne.keyCode;"Space"!==Ge&&"Enter"!==Ge&&32!==Qe&&13!==Qe||this.togglePopup()},o.prototype._onMapClick=function(Ne){var Ge=Ne.originalEvent.target,Qe=this._element;this._popup&&(Ge===Qe||Qe.contains(Ge))&&this.togglePopup()},o.prototype.getPopup=function(){return this._popup},o.prototype.togglePopup=function(){var Ne=this._popup;return Ne?(Ne.isOpen()?Ne.remove():Ne.addTo(this._map),this):this},o.prototype._update=function(Ne){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Dr(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var Ge="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?Ge="rotateZ("+this._rotation+"deg)":"map"===this._rotationAlignment&&(Ge="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var tt="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?tt="rotateX(0deg)":"map"===this._pitchAlignment&&(tt="rotateX("+this._map.getPitch()+"deg)"),Ne&&"moveend"!==Ne.type||(this._pos=this._pos.round()),Qe.setTransform(this._element,Uc[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+tt+" "+Ge)}},o.prototype.getOffset=function(){return this._offset},o.prototype.setOffset=function(Ge){return this._offset=Ne.Point.convert(Ge),this._update(),this},o.prototype._onMove=function(Ge){this._pos=Ge.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new Ne.Event("dragstart"))),this.fire(new Ne.Event("drag"))},o.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new Ne.Event("dragend")),this._state="inactive"},o.prototype._addDragHandler=function(Ne){this._element.contains(Ne.originalEvent.target)&&(Ne.preventDefault(),this._positionDelta=Ne.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},o.prototype.setDraggable=function(Ne){return this._draggable=!!Ne,this._map&&(Ne?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},o.prototype.isDraggable=function(){return this._draggable},o.prototype.setRotation=function(Ne){return this._rotation=Ne||0,this._update(),this},o.prototype.getRotation=function(){return this._rotation},o.prototype.setRotationAlignment=function(Ne){return this._rotationAlignment=Ne||"auto",this._update(),this},o.prototype.getRotationAlignment=function(){return this._rotationAlignment},o.prototype.setPitchAlignment=function(Ne){return this._pitchAlignment=Ne&&"auto"!==Ne?Ne:this._rotationAlignment,this._update(),this},o.prototype.getPitchAlignment=function(){return this._pitchAlignment},o}(Ne.Evented),Gc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Yc=0,Wc=!1,Xc=function(Ge){function o(Qe){Ge.call(this),this.options=Ne.extend({},Gc,Qe),Ne.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return Ge&&(o.__proto__=Ge),(o.prototype=Object.create(Ge&&Ge.prototype)).constructor=o,o.prototype.onAdd=function(Ge){var tt;return this._map=Ge,this._container=Qe.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),tt=this._setupUI,void 0!==Hc?tt(Hc):void 0!==Ne.window.navigator.permissions?Ne.window.navigator.permissions.query({name:"geolocation"}).then((function(Ne){tt(Hc="denied"!==Ne.state)})):tt(Hc=!!Ne.window.navigator.geolocation),this._container},o.prototype.onRemove=function(){void 0!==this._geolocationWatchID&&(Ne.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),Qe.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Yc=0,Wc=!1},o.prototype._isOutOfMapMaxBounds=function(Ne){var Ge=this._map.getMaxBounds(),Qe=Ne.coords;return Ge&&(Qe.longitude<Ge.getWest()||Qe.longitude>Ge.getEast()||Qe.latitude<Ge.getSouth()||Qe.latitude>Ge.getNorth())},o.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},o.prototype._onSuccess=function(Ge){if(this._map){if(this._isOutOfMapMaxBounds(Ge))return this._setErrorState(),this.fire(new Ne.Event("outofmaxbounds",Ge)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=Ge,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(Ge),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(Ge),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new Ne.Event("geolocate",Ge)),this._finish()}},o.prototype._updateCamera=function(Ge){var Qe=new Ne.LngLat(Ge.coords.longitude,Ge.coords.latitude),tt=Ge.coords.accuracy,rt=this._map.getBearing(),nt=Ne.extend({bearing:rt},this.options.fitBoundsOptions);this._map.fitBounds(Qe.toBounds(tt),nt,{geolocateSource:!0})},o.prototype._updateMarker=function(Ge){if(Ge){var Qe=new Ne.LngLat(Ge.coords.longitude,Ge.coords.latitude);this._accuracyCircleMarker.setLngLat(Qe).addTo(this._map),this._userLocationDotMarker.setLngLat(Qe).addTo(this._map),this._accuracy=Ge.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},o.prototype._updateCircleRadius=function(){var Ne=this._map._container.clientHeight/2,Ge=this._map.unproject([0,Ne]),Qe=this._map.unproject([1,Ne]),tt=Ge.distanceTo(Qe),rt=Math.ceil(2*this._accuracy/tt);this._circleElement.style.width=rt+"px",this._circleElement.style.height=rt+"px"},o.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},o.prototype._onError=function(Ge){if(this._map){if(this.options.trackUserLocation)if(1===Ge.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var Qe=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=Qe,this._geolocateButton.setAttribute("aria-label",Qe),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===Ge.code&&Wc)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new Ne.Event("error",Ge)),this._finish()}},o.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},o.prototype._setupUI=function(Ge){var tt=this;if(this._container.addEventListener("contextmenu",(function(Ne){return Ne.preventDefault()})),this._geolocateButton=Qe.create("button","mapboxgl-ctrl-geolocate",this._container),Qe.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===Ge){Ne.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var rt=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=rt,this._geolocateButton.setAttribute("aria-label",rt)}else{var nt=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=nt,this._geolocateButton.setAttribute("aria-label",nt)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Qe.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new qc(this._dotElement),this._circleElement=Qe.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new qc({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(function(Ge){Ge.geolocateSource||"ACTIVE_LOCK"!==tt._watchState||Ge.originalEvent&&"resize"===Ge.originalEvent.type||(tt._watchState="BACKGROUND",tt._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),tt._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),tt.fire(new Ne.Event("trackuserlocationend")))}))},o.prototype.trigger=function(){if(!this._setup)return Ne.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new Ne.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Yc--,Wc=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new Ne.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new Ne.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){var Ge;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Yc>1?(Ge={maximumAge:6e5,timeout:0},Wc=!0):(Ge=this.options.positionOptions,Wc=!1),this._geolocationWatchID=Ne.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,Ge)}}else Ne.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},o.prototype._clearWatch=function(){Ne.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},o}(Ne.Evented),Zc={maxWidth:100,unit:"metric"},Nr=function(Ge){this.options=Ne.extend({},Zc,Ge),Ne.bindAll(["_onMove","setUnit"],this)};function Zr(Ne,Ge,Qe){var tt=Qe&&Qe.maxWidth||100,rt=Ne._container.clientHeight/2,nt=Ne.unproject([0,rt]),at=Ne.unproject([tt,rt]),it=nt.distanceTo(at);if(Qe&&"imperial"===Qe.unit){var ot=3.2808*it;ot>5280?jr(Ge,tt,ot/5280,Ne._getUIString("ScaleControl.Miles")):jr(Ge,tt,ot,Ne._getUIString("ScaleControl.Feet"))}else Qe&&"nautical"===Qe.unit?jr(Ge,tt,it/1852,Ne._getUIString("ScaleControl.NauticalMiles")):it>=1e3?jr(Ge,tt,it/1e3,Ne._getUIString("ScaleControl.Kilometers")):jr(Ge,tt,it,Ne._getUIString("ScaleControl.Meters"))}function jr(Ne,Ge,Qe,tt){var rt,nt,at,it=(rt=Qe,(nt=Math.pow(10,(""+Math.floor(rt)).length-1))*(at=(at=rt/nt)>=10?10:at>=5?5:at>=3?3:at>=2?2:at>=1?1:function(Ne){var Ge=Math.pow(10,Math.ceil(-Math.log(Ne)/Math.LN10));return Math.round(Ne*Ge)/Ge}(at)));Ne.style.width=Ge*(it/Qe)+"px",Ne.innerHTML=it+"&nbsp;"+tt}Nr.prototype.getDefaultPosition=function(){return"bottom-left"},Nr.prototype._onMove=function(){Zr(this._map,this._container,this.options)},Nr.prototype.onAdd=function(Ne){return this._map=Ne,this._container=Qe.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",Ne.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Nr.prototype.onRemove=function(){Qe.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Nr.prototype.setUnit=function(Ne){this.options.unit=Ne,Zr(this._map,this._container,this.options)};var qr=function(Ge){this._fullscreen=!1,Ge&&Ge.container&&(Ge.container instanceof Ne.window.HTMLElement?this._container=Ge.container:Ne.warnOnce("Full screen control 'container' must be a DOM element.")),Ne.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in Ne.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in Ne.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in Ne.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in Ne.window.document&&(this._fullscreenchange="MSFullscreenChange")};qr.prototype.onAdd=function(Ge){return this._map=Ge,this._container||(this._container=this._map.getContainer()),this._controlContainer=Qe.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",Ne.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},qr.prototype.onRemove=function(){Qe.remove(this._controlContainer),this._map=null,Ne.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},qr.prototype._checkFullscreenSupport=function(){return!!(Ne.window.document.fullscreenEnabled||Ne.window.document.mozFullScreenEnabled||Ne.window.document.msFullscreenEnabled||Ne.window.document.webkitFullscreenEnabled)},qr.prototype._setupUI=function(){var Ge=this._fullscreenButton=Qe.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Qe.create("span","mapboxgl-ctrl-icon",Ge).setAttribute("aria-hidden",!0),Ge.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),Ne.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},qr.prototype._updateTitle=function(){var Ne=this._getTitle();this._fullscreenButton.setAttribute("aria-label",Ne),this._fullscreenButton.title=Ne},qr.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},qr.prototype._isFullscreen=function(){return this._fullscreen},qr.prototype._changeIcon=function(){(Ne.window.document.fullscreenElement||Ne.window.document.mozFullScreenElement||Ne.window.document.webkitFullscreenElement||Ne.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},qr.prototype._onClickFullscreen=function(){this._isFullscreen()?Ne.window.document.exitFullscreen?Ne.window.document.exitFullscreen():Ne.window.document.mozCancelFullScreen?Ne.window.document.mozCancelFullScreen():Ne.window.document.msExitFullscreen?Ne.window.document.msExitFullscreen():Ne.window.document.webkitCancelFullScreen&&Ne.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var Jc={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},Kc=function(Ge){function o(Qe){Ge.call(this),this.options=Ne.extend(Object.create(Jc),Qe),Ne.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return Ge&&(o.__proto__=Ge),(o.prototype=Object.create(Ge&&Ge.prototype)).constructor=o,o.prototype.addTo=function(Ge){return this._map&&this.remove(),this._map=Ge,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new Ne.Event("open")),this},o.prototype.isOpen=function(){return!!this._map},o.prototype.remove=function(){return this._content&&Qe.remove(this._content),this._container&&(Qe.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new Ne.Event("close")),this},o.prototype.getLngLat=function(){return this._lngLat},o.prototype.setLngLat=function(Ge){return this._lngLat=Ne.LngLat.convert(Ge),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this},o.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this},o.prototype.getElement=function(){return this._container},o.prototype.setText=function(Ge){return this.setDOMContent(Ne.window.document.createTextNode(Ge))},o.prototype.setHTML=function(Ge){var Qe,tt=Ne.window.document.createDocumentFragment(),rt=Ne.window.document.createElement("body");for(rt.innerHTML=Ge;Qe=rt.firstChild;)tt.appendChild(Qe);return this.setDOMContent(tt)},o.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},o.prototype.setMaxWidth=function(Ne){return this.options.maxWidth=Ne,this._update(),this},o.prototype.setDOMContent=function(Ne){return this._createContent(),this._content.appendChild(Ne),this._update(),this},o.prototype.addClassName=function(Ne){this._container&&this._container.classList.add(Ne)},o.prototype.removeClassName=function(Ne){this._container&&this._container.classList.remove(Ne)},o.prototype.toggleClassName=function(Ne){if(this._container)return this._container.classList.toggle(Ne)},o.prototype._createContent=function(){this._content&&Qe.remove(this._content),this._content=Qe.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=Qe.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},o.prototype._onMouseUp=function(Ne){this._update(Ne.point)},o.prototype._onMouseMove=function(Ne){this._update(Ne.point)},o.prototype._onDrag=function(Ne){this._update(Ne.point)},o.prototype._update=function(Ge){var tt=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=Qe.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=Qe.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach((function(Ne){return tt._container.classList.add(Ne)})),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Dr(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||Ge)){var rt=this._pos=this._trackPointer&&Ge?Ge:this._map.project(this._lngLat),nt=this.options.anchor,at=function e(Ge){if(Ge){if("number"==typeof Ge){var Qe=Math.round(Math.sqrt(.5*Math.pow(Ge,2)));return{center:new Ne.Point(0,0),top:new Ne.Point(0,Ge),"top-left":new Ne.Point(Qe,Qe),"top-right":new Ne.Point(-Qe,Qe),bottom:new Ne.Point(0,-Ge),"bottom-left":new Ne.Point(Qe,-Qe),"bottom-right":new Ne.Point(-Qe,-Qe),left:new Ne.Point(Ge,0),right:new Ne.Point(-Ge,0)}}if(Ge instanceof Ne.Point||Array.isArray(Ge)){var tt=Ne.Point.convert(Ge);return{center:tt,top:tt,"top-left":tt,"top-right":tt,bottom:tt,"bottom-left":tt,"bottom-right":tt,left:tt,right:tt}}return{center:Ne.Point.convert(Ge.center||[0,0]),top:Ne.Point.convert(Ge.top||[0,0]),"top-left":Ne.Point.convert(Ge["top-left"]||[0,0]),"top-right":Ne.Point.convert(Ge["top-right"]||[0,0]),bottom:Ne.Point.convert(Ge.bottom||[0,0]),"bottom-left":Ne.Point.convert(Ge["bottom-left"]||[0,0]),"bottom-right":Ne.Point.convert(Ge["bottom-right"]||[0,0]),left:Ne.Point.convert(Ge.left||[0,0]),right:Ne.Point.convert(Ge.right||[0,0])}}return e(new Ne.Point(0,0))}(this.options.offset);if(!nt){var it,ot=this._container.offsetWidth,dt=this._container.offsetHeight;it=rt.y+at.bottom.y<dt?["top"]:rt.y>this._map.transform.height-dt?["bottom"]:[],rt.x<ot/2?it.push("left"):rt.x>this._map.transform.width-ot/2&&it.push("right"),nt=0===it.length?"bottom":it.join("-")}var ht=rt.add(at[nt]).round();Qe.setTransform(this._container,Uc[nt]+" translate("+ht.x+"px,"+ht.y+"px)"),Lr(this._container,nt,"popup")}},o.prototype._onClose=function(){this.remove()},o}(Ne.Evented),$c={version:Ne.version,supported:Ge,setRTLTextPlugin:Ne.setRTLTextPlugin,getRTLTextPluginStatus:Ne.getRTLTextPluginStatus,Map:jc,NavigationControl:Cr,GeolocateControl:Xc,AttributionControl:gr,ScaleControl:Nr,FullscreenControl:qr,Popup:Kc,Marker:qc,Style:js,LngLat:Ne.LngLat,LngLatBounds:Ne.LngLatBounds,Point:Ne.Point,MercatorCoordinate:Ne.MercatorCoordinate,Evented:Ne.Evented,config:Ne.config,prewarm:function(){Ft().acquire(ms)},clearPrewarmedResources:function(){var Ne=vs;Ne&&(Ne.isPreloaded()&&1===Ne.numActive()?(Ne.release(ms),vs=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return Ne.config.ACCESS_TOKEN},set accessToken(Ge){Ne.config.ACCESS_TOKEN=Ge},get baseApiUrl(){return Ne.config.API_URL},set baseApiUrl(Ge){Ne.config.API_URL=Ge},get workerCount(){return kt.workerCount},set workerCount(Ne){kt.workerCount=Ne},get maxParallelImageRequests(){return Ne.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(Ge){Ne.config.MAX_PARALLEL_IMAGE_REQUESTS=Ge},clearStorage:function(Ge){Ne.clearTileCache(Ge)},workerUrl:""};return $c})),Qe},"object"==typeof Qe&&void 0!==Ge?Ge.exports=nt():"function"==typeof tt&&tt.amd?tt(nt):(rt=rt||self).mapboxgl=nt()},{}],474:[function(Ne,Ge,Qe){"use strict";Ge.exports=createTable;var tt=Ne("convex-hull");function constructVertex(Ne,Ge,Qe){for(var tt=new Array(Ne),rt=0;rt<Ne;++rt)tt[rt]=0,rt===Ge&&(tt[rt]+=.5),rt===Qe&&(tt[rt]+=.5);return tt}function constructCell(Ne,Ge){if(0===Ge||Ge===(1<<Ne+1)-1)return[];for(var Qe=[],rt=[],nt=0;nt<=Ne;++nt)if(Ge&1<<nt){Qe.push(constructVertex(Ne,nt-1,nt-1)),rt.push(null);for(var at=0;at<=Ne;++at)~Ge&1<<at&&(Qe.push(constructVertex(Ne,nt-1,at-1)),rt.push([nt,at]))}var it=tt(Qe),ot=[];e:for(nt=0;nt<it.length;++nt){var dt=it[nt],ht=[];for(at=0;at<dt.length;++at){if(!rt[dt[at]])continue e;ht.push(rt[dt[at]].slice())}ot.push(ht)}return ot}function createTable(Ne){for(var Ge=1<<Ne+1,Qe=new Array(Ge),tt=0;tt<Ge;++tt)Qe[tt]=constructCell(Ne,tt);return Qe}},{"convex-hull":135}],475:[function(Ne,Ge,Qe){var tt=Ne("./normalize"),rt=Ne("gl-mat4/create"),nt=Ne("gl-mat4/clone"),at=Ne("gl-mat4/determinant"),it=Ne("gl-mat4/invert"),ot=Ne("gl-mat4/transpose"),dt={length:Ne("gl-vec3/length"),normalize:Ne("gl-vec3/normalize"),dot:Ne("gl-vec3/dot"),cross:Ne("gl-vec3/cross")},ht=rt(),Dt=rt(),Ot=[0,0,0,0],Rt=[[0,0,0],[0,0,0],[0,0,0]],Zt=[0,0,0];function vec4multMat4(Ne,Ge,Qe){var tt=Ge[0],rt=Ge[1],nt=Ge[2],at=Ge[3];return Ne[0]=Qe[0]*tt+Qe[4]*rt+Qe[8]*nt+Qe[12]*at,Ne[1]=Qe[1]*tt+Qe[5]*rt+Qe[9]*nt+Qe[13]*at,Ne[2]=Qe[2]*tt+Qe[6]*rt+Qe[10]*nt+Qe[14]*at,Ne[3]=Qe[3]*tt+Qe[7]*rt+Qe[11]*nt+Qe[15]*at,Ne}function mat3from4(Ne,Ge){Ne[0][0]=Ge[0],Ne[0][1]=Ge[1],Ne[0][2]=Ge[2],Ne[1][0]=Ge[4],Ne[1][1]=Ge[5],Ne[1][2]=Ge[6],Ne[2][0]=Ge[8],Ne[2][1]=Ge[9],Ne[2][2]=Ge[10]}function combine(Ne,Ge,Qe,tt,rt){Ne[0]=Ge[0]*tt+Qe[0]*rt,Ne[1]=Ge[1]*tt+Qe[1]*rt,Ne[2]=Ge[2]*tt+Qe[2]*rt}Ge.exports=function(Ne,Ge,Qe,rt,er,dr){if(Ge||(Ge=[0,0,0]),Qe||(Qe=[0,0,0]),rt||(rt=[0,0,0]),er||(er=[0,0,0,1]),dr||(dr=[0,0,0,1]),!tt(ht,Ne))return!1;if(nt(Dt,ht),Dt[3]=0,Dt[7]=0,Dt[11]=0,Dt[15]=1,Math.abs(at(Dt)<1e-8))return!1;var mr=ht[3],xr=ht[7],br=ht[11],Ar=ht[12],en=ht[13],mn=ht[14],xn=ht[15];if(0!==mr||0!==xr||0!==br){if(Ot[0]=mr,Ot[1]=xr,Ot[2]=br,Ot[3]=xn,!it(Dt,Dt))return!1;ot(Dt,Dt),vec4multMat4(er,Ot,Dt)}else er[0]=er[1]=er[2]=0,er[3]=1;if(Ge[0]=Ar,Ge[1]=en,Ge[2]=mn,mat3from4(Rt,ht),Qe[0]=dt.length(Rt[0]),dt.normalize(Rt[0],Rt[0]),rt[0]=dt.dot(Rt[0],Rt[1]),combine(Rt[1],Rt[1],Rt[0],1,-rt[0]),Qe[1]=dt.length(Rt[1]),dt.normalize(Rt[1],Rt[1]),rt[0]/=Qe[1],rt[1]=dt.dot(Rt[0],Rt[2]),combine(Rt[2],Rt[2],Rt[0],1,-rt[1]),rt[2]=dt.dot(Rt[1],Rt[2]),combine(Rt[2],Rt[2],Rt[1],1,-rt[2]),Qe[2]=dt.length(Rt[2]),dt.normalize(Rt[2],Rt[2]),rt[1]/=Qe[2],rt[2]/=Qe[2],dt.cross(Zt,Rt[1],Rt[2]),dt.dot(Rt[0],Zt)<0)for(var kn=0;kn<3;kn++)Qe[kn]*=-1,Rt[kn][0]*=-1,Rt[kn][1]*=-1,Rt[kn][2]*=-1;return dr[0]=.5*Math.sqrt(Math.max(1+Rt[0][0]-Rt[1][1]-Rt[2][2],0)),dr[1]=.5*Math.sqrt(Math.max(1-Rt[0][0]+Rt[1][1]-Rt[2][2],0)),dr[2]=.5*Math.sqrt(Math.max(1-Rt[0][0]-Rt[1][1]+Rt[2][2],0)),dr[3]=.5*Math.sqrt(Math.max(1+Rt[0][0]+Rt[1][1]+Rt[2][2],0)),Rt[2][1]>Rt[1][2]&&(dr[0]=-dr[0]),Rt[0][2]>Rt[2][0]&&(dr[1]=-dr[1]),Rt[1][0]>Rt[0][1]&&(dr[2]=-dr[2]),!0}},{"./normalize":476,"gl-mat4/clone":278,"gl-mat4/create":280,"gl-mat4/determinant":281,"gl-mat4/invert":293,"gl-mat4/transpose":306,"gl-vec3/cross":365,"gl-vec3/dot":370,"gl-vec3/length":380,"gl-vec3/normalize":387}],476:[function(Ne,Ge,Qe){Ge.exports=function(Ne,Ge){var Qe=Ge[15];if(0===Qe)return!1;for(var tt=1/Qe,rt=0;rt<16;rt++)Ne[rt]=Ge[rt]*tt;return!0}},{}],477:[function(Ne,Ge,Qe){var tt=Ne("gl-vec3/lerp"),rt=Ne("mat4-recompose"),nt=Ne("mat4-decompose"),at=Ne("gl-mat4/determinant"),it=Ne("quat-slerp"),ot=state(),dt=state(),ht=state();function interpolate(Ne,Ge,Qe,Dt){if(0===at(Ge)||0===at(Qe))return!1;var Ot=nt(Ge,ot.translate,ot.scale,ot.skew,ot.perspective,ot.quaternion),Rt=nt(Qe,dt.translate,dt.scale,dt.skew,dt.perspective,dt.quaternion);return!(!Ot||!Rt||(tt(ht.translate,ot.translate,dt.translate,Dt),tt(ht.skew,ot.skew,dt.skew,Dt),tt(ht.scale,ot.scale,dt.scale,Dt),tt(ht.perspective,ot.perspective,dt.perspective,Dt),it(ht.quaternion,ot.quaternion,dt.quaternion,Dt),rt(Ne,ht.translate,ht.scale,ht.skew,ht.perspective,ht.quaternion),0))}function state(){return{translate:vec3(),scale:vec3(1),skew:vec3(),perspective:vec4(),quaternion:vec4()}}function vec3(Ne){return[Ne||0,Ne||0,Ne||0]}function vec4(){return[0,0,0,1]}Ge.exports=interpolate},{"gl-mat4/determinant":281,"gl-vec3/lerp":381,"mat4-decompose":475,"mat4-recompose":478,"quat-slerp":527}],478:[function(Ne,Ge,Qe){var tt={identity:Ne("gl-mat4/identity"),translate:Ne("gl-mat4/translate"),multiply:Ne("gl-mat4/multiply"),create:Ne("gl-mat4/create"),scale:Ne("gl-mat4/scale"),fromRotationTranslation:Ne("gl-mat4/fromRotationTranslation")},rt=(tt.create(),tt.create());Ge.exports=function(Ne,Ge,Qe,nt,at,it){return tt.identity(Ne),tt.fromRotationTranslation(Ne,it,Ge),Ne[3]=at[0],Ne[7]=at[1],Ne[11]=at[2],Ne[15]=at[3],tt.identity(rt),0!==nt[2]&&(rt[9]=nt[2],tt.multiply(Ne,Ne,rt)),0!==nt[1]&&(rt[9]=0,rt[8]=nt[1],tt.multiply(Ne,Ne,rt)),0!==nt[0]&&(rt[8]=0,rt[4]=nt[0],tt.multiply(Ne,Ne,rt)),tt.scale(Ne,Ne,Qe),Ne}},{"gl-mat4/create":280,"gl-mat4/fromRotationTranslation":284,"gl-mat4/identity":291,"gl-mat4/multiply":295,"gl-mat4/scale":303,"gl-mat4/translate":305}],479:[function(Ne,Ge,Qe){"use strict";Ge.exports=Math.log2||function(Ne){return Math.log(Ne)*Math.LOG2E}},{}],480:[function(Ne,Ge,Qe){"use strict";var tt=Ne("binary-search-bounds"),rt=Ne("mat4-interpolate"),nt=Ne("gl-mat4/invert"),at=Ne("gl-mat4/rotateX"),it=Ne("gl-mat4/rotateY"),ot=Ne("gl-mat4/rotateZ"),dt=Ne("gl-mat4/lookAt"),ht=Ne("gl-mat4/translate"),Dt=(Ne("gl-mat4/scale"),Ne("gl-vec3/normalize")),Ot=[0,0,0];function MatrixCameraController(Ne){this._components=Ne.slice(),this._time=[0],this.prevMatrix=Ne.slice(),this.nextMatrix=Ne.slice(),this.computedMatrix=Ne.slice(),this.computedInverse=Ne.slice(),this.computedEye=[0,0,0],this.computedUp=[0,0,0],this.computedCenter=[0,0,0],this.computedRadius=[0],this._limits=[-1/0,1/0]}Ge.exports=createMatrixCameraController;var Rt=MatrixCameraController.prototype;Rt.recalcMatrix=function(Ne){var Ge=this._time,Qe=tt.le(Ge,Ne),at=this.computedMatrix;if(!(Qe<0)){var it=this._components;if(Qe===Ge.length-1)for(var ot=16*Qe,dt=0;dt<16;++dt)at[dt]=it[ot++];else{var ht=Ge[Qe+1]-Ge[Qe],Ot=(ot=16*Qe,this.prevMatrix),Rt=!0;for(dt=0;dt<16;++dt)Ot[dt]=it[ot++];var Zt=this.nextMatrix;for(dt=0;dt<16;++dt)Zt[dt]=it[ot++],Rt=Rt&&Ot[dt]===Zt[dt];if(ht<1e-6||Rt)for(dt=0;dt<16;++dt)at[dt]=Ot[dt];else rt(at,Ot,Zt,(Ne-Ge[Qe])/ht)}var er=this.computedUp;er[0]=at[1],er[1]=at[5],er[2]=at[9],Dt(er,er);var dr=this.computedInverse;nt(dr,at);var mr=this.computedEye,xr=dr[15];mr[0]=dr[12]/xr,mr[1]=dr[13]/xr,mr[2]=dr[14]/xr;var br=this.computedCenter,Ar=Math.exp(this.computedRadius[0]);for(dt=0;dt<3;++dt)br[dt]=mr[dt]-at[2+4*dt]*Ar}},Rt.idle=function(Ne){if(!(Ne<this.lastT())){for(var Ge=this._components,Qe=Ge.length-16,tt=0;tt<16;++tt)Ge.push(Ge[Qe++]);this._time.push(Ne)}},Rt.flush=function(Ne){var Ge=tt.gt(this._time,Ne)-2;Ge<0||(this._time.splice(0,Ge),this._components.splice(0,16*Ge))},Rt.lastT=function(){return this._time[this._time.length-1]},Rt.lookAt=function(Ne,Ge,Qe,tt){this.recalcMatrix(Ne),Ge=Ge||this.computedEye,Qe=Qe||Ot,tt=tt||this.computedUp,this.setMatrix(Ne,dt(this.computedMatrix,Ge,Qe,tt));for(var rt=0,nt=0;nt<3;++nt)rt+=Math.pow(Qe[nt]-Ge[nt],2);rt=Math.log(Math.sqrt(rt)),this.computedRadius[0]=rt},Rt.rotate=function(Ne,Ge,Qe,tt){this.recalcMatrix(Ne);var rt=this.computedInverse;Ge&&it(rt,rt,Ge),Qe&&at(rt,rt,Qe),tt&&ot(rt,rt,tt),this.setMatrix(Ne,nt(this.computedMatrix,rt))};var Zt=[0,0,0];function createMatrixCameraController(Ne){return new MatrixCameraController((Ne=Ne||{}).matrix||[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}Rt.pan=function(Ne,Ge,Qe,tt){Zt[0]=-(Ge||0),Zt[1]=-(Qe||0),Zt[2]=-(tt||0),this.recalcMatrix(Ne);var rt=this.computedInverse;ht(rt,rt,Zt),this.setMatrix(Ne,nt(rt,rt))},Rt.translate=function(Ne,Ge,Qe,tt){Zt[0]=Ge||0,Zt[1]=Qe||0,Zt[2]=tt||0,this.recalcMatrix(Ne);var rt=this.computedMatrix;ht(rt,rt,Zt),this.setMatrix(Ne,rt)},Rt.setMatrix=function(Ne,Ge){if(!(Ne<this.lastT())){this._time.push(Ne);for(var Qe=0;Qe<16;++Qe)this._components.push(Ge[Qe])}},Rt.setDistance=function(Ne,Ge){this.computedRadius[0]=Ge},Rt.setDistanceLimits=function(Ne,Ge){var Qe=this._limits;Qe[0]=Ne,Qe[1]=Ge},Rt.getDistanceLimits=function(Ne){var Ge=this._limits;return Ne?(Ne[0]=Ge[0],Ne[1]=Ge[1],Ne):Ge}},{"binary-search-bounds":481,"gl-mat4/invert":293,"gl-mat4/lookAt":294,"gl-mat4/rotateX":300,"gl-mat4/rotateY":301,"gl-mat4/rotateZ":302,"gl-mat4/scale":303,"gl-mat4/translate":305,"gl-vec3/normalize":387,"mat4-interpolate":477}],481:[function(Ne,Ge,Qe){arguments[4][243][0].apply(Qe,arguments)},{dup:243}],482:[function(Ne,Ge,Qe){"use strict";Ge.exports=monotoneConvexHull2D;var tt=Ne("robust-orientation")[3];function monotoneConvexHull2D(Ne){var Ge=Ne.length;if(Ge<3){for(var Qe=new Array(Ge),rt=0;rt<Ge;++rt)Qe[rt]=rt;return 2===Ge&&Ne[0][0]===Ne[1][0]&&Ne[0][1]===Ne[1][1]?[0]:Qe}var nt=new Array(Ge);for(rt=0;rt<Ge;++rt)nt[rt]=rt;nt.sort((function(Ge,Qe){var tt=Ne[Ge][0]-Ne[Qe][0];return tt||Ne[Ge][1]-Ne[Qe][1]}));var at=[nt[0],nt[1]],it=[nt[0],nt[1]];for(rt=2;rt<Ge;++rt){for(var ot=nt[rt],dt=Ne[ot],ht=at.length;ht>1&&tt(Ne[at[ht-2]],Ne[at[ht-1]],dt)<=0;)ht-=1,at.pop();for(at.push(ot),ht=it.length;ht>1&&tt(Ne[it[ht-2]],Ne[it[ht-1]],dt)>=0;)ht-=1,it.pop();it.push(ot)}Qe=new Array(it.length+at.length-2);for(var Dt=0,Ot=(rt=0,at.length);rt<Ot;++rt)Qe[Dt++]=at[rt];for(var Rt=it.length-2;Rt>0;--Rt)Qe[Dt++]=it[Rt];return Qe}},{"robust-orientation":548}],483:[function(Ne,Ge,Qe){"use strict";Ge.exports=mouseListen;var tt=Ne("mouse-event");function mouseListen(Ne,Ge){Ge||(Ge=Ne,Ne=window);var Qe=0,rt=0,nt=0,at={shift:!1,alt:!1,control:!1,meta:!1},it=!1;function updateMods(Ne){var Ge=!1;return"altKey"in Ne&&(Ge=Ge||Ne.altKey!==at.alt,at.alt=!!Ne.altKey),"shiftKey"in Ne&&(Ge=Ge||Ne.shiftKey!==at.shift,at.shift=!!Ne.shiftKey),"ctrlKey"in Ne&&(Ge=Ge||Ne.ctrlKey!==at.control,at.control=!!Ne.ctrlKey),"metaKey"in Ne&&(Ge=Ge||Ne.metaKey!==at.meta,at.meta=!!Ne.metaKey),Ge}function handleEvent(Ne,it){var ot=tt.x(it),dt=tt.y(it);"buttons"in it&&(Ne=0|it.buttons),(Ne!==Qe||ot!==rt||dt!==nt||updateMods(it))&&(Qe=0|Ne,rt=ot||0,nt=dt||0,Ge&&Ge(Qe,rt,nt,at))}function clearState(Ne){handleEvent(0,Ne)}function handleBlur(){(Qe||rt||nt||at.shift||at.alt||at.meta||at.control)&&(rt=nt=0,Qe=0,at.shift=at.alt=at.control=at.meta=!1,Ge&&Ge(0,0,0,at))}function handleMods(Ne){updateMods(Ne)&&Ge&&Ge(Qe,rt,nt,at)}function handleMouseMove(Ne){0===tt.buttons(Ne)?handleEvent(0,Ne):handleEvent(Qe,Ne)}function handleMouseDown(Ne){handleEvent(Qe|tt.buttons(Ne),Ne)}function handleMouseUp(Ne){handleEvent(Qe&~tt.buttons(Ne),Ne)}function attachListeners(){it||(it=!0,Ne.addEventListener("mousemove",handleMouseMove),Ne.addEventListener("mousedown",handleMouseDown),Ne.addEventListener("mouseup",handleMouseUp),Ne.addEventListener("mouseleave",clearState),Ne.addEventListener("mouseenter",clearState),Ne.addEventListener("mouseout",clearState),Ne.addEventListener("mouseover",clearState),Ne.addEventListener("blur",handleBlur),Ne.addEventListener("keyup",handleMods),Ne.addEventListener("keydown",handleMods),Ne.addEventListener("keypress",handleMods),Ne!==window&&(window.addEventListener("blur",handleBlur),window.addEventListener("keyup",handleMods),window.addEventListener("keydown",handleMods),window.addEventListener("keypress",handleMods)))}function detachListeners(){it&&(it=!1,Ne.removeEventListener("mousemove",handleMouseMove),Ne.removeEventListener("mousedown",handleMouseDown),Ne.removeEventListener("mouseup",handleMouseUp),Ne.removeEventListener("mouseleave",clearState),Ne.removeEventListener("mouseenter",clearState),Ne.removeEventListener("mouseout",clearState),Ne.removeEventListener("mouseover",clearState),Ne.removeEventListener("blur",handleBlur),Ne.removeEventListener("keyup",handleMods),Ne.removeEventListener("keydown",handleMods),Ne.removeEventListener("keypress",handleMods),Ne!==window&&(window.removeEventListener("blur",handleBlur),window.removeEventListener("keyup",handleMods),window.removeEventListener("keydown",handleMods),window.removeEventListener("keypress",handleMods)))}attachListeners();var ot={element:Ne};return Object.defineProperties(ot,{enabled:{get:function(){return it},set:function(Ne){Ne?attachListeners():detachListeners()},enumerable:!0},buttons:{get:function(){return Qe},enumerable:!0},x:{get:function(){return rt},enumerable:!0},y:{get:function(){return nt},enumerable:!0},mods:{get:function(){return at},enumerable:!0}}),ot}},{"mouse-event":485}],484:[function(Ne,Ge,Qe){var tt={left:0,top:0};function mouseEventOffset(Ne,Ge,Qe){Ge=Ge||Ne.currentTarget||Ne.srcElement,Array.isArray(Qe)||(Qe=[0,0]);var tt=Ne.clientX||0,rt=Ne.clientY||0,nt=getBoundingClientOffset(Ge);return Qe[0]=tt-nt.left,Qe[1]=rt-nt.top,Qe}function getBoundingClientOffset(Ne){return Ne===window||Ne===document||Ne===document.body?tt:Ne.getBoundingClientRect()}Ge.exports=mouseEventOffset},{}],485:[function(Ne,Ge,Qe){"use strict";function mouseButtons(Ne){if("object"==typeof Ne){if("buttons"in Ne)return Ne.buttons;if("which"in Ne){if(2===(Ge=Ne.which))return 4;if(3===Ge)return 2;if(Ge>0)return 1<<Ge-1}else if("button"in Ne){var Ge;if(1===(Ge=Ne.button))return 4;if(2===Ge)return 2;if(Ge>=0)return 1<<Ge}}return 0}function mouseElement(Ne){return Ne.target||Ne.srcElement||window}function mouseRelativeX(Ne){if("object"==typeof Ne){if("offsetX"in Ne)return Ne.offsetX;var Ge=mouseElement(Ne).getBoundingClientRect();return Ne.clientX-Ge.left}return 0}function mouseRelativeY(Ne){if("object"==typeof Ne){if("offsetY"in Ne)return Ne.offsetY;var Ge=mouseElement(Ne).getBoundingClientRect();return Ne.clientY-Ge.top}return 0}Qe.buttons=mouseButtons,Qe.element=mouseElement,Qe.x=mouseRelativeX,Qe.y=mouseRelativeY},{}],486:[function(Ne,Ge,Qe){"use strict";var tt=Ne("to-px");function mouseWheelListen(Ne,Ge,Qe){"function"==typeof Ne&&(Qe=!!Ge,Ge=Ne,Ne=window);var rt=tt("ex",Ne),listener=function(Ne){Qe&&Ne.preventDefault();var tt=Ne.deltaX||0,nt=Ne.deltaY||0,at=Ne.deltaZ||0,it=1;switch(Ne.deltaMode){case 1:it=rt;break;case 2:it=window.innerHeight}if(nt*=it,at*=it,(tt*=it)||nt||at)return Ge(tt,nt,at,Ne)};return Ne.addEventListener("wheel",listener),listener}Ge.exports=mouseWheelListen},{"to-px":578}],487:[function(Ne,Ge,Qe){"use strict";var tt=Ne("typedarray-pool");function array(Ne){return"a"+Ne}function data(Ne){return"d"+Ne}function cube(Ne,Ge){return"c"+Ne+"_"+Ge}function shape(Ne){return"s"+Ne}function stride(Ne,Ge){return"t"+Ne+"_"+Ge}function offset(Ne){return"o"+Ne}function scalar(Ne){return"x"+Ne}function pointer(Ne){return"p"+Ne}function delta(Ne,Ge){return"d"+Ne+"_"+Ge}function index(Ne){return"i"+Ne}function step(Ne,Ge){return"u"+Ne+"_"+Ge}function pcube(Ne){return"b"+Ne}function qcube(Ne){return"y"+Ne}function pdelta(Ne){return"e"+Ne}function vert(Ne){return"v"+Ne}Ge.exports=createSurfaceExtractor;var rt="V",nt="P",at="N",it="Q",ot="X",dt="T";function permBitmask(Ne,Ge,Qe){for(var tt=0,rt=0;rt<Ne;++rt)Ge&1<<rt&&(tt|=1<<Qe[rt]);return tt}function compileSurfaceProcedure(Ne,Ge,Qe,ht,Dt,Ot){var Rt=Ot.length,Zt=Dt.length;if(Zt<2)throw new Error("ndarray-extract-contour: Dimension must be at least 2");for(var er="extractContour"+Dt.join("_"),dr=[],mr=[],xr=[],br=0;br<Rt;++br)xr.push(array(br));for(br=0;br<ht;++br)xr.push(scalar(br));for(br=0;br<Zt;++br)mr.push(shape(br)+"="+array(0)+".shape["+br+"]|0");for(br=0;br<Rt;++br){mr.push(data(br)+"="+array(br)+".data",offset(br)+"="+array(br)+".offset|0");for(var Ar=0;Ar<Zt;++Ar)mr.push(stride(br,Ar)+"="+array(br)+".stride["+Ar+"]|0")}for(br=0;br<Rt;++br)for(mr.push(pointer(br)+"="+offset(br)),mr.push(cube(br,0)),Ar=1;Ar<1<<Zt;++Ar){for(var en=[],mn=0;mn<Zt;++mn)Ar&1<<mn&&en.push("-"+stride(br,mn));mr.push(delta(br,Ar)+"=("+en.join("")+")|0"),mr.push(cube(br,Ar)+"=0")}for(br=0;br<Rt;++br)for(Ar=0;Ar<Zt;++Ar){var xn=[stride(br,Dt[Ar])];Ar>0&&xn.push(stride(br,Dt[Ar-1])+"*"+shape(Dt[Ar-1])),mr.push(step(br,Dt[Ar])+"=("+xn.join("-")+")|0")}for(br=0;br<Zt;++br)mr.push(index(br)+"=0");mr.push(at+"=0");var kn=["2"];for(br=Zt-2;br>=0;--br)kn.push(shape(Dt[br]));for(mr.push(it+"=("+kn.join("*")+")|0",nt+"=mallocUint32("+it+")",rt+"=mallocUint32("+it+")",ot+"=0"),mr.push(pcube(0)+"=0"),Ar=1;Ar<1<<Zt;++Ar){var Cn=[],En=[];for(mn=0;mn<Zt;++mn)Ar&1<<mn&&(0===En.length?Cn.push("1"):Cn.unshift(En.join("*"))),En.push(shape(Dt[mn]));var Pn="";Cn[0].indexOf(shape(Dt[Zt-2]))<0&&(Pn="-");var Dn=permBitmask(Zt,Ar,Dt);mr.push(pdelta(Dn)+"=(-"+Cn.join("-")+")|0",qcube(Dn)+"=("+Pn+Cn.join("-")+")|0",pcube(Dn)+"=0")}function forLoopBegin(Ne,Ge){dr.push("for(",index(Dt[Ne]),"=",Ge,";",index(Dt[Ne]),"<",shape(Dt[Ne]),";","++",index(Dt[Ne]),"){")}function forLoopEnd(Ne){for(var Ge=0;Ge<Rt;++Ge)dr.push(pointer(Ge),"+=",step(Ge,Dt[Ne]),";");dr.push("}")}function fillEmptySlice(Ne){for(var Ge=Ne-1;Ge>=0;--Ge)forLoopBegin(Ge,0);var Qe=[];for(Ge=0;Ge<Rt;++Ge)Ot[Ge]?Qe.push(data(Ge)+".get("+pointer(Ge)+")"):Qe.push(data(Ge)+"["+pointer(Ge)+"]");for(Ge=0;Ge<ht;++Ge)Qe.push(scalar(Ge));for(dr.push(nt,"[",ot,"++]=phase(",Qe.join(),");"),Ge=0;Ge<Ne;++Ge)forLoopEnd(Ge);for(var tt=0;tt<Rt;++tt)dr.push(pointer(tt),"+=",step(tt,Dt[Ne]),";")}function processGridCell(Ne){for(var Ge=0;Ge<Rt;++Ge)Ot[Ge]?dr.push(cube(Ge,0),"=",data(Ge),".get(",pointer(Ge),");"):dr.push(cube(Ge,0),"=",data(Ge),"[",pointer(Ge),"];");var Qe=[];for(Ge=0;Ge<Rt;++Ge)Qe.push(cube(Ge,0));for(Ge=0;Ge<ht;++Ge)Qe.push(scalar(Ge));dr.push(pcube(0),"=",nt,"[",ot,"]=phase(",Qe.join(),");");for(var tt=1;tt<1<<Zt;++tt)dr.push(pcube(tt),"=",nt,"[",ot,"+",pdelta(tt),"];");var it=[];for(tt=1;tt<1<<Zt;++tt)it.push("("+pcube(0)+"!=="+pcube(tt)+")");dr.push("if(",it.join("||"),"){");var dt=[];for(Ge=0;Ge<Zt;++Ge)dt.push(index(Ge));for(Ge=0;Ge<Rt;++Ge)for(dt.push(cube(Ge,0)),tt=1;tt<1<<Zt;++tt)Ot[Ge]?dr.push(cube(Ge,tt),"=",data(Ge),".get(",pointer(Ge),"+",delta(Ge,tt),");"):dr.push(cube(Ge,tt),"=",data(Ge),"[",pointer(Ge),"+",delta(Ge,tt),"];"),dt.push(cube(Ge,tt));for(Ge=0;Ge<1<<Zt;++Ge)dt.push(pcube(Ge));for(Ge=0;Ge<ht;++Ge)dt.push(scalar(Ge));dr.push("vertex(",dt.join(),");",vert(0),"=",rt,"[",ot,"]=",at,"++;");var Dt=(1<<Zt)-1,er=pcube(Dt);for(tt=0;tt<Zt;++tt)if(0==(Ne&~(1<<tt))){for(var mr=Dt^1<<tt,xr=pcube(mr),br=[],Ar=mr;Ar>0;Ar=Ar-1&mr)br.push(rt+"["+ot+"+"+pdelta(Ar)+"]");for(br.push(vert(0)),Ar=0;Ar<Rt;++Ar)1&tt?br.push(cube(Ar,Dt),cube(Ar,mr)):br.push(cube(Ar,mr),cube(Ar,Dt));for(1&tt?br.push(er,xr):br.push(xr,er),Ar=0;Ar<ht;++Ar)br.push(scalar(Ar));dr.push("if(",er,"!==",xr,"){","face(",br.join(),")}")}dr.push("}",ot,"+=1;")}function flip(){for(var Ne=1;Ne<1<<Zt;++Ne)dr.push(dt,"=",pdelta(Ne),";",pdelta(Ne),"=",qcube(Ne),";",qcube(Ne),"=",dt,";")}function createLoop(Ne,Ge){if(Ne<0)processGridCell(Ge);else{fillEmptySlice(Ne),dr.push("if(",shape(Dt[Ne]),">0){",index(Dt[Ne]),"=1;"),createLoop(Ne-1,Ge|1<<Dt[Ne]);for(var Qe=0;Qe<Rt;++Qe)dr.push(pointer(Qe),"+=",step(Qe,Dt[Ne]),";");Ne===Zt-1&&(dr.push(ot,"=0;"),flip()),forLoopBegin(Ne,2),createLoop(Ne-1,Ge),Ne===Zt-1&&(dr.push("if(",index(Dt[Zt-1]),"&1){",ot,"=0;}"),flip()),forLoopEnd(Ne),dr.push("}")}}mr.push(vert(0)+"=0",dt+"=0"),createLoop(Zt-1,0),dr.push("freeUint32(",rt,");freeUint32(",nt,");");var In=["'use strict';","function ",er,"(",xr.join(),"){","var ",mr.join(),";",dr.join(""),"}","return ",er].join("");return new Function("vertex","face","phase","mallocUint32","freeUint32",In)(Ne,Ge,Qe,tt.mallocUint32,tt.freeUint32)}function createSurfaceExtractor(Ne){function error(Ne){throw new Error("ndarray-extract-contour: "+Ne)}"object"!=typeof Ne&&error("Must specify arguments");var Ge=Ne.order;Array.isArray(Ge)||error("Must specify order");var Qe=Ne.arrayArguments||1;Qe<1&&error("Must have at least one array argument");var tt=Ne.scalarArguments||0;tt<0&&error("Scalar arg count must be > 0"),"function"!=typeof Ne.vertex&&error("Must specify vertex creation function"),"function"!=typeof Ne.cell&&error("Must specify cell creation function"),"function"!=typeof Ne.phase&&error("Must specify phase function");for(var rt=Ne.getters||[],nt=new Array(Qe),at=0;at<Qe;++at)rt.indexOf(at)>=0?nt[at]=!0:nt[at]=!1;return compileSurfaceProcedure(Ne.vertex,Ne.cell,Ne.phase,tt,Ge,nt)}},{"typedarray-pool":595}],488:[function(Ne,Ge,Qe){"use strict";Ge.exports=gradient;var tt=Ne("dup"),rt=Ne("cwise-compiler"),nt={},at={},it={body:"",args:[],thisVars:[],localVars:[]},ot=rt({args:["array","array","array"],pre:it,post:it,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1},{name:"left",lvalue:!1,rvalue:!0,count:1},{name:"right",lvalue:!1,rvalue:!0,count:1}],body:"out=0.5*(left-right)",thisVars:[],localVars:[]},funcName:"cdiff"}),dt=rt({args:["array"],pre:it,post:it,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1}],body:"out=0",thisVars:[],localVars:[]},funcName:"zero"});function generateTemplate(Ne){if(Ne in nt)return nt[Ne];for(var Ge=[],Qe=0;Qe<Ne;++Qe)Ge.push("out",Qe,"s=0.5*(inp",Qe,"l-inp",Qe,"r);");var at=["array"],ot=["junk"];for(Qe=0;Qe<Ne;++Qe){at.push("array"),ot.push("out"+Qe+"s");var dt=tt(Ne);dt[Qe]=-1,at.push({array:0,offset:dt.slice()}),dt[Qe]=1,at.push({array:0,offset:dt.slice()}),ot.push("inp"+Qe+"l","inp"+Qe+"r")}return nt[Ne]=rt({args:at,pre:it,post:it,body:{body:Ge.join(""),args:ot.map((function(Ne){return{name:Ne,lvalue:0===Ne.indexOf("out"),rvalue:0===Ne.indexOf("inp"),count:"junk"!==Ne|0}})),thisVars:[],localVars:[]},funcName:"fdTemplate"+Ne})}function generateGradient(Ne){var Ge=Ne.join();if(er=at[Ge])return er;var Qe=Ne.length,tt=["function gradient(dst,src){var s=src.shape.slice();"];function handleBoundary(Ge){for(var rt=Qe-Ge.length,nt=[],at=[],it=[],ot=0;ot<Qe;++ot)Ge.indexOf(ot+1)>=0?it.push("0"):Ge.indexOf(-(ot+1))>=0?it.push("s["+ot+"]-1"):(it.push("-1"),nt.push("1"),at.push("s["+ot+"]-2"));var dt=".lo("+nt.join()+").hi("+at.join()+")";if(0===nt.length&&(dt=""),rt>0){for(tt.push("if(1"),ot=0;ot<Qe;++ot)Ge.indexOf(ot+1)>=0||Ge.indexOf(-(ot+1))>=0||tt.push("&&s[",ot,"]>2");for(tt.push("){grad",rt,"(src.pick(",it.join(),")",dt),ot=0;ot<Qe;++ot)Ge.indexOf(ot+1)>=0||Ge.indexOf(-(ot+1))>=0||tt.push(",dst.pick(",it.join(),",",ot,")",dt);tt.push(");")}for(ot=0;ot<Ge.length;++ot){var ht=Math.abs(Ge[ot])-1,Dt="dst.pick("+it.join()+","+ht+")"+dt;switch(Ne[ht]){case"clamp":var Ot=it.slice(),Rt=it.slice();Ge[ot]<0?Ot[ht]="s["+ht+"]-2":Rt[ht]="1",0===rt?tt.push("if(s[",ht,"]>1){dst.set(",it.join(),",",ht,",0.5*(src.get(",Ot.join(),")-src.get(",Rt.join(),")))}else{dst.set(",it.join(),",",ht,",0)};"):tt.push("if(s[",ht,"]>1){diff(",Dt,",src.pick(",Ot.join(),")",dt,",src.pick(",Rt.join(),")",dt,");}else{zero(",Dt,");};");break;case"mirror":0===rt?tt.push("dst.set(",it.join(),",",ht,",0);"):tt.push("zero(",Dt,");");break;case"wrap":var Zt=it.slice(),er=it.slice();Ge[ot]<0?(Zt[ht]="s["+ht+"]-2",er[ht]="0"):(Zt[ht]="s["+ht+"]-1",er[ht]="1"),0===rt?tt.push("if(s[",ht,"]>2){dst.set(",it.join(),",",ht,",0.5*(src.get(",Zt.join(),")-src.get(",er.join(),")))}else{dst.set(",it.join(),",",ht,",0)};"):tt.push("if(s[",ht,"]>2){diff(",Dt,",src.pick(",Zt.join(),")",dt,",src.pick(",er.join(),")",dt,");}else{zero(",Dt,");};");break;default:throw new Error("ndarray-gradient: Invalid boundary condition")}}rt>0&&tt.push("};")}for(var rt=0;rt<1<<Qe;++rt){for(var it=[],ht=0;ht<Qe;++ht)rt&1<<ht&&it.push(ht+1);for(var Dt=0;Dt<1<<it.length;++Dt){var Ot=it.slice();for(ht=0;ht<it.length;++ht)Dt&1<<ht&&(Ot[ht]=-Ot[ht]);handleBoundary(Ot)}}tt.push("return dst;};return gradient");var Rt=["diff","zero"],Zt=[ot,dt];for(rt=1;rt<=Qe;++rt)Rt.push("grad"+rt),Zt.push(generateTemplate(rt));Rt.push(tt.join(""));var er=Function.apply(void 0,Rt).apply(void 0,Zt);return nt[Ge]=er,er}function gradient(Ne,Ge,Qe){if(Array.isArray(Qe)){if(Qe.length!==Ge.dimension)throw new Error("ndarray-gradient: invalid boundary conditions")}else Qe=tt(Ge.dimension,"string"==typeof Qe?Qe:"clamp");if(Ne.dimension!==Ge.dimension+1)throw new Error("ndarray-gradient: output dimension must be +1 input dimension");if(Ne.shape[Ge.dimension]!==Ge.dimension)throw new Error("ndarray-gradient: output shape must match input shape");for(var rt=0;rt<Ge.dimension;++rt)if(Ne.shape[rt]!==Ge.shape[rt])throw new Error("ndarray-gradient: shape mismatch");return 0===Ge.size?Ne:Ge.dimension<=0?(Ne.set(0),Ne):generateGradient(Qe)(Ne,Ge)}},{"cwise-compiler":151,dup:176}],489:[function(Ne,Ge,Qe){"use strict";function interp1d(Ne,Ge){var Qe=Math.floor(Ge),tt=Ge-Qe,rt=0<=Qe&&Qe<Ne.shape[0],nt=0<=Qe+1&&Qe+1<Ne.shape[0];return(1-tt)*(rt?+Ne.get(Qe):0)+tt*(nt?+Ne.get(Qe+1):0)}function interp2d(Ne,Ge,Qe){var tt=Math.floor(Ge),rt=Ge-tt,nt=0<=tt&&tt<Ne.shape[0],at=0<=tt+1&&tt+1<Ne.shape[0],it=Math.floor(Qe),ot=Qe-it,dt=0<=it&&it<Ne.shape[1],ht=0<=it+1&&it+1<Ne.shape[1],Dt=nt&&dt?Ne.get(tt,it):0,Ot=nt&&ht?Ne.get(tt,it+1):0;return(1-ot)*((1-rt)*Dt+rt*(at&&dt?Ne.get(tt+1,it):0))+ot*((1-rt)*Ot+rt*(at&&ht?Ne.get(tt+1,it+1):0))}function interp3d(Ne,Ge,Qe,tt){var rt=Math.floor(Ge),nt=Ge-rt,at=0<=rt&&rt<Ne.shape[0],it=0<=rt+1&&rt+1<Ne.shape[0],ot=Math.floor(Qe),dt=Qe-ot,ht=0<=ot&&ot<Ne.shape[1],Dt=0<=ot+1&&ot+1<Ne.shape[1],Ot=Math.floor(tt),Rt=tt-Ot,Zt=0<=Ot&&Ot<Ne.shape[2],er=0<=Ot+1&&Ot+1<Ne.shape[2],dr=at&&ht&&Zt?Ne.get(rt,ot,Ot):0,mr=at&&Dt&&Zt?Ne.get(rt,ot+1,Ot):0,xr=it&&ht&&Zt?Ne.get(rt+1,ot,Ot):0,br=it&&Dt&&Zt?Ne.get(rt+1,ot+1,Ot):0,Ar=at&&ht&&er?Ne.get(rt,ot,Ot+1):0,en=at&&Dt&&er?Ne.get(rt,ot+1,Ot+1):0;return(1-Rt)*((1-dt)*((1-nt)*dr+nt*xr)+dt*((1-nt)*mr+nt*br))+Rt*((1-dt)*((1-nt)*Ar+nt*(it&&ht&&er?Ne.get(rt+1,ot,Ot+1):0))+dt*((1-nt)*en+nt*(it&&Dt&&er?Ne.get(rt+1,ot+1,Ot+1):0)))}function interpNd(Ne){var Ge,Qe,tt=0|Ne.shape.length,rt=new Array(tt),nt=new Array(tt),at=new Array(tt),it=new Array(tt);for(Ge=0;Ge<tt;++Ge)Qe=+arguments[Ge+1],rt[Ge]=Math.floor(Qe),nt[Ge]=Qe-rt[Ge],at[Ge]=0<=rt[Ge]&&rt[Ge]<Ne.shape[Ge],it[Ge]=0<=rt[Ge]+1&&rt[Ge]+1<Ne.shape[Ge];var ot,dt,ht,Dt=0;e:for(Ge=0;Ge<1<<tt;++Ge){for(dt=1,ht=Ne.offset,ot=0;ot<tt;++ot)if(Ge&1<<ot){if(!it[ot])continue e;dt*=nt[ot],ht+=Ne.stride[ot]*(rt[ot]+1)}else{if(!at[ot])continue e;dt*=1-nt[ot],ht+=Ne.stride[ot]*rt[ot]}Dt+=dt*Ne.data[ht]}return Dt}function interpolate(Ne,Ge,Qe,tt){switch(Ne.shape.length){case 0:return 0;case 1:return interp1d(Ne,Ge);case 2:return interp2d(Ne,Ge,Qe);case 3:return interp3d(Ne,Ge,Qe,tt);default:return interpNd.apply(void 0,arguments)}}Ge.exports=interpolate,Ge.exports.d1=interp1d,Ge.exports.d2=interp2d,Ge.exports.d3=interp3d},{}],490:[function(Ne,Ge,Qe){"use strict";var tt=Ne("cwise-compiler"),rt={body:"",args:[],thisVars:[],localVars:[]};function fixup(Ne){if(!Ne)return rt;for(var Ge=0;Ge<Ne.args.length;++Ge){var Qe=Ne.args[Ge];Ne.args[Ge]=0===Ge?{name:Qe,lvalue:!0,rvalue:!!Ne.rvalue,count:Ne.count||1}:{name:Qe,lvalue:!1,rvalue:!0,count:1}}return Ne.thisVars||(Ne.thisVars=[]),Ne.localVars||(Ne.localVars=[]),Ne}function pcompile(Ne){return tt({args:Ne.args,pre:fixup(Ne.pre),body:fixup(Ne.body),post:fixup(Ne.proc),funcName:Ne.funcName})}function makeOp(Ne){for(var Ge=[],Qe=0;Qe<Ne.args.length;++Qe)Ge.push("a"+Qe);return new Function("P",["return function ",Ne.funcName,"_ndarrayops(",Ge.join(","),") {P(",Ge.join(","),");return a0}"].join(""))(pcompile(Ne))}var nt={add:"+",sub:"-",mul:"*",div:"/",mod:"%",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};!function(){for(var Ne in nt){var Ge=nt[Ne];Qe[Ne]=makeOp({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+Ge+"c"},funcName:Ne}),Qe[Ne+"eq"]=makeOp({args:["array","array"],body:{args:["a","b"],body:"a"+Ge+"=b"},rvalue:!0,funcName:Ne+"eq"}),Qe[Ne+"s"]=makeOp({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+Ge+"s"},funcName:Ne+"s"}),Qe[Ne+"seq"]=makeOp({args:["array","scalar"],body:{args:["a","s"],body:"a"+Ge+"=s"},rvalue:!0,funcName:Ne+"seq"})}}();var at={not:"!",bnot:"~",neg:"-",recip:"1.0/"};!function(){for(var Ne in at){var Ge=at[Ne];Qe[Ne]=makeOp({args:["array","array"],body:{args:["a","b"],body:"a="+Ge+"b"},funcName:Ne}),Qe[Ne+"eq"]=makeOp({args:["array"],body:{args:["a"],body:"a="+Ge+"a"},rvalue:!0,count:2,funcName:Ne+"eq"})}}();var it={and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">="};!function(){for(var Ne in it){var Ge=it[Ne];Qe[Ne]=makeOp({args:["array","array","array"],body:{args:["a","b","c"],body:"a=b"+Ge+"c"},funcName:Ne}),Qe[Ne+"s"]=makeOp({args:["array","array","scalar"],body:{args:["a","b","s"],body:"a=b"+Ge+"s"},funcName:Ne+"s"}),Qe[Ne+"eq"]=makeOp({args:["array","array"],body:{args:["a","b"],body:"a=a"+Ge+"b"},rvalue:!0,count:2,funcName:Ne+"eq"}),Qe[Ne+"seq"]=makeOp({args:["array","scalar"],body:{args:["a","s"],body:"a=a"+Ge+"s"},rvalue:!0,count:2,funcName:Ne+"seq"})}}();var ot=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"];!function(){for(var Ne=0;Ne<ot.length;++Ne){var Ge=ot[Ne];Qe[Ge]=makeOp({args:["array","array"],pre:{args:[],body:"this_f=Math."+Ge,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b)",thisVars:["this_f"]},funcName:Ge}),Qe[Ge+"eq"]=makeOp({args:["array"],pre:{args:[],body:"this_f=Math."+Ge,thisVars:["this_f"]},body:{args:["a"],body:"a=this_f(a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:Ge+"eq"})}}();var dt=["max","min","atan2","pow"];!function(){for(var Ne=0;Ne<dt.length;++Ne){var Ge=dt[Ne];Qe[Ge]=makeOp({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+Ge,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:Ge}),Qe[Ge+"s"]=makeOp({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+Ge,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(b,c)",thisVars:["this_f"]},funcName:Ge+"s"}),Qe[Ge+"eq"]=makeOp({args:["array","array"],pre:{args:[],body:"this_f=Math."+Ge,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:Ge+"eq"}),Qe[Ge+"seq"]=makeOp({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+Ge,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(a,b)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:Ge+"seq"})}}();var ht=["atan2","pow"];!function(){for(var Ne=0;Ne<ht.length;++Ne){var Ge=ht[Ne];Qe[Ge+"op"]=makeOp({args:["array","array","array"],pre:{args:[],body:"this_f=Math."+Ge,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:Ge+"op"}),Qe[Ge+"ops"]=makeOp({args:["array","array","scalar"],pre:{args:[],body:"this_f=Math."+Ge,thisVars:["this_f"]},body:{args:["a","b","c"],body:"a=this_f(c,b)",thisVars:["this_f"]},funcName:Ge+"ops"}),Qe[Ge+"opeq"]=makeOp({args:["array","array"],pre:{args:[],body:"this_f=Math."+Ge,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:Ge+"opeq"}),Qe[Ge+"opseq"]=makeOp({args:["array","scalar"],pre:{args:[],body:"this_f=Math."+Ge,thisVars:["this_f"]},body:{args:["a","b"],body:"a=this_f(b,a)",thisVars:["this_f"]},rvalue:!0,count:2,funcName:Ge+"opseq"})}}(),Qe.any=tt({args:["array"],pre:rt,body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"if(a){return true}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return false"},funcName:"any"}),Qe.all=tt({args:["array"],pre:rt,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1}],body:"if(!x){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"all"}),Qe.sum=tt({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s+=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"sum"}),Qe.prod=tt({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=1"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:1}],body:"this_s*=a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"prod"}),Qe.norm2squared=tt({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm2squared"}),Qe.norm2=tt({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:2}],body:"this_s+=a*a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return Math.sqrt(this_s)"},funcName:"norm2"}),Qe.norminf=tt({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:4}],body:"if(-a>this_s){this_s=-a}else if(a>this_s){this_s=a}",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norminf"}),Qe.norm1=tt({args:["array"],pre:{args:[],localVars:[],thisVars:["this_s"],body:"this_s=0"},body:{args:[{name:"a",lvalue:!1,rvalue:!0,count:3}],body:"this_s+=a<0?-a:a",localVars:[],thisVars:["this_s"]},post:{args:[],localVars:[],thisVars:["this_s"],body:"return this_s"},funcName:"norm1"}),Qe.sup=tt({args:["array"],pre:{body:"this_h=-Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_>this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),Qe.inf=tt({args:["array"],pre:{body:"this_h=Infinity",args:[],thisVars:["this_h"],localVars:[]},body:{body:"if(_inline_1_arg0_<this_h)this_h=_inline_1_arg0_",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_h"],localVars:[]},post:{body:"return this_h",args:[],thisVars:["this_h"],localVars:[]}}),Qe.argmin=tt({args:["index","array","shape"],pre:{body:"{this_v=Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_<this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),Qe.argmax=tt({args:["index","array","shape"],pre:{body:"{this_v=-Infinity;this_i=_inline_0_arg2_.slice(0)}",args:[{name:"_inline_0_arg0_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg1_",lvalue:!1,rvalue:!1,count:0},{name:"_inline_0_arg2_",lvalue:!1,rvalue:!0,count:1}],thisVars:["this_i","this_v"],localVars:[]},body:{body:"{if(_inline_1_arg1_>this_v){this_v=_inline_1_arg1_;for(var _inline_1_k=0;_inline_1_k<_inline_1_arg0_.length;++_inline_1_k){this_i[_inline_1_k]=_inline_1_arg0_[_inline_1_k]}}}",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:2}],thisVars:["this_i","this_v"],localVars:["_inline_1_k"]},post:{body:"{return this_i}",args:[],thisVars:["this_i"],localVars:[]}}),Qe.random=makeOp({args:["array"],pre:{args:[],body:"this_f=Math.random",thisVars:["this_f"]},body:{args:["a"],body:"a=this_f()",thisVars:["this_f"]},funcName:"random"}),Qe.assign=makeOp({args:["array","array"],body:{args:["a","b"],body:"a=b"},funcName:"assign"}),Qe.assigns=makeOp({args:["array","scalar"],body:{args:["a","b"],body:"a=b"},funcName:"assigns"}),Qe.equals=tt({args:["array","array"],pre:rt,body:{args:[{name:"x",lvalue:!1,rvalue:!0,count:1},{name:"y",lvalue:!1,rvalue:!0,count:1}],body:"if(x!==y){return false}",localVars:[],thisVars:[]},post:{args:[],localVars:[],thisVars:[],body:"return true"},funcName:"equals"})},{"cwise-compiler":151}],491:[function(Ne,Ge,Qe){"use strict";var tt=Ne("ndarray"),rt=Ne("./doConvert.js");Ge.exports=function(Ne,Ge){for(var Qe=[],nt=Ne,at=1;Array.isArray(nt);)Qe.push(nt.length),at*=nt.length,nt=nt[0];return 0===Qe.length?tt():(Ge||(Ge=tt(new Float64Array(at),Qe)),rt(Ge,Ne),Ge)}},{"./doConvert.js":492,ndarray:495}],492:[function(Ne,Ge,Qe){Ge.exports=Ne("cwise-compiler")({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}",args:[{name:"_inline_1_arg0_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},{"cwise-compiler":151}],493:[function(Ne,Ge,Qe){"use strict";var tt=Ne("typedarray-pool"),rt=32;function getMallocFree(Ne){switch(Ne){case"uint8":return[tt.mallocUint8,tt.freeUint8];case"uint16":return[tt.mallocUint16,tt.freeUint16];case"uint32":return[tt.mallocUint32,tt.freeUint32];case"int8":return[tt.mallocInt8,tt.freeInt8];case"int16":return[tt.mallocInt16,tt.freeInt16];case"int32":return[tt.mallocInt32,tt.freeInt32];case"float32":return[tt.mallocFloat,tt.freeFloat];case"float64":return[tt.mallocDouble,tt.freeDouble];default:return null}}function shapeArgs(Ne){for(var Ge=[],Qe=0;Qe<Ne;++Qe)Ge.push("s"+Qe);for(Qe=0;Qe<Ne;++Qe)Ge.push("n"+Qe);for(Qe=1;Qe<Ne;++Qe)Ge.push("d"+Qe);for(Qe=1;Qe<Ne;++Qe)Ge.push("e"+Qe);for(Qe=1;Qe<Ne;++Qe)Ge.push("f"+Qe);return Ge}function createInsertionSort(Ne,Ge){var Qe=["'use strict'"],tt=["ndarrayInsertionSort",Ne.join("d"),Ge].join(""),rt=["left","right","data","offset"].concat(shapeArgs(Ne.length)),nt=getMallocFree(Ge),at=["i,j,cptr,ptr=left*s0+offset"];if(Ne.length>1){for(var it=[],ot=1;ot<Ne.length;++ot)at.push("i"+ot),it.push("n"+ot);nt?at.push("scratch=malloc("+it.join("*")+")"):at.push("scratch=new Array("+it.join("*")+")"),at.push("dptr","sptr","a","b")}else at.push("scratch");function dataRead(Ne){return"generic"===Ge?["data.get(",Ne,")"].join(""):["data[",Ne,"]"].join("")}function dataWrite(Ne,Qe){return"generic"===Ge?["data.set(",Ne,",",Qe,")"].join(""):["data[",Ne,"]=",Qe].join("")}if(Qe.push(["function ",tt,"(",rt.join(","),"){var ",at.join(",")].join(""),"for(i=left+1;i<=right;++i){","j=i;ptr+=s0","cptr=ptr"),Ne.length>1){for(Qe.push("dptr=0;sptr=ptr"),ot=Ne.length-1;ot>=0;--ot)0!==(dt=Ne[ot])&&Qe.push(["for(i",dt,"=0;i",dt,"<n",dt,";++i",dt,"){"].join(""));for(Qe.push("scratch[dptr++]=",dataRead("sptr")),ot=0;ot<Ne.length;++ot)0!==(dt=Ne[ot])&&Qe.push("sptr+=d"+dt,"}");for(Qe.push("__g:while(j--\x3eleft){","dptr=0","sptr=cptr-s0"),ot=1;ot<Ne.length;++ot)1===ot&&Qe.push("__l:"),Qe.push(["for(i",ot,"=0;i",ot,"<n",ot,";++i",ot,"){"].join(""));for(Qe.push(["a=",dataRead("sptr"),"\nb=scratch[dptr]\nif(a<b){break __g}\nif(a>b){break __l}"].join("")),ot=Ne.length-1;ot>=1;--ot)Qe.push("sptr+=e"+ot,"dptr+=f"+ot,"}");for(Qe.push("dptr=cptr;sptr=cptr-s0"),ot=Ne.length-1;ot>=0;--ot)0!==(dt=Ne[ot])&&Qe.push(["for(i",dt,"=0;i",dt,"<n",dt,";++i",dt,"){"].join(""));for(Qe.push(dataWrite("dptr",dataRead("sptr"))),ot=0;ot<Ne.length;++ot)0!==(dt=Ne[ot])&&Qe.push(["dptr+=d",dt,";sptr+=d",dt].join(""),"}");for(Qe.push("cptr-=s0\n}"),Qe.push("dptr=cptr;sptr=0"),ot=Ne.length-1;ot>=0;--ot)0!==(dt=Ne[ot])&&Qe.push(["for(i",dt,"=0;i",dt,"<n",dt,";++i",dt,"){"].join(""));for(Qe.push(dataWrite("dptr","scratch[sptr++]")),ot=0;ot<Ne.length;++ot){var dt;0!==(dt=Ne[ot])&&Qe.push("dptr+=d"+dt,"}")}}else Qe.push("scratch="+dataRead("ptr"),"while((j--\x3eleft)&&("+dataRead("cptr-s0")+">scratch)){",dataWrite("cptr",dataRead("cptr-s0")),"cptr-=s0","}",dataWrite("cptr","scratch"));return Qe.push("}"),Ne.length>1&&nt&&Qe.push("free(scratch)"),Qe.push("} return "+tt),nt?new Function("malloc","free",Qe.join("\n"))(nt[0],nt[1]):new Function(Qe.join("\n"))()}function createQuickSort(Ne,Ge,Qe){var tt=["'use strict'"],nt=["ndarrayQuickSort",Ne.join("d"),Ge].join(""),at=["left","right","data","offset"].concat(shapeArgs(Ne.length)),it=getMallocFree(Ge),ot=0;tt.push(["function ",nt,"(",at.join(","),"){"].join(""));var dt=["sixth=((right-left+1)/6)|0","index1=left+sixth","index5=right-sixth","index3=(left+right)>>1","index2=index3-sixth","index4=index3+sixth","el1=index1","el2=index2","el3=index3","el4=index4","el5=index5","less=left+1","great=right-1","pivots_are_equal=true","tmp","tmp0","x","y","z","k","ptr0","ptr1","ptr2","comp_pivot1=0","comp_pivot2=0","comp=0"];if(Ne.length>1){for(var ht=[],Dt=1;Dt<Ne.length;++Dt)ht.push("n"+Dt),dt.push("i"+Dt);for(Dt=0;Dt<8;++Dt)dt.push("b_ptr"+Dt);dt.push("ptr3","ptr4","ptr5","ptr6","ptr7","pivot_ptr","ptr_shift","elementSize="+ht.join("*")),it?dt.push("pivot1=malloc(elementSize)","pivot2=malloc(elementSize)"):dt.push("pivot1=new Array(elementSize),pivot2=new Array(elementSize)")}else dt.push("pivot1","pivot2");function toPointer(Ne){return["(offset+",Ne,"*s0)"].join("")}function dataRead(Ne){return"generic"===Ge?["data.get(",Ne,")"].join(""):["data[",Ne,"]"].join("")}function dataWrite(Ne,Qe){return"generic"===Ge?["data.set(",Ne,",",Qe,")"].join(""):["data[",Ne,"]=",Qe].join("")}function cacheLoop(Ge,Qe,rt){if(1===Ge.length)tt.push("ptr0="+toPointer(Ge[0]));else for(var nt=0;nt<Ge.length;++nt)tt.push(["b_ptr",nt,"=s0*",Ge[nt]].join(""));for(Qe&&tt.push("pivot_ptr=0"),tt.push("ptr_shift=offset"),nt=Ne.length-1;nt>=0;--nt)0!==(at=Ne[nt])&&tt.push(["for(i",at,"=0;i",at,"<n",at,";++i",at,"){"].join(""));if(Ge.length>1)for(nt=0;nt<Ge.length;++nt)tt.push(["ptr",nt,"=b_ptr",nt,"+ptr_shift"].join(""));for(tt.push(rt),Qe&&tt.push("++pivot_ptr"),nt=0;nt<Ne.length;++nt){var at;0!==(at=Ne[nt])&&(Ge.length>1?tt.push("ptr_shift+=d"+at):tt.push("ptr0+=d"+at),tt.push("}"))}}function lexicoLoop(Ge,Qe,rt,nt){if(1===Qe.length)tt.push("ptr0="+toPointer(Qe[0]));else{for(var at=0;at<Qe.length;++at)tt.push(["b_ptr",at,"=s0*",Qe[at]].join(""));tt.push("ptr_shift=offset")}for(rt&&tt.push("pivot_ptr=0"),Ge&&tt.push(Ge+":"),at=1;at<Ne.length;++at)tt.push(["for(i",at,"=0;i",at,"<n",at,";++i",at,"){"].join(""));if(Qe.length>1)for(at=0;at<Qe.length;++at)tt.push(["ptr",at,"=b_ptr",at,"+ptr_shift"].join(""));for(tt.push(nt),at=Ne.length-1;at>=1;--at)rt&&tt.push("pivot_ptr+=f"+at),Qe.length>1?tt.push("ptr_shift+=e"+at):tt.push("ptr0+=e"+at),tt.push("}")}function cleanUp(){Ne.length>1&&it&&tt.push("free(pivot1)","free(pivot2)")}function compareSwap(Ge,Qe){var rt="el"+Ge,nt="el"+Qe;if(Ne.length>1){var at="__l"+ ++ot;lexicoLoop(at,[rt,nt],!1,["comp=",dataRead("ptr0"),"-",dataRead("ptr1"),"\n","if(comp>0){tmp0=",rt,";",rt,"=",nt,";",nt,"=tmp0;break ",at,"}\n","if(comp<0){break ",at,"}"].join(""))}else tt.push(["if(",dataRead(toPointer(rt)),">",dataRead(toPointer(nt)),"){tmp0=",rt,";",rt,"=",nt,";",nt,"=tmp0}"].join(""))}function moveElement(Ge,Qe){Ne.length>1?cacheLoop([Ge,Qe],!1,dataWrite("ptr0",dataRead("ptr1"))):tt.push(dataWrite(toPointer(Ge),dataRead(toPointer(Qe))))}function comparePivot(Ge,Qe,rt){if(Ne.length>1){var nt="__l"+ ++ot;lexicoLoop(nt,[Qe],!0,[Ge,"=",dataRead("ptr0"),"-pivot",rt,"[pivot_ptr]\n","if(",Ge,"!==0){break ",nt,"}"].join(""))}else tt.push([Ge,"=",dataRead(toPointer(Qe)),"-pivot",rt].join(""))}function swapElements(Ge,Qe){Ne.length>1?cacheLoop([Ge,Qe],!1,["tmp=",dataRead("ptr0"),"\n",dataWrite("ptr0",dataRead("ptr1")),"\n",dataWrite("ptr1","tmp")].join("")):tt.push(["ptr0=",toPointer(Ge),"\n","ptr1=",toPointer(Qe),"\n","tmp=",dataRead("ptr0"),"\n",dataWrite("ptr0",dataRead("ptr1")),"\n",dataWrite("ptr1","tmp")].join(""))}function tripleSwap(Ge,Qe,rt){Ne.length>1?(cacheLoop([Ge,Qe,rt],!1,["tmp=",dataRead("ptr0"),"\n",dataWrite("ptr0",dataRead("ptr1")),"\n",dataWrite("ptr1",dataRead("ptr2")),"\n",dataWrite("ptr2","tmp")].join("")),tt.push("++"+Qe,"--"+rt)):tt.push(["ptr0=",toPointer(Ge),"\n","ptr1=",toPointer(Qe),"\n","ptr2=",toPointer(rt),"\n","++",Qe,"\n","--",rt,"\n","tmp=",dataRead("ptr0"),"\n",dataWrite("ptr0",dataRead("ptr1")),"\n",dataWrite("ptr1",dataRead("ptr2")),"\n",dataWrite("ptr2","tmp")].join(""))}function swapAndDecrement(Ne,Ge){swapElements(Ne,Ge),tt.push("--"+Ge)}function storePivot(Ge,Qe,rt){Ne.length>1?cacheLoop([Ge,Qe],!0,[dataWrite("ptr0",dataRead("ptr1")),"\n",dataWrite("ptr1",["pivot",rt,"[pivot_ptr]"].join(""))].join("")):tt.push(dataWrite(toPointer(Ge),dataRead(toPointer(Qe))),dataWrite(toPointer(Qe),"pivot"+rt))}function doSort(Ge,Qe){tt.push(["if((",Qe,"-",Ge,")<=",rt,"){\n","insertionSort(",Ge,",",Qe,",data,offset,",shapeArgs(Ne.length).join(","),")\n","}else{\n",nt,"(",Ge,",",Qe,",data,offset,",shapeArgs(Ne.length).join(","),")\n","}"].join(""))}function walkPointer(Ge,Qe,rt){Ne.length>1?(tt.push(["__l",++ot,":while(true){"].join("")),cacheLoop([Ge],!0,["if(",dataRead("ptr0"),"!==pivot",Qe,"[pivot_ptr]){break __l",ot,"}"].join("")),tt.push(rt,"}")):tt.push(["while(",dataRead(toPointer(Ge)),"===pivot",Qe,"){",rt,"}"].join(""))}return tt.push("var "+dt.join(",")),compareSwap(1,2),compareSwap(4,5),compareSwap(1,3),compareSwap(2,3),compareSwap(1,4),compareSwap(3,4),compareSwap(2,5),compareSwap(2,3),compareSwap(4,5),Ne.length>1?cacheLoop(["el1","el2","el3","el4","el5","index1","index3","index5"],!0,["pivot1[pivot_ptr]=",dataRead("ptr1"),"\n","pivot2[pivot_ptr]=",dataRead("ptr3"),"\n","pivots_are_equal=pivots_are_equal&&(pivot1[pivot_ptr]===pivot2[pivot_ptr])\n","x=",dataRead("ptr0"),"\n","y=",dataRead("ptr2"),"\n","z=",dataRead("ptr4"),"\n",dataWrite("ptr5","x"),"\n",dataWrite("ptr6","y"),"\n",dataWrite("ptr7","z")].join("")):tt.push(["pivot1=",dataRead(toPointer("el2")),"\n","pivot2=",dataRead(toPointer("el4")),"\n","pivots_are_equal=pivot1===pivot2\n","x=",dataRead(toPointer("el1")),"\n","y=",dataRead(toPointer("el3")),"\n","z=",dataRead(toPointer("el5")),"\n",dataWrite(toPointer("index1"),"x"),"\n",dataWrite(toPointer("index3"),"y"),"\n",dataWrite(toPointer("index5"),"z")].join("")),moveElement("index2","left"),moveElement("index4","right"),tt.push("if(pivots_are_equal){"),tt.push("for(k=less;k<=great;++k){"),comparePivot("comp","k",1),tt.push("if(comp===0){continue}"),tt.push("if(comp<0){"),tt.push("if(k!==less){"),swapElements("k","less"),tt.push("}"),tt.push("++less"),tt.push("}else{"),tt.push("while(true){"),comparePivot("comp","great",1),tt.push("if(comp>0){"),tt.push("great--"),tt.push("}else if(comp<0){"),tripleSwap("k","less","great"),tt.push("break"),tt.push("}else{"),swapAndDecrement("k","great"),tt.push("break"),tt.push("}"),tt.push("}"),tt.push("}"),tt.push("}"),tt.push("}else{"),tt.push("for(k=less;k<=great;++k){"),comparePivot("comp_pivot1","k",1),tt.push("if(comp_pivot1<0){"),tt.push("if(k!==less){"),swapElements("k","less"),tt.push("}"),tt.push("++less"),tt.push("}else{"),comparePivot("comp_pivot2","k",2),tt.push("if(comp_pivot2>0){"),tt.push("while(true){"),comparePivot("comp","great",2),tt.push("if(comp>0){"),tt.push("if(--great<k){break}"),tt.push("continue"),tt.push("}else{"),comparePivot("comp","great",1),tt.push("if(comp<0){"),tripleSwap("k","less","great"),tt.push("}else{"),swapAndDecrement("k","great"),tt.push("}"),tt.push("break"),tt.push("}"),tt.push("}"),tt.push("}"),tt.push("}"),tt.push("}"),tt.push("}"),storePivot("left","(less-1)",1),storePivot("right","(great+1)",2),doSort("left","(less-2)"),doSort("(great+2)","right"),tt.push("if(pivots_are_equal){"),cleanUp(),tt.push("return"),tt.push("}"),tt.push("if(less<index1&&great>index5){"),walkPointer("less",1,"++less"),walkPointer("great",2,"--great"),tt.push("for(k=less;k<=great;++k){"),comparePivot("comp_pivot1","k",1),tt.push("if(comp_pivot1===0){"),tt.push("if(k!==less){"),swapElements("k","less"),tt.push("}"),tt.push("++less"),tt.push("}else{"),comparePivot("comp_pivot2","k",2),tt.push("if(comp_pivot2===0){"),tt.push("while(true){"),comparePivot("comp","great",2),tt.push("if(comp===0){"),tt.push("if(--great<k){break}"),tt.push("continue"),tt.push("}else{"),comparePivot("comp","great",1),tt.push("if(comp<0){"),tripleSwap("k","less","great"),tt.push("}else{"),swapAndDecrement("k","great"),tt.push("}"),tt.push("break"),tt.push("}"),tt.push("}"),tt.push("}"),tt.push("}"),tt.push("}"),tt.push("}"),cleanUp(),doSort("less","great"),tt.push("}return "+nt),Ne.length>1&&it?new Function("insertionSort","malloc","free",tt.join("\n"))(Qe,it[0],it[1]):new Function("insertionSort",tt.join("\n"))(Qe)}function compileSort(Ne,Ge){var Qe=["'use strict'"],tt=["ndarraySortWrapper",Ne.join("d"),Ge].join(""),nt=["array"];Qe.push(["function ",tt,"(",nt.join(","),"){"].join(""));for(var at=["data=array.data,offset=array.offset|0,shape=array.shape,stride=array.stride"],it=0;it<Ne.length;++it)at.push(["s",it,"=stride[",it,"]|0,n",it,"=shape[",it,"]|0"].join(""));var ot=new Array(Ne.length),dt=[];for(it=0;it<Ne.length;++it)0!==(Ot=Ne[it])&&(0===dt.length?ot[Ot]="1":ot[Ot]=dt.join("*"),dt.push("n"+Ot));var ht=-1,Dt=-1;for(it=0;it<Ne.length;++it){var Ot,Rt=Ne[it];0!==Rt&&(ht>0?at.push(["d",Rt,"=s",Rt,"-d",ht,"*n",ht].join("")):at.push(["d",Rt,"=s",Rt].join("")),ht=Rt),0!=(Ot=Ne.length-1-it)&&(Dt>0?at.push(["e",Ot,"=s",Ot,"-e",Dt,"*n",Dt,",f",Ot,"=",ot[Ot],"-f",Dt,"*n",Dt].join("")):at.push(["e",Ot,"=s",Ot,",f",Ot,"=",ot[Ot]].join("")),Dt=Ot)}Qe.push("var "+at.join(","));var Zt=["0","n0-1","data","offset"].concat(shapeArgs(Ne.length));Qe.push(["if(n0<=",rt,"){","insertionSort(",Zt.join(","),")}else{","quickSort(",Zt.join(","),")}"].join("")),Qe.push("}return "+tt);var er=new Function("insertionSort","quickSort",Qe.join("\n")),dr=createInsertionSort(Ne,Ge);return er(dr,createQuickSort(Ne,Ge,dr))}Ge.exports=compileSort},{"typedarray-pool":595}],494:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./lib/compile_sort.js"),rt={};function sort(Ne){var Ge=Ne.order,Qe=Ne.dtype,nt=[Ge,Qe].join(":"),at=rt[nt];return at||(rt[nt]=at=tt(Ge,Qe)),at(Ne),Ne}Ge.exports=sort},{"./lib/compile_sort.js":493}],495:[function(Ne,Ge,Qe){var tt=Ne("iota-array"),rt=Ne("is-buffer"),nt="undefined"!=typeof Float64Array;function compare1st(Ne,Ge){return Ne[0]-Ge[0]}function order(){var Ne,Ge=this.stride,Qe=new Array(Ge.length);for(Ne=0;Ne<Qe.length;++Ne)Qe[Ne]=[Math.abs(Ge[Ne]),Ne];Qe.sort(compare1st);var tt=new Array(Qe.length);for(Ne=0;Ne<tt.length;++Ne)tt[Ne]=Qe[Ne][1];return tt}function compileConstructor(Ne,Ge){var Qe=["View",Ge,"d",Ne].join("");Ge<0&&(Qe="View_Nil"+Ne);var rt="generic"===Ne;if(-1===Ge){var nt="function "+Qe+"(a){this.data=a;};var proto="+Qe+".prototype;proto.dtype='"+Ne+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+Qe+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+Qe+"(a){return new "+Qe+"(a);}";return new Function(nt)()}if(0===Ge)return nt="function "+Qe+"(a,d) {this.data = a;this.offset = d};var proto="+Qe+".prototype;proto.dtype='"+Ne+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+Qe+"_copy() {return new "+Qe+"(this.data,this.offset)};proto.pick=function "+Qe+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+Qe+"_get(){return "+(rt?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+Qe+"_set(v){return "+(rt?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+Qe+"(a,b,c,d){return new "+Qe+"(a,d)}",new Function("TrivialArray",nt)(at[Ne][0]);nt=["'use strict'"];var it=tt(Ge),ot=it.map((function(Ne){return"i"+Ne})),dt="this.offset+"+it.map((function(Ne){return"this.stride["+Ne+"]*i"+Ne})).join("+"),ht=it.map((function(Ne){return"b"+Ne})).join(","),Dt=it.map((function(Ne){return"c"+Ne})).join(",");nt.push("function "+Qe+"(a,"+ht+","+Dt+",d){this.data=a","this.shape=["+ht+"]","this.stride=["+Dt+"]","this.offset=d|0}","var proto="+Qe+".prototype","proto.dtype='"+Ne+"'","proto.dimension="+Ge),nt.push("Object.defineProperty(proto,'size',{get:function "+Qe+"_size(){return "+it.map((function(Ne){return"this.shape["+Ne+"]"})).join("*"),"}})"),1===Ge?nt.push("proto.order=[0]"):(nt.push("Object.defineProperty(proto,'order',{get:"),Ge<4?(nt.push("function "+Qe+"_order(){"),2===Ge?nt.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===Ge&&nt.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):nt.push("ORDER})")),nt.push("proto.set=function "+Qe+"_set("+ot.join(",")+",v){"),rt?nt.push("return this.data.set("+dt+",v)}"):nt.push("return this.data["+dt+"]=v}"),nt.push("proto.get=function "+Qe+"_get("+ot.join(",")+"){"),rt?nt.push("return this.data.get("+dt+")}"):nt.push("return this.data["+dt+"]}"),nt.push("proto.index=function "+Qe+"_index(",ot.join(),"){return "+dt+"}"),nt.push("proto.hi=function "+Qe+"_hi("+ot.join(",")+"){return new "+Qe+"(this.data,"+it.map((function(Ne){return["(typeof i",Ne,"!=='number'||i",Ne,"<0)?this.shape[",Ne,"]:i",Ne,"|0"].join("")})).join(",")+","+it.map((function(Ne){return"this.stride["+Ne+"]"})).join(",")+",this.offset)}");var Ot=it.map((function(Ne){return"a"+Ne+"=this.shape["+Ne+"]"})),Rt=it.map((function(Ne){return"c"+Ne+"=this.stride["+Ne+"]"}));nt.push("proto.lo=function "+Qe+"_lo("+ot.join(",")+"){var b=this.offset,d=0,"+Ot.join(",")+","+Rt.join(","));for(var Zt=0;Zt<Ge;++Zt)nt.push("if(typeof i"+Zt+"==='number'&&i"+Zt+">=0){d=i"+Zt+"|0;b+=c"+Zt+"*d;a"+Zt+"-=d}");for(nt.push("return new "+Qe+"(this.data,"+it.map((function(Ne){return"a"+Ne})).join(",")+","+it.map((function(Ne){return"c"+Ne})).join(",")+",b)}"),nt.push("proto.step=function "+Qe+"_step("+ot.join(",")+"){var "+it.map((function(Ne){return"a"+Ne+"=this.shape["+Ne+"]"})).join(",")+","+it.map((function(Ne){return"b"+Ne+"=this.stride["+Ne+"]"})).join(",")+",c=this.offset,d=0,ceil=Math.ceil"),Zt=0;Zt<Ge;++Zt)nt.push("if(typeof i"+Zt+"==='number'){d=i"+Zt+"|0;if(d<0){c+=b"+Zt+"*(a"+Zt+"-1);a"+Zt+"=ceil(-a"+Zt+"/d)}else{a"+Zt+"=ceil(a"+Zt+"/d)}b"+Zt+"*=d}");nt.push("return new "+Qe+"(this.data,"+it.map((function(Ne){return"a"+Ne})).join(",")+","+it.map((function(Ne){return"b"+Ne})).join(",")+",c)}");var er=new Array(Ge),dr=new Array(Ge);for(Zt=0;Zt<Ge;++Zt)er[Zt]="a[i"+Zt+"]",dr[Zt]="b[i"+Zt+"]";for(nt.push("proto.transpose=function "+Qe+"_transpose("+ot+"){"+ot.map((function(Ne,Ge){return Ne+"=("+Ne+"===undefined?"+Ge+":"+Ne+"|0)"})).join(";"),"var a=this.shape,b=this.stride;return new "+Qe+"(this.data,"+er.join(",")+","+dr.join(",")+",this.offset)}"),nt.push("proto.pick=function "+Qe+"_pick("+ot+"){var a=[],b=[],c=this.offset"),Zt=0;Zt<Ge;++Zt)nt.push("if(typeof i"+Zt+"==='number'&&i"+Zt+">=0){c=(c+this.stride["+Zt+"]*i"+Zt+")|0}else{a.push(this.shape["+Zt+"]);b.push(this.stride["+Zt+"])}");return nt.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),nt.push("return function construct_"+Qe+"(data,shape,stride,offset){return new "+Qe+"(data,"+it.map((function(Ne){return"shape["+Ne+"]"})).join(",")+","+it.map((function(Ne){return"stride["+Ne+"]"})).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",nt.join("\n"))(at[Ne],order)}function arrayDType(Ne){if(rt(Ne))return"buffer";if(nt)switch(Object.prototype.toString.call(Ne)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(Ne)?"array":"generic"}var at={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};function wrappedNDArrayCtor(Ne,Ge,Qe,tt){if(void 0===Ne)return(0,at.array[0])([]);"number"==typeof Ne&&(Ne=[Ne]),void 0===Ge&&(Ge=[Ne.length]);var rt=Ge.length;if(void 0===Qe){Qe=new Array(rt);for(var nt=rt-1,it=1;nt>=0;--nt)Qe[nt]=it,it*=Ge[nt]}if(void 0===tt)for(tt=0,nt=0;nt<rt;++nt)Qe[nt]<0&&(tt-=(Ge[nt]-1)*Qe[nt]);for(var ot=arrayDType(Ne),dt=at[ot];dt.length<=rt+1;)dt.push(compileConstructor(ot,dt.length-1));return(0,dt[rt+1])(Ne,Ge,Qe,tt)}Ge.exports=wrappedNDArrayCtor},{"iota-array":463,"is-buffer":465}],496:[function(Ne,Ge,Qe){"use strict";var tt=Ne("double-bits"),rt=Math.pow(2,-1074),nt=-1>>>0;function nextafter(Ne,Ge){if(isNaN(Ne)||isNaN(Ge))return NaN;if(Ne===Ge)return Ne;if(0===Ne)return Ge<0?-rt:rt;var Qe=tt.hi(Ne),at=tt.lo(Ne);return Ge>Ne==Ne>0?at===nt?(Qe+=1,at=0):at+=1:0===at?(at=nt,Qe-=1):at-=1,tt.pack(at,Qe)}Ge.exports=nextafter},{"double-bits":173}],497:[function(Ne,Ge,Qe){var tt=Math.PI,rt=radians(120);function normalize(Ne){for(var Ge,Qe=[],tt=0,rt=0,nt=0,at=0,it=null,ot=null,dt=0,ht=0,Dt=0,Ot=Ne.length;Dt<Ot;Dt++){var Rt=Ne[Dt],Zt=Rt[0];switch(Zt){case"M":nt=Rt[1],at=Rt[2];break;case"A":(Rt=arc(dt,ht,Rt[1],Rt[2],radians(Rt[3]),Rt[4],Rt[5],Rt[6],Rt[7])).unshift("C"),Rt.length>7&&(Qe.push(Rt.splice(0,7)),Rt.unshift("C"));break;case"S":var er=dt,dr=ht;"C"!=Ge&&"S"!=Ge||(er+=er-tt,dr+=dr-rt),Rt=["C",er,dr,Rt[1],Rt[2],Rt[3],Rt[4]];break;case"T":"Q"==Ge||"T"==Ge?(it=2*dt-it,ot=2*ht-ot):(it=dt,ot=ht),Rt=quadratic(dt,ht,it,ot,Rt[1],Rt[2]);break;case"Q":it=Rt[1],ot=Rt[2],Rt=quadratic(dt,ht,Rt[1],Rt[2],Rt[3],Rt[4]);break;case"L":Rt=line(dt,ht,Rt[1],Rt[2]);break;case"H":Rt=line(dt,ht,Rt[1],ht);break;case"V":Rt=line(dt,ht,dt,Rt[1]);break;case"Z":Rt=line(dt,ht,nt,at)}Ge=Zt,dt=Rt[Rt.length-2],ht=Rt[Rt.length-1],Rt.length>4?(tt=Rt[Rt.length-4],rt=Rt[Rt.length-3]):(tt=dt,rt=ht),Qe.push(Rt)}return Qe}function line(Ne,Ge,Qe,tt){return["C",Ne,Ge,Qe,tt,Qe,tt]}function quadratic(Ne,Ge,Qe,tt,rt,nt){return["C",Ne/3+2/3*Qe,Ge/3+2/3*tt,rt/3+2/3*Qe,nt/3+2/3*tt,rt,nt]}function arc(Ne,Ge,Qe,nt,at,it,ot,dt,ht,Dt){if(Dt)en=Dt[0],mn=Dt[1],br=Dt[2],Ar=Dt[3];else{var Ot=rotate(Ne,Ge,-at);Ne=Ot.x,Ge=Ot.y;var Rt=(Ne-(dt=(Ot=rotate(dt,ht,-at)).x))/2,Zt=(Ge-(ht=Ot.y))/2,er=Rt*Rt/(Qe*Qe)+Zt*Zt/(nt*nt);er>1&&(Qe*=er=Math.sqrt(er),nt*=er);var dr=Qe*Qe,mr=nt*nt,xr=(it==ot?-1:1)*Math.sqrt(Math.abs((dr*mr-dr*Zt*Zt-mr*Rt*Rt)/(dr*Zt*Zt+mr*Rt*Rt)));xr==1/0&&(xr=1);var br=xr*Qe*Zt/nt+(Ne+dt)/2,Ar=xr*-nt*Rt/Qe+(Ge+ht)/2,en=Math.asin(((Ge-Ar)/nt).toFixed(9)),mn=Math.asin(((ht-Ar)/nt).toFixed(9));(en=Ne<br?tt-en:en)<0&&(en=2*tt+en),(mn=dt<br?tt-mn:mn)<0&&(mn=2*tt+mn),ot&&en>mn&&(en-=2*tt),!ot&&mn>en&&(mn-=2*tt)}if(Math.abs(mn-en)>rt){var xn=mn,kn=dt,Cn=ht;mn=en+rt*(ot&&mn>en?1:-1);var En=arc(dt=br+Qe*Math.cos(mn),ht=Ar+nt*Math.sin(mn),Qe,nt,at,0,ot,kn,Cn,[mn,xn,br,Ar])}var Pn=Math.tan((mn-en)/4),Dn=4/3*Qe*Pn,In=4/3*nt*Pn,zn=[2*Ne-(Ne+Dn*Math.sin(en)),2*Ge-(Ge-In*Math.cos(en)),dt+Dn*Math.sin(mn),ht-In*Math.cos(mn),dt,ht];if(Dt)return zn;En&&(zn=zn.concat(En));for(var Bn=0;Bn<zn.length;){var Vn=rotate(zn[Bn],zn[Bn+1],at);zn[Bn++]=Vn.x,zn[Bn++]=Vn.y}return zn}function rotate(Ne,Ge,Qe){return{x:Ne*Math.cos(Qe)-Ge*Math.sin(Qe),y:Ne*Math.sin(Qe)+Ge*Math.cos(Qe)}}function radians(Ne){return Ne*(tt/180)}Ge.exports=normalize},{}],498:[function(Ne,Ge,Qe){var tt=1e-6,rt=1e-6;Qe.vertexNormals=function(Ne,Ge,Qe){for(var rt=Ge.length,nt=new Array(rt),at=void 0===Qe?tt:Qe,it=0;it<rt;++it)nt[it]=[0,0,0];for(it=0;it<Ne.length;++it)for(var ot=Ne[it],dt=0,ht=ot[ot.length-1],Dt=ot[0],Ot=0;Ot<ot.length;++Ot){dt=ht,ht=Dt,Dt=ot[(Ot+1)%ot.length];for(var Rt=Ge[dt],Zt=Ge[ht],er=Ge[Dt],dr=new Array(3),mr=0,xr=new Array(3),br=0,Ar=0;Ar<3;++Ar)dr[Ar]=Rt[Ar]-Zt[Ar],mr+=dr[Ar]*dr[Ar],xr[Ar]=er[Ar]-Zt[Ar],br+=xr[Ar]*xr[Ar];if(mr*br>at){var en=nt[ht],mn=1/Math.sqrt(mr*br);for(Ar=0;Ar<3;++Ar){var xn=(Ar+1)%3,kn=(Ar+2)%3;en[Ar]+=mn*(xr[xn]*dr[kn]-xr[kn]*dr[xn])}}}for(it=0;it<rt;++it){en=nt[it];var Cn=0;for(Ar=0;Ar<3;++Ar)Cn+=en[Ar]*en[Ar];if(Cn>at)for(mn=1/Math.sqrt(Cn),Ar=0;Ar<3;++Ar)en[Ar]*=mn;else for(Ar=0;Ar<3;++Ar)en[Ar]=0}return nt},Qe.faceNormals=function(Ne,Ge,Qe){for(var tt=Ne.length,nt=new Array(tt),at=void 0===Qe?rt:Qe,it=0;it<tt;++it){for(var ot=Ne[it],dt=new Array(3),ht=0;ht<3;++ht)dt[ht]=Ge[ot[ht]];var Dt=new Array(3),Ot=new Array(3);for(ht=0;ht<3;++ht)Dt[ht]=dt[1][ht]-dt[0][ht],Ot[ht]=dt[2][ht]-dt[0][ht];var Rt=new Array(3),Zt=0;for(ht=0;ht<3;++ht){var er=(ht+1)%3,dr=(ht+2)%3;Rt[ht]=Dt[er]*Ot[dr]-Dt[dr]*Ot[er],Zt+=Rt[ht]*Rt[ht]}for(Zt=Zt>at?1/Math.sqrt(Zt):0,ht=0;ht<3;++ht)Rt[ht]*=Zt;nt[it]=Rt}return nt}},{}],499:[function(Ne,Ge,Qe){"use strict";var tt=Object.getOwnPropertySymbols,rt=Object.prototype.hasOwnProperty,nt=Object.prototype.propertyIsEnumerable;function toObject(Ne){if(null==Ne)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(Ne)}function shouldUseNative(){try{if(!Object.assign)return!1;var Ne=new String("abc");if(Ne[5]="de","5"===Object.getOwnPropertyNames(Ne)[0])return!1;for(var Ge={},Qe=0;Qe<10;Qe++)Ge["_"+String.fromCharCode(Qe)]=Qe;if("0123456789"!==Object.getOwnPropertyNames(Ge).map((function(Ne){return Ge[Ne]})).join(""))return!1;var tt={};return"abcdefghijklmnopqrst".split("").forEach((function(Ne){tt[Ne]=Ne})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},tt)).join("")}catch(Ne){return!1}}Ge.exports=shouldUseNative()?Object.assign:function(Ne,Ge){for(var Qe,at,it=toObject(Ne),ot=1;ot<arguments.length;ot++){for(var dt in Qe=Object(arguments[ot]))rt.call(Qe,dt)&&(it[dt]=Qe[dt]);if(tt){at=tt(Qe);for(var ht=0;ht<at.length;ht++)nt.call(Qe,at[ht])&&(it[at[ht]]=Qe[at[ht]])}}return it}},{}],500:[function(Ne,Ge,Qe){"use strict";function quatFromFrame(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt){var ht=Ge+nt+dt;if(Dt>0){var Dt=Math.sqrt(ht+1);Ne[0]=.5*(at-ot)/Dt,Ne[1]=.5*(it-tt)/Dt,Ne[2]=.5*(Qe-nt)/Dt,Ne[3]=.5*Dt}else{var Ot=Math.max(Ge,nt,dt);Dt=Math.sqrt(2*Ot-ht+1),Ge>=Ot?(Ne[0]=.5*Dt,Ne[1]=.5*(rt+Qe)/Dt,Ne[2]=.5*(it+tt)/Dt,Ne[3]=.5*(at-ot)/Dt):nt>=Ot?(Ne[0]=.5*(Qe+rt)/Dt,Ne[1]=.5*Dt,Ne[2]=.5*(ot+at)/Dt,Ne[3]=.5*(it-tt)/Dt):(Ne[0]=.5*(tt+it)/Dt,Ne[1]=.5*(at+ot)/Dt,Ne[2]=.5*Dt,Ne[3]=.5*(Qe-rt)/Dt)}return Ne}Ge.exports=quatFromFrame},{}],501:[function(Ne,Ge,Qe){"use strict";Ge.exports=createOrbitController;var tt=Ne("filtered-vector"),rt=Ne("gl-mat4/lookAt"),nt=Ne("gl-mat4/fromQuat"),at=Ne("gl-mat4/invert"),it=Ne("./lib/quatFromFrame");function len3(Ne,Ge,Qe){return Math.sqrt(Math.pow(Ne,2)+Math.pow(Ge,2)+Math.pow(Qe,2))}function len4(Ne,Ge,Qe,tt){return Math.sqrt(Math.pow(Ne,2)+Math.pow(Ge,2)+Math.pow(Qe,2)+Math.pow(tt,2))}function normalize4(Ne,Ge){var Qe=Ge[0],tt=Ge[1],rt=Ge[2],nt=Ge[3],at=len4(Qe,tt,rt,nt);at>1e-6?(Ne[0]=Qe/at,Ne[1]=tt/at,Ne[2]=rt/at,Ne[3]=nt/at):(Ne[0]=Ne[1]=Ne[2]=0,Ne[3]=1)}function OrbitCameraController(Ne,Ge,Qe){this.radius=tt([Qe]),this.center=tt(Ge),this.rotation=tt(Ne),this.computedRadius=this.radius.curve(0),this.computedCenter=this.center.curve(0),this.computedRotation=this.rotation.curve(0),this.computedUp=[.1,0,0],this.computedEye=[.1,0,0],this.computedMatrix=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.recalcMatrix(0)}var ot=OrbitCameraController.prototype;function createOrbitController(Ne){var Ge=(Ne=Ne||{}).center||[0,0,0],Qe=Ne.rotation||[0,0,0,1],tt=Ne.radius||1;Ge=[].slice.call(Ge,0,3),normalize4(Qe=[].slice.call(Qe,0,4),Qe);var rt=new OrbitCameraController(Qe,Ge,Math.log(tt));return rt.setDistanceLimits(Ne.zoomMin,Ne.zoomMax),("eye"in Ne||"up"in Ne)&&rt.lookAt(0,Ne.eye,Ne.center,Ne.up),rt}ot.lastT=function(){return Math.max(this.radius.lastT(),this.center.lastT(),this.rotation.lastT())},ot.recalcMatrix=function(Ne){this.radius.curve(Ne),this.center.curve(Ne),this.rotation.curve(Ne);var Ge=this.computedRotation;normalize4(Ge,Ge);var Qe=this.computedMatrix;nt(Qe,Ge);var tt=this.computedCenter,rt=this.computedEye,at=this.computedUp,it=Math.exp(this.computedRadius[0]);rt[0]=tt[0]+it*Qe[2],rt[1]=tt[1]+it*Qe[6],rt[2]=tt[2]+it*Qe[10],at[0]=Qe[1],at[1]=Qe[5],at[2]=Qe[9];for(var ot=0;ot<3;++ot){for(var dt=0,ht=0;ht<3;++ht)dt+=Qe[ot+4*ht]*rt[ht];Qe[12+ot]=-dt}},ot.getMatrix=function(Ne,Ge){this.recalcMatrix(Ne);var Qe=this.computedMatrix;if(Ge){for(var tt=0;tt<16;++tt)Ge[tt]=Qe[tt];return Ge}return Qe},ot.idle=function(Ne){this.center.idle(Ne),this.radius.idle(Ne),this.rotation.idle(Ne)},ot.flush=function(Ne){this.center.flush(Ne),this.radius.flush(Ne),this.rotation.flush(Ne)},ot.pan=function(Ne,Ge,Qe,tt){Ge=Ge||0,Qe=Qe||0,tt=tt||0,this.recalcMatrix(Ne);var rt=this.computedMatrix,nt=rt[1],at=rt[5],it=rt[9],ot=len3(nt,at,it);nt/=ot,at/=ot,it/=ot;var dt=rt[0],ht=rt[4],Dt=rt[8],Ot=dt*nt+ht*at+Dt*it,Rt=len3(dt-=nt*Ot,ht-=at*Ot,Dt-=it*Ot);dt/=Rt,ht/=Rt,Dt/=Rt;var Zt=rt[2],er=rt[6],dr=rt[10],mr=Zt*nt+er*at+dr*it,xr=Zt*dt+er*ht+dr*Dt,br=len3(Zt-=mr*nt+xr*dt,er-=mr*at+xr*ht,dr-=mr*it+xr*Dt);Zt/=br,er/=br,dr/=br;var Ar=dt*Ge+nt*Qe,en=ht*Ge+at*Qe,mn=Dt*Ge+it*Qe;this.center.move(Ne,Ar,en,mn);var xn=Math.exp(this.computedRadius[0]);xn=Math.max(1e-4,xn+tt),this.radius.set(Ne,Math.log(xn))},ot.rotate=function(Ne,Ge,Qe,tt){this.recalcMatrix(Ne),Ge=Ge||0,Qe=Qe||0;var rt=this.computedMatrix,nt=rt[0],at=rt[4],it=rt[8],ot=rt[1],dt=rt[5],ht=rt[9],Dt=rt[2],Ot=rt[6],Rt=rt[10],Zt=Ge*nt+Qe*ot,er=Ge*at+Qe*dt,dr=Ge*it+Qe*ht,mr=-(Ot*dr-Rt*er),xr=-(Rt*Zt-Dt*dr),br=-(Dt*er-Ot*Zt),Ar=Math.sqrt(Math.max(0,1-Math.pow(mr,2)-Math.pow(xr,2)-Math.pow(br,2))),en=len4(mr,xr,br,Ar);en>1e-6?(mr/=en,xr/=en,br/=en,Ar/=en):(mr=xr=br=0,Ar=1);var mn=this.computedRotation,xn=mn[0],kn=mn[1],Cn=mn[2],En=mn[3],Pn=xn*Ar+En*mr+kn*br-Cn*xr,Dn=kn*Ar+En*xr+Cn*mr-xn*br,In=Cn*Ar+En*br+xn*xr-kn*mr,zn=En*Ar-xn*mr-kn*xr-Cn*br;if(tt){mr=Dt,xr=Ot,br=Rt;var Bn=Math.sin(tt)/len3(mr,xr,br);mr*=Bn,xr*=Bn,br*=Bn,zn=zn*(Ar=Math.cos(Ge))-(Pn=Pn*Ar+zn*mr+Dn*br-In*xr)*mr-(Dn=Dn*Ar+zn*xr+In*mr-Pn*br)*xr-(In=In*Ar+zn*br+Pn*xr-Dn*mr)*br}var Vn=len4(Pn,Dn,In,zn);Vn>1e-6?(Pn/=Vn,Dn/=Vn,In/=Vn,zn/=Vn):(Pn=Dn=In=0,zn=1),this.rotation.set(Ne,Pn,Dn,In,zn)},ot.lookAt=function(Ne,Ge,Qe,tt){this.recalcMatrix(Ne),Qe=Qe||this.computedCenter,Ge=Ge||this.computedEye,tt=tt||this.computedUp;var nt=this.computedMatrix;rt(nt,Ge,Qe,tt);var at=this.computedRotation;it(at,nt[0],nt[1],nt[2],nt[4],nt[5],nt[6],nt[8],nt[9],nt[10]),normalize4(at,at),this.rotation.set(Ne,at[0],at[1],at[2],at[3]);for(var ot=0,dt=0;dt<3;++dt)ot+=Math.pow(Qe[dt]-Ge[dt],2);this.radius.set(Ne,.5*Math.log(Math.max(ot,1e-6))),this.center.set(Ne,Qe[0],Qe[1],Qe[2])},ot.translate=function(Ne,Ge,Qe,tt){this.center.move(Ne,Ge||0,Qe||0,tt||0)},ot.setMatrix=function(Ne,Ge){var Qe=this.computedRotation;it(Qe,Ge[0],Ge[1],Ge[2],Ge[4],Ge[5],Ge[6],Ge[8],Ge[9],Ge[10]),normalize4(Qe,Qe),this.rotation.set(Ne,Qe[0],Qe[1],Qe[2],Qe[3]);var tt=this.computedMatrix;at(tt,Ge);var rt=tt[15];if(Math.abs(rt)>1e-6){var nt=tt[12]/rt,ot=tt[13]/rt,dt=tt[14]/rt;this.recalcMatrix(Ne);var ht=Math.exp(this.computedRadius[0]);this.center.set(Ne,nt-tt[2]*ht,ot-tt[6]*ht,dt-tt[10]*ht),this.radius.idle(Ne)}else this.center.idle(Ne),this.radius.idle(Ne)},ot.setDistance=function(Ne,Ge){Ge>0&&this.radius.set(Ne,Math.log(Ge))},ot.setDistanceLimits=function(Ne,Ge){Ne=Ne>0?Math.log(Ne):-1/0,Ge=Ge>0?Math.log(Ge):1/0,Ge=Math.max(Ge,Ne),this.radius.bounds[0][0]=Ne,this.radius.bounds[1][0]=Ge},ot.getDistanceLimits=function(Ne){var Ge=this.radius.bounds;return Ne?(Ne[0]=Math.exp(Ge[0][0]),Ne[1]=Math.exp(Ge[1][0]),Ne):[Math.exp(Ge[0][0]),Math.exp(Ge[1][0])]},ot.toJSON=function(){return this.recalcMatrix(this.lastT()),{center:this.computedCenter.slice(),rotation:this.computedRotation.slice(),distance:Math.log(this.computedRadius[0]),zoomMin:this.radius.bounds[0][0],zoomMax:this.radius.bounds[1][0]}},ot.fromJSON=function(Ne){var Ge=this.lastT(),Qe=Ne.center;Qe&&this.center.set(Ge,Qe[0],Qe[1],Qe[2]);var tt=Ne.rotation;tt&&this.rotation.set(Ge,tt[0],tt[1],tt[2],tt[3]);var rt=Ne.distance;rt&&rt>0&&this.radius.set(Ge,Math.log(rt)),this.setDistanceLimits(Ne.zoomMin,Ne.zoomMax)}},{"./lib/quatFromFrame":500,"filtered-vector":242,"gl-mat4/fromQuat":282,"gl-mat4/invert":293,"gl-mat4/lookAt":294}],502:[function(Ne,Ge,Qe){"use strict";var tt=Ne("repeat-string");Ge.exports=function(Ne,Ge,Qe){return tt(Qe=void 0!==Qe?Qe+"":" ",Ge)+Ne}},{"repeat-string":541}],503:[function(Ne,Ge,Qe){"use strict";function parse(Ne,Ge){if("string"!=typeof Ne)return[Ne];var Qe=[Ne];"string"==typeof Ge||Array.isArray(Ge)?Ge={brackets:Ge}:Ge||(Ge={});var tt=Ge.brackets?Array.isArray(Ge.brackets)?Ge.brackets:[Ge.brackets]:["{}","[]","()"],rt=Ge.escape||"___",nt=!!Ge.flat;tt.forEach((function(Ne){var Ge=new RegExp(["\\",Ne[0],"[^\\",Ne[0],"\\",Ne[1],"]*\\",Ne[1]].join("")),tt=[];function replaceToken(Ge,nt,at){var it=Qe.push(Ge.slice(Ne[0].length,-Ne[1].length))-1;return tt.push(it),rt+it+rt}Qe.forEach((function(Ne,tt){for(var rt,nt=0;Ne!=rt;)if(rt=Ne,Ne=Ne.replace(Ge,replaceToken),nt++>1e4)throw Error("References have circular dependency. Please, check them.");Qe[tt]=Ne})),tt=tt.reverse(),Qe=Qe.map((function(Ge){return tt.forEach((function(Qe){Ge=Ge.replace(new RegExp("(\\"+rt+Qe+"\\"+rt+")","g"),Ne[0]+"$1"+Ne[1])})),Ge}))}));var at=new RegExp("\\"+rt+"([0-9]+)\\"+rt);function nest(Ne,Ge,Qe){for(var tt,rt=[],nt=0;tt=at.exec(Ne);){if(nt++>1e4)throw Error("Circular references in parenthesis");rt.push(Ne.slice(0,tt.index)),rt.push(nest(Ge[tt[1]],Ge)),Ne=Ne.slice(tt.index+tt[0].length)}return rt.push(Ne),rt}return nt?Qe:nest(Qe[0],Qe)}function stringify(Ne,Ge){if(Ge&&Ge.flat){var Qe,tt=Ge&&Ge.escape||"___",rt=Ne[0];if(!rt)return"";for(var nt=new RegExp("\\"+tt+"([0-9]+)\\"+tt),at=0;rt!=Qe;){if(at++>1e4)throw Error("Circular references in "+Ne);Qe=rt,rt=rt.replace(nt,replaceRef)}return rt}return Ne.reduce((function f(Ne,Ge){return Array.isArray(Ge)&&(Ge=Ge.reduce(f,"")),Ne+Ge}),"");function replaceRef(Ge,Qe){if(null==Ne[Qe])throw Error("Reference "+Qe+"is undefined");return Ne[Qe]}}function parenthesis(Ne,Ge){return Array.isArray(Ne)?stringify(Ne,Ge):parse(Ne,Ge)}parenthesis.parse=parse,parenthesis.stringify=stringify,Ge.exports=parenthesis},{}],504:[function(Ne,Ge,Qe){"use strict";var tt=Ne("pick-by-alias");function parseRect(Ne){var Ge;return arguments.length>1&&(Ne=arguments),"string"==typeof Ne?Ne=Ne.split(/\s/).map(parseFloat):"number"==typeof Ne&&(Ne=[Ne]),Ne.length&&"number"==typeof Ne[0]?Ge=1===Ne.length?{width:Ne[0],height:Ne[0],x:0,y:0}:2===Ne.length?{width:Ne[0],height:Ne[1],x:0,y:0}:{x:Ne[0],y:Ne[1],width:Ne[2]-Ne[0]||0,height:Ne[3]-Ne[1]||0}:Ne&&(Ge={x:(Ne=tt(Ne,{left:"x l left Left",top:"y t top Top",width:"w width W Width",height:"h height W Width",bottom:"b bottom Bottom",right:"r right Right"})).left||0,y:Ne.top||0},null==Ne.width?Ne.right?Ge.width=Ne.right-Ge.x:Ge.width=0:Ge.width=Ne.width,null==Ne.height?Ne.bottom?Ge.height=Ne.bottom-Ge.y:Ge.height=0:Ge.height=Ne.height),Ge}Ge.exports=parseRect},{"pick-by-alias":511}],505:[function(Ne,Ge,Qe){Ge.exports=parse;var tt={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},rt=/([astvzqmhlc])([^astvzqmhlc]*)/gi;function parse(Ne){var Ge=[];return Ne.replace(rt,(function(Ne,Qe,rt){var nt=Qe.toLowerCase();for(rt=parseValues(rt),"m"==nt&&rt.length>2&&(Ge.push([Qe].concat(rt.splice(0,2))),nt="l",Qe="m"==Qe?"l":"L");;){if(rt.length==tt[nt])return rt.unshift(Qe),Ge.push(rt);if(rt.length<tt[nt])throw new Error("malformed path data");Ge.push([Qe].concat(rt.splice(0,tt[nt])))}})),Ge}var nt=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi;function parseValues(Ne){var Ge=Ne.match(nt);return Ge?Ge.map(Number):[]}},{}],506:[function(Ne,Ge,Qe){Ge.exports=function(Ne,Ge){Ge||(Ge=[0,""]),Ne=String(Ne);var Qe=parseFloat(Ne,10);return Ge[0]=Qe,Ge[1]=Ne.match(/[\d.\-\+]*\s*(.*)/)[1]||"",Ge}},{}],507:[function(Ne,Ge,Qe){(function(Ne){(function(){"use strict";function assertPath(Ne){if("string"!=typeof Ne)throw new TypeError("Path must be a string. Received "+JSON.stringify(Ne))}function normalizeStringPosix(Ne,Ge){for(var Qe,tt="",rt=0,nt=-1,at=0,it=0;it<=Ne.length;++it){if(it<Ne.length)Qe=Ne.charCodeAt(it);else{if(47===Qe)break;Qe=47}if(47===Qe){if(nt===it-1||1===at);else if(nt!==it-1&&2===at){if(tt.length<2||2!==rt||46!==tt.charCodeAt(tt.length-1)||46!==tt.charCodeAt(tt.length-2))if(tt.length>2){var ot=tt.lastIndexOf("/");if(ot!==tt.length-1){-1===ot?(tt="",rt=0):rt=(tt=tt.slice(0,ot)).length-1-tt.lastIndexOf("/"),nt=it,at=0;continue}}else if(2===tt.length||1===tt.length){tt="",rt=0,nt=it,at=0;continue}Ge&&(tt.length>0?tt+="/..":tt="..",rt=2)}else tt.length>0?tt+="/"+Ne.slice(nt+1,it):tt=Ne.slice(nt+1,it),rt=it-nt-1;nt=it,at=0}else 46===Qe&&-1!==at?++at:at=-1}return tt}function _format(Ne,Ge){var Qe=Ge.dir||Ge.root,tt=Ge.base||(Ge.name||"")+(Ge.ext||"");return Qe?Qe===Ge.root?Qe+tt:Qe+Ne+tt:tt}var Qe={resolve:function(){for(var Ge,Qe="",tt=!1,rt=arguments.length-1;rt>=-1&&!tt;rt--){var nt;rt>=0?nt=arguments[rt]:(void 0===Ge&&(Ge=Ne.cwd()),nt=Ge),assertPath(nt),0!==nt.length&&(Qe=nt+"/"+Qe,tt=47===nt.charCodeAt(0))}return Qe=normalizeStringPosix(Qe,!tt),tt?Qe.length>0?"/"+Qe:"/":Qe.length>0?Qe:"."},normalize:function(Ne){if(assertPath(Ne),0===Ne.length)return".";var Ge=47===Ne.charCodeAt(0),Qe=47===Ne.charCodeAt(Ne.length-1);return 0!==(Ne=normalizeStringPosix(Ne,!Ge)).length||Ge||(Ne="."),Ne.length>0&&Qe&&(Ne+="/"),Ge?"/"+Ne:Ne},isAbsolute:function(Ne){return assertPath(Ne),Ne.length>0&&47===Ne.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var Ne,Ge=0;Ge<arguments.length;++Ge){var tt=arguments[Ge];assertPath(tt),tt.length>0&&(void 0===Ne?Ne=tt:Ne+="/"+tt)}return void 0===Ne?".":Qe.normalize(Ne)},relative:function(Ne,Ge){if(assertPath(Ne),assertPath(Ge),Ne===Ge)return"";if((Ne=Qe.resolve(Ne))===(Ge=Qe.resolve(Ge)))return"";for(var tt=1;tt<Ne.length&&47===Ne.charCodeAt(tt);++tt);for(var rt=Ne.length,nt=rt-tt,at=1;at<Ge.length&&47===Ge.charCodeAt(at);++at);for(var it=Ge.length-at,ot=nt<it?nt:it,dt=-1,ht=0;ht<=ot;++ht){if(ht===ot){if(it>ot){if(47===Ge.charCodeAt(at+ht))return Ge.slice(at+ht+1);if(0===ht)return Ge.slice(at+ht)}else nt>ot&&(47===Ne.charCodeAt(tt+ht)?dt=ht:0===ht&&(dt=0));break}var Dt=Ne.charCodeAt(tt+ht);if(Dt!==Ge.charCodeAt(at+ht))break;47===Dt&&(dt=ht)}var Ot="";for(ht=tt+dt+1;ht<=rt;++ht)ht!==rt&&47!==Ne.charCodeAt(ht)||(0===Ot.length?Ot+="..":Ot+="/..");return Ot.length>0?Ot+Ge.slice(at+dt):(at+=dt,47===Ge.charCodeAt(at)&&++at,Ge.slice(at))},_makeLong:function(Ne){return Ne},dirname:function(Ne){if(assertPath(Ne),0===Ne.length)return".";for(var Ge=Ne.charCodeAt(0),Qe=47===Ge,tt=-1,rt=!0,nt=Ne.length-1;nt>=1;--nt)if(47===(Ge=Ne.charCodeAt(nt))){if(!rt){tt=nt;break}}else rt=!1;return-1===tt?Qe?"/":".":Qe&&1===tt?"//":Ne.slice(0,tt)},basename:function(Ne,Ge){if(void 0!==Ge&&"string"!=typeof Ge)throw new TypeError('"ext" argument must be a string');assertPath(Ne);var Qe,tt=0,rt=-1,nt=!0;if(void 0!==Ge&&Ge.length>0&&Ge.length<=Ne.length){if(Ge.length===Ne.length&&Ge===Ne)return"";var at=Ge.length-1,it=-1;for(Qe=Ne.length-1;Qe>=0;--Qe){var ot=Ne.charCodeAt(Qe);if(47===ot){if(!nt){tt=Qe+1;break}}else-1===it&&(nt=!1,it=Qe+1),at>=0&&(ot===Ge.charCodeAt(at)?-1==--at&&(rt=Qe):(at=-1,rt=it))}return tt===rt?rt=it:-1===rt&&(rt=Ne.length),Ne.slice(tt,rt)}for(Qe=Ne.length-1;Qe>=0;--Qe)if(47===Ne.charCodeAt(Qe)){if(!nt){tt=Qe+1;break}}else-1===rt&&(nt=!1,rt=Qe+1);return-1===rt?"":Ne.slice(tt,rt)},extname:function(Ne){assertPath(Ne);for(var Ge=-1,Qe=0,tt=-1,rt=!0,nt=0,at=Ne.length-1;at>=0;--at){var it=Ne.charCodeAt(at);if(47!==it)-1===tt&&(rt=!1,tt=at+1),46===it?-1===Ge?Ge=at:1!==nt&&(nt=1):-1!==Ge&&(nt=-1);else if(!rt){Qe=at+1;break}}return-1===Ge||-1===tt||0===nt||1===nt&&Ge===tt-1&&Ge===Qe+1?"":Ne.slice(Ge,tt)},format:function(Ne){if(null===Ne||"object"!=typeof Ne)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof Ne);return _format("/",Ne)},parse:function(Ne){assertPath(Ne);var Ge={root:"",dir:"",base:"",ext:"",name:""};if(0===Ne.length)return Ge;var Qe,tt=Ne.charCodeAt(0),rt=47===tt;rt?(Ge.root="/",Qe=1):Qe=0;for(var nt=-1,at=0,it=-1,ot=!0,dt=Ne.length-1,ht=0;dt>=Qe;--dt)if(47!==(tt=Ne.charCodeAt(dt)))-1===it&&(ot=!1,it=dt+1),46===tt?-1===nt?nt=dt:1!==ht&&(ht=1):-1!==nt&&(ht=-1);else if(!ot){at=dt+1;break}return-1===nt||-1===it||0===ht||1===ht&&nt===it-1&&nt===at+1?-1!==it&&(Ge.base=Ge.name=0===at&&rt?Ne.slice(1,it):Ne.slice(at,it)):(0===at&&rt?(Ge.name=Ne.slice(1,nt),Ge.base=Ne.slice(1,it)):(Ge.name=Ne.slice(at,nt),Ge.base=Ne.slice(at,it)),Ge.ext=Ne.slice(nt,it)),at>0?Ge.dir=Ne.slice(0,at-1):rt&&(Ge.dir="/"),Ge},sep:"/",delimiter:":",win32:null,posix:null};Qe.posix=Qe,Ge.exports=Qe}).call(this)}).call(this,Ne("_process"))},{_process:526}],508:[function(Ne,Ge,Qe){(function(Ne){(function(){(function(){var Qe,tt,rt,nt,at,it;"undefined"!=typeof performance&&null!==performance&&performance.now?Ge.exports=function(){return performance.now()}:null!=Ne&&Ne.hrtime?(Ge.exports=function(){return(Qe()-at)/1e6},tt=Ne.hrtime,nt=(Qe=function(){var Ne;return 1e9*(Ne=tt())[0]+Ne[1]})(),it=1e9*Ne.uptime(),at=nt-it):Date.now?(Ge.exports=function(){return Date.now()-rt},rt=Date.now()):(Ge.exports=function(){return(new Date).getTime()-rt},rt=(new Date).getTime())}).call(this)}).call(this)}).call(this,Ne("_process"))},{_process:526}],509:[function(Ne,Ge,Qe){"use strict";Ge.exports=permutationSign;var tt=32,rt=Ne("typedarray-pool");function permutationSign(Ne){var Ge=Ne.length;if(Ge<tt){for(var Qe=1,nt=0;nt<Ge;++nt)for(var at=0;at<nt;++at)if(Ne[nt]<Ne[at])Qe=-Qe;else if(Ne[nt]===Ne[at])return 0;return Qe}var it=rt.mallocUint8(Ge);for(nt=0;nt<Ge;++nt)it[nt]=0;for(Qe=1,nt=0;nt<Ge;++nt)if(!it[nt]){var ot=1;for(it[nt]=1,at=Ne[nt];at!==nt;at=Ne[at]){if(it[at])return rt.freeUint8(it),0;ot+=1,it[at]=1}1&ot||(Qe=-Qe)}return rt.freeUint8(it),Qe}},{"typedarray-pool":595}],510:[function(Ne,Ge,Qe){"use strict";var tt=Ne("typedarray-pool"),rt=Ne("invert-permutation");function rank(Ne){var Ge=Ne.length;switch(Ge){case 0:case 1:return 0;case 2:return Ne[1]}var Qe,nt,at,it=tt.mallocUint32(Ge),ot=tt.mallocUint32(Ge),dt=0;for(rt(Ne,ot),at=0;at<Ge;++at)it[at]=Ne[at];for(at=Ge-1;at>0;--at)nt=ot[at],Qe=it[at],it[at]=it[nt],it[nt]=Qe,ot[at]=ot[Qe],ot[Qe]=nt,dt=(dt+Qe)*at;return tt.freeUint32(ot),tt.freeUint32(it),dt}function unrank(Ne,Ge,Qe){switch(Ne){case 0:return Qe||[];case 1:return Qe?(Qe[0]=0,Qe):[0];case 2:return Qe?(Ge?(Qe[0]=0,Qe[1]=1):(Qe[0]=1,Qe[1]=0),Qe):Ge?[0,1]:[1,0]}var tt,rt,nt,at=1;for((Qe=Qe||new Array(Ne))[0]=0,nt=1;nt<Ne;++nt)Qe[nt]=nt,at=at*nt|0;for(nt=Ne-1;nt>0;--nt)Ge=Ge-(tt=Ge/at|0)*at|0,at=at/nt|0,rt=0|Qe[nt],Qe[nt]=0|Qe[tt],Qe[tt]=0|rt;return Qe}Qe.rank=rank,Qe.unrank=unrank},{"invert-permutation":462,"typedarray-pool":595}],511:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge,Qe){var tt,rt,nt={};if("string"==typeof Ge&&(Ge=toList(Ge)),Array.isArray(Ge)){var at={};for(rt=0;rt<Ge.length;rt++)at[Ge[rt]]=!0;Ge=at}for(tt in Ge)Ge[tt]=toList(Ge[tt]);var it={};for(tt in Ge){var ot=Ge[tt];if(Array.isArray(ot))for(rt=0;rt<ot.length;rt++){var dt=ot[rt];if(Qe&&(it[dt]=!0),dt in Ne){if(nt[tt]=Ne[dt],Qe)for(var ht=rt;ht<ot.length;ht++)it[ot[ht]]=!0;break}}else tt in Ne&&(Ge[tt]&&(nt[tt]=Ne[tt]),Qe&&(it[tt]=!0))}if(Qe)for(tt in Ne)it[tt]||(nt[tt]=Ne[tt]);return nt};var tt={};function toList(Ne){return tt[Ne]?tt[Ne]:("string"==typeof Ne&&(Ne=tt[Ne]=Ne.split(/\s*,\s*|\s+/)),Ne)}},{}],512:[function(Ne,Ge,Qe){"use strict";Ge.exports=planarDual;var tt=Ne("compare-angle");function planarDual(Ne,Ge){for(var Qe=0|Ge.length,rt=Ne.length,nt=[new Array(Qe),new Array(Qe)],at=0;at<Qe;++at)nt[0][at]=[],nt[1][at]=[];for(at=0;at<rt;++at){var it=Ne[at];nt[0][it[0]].push(it),nt[1][it[1]].push(it)}var ot=[];for(at=0;at<Qe;++at)nt[0][at].length+nt[1][at].length===0&&ot.push([at]);function cut(Ne,Ge){var Qe=nt[Ge][Ne[Ge]];Qe.splice(Qe.indexOf(Ne),1)}function next(Ne,Qe,rt){for(var at,it,ot,dt=0;dt<2;++dt)if(nt[dt][Qe].length>0){at=nt[dt][Qe][0],ot=dt;break}it=at[1^ot];for(var ht=0;ht<2;++ht)for(var Dt=nt[ht][Qe],Ot=0;Ot<Dt.length;++Ot){var Rt=Dt[Ot],Zt=Rt[1^ht];tt(Ge[Ne],Ge[Qe],Ge[it],Ge[Zt])>0&&(at=Rt,it=Zt,ot=ht)}return rt||at&&cut(at,ot),it}function extractCycle(Ne,Qe){var rt=nt[Qe][Ne][0],at=[Ne];cut(rt,Qe);for(var it=rt[1^Qe];;){for(;it!==Ne;)at.push(it),it=next(at[at.length-2],it,!1);if(nt[0][Ne].length+nt[1][Ne].length===0)break;var ot=at[at.length-1],dt=Ne,ht=at[1],Dt=next(ot,dt,!0);if(tt(Ge[ot],Ge[dt],Ge[ht],Ge[Dt])<0)break;at.push(Ne),it=next(ot,dt)}return at}function shouldGlue(Ne,Ge){return Ge[1]===Ge[Ge.length-1]}for(at=0;at<Qe;++at)for(var dt=0;dt<2;++dt){for(var ht=[];nt[dt][at].length>0;){nt[0][at].length;var Dt=extractCycle(at,dt);shouldGlue(ht,Dt)?ht.push.apply(ht,Dt):(ht.length>0&&ot.push(ht),ht=Dt)}ht.length>0&&ot.push(ht)}return ot}},{"compare-angle":132}],513:[function(Ne,Ge,Qe){"use strict";Ge.exports=trimLeaves;var tt=Ne("edges-to-adjacency-list");function trimLeaves(Ne,Ge){for(var Qe=tt(Ne,Ge.length),rt=new Array(Ge.length),nt=new Array(Ge.length),at=[],it=0;it<Ge.length;++it){var ot=Qe[it].length;nt[it]=ot,rt[it]=!0,ot<=1&&at.push(it)}for(;at.length>0;){rt[Rt=at.pop()]=!1;var dt=Qe[Rt];for(it=0;it<dt.length;++it){var ht=dt[it];0==--nt[ht]&&at.push(ht)}}var Dt=new Array(Ge.length),Ot=[];for(it=0;it<Ge.length;++it)if(rt[it]){var Rt=Ot.length;Dt[it]=Rt,Ot.push(Ge[it])}else Dt[it]=-1;var Zt=[];for(it=0;it<Ne.length;++it){var er=Ne[it];rt[er[0]]&&rt[er[1]]&&Zt.push([Dt[er[0]],Dt[er[1]]])}return[Zt,Ot]}},{"edges-to-adjacency-list":178}],514:[function(Ne,Ge,Qe){"use strict";Ge.exports=planarGraphToPolyline;var tt=Ne("edges-to-adjacency-list"),rt=Ne("planar-dual"),nt=Ne("point-in-big-polygon"),at=Ne("two-product"),it=Ne("robust-sum"),ot=Ne("uniq"),dt=Ne("./lib/trim-leaves");function makeArray(Ne,Ge){for(var Qe=new Array(Ne),tt=0;tt<Ne;++tt)Qe[tt]=Ge;return Qe}function makeArrayOfArrays(Ne){for(var Ge=new Array(Ne),Qe=0;Qe<Ne;++Qe)Ge[Qe]=[];return Ge}function planarGraphToPolyline(Ne,Ge){Ne=(Yn=dt(Ne,Ge))[0];for(var Qe=(Ge=Yn[1]).length,ht=(Ne.length,tt(Ne,Ge.length)),Dt=0;Dt<Qe;++Dt)if(ht[Dt].length%2==1)throw new Error("planar-graph-to-polyline: graph must be manifold");var Ot=rt(Ne,Ge);function ccw(Ne){for(var Qe=Ne.length,tt=[0],rt=0;rt<Qe;++rt){var nt=Ge[Ne[rt]],ot=Ge[Ne[(rt+1)%Qe]],dt=at(-nt[0],nt[1]),ht=at(-nt[0],ot[1]),Dt=at(ot[0],nt[1]),Ot=at(ot[0],ot[1]);tt=it(tt,it(it(dt,ht),it(Dt,Ot)))}return tt[tt.length-1]>0}var Rt=(Ot=Ot.filter(ccw)).length,Zt=new Array(Rt),er=new Array(Rt);for(Dt=0;Dt<Rt;++Dt){Zt[Dt]=Dt;var dr=new Array(Rt),mr=Ot[Dt].map((function(Ne){return Ge[Ne]})),xr=nt([mr]),br=0;e:for(var Ar=0;Ar<Rt;++Ar)if(dr[Ar]=0,Dt!==Ar){for(var en=(ma=Ot[Ar]).length,mn=0;mn<en;++mn){var xn=xr(Ge[ma[mn]]);if(0!==xn){xn<0&&(dr[Ar]=1,br+=1);continue e}}dr[Ar]=1,br+=1}er[Dt]=[br,Dt,dr]}for(er.sort((function(Ne,Ge){return Ge[0]-Ne[0]})),Dt=0;Dt<Rt;++Dt){var kn=(dr=er[Dt])[1],Cn=dr[2];for(Ar=0;Ar<Rt;++Ar)Cn[Ar]&&(Zt[Ar]=kn)}var En=makeArrayOfArrays(Rt);for(Dt=0;Dt<Rt;++Dt)En[Dt].push(Zt[Dt]),En[Zt[Dt]].push(Dt);var Pn={},Dn=makeArray(Qe,!1);for(Dt=0;Dt<Rt;++Dt)for(en=(ma=Ot[Dt]).length,Ar=0;Ar<en;++Ar){var In=ma[Ar],zn=ma[(Ar+1)%en],Bn=Math.min(In,zn)+":"+Math.max(In,zn);if(Bn in Pn){var Vn=Pn[Bn];En[Vn].push(Dt),En[Dt].push(Vn),Dn[In]=Dn[zn]=!0}else Pn[Bn]=Dt}function sharedBoundary(Ne){for(var Ge=Ne.length,Qe=0;Qe<Ge;++Qe)if(!Dn[Ne[Qe]])return!1;return!0}var Hn=[],qn=makeArray(Rt,-1);for(Dt=0;Dt<Rt;++Dt)Zt[Dt]!==Dt||sharedBoundary(Ot[Dt])?qn[Dt]=-1:(Hn.push(Dt),qn[Dt]=0);for(var Yn=[];Hn.length>0;){var $n=Hn.pop(),ra=En[$n];ot(ra,(function(Ne,Ge){return Ne-Ge}));var oa,pa=ra.length,ga=qn[$n];for(0===ga&&(oa=[ma=Ot[$n]]),Dt=0;Dt<pa;++Dt){var ma,_a=ra[Dt];qn[_a]>=0||(qn[_a]=1^ga,Hn.push(_a),0===ga&&(sharedBoundary(ma=Ot[_a])||(ma.reverse(),oa.push(ma))))}0===ga&&Yn.push(oa)}return Yn}},{"./lib/trim-leaves":513,"edges-to-adjacency-list":178,"planar-dual":512,"point-in-big-polygon":516,"robust-sum":553,"two-product":582,uniq:597}],515:[function(Ne,Ge,Qe){arguments[4][243][0].apply(Qe,arguments)},{dup:243}],516:[function(Ne,Ge,Qe){Ge.exports=preprocessPolygon;var tt=Ne("robust-orientation")[3],rt=Ne("slab-decomposition"),nt=Ne("interval-tree-1d"),at=Ne("binary-search-bounds");function visitInterval(){return!0}function intervalSearch(Ne){return function(Ge,Qe){var tt=Ne[Ge];return!!tt&&!!tt.queryPoint(Qe,visitInterval)}}function buildVerticalIndex(Ne){for(var Ge={},Qe=0;Qe<Ne.length;++Qe){var tt=Ne[Qe],rt=tt[0][0],at=tt[0][1],it=tt[1][1],ot=[Math.min(at,it),Math.max(at,it)];rt in Ge?Ge[rt].push(ot):Ge[rt]=[ot]}var dt={},ht=Object.keys(Ge);for(Qe=0;Qe<ht.length;++Qe){var Dt=Ge[ht[Qe]];dt[ht[Qe]]=nt(Dt)}return intervalSearch(dt)}function buildSlabSearch(Ne,Ge){return function(Qe){var rt=at.le(Ge,Qe[0]);if(rt<0)return 1;var nt=Ne[rt];if(!nt){if(!(rt>0&&Ge[rt]===Qe[0]))return 1;nt=Ne[rt-1]}for(var it=1;nt;){var ot=nt.key,dt=tt(Qe,ot[0],ot[1]);if(ot[0][0]<ot[1][0])if(dt<0)nt=nt.left;else{if(!(dt>0))return 0;it=-1,nt=nt.right}else if(dt>0)nt=nt.left;else{if(!(dt<0))return 0;it=1,nt=nt.right}}return it}}function classifyEmpty(Ne){return 1}function createClassifyVertical(Ne){return function(Ge){return Ne(Ge[0],Ge[1])?0:1}}function createClassifyPointDegen(Ne,Ge){return function(Qe){return Ne(Qe[0],Qe[1])?0:Ge(Qe)}}function preprocessPolygon(Ne){for(var Ge=Ne.length,Qe=[],tt=[],nt=0;nt<Ge;++nt)for(var at=Ne[nt],it=at.length,ot=it-1,dt=0;dt<it;ot=dt++){var ht=at[ot],Dt=at[dt];ht[0]===Dt[0]?tt.push([ht,Dt]):Qe.push([ht,Dt])}if(0===Qe.length)return 0===tt.length?classifyEmpty:createClassifyVertical(buildVerticalIndex(tt));var Ot=rt(Qe),Rt=buildSlabSearch(Ot.slabs,Ot.coordinates);return 0===tt.length?Rt:createClassifyPointDegen(buildVerticalIndex(tt),Rt)}},{"binary-search-bounds":515,"interval-tree-1d":460,"robust-orientation":548,"slab-decomposition":565}],517:[function(Ne,Ge,Qe){var tt,rt=Ne("./lib/build-log"),nt=Ne("./lib/epsilon"),at=Ne("./lib/intersecter"),it=Ne("./lib/segment-chainer"),ot=Ne("./lib/segment-selector"),dt=Ne("./lib/geojson"),ht=!1,Dt=nt();function operate(Ne,Ge,Qe){var rt=tt.segments(Ne),nt=tt.segments(Ge),at=Qe(tt.combine(rt,nt));return tt.polygon(at)}tt={buildLog:function(Ne){return!0===Ne?ht=rt():!1===Ne&&(ht=!1),!1!==ht&&ht.list},epsilon:function(Ne){return Dt.epsilon(Ne)},segments:function(Ne){var Ge=at(!0,Dt,ht);return Ne.regions.forEach(Ge.addRegion),{segments:Ge.calculate(Ne.inverted),inverted:Ne.inverted}},combine:function(Ne,Ge){return{combined:at(!1,Dt,ht).calculate(Ne.segments,Ne.inverted,Ge.segments,Ge.inverted),inverted1:Ne.inverted,inverted2:Ge.inverted}},selectUnion:function(Ne){return{segments:ot.union(Ne.combined,ht),inverted:Ne.inverted1||Ne.inverted2}},selectIntersect:function(Ne){return{segments:ot.intersect(Ne.combined,ht),inverted:Ne.inverted1&&Ne.inverted2}},selectDifference:function(Ne){return{segments:ot.difference(Ne.combined,ht),inverted:Ne.inverted1&&!Ne.inverted2}},selectDifferenceRev:function(Ne){return{segments:ot.differenceRev(Ne.combined,ht),inverted:!Ne.inverted1&&Ne.inverted2}},selectXor:function(Ne){return{segments:ot.xor(Ne.combined,ht),inverted:Ne.inverted1!==Ne.inverted2}},polygon:function(Ne){return{regions:it(Ne.segments,Dt,ht),inverted:Ne.inverted}},polygonFromGeoJSON:function(Ne){return dt.toPolygon(tt,Ne)},polygonToGeoJSON:function(Ne){return dt.fromPolygon(tt,Dt,Ne)},union:function(Ne,Ge){return operate(Ne,Ge,tt.selectUnion)},intersect:function(Ne,Ge){return operate(Ne,Ge,tt.selectIntersect)},difference:function(Ne,Ge){return operate(Ne,Ge,tt.selectDifference)},differenceRev:function(Ne,Ge){return operate(Ne,Ge,tt.selectDifferenceRev)},xor:function(Ne,Ge){return operate(Ne,Ge,tt.selectXor)}},"object"==typeof window&&(window.PolyBool=tt),Ge.exports=tt},{"./lib/build-log":518,"./lib/epsilon":519,"./lib/geojson":520,"./lib/intersecter":521,"./lib/segment-chainer":523,"./lib/segment-selector":524}],518:[function(Ne,Ge,Qe){function BuildLog(){var Ne,Ge=0,Qe=!1;function push(Ge,Qe){return Ne.list.push({type:Ge,data:Qe?JSON.parse(JSON.stringify(Qe)):void 0}),Ne}return Ne={list:[],segmentId:function(){return Ge++},checkIntersection:function(Ne,Ge){return push("check",{seg1:Ne,seg2:Ge})},segmentChop:function(Ne,Ge){return push("div_seg",{seg:Ne,pt:Ge}),push("chop",{seg:Ne,pt:Ge})},statusRemove:function(Ne){return push("pop_seg",{seg:Ne})},segmentUpdate:function(Ne){return push("seg_update",{seg:Ne})},segmentNew:function(Ne,Ge){return push("new_seg",{seg:Ne,primary:Ge})},segmentRemove:function(Ne){return push("rem_seg",{seg:Ne})},tempStatus:function(Ne,Ge,Qe){return push("temp_status",{seg:Ne,above:Ge,below:Qe})},rewind:function(Ne){return push("rewind",{seg:Ne})},status:function(Ne,Ge,Qe){return push("status",{seg:Ne,above:Ge,below:Qe})},vert:function(Ge){return Ge===Qe?Ne:(Qe=Ge,push("vert",{x:Ge}))},log:function(Ne){return"string"!=typeof Ne&&(Ne=JSON.stringify(Ne,!1,"  ")),push("log",{txt:Ne})},reset:function(){return push("reset")},selected:function(Ne){return push("selected",{segs:Ne})},chainStart:function(Ne){return push("chain_start",{seg:Ne})},chainRemoveHead:function(Ne,Ge){return push("chain_rem_head",{index:Ne,pt:Ge})},chainRemoveTail:function(Ne,Ge){return push("chain_rem_tail",{index:Ne,pt:Ge})},chainNew:function(Ne,Ge){return push("chain_new",{pt1:Ne,pt2:Ge})},chainMatch:function(Ne){return push("chain_match",{index:Ne})},chainClose:function(Ne){return push("chain_close",{index:Ne})},chainAddHead:function(Ne,Ge){return push("chain_add_head",{index:Ne,pt:Ge})},chainAddTail:function(Ne,Ge){return push("chain_add_tail",{index:Ne,pt:Ge})},chainConnect:function(Ne,Ge){return push("chain_con",{index1:Ne,index2:Ge})},chainReverse:function(Ne){return push("chain_rev",{index:Ne})},chainJoin:function(Ne,Ge){return push("chain_join",{index1:Ne,index2:Ge})},done:function(){return push("done")}}}Ge.exports=BuildLog},{}],519:[function(Ne,Ge,Qe){function Epsilon(Ne){"number"!=typeof Ne&&(Ne=1e-10);var Ge={epsilon:function(Ge){return"number"==typeof Ge&&(Ne=Ge),Ne},pointAboveOrOnLine:function(Ge,Qe,tt){var rt=Qe[0],nt=Qe[1],at=tt[0],it=tt[1],ot=Ge[0];return(at-rt)*(Ge[1]-nt)-(it-nt)*(ot-rt)>=-Ne},pointBetween:function(Ge,Qe,tt){var rt=Ge[1]-Qe[1],nt=tt[0]-Qe[0],at=Ge[0]-Qe[0],it=tt[1]-Qe[1],ot=at*nt+rt*it;return!(ot<Ne||ot-(nt*nt+it*it)>-Ne)},pointsSameX:function(Ge,Qe){return Math.abs(Ge[0]-Qe[0])<Ne},pointsSameY:function(Ge,Qe){return Math.abs(Ge[1]-Qe[1])<Ne},pointsSame:function(Ne,Qe){return Ge.pointsSameX(Ne,Qe)&&Ge.pointsSameY(Ne,Qe)},pointsCompare:function(Ne,Qe){return Ge.pointsSameX(Ne,Qe)?Ge.pointsSameY(Ne,Qe)?0:Ne[1]<Qe[1]?-1:1:Ne[0]<Qe[0]?-1:1},pointsCollinear:function(Ge,Qe,tt){var rt=Ge[0]-Qe[0],nt=Ge[1]-Qe[1],at=Qe[0]-tt[0],it=Qe[1]-tt[1];return Math.abs(rt*it-at*nt)<Ne},linesIntersect:function(Ge,Qe,tt,rt){var nt=Qe[0]-Ge[0],at=Qe[1]-Ge[1],it=rt[0]-tt[0],ot=rt[1]-tt[1],dt=nt*ot-at*it;if(Math.abs(dt)<Ne)return!1;var ht=Ge[0]-tt[0],Dt=Ge[1]-tt[1],Ot=(it*Dt-ot*ht)/dt,Rt=(nt*Dt-at*ht)/dt,Zt={alongA:0,alongB:0,pt:[Ge[0]+Ot*nt,Ge[1]+Ot*at]};return Zt.alongA=Ot<=-Ne?-2:Ot<Ne?-1:Ot-1<=-Ne?0:Ot-1<Ne?1:2,Zt.alongB=Rt<=-Ne?-2:Rt<Ne?-1:Rt-1<=-Ne?0:Rt-1<Ne?1:2,Zt},pointInsideRegion:function(Ge,Qe){for(var tt=Ge[0],rt=Ge[1],nt=Qe[Qe.length-1][0],at=Qe[Qe.length-1][1],it=!1,ot=0;ot<Qe.length;ot++){var dt=Qe[ot][0],ht=Qe[ot][1];ht-rt>Ne!=at-rt>Ne&&(nt-dt)*(rt-ht)/(at-ht)+dt-tt>Ne&&(it=!it),nt=dt,at=ht}return it}};return Ge}Ge.exports=Epsilon},{}],520:[function(Ne,Ge,Qe){var tt={toPolygon:function(Ne,Ge){function GeoPoly(Ge){if(Ge.length<=0)return Ne.segments({inverted:!1,regions:[]});function LineString(Ge){var Qe=Ge.slice(0,Ge.length-1);return Ne.segments({inverted:!1,regions:[Qe]})}for(var Qe=LineString(Ge[0]),tt=1;tt<Ge.length;tt++)Qe=Ne.selectDifference(Ne.combine(Qe,LineString(Ge[tt])));return Qe}if("Polygon"===Ge.type)return Ne.polygon(GeoPoly(Ge.coordinates));if("MultiPolygon"===Ge.type){for(var Qe=Ne.segments({inverted:!1,regions:[]}),tt=0;tt<Ge.coordinates.length;tt++)Qe=Ne.selectUnion(Ne.combine(Qe,GeoPoly(Ge.coordinates[tt])));return Ne.polygon(Qe)}throw new Error("PolyBool: Cannot convert GeoJSON object to PolyBool polygon")},fromPolygon:function(Ne,Ge,Qe){function regionInsideRegion(Ne,Qe){return Ge.pointInsideRegion([.5*(Ne[0][0]+Ne[1][0]),.5*(Ne[0][1]+Ne[1][1])],Qe)}function newNode(Ne){return{region:Ne,children:[]}}Qe=Ne.polygon(Ne.segments(Qe));var tt=newNode(null);function addChild(Ne,Ge){for(var Qe=0;Qe<Ne.children.length;Qe++)if(regionInsideRegion(Ge,(rt=Ne.children[Qe]).region))return void addChild(rt,Ge);var tt=newNode(Ge);for(Qe=0;Qe<Ne.children.length;Qe++){var rt;regionInsideRegion((rt=Ne.children[Qe]).region,Ge)&&(tt.children.push(rt),Ne.children.splice(Qe,1),Qe--)}Ne.children.push(tt)}for(var rt=0;rt<Qe.regions.length;rt++){var nt=Qe.regions[rt];nt.length<3||addChild(tt,nt)}function forceWinding(Ne,Ge){for(var Qe=0,tt=Ne[Ne.length-1][0],rt=Ne[Ne.length-1][1],nt=[],at=0;at<Ne.length;at++){var it=Ne[at][0],ot=Ne[at][1];nt.push([it,ot]),Qe+=ot*tt-it*rt,tt=it,rt=ot}return Qe<0!==Ge&&nt.reverse(),nt.push([nt[0][0],nt[0][1]]),nt}var at=[];function addExterior(Ne){var Ge=[forceWinding(Ne.region,!1)];at.push(Ge);for(var Qe=0;Qe<Ne.children.length;Qe++)Ge.push(getInterior(Ne.children[Qe]))}function getInterior(Ne){for(var Ge=0;Ge<Ne.children.length;Ge++)addExterior(Ne.children[Ge]);return forceWinding(Ne.region,!0)}for(rt=0;rt<tt.children.length;rt++)addExterior(tt.children[rt]);return at.length<=0?{type:"Polygon",coordinates:[]}:1==at.length?{type:"Polygon",coordinates:at[0]}:{type:"MultiPolygon",coordinates:at}}};Ge.exports=tt},{}],521:[function(Ne,Ge,Qe){var tt=Ne("./linked-list");function Intersecter(Ne,Ge,Qe){function segmentNew(Ne,Ge){return{id:Qe?Qe.segmentId():-1,start:Ne,end:Ge,myFill:{above:null,below:null},otherFill:null}}function segmentCopy(Ne,Ge,tt){return{id:Qe?Qe.segmentId():-1,start:Ne,end:Ge,myFill:{above:tt.myFill.above,below:tt.myFill.below},otherFill:null}}var rt=tt.create();function eventCompare(Ne,Qe,tt,rt,nt,at){var it=Ge.pointsCompare(Qe,nt);return 0!==it?it:Ge.pointsSame(tt,at)?0:Ne!==rt?Ne?1:-1:Ge.pointAboveOrOnLine(tt,rt?nt:at,rt?at:nt)?1:-1}function eventAdd(Ne,Ge){rt.insertBefore(Ne,(function(Qe){return eventCompare(Ne.isStart,Ne.pt,Ge,Qe.isStart,Qe.pt,Qe.other.pt)<0}))}function eventAddSegmentStart(Ne,Ge){var Qe=tt.node({isStart:!0,pt:Ne.start,seg:Ne,primary:Ge,other:null,status:null});return eventAdd(Qe,Ne.end),Qe}function eventAddSegmentEnd(Ne,Ge,Qe){var rt=tt.node({isStart:!1,pt:Ge.end,seg:Ge,primary:Qe,other:Ne,status:null});Ne.other=rt,eventAdd(rt,Ne.pt)}function eventAddSegment(Ne,Ge){var Qe=eventAddSegmentStart(Ne,Ge);return eventAddSegmentEnd(Qe,Ne,Ge),Qe}function eventUpdateEnd(Ne,Ge){Qe&&Qe.segmentChop(Ne.seg,Ge),Ne.other.remove(),Ne.seg.end=Ge,Ne.other.pt=Ge,eventAdd(Ne.other,Ne.pt)}function eventDivide(Ne,Ge){var Qe=segmentCopy(Ge,Ne.seg.end,Ne.seg);return eventUpdateEnd(Ne,Ge),eventAddSegment(Qe,Ne.primary)}function calculate(nt,at){var it=tt.create();function statusCompare(Ne,Qe){var tt=Ne.seg.start,rt=Ne.seg.end,nt=Qe.seg.start,at=Qe.seg.end;return Ge.pointsCollinear(tt,nt,at)?Ge.pointsCollinear(rt,nt,at)||Ge.pointAboveOrOnLine(rt,nt,at)?1:-1:Ge.pointAboveOrOnLine(tt,nt,at)?1:-1}function statusFindSurrounding(Ne){return it.findTransition((function(Ge){return statusCompare(Ne,Ge.ev)>0}))}function checkIntersection(Ne,tt){var rt=Ne.seg,nt=tt.seg,at=rt.start,it=rt.end,ot=nt.start,dt=nt.end;Qe&&Qe.checkIntersection(rt,nt);var ht=Ge.linesIntersect(at,it,ot,dt);if(!1===ht){if(!Ge.pointsCollinear(at,it,ot))return!1;if(Ge.pointsSame(at,dt)||Ge.pointsSame(it,ot))return!1;var Dt=Ge.pointsSame(at,ot),Ot=Ge.pointsSame(it,dt);if(Dt&&Ot)return tt;var Rt=!Dt&&Ge.pointBetween(at,ot,dt),Zt=!Ot&&Ge.pointBetween(it,ot,dt);if(Dt)return Zt?eventDivide(tt,it):eventDivide(Ne,dt),tt;Rt&&(Ot||(Zt?eventDivide(tt,it):eventDivide(Ne,dt)),eventDivide(tt,at))}else 0===ht.alongA&&(-1===ht.alongB?eventDivide(Ne,ot):0===ht.alongB?eventDivide(Ne,ht.pt):1===ht.alongB&&eventDivide(Ne,dt)),0===ht.alongB&&(-1===ht.alongA?eventDivide(tt,at):0===ht.alongA?eventDivide(tt,ht.pt):1===ht.alongA&&eventDivide(tt,it));return!1}for(var ot=[];!rt.isEmpty();){var dt=rt.getHead();if(Qe&&Qe.vert(dt.pt[0]),dt.isStart){Qe&&Qe.segmentNew(dt.seg,dt.primary);var ht=statusFindSurrounding(dt),Dt=ht.before?ht.before.ev:null,Ot=ht.after?ht.after.ev:null;function checkBothIntersections(){if(Dt){var Ne=checkIntersection(dt,Dt);if(Ne)return Ne}return!!Ot&&checkIntersection(dt,Ot)}Qe&&Qe.tempStatus(dt.seg,!!Dt&&Dt.seg,!!Ot&&Ot.seg);var Rt,Zt,er=checkBothIntersections();if(er&&(Ne?(Zt=null===dt.seg.myFill.below||dt.seg.myFill.above!==dt.seg.myFill.below)&&(er.seg.myFill.above=!er.seg.myFill.above):er.seg.otherFill=dt.seg.myFill,Qe&&Qe.segmentUpdate(er.seg),dt.other.remove(),dt.remove()),rt.getHead()!==dt){Qe&&Qe.rewind(dt.seg);continue}Ne?(Zt=null===dt.seg.myFill.below||dt.seg.myFill.above!==dt.seg.myFill.below,dt.seg.myFill.below=Ot?Ot.seg.myFill.above:nt,dt.seg.myFill.above=Zt?!dt.seg.myFill.below:dt.seg.myFill.below):null===dt.seg.otherFill&&(Rt=Ot?dt.primary===Ot.primary?Ot.seg.otherFill.above:Ot.seg.myFill.above:dt.primary?at:nt,dt.seg.otherFill={above:Rt,below:Rt}),Qe&&Qe.status(dt.seg,!!Dt&&Dt.seg,!!Ot&&Ot.seg),dt.other.status=ht.insert(tt.node({ev:dt}))}else{var dr=dt.status;if(null===dr)throw new Error("PolyBool: Zero-length segment detected; your epsilon is probably too small or too large");if(it.exists(dr.prev)&&it.exists(dr.next)&&checkIntersection(dr.prev.ev,dr.next.ev),Qe&&Qe.statusRemove(dr.ev.seg),dr.remove(),!dt.primary){var mr=dt.seg.myFill;dt.seg.myFill=dt.seg.otherFill,dt.seg.otherFill=mr}ot.push(dt.seg)}rt.getHead().remove()}return Qe&&Qe.done(),ot}return Ne?{addRegion:function(Ne){for(var Qe,tt=Ne[Ne.length-1],rt=0;rt<Ne.length;rt++){Qe=tt,tt=Ne[rt];var nt=Ge.pointsCompare(Qe,tt);0!==nt&&eventAddSegment(segmentNew(nt<0?Qe:tt,nt<0?tt:Qe),!0)}},calculate:function(Ne){return calculate(Ne,!1)}}:{calculate:function(Ne,Ge,Qe,tt){return Ne.forEach((function(Ne){eventAddSegment(segmentCopy(Ne.start,Ne.end,Ne),!0)})),Qe.forEach((function(Ne){eventAddSegment(segmentCopy(Ne.start,Ne.end,Ne),!1)})),calculate(Ge,tt)}}}Ge.exports=Intersecter},{"./linked-list":522}],522:[function(Ne,Ge,Qe){var tt={create:function(){var Ne={root:{root:!0,next:null},exists:function(Ge){return null!==Ge&&Ge!==Ne.root},isEmpty:function(){return null===Ne.root.next},getHead:function(){return Ne.root.next},insertBefore:function(Ge,Qe){for(var tt=Ne.root,rt=Ne.root.next;null!==rt;){if(Qe(rt))return Ge.prev=rt.prev,Ge.next=rt,rt.prev.next=Ge,void(rt.prev=Ge);tt=rt,rt=rt.next}tt.next=Ge,Ge.prev=tt,Ge.next=null},findTransition:function(Ge){for(var Qe=Ne.root,tt=Ne.root.next;null!==tt&&!Ge(tt);)Qe=tt,tt=tt.next;return{before:Qe===Ne.root?null:Qe,after:tt,insert:function(Ne){return Ne.prev=Qe,Ne.next=tt,Qe.next=Ne,null!==tt&&(tt.prev=Ne),Ne}}}};return Ne},node:function(Ne){return Ne.prev=null,Ne.next=null,Ne.remove=function(){Ne.prev.next=Ne.next,Ne.next&&(Ne.next.prev=Ne.prev),Ne.prev=null,Ne.next=null},Ne}};Ge.exports=tt},{}],523:[function(Ne,Ge,Qe){function SegmentChainer(Ne,Ge,Qe){var tt=[],rt=[];return Ne.forEach((function(Ne){var nt=Ne.start,at=Ne.end;if(Ge.pointsSame(nt,at))console.warn("PolyBool: Warning: Zero-length segment detected; your epsilon is probably too small or too large");else{Qe&&Qe.chainStart(Ne);for(var it={index:0,matches_head:!1,matches_pt1:!1},ot={index:0,matches_head:!1,matches_pt1:!1},dt=it,ht=0;ht<tt.length;ht++){var Dt=(dr=tt[ht])[0],Ot=(dr[1],dr[dr.length-1]);if(dr[dr.length-2],Ge.pointsSame(Dt,nt)){if(setMatch(ht,!0,!0))break}else if(Ge.pointsSame(Dt,at)){if(setMatch(ht,!0,!1))break}else if(Ge.pointsSame(Ot,nt)){if(setMatch(ht,!1,!0))break}else if(Ge.pointsSame(Ot,at)&&setMatch(ht,!1,!1))break}if(dt===it)return tt.push([nt,at]),void(Qe&&Qe.chainNew(nt,at));if(dt===ot){Qe&&Qe.chainMatch(it.index);var Rt=it.index,Zt=it.matches_pt1?at:nt,er=it.matches_head,dr=tt[Rt],mr=er?dr[0]:dr[dr.length-1],xr=er?dr[1]:dr[dr.length-2],br=er?dr[dr.length-1]:dr[0],Ar=er?dr[dr.length-2]:dr[1];return Ge.pointsCollinear(xr,mr,Zt)&&(er?(Qe&&Qe.chainRemoveHead(it.index,Zt),dr.shift()):(Qe&&Qe.chainRemoveTail(it.index,Zt),dr.pop()),mr=xr),Ge.pointsSame(br,Zt)?(tt.splice(Rt,1),Ge.pointsCollinear(Ar,br,mr)&&(er?(Qe&&Qe.chainRemoveTail(it.index,mr),dr.pop()):(Qe&&Qe.chainRemoveHead(it.index,mr),dr.shift())),Qe&&Qe.chainClose(it.index),void rt.push(dr)):void(er?(Qe&&Qe.chainAddHead(it.index,Zt),dr.unshift(Zt)):(Qe&&Qe.chainAddTail(it.index,Zt),dr.push(Zt)))}var en=it.index,mn=ot.index;Qe&&Qe.chainConnect(en,mn);var xn=tt[en].length<tt[mn].length;it.matches_head?ot.matches_head?xn?(reverseChain(en),appendChain(en,mn)):(reverseChain(mn),appendChain(mn,en)):appendChain(mn,en):ot.matches_head?appendChain(en,mn):xn?(reverseChain(en),appendChain(mn,en)):(reverseChain(mn),appendChain(en,mn))}function setMatch(Ne,Ge,Qe){return dt.index=Ne,dt.matches_head=Ge,dt.matches_pt1=Qe,dt===it?(dt=ot,!1):(dt=null,!0)}function reverseChain(Ne){Qe&&Qe.chainReverse(Ne),tt[Ne].reverse()}function appendChain(Ne,rt){var nt=tt[Ne],at=tt[rt],it=nt[nt.length-1],ot=nt[nt.length-2],dt=at[0],ht=at[1];Ge.pointsCollinear(ot,it,dt)&&(Qe&&Qe.chainRemoveTail(Ne,it),nt.pop(),it=ot),Ge.pointsCollinear(it,dt,ht)&&(Qe&&Qe.chainRemoveHead(rt,dt),at.shift()),Qe&&Qe.chainJoin(Ne,rt),tt[Ne]=nt.concat(at),tt.splice(rt,1)}})),rt}Ge.exports=SegmentChainer},{}],524:[function(Ne,Ge,Qe){function select(Ne,Ge,Qe){var tt=[];return Ne.forEach((function(Ne){var rt=(Ne.myFill.above?8:0)+(Ne.myFill.below?4:0)+(Ne.otherFill&&Ne.otherFill.above?2:0)+(Ne.otherFill&&Ne.otherFill.below?1:0);0!==Ge[rt]&&tt.push({id:Qe?Qe.segmentId():-1,start:Ne.start,end:Ne.end,myFill:{above:1===Ge[rt],below:2===Ge[rt]},otherFill:null})})),Qe&&Qe.selected(tt),tt}var tt={union:function(Ne,Ge){return select(Ne,[0,2,1,0,2,2,0,0,1,0,1,0,0,0,0,0],Ge)},intersect:function(Ne,Ge){return select(Ne,[0,0,0,0,0,2,0,2,0,0,1,1,0,2,1,0],Ge)},difference:function(Ne,Ge){return select(Ne,[0,0,0,0,2,0,2,0,1,1,0,0,0,1,2,0],Ge)},differenceRev:function(Ne,Ge){return select(Ne,[0,2,1,0,0,0,1,1,0,2,0,2,0,0,0,0],Ge)},xor:function(Ne,Ge){return select(Ne,[0,2,1,0,2,0,0,1,1,0,0,2,0,1,2,0],Ge)}};Ge.exports=tt},{}],525:[function(Ne,Ge,Qe){"use strict";var tt=new Float64Array(4),rt=new Float64Array(4),nt=new Float64Array(4);function closestPoint2d(Ne,Ge,Qe,at,it){tt.length<at.length&&(tt=new Float64Array(at.length),rt=new Float64Array(at.length),nt=new Float64Array(at.length));for(var ot=0;ot<at.length;++ot)tt[ot]=Ne[ot]-at[ot],rt[ot]=Ge[ot]-Ne[ot],nt[ot]=Qe[ot]-Ne[ot];var dt=0,ht=0,Dt=0,Ot=0,Rt=0,Zt=0;for(ot=0;ot<at.length;++ot){var er=rt[ot],dr=nt[ot],mr=tt[ot];dt+=er*er,ht+=er*dr,Dt+=dr*dr,Ot+=mr*er,Rt+=mr*dr,Zt+=mr*mr}var xr,br,Ar,en,mn,xn=Math.abs(dt*Dt-ht*ht),kn=ht*Rt-Dt*Ot,Cn=ht*Ot-dt*Rt;if(kn+Cn<=xn)if(kn<0)Cn<0&&Ot<0?(Cn=0,-Ot>=dt?(kn=1,xr=dt+2*Ot+Zt):xr=Ot*(kn=-Ot/dt)+Zt):(kn=0,Rt>=0?(Cn=0,xr=Zt):-Rt>=Dt?(Cn=1,xr=Dt+2*Rt+Zt):xr=Rt*(Cn=-Rt/Dt)+Zt);else if(Cn<0)Cn=0,Ot>=0?(kn=0,xr=Zt):-Ot>=dt?(kn=1,xr=dt+2*Ot+Zt):xr=Ot*(kn=-Ot/dt)+Zt;else{var En=1/xn;xr=(kn*=En)*(dt*kn+ht*(Cn*=En)+2*Ot)+Cn*(ht*kn+Dt*Cn+2*Rt)+Zt}else kn<0?(Ar=Dt+Rt)>(br=ht+Ot)?(en=Ar-br)>=(mn=dt-2*ht+Dt)?(kn=1,Cn=0,xr=dt+2*Ot+Zt):xr=(kn=en/mn)*(dt*kn+ht*(Cn=1-kn)+2*Ot)+Cn*(ht*kn+Dt*Cn+2*Rt)+Zt:(kn=0,Ar<=0?(Cn=1,xr=Dt+2*Rt+Zt):Rt>=0?(Cn=0,xr=Zt):xr=Rt*(Cn=-Rt/Dt)+Zt):Cn<0?(Ar=dt+Ot)>(br=ht+Rt)?(en=Ar-br)>=(mn=dt-2*ht+Dt)?(Cn=1,kn=0,xr=Dt+2*Rt+Zt):xr=(kn=1-(Cn=en/mn))*(dt*kn+ht*Cn+2*Ot)+Cn*(ht*kn+Dt*Cn+2*Rt)+Zt:(Cn=0,Ar<=0?(kn=1,xr=dt+2*Ot+Zt):Ot>=0?(kn=0,xr=Zt):xr=Ot*(kn=-Ot/dt)+Zt):(en=Dt+Rt-ht-Ot)<=0?(kn=0,Cn=1,xr=Dt+2*Rt+Zt):en>=(mn=dt-2*ht+Dt)?(kn=1,Cn=0,xr=dt+2*Ot+Zt):xr=(kn=en/mn)*(dt*kn+ht*(Cn=1-kn)+2*Ot)+Cn*(ht*kn+Dt*Cn+2*Rt)+Zt;var Pn=1-kn-Cn;for(ot=0;ot<at.length;++ot)it[ot]=Pn*Ne[ot]+kn*Ge[ot]+Cn*Qe[ot];return xr<0?0:xr}Ge.exports=closestPoint2d},{}],526:[function(Ne,Ge,Qe){var tt,rt,nt=Ge.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(Ne){if(tt===setTimeout)return setTimeout(Ne,0);if((tt===defaultSetTimout||!tt)&&setTimeout)return tt=setTimeout,setTimeout(Ne,0);try{return tt(Ne,0)}catch(Ge){try{return tt.call(null,Ne,0)}catch(Ge){return tt.call(this,Ne,0)}}}function runClearTimeout(Ne){if(rt===clearTimeout)return clearTimeout(Ne);if((rt===defaultClearTimeout||!rt)&&clearTimeout)return rt=clearTimeout,clearTimeout(Ne);try{return rt(Ne)}catch(Ge){try{return rt.call(null,Ne)}catch(Ge){return rt.call(this,Ne)}}}!function(){try{tt="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(Ne){tt=defaultSetTimout}try{rt="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(Ne){rt=defaultClearTimeout}}();var at,it=[],ot=!1,dt=-1;function cleanUpNextTick(){ot&&at&&(ot=!1,at.length?it=at.concat(it):dt=-1,it.length&&drainQueue())}function drainQueue(){if(!ot){var Ne=runTimeout(cleanUpNextTick);ot=!0;for(var Ge=it.length;Ge;){for(at=it,it=[];++dt<Ge;)at&&at[dt].run();dt=-1,Ge=it.length}at=null,ot=!1,runClearTimeout(Ne)}}function Item(Ne,Ge){this.fun=Ne,this.array=Ge}function noop(){}nt.nextTick=function(Ne){var Ge=new Array(arguments.length-1);if(arguments.length>1)for(var Qe=1;Qe<arguments.length;Qe++)Ge[Qe-1]=arguments[Qe];it.push(new Item(Ne,Ge)),1!==it.length||ot||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},nt.title="browser",nt.browser=!0,nt.env={},nt.argv=[],nt.version="",nt.versions={},nt.on=noop,nt.addListener=noop,nt.once=noop,nt.off=noop,nt.removeListener=noop,nt.removeAllListeners=noop,nt.emit=noop,nt.prependListener=noop,nt.prependOnceListener=noop,nt.listeners=function(Ne){return[]},nt.binding=function(Ne){throw new Error("process.binding is not supported")},nt.cwd=function(){return"/"},nt.chdir=function(Ne){throw new Error("process.chdir is not supported")},nt.umask=function(){return 0}},{}],527:[function(Ne,Ge,Qe){Ge.exports=Ne("gl-quat/slerp")},{"gl-quat/slerp":325}],528:[function(Ne,Ge,tt){(function(Qe){(function(){for(var tt=Ne("performance-now"),rt="undefined"==typeof window?Qe:window,nt=["moz","webkit"],at="AnimationFrame",it=rt["request"+at],ot=rt["cancel"+at]||rt["cancelRequest"+at],dt=0;!it&&dt<nt.length;dt++)it=rt[nt[dt]+"Request"+at],ot=rt[nt[dt]+"Cancel"+at]||rt[nt[dt]+"CancelRequest"+at];if(!it||!ot){var ht=0,Dt=0,Ot=[],Rt=1e3/60;it=function(Ne){if(0===Ot.length){var Ge=tt(),Qe=Math.max(0,Rt-(Ge-ht));ht=Qe+Ge,setTimeout((function(){var Ne=Ot.slice(0);Ot.length=0;for(var Ge=0;Ge<Ne.length;Ge++)if(!Ne[Ge].cancelled)try{Ne[Ge].callback(ht)}catch(Ne){setTimeout((function(){throw Ne}),0)}}),Math.round(Qe))}return Ot.push({handle:++Dt,callback:Ne,cancelled:!1}),Dt},ot=function(Ne){for(var Ge=0;Ge<Ot.length;Ge++)Ot[Ge].handle===Ne&&(Ot[Ge].cancelled=!0)}}Ge.exports=function(Ne){return it.call(rt,Ne)},Ge.exports.cancel=function(){ot.apply(rt,arguments)},Ge.exports.polyfill=function(Ne){Ne||(Ne=rt),Ne.requestAnimationFrame=it,Ne.cancelAnimationFrame=ot}}).call(this)}).call(this,void 0!==Qe.g?Qe.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"performance-now":508}],529:[function(Ne,Ge,Qe){"use strict";var tt=Ne("big-rat/add");function add(Ne,Ge){for(var Qe=Ne.length,rt=new Array(Qe),nt=0;nt<Qe;++nt)rt[nt]=tt(Ne[nt],Ge[nt]);return rt}Ge.exports=add},{"big-rat/add":80}],530:[function(Ne,Ge,Qe){"use strict";Ge.exports=float2rat;var tt=Ne("big-rat");function float2rat(Ne){for(var Ge=new Array(Ne.length),Qe=0;Qe<Ne.length;++Qe)Ge[Qe]=tt(Ne[Qe]);return Ge}},{"big-rat":83}],531:[function(Ne,Ge,Qe){"use strict";var tt=Ne("big-rat"),rt=Ne("big-rat/mul");function muls(Ne,Ge){for(var Qe=tt(Ge),nt=Ne.length,at=new Array(nt),it=0;it<nt;++it)at[it]=rt(Ne[it],Qe);return at}Ge.exports=muls},{"big-rat":83,"big-rat/mul":92}],532:[function(Ne,Ge,Qe){"use strict";var tt=Ne("big-rat/sub");function sub(Ne,Ge){for(var Qe=Ne.length,rt=new Array(Qe),nt=0;nt<Qe;++nt)rt[nt]=tt(Ne[nt],Ge[nt]);return rt}Ge.exports=sub},{"big-rat/sub":94}],533:[function(Ne,Ge,Qe){"use strict";var tt=Ne("compare-cell"),rt=Ne("compare-oriented-cell"),nt=Ne("cell-orientation");function reduceCellComplex(Ne){Ne.sort(rt);for(var Ge=Ne.length,Qe=0,at=0;at<Ge;++at){var it=Ne[at],ot=nt(it);if(0!==ot){if(Qe>0){var dt=Ne[Qe-1];if(0===tt(it,dt)&&nt(dt)!==ot){Qe-=1;continue}}Ne[Qe++]=it}}return Ne.length=Qe,Ne}Ge.exports=reduceCellComplex},{"cell-orientation":117,"compare-cell":133,"compare-oriented-cell":134}],534:[function(Ne,Ge,Qe){"use strict";var tt=Ne("array-bounds"),rt=Ne("color-normalize"),nt=Ne("update-diff"),at=Ne("pick-by-alias"),it=Ne("object-assign"),ot=Ne("flatten-vertex-data"),dt=Ne("to-float32"),ht=dt.float32,Dt=dt.fract32;Ge.exports=Error2D;var Ot=[[1,0,0,1,0,0],[1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,-1,0,0],[-1,0,0,1,0,0],[1,0,0,1,0,0],[1,0,-1,0,0,1],[1,0,-1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,-1],[1,0,1,0,0,1],[1,0,-1,0,0,1],[-1,0,-1,0,0,1],[-1,0,-1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,-1],[-1,0,1,0,0,1],[-1,0,-1,0,0,1],[0,1,1,0,0,0],[0,1,-1,0,0,0],[0,-1,-1,0,0,0],[0,-1,-1,0,0,0],[0,1,1,0,0,0],[0,-1,1,0,0,0],[0,1,0,-1,1,0],[0,1,0,-1,-1,0],[0,1,0,1,-1,0],[0,1,0,1,1,0],[0,1,0,-1,1,0],[0,1,0,1,-1,0],[0,-1,0,-1,1,0],[0,-1,0,-1,-1,0],[0,-1,0,1,-1,0],[0,-1,0,1,1,0],[0,-1,0,-1,1,0],[0,-1,0,1,-1,0]];function Error2D(Ne,Ge){if("function"==typeof Ne?(Ge||(Ge={}),Ge.regl=Ne):Ge=Ne,Ge.length&&(Ge.positions=Ge),!(Ne=Ge.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");var Qe,dt,Rt,Zt,er,dr,mr=Ne._gl,xr={color:"black",capSize:5,lineWidth:1,opacity:1,viewport:null,range:null,offset:0,count:0,bounds:null,positions:[],errors:[]},br=[];return Zt=Ne.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array(0)}),dt=Ne.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),Rt=Ne.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),er=Ne.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)}),dr=Ne.buffer({usage:"static",type:"float",data:Ot}),update(Ge),Qe=Ne({vert:"\n\t\tprecision highp float;\n\n\t\tattribute vec2 position, positionFract;\n\t\tattribute vec4 error;\n\t\tattribute vec4 color;\n\n\t\tattribute vec2 direction, lineOffset, capOffset;\n\n\t\tuniform vec4 viewport;\n\t\tuniform float lineWidth, capSize;\n\t\tuniform vec2 scale, scaleFract, translate, translateFract;\n\n\t\tvarying vec4 fragColor;\n\n\t\tvoid main() {\n\t\t\tfragColor = color / 255.;\n\n\t\t\tvec2 pixelOffset = lineWidth * lineOffset + (capSize + lineWidth) * capOffset;\n\n\t\t\tvec2 dxy = -step(.5, direction.xy) * error.xz + step(direction.xy, vec2(-.5)) * error.yw;\n\n\t\t\tvec2 position = position + dxy;\n\n\t\t\tvec2 pos = (position + translate) * scale\n\t\t\t\t+ (positionFract + translateFract) * scale\n\t\t\t\t+ (position + translate) * scaleFract\n\t\t\t\t+ (positionFract + translateFract) * scaleFract;\n\n\t\t\tpos += pixelOffset / viewport.zw;\n\n\t\t\tgl_Position = vec4(pos * 2. - 1., 0, 1);\n\t\t}\n\t\t",frag:"\n\t\tprecision highp float;\n\n\t\tvarying vec4 fragColor;\n\n\t\tuniform float opacity;\n\n\t\tvoid main() {\n\t\t\tgl_FragColor = fragColor;\n\t\t\tgl_FragColor.a *= opacity;\n\t\t}\n\t\t",uniforms:{range:Ne.prop("range"),lineWidth:Ne.prop("lineWidth"),capSize:Ne.prop("capSize"),opacity:Ne.prop("opacity"),scale:Ne.prop("scale"),translate:Ne.prop("translate"),scaleFract:Ne.prop("scaleFract"),translateFract:Ne.prop("translateFract"),viewport:function(Ne,Ge){return[Ge.viewport.x,Ge.viewport.y,Ne.viewportWidth,Ne.viewportHeight]}},attributes:{color:{buffer:Zt,offset:function(Ne,Ge){return 4*Ge.offset},divisor:1},position:{buffer:dt,offset:function(Ne,Ge){return 8*Ge.offset},divisor:1},positionFract:{buffer:Rt,offset:function(Ne,Ge){return 8*Ge.offset},divisor:1},error:{buffer:er,offset:function(Ne,Ge){return 16*Ge.offset},divisor:1},direction:{buffer:dr,stride:24,offset:0},lineOffset:{buffer:dr,stride:24,offset:8},capOffset:{buffer:dr,stride:24,offset:16}},primitive:"triangles",blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:!1},scissor:{enable:!0,box:Ne.prop("viewport")},viewport:Ne.prop("viewport"),stencil:!1,instances:Ne.prop("count"),count:Ot.length}),it(error2d,{update:update,draw:draw,destroy:destroy,regl:Ne,gl:mr,canvas:mr.canvas,groups:br}),error2d;function error2d(Ne){Ne?update(Ne):null===Ne&&destroy(),draw()}function draw(Ge){if("number"==typeof Ge)return drawGroup(Ge);Ge&&!Array.isArray(Ge)&&(Ge=[Ge]),Ne._refresh(),br.forEach((function(Ne,Qe){Ne&&(Ge&&(Ge[Qe]?Ne.draw=!0:Ne.draw=!1),Ne.draw?drawGroup(Qe):Ne.draw=!0)}))}function drawGroup(Ne){"number"==typeof Ne&&(Ne=br[Ne]),null!=Ne&&Ne&&Ne.count&&Ne.color&&Ne.opacity&&Ne.positions&&Ne.positions.length>1&&(Ne.scaleRatio=[Ne.scale[0]*Ne.viewport.width,Ne.scale[1]*Ne.viewport.height],Qe(Ne),Ne.after&&Ne.after(Ne))}function update(Ne){if(Ne){null!=Ne.length?"number"==typeof Ne[0]&&(Ne=[{positions:Ne}]):Array.isArray(Ne)||(Ne=[Ne]);var Ge=0,Qe=0;if(error2d.groups=br=Ne.map((function(Ne,dt){var ht=br[dt];return Ne?("function"==typeof Ne?Ne={after:Ne}:"number"==typeof Ne[0]&&(Ne={positions:Ne}),Ne=at(Ne,{color:"color colors fill",capSize:"capSize cap capsize cap-size",lineWidth:"lineWidth line-width width line thickness",opacity:"opacity alpha",range:"range dataBox",viewport:"viewport viewBox",errors:"errors error",positions:"positions position data points"}),ht||(br[dt]=ht={id:dt,scale:null,translate:null,scaleFract:null,translateFract:null,draw:!0},Ne=it({},xr,Ne)),nt(ht,Ne,[{lineWidth:function(Ne){return.5*+Ne},capSize:function(Ne){return.5*+Ne},opacity:parseFloat,errors:function(Ne){return Ne=ot(Ne),Qe+=Ne.length,Ne},positions:function(Ne,Qe){return Ne=ot(Ne,"float64"),Qe.count=Math.floor(Ne.length/2),Qe.bounds=tt(Ne,2),Qe.offset=Ge,Ge+=Qe.count,Ne}},{color:function(Ne,Ge){var Qe=Ge.count;if(Ne||(Ne="transparent"),!Array.isArray(Ne)||"number"==typeof Ne[0]){var tt=Ne;Ne=Array(Qe);for(var nt=0;nt<Qe;nt++)Ne[nt]=tt}if(Ne.length<Qe)throw Error("Not enough colors");for(var at=new Uint8Array(4*Qe),it=0;it<Qe;it++){var ot=rt(Ne[it],"uint8");at.set(ot,4*it)}return at},range:function(Ne,Ge,Qe){var tt=Ge.bounds;return Ne||(Ne=tt),Ge.scale=[1/(Ne[2]-Ne[0]),1/(Ne[3]-Ne[1])],Ge.translate=[-Ne[0],-Ne[1]],Ge.scaleFract=Dt(Ge.scale),Ge.translateFract=Dt(Ge.translate),Ne},viewport:function(Ne){var Ge;return Array.isArray(Ne)?Ge={x:Ne[0],y:Ne[1],width:Ne[2]-Ne[0],height:Ne[3]-Ne[1]}:Ne?(Ge={x:Ne.x||Ne.left||0,y:Ne.y||Ne.top||0},Ne.right?Ge.width=Ne.right-Ge.x:Ge.width=Ne.w||Ne.width||0,Ne.bottom?Ge.height=Ne.bottom-Ge.y:Ge.height=Ne.h||Ne.height||0):Ge={x:0,y:0,width:mr.drawingBufferWidth,height:mr.drawingBufferHeight},Ge}}]),ht):ht})),Ge||Qe){var Ot=br.reduce((function(Ne,Ge,Qe){return Ne+(Ge?Ge.count:0)}),0),dr=new Float64Array(2*Ot),Ar=new Uint8Array(4*Ot),en=new Float32Array(4*Ot);br.forEach((function(Ne,Ge){if(Ne){var Qe=Ne.positions,tt=Ne.count,rt=Ne.offset,nt=Ne.color,at=Ne.errors;tt&&(Ar.set(nt,4*rt),en.set(at,4*rt),dr.set(Qe,2*rt))}})),dt(ht(dr)),Rt(Dt(dr)),Zt(Ar),er(en)}}}function destroy(){dt.destroy(),Rt.destroy(),Zt.destroy(),er.destroy(),dr.destroy()}}},{"array-bounds":70,"color-normalize":125,"flatten-vertex-data":244,"object-assign":499,"pick-by-alias":511,"to-float32":577,"update-diff":599}],535:[function(Ne,Ge,Qe){"use strict";var tt=Ne("color-normalize"),rt=Ne("array-bounds"),nt=Ne("object-assign"),at=Ne("glslify"),it=Ne("pick-by-alias"),ot=Ne("flatten-vertex-data"),dt=Ne("earcut"),ht=Ne("array-normalize"),Dt=Ne("to-float32"),Ot=Dt.float32,Rt=Dt.fract32,Zt=Ne("es6-weak-map"),er=Ne("parse-rect");function Line2D(Ne,Ge){if(!(this instanceof Line2D))return new Line2D(Ne,Ge);if("function"==typeof Ne?(Ge||(Ge={}),Ge.regl=Ne):Ge=Ne,Ge.length&&(Ge.positions=Ge),!(Ne=Ge.regl).hasExtension("ANGLE_instanced_arrays"))throw Error("regl-error2d: `ANGLE_instanced_arrays` extension should be enabled");this.gl=Ne._gl,this.regl=Ne,this.passes=[],this.shaders=Line2D.shaders.has(Ne)?Line2D.shaders.get(Ne):Line2D.shaders.set(Ne,Line2D.createShaders(Ne)).get(Ne),this.update(Ge)}Ge.exports=Line2D,Line2D.dashMult=2,Line2D.maxPatternLength=256,Line2D.precisionThreshold=3e6,Line2D.maxPoints=1e4,Line2D.maxLines=2048,Line2D.shaders=new Zt,Line2D.createShaders=function(Ne){var Ge,Qe=Ne.buffer({usage:"static",type:"float",data:[0,1,0,0,1,1,1,0]}),tt={primitive:"triangle strip",instances:Ne.prop("count"),count:4,offset:0,uniforms:{miterMode:function(Ne,Ge){return"round"===Ge.join?2:1},miterLimit:Ne.prop("miterLimit"),scale:Ne.prop("scale"),scaleFract:Ne.prop("scaleFract"),translateFract:Ne.prop("translateFract"),translate:Ne.prop("translate"),thickness:Ne.prop("thickness"),dashPattern:Ne.prop("dashTexture"),opacity:Ne.prop("opacity"),pixelRatio:Ne.context("pixelRatio"),id:Ne.prop("id"),dashSize:Ne.prop("dashLength"),viewport:function(Ne,Ge){return[Ge.viewport.x,Ge.viewport.y,Ne.viewportWidth,Ne.viewportHeight]},depth:Ne.prop("depth")},blend:{enable:!0,color:[0,0,0,0],equation:{rgb:"add",alpha:"add"},func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},depth:{enable:function(Ne,Ge){return!Ge.overlay}},stencil:{enable:!1},scissor:{enable:!0,box:Ne.prop("viewport")},viewport:Ne.prop("viewport")},rt=Ne(nt({vert:at(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, aCoordFract, bCoordFract;\nattribute vec4 color;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvec2 project(vec2 position, vec2 positionFract, vec2 scale, vec2 scaleFract, vec2 translate, vec2 translateFract) {\n\t// the order is important\n\treturn position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n}\n\nvoid main() {\n\tfloat lineStart = 1. - lineEnd;\n\tfloat lineOffset = lineTop * 2. - 1.;\n\n\tvec2 diff = (bCoord + bCoordFract - aCoord - aCoordFract);\n\ttangent = normalize(diff * scale * viewport.zw);\n\tvec2 normal = vec2(-tangent.y, tangent.x);\n\n\tvec2 position = project(aCoord, aCoordFract, scale, scaleFract, translate, translateFract) * lineStart\n\t\t+ project(bCoord, bCoordFract, scale, scaleFract, translate, translateFract) * lineEnd\n\n\t\t+ thickness * normal * .5 * lineOffset / viewport.zw;\n\n\tgl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n\tfragColor = color / 255.;\n}\n"]),frag:at(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D dashPattern;\n\nuniform float dashSize, pixelRatio, thickness, opacity, id;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\n\nvoid main() {\n\tfloat alpha = 1.;\n\n\tfloat t = fract(dot(tangent, gl_FragCoord.xy) / dashSize) * .5 + .25;\n\tfloat dash = texture2D(dashPattern, vec2(t, .5)).r;\n\n\tgl_FragColor = fragColor;\n\tgl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:Qe,divisor:0,stride:8,offset:0},lineTop:{buffer:Qe,divisor:0,stride:8,offset:4},aCoord:{buffer:Ne.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:Ne.prop("positionBuffer"),stride:8,offset:16,divisor:1},aCoordFract:{buffer:Ne.prop("positionFractBuffer"),stride:8,offset:8,divisor:1},bCoordFract:{buffer:Ne.prop("positionFractBuffer"),stride:8,offset:16,divisor:1},color:{buffer:Ne.prop("colorBuffer"),stride:4,offset:0,divisor:1}}},tt));try{Ge=Ne(nt({cull:{enable:!0,face:"back"},vert:at(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 aCoord, bCoord, nextCoord, prevCoord;\nattribute vec4 aColor, bColor;\nattribute float lineEnd, lineTop;\n\nuniform vec2 scale, translate;\nuniform float thickness, pixelRatio, id, depth;\nuniform vec4 viewport;\nuniform float miterLimit, miterMode;\n\nvarying vec4 fragColor;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 tangent;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nconst float REVERSE_THRESHOLD = -.875;\nconst float MIN_DIFF = 1e-6;\n\n// TODO: possible optimizations: avoid overcalculating all for vertices and calc just one instead\n// TODO: precalculate dot products, normalize things beforehead etc.\n// TODO: refactor to rectangular algorithm\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n\tvec2 diff = b - a;\n\tvec2 perp = normalize(vec2(-diff.y, diff.x));\n\treturn dot(p - a, perp);\n}\n\nbool isNaN( float val ){\n  return ( val < 0.0 || 0.0 < val || val == 0.0 ) ? false : true;\n}\n\nvoid main() {\n\tvec2 aCoord = aCoord, bCoord = bCoord, prevCoord = prevCoord, nextCoord = nextCoord;\n\n  vec2 adjustedScale;\n  adjustedScale.x = (abs(scale.x) < MIN_DIFF) ? MIN_DIFF : scale.x;\n  adjustedScale.y = (abs(scale.y) < MIN_DIFF) ? MIN_DIFF : scale.y;\n\n  vec2 scaleRatio = adjustedScale * viewport.zw;\n\tvec2 normalWidth = thickness / scaleRatio;\n\n\tfloat lineStart = 1. - lineEnd;\n\tfloat lineBot = 1. - lineTop;\n\n\tfragColor = (lineStart * aColor + lineEnd * bColor) / 255.;\n\n\tif (isNaN(aCoord.x) || isNaN(aCoord.y) || isNaN(bCoord.x) || isNaN(bCoord.y)) return;\n\n\tif (aCoord == prevCoord) prevCoord = aCoord + normalize(bCoord - aCoord);\n\tif (bCoord == nextCoord) nextCoord = bCoord - normalize(bCoord - aCoord);\n\n\tvec2 prevDiff = aCoord - prevCoord;\n\tvec2 currDiff = bCoord - aCoord;\n\tvec2 nextDiff = nextCoord - bCoord;\n\n\tvec2 prevTangent = normalize(prevDiff * scaleRatio);\n\tvec2 currTangent = normalize(currDiff * scaleRatio);\n\tvec2 nextTangent = normalize(nextDiff * scaleRatio);\n\n\tvec2 prevNormal = vec2(-prevTangent.y, prevTangent.x);\n\tvec2 currNormal = vec2(-currTangent.y, currTangent.x);\n\tvec2 nextNormal = vec2(-nextTangent.y, nextTangent.x);\n\n\tvec2 startJoinDirection = normalize(prevTangent - currTangent);\n\tvec2 endJoinDirection = normalize(currTangent - nextTangent);\n\n\t// collapsed/unidirectional segment cases\n\t// FIXME: there should be more elegant solution\n\tvec2 prevTanDiff = abs(prevTangent - currTangent);\n\tvec2 nextTanDiff = abs(nextTangent - currTangent);\n\tif (max(prevTanDiff.x, prevTanDiff.y) < MIN_DIFF) {\n\t\tstartJoinDirection = currNormal;\n\t}\n\tif (max(nextTanDiff.x, nextTanDiff.y) < MIN_DIFF) {\n\t\tendJoinDirection = currNormal;\n\t}\n\tif (aCoord == bCoord) {\n\t\tendJoinDirection = startJoinDirection;\n\t\tcurrNormal = prevNormal;\n\t\tcurrTangent = prevTangent;\n\t}\n\n\ttangent = currTangent;\n\n\t//calculate join shifts relative to normals\n\tfloat startJoinShift = dot(currNormal, startJoinDirection);\n\tfloat endJoinShift = dot(currNormal, endJoinDirection);\n\n\tfloat startMiterRatio = abs(1. / startJoinShift);\n\tfloat endMiterRatio = abs(1. / endJoinShift);\n\n\tvec2 startJoin = startJoinDirection * startMiterRatio;\n\tvec2 endJoin = endJoinDirection * endMiterRatio;\n\n\tvec2 startTopJoin, startBotJoin, endTopJoin, endBotJoin;\n\tstartTopJoin = sign(startJoinShift) * startJoin * .5;\n\tstartBotJoin = -startTopJoin;\n\n\tendTopJoin = sign(endJoinShift) * endJoin * .5;\n\tendBotJoin = -endTopJoin;\n\n\tvec2 aTopCoord = aCoord + normalWidth * startTopJoin;\n\tvec2 bTopCoord = bCoord + normalWidth * endTopJoin;\n\tvec2 aBotCoord = aCoord + normalWidth * startBotJoin;\n\tvec2 bBotCoord = bCoord + normalWidth * endBotJoin;\n\n\t//miter anti-clipping\n\tfloat baClipping = distToLine(bCoord, aCoord, aBotCoord) / dot(normalize(normalWidth * endBotJoin), normalize(normalWidth.yx * vec2(-startBotJoin.y, startBotJoin.x)));\n\tfloat abClipping = distToLine(aCoord, bCoord, bTopCoord) / dot(normalize(normalWidth * startBotJoin), normalize(normalWidth.yx * vec2(-endBotJoin.y, endBotJoin.x)));\n\n\t//prevent close to reverse direction switch\n\tbool prevReverse = dot(currTangent, prevTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, prevNormal)) * min(length(prevDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\tbool nextReverse = dot(currTangent, nextTangent) <= REVERSE_THRESHOLD && abs(dot(currTangent, nextNormal)) * min(length(nextDiff), length(currDiff)) <  length(normalWidth * currNormal);\n\n\tif (prevReverse) {\n\t\t//make join rectangular\n\t\tvec2 miterShift = normalWidth * startJoinDirection * miterLimit * .5;\n\t\tfloat normalAdjust = 1. - min(miterLimit / startMiterRatio, 1.);\n\t\taBotCoord = aCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n\t\taTopCoord = aCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n\t}\n\telse if (!nextReverse && baClipping > 0. && baClipping < length(normalWidth * endBotJoin)) {\n\t\t//handle miter clipping\n\t\tbTopCoord -= normalWidth * endTopJoin;\n\t\tbTopCoord += normalize(endTopJoin * normalWidth) * baClipping;\n\t}\n\n\tif (nextReverse) {\n\t\t//make join rectangular\n\t\tvec2 miterShift = normalWidth * endJoinDirection * miterLimit * .5;\n\t\tfloat normalAdjust = 1. - min(miterLimit / endMiterRatio, 1.);\n\t\tbBotCoord = bCoord + miterShift - normalAdjust * normalWidth * currNormal * .5;\n\t\tbTopCoord = bCoord + miterShift + normalAdjust * normalWidth * currNormal * .5;\n\t}\n\telse if (!prevReverse && abClipping > 0. && abClipping < length(normalWidth * startBotJoin)) {\n\t\t//handle miter clipping\n\t\taBotCoord -= normalWidth * startBotJoin;\n\t\taBotCoord += normalize(startBotJoin * normalWidth) * abClipping;\n\t}\n\n\tvec2 aTopPosition = (aTopCoord) * adjustedScale + translate;\n\tvec2 aBotPosition = (aBotCoord) * adjustedScale + translate;\n\n\tvec2 bTopPosition = (bTopCoord) * adjustedScale + translate;\n\tvec2 bBotPosition = (bBotCoord) * adjustedScale + translate;\n\n\t//position is normalized 0..1 coord on the screen\n\tvec2 position = (aTopPosition * lineTop + aBotPosition * lineBot) * lineStart + (bTopPosition * lineTop + bBotPosition * lineBot) * lineEnd;\n\n\tstartCoord = aCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\tendCoord = bCoord * scaleRatio + translate * viewport.zw + viewport.xy;\n\n\tgl_Position = vec4(position  * 2.0 - 1.0, depth, 1);\n\n\tenableStartMiter = step(dot(currTangent, prevTangent), .5);\n\tenableEndMiter = step(dot(currTangent, nextTangent), .5);\n\n\t//bevel miter cutoffs\n\tif (miterMode == 1.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tvec2 startMiterWidth = vec2(startJoinDirection) * thickness * miterLimit * .5;\n\t\t\tstartCutoff = vec4(aCoord, aCoord);\n\t\t\tstartCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n\t\t\tstartCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tstartCutoff += viewport.xyxy;\n\t\t\tstartCutoff += startMiterWidth.xyxy;\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tvec2 endMiterWidth = vec2(endJoinDirection) * thickness * miterLimit * .5;\n\t\t\tendCutoff = vec4(bCoord, bCoord);\n\t\t\tendCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n\t\t\tendCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tendCutoff += viewport.xyxy;\n\t\t\tendCutoff += endMiterWidth.xyxy;\n\t\t}\n\t}\n\n\t//round miter cutoffs\n\telse if (miterMode == 2.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tvec2 startMiterWidth = vec2(startJoinDirection) * thickness * abs(dot(startJoinDirection, currNormal)) * .5;\n\t\t\tstartCutoff = vec4(aCoord, aCoord);\n\t\t\tstartCutoff.zw += vec2(-startJoinDirection.y, startJoinDirection.x) / scaleRatio;\n\t\t\tstartCutoff = startCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tstartCutoff += viewport.xyxy;\n\t\t\tstartCutoff += startMiterWidth.xyxy;\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tvec2 endMiterWidth = vec2(endJoinDirection) * thickness * abs(dot(endJoinDirection, currNormal)) * .5;\n\t\t\tendCutoff = vec4(bCoord, bCoord);\n\t\t\tendCutoff.zw += vec2(-endJoinDirection.y, endJoinDirection.x)  / scaleRatio;\n\t\t\tendCutoff = endCutoff * scaleRatio.xyxy + translate.xyxy * viewport.zwzw;\n\t\t\tendCutoff += viewport.xyxy;\n\t\t\tendCutoff += endMiterWidth.xyxy;\n\t\t}\n\t}\n}\n"]),frag:at(["precision highp float;\n#define GLSLIFY 1\n\nuniform sampler2D dashPattern;\nuniform float dashSize, pixelRatio, thickness, opacity, id, miterMode;\n\nvarying vec4 fragColor;\nvarying vec2 tangent;\nvarying vec4 startCutoff, endCutoff;\nvarying vec2 startCoord, endCoord;\nvarying float enableStartMiter, enableEndMiter;\n\nfloat distToLine(vec2 p, vec2 a, vec2 b) {\n\tvec2 diff = b - a;\n\tvec2 perp = normalize(vec2(-diff.y, diff.x));\n\treturn dot(p - a, perp);\n}\n\nvoid main() {\n\tfloat alpha = 1., distToStart, distToEnd;\n\tfloat cutoff = thickness * .5;\n\n\t//bevel miter\n\tif (miterMode == 1.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tdistToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n\t\t\tif (distToStart < -1.) {\n\t\t\t\tdiscard;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\talpha *= min(max(distToStart + 1., 0.), 1.);\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tdistToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n\t\t\tif (distToEnd < -1.) {\n\t\t\t\tdiscard;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\talpha *= min(max(distToEnd + 1., 0.), 1.);\n\t\t}\n\t}\n\n\t// round miter\n\telse if (miterMode == 2.) {\n\t\tif (enableStartMiter == 1.) {\n\t\t\tdistToStart = distToLine(gl_FragCoord.xy, startCutoff.xy, startCutoff.zw);\n\t\t\tif (distToStart < 0.) {\n\t\t\t\tfloat radius = length(gl_FragCoord.xy - startCoord);\n\n\t\t\t\tif(radius > cutoff + .5) {\n\t\t\t\t\tdiscard;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\talpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n\t\t\t}\n\t\t}\n\n\t\tif (enableEndMiter == 1.) {\n\t\t\tdistToEnd = distToLine(gl_FragCoord.xy, endCutoff.xy, endCutoff.zw);\n\t\t\tif (distToEnd < 0.) {\n\t\t\t\tfloat radius = length(gl_FragCoord.xy - endCoord);\n\n\t\t\t\tif(radius > cutoff + .5) {\n\t\t\t\t\tdiscard;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\talpha -= smoothstep(cutoff - .5, cutoff + .5, radius);\n\t\t\t}\n\t\t}\n\t}\n\n\tfloat t = fract(dot(tangent, gl_FragCoord.xy) / dashSize) * .5 + .25;\n\tfloat dash = texture2D(dashPattern, vec2(t, .5)).r;\n\n\tgl_FragColor = fragColor;\n\tgl_FragColor.a *= alpha * opacity * dash;\n}\n"]),attributes:{lineEnd:{buffer:Qe,divisor:0,stride:8,offset:0},lineTop:{buffer:Qe,divisor:0,stride:8,offset:4},aColor:{buffer:Ne.prop("colorBuffer"),stride:4,offset:0,divisor:1},bColor:{buffer:Ne.prop("colorBuffer"),stride:4,offset:4,divisor:1},prevCoord:{buffer:Ne.prop("positionBuffer"),stride:8,offset:0,divisor:1},aCoord:{buffer:Ne.prop("positionBuffer"),stride:8,offset:8,divisor:1},bCoord:{buffer:Ne.prop("positionBuffer"),stride:8,offset:16,divisor:1},nextCoord:{buffer:Ne.prop("positionBuffer"),stride:8,offset:24,divisor:1}}},tt))}catch(Ne){Ge=rt}return{fill:Ne({primitive:"triangle",elements:function(Ne,Ge){return Ge.triangles},offset:0,vert:at(["precision highp float;\n#define GLSLIFY 1\n\nattribute vec2 position, positionFract;\n\nuniform vec4 color;\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float pixelRatio, id;\nuniform vec4 viewport;\nuniform float opacity;\n\nvarying vec4 fragColor;\n\nconst float MAX_LINES = 256.;\n\nvoid main() {\n\tfloat depth = (MAX_LINES - 4. - id) / (MAX_LINES);\n\n\tvec2 position = position * scale + translate\n       + positionFract * scale + translateFract\n       + position * scaleFract\n       + positionFract * scaleFract;\n\n\tgl_Position = vec4(position * 2.0 - 1.0, depth, 1);\n\n\tfragColor = color / 255.;\n\tfragColor.a *= opacity;\n}\n"]),frag:at(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n\tgl_FragColor = fragColor;\n}\n"]),uniforms:{scale:Ne.prop("scale"),color:Ne.prop("fill"),scaleFract:Ne.prop("scaleFract"),translateFract:Ne.prop("translateFract"),translate:Ne.prop("translate"),opacity:Ne.prop("opacity"),pixelRatio:Ne.context("pixelRatio"),id:Ne.prop("id"),viewport:function(Ne,Ge){return[Ge.viewport.x,Ge.viewport.y,Ne.viewportWidth,Ne.viewportHeight]}},attributes:{position:{buffer:Ne.prop("positionBuffer"),stride:8,offset:8},positionFract:{buffer:Ne.prop("positionFractBuffer"),stride:8,offset:8}},blend:tt.blend,depth:{enable:!1},scissor:tt.scissor,stencil:tt.stencil,viewport:tt.viewport}),rect:rt,miter:Ge}},Line2D.defaults={dashes:null,join:"miter",miterLimit:1,thickness:10,cap:"square",color:"black",opacity:1,overlay:!1,viewport:null,range:null,close:!1,fill:null},Line2D.prototype.render=function(){for(var Ne,Ge=[],Qe=arguments.length;Qe--;)Ge[Qe]=arguments[Qe];Ge.length&&(Ne=this).update.apply(Ne,Ge),this.draw()},Line2D.prototype.draw=function(){for(var Ne=this,Ge=[],Qe=arguments.length;Qe--;)Ge[Qe]=arguments[Qe];return(Ge.length?Ge:this.passes).forEach((function(Ge,Qe){var tt;if(Ge&&Array.isArray(Ge))return(tt=Ne).draw.apply(tt,Ge);"number"==typeof Ge&&(Ge=Ne.passes[Ge]),Ge&&Ge.count>1&&Ge.opacity&&(Ne.regl._refresh(),Ge.fill&&Ge.triangles&&Ge.triangles.length>2&&Ne.shaders.fill(Ge),Ge.thickness&&(Ge.scale[0]*Ge.viewport.width>Line2D.precisionThreshold||Ge.scale[1]*Ge.viewport.height>Line2D.precisionThreshold||"rect"===Ge.join||!Ge.join&&(Ge.thickness<=2||Ge.count>=Line2D.maxPoints)?Ne.shaders.rect(Ge):Ne.shaders.miter(Ge)))})),this},Line2D.prototype.update=function(Ne){var Ge=this;if(Ne){null!=Ne.length?"number"==typeof Ne[0]&&(Ne=[{positions:Ne}]):Array.isArray(Ne)||(Ne=[Ne]);var Qe=this,at=Qe.regl,Dt=Qe.gl;if(Ne.forEach((function(Ne,Qe){var Zt=Ge.passes[Qe];if(void 0!==Ne)if(null!==Ne){if("number"==typeof Ne[0]&&(Ne={positions:Ne}),Ne=it(Ne,{positions:"positions points data coords",thickness:"thickness lineWidth lineWidths line-width linewidth width stroke-width strokewidth strokeWidth",join:"lineJoin linejoin join type mode",miterLimit:"miterlimit miterLimit",dashes:"dash dashes dasharray dash-array dashArray",color:"color colour stroke colors colours stroke-color strokeColor",fill:"fill fill-color fillColor",opacity:"alpha opacity",overlay:"overlay crease overlap intersect",close:"closed close closed-path closePath",range:"range dataBox",viewport:"viewport viewBox",hole:"holes hole hollow"}),Zt||(Ge.passes[Qe]=Zt={id:Qe,scale:null,scaleFract:null,translate:null,translateFract:null,count:0,hole:[],depth:0,dashLength:1,dashTexture:at.texture({channels:1,data:new Uint8Array([255]),width:1,height:1,mag:"linear",min:"linear"}),colorBuffer:at.buffer({usage:"dynamic",type:"uint8",data:new Uint8Array}),positionBuffer:at.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),positionFractBuffer:at.buffer({usage:"dynamic",type:"float",data:new Uint8Array})},Ne=nt({},Line2D.defaults,Ne)),null!=Ne.thickness&&(Zt.thickness=parseFloat(Ne.thickness)),null!=Ne.opacity&&(Zt.opacity=parseFloat(Ne.opacity)),null!=Ne.miterLimit&&(Zt.miterLimit=parseFloat(Ne.miterLimit)),null!=Ne.overlay&&(Zt.overlay=!!Ne.overlay,Qe<Line2D.maxLines&&(Zt.depth=2*(Line2D.maxLines-1-Qe%Line2D.maxLines)/Line2D.maxLines-1)),null!=Ne.join&&(Zt.join=Ne.join),null!=Ne.hole&&(Zt.hole=Ne.hole),null!=Ne.fill&&(Zt.fill=Ne.fill?tt(Ne.fill,"uint8"):null),null!=Ne.viewport&&(Zt.viewport=er(Ne.viewport)),Zt.viewport||(Zt.viewport=er([Dt.drawingBufferWidth,Dt.drawingBufferHeight])),null!=Ne.close&&(Zt.close=Ne.close),null===Ne.positions&&(Ne.positions=[]),Ne.positions){var dr,mr;if(Ne.positions.x&&Ne.positions.y){var xr=Ne.positions.x,br=Ne.positions.y;mr=Zt.count=Math.max(xr.length,br.length),dr=new Float64Array(2*mr);for(var Ar=0;Ar<mr;Ar++)dr[2*Ar]=xr[Ar],dr[2*Ar+1]=br[Ar]}else dr=ot(Ne.positions,"float64"),mr=Zt.count=Math.floor(dr.length/2);var en=Zt.bounds=rt(dr,2);if(Zt.fill){for(var mn=[],xn={},kn=0,Cn=0,En=0,Pn=Zt.count;Cn<Pn;Cn++){var Dn=dr[2*Cn],In=dr[2*Cn+1];isNaN(Dn)||isNaN(In)||null==Dn||null==In?(Dn=dr[2*kn],In=dr[2*kn+1],xn[Cn]=kn):kn=Cn,mn[En++]=Dn,mn[En++]=In}for(var zn=dt(mn,Zt.hole||[]),Bn=0,Vn=zn.length;Bn<Vn;Bn++)null!=xn[zn[Bn]]&&(zn[Bn]=xn[zn[Bn]]);Zt.triangles=zn}var Hn=new Float64Array(dr);ht(Hn,2,en);var qn=new Float64Array(2*mr+6);Zt.close?dr[0]===dr[2*mr-2]&&dr[1]===dr[2*mr-1]?(qn[0]=Hn[2*mr-4],qn[1]=Hn[2*mr-3]):(qn[0]=Hn[2*mr-2],qn[1]=Hn[2*mr-1]):(qn[0]=Hn[0],qn[1]=Hn[1]),qn.set(Hn,2),Zt.close?dr[0]===dr[2*mr-2]&&dr[1]===dr[2*mr-1]?(qn[2*mr+2]=Hn[2],qn[2*mr+3]=Hn[3],Zt.count-=1):(qn[2*mr+2]=Hn[0],qn[2*mr+3]=Hn[1],qn[2*mr+4]=Hn[2],qn[2*mr+5]=Hn[3]):(qn[2*mr+2]=Hn[2*mr-2],qn[2*mr+3]=Hn[2*mr-1],qn[2*mr+4]=Hn[2*mr-2],qn[2*mr+5]=Hn[2*mr-1]),Zt.positionBuffer(Ot(qn)),Zt.positionFractBuffer(Rt(qn))}if(Ne.range?Zt.range=Ne.range:Zt.range||(Zt.range=Zt.bounds),(Ne.range||Ne.positions)&&Zt.count){var Yn=Zt.bounds,$n=Yn[2]-Yn[0],ra=Yn[3]-Yn[1],oa=Zt.range[2]-Zt.range[0],pa=Zt.range[3]-Zt.range[1];Zt.scale=[$n/oa,ra/pa],Zt.translate=[-Zt.range[0]/oa+Yn[0]/oa||0,-Zt.range[1]/pa+Yn[1]/pa||0],Zt.scaleFract=Rt(Zt.scale),Zt.translateFract=Rt(Zt.translate)}if(Ne.dashes){var ga,ma=0;if(!Ne.dashes||Ne.dashes.length<2)ma=1,ga=new Uint8Array([255,255,255,255,255,255,255,255]);else{ma=0;for(var _a=0;_a<Ne.dashes.length;++_a)ma+=Ne.dashes[_a];ga=new Uint8Array(ma*Line2D.dashMult);for(var Va=0,Wa=255,Qa=0;Qa<2;Qa++)for(var ti=0;ti<Ne.dashes.length;++ti){for(var ni=0,di=Ne.dashes[ti]*Line2D.dashMult*.5;ni<di;++ni)ga[Va++]=Wa;Wa^=255}}Zt.dashLength=ma,Zt.dashTexture({channels:1,data:ga,width:ga.length,height:1,mag:"linear",min:"linear"},0,0)}if(Ne.color){var ji=Zt.count,Hi=Ne.color;Hi||(Hi="transparent");var Yi=new Uint8Array(4*ji+4);if(Array.isArray(Hi)&&"number"!=typeof Hi[0]){for(var uo=0;uo<ji;uo++){var go=tt(Hi[uo],"uint8");Yi.set(go,4*uo)}Yi.set(tt(Hi[0],"uint8"),4*ji)}else for(var ns=tt(Hi,"uint8"),as=0;as<ji+1;as++)Yi.set(ns,4*as);Zt.colorBuffer({usage:"dynamic",type:"uint8",data:Yi})}}else Ge.passes[Qe]=null})),Ne.length<this.passes.length){for(var Zt=Ne.length;Zt<this.passes.length;Zt++){var dr=this.passes[Zt];dr&&(dr.colorBuffer.destroy(),dr.positionBuffer.destroy(),dr.dashTexture.destroy())}this.passes.length=Ne.length}for(var mr=[],xr=0;xr<this.passes.length;xr++)null!==this.passes[xr]&&mr.push(this.passes[xr]);return this.passes=mr,this}},Line2D.prototype.destroy=function(){return this.passes.forEach((function(Ne){Ne.colorBuffer.destroy(),Ne.positionBuffer.destroy(),Ne.dashTexture.destroy()})),this.passes.length=0,this}},{"array-bounds":70,"array-normalize":71,"color-normalize":125,earcut:177,"es6-weak-map":233,"flatten-vertex-data":244,glslify:536,"object-assign":499,"parse-rect":504,"pick-by-alias":511,"to-float32":577}],536:[function(Ne,Ge,Qe){arguments[4][257][0].apply(Qe,arguments)},{dup:257}],537:[function(Ne,Ge,Qe){"use strict";function _slicedToArray(Ne,Ge){return _arrayWithHoles(Ne)||_iterableToArrayLimit(Ne,Ge)||_unsupportedIterableToArray(Ne,Ge)||_nonIterableRest()}function _toConsumableArray(Ne){return _arrayWithoutHoles(Ne)||_iterableToArray(Ne)||_unsupportedIterableToArray(Ne)||_nonIterableSpread()}function _arrayWithoutHoles(Ne){if(Array.isArray(Ne))return _arrayLikeToArray(Ne)}function _arrayWithHoles(Ne){if(Array.isArray(Ne))return Ne}function _iterableToArray(Ne){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(Ne))return Array.from(Ne)}function _iterableToArrayLimit(Ne,Ge){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(Ne)){var Qe=[],tt=!0,rt=!1,nt=void 0;try{for(var at,it=Ne[Symbol.iterator]();!(tt=(at=it.next()).done)&&(Qe.push(at.value),!Ge||Qe.length!==Ge);tt=!0);}catch(Ne){rt=!0,nt=Ne}finally{try{tt||null==it.return||it.return()}finally{if(rt)throw nt}}return Qe}}function _unsupportedIterableToArray(Ne,Ge){if(Ne){if("string"==typeof Ne)return _arrayLikeToArray(Ne,Ge);var Qe=Object.prototype.toString.call(Ne).slice(8,-1);return"Object"===Qe&&Ne.constructor&&(Qe=Ne.constructor.name),"Map"===Qe||"Set"===Qe?Array.from(Ne):"Arguments"===Qe||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Qe)?_arrayLikeToArray(Ne,Ge):void 0}}function _arrayLikeToArray(Ne,Ge){(null==Ge||Ge>Ne.length)&&(Ge=Ne.length);for(var Qe=0,tt=new Array(Ge);Qe<Ge;Qe++)tt[Qe]=Ne[Qe];return tt}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var tt=Ne("color-normalize"),rt=Ne("array-bounds"),nt=Ne("color-id"),at=Ne("@plotly/point-cluster"),it=Ne("object-assign"),ot=Ne("glslify"),dt=Ne("pick-by-alias"),ht=Ne("update-diff"),Dt=Ne("flatten-vertex-data"),Ot=Ne("is-iexplorer"),Rt=Ne("to-float32"),Zt=Ne("parse-rect"),er=Scatter;function Scatter(Ne,Ge){var Qe=this;if(!(this instanceof Scatter))return new Scatter(Ne,Ge);"function"==typeof Ne?(Ge||(Ge={}),Ge.regl=Ne):(Ge=Ne,Ne=null),Ge&&Ge.length&&(Ge.positions=Ge);var tt,rt=(Ne=Ge.regl)._gl,nt=[],at={},dt=[],ht=[null],Dt=[null],Rt=255,Zt=100;this.tooManyColors=Ot,tt=Ne.texture({data:new Uint8Array(4*Rt),width:Rt,height:1,type:"uint8",format:"rgba",wrapS:"clamp",wrapT:"clamp",mag:"nearest",min:"nearest"}),it(this,{regl:Ne,gl:rt,groups:dt,markerCache:Dt,markerTextures:ht,palette:nt,paletteIds:at,paletteTexture:tt,maxColors:Rt,maxSize:Zt,canvas:rt.canvas}),this.update(Ge);var er={uniforms:{constPointSize:!!Ge.constPointSize,pixelRatio:Ne.context("pixelRatio"),palette:tt,paletteSize:function(Ne,Ge){return[Qe.tooManyColors?0:Rt,tt.height]},scale:Ne.prop("scale"),scaleFract:Ne.prop("scaleFract"),translate:Ne.prop("translate"),translateFract:Ne.prop("translateFract"),opacity:Ne.prop("opacity"),marker:Ne.prop("markerTexture")},attributes:{x:function(Ne,Ge){return Ge.xAttr||{buffer:Ge.positionBuffer,stride:8,offset:0}},y:function(Ne,Ge){return Ge.yAttr||{buffer:Ge.positionBuffer,stride:8,offset:4}},xFract:function(Ne,Ge){return Ge.xAttr?{constant:[0,0]}:{buffer:Ge.positionFractBuffer,stride:8,offset:0}},yFract:function(Ne,Ge){return Ge.yAttr?{constant:[0,0]}:{buffer:Ge.positionFractBuffer,stride:8,offset:4}},size:function(Ne,Ge){return Ge.size.length?{buffer:Ge.sizeBuffer,stride:2,offset:0}:{constant:[Math.round(255*Ge.size/Qe.maxSize)]}},borderSize:function(Ne,Ge){return Ge.borderSize.length?{buffer:Ge.sizeBuffer,stride:2,offset:1}:{constant:[Math.round(255*Ge.borderSize/Qe.maxSize)]}},colorId:function(Ne,Ge){return Ge.color.length?{buffer:Ge.colorBuffer,stride:Qe.tooManyColors?8:4,offset:0}:{constant:Qe.tooManyColors?nt.slice(4*Ge.color,4*Ge.color+4):[Ge.color]}},borderColorId:function(Ne,Ge){return Ge.borderColor.length?{buffer:Ge.colorBuffer,stride:Qe.tooManyColors?8:4,offset:Qe.tooManyColors?4:2}:{constant:Qe.tooManyColors?nt.slice(4*Ge.borderColor,4*Ge.borderColor+4):[Ge.borderColor]}},isActive:function(Ne,Ge){return!0===Ge.activation?{constant:[1]}:Ge.activation?Ge.activation:{constant:[0]}}},blend:{enable:!0,color:[0,0,0,1],func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:"one minus dst alpha",dstAlpha:"one"}},scissor:{enable:!0,box:Ne.prop("viewport")},viewport:Ne.prop("viewport"),stencil:{enable:!1},depth:{enable:!1},elements:Ne.prop("elements"),count:Ne.prop("count"),offset:Ne.prop("offset"),primitive:"points"},dr=it({},er);dr.frag=ot(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragWidth, fragBorderColorLevel, fragColorLevel;\n\nuniform sampler2D marker;\nuniform float opacity;\n\nfloat smoothStep(float x, float y) {\n  return 1.0 / (1.0 + exp(50.0*(x - y)));\n}\n\nvoid main() {\n  float dist = texture2D(marker, gl_PointCoord).r, delta = fragWidth;\n\n  // max-distance alpha\n  if (dist < 0.003) discard;\n\n  // null-border case\n  if (fragBorderColorLevel == fragColorLevel || fragBorderColor.a == 0.) {\n    float colorAmt = smoothstep(.5 - delta, .5 + delta, dist);\n    gl_FragColor = vec4(fragColor.rgb, colorAmt * fragColor.a * opacity);\n  }\n  else {\n    float borderColorAmt = smoothstep(fragBorderColorLevel - delta, fragBorderColorLevel + delta, dist);\n    float colorAmt = smoothstep(fragColorLevel - delta, fragColorLevel + delta, dist);\n\n    vec4 color = fragBorderColor;\n    color.a *= borderColorAmt;\n    color = mix(color, fragColor, colorAmt);\n    color.a *= opacity;\n\n    gl_FragColor = color;\n  }\n\n}\n"]),dr.vert=ot(["precision highp float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform vec2 scale, scaleFract, translate, translateFract, paletteSize;\nuniform float pixelRatio;\nuniform bool constPointSize;\nuniform sampler2D palette;\n\nconst float maxSize = 100.;\nconst float borderLevel = .5;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragPointSize, fragBorderRadius, fragWidth, fragBorderColorLevel, fragColorLevel;\n\nfloat pointSizeScale = (constPointSize) ? 2. : pixelRatio;\n\nbool isDirect = (paletteSize.x < 1.);\n\nvec4 getColor(vec4 id) {\n  return isDirect ? id / 255. : texture2D(palette,\n    vec2(\n      (id.x + .5) / paletteSize.x,\n      (id.y + .5) / paletteSize.y\n    )\n  );\n}\n\nvoid main() {\n  // ignore inactive points\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = 2. * size * pointSizeScale;\n  fragPointSize = size * pixelRatio;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0., 1.);\n\n  fragColor = color;\n  fragBorderColor = borderColor;\n  fragWidth = 1. / gl_PointSize;\n\n  fragBorderColorLevel = clamp(borderLevel - borderLevel * borderSize / size, 0., 1.);\n  fragColorLevel = clamp(borderLevel + (1. - borderLevel) * borderSize / size, 0., 1.);\n}"]),this.drawMarker=Ne(dr);var mr=it({},er);mr.frag=ot(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor, fragBorderColor;\n\nuniform float opacity;\nvarying float fragBorderRadius, fragWidth;\n\nfloat smoothStep(float edge0, float edge1, float x) {\n\tfloat t;\n\tt = clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);\n\treturn t * t * (3.0 - 2.0 * t);\n}\n\nvoid main() {\n\tfloat radius, alpha = 1.0, delta = fragWidth;\n\n\tradius = length(2.0 * gl_PointCoord.xy - 1.0);\n\n\tif (radius > 1.0 + delta) {\n\t\tdiscard;\n\t}\n\n\talpha -= smoothstep(1.0 - delta, 1.0 + delta, radius);\n\n\tfloat borderRadius = fragBorderRadius;\n\tfloat ratio = smoothstep(borderRadius - delta, borderRadius + delta, radius);\n\tvec4 color = mix(fragColor, fragBorderColor, ratio);\n\tcolor.a *= alpha * opacity;\n\tgl_FragColor = color;\n}\n"]),mr.vert=ot(["precision highp float;\n#define GLSLIFY 1\n\nattribute float x, y, xFract, yFract;\nattribute float size, borderSize;\nattribute vec4 colorId, borderColorId;\nattribute float isActive;\n\nuniform vec2 scale, scaleFract, translate, translateFract;\nuniform float pixelRatio;\nuniform bool constPointSize;\nuniform sampler2D palette;\nuniform vec2 paletteSize;\n\nconst float maxSize = 100.;\n\nvarying vec4 fragColor, fragBorderColor;\nvarying float fragBorderRadius, fragWidth;\n\nfloat pointSizeScale = (constPointSize) ? 2. : pixelRatio;\n\nbool isDirect = (paletteSize.x < 1.);\n\nvec4 getColor(vec4 id) {\n  return isDirect ? id / 255. : texture2D(palette,\n    vec2(\n      (id.x + .5) / paletteSize.x,\n      (id.y + .5) / paletteSize.y\n    )\n  );\n}\n\nvoid main() {\n  // ignore inactive points\n  if (isActive == 0.) return;\n\n  vec2 position = vec2(x, y);\n  vec2 positionFract = vec2(xFract, yFract);\n\n  vec4 color = getColor(colorId);\n  vec4 borderColor = getColor(borderColorId);\n\n  float size = size * maxSize / 255.;\n  float borderSize = borderSize * maxSize / 255.;\n\n  gl_PointSize = (size + borderSize) * pointSizeScale;\n\n  vec2 pos = (position + translate) * scale\n      + (positionFract + translateFract) * scale\n      + (position + translate) * scaleFract\n      + (positionFract + translateFract) * scaleFract;\n\n  gl_Position = vec4(pos * 2. - 1., 0., 1.);\n\n  fragBorderRadius = 1. - 2. * borderSize / (size + borderSize);\n  fragColor = color;\n  fragBorderColor = borderColor.a == 0. || borderSize == 0. ? vec4(color.rgb, 0.) : borderColor;\n  fragWidth = 1. / gl_PointSize;\n}\n"]),Ot&&(mr.frag=mr.frag.replace("smoothstep","smoothStep"),dr.frag=dr.frag.replace("smoothstep","smoothStep")),this.drawCircle=Ne(mr)}Scatter.defaults={color:"black",borderColor:"transparent",borderSize:0,size:12,opacity:1,marker:void 0,viewport:null,range:null,pixelSize:null,count:0,offset:0,bounds:null,positions:[],snap:1e4},Scatter.prototype.render=function(){return arguments.length&&this.update.apply(this,arguments),this.draw(),this},Scatter.prototype.draw=function(){for(var Ne=this,Ge=arguments.length,Qe=new Array(Ge),tt=0;tt<Ge;tt++)Qe[tt]=arguments[tt];var rt=this.groups;if(1===Qe.length&&Array.isArray(Qe[0])&&(null===Qe[0][0]||Array.isArray(Qe[0][0]))&&(Qe=Qe[0]),this.regl._refresh(),Qe.length)for(var nt=0;nt<Qe.length;nt++)this.drawItem(nt,Qe[nt]);else rt.forEach((function(Ge,Qe){Ne.drawItem(Qe)}));return this},Scatter.prototype.drawItem=function(Ne,Ge){var Qe=this.groups,tt=Qe[Ne];if("number"==typeof Ge&&(Ne=Ge,tt=Qe[Ge],Ge=null),tt&&tt.count&&tt.opacity){tt.activation[0]&&this.drawCircle(this.getMarkerDrawOptions(0,tt,Ge));for(var rt=[],nt=1;nt<tt.activation.length;nt++)tt.activation[nt]&&(!0===tt.activation[nt]||tt.activation[nt].data.length)&&rt.push.apply(rt,_toConsumableArray(this.getMarkerDrawOptions(nt,tt,Ge)));rt.length&&this.drawMarker(rt)}},Scatter.prototype.getMarkerDrawOptions=function(Ne,Ge,Qe){var tt=Ge.range,rt=Ge.tree,nt=Ge.viewport,at=Ge.activation,ot=Ge.selectionBuffer,dt=Ge.count;if(this.regl,!rt)return Qe?[it({},Ge,{markerTexture:this.markerTextures[Ne],activation:at[Ne],count:Qe.length,elements:Qe,offset:0})]:[it({},Ge,{markerTexture:this.markerTextures[Ne],activation:at[Ne],offset:0})];var ht=[],Dt=rt.range(tt,{lod:!0,px:[(tt[2]-tt[0])/nt.width,(tt[3]-tt[1])/nt.height]});if(Qe){for(var Ot=at[Ne].data,Rt=new Uint8Array(dt),Zt=0;Zt<Qe.length;Zt++){var er=Qe[Zt];Rt[er]=Ot?Ot[er]:1}ot.subdata(Rt)}for(var dr=Dt.length;dr--;){var mr=_slicedToArray(Dt[dr],2),xr=mr[0],br=mr[1];ht.push(it({},Ge,{markerTexture:this.markerTextures[Ne],activation:Qe?ot:at[Ne],offset:xr,count:br-xr}))}return ht},Scatter.prototype.update=function(){for(var Ne=this,Ge=arguments.length,Qe=new Array(Ge),tt=0;tt<Ge;tt++)Qe[tt]=arguments[tt];if(Qe.length){1===Qe.length&&Array.isArray(Qe[0])&&(Qe=Qe[0]);var nt=this.groups,ot=this.gl,Ot=this.regl,er=this.maxSize,dr=this.maxColors,mr=this.palette;this.groups=nt=Qe.map((function(Ge,Qe){var tt=nt[Qe];if(void 0===Ge)return tt;null===Ge?Ge={positions:null}:"function"==typeof Ge?Ge={ondraw:Ge}:"number"==typeof Ge[0]&&(Ge={positions:Ge}),null===(Ge=dt(Ge,{positions:"positions data points",snap:"snap cluster lod tree",size:"sizes size radius",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",color:"colors color fill fill-color fillColor",borderColor:"borderColors borderColor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range dataBox databox",viewport:"viewport viewPort viewBox viewbox",opacity:"opacity alpha transparency",bounds:"bound bounds boundaries limits",tooManyColors:"tooManyColors palette paletteMode optimizePalette enablePalette"})).positions&&(Ge.positions=[]),null!=Ge.tooManyColors&&(Ne.tooManyColors=Ge.tooManyColors),tt||(nt[Qe]=tt={id:Qe,scale:null,translate:null,scaleFract:null,translateFract:null,activation:[],selectionBuffer:Ot.buffer({data:new Uint8Array(0),usage:"stream",type:"uint8"}),sizeBuffer:Ot.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),colorBuffer:Ot.buffer({data:new Uint8Array(0),usage:"dynamic",type:"uint8"}),positionBuffer:Ot.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"}),positionFractBuffer:Ot.buffer({data:new Uint8Array(0),usage:"dynamic",type:"float"})},Ge=it({},Scatter.defaults,Ge)),Ge.positions&&!("marker"in Ge)&&(Ge.marker=tt.marker,delete tt.marker),Ge.marker&&!("positions"in Ge)&&(Ge.positions=tt.positions,delete tt.positions);var xr=0,br=0;if(ht(tt,Ge,[{snap:!0,size:function(Ne,Ge){return null==Ne&&(Ne=Scatter.defaults.size),xr+=Ne&&Ne.length?1:0,Ne},borderSize:function(Ne,Ge){return null==Ne&&(Ne=Scatter.defaults.borderSize),xr+=Ne&&Ne.length?1:0,Ne},opacity:parseFloat,color:function(Ge,Qe){return null==Ge&&(Ge=Scatter.defaults.color),Ge=Ne.updateColor(Ge),br++,Ge},borderColor:function(Ge,Qe){return null==Ge&&(Ge=Scatter.defaults.borderColor),Ge=Ne.updateColor(Ge),br++,Ge},bounds:function(Ne,Ge,Qe){return"range"in Qe||(Qe.range=null),Ne},positions:function(Ne,Ge,Qe){var tt=Ge.snap,nt=Ge.positionBuffer,it=Ge.positionFractBuffer,ot=Ge.selectionBuffer;if(Ne.x||Ne.y)return Ne.x.length?Ge.xAttr={buffer:Ot.buffer(Ne.x),offset:0,stride:4,count:Ne.x.length}:Ge.xAttr={buffer:Ne.x.buffer,offset:4*Ne.x.offset||0,stride:4*(Ne.x.stride||1),count:Ne.x.count},Ne.y.length?Ge.yAttr={buffer:Ot.buffer(Ne.y),offset:0,stride:4,count:Ne.y.length}:Ge.yAttr={buffer:Ne.y.buffer,offset:4*Ne.y.offset||0,stride:4*(Ne.y.stride||1),count:Ne.y.count},Ge.count=Math.max(Ge.xAttr.count,Ge.yAttr.count),Ne;Ne=Dt(Ne,"float64");var dt=Ge.count=Math.floor(Ne.length/2),ht=Ge.bounds=dt?rt(Ne,2):null;if(Qe.range||Ge.range||(delete Ge.range,Qe.range=ht),Qe.marker||Ge.marker||(delete Ge.marker,Qe.marker=null),tt&&(!0===tt||dt>tt)?Ge.tree=at(Ne,{bounds:ht}):tt&&tt.length&&(Ge.tree=tt),Ge.tree){var Zt={primitive:"points",usage:"static",data:Ge.tree,type:"uint32"};Ge.elements?Ge.elements(Zt):Ge.elements=Ot.elements(Zt)}return nt({data:Rt.float(Ne),usage:"dynamic"}),it({data:Rt.fract(Ne),usage:"dynamic"}),ot({data:new Uint8Array(dt),type:"uint8",usage:"stream"}),Ne}},{marker:function(Ge,Qe,tt){var rt=Qe.activation;if(rt.forEach((function(Ne){return Ne&&Ne.destroy&&Ne.destroy()})),rt.length=0,Ge&&"number"!=typeof Ge[0]){for(var nt=[],at=0,it=Math.min(Ge.length,Qe.count);at<it;at++){var ot=Ne.addMarker(Ge[at]);nt[ot]||(nt[ot]=new Uint8Array(Qe.count)),nt[ot][at]=1}for(var dt=0;dt<nt.length;dt++)if(nt[dt]){var ht={data:nt[dt],type:"uint8",usage:"static"};rt[dt]?rt[dt](ht):rt[dt]=Ot.buffer(ht),rt[dt].data=nt[dt]}}else rt[Ne.addMarker(Ge)]=!0;return Ge},range:function(Ne,Ge,Qe){var tt=Ge.bounds;if(tt)return Ne||(Ne=tt),Ge.scale=[1/(Ne[2]-Ne[0]),1/(Ne[3]-Ne[1])],Ge.translate=[-Ne[0],-Ne[1]],Ge.scaleFract=Rt.fract(Ge.scale),Ge.translateFract=Rt.fract(Ge.translate),Ne},viewport:function(Ne){return Zt(Ne||[ot.drawingBufferWidth,ot.drawingBufferHeight])}}]),xr){var Ar=tt,en=Ar.count,mn=Ar.size,xn=Ar.borderSize,kn=Ar.sizeBuffer,Cn=new Uint8Array(2*en);if(mn.length||xn.length)for(var En=0;En<en;En++)Cn[2*En]=Math.round(255*(null==mn[En]?mn:mn[En])/er),Cn[2*En+1]=Math.round(255*(null==xn[En]?xn:xn[En])/er);kn({data:Cn,usage:"dynamic"})}if(br){var Pn,Dn=tt,In=Dn.count,zn=Dn.color,Bn=Dn.borderColor,Vn=Dn.colorBuffer;if(Ne.tooManyColors){if(zn.length||Bn.length){Pn=new Uint8Array(8*In);for(var Hn=0;Hn<In;Hn++){var qn=zn[Hn];Pn[8*Hn]=mr[4*qn],Pn[8*Hn+1]=mr[4*qn+1],Pn[8*Hn+2]=mr[4*qn+2],Pn[8*Hn+3]=mr[4*qn+3];var Yn=Bn[Hn];Pn[8*Hn+4]=mr[4*Yn],Pn[8*Hn+5]=mr[4*Yn+1],Pn[8*Hn+6]=mr[4*Yn+2],Pn[8*Hn+7]=mr[4*Yn+3]}}}else if(zn.length||Bn.length){Pn=new Uint8Array(4*In+2);for(var $n=0;$n<In;$n++)null!=zn[$n]&&(Pn[4*$n]=zn[$n]%dr,Pn[4*$n+1]=Math.floor(zn[$n]/dr)),null!=Bn[$n]&&(Pn[4*$n+2]=Bn[$n]%dr,Pn[4*$n+3]=Math.floor(Bn[$n]/dr))}Vn({data:Pn||new Uint8Array(0),type:"uint8",usage:"dynamic"})}return tt}))}},Scatter.prototype.addMarker=function(Ne){var Ge,Qe=this.markerTextures,tt=this.regl,rt=this.markerCache,nt=null==Ne?0:rt.indexOf(Ne);if(nt>=0)return nt;if(Ne instanceof Uint8Array||Ne instanceof Uint8ClampedArray)Ge=Ne;else{Ge=new Uint8Array(Ne.length);for(var at=0,it=Ne.length;at<it;at++)Ge[at]=255*Ne[at]}var ot=Math.floor(Math.sqrt(Ge.length));return nt=Qe.length,rt.push(Ne),Qe.push(tt.texture({channels:1,data:Ge,radius:ot,mag:"linear",min:"linear"})),nt},Scatter.prototype.updateColor=function(Ne){var Ge=this.paletteIds,Qe=this.palette,rt=this.maxColors;Array.isArray(Ne)||(Ne=[Ne]);var at=[];if("number"==typeof Ne[0]){var it=[];if(Array.isArray(Ne))for(var ot=0;ot<Ne.length;ot+=4)it.push(Ne.slice(ot,ot+4));else for(var dt=0;dt<Ne.length;dt+=4)it.push(Ne.subarray(dt,dt+4));Ne=it}for(var ht=0;ht<Ne.length;ht++){var Dt=Ne[ht];Dt=tt(Dt,"uint8");var Ot=nt(Dt,!1);if(null==Ge[Ot]){var Rt=Qe.length;Ge[Ot]=Math.floor(Rt/4),Qe[Rt]=Dt[0],Qe[Rt+1]=Dt[1],Qe[Rt+2]=Dt[2],Qe[Rt+3]=Dt[3]}at[ht]=Ge[Ot]}return!this.tooManyColors&&Qe.length>4*rt&&(this.tooManyColors=!0),this.updatePalette(Qe),1===at.length?at[0]:at},Scatter.prototype.updatePalette=function(Ne){if(!this.tooManyColors){var Ge=this.maxColors,Qe=this.paletteTexture,tt=Math.ceil(.25*Ne.length/Ge);if(tt>1)for(var rt=.25*(Ne=Ne.slice()).length%Ge;rt<tt*Ge;rt++)Ne.push(0,0,0,0);Qe.height<tt&&Qe.resize(Ge,tt),Qe.subimage({width:Math.min(.25*Ne.length,Ge),height:tt,data:Ne},0,0)}},Scatter.prototype.destroy=function(){return this.groups.forEach((function(Ne){Ne.sizeBuffer.destroy(),Ne.positionBuffer.destroy(),Ne.positionFractBuffer.destroy(),Ne.colorBuffer.destroy(),Ne.activation.forEach((function(Ne){return Ne&&Ne.destroy&&Ne.destroy()})),Ne.selectionBuffer.destroy(),Ne.elements&&Ne.elements.destroy()})),this.groups.length=0,this.paletteTexture.destroy(),this.markerTextures.forEach((function(Ne){return Ne&&Ne.destroy&&Ne.destroy()})),this};var dr=Ne("object-assign"),reglScatter2d=function(Ne,Ge){var Qe=new er(Ne,Ge),tt=Qe.render.bind(Qe);return dr(tt,{render:tt,update:Qe.update.bind(Qe),draw:Qe.draw.bind(Qe),destroy:Qe.destroy.bind(Qe),regl:Qe.regl,gl:Qe.gl,canvas:Qe.gl.canvas,groups:Qe.groups,markers:Qe.markerCache,palette:Qe.palette}),tt};Ge.exports=reglScatter2d},{"@plotly/point-cluster":57,"array-bounds":70,"color-id":123,"color-normalize":125,"flatten-vertex-data":244,glslify:538,"is-iexplorer":466,"object-assign":499,"parse-rect":504,"pick-by-alias":511,"to-float32":577,"update-diff":599}],538:[function(Ne,Ge,Qe){arguments[4][257][0].apply(Qe,arguments)},{dup:257}],539:[function(Ne,Ge,Qe){"use strict";var tt=Ne("regl-scatter2d"),rt=Ne("pick-by-alias"),nt=Ne("array-bounds"),at=Ne("raf"),it=Ne("array-range"),ot=Ne("parse-rect"),dt=Ne("flatten-vertex-data");function SPLOM(Ne,Ge){if(!(this instanceof SPLOM))return new SPLOM(Ne,Ge);this.traces=[],this.passes={},this.regl=Ne,this.scatter=tt(Ne),this.canvas=this.scatter.canvas}function passId(Ne,Ge,Qe){return(null!=Ne.id?Ne.id:Ne)<<16|(255&Ge)<<8|255&Qe}function getBox(Ne,Ge,Qe){var tt,rt,nt,at,it=Ne[Ge],ot=Ne[Qe];return it.length>2?(it[0],it[2],tt=it[1],rt=it[3]):it.length?(tt=it[0],rt=it[1]):(it.x,tt=it.y,it.x,it.width,rt=it.y+it.height),ot.length>2?(nt=ot[0],at=ot[2],ot[1],ot[3]):ot.length?(nt=ot[0],at=ot[1]):(nt=ot.x,ot.y,at=ot.x+ot.width,ot.y,ot.height),[nt,tt,at,rt]}function getPad(Ne){if("number"==typeof Ne)return[Ne,Ne,Ne,Ne];if(2===Ne.length)return[Ne[0],Ne[1],Ne[0],Ne[1]];var Ge=ot(Ne);return[Ge.x,Ge.y,Ge.x+Ge.width,Ge.y+Ge.height]}Ge.exports=SPLOM,SPLOM.prototype.render=function(){for(var Ne,Ge=this,Qe=[],tt=arguments.length;tt--;)Qe[tt]=arguments[tt];return Qe.length&&(Ne=this).update.apply(Ne,Qe),this.regl.attributes.preserveDrawingBuffer?this.draw():(this.dirty?null==this.planned&&(this.planned=at((function(){Ge.draw(),Ge.dirty=!0,Ge.planned=null}))):(this.draw(),this.dirty=!0,at((function(){Ge.dirty=!1}))),this)},SPLOM.prototype.update=function(){for(var Ne,Ge=[],Qe=arguments.length;Qe--;)Ge[Qe]=arguments[Qe];if(Ge.length){for(var tt=0;tt<Ge.length;tt++)this.updateItem(tt,Ge[tt]);this.traces=this.traces.filter(Boolean);for(var rt=[],nt=0,at=0;at<this.traces.length;at++){for(var it=this.traces[at],ot=this.traces[at].passes,dt=0;dt<ot.length;dt++)rt.push(this.passes[ot[dt]]);it.passOffset=nt,nt+=it.passes.length}return(Ne=this.scatter).update.apply(Ne,rt),this}},SPLOM.prototype.updateItem=function(Ne,Ge){var Qe=this.regl;if(null===Ge)return this.traces[Ne]=null,this;if(!Ge)return this;var tt,at=rt(Ge,{data:"data items columns rows values dimensions samples x",snap:"snap cluster",size:"sizes size radius",color:"colors color fill fill-color fillColor",opacity:"opacity alpha transparency opaque",borderSize:"borderSizes borderSize border-size bordersize borderWidth borderWidths border-width borderwidth stroke-width strokeWidth strokewidth outline",borderColor:"borderColors borderColor bordercolor stroke stroke-color strokeColor",marker:"markers marker shape",range:"range ranges databox dataBox",viewport:"viewport viewBox viewbox",domain:"domain domains area areas",padding:"pad padding paddings pads margin margins",transpose:"transpose transposed",diagonal:"diagonal diag showDiagonal",upper:"upper up top upperhalf upperHalf showupperhalf showUpper showUpperHalf",lower:"lower low bottom lowerhalf lowerHalf showlowerhalf showLowerHalf showLower"}),it=this.traces[Ne]||(this.traces[Ne]={id:Ne,buffer:Qe.buffer({usage:"dynamic",type:"float",data:new Uint8Array}),color:"black",marker:null,size:12,borderColor:"transparent",borderSize:1,viewport:ot([Qe._gl.drawingBufferWidth,Qe._gl.drawingBufferHeight]),padding:[0,0,0,0],opacity:1,diagonal:!0,upper:!0,lower:!0});if(null!=at.color&&(it.color=at.color),null!=at.size&&(it.size=at.size),null!=at.marker&&(it.marker=at.marker),null!=at.borderColor&&(it.borderColor=at.borderColor),null!=at.borderSize&&(it.borderSize=at.borderSize),null!=at.opacity&&(it.opacity=at.opacity),at.viewport&&(it.viewport=ot(at.viewport)),null!=at.diagonal&&(it.diagonal=at.diagonal),null!=at.upper&&(it.upper=at.upper),null!=at.lower&&(it.lower=at.lower),at.data){it.buffer(dt(at.data)),it.columns=at.data.length,it.count=at.data[0].length,it.bounds=[];for(var ht=0;ht<it.columns;ht++)it.bounds[ht]=nt(at.data[ht],1)}at.range&&(it.range=at.range,tt=it.range&&"number"!=typeof it.range[0]),at.domain&&(it.domain=at.domain);var Dt=!1;null!=at.padding&&(Array.isArray(at.padding)&&at.padding.length===it.columns&&"number"==typeof at.padding[at.padding.length-1]?(it.padding=at.padding.map(getPad),Dt=!0):it.padding=getPad(at.padding));var Ot=it.columns,Rt=it.count,Zt=it.viewport.width,er=it.viewport.height,dr=it.viewport.x,mr=it.viewport.y,xr=Zt/Ot,br=er/Ot;it.passes=[];for(var Ar=0;Ar<Ot;Ar++)for(var en=0;en<Ot;en++)if((it.diagonal||en!==Ar)&&(it.upper||!(Ar>en))&&(it.lower||!(Ar<en))){var mn=passId(it.id,Ar,en),xn=this.passes[mn]||(this.passes[mn]={});if(at.data&&(at.transpose?xn.positions={x:{buffer:it.buffer,offset:en,count:Rt,stride:Ot},y:{buffer:it.buffer,offset:Ar,count:Rt,stride:Ot}}:xn.positions={x:{buffer:it.buffer,offset:en*Rt,count:Rt},y:{buffer:it.buffer,offset:Ar*Rt,count:Rt}},xn.bounds=getBox(it.bounds,Ar,en)),at.domain||at.viewport||at.data){var kn=Dt?getBox(it.padding,Ar,en):it.padding;if(it.domain){var Cn=getBox(it.domain,Ar,en),En=Cn[0],Pn=Cn[1],Dn=Cn[2],In=Cn[3];xn.viewport=[dr+En*Zt+kn[0],mr+Pn*er+kn[1],dr+Dn*Zt-kn[2],mr+In*er-kn[3]]}else xn.viewport=[dr+en*xr+xr*kn[0],mr+Ar*br+br*kn[1],dr+(en+1)*xr-xr*kn[2],mr+(Ar+1)*br-br*kn[3]]}at.color&&(xn.color=it.color),at.size&&(xn.size=it.size),at.marker&&(xn.marker=it.marker),at.borderSize&&(xn.borderSize=it.borderSize),at.borderColor&&(xn.borderColor=it.borderColor),at.opacity&&(xn.opacity=it.opacity),at.range&&(xn.range=tt?getBox(it.range,Ar,en):it.range||xn.bounds),it.passes.push(mn)}return this},SPLOM.prototype.draw=function(){for(var Ne,Ge=[],Qe=arguments.length;Qe--;)Ge[Qe]=arguments[Qe];if(Ge.length){for(var tt=[],rt=0;rt<Ge.length;rt++)if("number"==typeof Ge[rt]){var nt=this.traces[Ge[rt]],at=nt.passes,ot=nt.passOffset;tt.push.apply(tt,it(ot,ot+at.length))}else if(Ge[rt].length){var dt=Ge[rt],ht=this.traces[rt],Dt=ht.passes,Ot=ht.passOffset;Dt=Dt.map((function(Ne,Ge){tt[Ot+Ge]=dt}))}(Ne=this.scatter).draw.apply(Ne,tt)}else this.scatter.draw();return this},SPLOM.prototype.destroy=function(){return this.traces.forEach((function(Ne){Ne.buffer&&Ne.buffer.destroy&&Ne.buffer.destroy()})),this.traces=null,this.passes=null,this.scatter.destroy(),this}},{"array-bounds":70,"array-range":72,"flatten-vertex-data":244,"parse-rect":504,"pick-by-alias":511,raf:528,"regl-scatter2d":537}],540:[function(Ne,Ge,Qe){var rt,nt;rt=this,nt=function(){function ja(Ge,Qe){this.id=Ne++,this.type=Ge,this.data=Qe}function N(Ne){if(0===Ne.length)return[];var Ge=Ne.charAt(0),Qe=Ne.charAt(Ne.length-1);if(1<Ne.length&&Ge===Qe&&('"'===Ge||"'"===Ge))return['"'+Ne.substr(1,Ne.length-2).replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];if(Ge=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(Ne))return N(Ne.substr(0,Ge.index)).concat(N(Ge[1])).concat(N(Ne.substr(Ge.index+Ge[0].length)));if(1===(Ge=Ne.split(".")).length)return['"'+Ne.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'];for(Ne=[],Qe=0;Qe<Ge.length;++Qe)Ne=Ne.concat(N(Ge[Qe]));return Ne}function bb(Ne){return"["+N(Ne).join("][")+"]"}function Cb(){var Ne={"":0},Ge=[""];return{id:function(Qe){var tt=Ne[Qe];return tt||(tt=Ne[Qe]=Ge.length,Ge.push(Qe),tt)},str:function(Ne){return Ge[Ne]}}}function Db(Ne,Ge,Qe){function e(){var Ge=window.innerWidth,tt=window.innerHeight;Ne!==document.body&&(Ge=(tt=Ne.getBoundingClientRect()).right-tt.left,tt=tt.bottom-tt.top),rt.width=Qe*Ge,rt.height=Qe*tt,H(rt.style,{width:Ge+"px",height:tt+"px"})}var tt,rt=document.createElement("canvas");return H(rt.style,{border:0,margin:0,padding:0,top:0,left:0}),Ne.appendChild(rt),Ne===document.body&&(rt.style.position="absolute",H(Ne.style,{margin:0,padding:0})),Ne!==document.body&&"function"==typeof ResizeObserver?(tt=new ResizeObserver((function(){setTimeout(e)}))).observe(Ne):window.addEventListener("resize",e,!1),e(),{canvas:rt,onDestroy:function(){tt?tt.disconnect():window.removeEventListener("resize",e),Ne.removeChild(rt)}}}function Eb(Ne,Ge){function c(Qe){try{return Ne.getContext(Qe,Ge)}catch(Ne){return null}}return c("webgl")||c("experimental-webgl")||c("webgl-experimental")}function cb(Ne){return"string"==typeof Ne?Ne.split():Ne}function db(Ne){return"string"==typeof Ne?document.querySelector(Ne):Ne}function Fb(Ne){var Ge,Qe,tt,rt,nt=Ne||{};Ne={};var at=[],it=[],ot="undefined"==typeof window?1:window.devicePixelRatio,dt=!1,t=function(Ne){},m=function(){};if("string"==typeof nt?Ge=document.querySelector(nt):"object"==typeof nt&&("string"==typeof nt.nodeName&&"function"==typeof nt.appendChild&&"function"==typeof nt.getBoundingClientRect?Ge=nt:"function"==typeof nt.drawArrays||"function"==typeof nt.drawElements?tt=(rt=nt).canvas:("gl"in nt?rt=nt.gl:"canvas"in nt?tt=db(nt.canvas):"container"in nt&&(Qe=db(nt.container)),"attributes"in nt&&(Ne=nt.attributes),"extensions"in nt&&(at=cb(nt.extensions)),"optionalExtensions"in nt&&(it=cb(nt.optionalExtensions)),"onDone"in nt&&(t=nt.onDone),"profile"in nt&&(dt=!!nt.profile),"pixelRatio"in nt&&(ot=+nt.pixelRatio))),Ge&&("canvas"===Ge.nodeName.toLowerCase()?tt=Ge:Qe=Ge),!rt){if(!tt){if(!(Ge=Db(Qe||document.body,t,ot)))return null;tt=Ge.canvas,m=Ge.onDestroy}void 0===Ne.premultipliedAlpha&&(Ne.premultipliedAlpha=!0),rt=Eb(tt,Ne)}return rt?{gl:rt,canvas:tt,container:Qe,extensions:at,optionalExtensions:it,pixelRatio:ot,profile:dt,onDone:t,onDestroy:m}:(m(),t("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function Gb(Ne,Ge){function c(Ge){var tt;Ge=Ge.toLowerCase();try{tt=Qe[Ge]=Ne.getExtension(Ge)}catch(Ne){}return!!tt}for(var Qe={},tt=0;tt<Ge.extensions.length;++tt){var rt=Ge.extensions[tt];if(!c(rt))return Ge.onDestroy(),Ge.onDone('"'+rt+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return Ge.optionalExtensions.forEach(c),{extensions:Qe,restore:function(){Object.keys(Qe).forEach((function(Ne){if(Qe[Ne]&&!c(Ne))throw Error("(regl): error restoring extension "+Ne)}))}}}function A(Ne,Ge){for(var Qe=Array(Ne),tt=0;tt<Ne;++tt)Qe[tt]=Ge(tt);return Qe}function eb(Ne){var Ge,Qe;return Ge=(65535<Ne)<<4,Ge|=Qe=(255<(Ne>>>=Ge))<<3,(Ge|=Qe=(15<(Ne>>>=Qe))<<2)|(Qe=(3<(Ne>>>=Qe))<<1)|Ne>>>Qe>>1}function fb(){function a(Ge){e:{for(var Qe=16;268435456>=Qe;Qe*=16)if(Ge<=Qe){Ge=Qe;break e}Ge=0}return 0<(Qe=Ne[eb(Ge)>>2]).length?Qe.pop():new ArrayBuffer(Ge)}function b(Ge){Ne[eb(Ge.byteLength)>>2].push(Ge)}var Ne=A(8,(function(){return[]}));return{alloc:a,free:b,allocType:function(Ne,Ge){var Qe=null;switch(Ne){case 5120:Qe=new Int8Array(a(Ge),0,Ge);break;case 5121:Qe=new Uint8Array(a(Ge),0,Ge);break;case 5122:Qe=new Int16Array(a(2*Ge),0,Ge);break;case 5123:Qe=new Uint16Array(a(2*Ge),0,Ge);break;case 5124:Qe=new Int32Array(a(4*Ge),0,Ge);break;case 5125:Qe=new Uint32Array(a(4*Ge),0,Ge);break;case 5126:Qe=new Float32Array(a(4*Ge),0,Ge);break;default:return null}return Qe.length!==Ge?Qe.subarray(0,Ge):Qe},freeType:function(Ne){b(Ne.buffer)}}}function X(Ne){return!!Ne&&"object"==typeof Ne&&Array.isArray(Ne.shape)&&Array.isArray(Ne.stride)&&"number"==typeof Ne.offset&&Ne.shape.length===Ne.stride.length&&(Array.isArray(Ne.data)||G(Ne.data))}function gb(Ne,Ge,Qe,tt,rt,nt){for(var at=0;at<Ge;++at)for(var it=Ne[at],ot=0;ot<Qe;++ot)for(var dt=it[ot],ht=0;ht<tt;++ht)rt[nt++]=dt[ht]}function hb(Ne,Ge,Qe,tt,rt){for(var nt=1,at=Qe+1;at<Ge.length;++at)nt*=Ge[at];var it=Ge[Qe];if(4==Ge.length-Qe){var ot=Ge[Qe+1],dt=Ge[Qe+2];for(Ge=Ge[Qe+3],at=0;at<it;++at)gb(Ne[at],ot,dt,Ge,tt,rt),rt+=nt}else for(at=0;at<it;++at)hb(Ne[at],Ge,Qe+1,tt,rt),rt+=nt}function Fa(Ne){return 0|at[Object.prototype.toString.call(Ne)]}function ib(Ne,Ge){for(var Qe=0;Qe<Ge.length;++Qe)Ne[Qe]=Ge[Qe]}function jb(Ne,Ge,Qe,tt,rt,nt,at){for(var it=0,ot=0;ot<Qe;++ot)for(var dt=0;dt<tt;++dt)Ne[it++]=Ge[rt*ot+nt*dt+at]}function Hb(Ne,Ge,Qe,tt){function g(Ge){this.id=nt++,this.buffer=Ne.createBuffer(),this.type=Ge,this.usage=35044,this.byteLength=0,this.dimension=1,this.dtype=5121,this.persistentData=null,Qe.profile&&(this.stats={size:0})}function d(Ge,Qe,tt){Ge.byteLength=Qe.byteLength,Ne.bufferData(Ge.type,Qe,tt)}function r(Ne,Ge,Qe,tt,nt,at){if(Ne.usage=Qe,Array.isArray(Ge)){if(Ne.dtype=tt||5126,0<Ge.length)if(Array.isArray(Ge[0])){nt=ht(Ge);for(var it=tt=1;it<nt.length;++it)tt*=nt[it];Ne.dimension=tt,d(Ne,Ge=dt(Ge,nt,Ne.dtype),Qe),at?Ne.persistentData=Ge:rt.freeType(Ge)}else"number"==typeof Ge[0]?(Ne.dimension=nt,ib(nt=rt.allocType(Ne.dtype,Ge.length),Ge),d(Ne,nt,Qe),at?Ne.persistentData=nt:rt.freeType(nt)):G(Ge[0])&&(Ne.dimension=Ge[0].length,Ne.dtype=tt||Fa(Ge[0])||5126,d(Ne,Ge=dt(Ge,[Ge.length,Ge[0].length],Ne.dtype),Qe),at?Ne.persistentData=Ge:rt.freeType(Ge))}else if(G(Ge))Ne.dtype=tt||Fa(Ge),Ne.dimension=nt,d(Ne,Ge,Qe),at&&(Ne.persistentData=new Uint8Array(new Uint8Array(Ge.buffer)));else if(X(Ge)){nt=Ge.shape;var ot=Ge.stride,Dt=(it=Ge.offset,0),Ot=0,Rt=0,Zt=0;1===nt.length?(Dt=nt[0],Ot=1,Rt=ot[0],Zt=0):2===nt.length&&(Dt=nt[0],Ot=nt[1],Rt=ot[0],Zt=ot[1]),Ne.dtype=tt||Fa(Ge.data)||5126,Ne.dimension=Ot,jb(nt=rt.allocType(Ne.dtype,Dt*Ot),Ge.data,Dt,Ot,Rt,Zt,it),d(Ne,nt,Qe),at?Ne.persistentData=nt:rt.freeType(nt)}else Ge instanceof ArrayBuffer&&(Ne.dtype=5121,Ne.dimension=nt,d(Ne,Ge,Qe),at&&(Ne.persistentData=new Uint8Array(new Uint8Array(Ge))))}function n(Qe){Ge.bufferCount--,tt(Qe),Ne.deleteBuffer(Qe.buffer),Qe.buffer=null,delete at[Qe.id]}var nt=0,at={};g.prototype.bind=function(){Ne.bindBuffer(this.type,this.buffer)},g.prototype.destroy=function(){n(this)};var Ot=[];return Qe.profile&&(Ge.getTotalBufferSize=function(){var Ne=0;return Object.keys(at).forEach((function(Ge){Ne+=at[Ge].stats.size})),Ne}),{create:function(tt,nt,Ot,Rt){function f(Ge){var tt=35044,rt=null,nt=0,at=0,dt=1;return Array.isArray(Ge)||G(Ge)||X(Ge)||Ge instanceof ArrayBuffer?rt=Ge:"number"==typeof Ge?nt=0|Ge:Ge&&("data"in Ge&&(rt=Ge.data),"usage"in Ge&&(tt=ot[Ge.usage]),"type"in Ge&&(at=it[Ge.type]),"dimension"in Ge&&(dt=0|Ge.dimension),"length"in Ge&&(nt=0|Ge.length)),Zt.bind(),rt?r(Zt,rt,tt,at,dt,Rt):(nt&&Ne.bufferData(Zt.type,nt,tt),Zt.dtype=at||5121,Zt.usage=tt,Zt.dimension=dt,Zt.byteLength=nt),Qe.profile&&(Zt.stats.size=Zt.byteLength*Dt[Zt.dtype]),f}Ge.bufferCount++;var Zt=new g(nt);return at[Zt.id]=Zt,Ot||f(tt),f._reglType="buffer",f._buffer=Zt,f.subdata=function(Ge,Qe){var tt,nt=0|(Qe||0);if(Zt.bind(),G(Ge)||Ge instanceof ArrayBuffer)Ne.bufferSubData(Zt.type,nt,Ge);else if(Array.isArray(Ge)){if(0<Ge.length)if("number"==typeof Ge[0]){var at=rt.allocType(Zt.dtype,Ge.length);ib(at,Ge),Ne.bufferSubData(Zt.type,nt,at),rt.freeType(at)}else(Array.isArray(Ge[0])||G(Ge[0]))&&(tt=ht(Ge),at=dt(Ge,tt,Zt.dtype),Ne.bufferSubData(Zt.type,nt,at),rt.freeType(at))}else if(X(Ge)){tt=Ge.shape;var it=Ge.stride,ot=at=0,Dt=0,Ot=0;1===tt.length?(at=tt[0],ot=1,Dt=it[0],Ot=0):2===tt.length&&(at=tt[0],ot=tt[1],Dt=it[0],Ot=it[1]),tt=Array.isArray(Ge.data)?Zt.dtype:Fa(Ge.data),jb(tt=rt.allocType(tt,at*ot),Ge.data,at,ot,Dt,Ot,Ge.offset),Ne.bufferSubData(Zt.type,nt,tt),rt.freeType(tt)}return f},Qe.profile&&(f.stats=Zt.stats),f.destroy=function(){n(Zt)},f},createStream:function(Ne,Ge){var Qe=Ot.pop();return Qe||(Qe=new g(Ne)),Qe.bind(),r(Qe,Ge,35040,0,1,!1),Qe},destroyStream:function(Ne){Ot.push(Ne)},clear:function(){J(at).forEach(n),Ot.forEach(n)},getBuffer:function(Ne){return Ne&&Ne._buffer instanceof g?Ne._buffer:null},restore:function(){J(at).forEach((function(Ge){Ge.buffer=Ne.createBuffer(),Ne.bindBuffer(Ge.type,Ge.buffer),Ne.bufferData(Ge.type,Ge.persistentData||Ge.byteLength,Ge.usage)}))},_initBuffer:r}}function Ib(Ne,Ge,Qe,tt){function g(Ne){this.id=nt++,rt[this.id]=this,this.buffer=Ne,this.primType=4,this.type=this.vertCount=0}function d(tt,rt,nt,at,it,ot,dt){var ht;if(tt.buffer.bind(),rt?((ht=dt)||G(rt)&&(!X(rt)||G(rt.data))||(ht=Ge.oes_element_index_uint?5125:5123),Qe._initBuffer(tt.buffer,rt,nt,ht,3)):(Ne.bufferData(34963,ot,nt),tt.buffer.dtype=ht||5121,tt.buffer.usage=nt,tt.buffer.dimension=3,tt.buffer.byteLength=ot),ht=dt,!dt){switch(tt.buffer.dtype){case 5121:case 5120:ht=5121;break;case 5123:case 5122:ht=5123;break;case 5125:case 5124:ht=5125}tt.buffer.dtype=ht}tt.type=ht,0>(rt=it)&&(rt=tt.buffer.byteLength,5123===ht?rt>>=1:5125===ht&&(rt>>=2)),tt.vertCount=rt,rt=at,0>at&&(rt=4,1===(at=tt.buffer.dimension)&&(rt=0),2===at&&(rt=1),3===at&&(rt=4)),tt.primType=rt}function r(Ne){tt.elementsCount--,delete rt[Ne.id],Ne.buffer.destroy(),Ne.buffer=null}var rt={},nt=0,at={uint8:5121,uint16:5123};Ge.oes_element_index_uint&&(at.uint32=5125),g.prototype.bind=function(){this.buffer.bind()};var it=[];return{create:function(Ne,Ge){function k(Ne){if(Ne)if("number"==typeof Ne)rt(Ne),nt.primType=4,nt.vertCount=0|Ne,nt.type=5121;else{var Ge=null,Qe=35044,tt=-1,it=-1,dt=0,ht=0;Array.isArray(Ne)||G(Ne)||X(Ne)?Ge=Ne:("data"in Ne&&(Ge=Ne.data),"usage"in Ne&&(Qe=ot[Ne.usage]),"primitive"in Ne&&(tt=Ot[Ne.primitive]),"count"in Ne&&(it=0|Ne.count),"type"in Ne&&(ht=at[Ne.type]),"length"in Ne?dt=0|Ne.length:(dt=it,5123===ht||5122===ht?dt*=2:5125!==ht&&5124!==ht||(dt*=4))),d(nt,Ge,Qe,tt,it,dt,ht)}else rt(),nt.primType=4,nt.vertCount=0,nt.type=5121;return k}var rt=Qe.create(null,34963,!0),nt=new g(rt._buffer);return tt.elementsCount++,k(Ne),k._reglType="elements",k._elements=nt,k.subdata=function(Ne,Ge){return rt.subdata(Ne,Ge),k},k.destroy=function(){r(nt)},k},createStream:function(Ne){var Ge=it.pop();return Ge||(Ge=new g(Qe.create(null,34963,!0,!1)._buffer)),d(Ge,Ne,35040,-1,-1,0,0),Ge},destroyStream:function(Ne){it.push(Ne)},getElements:function(Ne){return"function"==typeof Ne&&Ne._elements instanceof g?Ne._elements:null},clear:function(){J(rt).forEach(r)}}}function nb(Ne){for(var Ge=rt.allocType(5123,Ne.length),Qe=0;Qe<Ne.length;++Qe)if(isNaN(Ne[Qe]))Ge[Qe]=65535;else if(1/0===Ne[Qe])Ge[Qe]=31744;else if(-1/0===Ne[Qe])Ge[Qe]=64512;else{Rt[0]=Ne[Qe];var tt=(at=Zt[0])>>>31<<15,nt=(at<<1>>>24)-127,at=at>>13&1023;Ge[Qe]=-24>nt?tt:-14>nt?tt+(at+1024>>-14-nt):15<nt?tt+31744:tt+(nt+15<<10)+at}return Ge}function na(Ne){return Array.isArray(Ne)||G(Ne)}function ka(Ne){return"[object "+Ne+"]"}function pb(Ne){return Array.isArray(Ne)&&(0===Ne.length||"number"==typeof Ne[0])}function qb(Ne){return!(!Array.isArray(Ne)||0===Ne.length||!na(Ne[0]))}function Y(Ne){return Object.prototype.toString.call(Ne)}function Ta(Ne){if(!Ne)return!1;var Ge=Y(Ne);return 0<=kn.indexOf(Ge)||pb(Ne)||qb(Ne)||X(Ne)}function rb(Ne,Ge){36193===Ne.type?(Ne.data=nb(Ge),rt.freeType(Ge)):Ne.data=Ge}function Ia(Ne,Ge,Qe,tt,rt,nt){if(Ne=void 0!==En[Ne]?En[Ne]:mr[Ne]*Cn[Ge],nt&&(Ne*=6),rt){for(tt=0;1<=Qe;)tt+=Ne*Qe*Qe,Qe/=2;return tt}return Ne*Qe*tt}function Lb(Ne,Ge,Qe,tt,it,ot,dt){function n(){this.format=this.internalformat=6408,this.type=5121,this.flipY=this.premultiplyAlpha=this.compressed=!1,this.unpackAlignment=1,this.colorSpace=37444,this.channels=this.height=this.width=0}function u(Ne,Ge){Ne.internalformat=Ge.internalformat,Ne.format=Ge.format,Ne.type=Ge.type,Ne.compressed=Ge.compressed,Ne.premultiplyAlpha=Ge.premultiplyAlpha,Ne.flipY=Ge.flipY,Ne.unpackAlignment=Ge.unpackAlignment,Ne.colorSpace=Ge.colorSpace,Ne.width=Ge.width,Ne.height=Ge.height,Ne.channels=Ge.channels}function q(Ne,Ge){if("object"==typeof Ge&&Ge){"premultiplyAlpha"in Ge&&(Ne.premultiplyAlpha=Ge.premultiplyAlpha),"flipY"in Ge&&(Ne.flipY=Ge.flipY),"alignment"in Ge&&(Ne.unpackAlignment=Ge.alignment),"colorSpace"in Ge&&(Ne.colorSpace=Zt[Ge.colorSpace]),"type"in Ge&&(Ne.type=kn[Ge.type]);var Qe=Ne.width,tt=Ne.height,rt=Ne.channels,nt=!1;"shape"in Ge?(Qe=Ge.shape[0],tt=Ge.shape[1],3===Ge.shape.length&&(rt=Ge.shape[2],nt=!0)):("radius"in Ge&&(Qe=tt=Ge.radius),"width"in Ge&&(Qe=Ge.width),"height"in Ge&&(tt=Ge.height),"channels"in Ge&&(rt=Ge.channels,nt=!0)),Ne.width=0|Qe,Ne.height=0|tt,Ne.channels=0|rt,Qe=!1,"format"in Ge&&(Qe=Ge.format,tt=Ne.internalformat=Cn[Qe],Ne.format=qn[tt],Qe in kn&&!("type"in Ge)&&(Ne.type=kn[Qe]),Qe in En&&(Ne.compressed=!0),Qe=!0),!nt&&Qe?Ne.channels=mr[Ne.format]:nt&&!Qe&&Ne.channels!==dr[Ne.format]&&(Ne.format=Ne.internalformat=dr[Ne.channels])}}function t(Ge){Ne.pixelStorei(37440,Ge.flipY),Ne.pixelStorei(37441,Ge.premultiplyAlpha),Ne.pixelStorei(37443,Ge.colorSpace),Ne.pixelStorei(3317,Ge.unpackAlignment)}function m(){n.call(this),this.yOffset=this.xOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function F(Ne,Ge){var Qe=null;if(Ta(Ge)?Qe=Ge:Ge&&(q(Ne,Ge),"x"in Ge&&(Ne.xOffset=0|Ge.x),"y"in Ge&&(Ne.yOffset=0|Ge.y),Ta(Ge.data)&&(Qe=Ge.data)),Ge.copy){var tt=it.viewportWidth,ot=it.viewportHeight;Ne.width=Ne.width||tt-Ne.xOffset,Ne.height=Ne.height||ot-Ne.yOffset,Ne.needsCopy=!0}else if(Qe){if(G(Qe))Ne.channels=Ne.channels||4,Ne.data=Qe,"type"in Ge||5121!==Ne.type||(Ne.type=0|at[Object.prototype.toString.call(Qe)]);else if(pb(Qe)){switch(Ne.channels=Ne.channels||4,ot=(tt=Qe).length,Ne.type){case 5121:case 5123:case 5125:case 5126:(ot=rt.allocType(Ne.type,ot)).set(tt),Ne.data=ot;break;case 36193:Ne.data=nb(tt)}Ne.alignment=1,Ne.needsFree=!0}else if(X(Qe)){tt=Qe.data,Array.isArray(tt)||5121!==Ne.type||(Ne.type=0|at[Object.prototype.toString.call(tt)]),ot=Qe.shape;var dt,ht,Dt,Ot,Rt=Qe.stride;3===ot.length?(Dt=ot[2],Ot=Rt[2]):Ot=Dt=1,dt=ot[0],ht=ot[1],ot=Rt[0],Rt=Rt[1],Ne.alignment=1,Ne.width=dt,Ne.height=ht,Ne.channels=Dt,Ne.format=Ne.internalformat=dr[Dt],Ne.needsFree=!0,dt=Ot,Qe=Qe.offset,Dt=Ne.width,Ot=Ne.height,ht=Ne.channels;for(var Zt=rt.allocType(36193===Ne.type?5126:Ne.type,Dt*Ot*ht),er=0,mr=0;mr<Ot;++mr)for(var kn=0;kn<Dt;++kn)for(var Cn=0;Cn<ht;++Cn)Zt[er++]=tt[ot*kn+Rt*mr+dt*Cn+Qe];rb(Ne,Zt)}else if(Y(Qe)===xr||Y(Qe)===br||Y(Qe)===Ar)Y(Qe)===xr||Y(Qe)===br?Ne.element=Qe:Ne.element=Qe.canvas,Ne.width=Ne.element.width,Ne.height=Ne.element.height,Ne.channels=4;else if(Y(Qe)===en)Ne.element=Qe,Ne.width=Qe.width,Ne.height=Qe.height,Ne.channels=4;else if(Y(Qe)===mn)Ne.element=Qe,Ne.width=Qe.naturalWidth,Ne.height=Qe.naturalHeight,Ne.channels=4;else if(Y(Qe)===xn)Ne.element=Qe,Ne.width=Qe.videoWidth,Ne.height=Qe.videoHeight,Ne.channels=4;else if(qb(Qe)){for(tt=Ne.width||Qe[0].length,ot=Ne.height||Qe.length,Rt=Ne.channels,Rt=na(Qe[0][0])?Rt||Qe[0][0].length:Rt||1,dt=nt.shape(Qe),Dt=1,Ot=0;Ot<dt.length;++Ot)Dt*=dt[Ot];Dt=rt.allocType(36193===Ne.type?5126:Ne.type,Dt),nt.flatten(Qe,dt,"",Dt),rb(Ne,Dt),Ne.alignment=1,Ne.width=tt,Ne.height=ot,Ne.channels=Rt,Ne.format=Ne.internalformat=dr[Rt],Ne.needsFree=!0}}else Ne.width=Ne.width||1,Ne.height=Ne.height||1,Ne.channels=Ne.channels||4}function k(Ge,Qe,rt,nt,at){var it=Ge.element,ot=Ge.data,dt=Ge.internalformat,ht=Ge.format,Dt=Ge.type,Ot=Ge.width,Rt=Ge.height;t(Ge),it?Ne.texSubImage2D(Qe,at,rt,nt,ht,Dt,it):Ge.compressed?Ne.compressedTexSubImage2D(Qe,at,rt,nt,dt,Ot,Rt,ot):Ge.needsCopy?(tt(),Ne.copyTexSubImage2D(Qe,at,rt,nt,Ge.xOffset,Ge.yOffset,Ot,Rt)):Ne.texSubImage2D(Qe,at,rt,nt,Ot,Rt,ht,Dt,ot)}function h(){return Yn.pop()||new m}function f(Ne){Ne.needsFree&&rt.freeType(Ne.data),m.call(Ne),Yn.push(Ne)}function p(){n.call(this),this.genMipmaps=!1,this.mipmapHint=4352,this.mipmask=0,this.images=Array(16)}function l(Ne,Ge,Qe){var tt=Ne.images[0]=h();Ne.mipmask=1,tt.width=Ne.width=Ge,tt.height=Ne.height=Qe,tt.channels=Ne.channels=4}function v(Ne,Ge){var Qe=null;if(Ta(Ge))u(Qe=Ne.images[0]=h(),Ne),F(Qe,Ge),Ne.mipmask=1;else if(q(Ne,Ge),Array.isArray(Ge.mipmap))for(var tt=Ge.mipmap,rt=0;rt<tt.length;++rt)u(Qe=Ne.images[rt]=h(),Ne),Qe.width>>=rt,Qe.height>>=rt,F(Qe,tt[rt]),Ne.mipmask|=1<<rt;else u(Qe=Ne.images[0]=h(),Ne),F(Qe,Ge),Ne.mipmask=1;u(Ne,Ne.images[0])}function Q(Ge,Qe){for(var rt=Ge.images,nt=0;nt<rt.length&&rt[nt];++nt){var at=rt[nt],it=Qe,ot=nt,dt=at.element,ht=at.data,Dt=at.internalformat,Ot=at.format,Rt=at.type,Zt=at.width,er=at.height;t(at),dt?Ne.texImage2D(it,ot,Ot,Ot,Rt,dt):at.compressed?Ne.compressedTexImage2D(it,ot,Dt,Zt,er,0,ht):at.needsCopy?(tt(),Ne.copyTexImage2D(it,ot,Ot,at.xOffset,at.yOffset,Zt,er,0)):Ne.texImage2D(it,ot,Ot,Zt,er,0,Ot,Rt,ht||null)}}function C(){var Ne=$n.pop()||new p;n.call(Ne);for(var Ge=Ne.mipmask=0;16>Ge;++Ge)Ne.images[Ge]=null;return Ne}function va(Ne){for(var Ge=Ne.images,Qe=0;Qe<Ge.length;++Qe)Ge[Qe]&&f(Ge[Qe]),Ge[Qe]=null;$n.push(Ne)}function ea(){this.magFilter=this.minFilter=9728,this.wrapT=this.wrapS=33071,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=4352}function mb(Ne,Ge){"min"in Ge&&(Ne.minFilter=Rt[Ge.min],0<=er.indexOf(Ne.minFilter)&&!("faces"in Ge)&&(Ne.genMipmaps=!0)),"mag"in Ge&&(Ne.magFilter=Ot[Ge.mag]);var Qe=Ne.wrapS,tt=Ne.wrapT;if("wrap"in Ge){var rt=Ge.wrap;"string"==typeof rt?Qe=tt=Dt[rt]:Array.isArray(rt)&&(Qe=Dt[rt[0]],tt=Dt[rt[1]])}else"wrapS"in Ge&&(Qe=Dt[Ge.wrapS]),"wrapT"in Ge&&(tt=Dt[Ge.wrapT]);if(Ne.wrapS=Qe,Ne.wrapT=tt,"anisotropic"in Ge&&(Ne.anisotropic=Ge.anisotropic),"mipmap"in Ge){switch(Qe=!1,typeof Ge.mipmap){case"string":Ne.mipmapHint=ht[Ge.mipmap],Qe=Ne.genMipmaps=!0;break;case"boolean":Qe=Ne.genMipmaps=Ge.mipmap;break;case"object":Ne.genMipmaps=!1,Qe=!0}!Qe||"min"in Ge||(Ne.minFilter=9984)}}function Ra(Qe,tt){Ne.texParameteri(tt,10241,Qe.minFilter),Ne.texParameteri(tt,10240,Qe.magFilter),Ne.texParameteri(tt,10242,Qe.wrapS),Ne.texParameteri(tt,10243,Qe.wrapT),Ge.ext_texture_filter_anisotropic&&Ne.texParameteri(tt,34046,Qe.anisotropic),Qe.genMipmaps&&(Ne.hint(33170,Qe.mipmapHint),Ne.generateMipmap(tt))}function R(Ge){n.call(this),this.mipmask=0,this.internalformat=6408,this.id=ra++,this.refCount=1,this.target=Ge,this.texture=Ne.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new ea,dt.profile&&(this.stats={size:0})}function sa(Ge){Ne.activeTexture(33984),Ne.bindTexture(Ge.target,Ge.texture)}function za(){var Ge=ga[0];Ge?Ne.bindTexture(Ge.target,Ge.texture):Ne.bindTexture(3553,null)}function D(Ge){var Qe=Ge.texture,tt=Ge.unit,rt=Ge.target;0<=tt&&(Ne.activeTexture(33984+tt),Ne.bindTexture(rt,null),ga[tt]=null),Ne.deleteTexture(Qe),Ge.texture=null,Ge.params=null,Ge.pixels=null,Ge.refCount=0,delete oa[Ge.id],ot.textureCount--}var ht={"don't care":4352,"dont care":4352,nice:4354,fast:4353},Dt={repeat:10497,clamp:33071,mirror:33648},Ot={nearest:9728,linear:9729},Rt=H({mipmap:9987,"nearest mipmap nearest":9984,"linear mipmap nearest":9985,"nearest mipmap linear":9986,"linear mipmap linear":9987},Ot),Zt={none:0,browser:37444},kn={uint8:5121,rgba4:32819,rgb565:33635,"rgb5 a1":32820},Cn={alpha:6406,luminance:6409,"luminance alpha":6410,rgb:6407,rgba:6408,rgba4:32854,"rgb5 a1":32855,rgb565:36194},En={};Ge.ext_srgb&&(Cn.srgb=35904,Cn.srgba=35906),Ge.oes_texture_float&&(kn.float32=kn.float=5126),Ge.oes_texture_half_float&&(kn.float16=kn["half float"]=36193),Ge.webgl_depth_texture&&(H(Cn,{depth:6402,"depth stencil":34041}),H(kn,{uint16:5123,uint32:5125,"depth stencil":34042})),Ge.webgl_compressed_texture_s3tc&&H(En,{"rgb s3tc dxt1":33776,"rgba s3tc dxt1":33777,"rgba s3tc dxt3":33778,"rgba s3tc dxt5":33779}),Ge.webgl_compressed_texture_atc&&H(En,{"rgb atc":35986,"rgba atc explicit alpha":35987,"rgba atc interpolated alpha":34798}),Ge.webgl_compressed_texture_pvrtc&&H(En,{"rgb pvrtc 4bppv1":35840,"rgb pvrtc 2bppv1":35841,"rgba pvrtc 4bppv1":35842,"rgba pvrtc 2bppv1":35843}),Ge.webgl_compressed_texture_etc1&&(En["rgb etc1"]=36196);var Pn=Array.prototype.slice.call(Ne.getParameter(34467));Object.keys(En).forEach((function(Ne){var Ge=En[Ne];0<=Pn.indexOf(Ge)&&(Cn[Ne]=Ge)}));var Dn=Object.keys(Cn);Qe.textureFormats=Dn;var In=[];Object.keys(Cn).forEach((function(Ne){In[Cn[Ne]]=Ne}));var zn=[];Object.keys(kn).forEach((function(Ne){zn[kn[Ne]]=Ne}));var Bn=[];Object.keys(Ot).forEach((function(Ne){Bn[Ot[Ne]]=Ne}));var Vn=[];Object.keys(Rt).forEach((function(Ne){Vn[Rt[Ne]]=Ne}));var Hn=[];Object.keys(Dt).forEach((function(Ne){Hn[Dt[Ne]]=Ne}));var qn=Dn.reduce((function(Ne,Qe){var tt=Cn[Qe];return 6409===tt||6406===tt||6409===tt||6410===tt||6402===tt||34041===tt||Ge.ext_srgb&&(35904===tt||35906===tt)?Ne[tt]=tt:32855===tt||0<=Qe.indexOf("rgba")?Ne[tt]=6408:Ne[tt]=6407,Ne}),{}),Yn=[],$n=[],ra=0,oa={},pa=Qe.maxTextureUnits,ga=Array(pa).map((function(){return null}));return H(R.prototype,{bind:function(){this.bindCount+=1;var Ge=this.unit;if(0>Ge){for(var Qe=0;Qe<pa;++Qe){var tt=ga[Qe];if(tt){if(0<tt.bindCount)continue;tt.unit=-1}ga[Qe]=this,Ge=Qe;break}dt.profile&&ot.maxTextureUnits<Ge+1&&(ot.maxTextureUnits=Ge+1),this.unit=Ge,Ne.activeTexture(33984+Ge),Ne.bindTexture(this.target,this.texture)}return Ge},unbind:function(){--this.bindCount},decRef:function(){0>=--this.refCount&&D(this)}}),dt.profile&&(ot.getTotalTextureSize=function(){var Ne=0;return Object.keys(oa).forEach((function(Ge){Ne+=oa[Ge].stats.size})),Ne}),{create2D:function(Ge,Qe){function e(Ne,Ge){var Qe=tt.texInfo;ea.call(Qe);var rt=C();return"number"==typeof Ne?l(rt,0|Ne,"number"==typeof Ge?0|Ge:0|Ne):Ne?(mb(Qe,Ne),v(rt,Ne)):l(rt,1,1),Qe.genMipmaps&&(rt.mipmask=(rt.width<<1)-1),tt.mipmask=rt.mipmask,u(tt,rt),tt.internalformat=rt.internalformat,e.width=rt.width,e.height=rt.height,sa(tt),Q(rt,3553),Ra(Qe,3553),za(),va(rt),dt.profile&&(tt.stats.size=Ia(tt.internalformat,tt.type,rt.width,rt.height,Qe.genMipmaps,!1)),e.format=In[tt.internalformat],e.type=zn[tt.type],e.mag=Bn[Qe.magFilter],e.min=Vn[Qe.minFilter],e.wrapS=Hn[Qe.wrapS],e.wrapT=Hn[Qe.wrapT],e}var tt=new R(3553);return oa[tt.id]=tt,ot.textureCount++,e(Ge,Qe),e.subimage=function(Ne,Ge,Qe,rt){Ge|=0,Qe|=0,rt|=0;var nt=h();return u(nt,tt),nt.width=0,nt.height=0,F(nt,Ne),nt.width=nt.width||(tt.width>>rt)-Ge,nt.height=nt.height||(tt.height>>rt)-Qe,sa(tt),k(nt,3553,Ge,Qe,rt),za(),f(nt),e},e.resize=function(Ge,Qe){var rt=0|Ge,nt=0|Qe||rt;if(rt===tt.width&&nt===tt.height)return e;e.width=tt.width=rt,e.height=tt.height=nt,sa(tt);for(var at=0;tt.mipmask>>at;++at){var it=rt>>at,ot=nt>>at;if(!it||!ot)break;Ne.texImage2D(3553,at,tt.format,it,ot,0,tt.format,tt.type,null)}return za(),dt.profile&&(tt.stats.size=Ia(tt.internalformat,tt.type,rt,nt,!1,!1)),e},e._reglType="texture2d",e._texture=tt,dt.profile&&(e.stats=tt.stats),e.destroy=function(){tt.decRef()},e},createCube:function(Ge,Qe,tt,rt,nt,at){function m(Ne,Ge,Qe,tt,rt,nt){var at,ot=it.texInfo;for(ea.call(ot),at=0;6>at;++at)ht[at]=C();if("number"!=typeof Ne&&Ne){if("object"==typeof Ne)if(Ge)v(ht[0],Ne),v(ht[1],Ge),v(ht[2],Qe),v(ht[3],tt),v(ht[4],rt),v(ht[5],nt);else if(mb(ot,Ne),q(it,Ne),"faces"in Ne)for(Ne=Ne.faces,at=0;6>at;++at)u(ht[at],it),v(ht[at],Ne[at]);else for(at=0;6>at;++at)v(ht[at],Ne)}else for(Ne=0|Ne||1,at=0;6>at;++at)l(ht[at],Ne,Ne);for(u(it,ht[0]),it.mipmask=ot.genMipmaps?(ht[0].width<<1)-1:ht[0].mipmask,it.internalformat=ht[0].internalformat,m.width=ht[0].width,m.height=ht[0].height,sa(it),at=0;6>at;++at)Q(ht[at],34069+at);for(Ra(ot,34067),za(),dt.profile&&(it.stats.size=Ia(it.internalformat,it.type,m.width,m.height,ot.genMipmaps,!0)),m.format=In[it.internalformat],m.type=zn[it.type],m.mag=Bn[ot.magFilter],m.min=Vn[ot.minFilter],m.wrapS=Hn[ot.wrapS],m.wrapT=Hn[ot.wrapT],at=0;6>at;++at)va(ht[at]);return m}var it=new R(34067);oa[it.id]=it,ot.cubeCount++;var ht=Array(6);return m(Ge,Qe,tt,rt,nt,at),m.subimage=function(Ne,Ge,Qe,tt,rt){Qe|=0,tt|=0,rt|=0;var nt=h();return u(nt,it),nt.width=0,nt.height=0,F(nt,Ge),nt.width=nt.width||(it.width>>rt)-Qe,nt.height=nt.height||(it.height>>rt)-tt,sa(it),k(nt,34069+Ne,Qe,tt,rt),za(),f(nt),m},m.resize=function(Ge){if((Ge|=0)!==it.width){m.width=it.width=Ge,m.height=it.height=Ge,sa(it);for(var Qe=0;6>Qe;++Qe)for(var tt=0;it.mipmask>>tt;++tt)Ne.texImage2D(34069+Qe,tt,it.format,Ge>>tt,Ge>>tt,0,it.format,it.type,null);return za(),dt.profile&&(it.stats.size=Ia(it.internalformat,it.type,m.width,m.height,!1,!0)),m}},m._reglType="textureCube",m._texture=it,dt.profile&&(m.stats=it.stats),m.destroy=function(){it.decRef()},m},clear:function(){for(var Ge=0;Ge<pa;++Ge)Ne.activeTexture(33984+Ge),Ne.bindTexture(3553,null),ga[Ge]=null;J(oa).forEach(D),ot.cubeCount=0,ot.textureCount=0},getTexture:function(Ne){return null},restore:function(){for(var Ge=0;Ge<pa;++Ge){var Qe=ga[Ge];Qe&&(Qe.bindCount=0,Qe.unit=-1,ga[Ge]=null)}J(oa).forEach((function(Ge){Ge.texture=Ne.createTexture(),Ne.bindTexture(Ge.target,Ge.texture);for(var Qe=0;32>Qe;++Qe)if(0!=(Ge.mipmask&1<<Qe))if(3553===Ge.target)Ne.texImage2D(3553,Qe,Ge.internalformat,Ge.width>>Qe,Ge.height>>Qe,0,Ge.internalformat,Ge.type,null);else for(var tt=0;6>tt;++tt)Ne.texImage2D(34069+tt,Qe,Ge.internalformat,Ge.width>>Qe,Ge.height>>Qe,0,Ge.internalformat,Ge.type,null);Ra(Ge.texInfo,Ge.target)}))}}}function Ob(Ne,Ge,Qe,tt,rt,nt){function r(Ne,Ge,Qe){this.target=Ne,this.texture=Ge,this.renderbuffer=Qe;var tt=Ne=0;Ge?(Ne=Ge.width,tt=Ge.height):Qe&&(Ne=Qe.width,tt=Qe.height),this.width=Ne,this.height=tt}function n(Ne){Ne&&(Ne.texture&&Ne.texture._texture.decRef(),Ne.renderbuffer&&Ne.renderbuffer._renderbuffer.decRef())}function u(Ne,Ge,Qe){Ne&&(Ne.texture?Ne.texture._texture.refCount+=1:Ne.renderbuffer._renderbuffer.refCount+=1)}function q(Ge,Qe){Qe&&(Qe.texture?Ne.framebufferTexture2D(36160,Ge,Qe.target,Qe.texture._texture.texture,0):Ne.framebufferRenderbuffer(36160,Ge,36161,Qe.renderbuffer._renderbuffer.renderbuffer))}function t(Ne){var Ge=3553,Qe=null,tt=null,rt=Ne;return"object"==typeof Ne&&(rt=Ne.data,"target"in Ne&&(Ge=0|Ne.target)),"texture2d"===(Ne=rt._reglType)||"textureCube"===Ne?Qe=rt:"renderbuffer"===Ne&&(tt=rt,Ge=36161),new r(Ge,Qe,tt)}function m(Ne,Ge,Qe,nt,at){return Qe?((Ne=tt.create2D({width:Ne,height:Ge,format:nt,type:at}))._texture.refCount=0,new r(3553,Ne,null)):((Ne=rt.create({width:Ne,height:Ge,format:nt}))._renderbuffer.refCount=0,new r(36161,null,Ne))}function F(Ne){return Ne&&(Ne.texture||Ne.renderbuffer)}function k(Ne,Ge,Qe){Ne&&(Ne.texture?Ne.texture.resize(Ge,Qe):Ne.renderbuffer&&Ne.renderbuffer.resize(Ge,Qe),Ne.width=Ge,Ne.height=Qe)}function h(){this.id=ht++,Dt[this.id]=this,this.framebuffer=Ne.createFramebuffer(),this.height=this.width=0,this.colorAttachments=[],this.depthStencilAttachment=this.stencilAttachment=this.depthAttachment=null}function f(Ne){Ne.colorAttachments.forEach(n),n(Ne.depthAttachment),n(Ne.stencilAttachment),n(Ne.depthStencilAttachment)}function p(Ge){Ne.deleteFramebuffer(Ge.framebuffer),Ge.framebuffer=null,nt.framebufferCount--,delete Dt[Ge.id]}function l(Ge){var tt;Ne.bindFramebuffer(36160,Ge.framebuffer);var rt=Ge.colorAttachments;for(tt=0;tt<rt.length;++tt)q(36064+tt,rt[tt]);for(tt=rt.length;tt<Qe.maxColorAttachments;++tt)Ne.framebufferTexture2D(36160,36064+tt,3553,null,0);Ne.framebufferTexture2D(36160,33306,3553,null,0),Ne.framebufferTexture2D(36160,36096,3553,null,0),Ne.framebufferTexture2D(36160,36128,3553,null,0),q(36096,Ge.depthAttachment),q(36128,Ge.stencilAttachment),q(33306,Ge.depthStencilAttachment),Ne.checkFramebufferStatus(36160),Ne.isContextLost(),Ne.bindFramebuffer(36160,at.next?at.next.framebuffer:null),at.cur=at.next,Ne.getError()}function v(Ne,Ge){function c(Ne,Ge){var tt,rt=0,nt=0,at=!0,dt=!0;tt=null;var ht=!0,Dt="rgba",Ot="uint8",Rt=1,Zt=null,er=null,dr=null,mr=!1;"number"==typeof Ne?(rt=0|Ne,nt=0|Ge||rt):Ne?("shape"in Ne?(rt=(nt=Ne.shape)[0],nt=nt[1]):("radius"in Ne&&(rt=nt=Ne.radius),"width"in Ne&&(rt=Ne.width),"height"in Ne&&(nt=Ne.height)),("color"in Ne||"colors"in Ne)&&(tt=Ne.color||Ne.colors,Array.isArray(tt)),tt||("colorCount"in Ne&&(Rt=0|Ne.colorCount),"colorTexture"in Ne&&(ht=!!Ne.colorTexture,Dt="rgba4"),"colorType"in Ne&&(Ot=Ne.colorType,!ht)&&("half float"===Ot||"float16"===Ot?Dt="rgba16f":"float"!==Ot&&"float32"!==Ot||(Dt="rgba32f")),"colorFormat"in Ne&&(Dt=Ne.colorFormat,0<=it.indexOf(Dt)?ht=!0:0<=ot.indexOf(Dt)&&(ht=!1))),("depthTexture"in Ne||"depthStencilTexture"in Ne)&&(mr=!(!Ne.depthTexture&&!Ne.depthStencilTexture)),"depth"in Ne&&("boolean"==typeof Ne.depth?at=Ne.depth:(Zt=Ne.depth,dt=!1)),"stencil"in Ne&&("boolean"==typeof Ne.stencil?dt=Ne.stencil:(er=Ne.stencil,at=!1)),"depthStencil"in Ne&&("boolean"==typeof Ne.depthStencil?at=dt=Ne.depthStencil:(dr=Ne.depthStencil,dt=at=!1))):rt=nt=1;var xr=null,br=null,Ar=null,en=null;if(Array.isArray(tt))xr=tt.map(t);else if(tt)xr=[t(tt)];else for(xr=Array(Rt),tt=0;tt<Rt;++tt)xr[tt]=m(rt,nt,ht,Dt,Ot);for(rt=rt||xr[0].width,nt=nt||xr[0].height,Zt?br=t(Zt):at&&!dt&&(br=m(rt,nt,mr,"depth","uint32")),er?Ar=t(er):dt&&!at&&(Ar=m(rt,nt,!1,"stencil","uint8")),dr?en=t(dr):!Zt&&!er&&dt&&at&&(en=m(rt,nt,mr,"depth stencil","depth stencil")),at=null,tt=0;tt<xr.length;++tt)u(xr[tt],rt,nt),xr[tt]&&xr[tt].texture&&(dt=Dn[xr[tt].texture._texture.format]*In[xr[tt].texture._texture.type],null===at&&(at=dt));return u(br,rt,nt),u(Ar,rt,nt),u(en,rt,nt),f(Qe),Qe.width=rt,Qe.height=nt,Qe.colorAttachments=xr,Qe.depthAttachment=br,Qe.stencilAttachment=Ar,Qe.depthStencilAttachment=en,c.color=xr.map(F),c.depth=F(br),c.stencil=F(Ar),c.depthStencil=F(en),c.width=Qe.width,c.height=Qe.height,l(Qe),c}var Qe=new h;return nt.framebufferCount++,c(Ne,Ge),H(c,{resize:function(Ne,Ge){var tt=Math.max(0|Ne,1),rt=Math.max(0|Ge||tt,1);if(tt===Qe.width&&rt===Qe.height)return c;for(var nt=Qe.colorAttachments,at=0;at<nt.length;++at)k(nt[at],tt,rt);return k(Qe.depthAttachment,tt,rt),k(Qe.stencilAttachment,tt,rt),k(Qe.depthStencilAttachment,tt,rt),Qe.width=c.width=tt,Qe.height=c.height=rt,l(Qe),c},_reglType:"framebuffer",_framebuffer:Qe,destroy:function(){p(Qe),f(Qe)},use:function(Ne){at.setFBO({framebuffer:c},Ne)}})}var at={cur:null,next:null,dirty:!1,setFBO:null},it=["rgba"],ot=["rgba4","rgb565","rgb5 a1"];Ge.ext_srgb&&ot.push("srgba"),Ge.ext_color_buffer_half_float&&ot.push("rgba16f","rgb16f"),Ge.webgl_color_buffer_float&&ot.push("rgba32f");var dt=["uint8"];Ge.oes_texture_half_float&&dt.push("half float","float16"),Ge.oes_texture_float&&dt.push("float","float32");var ht=0,Dt={};return H(at,{getFramebuffer:function(Ne){return"function"==typeof Ne&&"framebuffer"===Ne._reglType&&(Ne=Ne._framebuffer)instanceof h?Ne:null},create:v,createCube:function(Ne){function b(Ne){var Qe,rt={color:null},nt=0,at=null;Qe="rgba";var it="uint8",ot=1;if("number"==typeof Ne?nt=0|Ne:Ne?("shape"in Ne?nt=Ne.shape[0]:("radius"in Ne&&(nt=0|Ne.radius),"width"in Ne?nt=0|Ne.width:"height"in Ne&&(nt=0|Ne.height)),("color"in Ne||"colors"in Ne)&&(at=Ne.color||Ne.colors,Array.isArray(at)),at||("colorCount"in Ne&&(ot=0|Ne.colorCount),"colorType"in Ne&&(it=Ne.colorType),"colorFormat"in Ne&&(Qe=Ne.colorFormat)),"depth"in Ne&&(rt.depth=Ne.depth),"stencil"in Ne&&(rt.stencil=Ne.stencil),"depthStencil"in Ne&&(rt.depthStencil=Ne.depthStencil)):nt=1,at)if(Array.isArray(at))for(Ne=[],Qe=0;Qe<at.length;++Qe)Ne[Qe]=at[Qe];else Ne=[at];else for(Ne=Array(ot),at={radius:nt,format:Qe,type:it},Qe=0;Qe<ot;++Qe)Ne[Qe]=tt.createCube(at);for(rt.color=Array(Ne.length),Qe=0;Qe<Ne.length;++Qe)ot=Ne[Qe],nt=nt||ot.width,rt.color[Qe]={target:34069,data:Ne[Qe]};for(Qe=0;6>Qe;++Qe){for(ot=0;ot<Ne.length;++ot)rt.color[ot].target=34069+Qe;0<Qe&&(rt.depth=Ge[0].depth,rt.stencil=Ge[0].stencil,rt.depthStencil=Ge[0].depthStencil),Ge[Qe]?Ge[Qe](rt):Ge[Qe]=v(rt)}return H(b,{width:nt,height:nt,color:Ne})}var Ge=Array(6);return b(Ne),H(b,{faces:Ge,resize:function(Ne){var Qe=0|Ne;if(Qe===b.width)return b;var tt=b.color;for(Ne=0;Ne<tt.length;++Ne)tt[Ne].resize(Qe);for(Ne=0;6>Ne;++Ne)Ge[Ne].resize(Qe);return b.width=b.height=Qe,b},_reglType:"framebufferCube",destroy:function(){Ge.forEach((function(Ne){Ne.destroy()}))}})},clear:function(){J(Dt).forEach(p)},restore:function(){at.cur=null,at.next=null,at.dirty=!0,J(Dt).forEach((function(Ge){Ge.framebuffer=Ne.createFramebuffer(),l(Ge)}))}})}function Ya(){this.w=this.z=this.y=this.x=this.state=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=5126,this.divisor=this.stride=this.offset=0}function Pb(Ne,Ge,Qe,tt,rt){function d(Ne){if(Ne!==ht.currentVAO){var Qe=Ge.oes_vertex_array_object;Ne?Qe.bindVertexArrayOES(Ne.vao):Qe.bindVertexArrayOES(null),ht.currentVAO=Ne}}function r(Qe){if(Qe!==ht.currentVAO){if(Qe)Qe.bindAttrs();else for(var tt=Ge.angle_instanced_arrays,rt=0;rt<at.length;++rt){var nt=at[rt];nt.buffer?(Ne.enableVertexAttribArray(rt),Ne.vertexAttribPointer(rt,nt.size,nt.type,nt.normalized,nt.stride,nt.offfset),tt&&tt.vertexAttribDivisorANGLE(rt,nt.divisor)):(Ne.disableVertexAttribArray(rt),Ne.vertexAttrib4f(rt,nt.x,nt.y,nt.z,nt.w))}ht.currentVAO=Qe}}function n(){J(dt).forEach((function(Ne){Ne.destroy()}))}function u(){this.id=++ot,this.attributes=[];var Ne=Ge.oes_vertex_array_object;this.vao=Ne?Ne.createVertexArrayOES():null,dt[this.id]=this,this.buffers=[]}function q(){Ge.oes_vertex_array_object&&J(dt).forEach((function(Ne){Ne.refresh()}))}var nt=Qe.maxAttributes,at=Array(nt);for(Qe=0;Qe<nt;++Qe)at[Qe]=new Ya;var ot=0,dt={},ht={Record:Ya,scope:{},state:at,currentVAO:null,targetVAO:null,restore:Ge.oes_vertex_array_object?q:function(){},createVAO:function(Ne){function b(Ne){for(var Qe=0;Qe<Ge.buffers.length;++Qe)Ge.buffers[Qe].destroy();Ge.buffers.length=0,(Qe=Ge.attributes).length=Ne.length;for(var tt=0;tt<Ne.length;++tt){var nt=Ne[tt],at=Qe[tt]=new Ya;Array.isArray(nt)||G(nt)||X(nt)?(nt=rt.create(nt,34962,!1,!0),at.buffer=rt.getBuffer(nt),at.size=0|at.buffer.dimension,at.normalized=!1,at.type=at.buffer.dtype,at.offset=0,at.stride=0,at.divisor=0,at.state=1,Ge.buffers.push(nt)):rt.getBuffer(nt)?(at.buffer=rt.getBuffer(nt),at.size=0|at.buffer.dimension,at.normalized=!1,at.type=at.buffer.dtype,at.offset=0,at.stride=0,at.divisor=0,at.state=1):rt.getBuffer(nt.buffer)?(at.buffer=rt.getBuffer(nt.buffer),at.size=0|(+nt.size||at.buffer.dimension),at.normalized=!!nt.normalized||!1,at.type="type"in nt?it[nt.type]:at.buffer.dtype,at.offset=0|(nt.offset||0),at.stride=0|(nt.stride||0),at.divisor=0|(nt.divisor||0),at.state=1):"x"in nt&&(at.x=+nt.x||0,at.y=+nt.y||0,at.z=+nt.z||0,at.w=+nt.w||0,at.state=2)}return Ge.refresh(),b}var Ge=new u;return tt.vaoCount+=1,b.destroy=function(){Ge.destroy()},b._vao=Ge,b._reglType="vao",b(Ne)},getVAO:function(Ne){return"function"==typeof Ne&&Ne._vao?Ne._vao:null},destroyBuffer:function(Ge){for(var Qe=0;Qe<at.length;++Qe){var tt=at[Qe];tt.buffer===Ge&&(Ne.disableVertexAttribArray(Qe),tt.buffer=null)}},setVAO:Ge.oes_vertex_array_object?d:r,clear:Ge.oes_vertex_array_object?n:function(){}};return u.prototype.bindAttrs=function(){for(var Qe=Ge.angle_instanced_arrays,tt=this.attributes,rt=0;rt<tt.length;++rt){var at=tt[rt];at.buffer?(Ne.enableVertexAttribArray(rt),Ne.bindBuffer(34962,at.buffer.buffer),Ne.vertexAttribPointer(rt,at.size,at.type,at.normalized,at.stride,at.offset),Qe&&Qe.vertexAttribDivisorANGLE(rt,at.divisor)):(Ne.disableVertexAttribArray(rt),Ne.vertexAttrib4f(rt,at.x,at.y,at.z,at.w))}for(Qe=tt.length;Qe<nt;++Qe)Ne.disableVertexAttribArray(Qe)},u.prototype.refresh=function(){var Ne=Ge.oes_vertex_array_object;Ne&&(Ne.bindVertexArrayOES(this.vao),this.bindAttrs(),ht.currentVAO=this)},u.prototype.destroy=function(){if(this.vao){var Ne=Ge.oes_vertex_array_object;this===ht.currentVAO&&(ht.currentVAO=null,Ne.bindVertexArrayOES(null)),Ne.deleteVertexArrayOES(this.vao),this.vao=null}dt[this.id]&&(delete dt[this.id],--tt.vaoCount)},ht}function Qb(Ne,Ge,Qe,tt){function g(Ne,Ge,Qe,tt){this.name=Ne,this.id=Ge,this.location=Qe,this.info=tt}function d(Ne,Ge){for(var Qe=0;Qe<Ne.length;++Qe)if(Ne[Qe].id===Ge.id)return void(Ne[Qe].location=Ge.location);Ne.push(Ge)}function r(Qe,tt,at){if(!(ot=(at=35632===Qe?rt:nt)[tt])){var it=Ge.str(tt),ot=Ne.createShader(Qe);Ne.shaderSource(ot,it),Ne.compileShader(ot),at[tt]=ot}return ot}function n(Ne,Ge){this.id=ot++,this.fragId=Ne,this.vertId=Ge,this.program=null,this.uniforms=[],this.attributes=[],tt.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function u(Qe,rt,nt){var at;at=r(35632,Qe.fragId);var it=r(35633,Qe.vertId);if(rt=Qe.program=Ne.createProgram(),Ne.attachShader(rt,at),Ne.attachShader(rt,it),nt)for(at=0;at<nt.length;++at)it=nt[at],Ne.bindAttribLocation(rt,it[0],it[1]);Ne.linkProgram(rt),it=Ne.getProgramParameter(rt,35718),tt.profile&&(Qe.stats.uniformsCount=it);var ot=Qe.uniforms;for(at=0;at<it;++at)if(nt=Ne.getActiveUniform(rt,at))if(1<nt.size)for(var dt=0;dt<nt.size;++dt){var ht=nt.name.replace("[0]","["+dt+"]");d(ot,new g(ht,Ge.id(ht),Ne.getUniformLocation(rt,ht),nt))}else d(ot,new g(nt.name,Ge.id(nt.name),Ne.getUniformLocation(rt,nt.name),nt));for(it=Ne.getProgramParameter(rt,35721),tt.profile&&(Qe.stats.attributesCount=it),Qe=Qe.attributes,at=0;at<it;++at)(nt=Ne.getActiveAttrib(rt,at))&&d(Qe,new g(nt.name,Ge.id(nt.name),Ne.getAttribLocation(rt,nt.name),nt))}var rt={},nt={},at={},it=[],ot=0;return tt.profile&&(Qe.getMaxUniformsCount=function(){var Ne=0;return it.forEach((function(Ge){Ge.stats.uniformsCount>Ne&&(Ne=Ge.stats.uniformsCount)})),Ne},Qe.getMaxAttributesCount=function(){var Ne=0;return it.forEach((function(Ge){Ge.stats.attributesCount>Ne&&(Ne=Ge.stats.attributesCount)})),Ne}),{clear:function(){var Ge=Ne.deleteShader.bind(Ne);J(rt).forEach(Ge),rt={},J(nt).forEach(Ge),nt={},it.forEach((function(Ge){Ne.deleteProgram(Ge.program)})),it.length=0,at={},Qe.shaderCount=0},program:function(Ne,Ge,tt,rt){var nt=at[Ge];nt||(nt=at[Ge]={});var ot=nt[Ne];return ot&&!rt?ot:(Ge=new n(Ge,Ne),Qe.shaderCount++,u(Ge,tt,rt),ot||(nt[Ne]=Ge),it.push(Ge),Ge)},restore:function(){rt={},nt={};for(var Ne=0;Ne<it.length;++Ne)u(it[Ne],null,it[Ne].attributes.map((function(Ne){return[Ne.location,Ne.name]})))},shader:r,frag:-1,vert:-1}}function Rb(Ne,Ge,Qe,tt,rt,nt,at){function n(rt){var nt;nt=null===Ge.next?5121:Ge.next.colorAttachments[0].texture._texture.type;var at=0,it=0,ot=tt.framebufferWidth,dt=tt.framebufferHeight,ht=null;return G(rt)?ht=rt:rt&&(at=0|rt.x,it=0|rt.y,ot=0|(rt.width||tt.framebufferWidth-at),dt=0|(rt.height||tt.framebufferHeight-it),ht=rt.data||null),Qe(),rt=ot*dt*4,ht||(5121===nt?ht=new Uint8Array(rt):5126===nt&&(ht=ht||new Float32Array(rt))),Ne.pixelStorei(3333,4),Ne.readPixels(at,it,ot,dt,6408,nt,ht),ht}function u(Ne){var Qe;return Ge.setFBO({framebuffer:Ne.framebuffer},(function(){Qe=n(Ne)})),Qe}return function(Ne){return Ne&&"framebuffer"in Ne?u(Ne):n(Ne)}}function ta(Ne){return Array.prototype.slice.call(Ne)}function Aa(Ne){return ta(Ne).join("")}function Sb(){function a(){var Ge=[],Qe=[];return H((function(){Ge.push.apply(Ge,ta(arguments))}),{def:function(){var tt="v"+Ne++;return Qe.push(tt),0<arguments.length&&(Ge.push(tt,"="),Ge.push.apply(Ge,ta(arguments)),Ge.push(";")),tt},toString:function(){return Aa([0<Qe.length?"var "+Qe.join(",")+";":"",Aa(Ge)])}})}function b(){function b(Qe,tt){Ge(Qe,tt,"=",Ne.def(Qe,tt),";")}var Ne=a(),Ge=a(),Qe=Ne.toString,tt=Ge.toString;return H((function(){Ne.apply(Ne,ta(arguments))}),{def:Ne.def,entry:Ne,exit:Ge,save:b,set:function(Ge,Qe,tt){b(Ge,Qe),Ne(Ge,Qe,"=",tt,";")},toString:function(){return Qe()+tt()}})}var Ne=0,Ge=[],Qe=[],tt=a(),rt={};return{global:tt,link:function(tt){for(var rt=0;rt<Qe.length;++rt)if(Qe[rt]===tt)return Ge[rt];return rt="g"+Ne++,Ge.push(rt),Qe.push(tt),rt},block:a,proc:function(Ne,Ge){function d(){var Ne="a"+Qe.length;return Qe.push(Ne),Ne}var Qe=[];Ge=Ge||0;for(var tt=0;tt<Ge;++tt)d();var nt=(tt=b()).toString;return rt[Ne]=H(tt,{arg:d,toString:function(){return Aa(["function(",Qe.join(),"){",nt(),"}"])}})},scope:b,cond:function(){var Ne=Aa(arguments),Ge=b(),Qe=b(),tt=Ge.toString,rt=Qe.toString;return H(Ge,{then:function(){return Ge.apply(Ge,ta(arguments)),this},else:function(){return Qe.apply(Qe,ta(arguments)),this},toString:function(){var Ge=rt();return Ge&&(Ge="else{"+Ge+"}"),Aa(["if(",Ne,"){",tt(),"}",Ge])}})},compile:function(){var Ne=['"use strict";',tt,"return {"];Object.keys(rt).forEach((function(Ge){Ne.push('"',Ge,'":',rt[Ge].toString(),",")})),Ne.push("}");var nt=Aa(Ne).replace(/;/g,";\n").replace(/}/g,"}\n").replace(/{/g,"{\n");return Function.apply(null,Ge.concat(nt)).apply(null,Qe)}}}function Oa(Ne){return Array.isArray(Ne)||G(Ne)||X(Ne)}function wb(Ne){return Ne.sort((function(Ne,Ge){return"viewport"===Ne?-1:"viewport"===Ge?1:Ne<Ge?-1:1}))}function P(Ne,Ge,Qe,tt){this.thisDep=Ne,this.contextDep=Ge,this.propDep=Qe,this.append=tt}function ua(Ne){return Ne&&!(Ne.thisDep||Ne.contextDep||Ne.propDep)}function C(Ne){return new P(!1,!1,!1,Ne)}function L(Ne,Ge){var Qe=Ne.type;return 0===Qe?new P(!0,1<=(Qe=Ne.data.length),2<=Qe,Ge):4===Qe?new P((Qe=Ne.data).thisDep,Qe.contextDep,Qe.propDep,Ge):new P(3===Qe,2===Qe,1===Qe,Ge)}function Tb(Ne,Qe,tt,rt,nt,at,ot,dt,ht,Dt,Rt,Zt,er,dr,mr){function f(Ne){return Ne.replace(".","_")}function p(Ne,Ge,Qe){var tt=f(Ne);kn.push(Ne),xn[tt]=mn[tt]=!!Qe,Cn[tt]=Ge}function l(Ne,Ge,Qe){var tt=f(Ne);kn.push(Ne),Array.isArray(Qe)?(mn[tt]=Qe.slice(),xn[tt]=Qe.slice()):mn[tt]=xn[tt]=Qe,En[tt]=Ge}function v(){var Ne=Sb(),Ge=Ne.link,tt=Ne.global;Ne.id=In++,Ne.batchId="0";var rt=Ge(Pn),nt=Ne.shared={props:"a0"};Object.keys(Pn).forEach((function(Ne){nt[Ne]=tt.def(rt,".",Ne)}));var at=Ne.next={},it=Ne.current={};Object.keys(En).forEach((function(Ne){Array.isArray(mn[Ne])&&(at[Ne]=tt.def(nt.next,".",Ne),it[Ne]=tt.def(nt.current,".",Ne))}));var ot=Ne.constants={};Object.keys(Dn).forEach((function(Ne){ot[Ne]=tt.def(JSON.stringify(Dn[Ne]))})),Ne.invoke=function(Qe,tt){switch(tt.type){case 0:var rt=["this",nt.context,nt.props,Ne.batchId];return Qe.def(Ge(tt.data),".call(",rt.slice(0,Math.max(tt.data.length+1,4)),")");case 1:return Qe.def(nt.props,tt.data);case 2:return Qe.def(nt.context,tt.data);case 3:return Qe.def("this",tt.data);case 4:return tt.data.append(Ne,Qe),tt.data.ref}},Ne.attribCache={};var dt={};return Ne.scopeAttrib=function(Ne){if((Ne=Qe.id(Ne))in dt)return dt[Ne];var tt=Dt.scope[Ne];return tt||(tt=Dt.scope[Ne]=new xr),dt[Ne]=Ge(tt)},Ne}function Q(Ne){var Ge,Qe=Ne.static;if(Ne=Ne.dynamic,"profile"in Qe){var tt=!!Qe.profile;(Ge=C((function(Ne,Ge){return tt}))).enable=tt}else if("profile"in Ne){var rt=Ne.profile;Ge=L(rt,(function(Ne,Ge){return Ne.invoke(Ge,rt)}))}return Ge}function z(Ne,Ge){var Qe=Ne.static,tt=Ne.dynamic;if("framebuffer"in Qe){var rt=Qe.framebuffer;return rt?(rt=dt.getFramebuffer(rt),C((function(Ne,Ge){var Qe=Ne.link(rt),tt=Ne.shared;return Ge.set(tt.framebuffer,".next",Qe),tt=tt.context,Ge.set(tt,".framebufferWidth",Qe+".width"),Ge.set(tt,".framebufferHeight",Qe+".height"),Qe}))):C((function(Ne,Ge){var Qe=Ne.shared;return Ge.set(Qe.framebuffer,".next","null"),Qe=Qe.context,Ge.set(Qe,".framebufferWidth",Qe+".drawingBufferWidth"),Ge.set(Qe,".framebufferHeight",Qe+".drawingBufferHeight"),"null"}))}if("framebuffer"in tt){var nt=tt.framebuffer;return L(nt,(function(Ne,Ge){var Qe=Ne.invoke(Ge,nt),tt=Ne.shared,rt=tt.framebuffer;return Qe=Ge.def(rt,".getFramebuffer(",Qe,")"),Ge.set(rt,".next",Qe),tt=tt.context,Ge.set(tt,".framebufferWidth",Qe+"?"+Qe+".width:"+tt+".drawingBufferWidth"),Ge.set(tt,".framebufferHeight",Qe+"?"+Qe+".height:"+tt+".drawingBufferHeight"),Qe}))}return null}function w(Ne,Ge,Qe){function d(Ne){if(Ne in tt){var Qe=tt[Ne];Ne=!0;var nt,at,it=0|Qe.x,ot=0|Qe.y;return"width"in Qe?nt=0|Qe.width:Ne=!1,"height"in Qe?at=0|Qe.height:Ne=!1,new P(!Ne&&Ge&&Ge.thisDep,!Ne&&Ge&&Ge.contextDep,!Ne&&Ge&&Ge.propDep,(function(Ne,Ge){var tt=Ne.shared.context,rt=nt;"width"in Qe||(rt=Ge.def(tt,".","framebufferWidth","-",it));var dt=at;return"height"in Qe||(dt=Ge.def(tt,".","framebufferHeight","-",ot)),[it,ot,rt,dt]}))}if(Ne in rt){var dt=rt[Ne];return Ne=L(dt,(function(Ne,Ge){var Qe=Ne.invoke(Ge,dt),tt=Ne.shared.context,rt=Ge.def(Qe,".x|0"),nt=Ge.def(Qe,".y|0");return[rt,nt,Ge.def('"width" in ',Qe,"?",Qe,".width|0:","(",tt,".","framebufferWidth","-",rt,")"),Qe=Ge.def('"height" in ',Qe,"?",Qe,".height|0:","(",tt,".","framebufferHeight","-",nt,")")]})),Ge&&(Ne.thisDep=Ne.thisDep||Ge.thisDep,Ne.contextDep=Ne.contextDep||Ge.contextDep,Ne.propDep=Ne.propDep||Ge.propDep),Ne}return Ge?new P(Ge.thisDep,Ge.contextDep,Ge.propDep,(function(Ne,Ge){var Qe=Ne.shared.context;return[0,0,Ge.def(Qe,".","framebufferWidth"),Ge.def(Qe,".","framebufferHeight")]})):null}var tt=Ne.static,rt=Ne.dynamic;if(Ne=d("viewport")){var nt=Ne;Ne=new P(Ne.thisDep,Ne.contextDep,Ne.propDep,(function(Ne,Ge){var Qe=nt.append(Ne,Ge),tt=Ne.shared.context;return Ge.set(tt,".viewportWidth",Qe[2]),Ge.set(tt,".viewportHeight",Qe[3]),Qe}))}return{viewport:Ne,scissor_box:d("scissor.box")}}function H(Ne,Ge){if("string"==typeof(Qe=Ne.static).frag&&"string"==typeof Qe.vert){if(0<Object.keys(Ge.dynamic).length)return null;var Qe=Ge.static,tt=Object.keys(Qe);if(0<tt.length&&"number"==typeof Qe[tt[0]]){for(var rt=[],nt=0;nt<tt.length;++nt)rt.push([0|Qe[tt[nt]],tt[nt]]);return rt}}return null}function E(Ne,Ge,tt){function e(Ne){if(Ne in rt){var Ge=Qe.id(rt[Ne]);return(Ne=C((function(){return Ge}))).id=Ge,Ne}if(Ne in nt){var tt=nt[Ne];return L(tt,(function(Ne,Ge){var Qe=Ne.invoke(Ge,tt);return Ge.def(Ne.shared.strings,".id(",Qe,")")}))}return null}var rt=Ne.static,nt=Ne.dynamic,at=e("frag"),it=e("vert"),ot=null;return ua(at)&&ua(it)?(ot=Rt.program(it.id,at.id,null,tt),Ne=C((function(Ne,Ge){return Ne.link(ot)}))):Ne=new P(at&&at.thisDep||it&&it.thisDep,at&&at.contextDep||it&&it.contextDep,at&&at.propDep||it&&it.propDep,(function(Ne,Ge){var Qe,tt,rt=Ne.shared.shader;return Qe=at?at.append(Ne,Ge):Ge.def(rt,".","frag"),tt=it?it.append(Ne,Ge):Ge.def(rt,".","vert"),Ge.def(rt+".program("+tt+","+Qe+")")})),{frag:at,vert:it,progVar:Ne,program:ot}}function G(Ne,Ge){function c(Ne,Ge){if(Ne in Qe){var nt=0|Qe[Ne];return C((function(Ne,Qe){return Ge&&(Ne.OFFSET=nt),nt}))}if(Ne in tt){var at=tt[Ne];return L(at,(function(Ne,Qe){var tt=Ne.invoke(Qe,at);return Ge&&(Ne.OFFSET=tt),tt}))}return Ge&&rt?C((function(Ne,Ge){return Ne.OFFSET="0",0})):null}var Qe=Ne.static,tt=Ne.dynamic,rt=function(){if("elements"in Qe){var Ne=Qe.elements;Oa(Ne)?Ne=at.getElements(at.create(Ne,!0)):Ne&&(Ne=at.getElements(Ne));var Ge=C((function(Ge,Qe){if(Ne){var tt=Ge.link(Ne);return Ge.ELEMENTS=tt}return Ge.ELEMENTS=null}));return Ge.value=Ne,Ge}if("elements"in tt){var rt=tt.elements;return L(rt,(function(Ne,Ge){var Qe=(tt=Ne.shared).isBufferArgs,tt=tt.elements,nt=Ne.invoke(Ge,rt),at=Ge.def("null");return Qe=Ge.def(Qe,"(",nt,")"),nt=Ne.cond(Qe).then(at,"=",tt,".createStream(",nt,");").else(at,"=",tt,".getElements(",nt,");"),Ge.entry(nt),Ge.exit(Ne.cond(Qe).then(tt,".destroyStream(",at,");")),Ne.ELEMENTS=at}))}return null}(),nt=c("offset",!0);return{elements:rt,primitive:function(){if("primitive"in Qe){var Ne=Qe.primitive;return C((function(Ge,Qe){return Ot[Ne]}))}if("primitive"in tt){var Ge=tt.primitive;return L(Ge,(function(Ne,Qe){var tt=Ne.constants.primTypes,rt=Ne.invoke(Qe,Ge);return Qe.def(tt,"[",rt,"]")}))}return rt?ua(rt)?rt.value?C((function(Ne,Ge){return Ge.def(Ne.ELEMENTS,".primType")})):C((function(){return 4})):new P(rt.thisDep,rt.contextDep,rt.propDep,(function(Ne,Ge){var Qe=Ne.ELEMENTS;return Ge.def(Qe,"?",Qe,".primType:",4)})):null}(),count:function(){if("count"in Qe){var Ne=0|Qe.count;return C((function(){return Ne}))}if("count"in tt){var Ge=tt.count;return L(Ge,(function(Ne,Qe){return Ne.invoke(Qe,Ge)}))}return rt?ua(rt)?rt?nt?new P(nt.thisDep,nt.contextDep,nt.propDep,(function(Ne,Ge){return Ge.def(Ne.ELEMENTS,".vertCount-",Ne.OFFSET)})):C((function(Ne,Ge){return Ge.def(Ne.ELEMENTS,".vertCount")})):C((function(){return-1})):new P(rt.thisDep||nt.thisDep,rt.contextDep||nt.contextDep,rt.propDep||nt.propDep,(function(Ne,Ge){var Qe=Ne.ELEMENTS;return Ne.OFFSET?Ge.def(Qe,"?",Qe,".vertCount-",Ne.OFFSET,":-1"):Ge.def(Qe,"?",Qe,".vertCount:-1")})):null}(),instances:c("instances",!1),offset:nt}}function R(Ne,Ge){var Qe=Ne.static,tt=Ne.dynamic,rt={};return kn.forEach((function(Ne){function b(nt,at){if(Ne in Qe){var it=nt(Qe[Ne]);rt[Ge]=C((function(){return it}))}else if(Ne in tt){var ot=tt[Ne];rt[Ge]=L(ot,(function(Ne,Ge){return at(Ne,Ge,Ne.invoke(Ge,ot))}))}}var Ge=f(Ne);switch(Ne){case"cull.enable":case"blend.enable":case"dither":case"stencil.enable":case"depth.enable":case"scissor.enable":case"polygonOffset.enable":case"sample.alpha":case"sample.enable":case"depth.mask":case"lineWidth":return b((function(Ne){return Ne}),(function(Ne,Ge,Qe){return Qe}));case"depth.func":return b((function(Ne){return Hn[Ne]}),(function(Ne,Ge,Qe){return Ge.def(Ne.constants.compareFuncs,"[",Qe,"]")}));case"depth.range":return b((function(Ne){return Ne}),(function(Ne,Ge,Qe){return[Ge.def("+",Qe,"[0]"),Ge=Ge.def("+",Qe,"[1]")]}));case"blend.func":return b((function(Ne){return[Vn["srcRGB"in Ne?Ne.srcRGB:Ne.src],Vn["dstRGB"in Ne?Ne.dstRGB:Ne.dst],Vn["srcAlpha"in Ne?Ne.srcAlpha:Ne.src],Vn["dstAlpha"in Ne?Ne.dstAlpha:Ne.dst]]}),(function(Ne,Ge,Qe){function d(Ne,tt){return Ge.def('"',Ne,tt,'" in ',Qe,"?",Qe,".",Ne,tt,":",Qe,".",Ne)}Ne=Ne.constants.blendFuncs;var tt=d("src","RGB"),rt=d("dst","RGB"),nt=(tt=Ge.def(Ne,"[",tt,"]"),Ge.def(Ne,"[",d("src","Alpha"),"]"));return[tt,rt=Ge.def(Ne,"[",rt,"]"),nt,Ne=Ge.def(Ne,"[",d("dst","Alpha"),"]")]}));case"blend.equation":return b((function(Ne){return"string"==typeof Ne?[br[Ne],br[Ne]]:"object"==typeof Ne?[br[Ne.rgb],br[Ne.alpha]]:void 0}),(function(Ne,Ge,Qe){var tt=Ne.constants.blendEquations,rt=Ge.def(),nt=Ge.def();return(Ne=Ne.cond("typeof ",Qe,'==="string"')).then(rt,"=",nt,"=",tt,"[",Qe,"];"),Ne.else(rt,"=",tt,"[",Qe,".rgb];",nt,"=",tt,"[",Qe,".alpha];"),Ge(Ne),[rt,nt]}));case"blend.color":return b((function(Ne){return A(4,(function(Ge){return+Ne[Ge]}))}),(function(Ne,Ge,Qe){return A(4,(function(Ne){return Ge.def("+",Qe,"[",Ne,"]")}))}));case"stencil.mask":return b((function(Ne){return 0|Ne}),(function(Ne,Ge,Qe){return Ge.def(Qe,"|0")}));case"stencil.func":return b((function(Ne){return[Hn[Ne.cmp||"keep"],Ne.ref||0,"mask"in Ne?Ne.mask:-1]}),(function(Ne,Ge,Qe){return[Ne=Ge.def('"cmp" in ',Qe,"?",Ne.constants.compareFuncs,"[",Qe,".cmp]",":",7680),Ge.def(Qe,".ref|0"),Ge=Ge.def('"mask" in ',Qe,"?",Qe,".mask|0:-1")]}));case"stencil.opFront":case"stencil.opBack":return b((function(Ge){return["stencil.opBack"===Ne?1029:1028,qn[Ge.fail||"keep"],qn[Ge.zfail||"keep"],qn[Ge.zpass||"keep"]]}),(function(Ge,Qe,tt){function e(Ne){return Qe.def('"',Ne,'" in ',tt,"?",rt,"[",tt,".",Ne,"]:",7680)}var rt=Ge.constants.stencilOps;return["stencil.opBack"===Ne?1029:1028,e("fail"),e("zfail"),e("zpass")]}));case"polygonOffset.offset":return b((function(Ne){return[0|Ne.factor,0|Ne.units]}),(function(Ne,Ge,Qe){return[Ge.def(Qe,".factor|0"),Ge=Ge.def(Qe,".units|0")]}));case"cull.face":return b((function(Ne){var Ge=0;return"front"===Ne?Ge=1028:"back"===Ne&&(Ge=1029),Ge}),(function(Ne,Ge,Qe){return Ge.def(Qe,'==="front"?',1028,":",1029)}));case"frontFace":return b((function(Ne){return Yn[Ne]}),(function(Ne,Ge,Qe){return Ge.def(Qe+'==="cw"?2304:2305')}));case"colorMask":return b((function(Ne){return Ne.map((function(Ne){return!!Ne}))}),(function(Ne,Ge,Qe){return A(4,(function(Ne){return"!!"+Qe+"["+Ne+"]"}))}));case"sample.coverage":return b((function(Ne){return["value"in Ne?Ne.value:1,!!Ne.invert]}),(function(Ne,Ge,Qe){return[Ge.def('"value" in ',Qe,"?+",Qe,".value:1"),Ge=Ge.def("!!",Qe,".invert")]}))}})),rt}function sa(Ne,Ge){var Qe=Ne.static,tt=Ne.dynamic,rt={};return Object.keys(Qe).forEach((function(Ne){var Ge,tt=Qe[Ne];if("number"==typeof tt||"boolean"==typeof tt)Ge=C((function(){return tt}));else if("function"==typeof tt){var nt=tt._reglType;"texture2d"===nt||"textureCube"===nt?Ge=C((function(Ne){return Ne.link(tt)})):"framebuffer"!==nt&&"framebufferCube"!==nt||(Ge=C((function(Ne){return Ne.link(tt.color[0])})))}else na(tt)&&(Ge=C((function(Ne){return Ne.global.def("[",A(tt.length,(function(Ne){return tt[Ne]})),"]")})));Ge.value=tt,rt[Ne]=Ge})),Object.keys(tt).forEach((function(Ne){var Ge=tt[Ne];rt[Ne]=L(Ge,(function(Ne,Qe){return Ne.invoke(Qe,Ge)}))})),rt}function J(Ne,Ge){var tt=Ne.static,rt=Ne.dynamic,at={};return Object.keys(tt).forEach((function(Ne){var Ge=tt[Ne],rt=Qe.id(Ne),ot=new xr;if(Oa(Ge))ot.state=1,ot.buffer=nt.getBuffer(nt.create(Ge,34962,!1,!0)),ot.type=0;else if(ht=nt.getBuffer(Ge))ot.state=1,ot.buffer=ht,ot.type=0;else if("constant"in Ge){var dt=Ge.constant;ot.buffer="null",ot.state=2,"number"==typeof dt?ot.x=dt:zn.forEach((function(Ne,Ge){Ge<dt.length&&(ot[Ne]=dt[Ge])}))}else{var ht=Oa(Ge.buffer)?nt.getBuffer(nt.create(Ge.buffer,34962,!1,!0)):nt.getBuffer(Ge.buffer),Dt=0|Ge.offset,Ot=0|Ge.stride,Rt=0|Ge.size,Zt=!!Ge.normalized,er=0;"type"in Ge&&(er=it[Ge.type]),Ge=0|Ge.divisor,ot.buffer=ht,ot.state=1,ot.size=Rt,ot.normalized=Zt,ot.type=er||ht.dtype,ot.offset=Dt,ot.stride=Ot,ot.divisor=Ge}at[Ne]=C((function(Ne,Ge){var Qe=Ne.attribCache;if(rt in Qe)return Qe[rt];var tt={isStream:!1};return Object.keys(ot).forEach((function(Ne){tt[Ne]=ot[Ne]})),ot.buffer&&(tt.buffer=Ne.link(ot.buffer),tt.type=tt.type||tt.buffer+".dtype"),Qe[rt]=tt}))})),Object.keys(rt).forEach((function(Ne){var Ge=rt[Ne];at[Ne]=L(Ge,(function(Ne,Qe){function d(Ne){Qe(it[Ne],"=",tt,".",Ne,"|0;")}var tt=Ne.invoke(Qe,Ge),rt=Ne.shared,nt=Ne.constants,at=rt.isBufferArgs,it=(rt=rt.buffer,{isStream:Qe.def(!1)}),ot=new xr;ot.state=1,Object.keys(ot).forEach((function(Ne){it[Ne]=Qe.def(""+ot[Ne])}));var dt=it.buffer,ht=it.type;return Qe("if(",at,"(",tt,")){",it.isStream,"=true;",dt,"=",rt,".createStream(",34962,",",tt,");",ht,"=",dt,".dtype;","}else{",dt,"=",rt,".getBuffer(",tt,");","if(",dt,"){",ht,"=",dt,".dtype;",'}else if("constant" in ',tt,"){",it.state,"=",2,";","if(typeof "+tt+'.constant === "number"){',it[zn[0]],"=",tt,".constant;",zn.slice(1).map((function(Ne){return it[Ne]})).join("="),"=0;","}else{",zn.map((function(Ne,Ge){return it[Ne]+"="+tt+".constant.length>"+Ge+"?"+tt+".constant["+Ge+"]:0;"})).join(""),"}}else{","if(",at,"(",tt,".buffer)){",dt,"=",rt,".createStream(",34962,",",tt,".buffer);","}else{",dt,"=",rt,".getBuffer(",tt,".buffer);","}",ht,'="type" in ',tt,"?",nt.glTypes,"[",tt,".type]:",dt,".dtype;",it.normalized,"=!!",tt,".normalized;"),d("size"),d("offset"),d("stride"),d("divisor"),Qe("}}"),Qe.exit("if(",it.isStream,"){",rt,".destroyStream(",dt,");","}"),it}))})),at}function D(Ne,Ge){var Qe=Ne.static,tt=Ne.dynamic;if("vao"in Qe){var rt=Qe.vao;return null!==rt&&null===Dt.getVAO(rt)&&(rt=Dt.createVAO(rt)),C((function(Ne){return Ne.link(Dt.getVAO(rt))}))}if("vao"in tt){var nt=tt.vao;return L(nt,(function(Ne,Ge){var Qe=Ne.invoke(Ge,nt);return Ge.def(Ne.shared.vao+".getVAO("+Qe+")")}))}return null}function x(Ne){var Ge=Ne.static,Qe=Ne.dynamic,tt={};return Object.keys(Ge).forEach((function(Ne){var Qe=Ge[Ne];tt[Ne]=C((function(Ne,Ge){return"number"==typeof Qe||"boolean"==typeof Qe?""+Qe:Ne.link(Qe)}))})),Object.keys(Qe).forEach((function(Ne){var Ge=Qe[Ne];tt[Ne]=L(Ge,(function(Ne,Qe){return Ne.invoke(Qe,Ge)}))})),tt}function la(Ne,Ge,Qe,rt,nt){function h(Ne){var Ge=it[Ne];Ge&&(dt[Ne]=Ge)}var at=H(Ne,Ge),it=w(Ne,Ot=z(Ne,nt),nt),ot=G(Ne,nt),dt=R(Ne,nt),ht=E(Ne,nt,at);h("viewport"),h(f("scissor.box"));var Ot,Rt=0<Object.keys(dt).length;if((Ot={framebuffer:Ot,draw:ot,shader:ht,state:dt,dirty:Rt,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}}).profile=Q(Ne,nt),Ot.uniforms=sa(Qe,nt),Ot.drawVAO=Ot.scopeVAO=D(Ne,nt),!Ot.drawVAO&&ht.program&&!at&&tt.angle_instanced_arrays){var Zt=!0;if(Ne=ht.program.attributes.map((function(Ne){return Ne=Ge.static[Ne],Zt=Zt&&!!Ne,Ne})),Zt&&0<Ne.length){var er=Dt.getVAO(Dt.createVAO(Ne));Ot.drawVAO=new P(null,null,null,(function(Ne,Ge){return Ne.link(er)})),Ot.useVAO=!0}}return at?Ot.useVAO=!0:Ot.attributes=J(Ge,nt),Ot.context=x(rt,nt),Ot}function T(Ne,Ge,Qe){var tt=Ne.shared.context,rt=Ne.scope();Object.keys(Qe).forEach((function(nt){Ge.save(tt,"."+nt),rt(tt,".",nt,"=",Qe[nt].append(Ne,Ge),";")})),Ge(rt)}function O(Ne,Ge,Qe,tt){var rt,nt=(it=Ne.shared).gl,at=it.framebuffer;en&&(rt=Ge.def(it.extensions,".webgl_draw_buffers"));var it=(ot=Ne.constants).drawBuffer,ot=ot.backBuffer;Ne=Qe?Qe.append(Ne,Ge):Ge.def(at,".next"),tt||Ge("if(",Ne,"!==",at,".cur){"),Ge("if(",Ne,"){",nt,".bindFramebuffer(",36160,",",Ne,".framebuffer);"),en&&Ge(rt,".drawBuffersWEBGL(",it,"[",Ne,".colorAttachments.length]);"),Ge("}else{",nt,".bindFramebuffer(",36160,",null);"),en&&Ge(rt,".drawBuffersWEBGL(",ot,");"),Ge("}",at,".cur=",Ne,";"),tt||Ge("}")}function S(Ne,Ge,Qe){var tt=Ne.shared,rt=tt.gl,nt=Ne.current,at=Ne.next,it=tt.current,ot=tt.next,dt=Ne.cond(it,".dirty");kn.forEach((function(Ge){var tt,ht;if(!((Ge=f(Ge))in Qe.state))if(Ge in at){tt=at[Ge],ht=nt[Ge];var Dt=A(mn[Ge].length,(function(Ne){return dt.def(tt,"[",Ne,"]")}));dt(Ne.cond(Dt.map((function(Ne,Ge){return Ne+"!=="+ht+"["+Ge+"]"})).join("||")).then(rt,".",En[Ge],"(",Dt,");",Dt.map((function(Ne,Ge){return ht+"["+Ge+"]="+Ne})).join(";"),";"))}else tt=dt.def(ot,".",Ge),Dt=Ne.cond(tt,"!==",it,".",Ge),dt(Dt),Ge in Cn?Dt(Ne.cond(tt).then(rt,".enable(",Cn[Ge],");").else(rt,".disable(",Cn[Ge],");"),it,".",Ge,"=",tt,";"):Dt(rt,".",En[Ge],"(",tt,");",it,".",Ge,"=",tt,";")})),0===Object.keys(Qe.state).length&&dt(it,".dirty=false;"),Ge(dt)}function K(Ne,Ge,Qe,tt){var rt=Ne.shared,nt=Ne.current,at=rt.current,it=rt.gl;wb(Object.keys(Qe)).forEach((function(rt){var ot=Qe[rt];if(!tt||tt(ot)){var dt=ot.append(Ne,Ge);if(Cn[rt]){var ht=Cn[rt];ua(ot)?Ge(it,dt?".enable(":".disable(",ht,");"):Ge(Ne.cond(dt).then(it,".enable(",ht,");").else(it,".disable(",ht,");")),Ge(at,".",rt,"=",dt,";")}else if(na(dt)){var Dt=nt[rt];Ge(it,".",En[rt],"(",dt,");",dt.map((function(Ne,Ge){return Dt+"["+Ge+"]="+Ne})).join(";"),";")}else Ge(it,".",En[rt],"(",dt,");",at,".",rt,"=",dt,";")}}))}function B(Ne,Ge){Ar&&(Ne.instancing=Ge.def(Ne.shared.extensions,".angle_instanced_arrays"))}function V(Ne,Ge,Qe,tt,rt){function f(){return"undefined"==typeof performance?"Date.now()":"performance.now()"}function g(Ne){Ne(nt=Ge.def(),"=",f(),";"),"string"==typeof rt?Ne(ot,".count+=",rt,";"):Ne(ot,".count++;"),dr&&(tt?Ne(at=Ge.def(),"=",ht,".getNumPendingQueries();"):Ne(ht,".beginQuery(",ot,");"))}function h(Ne){Ne(ot,".cpuTime+=",f(),"-",nt,";"),dr&&(tt?Ne(ht,".pushScopeStats(",at,",",ht,".getNumPendingQueries(),",ot,");"):Ne(ht,".endQuery();"))}function m(Ne){var Qe=Ge.def(dt,".profile");Ge(dt,".profile=",Ne,";"),Ge.exit(dt,".profile=",Qe,";")}var nt,at,it=Ne.shared,ot=Ne.stats,dt=it.current,ht=it.timer;if(Qe=Qe.profile){if(ua(Qe))return void(Qe.enable?(g(Ge),h(Ge.exit),m("true")):m("false"));m(Qe=Qe.append(Ne,Ge))}else Qe=Ge.def(dt,".profile");g(it=Ne.block()),Ge("if(",Qe,"){",it,"}"),h(Ne=Ne.block()),Ge.exit("if(",Qe,"){",Ne,"}")}function N(Ne,Ge,Qe,tt,rt){function f(Ne){switch(Ne){case 35664:case 35667:case 35671:return 2;case 35665:case 35668:case 35672:return 3;case 35666:case 35669:case 35673:return 4;default:return 1}}function g(Qe,tt,rt){function f(){Ge("if(!",ot,".buffer){",at,".enableVertexAttribArray(",it,");}");var Qe,nt=rt.type;Qe=rt.size?Ge.def(rt.size,"||",tt):tt,Ge("if(",ot,".type!==",nt,"||",ot,".size!==",Qe,"||",Dt.map((function(Ne){return ot+"."+Ne+"!=="+rt[Ne]})).join("||"),"){",at,".bindBuffer(",34962,",",dt,".buffer);",at,".vertexAttribPointer(",[it,Qe,nt,rt.normalized,rt.stride,rt.offset],");",ot,".type=",nt,";",ot,".size=",Qe,";",Dt.map((function(Ne){return ot+"."+Ne+"="+rt[Ne]+";"})).join(""),"}"),Ar&&(nt=rt.divisor,Ge("if(",ot,".divisor!==",nt,"){",Ne.instancing,".vertexAttribDivisorANGLE(",[it,nt],");",ot,".divisor=",nt,";}"))}function k(){Ge("if(",ot,".buffer){",at,".disableVertexAttribArray(",it,");",ot,".buffer=null;","}if(",zn.map((function(Ne,Ge){return ot+"."+Ne+"!=="+ht[Ge]})).join("||"),"){",at,".vertexAttrib4f(",it,",",ht,");",zn.map((function(Ne,Ge){return ot+"."+Ne+"="+ht[Ge]+";"})).join(""),"}")}var at=nt.gl,it=Ge.def(Qe,".location"),ot=Ge.def(nt.attributes,"[",it,"]");Qe=rt.state;var dt=rt.buffer,ht=[rt.x,rt.y,rt.z,rt.w],Dt=["buffer","normalized","offset","stride"];1===Qe?f():2===Qe?k():(Ge("if(",Qe,"===",1,"){"),f(),Ge("}else{"),k(),Ge("}"))}var nt=Ne.shared;tt.forEach((function(tt){var nt,at=tt.name,it=Qe.attributes[at];if(it){if(!rt(it))return;nt=it.append(Ne,Ge)}else{if(!rt($n))return;var ot=Ne.scopeAttrib(at);nt={},Object.keys(new xr).forEach((function(Ne){nt[Ne]=Ge.def(ot,".",Ne)}))}g(Ne.link(tt),f(tt.info.type),nt)}))}function wa(Ne,Ge,tt,rt,nt){for(var at,it=Ne.shared,ot=it.gl,dt=0;dt<rt.length;++dt){var ht,Dt=(Zt=rt[dt]).name,Ot=Zt.info.type,Rt=tt.uniforms[Dt],Zt=Ne.link(Zt)+".location";if(Rt){if(!nt(Rt))continue;if(ua(Rt)){if(Dt=Rt.value,35678===Ot||35680===Ot)Ge(ot,".uniform1i(",Zt,",",(Ot=Ne.link(Dt._texture||Dt.color[0]._texture))+".bind());"),Ge.exit(Ot,".unbind();");else if(35674===Ot||35675===Ot||35676===Ot)Rt=2,35675===Ot?Rt=3:35676===Ot&&(Rt=4),Ge(ot,".uniformMatrix",Rt,"fv(",Zt,",false,",Dt=Ne.global.def("new Float32Array(["+Array.prototype.slice.call(Dt)+"])"),");");else{switch(Ot){case 5126:at="1f";break;case 35664:at="2f";break;case 35665:at="3f";break;case 35666:at="4f";break;case 35670:case 5124:at="1i";break;case 35671:case 35667:at="2i";break;case 35672:case 35668:at="3i";break;case 35673:case 35669:at="4i"}Ge(ot,".uniform",at,"(",Zt,",",na(Dt)?Array.prototype.slice.call(Dt):Dt,");")}continue}ht=Rt.append(Ne,Ge)}else{if(!nt($n))continue;ht=Ge.def(it.uniforms,"[",Qe.id(Dt),"]")}switch(35678===Ot?Ge("if(",ht,"&&",ht,'._reglType==="framebuffer"){',ht,"=",ht,".color[0];","}"):35680===Ot&&Ge("if(",ht,"&&",ht,'._reglType==="framebufferCube"){',ht,"=",ht,".color[0];","}"),Dt=1,Ot){case 35678:case 35680:Ot=Ge.def(ht,"._texture"),Ge(ot,".uniform1i(",Zt,",",Ot,".bind());"),Ge.exit(Ot,".unbind();");continue;case 5124:case 35670:at="1i";break;case 35667:case 35671:at="2i",Dt=2;break;case 35668:case 35672:at="3i",Dt=3;break;case 35669:case 35673:at="4i",Dt=4;break;case 5126:at="1f";break;case 35664:at="2f",Dt=2;break;case 35665:at="3f",Dt=3;break;case 35666:at="4f",Dt=4;break;case 35674:at="Matrix2fv";break;case 35675:at="Matrix3fv";break;case 35676:at="Matrix4fv"}if(Ge(ot,".uniform",at,"(",Zt,","),"M"===at.charAt(0)){Zt=Math.pow(Ot-35674+2,2);var er=Ne.global.def("new Float32Array(",Zt,")");Ge("false,(Array.isArray(",ht,")||",ht," instanceof Float32Array)?",ht,":(",A(Zt,(function(Ne){return er+"["+Ne+"]="+ht+"["+Ne+"]"})),",",er,")")}else Ge(1<Dt?A(Dt,(function(Ne){return ht+"["+Ne+"]"})):ht);Ge(");")}}function aa(Ne,Ge,Qe,tt){function e(rt){var nt=dt[rt];return nt?nt.contextDep&&tt.contextDynamic||nt.propDep?nt.append(Ne,Qe):nt.append(Ne,Ge):Ge.def(ot,".",rt)}function f(){function a(){Qe(nt,".drawElementsInstancedANGLE(",[Dt,Rt,Zt,Ot+"<<(("+Zt+"-5121)>>1)",rt],");")}function b(){Qe(nt,".drawArraysInstancedANGLE(",[Dt,Ot,Rt,rt],");")}ht?er?a():(Qe("if(",ht,"){"),a(),Qe("}else{"),b(),Qe("}")):b()}function g(){function a(){Qe(it+".drawElements("+[Dt,Rt,Zt,Ot+"<<(("+Zt+"-5121)>>1)"]+");")}function b(){Qe(it+".drawArrays("+[Dt,Ot,Rt]+");")}ht?er?a():(Qe("if(",ht,"){"),a(),Qe("}else{"),b(),Qe("}")):b()}var rt,nt,at=Ne.shared,it=at.gl,ot=at.draw,dt=tt.draw,ht=function(){var rt=dt.elements,nt=Ge;return rt?((rt.contextDep&&tt.contextDynamic||rt.propDep)&&(nt=Qe),rt=rt.append(Ne,nt)):rt=nt.def(ot,".","elements"),rt&&nt("if("+rt+")"+it+".bindBuffer(34963,"+rt+".buffer.buffer);"),rt}(),Dt=e("primitive"),Ot=e("offset"),Rt=function(){var rt=dt.count,nt=Ge;return rt?((rt.contextDep&&tt.contextDynamic||rt.propDep)&&(nt=Qe),rt=rt.append(Ne,nt)):rt=nt.def(ot,".","count"),rt}();if("number"==typeof Rt){if(0===Rt)return}else Qe("if(",Rt,"){"),Qe.exit("}");Ar&&(rt=e("instances"),nt=Ne.instancing);var Zt=ht+".type",er=dt.elements&&ua(dt.elements);Ar&&("number"!=typeof rt||0<=rt)?"string"==typeof rt?(Qe("if(",rt,">0){"),f(),Qe("}else if(",rt,"<0){"),g(),Qe("}")):f():g()}function xa(Ne,Ge,Qe,tt,rt){return rt=(Ge=v()).proc("body",rt),Ar&&(Ge.instancing=rt.def(Ge.shared.extensions,".angle_instanced_arrays")),Ne(Ge,rt,Qe,tt),Ge.compile().body}function ba(Ne,Ge,Qe,tt){B(Ne,Ge),Qe.useVAO?Qe.drawVAO?Ge(Ne.shared.vao,".setVAO(",Qe.drawVAO.append(Ne,Ge),");"):Ge(Ne.shared.vao,".setVAO(",Ne.shared.vao,".targetVAO);"):(Ge(Ne.shared.vao,".setVAO(null);"),N(Ne,Ge,Qe,tt.attributes,(function(){return!0}))),wa(Ne,Ge,Qe,tt.uniforms,(function(){return!0})),aa(Ne,Ge,Ge,Qe)}function Da(Ne,Ge){var Qe=Ne.proc("draw",1);B(Ne,Qe),T(Ne,Qe,Ge.context),O(Ne,Qe,Ge.framebuffer),S(Ne,Qe,Ge),K(Ne,Qe,Ge.state),V(Ne,Qe,Ge,!1,!0);var tt=Ge.shader.progVar.append(Ne,Qe);if(Qe(Ne.shared.gl,".useProgram(",tt,".program);"),Ge.shader.program)ba(Ne,Qe,Ge,Ge.shader.program);else{Qe(Ne.shared.vao,".setVAO(null);");var rt=Ne.global.def("{}"),nt=Qe.def(tt,".id"),at=Qe.def(rt,"[",nt,"]");Qe(Ne.cond(at).then(at,".call(this,a0);").else(at,"=",rt,"[",nt,"]=",Ne.link((function(Qe){return xa(ba,Ne,Ge,Qe,1)})),"(",tt,");",at,".call(this,a0);"))}0<Object.keys(Ge.state).length&&Qe(Ne.shared.current,".dirty=true;")}function fa(Ne,Ge,Qe,tt){function e(){return!0}Ne.batchId="a1",B(Ne,Ge),N(Ne,Ge,Qe,tt.attributes,e),wa(Ne,Ge,Qe,tt.uniforms,e),aa(Ne,Ge,Ge,Qe)}function M(Ne,Ge,Qe,tt){function e(Ne){return Ne.contextDep&&rt||Ne.propDep}function f(Ne){return!e(Ne)}B(Ne,Ge);var rt=Qe.contextDep,nt=Ge.def(),at=Ge.def();Ne.shared.props=at,Ne.batchId=nt;var it=Ne.scope(),ot=Ne.scope();Ge(it.entry,"for(",nt,"=0;",nt,"<","a1",";++",nt,"){",at,"=","a0","[",nt,"];",ot,"}",it.exit),Qe.needsContext&&T(Ne,ot,Qe.context),Qe.needsFramebuffer&&O(Ne,ot,Qe.framebuffer),K(Ne,ot,Qe.state,e),Qe.profile&&e(Qe.profile)&&V(Ne,ot,Qe,!1,!0),tt?(Qe.useVAO?Qe.drawVAO?e(Qe.drawVAO)?ot(Ne.shared.vao,".setVAO(",Qe.drawVAO.append(Ne,ot),");"):it(Ne.shared.vao,".setVAO(",Qe.drawVAO.append(Ne,it),");"):it(Ne.shared.vao,".setVAO(",Ne.shared.vao,".targetVAO);"):(it(Ne.shared.vao,".setVAO(null);"),N(Ne,it,Qe,tt.attributes,f),N(Ne,ot,Qe,tt.attributes,e)),wa(Ne,it,Qe,tt.uniforms,f),wa(Ne,ot,Qe,tt.uniforms,e),aa(Ne,it,ot,Qe)):(Ge=Ne.global.def("{}"),tt=Qe.shader.progVar.append(Ne,ot),at=ot.def(tt,".id"),it=ot.def(Ge,"[",at,"]"),ot(Ne.shared.gl,".useProgram(",tt,".program);","if(!",it,"){",it,"=",Ge,"[",at,"]=",Ne.link((function(Ge){return xa(fa,Ne,Qe,Ge,2)})),"(",tt,");}",it,".call(this,a0[",nt,"],",nt,");"))}function X(Ne,Ge){function c(Ne){return Ne.contextDep&&tt||Ne.propDep}var Qe=Ne.proc("batch",2);Ne.batchId="0",B(Ne,Qe);var tt=!1,rt=!0;Object.keys(Ge.context).forEach((function(Ne){tt=tt||Ge.context[Ne].propDep})),tt||(T(Ne,Qe,Ge.context),rt=!1);var nt=!1;if((at=Ge.framebuffer)?(at.propDep?tt=nt=!0:at.contextDep&&tt&&(nt=!0),nt||O(Ne,Qe,at)):O(Ne,Qe,null),Ge.state.viewport&&Ge.state.viewport.propDep&&(tt=!0),S(Ne,Qe,Ge),K(Ne,Qe,Ge.state,(function(Ne){return!c(Ne)})),Ge.profile&&c(Ge.profile)||V(Ne,Qe,Ge,!1,"a1"),Ge.contextDep=tt,Ge.needsContext=rt,Ge.needsFramebuffer=nt,(rt=Ge.shader.progVar).contextDep&&tt||rt.propDep)M(Ne,Qe,Ge,null);else if(rt=rt.append(Ne,Qe),Qe(Ne.shared.gl,".useProgram(",rt,".program);"),Ge.shader.program)M(Ne,Qe,Ge,Ge.shader.program);else{Qe(Ne.shared.vao,".setVAO(null);");var at=Ne.global.def("{}"),it=(nt=Qe.def(rt,".id"),Qe.def(at,"[",nt,"]"));Qe(Ne.cond(it).then(it,".call(this,a0,a1);").else(it,"=",at,"[",nt,"]=",Ne.link((function(Qe){return xa(M,Ne,Ge,Qe,2)})),"(",rt,");",it,".call(this,a0,a1);"))}0<Object.keys(Ge.state).length&&Qe(Ne.shared.current,".dirty=true;")}function Y(Ne,Ge){function d(Qe){var nt=Ge.shader[Qe];nt&&tt.set(rt.shader,"."+Qe,nt.append(Ne,tt))}var tt=Ne.proc("scope",3);Ne.batchId="a2";var rt=Ne.shared,nt=rt.current;T(Ne,tt,Ge.context),Ge.framebuffer&&Ge.framebuffer.append(Ne,tt),wb(Object.keys(Ge.state)).forEach((function(Qe){var nt=Ge.state[Qe].append(Ne,tt);na(nt)?nt.forEach((function(Ge,rt){tt.set(Ne.next[Qe],"["+rt+"]",Ge)})):tt.set(rt.next,"."+Qe,nt)})),V(Ne,tt,Ge,!0,!0),["elements","offset","count","instances","primitive"].forEach((function(Qe){var nt=Ge.draw[Qe];nt&&tt.set(rt.draw,"."+Qe,""+nt.append(Ne,tt))})),Object.keys(Ge.uniforms).forEach((function(nt){tt.set(rt.uniforms,"["+Qe.id(nt)+"]",Ge.uniforms[nt].append(Ne,tt))})),Object.keys(Ge.attributes).forEach((function(Qe){var rt=Ge.attributes[Qe].append(Ne,tt),nt=Ne.scopeAttrib(Qe);Object.keys(new xr).forEach((function(Ne){tt.set(nt,"."+Ne,rt[Ne])}))})),Ge.scopeVAO&&tt.set(rt.vao,".targetVAO",Ge.scopeVAO.append(Ne,tt)),d("vert"),d("frag"),0<Object.keys(Ge.state).length&&(tt(nt,".dirty=true;"),tt.exit(nt,".dirty=true;")),tt("a1(",Ne.shared.context,",a0,",Ne.batchId,");")}function ha(Ne){if("object"==typeof Ne&&!na(Ne)){for(var Qe=Object.keys(Ne),tt=0;tt<Qe.length;++tt)if(Ge.isDynamic(Ne[Qe[tt]]))return!0;return!1}}function ja(Ne,Qe,tt){function d(Ne,Qe){at.forEach((function(tt){var nt=rt[tt];Ge.isDynamic(nt)&&(nt=Ne.invoke(Qe,nt),Qe(ht,".",tt,"=",nt,";"))}))}var rt=Qe.static[tt];if(rt&&ha(rt)){var nt=Ne.global,at=Object.keys(rt),it=!1,ot=!1,dt=!1,ht=Ne.global.def("{}");at.forEach((function(Qe){var tt=rt[Qe];if(Ge.isDynamic(tt))"function"==typeof tt&&(tt=rt[Qe]=Ge.unbox(tt)),Qe=L(tt,null),it=it||Qe.thisDep,dt=dt||Qe.propDep,ot=ot||Qe.contextDep;else{switch(nt(ht,".",Qe,"="),typeof tt){case"number":nt(tt);break;case"string":nt('"',tt,'"');break;case"object":Array.isArray(tt)&&nt("[",tt.join(),"]");break;default:nt(Ne.link(tt))}nt(";")}})),Qe.dynamic[tt]=new Ge.DynamicVariable(4,{thisDep:it,contextDep:ot,propDep:dt,ref:ht,append:d}),delete Qe.static[tt]}}var xr=Dt.Record,br={add:32774,subtract:32778,"reverse subtract":32779};tt.ext_blend_minmax&&(br.min=32775,br.max=32776);var Ar=tt.angle_instanced_arrays,en=tt.webgl_draw_buffers,mn={dirty:!0,profile:mr.profile},xn={},kn=[],Cn={},En={};p("dither",3024),p("blend.enable",3042),l("blend.color","blendColor",[0,0,0,0]),l("blend.equation","blendEquationSeparate",[32774,32774]),l("blend.func","blendFuncSeparate",[1,0,1,0]),p("depth.enable",2929,!0),l("depth.func","depthFunc",513),l("depth.range","depthRange",[0,1]),l("depth.mask","depthMask",!0),l("colorMask","colorMask",[!0,!0,!0,!0]),p("cull.enable",2884),l("cull.face","cullFace",1029),l("frontFace","frontFace",2305),l("lineWidth","lineWidth",1),p("polygonOffset.enable",32823),l("polygonOffset.offset","polygonOffset",[0,0]),p("sample.alpha",32926),p("sample.enable",32928),l("sample.coverage","sampleCoverage",[1,!1]),p("stencil.enable",2960),l("stencil.mask","stencilMask",-1),l("stencil.func","stencilFunc",[519,0,-1]),l("stencil.opFront","stencilOpSeparate",[1028,7680,7680,7680]),l("stencil.opBack","stencilOpSeparate",[1029,7680,7680,7680]),p("scissor.enable",3089),l("scissor.box","scissor",[0,0,Ne.drawingBufferWidth,Ne.drawingBufferHeight]),l("viewport","viewport",[0,0,Ne.drawingBufferWidth,Ne.drawingBufferHeight]);var Pn={gl:Ne,context:er,strings:Qe,next:xn,current:mn,draw:Zt,elements:at,buffer:nt,shader:Rt,attributes:Dt.state,vao:Dt,uniforms:ht,framebuffer:dt,extensions:tt,timer:dr,isBufferArgs:Oa},Dn={primTypes:Ot,compareFuncs:Hn,blendFuncs:Vn,blendEquations:br,stencilOps:qn,glTypes:it,orientationType:Yn};en&&(Dn.backBuffer=[1029],Dn.drawBuffer=A(rt.maxDrawbuffers,(function(Ne){return 0===Ne?[0]:A(Ne,(function(Ne){return 36064+Ne}))})));var In=0;return{next:xn,current:mn,procs:function(){var Ne=v(),Ge=Ne.proc("poll"),Qe=Ne.proc("refresh"),nt=Ne.block();Ge(nt),Qe(nt);var at,it=Ne.shared,ot=it.gl,dt=it.next,ht=it.current;nt(ht,".dirty=false;"),O(Ne,Ge),O(Ne,Qe,null,!0),Ar&&(at=Ne.link(Ar)),tt.oes_vertex_array_object&&Qe(Ne.link(tt.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var Dt=0;Dt<rt.maxAttributes;++Dt){var Ot=Qe.def(it.attributes,"[",Dt,"]"),Rt=Ne.cond(Ot,".buffer");Rt.then(ot,".enableVertexAttribArray(",Dt,");",ot,".bindBuffer(",34962,",",Ot,".buffer.buffer);",ot,".vertexAttribPointer(",Dt,",",Ot,".size,",Ot,".type,",Ot,".normalized,",Ot,".stride,",Ot,".offset);").else(ot,".disableVertexAttribArray(",Dt,");",ot,".vertexAttrib4f(",Dt,",",Ot,".x,",Ot,".y,",Ot,".z,",Ot,".w);",Ot,".buffer=null;"),Qe(Rt),Ar&&Qe(at,".vertexAttribDivisorANGLE(",Dt,",",Ot,".divisor);")}return Qe(Ne.shared.vao,".currentVAO=null;",Ne.shared.vao,".setVAO(",Ne.shared.vao,".targetVAO);"),Object.keys(Cn).forEach((function(tt){var rt=Cn[tt],at=nt.def(dt,".",tt),it=Ne.block();it("if(",at,"){",ot,".enable(",rt,")}else{",ot,".disable(",rt,")}",ht,".",tt,"=",at,";"),Qe(it),Ge("if(",at,"!==",ht,".",tt,"){",it,"}")})),Object.keys(En).forEach((function(tt){var rt,at,it=En[tt],Dt=mn[tt],Ot=Ne.block();Ot(ot,".",it,"("),na(Dt)?(it=Dt.length,rt=Ne.global.def(dt,".",tt),at=Ne.global.def(ht,".",tt),Ot(A(it,(function(Ne){return rt+"["+Ne+"]"})),");",A(it,(function(Ne){return at+"["+Ne+"]="+rt+"["+Ne+"];"})).join("")),Ge("if(",A(it,(function(Ne){return rt+"["+Ne+"]!=="+at+"["+Ne+"]"})).join("||"),"){",Ot,"}")):(rt=nt.def(dt,".",tt),at=nt.def(ht,".",tt),Ot(rt,");",ht,".",tt,"=",rt,";"),Ge("if(",rt,"!==",at,"){",Ot,"}")),Qe(Ot)})),Ne.compile()}(),compile:function(Ne,Ge,Qe,tt,rt){var nt=v();return nt.stats=nt.link(rt),Object.keys(Ge.static).forEach((function(Ne){ja(nt,Ge,Ne)})),Bn.forEach((function(Ge){ja(nt,Ne,Ge)})),Qe=la(Ne,Ge,Qe,tt,nt),Da(nt,Qe),Y(nt,Qe),X(nt,Qe),nt.compile()}}}function zb(Ne,Ge){for(var Qe=0;Qe<Ne.length;++Qe)if(Ne[Qe]===Ge)return Qe;return-1}var H=function(Ne,Ge){for(var Qe=Object.keys(Ge),tt=0;tt<Qe.length;++tt)Ne[Qe[tt]]=Ge[Qe[tt]];return Ne},Ne=0,Ge={DynamicVariable:ja,define:function(Ne,Ge){return new ja(Ne,bb(Ge+""))},isDynamic:function(Ne){return"function"==typeof Ne&&!Ne._reglType||Ne instanceof ja},unbox:function(Ne,Ge){return"function"==typeof Ne?new ja(0,Ne):Ne},accessor:bb},Qe={next:"function"==typeof requestAnimationFrame?function(Ne){return requestAnimationFrame(Ne)}:function(Ne){return setTimeout(Ne,16)},cancel:"function"==typeof cancelAnimationFrame?function(Ne){return cancelAnimationFrame(Ne)}:clearTimeout},tt="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:function(){return+new Date},rt=fb();rt.zero=fb();var Vb=function(Ne,Ge){var Qe=1;Ge.ext_texture_filter_anisotropic&&(Qe=Ne.getParameter(34047));var tt=1,nt=1;Ge.webgl_draw_buffers&&(tt=Ne.getParameter(34852),nt=Ne.getParameter(36063));var at=!!Ge.oes_texture_float;if(at){at=Ne.createTexture(),Ne.bindTexture(3553,at),Ne.texImage2D(3553,0,6408,1,1,0,6408,5126,null);var it=Ne.createFramebuffer();if(Ne.bindFramebuffer(36160,it),Ne.framebufferTexture2D(36160,36064,3553,at,0),Ne.bindTexture(3553,null),36053!==Ne.checkFramebufferStatus(36160))at=!1;else{Ne.viewport(0,0,1,1),Ne.clearColor(1,0,0,1),Ne.clear(16384);var ot=rt.allocType(5126,4);Ne.readPixels(0,0,1,1,6408,5126,ot),Ne.getError()?at=!1:(Ne.deleteFramebuffer(it),Ne.deleteTexture(at),at=1===ot[0]),rt.freeType(ot)}}return ot=!0,"undefined"!=typeof navigator&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent))||(ot=Ne.createTexture(),it=rt.allocType(5121,36),Ne.activeTexture(33984),Ne.bindTexture(34067,ot),Ne.texImage2D(34069,0,6408,3,3,0,6408,5121,it),rt.freeType(it),Ne.bindTexture(34067,null),Ne.deleteTexture(ot),ot=!Ne.getError()),{colorBits:[Ne.getParameter(3410),Ne.getParameter(3411),Ne.getParameter(3412),Ne.getParameter(3413)],depthBits:Ne.getParameter(3414),stencilBits:Ne.getParameter(3415),subpixelBits:Ne.getParameter(3408),extensions:Object.keys(Ge).filter((function(Ne){return!!Ge[Ne]})),maxAnisotropic:Qe,maxDrawbuffers:tt,maxColorAttachments:nt,pointSizeDims:Ne.getParameter(33901),lineWidthDims:Ne.getParameter(33902),maxViewportDims:Ne.getParameter(3386),maxCombinedTextureUnits:Ne.getParameter(35661),maxCubeMapSize:Ne.getParameter(34076),maxRenderbufferSize:Ne.getParameter(34024),maxTextureUnits:Ne.getParameter(34930),maxTextureSize:Ne.getParameter(3379),maxAttributes:Ne.getParameter(34921),maxVertexUniforms:Ne.getParameter(36347),maxVertexTextureUnits:Ne.getParameter(35660),maxVaryingVectors:Ne.getParameter(36348),maxFragmentUniforms:Ne.getParameter(36349),glsl:Ne.getParameter(35724),renderer:Ne.getParameter(7937),vendor:Ne.getParameter(7936),version:Ne.getParameter(7938),readFloat:at,npotTextureCube:ot}},G=function(Ne){return Ne instanceof Uint8Array||Ne instanceof Uint16Array||Ne instanceof Uint32Array||Ne instanceof Int8Array||Ne instanceof Int16Array||Ne instanceof Int32Array||Ne instanceof Float32Array||Ne instanceof Float64Array||Ne instanceof Uint8ClampedArray},J=function(Ne){return Object.keys(Ne).map((function(Ge){return Ne[Ge]}))},nt={shape:function(Ne){for(var Ge=[];Ne.length;Ne=Ne[0])Ge.push(Ne.length);return Ge},flatten:function(Ne,Ge,Qe,tt){var nt=1;if(Ge.length)for(var at=0;at<Ge.length;++at)nt*=Ge[at];else nt=0;switch(Qe=tt||rt.allocType(Qe,nt),Ge.length){case 0:break;case 1:for(tt=Ge[0],Ge=0;Ge<tt;++Ge)Qe[Ge]=Ne[Ge];break;case 2:for(tt=Ge[0],Ge=Ge[1],at=nt=0;at<tt;++at)for(var it=Ne[at],ot=0;ot<Ge;++ot)Qe[nt++]=it[ot];break;case 3:gb(Ne,Ge[0],Ge[1],Ge[2],Qe,0);break;default:hb(Ne,Ge,0,Qe,0)}return Qe}},at={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},it={int8:5120,int16:5122,int32:5124,uint8:5121,uint16:5123,uint32:5125,float:5126,float32:5126},ot={dynamic:35048,stream:35040,static:35044},dt=nt.flatten,ht=nt.shape,Dt=[];Dt[5120]=1,Dt[5122]=2,Dt[5124]=4,Dt[5121]=1,Dt[5123]=2,Dt[5125]=4,Dt[5126]=4;var Ot={points:0,point:0,lines:1,line:1,triangles:4,triangle:4,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},Rt=new Float32Array(1),Zt=new Uint32Array(Rt.buffer),er=[9984,9986,9985,9987],dr=[0,6409,6410,6407,6408],mr={};mr[6409]=mr[6406]=mr[6402]=1,mr[34041]=mr[6410]=2,mr[6407]=mr[35904]=3,mr[6408]=mr[35906]=4;var xr=ka("HTMLCanvasElement"),br=ka("OffscreenCanvas"),Ar=ka("CanvasRenderingContext2D"),en=ka("ImageBitmap"),mn=ka("HTMLImageElement"),xn=ka("HTMLVideoElement"),kn=Object.keys(at).concat([xr,br,Ar,en,mn,xn]),Cn=[];Cn[5121]=1,Cn[5126]=4,Cn[36193]=2,Cn[5123]=2,Cn[5125]=4;var En=[];En[32854]=2,En[32855]=2,En[36194]=2,En[34041]=4,En[33776]=.5,En[33777]=.5,En[33778]=1,En[33779]=1,En[35986]=.5,En[35987]=1,En[34798]=1,En[35840]=.5,En[35841]=.25,En[35842]=.5,En[35843]=.25,En[36196]=.5;var Pn=[];Pn[32854]=2,Pn[32855]=2,Pn[36194]=2,Pn[33189]=2,Pn[36168]=1,Pn[34041]=4,Pn[35907]=4,Pn[34836]=16,Pn[34842]=8,Pn[34843]=6;var Wb=function(Ne,Ge,Qe,tt,rt){function d(Ne){this.id=it++,this.refCount=1,this.renderbuffer=Ne,this.format=32854,this.height=this.width=0,rt.profile&&(this.stats={size:0})}function r(Ge){var Qe=Ge.renderbuffer;Ne.bindRenderbuffer(36161,null),Ne.deleteRenderbuffer(Qe),Ge.renderbuffer=null,Ge.refCount=0,delete ot[Ge.id],tt.renderbufferCount--}var nt={rgba4:32854,rgb565:36194,"rgb5 a1":32855,depth:33189,stencil:36168,"depth stencil":34041};Ge.ext_srgb&&(nt.srgba=35907),Ge.ext_color_buffer_half_float&&(nt.rgba16f=34842,nt.rgb16f=34843),Ge.webgl_color_buffer_float&&(nt.rgba32f=34836);var at=[];Object.keys(nt).forEach((function(Ne){at[nt[Ne]]=Ne}));var it=0,ot={};return d.prototype.decRef=function(){0>=--this.refCount&&r(this)},rt.profile&&(tt.getTotalRenderbufferSize=function(){var Ne=0;return Object.keys(ot).forEach((function(Ge){Ne+=ot[Ge].stats.size})),Ne}),{create:function(Ge,Qe){function k(Ge,Qe){var tt=0,ot=0,dt=32854;if("object"==typeof Ge&&Ge?("shape"in Ge?(tt=0|(ot=Ge.shape)[0],ot=0|ot[1]):("radius"in Ge&&(tt=ot=0|Ge.radius),"width"in Ge&&(tt=0|Ge.width),"height"in Ge&&(ot=0|Ge.height)),"format"in Ge&&(dt=nt[Ge.format])):"number"==typeof Ge?(tt=0|Ge,ot="number"==typeof Qe?0|Qe:tt):Ge||(tt=ot=1),tt!==it.width||ot!==it.height||dt!==it.format)return k.width=it.width=tt,k.height=it.height=ot,it.format=dt,Ne.bindRenderbuffer(36161,it.renderbuffer),Ne.renderbufferStorage(36161,dt,tt,ot),rt.profile&&(it.stats.size=Pn[it.format]*it.width*it.height),k.format=at[it.format],k}var it=new d(Ne.createRenderbuffer());return ot[it.id]=it,tt.renderbufferCount++,k(Ge,Qe),k.resize=function(Ge,Qe){var tt=0|Ge,nt=0|Qe||tt;return tt===it.width&&nt===it.height||(k.width=it.width=tt,k.height=it.height=nt,Ne.bindRenderbuffer(36161,it.renderbuffer),Ne.renderbufferStorage(36161,it.format,tt,nt),rt.profile&&(it.stats.size=Pn[it.format]*it.width*it.height)),k},k._reglType="renderbuffer",k._renderbuffer=it,rt.profile&&(k.stats=it.stats),k.destroy=function(){it.decRef()},k},clear:function(){J(ot).forEach(r)},restore:function(){J(ot).forEach((function(Ge){Ge.renderbuffer=Ne.createRenderbuffer(),Ne.bindRenderbuffer(36161,Ge.renderbuffer),Ne.renderbufferStorage(36161,Ge.format,Ge.width,Ge.height)})),Ne.bindRenderbuffer(36161,null)}}},Dn=[];Dn[6408]=4,Dn[6407]=3;var In=[];In[5121]=1,In[5126]=4,In[36193]=2;var zn=["x","y","z","w"],Bn="blend.func blend.equation stencil.func stencil.opFront stencil.opBack sample.coverage viewport scissor.box polygonOffset.offset".split(" "),Vn={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},Hn={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},qn={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Yn={cw:2304,ccw:2305},$n=new P(!1,!1,!1,(function(){})),Xb=function(Ne,Ge){function c(){this.endQueryIndex=this.startQueryIndex=-1,this.sum=0,this.stats=null}function e(Ne,Ge,Qe){var tt=rt.pop()||new c;tt.startQueryIndex=Ne,tt.endQueryIndex=Ge,tt.sum=0,tt.stats=Qe,nt.push(tt)}if(!Ge.ext_disjoint_timer_query)return null;var Qe=[],tt=[],rt=[],nt=[],at=[],it=[];return{beginQuery:function(Ne){var rt=Qe.pop()||Ge.ext_disjoint_timer_query.createQueryEXT();Ge.ext_disjoint_timer_query.beginQueryEXT(35007,rt),tt.push(rt),e(tt.length-1,tt.length,Ne)},endQuery:function(){Ge.ext_disjoint_timer_query.endQueryEXT(35007)},pushScopeStats:e,update:function(){var Ne,ot;if(0!==(Ne=tt.length)){it.length=Math.max(it.length,Ne+1),at.length=Math.max(at.length,Ne+1),at[0]=0;var dt=it[0]=0;for(ot=Ne=0;ot<tt.length;++ot){var ht=tt[ot];Ge.ext_disjoint_timer_query.getQueryObjectEXT(ht,34919)?(dt+=Ge.ext_disjoint_timer_query.getQueryObjectEXT(ht,34918),Qe.push(ht)):tt[Ne++]=ht,at[ot+1]=dt,it[ot+1]=Ne}for(tt.length=Ne,ot=Ne=0;ot<nt.length;++ot){var Dt=(dt=nt[ot]).startQueryIndex;ht=dt.endQueryIndex,dt.sum+=at[ht]-at[Dt],Dt=it[Dt],(ht=it[ht])===Dt?(dt.stats.gpuTime+=dt.sum/1e6,rt.push(dt)):(dt.startQueryIndex=Dt,dt.endQueryIndex=ht,nt[Ne++]=dt)}nt.length=Ne}},getNumPendingQueries:function(){return tt.length},clear:function(){Qe.push.apply(Qe,tt);for(var Ne=0;Ne<Qe.length;Ne++)Ge.ext_disjoint_timer_query.deleteQueryEXT(Qe[Ne]);tt.length=0,Qe.length=0},restore:function(){tt.length=0,Qe.length=0}}};return function(Ne){function b(){if(0===En.length)ht&&ht.update(),zn=null;else{zn=Qe.next(b),t();for(var Ne=En.length-1;0<=Ne;--Ne){var Ge=En[Ne];Ge&&Ge(Zt,null,0)}rt.flush(),ht&&ht.update()}}function c(){!zn&&0<En.length&&(zn=Qe.next(b))}function e(){zn&&(Qe.cancel(b),zn=null)}function g(Ne){Ne.preventDefault(),e(),Pn.forEach((function(Ne){Ne()}))}function d(Ne){rt.getError(),at.restore(),br.restore(),dr.restore(),Ar.restore(),en.restore(),mn.restore(),mr.restore(),ht&&ht.restore(),xn.procs.refresh(),c(),Dn.forEach((function(Ne){Ne()}))}function r(Ne){function b(Ne){var Qe={},tt={};return Object.keys(Ne).forEach((function(rt){var nt=Ne[rt];Ge.isDynamic(nt)?tt[rt]=Ge.unbox(nt,rt):Qe[rt]=nt})),{dynamic:tt,static:Qe}}function c(Ne){for(;dt.length<Ne;)dt.push(null);return dt}var Qe=b(Ne.context||{}),tt=b(Ne.uniforms||{}),rt=b(Ne.attributes||{}),nt=b(function(Ne){function b(Ne){if(Ne in Ge){var Qe=Ge[Ne];delete Ge[Ne],Object.keys(Qe).forEach((function(tt){Ge[Ne+"."+tt]=Qe[tt]}))}}var Ge=H({},Ne);return delete Ge.uniforms,delete Ge.attributes,delete Ge.context,delete Ge.vao,"stencil"in Ge&&Ge.stencil.op&&(Ge.stencil.opBack=Ge.stencil.opFront=Ge.stencil.op,delete Ge.stencil.op),b("blend"),b("depth"),b("cull"),b("stencil"),b("polygonOffset"),b("scissor"),b("sample"),"vao"in Ne&&(Ge.vao=Ne.vao),Ge}(Ne));Ne={gpuTime:0,cpuTime:0,count:0};var at=(Qe=xn.compile(nt,rt,tt,Qe,Ne)).draw,it=Qe.batch,ot=Qe.scope,dt=[];return H((function(Ne,Ge){var Qe;if("function"==typeof Ne)return ot.call(this,null,Ne,0);if("function"==typeof Ge)if("number"==typeof Ne)for(Qe=0;Qe<Ne;++Qe)ot.call(this,null,Ge,Qe);else{if(!Array.isArray(Ne))return ot.call(this,Ne,Ge,0);for(Qe=0;Qe<Ne.length;++Qe)ot.call(this,Ne[Qe],Ge,Qe)}else if("number"==typeof Ne){if(0<Ne)return it.call(this,c(0|Ne),0|Ne)}else{if(!Array.isArray(Ne))return at.call(this,Ne);if(Ne.length)return it.call(this,Ne,Ne.length)}}),{stats:Ne})}function n(Ne,Ge){var Qe=0;xn.procs.poll();var tt=Ge.color;tt&&(rt.clearColor(+tt[0]||0,+tt[1]||0,+tt[2]||0,+tt[3]||0),Qe|=16384),"depth"in Ge&&(rt.clearDepth(+Ge.depth),Qe|=256),"stencil"in Ge&&(rt.clearStencil(0|Ge.stencil),Qe|=1024),rt.clear(Qe)}function u(Ne){return En.push(Ne),c(),{cancel:function(){function b(){var Ne=zb(En,b);En[Ne]=En[En.length-1],--En.length,0>=En.length&&e()}var Ge=zb(En,Ne);En[Ge]=b}}}function q(){var Ne=kn.viewport,Ge=kn.scissor_box;Ne[0]=Ne[1]=Ge[0]=Ge[1]=0,Zt.viewportWidth=Zt.framebufferWidth=Zt.drawingBufferWidth=Ne[2]=Ge[2]=rt.drawingBufferWidth,Zt.viewportHeight=Zt.framebufferHeight=Zt.drawingBufferHeight=Ne[3]=Ge[3]=rt.drawingBufferHeight}function t(){Zt.tick+=1,Zt.time=z(),q(),xn.procs.poll()}function m(){q(),xn.procs.refresh(),ht&&ht.update()}function z(){return(tt()-Dt)/1e3}if(!(Ne=Fb(Ne)))return null;var rt=Ne.gl,nt=rt.getContextAttributes();rt.isContextLost();var at=Gb(rt,Ne);if(!at)return null;var it=Cb(),ot={vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0},dt=at.extensions,ht=Xb(rt,dt),Dt=tt(),Ot=rt.drawingBufferWidth,Rt=rt.drawingBufferHeight,Zt={tick:0,time:0,viewportWidth:Ot,viewportHeight:Rt,framebufferWidth:Ot,framebufferHeight:Rt,drawingBufferWidth:Ot,drawingBufferHeight:Rt,pixelRatio:Ne.pixelRatio},er=Vb(rt,dt),dr=Hb(rt,ot,Ne,(function(Ne){return mr.destroyBuffer(Ne)})),mr=Pb(rt,dt,er,ot,dr),xr=Ib(rt,dt,dr,ot),br=Qb(rt,it,ot,Ne),Ar=Lb(rt,dt,er,(function(){xn.procs.poll()}),Zt,ot,Ne),en=Wb(rt,dt,er,ot,Ne),mn=Ob(rt,dt,er,Ar,en,ot),xn=Tb(rt,it,dt,er,dr,xr,Ar,mn,{},mr,br,{elements:null,primitive:4,count:-1,offset:0,instances:-1},Zt,ht,Ne),kn=(it=Rb(rt,mn,xn.procs.poll,Zt,nt,dt,er),xn.next),Cn=rt.canvas,En=[],Pn=[],Dn=[],In=[Ne.onDestroy],zn=null;Cn&&(Cn.addEventListener("webglcontextlost",g,!1),Cn.addEventListener("webglcontextrestored",d,!1));var Bn=mn.setFBO=r({framebuffer:Ge.define.call(null,1,"framebuffer")});return m(),nt=H(r,{clear:function(Ne){if("framebuffer"in Ne)if(Ne.framebuffer&&"framebufferCube"===Ne.framebuffer_reglType)for(var Ge=0;6>Ge;++Ge)Bn(H({framebuffer:Ne.framebuffer.faces[Ge]},Ne),n);else Bn(Ne,n);else n(null,Ne)},prop:Ge.define.bind(null,1),context:Ge.define.bind(null,2),this:Ge.define.bind(null,3),draw:r({}),buffer:function(Ne){return dr.create(Ne,34962,!1,!1)},elements:function(Ne){return xr.create(Ne,!1)},texture:Ar.create2D,cube:Ar.createCube,renderbuffer:en.create,framebuffer:mn.create,framebufferCube:mn.createCube,vao:mr.createVAO,attributes:nt,frame:u,on:function(Ne,Ge){var Qe;switch(Ne){case"frame":return u(Ge);case"lost":Qe=Pn;break;case"restore":Qe=Dn;break;case"destroy":Qe=In}return Qe.push(Ge),{cancel:function(){for(var Ne=0;Ne<Qe.length;++Ne)if(Qe[Ne]===Ge){Qe[Ne]=Qe[Qe.length-1],Qe.pop();break}}}},limits:er,hasExtension:function(Ne){return 0<=er.extensions.indexOf(Ne.toLowerCase())},read:it,destroy:function(){En.length=0,e(),Cn&&(Cn.removeEventListener("webglcontextlost",g),Cn.removeEventListener("webglcontextrestored",d)),br.clear(),mn.clear(),en.clear(),Ar.clear(),xr.clear(),dr.clear(),mr.clear(),ht&&ht.clear(),In.forEach((function(Ne){Ne()}))},_gl:rt,_refresh:m,poll:function(){t(),ht&&ht.update()},now:z,stats:ot}),Ne.onDone(null,nt),nt}},"object"==typeof Qe&&void 0!==Ge?Ge.exports=nt():"function"==typeof tt&&tt.amd?tt(nt):rt.createREGL=nt()},{}],541:[function(Ne,Ge,Qe){"use strict";var tt,rt="";function repeat(Ne,Ge){if("string"!=typeof Ne)throw new TypeError("expected a string");if(1===Ge)return Ne;if(2===Ge)return Ne+Ne;var Qe=Ne.length*Ge;if(tt!==Ne||void 0===tt)tt=Ne,rt="";else if(rt.length>=Qe)return rt.substr(0,Qe);for(;Qe>rt.length&&Ge>1;)1&Ge&&(rt+=Ne),Ge>>=1,Ne+=Ne;return rt=(rt+=Ne).substr(0,Qe)}Ge.exports=repeat},{}],542:[function(Ne,Ge,tt){(function(Ne){(function(){Ge.exports=Ne.performance&&Ne.performance.now?function(){return performance.now()}:Date.now||function(){return+new Date}}).call(this)}).call(this,void 0!==Qe.g?Qe.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],543:[function(Ne,Ge,Qe){"use strict";function compressExpansion(Ne){for(var Ge=Ne.length,Qe=Ne[Ne.length-1],tt=Ge,rt=Ge-2;rt>=0;--rt){var nt=Qe;(ot=(it=Ne[rt])-((Qe=nt+it)-nt))&&(Ne[--tt]=Qe,Qe=ot)}var at=0;for(rt=tt;rt<Ge;++rt){var it,ot;(ot=(it=Qe)-((Qe=(nt=Ne[rt])+it)-nt))&&(Ne[at++]=ot)}return Ne[at++]=Qe,Ne.length=at,Ne}Ge.exports=compressExpansion},{}],544:[function(Ne,Ge,Qe){"use strict";var tt=Ne("two-product"),rt=Ne("robust-sum"),nt=Ne("robust-scale"),at=Ne("robust-compress"),it=6;function cofactor(Ne,Ge){for(var Qe=new Array(Ne.length-1),tt=1;tt<Ne.length;++tt)for(var rt=Qe[tt-1]=new Array(Ne.length-1),nt=0,at=0;nt<Ne.length;++nt)nt!==Ge&&(rt[at++]=Ne[tt][nt]);return Qe}function matrix(Ne){for(var Ge=new Array(Ne),Qe=0;Qe<Ne;++Qe){Ge[Qe]=new Array(Ne);for(var tt=0;tt<Ne;++tt)Ge[Qe][tt]=["m[",Qe,"][",tt,"]"].join("")}return Ge}function sign(Ne){return 1&Ne?"-":""}function generateSum(Ne){if(1===Ne.length)return Ne[0];if(2===Ne.length)return["sum(",Ne[0],",",Ne[1],")"].join("");var Ge=Ne.length>>1;return["sum(",generateSum(Ne.slice(0,Ge)),",",generateSum(Ne.slice(Ge)),")"].join("")}function determinant(Ne){if(2===Ne.length)return["sum(prod(",Ne[0][0],",",Ne[1][1],"),prod(-",Ne[0][1],",",Ne[1][0],"))"].join("");for(var Ge=[],Qe=0;Qe<Ne.length;++Qe)Ge.push(["scale(",determinant(cofactor(Ne,Qe)),",",sign(Qe),Ne[0][Qe],")"].join(""));return generateSum(Ge)}function compileDeterminant(Ne){return new Function("sum","scale","prod","compress",["function robustDeterminant",Ne,"(m){return compress(",determinant(matrix(Ne)),")};return robustDeterminant",Ne].join(""))(rt,nt,tt,at)}var ot=[function(){return[0]},function(Ne){return[Ne[0][0]]}];function generateDispatch(){for(;ot.length<it;)ot.push(compileDeterminant(ot.length));for(var Ne=[],Qe=["function robustDeterminant(m){switch(m.length){"],tt=0;tt<it;++tt)Ne.push("det"+tt),Qe.push("case ",tt,":return det",tt,"(m);");Qe.push("}var det=CACHE[m.length];if(!det)det=CACHE[m.length]=gen(m.length);return det(m);}return robustDeterminant"),Ne.push("CACHE","gen",Qe.join(""));var rt=Function.apply(void 0,Ne);for(Ge.exports=rt.apply(void 0,ot.concat([ot,compileDeterminant])),tt=0;tt<ot.length;++tt)Ge.exports[tt]=ot[tt]}generateDispatch()},{"robust-compress":543,"robust-scale":550,"robust-sum":553,"two-product":582}],545:[function(Ne,Ge,Qe){"use strict";var tt=Ne("two-product"),rt=Ne("robust-sum");function robustDotProduct(Ne,Ge){for(var Qe=tt(Ne[0],Ge[0]),nt=1;nt<Ne.length;++nt)Qe=rt(Qe,tt(Ne[nt],Ge[nt]));return Qe}Ge.exports=robustDotProduct},{"robust-sum":553,"two-product":582}],546:[function(Ne,Ge,Qe){"use strict";var tt=Ne("two-product"),rt=Ne("robust-sum"),nt=Ne("robust-subtract"),at=Ne("robust-scale"),it=6;function cofactor(Ne,Ge){for(var Qe=new Array(Ne.length-1),tt=1;tt<Ne.length;++tt)for(var rt=Qe[tt-1]=new Array(Ne.length-1),nt=0,at=0;nt<Ne.length;++nt)nt!==Ge&&(rt[at++]=Ne[tt][nt]);return Qe}function matrix(Ne){for(var Ge=new Array(Ne),Qe=0;Qe<Ne;++Qe){Ge[Qe]=new Array(Ne);for(var tt=0;tt<Ne;++tt)Ge[Qe][tt]=["m",tt,"[",Ne-Qe-2,"]"].join("")}return Ge}function generateSum(Ne){if(1===Ne.length)return Ne[0];if(2===Ne.length)return["sum(",Ne[0],",",Ne[1],")"].join("");var Ge=Ne.length>>1;return["sum(",generateSum(Ne.slice(0,Ge)),",",generateSum(Ne.slice(Ge)),")"].join("")}function makeProduct(Ne,Ge){if("m"===Ne.charAt(0)){if("w"===Ge.charAt(0)){var Qe=Ne.split("[");return["w",Ge.substr(1),"m",Qe[0].substr(1)].join("")}return["prod(",Ne,",",Ge,")"].join("")}return makeProduct(Ge,Ne)}function sign(Ne){return!0&Ne?"-":""}function determinant(Ne){if(2===Ne.length)return[["diff(",makeProduct(Ne[0][0],Ne[1][1]),",",makeProduct(Ne[1][0],Ne[0][1]),")"].join("")];for(var Ge=[],Qe=0;Qe<Ne.length;++Qe)Ge.push(["scale(",generateSum(determinant(cofactor(Ne,Qe))),",",sign(Qe),Ne[0][Qe],")"].join(""));return Ge}function makeSquare(Ne,Ge){for(var Qe=[],tt=0;tt<Ge-2;++tt)Qe.push(["prod(m",Ne,"[",tt,"],m",Ne,"[",tt,"])"].join(""));return generateSum(Qe)}function orientation(Ne){for(var Ge=[],Qe=[],it=matrix(Ne),ot=0;ot<Ne;++ot)it[0][ot]="1",it[Ne-1][ot]="w"+ot;for(ot=0;ot<Ne;++ot)0==(1&ot)?Ge.push.apply(Ge,determinant(cofactor(it,ot))):Qe.push.apply(Qe,determinant(cofactor(it,ot)));var dt=generateSum(Ge),ht=generateSum(Qe),Dt="exactInSphere"+Ne,Ot=[];for(ot=0;ot<Ne;++ot)Ot.push("m"+ot);var Rt=["function ",Dt,"(",Ot.join(),"){"];for(ot=0;ot<Ne;++ot){Rt.push("var w",ot,"=",makeSquare(ot,Ne),";");for(var Zt=0;Zt<Ne;++Zt)Zt!==ot&&Rt.push("var w",ot,"m",Zt,"=scale(w",ot,",m",Zt,"[0]);")}return Rt.push("var p=",dt,",n=",ht,",d=diff(p,n);return d[d.length-1];}return ",Dt),new Function("sum","diff","prod","scale",Rt.join(""))(rt,nt,tt,at)}function inSphere0(){return 0}function inSphere1(){return 0}function inSphere2(){return 0}var ot=[inSphere0,inSphere1,inSphere2];function slowInSphere(Ne){var Ge=ot[Ne.length];return Ge||(Ge=ot[Ne.length]=orientation(Ne.length)),Ge.apply(void 0,Ne)}function generateInSphereTest(){for(;ot.length<=it;)ot.push(orientation(ot.length));for(var Ne=[],Qe=["slow"],tt=0;tt<=it;++tt)Ne.push("a"+tt),Qe.push("o"+tt);var rt=["function testInSphere(",Ne.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(tt=2;tt<=it;++tt)rt.push("case ",tt,":return o",tt,"(",Ne.slice(0,tt).join(),");");rt.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return testInSphere"),Qe.push(rt.join(""));var nt=Function.apply(void 0,Qe);for(Ge.exports=nt.apply(void 0,[slowInSphere].concat(ot)),tt=0;tt<=it;++tt)Ge.exports[tt]=ot[tt]}generateInSphereTest()},{"robust-scale":550,"robust-subtract":552,"robust-sum":553,"two-product":582}],547:[function(Ne,Ge,Qe){"use strict";var tt=Ne("robust-determinant"),rt=6;function generateSolver(Ne){for(var Ge="robustLinearSolve"+Ne+"d",Qe=["function ",Ge,"(A,b){return ["],rt=0;rt<Ne;++rt){Qe.push("det([");for(var nt=0;nt<Ne;++nt){nt>0&&Qe.push(","),Qe.push("[");for(var at=0;at<Ne;++at)at>0&&Qe.push(","),at===rt?Qe.push("+b[",nt,"]"):Qe.push("+A[",nt,"][",at,"]");Qe.push("]")}Qe.push("]),")}Qe.push("det(A)]}return ",Ge);var it=new Function("det",Qe.join(""));return it(Ne<6?tt[Ne]:tt)}function robustLinearSolve0d(){return[0]}function robustLinearSolve1d(Ne,Ge){return[[Ge[0]],[Ne[0][0]]]}var nt=[robustLinearSolve0d,robustLinearSolve1d];function generateDispatch(){for(;nt.length<rt;)nt.push(generateSolver(nt.length));for(var Ne=[],Qe=["function dispatchLinearSolve(A,b){switch(A.length){"],tt=0;tt<rt;++tt)Ne.push("s"+tt),Qe.push("case ",tt,":return s",tt,"(A,b);");Qe.push("}var s=CACHE[A.length];if(!s)s=CACHE[A.length]=g(A.length);return s(A,b)}return dispatchLinearSolve"),Ne.push("CACHE","g",Qe.join(""));var at=Function.apply(void 0,Ne);for(Ge.exports=at.apply(void 0,nt.concat([nt,generateSolver])),tt=0;tt<rt;++tt)Ge.exports[tt]=nt[tt]}generateDispatch()},{"robust-determinant":544}],548:[function(Ne,Ge,Qe){"use strict";var tt=Ne("two-product"),rt=Ne("robust-sum"),nt=Ne("robust-scale"),at=Ne("robust-subtract"),it=5,ot=11102230246251565e-32,dt=(3+16*ot)*ot,ht=(7+56*ot)*ot;function cofactor(Ne,Ge){for(var Qe=new Array(Ne.length-1),tt=1;tt<Ne.length;++tt)for(var rt=Qe[tt-1]=new Array(Ne.length-1),nt=0,at=0;nt<Ne.length;++nt)nt!==Ge&&(rt[at++]=Ne[tt][nt]);return Qe}function matrix(Ne){for(var Ge=new Array(Ne),Qe=0;Qe<Ne;++Qe){Ge[Qe]=new Array(Ne);for(var tt=0;tt<Ne;++tt)Ge[Qe][tt]=["m",tt,"[",Ne-Qe-1,"]"].join("")}return Ge}function sign(Ne){return 1&Ne?"-":""}function generateSum(Ne){if(1===Ne.length)return Ne[0];if(2===Ne.length)return["sum(",Ne[0],",",Ne[1],")"].join("");var Ge=Ne.length>>1;return["sum(",generateSum(Ne.slice(0,Ge)),",",generateSum(Ne.slice(Ge)),")"].join("")}function determinant(Ne){if(2===Ne.length)return[["sum(prod(",Ne[0][0],",",Ne[1][1],"),prod(-",Ne[0][1],",",Ne[1][0],"))"].join("")];for(var Ge=[],Qe=0;Qe<Ne.length;++Qe)Ge.push(["scale(",generateSum(determinant(cofactor(Ne,Qe))),",",sign(Qe),Ne[0][Qe],")"].join(""));return Ge}function orientation(Ne){for(var Ge=[],Qe=[],it=matrix(Ne),ot=[],dt=0;dt<Ne;++dt)0==(1&dt)?Ge.push.apply(Ge,determinant(cofactor(it,dt))):Qe.push.apply(Qe,determinant(cofactor(it,dt))),ot.push("m"+dt);var ht=generateSum(Ge),Dt=generateSum(Qe),Ot="orientation"+Ne+"Exact",Rt=["function ",Ot,"(",ot.join(),"){var p=",ht,",n=",Dt,",d=sub(p,n);return d[d.length-1];};return ",Ot].join("");return new Function("sum","prod","scale","sub",Rt)(rt,tt,nt,at)}var Dt=orientation(3),Ot=orientation(4),Rt=[function(){return 0},function(){return 0},function(Ne,Ge){return Ge[0]-Ne[0]},function(Ne,Ge,Qe){var tt,rt=(Ne[1]-Qe[1])*(Ge[0]-Qe[0]),nt=(Ne[0]-Qe[0])*(Ge[1]-Qe[1]),at=rt-nt;if(rt>0){if(nt<=0)return at;tt=rt+nt}else{if(!(rt<0))return at;if(nt>=0)return at;tt=-(rt+nt)}var it=dt*tt;return at>=it||at<=-it?at:Dt(Ne,Ge,Qe)},function(Ne,Ge,Qe,tt){var rt=Ne[0]-tt[0],nt=Ge[0]-tt[0],at=Qe[0]-tt[0],it=Ne[1]-tt[1],ot=Ge[1]-tt[1],dt=Qe[1]-tt[1],Dt=Ne[2]-tt[2],Rt=Ge[2]-tt[2],Zt=Qe[2]-tt[2],er=nt*dt,dr=at*ot,mr=at*it,xr=rt*dt,br=rt*ot,Ar=nt*it,en=Dt*(er-dr)+Rt*(mr-xr)+Zt*(br-Ar),mn=(Math.abs(er)+Math.abs(dr))*Math.abs(Dt)+(Math.abs(mr)+Math.abs(xr))*Math.abs(Rt)+(Math.abs(br)+Math.abs(Ar))*Math.abs(Zt),xn=ht*mn;return en>xn||-en>xn?en:Ot(Ne,Ge,Qe,tt)}];function slowOrient(Ne){var Ge=Rt[Ne.length];return Ge||(Ge=Rt[Ne.length]=orientation(Ne.length)),Ge.apply(void 0,Ne)}function generateOrientationProc(){for(;Rt.length<=it;)Rt.push(orientation(Rt.length));for(var Ne=[],Qe=["slow"],tt=0;tt<=it;++tt)Ne.push("a"+tt),Qe.push("o"+tt);var rt=["function getOrientation(",Ne.join(),"){switch(arguments.length){case 0:case 1:return 0;"];for(tt=2;tt<=it;++tt)rt.push("case ",tt,":return o",tt,"(",Ne.slice(0,tt).join(),");");rt.push("}var s=new Array(arguments.length);for(var i=0;i<arguments.length;++i){s[i]=arguments[i]};return slow(s);}return getOrientation"),Qe.push(rt.join(""));var nt=Function.apply(void 0,Qe);for(Ge.exports=nt.apply(void 0,[slowOrient].concat(Rt)),tt=0;tt<=it;++tt)Ge.exports[tt]=Rt[tt]}generateOrientationProc()},{"robust-scale":550,"robust-subtract":552,"robust-sum":553,"two-product":582}],549:[function(Ne,Ge,Qe){"use strict";var tt=Ne("robust-sum"),rt=Ne("robust-scale");function robustProduct(Ne,Ge){if(1===Ne.length)return rt(Ge,Ne[0]);if(1===Ge.length)return rt(Ne,Ge[0]);if(0===Ne.length||0===Ge.length)return[0];var Qe=[0];if(Ne.length<Ge.length)for(var nt=0;nt<Ne.length;++nt)Qe=tt(Qe,rt(Ge,Ne[nt]));else for(nt=0;nt<Ge.length;++nt)Qe=tt(Qe,rt(Ne,Ge[nt]));return Qe}Ge.exports=robustProduct},{"robust-scale":550,"robust-sum":553}],550:[function(Ne,Ge,Qe){"use strict";var tt=Ne("two-product"),rt=Ne("two-sum");function scaleLinearExpansion(Ne,Ge){var Qe=Ne.length;if(1===Qe){var nt=tt(Ne[0],Ge);return nt[0]?nt:[nt[1]]}var at=new Array(2*Qe),it=[.1,.1],ot=[.1,.1],dt=0;tt(Ne[0],Ge,it),it[0]&&(at[dt++]=it[0]);for(var ht=1;ht<Qe;++ht){tt(Ne[ht],Ge,ot);var Dt=it[1];rt(Dt,ot[0],it),it[0]&&(at[dt++]=it[0]);var Ot=ot[1],Rt=it[1],Zt=Ot+Rt,er=Rt-(Zt-Ot);it[1]=Zt,er&&(at[dt++]=er)}return it[1]&&(at[dt++]=it[1]),0===dt&&(at[dt++]=0),at.length=dt,at}Ge.exports=scaleLinearExpansion},{"two-product":582,"two-sum":583}],551:[function(Ne,Ge,Qe){"use strict";Ge.exports=segmentsIntersect;var tt=Ne("robust-orientation")[3];function checkCollinear(Ne,Ge,Qe,tt){for(var rt=0;rt<2;++rt){var nt=Ne[rt],at=Ge[rt],it=Math.min(nt,at),ot=Math.max(nt,at),dt=Qe[rt],ht=tt[rt],Dt=Math.min(dt,ht);if(Math.max(dt,ht)<it||ot<Dt)return!1}return!0}function segmentsIntersect(Ne,Ge,Qe,rt){var nt=tt(Ne,Qe,rt),at=tt(Ge,Qe,rt);if(nt>0&&at>0||nt<0&&at<0)return!1;var it=tt(Qe,Ne,Ge),ot=tt(rt,Ne,Ge);return!(it>0&&ot>0||it<0&&ot<0)&&(0!==nt||0!==at||0!==it||0!==ot||checkCollinear(Ne,Ge,Qe,rt))}},{"robust-orientation":548}],552:[function(Ne,Ge,Qe){"use strict";function scalarScalar(Ne,Ge){var Qe=Ne+Ge,tt=Qe-Ne,rt=Ne-(Qe-tt)+(Ge-tt);return rt?[rt,Qe]:[Qe]}function robustSubtract(Ne,Ge){var Qe=0|Ne.length,tt=0|Ge.length;if(1===Qe&&1===tt)return scalarScalar(Ne[0],-Ge[0]);var rt,nt,at=new Array(Qe+tt),it=0,ot=0,dt=0,ht=Math.abs,Dt=Ne[ot],Ot=ht(Dt),Rt=-Ge[dt],Zt=ht(Rt);Ot<Zt?(nt=Dt,(ot+=1)<Qe&&(Ot=ht(Dt=Ne[ot]))):(nt=Rt,(dt+=1)<tt&&(Zt=ht(Rt=-Ge[dt]))),ot<Qe&&Ot<Zt||dt>=tt?(rt=Dt,(ot+=1)<Qe&&(Ot=ht(Dt=Ne[ot]))):(rt=Rt,(dt+=1)<tt&&(Zt=ht(Rt=-Ge[dt])));for(var er,dr,mr=rt+nt,xr=mr-rt,br=nt-xr,Ar=br,en=mr;ot<Qe&&dt<tt;)Ot<Zt?(rt=Dt,(ot+=1)<Qe&&(Ot=ht(Dt=Ne[ot]))):(rt=Rt,(dt+=1)<tt&&(Zt=ht(Rt=-Ge[dt]))),(br=(nt=Ar)-(xr=(mr=rt+nt)-rt))&&(at[it++]=br),Ar=en-((er=en+mr)-(dr=er-en))+(mr-dr),en=er;for(;ot<Qe;)(br=(nt=Ar)-(xr=(mr=(rt=Dt)+nt)-rt))&&(at[it++]=br),Ar=en-((er=en+mr)-(dr=er-en))+(mr-dr),en=er,(ot+=1)<Qe&&(Dt=Ne[ot]);for(;dt<tt;)(br=(nt=Ar)-(xr=(mr=(rt=Rt)+nt)-rt))&&(at[it++]=br),Ar=en-((er=en+mr)-(dr=er-en))+(mr-dr),en=er,(dt+=1)<tt&&(Rt=-Ge[dt]);return Ar&&(at[it++]=Ar),en&&(at[it++]=en),it||(at[it++]=0),at.length=it,at}Ge.exports=robustSubtract},{}],553:[function(Ne,Ge,Qe){"use strict";function scalarScalar(Ne,Ge){var Qe=Ne+Ge,tt=Qe-Ne,rt=Ne-(Qe-tt)+(Ge-tt);return rt?[rt,Qe]:[Qe]}function linearExpansionSum(Ne,Ge){var Qe=0|Ne.length,tt=0|Ge.length;if(1===Qe&&1===tt)return scalarScalar(Ne[0],Ge[0]);var rt,nt,at=new Array(Qe+tt),it=0,ot=0,dt=0,ht=Math.abs,Dt=Ne[ot],Ot=ht(Dt),Rt=Ge[dt],Zt=ht(Rt);Ot<Zt?(nt=Dt,(ot+=1)<Qe&&(Ot=ht(Dt=Ne[ot]))):(nt=Rt,(dt+=1)<tt&&(Zt=ht(Rt=Ge[dt]))),ot<Qe&&Ot<Zt||dt>=tt?(rt=Dt,(ot+=1)<Qe&&(Ot=ht(Dt=Ne[ot]))):(rt=Rt,(dt+=1)<tt&&(Zt=ht(Rt=Ge[dt])));for(var er,dr,mr=rt+nt,xr=mr-rt,br=nt-xr,Ar=br,en=mr;ot<Qe&&dt<tt;)Ot<Zt?(rt=Dt,(ot+=1)<Qe&&(Ot=ht(Dt=Ne[ot]))):(rt=Rt,(dt+=1)<tt&&(Zt=ht(Rt=Ge[dt]))),(br=(nt=Ar)-(xr=(mr=rt+nt)-rt))&&(at[it++]=br),Ar=en-((er=en+mr)-(dr=er-en))+(mr-dr),en=er;for(;ot<Qe;)(br=(nt=Ar)-(xr=(mr=(rt=Dt)+nt)-rt))&&(at[it++]=br),Ar=en-((er=en+mr)-(dr=er-en))+(mr-dr),en=er,(ot+=1)<Qe&&(Dt=Ne[ot]);for(;dt<tt;)(br=(nt=Ar)-(xr=(mr=(rt=Rt)+nt)-rt))&&(at[it++]=br),Ar=en-((er=en+mr)-(dr=er-en))+(mr-dr),en=er,(dt+=1)<tt&&(Rt=Ge[dt]);return Ar&&(at[it++]=Ar),en&&(at[it++]=en),it||(at[it++]=0),at.length=it,at}Ge.exports=linearExpansionSum},{}],554:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne){return Ne<0?-1:Ne>0?1:0}},{}],555:[function(Ne,Ge,Qe){"use strict";Ge.exports=boundary;var tt=Ne("boundary-cells"),rt=Ne("reduce-simplicial-complex");function boundary(Ne){return rt(tt(Ne))}},{"boundary-cells":100,"reduce-simplicial-complex":533}],556:[function(Ne,Ge,Qe){"use strict";Ge.exports=extractContour;var tt=Ne("ndarray"),rt=Ne("typedarray-pool"),nt=Ne("ndarray-sort"),at=Ne("./lib/codegen");function getDimension(Ne){for(var Ge=Ne.length,Qe=0,tt=0;tt<Ge;++tt)Qe=0|Math.max(Qe,Ne[tt].length);return Qe-1}function getSigns(Ne,Ge){for(var Qe=Ne.length,tt=rt.mallocUint8(Qe),nt=0;nt<Qe;++nt)tt[nt]=Ne[nt]<Ge|0;return tt}function getEdges(Ne,Ge){for(var Qe=Ne.length,at=Ge*(Ge+1)/2*Qe|0,it=rt.mallocUint32(2*at),ot=0,dt=0;dt<Qe;++dt)for(var ht=Ne[dt],Dt=(Ge=ht.length,0);Dt<Ge;++Dt)for(var Ot=0;Ot<Dt;++Ot){var Rt=ht[Ot],Zt=ht[Dt];it[ot++]=0|Math.min(Rt,Zt),it[ot++]=0|Math.max(Rt,Zt)}nt(tt(it,[ot/2|0,2]));var er=2;for(dt=2;dt<ot;dt+=2)it[dt-2]===it[dt]&&it[dt-1]===it[dt+1]||(it[er++]=it[dt],it[er++]=it[dt+1]);return tt(it,[er/2|0,2])}function getCrossingWeights(Ne,Ge,Qe,nt){for(var at=Ne.data,it=Ne.shape[0],ot=rt.mallocDouble(it),dt=0,ht=0;ht<it;++ht){var Dt=at[2*ht],Ot=at[2*ht+1];if(Qe[Dt]!==Qe[Ot]){var Rt=Ge[Dt],Zt=Ge[Ot];at[2*dt]=Dt,at[2*dt+1]=Ot,ot[dt++]=(Zt-nt)/(Zt-Rt)}}return Ne.shape[0]=dt,tt(ot,[dt])}function getCascade(Ne,Ge){var Qe=rt.mallocInt32(2*Ge),tt=Ne.shape[0],nt=Ne.data;Qe[0]=0;for(var at=0,it=0;it<tt;++it){var ot=nt[2*it];if(ot!==at){for(Qe[2*at+1]=it;++at<ot;)Qe[2*at]=it,Qe[2*at+1]=it;Qe[2*at]=it}}for(Qe[2*at+1]=tt;++at<Ge;)Qe[2*at]=Qe[2*at+1]=tt;return Qe}function unpackEdges(Ne){for(var Ge=0|Ne.shape[0],Qe=Ne.data,tt=new Array(Ge),rt=0;rt<Ge;++rt)tt[rt]=[Qe[2*rt],Qe[2*rt+1]];return tt}function extractContour(Ne,Ge,Qe,tt){if(Qe=Qe||0,void 0===tt&&(tt=getDimension(Ne)),0===Ne.length||tt<1)return{cells:[],vertexIds:[],vertexWeights:[]};var nt=getSigns(Ge,+Qe),it=getEdges(Ne,tt),ot=getCrossingWeights(it,Ge,nt,+Qe),dt=getCascade(it,0|Ge.length),ht=at(tt)(Ne,it.data,dt,nt),Dt=unpackEdges(it),Ot=[].slice.call(ot.data,0,ot.shape[0]);return rt.free(nt),rt.free(it.data),rt.free(ot.data),rt.free(dt),{cells:ht,vertexIds:Dt,vertexWeights:Ot}}},{"./lib/codegen":557,ndarray:495,"ndarray-sort":494,"typedarray-pool":595}],557:[function(Ne,Ge,Qe){"use strict";Ge.exports=getPolygonizer;var tt=Ne("typedarray-pool"),rt=Ne("marching-simplex-table"),nt={};function createCellPolygonizer(Ne){var Ge=0,Qe=new Array(Ne+1);Qe[0]=[[]];for(var nt=1;nt<=Ne;++nt)for(var at=Qe[nt]=rt(nt),it=0;it<at.length;++it)Ge=Math.max(Ge,at[nt].length);var ot=["function B(C,E,i,j){","var a=Math.min(i,j)|0,b=Math.max(i,j)|0,l=C[2*a],h=C[2*a+1];","while(l<h){","var m=(l+h)>>1,v=E[2*m+1];","if(v===b){return m}","if(b<v){h=m}else{l=m+1}","}","return l;","};","function getContour",Ne,"d(F,E,C,S){","var n=F.length,R=[];","for(var i=0;i<n;++i){var c=F[i],l=c.length;"];function generateCase(Ne){if(!(Ne.length<=0)){ot.push("R.push(");for(var Ge=0;Ge<Ne.length;++Ge){var Qe=Ne[Ge];Ge>0&&ot.push(","),ot.push("[");for(var tt=0;tt<Qe.length;++tt){var rt=Qe[tt];tt>0&&ot.push(","),ot.push("B(C,E,c[",rt[0],"],c[",rt[1],"])")}ot.push("]")}ot.push(");")}}for(nt=Ne+1;nt>1;--nt){nt<Ne+1&&ot.push("else "),ot.push("if(l===",nt,"){");var dt=[];for(it=0;it<nt;++it)dt.push("(S[c["+it+"]]<<"+it+")");for(ot.push("var M=",dt.join("+"),";if(M===0||M===",(1<<nt)-1,"){continue}switch(M){"),at=Qe[nt-1],it=0;it<at.length;++it)ot.push("case ",it,":"),generateCase(at[it]),ot.push("break;");ot.push("}}")}return ot.push("}return R;};return getContour",Ne,"d"),new Function("pool",ot.join(""))(tt)}function getPolygonizer(Ne){var Ge=nt[Ne];return Ge||(Ge=nt[Ne]=createCellPolygonizer(Ne)),Ge}},{"marching-simplex-table":474,"typedarray-pool":595}],558:[function(Ne,Ge,Qe){"use strict";var tt=Ne("bit-twiddle"),rt=Ne("union-find");function dimension(Ne){for(var Ge=0,Qe=Math.max,tt=0,rt=Ne.length;tt<rt;++tt)Ge=Qe(Ge,Ne[tt].length);return Ge-1}function countVertices(Ne){for(var Ge=-1,Qe=Math.max,tt=0,rt=Ne.length;tt<rt;++tt)for(var nt=Ne[tt],at=0,it=nt.length;at<it;++at)Ge=Qe(Ge,nt[at]);return Ge+1}function cloneCells(Ne){for(var Ge=new Array(Ne.length),Qe=0,tt=Ne.length;Qe<tt;++Qe)Ge[Qe]=Ne[Qe].slice(0);return Ge}function compareCells(Ne,Ge){var Qe=Ne.length,tt=Ne.length-Ge.length,rt=Math.min;if(tt)return tt;switch(Qe){case 0:return 0;case 1:return Ne[0]-Ge[0];case 2:return(it=Ne[0]+Ne[1]-Ge[0]-Ge[1])||rt(Ne[0],Ne[1])-rt(Ge[0],Ge[1]);case 3:var nt=Ne[0]+Ne[1],at=Ge[0]+Ge[1];if(it=nt+Ne[2]-(at+Ge[2]))return it;var it,ot=rt(Ne[0],Ne[1]),dt=rt(Ge[0],Ge[1]);return(it=rt(ot,Ne[2])-rt(dt,Ge[2]))||rt(ot+Ne[2],nt)-rt(dt+Ge[2],at);default:var ht=Ne.slice(0);ht.sort();var Dt=Ge.slice(0);Dt.sort();for(var Ot=0;Ot<Qe;++Ot)if(tt=ht[Ot]-Dt[Ot])return tt;return 0}}function compareZipped(Ne,Ge){return compareCells(Ne[0],Ge[0])}function normalize(Ne,Ge){if(Ge){for(var Qe=Ne.length,tt=new Array(Qe),rt=0;rt<Qe;++rt)tt[rt]=[Ne[rt],Ge[rt]];for(tt.sort(compareZipped),rt=0;rt<Qe;++rt)Ne[rt]=tt[rt][0],Ge[rt]=tt[rt][1];return Ne}return Ne.sort(compareCells),Ne}function unique(Ne){if(0===Ne.length)return[];for(var Ge=1,Qe=Ne.length,tt=1;tt<Qe;++tt){var rt=Ne[tt];if(compareCells(rt,Ne[tt-1])){if(tt===Ge){Ge++;continue}Ne[Ge++]=rt}}return Ne.length=Ge,Ne}function findCell(Ne,Ge){for(var Qe=0,tt=Ne.length-1,rt=-1;Qe<=tt;){var nt=Qe+tt>>1,at=compareCells(Ne[nt],Ge);at<=0?(0===at&&(rt=nt),Qe=nt+1):at>0&&(tt=nt-1)}return rt}function incidence(Ne,Ge){for(var Qe=new Array(Ne.length),rt=0,nt=Qe.length;rt<nt;++rt)Qe[rt]=[];for(var at=[],it=(rt=0,Ge.length);rt<it;++rt)for(var ot=Ge[rt],dt=ot.length,ht=1,Dt=1<<dt;ht<Dt;++ht){at.length=tt.popCount(ht);for(var Ot=0,Rt=0;Rt<dt;++Rt)ht&1<<Rt&&(at[Ot++]=ot[Rt]);var Zt=findCell(Ne,at);if(!(Zt<0))for(;Qe[Zt++].push(rt),!(Zt>=Ne.length||0!==compareCells(Ne[Zt],at)););}return Qe}function dual(Ne,Ge){if(!Ge)return incidence(unique(skeleton(Ne,0)),Ne,0);for(var Qe=new Array(Ge),tt=0;tt<Ge;++tt)Qe[tt]=[];tt=0;for(var rt=Ne.length;tt<rt;++tt)for(var nt=Ne[tt],at=0,it=nt.length;at<it;++at)Qe[nt[at]].push(tt);return Qe}function explode(Ne){for(var Ge=[],Qe=0,tt=Ne.length;Qe<tt;++Qe)for(var rt=Ne[Qe],nt=0|rt.length,at=1,it=1<<nt;at<it;++at){for(var ot=[],dt=0;dt<nt;++dt)at>>>dt&1&&ot.push(rt[dt]);Ge.push(ot)}return normalize(Ge)}function skeleton(Ne,Ge){if(Ge<0)return[];for(var Qe=[],rt=(1<<Ge+1)-1,nt=0;nt<Ne.length;++nt)for(var at=Ne[nt],it=rt;it<1<<at.length;it=tt.nextCombination(it)){for(var ot=new Array(Ge+1),dt=0,ht=0;ht<at.length;++ht)it&1<<ht&&(ot[dt++]=at[ht]);Qe.push(ot)}return normalize(Qe)}function boundary(Ne){for(var Ge=[],Qe=0,tt=Ne.length;Qe<tt;++Qe)for(var rt=Ne[Qe],nt=0,at=rt.length;nt<at;++nt){for(var it=new Array(rt.length-1),ot=0,dt=0;ot<at;++ot)ot!==nt&&(it[dt++]=rt[ot]);Ge.push(it)}return normalize(Ge)}function connectedComponents_dense(Ne,Ge){for(var Qe=new rt(Ge),tt=0;tt<Ne.length;++tt)for(var nt=Ne[tt],at=0;at<nt.length;++at)for(var it=at+1;it<nt.length;++it)Qe.link(nt[at],nt[it]);var ot=[],dt=Qe.ranks;for(tt=0;tt<dt.length;++tt)dt[tt]=-1;for(tt=0;tt<Ne.length;++tt){var ht=Qe.find(Ne[tt][0]);dt[ht]<0?(dt[ht]=ot.length,ot.push([Ne[tt].slice(0)])):ot[dt[ht]].push(Ne[tt].slice(0))}return ot}function connectedComponents_sparse(Ne){for(var Ge=unique(normalize(skeleton(Ne,0))),Qe=new rt(Ge.length),tt=0;tt<Ne.length;++tt)for(var nt=Ne[tt],at=0;at<nt.length;++at)for(var it=findCell(Ge,[nt[at]]),ot=at+1;ot<nt.length;++ot)Qe.link(it,findCell(Ge,[nt[ot]]));var dt=[],ht=Qe.ranks;for(tt=0;tt<ht.length;++tt)ht[tt]=-1;for(tt=0;tt<Ne.length;++tt){var Dt=Qe.find(findCell(Ge,[Ne[tt][0]]));ht[Dt]<0?(ht[Dt]=dt.length,dt.push([Ne[tt].slice(0)])):dt[ht[Dt]].push(Ne[tt].slice(0))}return dt}function connectedComponents(Ne,Ge){return Ge?connectedComponents_dense(Ne,Ge):connectedComponents_sparse(Ne)}Qe.dimension=dimension,Qe.countVertices=countVertices,Qe.cloneCells=cloneCells,Qe.compareCells=compareCells,Qe.normalize=normalize,Qe.unique=unique,Qe.findCell=findCell,Qe.incidence=incidence,Qe.dual=dual,Qe.explode=explode,Qe.skeleton=skeleton,Qe.boundary=boundary,Qe.connectedComponents=connectedComponents},{"bit-twiddle":97,"union-find":596}],559:[function(Ne,Ge,Qe){arguments[4][97][0].apply(Qe,arguments)},{dup:97}],560:[function(Ne,Ge,Qe){arguments[4][558][0].apply(Qe,arguments)},{"bit-twiddle":559,dup:558,"union-find":561}],561:[function(Ne,Ge,Qe){"use strict";function UnionFind(Ne){this.roots=new Array(Ne),this.ranks=new Array(Ne);for(var Ge=0;Ge<Ne;++Ge)this.roots[Ge]=Ge,this.ranks[Ge]=0}Ge.exports=UnionFind,UnionFind.prototype.length=function(){return this.roots.length},UnionFind.prototype.makeSet=function(){var Ne=this.roots.length;return this.roots.push(Ne),this.ranks.push(0),Ne},UnionFind.prototype.find=function(Ne){for(var Ge=this.roots;Ge[Ne]!==Ne;){var Qe=Ge[Ne];Ge[Ne]=Ge[Qe],Ne=Qe}return Ne},UnionFind.prototype.link=function(Ne,Ge){var Qe=this.find(Ne),tt=this.find(Ge);if(Qe!==tt){var rt=this.ranks,nt=this.roots,at=rt[Qe],it=rt[tt];at<it?nt[Qe]=tt:it<at?nt[tt]=Qe:(nt[tt]=Qe,++rt[Qe])}}},{}],562:[function(Ne,Ge,Qe){"use strict";Ge.exports=simplifyPolygon;var tt=Ne("robust-orientation"),rt=Ne("simplicial-complex");function errorWeight(Ne,Ge,Qe){return Math.abs(tt(Ne,Ge,Qe))/Math.sqrt(Math.pow(Ge[0]-Qe[0],2)+Math.pow(Ge[1]-Qe[1],2))}function simplifyPolygon(Ne,Ge,Qe){for(var tt=Ge.length,nt=Ne.length,at=new Array(tt),it=new Array(tt),ot=new Array(tt),dt=new Array(tt),ht=0;ht<tt;++ht)at[ht]=it[ht]=-1,ot[ht]=1/0,dt[ht]=!1;for(ht=0;ht<nt;++ht){var Dt=Ne[ht];if(2!==Dt.length)throw new Error("Input must be a graph");var Ot=Dt[1],Rt=Dt[0];-1!==it[Rt]?it[Rt]=-2:it[Rt]=Ot,-1!==at[Ot]?at[Ot]=-2:at[Ot]=Rt}function computeWeight(Ne){if(dt[Ne])return 1/0;var Qe=at[Ne],tt=it[Ne];return Qe<0||tt<0?1/0:errorWeight(Ge[Ne],Ge[Qe],Ge[tt])}function heapSwap(Ne,Ge){var Qe=Zt[Ne],tt=Zt[Ge];Zt[Ne]=tt,Zt[Ge]=Qe,er[Qe]=Ge,er[tt]=Ne}function heapWeight(Ne){return ot[Zt[Ne]]}function heapParent(Ne){return 1&Ne?Ne-1>>1:(Ne>>1)-1}function heapDown(Ne){for(var Ge=heapWeight(Ne);;){var Qe=Ge,tt=2*Ne+1,rt=2*(Ne+1),nt=Ne;if(tt<dr){var at=heapWeight(tt);at<Qe&&(nt=tt,Qe=at)}if(rt<dr&&heapWeight(rt)<Qe&&(nt=rt),nt===Ne)return Ne;heapSwap(Ne,nt),Ne=nt}}function heapUp(Ne){for(var Ge=heapWeight(Ne);Ne>0;){var Qe=heapParent(Ne);if(!(Qe>=0&&Ge<heapWeight(Qe)))return Ne;heapSwap(Ne,Qe),Ne=Qe}}function heapPop(){if(dr>0){var Ne=Zt[0];return heapSwap(0,dr-1),dr-=1,heapDown(0),Ne}return-1}function heapUpdate(Ne,Ge){var Qe=Zt[Ne];return ot[Qe]===Ge?Ne:(ot[Qe]=-1/0,heapUp(Ne),heapPop(),ot[Qe]=Ge,heapUp((dr+=1)-1))}function kill(Ne){if(!dt[Ne]){dt[Ne]=!0;var Ge=at[Ne],Qe=it[Ne];at[Qe]>=0&&(at[Qe]=Ge),it[Ge]>=0&&(it[Ge]=Qe),er[Ge]>=0&&heapUpdate(er[Ge],computeWeight(Ge)),er[Qe]>=0&&heapUpdate(er[Qe],computeWeight(Qe))}}var Zt=[],er=new Array(tt);for(ht=0;ht<tt;++ht)(ot[ht]=computeWeight(ht))<1/0?(er[ht]=Zt.length,Zt.push(ht)):er[ht]=-1;var dr=Zt.length;for(ht=dr>>1;ht>=0;--ht)heapDown(ht);for(;;){var mr=heapPop();if(mr<0||ot[mr]>Qe)break;kill(mr)}var xr=[];for(ht=0;ht<tt;++ht)dt[ht]||(er[ht]=xr.length,xr.push(Ge[ht].slice()));function tortoiseHare(Ne,Ge){if(Ne[Ge]<0)return Ge;var Qe=Ge,tt=Ge;do{var rt=Ne[tt];if(!dt[tt]||rt<0||rt===tt)break;if(rt=Ne[tt=rt],!dt[tt]||rt<0||rt===tt)break;tt=rt,Qe=Ne[Qe]}while(Qe!==tt);for(var nt=Ge;nt!==tt;nt=Ne[nt])Ne[nt]=tt;return tt}xr.length;var br=[];return Ne.forEach((function(Ne){var Ge=tortoiseHare(at,Ne[0]),Qe=tortoiseHare(it,Ne[1]);if(Ge>=0&&Qe>=0&&Ge!==Qe){var tt=er[Ge],rt=er[Qe];tt!==rt&&br.push([tt,rt])}})),rt.unique(rt.normalize(br)),{positions:xr,edges:br}}},{"robust-orientation":548,"simplicial-complex":560}],563:[function(Ne,Ge,Qe){"use strict";Ge.exports=orderSegments;var tt=Ne("robust-orientation");function horizontalOrder(Ne,Ge){var Qe,rt,nt,at;if(Ge[0][0]<Ge[1][0])Qe=Ge[0],rt=Ge[1];else{if(!(Ge[0][0]>Ge[1][0])){var it=Math.min(Ne[0][1],Ne[1][1]),ot=Math.max(Ne[0][1],Ne[1][1]),dt=Math.min(Ge[0][1],Ge[1][1]),ht=Math.max(Ge[0][1],Ge[1][1]);return ot<dt?ot-dt:it>ht?it-ht:ot-ht}Qe=Ge[1],rt=Ge[0]}Ne[0][1]<Ne[1][1]?(nt=Ne[0],at=Ne[1]):(nt=Ne[1],at=Ne[0]);var Dt=tt(rt,Qe,nt);return Dt||(Dt=tt(rt,Qe,at))||at-rt}function orderSegments(Ne,Ge){var Qe,rt,nt,at;if(Ge[0][0]<Ge[1][0])Qe=Ge[0],rt=Ge[1];else{if(!(Ge[0][0]>Ge[1][0]))return horizontalOrder(Ge,Ne);Qe=Ge[1],rt=Ge[0]}if(Ne[0][0]<Ne[1][0])nt=Ne[0],at=Ne[1];else{if(!(Ne[0][0]>Ne[1][0]))return-horizontalOrder(Ne,Ge);nt=Ne[1],at=Ne[0]}var it=tt(Qe,rt,at),ot=tt(Qe,rt,nt);if(it<0){if(ot<=0)return it}else if(it>0){if(ot>=0)return it}else if(ot)return ot;if(it=tt(at,nt,rt),ot=tt(at,nt,Qe),it<0){if(ot<=0)return it}else if(it>0){if(ot>=0)return it}else if(ot)return ot;return rt[0]-at[0]}},{"robust-orientation":548}],564:[function(Ne,Ge,Qe){arguments[4][243][0].apply(Qe,arguments)},{dup:243}],565:[function(Ne,Ge,Qe){"use strict";Ge.exports=createSlabDecomposition;var tt=Ne("binary-search-bounds"),rt=Ne("functional-red-black-tree"),nt=Ne("robust-orientation"),at=Ne("./lib/order-segments");function SlabDecomposition(Ne,Ge,Qe){this.slabs=Ne,this.coordinates=Ge,this.horizontal=Qe}function compareHorizontal(Ne,Ge){return Ne.y-Ge}function searchBucket(Ne,Ge){for(var Qe=null;Ne;){var tt,rt,at=Ne.key;at[0][0]<at[1][0]?(tt=at[0],rt=at[1]):(tt=at[1],rt=at[0]);var it=nt(tt,rt,Ge);if(it<0)Ne=Ne.left;else if(it>0)if(Ge[0]!==at[1][0])Qe=Ne,Ne=Ne.right;else{if(ot=searchBucket(Ne.right,Ge))return ot;Ne=Ne.left}else{if(Ge[0]!==at[1][0])return Ne;var ot;if(ot=searchBucket(Ne.right,Ge))return ot;Ne=Ne.left}}return Qe}function IntervalSegment(Ne,Ge,Qe,tt){this.y=Ne,this.index=Ge,this.start=Qe,this.closed=tt}function Event(Ne,Ge,Qe,tt){this.x=Ne,this.segment=Ge,this.create=Qe,this.index=tt}function createSlabDecomposition(Ne){for(var Ge=Ne.length,Qe=2*Ge,tt=new Array(Qe),nt=0;nt<Ge;++nt){var it=Ne[nt],ot=it[0][0]<it[1][0];tt[2*nt]=new Event(it[0][0],it,ot,nt),tt[2*nt+1]=new Event(it[1][0],it,!ot,nt)}tt.sort((function(Ne,Ge){var Qe=Ne.x-Ge.x;return Qe||(Qe=Ne.create-Ge.create)||Math.min(Ne.segment[0][1],Ne.segment[1][1])-Math.min(Ge.segment[0][1],Ge.segment[1][1])}));var dt=rt(at),ht=[],Dt=[],Ot=[];for(nt=0;nt<Qe;){for(var Rt=tt[nt].x,Zt=[];nt<Qe;){var er=tt[nt];if(er.x!==Rt)break;nt+=1,er.segment[0][0]===er.x&&er.segment[1][0]===er.x?er.create&&(er.segment[0][1]<er.segment[1][1]?(Zt.push(new IntervalSegment(er.segment[0][1],er.index,!0,!0)),Zt.push(new IntervalSegment(er.segment[1][1],er.index,!1,!1))):(Zt.push(new IntervalSegment(er.segment[1][1],er.index,!0,!1)),Zt.push(new IntervalSegment(er.segment[0][1],er.index,!1,!0)))):dt=er.create?dt.insert(er.segment,er.index):dt.remove(er.segment)}ht.push(dt.root),Dt.push(Rt),Ot.push(Zt)}return new SlabDecomposition(ht,Dt,Ot)}SlabDecomposition.prototype.castUp=function(Ne){var Ge=tt.le(this.coordinates,Ne[0]);if(Ge<0)return-1;this.slabs[Ge];var Qe=searchBucket(this.slabs[Ge],Ne),rt=-1;if(Qe&&(rt=Qe.value),this.coordinates[Ge]===Ne[0]){var it=null;if(Qe&&(it=Qe.key),Ge>0){var ot=searchBucket(this.slabs[Ge-1],Ne);ot&&(it?at(ot.key,it)>0&&(it=ot.key,rt=ot.value):(rt=ot.value,it=ot.key))}var dt=this.horizontal[Ge];if(dt.length>0){var ht=tt.ge(dt,Ne[1],compareHorizontal);if(ht<dt.length){var Dt=dt[ht];if(Ne[1]===Dt.y){if(Dt.closed)return Dt.index;for(;ht<dt.length-1&&dt[ht+1].y===Ne[1];)if((Dt=dt[ht+=1]).closed)return Dt.index;if(Dt.y===Ne[1]&&!Dt.start){if((ht+=1)>=dt.length)return rt;Dt=dt[ht]}}if(Dt.start)if(it){var Ot=nt(it[0],it[1],[Ne[0],Dt.y]);it[0][0]>it[1][0]&&(Ot=-Ot),Ot>0&&(rt=Dt.index)}else rt=Dt.index;else Dt.y!==Ne[1]&&(rt=Dt.index)}}}return rt}},{"./lib/order-segments":563,"binary-search-bounds":564,"functional-red-black-tree":247,"robust-orientation":548}],566:[function(Ne,Ge,Qe){"use strict";var tt=Ne("robust-dot-product"),rt=Ne("robust-sum");function planeT(Ne,Ge){var Qe=rt(tt(Ne,Ge),[Ge[Ge.length-1]]);return Qe[Qe.length-1]}function lerpW(Ne,Ge,Qe,tt){var rt=-Ge/(tt-Ge);rt<0?rt=0:rt>1&&(rt=1);for(var nt=1-rt,at=Ne.length,it=new Array(at),ot=0;ot<at;++ot)it[ot]=rt*Ne[ot]+nt*Qe[ot];return it}function splitPolygon(Ne,Ge){for(var Qe=[],tt=[],rt=planeT(Ne[Ne.length-1],Ge),nt=Ne[Ne.length-1],at=Ne[0],it=0;it<Ne.length;++it,nt=at){var ot=planeT(at=Ne[it],Ge);if(rt<0&&ot>0||rt>0&&ot<0){var dt=lerpW(nt,ot,at,rt);Qe.push(dt),tt.push(dt.slice())}ot<0?tt.push(at.slice()):ot>0?Qe.push(at.slice()):(Qe.push(at.slice()),tt.push(at.slice())),rt=ot}return{positive:Qe,negative:tt}}function positive(Ne,Ge){for(var Qe=[],tt=planeT(Ne[Ne.length-1],Ge),rt=Ne[Ne.length-1],nt=Ne[0],at=0;at<Ne.length;++at,rt=nt){var it=planeT(nt=Ne[at],Ge);(tt<0&&it>0||tt>0&&it<0)&&Qe.push(lerpW(rt,it,nt,tt)),it>=0&&Qe.push(nt.slice()),tt=it}return Qe}function negative(Ne,Ge){for(var Qe=[],tt=planeT(Ne[Ne.length-1],Ge),rt=Ne[Ne.length-1],nt=Ne[0],at=0;at<Ne.length;++at,rt=nt){var it=planeT(nt=Ne[at],Ge);(tt<0&&it>0||tt>0&&it<0)&&Qe.push(lerpW(rt,it,nt,tt)),it<=0&&Qe.push(nt.slice()),tt=it}return Qe}Ge.exports=splitPolygon,Ge.exports.positive=positive,Ge.exports.negative=negative},{"robust-dot-product":545,"robust-sum":553}],567:[function(Ne,Ge,Qe){!function(){"use strict";var Ne={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function sprintf(Ne){return sprintf_format(sprintf_parse(Ne),arguments)}function vsprintf(Ne,Ge){return sprintf.apply(null,[Ne].concat(Ge||[]))}function sprintf_format(Ge,Qe){var tt,rt,nt,at,it,ot,dt,ht,Dt,Ot=1,Rt=Ge.length,Zt="";for(rt=0;rt<Rt;rt++)if("string"==typeof Ge[rt])Zt+=Ge[rt];else if("object"==typeof Ge[rt]){if((at=Ge[rt]).keys)for(tt=Qe[Ot],nt=0;nt<at.keys.length;nt++){if(null==tt)throw new Error(sprintf('[sprintf] Cannot access property "%s" of undefined value "%s"',at.keys[nt],at.keys[nt-1]));tt=tt[at.keys[nt]]}else tt=at.param_no?Qe[at.param_no]:Qe[Ot++];if(Ne.not_type.test(at.type)&&Ne.not_primitive.test(at.type)&&tt instanceof Function&&(tt=tt()),Ne.numeric_arg.test(at.type)&&"number"!=typeof tt&&isNaN(tt))throw new TypeError(sprintf("[sprintf] expecting number but found %T",tt));switch(Ne.number.test(at.type)&&(ht=tt>=0),at.type){case"b":tt=parseInt(tt,10).toString(2);break;case"c":tt=String.fromCharCode(parseInt(tt,10));break;case"d":case"i":tt=parseInt(tt,10);break;case"j":tt=JSON.stringify(tt,null,at.width?parseInt(at.width):0);break;case"e":tt=at.precision?parseFloat(tt).toExponential(at.precision):parseFloat(tt).toExponential();break;case"f":tt=at.precision?parseFloat(tt).toFixed(at.precision):parseFloat(tt);break;case"g":tt=at.precision?String(Number(tt.toPrecision(at.precision))):parseFloat(tt);break;case"o":tt=(parseInt(tt,10)>>>0).toString(8);break;case"s":tt=String(tt),tt=at.precision?tt.substring(0,at.precision):tt;break;case"t":tt=String(!!tt),tt=at.precision?tt.substring(0,at.precision):tt;break;case"T":tt=Object.prototype.toString.call(tt).slice(8,-1).toLowerCase(),tt=at.precision?tt.substring(0,at.precision):tt;break;case"u":tt=parseInt(tt,10)>>>0;break;case"v":tt=tt.valueOf(),tt=at.precision?tt.substring(0,at.precision):tt;break;case"x":tt=(parseInt(tt,10)>>>0).toString(16);break;case"X":tt=(parseInt(tt,10)>>>0).toString(16).toUpperCase()}Ne.json.test(at.type)?Zt+=tt:(!Ne.number.test(at.type)||ht&&!at.sign?Dt="":(Dt=ht?"+":"-",tt=tt.toString().replace(Ne.sign,"")),ot=at.pad_char?"0"===at.pad_char?"0":at.pad_char.charAt(1):" ",dt=at.width-(Dt+tt).length,it=at.width&&dt>0?ot.repeat(dt):"",Zt+=at.align?Dt+tt+it:"0"===ot?Dt+it+tt:it+Dt+tt)}return Zt}var Ge=Object.create(null);function sprintf_parse(Qe){if(Ge[Qe])return Ge[Qe];for(var tt,rt=Qe,nt=[],at=0;rt;){if(null!==(tt=Ne.text.exec(rt)))nt.push(tt[0]);else if(null!==(tt=Ne.modulo.exec(rt)))nt.push("%");else{if(null===(tt=Ne.placeholder.exec(rt)))throw new SyntaxError("[sprintf] unexpected placeholder");if(tt[2]){at|=1;var it=[],ot=tt[2],dt=[];if(null===(dt=Ne.key.exec(ot)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(it.push(dt[1]);""!==(ot=ot.substring(dt[0].length));)if(null!==(dt=Ne.key_access.exec(ot)))it.push(dt[1]);else{if(null===(dt=Ne.index_access.exec(ot)))throw new SyntaxError("[sprintf] failed to parse named argument key");it.push(dt[1])}tt[2]=it}else at|=2;if(3===at)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");nt.push({placeholder:tt[0],param_no:tt[1],keys:tt[2],sign:tt[3],pad_char:tt[4],align:tt[5],width:tt[6],precision:tt[7],type:tt[8]})}rt=rt.substring(tt[0].length)}return Ge[Qe]=nt}void 0!==Qe&&(Qe.sprintf=sprintf,Qe.vsprintf=vsprintf),"undefined"!=typeof window&&(window.sprintf=sprintf,window.vsprintf=vsprintf,"function"==typeof tt&&tt.amd&&tt((function(){return{sprintf:sprintf,vsprintf:vsprintf}})))}()},{}],568:[function(Ne,Ge,Qe){"use strict";var tt=Ne("parenthesis");Ge.exports=function(Ne,Ge,Qe){if(null==Ne)throw Error("First argument should be a string");if(null==Ge)throw Error("Separator should be a string or a RegExp");Qe?("string"==typeof Qe||Array.isArray(Qe))&&(Qe={ignore:Qe}):Qe={},null==Qe.escape&&(Qe.escape=!0),null==Qe.ignore?Qe.ignore=["[]","()","{}","<>",'""',"''","``","ââ","Â«Â»"]:("string"==typeof Qe.ignore&&(Qe.ignore=[Qe.ignore]),Qe.ignore=Qe.ignore.map((function(Ne){return 1===Ne.length&&(Ne+=Ne),Ne})));var rt=tt.parse(Ne,{flat:!0,brackets:Qe.ignore}),nt=rt[0].split(Ge);if(Qe.escape){for(var at=[],it=0;it<nt.length;it++){var ot=nt[it],dt=nt[it+1];"\\"===ot[ot.length-1]&&"\\"!==ot[ot.length-2]?(at.push(ot+Ge+dt),it++):at.push(ot)}nt=at}for(it=0;it<nt.length;it++)rt[0]=nt[it],nt[it]=tt.stringify(rt,{flat:!0});return nt}},{parenthesis:503}],569:[function(Ne,Ge,Qe){"use strict";function stronglyConnectedComponents(Ne){for(var Ge=Ne.length,Qe=new Array(Ge),tt=new Array(Ge),rt=new Array(Ge),nt=new Array(Ge),at=new Array(Ge),it=new Array(Ge),ot=0;ot<Ge;++ot)Qe[ot]=-1,tt[ot]=0,rt[ot]=!1,nt[ot]=0,at[ot]=-1,it[ot]=[];var dt,ht=0,Dt=[],Ot=[];function strongConnect(Ge){var ot=[Ge],dt=[Ge];for(Qe[Ge]=tt[Ge]=ht,rt[Ge]=!0,ht+=1;dt.length>0;){Ge=dt[dt.length-1];var Rt=Ne[Ge];if(nt[Ge]<Rt.length){for(var Zt=nt[Ge];Zt<Rt.length;++Zt){var er=Rt[Zt];if(Qe[er]<0){Qe[er]=tt[er]=ht,rt[er]=!0,ht+=1,ot.push(er),dt.push(er);break}rt[er]&&(tt[Ge]=0|Math.min(tt[Ge],tt[er])),at[er]>=0&&it[Ge].push(at[er])}nt[Ge]=Zt}else{if(tt[Ge]===Qe[Ge]){var dr=[],mr=[],xr=0;for(Zt=ot.length-1;Zt>=0;--Zt){var br=ot[Zt];if(rt[br]=!1,dr.push(br),mr.push(it[br]),xr+=it[br].length,at[br]=Dt.length,br===Ge){ot.length=Zt;break}}Dt.push(dr);var Ar=new Array(xr);for(Zt=0;Zt<mr.length;Zt++)for(var en=0;en<mr[Zt].length;en++)Ar[--xr]=mr[Zt][en];Ot.push(Ar)}dt.pop()}}}for(ot=0;ot<Ge;++ot)Qe[ot]<0&&strongConnect(ot);for(ot=0;ot<Ot.length;ot++){var Rt=Ot[ot];if(0!==Rt.length){Rt.sort((function(Ne,Ge){return Ne-Ge})),dt=[Rt[0]];for(var Zt=1;Zt<Rt.length;Zt++)Rt[Zt]!==Rt[Zt-1]&&dt.push(Rt[Zt]);Ot[ot]=dt}}return{components:Dt,adjacencyList:Ot}}Ge.exports=stronglyConnectedComponents},{}],570:[function(Ne,Ge,Qe){"use strict";Ge.exports=surfaceNets;var tt=Ne("ndarray-extract-contour"),rt=Ne("triangulate-hypercube"),nt=Ne("zero-crossings");function buildSurfaceNets(Ne,Ge){var Qe=Ne.length,nt=["'use strict';"],at="surfaceNets"+Ne.join("_")+"d"+Ge;nt.push("var contour=genContour({","order:[",Ne.join(),"],","scalarArguments: 3,","phase:function phaseFunc(p,a,b,c) { return (p > c)|0 },"),"generic"===Ge&&nt.push("getters:[0],");for(var it=[],ot=[],dt=0;dt<Qe;++dt)it.push("d"+dt),ot.push("d"+dt);for(dt=0;dt<1<<Qe;++dt)it.push("v"+dt),ot.push("v"+dt);for(dt=0;dt<1<<Qe;++dt)it.push("p"+dt),ot.push("p"+dt);it.push("a","b","c"),ot.push("a","c"),nt.push("vertex:function vertexFunc(",it.join(),"){");var ht=[];for(dt=0;dt<1<<Qe;++dt)ht.push("(p"+dt+"<<"+dt+")");nt.push("var m=(",ht.join("+"),")|0;if(m===0||m===",(1<<(1<<Qe))-1,"){return}");var Dt=[],Ot=[];for(1<<(1<<Qe)<=128?(nt.push("switch(m){"),Ot=nt):nt.push("switch(m>>>7){"),dt=0;dt<1<<(1<<Qe);++dt){if(1<<(1<<Qe)>128&&dt%128==0){Dt.length>0&&Ot.push("}}");var Rt="vExtra"+Dt.length;nt.push("case ",dt>>>7,":",Rt,"(m&0x7f,",ot.join(),");break;"),Ot=["function ",Rt,"(m,",ot.join(),"){switch(m){"],Dt.push(Ot)}Ot.push("case ",127&dt,":");for(var Zt=new Array(Qe),er=new Array(Qe),dr=new Array(Qe),mr=new Array(Qe),xr=0,br=0;br<Qe;++br)Zt[br]=[],er[br]=[],dr[br]=0,mr[br]=0;for(br=0;br<1<<Qe;++br)for(var Ar=0;Ar<Qe;++Ar){var en=br^1<<Ar;if(!(en>br)&&!(dt&1<<en)!=!(dt&1<<br)){var mn=1;dt&1<<en?er[Ar].push("v"+en+"-v"+br):(er[Ar].push("v"+br+"-v"+en),mn=-mn),mn<0?(Zt[Ar].push("-v"+br+"-v"+en),dr[Ar]+=2):(Zt[Ar].push("v"+br+"+v"+en),dr[Ar]-=2),xr+=1;for(var xn=0;xn<Qe;++xn)xn!==Ar&&(en&1<<xn?mr[xn]+=1:mr[xn]-=1)}}var kn=[];for(Ar=0;Ar<Qe;++Ar)if(0===Zt[Ar].length)kn.push("d"+Ar+"-0.5");else{var Cn="";dr[Ar]<0?Cn=dr[Ar]+"*c":dr[Ar]>0&&(Cn="+"+dr[Ar]+"*c");var En=Zt[Ar].length/xr*.5,Pn=.5+mr[Ar]/xr*.5;kn.push("d"+Ar+"-"+Pn+"-"+En+"*("+Zt[Ar].join("+")+Cn+")/("+er[Ar].join("+")+")")}Ot.push("a.push([",kn.join(),"]);","break;")}nt.push("}},"),Dt.length>0&&Ot.push("}}");var Dn=[];for(dt=0;dt<1<<Qe-1;++dt)Dn.push("v"+dt);Dn.push("c0","c1","p0","p1","a","b","c"),nt.push("cell:function cellFunc(",Dn.join(),"){");var In=rt(Qe-1);for(nt.push("if(p0){b.push(",In.map((function(Ne){return"["+Ne.map((function(Ne){return"v"+Ne}))+"]"})).join(),")}else{b.push(",In.map((function(Ne){var Ge=Ne.slice();return Ge.reverse(),"["+Ge.map((function(Ne){return"v"+Ne}))+"]"})).join(),")}}});function ",at,"(array,level){var verts=[],cells=[];contour(array,verts,cells,level);return {positions:verts,cells:cells};} return ",at,";"),dt=0;dt<Dt.length;++dt)nt.push(Dt[dt].join(""));return new Function("genContour",nt.join(""))(tt)}function mesh1D(Ne,Ge){for(var Qe=nt(Ne,Ge),tt=Qe.length,rt=new Array(tt),at=new Array(tt),it=0;it<tt;++it)rt[it]=[Qe[it]],at[it]=[it];return{positions:rt,cells:at}}var at={};function surfaceNets(Ne,Ge){if(Ne.dimension<=0)return{positions:[],cells:[]};if(1===Ne.dimension)return mesh1D(Ne,Ge);var Qe=Ne.order.join()+"-"+Ne.dtype,tt=at[Qe];return Ge=+Ge||0,tt||(tt=at[Qe]=buildSurfaceNets(Ne.order,Ne.dtype)),tt(Ne,Ge)}},{"ndarray-extract-contour":487,"triangulate-hypercube":580,"zero-crossings":624}],571:[function(Ne,Ge,Qe){"use strict";Object.defineProperty(Qe,"__esModule",{value:!0});var tt=function(){function sliceIterator(Ne,Ge){var Qe=[],tt=!0,rt=!1,nt=void 0;try{for(var at,it=Ne[Symbol.iterator]();!(tt=(at=it.next()).done)&&(Qe.push(at.value),!Ge||Qe.length!==Ge);tt=!0);}catch(Ne){rt=!0,nt=Ne}finally{try{!tt&&it.return&&it.return()}finally{if(rt)throw nt}}return Qe}return function(Ne,Ge){if(Array.isArray(Ne))return Ne;if(Symbol.iterator in Object(Ne))return sliceIterator(Ne,Ge);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),rt=2*Math.PI,mapToEllipse=function(Ne,Ge,Qe,tt,rt,nt,at){var it=Ne.x,ot=Ne.y;return{x:tt*(it*=Ge)-rt*(ot*=Qe)+nt,y:rt*it+tt*ot+at}},approxUnitArc=function(Ne,Ge){var Qe=1.5707963267948966===Ge?.551915024494:-1.5707963267948966===Ge?-.551915024494:4/3*Math.tan(Ge/4),tt=Math.cos(Ne),rt=Math.sin(Ne),nt=Math.cos(Ne+Ge),at=Math.sin(Ne+Ge);return[{x:tt-rt*Qe,y:rt+tt*Qe},{x:nt+at*Qe,y:at-nt*Qe},{x:nt,y:at}]},vectorAngle=function(Ne,Ge,Qe,tt){var rt=Ne*Qe+Ge*tt;return rt>1&&(rt=1),rt<-1&&(rt=-1),(Ne*tt-Ge*Qe<0?-1:1)*Math.acos(rt)},getArcCenter=function(Ne,Ge,Qe,tt,nt,at,it,ot,dt,ht,Dt,Ot){var Rt=Math.pow(nt,2),Zt=Math.pow(at,2),er=Math.pow(Dt,2),dr=Math.pow(Ot,2),mr=Rt*Zt-Rt*dr-Zt*er;mr<0&&(mr=0),mr/=Rt*dr+Zt*er;var xr=(mr=Math.sqrt(mr)*(it===ot?-1:1))*nt/at*Ot,br=mr*-at/nt*Dt,Ar=ht*xr-dt*br+(Ne+Qe)/2,en=dt*xr+ht*br+(Ge+tt)/2,mn=(Dt-xr)/nt,xn=(Ot-br)/at,kn=(-Dt-xr)/nt,Cn=(-Ot-br)/at,En=vectorAngle(1,0,mn,xn),Pn=vectorAngle(mn,xn,kn,Cn);return 0===ot&&Pn>0&&(Pn-=rt),1===ot&&Pn<0&&(Pn+=rt),[Ar,en,En,Pn]},arcToBezier=function(Ne){var Ge=Ne.px,Qe=Ne.py,nt=Ne.cx,at=Ne.cy,it=Ne.rx,ot=Ne.ry,dt=Ne.xAxisRotation,ht=void 0===dt?0:dt,Dt=Ne.largeArcFlag,Ot=void 0===Dt?0:Dt,Rt=Ne.sweepFlag,Zt=void 0===Rt?0:Rt,er=[];if(0===it||0===ot)return[];var dr=Math.sin(ht*rt/360),mr=Math.cos(ht*rt/360),xr=mr*(Ge-nt)/2+dr*(Qe-at)/2,br=-dr*(Ge-nt)/2+mr*(Qe-at)/2;if(0===xr&&0===br)return[];it=Math.abs(it),ot=Math.abs(ot);var Ar=Math.pow(xr,2)/Math.pow(it,2)+Math.pow(br,2)/Math.pow(ot,2);Ar>1&&(it*=Math.sqrt(Ar),ot*=Math.sqrt(Ar));var en=getArcCenter(Ge,Qe,nt,at,it,ot,Ot,Zt,dr,mr,xr,br),mn=tt(en,4),xn=mn[0],kn=mn[1],Cn=mn[2],En=mn[3],Pn=Math.abs(En)/(rt/4);Math.abs(1-Pn)<1e-7&&(Pn=1);var Dn=Math.max(Math.ceil(Pn),1);En/=Dn;for(var In=0;In<Dn;In++)er.push(approxUnitArc(Cn,En)),Cn+=En;return er.map((function(Ne){var Ge=mapToEllipse(Ne[0],it,ot,mr,dr,xn,kn),Qe=Ge.x,tt=Ge.y,rt=mapToEllipse(Ne[1],it,ot,mr,dr,xn,kn),nt=rt.x,at=rt.y,dt=mapToEllipse(Ne[2],it,ot,mr,dr,xn,kn);return{x1:Qe,y1:tt,x2:nt,y2:at,x:dt.x,y:dt.y}}))};Qe.default=arcToBezier,Ge.exports=Qe.default},{}],572:[function(Ne,Ge,Qe){"use strict";var tt=Ne("parse-svg-path"),rt=Ne("abs-svg-path"),nt=Ne("normalize-svg-path"),at=Ne("is-svg-path"),it=Ne("assert");function pathBounds(Ne){if(Array.isArray(Ne)&&1===Ne.length&&"string"==typeof Ne[0]&&(Ne=Ne[0]),"string"==typeof Ne&&(it(at(Ne),"String is not an SVG path."),Ne=tt(Ne)),it(Array.isArray(Ne),"Argument should be a string or an array of path segments."),Ne=rt(Ne),!(Ne=nt(Ne)).length)return[0,0,0,0];for(var Ge=[1/0,1/0,-1/0,-1/0],Qe=0,ot=Ne.length;Qe<ot;Qe++)for(var dt=Ne[Qe].slice(1),ht=0;ht<dt.length;ht+=2)dt[ht+0]<Ge[0]&&(Ge[0]=dt[ht+0]),dt[ht+1]<Ge[1]&&(Ge[1]=dt[ht+1]),dt[ht+0]>Ge[2]&&(Ge[2]=dt[ht+0]),dt[ht+1]>Ge[3]&&(Ge[3]=dt[ht+1]);return Ge}Ge.exports=pathBounds},{"abs-svg-path":65,assert:73,"is-svg-path":471,"normalize-svg-path":573,"parse-svg-path":505}],573:[function(Ne,Ge,Qe){"use strict";Ge.exports=normalize;var tt=Ne("svg-arc-to-cubic-bezier");function normalize(Ne){for(var Ge,Qe=[],rt=0,nt=0,at=0,it=0,ot=null,dt=null,ht=0,Dt=0,Ot=0,Rt=Ne.length;Ot<Rt;Ot++){var Zt=Ne[Ot],er=Zt[0];switch(er){case"M":at=Zt[1],it=Zt[2];break;case"A":var dr=tt({px:ht,py:Dt,cx:Zt[6],cy:Zt[7],rx:Zt[1],ry:Zt[2],xAxisRotation:Zt[3],largeArcFlag:Zt[4],sweepFlag:Zt[5]});if(!dr.length)continue;for(var mr,xr=0;xr<dr.length;xr++)Zt=["C",(mr=dr[xr]).x1,mr.y1,mr.x2,mr.y2,mr.x,mr.y],xr<dr.length-1&&Qe.push(Zt);break;case"S":var br=ht,Ar=Dt;"C"!=Ge&&"S"!=Ge||(br+=br-rt,Ar+=Ar-nt),Zt=["C",br,Ar,Zt[1],Zt[2],Zt[3],Zt[4]];break;case"T":"Q"==Ge||"T"==Ge?(ot=2*ht-ot,dt=2*Dt-dt):(ot=ht,dt=Dt),Zt=quadratic(ht,Dt,ot,dt,Zt[1],Zt[2]);break;case"Q":ot=Zt[1],dt=Zt[2],Zt=quadratic(ht,Dt,Zt[1],Zt[2],Zt[3],Zt[4]);break;case"L":Zt=line(ht,Dt,Zt[1],Zt[2]);break;case"H":Zt=line(ht,Dt,Zt[1],Dt);break;case"V":Zt=line(ht,Dt,ht,Zt[1]);break;case"Z":Zt=line(ht,Dt,at,it)}Ge=er,ht=Zt[Zt.length-2],Dt=Zt[Zt.length-1],Zt.length>4?(rt=Zt[Zt.length-4],nt=Zt[Zt.length-3]):(rt=ht,nt=Dt),Qe.push(Zt)}return Qe}function line(Ne,Ge,Qe,tt){return["C",Ne,Ge,Qe,tt,Qe,tt]}function quadratic(Ne,Ge,Qe,tt,rt,nt){return["C",Ne/3+2/3*Qe,Ge/3+2/3*tt,rt/3+2/3*Qe,nt/3+2/3*tt,rt,nt]}},{"svg-arc-to-cubic-bezier":571}],574:[function(Ne,Ge,Qe){"use strict";var tt,rt=Ne("svg-path-bounds"),nt=Ne("parse-svg-path"),at=Ne("draw-svg-path"),it=Ne("is-svg-path"),ot=Ne("bitmap-sdf"),dt=document.createElement("canvas"),ht=dt.getContext("2d");function pathSdf(Ne,Ge){if(!it(Ne))throw Error("Argument should be valid svg path string");var Qe,tt;Ge||(Ge={}),Ge.shape?(Qe=Ge.shape[0],tt=Ge.shape[1]):(Qe=dt.width=Ge.w||Ge.width||200,tt=dt.height=Ge.h||Ge.height||200);var Dt=Math.min(Qe,tt),Ot=Ge.stroke||0,Rt=Ge.viewbox||Ge.viewBox||rt(Ne),Zt=[Qe/(Rt[2]-Rt[0]),tt/(Rt[3]-Rt[1])],er=Math.min(Zt[0]||0,Zt[1]||0)/2;if(ht.fillStyle="black",ht.fillRect(0,0,Qe,tt),ht.fillStyle="white",Ot&&("number"!=typeof Ot&&(Ot=1),ht.strokeStyle=Ot>0?"white":"black",ht.lineWidth=Math.abs(Ot)),ht.translate(.5*Qe,.5*tt),ht.scale(er,er),isPath2DSupported()){var dr=new Path2D(Ne);ht.fill(dr),Ot&&ht.stroke(dr)}else{var mr=nt(Ne);at(ht,mr),ht.fill(),Ot&&ht.stroke()}return ht.setTransform(1,0,0,1,0,0),ot(ht,{cutoff:null!=Ge.cutoff?Ge.cutoff:.5,radius:null!=Ge.radius?Ge.radius:.5*Dt})}function isPath2DSupported(){if(null!=tt)return tt;var Ne=document.createElement("canvas").getContext("2d");if(Ne.canvas.width=Ne.canvas.height=1,!window.Path2D)return tt=!1;var Ge=new Path2D("M0,0h1v1h-1v-1Z");Ne.fillStyle="black",Ne.fill(Ge);var Qe=Ne.getImageData(0,0,1,1);return tt=Qe&&Qe.data&&255===Qe.data[3]}Ge.exports=pathSdf},{"bitmap-sdf":98,"draw-svg-path":174,"is-svg-path":471,"parse-svg-path":505,"svg-path-bounds":572}],575:[function(Ne,Ge,Qe){(function(Qe){(function(){"use strict";Ge.exports=textGet;var tt=Ne("vectorize-text"),rt=window||Qe.global||{},nt=rt.__TEXT_CACHE||{};function unwrap(Ne){for(var Ge=Ne.cells,Qe=Ne.positions,tt=new Float32Array(6*Ge.length),rt=0,nt=0,at=0;at<Ge.length;++at)for(var it=Ge[at],ot=0;ot<3;++ot){var dt=Qe[it[ot]];tt[rt++]=dt[0],tt[rt++]=dt[1]+1.4,nt=Math.max(dt[0],nt)}return{data:tt,shape:nt}}function textGet(Ne,Ge,Qe){Qe=Qe||{};var rt=nt[Ne];rt||(rt=nt[Ne]={" ":{data:new Float32Array(0),shape:.2}});var at=rt[Ge];if(!at)if(Ge.length<=1||!/\d/.test(Ge))at=rt[Ge]=unwrap(tt(Ge,{triangles:!0,font:Ne,textAlign:Qe.textAlign||"left",textBaseline:"alphabetic",styletags:{breaklines:!0,bolds:!0,italics:!0,subscripts:!0,superscripts:!0}}));else{for(var it=Ge.split(/(\d|\s)/),ot=new Array(it.length),dt=0,ht=0,Dt=0;Dt<it.length;++Dt)ot[Dt]=textGet(Ne,it[Dt]),dt+=ot[Dt].data.length,ht+=ot[Dt].shape,Dt>0&&(ht+=.02);var Ot=new Float32Array(dt),Rt=0,Zt=-.5*ht;for(Dt=0;Dt<ot.length;++Dt){for(var er=ot[Dt].data,dr=0;dr<er.length;dr+=2)Ot[Rt++]=er[dr]+Zt,Ot[Rt++]=er[dr+1];Zt+=ot[Dt].shape+.02}at=rt[Ge]={data:Ot,shape:ht}}return at}rt.__TEXT_CACHE={}}).call(this)}).call(this,Ne("_process"))},{_process:526,"vectorize-text":600}],576:[function(Ne,Ge,Qe){!function(Ne){var Qe=/^\s+/,rt=/\s+$/,nt=0,at=Ne.round,it=Ne.min,ot=Ne.max,dt=Ne.random;function tinycolor(Ne,Ge){if(Ge=Ge||{},(Ne=Ne||"")instanceof tinycolor)return Ne;if(!(this instanceof tinycolor))return new tinycolor(Ne,Ge);var Qe=inputToRGB(Ne);this._originalInput=Ne,this._r=Qe.r,this._g=Qe.g,this._b=Qe.b,this._a=Qe.a,this._roundA=at(100*this._a)/100,this._format=Ge.format||Qe.format,this._gradientType=Ge.gradientType,this._r<1&&(this._r=at(this._r)),this._g<1&&(this._g=at(this._g)),this._b<1&&(this._b=at(this._b)),this._ok=Qe.ok,this._tc_id=nt++}function inputToRGB(Ne){var Ge={r:0,g:0,b:0},Qe=1,tt=null,rt=null,nt=null,at=!1,dt=!1;return"string"==typeof Ne&&(Ne=stringInputToObject(Ne)),"object"==typeof Ne&&(isValidCSSUnit(Ne.r)&&isValidCSSUnit(Ne.g)&&isValidCSSUnit(Ne.b)?(Ge=rgbToRgb(Ne.r,Ne.g,Ne.b),at=!0,dt="%"===String(Ne.r).substr(-1)?"prgb":"rgb"):isValidCSSUnit(Ne.h)&&isValidCSSUnit(Ne.s)&&isValidCSSUnit(Ne.v)?(tt=convertToPercentage(Ne.s),rt=convertToPercentage(Ne.v),Ge=hsvToRgb(Ne.h,tt,rt),at=!0,dt="hsv"):isValidCSSUnit(Ne.h)&&isValidCSSUnit(Ne.s)&&isValidCSSUnit(Ne.l)&&(tt=convertToPercentage(Ne.s),nt=convertToPercentage(Ne.l),Ge=hslToRgb(Ne.h,tt,nt),at=!0,dt="hsl"),Ne.hasOwnProperty("a")&&(Qe=Ne.a)),Qe=boundAlpha(Qe),{ok:at,format:Ne.format||dt,r:it(255,ot(Ge.r,0)),g:it(255,ot(Ge.g,0)),b:it(255,ot(Ge.b,0)),a:Qe}}function rgbToRgb(Ne,Ge,Qe){return{r:255*bound01(Ne,255),g:255*bound01(Ge,255),b:255*bound01(Qe,255)}}function rgbToHsl(Ne,Ge,Qe){Ne=bound01(Ne,255),Ge=bound01(Ge,255),Qe=bound01(Qe,255);var tt,rt,nt=ot(Ne,Ge,Qe),at=it(Ne,Ge,Qe),dt=(nt+at)/2;if(nt==at)tt=rt=0;else{var ht=nt-at;switch(rt=dt>.5?ht/(2-nt-at):ht/(nt+at),nt){case Ne:tt=(Ge-Qe)/ht+(Ge<Qe?6:0);break;case Ge:tt=(Qe-Ne)/ht+2;break;case Qe:tt=(Ne-Ge)/ht+4}tt/=6}return{h:tt,s:rt,l:dt}}function hslToRgb(Ne,Ge,Qe){var tt,rt,nt;function hue2rgb(Ne,Ge,Qe){return Qe<0&&(Qe+=1),Qe>1&&(Qe-=1),Qe<1/6?Ne+6*(Ge-Ne)*Qe:Qe<.5?Ge:Qe<2/3?Ne+(Ge-Ne)*(2/3-Qe)*6:Ne}if(Ne=bound01(Ne,360),Ge=bound01(Ge,100),Qe=bound01(Qe,100),0===Ge)tt=rt=nt=Qe;else{var at=Qe<.5?Qe*(1+Ge):Qe+Ge-Qe*Ge,it=2*Qe-at;tt=hue2rgb(it,at,Ne+1/3),rt=hue2rgb(it,at,Ne),nt=hue2rgb(it,at,Ne-1/3)}return{r:255*tt,g:255*rt,b:255*nt}}function rgbToHsv(Ne,Ge,Qe){Ne=bound01(Ne,255),Ge=bound01(Ge,255),Qe=bound01(Qe,255);var tt,rt,nt=ot(Ne,Ge,Qe),at=it(Ne,Ge,Qe),dt=nt,ht=nt-at;if(rt=0===nt?0:ht/nt,nt==at)tt=0;else{switch(nt){case Ne:tt=(Ge-Qe)/ht+(Ge<Qe?6:0);break;case Ge:tt=(Qe-Ne)/ht+2;break;case Qe:tt=(Ne-Ge)/ht+4}tt/=6}return{h:tt,s:rt,v:dt}}function hsvToRgb(Ge,Qe,tt){Ge=6*bound01(Ge,360),Qe=bound01(Qe,100),tt=bound01(tt,100);var rt=Ne.floor(Ge),nt=Ge-rt,at=tt*(1-Qe),it=tt*(1-nt*Qe),ot=tt*(1-(1-nt)*Qe),dt=rt%6;return{r:255*[tt,it,at,at,ot,tt][dt],g:255*[ot,tt,tt,it,at,at][dt],b:255*[at,at,ot,tt,tt,it][dt]}}function rgbToHex(Ne,Ge,Qe,tt){var rt=[pad2(at(Ne).toString(16)),pad2(at(Ge).toString(16)),pad2(at(Qe).toString(16))];return tt&&rt[0].charAt(0)==rt[0].charAt(1)&&rt[1].charAt(0)==rt[1].charAt(1)&&rt[2].charAt(0)==rt[2].charAt(1)?rt[0].charAt(0)+rt[1].charAt(0)+rt[2].charAt(0):rt.join("")}function rgbaToHex(Ne,Ge,Qe,tt,rt){var nt=[pad2(at(Ne).toString(16)),pad2(at(Ge).toString(16)),pad2(at(Qe).toString(16)),pad2(convertDecimalToHex(tt))];return rt&&nt[0].charAt(0)==nt[0].charAt(1)&&nt[1].charAt(0)==nt[1].charAt(1)&&nt[2].charAt(0)==nt[2].charAt(1)&&nt[3].charAt(0)==nt[3].charAt(1)?nt[0].charAt(0)+nt[1].charAt(0)+nt[2].charAt(0)+nt[3].charAt(0):nt.join("")}function rgbaToArgbHex(Ne,Ge,Qe,tt){return[pad2(convertDecimalToHex(tt)),pad2(at(Ne).toString(16)),pad2(at(Ge).toString(16)),pad2(at(Qe).toString(16))].join("")}function desaturate(Ne,Ge){Ge=0===Ge?0:Ge||10;var Qe=tinycolor(Ne).toHsl();return Qe.s-=Ge/100,Qe.s=clamp01(Qe.s),tinycolor(Qe)}function saturate(Ne,Ge){Ge=0===Ge?0:Ge||10;var Qe=tinycolor(Ne).toHsl();return Qe.s+=Ge/100,Qe.s=clamp01(Qe.s),tinycolor(Qe)}function greyscale(Ne){return tinycolor(Ne).desaturate(100)}function lighten(Ne,Ge){Ge=0===Ge?0:Ge||10;var Qe=tinycolor(Ne).toHsl();return Qe.l+=Ge/100,Qe.l=clamp01(Qe.l),tinycolor(Qe)}function brighten(Ne,Ge){Ge=0===Ge?0:Ge||10;var Qe=tinycolor(Ne).toRgb();return Qe.r=ot(0,it(255,Qe.r-at(-Ge/100*255))),Qe.g=ot(0,it(255,Qe.g-at(-Ge/100*255))),Qe.b=ot(0,it(255,Qe.b-at(-Ge/100*255))),tinycolor(Qe)}function darken(Ne,Ge){Ge=0===Ge?0:Ge||10;var Qe=tinycolor(Ne).toHsl();return Qe.l-=Ge/100,Qe.l=clamp01(Qe.l),tinycolor(Qe)}function spin(Ne,Ge){var Qe=tinycolor(Ne).toHsl(),tt=(Qe.h+Ge)%360;return Qe.h=tt<0?360+tt:tt,tinycolor(Qe)}function complement(Ne){var Ge=tinycolor(Ne).toHsl();return Ge.h=(Ge.h+180)%360,tinycolor(Ge)}function triad(Ne){var Ge=tinycolor(Ne).toHsl(),Qe=Ge.h;return[tinycolor(Ne),tinycolor({h:(Qe+120)%360,s:Ge.s,l:Ge.l}),tinycolor({h:(Qe+240)%360,s:Ge.s,l:Ge.l})]}function tetrad(Ne){var Ge=tinycolor(Ne).toHsl(),Qe=Ge.h;return[tinycolor(Ne),tinycolor({h:(Qe+90)%360,s:Ge.s,l:Ge.l}),tinycolor({h:(Qe+180)%360,s:Ge.s,l:Ge.l}),tinycolor({h:(Qe+270)%360,s:Ge.s,l:Ge.l})]}function splitcomplement(Ne){var Ge=tinycolor(Ne).toHsl(),Qe=Ge.h;return[tinycolor(Ne),tinycolor({h:(Qe+72)%360,s:Ge.s,l:Ge.l}),tinycolor({h:(Qe+216)%360,s:Ge.s,l:Ge.l})]}function analogous(Ne,Ge,Qe){Ge=Ge||6,Qe=Qe||30;var tt=tinycolor(Ne).toHsl(),rt=360/Qe,nt=[tinycolor(Ne)];for(tt.h=(tt.h-(rt*Ge>>1)+720)%360;--Ge;)tt.h=(tt.h+rt)%360,nt.push(tinycolor(tt));return nt}function monochromatic(Ne,Ge){Ge=Ge||6;for(var Qe=tinycolor(Ne).toHsv(),tt=Qe.h,rt=Qe.s,nt=Qe.v,at=[],it=1/Ge;Ge--;)at.push(tinycolor({h:tt,s:rt,v:nt})),nt=(nt+it)%1;return at}tinycolor.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var Ne=this.toRgb();return(299*Ne.r+587*Ne.g+114*Ne.b)/1e3},getLuminance:function(){var Ge,Qe,tt,rt=this.toRgb();return Ge=rt.r/255,Qe=rt.g/255,tt=rt.b/255,.2126*(Ge<=.03928?Ge/12.92:Ne.pow((Ge+.055)/1.055,2.4))+.7152*(Qe<=.03928?Qe/12.92:Ne.pow((Qe+.055)/1.055,2.4))+.0722*(tt<=.03928?tt/12.92:Ne.pow((tt+.055)/1.055,2.4))},setAlpha:function(Ne){return this._a=boundAlpha(Ne),this._roundA=at(100*this._a)/100,this},toHsv:function(){var Ne=rgbToHsv(this._r,this._g,this._b);return{h:360*Ne.h,s:Ne.s,v:Ne.v,a:this._a}},toHsvString:function(){var Ne=rgbToHsv(this._r,this._g,this._b),Ge=at(360*Ne.h),Qe=at(100*Ne.s),tt=at(100*Ne.v);return 1==this._a?"hsv("+Ge+", "+Qe+"%, "+tt+"%)":"hsva("+Ge+", "+Qe+"%, "+tt+"%, "+this._roundA+")"},toHsl:function(){var Ne=rgbToHsl(this._r,this._g,this._b);return{h:360*Ne.h,s:Ne.s,l:Ne.l,a:this._a}},toHslString:function(){var Ne=rgbToHsl(this._r,this._g,this._b),Ge=at(360*Ne.h),Qe=at(100*Ne.s),tt=at(100*Ne.l);return 1==this._a?"hsl("+Ge+", "+Qe+"%, "+tt+"%)":"hsla("+Ge+", "+Qe+"%, "+tt+"%, "+this._roundA+")"},toHex:function(Ne){return rgbToHex(this._r,this._g,this._b,Ne)},toHexString:function(Ne){return"#"+this.toHex(Ne)},toHex8:function(Ne){return rgbaToHex(this._r,this._g,this._b,this._a,Ne)},toHex8String:function(Ne){return"#"+this.toHex8(Ne)},toRgb:function(){return{r:at(this._r),g:at(this._g),b:at(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+at(this._r)+", "+at(this._g)+", "+at(this._b)+")":"rgba("+at(this._r)+", "+at(this._g)+", "+at(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:at(100*bound01(this._r,255))+"%",g:at(100*bound01(this._g,255))+"%",b:at(100*bound01(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+at(100*bound01(this._r,255))+"%, "+at(100*bound01(this._g,255))+"%, "+at(100*bound01(this._b,255))+"%)":"rgba("+at(100*bound01(this._r,255))+"%, "+at(100*bound01(this._g,255))+"%, "+at(100*bound01(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(Dt[rgbToHex(this._r,this._g,this._b,!0)]||!1)},toFilter:function(Ne){var Ge="#"+rgbaToArgbHex(this._r,this._g,this._b,this._a),Qe=Ge,tt=this._gradientType?"GradientType = 1, ":"";if(Ne){var rt=tinycolor(Ne);Qe="#"+rgbaToArgbHex(rt._r,rt._g,rt._b,rt._a)}return"progid:DXImageTransform.Microsoft.gradient("+tt+"startColorstr="+Ge+",endColorstr="+Qe+")"},toString:function(Ne){var Ge=!!Ne;Ne=Ne||this._format;var Qe=!1,tt=this._a<1&&this._a>=0;return Ge||!tt||"hex"!==Ne&&"hex6"!==Ne&&"hex3"!==Ne&&"hex4"!==Ne&&"hex8"!==Ne&&"name"!==Ne?("rgb"===Ne&&(Qe=this.toRgbString()),"prgb"===Ne&&(Qe=this.toPercentageRgbString()),"hex"!==Ne&&"hex6"!==Ne||(Qe=this.toHexString()),"hex3"===Ne&&(Qe=this.toHexString(!0)),"hex4"===Ne&&(Qe=this.toHex8String(!0)),"hex8"===Ne&&(Qe=this.toHex8String()),"name"===Ne&&(Qe=this.toName()),"hsl"===Ne&&(Qe=this.toHslString()),"hsv"===Ne&&(Qe=this.toHsvString()),Qe||this.toHexString()):"name"===Ne&&0===this._a?this.toName():this.toRgbString()},clone:function(){return tinycolor(this.toString())},_applyModification:function(Ne,Ge){var Qe=Ne.apply(null,[this].concat([].slice.call(Ge)));return this._r=Qe._r,this._g=Qe._g,this._b=Qe._b,this.setAlpha(Qe._a),this},lighten:function(){return this._applyModification(lighten,arguments)},brighten:function(){return this._applyModification(brighten,arguments)},darken:function(){return this._applyModification(darken,arguments)},desaturate:function(){return this._applyModification(desaturate,arguments)},saturate:function(){return this._applyModification(saturate,arguments)},greyscale:function(){return this._applyModification(greyscale,arguments)},spin:function(){return this._applyModification(spin,arguments)},_applyCombination:function(Ne,Ge){return Ne.apply(null,[this].concat([].slice.call(Ge)))},analogous:function(){return this._applyCombination(analogous,arguments)},complement:function(){return this._applyCombination(complement,arguments)},monochromatic:function(){return this._applyCombination(monochromatic,arguments)},splitcomplement:function(){return this._applyCombination(splitcomplement,arguments)},triad:function(){return this._applyCombination(triad,arguments)},tetrad:function(){return this._applyCombination(tetrad,arguments)}},tinycolor.fromRatio=function(Ne,Ge){if("object"==typeof Ne){var Qe={};for(var tt in Ne)Ne.hasOwnProperty(tt)&&(Qe[tt]="a"===tt?Ne[tt]:convertToPercentage(Ne[tt]));Ne=Qe}return tinycolor(Ne,Ge)},tinycolor.equals=function(Ne,Ge){return!(!Ne||!Ge)&&tinycolor(Ne).toRgbString()==tinycolor(Ge).toRgbString()},tinycolor.random=function(){return tinycolor.fromRatio({r:dt(),g:dt(),b:dt()})},tinycolor.mix=function(Ne,Ge,Qe){Qe=0===Qe?0:Qe||50;var tt=tinycolor(Ne).toRgb(),rt=tinycolor(Ge).toRgb(),nt=Qe/100;return tinycolor({r:(rt.r-tt.r)*nt+tt.r,g:(rt.g-tt.g)*nt+tt.g,b:(rt.b-tt.b)*nt+tt.b,a:(rt.a-tt.a)*nt+tt.a})},tinycolor.readability=function(Ge,Qe){var tt=tinycolor(Ge),rt=tinycolor(Qe);return(Ne.max(tt.getLuminance(),rt.getLuminance())+.05)/(Ne.min(tt.getLuminance(),rt.getLuminance())+.05)},tinycolor.isReadable=function(Ne,Ge,Qe){var tt,rt,nt=tinycolor.readability(Ne,Ge);switch(rt=!1,(tt=validateWCAG2Parms(Qe)).level+tt.size){case"AAsmall":case"AAAlarge":rt=nt>=4.5;break;case"AAlarge":rt=nt>=3;break;case"AAAsmall":rt=nt>=7}return rt},tinycolor.mostReadable=function(Ne,Ge,Qe){var tt,rt,nt,at,it=null,ot=0;rt=(Qe=Qe||{}).includeFallbackColors,nt=Qe.level,at=Qe.size;for(var dt=0;dt<Ge.length;dt++)(tt=tinycolor.readability(Ne,Ge[dt]))>ot&&(ot=tt,it=tinycolor(Ge[dt]));return tinycolor.isReadable(Ne,it,{level:nt,size:at})||!rt?it:(Qe.includeFallbackColors=!1,tinycolor.mostReadable(Ne,["#fff","#000"],Qe))};var ht=tinycolor.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},Dt=tinycolor.hexNames=flip(ht);function flip(Ne){var Ge={};for(var Qe in Ne)Ne.hasOwnProperty(Qe)&&(Ge[Ne[Qe]]=Qe);return Ge}function boundAlpha(Ne){return Ne=parseFloat(Ne),(isNaN(Ne)||Ne<0||Ne>1)&&(Ne=1),Ne}function bound01(Ge,Qe){isOnePointZero(Ge)&&(Ge="100%");var tt=isPercentage(Ge);return Ge=it(Qe,ot(0,parseFloat(Ge))),tt&&(Ge=parseInt(Ge*Qe,10)/100),Ne.abs(Ge-Qe)<1e-6?1:Ge%Qe/parseFloat(Qe)}function clamp01(Ne){return it(1,ot(0,Ne))}function parseIntFromHex(Ne){return parseInt(Ne,16)}function isOnePointZero(Ne){return"string"==typeof Ne&&-1!=Ne.indexOf(".")&&1===parseFloat(Ne)}function isPercentage(Ne){return"string"==typeof Ne&&-1!=Ne.indexOf("%")}function pad2(Ne){return 1==Ne.length?"0"+Ne:""+Ne}function convertToPercentage(Ne){return Ne<=1&&(Ne=100*Ne+"%"),Ne}function convertDecimalToHex(Ge){return Ne.round(255*parseFloat(Ge)).toString(16)}function convertHexToDecimal(Ne){return parseIntFromHex(Ne)/255}var Ot,Rt,Zt,er=(Rt="[\\s|\\(]+("+(Ot="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+Ot+")[,|\\s]+("+Ot+")\\s*\\)?",Zt="[\\s|\\(]+("+Ot+")[,|\\s]+("+Ot+")[,|\\s]+("+Ot+")[,|\\s]+("+Ot+")\\s*\\)?",{CSS_UNIT:new RegExp(Ot),rgb:new RegExp("rgb"+Rt),rgba:new RegExp("rgba"+Zt),hsl:new RegExp("hsl"+Rt),hsla:new RegExp("hsla"+Zt),hsv:new RegExp("hsv"+Rt),hsva:new RegExp("hsva"+Zt),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});function isValidCSSUnit(Ne){return!!er.CSS_UNIT.exec(Ne)}function stringInputToObject(Ne){Ne=Ne.replace(Qe,"").replace(rt,"").toLowerCase();var Ge,tt=!1;if(ht[Ne])Ne=ht[Ne],tt=!0;else if("transparent"==Ne)return{r:0,g:0,b:0,a:0,format:"name"};return(Ge=er.rgb.exec(Ne))?{r:Ge[1],g:Ge[2],b:Ge[3]}:(Ge=er.rgba.exec(Ne))?{r:Ge[1],g:Ge[2],b:Ge[3],a:Ge[4]}:(Ge=er.hsl.exec(Ne))?{h:Ge[1],s:Ge[2],l:Ge[3]}:(Ge=er.hsla.exec(Ne))?{h:Ge[1],s:Ge[2],l:Ge[3],a:Ge[4]}:(Ge=er.hsv.exec(Ne))?{h:Ge[1],s:Ge[2],v:Ge[3]}:(Ge=er.hsva.exec(Ne))?{h:Ge[1],s:Ge[2],v:Ge[3],a:Ge[4]}:(Ge=er.hex8.exec(Ne))?{r:parseIntFromHex(Ge[1]),g:parseIntFromHex(Ge[2]),b:parseIntFromHex(Ge[3]),a:convertHexToDecimal(Ge[4]),format:tt?"name":"hex8"}:(Ge=er.hex6.exec(Ne))?{r:parseIntFromHex(Ge[1]),g:parseIntFromHex(Ge[2]),b:parseIntFromHex(Ge[3]),format:tt?"name":"hex"}:(Ge=er.hex4.exec(Ne))?{r:parseIntFromHex(Ge[1]+""+Ge[1]),g:parseIntFromHex(Ge[2]+""+Ge[2]),b:parseIntFromHex(Ge[3]+""+Ge[3]),a:convertHexToDecimal(Ge[4]+""+Ge[4]),format:tt?"name":"hex8"}:!!(Ge=er.hex3.exec(Ne))&&{r:parseIntFromHex(Ge[1]+""+Ge[1]),g:parseIntFromHex(Ge[2]+""+Ge[2]),b:parseIntFromHex(Ge[3]+""+Ge[3]),format:tt?"name":"hex"}}function validateWCAG2Parms(Ne){var Ge,Qe;return"AA"!==(Ge=((Ne=Ne||{level:"AA",size:"small"}).level||"AA").toUpperCase())&&"AAA"!==Ge&&(Ge="AA"),"small"!==(Qe=(Ne.size||"small").toLowerCase())&&"large"!==Qe&&(Qe="small"),{level:Ge,size:Qe}}void 0!==Ge&&Ge.exports?Ge.exports=tinycolor:"function"==typeof tt&&tt.amd?tt((function(){return tinycolor})):window.tinycolor=tinycolor}(Math)},{}],577:[function(Ne,Ge,Qe){"use strict";Ge.exports=float32,Ge.exports.float32=Ge.exports.float=float32,Ge.exports.fract32=Ge.exports.fract=fract32;var tt=new Float32Array(1);function fract32(Ne){if(Ne.length){for(var Ge=float32(Ne),Qe=0,tt=Ge.length;Qe<tt;Qe++)Ge[Qe]=Ne[Qe]-Ge[Qe];return Ge}return float32(Ne-float32(Ne))}function float32(Ne){if(Ne.length){if(Ne instanceof Float32Array)return Ne;var Ge=new Float32Array(Ne);return Ge.set(Ne),Ge}return tt[0]=Ne,tt[0]}},{}],578:[function(Ne,Ge,Qe){"use strict";var tt=Ne("parse-unit");Ge.exports=toPX;var rt=96;function getPropertyInPX(Ne,Ge){var Qe=tt(getComputedStyle(Ne).getPropertyValue(Ge));return Qe[0]*toPX(Qe[1],Ne)}function getSizeBrutal(Ne,Ge){var Qe=document.createElement("div");Qe.style["font-size"]="128"+Ne,Ge.appendChild(Qe);var tt=getPropertyInPX(Qe,"font-size")/128;return Ge.removeChild(Qe),tt}function toPX(Ne,Ge){switch(Ge=Ge||document.body,Ne=(Ne||"px").trim().toLowerCase(),Ge!==window&&Ge!==document||(Ge=document.body),Ne){case"%":return Ge.clientHeight/100;case"ch":case"ex":return getSizeBrutal(Ne,Ge);case"em":return getPropertyInPX(Ge,"font-size");case"rem":return getPropertyInPX(document.body,"font-size");case"vw":return window.innerWidth/100;case"vh":return window.innerHeight/100;case"vmin":return Math.min(window.innerWidth,window.innerHeight)/100;case"vmax":return Math.max(window.innerWidth,window.innerHeight)/100;case"in":return rt;case"cm":return rt/2.54;case"mm":return rt/25.4;case"pt":return rt/72;case"pc":return rt/6}return 1}},{"parse-unit":506}],579:[function(Ne,Ge,Qe){var rt,nt;rt=this,nt=function(Ne){"use strict";function identity(Ne){return Ne}function transform(Ne){if(null==Ne)return identity;var Ge,Qe,tt=Ne.scale[0],rt=Ne.scale[1],nt=Ne.translate[0],at=Ne.translate[1];return function(Ne,it){it||(Ge=Qe=0);var ot=2,dt=Ne.length,ht=new Array(dt);for(ht[0]=(Ge+=Ne[0])*tt+nt,ht[1]=(Qe+=Ne[1])*rt+at;ot<dt;)ht[ot]=Ne[ot],++ot;return ht}}function bbox(Ne){var Ge,Qe=transform(Ne.transform),tt=1/0,rt=tt,nt=-tt,at=-tt;function bboxPoint(Ne){(Ne=Qe(Ne))[0]<tt&&(tt=Ne[0]),Ne[0]>nt&&(nt=Ne[0]),Ne[1]<rt&&(rt=Ne[1]),Ne[1]>at&&(at=Ne[1])}function bboxGeometry(Ne){switch(Ne.type){case"GeometryCollection":Ne.geometries.forEach(bboxGeometry);break;case"Point":bboxPoint(Ne.coordinates);break;case"MultiPoint":Ne.coordinates.forEach(bboxPoint)}}for(Ge in Ne.arcs.forEach((function(Ne){for(var Ge,it=-1,ot=Ne.length;++it<ot;)(Ge=Qe(Ne[it],it))[0]<tt&&(tt=Ge[0]),Ge[0]>nt&&(nt=Ge[0]),Ge[1]<rt&&(rt=Ge[1]),Ge[1]>at&&(at=Ge[1])})),Ne.objects)bboxGeometry(Ne.objects[Ge]);return[tt,rt,nt,at]}function reverse(Ne,Ge){for(var Qe,tt=Ne.length,rt=tt-Ge;rt<--tt;)Qe=Ne[rt],Ne[rt++]=Ne[tt],Ne[tt]=Qe}function feature(Ne,Ge){return"string"==typeof Ge&&(Ge=Ne.objects[Ge]),"GeometryCollection"===Ge.type?{type:"FeatureCollection",features:Ge.geometries.map((function(Ge){return feature$1(Ne,Ge)}))}:feature$1(Ne,Ge)}function feature$1(Ne,Ge){var Qe=Ge.id,tt=Ge.bbox,rt=null==Ge.properties?{}:Ge.properties,nt=object(Ne,Ge);return null==Qe&&null==tt?{type:"Feature",properties:rt,geometry:nt}:null==tt?{type:"Feature",id:Qe,properties:rt,geometry:nt}:{type:"Feature",id:Qe,bbox:tt,properties:rt,geometry:nt}}function object(Ne,Ge){var Qe=transform(Ne.transform),tt=Ne.arcs;function arc(Ne,Ge){Ge.length&&Ge.pop();for(var rt=tt[Ne<0?~Ne:Ne],nt=0,at=rt.length;nt<at;++nt)Ge.push(Qe(rt[nt],nt));Ne<0&&reverse(Ge,at)}function point(Ne){return Qe(Ne)}function line(Ne){for(var Ge=[],Qe=0,tt=Ne.length;Qe<tt;++Qe)arc(Ne[Qe],Ge);return Ge.length<2&&Ge.push(Ge[0]),Ge}function ring(Ne){for(var Ge=line(Ne);Ge.length<4;)Ge.push(Ge[0]);return Ge}function polygon(Ne){return Ne.map(ring)}function geometry(Ne){var Ge,Qe=Ne.type;switch(Qe){case"GeometryCollection":return{type:Qe,geometries:Ne.geometries.map(geometry)};case"Point":Ge=point(Ne.coordinates);break;case"MultiPoint":Ge=Ne.coordinates.map(point);break;case"LineString":Ge=line(Ne.arcs);break;case"MultiLineString":Ge=Ne.arcs.map(line);break;case"Polygon":Ge=polygon(Ne.arcs);break;case"MultiPolygon":Ge=Ne.arcs.map(polygon);break;default:return null}return{type:Qe,coordinates:Ge}}return geometry(Ge)}function stitch(Ne,Ge){var Qe={},tt={},rt={},nt=[],at=-1;function ends(Ge){var Qe,tt=Ne.arcs[Ge<0?~Ge:Ge],rt=tt[0];return Ne.transform?(Qe=[0,0],tt.forEach((function(Ne){Qe[0]+=Ne[0],Qe[1]+=Ne[1]}))):Qe=tt[tt.length-1],Ge<0?[Qe,rt]:[rt,Qe]}function flush(Ne,Ge){for(var tt in Ne){var rt=Ne[tt];delete Ge[rt.start],delete rt.start,delete rt.end,rt.forEach((function(Ne){Qe[Ne<0?~Ne:Ne]=1})),nt.push(rt)}}return Ge.forEach((function(Qe,tt){var rt,nt=Ne.arcs[Qe<0?~Qe:Qe];nt.length<3&&!nt[1][0]&&!nt[1][1]&&(rt=Ge[++at],Ge[at]=Qe,Ge[tt]=rt)})),Ge.forEach((function(Ne){var Ge,Qe,nt=ends(Ne),at=nt[0],it=nt[1];if(Ge=rt[at])if(delete rt[Ge.end],Ge.push(Ne),Ge.end=it,Qe=tt[it]){delete tt[Qe.start];var ot=Qe===Ge?Ge:Ge.concat(Qe);tt[ot.start=Ge.start]=rt[ot.end=Qe.end]=ot}else tt[Ge.start]=rt[Ge.end]=Ge;else if(Ge=tt[it])if(delete tt[Ge.start],Ge.unshift(Ne),Ge.start=at,Qe=rt[at]){delete rt[Qe.end];var dt=Qe===Ge?Ge:Qe.concat(Ge);tt[dt.start=Qe.start]=rt[dt.end=Ge.end]=dt}else tt[Ge.start]=rt[Ge.end]=Ge;else tt[(Ge=[Ne]).start=at]=rt[Ge.end=it]=Ge})),flush(rt,tt),flush(tt,rt),Ge.forEach((function(Ne){Qe[Ne<0?~Ne:Ne]||nt.push([Ne])})),nt}function mesh(Ne){return object(Ne,meshArcs.apply(this,arguments))}function meshArcs(Ne,Ge,Qe){var tt,rt,nt;if(arguments.length>1)tt=extractArcs(Ne,Ge,Qe);else for(rt=0,tt=new Array(nt=Ne.arcs.length);rt<nt;++rt)tt[rt]=rt;return{type:"MultiLineString",arcs:stitch(Ne,tt)}}function extractArcs(Ne,Ge,Qe){var tt,rt=[],nt=[];function extract0(Ne){var Ge=Ne<0?~Ne:Ne;(nt[Ge]||(nt[Ge]=[])).push({i:Ne,g:tt})}function extract1(Ne){Ne.forEach(extract0)}function extract2(Ne){Ne.forEach(extract1)}function extract3(Ne){Ne.forEach(extract2)}function geometry(Ne){switch(tt=Ne,Ne.type){case"GeometryCollection":Ne.geometries.forEach(geometry);break;case"LineString":extract1(Ne.arcs);break;case"MultiLineString":case"Polygon":extract2(Ne.arcs);break;case"MultiPolygon":extract3(Ne.arcs)}}return geometry(Ge),nt.forEach(null==Qe?function(Ne){rt.push(Ne[0].i)}:function(Ne){Qe(Ne[0].g,Ne[Ne.length-1].g)&&rt.push(Ne[0].i)}),rt}function planarRingArea(Ne){for(var Ge,Qe=-1,tt=Ne.length,rt=Ne[tt-1],nt=0;++Qe<tt;)Ge=rt,rt=Ne[Qe],nt+=Ge[0]*rt[1]-Ge[1]*rt[0];return Math.abs(nt)}function merge(Ne){return object(Ne,mergeArcs.apply(this,arguments))}function mergeArcs(Ne,Ge){var Qe={},tt=[],rt=[];function geometry(Ne){switch(Ne.type){case"GeometryCollection":Ne.geometries.forEach(geometry);break;case"Polygon":extract(Ne.arcs);break;case"MultiPolygon":Ne.arcs.forEach(extract)}}function extract(Ne){Ne.forEach((function(Ge){Ge.forEach((function(Ge){(Qe[Ge=Ge<0?~Ge:Ge]||(Qe[Ge]=[])).push(Ne)}))})),tt.push(Ne)}function area(Ge){return planarRingArea(object(Ne,{type:"Polygon",arcs:[Ge]}).coordinates[0])}return Ge.forEach(geometry),tt.forEach((function(Ne){if(!Ne._){var Ge=[],tt=[Ne];for(Ne._=1,rt.push(Ge);Ne=tt.pop();)Ge.push(Ne),Ne.forEach((function(Ne){Ne.forEach((function(Ne){Qe[Ne<0?~Ne:Ne].forEach((function(Ne){Ne._||(Ne._=1,tt.push(Ne))}))}))}))}})),tt.forEach((function(Ne){delete Ne._})),{type:"MultiPolygon",arcs:rt.map((function(Ge){var tt,rt=[];if(Ge.forEach((function(Ne){Ne.forEach((function(Ne){Ne.forEach((function(Ne){Qe[Ne<0?~Ne:Ne].length<2&&rt.push(Ne)}))}))})),(tt=(rt=stitch(Ne,rt)).length)>1)for(var nt,at,it=1,ot=area(rt[0]);it<tt;++it)(nt=area(rt[it]))>ot&&(at=rt[0],rt[0]=rt[it],rt[it]=at,ot=nt);return rt})).filter((function(Ne){return Ne.length>0}))}}function bisect(Ne,Ge){for(var Qe=0,tt=Ne.length;Qe<tt;){var rt=Qe+tt>>>1;Ne[rt]<Ge?Qe=rt+1:tt=rt}return Qe}function neighbors(Ne){var Ge={},Qe=Ne.map((function(){return[]}));function line(Ne,Qe){Ne.forEach((function(Ne){Ne<0&&(Ne=~Ne);var tt=Ge[Ne];tt?tt.push(Qe):Ge[Ne]=[Qe]}))}function polygon(Ne,Ge){Ne.forEach((function(Ne){line(Ne,Ge)}))}function geometry(Ne,Ge){"GeometryCollection"===Ne.type?Ne.geometries.forEach((function(Ne){geometry(Ne,Ge)})):Ne.type in tt&&tt[Ne.type](Ne.arcs,Ge)}var tt={LineString:line,MultiLineString:polygon,Polygon:polygon,MultiPolygon:function(Ne,Ge){Ne.forEach((function(Ne){polygon(Ne,Ge)}))}};for(var rt in Ne.forEach(geometry),Ge)for(var nt=Ge[rt],at=nt.length,it=0;it<at;++it)for(var ot=it+1;ot<at;++ot){var dt,ht=nt[it],Dt=nt[ot];(dt=Qe[ht])[rt=bisect(dt,Dt)]!==Dt&&dt.splice(rt,0,Dt),(dt=Qe[Dt])[rt=bisect(dt,ht)]!==ht&&dt.splice(rt,0,ht)}return Qe}function untransform(Ne){if(null==Ne)return identity;var Ge,Qe,tt=Ne.scale[0],rt=Ne.scale[1],nt=Ne.translate[0],at=Ne.translate[1];return function(Ne,it){it||(Ge=Qe=0);var ot=2,dt=Ne.length,ht=new Array(dt),Dt=Math.round((Ne[0]-nt)/tt),Ot=Math.round((Ne[1]-at)/rt);for(ht[0]=Dt-Ge,Ge=Dt,ht[1]=Ot-Qe,Qe=Ot;ot<dt;)ht[ot]=Ne[ot],++ot;return ht}}function quantize(Ne,Ge){if(Ne.transform)throw new Error("already quantized");if(Ge&&Ge.scale)it=Ne.bbox;else{if(!((Qe=Math.floor(Ge))>=2))throw new Error("n must be â¥2");var Qe,tt=(it=Ne.bbox||bbox(Ne))[0],rt=it[1],nt=it[2],at=it[3];Ge={scale:[nt-tt?(nt-tt)/(Qe-1):1,at-rt?(at-rt)/(Qe-1):1],translate:[tt,rt]}}var it,ot,dt=untransform(Ge),ht=Ne.objects,Dt={};function quantizePoint(Ne){return dt(Ne)}function quantizeGeometry(Ne){var Ge;switch(Ne.type){case"GeometryCollection":Ge={type:"GeometryCollection",geometries:Ne.geometries.map(quantizeGeometry)};break;case"Point":Ge={type:"Point",coordinates:quantizePoint(Ne.coordinates)};break;case"MultiPoint":Ge={type:"MultiPoint",coordinates:Ne.coordinates.map(quantizePoint)};break;default:return Ne}return null!=Ne.id&&(Ge.id=Ne.id),null!=Ne.bbox&&(Ge.bbox=Ne.bbox),null!=Ne.properties&&(Ge.properties=Ne.properties),Ge}function quantizeArc(Ne){var Ge,Qe=0,tt=1,rt=Ne.length,nt=new Array(rt);for(nt[0]=dt(Ne[0],0);++Qe<rt;)((Ge=dt(Ne[Qe],Qe))[0]||Ge[1])&&(nt[tt++]=Ge);return 1===tt&&(nt[tt++]=[0,0]),nt.length=tt,nt}for(ot in ht)Dt[ot]=quantizeGeometry(ht[ot]);return{type:"Topology",bbox:it,transform:Ge,objects:Dt,arcs:Ne.arcs.map(quantizeArc)}}Ne.bbox=bbox,Ne.feature=feature,Ne.merge=merge,Ne.mergeArcs=mergeArcs,Ne.mesh=mesh,Ne.meshArcs=meshArcs,Ne.neighbors=neighbors,Ne.quantize=quantize,Ne.transform=transform,Ne.untransform=untransform,Object.defineProperty(Ne,"__esModule",{value:!0})},"object"==typeof Qe&&void 0!==Ge?nt(Qe):"function"==typeof tt&&tt.amd?tt(["exports"],nt):nt((rt=rt||self).topojson=rt.topojson||{})},{}],580:[function(Ne,Ge,Qe){"use strict";Ge.exports=triangulateCube;var tt=Ne("permutation-rank"),rt=Ne("permutation-parity"),nt=Ne("gamma");function triangulateCube(Ne){if(Ne<0)return[];if(0===Ne)return[[0]];for(var Ge=0|Math.round(nt(Ne+1)),Qe=[],at=0;at<Ge;++at){for(var it=tt.unrank(Ne,at),ot=[0],dt=0,ht=0;ht<it.length;++ht)dt+=1<<it[ht],ot.push(dt);rt(it)<1&&(ot[0]=dt,ot[Ne]=0),Qe.push(ot)}return Qe}},{gamma:248,"permutation-parity":509,"permutation-rank":510}],581:[function(Ne,Ge,Qe){"use strict";Ge.exports=createTurntableController;var tt=Ne("filtered-vector"),rt=Ne("gl-mat4/invert"),nt=Ne("gl-mat4/rotate"),at=Ne("gl-vec3/cross"),it=Ne("gl-vec3/normalize"),ot=Ne("gl-vec3/dot");function len3(Ne,Ge,Qe){return Math.sqrt(Math.pow(Ne,2)+Math.pow(Ge,2)+Math.pow(Qe,2))}function clamp1(Ne){return Math.min(1,Math.max(-1,Ne))}function findOrthoPair(Ne){var Ge=Math.abs(Ne[0]),Qe=Math.abs(Ne[1]),tt=Math.abs(Ne[2]),rt=[0,0,0];Ge>Math.max(Qe,tt)?rt[2]=1:Qe>Math.max(Ge,tt)?rt[0]=1:rt[1]=1;for(var nt=0,at=0,ot=0;ot<3;++ot)nt+=Ne[ot]*Ne[ot],at+=rt[ot]*Ne[ot];for(ot=0;ot<3;++ot)rt[ot]-=at/nt*Ne[ot];return it(rt,rt),rt}function TurntableController(Ne,Ge,Qe,rt,nt,at,it,ot){this.center=tt(Qe),this.up=tt(rt),this.right=tt(nt),this.radius=tt([at]),this.angle=tt([it,ot]),this.angle.bounds=[[-1/0,-Math.PI/2],[1/0,Math.PI/2]],this.setDistanceLimits(Ne,Ge),this.computedCenter=this.center.curve(0),this.computedUp=this.up.curve(0),this.computedRight=this.right.curve(0),this.computedRadius=this.radius.curve(0),this.computedAngle=this.angle.curve(0),this.computedToward=[0,0,0],this.computedEye=[0,0,0],this.computedMatrix=new Array(16);for(var dt=0;dt<16;++dt)this.computedMatrix[dt]=.5;this.recalcMatrix(0)}var dt=TurntableController.prototype;dt.setDistanceLimits=function(Ne,Ge){Ne=Ne>0?Math.log(Ne):-1/0,Ge=Ge>0?Math.log(Ge):1/0,Ge=Math.max(Ge,Ne),this.radius.bounds[0][0]=Ne,this.radius.bounds[1][0]=Ge},dt.getDistanceLimits=function(Ne){var Ge=this.radius.bounds[0];return Ne?(Ne[0]=Math.exp(Ge[0][0]),Ne[1]=Math.exp(Ge[1][0]),Ne):[Math.exp(Ge[0][0]),Math.exp(Ge[1][0])]},dt.recalcMatrix=function(Ne){this.center.curve(Ne),this.up.curve(Ne),this.right.curve(Ne),this.radius.curve(Ne),this.angle.curve(Ne);for(var Ge=this.computedUp,Qe=this.computedRight,tt=0,rt=0,nt=0;nt<3;++nt)rt+=Ge[nt]*Qe[nt],tt+=Ge[nt]*Ge[nt];var ot=Math.sqrt(tt),dt=0;for(nt=0;nt<3;++nt)Qe[nt]-=Ge[nt]*rt/tt,dt+=Qe[nt]*Qe[nt],Ge[nt]/=ot;var ht=Math.sqrt(dt);for(nt=0;nt<3;++nt)Qe[nt]/=ht;var Dt=this.computedToward;at(Dt,Ge,Qe),it(Dt,Dt);var Ot=Math.exp(this.computedRadius[0]),Rt=this.computedAngle[0],Zt=this.computedAngle[1],er=Math.cos(Rt),dr=Math.sin(Rt),mr=Math.cos(Zt),xr=Math.sin(Zt),br=this.computedCenter,Ar=er*mr,en=dr*mr,mn=xr,xn=-er*xr,kn=-dr*xr,Cn=mr,En=this.computedEye,Pn=this.computedMatrix;for(nt=0;nt<3;++nt){var Dn=Ar*Qe[nt]+en*Dt[nt]+mn*Ge[nt];Pn[4*nt+1]=xn*Qe[nt]+kn*Dt[nt]+Cn*Ge[nt],Pn[4*nt+2]=Dn,Pn[4*nt+3]=0}var In=Pn[1],zn=Pn[5],Bn=Pn[9],Vn=Pn[2],Hn=Pn[6],qn=Pn[10],Yn=zn*qn-Bn*Hn,$n=Bn*Vn-In*qn,ra=In*Hn-zn*Vn,oa=len3(Yn,$n,ra);for(Yn/=oa,$n/=oa,ra/=oa,Pn[0]=Yn,Pn[4]=$n,Pn[8]=ra,nt=0;nt<3;++nt)En[nt]=br[nt]+Pn[2+4*nt]*Ot;for(nt=0;nt<3;++nt){dt=0;for(var pa=0;pa<3;++pa)dt+=Pn[nt+4*pa]*En[pa];Pn[12+nt]=-dt}Pn[15]=1},dt.getMatrix=function(Ne,Ge){this.recalcMatrix(Ne);var Qe=this.computedMatrix;if(Ge){for(var tt=0;tt<16;++tt)Ge[tt]=Qe[tt];return Ge}return Qe};var ht=[0,0,0];function createTurntableController(Ne){var Ge=(Ne=Ne||{}).center||[0,0,0],Qe=Ne.up||[0,1,0],tt=Ne.right||findOrthoPair(Qe),rt=Ne.radius||1,nt=Ne.theta||0,dt=Ne.phi||0;if(Ge=[].slice.call(Ge,0,3),Qe=[].slice.call(Qe,0,3),it(Qe,Qe),tt=[].slice.call(tt,0,3),it(tt,tt),"eye"in Ne){var ht=Ne.eye,Dt=[ht[0]-Ge[0],ht[1]-Ge[1],ht[2]-Ge[2]];at(tt,Dt,Qe),len3(tt[0],tt[1],tt[2])<1e-6?tt=findOrthoPair(Qe):it(tt,tt),rt=len3(Dt[0],Dt[1],Dt[2]);var Ot=ot(Qe,Dt)/rt,Rt=ot(tt,Dt)/rt;dt=Math.acos(Ot),nt=Math.acos(Rt)}return rt=Math.log(rt),new TurntableController(Ne.zoomMin,Ne.zoomMax,Ge,Qe,tt,rt,nt,dt)}dt.rotate=function(Ne,Ge,Qe,tt){if(this.angle.move(Ne,Ge,Qe),tt){this.recalcMatrix(Ne);var rt=this.computedMatrix;ht[0]=rt[2],ht[1]=rt[6],ht[2]=rt[10];for(var at=this.computedUp,it=this.computedRight,ot=this.computedToward,dt=0;dt<3;++dt)rt[4*dt]=at[dt],rt[4*dt+1]=it[dt],rt[4*dt+2]=ot[dt];for(nt(rt,rt,tt,ht),dt=0;dt<3;++dt)at[dt]=rt[4*dt],it[dt]=rt[4*dt+1];this.up.set(Ne,at[0],at[1],at[2]),this.right.set(Ne,it[0],it[1],it[2])}},dt.pan=function(Ne,Ge,Qe,tt){Ge=Ge||0,Qe=Qe||0,tt=tt||0,this.recalcMatrix(Ne);var rt=this.computedMatrix,nt=(Math.exp(this.computedRadius[0]),rt[1]),at=rt[5],it=rt[9],ot=len3(nt,at,it);nt/=ot,at/=ot,it/=ot;var dt=rt[0],ht=rt[4],Dt=rt[8],Ot=dt*nt+ht*at+Dt*it,Rt=len3(dt-=nt*Ot,ht-=at*Ot,Dt-=it*Ot),Zt=(dt/=Rt)*Ge+nt*Qe,er=(ht/=Rt)*Ge+at*Qe,dr=(Dt/=Rt)*Ge+it*Qe;this.center.move(Ne,Zt,er,dr);var mr=Math.exp(this.computedRadius[0]);mr=Math.max(1e-4,mr+tt),this.radius.set(Ne,Math.log(mr))},dt.translate=function(Ne,Ge,Qe,tt){this.center.move(Ne,Ge||0,Qe||0,tt||0)},dt.setMatrix=function(Ne,Ge,Qe,tt){var nt=1;"number"==typeof Qe&&(nt=0|Qe),(nt<0||nt>3)&&(nt=1);var at=(nt+2)%3;Ge||(this.recalcMatrix(Ne),Ge=this.computedMatrix);var it=Ge[nt],ot=Ge[nt+4],dt=Ge[nt+8];if(tt){var ht=Math.abs(it),Dt=Math.abs(ot),Ot=Math.abs(dt),Rt=Math.max(ht,Dt,Ot);ht===Rt?(it=it<0?-1:1,ot=dt=0):Ot===Rt?(dt=dt<0?-1:1,it=ot=0):(ot=ot<0?-1:1,it=dt=0)}else{var Zt=len3(it,ot,dt);it/=Zt,ot/=Zt,dt/=Zt}var er,dr,mr=Ge[at],xr=Ge[at+4],br=Ge[at+8],Ar=mr*it+xr*ot+br*dt,en=len3(mr-=it*Ar,xr-=ot*Ar,br-=dt*Ar),mn=ot*(br/=en)-dt*(xr/=en),xn=dt*(mr/=en)-it*br,kn=it*xr-ot*mr,Cn=len3(mn,xn,kn);if(mn/=Cn,xn/=Cn,kn/=Cn,this.center.jump(Ne,_a,Va,Wa),this.radius.idle(Ne),this.up.jump(Ne,it,ot,dt),this.right.jump(Ne,mr,xr,br),2===nt){var En=Ge[1],Pn=Ge[5],Dn=Ge[9],In=En*mr+Pn*xr+Dn*br,zn=En*mn+Pn*xn+Dn*kn;er=qn<0?-Math.PI/2:Math.PI/2,dr=Math.atan2(zn,In)}else{var Bn=Ge[2],Vn=Ge[6],Hn=Ge[10],qn=Bn*it+Vn*ot+Hn*dt,Yn=Bn*mr+Vn*xr+Hn*br,$n=Bn*mn+Vn*xn+Hn*kn;er=Math.asin(clamp1(qn)),dr=Math.atan2($n,Yn)}this.angle.jump(Ne,dr,er),this.recalcMatrix(Ne);var ra=Ge[2],oa=Ge[6],pa=Ge[10],ga=this.computedMatrix;rt(ga,Ge);var ma=ga[15],_a=ga[12]/ma,Va=ga[13]/ma,Wa=ga[14]/ma,Qa=Math.exp(this.computedRadius[0]);this.center.jump(Ne,_a-ra*Qa,Va-oa*Qa,Wa-pa*Qa)},dt.lastT=function(){return Math.max(this.center.lastT(),this.up.lastT(),this.right.lastT(),this.radius.lastT(),this.angle.lastT())},dt.idle=function(Ne){this.center.idle(Ne),this.up.idle(Ne),this.right.idle(Ne),this.radius.idle(Ne),this.angle.idle(Ne)},dt.flush=function(Ne){this.center.flush(Ne),this.up.flush(Ne),this.right.flush(Ne),this.radius.flush(Ne),this.angle.flush(Ne)},dt.setDistance=function(Ne,Ge){Ge>0&&this.radius.set(Ne,Math.log(Ge))},dt.lookAt=function(Ne,Ge,Qe,tt){this.recalcMatrix(Ne),Ge=Ge||this.computedEye,Qe=Qe||this.computedCenter;var rt=(tt=tt||this.computedUp)[0],nt=tt[1],at=tt[2],it=len3(rt,nt,at);if(!(it<1e-6)){rt/=it,nt/=it,at/=it;var ot=Ge[0]-Qe[0],dt=Ge[1]-Qe[1],ht=Ge[2]-Qe[2],Dt=len3(ot,dt,ht);if(!(Dt<1e-6)){ot/=Dt,dt/=Dt,ht/=Dt;var Ot=this.computedRight,Rt=Ot[0],Zt=Ot[1],er=Ot[2],dr=rt*Rt+nt*Zt+at*er,mr=len3(Rt-=dr*rt,Zt-=dr*nt,er-=dr*at);if(!(mr<.01&&(mr=len3(Rt=nt*ht-at*dt,Zt=at*ot-rt*ht,er=rt*dt-nt*ot))<1e-6)){Rt/=mr,Zt/=mr,er/=mr,this.up.set(Ne,rt,nt,at),this.right.set(Ne,Rt,Zt,er),this.center.set(Ne,Qe[0],Qe[1],Qe[2]),this.radius.set(Ne,Math.log(Dt));var xr=nt*er-at*Zt,br=at*Rt-rt*er,Ar=rt*Zt-nt*Rt,en=len3(xr,br,Ar),mn=rt*ot+nt*dt+at*ht,xn=Rt*ot+Zt*dt+er*ht,kn=(xr/=en)*ot+(br/=en)*dt+(Ar/=en)*ht,Cn=Math.asin(clamp1(mn)),En=Math.atan2(kn,xn),Pn=this.angle._state,Dn=Pn[Pn.length-1],In=Pn[Pn.length-2];Dn%=2*Math.PI;var zn=Math.abs(Dn+2*Math.PI-En),Bn=Math.abs(Dn-En),Vn=Math.abs(Dn-2*Math.PI-En);zn<Bn&&(Dn+=2*Math.PI),Vn<Bn&&(Dn-=2*Math.PI),this.angle.jump(this.angle.lastT(),Dn,In),this.angle.set(Ne,En,Cn)}}}}},{"filtered-vector":242,"gl-mat4/invert":293,"gl-mat4/rotate":299,"gl-vec3/cross":365,"gl-vec3/dot":370,"gl-vec3/normalize":387}],582:[function(Ne,Ge,Qe){"use strict";Ge.exports=twoProduct;var tt=+(Math.pow(2,27)+1);function twoProduct(Ne,Ge,Qe){var rt=Ne*Ge,nt=tt*Ne,at=nt-(nt-Ne),it=Ne-at,ot=tt*Ge,dt=ot-(ot-Ge),ht=Ge-dt,Dt=it*ht-(rt-at*dt-it*dt-at*ht);return Qe?(Qe[0]=Dt,Qe[1]=rt,Qe):[Dt,rt]}},{}],583:[function(Ne,Ge,Qe){"use strict";function fastTwoSum(Ne,Ge,Qe){var tt=Ne+Ge,rt=tt-Ne,nt=Ge-rt,at=Ne-(tt-rt);return Qe?(Qe[0]=at+nt,Qe[1]=tt,Qe):[at+nt,tt]}Ge.exports=fastTwoSum},{}],584:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../prototype/is");Ge.exports=function(Ne){if("function"!=typeof Ne)return!1;if(!hasOwnProperty.call(Ne,"length"))return!1;try{if("number"!=typeof Ne.length)return!1;if("function"!=typeof Ne.call)return!1;if("function"!=typeof Ne.apply)return!1}catch(Ne){return!1}return!tt(Ne)}},{"../prototype/is":591}],585:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../value/is"),rt=Ne("../object/is"),nt=Ne("../string/coerce"),at=Ne("./to-short-string"),resolveMessage=function(Ne,Ge){return Ne.replace("%v",at(Ge))};Ge.exports=function(Ne,Ge,Qe){if(!rt(Qe))throw new TypeError(resolveMessage(Ge,Ne));if(!tt(Ne)){if("default"in Qe)return Qe.default;if(Qe.isOptional)return null}var at=nt(Qe.errorMessage);throw tt(at)||(at=Ge),new TypeError(resolveMessage(at,Ne))}},{"../object/is":588,"../string/coerce":592,"../value/is":594,"./to-short-string":587}],586:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne){try{return Ne.toString()}catch(Ge){try{return String(Ne)}catch(Ne){return null}}}},{}],587:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./safe-to-string"),rt=/[\n\r\u2028\u2029]/g;Ge.exports=function(Ne){var Ge=tt(Ne);return null===Ge?"<Non-coercible to string value>":(Ge.length>100&&(Ge=Ge.slice(0,99)+"â¦"),Ge=Ge.replace(rt,(function(Ne){switch(Ne){case"\n":return"\\n";case"\r":return"\\r";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw new Error("Unexpected character")}})))}},{"./safe-to-string":586}],588:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../value/is"),rt={object:!0,function:!0,undefined:!0};Ge.exports=function(Ne){return!!tt(Ne)&&hasOwnProperty.call(rt,typeof Ne)}},{"../value/is":594}],589:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../lib/resolve-exception"),rt=Ne("./is");Ge.exports=function(Ne){return rt(Ne)?Ne:tt(Ne,"%v is not a plain function",arguments[1])}},{"../lib/resolve-exception":585,"./is":590}],590:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../function/is"),rt=/^\s*class[\s{/}]/,nt=Function.prototype.toString;Ge.exports=function(Ne){return!!tt(Ne)&&!rt.test(nt.call(Ne))}},{"../function/is":584}],591:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../object/is");Ge.exports=function(Ne){if(!tt(Ne))return!1;try{return!!Ne.constructor&&Ne.constructor.prototype===Ne}catch(Ne){return!1}}},{"../object/is":588}],592:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../value/is"),rt=Ne("../object/is"),nt=Object.prototype.toString;Ge.exports=function(Ne){if(!tt(Ne))return null;if(rt(Ne)){var Ge=Ne.toString;if("function"!=typeof Ge)return null;if(Ge===nt)return null}try{return""+Ne}catch(Ne){return null}}},{"../object/is":588,"../value/is":594}],593:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../lib/resolve-exception"),rt=Ne("./is");Ge.exports=function(Ne){return rt(Ne)?Ne:tt(Ne,"Cannot use %v",arguments[1])}},{"../lib/resolve-exception":585,"./is":594}],594:[function(Ne,Ge,Qe){"use strict";var tt=void 0;Ge.exports=function(Ne){return Ne!==tt&&null!==Ne}},{}],595:[function(Ne,Ge,tt){(function(Ge){(function(){"use strict";var Qe=Ne("bit-twiddle"),rt=Ne("dup"),nt=Ne("buffer").Buffer;Ge.__TYPEDARRAY_POOL||(Ge.__TYPEDARRAY_POOL={UINT8:rt([32,0]),UINT16:rt([32,0]),UINT32:rt([32,0]),BIGUINT64:rt([32,0]),INT8:rt([32,0]),INT16:rt([32,0]),INT32:rt([32,0]),BIGINT64:rt([32,0]),FLOAT:rt([32,0]),DOUBLE:rt([32,0]),DATA:rt([32,0]),UINT8C:rt([32,0]),BUFFER:rt([32,0])});var at="undefined"!=typeof Uint8ClampedArray,it="undefined"!=typeof BigUint64Array,ot="undefined"!=typeof BigInt64Array,dt=Ge.__TYPEDARRAY_POOL;dt.UINT8C||(dt.UINT8C=rt([32,0])),dt.BIGUINT64||(dt.BIGUINT64=rt([32,0])),dt.BIGINT64||(dt.BIGINT64=rt([32,0])),dt.BUFFER||(dt.BUFFER=rt([32,0]));var ht=dt.DATA,Dt=dt.BUFFER;function freeArrayBuffer(Ne){if(Ne){var Ge=Ne.length||Ne.byteLength,tt=Qe.log2(Ge);ht[tt].push(Ne)}}function freeTypedArray(Ne){freeArrayBuffer(Ne.buffer)}function mallocArrayBuffer(Ne){Ne=Qe.nextPow2(Ne);var Ge=Qe.log2(Ne),tt=ht[Ge];return tt.length>0?tt.pop():new ArrayBuffer(Ne)}function mallocUint8(Ne){return new Uint8Array(mallocArrayBuffer(Ne),0,Ne)}function mallocUint16(Ne){return new Uint16Array(mallocArrayBuffer(2*Ne),0,Ne)}function mallocUint32(Ne){return new Uint32Array(mallocArrayBuffer(4*Ne),0,Ne)}function mallocInt8(Ne){return new Int8Array(mallocArrayBuffer(Ne),0,Ne)}function mallocInt16(Ne){return new Int16Array(mallocArrayBuffer(2*Ne),0,Ne)}function mallocInt32(Ne){return new Int32Array(mallocArrayBuffer(4*Ne),0,Ne)}function mallocFloat(Ne){return new Float32Array(mallocArrayBuffer(4*Ne),0,Ne)}function mallocDouble(Ne){return new Float64Array(mallocArrayBuffer(8*Ne),0,Ne)}function mallocUint8Clamped(Ne){return at?new Uint8ClampedArray(mallocArrayBuffer(Ne),0,Ne):mallocUint8(Ne)}function mallocBigUint64(Ne){return it?new BigUint64Array(mallocArrayBuffer(8*Ne),0,Ne):null}function mallocBigInt64(Ne){return ot?new BigInt64Array(mallocArrayBuffer(8*Ne),0,Ne):null}function mallocDataView(Ne){return new DataView(mallocArrayBuffer(Ne),0,Ne)}function mallocBuffer(Ne){Ne=Qe.nextPow2(Ne);var Ge=Qe.log2(Ne),tt=Dt[Ge];return tt.length>0?tt.pop():new nt(Ne)}tt.free=function(Ne){if(nt.isBuffer(Ne))Dt[Qe.log2(Ne.length)].push(Ne);else{if("[object ArrayBuffer]"!==Object.prototype.toString.call(Ne)&&(Ne=Ne.buffer),!Ne)return;var Ge=Ne.length||Ne.byteLength,tt=0|Qe.log2(Ge);ht[tt].push(Ne)}},tt.freeUint8=tt.freeUint16=tt.freeUint32=tt.freeBigUint64=tt.freeInt8=tt.freeInt16=tt.freeInt32=tt.freeBigInt64=tt.freeFloat32=tt.freeFloat=tt.freeFloat64=tt.freeDouble=tt.freeUint8Clamped=tt.freeDataView=freeTypedArray,tt.freeArrayBuffer=freeArrayBuffer,tt.freeBuffer=function(Ne){Dt[Qe.log2(Ne.length)].push(Ne)},tt.malloc=function(Ne,Ge){if(void 0===Ge||"arraybuffer"===Ge)return mallocArrayBuffer(Ne);switch(Ge){case"uint8":return mallocUint8(Ne);case"uint16":return mallocUint16(Ne);case"uint32":return mallocUint32(Ne);case"int8":return mallocInt8(Ne);case"int16":return mallocInt16(Ne);case"int32":return mallocInt32(Ne);case"float":case"float32":return mallocFloat(Ne);case"double":case"float64":return mallocDouble(Ne);case"uint8_clamped":return mallocUint8Clamped(Ne);case"bigint64":return mallocBigInt64(Ne);case"biguint64":return mallocBigUint64(Ne);case"buffer":return mallocBuffer(Ne);case"data":case"dataview":return mallocDataView(Ne);default:return null}return null},tt.mallocArrayBuffer=mallocArrayBuffer,tt.mallocUint8=mallocUint8,tt.mallocUint16=mallocUint16,tt.mallocUint32=mallocUint32,tt.mallocInt8=mallocInt8,tt.mallocInt16=mallocInt16,tt.mallocInt32=mallocInt32,tt.mallocFloat32=tt.mallocFloat=mallocFloat,tt.mallocFloat64=tt.mallocDouble=mallocDouble,tt.mallocUint8Clamped=mallocUint8Clamped,tt.mallocBigUint64=mallocBigUint64,tt.mallocBigInt64=mallocBigInt64,tt.mallocDataView=mallocDataView,tt.mallocBuffer=mallocBuffer,tt.clearCache=function(){for(var Ne=0;Ne<32;++Ne)dt.UINT8[Ne].length=0,dt.UINT16[Ne].length=0,dt.UINT32[Ne].length=0,dt.INT8[Ne].length=0,dt.INT16[Ne].length=0,dt.INT32[Ne].length=0,dt.FLOAT[Ne].length=0,dt.DOUBLE[Ne].length=0,dt.BIGUINT64[Ne].length=0,dt.BIGINT64[Ne].length=0,dt.UINT8C[Ne].length=0,ht[Ne].length=0,Dt[Ne].length=0}}).call(this)}).call(this,void 0!==Qe.g?Qe.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"bit-twiddle":97,buffer:111,dup:176}],596:[function(Ne,Ge,Qe){"use strict";function UnionFind(Ne){this.roots=new Array(Ne),this.ranks=new Array(Ne);for(var Ge=0;Ge<Ne;++Ge)this.roots[Ge]=Ge,this.ranks[Ge]=0}Ge.exports=UnionFind;var tt=UnionFind.prototype;Object.defineProperty(tt,"length",{get:function(){return this.roots.length}}),tt.makeSet=function(){var Ne=this.roots.length;return this.roots.push(Ne),this.ranks.push(0),Ne},tt.find=function(Ne){for(var Ge=Ne,Qe=this.roots;Qe[Ne]!==Ne;)Ne=Qe[Ne];for(;Qe[Ge]!==Ne;){var tt=Qe[Ge];Qe[Ge]=Ne,Ge=tt}return Ne},tt.link=function(Ne,Ge){var Qe=this.find(Ne),tt=this.find(Ge);if(Qe!==tt){var rt=this.ranks,nt=this.roots,at=rt[Qe],it=rt[tt];at<it?nt[Qe]=tt:it<at?nt[tt]=Qe:(nt[tt]=Qe,++rt[Qe])}}},{}],597:[function(Ne,Ge,Qe){"use strict";function unique_pred(Ne,Ge){for(var Qe=1,tt=Ne.length,rt=Ne[0],nt=Ne[0],at=1;at<tt;++at)if(nt=rt,Ge(rt=Ne[at],nt)){if(at===Qe){Qe++;continue}Ne[Qe++]=rt}return Ne.length=Qe,Ne}function unique_eq(Ne){for(var Ge=1,Qe=Ne.length,tt=Ne[0],rt=Ne[0],nt=1;nt<Qe;++nt,rt=tt)if(rt=tt,(tt=Ne[nt])!==rt){if(nt===Ge){Ge++;continue}Ne[Ge++]=tt}return Ne.length=Ge,Ne}function unique(Ne,Ge,Qe){return 0===Ne.length?Ne:Ge?(Qe||Ne.sort(Ge),unique_pred(Ne,Ge)):(Qe||Ne.sort(),unique_eq(Ne))}Ge.exports=unique},{}],598:[function(Ne,Ge,Qe){var tt=/[\'\"]/;Ge.exports=function(Ne){return Ne?(tt.test(Ne.charAt(0))&&(Ne=Ne.substr(1)),tt.test(Ne.charAt(Ne.length-1))&&(Ne=Ne.substr(0,Ne.length-1)),Ne):""}},{}],599:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge,Qe){Array.isArray(Qe)||(Qe=[].slice.call(arguments,2));for(var tt=0,rt=Qe.length;tt<rt;tt++){var nt=Qe[tt];for(var at in nt)if((void 0===Ge[at]||Array.isArray(Ge[at])||Ne[at]!==Ge[at])&&at in Ge){var it;if(!0===nt[at])it=Ge[at];else{if(!1===nt[at])continue;if("function"==typeof nt[at]&&void 0===(it=nt[at](Ge[at],Ne,Ge)))continue}Ne[at]=it}}return Ne}},{}],600:[function(Ne,Ge,Qe){"use strict";Ge.exports=createText;var tt=Ne("./lib/vtext"),rt=null,nt=null;function createText(Ne,Ge){return"object"==typeof Ge&&null!==Ge||(Ge={}),tt(Ne,Ge.canvas||rt,Ge.context||nt,Ge)}"undefined"!=typeof document&&((rt=document.createElement("canvas")).width=8192,rt.height=1024,nt=rt.getContext("2d"))},{"./lib/vtext":601}],601:[function(Ne,Ge,Qe){Ge.exports=vectorizeText,Ge.exports.processPixels=processPixels;var tt=Ne("surface-nets"),rt=Ne("ndarray"),nt=Ne("simplify-planar-graph"),at=Ne("clean-pslg"),it=Ne("cdt2d"),ot=Ne("planar-graph-to-polyline"),dt="b",ht="b|",Dt="i",Ot="i|",Rt="sup",Zt="+",er="+1",dr="sub",mr="-",xr="-1";function parseTag(Ne,Ge,Qe,tt){for(var rt="<"+Ne+">",nt="</"+Ne+">",at=rt.length,it=nt.length,ot=Ge[0]===Zt||Ge[0]===mr,dt=0,ht=-it;dt>-1&&-1!==(dt=Qe.indexOf(rt,dt))&&-1!==(ht=Qe.indexOf(nt,dt+at))&&!(ht<=dt);){for(var Dt=dt;Dt<ht+it;++Dt)if(Dt<dt+at||Dt>=ht)tt[Dt]=null,Qe=Qe.substr(0,Dt)+" "+Qe.substr(Dt+1);else if(null!==tt[Dt]){var Ot=tt[Dt].indexOf(Ge[0]);-1===Ot?tt[Dt]+=Ge:ot&&(tt[Dt]=tt[Dt].substr(0,Ot+1)+(1+parseInt(tt[Dt][Ot+1]))+tt[Dt].substr(Ot+2))}var Rt=dt+at,er=Qe.substr(Rt,ht-Rt).indexOf(rt);dt=-1!==er?er:ht+it}return tt}function transformPositions(Ne,Ge,Qe){for(var tt=Ge.textAlign||"start",rt=Ge.textBaseline||"alphabetic",nt=[1<<30,1<<30],at=[0,0],it=Ne.length,ot=0;ot<it;++ot)for(var dt=Ne[ot],ht=0;ht<2;++ht)nt[ht]=0|Math.min(nt[ht],dt[ht]),at[ht]=0|Math.max(at[ht],dt[ht]);var Dt=0;switch(tt){case"center":Dt=-.5*(nt[0]+at[0]);break;case"right":case"end":Dt=-at[0];break;case"left":case"start":Dt=-nt[0];break;default:throw new Error("vectorize-text: Unrecognized textAlign: '"+tt+"'")}var Ot=0;switch(rt){case"hanging":case"top":Ot=-nt[1];break;case"middle":Ot=-.5*(nt[1]+at[1]);break;case"alphabetic":case"ideographic":Ot=-3*Qe;break;case"bottom":Ot=-at[1];break;default:throw new Error("vectorize-text: Unrecoginized textBaseline: '"+rt+"'")}var Rt=1/Qe;return"lineHeight"in Ge?Rt*=+Ge.lineHeight:"width"in Ge?Rt=Ge.width/(at[0]-nt[0]):"height"in Ge&&(Rt=Ge.height/(at[1]-nt[1])),Ne.map((function(Ne){return[Rt*(Ne[0]+Dt),Rt*(Ne[1]+Ot)]}))}function getPixels(Ne,Ge,Qe,tt,nt,at){Qe=Qe.replace(/\n/g,""),Qe=!0===at.breaklines?Qe.replace(/\<br\>/g,"\n"):Qe.replace(/\<br\>/g," ");var it="",ot=[];for(mn=0;mn<Qe.length;++mn)ot[mn]=it;!0===at.bolds&&(ot=parseTag(dt,ht,Qe,ot)),!0===at.italics&&(ot=parseTag(Dt,Ot,Qe,ot)),!0===at.superscripts&&(ot=parseTag(Rt,er,Qe,ot)),!0===at.subscripts&&(ot=parseTag(dr,xr,Qe,ot));var br=[],Ar="";for(mn=0;mn<Qe.length;++mn)null!==ot[mn]&&(Ar+=Qe[mn],br.push(ot[mn]));var en,mn,xn,kn,Cn,En=Ar.split("\n"),Pn=En.length,Dn=Math.round(nt*tt),In=tt,zn=2*tt,Bn=0,Vn=Pn*Dn+zn;Ne.height<Vn&&(Ne.height=Vn),Ge.fillStyle="#000",Ge.fillRect(0,0,Ne.width,Ne.height),Ge.fillStyle="#fff";var Hn=0,qn="";function writeBuffer(){if(""!==qn){var Ne=Ge.measureText(qn).width;Ge.fillText(qn,In+xn,zn+kn),xn+=Ne}}function getTextFontSize(){return Math.round(Cn)+"px "}function changeStyle(Ne,Qe){var tt=""+Ge.font;if(!0===at.subscripts){var rt=Ne.indexOf(mr),nt=Qe.indexOf(mr),it=rt>-1?parseInt(Ne[1+rt]):0,ot=nt>-1?parseInt(Qe[1+nt]):0;it!==ot&&(tt=tt.replace(getTextFontSize(),"?px "),Cn*=Math.pow(.75,ot-it),tt=tt.replace("?px ",getTextFontSize())),kn+=.25*Dn*(ot-it)}if(!0===at.superscripts){var dt=Ne.indexOf(Zt),Dt=Qe.indexOf(Zt),Rt=dt>-1?parseInt(Ne[1+dt]):0,er=Dt>-1?parseInt(Qe[1+Dt]):0;Rt!==er&&(tt=tt.replace(getTextFontSize(),"?px "),Cn*=Math.pow(.75,er-Rt),tt=tt.replace("?px ",getTextFontSize())),kn-=.25*Dn*(er-Rt)}if(!0===at.bolds){var dr=Ne.indexOf(ht)>-1,xr=Qe.indexOf(ht)>-1;!dr&&xr&&(tt=br?tt.replace("italic ","italic bold "):"bold "+tt),dr&&!xr&&(tt=tt.replace("bold ",""))}if(!0===at.italics){var br=Ne.indexOf(Ot)>-1,Ar=Qe.indexOf(Ot)>-1;!br&&Ar&&(tt="italic "+tt),br&&!Ar&&(tt=tt.replace("italic ",""))}Ge.font=tt}for(en=0;en<Pn;++en){var Yn=En[en]+"\n";for(xn=0,kn=en*Dn,Cn=tt,qn="",mn=0;mn<Yn.length;++mn){var $n=mn+Hn<br.length?br[mn+Hn]:br[br.length-1];it===$n?qn+=Yn[mn]:(writeBuffer(),qn=Yn[mn],void 0!==$n&&(changeStyle(it,$n),it=$n))}writeBuffer(),Hn+=Yn.length;var ra=0|Math.round(xn+2*In);Bn<ra&&(Bn=ra)}var oa=Bn,pa=zn+Dn*Pn;return rt(Ge.getImageData(0,0,oa,pa).data,[pa,oa,4]).pick(-1,-1,0).transpose(1,0)}function getContour(Ne,Ge){var Qe=tt(Ne,128);return Ge?nt(Qe.cells,Qe.positions,.25):{edges:Qe.cells,positions:Qe.positions}}function processPixelsImpl(Ne,Ge,Qe,tt){var rt=getContour(Ne,tt),nt=transformPositions(rt.positions,Ge,Qe),dt=rt.edges,ht="ccw"===Ge.orientation;if(at(nt,dt),Ge.polygons||Ge.polygon||Ge.polyline){for(var Dt=ot(dt,nt),Ot=new Array(Dt.length),Rt=0;Rt<Dt.length;++Rt){for(var Zt=Dt[Rt],er=new Array(Zt.length),dr=0;dr<Zt.length;++dr){for(var mr=Zt[dr],xr=new Array(mr.length),br=0;br<mr.length;++br)xr[br]=nt[mr[br]].slice();ht&&xr.reverse(),er[dr]=xr}Ot[Rt]=er}return Ot}return Ge.triangles||Ge.triangulate||Ge.triangle?{cells:it(nt,dt,{delaunay:!1,exterior:!1,interior:!0}),positions:nt}:{edges:dt,positions:nt}}function processPixels(Ne,Ge,Qe){try{return processPixelsImpl(Ne,Ge,Qe,!0)}catch(Ne){}try{return processPixelsImpl(Ne,Ge,Qe,!1)}catch(Ne){}return Ge.polygons||Ge.polyline||Ge.polygon?[]:Ge.triangles||Ge.triangulate||Ge.triangle?{cells:[],positions:[]}:{edges:[],positions:[]}}function vectorizeText(Ne,Ge,Qe,tt){var rt=64,nt=1.25,at={breaklines:!1,bolds:!1,italics:!1,subscripts:!1,superscripts:!1};return tt&&(tt.size&&tt.size>0&&(rt=tt.size),tt.lineSpacing&&tt.lineSpacing>0&&(nt=tt.lineSpacing),tt.styletags&&tt.styletags.breaklines&&(at.breaklines=!!tt.styletags.breaklines),tt.styletags&&tt.styletags.bolds&&(at.bolds=!!tt.styletags.bolds),tt.styletags&&tt.styletags.italics&&(at.italics=!!tt.styletags.italics),tt.styletags&&tt.styletags.subscripts&&(at.subscripts=!!tt.styletags.subscripts),tt.styletags&&tt.styletags.superscripts&&(at.superscripts=!!tt.styletags.superscripts)),Qe.font=[tt.fontStyle,tt.fontVariant,tt.fontWeight,rt+"px",tt.font].filter((function(Ne){return Ne})).join(" "),Qe.textAlign="start",Qe.textBaseline="alphabetic",Qe.direction="ltr",processPixels(getPixels(Ge,Qe,Ne,rt,nt,at),tt,rt)}},{cdt2d:112,"clean-pslg":121,ndarray:495,"planar-graph-to-polyline":514,"simplify-planar-graph":562,"surface-nets":570}],602:[function(Ne,Ge,Qe){!function(){"use strict";if("undefined"==typeof ses||!ses.ok||ses.ok()){"undefined"!=typeof ses&&(ses.weakMapPermitHostObjects=weakMapPermitHostObjects);var Ne=!1;if("function"==typeof WeakMap){var Qe=WeakMap;if("undefined"!=typeof navigator&&/Firefox/.test(navigator.userAgent));else{var tt=new Qe,rt=Object.freeze({});if(tt.set(rt,1),1===tt.get(rt))return void(Ge.exports=WeakMap);Ne=!0}}Object.prototype.hasOwnProperty;var nt=Object.getOwnPropertyNames,at=Object.defineProperty,it=Object.isExtensible,ot="weakmap:",dt=ot+"ident:"+Math.random()+"___";if("undefined"!=typeof crypto&&"function"==typeof crypto.getRandomValues&&"function"==typeof ArrayBuffer&&"function"==typeof Uint8Array){var ht=new ArrayBuffer(25),Dt=new Uint8Array(ht);crypto.getRandomValues(Dt),dt=ot+"rand:"+Array.prototype.map.call(Dt,(function(Ne){return(Ne%36).toString(36)})).join("")+"___"}if(at(Object,"getOwnPropertyNames",{value:function(Ne){return nt(Ne).filter(isNotHiddenName)}}),"getPropertyNames"in Object){var Ot=Object.getPropertyNames;at(Object,"getPropertyNames",{value:function(Ne){return Ot(Ne).filter(isNotHiddenName)}})}!function(){var Ne=Object.freeze;at(Object,"freeze",{value:function(Ge){return getHiddenRecord(Ge),Ne(Ge)}});var Ge=Object.seal;at(Object,"seal",{value:function(Ne){return getHiddenRecord(Ne),Ge(Ne)}});var Qe=Object.preventExtensions;at(Object,"preventExtensions",{value:function(Ne){return getHiddenRecord(Ne),Qe(Ne)}})}();var Rt=!1,Zt=0,OurWeakMap=function(){this instanceof OurWeakMap||calledAsFunctionWarning();var Ne=[],Ge=[],Qe=Zt++;function get___(tt,rt){var nt,at=getHiddenRecord(tt);return at?Qe in at?at[Qe]:rt:(nt=Ne.indexOf(tt))>=0?Ge[nt]:rt}function has___(Ge){var tt=getHiddenRecord(Ge);return tt?Qe in tt:Ne.indexOf(Ge)>=0}function set___(tt,rt){var nt,at=getHiddenRecord(tt);return at?at[Qe]=rt:(nt=Ne.indexOf(tt))>=0?Ge[nt]=rt:(nt=Ne.length,Ge[nt]=rt,Ne[nt]=tt),this}function delete___(tt){var rt,nt,at=getHiddenRecord(tt);return at?Qe in at&&delete at[Qe]:!((rt=Ne.indexOf(tt))<0||(nt=Ne.length-1,Ne[rt]=void 0,Ge[rt]=Ge[nt],Ne[rt]=Ne[nt],Ne.length=nt,Ge.length=nt,0))}return Object.create(OurWeakMap.prototype,{get___:{value:constFunc(get___)},has___:{value:constFunc(has___)},set___:{value:constFunc(set___)},delete___:{value:constFunc(delete___)}})};OurWeakMap.prototype=Object.create(Object.prototype,{get:{value:function(Ne,Ge){return this.get___(Ne,Ge)},writable:!0,configurable:!0},has:{value:function(Ne){return this.has___(Ne)},writable:!0,configurable:!0},set:{value:function(Ne,Ge){return this.set___(Ne,Ge)},writable:!0,configurable:!0},delete:{value:function(Ne){return this.delete___(Ne)},writable:!0,configurable:!0}}),"function"==typeof Qe?function(){function DoubleWeakMap(){this instanceof OurWeakMap||calledAsFunctionWarning();var Ge,tt=new Qe,rt=void 0,nt=!1;function dget(Ne,Ge){return rt?tt.has(Ne)?tt.get(Ne):rt.get___(Ne,Ge):tt.get(Ne,Ge)}function dhas(Ne){return tt.has(Ne)||!!rt&&rt.has___(Ne)}function ddelete(Ne){var Ge=!!tt.delete(Ne);return rt&&rt.delete___(Ne)||Ge}return Ge=Ne?function(Ne,Ge){return tt.set(Ne,Ge),tt.has(Ne)||(rt||(rt=new OurWeakMap),rt.set(Ne,Ge)),this}:function(Ne,Ge){if(nt)try{tt.set(Ne,Ge)}catch(Qe){rt||(rt=new OurWeakMap),rt.set___(Ne,Ge)}else tt.set(Ne,Ge);return this},Object.create(OurWeakMap.prototype,{get___:{value:constFunc(dget)},has___:{value:constFunc(dhas)},set___:{value:constFunc(Ge)},delete___:{value:constFunc(ddelete)},permitHostObjects___:{value:constFunc((function(Ne){if(Ne!==weakMapPermitHostObjects)throw new Error("bogus call to permitHostObjects___");nt=!0}))}})}Ne&&"undefined"!=typeof Proxy&&(Proxy=void 0),DoubleWeakMap.prototype=OurWeakMap.prototype,Ge.exports=DoubleWeakMap,Object.defineProperty(WeakMap.prototype,"constructor",{value:WeakMap,enumerable:!1,configurable:!0,writable:!0})}():("undefined"!=typeof Proxy&&(Proxy=void 0),Ge.exports=OurWeakMap)}function weakMapPermitHostObjects(Ne){Ne.permitHostObjects___&&Ne.permitHostObjects___(weakMapPermitHostObjects)}function isNotHiddenName(Ne){return!(Ne.substr(0,ot.length)==ot&&"___"===Ne.substr(Ne.length-3))}function getHiddenRecord(Ne){if(Ne!==Object(Ne))throw new TypeError("Not an object: "+Ne);var Ge=Ne[dt];if(Ge&&Ge.key===Ne)return Ge;if(it(Ne)){Ge={key:Ne};try{return at(Ne,dt,{value:Ge,writable:!1,enumerable:!1,configurable:!1}),Ge}catch(Ne){return}}}function constFunc(Ne){return Ne.prototype=null,Object.freeze(Ne)}function calledAsFunctionWarning(){Rt||"undefined"==typeof console||(Rt=!0,console.warn("WeakMap should be invoked as new WeakMap(), not WeakMap(). This will be an error in the future."))}}()},{}],603:[function(Ne,Ge,Qe){var tt=Ne("./hidden-store.js");function createStore(){var Ne={};return function(Ge){if(("object"!=typeof Ge||null===Ge)&&"function"!=typeof Ge)throw new Error("Weakmap-shim: Key must be object");var Qe=Ge.valueOf(Ne);return Qe&&Qe.identity===Ne?Qe:tt(Ge,Ne)}}Ge.exports=createStore},{"./hidden-store.js":604}],604:[function(Ne,Ge,Qe){function hiddenStore(Ne,Ge){var Qe={identity:Ge},tt=Ne.valueOf;return Object.defineProperty(Ne,"valueOf",{value:function(Ne){return Ne!==Ge?tt.apply(this,arguments):Qe},writable:!0}),Qe}Ge.exports=hiddenStore},{}],605:[function(Ne,Ge,Qe){var tt=Ne("./create-store.js");function weakMap(){var Ne=tt();return{get:function(Ge,Qe){var tt=Ne(Ge);return tt.hasOwnProperty("value")?tt.value:Qe},set:function(Ge,Qe){return Ne(Ge).value=Qe,this},has:function(Ge){return"value"in Ne(Ge)},delete:function(Ge){return delete Ne(Ge).value}}}Ge.exports=weakMap},{"./create-store.js":603}],606:[function(Ne,Ge,Qe){var tt=Ne("get-canvas-context");Ge.exports=function(Ne){return tt("webgl",Ne)}},{"get-canvas-context":249}],607:[function(Ne,Ge,Qe){var tt=Ne("../main"),rt=Ne("object-assign"),nt=tt.instance();function ChineseCalendar(Ne){this.local=this.regionalOptions[Ne||""]||this.regionalOptions[""]}ChineseCalendar.prototype=new tt.baseCalendar,rt(ChineseCalendar.prototype,{name:"Chinese",jdEpoch:1721425.5,hasYearZero:!1,minMonth:0,firstMonth:0,minDay:1,regionalOptions:{"":{name:"Chinese",epochs:["BEC","EC"],monthNumbers:function(Ne,Ge){if("string"==typeof Ne){var Qe=Ne.match(it);return Qe?Qe[0]:""}var tt=this._validateYear(Ne),rt=Ne.month(),nt=""+this.toChineseMonth(tt,rt);return Ge&&nt.length<2&&(nt="0"+nt),this.isIntercalaryMonth(tt,rt)&&(nt+="i"),nt},monthNames:function(Ne){if("string"==typeof Ne){var Ge=Ne.match(ot);return Ge?Ge[0]:""}var Qe=this._validateYear(Ne),tt=Ne.month(),rt=["ä¸æ","äºæ","ä¸æ","åæ","äºæ","å­æ","ä¸æ","å«æ","ä¹æ","åæ","åä¸æ","åäºæ"][this.toChineseMonth(Qe,tt)-1];return this.isIntercalaryMonth(Qe,tt)&&(rt="é°"+rt),rt},monthNamesShort:function(Ne){if("string"==typeof Ne){var Ge=Ne.match(dt);return Ge?Ge[0]:""}var Qe=this._validateYear(Ne),tt=Ne.month(),rt=["ä¸","äº","ä¸","å","äº","å­","ä¸","å«","ä¹","å","åä¸","åäº"][this.toChineseMonth(Qe,tt)-1];return this.isIntercalaryMonth(Qe,tt)&&(rt="é°"+rt),rt},parseMonth:function(Ne,Ge){Ne=this._validateYear(Ne);var Qe,tt=parseInt(Ge);if(isNaN(tt))"é°"===Ge[0]&&(Qe=!0,Ge=Ge.substring(1)),"æ"===Ge[Ge.length-1]&&(Ge=Ge.substring(0,Ge.length-1)),tt=1+["ä¸","äº","ä¸","å","äº","å­","ä¸","å«","ä¹","å","åä¸","åäº"].indexOf(Ge);else{var rt=Ge[Ge.length-1];Qe="i"===rt||"I"===rt}return this.toMonthIndex(Ne,tt,Qe)},dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},_validateYear:function(Ne,Ge){if(Ne.year&&(Ne=Ne.year()),"number"!=typeof Ne||Ne<1888||Ne>2111)throw Ge.replace(/\{0\}/,this.local.name);return Ne},toMonthIndex:function(Ne,Ge,Qe){var rt=this.intercalaryMonth(Ne);if(Qe&&Ge!==rt||Ge<1||Ge>12)throw tt.local.invalidMonth.replace(/\{0\}/,this.local.name);return rt?!Qe&&Ge<=rt?Ge-1:Ge:Ge-1},toChineseMonth:function(Ne,Ge){Ne.year&&(Ge=(Ne=Ne.year()).month());var Qe=this.intercalaryMonth(Ne);if(Ge<0||Ge>(Qe?12:11))throw tt.local.invalidMonth.replace(/\{0\}/,this.local.name);return Qe?Ge<Qe?Ge+1:Ge:Ge+1},intercalaryMonth:function(Ne){return Ne=this._validateYear(Ne),ht[Ne-ht[0]]>>13},isIntercalaryMonth:function(Ne,Ge){Ne.year&&(Ge=(Ne=Ne.year()).month());var Qe=this.intercalaryMonth(Ne);return!!Qe&&Qe===Ge},leapYear:function(Ne){return 0!==this.intercalaryMonth(Ne)},weekOfYear:function(Ne,Ge,Qe){var rt,at=this._validateYear(Ne,tt.local.invalidyear),it=Dt[at-Dt[0]],ot=it>>9&4095,dt=it>>5&15,ht=31&it;(rt=nt.newDate(ot,dt,ht)).add(4-(rt.dayOfWeek()||7),"d");var Ot=this.toJD(Ne,Ge,Qe)-rt.toJD();return 1+Math.floor(Ot/7)},monthsInYear:function(Ne){return this.leapYear(Ne)?13:12},daysInMonth:function(Ne,Ge){Ne.year&&(Ge=Ne.month(),Ne=Ne.year()),Ne=this._validateYear(Ne);var Qe=ht[Ne-ht[0]];if(Ge>(Qe>>13?12:11))throw tt.local.invalidMonth.replace(/\{0\}/,this.local.name);return Qe&1<<12-Ge?30:29},weekDay:function(Ne,Ge,Qe){return(this.dayOfWeek(Ne,Ge,Qe)||7)<6},toJD:function(Ne,Ge,Qe){var rt=this._validate(Ne,it,Qe,tt.local.invalidDate);Ne=this._validateYear(rt.year()),Ge=rt.month(),Qe=rt.day();var at=this.isIntercalaryMonth(Ne,Ge),it=this.toChineseMonth(Ne,Ge),ot=toSolar(Ne,it,Qe,at);return nt.toJD(ot.year,ot.month,ot.day)},fromJD:function(Ne){var Ge=nt.fromJD(Ne),Qe=toLunar(Ge.year(),Ge.month(),Ge.day()),tt=this.toMonthIndex(Qe.year,Qe.month,Qe.isIntercalary);return this.newDate(Qe.year,tt,Qe.day)},fromString:function(Ne){var Ge=Ne.match(at),Qe=this._validateYear(+Ge[1]),tt=+Ge[2],rt=!!Ge[3],nt=this.toMonthIndex(Qe,tt,rt),it=+Ge[4];return this.newDate(Qe,nt,it)},add:function(Ne,Ge,Qe){var tt=Ne.year(),rt=Ne.month(),nt=this.isIntercalaryMonth(tt,rt),at=this.toChineseMonth(tt,rt),it=Object.getPrototypeOf(ChineseCalendar.prototype).add.call(this,Ne,Ge,Qe);if("y"===Qe){var ot=it.year(),dt=it.month(),ht=this.isIntercalaryMonth(ot,at),Dt=nt&&ht?this.toMonthIndex(ot,at,!0):this.toMonthIndex(ot,at,!1);Dt!==dt&&it.month(Dt)}return it}});var at=/^\s*(-?\d\d\d\d|\d\d)[-/](\d?\d)([iI]?)[-/](\d?\d)/m,it=/^\d?\d[iI]?/m,ot=/^é°?å?[ä¸äºä¸åäºå­ä¸å«ä¹]?æ/m,dt=/^é°?å?[ä¸äºä¸åäºå­ä¸å«ä¹]?/m;tt.calendars.chinese=ChineseCalendar;var ht=[1887,5780,5802,19157,2742,50359,1198,2646,46378,7466,3412,30122,5482,67949,2396,5294,43597,6732,6954,36181,2772,4954,18781,2396,54427,5274,6730,47781,5800,6868,21210,4790,59703,2350,5270,46667,3402,3496,38325,1388,4782,18735,2350,52374,6804,7498,44457,2906,1388,29294,4700,63789,6442,6804,56138,5802,2772,38235,1210,4698,22827,5418,63125,3476,5802,43701,2484,5302,27223,2646,70954,7466,3412,54698,5482,2412,38062,5294,2636,32038,6954,60245,2772,4826,43357,2394,5274,39501,6730,72357,5800,5844,53978,4790,2358,38039,5270,87627,3402,3496,54708,5484,4782,43311,2350,3222,27978,7498,68965,2904,5484,45677,4700,6444,39573,6804,6986,19285,2772,62811,1210,4698,47403,5418,5780,38570,5546,76469,2420,5302,51799,2646,5414,36501,3412,5546,18869,2412,54446,5276,6732,48422,6822,2900,28010,4826,92509,2394,5274,55883,6730,6820,47956,5812,2778,18779,2358,62615,5270,5450,46757,3492,5556,27318,4718,67887,2350,3222,52554,7498,3428,38252,5468,4700,31022,6444,64149,6804,6986,43861,2772,5338,35421,2650,70955,5418,5780,54954,5546,2740,38074,5302,2646,29991,3366,61011,3412,5546,43445,2412,5294,35406,6732,72998,6820,6996,52586,2778,2396,38045,5274,6698,23333,6820,64338,5812,2746,43355,2358,5270,39499,5450,79525,3492,5548],Dt=[1887,966732,967231,967733,968265,968766,969297,969798,970298,970829,971330,971830,972362,972863,973395,973896,974397,974928,975428,975929,976461,976962,977462,977994,978494,979026,979526,980026,980558,981059,981559,982091,982593,983124,983624,984124,984656,985157,985656,986189,986690,987191,987722,988222,988753,989254,989754,990286,990788,991288,991819,992319,992851,993352,993851,994383,994885,995385,995917,996418,996918,997450,997949,998481,998982,999483,1000014,1000515,1001016,1001548,1002047,1002578,1003080,1003580,1004111,1004613,1005113,1005645,1006146,1006645,1007177,1007678,1008209,1008710,1009211,1009743,1010243,1010743,1011275,1011775,1012306,1012807,1013308,1013840,1014341,1014841,1015373,1015874,1016404,1016905,1017405,1017937,1018438,1018939,1019471,1019972,1020471,1021002,1021503,1022035,1022535,1023036,1023568,1024069,1024568,1025100,1025601,1026102,1026633,1027133,1027666,1028167,1028666,1029198,1029699,1030199,1030730,1031231,1031763,1032264,1032764,1033296,1033797,1034297,1034828,1035329,1035830,1036362,1036861,1037393,1037894,1038394,1038925,1039427,1039927,1040459,1040959,1041491,1041992,1042492,1043023,1043524,1044024,1044556,1045057,1045558,1046090,1046590,1047121,1047622,1048122,1048654,1049154,1049655,1050187,1050689,1051219,1051720,1052220,1052751,1053252,1053752,1054284,1054786,1055285,1055817,1056317,1056849,1057349,1057850,1058382,1058883,1059383,1059915,1060415,1060947,1061447,1061947,1062479,1062981,1063480,1064012,1064514,1065014,1065545,1066045,1066577,1067078,1067578,1068110,1068611,1069112,1069642,1070142,1070674,1071175,1071675,1072207,1072709,1073209,1073740,1074241,1074741,1075273,1075773,1076305,1076807,1077308,1077839,1078340,1078840,1079372,1079871,1080403,1080904];function toLunar(Ne,Ge,Qe,tt){var rt,nt;if("object"==typeof Ne)rt=Ne,nt=Ge||{};else{if(!("number"==typeof Ne&&Ne>=1888&&Ne<=2111))throw new Error("Solar year outside range 1888-2111");if(!("number"==typeof Ge&&Ge>=1&&Ge<=12))throw new Error("Solar month outside range 1 - 12");if(!("number"==typeof Qe&&Qe>=1&&Qe<=31))throw new Error("Solar day outside range 1 - 31");rt={year:Ne,month:Ge,day:Qe},nt=tt||{}}var at=Dt[rt.year-Dt[0]],it=rt.year<<9|rt.month<<5|rt.day;nt.year=it>=at?rt.year:rt.year-1,at=Dt[nt.year-Dt[0]];var ot,dt=new Date(at>>9&4095,(at>>5&15)-1,31&at),Ot=new Date(rt.year,rt.month-1,rt.day);ot=Math.round((Ot-dt)/864e5);var Rt,Zt=ht[nt.year-ht[0]];for(Rt=0;Rt<13;Rt++){var er=Zt&1<<12-Rt?30:29;if(ot<er)break;ot-=er}var dr=Zt>>13;return!dr||Rt<dr?(nt.isIntercalary=!1,nt.month=1+Rt):Rt===dr?(nt.isIntercalary=!0,nt.month=Rt):(nt.isIntercalary=!1,nt.month=Rt),nt.day=1+ot,nt}function toSolar(Ne,Ge,Qe,tt,rt){var nt,at,it;if("object"==typeof Ne)at=Ne,nt=Ge||{};else{var ot;if(!("number"==typeof Ne&&Ne>=1888&&Ne<=2111))throw new Error("Lunar year outside range 1888-2111");if(!("number"==typeof Ge&&Ge>=1&&Ge<=12))throw new Error("Lunar month outside range 1 - 12");if(!("number"==typeof Qe&&Qe>=1&&Qe<=30))throw new Error("Lunar day outside range 1 - 30");"object"==typeof tt?(ot=!1,nt=tt):(ot=!!tt,nt=rt||{}),at={year:Ne,month:Ge,day:Qe,isIntercalary:ot}}it=at.day-1;var dt,Ot=ht[at.year-ht[0]],Rt=Ot>>13;dt=Rt&&(at.month>Rt||at.isIntercalary)?at.month:at.month-1;for(var Zt=0;Zt<dt;Zt++)it+=Ot&1<<12-Zt?30:29;var er=Dt[at.year-Dt[0]],dr=new Date(er>>9&4095,(er>>5&15)-1,(31&er)+it);return nt.year=dr.getFullYear(),nt.month=1+dr.getMonth(),nt.day=dr.getDate(),nt}},{"../main":621,"object-assign":499}],608:[function(Ne,Ge,Qe){var tt=Ne("../main"),rt=Ne("object-assign");function CopticCalendar(Ne){this.local=this.regionalOptions[Ne||""]||this.regionalOptions[""]}CopticCalendar.prototype=new tt.baseCalendar,rt(CopticCalendar.prototype,{name:"Coptic",jdEpoch:1825029.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Coptic",epochs:["BAM","AM"],monthNames:["Thout","Paopi","Hathor","Koiak","Tobi","Meshir","Paremhat","Paremoude","Pashons","Paoni","Epip","Mesori","Pi Kogi Enavot"],monthNamesShort:["Tho","Pao","Hath","Koi","Tob","Mesh","Pat","Pad","Pash","Pao","Epi","Meso","PiK"],dayNames:["Tkyriaka","Pesnau","Pshoment","Peftoou","Ptiou","Psoou","Psabbaton"],dayNamesShort:["Tky","Pes","Psh","Pef","Pti","Pso","Psa"],dayNamesMin:["Tk","Pes","Psh","Pef","Pt","Pso","Psa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(Ne){var Ge=this._validate(Ne,this.minMonth,this.minDay,tt.local.invalidYear);return(Ne=Ge.year()+(Ge.year()<0?1:0))%4==3||Ne%4==-1},monthsInYear:function(Ne){return this._validate(Ne,this.minMonth,this.minDay,tt.local.invalidYear||tt.regionalOptions[""].invalidYear),13},weekOfYear:function(Ne,Ge,Qe){var tt=this.newDate(Ne,Ge,Qe);return tt.add(-tt.dayOfWeek(),"d"),Math.floor((tt.dayOfYear()-1)/7)+1},daysInMonth:function(Ne,Ge){var Qe=this._validate(Ne,Ge,this.minDay,tt.local.invalidMonth);return this.daysPerMonth[Qe.month()-1]+(13===Qe.month()&&this.leapYear(Qe.year())?1:0)},weekDay:function(Ne,Ge,Qe){return(this.dayOfWeek(Ne,Ge,Qe)||7)<6},toJD:function(Ne,Ge,Qe){var rt=this._validate(Ne,Ge,Qe,tt.local.invalidDate);return(Ne=rt.year())<0&&Ne++,rt.day()+30*(rt.month()-1)+365*(Ne-1)+Math.floor(Ne/4)+this.jdEpoch-1},fromJD:function(Ne){var Ge=Math.floor(Ne)+.5-this.jdEpoch,Qe=Math.floor((Ge-Math.floor((Ge+366)/1461))/365)+1;Qe<=0&&Qe--,Ge=Math.floor(Ne)+.5-this.newDate(Qe,1,1).toJD();var tt=Math.floor(Ge/30)+1,rt=Ge-30*(tt-1)+1;return this.newDate(Qe,tt,rt)}}),tt.calendars.coptic=CopticCalendar},{"../main":621,"object-assign":499}],609:[function(Ne,Ge,Qe){var tt=Ne("../main"),rt=Ne("object-assign");function DiscworldCalendar(Ne){this.local=this.regionalOptions[Ne||""]||this.regionalOptions[""]}DiscworldCalendar.prototype=new tt.baseCalendar,rt(DiscworldCalendar.prototype,{name:"Discworld",jdEpoch:1721425.5,daysPerMonth:[16,32,32,32,32,32,32,32,32,32,32,32,32],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Discworld",epochs:["BUC","UC"],monthNames:["Ick","Offle","February","March","April","May","June","Grune","August","Spune","Sektober","Ember","December"],monthNamesShort:["Ick","Off","Feb","Mar","Apr","May","Jun","Gru","Aug","Spu","Sek","Emb","Dec"],dayNames:["Sunday","Octeday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Oct","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Oc","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:2,isRTL:!1}},leapYear:function(Ne){return this._validate(Ne,this.minMonth,this.minDay,tt.local.invalidYear),!1},monthsInYear:function(Ne){return this._validate(Ne,this.minMonth,this.minDay,tt.local.invalidYear),13},daysInYear:function(Ne){return this._validate(Ne,this.minMonth,this.minDay,tt.local.invalidYear),400},weekOfYear:function(Ne,Ge,Qe){var tt=this.newDate(Ne,Ge,Qe);return tt.add(-tt.dayOfWeek(),"d"),Math.floor((tt.dayOfYear()-1)/8)+1},daysInMonth:function(Ne,Ge){var Qe=this._validate(Ne,Ge,this.minDay,tt.local.invalidMonth);return this.daysPerMonth[Qe.month()-1]},daysInWeek:function(){return 8},dayOfWeek:function(Ne,Ge,Qe){return(this._validate(Ne,Ge,Qe,tt.local.invalidDate).day()+1)%8},weekDay:function(Ne,Ge,Qe){var tt=this.dayOfWeek(Ne,Ge,Qe);return tt>=2&&tt<=6},extraInfo:function(Ne,Ge,Qe){var rt=this._validate(Ne,Ge,Qe,tt.local.invalidDate);return{century:nt[Math.floor((rt.year()-1)/100)+1]||""}},toJD:function(Ne,Ge,Qe){var rt=this._validate(Ne,Ge,Qe,tt.local.invalidDate);return Ne=rt.year()+(rt.year()<0?1:0),Ge=rt.month(),(Qe=rt.day())+(Ge>1?16:0)+(Ge>2?32*(Ge-2):0)+400*(Ne-1)+this.jdEpoch-1},fromJD:function(Ne){Ne=Math.floor(Ne+.5)-Math.floor(this.jdEpoch)-1;var Ge=Math.floor(Ne/400)+1;Ne-=400*(Ge-1),Ne+=Ne>15?16:0;var Qe=Math.floor(Ne/32)+1,tt=Ne-32*(Qe-1)+1;return this.newDate(Ge<=0?Ge-1:Ge,Qe,tt)}});var nt={20:"Fruitbat",21:"Anchovy"};tt.calendars.discworld=DiscworldCalendar},{"../main":621,"object-assign":499}],610:[function(Ne,Ge,Qe){var tt=Ne("../main"),rt=Ne("object-assign");function EthiopianCalendar(Ne){this.local=this.regionalOptions[Ne||""]||this.regionalOptions[""]}EthiopianCalendar.prototype=new tt.baseCalendar,rt(EthiopianCalendar.prototype,{name:"Ethiopian",jdEpoch:1724220.5,daysPerMonth:[30,30,30,30,30,30,30,30,30,30,30,30,5],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Ethiopian",epochs:["BEE","EE"],monthNames:["Meskerem","Tikemet","Hidar","Tahesas","Tir","Yekatit","Megabit","Miazia","Genbot","Sene","Hamle","Nehase","Pagume"],monthNamesShort:["Mes","Tik","Hid","Tah","Tir","Yek","Meg","Mia","Gen","Sen","Ham","Neh","Pag"],dayNames:["Ehud","Segno","Maksegno","Irob","Hamus","Arb","Kidame"],dayNamesShort:["Ehu","Seg","Mak","Iro","Ham","Arb","Kid"],dayNamesMin:["Eh","Se","Ma","Ir","Ha","Ar","Ki"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(Ne){var Ge=this._validate(Ne,this.minMonth,this.minDay,tt.local.invalidYear);return(Ne=Ge.year()+(Ge.year()<0?1:0))%4==3||Ne%4==-1},monthsInYear:function(Ne){return this._validate(Ne,this.minMonth,this.minDay,tt.local.invalidYear||tt.regionalOptions[""].invalidYear),13},weekOfYear:function(Ne,Ge,Qe){var tt=this.newDate(Ne,Ge,Qe);return tt.add(-tt.dayOfWeek(),"d"),Math.floor((tt.dayOfYear()-1)/7)+1},daysInMonth:function(Ne,Ge){var Qe=this._validate(Ne,Ge,this.minDay,tt.local.invalidMonth);return this.daysPerMonth[Qe.month()-1]+(13===Qe.month()&&this.leapYear(Qe.year())?1:0)},weekDay:function(Ne,Ge,Qe){return(this.dayOfWeek(Ne,Ge,Qe)||7)<6},toJD:function(Ne,Ge,Qe){var rt=this._validate(Ne,Ge,Qe,tt.local.invalidDate);return(Ne=rt.year())<0&&Ne++,rt.day()+30*(rt.month()-1)+365*(Ne-1)+Math.floor(Ne/4)+this.jdEpoch-1},fromJD:function(Ne){var Ge=Math.floor(Ne)+.5-this.jdEpoch,Qe=Math.floor((Ge-Math.floor((Ge+366)/1461))/365)+1;Qe<=0&&Qe--,Ge=Math.floor(Ne)+.5-this.newDate(Qe,1,1).toJD();var tt=Math.floor(Ge/30)+1,rt=Ge-30*(tt-1)+1;return this.newDate(Qe,tt,rt)}}),tt.calendars.ethiopian=EthiopianCalendar},{"../main":621,"object-assign":499}],611:[function(Ne,Ge,Qe){var tt=Ne("../main"),rt=Ne("object-assign");function HebrewCalendar(Ne){this.local=this.regionalOptions[Ne||""]||this.regionalOptions[""]}function mod(Ne,Ge){return Ne-Ge*Math.floor(Ne/Ge)}HebrewCalendar.prototype=new tt.baseCalendar,rt(HebrewCalendar.prototype,{name:"Hebrew",jdEpoch:347995.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29,29],hasYearZero:!1,minMonth:1,firstMonth:7,minDay:1,regionalOptions:{"":{name:"Hebrew",epochs:["BAM","AM"],monthNames:["Nisan","Iyar","Sivan","Tammuz","Av","Elul","Tishrei","Cheshvan","Kislev","Tevet","Shevat","Adar","Adar II"],monthNamesShort:["Nis","Iya","Siv","Tam","Av","Elu","Tis","Che","Kis","Tev","She","Ada","Ad2"],dayNames:["Yom Rishon","Yom Sheni","Yom Shlishi","Yom Revi'i","Yom Chamishi","Yom Shishi","Yom Shabbat"],dayNamesShort:["Ris","She","Shl","Rev","Cha","Shi","Sha"],dayNamesMin:["Ri","She","Shl","Re","Ch","Shi","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(Ne){var Ge=this._validate(Ne,this.minMonth,this.minDay,tt.local.invalidYear);return this._leapYear(Ge.year())},_leapYear:function(Ne){return mod(7*(Ne=Ne<0?Ne+1:Ne)+1,19)<7},monthsInYear:function(Ne){return this._validate(Ne,this.minMonth,this.minDay,tt.local.invalidYear),this._leapYear(Ne.year?Ne.year():Ne)?13:12},weekOfYear:function(Ne,Ge,Qe){var tt=this.newDate(Ne,Ge,Qe);return tt.add(-tt.dayOfWeek(),"d"),Math.floor((tt.dayOfYear()-1)/7)+1},daysInYear:function(Ne){return Ne=this._validate(Ne,this.minMonth,this.minDay,tt.local.invalidYear).year(),this.toJD(-1===Ne?1:Ne+1,7,1)-this.toJD(Ne,7,1)},daysInMonth:function(Ne,Ge){return Ne.year&&(Ge=Ne.month(),Ne=Ne.year()),this._validate(Ne,Ge,this.minDay,tt.local.invalidMonth),12===Ge&&this.leapYear(Ne)||8===Ge&&5===mod(this.daysInYear(Ne),10)?30:9===Ge&&3===mod(this.daysInYear(Ne),10)?29:this.daysPerMonth[Ge-1]},weekDay:function(Ne,Ge,Qe){return 6!==this.dayOfWeek(Ne,Ge,Qe)},extraInfo:function(Ne,Ge,Qe){var rt=this._validate(Ne,Ge,Qe,tt.local.invalidDate);return{yearType:(this.leapYear(rt)?"embolismic":"common")+" "+["deficient","regular","complete"][this.daysInYear(rt)%10-3]}},toJD:function(Ne,Ge,Qe){var rt=this._validate(Ne,Ge,Qe,tt.local.invalidDate);Ne=rt.year(),Ge=rt.month(),Qe=rt.day();var nt=Ne<=0?Ne+1:Ne,at=this.jdEpoch+this._delay1(nt)+this._delay2(nt)+Qe+1;if(Ge<7){for(var it=7;it<=this.monthsInYear(Ne);it++)at+=this.daysInMonth(Ne,it);for(it=1;it<Ge;it++)at+=this.daysInMonth(Ne,it)}else for(it=7;it<Ge;it++)at+=this.daysInMonth(Ne,it);return at},_delay1:function(Ne){var Ge=Math.floor((235*Ne-234)/19),Qe=12084+13753*Ge,tt=29*Ge+Math.floor(Qe/25920);return mod(3*(tt+1),7)<3&&tt++,tt},_delay2:function(Ne){var Ge=this._delay1(Ne-1),Qe=this._delay1(Ne);return this._delay1(Ne+1)-Qe==356?2:Qe-Ge==382?1:0},fromJD:function(Ne){Ne=Math.floor(Ne)+.5;for(var Ge=Math.floor(98496*(Ne-this.jdEpoch)/35975351)-1;Ne>=this.toJD(-1===Ge?1:Ge+1,7,1);)Ge++;for(var Qe=Ne<this.toJD(Ge,1,1)?7:1;Ne>this.toJD(Ge,Qe,this.daysInMonth(Ge,Qe));)Qe++;var tt=Ne-this.toJD(Ge,Qe,1)+1;return this.newDate(Ge,Qe,tt)}}),tt.calendars.hebrew=HebrewCalendar},{"../main":621,"object-assign":499}],612:[function(Ne,Ge,Qe){var tt=Ne("../main"),rt=Ne("object-assign");function IslamicCalendar(Ne){this.local=this.regionalOptions[Ne||""]||this.regionalOptions[""]}IslamicCalendar.prototype=new tt.baseCalendar,rt(IslamicCalendar.prototype,{name:"Islamic",jdEpoch:1948439.5,daysPerMonth:[30,29,30,29,30,29,30,29,30,29,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Islamic",epochs:["BH","AH"],monthNames:["Muharram","Safar","Rabi' al-awwal","Rabi' al-thani","Jumada al-awwal","Jumada al-thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-ahad","Yawm al-ithnayn","Yawm ath-thulaathaa'","Yawm al-arbi'aa'","Yawm al-khamÄ«s","Yawm al-jum'a","Yawm as-sabt"],dayNamesShort:["Aha","Ith","Thu","Arb","Kha","Jum","Sab"],dayNamesMin:["Ah","It","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(Ne){return(11*this._validate(Ne,this.minMonth,this.minDay,tt.local.invalidYear).year()+14)%30<11},weekOfYear:function(Ne,Ge,Qe){var tt=this.newDate(Ne,Ge,Qe);return tt.add(-tt.dayOfWeek(),"d"),Math.floor((tt.dayOfYear()-1)/7)+1},daysInYear:function(Ne){return this.leapYear(Ne)?355:354},daysInMonth:function(Ne,Ge){var Qe=this._validate(Ne,Ge,this.minDay,tt.local.invalidMonth);return this.daysPerMonth[Qe.month()-1]+(12===Qe.month()&&this.leapYear(Qe.year())?1:0)},weekDay:function(Ne,Ge,Qe){return 5!==this.dayOfWeek(Ne,Ge,Qe)},toJD:function(Ne,Ge,Qe){var rt=this._validate(Ne,Ge,Qe,tt.local.invalidDate);return Ne=rt.year(),Ge=rt.month(),Ne=Ne<=0?Ne+1:Ne,(Qe=rt.day())+Math.ceil(29.5*(Ge-1))+354*(Ne-1)+Math.floor((3+11*Ne)/30)+this.jdEpoch-1},fromJD:function(Ne){Ne=Math.floor(Ne)+.5;var Ge=Math.floor((30*(Ne-this.jdEpoch)+10646)/10631);Ge=Ge<=0?Ge-1:Ge;var Qe=Math.min(12,Math.ceil((Ne-29-this.toJD(Ge,1,1))/29.5)+1),tt=Ne-this.toJD(Ge,Qe,1)+1;return this.newDate(Ge,Qe,tt)}}),tt.calendars.islamic=IslamicCalendar},{"../main":621,"object-assign":499}],613:[function(Ne,Ge,Qe){var tt=Ne("../main"),rt=Ne("object-assign");function JulianCalendar(Ne){this.local=this.regionalOptions[Ne||""]||this.regionalOptions[""]}JulianCalendar.prototype=new tt.baseCalendar,rt(JulianCalendar.prototype,{name:"Julian",jdEpoch:1721423.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Julian",epochs:["BC","AD"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(Ne){var Ge=this._validate(Ne,this.minMonth,this.minDay,tt.local.invalidYear);return(Ne=Ge.year()<0?Ge.year()+1:Ge.year())%4==0},weekOfYear:function(Ne,Ge,Qe){var tt=this.newDate(Ne,Ge,Qe);return tt.add(4-(tt.dayOfWeek()||7),"d"),Math.floor((tt.dayOfYear()-1)/7)+1},daysInMonth:function(Ne,Ge){var Qe=this._validate(Ne,Ge,this.minDay,tt.local.invalidMonth);return this.daysPerMonth[Qe.month()-1]+(2===Qe.month()&&this.leapYear(Qe.year())?1:0)},weekDay:function(Ne,Ge,Qe){return(this.dayOfWeek(Ne,Ge,Qe)||7)<6},toJD:function(Ne,Ge,Qe){var rt=this._validate(Ne,Ge,Qe,tt.local.invalidDate);return Ne=rt.year(),Ge=rt.month(),Qe=rt.day(),Ne<0&&Ne++,Ge<=2&&(Ne--,Ge+=12),Math.floor(365.25*(Ne+4716))+Math.floor(30.6001*(Ge+1))+Qe-1524.5},fromJD:function(Ne){var Ge=Math.floor(Ne+.5)+1524,Qe=Math.floor((Ge-122.1)/365.25),tt=Math.floor(365.25*Qe),rt=Math.floor((Ge-tt)/30.6001),nt=rt-Math.floor(rt<14?1:13),at=Qe-Math.floor(nt>2?4716:4715),it=Ge-tt-Math.floor(30.6001*rt);return at<=0&&at--,this.newDate(at,nt,it)}}),tt.calendars.julian=JulianCalendar},{"../main":621,"object-assign":499}],614:[function(Ne,Ge,Qe){var tt=Ne("../main"),rt=Ne("object-assign");function MayanCalendar(Ne){this.local=this.regionalOptions[Ne||""]||this.regionalOptions[""]}function mod(Ne,Ge){return Ne-Ge*Math.floor(Ne/Ge)}function amod(Ne,Ge){return mod(Ne-1,Ge)+1}MayanCalendar.prototype=new tt.baseCalendar,rt(MayanCalendar.prototype,{name:"Mayan",jdEpoch:584282.5,hasYearZero:!0,minMonth:0,firstMonth:0,minDay:0,regionalOptions:{"":{name:"Mayan",epochs:["",""],monthNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],monthNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17"],dayNames:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesShort:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],dayNamesMin:["0","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19"],digits:null,dateFormat:"YYYY.m.d",firstDay:0,isRTL:!1,haabMonths:["Pop","Uo","Zip","Zotz","Tzec","Xul","Yaxkin","Mol","Chen","Yax","Zac","Ceh","Mac","Kankin","Muan","Pax","Kayab","Cumku","Uayeb"],tzolkinMonths:["Imix","Ik","Akbal","Kan","Chicchan","Cimi","Manik","Lamat","Muluc","Oc","Chuen","Eb","Ben","Ix","Men","Cib","Caban","Etznab","Cauac","Ahau"]}},leapYear:function(Ne){return this._validate(Ne,this.minMonth,this.minDay,tt.local.invalidYear),!1},formatYear:function(Ne){Ne=this._validate(Ne,this.minMonth,this.minDay,tt.local.invalidYear).year();var Ge=Math.floor(Ne/400);return Ne%=400,Ne+=Ne<0?400:0,Ge+"."+Math.floor(Ne/20)+"."+Ne%20},forYear:function(Ne){if((Ne=Ne.split(".")).length<3)throw"Invalid Mayan year";for(var Ge=0,Qe=0;Qe<Ne.length;Qe++){var tt=parseInt(Ne[Qe],10);if(Math.abs(tt)>19||Qe>0&&tt<0)throw"Invalid Mayan year";Ge=20*Ge+tt}return Ge},monthsInYear:function(Ne){return this._validate(Ne,this.minMonth,this.minDay,tt.local.invalidYear),18},weekOfYear:function(Ne,Ge,Qe){return this._validate(Ne,Ge,Qe,tt.local.invalidDate),0},daysInYear:function(Ne){return this._validate(Ne,this.minMonth,this.minDay,tt.local.invalidYear),360},daysInMonth:function(Ne,Ge){return this._validate(Ne,Ge,this.minDay,tt.local.invalidMonth),20},daysInWeek:function(){return 5},dayOfWeek:function(Ne,Ge,Qe){return this._validate(Ne,Ge,Qe,tt.local.invalidDate).day()},weekDay:function(Ne,Ge,Qe){return this._validate(Ne,Ge,Qe,tt.local.invalidDate),!0},extraInfo:function(Ne,Ge,Qe){var rt=this._validate(Ne,Ge,Qe,tt.local.invalidDate).toJD(),nt=this._toHaab(rt),at=this._toTzolkin(rt);return{haabMonthName:this.local.haabMonths[nt[0]-1],haabMonth:nt[0],haabDay:nt[1],tzolkinDayName:this.local.tzolkinMonths[at[0]-1],tzolkinDay:at[0],tzolkinTrecena:at[1]}},_toHaab:function(Ne){var Ge=mod(8+(Ne-=this.jdEpoch)+340,365);return[Math.floor(Ge/20)+1,mod(Ge,20)]},_toTzolkin:function(Ne){return[amod(20+(Ne-=this.jdEpoch),20),amod(Ne+4,13)]},toJD:function(Ne,Ge,Qe){var rt=this._validate(Ne,Ge,Qe,tt.local.invalidDate);return rt.day()+20*rt.month()+360*rt.year()+this.jdEpoch},fromJD:function(Ne){Ne=Math.floor(Ne)+.5-this.jdEpoch;var Ge=Math.floor(Ne/360);Ne%=360,Ne+=Ne<0?360:0;var Qe=Math.floor(Ne/20),tt=Ne%20;return this.newDate(Ge,Qe,tt)}}),tt.calendars.mayan=MayanCalendar},{"../main":621,"object-assign":499}],615:[function(Ne,Ge,Qe){var tt=Ne("../main"),rt=Ne("object-assign");function NanakshahiCalendar(Ne){this.local=this.regionalOptions[Ne||""]||this.regionalOptions[""]}NanakshahiCalendar.prototype=new tt.baseCalendar;var nt=tt.instance("gregorian");rt(NanakshahiCalendar.prototype,{name:"Nanakshahi",jdEpoch:2257673.5,daysPerMonth:[31,31,31,31,31,30,30,30,30,30,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Nanakshahi",epochs:["BN","AN"],monthNames:["Chet","Vaisakh","Jeth","Harh","Sawan","Bhadon","Assu","Katak","Maghar","Poh","Magh","Phagun"],monthNamesShort:["Che","Vai","Jet","Har","Saw","Bha","Ass","Kat","Mgr","Poh","Mgh","Pha"],dayNames:["Somvaar","Mangalvar","Budhvaar","Veervaar","Shukarvaar","Sanicharvaar","Etvaar"],dayNamesShort:["Som","Mangal","Budh","Veer","Shukar","Sanichar","Et"],dayNamesMin:["So","Ma","Bu","Ve","Sh","Sa","Et"],digits:null,dateFormat:"dd-mm-yyyy",firstDay:0,isRTL:!1}},leapYear:function(Ne){var Ge=this._validate(Ne,this.minMonth,this.minDay,tt.local.invalidYear||tt.regionalOptions[""].invalidYear);return nt.leapYear(Ge.year()+(Ge.year()<1?1:0)+1469)},weekOfYear:function(Ne,Ge,Qe){var tt=this.newDate(Ne,Ge,Qe);return tt.add(1-(tt.dayOfWeek()||7),"d"),Math.floor((tt.dayOfYear()-1)/7)+1},daysInMonth:function(Ne,Ge){var Qe=this._validate(Ne,Ge,this.minDay,tt.local.invalidMonth);return this.daysPerMonth[Qe.month()-1]+(12===Qe.month()&&this.leapYear(Qe.year())?1:0)},weekDay:function(Ne,Ge,Qe){return(this.dayOfWeek(Ne,Ge,Qe)||7)<6},toJD:function(Ne,Ge,Qe){var rt=this._validate(Ne,Ge,Qe,tt.local.invalidMonth);(Ne=rt.year())<0&&Ne++;for(var at=rt.day(),it=1;it<rt.month();it++)at+=this.daysPerMonth[it-1];return at+nt.toJD(Ne+1468,3,13)},fromJD:function(Ne){Ne=Math.floor(Ne+.5);for(var Ge=Math.floor((Ne-(this.jdEpoch-1))/366);Ne>=this.toJD(Ge+1,1,1);)Ge++;for(var Qe=Ne-Math.floor(this.toJD(Ge,1,1)+.5)+1,tt=1;Qe>this.daysInMonth(Ge,tt);)Qe-=this.daysInMonth(Ge,tt),tt++;return this.newDate(Ge,tt,Qe)}}),tt.calendars.nanakshahi=NanakshahiCalendar},{"../main":621,"object-assign":499}],616:[function(Ne,Ge,Qe){var tt=Ne("../main"),rt=Ne("object-assign");function NepaliCalendar(Ne){this.local=this.regionalOptions[Ne||""]||this.regionalOptions[""]}NepaliCalendar.prototype=new tt.baseCalendar,rt(NepaliCalendar.prototype,{name:"Nepali",jdEpoch:1700709.5,daysPerMonth:[31,31,32,32,31,30,30,29,30,29,30,30],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,daysPerYear:365,regionalOptions:{"":{name:"Nepali",epochs:["BBS","ABS"],monthNames:["Baisakh","Jestha","Ashadh","Shrawan","Bhadra","Ashwin","Kartik","Mangsir","Paush","Mangh","Falgun","Chaitra"],monthNamesShort:["Bai","Je","As","Shra","Bha","Ash","Kar","Mang","Pau","Ma","Fal","Chai"],dayNames:["Aaitabaar","Sombaar","Manglbaar","Budhabaar","Bihibaar","Shukrabaar","Shanibaar"],dayNamesShort:["Aaita","Som","Mangl","Budha","Bihi","Shukra","Shani"],dayNamesMin:["Aai","So","Man","Bu","Bi","Shu","Sha"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:1,isRTL:!1}},leapYear:function(Ne){return this.daysInYear(Ne)!==this.daysPerYear},weekOfYear:function(Ne,Ge,Qe){var tt=this.newDate(Ne,Ge,Qe);return tt.add(-tt.dayOfWeek(),"d"),Math.floor((tt.dayOfYear()-1)/7)+1},daysInYear:function(Ne){if(Ne=this._validate(Ne,this.minMonth,this.minDay,tt.local.invalidYear).year(),void 0===this.NEPALI_CALENDAR_DATA[Ne])return this.daysPerYear;for(var Ge=0,Qe=this.minMonth;Qe<=12;Qe++)Ge+=this.NEPALI_CALENDAR_DATA[Ne][Qe];return Ge},daysInMonth:function(Ne,Ge){return Ne.year&&(Ge=Ne.month(),Ne=Ne.year()),this._validate(Ne,Ge,this.minDay,tt.local.invalidMonth),void 0===this.NEPALI_CALENDAR_DATA[Ne]?this.daysPerMonth[Ge-1]:this.NEPALI_CALENDAR_DATA[Ne][Ge]},weekDay:function(Ne,Ge,Qe){return 6!==this.dayOfWeek(Ne,Ge,Qe)},toJD:function(Ne,Ge,Qe){var rt=this._validate(Ne,Ge,Qe,tt.local.invalidDate);Ne=rt.year(),Ge=rt.month(),Qe=rt.day();var nt=tt.instance(),at=0,it=Ge,ot=Ne;this._createMissingCalendarData(Ne);var dt=Ne-(it>9||9===it&&Qe>=this.NEPALI_CALENDAR_DATA[ot][0]?56:57);for(9!==Ge&&(at=Qe,it--);9!==it;)it<=0&&(it=12,ot--),at+=this.NEPALI_CALENDAR_DATA[ot][it],it--;return 9===Ge?(at+=Qe-this.NEPALI_CALENDAR_DATA[ot][0])<0&&(at+=nt.daysInYear(dt)):at+=this.NEPALI_CALENDAR_DATA[ot][9]-this.NEPALI_CALENDAR_DATA[ot][0],nt.newDate(dt,1,1).add(at,"d").toJD()},fromJD:function(Ne){var Ge=tt.instance().fromJD(Ne),Qe=Ge.year(),rt=Ge.dayOfYear(),nt=Qe+56;this._createMissingCalendarData(nt);for(var at=9,it=this.NEPALI_CALENDAR_DATA[nt][0],ot=this.NEPALI_CALENDAR_DATA[nt][at]-it+1;rt>ot;)++at>12&&(at=1,nt++),ot+=this.NEPALI_CALENDAR_DATA[nt][at];var dt=this.NEPALI_CALENDAR_DATA[nt][at]-(ot-rt);return this.newDate(nt,at,dt)},_createMissingCalendarData:function(Ne){var Ge=this.daysPerMonth.slice(0);Ge.unshift(17);for(var Qe=Ne-1;Qe<Ne+2;Qe++)void 0===this.NEPALI_CALENDAR_DATA[Qe]&&(this.NEPALI_CALENDAR_DATA[Qe]=Ge)},NEPALI_CALENDAR_DATA:{1970:[18,31,31,32,31,31,31,30,29,30,29,30,30],1971:[18,31,31,32,31,32,30,30,29,30,29,30,30],1972:[17,31,32,31,32,31,30,30,30,29,29,30,30],1973:[19,30,32,31,32,31,30,30,30,29,30,29,31],1974:[19,31,31,32,30,31,31,30,29,30,29,30,30],1975:[18,31,31,32,32,30,31,30,29,30,29,30,30],1976:[17,31,32,31,32,31,30,30,30,29,29,30,31],1977:[18,31,32,31,32,31,31,29,30,29,30,29,31],1978:[18,31,31,32,31,31,31,30,29,30,29,30,30],1979:[18,31,31,32,32,31,30,30,29,30,29,30,30],1980:[17,31,32,31,32,31,30,30,30,29,29,30,31],1981:[18,31,31,31,32,31,31,29,30,30,29,30,30],1982:[18,31,31,32,31,31,31,30,29,30,29,30,30],1983:[18,31,31,32,32,31,30,30,29,30,29,30,30],1984:[17,31,32,31,32,31,30,30,30,29,29,30,31],1985:[18,31,31,31,32,31,31,29,30,30,29,30,30],1986:[18,31,31,32,31,31,31,30,29,30,29,30,30],1987:[18,31,32,31,32,31,30,30,29,30,29,30,30],1988:[17,31,32,31,32,31,30,30,30,29,29,30,31],1989:[18,31,31,31,32,31,31,30,29,30,29,30,30],1990:[18,31,31,32,31,31,31,30,29,30,29,30,30],1991:[18,31,32,31,32,31,30,30,29,30,29,30,30],1992:[17,31,32,31,32,31,30,30,30,29,30,29,31],1993:[18,31,31,31,32,31,31,30,29,30,29,30,30],1994:[18,31,31,32,31,31,31,30,29,30,29,30,30],1995:[17,31,32,31,32,31,30,30,30,29,29,30,30],1996:[17,31,32,31,32,31,30,30,30,29,30,29,31],1997:[18,31,31,32,31,31,31,30,29,30,29,30,30],1998:[18,31,31,32,31,31,31,30,29,30,29,30,30],1999:[17,31,32,31,32,31,30,30,30,29,29,30,31],2e3:[17,30,32,31,32,31,30,30,30,29,30,29,31],2001:[18,31,31,32,31,31,31,30,29,30,29,30,30],2002:[18,31,31,32,32,31,30,30,29,30,29,30,30],2003:[17,31,32,31,32,31,30,30,30,29,29,30,31],2004:[17,30,32,31,32,31,30,30,30,29,30,29,31],2005:[18,31,31,32,31,31,31,30,29,30,29,30,30],2006:[18,31,31,32,32,31,30,30,29,30,29,30,30],2007:[17,31,32,31,32,31,30,30,30,29,29,30,31],2008:[17,31,31,31,32,31,31,29,30,30,29,29,31],2009:[18,31,31,32,31,31,31,30,29,30,29,30,30],2010:[18,31,31,32,32,31,30,30,29,30,29,30,30],2011:[17,31,32,31,32,31,30,30,30,29,29,30,31],2012:[17,31,31,31,32,31,31,29,30,30,29,30,30],2013:[18,31,31,32,31,31,31,30,29,30,29,30,30],2014:[18,31,31,32,32,31,30,30,29,30,29,30,30],2015:[17,31,32,31,32,31,30,30,30,29,29,30,31],2016:[17,31,31,31,32,31,31,29,30,30,29,30,30],2017:[18,31,31,32,31,31,31,30,29,30,29,30,30],2018:[18,31,32,31,32,31,30,30,29,30,29,30,30],2019:[17,31,32,31,32,31,30,30,30,29,30,29,31],2020:[17,31,31,31,32,31,31,30,29,30,29,30,30],2021:[18,31,31,32,31,31,31,30,29,30,29,30,30],2022:[17,31,32,31,32,31,30,30,30,29,29,30,30],2023:[17,31,32,31,32,31,30,30,30,29,30,29,31],2024:[17,31,31,31,32,31,31,30,29,30,29,30,30],2025:[18,31,31,32,31,31,31,30,29,30,29,30,30],2026:[17,31,32,31,32,31,30,30,30,29,29,30,31],2027:[17,30,32,31,32,31,30,30,30,29,30,29,31],2028:[17,31,31,32,31,31,31,30,29,30,29,30,30],2029:[18,31,31,32,31,32,30,30,29,30,29,30,30],2030:[17,31,32,31,32,31,30,30,30,30,30,30,31],2031:[17,31,32,31,32,31,31,31,31,31,31,31,31],2032:[17,32,32,32,32,32,32,32,32,32,32,32,32],2033:[18,31,31,32,32,31,30,30,29,30,29,30,30],2034:[17,31,32,31,32,31,30,30,30,29,29,30,31],2035:[17,30,32,31,32,31,31,29,30,30,29,29,31],2036:[17,31,31,32,31,31,31,30,29,30,29,30,30],2037:[18,31,31,32,32,31,30,30,29,30,29,30,30],2038:[17,31,32,31,32,31,30,30,30,29,29,30,31],2039:[17,31,31,31,32,31,31,29,30,30,29,30,30],2040:[17,31,31,32,31,31,31,30,29,30,29,30,30],2041:[18,31,31,32,32,31,30,30,29,30,29,30,30],2042:[17,31,32,31,32,31,30,30,30,29,29,30,31],2043:[17,31,31,31,32,31,31,29,30,30,29,30,30],2044:[17,31,31,32,31,31,31,30,29,30,29,30,30],2045:[18,31,32,31,32,31,30,30,29,30,29,30,30],2046:[17,31,32,31,32,31,30,30,30,29,29,30,31],2047:[17,31,31,31,32,31,31,30,29,30,29,30,30],2048:[17,31,31,32,31,31,31,30,29,30,29,30,30],2049:[17,31,32,31,32,31,30,30,30,29,29,30,30],2050:[17,31,32,31,32,31,30,30,30,29,30,29,31],2051:[17,31,31,31,32,31,31,30,29,30,29,30,30],2052:[17,31,31,32,31,31,31,30,29,30,29,30,30],2053:[17,31,32,31,32,31,30,30,30,29,29,30,30],2054:[17,31,32,31,32,31,30,30,30,29,30,29,31],2055:[17,31,31,32,31,31,31,30,29,30,30,29,30],2056:[17,31,31,32,31,32,30,30,29,30,29,30,30],2057:[17,31,32,31,32,31,30,30,30,29,29,30,31],2058:[17,30,32,31,32,31,30,30,30,29,30,29,31],2059:[17,31,31,32,31,31,31,30,29,30,29,30,30],2060:[17,31,31,32,32,31,30,30,29,30,29,30,30],2061:[17,31,32,31,32,31,30,30,30,29,29,30,31],2062:[17,30,32,31,32,31,31,29,30,29,30,29,31],2063:[17,31,31,32,31,31,31,30,29,30,29,30,30],2064:[17,31,31,32,32,31,30,30,29,30,29,30,30],2065:[17,31,32,31,32,31,30,30,30,29,29,30,31],2066:[17,31,31,31,32,31,31,29,30,30,29,29,31],2067:[17,31,31,32,31,31,31,30,29,30,29,30,30],2068:[17,31,31,32,32,31,30,30,29,30,29,30,30],2069:[17,31,32,31,32,31,30,30,30,29,29,30,31],2070:[17,31,31,31,32,31,31,29,30,30,29,30,30],2071:[17,31,31,32,31,31,31,30,29,30,29,30,30],2072:[17,31,32,31,32,31,30,30,29,30,29,30,30],2073:[17,31,32,31,32,31,30,30,30,29,29,30,31],2074:[17,31,31,31,32,31,31,30,29,30,29,30,30],2075:[17,31,31,32,31,31,31,30,29,30,29,30,30],2076:[16,31,32,31,32,31,30,30,30,29,29,30,30],2077:[17,31,32,31,32,31,30,30,30,29,30,29,31],2078:[17,31,31,31,32,31,31,30,29,30,29,30,30],2079:[17,31,31,32,31,31,31,30,29,30,29,30,30],2080:[16,31,32,31,32,31,30,30,30,29,29,30,30],2081:[17,31,31,32,32,31,30,30,30,29,30,30,30],2082:[17,31,32,31,32,31,30,30,30,29,30,30,30],2083:[17,31,31,32,31,31,30,30,30,29,30,30,30],2084:[17,31,31,32,31,31,30,30,30,29,30,30,30],2085:[17,31,32,31,32,31,31,30,30,29,30,30,30],2086:[17,31,32,31,32,31,30,30,30,29,30,30,30],2087:[16,31,31,32,31,31,31,30,30,29,30,30,30],2088:[16,30,31,32,32,30,31,30,30,29,30,30,30],2089:[17,31,32,31,32,31,30,30,30,29,30,30,30],2090:[17,31,32,31,32,31,30,30,30,29,30,30,30],2091:[16,31,31,32,31,31,31,30,30,29,30,30,30],2092:[16,31,31,32,32,31,30,30,30,29,30,30,30],2093:[17,31,32,31,32,31,30,30,30,29,30,30,30],2094:[17,31,31,32,31,31,30,30,30,29,30,30,30],2095:[17,31,31,32,31,31,31,30,29,30,30,30,30],2096:[17,30,31,32,32,31,30,30,29,30,29,30,30],2097:[17,31,32,31,32,31,30,30,30,29,30,30,30],2098:[17,31,31,32,31,31,31,29,30,29,30,30,31],2099:[17,31,31,32,31,31,31,30,29,29,30,30,30],2100:[17,31,32,31,32,30,31,30,29,30,29,30,30]}}),tt.calendars.nepali=NepaliCalendar},{"../main":621,"object-assign":499}],617:[function(Ne,Ge,Qe){var tt=Ne("../main"),rt=Ne("object-assign");function PersianCalendar(Ne){this.local=this.regionalOptions[Ne||""]||this.regionalOptions[""]}function mod(Ne,Ge){return Ne-Ge*Math.floor(Ne/Ge)}PersianCalendar.prototype=new tt.baseCalendar,rt(PersianCalendar.prototype,{name:"Persian",jdEpoch:1948320.5,daysPerMonth:[31,31,31,31,31,31,30,30,30,30,30,29],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Persian",epochs:["BP","AP"],monthNames:["Farvardin","Ordibehesht","Khordad","Tir","Mordad","Shahrivar","Mehr","Aban","Azar","Day","Bahman","Esfand"],monthNamesShort:["Far","Ord","Kho","Tir","Mor","Sha","Meh","Aba","Aza","Day","Bah","Esf"],dayNames:["Yekshambe","Doshambe","Seshambe","ChÃ¦harshambe","Panjshambe","Jom'e","Shambe"],dayNamesShort:["Yek","Do","Se","ChÃ¦","Panj","Jom","Sha"],dayNamesMin:["Ye","Do","Se","Ch","Pa","Jo","Sh"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!1}},leapYear:function(Ne){var Ge=this._validate(Ne,this.minMonth,this.minDay,tt.local.invalidYear);return 682*((Ge.year()-(Ge.year()>0?474:473))%2820+474+38)%2816<682},weekOfYear:function(Ne,Ge,Qe){var tt=this.newDate(Ne,Ge,Qe);return tt.add(-(tt.dayOfWeek()+1)%7,"d"),Math.floor((tt.dayOfYear()-1)/7)+1},daysInMonth:function(Ne,Ge){var Qe=this._validate(Ne,Ge,this.minDay,tt.local.invalidMonth);return this.daysPerMonth[Qe.month()-1]+(12===Qe.month()&&this.leapYear(Qe.year())?1:0)},weekDay:function(Ne,Ge,Qe){return 5!==this.dayOfWeek(Ne,Ge,Qe)},toJD:function(Ne,Ge,Qe){var rt=this._validate(Ne,Ge,Qe,tt.local.invalidDate);Ne=rt.year(),Ge=rt.month(),Qe=rt.day();var nt=Ne-(Ne>=0?474:473),at=474+mod(nt,2820);return Qe+(Ge<=7?31*(Ge-1):30*(Ge-1)+6)+Math.floor((682*at-110)/2816)+365*(at-1)+1029983*Math.floor(nt/2820)+this.jdEpoch-1},fromJD:function(Ne){var Ge=(Ne=Math.floor(Ne)+.5)-this.toJD(475,1,1),Qe=Math.floor(Ge/1029983),tt=mod(Ge,1029983),rt=2820;if(1029982!==tt){var nt=Math.floor(tt/366),at=mod(tt,366);rt=Math.floor((2134*nt+2816*at+2815)/1028522)+nt+1}var it=rt+2820*Qe+474;it=it<=0?it-1:it;var ot=Ne-this.toJD(it,1,1)+1,dt=ot<=186?Math.ceil(ot/31):Math.ceil((ot-6)/30),ht=Ne-this.toJD(it,dt,1)+1;return this.newDate(it,dt,ht)}}),tt.calendars.persian=PersianCalendar,tt.calendars.jalali=PersianCalendar},{"../main":621,"object-assign":499}],618:[function(Ne,Ge,Qe){var tt=Ne("../main"),rt=Ne("object-assign"),nt=tt.instance();function TaiwanCalendar(Ne){this.local=this.regionalOptions[Ne||""]||this.regionalOptions[""]}TaiwanCalendar.prototype=new tt.baseCalendar,rt(TaiwanCalendar.prototype,{name:"Taiwan",jdEpoch:2419402.5,yearsOffset:1911,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Taiwan",epochs:["BROC","ROC"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:1,isRTL:!1}},leapYear:function(Ne){var Ge=this._validate(Ne,this.minMonth,this.minDay,tt.local.invalidYear);return Ne=this._t2gYear(Ge.year()),nt.leapYear(Ne)},weekOfYear:function(Ne,Ge,Qe){var rt=this._validate(Ne,this.minMonth,this.minDay,tt.local.invalidYear);return Ne=this._t2gYear(rt.year()),nt.weekOfYear(Ne,rt.month(),rt.day())},daysInMonth:function(Ne,Ge){var Qe=this._validate(Ne,Ge,this.minDay,tt.local.invalidMonth);return this.daysPerMonth[Qe.month()-1]+(2===Qe.month()&&this.leapYear(Qe.year())?1:0)},weekDay:function(Ne,Ge,Qe){return(this.dayOfWeek(Ne,Ge,Qe)||7)<6},toJD:function(Ne,Ge,Qe){var rt=this._validate(Ne,Ge,Qe,tt.local.invalidDate);return Ne=this._t2gYear(rt.year()),nt.toJD(Ne,rt.month(),rt.day())},fromJD:function(Ne){var Ge=nt.fromJD(Ne),Qe=this._g2tYear(Ge.year());return this.newDate(Qe,Ge.month(),Ge.day())},_t2gYear:function(Ne){return Ne+this.yearsOffset+(Ne>=-this.yearsOffset&&Ne<=-1?1:0)},_g2tYear:function(Ne){return Ne-this.yearsOffset-(Ne>=1&&Ne<=this.yearsOffset?1:0)}}),tt.calendars.taiwan=TaiwanCalendar},{"../main":621,"object-assign":499}],619:[function(Ne,Ge,Qe){var tt=Ne("../main"),rt=Ne("object-assign"),nt=tt.instance();function ThaiCalendar(Ne){this.local=this.regionalOptions[Ne||""]||this.regionalOptions[""]}ThaiCalendar.prototype=new tt.baseCalendar,rt(ThaiCalendar.prototype,{name:"Thai",jdEpoch:1523098.5,yearsOffset:543,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Thai",epochs:["BBE","BE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"dd/mm/yyyy",firstDay:0,isRTL:!1}},leapYear:function(Ne){var Ge=this._validate(Ne,this.minMonth,this.minDay,tt.local.invalidYear);return Ne=this._t2gYear(Ge.year()),nt.leapYear(Ne)},weekOfYear:function(Ne,Ge,Qe){var rt=this._validate(Ne,this.minMonth,this.minDay,tt.local.invalidYear);return Ne=this._t2gYear(rt.year()),nt.weekOfYear(Ne,rt.month(),rt.day())},daysInMonth:function(Ne,Ge){var Qe=this._validate(Ne,Ge,this.minDay,tt.local.invalidMonth);return this.daysPerMonth[Qe.month()-1]+(2===Qe.month()&&this.leapYear(Qe.year())?1:0)},weekDay:function(Ne,Ge,Qe){return(this.dayOfWeek(Ne,Ge,Qe)||7)<6},toJD:function(Ne,Ge,Qe){var rt=this._validate(Ne,Ge,Qe,tt.local.invalidDate);return Ne=this._t2gYear(rt.year()),nt.toJD(Ne,rt.month(),rt.day())},fromJD:function(Ne){var Ge=nt.fromJD(Ne),Qe=this._g2tYear(Ge.year());return this.newDate(Qe,Ge.month(),Ge.day())},_t2gYear:function(Ne){return Ne-this.yearsOffset-(Ne>=1&&Ne<=this.yearsOffset?1:0)},_g2tYear:function(Ne){return Ne+this.yearsOffset+(Ne>=-this.yearsOffset&&Ne<=-1?1:0)}}),tt.calendars.thai=ThaiCalendar},{"../main":621,"object-assign":499}],620:[function(Ne,Ge,Qe){var tt=Ne("../main"),rt=Ne("object-assign");function UmmAlQuraCalendar(Ne){this.local=this.regionalOptions[Ne||""]||this.regionalOptions[""]}UmmAlQuraCalendar.prototype=new tt.baseCalendar,rt(UmmAlQuraCalendar.prototype,{name:"UmmAlQura",hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Umm al-Qura",epochs:["BH","AH"],monthNames:["Al-Muharram","Safar","Rabi' al-awwal","Rabi' Al-Thani","Jumada Al-Awwal","Jumada Al-Thani","Rajab","Sha'aban","Ramadan","Shawwal","Dhu al-Qi'dah","Dhu al-Hijjah"],monthNamesShort:["Muh","Saf","Rab1","Rab2","Jum1","Jum2","Raj","Sha'","Ram","Shaw","DhuQ","DhuH"],dayNames:["Yawm al-Ahad","Yawm al-Ithnain","Yawm al-ThalÄthÄâ","Yawm al-ArbaâÄâ","Yawm al-KhamÄ«s","Yawm al-Jumâa","Yawm al-Sabt"],dayNamesMin:["Ah","Ith","Th","Ar","Kh","Ju","Sa"],digits:null,dateFormat:"yyyy/mm/dd",firstDay:6,isRTL:!0}},leapYear:function(Ne){var Ge=this._validate(Ne,this.minMonth,this.minDay,tt.local.invalidYear);return 355===this.daysInYear(Ge.year())},weekOfYear:function(Ne,Ge,Qe){var tt=this.newDate(Ne,Ge,Qe);return tt.add(-tt.dayOfWeek(),"d"),Math.floor((tt.dayOfYear()-1)/7)+1},daysInYear:function(Ne){for(var Ge=0,Qe=1;Qe<=12;Qe++)Ge+=this.daysInMonth(Ne,Qe);return Ge},daysInMonth:function(Ne,Ge){for(var Qe=this._validate(Ne,Ge,this.minDay,tt.local.invalidMonth).toJD()-24e5+.5,rt=0,at=0;at<nt.length;at++){if(nt[at]>Qe)return nt[rt]-nt[rt-1];rt++}return 30},weekDay:function(Ne,Ge,Qe){return 5!==this.dayOfWeek(Ne,Ge,Qe)},toJD:function(Ne,Ge,Qe){var rt=this._validate(Ne,Ge,Qe,tt.local.invalidDate),at=12*(rt.year()-1)+rt.month()-15292;return rt.day()+nt[at-1]-1+24e5-.5},fromJD:function(Ne){for(var Ge=Ne-24e5+.5,Qe=0,tt=0;tt<nt.length&&!(nt[tt]>Ge);tt++)Qe++;var rt=Qe+15292,at=Math.floor((rt-1)/12),it=at+1,ot=rt-12*at,dt=Ge-nt[Qe-1]+1;return this.newDate(it,ot,dt)},isValid:function(Ne,Ge,Qe){var rt=tt.baseCalendar.prototype.isValid.apply(this,arguments);return rt&&(rt=(Ne=null!=Ne.year?Ne.year:Ne)>=1276&&Ne<=1500),rt},_validate:function(Ne,Ge,Qe,rt){var nt=tt.baseCalendar.prototype._validate.apply(this,arguments);if(nt.year<1276||nt.year>1500)throw rt.replace(/\{0\}/,this.local.name);return nt}}),tt.calendars.ummalqura=UmmAlQuraCalendar;var nt=[20,50,79,109,138,168,197,227,256,286,315,345,374,404,433,463,492,522,551,581,611,641,670,700,729,759,788,818,847,877,906,936,965,995,1024,1054,1083,1113,1142,1172,1201,1231,1260,1290,1320,1350,1379,1409,1438,1468,1497,1527,1556,1586,1615,1645,1674,1704,1733,1763,1792,1822,1851,1881,1910,1940,1969,1999,2028,2058,2087,2117,2146,2176,2205,2235,2264,2294,2323,2353,2383,2413,2442,2472,2501,2531,2560,2590,2619,2649,2678,2708,2737,2767,2796,2826,2855,2885,2914,2944,2973,3003,3032,3062,3091,3121,3150,3180,3209,3239,3268,3298,3327,3357,3386,3416,3446,3476,3505,3535,3564,3594,3623,3653,3682,3712,3741,3771,3800,3830,3859,3889,3918,3948,3977,4007,4036,4066,4095,4125,4155,4185,4214,4244,4273,4303,4332,4362,4391,4421,4450,4480,4509,4539,4568,4598,4627,4657,4686,4716,4745,4775,4804,4834,4863,4893,4922,4952,4981,5011,5040,5070,5099,5129,5158,5188,5218,5248,5277,5307,5336,5366,5395,5425,5454,5484,5513,5543,5572,5602,5631,5661,5690,5720,5749,5779,5808,5838,5867,5897,5926,5956,5985,6015,6044,6074,6103,6133,6162,6192,6221,6251,6281,6311,6340,6370,6399,6429,6458,6488,6517,6547,6576,6606,6635,6665,6694,6724,6753,6783,6812,6842,6871,6901,6930,6960,6989,7019,7048,7078,7107,7137,7166,7196,7225,7255,7284,7314,7344,7374,7403,7433,7462,7492,7521,7551,7580,7610,7639,7669,7698,7728,7757,7787,7816,7846,7875,7905,7934,7964,7993,8023,8053,8083,8112,8142,8171,8201,8230,8260,8289,8319,8348,8378,8407,8437,8466,8496,8525,8555,8584,8614,8643,8673,8702,8732,8761,8791,8821,8850,8880,8909,8938,8968,8997,9027,9056,9086,9115,9145,9175,9205,9234,9264,9293,9322,9352,9381,9410,9440,9470,9499,9529,9559,9589,9618,9648,9677,9706,9736,9765,9794,9824,9853,9883,9913,9943,9972,10002,10032,10061,10090,10120,10149,10178,10208,10237,10267,10297,10326,10356,10386,10415,10445,10474,10504,10533,10562,10592,10621,10651,10680,10710,10740,10770,10799,10829,10858,10888,10917,10947,10976,11005,11035,11064,11094,11124,11153,11183,11213,11242,11272,11301,11331,11360,11389,11419,11448,11478,11507,11537,11567,11596,11626,11655,11685,11715,11744,11774,11803,11832,11862,11891,11921,11950,11980,12010,12039,12069,12099,12128,12158,12187,12216,12246,12275,12304,12334,12364,12393,12423,12453,12483,12512,12542,12571,12600,12630,12659,12688,12718,12747,12777,12807,12837,12866,12896,12926,12955,12984,13014,13043,13072,13102,13131,13161,13191,13220,13250,13280,13310,13339,13368,13398,13427,13456,13486,13515,13545,13574,13604,13634,13664,13693,13723,13752,13782,13811,13840,13870,13899,13929,13958,13988,14018,14047,14077,14107,14136,14166,14195,14224,14254,14283,14313,14342,14372,14401,14431,14461,14490,14520,14550,14579,14609,14638,14667,14697,14726,14756,14785,14815,14844,14874,14904,14933,14963,14993,15021,15051,15081,15110,15140,15169,15199,15228,15258,15287,15317,15347,15377,15406,15436,15465,15494,15524,15553,15582,15612,15641,15671,15701,15731,15760,15790,15820,15849,15878,15908,15937,15966,15996,16025,16055,16085,16114,16144,16174,16204,16233,16262,16292,16321,16350,16380,16409,16439,16468,16498,16528,16558,16587,16617,16646,16676,16705,16734,16764,16793,16823,16852,16882,16912,16941,16971,17001,17030,17060,17089,17118,17148,17177,17207,17236,17266,17295,17325,17355,17384,17414,17444,17473,17502,17532,17561,17591,17620,17650,17679,17709,17738,17768,17798,17827,17857,17886,17916,17945,17975,18004,18034,18063,18093,18122,18152,18181,18211,18241,18270,18300,18330,18359,18388,18418,18447,18476,18506,18535,18565,18595,18625,18654,18684,18714,18743,18772,18802,18831,18860,18890,18919,18949,18979,19008,19038,19068,19098,19127,19156,19186,19215,19244,19274,19303,19333,19362,19392,19422,19452,19481,19511,19540,19570,19599,19628,19658,19687,19717,19746,19776,19806,19836,19865,19895,19924,19954,19983,20012,20042,20071,20101,20130,20160,20190,20219,20249,20279,20308,20338,20367,20396,20426,20455,20485,20514,20544,20573,20603,20633,20662,20692,20721,20751,20780,20810,20839,20869,20898,20928,20957,20987,21016,21046,21076,21105,21135,21164,21194,21223,21253,21282,21312,21341,21371,21400,21430,21459,21489,21519,21548,21578,21607,21637,21666,21696,21725,21754,21784,21813,21843,21873,21902,21932,21962,21991,22021,22050,22080,22109,22138,22168,22197,22227,22256,22286,22316,22346,22375,22405,22434,22464,22493,22522,22552,22581,22611,22640,22670,22700,22730,22759,22789,22818,22848,22877,22906,22936,22965,22994,23024,23054,23083,23113,23143,23173,23202,23232,23261,23290,23320,23349,23379,23408,23438,23467,23497,23527,23556,23586,23616,23645,23674,23704,23733,23763,23792,23822,23851,23881,23910,23940,23970,23999,24029,24058,24088,24117,24147,24176,24206,24235,24265,24294,24324,24353,24383,24413,24442,24472,24501,24531,24560,24590,24619,24648,24678,24707,24737,24767,24796,24826,24856,24885,24915,24944,24974,25003,25032,25062,25091,25121,25150,25180,25210,25240,25269,25299,25328,25358,25387,25416,25446,25475,25505,25534,25564,25594,25624,25653,25683,25712,25742,25771,25800,25830,25859,25888,25918,25948,25977,26007,26037,26067,26096,26126,26155,26184,26214,26243,26272,26302,26332,26361,26391,26421,26451,26480,26510,26539,26568,26598,26627,26656,26686,26715,26745,26775,26805,26834,26864,26893,26923,26952,26982,27011,27041,27070,27099,27129,27159,27188,27218,27248,27277,27307,27336,27366,27395,27425,27454,27484,27513,27542,27572,27602,27631,27661,27691,27720,27750,27779,27809,27838,27868,27897,27926,27956,27985,28015,28045,28074,28104,28134,28163,28193,28222,28252,28281,28310,28340,28369,28399,28428,28458,28488,28517,28547,28577,28607,28636,28665,28695,28724,28754,28783,28813,28843,28872,28901,28931,28960,28990,29019,29049,29078,29108,29137,29167,29196,29226,29255,29285,29315,29345,29375,29404,29434,29463,29492,29522,29551,29580,29610,29640,29669,29699,29729,29759,29788,29818,29847,29876,29906,29935,29964,29994,30023,30053,30082,30112,30141,30171,30200,30230,30259,30289,30318,30348,30378,30408,30437,30467,30496,30526,30555,30585,30614,30644,30673,30703,30732,30762,30791,30821,30850,30880,30909,30939,30968,30998,31027,31057,31086,31116,31145,31175,31204,31234,31263,31293,31322,31352,31381,31411,31441,31471,31500,31530,31559,31589,31618,31648,31676,31706,31736,31766,31795,31825,31854,31884,31913,31943,31972,32002,32031,32061,32090,32120,32150,32180,32209,32239,32268,32298,32327,32357,32386,32416,32445,32475,32504,32534,32563,32593,32622,32652,32681,32711,32740,32770,32799,32829,32858,32888,32917,32947,32976,33006,33035,33065,33094,33124,33153,33183,33213,33243,33272,33302,33331,33361,33390,33420,33450,33479,33509,33539,33568,33598,33627,33657,33686,33716,33745,33775,33804,33834,33863,33893,33922,33952,33981,34011,34040,34069,34099,34128,34158,34187,34217,34247,34277,34306,34336,34365,34395,34424,34454,34483,34512,34542,34571,34601,34631,34660,34690,34719,34749,34778,34808,34837,34867,34896,34926,34955,34985,35015,35044,35074,35103,35133,35162,35192,35222,35251,35280,35310,35340,35370,35399,35429,35458,35488,35517,35547,35576,35605,35635,35665,35694,35723,35753,35782,35811,35841,35871,35901,35930,35960,35989,36019,36048,36078,36107,36136,36166,36195,36225,36254,36284,36314,36343,36373,36403,36433,36462,36492,36521,36551,36580,36610,36639,36669,36698,36728,36757,36786,36816,36845,36875,36904,36934,36963,36993,37022,37052,37081,37111,37141,37170,37200,37229,37259,37288,37318,37347,37377,37406,37436,37465,37495,37524,37554,37584,37613,37643,37672,37701,37731,37760,37790,37819,37849,37878,37908,37938,37967,37997,38027,38056,38085,38115,38144,38174,38203,38233,38262,38292,38322,38351,38381,38410,38440,38469,38499,38528,38558,38587,38617,38646,38676,38705,38735,38764,38794,38823,38853,38882,38912,38941,38971,39001,39030,39059,39089,39118,39148,39178,39208,39237,39267,39297,39326,39355,39385,39414,39444,39473,39503,39532,39562,39592,39621,39650,39680,39709,39739,39768,39798,39827,39857,39886,39916,39946,39975,40005,40035,40064,40094,40123,40153,40182,40212,40241,40271,40300,40330,40359,40389,40418,40448,40477,40507,40536,40566,40595,40625,40655,40685,40714,40744,40773,40803,40832,40862,40892,40921,40951,40980,41009,41039,41068,41098,41127,41157,41186,41216,41245,41275,41304,41334,41364,41393,41422,41452,41481,41511,41540,41570,41599,41629,41658,41688,41718,41748,41777,41807,41836,41865,41894,41924,41953,41983,42012,42042,42072,42102,42131,42161,42190,42220,42249,42279,42308,42337,42367,42397,42426,42456,42485,42515,42545,42574,42604,42633,42662,42692,42721,42751,42780,42810,42839,42869,42899,42929,42958,42988,43017,43046,43076,43105,43135,43164,43194,43223,43253,43283,43312,43342,43371,43401,43430,43460,43489,43519,43548,43578,43607,43637,43666,43696,43726,43755,43785,43814,43844,43873,43903,43932,43962,43991,44021,44050,44080,44109,44139,44169,44198,44228,44258,44287,44317,44346,44375,44405,44434,44464,44493,44523,44553,44582,44612,44641,44671,44700,44730,44759,44788,44818,44847,44877,44906,44936,44966,44996,45025,45055,45084,45114,45143,45172,45202,45231,45261,45290,45320,45350,45380,45409,45439,45468,45498,45527,45556,45586,45615,45644,45674,45704,45733,45763,45793,45823,45852,45882,45911,45940,45970,45999,46028,46058,46088,46117,46147,46177,46206,46236,46265,46295,46324,46354,46383,46413,46442,46472,46501,46531,46560,46590,46620,46649,46679,46708,46738,46767,46797,46826,46856,46885,46915,46944,46974,47003,47033,47063,47092,47122,47151,47181,47210,47240,47269,47298,47328,47357,47387,47417,47446,47476,47506,47535,47565,47594,47624,47653,47682,47712,47741,47771,47800,47830,47860,47890,47919,47949,47978,48008,48037,48066,48096,48125,48155,48184,48214,48244,48273,48303,48333,48362,48392,48421,48450,48480,48509,48538,48568,48598,48627,48657,48687,48717,48746,48776,48805,48834,48864,48893,48922,48952,48982,49011,49041,49071,49100,49130,49160,49189,49218,49248,49277,49306,49336,49365,49395,49425,49455,49484,49514,49543,49573,49602,49632,49661,49690,49720,49749,49779,49809,49838,49868,49898,49927,49957,49986,50016,50045,50075,50104,50133,50163,50192,50222,50252,50281,50311,50340,50370,50400,50429,50459,50488,50518,50547,50576,50606,50635,50665,50694,50724,50754,50784,50813,50843,50872,50902,50931,50960,50990,51019,51049,51078,51108,51138,51167,51197,51227,51256,51286,51315,51345,51374,51403,51433,51462,51492,51522,51552,51582,51611,51641,51670,51699,51729,51758,51787,51816,51846,51876,51906,51936,51965,51995,52025,52054,52083,52113,52142,52171,52200,52230,52260,52290,52319,52349,52379,52408,52438,52467,52497,52526,52555,52585,52614,52644,52673,52703,52733,52762,52792,52822,52851,52881,52910,52939,52969,52998,53028,53057,53087,53116,53146,53176,53205,53235,53264,53294,53324,53353,53383,53412,53441,53471,53500,53530,53559,53589,53619,53648,53678,53708,53737,53767,53796,53825,53855,53884,53913,53943,53973,54003,54032,54062,54092,54121,54151,54180,54209,54239,54268,54297,54327,54357,54387,54416,54446,54476,54505,54535,54564,54593,54623,54652,54681,54711,54741,54770,54800,54830,54859,54889,54919,54948,54977,55007,55036,55066,55095,55125,55154,55184,55213,55243,55273,55302,55332,55361,55391,55420,55450,55479,55508,55538,55567,55597,55627,55657,55686,55716,55745,55775,55804,55834,55863,55892,55922,55951,55981,56011,56040,56070,56100,56129,56159,56188,56218,56247,56276,56306,56335,56365,56394,56424,56454,56483,56513,56543,56572,56601,56631,56660,56690,56719,56749,56778,56808,56837,56867,56897,56926,56956,56985,57015,57044,57074,57103,57133,57162,57192,57221,57251,57280,57310,57340,57369,57399,57429,57458,57487,57517,57546,57576,57605,57634,57664,57694,57723,57753,57783,57813,57842,57871,57901,57930,57959,57989,58018,58048,58077,58107,58137,58167,58196,58226,58255,58285,58314,58343,58373,58402,58432,58461,58491,58521,58551,58580,58610,58639,58669,58698,58727,58757,58786,58816,58845,58875,58905,58934,58964,58994,59023,59053,59082,59111,59141,59170,59200,59229,59259,59288,59318,59348,59377,59407,59436,59466,59495,59525,59554,59584,59613,59643,59672,59702,59731,59761,59791,59820,59850,59879,59909,59939,59968,59997,60027,60056,60086,60115,60145,60174,60204,60234,60264,60293,60323,60352,60381,60411,60440,60469,60499,60528,60558,60588,60618,60648,60677,60707,60736,60765,60795,60824,60853,60883,60912,60942,60972,61002,61031,61061,61090,61120,61149,61179,61208,61237,61267,61296,61326,61356,61385,61415,61445,61474,61504,61533,61563,61592,61621,61651,61680,61710,61739,61769,61799,61828,61858,61888,61917,61947,61976,62006,62035,62064,62094,62123,62153,62182,62212,62242,62271,62301,62331,62360,62390,62419,62448,62478,62507,62537,62566,62596,62625,62655,62685,62715,62744,62774,62803,62832,62862,62891,62921,62950,62980,63009,63039,63069,63099,63128,63157,63187,63216,63246,63275,63305,63334,63363,63393,63423,63453,63482,63512,63541,63571,63600,63630,63659,63689,63718,63747,63777,63807,63836,63866,63895,63925,63955,63984,64014,64043,64073,64102,64131,64161,64190,64220,64249,64279,64309,64339,64368,64398,64427,64457,64486,64515,64545,64574,64603,64633,64663,64692,64722,64752,64782,64811,64841,64870,64899,64929,64958,64987,65017,65047,65076,65106,65136,65166,65195,65225,65254,65283,65313,65342,65371,65401,65431,65460,65490,65520,65549,65579,65608,65638,65667,65697,65726,65755,65785,65815,65844,65874,65903,65933,65963,65992,66022,66051,66081,66110,66140,66169,66199,66228,66258,66287,66317,66346,66376,66405,66435,66465,66494,66524,66553,66583,66612,66641,66671,66700,66730,66760,66789,66819,66849,66878,66908,66937,66967,66996,67025,67055,67084,67114,67143,67173,67203,67233,67262,67292,67321,67351,67380,67409,67439,67468,67497,67527,67557,67587,67617,67646,67676,67705,67735,67764,67793,67823,67852,67882,67911,67941,67971,68e3,68030,68060,68089,68119,68148,68177,68207,68236,68266,68295,68325,68354,68384,68414,68443,68473,68502,68532,68561,68591,68620,68650,68679,68708,68738,68768,68797,68827,68857,68886,68916,68946,68975,69004,69034,69063,69092,69122,69152,69181,69211,69240,69270,69300,69330,69359,69388,69418,69447,69476,69506,69535,69565,69595,69624,69654,69684,69713,69743,69772,69802,69831,69861,69890,69919,69949,69978,70008,70038,70067,70097,70126,70156,70186,70215,70245,70274,70303,70333,70362,70392,70421,70451,70481,70510,70540,70570,70599,70629,70658,70687,70717,70746,70776,70805,70835,70864,70894,70924,70954,70983,71013,71042,71071,71101,71130,71159,71189,71218,71248,71278,71308,71337,71367,71397,71426,71455,71485,71514,71543,71573,71602,71632,71662,71691,71721,71751,71781,71810,71839,71869,71898,71927,71957,71986,72016,72046,72075,72105,72135,72164,72194,72223,72253,72282,72311,72341,72370,72400,72429,72459,72489,72518,72548,72577,72607,72637,72666,72695,72725,72754,72784,72813,72843,72872,72902,72931,72961,72991,73020,73050,73080,73109,73139,73168,73197,73227,73256,73286,73315,73345,73375,73404,73434,73464,73493,73523,73552,73581,73611,73640,73669,73699,73729,73758,73788,73818,73848,73877,73907,73936,73965,73995,74024,74053,74083,74113,74142,74172,74202,74231,74261,74291,74320,74349,74379,74408,74437,74467,74497,74526,74556,74586,74615,74645,74675,74704,74733,74763,74792,74822,74851,74881,74910,74940,74969,74999,75029,75058,75088,75117,75147,75176,75206,75235,75264,75294,75323,75353,75383,75412,75442,75472,75501,75531,75560,75590,75619,75648,75678,75707,75737,75766,75796,75826,75856,75885,75915,75944,75974,76003,76032,76062,76091,76121,76150,76180,76210,76239,76269,76299,76328,76358,76387,76416,76446,76475,76505,76534,76564,76593,76623,76653,76682,76712,76741,76771,76801,76830,76859,76889,76918,76948,76977,77007,77036,77066,77096,77125,77155,77185,77214,77243,77273,77302,77332,77361,77390,77420,77450,77479,77509,77539,77569,77598,77627,77657,77686,77715,77745,77774,77804,77833,77863,77893,77923,77952,77982,78011,78041,78070,78099,78129,78158,78188,78217,78247,78277,78307,78336,78366,78395,78425,78454,78483,78513,78542,78572,78601,78631,78661,78690,78720,78750,78779,78808,78838,78867,78897,78926,78956,78985,79015,79044,79074,79104,79133,79163,79192,79222,79251,79281,79310,79340,79369,79399,79428,79458,79487,79517,79546,79576,79606,79635,79665,79695,79724,79753,79783,79812,79841,79871,79900,79930,79960,79990]},{"../main":621,"object-assign":499}],621:[function(Ne,Ge,Qe){var tt=Ne("object-assign");function Calendars(){this.regionalOptions=[],this.regionalOptions[""]={invalidCalendar:"Calendar {0} not found",invalidDate:"Invalid {0} date",invalidMonth:"Invalid {0} month",invalidYear:"Invalid {0} year",differentCalendars:"Cannot mix {0} and {1} dates"},this.local=this.regionalOptions[""],this.calendars={},this._localCals={}}function CDate(Ne,Ge,Qe,tt){if(this._calendar=Ne,this._year=Ge,this._month=Qe,this._day=tt,0===this._calendar._validateLevel&&!this._calendar.isValid(this._year,this._month,this._day))throw(rt.local.invalidDate||rt.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name)}function pad(Ne,Ge){return"000000".substring(0,Ge-(Ne=""+Ne).length)+Ne}function BaseCalendar(){this.shortYearCutoff="+10"}function GregorianCalendar(Ne){this.local=this.regionalOptions[Ne]||this.regionalOptions[""]}tt(Calendars.prototype,{instance:function(Ne,Ge){Ne=(Ne||"gregorian").toLowerCase(),Ge=Ge||"";var Qe=this._localCals[Ne+"-"+Ge];if(!Qe&&this.calendars[Ne]&&(Qe=new this.calendars[Ne](Ge),this._localCals[Ne+"-"+Ge]=Qe),!Qe)throw(this.local.invalidCalendar||this.regionalOptions[""].invalidCalendar).replace(/\{0\}/,Ne);return Qe},newDate:function(Ne,Ge,Qe,tt,rt){return(tt=(null!=Ne&&Ne.year?Ne.calendar():"string"==typeof tt?this.instance(tt,rt):tt)||this.instance()).newDate(Ne,Ge,Qe)},substituteDigits:function(Ne){return function(Ge){return(Ge+"").replace(/[0-9]/g,(function(Ge){return Ne[Ge]}))}},substituteChineseDigits:function(Ne,Ge){return function(Qe){for(var tt="",rt=0;Qe>0;){var nt=Qe%10;tt=(0===nt?"":Ne[nt]+Ge[rt])+tt,rt++,Qe=Math.floor(Qe/10)}return 0===tt.indexOf(Ne[1]+Ge[1])&&(tt=tt.substr(1)),tt||Ne[0]}}}),tt(CDate.prototype,{newDate:function(Ne,Ge,Qe){return this._calendar.newDate(null==Ne?this:Ne,Ge,Qe)},year:function(Ne){return 0===arguments.length?this._year:this.set(Ne,"y")},month:function(Ne){return 0===arguments.length?this._month:this.set(Ne,"m")},day:function(Ne){return 0===arguments.length?this._day:this.set(Ne,"d")},date:function(Ne,Ge,Qe){if(!this._calendar.isValid(Ne,Ge,Qe))throw(rt.local.invalidDate||rt.regionalOptions[""].invalidDate).replace(/\{0\}/,this._calendar.local.name);return this._year=Ne,this._month=Ge,this._day=Qe,this},leapYear:function(){return this._calendar.leapYear(this)},epoch:function(){return this._calendar.epoch(this)},formatYear:function(){return this._calendar.formatYear(this)},monthOfYear:function(){return this._calendar.monthOfYear(this)},weekOfYear:function(){return this._calendar.weekOfYear(this)},daysInYear:function(){return this._calendar.daysInYear(this)},dayOfYear:function(){return this._calendar.dayOfYear(this)},daysInMonth:function(){return this._calendar.daysInMonth(this)},dayOfWeek:function(){return this._calendar.dayOfWeek(this)},weekDay:function(){return this._calendar.weekDay(this)},extraInfo:function(){return this._calendar.extraInfo(this)},add:function(Ne,Ge){return this._calendar.add(this,Ne,Ge)},set:function(Ne,Ge){return this._calendar.set(this,Ne,Ge)},compareTo:function(Ne){if(this._calendar.name!==Ne._calendar.name)throw(rt.local.differentCalendars||rt.regionalOptions[""].differentCalendars).replace(/\{0\}/,this._calendar.local.name).replace(/\{1\}/,Ne._calendar.local.name);var Ge=this._year!==Ne._year?this._year-Ne._year:this._month!==Ne._month?this.monthOfYear()-Ne.monthOfYear():this._day-Ne._day;return 0===Ge?0:Ge<0?-1:1},calendar:function(){return this._calendar},toJD:function(){return this._calendar.toJD(this)},fromJD:function(Ne){return this._calendar.fromJD(Ne)},toJSDate:function(){return this._calendar.toJSDate(this)},fromJSDate:function(Ne){return this._calendar.fromJSDate(Ne)},toString:function(){return(this.year()<0?"-":"")+pad(Math.abs(this.year()),4)+"-"+pad(this.month(),2)+"-"+pad(this.day(),2)}}),tt(BaseCalendar.prototype,{_validateLevel:0,newDate:function(Ne,Ge,Qe){return null==Ne?this.today():(Ne.year&&(this._validate(Ne,Ge,Qe,rt.local.invalidDate||rt.regionalOptions[""].invalidDate),Qe=Ne.day(),Ge=Ne.month(),Ne=Ne.year()),new CDate(this,Ne,Ge,Qe))},today:function(){return this.fromJSDate(new Date)},epoch:function(Ne){return this._validate(Ne,this.minMonth,this.minDay,rt.local.invalidYear||rt.regionalOptions[""].invalidYear).year()<0?this.local.epochs[0]:this.local.epochs[1]},formatYear:function(Ne){var Ge=this._validate(Ne,this.minMonth,this.minDay,rt.local.invalidYear||rt.regionalOptions[""].invalidYear);return(Ge.year()<0?"-":"")+pad(Math.abs(Ge.year()),4)},monthsInYear:function(Ne){return this._validate(Ne,this.minMonth,this.minDay,rt.local.invalidYear||rt.regionalOptions[""].invalidYear),12},monthOfYear:function(Ne,Ge){var Qe=this._validate(Ne,Ge,this.minDay,rt.local.invalidMonth||rt.regionalOptions[""].invalidMonth);return(Qe.month()+this.monthsInYear(Qe)-this.firstMonth)%this.monthsInYear(Qe)+this.minMonth},fromMonthOfYear:function(Ne,Ge){var Qe=(Ge+this.firstMonth-2*this.minMonth)%this.monthsInYear(Ne)+this.minMonth;return this._validate(Ne,Qe,this.minDay,rt.local.invalidMonth||rt.regionalOptions[""].invalidMonth),Qe},daysInYear:function(Ne){var Ge=this._validate(Ne,this.minMonth,this.minDay,rt.local.invalidYear||rt.regionalOptions[""].invalidYear);return this.leapYear(Ge)?366:365},dayOfYear:function(Ne,Ge,Qe){var tt=this._validate(Ne,Ge,Qe,rt.local.invalidDate||rt.regionalOptions[""].invalidDate);return tt.toJD()-this.newDate(tt.year(),this.fromMonthOfYear(tt.year(),this.minMonth),this.minDay).toJD()+1},daysInWeek:function(){return 7},dayOfWeek:function(Ne,Ge,Qe){var tt=this._validate(Ne,Ge,Qe,rt.local.invalidDate||rt.regionalOptions[""].invalidDate);return(Math.floor(this.toJD(tt))+2)%this.daysInWeek()},extraInfo:function(Ne,Ge,Qe){return this._validate(Ne,Ge,Qe,rt.local.invalidDate||rt.regionalOptions[""].invalidDate),{}},add:function(Ne,Ge,Qe){return this._validate(Ne,this.minMonth,this.minDay,rt.local.invalidDate||rt.regionalOptions[""].invalidDate),this._correctAdd(Ne,this._add(Ne,Ge,Qe),Ge,Qe)},_add:function(Ne,Ge,Qe){if(this._validateLevel++,"d"===Qe||"w"===Qe){var tt=Ne.toJD()+Ge*("w"===Qe?this.daysInWeek():1),rt=Ne.calendar().fromJD(tt);return this._validateLevel--,[rt.year(),rt.month(),rt.day()]}try{var nt=Ne.year()+("y"===Qe?Ge:0),at=Ne.monthOfYear()+("m"===Qe?Ge:0),it=(rt=Ne.day(),function(Ne){for(;at<Ne.minMonth;)nt--,at+=Ne.monthsInYear(nt);for(var Ge=Ne.monthsInYear(nt);at>Ge-1+Ne.minMonth;)nt++,at-=Ge,Ge=Ne.monthsInYear(nt)});"y"===Qe?(Ne.month()!==this.fromMonthOfYear(nt,at)&&(at=this.newDate(nt,Ne.month(),this.minDay).monthOfYear()),at=Math.min(at,this.monthsInYear(nt)),rt=Math.min(rt,this.daysInMonth(nt,this.fromMonthOfYear(nt,at)))):"m"===Qe&&(it(this),rt=Math.min(rt,this.daysInMonth(nt,this.fromMonthOfYear(nt,at))));var ot=[nt,this.fromMonthOfYear(nt,at),rt];return this._validateLevel--,ot}catch(Ne){throw this._validateLevel--,Ne}},_correctAdd:function(Ne,Ge,Qe,tt){if(!(this.hasYearZero||"y"!==tt&&"m"!==tt||0!==Ge[0]&&Ne.year()>0==Ge[0]>0)){var rt={y:[1,1,"y"],m:[1,this.monthsInYear(-1),"m"],w:[this.daysInWeek(),this.daysInYear(-1),"d"],d:[1,this.daysInYear(-1),"d"]}[tt],nt=Qe<0?-1:1;Ge=this._add(Ne,Qe*rt[0]+nt*rt[1],rt[2])}return Ne.date(Ge[0],Ge[1],Ge[2])},set:function(Ne,Ge,Qe){this._validate(Ne,this.minMonth,this.minDay,rt.local.invalidDate||rt.regionalOptions[""].invalidDate);var tt="y"===Qe?Ge:Ne.year(),nt="m"===Qe?Ge:Ne.month(),at="d"===Qe?Ge:Ne.day();return"y"!==Qe&&"m"!==Qe||(at=Math.min(at,this.daysInMonth(tt,nt))),Ne.date(tt,nt,at)},isValid:function(Ne,Ge,Qe){this._validateLevel++;var tt=this.hasYearZero||0!==Ne;if(tt){var rt=this.newDate(Ne,Ge,this.minDay);tt=Ge>=this.minMonth&&Ge-this.minMonth<this.monthsInYear(rt)&&Qe>=this.minDay&&Qe-this.minDay<this.daysInMonth(rt)}return this._validateLevel--,tt},toJSDate:function(Ne,Ge,Qe){var tt=this._validate(Ne,Ge,Qe,rt.local.invalidDate||rt.regionalOptions[""].invalidDate);return rt.instance().fromJD(this.toJD(tt)).toJSDate()},fromJSDate:function(Ne){return this.fromJD(rt.instance().fromJSDate(Ne).toJD())},_validate:function(Ne,Ge,Qe,tt){if(Ne.year){if(0===this._validateLevel&&this.name!==Ne.calendar().name)throw(rt.local.differentCalendars||rt.regionalOptions[""].differentCalendars).replace(/\{0\}/,this.local.name).replace(/\{1\}/,Ne.calendar().local.name);return Ne}try{if(this._validateLevel++,1===this._validateLevel&&!this.isValid(Ne,Ge,Qe))throw tt.replace(/\{0\}/,this.local.name);var nt=this.newDate(Ne,Ge,Qe);return this._validateLevel--,nt}catch(Ne){throw this._validateLevel--,Ne}}}),GregorianCalendar.prototype=new BaseCalendar,tt(GregorianCalendar.prototype,{name:"Gregorian",jdEpoch:1721425.5,daysPerMonth:[31,28,31,30,31,30,31,31,30,31,30,31],hasYearZero:!1,minMonth:1,firstMonth:1,minDay:1,regionalOptions:{"":{name:"Gregorian",epochs:["BCE","CE"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],digits:null,dateFormat:"mm/dd/yyyy",firstDay:0,isRTL:!1}},leapYear:function(Ne){var Ge=this._validate(Ne,this.minMonth,this.minDay,rt.local.invalidYear||rt.regionalOptions[""].invalidYear);return(Ne=Ge.year()+(Ge.year()<0?1:0))%4==0&&(Ne%100!=0||Ne%400==0)},weekOfYear:function(Ne,Ge,Qe){var tt=this.newDate(Ne,Ge,Qe);return tt.add(4-(tt.dayOfWeek()||7),"d"),Math.floor((tt.dayOfYear()-1)/7)+1},daysInMonth:function(Ne,Ge){var Qe=this._validate(Ne,Ge,this.minDay,rt.local.invalidMonth||rt.regionalOptions[""].invalidMonth);return this.daysPerMonth[Qe.month()-1]+(2===Qe.month()&&this.leapYear(Qe.year())?1:0)},weekDay:function(Ne,Ge,Qe){return(this.dayOfWeek(Ne,Ge,Qe)||7)<6},toJD:function(Ne,Ge,Qe){var tt=this._validate(Ne,Ge,Qe,rt.local.invalidDate||rt.regionalOptions[""].invalidDate);Ne=tt.year(),Ge=tt.month(),Qe=tt.day(),Ne<0&&Ne++,Ge<3&&(Ge+=12,Ne--);var nt=Math.floor(Ne/100),at=2-nt+Math.floor(nt/4);return Math.floor(365.25*(Ne+4716))+Math.floor(30.6001*(Ge+1))+Qe+at-1524.5},fromJD:function(Ne){var Ge=Math.floor(Ne+.5),Qe=Math.floor((Ge-1867216.25)/36524.25),tt=1524+(Qe=Ge+1+Qe-Math.floor(Qe/4)),rt=Math.floor((tt-122.1)/365.25),nt=Math.floor(365.25*rt),at=Math.floor((tt-nt)/30.6001),it=tt-nt-Math.floor(30.6001*at),ot=at-(at>13.5?13:1),dt=rt-(ot>2.5?4716:4715);return dt<=0&&dt--,this.newDate(dt,ot,it)},toJSDate:function(Ne,Ge,Qe){var tt=this._validate(Ne,Ge,Qe,rt.local.invalidDate||rt.regionalOptions[""].invalidDate),nt=new Date(tt.year(),tt.month()-1,tt.day());return nt.setHours(0),nt.setMinutes(0),nt.setSeconds(0),nt.setMilliseconds(0),nt.setHours(nt.getHours()>12?nt.getHours()+2:0),nt},fromJSDate:function(Ne){return this.newDate(Ne.getFullYear(),Ne.getMonth()+1,Ne.getDate())}});var rt=Ge.exports=new Calendars;rt.cdate=CDate,rt.baseCalendar=BaseCalendar,rt.calendars.gregorian=GregorianCalendar},{"object-assign":499}],622:[function(Ne,Ge,Qe){var tt=Ne("object-assign"),rt=Ne("./main");tt(rt.regionalOptions[""],{invalidArguments:"Invalid arguments",invalidFormat:"Cannot format a date from another calendar",missingNumberAt:"Missing number at position {0}",unknownNameAt:"Unknown name at position {0}",unexpectedLiteralAt:"Unexpected literal at position {0}",unexpectedText:"Additional text found at end"}),rt.local=rt.regionalOptions[""],tt(rt.cdate.prototype,{formatDate:function(Ne,Ge){return"string"!=typeof Ne&&(Ge=Ne,Ne=""),this._calendar.formatDate(Ne||"",this,Ge)}}),tt(rt.baseCalendar.prototype,{UNIX_EPOCH:rt.instance().newDate(1970,1,1).toJD(),SECS_PER_DAY:86400,TICKS_EPOCH:rt.instance().jdEpoch,TICKS_PER_DAY:864e9,ATOM:"yyyy-mm-dd",COOKIE:"D, dd M yyyy",FULL:"DD, MM d, yyyy",ISO_8601:"yyyy-mm-dd",JULIAN:"J",RFC_822:"D, d M yy",RFC_850:"DD, dd-M-yy",RFC_1036:"D, d M yy",RFC_1123:"D, d M yyyy",RFC_2822:"D, d M yyyy",RSS:"D, d M yy",TICKS:"!",TIMESTAMP:"@",W3C:"yyyy-mm-dd",formatDate:function(Ne,Ge,Qe){if("string"!=typeof Ne&&(Qe=Ge,Ge=Ne,Ne=""),!Ge)return"";if(Ge.calendar()!==this)throw rt.local.invalidFormat||rt.regionalOptions[""].invalidFormat;Ne=Ne||this.local.dateFormat;for(var tt=(Qe=Qe||{}).dayNamesShort||this.local.dayNamesShort,nt=Qe.dayNames||this.local.dayNames,at=Qe.monthNumbers||this.local.monthNumbers,it=Qe.monthNamesShort||this.local.monthNamesShort,ot=Qe.monthNames||this.local.monthNames,dt=(Qe.calculateWeek||this.local.calculateWeek,function(Ge,Qe){for(var tt=1;Zt+tt<Ne.length&&Ne.charAt(Zt+tt)===Ge;)tt++;return Zt+=tt-1,Math.floor(tt/(Qe||1))>1}),formatNumber=function(Ne,Ge,Qe,tt){var rt=""+Ge;if(dt(Ne,tt))for(;rt.length<Qe;)rt="0"+rt;return rt},formatName=function(Ne,Ge,Qe,tt){return dt(Ne)?tt[Ge]:Qe[Ge]},ht=this,formatMonth=function(Ne){return"function"==typeof at?at.call(ht,Ne,dt("m")):localiseNumbers(formatNumber("m",Ne.month(),2))},formatMonthName=function(Ne,Ge){return Ge?"function"==typeof ot?ot.call(ht,Ne):ot[Ne.month()-ht.minMonth]:"function"==typeof it?it.call(ht,Ne):it[Ne.month()-ht.minMonth]},Dt=this.local.digits,localiseNumbers=function(Ne){return Qe.localNumbers&&Dt?Dt(Ne):Ne},Ot="",Rt=!1,Zt=0;Zt<Ne.length;Zt++)if(Rt)"'"!==Ne.charAt(Zt)||dt("'")?Ot+=Ne.charAt(Zt):Rt=!1;else switch(Ne.charAt(Zt)){case"d":Ot+=localiseNumbers(formatNumber("d",Ge.day(),2));break;case"D":Ot+=formatName("D",Ge.dayOfWeek(),tt,nt);break;case"o":Ot+=formatNumber("o",Ge.dayOfYear(),3);break;case"w":Ot+=formatNumber("w",Ge.weekOfYear(),2);break;case"m":Ot+=formatMonth(Ge);break;case"M":Ot+=formatMonthName(Ge,dt("M"));break;case"y":Ot+=dt("y",2)?Ge.year():(Ge.year()%100<10?"0":"")+Ge.year()%100;break;case"Y":dt("Y",2),Ot+=Ge.formatYear();break;case"J":Ot+=Ge.toJD();break;case"@":Ot+=(Ge.toJD()-this.UNIX_EPOCH)*this.SECS_PER_DAY;break;case"!":Ot+=(Ge.toJD()-this.TICKS_EPOCH)*this.TICKS_PER_DAY;break;case"'":dt("'")?Ot+="'":Rt=!0;break;default:Ot+=Ne.charAt(Zt)}return Ot},parseDate:function(Ne,Ge,Qe){if(null==Ge)throw rt.local.invalidArguments||rt.regionalOptions[""].invalidArguments;if(""===(Ge="object"==typeof Ge?Ge.toString():Ge+""))return null;Ne=Ne||this.local.dateFormat;var tt=(Qe=Qe||{}).shortYearCutoff||this.shortYearCutoff;tt="string"!=typeof tt?tt:this.today().year()%100+parseInt(tt,10);for(var nt=Qe.dayNamesShort||this.local.dayNamesShort,at=Qe.dayNames||this.local.dayNames,it=Qe.parseMonth||this.local.parseMonth,ot=Qe.monthNumbers||this.local.monthNumbers,dt=Qe.monthNamesShort||this.local.monthNamesShort,ht=Qe.monthNames||this.local.monthNames,Dt=-1,Ot=-1,Rt=-1,Zt=-1,er=-1,dr=!1,mr=!1,doubled=function(Ge,Qe){for(var tt=1;Ar+tt<Ne.length&&Ne.charAt(Ar+tt)===Ge;)tt++;return Ar+=tt-1,Math.floor(tt/(Qe||1))>1},getNumber=function(Ne,Qe){var tt=doubled(Ne,Qe),nt=[2,3,tt?4:2,tt?4:2,10,11,20]["oyYJ@!".indexOf(Ne)+1],at=new RegExp("^-?\\d{1,"+nt+"}"),it=Ge.substring(br).match(at);if(!it)throw(rt.local.missingNumberAt||rt.regionalOptions[""].missingNumberAt).replace(/\{0\}/,br);return br+=it[0].length,parseInt(it[0],10)},xr=this,getMonthNumber=function(){if("function"==typeof ot){doubled("m");var Ne=ot.call(xr,Ge.substring(br));return br+=Ne.length,Ne}return getNumber("m")},getName=function(Ne,Qe,tt,nt){for(var at=doubled(Ne,nt)?tt:Qe,it=0;it<at.length;it++)if(Ge.substr(br,at[it].length).toLowerCase()===at[it].toLowerCase())return br+=at[it].length,it+xr.minMonth;throw(rt.local.unknownNameAt||rt.regionalOptions[""].unknownNameAt).replace(/\{0\}/,br)},getMonthName=function(){if("function"==typeof ht){var Ne=doubled("M")?ht.call(xr,Ge.substring(br)):dt.call(xr,Ge.substring(br));return br+=Ne.length,Ne}return getName("M",dt,ht)},checkLiteral=function(){if(Ge.charAt(br)!==Ne.charAt(Ar))throw(rt.local.unexpectedLiteralAt||rt.regionalOptions[""].unexpectedLiteralAt).replace(/\{0\}/,br);br++},br=0,Ar=0;Ar<Ne.length;Ar++)if(mr)"'"!==Ne.charAt(Ar)||doubled("'")?checkLiteral():mr=!1;else switch(Ne.charAt(Ar)){case"d":Zt=getNumber("d");break;case"D":getName("D",nt,at);break;case"o":er=getNumber("o");break;case"w":getNumber("w");break;case"m":Rt=getMonthNumber();break;case"M":Rt=getMonthName();break;case"y":var en=Ar;dr=!doubled("y",2),Ar=en,Ot=getNumber("y",2);break;case"Y":Ot=getNumber("Y",2);break;case"J":Dt=getNumber("J")+.5,"."===Ge.charAt(br)&&(br++,getNumber("J"));break;case"@":Dt=getNumber("@")/this.SECS_PER_DAY+this.UNIX_EPOCH;break;case"!":Dt=getNumber("!")/this.TICKS_PER_DAY+this.TICKS_EPOCH;break;case"*":br=Ge.length;break;case"'":doubled("'")?checkLiteral():mr=!0;break;default:checkLiteral()}if(br<Ge.length)throw rt.local.unexpectedText||rt.regionalOptions[""].unexpectedText;if(-1===Ot?Ot=this.today().year():Ot<100&&dr&&(Ot+=-1===tt?1900:this.today().year()-this.today().year()%100-(Ot<=tt?0:100)),"string"==typeof Rt&&(Rt=it.call(this,Ot,Rt)),er>-1){Rt=1,Zt=er;for(var mn=this.daysInMonth(Ot,Rt);Zt>mn;mn=this.daysInMonth(Ot,Rt))Rt++,Zt-=mn}return Dt>-1?this.fromJD(Dt):this.newDate(Ot,Rt,Zt)},determineDate:function(Ne,Ge,Qe,tt,rt){Qe&&"object"!=typeof Qe&&(rt=tt,tt=Qe,Qe=null),"string"!=typeof tt&&(rt=tt,tt="");var nt=this,offsetString=function(Ne){try{return nt.parseDate(tt,Ne,rt)}catch(Ne){}for(var Ge=((Ne=Ne.toLowerCase()).match(/^c/)&&Qe?Qe.newDate():null)||nt.today(),at=/([+-]?[0-9]+)\s*(d|w|m|y)?/g,it=at.exec(Ne);it;)Ge.add(parseInt(it[1],10),it[2]||"d"),it=at.exec(Ne);return Ge};return Ge=Ge?Ge.newDate():null,Ne=null==Ne?Ge:"string"==typeof Ne?offsetString(Ne):"number"==typeof Ne?isNaN(Ne)||Ne===1/0||Ne===-1/0?Ge:nt.today().add(Ne,"d"):nt.newDate(Ne)}})},{"./main":621,"object-assign":499}],623:[function(Ne,Ge,Qe){Ge.exports=Ne("cwise-compiler")({args:["array",{offset:[1],array:0},"scalar","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},post:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\n        var _inline_1_da = _inline_1_arg0_ - _inline_1_arg3_\n        var _inline_1_db = _inline_1_arg1_ - _inline_1_arg3_\n        if((_inline_1_da >= 0) !== (_inline_1_db >= 0)) {\n          _inline_1_arg2_.push(_inline_1_arg4_[0] + 0.5 + 0.5 * (_inline_1_da + _inline_1_db) / (_inline_1_da - _inline_1_db))\n        }\n      }",args:[{name:"_inline_1_arg0_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg3_",lvalue:!1,rvalue:!0,count:2},{name:"_inline_1_arg4_",lvalue:!1,rvalue:!0,count:1}],thisVars:[],localVars:["_inline_1_da","_inline_1_db"]},funcName:"zeroCrossings"})},{"cwise-compiler":151}],624:[function(Ne,Ge,Qe){"use strict";Ge.exports=findZeroCrossings;var tt=Ne("./lib/zc-core");function findZeroCrossings(Ne,Ge){var Qe=[];return Ge=+Ge||0,tt(Ne.hi(Ne.shape[0]-1),Qe,Ge),Qe}},{"./lib/zc-core":623}],625:[function(Ne,Ge,Qe){"use strict";Ge.exports=[{path:"",backoff:0},{path:"M-2.4,-3V3L0.6,0Z",backoff:.6},{path:"M-3.7,-2.5V2.5L1.3,0Z",backoff:1.3},{path:"M-4.45,-3L-1.65,-0.2V0.2L-4.45,3L1.55,0Z",backoff:1.55},{path:"M-2.2,-2.2L-0.2,-0.2V0.2L-2.2,2.2L-1.4,3L1.6,0L-1.4,-3Z",backoff:1.6},{path:"M-4.4,-2.1L-0.6,-0.2V0.2L-4.4,2.1L-4,3L2,0L-4,-3Z",backoff:2},{path:"M2,0A2,2 0 1,1 0,-2A2,2 0 0,1 2,0Z",backoff:0,noRotate:!0},{path:"M2,2V-2H-2V2Z",backoff:0,noRotate:!0}]},{}],626:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./arrow_paths"),rt=Ne("../../plots/font_attributes"),nt=Ne("../../plots/cartesian/constants"),at=Ne("../../plot_api/plot_template").templatedArray;Ne("../../constants/axis_placeable_objects"),Ge.exports=at("annotation",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},text:{valType:"string",editType:"calc+arraydraw"},textangle:{valType:"angle",dflt:0,editType:"calc+arraydraw"},font:rt({editType:"calc+arraydraw",colorEditType:"arraydraw"}),width:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},height:{valType:"number",min:1,dflt:null,editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},align:{valType:"enumerated",values:["left","center","right"],dflt:"center",editType:"arraydraw"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"arraydraw"},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},bordercolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},borderpad:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},borderwidth:{valType:"number",min:0,dflt:1,editType:"calc+arraydraw"},showarrow:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},arrowcolor:{valType:"color",editType:"arraydraw"},arrowhead:{valType:"integer",min:0,max:tt.length,dflt:1,editType:"arraydraw"},startarrowhead:{valType:"integer",min:0,max:tt.length,dflt:1,editType:"arraydraw"},arrowside:{valType:"flaglist",flags:["end","start"],extras:["none"],dflt:"end",editType:"arraydraw"},arrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},startarrowsize:{valType:"number",min:.3,dflt:1,editType:"calc+arraydraw"},arrowwidth:{valType:"number",min:.1,editType:"calc+arraydraw"},standoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},startstandoff:{valType:"number",min:0,dflt:0,editType:"calc+arraydraw"},ax:{valType:"any",editType:"calc+arraydraw"},ay:{valType:"any",editType:"calc+arraydraw"},axref:{valType:"enumerated",dflt:"pixel",values:["pixel",nt.idRegex.x.toString()],editType:"calc"},ayref:{valType:"enumerated",dflt:"pixel",values:["pixel",nt.idRegex.y.toString()],editType:"calc"},xref:{valType:"enumerated",values:["paper",nt.idRegex.x.toString()],editType:"calc"},x:{valType:"any",editType:"calc+arraydraw"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"auto",editType:"calc+arraydraw"},xshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},yref:{valType:"enumerated",values:["paper",nt.idRegex.y.toString()],editType:"calc"},y:{valType:"any",editType:"calc+arraydraw"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"auto",editType:"calc+arraydraw"},yshift:{valType:"number",dflt:0,editType:"calc+arraydraw"},clicktoshow:{valType:"enumerated",values:[!1,"onoff","onout"],dflt:!1,editType:"arraydraw"},xclick:{valType:"any",editType:"arraydraw"},yclick:{valType:"any",editType:"arraydraw"},hovertext:{valType:"string",editType:"arraydraw"},hoverlabel:{bgcolor:{valType:"color",editType:"arraydraw"},bordercolor:{valType:"color",editType:"arraydraw"},font:rt({editType:"arraydraw"}),editType:"arraydraw"},captureevents:{valType:"boolean",editType:"arraydraw"},editType:"calc",_deprecated:{ref:{valType:"string",editType:"calc"}}})},{"../../constants/axis_placeable_objects":746,"../../plot_api/plot_template":817,"../../plots/cartesian/constants":834,"../../plots/font_attributes":856,"./arrow_paths":625}],627:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../plots/cartesian/axes"),nt=Ne("./draw").draw;function annAutorange(Ne){var Ge=Ne._fullLayout;tt.filterVisible(Ge.annotations).forEach((function(Ge){var Qe=rt.getFromId(Ne,Ge.xref),tt=rt.getFromId(Ne,Ge.yref),nt=rt.getRefType(Ge.xref),at=rt.getRefType(Ge.yref);Ge._extremes={},"range"===nt&&calcAxisExpansion(Ge,Qe),"range"===at&&calcAxisExpansion(Ge,tt)}))}function calcAxisExpansion(Ne,Ge){var Qe,tt=Ge._id,nt=tt.charAt(0),at=Ne[nt],it=Ne["a"+nt],ot=Ne[nt+"ref"],dt=Ne["a"+nt+"ref"],ht=Ne["_"+nt+"padplus"],Dt=Ne["_"+nt+"padminus"],Ot={x:1,y:-1}[nt]*Ne[nt+"shift"],Rt=3*Ne.arrowsize*Ne.arrowwidth||0,Zt=Rt+Ot,er=Rt-Ot,dr=3*Ne.startarrowsize*Ne.arrowwidth||0,mr=dr+Ot,xr=dr-Ot;if(dt===ot){var br=rt.findExtremes(Ge,[Ge.r2c(at)],{ppadplus:Zt,ppadminus:er}),Ar=rt.findExtremes(Ge,[Ge.r2c(it)],{ppadplus:Math.max(ht,mr),ppadminus:Math.max(Dt,xr)});Qe={min:[br.min[0],Ar.min[0]],max:[br.max[0],Ar.max[0]]}}else mr=it?mr+it:mr,xr=it?xr-it:xr,Qe=rt.findExtremes(Ge,[Ge.r2c(at)],{ppadplus:Math.max(ht,Zt,mr),ppadminus:Math.max(Dt,er,xr)});Ne._extremes[tt]=Qe}Ge.exports=function(Ne){var Ge=Ne._fullLayout;if(tt.filterVisible(Ge.annotations).length&&Ne._fullData.length)return tt.syncOrAsync([nt,annAutorange],Ne)}},{"../../lib":778,"../../plots/cartesian/axes":828,"./draw":632}],628:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../registry"),nt=Ne("../../plot_api/plot_template").arrayEditor;function hasClickToShow(Ne,Ge){var Qe=getToggleSets(Ne,Ge);return Qe.on.length>0||Qe.explicitOff.length>0}function onClick(Ne,Ge){var Qe,at,it=getToggleSets(Ne,Ge),ot=it.on,dt=it.off.concat(it.explicitOff),ht={},Dt=Ne._fullLayout.annotations;if(ot.length||dt.length){for(Qe=0;Qe<ot.length;Qe++)(at=nt(Ne.layout,"annotations",Dt[ot[Qe]])).modifyItem("visible",!0),tt.extendFlat(ht,at.getUpdateObj());for(Qe=0;Qe<dt.length;Qe++)(at=nt(Ne.layout,"annotations",Dt[dt[Qe]])).modifyItem("visible",!1),tt.extendFlat(ht,at.getUpdateObj());return rt.call("update",Ne,{},ht)}}function getToggleSets(Ne,Ge){var Qe,tt,rt,nt,at,it,ot,dt=Ne._fullLayout.annotations,ht=[],Dt=[],Ot=[],Rt=(Ge||[]).length;for(Qe=0;Qe<dt.length;Qe++)if(nt=(rt=dt[Qe]).clicktoshow){for(tt=0;tt<Rt;tt++)if(it=(at=Ge[tt]).xaxis,ot=at.yaxis,it._id===rt.xref&&ot._id===rt.yref&&it.d2r(at.x)===clickData2r(rt._xclick,it)&&ot.d2r(at.y)===clickData2r(rt._yclick,ot)){(rt.visible?"onout"===nt?Dt:Ot:ht).push(Qe);break}tt===Rt&&rt.visible&&"onout"===nt&&Dt.push(Qe)}return{on:ht,off:Dt,explicitOff:Ot}}function clickData2r(Ne,Ge){return"log"===Ge.type?Ge.l2r(Ne):Ge.d2r(Ne)}Ge.exports={hasClickToShow:hasClickToShow,onClick:onClick}},{"../../lib":778,"../../plot_api/plot_template":817,"../../registry":911}],629:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../color");Ge.exports=function(Ne,Ge,Qe,nt){nt("opacity");var at=nt("bgcolor"),it=nt("bordercolor"),ot=rt.opacity(it);nt("borderpad");var dt=nt("borderwidth"),ht=nt("showarrow");if(nt("text",ht?" ":Qe._dfltTitle.annotation),nt("textangle"),tt.coerceFont(nt,"font",Qe.font),nt("width"),nt("align"),nt("height")&&nt("valign"),ht){var Dt,Ot,Rt=nt("arrowside");-1!==Rt.indexOf("end")&&(Dt=nt("arrowhead"),Ot=nt("arrowsize")),-1!==Rt.indexOf("start")&&(nt("startarrowhead",Dt),nt("startarrowsize",Ot)),nt("arrowcolor",ot?Ge.bordercolor:rt.defaultLine),nt("arrowwidth",2*(ot&&dt||1)),nt("standoff"),nt("startstandoff")}var Zt=nt("hovertext"),er=Qe.hoverlabel||{};if(Zt){var dr=nt("hoverlabel.bgcolor",er.bgcolor||(rt.opacity(at)?rt.rgb(at):rt.defaultLine)),mr=nt("hoverlabel.bordercolor",er.bordercolor||rt.contrast(dr));tt.coerceFont(nt,"hoverlabel.font",{family:er.font.family,size:er.font.size,color:er.font.color||mr})}nt("captureevents",!!Zt)}},{"../../lib":778,"../color":643}],630:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../lib/to_log_range");Ge.exports=function(Ne,Ge,Qe,nt){Ge=Ge||{};var at="log"===Qe&&"linear"===Ge.type,it="linear"===Qe&&"log"===Ge.type;if(at||it)for(var ot,dt,ht=Ne._fullLayout.annotations,Dt=Ge._id.charAt(0),Ot=0;Ot<ht.length;Ot++)ot=ht[Ot],dt="annotations["+Ot+"].",ot[Dt+"ref"]===Ge._id&&convert(Dt),ot["a"+Dt+"ref"]===Ge._id&&convert("a"+Dt);function convert(Ne){var Qe=ot[Ne],it=null;it=at?rt(Qe,Ge.range):Math.pow(10,Qe),tt(it)||(it=null),nt(dt+Ne,it)}}},{"../../lib/to_log_range":805,"fast-isnumeric":241}],631:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../plots/cartesian/axes"),nt=Ne("../../plots/array_container_defaults"),at=Ne("./common_defaults"),it=Ne("./attributes");function handleAnnotationDefaults(Ne,Ge,Qe){function coerce(Qe,rt){return tt.coerce(Ne,Ge,it,Qe,rt)}var nt=coerce("visible"),ot=coerce("clicktoshow");if(nt||ot){at(Ne,Ge,Qe,coerce);for(var dt=Ge.showarrow,ht=["x","y"],Dt=[-10,-30],Ot={_fullLayout:Qe},Rt=0;Rt<2;Rt++){var Zt=ht[Rt],er=rt.coerceRef(Ne,Ge,Ot,Zt,"","paper");if("paper"!==er&&rt.getFromId(Ot,er)._annIndices.push(Ge._index),rt.coercePosition(Ge,Ot,coerce,er,Zt,.5),dt){var dr="a"+Zt,mr=rt.coerceRef(Ne,Ge,Ot,dr,"pixel",["pixel","paper"]);"pixel"!==mr&&mr!==er&&(mr=Ge[dr]="pixel");var xr="pixel"===mr?Dt[Rt]:.4;rt.coercePosition(Ge,Ot,coerce,mr,dr,xr)}coerce(Zt+"anchor"),coerce(Zt+"shift")}if(tt.noneOrAll(Ne,Ge,["x","y"]),dt&&tt.noneOrAll(Ne,Ge,["ax","ay"]),ot){var br=coerce("xclick"),Ar=coerce("yclick");Ge._xclick=void 0===br?Ge.x:rt.cleanPosition(br,Ot,Ge.xref),Ge._yclick=void 0===Ar?Ge.y:rt.cleanPosition(Ar,Ot,Ge.yref)}}}Ge.exports=function(Ne,Ge){nt(Ne,Ge,{name:"annotations",handleItemDefaults:handleAnnotationDefaults})}},{"../../lib":778,"../../plots/array_container_defaults":823,"../../plots/cartesian/axes":828,"./attributes":626,"./common_defaults":629}],632:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../registry"),nt=Ne("../../plots/plots"),at=Ne("../../lib"),it=at.strTranslate,ot=Ne("../../plots/cartesian/axes"),dt=Ne("../color"),ht=Ne("../drawing"),Dt=Ne("../fx"),Ot=Ne("../../lib/svg_text_utils"),Rt=Ne("../../lib/setcursor"),Zt=Ne("../dragelement"),er=Ne("../../plot_api/plot_template").arrayEditor,dr=Ne("./draw_arrow_head");function draw(Ne){var Ge=Ne._fullLayout;Ge._infolayer.selectAll(".annotation").remove();for(var Qe=0;Qe<Ge.annotations.length;Qe++)Ge.annotations[Qe].visible&&drawOne(Ne,Qe);return nt.previousPromises(Ne)}function drawOne(Ne,Ge){var Qe=Ne._fullLayout.annotations[Ge]||{},tt=ot.getFromId(Ne,Qe.xref),rt=ot.getFromId(Ne,Qe.yref);tt&&tt.setScale(),rt&&rt.setScale(),drawRaw(Ne,Qe,Ge,!1,tt,rt)}function shiftPosition(Ne,Ge,Qe,tt,rt){var nt=rt[Qe],at=rt[Qe+"ref"],it=-1!==Qe.indexOf("y"),dt="domain"===ot.getRefType(at),ht=it?tt.h:tt.w;return Ne?dt?nt+(it?-Ge:Ge)/Ne._length:Ne.p2r(Ne.r2p(nt)+Ge):nt+(it?-Ge:Ge)/ht}function drawRaw(Ne,Ge,Qe,nt,mr,xr){var br,Ar,en=Ne._fullLayout,mn=Ne._fullLayout._size,xn=Ne._context.edits;nt?(br="annotation-"+nt,Ar=nt+".annotations"):(br="annotation",Ar="annotations");var kn=er(Ne.layout,Ar,Ge),Cn=kn.modifyBase,En=kn.modifyItem,Pn=kn.getUpdateObj;en._infolayer.selectAll("."+br+'[data-index="'+Qe+'"]').remove();var Dn="clip"+en._uid+"_ann"+Qe;if(Ge._input&&!1!==Ge.visible){var In={x:{},y:{}},zn=+Ge.textangle||0,Bn=en._infolayer.append("g").classed(br,!0).attr("data-index",String(Qe)).style("opacity",Ge.opacity),Vn=Bn.append("g").classed("annotation-text-g",!0),Hn=xn[Ge.showarrow?"annotationTail":"annotationPosition"],qn=Ge.captureevents||xn.annotationText||Hn,Yn=Vn.append("g").style("pointer-events",qn?"all":null).call(Rt,"pointer").on("click",(function(){Ne._dragging=!1,Ne.emit("plotly_clickannotation",makeEventData(tt.event))}));Ge.hovertext&&Yn.on("mouseover",(function(){var Qe=Ge.hoverlabel,tt=Qe.font,rt=this.getBoundingClientRect(),nt=Ne.getBoundingClientRect();Dt.loneHover({x0:rt.left-nt.left,x1:rt.right-nt.left,y:(rt.top+rt.bottom)/2-nt.top,text:Ge.hovertext,color:Qe.bgcolor,borderColor:Qe.bordercolor,fontFamily:tt.family,fontSize:tt.size,fontColor:tt.color},{container:en._hoverlayer.node(),outerContainer:en._paper.node(),gd:Ne})})).on("mouseout",(function(){Dt.loneUnhover(en._hoverlayer.node())}));var $n=Ge.borderwidth,ra=Ge.borderpad,oa=$n+ra,pa=Yn.append("rect").attr("class","bg").style("stroke-width",$n+"px").call(dt.stroke,Ge.bordercolor).call(dt.fill,Ge.bgcolor),ga=Ge.width||Ge.height,ma=en._topclips.selectAll("#"+Dn).data(ga?[0]:[]);ma.enter().append("clipPath").classed("annclip",!0).attr("id",Dn).append("rect"),ma.exit().remove();var _a=Ge.font,Va=en._meta?at.templateString(Ge.text,en._meta):Ge.text,Wa=Yn.append("text").classed("annotation-text",!0).text(Va);xn.annotationText?Wa.call(Ot.makeEditable,{delegate:Yn,gd:Ne}).call(textLayout).on("edit",(function(Qe){Ge.text=Qe,this.call(textLayout),En("text",Qe),mr&&mr.autorange&&Cn(mr._name+".autorange",!0),xr&&xr.autorange&&Cn(xr._name+".autorange",!0),rt.call("_guiRelayout",Ne,Pn())})):Wa.call(textLayout)}else tt.selectAll("#"+Dn).remove();function makeEventData(Ne){var tt={index:Qe,annotation:Ge._input,fullAnnotation:Ge,event:Ne};return nt&&(tt.subplotId=nt),tt}function textLayout(Qe){return Qe.call(ht.font,_a).attr({"text-anchor":{left:"start",right:"end"}[Ge.align]||"middle"}),Ot.convertToTspans(Qe,Ne,drawGraphicalElements),Qe}function drawGraphicalElements(){var Qe=Wa.selectAll("a");1===Qe.size()&&Qe.text()===Wa.text()&&Yn.insert("a",":first-child").attr({"xlink:xlink:href":Qe.attr("xlink:href"),"xlink:xlink:show":Qe.attr("xlink:show")}).style({cursor:"pointer"}).node().appendChild(pa.node());var tt=Yn.select(".annotation-text-math-group"),Dt=!tt.empty(),er=ht.bBox((Dt?tt:Wa).node()),br=er.width,Ar=er.height,kn=Ge.width||br,qn=Ge.height||Ar,ra=Math.round(kn+2*oa),_a=Math.round(qn+2*oa);function shiftFraction(Ne,Ge){return"auto"===Ge&&(Ge=Ne<1/3?"left":Ne>2/3?"right":"center"),{center:0,middle:0,left:.5,bottom:-.5,right:-.5,top:.5}[Ge]}for(var Va=!1,Qa=["x","y"],ti=0;ti<Qa.length;ti++){var ni,di,ji,Hi,Yi,uo=Qa[ti],go=Ge[uo+"ref"]||uo,ns=Ge["a"+uo+"ref"],as={x:mr,y:xr}[uo],is=(zn+("x"===uo?0:-90))*Math.PI/180,os=ra*Math.cos(is),ss=_a*Math.sin(is),cs=Math.abs(os)+Math.abs(ss),ds=Ge[uo+"anchor"],ms=Ge[uo+"shift"]*("x"===uo?1:-1),vs=In[uo],_s=ot.getRefType(go);if(as&&"domain"!==_s){var ws=as.r2fraction(Ge[uo]);(ws<0||ws>1)&&(ns===go?((ws=as.r2fraction(Ge["a"+uo]))<0||ws>1)&&(Va=!0):Va=!0),ni=as._offset+as.r2p(Ge[uo]),Hi=.5}else{var Ts="domain"===_s;"x"===uo?(ji=Ge[uo],ni=Ts?as._offset+as._length*ji:ni=mn.l+mn.w*ji):(ji=1-Ge[uo],ni=Ts?as._offset+as._length*ji:ni=mn.t+mn.h*ji),Hi=Ge.showarrow?.5:ji}if(Ge.showarrow){vs.head=ni;var ks=Ge["a"+uo];if(Yi=os*shiftFraction(.5,Ge.xanchor)-ss*shiftFraction(.5,Ge.yanchor),ns===go){var Cs=ot.getRefType(ns);"domain"===Cs?("y"===uo&&(ks=1-ks),vs.tail=as._offset+as._length*ks):"paper"===Cs?"y"===uo?(ks=1-ks,vs.tail=mn.t+mn.h*ks):vs.tail=mn.l+mn.w*ks:vs.tail=as._offset+as.r2p(ks),di=Yi}else vs.tail=ni+ks,di=Yi+ks;vs.text=vs.tail+Yi;var Es=en["x"===uo?"width":"height"];if("paper"===go&&(vs.head=at.constrain(vs.head,1,Es-1)),"pixel"===ns){var Ls=-Math.max(vs.tail-3,vs.text),Ps=Math.min(vs.tail+3,vs.text)-Es;Ls>0?(vs.tail+=Ls,vs.text+=Ls):Ps>0&&(vs.tail-=Ps,vs.text-=Ps)}vs.tail+=ms,vs.head+=ms}else di=Yi=cs*shiftFraction(Hi,ds),vs.text=ni+Yi;vs.text+=ms,Yi+=ms,di+=ms,Ge["_"+uo+"padplus"]=cs/2+di,Ge["_"+uo+"padminus"]=cs/2-di,Ge["_"+uo+"size"]=cs,Ge["_"+uo+"shift"]=Yi}if(Va)Yn.remove();else{var Ds=0,Is=0;if("left"!==Ge.align&&(Ds=(kn-br)*("center"===Ge.align?.5:1)),"top"!==Ge.valign&&(Is=(qn-Ar)*("middle"===Ge.valign?.5:1)),Dt)tt.select("svg").attr({x:oa+Ds-1,y:oa+Is}).call(ht.setClipUrl,ga?Dn:null,Ne);else{var Os=oa+Is-er.top,zs=oa+Ds-er.left;Wa.call(Ot.positionText,zs,Os).call(ht.setClipUrl,ga?Dn:null,Ne)}ma.select("rect").call(ht.setRect,oa,oa,kn,qn),pa.call(ht.setRect,$n/2,$n/2,ra-$n,_a-$n),Yn.call(ht.setTranslate,Math.round(In.x.text-ra/2),Math.round(In.y.text-_a/2)),Vn.attr({transform:"rotate("+zn+","+In.x.text+","+In.y.text+")"});var Rs,drawArrow=function(Qe,tt){Bn.selectAll(".annotation-arrow-g").remove();var ot=In.x.head,Dt=In.y.head,Ot=In.x.tail+Qe,Rt=In.y.tail+tt,er=In.x.text+Qe,br=In.y.text+tt,Ar=at.rotationXYMatrix(zn,er,br),en=at.apply2DTransform(Ar),kn=at.apply2DTransform2(Ar),Dn=+pa.attr("width"),Hn=+pa.attr("height"),qn=er-.5*Dn,$n=qn+Dn,ra=br-.5*Hn,oa=ra+Hn,ga=[[qn,ra,qn,oa],[qn,oa,$n,oa],[$n,oa,$n,ra],[$n,ra,qn,ra]].map(kn);if(!ga.reduce((function(Ne,Ge){return Ne^!!at.segmentsIntersect(ot,Dt,ot+1e6,Dt+1e6,Ge[0],Ge[1],Ge[2],Ge[3])}),!1)){ga.forEach((function(Ne){var Ge=at.segmentsIntersect(Ot,Rt,ot,Dt,Ne[0],Ne[1],Ne[2],Ne[3]);Ge&&(Ot=Ge.x,Rt=Ge.y)}));var ma=Ge.arrowwidth,_a=Ge.arrowcolor,Va=Ge.arrowside,Wa=Bn.append("g").style({opacity:dt.opacity(_a)}).classed("annotation-arrow-g",!0),Qa=Wa.append("path").attr("d","M"+Ot+","+Rt+"L"+ot+","+Dt).style("stroke-width",ma+"px").call(dt.stroke,dt.rgb(_a));if(dr(Qa,Va,Ge),xn.annotationPosition&&Qa.node().parentNode&&!nt){var ti=ot,ni=Dt;if(Ge.standoff){var di=Math.sqrt(Math.pow(ot-Ot,2)+Math.pow(Dt-Rt,2));ti+=Ge.standoff*(Ot-ot)/di,ni+=Ge.standoff*(Rt-Dt)/di}var ji,Hi,Yi=Wa.append("path").classed("annotation-arrow",!0).classed("anndrag",!0).classed("cursor-move",!0).attr({d:"M3,3H-3V-3H3ZM0,0L"+(Ot-ti)+","+(Rt-ni),transform:it(ti,ni)}).style("stroke-width",ma+6+"px").call(dt.stroke,"rgba(0,0,0,0)").call(dt.fill,"rgba(0,0,0,0)");Zt.init({element:Yi.node(),gd:Ne,prepFn:function(){var Ne=ht.getTranslate(Yn);ji=Ne.x,Hi=Ne.y,mr&&mr.autorange&&Cn(mr._name+".autorange",!0),xr&&xr.autorange&&Cn(xr._name+".autorange",!0)},moveFn:function(Ne,Qe){var tt=en(ji,Hi),rt=tt[0]+Ne,nt=tt[1]+Qe;Yn.call(ht.setTranslate,rt,nt),En("x",shiftPosition(mr,Ne,"x",mn,Ge)),En("y",shiftPosition(xr,Qe,"y",mn,Ge)),Ge.axref===Ge.xref&&En("ax",shiftPosition(mr,Ne,"ax",mn,Ge)),Ge.ayref===Ge.yref&&En("ay",shiftPosition(xr,Qe,"ay",mn,Ge)),Wa.attr("transform",it(Ne,Qe)),Vn.attr({transform:"rotate("+zn+","+rt+","+nt+")"})},doneFn:function(){rt.call("_guiRelayout",Ne,Pn());var Ge=document.querySelector(".js-notes-box-panel");Ge&&Ge.redraw(Ge.selectedObj)}})}}};Ge.showarrow&&drawArrow(0,0),Hn&&Zt.init({element:Yn.node(),gd:Ne,prepFn:function(){Rs=Vn.attr("transform")},moveFn:function(Ne,Qe){var tt="pointer";if(Ge.showarrow)Ge.axref===Ge.xref?En("ax",shiftPosition(mr,Ne,"ax",mn,Ge)):En("ax",Ge.ax+Ne),Ge.ayref===Ge.yref?En("ay",shiftPosition(xr,Qe,"ay",mn.w,Ge)):En("ay",Ge.ay+Qe),drawArrow(Ne,Qe);else{if(nt)return;var rt,at;if(mr)rt=shiftPosition(mr,Ne,"x",mn,Ge);else{var ot=Ge._xsize/mn.w,dt=Ge.x+(Ge._xshift-Ge.xshift)/mn.w-ot/2;rt=Zt.align(dt+Ne/mn.w,ot,0,1,Ge.xanchor)}if(xr)at=shiftPosition(xr,Qe,"y",mn,Ge);else{var ht=Ge._ysize/mn.h,Dt=Ge.y-(Ge._yshift+Ge.yshift)/mn.h-ht/2;at=Zt.align(Dt-Qe/mn.h,ht,0,1,Ge.yanchor)}En("x",rt),En("y",at),mr&&xr||(tt=Zt.getCursor(mr?.5:rt,xr?.5:at,Ge.xanchor,Ge.yanchor))}Vn.attr({transform:it(Ne,Qe)+Rs}),Rt(Yn,tt)},clickFn:function(Qe,tt){Ge.captureevents&&Ne.emit("plotly_clickannotation",makeEventData(tt))},doneFn:function(){Rt(Yn),rt.call("_guiRelayout",Ne,Pn());var Ge=document.querySelector(".js-notes-box-panel");Ge&&Ge.redraw(Ge.selectedObj)}})}}}Ge.exports={draw:draw,drawOne:drawOne,drawRaw:drawRaw}},{"../../lib":778,"../../lib/setcursor":799,"../../lib/svg_text_utils":803,"../../plot_api/plot_template":817,"../../plots/cartesian/axes":828,"../../plots/plots":891,"../../registry":911,"../color":643,"../dragelement":662,"../drawing":665,"../fx":683,"./draw_arrow_head":633,d3:169}],633:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../color"),nt=Ne("./arrow_paths"),at=Ne("../../lib"),it=at.strScale,ot=at.strRotate,dt=at.strTranslate;Ge.exports=function(Ne,Ge,Qe){var at,ht,Dt,Ot,Rt=Ne.node(),Zt=nt[Qe.arrowhead||0],er=nt[Qe.startarrowhead||0],dr=(Qe.arrowwidth||1)*(Qe.arrowsize||1),mr=(Qe.arrowwidth||1)*(Qe.startarrowsize||1),xr=Ge.indexOf("start")>=0,br=Ge.indexOf("end")>=0,Ar=Zt.backoff*dr+Qe.standoff,en=er.backoff*mr+Qe.startstandoff;if("line"===Rt.nodeName){at={x:+Ne.attr("x1"),y:+Ne.attr("y1")},ht={x:+Ne.attr("x2"),y:+Ne.attr("y2")};var mn=at.x-ht.x,xn=at.y-ht.y;if(Ot=(Dt=Math.atan2(xn,mn))+Math.PI,Ar&&en&&Ar+en>Math.sqrt(mn*mn+xn*xn))return void hideLine();if(Ar){if(Ar*Ar>mn*mn+xn*xn)return void hideLine();var kn=Ar*Math.cos(Dt),Cn=Ar*Math.sin(Dt);ht.x+=kn,ht.y+=Cn,Ne.attr({x2:ht.x,y2:ht.y})}if(en){if(en*en>mn*mn+xn*xn)return void hideLine();var En=en*Math.cos(Dt),Pn=en*Math.sin(Dt);at.x-=En,at.y-=Pn,Ne.attr({x1:at.x,y1:at.y})}}else if("path"===Rt.nodeName){var Dn=Rt.getTotalLength(),In="";if(Dn<Ar+en)return void hideLine();var zn=Rt.getPointAtLength(0),Bn=Rt.getPointAtLength(.1);Dt=Math.atan2(zn.y-Bn.y,zn.x-Bn.x),at=Rt.getPointAtLength(Math.min(en,Dn)),In="0px,"+en+"px,";var Vn=Rt.getPointAtLength(Dn),Hn=Rt.getPointAtLength(Dn-.1);Ot=Math.atan2(Vn.y-Hn.y,Vn.x-Hn.x),ht=Rt.getPointAtLength(Math.max(0,Dn-Ar)),In+=Dn-(In?en+Ar:Ar)+"px,"+Dn+"px",Ne.style("stroke-dasharray",In)}function hideLine(){Ne.style("stroke-dasharray","0px,100px")}function drawhead(Ge,nt,at,ht){Ge.path&&(Ge.noRotate&&(at=0),tt.select(Rt.parentNode).append("path").attr({class:Ne.attr("class"),d:Ge.path,transform:dt(nt.x,nt.y)+ot(180*at/Math.PI)+it(ht)}).style({fill:rt.rgb(Qe.arrowcolor),"stroke-width":0}))}xr&&drawhead(er,at,Dt,mr),br&&drawhead(Zt,ht,Ot,dr)}},{"../../lib":778,"../color":643,"./arrow_paths":625,d3:169}],634:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./draw"),rt=Ne("./click");Ge.exports={moduleType:"component",name:"annotations",layoutAttributes:Ne("./attributes"),supplyLayoutDefaults:Ne("./defaults"),includeBasePlot:Ne("../../plots/cartesian/include_components")("annotations"),calcAutorange:Ne("./calc_autorange"),draw:tt.draw,drawOne:tt.drawOne,drawRaw:tt.drawRaw,hasClickToShow:rt.hasClickToShow,onClick:rt.onClick,convertCoords:Ne("./convert_coords")}},{"../../plots/cartesian/include_components":840,"./attributes":626,"./calc_autorange":627,"./click":628,"./convert_coords":630,"./defaults":631,"./draw":632}],635:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../annotations/attributes"),rt=Ne("../../plot_api/edit_types").overrideAll,nt=Ne("../../plot_api/plot_template").templatedArray;Ge.exports=rt(nt("annotation",{visible:tt.visible,x:{valType:"any"},y:{valType:"any"},z:{valType:"any"},ax:{valType:"number"},ay:{valType:"number"},xanchor:tt.xanchor,xshift:tt.xshift,yanchor:tt.yanchor,yshift:tt.yshift,text:tt.text,textangle:tt.textangle,font:tt.font,width:tt.width,height:tt.height,opacity:tt.opacity,align:tt.align,valign:tt.valign,bgcolor:tt.bgcolor,bordercolor:tt.bordercolor,borderpad:tt.borderpad,borderwidth:tt.borderwidth,showarrow:tt.showarrow,arrowcolor:tt.arrowcolor,arrowhead:tt.arrowhead,startarrowhead:tt.startarrowhead,arrowside:tt.arrowside,arrowsize:tt.arrowsize,startarrowsize:tt.startarrowsize,arrowwidth:tt.arrowwidth,standoff:tt.standoff,startstandoff:tt.startstandoff,hovertext:tt.hovertext,hoverlabel:tt.hoverlabel,captureevents:tt.captureevents}),"calc","from-root")},{"../../plot_api/edit_types":810,"../../plot_api/plot_template":817,"../annotations/attributes":626}],636:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../plots/cartesian/axes");function mockAnnAxes(Ne,Ge){var Qe=Ge.fullSceneLayout.domain,nt=Ge.fullLayout._size,at={pdata:null,type:"linear",autorange:!1,range:[-1/0,1/0]};Ne._xa={},tt.extendFlat(Ne._xa,at),rt.setConvert(Ne._xa),Ne._xa._offset=nt.l+Qe.x[0]*nt.w,Ne._xa.l2p=function(){return.5*(1+Ne._pdata[0]/Ne._pdata[3])*nt.w*(Qe.x[1]-Qe.x[0])},Ne._ya={},tt.extendFlat(Ne._ya,at),rt.setConvert(Ne._ya),Ne._ya._offset=nt.t+(1-Qe.y[1])*nt.h,Ne._ya.l2p=function(){return.5*(1-Ne._pdata[1]/Ne._pdata[3])*nt.h*(Qe.y[1]-Qe.y[0])}}Ge.exports=function(Ne){for(var Ge=Ne.fullSceneLayout.annotations,Qe=0;Qe<Ge.length;Qe++)mockAnnAxes(Ge[Qe],Ne);Ne.fullLayout._infolayer.selectAll(".annotation-"+Ne.id).remove()}},{"../../lib":778,"../../plots/cartesian/axes":828}],637:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../plots/cartesian/axes"),nt=Ne("../../plots/array_container_defaults"),at=Ne("../annotations/common_defaults"),it=Ne("./attributes");function handleAnnotationDefaults(Ne,Ge,Qe,nt){function coerce(Qe,rt){return tt.coerce(Ne,Ge,it,Qe,rt)}function coercePosition(Ne){var tt=Ne+"axis",nt={_fullLayout:{}};return nt._fullLayout[tt]=Qe[tt],rt.coercePosition(Ge,nt,coerce,Ne,Ne,.5)}coerce("visible")&&(at(Ne,Ge,nt.fullLayout,coerce),coercePosition("x"),coercePosition("y"),coercePosition("z"),tt.noneOrAll(Ne,Ge,["x","y","z"]),Ge.xref="x",Ge.yref="y",Ge.zref="z",coerce("xanchor"),coerce("yanchor"),coerce("xshift"),coerce("yshift"),Ge.showarrow&&(Ge.axref="pixel",Ge.ayref="pixel",coerce("ax",-10),coerce("ay",-30),tt.noneOrAll(Ne,Ge,["ax","ay"])))}Ge.exports=function(Ne,Ge,Qe){nt(Ne,Ge,{name:"annotations",handleItemDefaults:handleAnnotationDefaults,fullLayout:Qe.fullLayout})}},{"../../lib":778,"../../plots/array_container_defaults":823,"../../plots/cartesian/axes":828,"../annotations/common_defaults":629,"./attributes":635}],638:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../annotations/draw").drawRaw,rt=Ne("../../plots/gl3d/project"),nt=["x","y","z"];Ge.exports=function(Ne){for(var Ge=Ne.fullSceneLayout,Qe=Ne.dataScale,at=Ge.annotations,it=0;it<at.length;it++){for(var ot=at[it],dt=!1,ht=0;ht<3;ht++){var Dt=nt[ht],Ot=ot[Dt],Rt=Ge[Dt+"axis"].r2fraction(Ot);if(Rt<0||Rt>1){dt=!0;break}}dt?Ne.fullLayout._infolayer.select(".annotation-"+Ne.id+'[data-index="'+it+'"]').remove():(ot._pdata=rt(Ne.glplot.cameraParams,[Ge.xaxis.r2l(ot.x)*Qe[0],Ge.yaxis.r2l(ot.y)*Qe[1],Ge.zaxis.r2l(ot.z)*Qe[2]]),tt(Ne.graphDiv,ot,it,Ne.id,ot._xa,ot._ya))}}},{"../../plots/gl3d/project":879,"../annotations/draw":632}],639:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../registry"),rt=Ne("../../lib");function includeGL3D(Ne,Ge){var Qe=tt.subplotsRegistry.gl3d;if(Qe)for(var nt=Qe.attrRegex,at=Object.keys(Ne),it=0;it<at.length;it++){var ot=at[it];nt.test(ot)&&(Ne[ot].annotations||[]).length&&(rt.pushUnique(Ge._basePlotModules,Qe),rt.pushUnique(Ge._subplots.gl3d,ot))}}Ge.exports={moduleType:"component",name:"annotations3d",schema:{subplots:{scene:{annotations:Ne("./attributes")}}},layoutAttributes:Ne("./attributes"),handleDefaults:Ne("./defaults"),includeBasePlot:includeGL3D,convert:Ne("./convert"),draw:Ne("./draw")}},{"../../lib":778,"../../registry":911,"./attributes":635,"./convert":636,"./defaults":637,"./draw":638}],640:[function(Ne,Ge,Qe){"use strict";Ge.exports=Ne("world-calendars/dist/main"),Ne("world-calendars/dist/plus"),Ne("world-calendars/dist/calendars/chinese"),Ne("world-calendars/dist/calendars/coptic"),Ne("world-calendars/dist/calendars/discworld"),Ne("world-calendars/dist/calendars/ethiopian"),Ne("world-calendars/dist/calendars/hebrew"),Ne("world-calendars/dist/calendars/islamic"),Ne("world-calendars/dist/calendars/julian"),Ne("world-calendars/dist/calendars/mayan"),Ne("world-calendars/dist/calendars/nanakshahi"),Ne("world-calendars/dist/calendars/nepali"),Ne("world-calendars/dist/calendars/persian"),Ne("world-calendars/dist/calendars/taiwan"),Ne("world-calendars/dist/calendars/thai"),Ne("world-calendars/dist/calendars/ummalqura")},{"world-calendars/dist/calendars/chinese":607,"world-calendars/dist/calendars/coptic":608,"world-calendars/dist/calendars/discworld":609,"world-calendars/dist/calendars/ethiopian":610,"world-calendars/dist/calendars/hebrew":611,"world-calendars/dist/calendars/islamic":612,"world-calendars/dist/calendars/julian":613,"world-calendars/dist/calendars/mayan":614,"world-calendars/dist/calendars/nanakshahi":615,"world-calendars/dist/calendars/nepali":616,"world-calendars/dist/calendars/persian":617,"world-calendars/dist/calendars/taiwan":618,"world-calendars/dist/calendars/thai":619,"world-calendars/dist/calendars/ummalqura":620,"world-calendars/dist/main":621,"world-calendars/dist/plus":622}],641:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./calendars"),rt=Ne("../../lib"),nt=Ne("../../constants/numerical"),at=nt.EPOCHJD,it=nt.ONEDAY,ot={valType:"enumerated",values:Object.keys(tt.calendars),editType:"calc",dflt:"gregorian"},handleDefaults=function(Ne,Ge,Qe,tt){var nt={};return nt[Qe]=ot,rt.coerce(Ne,Ge,nt,Qe,tt)},handleTraceDefaults=function(Ne,Ge,Qe,tt){for(var rt=0;rt<Qe.length;rt++)handleDefaults(Ne,Ge,Qe[rt]+"calendar",tt.calendar)},dt={chinese:"2000-01-01",coptic:"2000-01-01",discworld:"2000-01-01",ethiopian:"2000-01-01",hebrew:"5000-01-01",islamic:"1000-01-01",julian:"2000-01-01",mayan:"5000-01-01",nanakshahi:"1000-01-01",nepali:"2000-01-01",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-01",thai:"2000-01-01",ummalqura:"1400-01-01"},ht={chinese:"2000-01-02",coptic:"2000-01-03",discworld:"2000-01-03",ethiopian:"2000-01-05",hebrew:"5000-01-01",islamic:"1000-01-02",julian:"2000-01-03",mayan:"5000-01-01",nanakshahi:"1000-01-05",nepali:"2000-01-05",persian:"1000-01-01",jalali:"1000-01-01",taiwan:"1000-01-04",thai:"2000-01-04",ummalqura:"1400-01-06"},Dt={chinese:["2000-01-01","2001-01-01"],coptic:["1700-01-01","1701-01-01"],discworld:["1800-01-01","1801-01-01"],ethiopian:["2000-01-01","2001-01-01"],hebrew:["5700-01-01","5701-01-01"],islamic:["1400-01-01","1401-01-01"],julian:["2000-01-01","2001-01-01"],mayan:["5200-01-01","5201-01-01"],nanakshahi:["0500-01-01","0501-01-01"],nepali:["2000-01-01","2001-01-01"],persian:["1400-01-01","1401-01-01"],jalali:["1400-01-01","1401-01-01"],taiwan:["0100-01-01","0101-01-01"],thai:["2500-01-01","2501-01-01"],ummalqura:["1400-01-01","1401-01-01"]},Ot="##",Rt={d:{0:"dd","-":"d"},e:{0:"d","-":"d"},a:{0:"D","-":"D"},A:{0:"DD","-":"DD"},j:{0:"oo","-":"o"},W:{0:"ww","-":"w"},m:{0:"mm","-":"m"},b:{0:"M","-":"M"},B:{0:"MM","-":"MM"},y:{0:"yy","-":"yy"},Y:{0:"yyyy","-":"yyyy"},U:Ot,w:Ot,c:{0:"D M d %X yyyy","-":"D M d %X yyyy"},x:{0:"mm/dd/yyyy","-":"mm/dd/yyyy"}};function worldCalFmt(Ne,Ge,Qe){for(var tt,rt,nt,ot,dt,ht=Math.floor((Ge+.05)/it)+at,Dt=getCal(Qe).fromJD(ht),Zt=0;-1!==(Zt=Ne.indexOf("%",Zt));)"0"===(tt=Ne.charAt(Zt+1))||"-"===tt||"_"===tt?(nt=3,rt=Ne.charAt(Zt+2),"_"===tt&&(tt="-")):(rt=tt,tt="0",nt=2),(ot=Rt[rt])?(dt=ot===Ot?Ot:Dt.formatDate(ot[tt]),Ne=Ne.substr(0,Zt)+dt+Ne.substr(Zt+nt),Zt+=dt.length):Zt+=nt;return Ne}var Zt={};function getCal(Ne){var Ge=Zt[Ne];return Ge||(Ge=Zt[Ne]=tt.instance(Ne))}function makeAttrs(Ne){return rt.extendFlat({},ot,{description:Ne})}function makeTraceAttrsDescription(Ne){return"Sets the calendar system to use with `"+Ne+"` date data."}var er={xcalendar:makeAttrs(makeTraceAttrsDescription("x"))},dr=rt.extendFlat({},er,{ycalendar:makeAttrs(makeTraceAttrsDescription("y"))}),mr=rt.extendFlat({},dr,{zcalendar:makeAttrs(makeTraceAttrsDescription("z"))}),xr=makeAttrs(["Sets the calendar system to use for `range` and `tick0`","if this is a date axis. This does not set the calendar for","interpreting data on this axis, that's specified in the trace","or via the global `layout.calendar`"].join(" "));Ge.exports={moduleType:"component",name:"calendars",schema:{traces:{scatter:dr,bar:dr,box:dr,heatmap:dr,contour:dr,histogram:dr,histogram2d:dr,histogram2dcontour:dr,scatter3d:mr,surface:mr,mesh3d:mr,scattergl:dr,ohlc:er,candlestick:er},layout:{calendar:makeAttrs(["Sets the default calendar system to use for interpreting and","displaying dates throughout the plot."].join(" "))},subplots:{xaxis:{calendar:xr},yaxis:{calendar:xr},scene:{xaxis:{calendar:xr},yaxis:{calendar:xr},zaxis:{calendar:xr}},polar:{radialaxis:{calendar:xr}}},transforms:{filter:{valuecalendar:makeAttrs(["Sets the calendar system to use for `value`, if it is a date."].join(" ")),targetcalendar:makeAttrs(["Sets the calendar system to use for `target`, if it is an","array of dates. If `target` is a string (eg *x*) we use the","corresponding trace attribute (eg `xcalendar`) if it exists,","even if `targetcalendar` is provided."].join(" "))}}},layoutAttributes:ot,handleDefaults:handleDefaults,handleTraceDefaults:handleTraceDefaults,CANONICAL_SUNDAY:ht,CANONICAL_TICK:dt,DFLTRANGE:Dt,getCal:getCal,worldCalFmt:worldCalFmt}},{"../../constants/numerical":753,"../../lib":778,"./calendars":640}],642:[function(Ne,Ge,Qe){"use strict";Qe.defaults=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],Qe.defaultLine="#444",Qe.lightLine="#eee",Qe.background="#fff",Qe.borderLine="#BEC8D9",Qe.lightFraction=1e3/11},{}],643:[function(Ne,Ge,Qe){"use strict";var tt=Ne("tinycolor2"),rt=Ne("fast-isnumeric"),nt=Ge.exports={},at=Ne("./attributes");nt.defaults=at.defaults;var it=nt.defaultLine=at.defaultLine;nt.lightLine=at.lightLine;var ot=nt.background=at.background;function cleanOne(Ne){if(rt(Ne)||"string"!=typeof Ne)return Ne;var Ge=Ne.trim();if("rgb"!==Ge.substr(0,3))return Ne;var Qe=Ge.match(/^rgba?\s*\(([^()]*)\)$/);if(!Qe)return Ne;var tt=Qe[1].trim().split(/\s*[\s,]\s*/),nt="a"===Ge.charAt(3)&&4===tt.length;if(!nt&&3!==tt.length)return Ne;for(var at=0;at<tt.length;at++){if(!tt[at].length)return Ne;if(tt[at]=Number(tt[at]),!(tt[at]>=0))return Ne;if(3===at)tt[at]>1&&(tt[at]=1);else if(tt[at]>=1)return Ne}var it=Math.round(255*tt[0])+", "+Math.round(255*tt[1])+", "+Math.round(255*tt[2]);return nt?"rgba("+it+", "+tt[3]+")":"rgb("+it+")"}nt.tinyRGB=function(Ne){var Ge=Ne.toRgb();return"rgb("+Math.round(Ge.r)+", "+Math.round(Ge.g)+", "+Math.round(Ge.b)+")"},nt.rgb=function(Ne){return nt.tinyRGB(tt(Ne))},nt.opacity=function(Ne){return Ne?tt(Ne).getAlpha():0},nt.addOpacity=function(Ne,Ge){var Qe=tt(Ne).toRgb();return"rgba("+Math.round(Qe.r)+", "+Math.round(Qe.g)+", "+Math.round(Qe.b)+", "+Ge+")"},nt.combine=function(Ne,Ge){var Qe=tt(Ne).toRgb();if(1===Qe.a)return tt(Ne).toRgbString();var rt=tt(Ge||ot).toRgb(),nt=1===rt.a?rt:{r:255*(1-rt.a)+rt.r*rt.a,g:255*(1-rt.a)+rt.g*rt.a,b:255*(1-rt.a)+rt.b*rt.a},at={r:nt.r*(1-Qe.a)+Qe.r*Qe.a,g:nt.g*(1-Qe.a)+Qe.g*Qe.a,b:nt.b*(1-Qe.a)+Qe.b*Qe.a};return tt(at).toRgbString()},nt.contrast=function(Ne,Ge,Qe){var rt=tt(Ne);return 1!==rt.getAlpha()&&(rt=tt(nt.combine(Ne,ot))),(rt.isDark()?Ge?rt.lighten(Ge):ot:Qe?rt.darken(Qe):it).toString()},nt.stroke=function(Ne,Ge){var Qe=tt(Ge);Ne.style({stroke:nt.tinyRGB(Qe),"stroke-opacity":Qe.getAlpha()})},nt.fill=function(Ne,Ge){var Qe=tt(Ge);Ne.style({fill:nt.tinyRGB(Qe),"fill-opacity":Qe.getAlpha()})},nt.clean=function(Ne){if(Ne&&"object"==typeof Ne){var Ge,Qe,tt,rt,at=Object.keys(Ne);for(Ge=0;Ge<at.length;Ge++)if(rt=Ne[tt=at[Ge]],"color"===tt.substr(tt.length-5))if(Array.isArray(rt))for(Qe=0;Qe<rt.length;Qe++)rt[Qe]=cleanOne(rt[Qe]);else Ne[tt]=cleanOne(rt);else if("colorscale"===tt.substr(tt.length-10)&&Array.isArray(rt))for(Qe=0;Qe<rt.length;Qe++)Array.isArray(rt[Qe])&&(rt[Qe][1]=cleanOne(rt[Qe][1]));else if(Array.isArray(rt)){var it=rt[0];if(!Array.isArray(it)&&it&&"object"==typeof it)for(Qe=0;Qe<rt.length;Qe++)nt.clean(rt[Qe])}else rt&&"object"==typeof rt&&nt.clean(rt)}}},{"./attributes":642,"fast-isnumeric":241,tinycolor2:576}],644:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/cartesian/layout_attributes"),rt=Ne("../../plots/font_attributes"),nt=Ne("../../lib/extend").extendFlat,at=Ne("../../plot_api/edit_types").overrideAll;Ge.exports=at({thicknessmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"pixels"},thickness:{valType:"number",min:0,dflt:30},lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",dflt:1.02,min:-2,max:3},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},xpad:{valType:"number",min:0,dflt:10},y:{valType:"number",dflt:.5,min:-2,max:3},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle"},ypad:{valType:"number",min:0,dflt:10},outlinecolor:tt.linecolor,outlinewidth:tt.linewidth,bordercolor:tt.linecolor,borderwidth:{valType:"number",min:0,dflt:0},bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)"},tickmode:tt.tickmode,nticks:tt.nticks,tick0:tt.tick0,dtick:tt.dtick,tickvals:tt.tickvals,ticktext:tt.ticktext,ticks:nt({},tt.ticks,{dflt:""}),ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside bottom","inside bottom"],dflt:"outside"},ticklen:tt.ticklen,tickwidth:tt.tickwidth,tickcolor:tt.tickcolor,showticklabels:tt.showticklabels,tickfont:rt({}),tickangle:tt.tickangle,tickformat:tt.tickformat,tickformatstops:tt.tickformatstops,tickprefix:tt.tickprefix,showtickprefix:tt.showtickprefix,ticksuffix:tt.ticksuffix,showticksuffix:tt.showticksuffix,separatethousands:tt.separatethousands,exponentformat:tt.exponentformat,minexponent:tt.minexponent,showexponent:tt.showexponent,title:{text:{valType:"string"},font:rt({}),side:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}},_deprecated:{title:{valType:"string"},titlefont:rt({}),titleside:{valType:"enumerated",values:["right","top","bottom"],dflt:"top"}}},"colorbars","from-root")},{"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/cartesian/layout_attributes":842,"../../plots/font_attributes":856}],645:[function(Ne,Ge,Qe){"use strict";Ge.exports={cn:{colorbar:"colorbar",cbbg:"cbbg",cbfill:"cbfill",cbfills:"cbfills",cbline:"cbline",cblines:"cblines",cbaxis:"cbaxis",cbtitleunshift:"cbtitleunshift",cbtitle:"cbtitle",cboutline:"cboutline",crisp:"crisp",jsPlaceholder:"js-placeholder"}}},{}],646:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../plot_api/plot_template"),nt=Ne("../../plots/cartesian/tick_value_defaults"),at=Ne("../../plots/cartesian/tick_mark_defaults"),it=Ne("../../plots/cartesian/tick_label_defaults"),ot=Ne("./attributes");Ge.exports=function(Ne,Ge,Qe){var dt=rt.newContainer(Ge,"colorbar"),ht=Ne.colorbar||{};function coerce(Ne,Ge){return tt.coerce(ht,dt,ot,Ne,Ge)}var Dt=coerce("thicknessmode");coerce("thickness","fraction"===Dt?30/(Qe.width-Qe.margin.l-Qe.margin.r):30);var Ot=coerce("lenmode");coerce("len","fraction"===Ot?1:Qe.height-Qe.margin.t-Qe.margin.b),coerce("x"),coerce("xanchor"),coerce("xpad"),coerce("y"),coerce("yanchor"),coerce("ypad"),tt.noneOrAll(ht,dt,["x","y"]),coerce("outlinecolor"),coerce("outlinewidth"),coerce("bordercolor"),coerce("borderwidth"),coerce("bgcolor");var Rt=coerce("ticklabelposition");nt(ht,dt,coerce,"linear");var Zt={outerTicks:!1,font:Qe.font};-1!==Rt.indexOf("inside")&&(Zt.bgColor="black"),it(ht,dt,coerce,"linear",Zt),at(ht,dt,coerce,"linear",Zt),coerce("title.text",Qe._dfltTitle.colorbar),tt.coerceFont(coerce,"title.font",Qe.font),coerce("title.side")}},{"../../lib":778,"../../plot_api/plot_template":817,"../../plots/cartesian/tick_label_defaults":849,"../../plots/cartesian/tick_mark_defaults":850,"../../plots/cartesian/tick_value_defaults":851,"./attributes":644}],647:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("tinycolor2"),nt=Ne("../../plots/plots"),at=Ne("../../registry"),it=Ne("../../plots/cartesian/axes"),ot=Ne("../dragelement"),dt=Ne("../../lib"),ht=dt.strTranslate,Dt=Ne("../../lib/extend").extendFlat,Ot=Ne("../../lib/setcursor"),Rt=Ne("../drawing"),Zt=Ne("../color"),er=Ne("../titles"),dr=Ne("../../lib/svg_text_utils"),mr=Ne("../colorscale/helpers").flipScale,xr=Ne("../../plots/cartesian/axis_defaults"),br=Ne("../../plots/cartesian/position_defaults"),Ar=Ne("../../plots/cartesian/layout_attributes"),en=Ne("../../constants/alignment"),mn=en.LINE_SPACING,xn=en.FROM_TL,kn=en.FROM_BR,Cn=Ne("./constants").cn;function draw(Ne){var Ge=Ne._fullLayout._infolayer.selectAll("g."+Cn.colorbar).data(makeColorBarData(Ne),(function(Ne){return Ne._id}));Ge.enter().append("g").attr("class",(function(Ne){return Ne._id})).classed(Cn.colorbar,!0),Ge.each((function(Ge){var Qe=tt.select(this);dt.ensureSingle(Qe,"rect",Cn.cbbg),dt.ensureSingle(Qe,"g",Cn.cbfills),dt.ensureSingle(Qe,"g",Cn.cblines),dt.ensureSingle(Qe,"g",Cn.cbaxis,(function(Ne){Ne.classed(Cn.crisp,!0)})),dt.ensureSingle(Qe,"g",Cn.cbtitleunshift,(function(Ne){Ne.append("g").classed(Cn.cbtitle,!0)})),dt.ensureSingle(Qe,"rect",Cn.cboutline);var rt=drawColorBar(Qe,Ge,Ne);rt&&rt.then&&(Ne._promises||[]).push(rt),Ne._context.edits.colorbarPosition&&makeEditable(Qe,Ge,Ne)})),Ge.exit().each((function(Ge){nt.autoMargin(Ne,Ge._id)})).remove(),Ge.order()}function makeColorBarData(Ne){var Ge,Qe,tt,rt,nt=Ne._fullLayout,at=Ne.calcdata,it=[];function initOpts(Ne){return Dt(Ne,{_fillcolor:null,_line:{color:null,width:null,dash:null},_levels:{start:null,end:null,size:null},_filllevels:null,_fillgradient:null,_zrange:null})}function calcOpts(){"function"==typeof rt.calc?rt.calc(Ne,tt,Ge):(Ge._fillgradient=Qe.reversescale?mr(Qe.colorscale):Qe.colorscale,Ge._zrange=[Qe[rt.min],Qe[rt.max]])}for(var ot=0;ot<at.length;ot++){var dt=at[ot],ht=(tt=dt[0].trace)._module.colorbar;if(!0===tt.visible&&ht)for(var Ot=Array.isArray(ht),Rt=Ot?ht:[ht],Zt=0;Zt<Rt.length;Zt++){var er=(rt=Rt[Zt]).container;(Qe=er?tt[er]:tt)&&Qe.showscale&&((Ge=initOpts(Qe.colorbar))._id="cb"+tt.uid+(Ot&&er?"-"+er:""),Ge._traceIndex=tt.index,Ge._propPrefix=(er?er+".":"")+"colorbar.",Ge._meta=tt._meta,calcOpts(),it.push(Ge))}}for(var dr in nt._colorAxes)if((Qe=nt[dr]).showscale){var xr=nt._colorAxes[dr];(Ge=initOpts(Qe.colorbar))._id="cb"+dr,Ge._propPrefix=dr+".colorbar.",Ge._meta=nt._meta,rt={min:"cmin",max:"cmax"},"heatmap"!==xr[0]&&(tt=xr[1],rt.calc=tt._module.colorbar.calc),calcOpts(),it.push(Ge)}return it}function drawColorBar(Ne,Ge,Qe){var at=Qe._fullLayout,ot=at._size,Ot=Ge._fillcolor,mr=Ge._line,xr=Ge.title,br=xr.side,Ar=Ge._zrange||tt.extent(("function"==typeof Ot?Ot:mr.color).domain()),en="function"==typeof mr.color?mr.color:function(){return mr.color},En="function"==typeof Ot?Ot:function(){return Ot},Pn=Ge._levels,Dn=calcLevels(Qe,Ge,Ar),In=Dn.fill,zn=Dn.line,Bn=Math.round(Ge.thickness*("fraction"===Ge.thicknessmode?ot.w:1)),Vn=Bn/ot.w,Hn=Math.round(Ge.len*("fraction"===Ge.lenmode?ot.h:1)),qn=Hn/ot.h,Yn=Ge.xpad/ot.w,$n=(Ge.borderwidth+Ge.outlinewidth)/2,ra=Ge.ypad/ot.h,oa=Math.round(Ge.x*ot.w+Ge.xpad),pa=Ge.x-Vn*({middle:.5,right:1}[Ge.xanchor]||0),ga=Ge.y+qn*(({top:-.5,bottom:.5}[Ge.yanchor]||0)-.5),ma=Math.round(ot.h*(1-ga)),_a=ma-Hn;Ge._lenFrac=qn,Ge._thickFrac=Vn,Ge._xLeftFrac=pa,Ge._yBottomFrac=ga;var Va=Ge._axis=mockColorBarAxis(Qe,Ge,Ar);if(Va.position=Ge.x+Yn+Vn,-1!==["top","bottom"].indexOf(br)&&(Va.title.side=br,Va.titlex=Ge.x+Yn,Va.titley=ga+("top"===xr.side?qn-ra:ra)),mr.color&&"auto"===Ge.tickmode){Va.tickmode="linear",Va.tick0=Pn.start;var Wa=Pn.size,Qa=dt.constrain((ma-_a)/50,4,15)+1,ti=(Ar[1]-Ar[0])/((Ge.nticks||Qa)*Wa);if(ti>1){var ni=Math.pow(10,Math.floor(Math.log(ti)/Math.LN10));Wa*=ni*dt.roundUp(ti/ni,[2,5,10]),(Math.abs(Pn.start)/Pn.size+1e-6)%1<2e-6&&(Va.tick0=0)}Va.dtick=Wa}Va.domain=[ga+ra,ga+qn-ra],Va.setScale(),Ne.attr("transform",ht(Math.round(ot.l),Math.round(ot.t)));var di,ji=Ne.select("."+Cn.cbtitleunshift).attr("transform",ht(-Math.round(ot.l),-Math.round(ot.t))),Hi=Ne.select("."+Cn.cbaxis),Yi=0;function drawTitle(tt,rt){var nt={propContainer:Va,propName:Ge._propPrefix+"title",traceIndex:Ge._traceIndex,_meta:Ge._meta,placeholder:at._dfltTitle.colorbar,containerGroup:Ne.select("."+Cn.cbtitle)},it="h"===tt.charAt(0)?tt.substr(1):"h"+tt;Ne.selectAll("."+it+",."+it+"-math-group").remove(),er.draw(Qe,tt,Dt(nt,rt||{}))}function drawDummyTitle(){if(-1!==["top","bottom"].indexOf(br)){var Ne,Qe=ot.l+(Ge.x+Yn)*ot.w,tt=Va.title.font.size;Ne="top"===br?(1-(ga+qn-ra))*ot.h+ot.t+3+.75*tt:(1-(ga+ra))*ot.h+ot.t-3-.25*tt,drawTitle(Va._id+"title",{attributes:{x:Qe,y:Ne,"text-anchor":"start"}})}}function drawCbTitle(){if(-1===["top","bottom"].indexOf(br)){var Ne=Va.title.font.size,Ge=Va._offset+Va._length/2,rt=ot.l+(Va.position||0)*ot.w+("right"===Va.side?10+Ne*(Va.showticklabels?1:.5):-10-Ne*(Va.showticklabels?.5:0));drawTitle("h"+Va._id+"title",{avoid:{selection:tt.select(Qe).selectAll("g."+Va._id+"tick"),side:br,offsetLeft:ot.l,offsetTop:0,maxShift:at.width},attributes:{x:rt,y:Ge,"text-anchor":"middle"},transform:{rotate:"-90",offset:0}})}}function drawAxis(){if(-1!==["top","bottom"].indexOf(br)){var nt=Ne.select("."+Cn.cbtitle),at=nt.select("text"),Dt=[-Ge.outlinewidth/2,Ge.outlinewidth/2],Ot=nt.select(".h"+Va._id+"title-math-group").node(),Zt=15.6;if(at.node()&&(Zt=parseInt(at.node().style.fontSize,10)*mn),Ot?(Yi=Rt.bBox(Ot).height)>Zt&&(Dt[1]-=(Yi-Zt)/2):at.node()&&!at.classed(Cn.jsPlaceholder)&&(Yi=Rt.bBox(at.node()).height),Yi){if(Yi+=5,"top"===br)Va.domain[1]-=Yi/ot.h,Dt[1]*=-1;else{Va.domain[0]+=Yi/ot.h;var er=dr.lineCount(at);Dt[1]+=(1-er)*Zt}nt.attr("transform",ht(Dt[0],Dt[1])),Va.setScale()}}Ne.selectAll("."+Cn.cbfills+",."+Cn.cblines).attr("transform",ht(0,Math.round(ot.h*(1-Va.domain[1])))),Hi.attr("transform",ht(0,Math.round(-ot.t)));var xr=Ne.select("."+Cn.cbfills).selectAll("rect."+Cn.cbfill).attr("style","").data(In);xr.enter().append("rect").classed(Cn.cbfill,!0).style("stroke","none"),xr.exit().remove();var xn=Ar.map(Va.c2p).map(Math.round).sort((function(Ne,Ge){return Ne-Ge}));xr.each((function(Ne,nt){var at=[0===nt?Ar[0]:(In[nt]+In[nt-1])/2,nt===In.length-1?Ar[1]:(In[nt]+In[nt+1])/2].map(Va.c2p).map(Math.round);at[1]=dt.constrain(at[1]+(at[1]>at[0])?1:-1,xn[0],xn[1]);var it=tt.select(this).attr({x:oa,width:Math.max(Bn,2),y:tt.min(at),height:Math.max(tt.max(at)-tt.min(at),2)});if(Ge._fillgradient)Rt.gradient(it,Qe,Ge._id,"vertical",Ge._fillgradient,"fill");else{var ot=En(Ne).replace("e-","");it.attr("fill",rt(ot).toHexString())}}));var kn=Ne.select("."+Cn.cblines).selectAll("path."+Cn.cbline).data(mr.color&&mr.width?zn:[]);kn.enter().append("path").classed(Cn.cbline,!0),kn.exit().remove(),kn.each((function(Ne){tt.select(this).attr("d","M"+oa+","+(Math.round(Va.c2p(Ne))+mr.width/2%1)+"h"+Bn).call(Rt.lineGroupStyle,mr.width,en(Ne),mr.dash)})),Hi.selectAll("g."+Va._id+"tick,path").remove();var Pn=oa+Bn+(Ge.outlinewidth||0)/2-("outside"===Ge.ticks?1:0),Dn=it.calcTicks(Va),Vn=it.getTickSigns(Va)[2];return it.drawTicks(Qe,Va,{vals:"inside"===Va.ticks?it.clipEnds(Va,Dn):Dn,layer:Hi,path:it.makeTickPath(Va,Pn,Vn),transFn:it.makeTransTickFn(Va)}),it.drawLabels(Qe,Va,{vals:Dn,layer:Hi,transFn:it.makeTransTickLabelFn(Va),labelFns:it.makeLabelFns(Va,Pn)})}function positionCB(){var tt=Bn+Ge.outlinewidth/2;if(-1===Va.ticklabelposition.indexOf("inside")&&(tt+=Rt.bBox(Hi.node()).width),(di=ji.select("text")).node()&&!di.classed(Cn.jsPlaceholder)){var rt,at=ji.select(".h"+Va._id+"title-math-group").node();rt=at&&-1!==["top","bottom"].indexOf(br)?Rt.bBox(at).width:Rt.bBox(ji.node()).right-oa-ot.l,tt=Math.max(tt,rt)}var it=2*Ge.xpad+tt+Ge.borderwidth+Ge.outlinewidth/2,dt=ma-_a;Ne.select("."+Cn.cbbg).attr({x:oa-Ge.xpad-(Ge.borderwidth+Ge.outlinewidth)/2,y:_a-$n,width:Math.max(it,2),height:Math.max(dt+2*$n,2)}).call(Zt.fill,Ge.bgcolor).call(Zt.stroke,Ge.bordercolor).style("stroke-width",Ge.borderwidth),Ne.selectAll("."+Cn.cboutline).attr({x:oa,y:_a+Ge.ypad+("top"===br?Yi:0),width:Math.max(Bn,2),height:Math.max(dt-2*Ge.ypad-Yi,2)}).call(Zt.stroke,Ge.outlinecolor).style({fill:"none","stroke-width":Ge.outlinewidth});var Dt=({center:.5,right:1}[Ge.xanchor]||0)*it;Ne.attr("transform",ht(ot.l-Dt,ot.t));var Ot={},er=xn[Ge.yanchor],dr=kn[Ge.yanchor];"pixels"===Ge.lenmode?(Ot.y=Ge.y,Ot.t=dt*er,Ot.b=dt*dr):(Ot.t=Ot.b=0,Ot.yt=Ge.y+Ge.len*er,Ot.yb=Ge.y-Ge.len*dr);var mr=xn[Ge.xanchor],xr=kn[Ge.xanchor];if("pixels"===Ge.thicknessmode)Ot.x=Ge.x,Ot.l=it*mr,Ot.r=it*xr;else{var Ar=it-Bn;Ot.l=Ar*mr,Ot.r=Ar*xr,Ot.xl=Ge.x-Ge.thickness*mr,Ot.xr=Ge.x+Ge.thickness*xr}nt.autoMargin(Qe,Ge._id,Ot)}return dt.syncOrAsync([nt.previousPromises,drawDummyTitle,drawAxis,drawCbTitle,nt.previousPromises,positionCB],Qe)}function makeEditable(Ne,Ge,Qe){var tt,rt,nt,it=Qe._fullLayout._size;ot.init({element:Ne.node(),gd:Qe,prepFn:function(){tt=Ne.attr("transform"),Ot(Ne)},moveFn:function(Qe,at){Ne.attr("transform",tt+ht(Qe,at)),rt=ot.align(Ge._xLeftFrac+Qe/it.w,Ge._thickFrac,0,1,Ge.xanchor),nt=ot.align(Ge._yBottomFrac-at/it.h,Ge._lenFrac,0,1,Ge.yanchor);var dt=ot.getCursor(rt,nt,Ge.xanchor,Ge.yanchor);Ot(Ne,dt)},doneFn:function(){if(Ot(Ne),void 0!==rt&&void 0!==nt){var tt={};tt[Ge._propPrefix+"x"]=rt,tt[Ge._propPrefix+"y"]=nt,void 0!==Ge._traceIndex?at.call("_guiRestyle",Qe,tt,Ge._traceIndex):at.call("_guiRelayout",Qe,tt)}}})}function calcLevels(Ne,Ge,Qe){var tt,rt,nt=Ge._levels,at=[],it=[],ot=nt.end+nt.size/100,dt=nt.size,ht=1.001*Qe[0]-.001*Qe[1],Dt=1.001*Qe[1]-.001*Qe[0];for(rt=0;rt<1e5&&(tt=nt.start+rt*dt,!(dt>0?tt>=ot:tt<=ot));rt++)tt>ht&&tt<Dt&&at.push(tt);if(Ge._fillgradient)it=[0];else if("function"==typeof Ge._fillcolor){var Ot=Ge._filllevels;if(Ot)for(ot=Ot.end+Ot.size/100,dt=Ot.size,rt=0;rt<1e5&&(tt=Ot.start+rt*dt,!(dt>0?tt>=ot:tt<=ot));rt++)tt>Qe[0]&&tt<Qe[1]&&it.push(tt);else(it=at.map((function(Ne){return Ne-nt.size/2}))).push(it[it.length-1]+nt.size)}else Ge._fillcolor&&"string"==typeof Ge._fillcolor&&(it=[0]);return nt.size<0&&(at.reverse(),it.reverse()),{line:at,fill:it}}function mockColorBarAxis(Ne,Ge,Qe){var tt=Ne._fullLayout,rt={type:"linear",range:Qe,tickmode:Ge.tickmode,nticks:Ge.nticks,tick0:Ge.tick0,dtick:Ge.dtick,tickvals:Ge.tickvals,ticktext:Ge.ticktext,ticks:Ge.ticks,ticklen:Ge.ticklen,tickwidth:Ge.tickwidth,tickcolor:Ge.tickcolor,showticklabels:Ge.showticklabels,ticklabelposition:Ge.ticklabelposition,tickfont:Ge.tickfont,tickangle:Ge.tickangle,tickformat:Ge.tickformat,exponentformat:Ge.exponentformat,minexponent:Ge.minexponent,separatethousands:Ge.separatethousands,showexponent:Ge.showexponent,showtickprefix:Ge.showtickprefix,tickprefix:Ge.tickprefix,showticksuffix:Ge.showticksuffix,ticksuffix:Ge.ticksuffix,title:Ge.title,showline:!0,anchor:"free",side:"right",position:1},nt={type:"linear",_id:"y"+Ge._id},at={letter:"y",font:tt.font,noHover:!0,noTickson:!0,noTicklabelmode:!0,calendar:tt.calendar};function coerce(Ne,Ge){return dt.coerce(rt,nt,Ar,Ne,Ge)}return xr(rt,nt,coerce,at,tt),br(rt,nt,coerce,at),nt}Ge.exports={draw:draw}},{"../../constants/alignment":745,"../../lib":778,"../../lib/extend":768,"../../lib/setcursor":799,"../../lib/svg_text_utils":803,"../../plots/cartesian/axes":828,"../../plots/cartesian/axis_defaults":830,"../../plots/cartesian/layout_attributes":842,"../../plots/cartesian/position_defaults":845,"../../plots/plots":891,"../../registry":911,"../color":643,"../colorscale/helpers":654,"../dragelement":662,"../drawing":665,"../titles":738,"./constants":645,d3:169,tinycolor2:576}],648:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib");Ge.exports=function(Ne){return tt.isPlainObject(Ne.colorbar)}},{"../../lib":778}],649:[function(Ne,Ge,Qe){"use strict";Ge.exports={moduleType:"component",name:"colorbar",attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),draw:Ne("./draw").draw,hasColorbar:Ne("./has_colorbar")}},{"./attributes":644,"./defaults":646,"./draw":647,"./has_colorbar":648}],650:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../colorbar/attributes"),rt=Ne("../../lib/regex").counter,nt=Ne("./scales.js").scales;function code(Ne){return"`"+Ne+"`"}Object.keys(nt),Ge.exports=function(Ne,Ge){Ne=Ne||"";var Qe,at=(Ge=Ge||{}).cLetter||"c",it=("onlyIfNumerical"in Ge?Ge.onlyIfNumerical:Boolean(Ne),"noScale"in Ge?Ge.noScale:"marker.line"===Ne),ot="showScaleDflt"in Ge?Ge.showScaleDflt:"z"===at,dt="string"==typeof Ge.colorscaleDflt?nt[Ge.colorscaleDflt]:null,ht=Ge.editTypeOverride||"",Dt=Ne?Ne+".":"";"colorAttr"in Ge?(Qe=Ge.colorAttr,Ge.colorAttr):code(Dt+(Qe={z:"z",c:"color"}[at]));var Ot=at+"auto",Rt=at+"min",Zt=at+"max",er=at+"mid",dr=(code(Dt+Ot),code(Dt+Rt),code(Dt+Zt),{});dr[Rt]=dr[Zt]=void 0;var mr={};mr[Ot]=!1;var xr={};return"color"===Qe&&(xr.color={valType:"color",arrayOk:!0,editType:ht||"style"},Ge.anim&&(xr.color.anim=!0)),xr[Ot]={valType:"boolean",dflt:!0,editType:"calc",impliedEdits:dr},xr[Rt]={valType:"number",dflt:null,editType:ht||"plot",impliedEdits:mr},xr[Zt]={valType:"number",dflt:null,editType:ht||"plot",impliedEdits:mr},xr[er]={valType:"number",dflt:null,editType:"calc",impliedEdits:dr},xr.colorscale={valType:"colorscale",editType:"calc",dflt:dt,impliedEdits:{autocolorscale:!1}},xr.autocolorscale={valType:"boolean",dflt:!1!==Ge.autoColorDflt,editType:"calc",impliedEdits:{colorscale:void 0}},xr.reversescale={valType:"boolean",dflt:!1,editType:"plot"},it||(xr.showscale={valType:"boolean",dflt:ot,editType:"calc"},xr.colorbar=tt),Ge.noColorAxis||(xr.coloraxis={valType:"subplotid",regex:rt("coloraxis"),dflt:null,editType:"calc"}),xr}},{"../../lib/regex":795,"../colorbar/attributes":644,"./scales.js":658}],651:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../lib"),nt=Ne("./helpers").extractOpts;Ge.exports=function(Ne,Ge,Qe){var at,it=Ne._fullLayout,ot=Qe.vals,dt=Qe.containerStr,ht=dt?rt.nestedProperty(Ge,dt).get():Ge,Dt=nt(ht),Ot=!1!==Dt.auto,Rt=Dt.min,Zt=Dt.max,er=Dt.mid,minVal=function(){return rt.aggNums(Math.min,null,ot)},maxVal=function(){return rt.aggNums(Math.max,null,ot)};void 0===Rt?Rt=minVal():Ot&&(Rt=ht._colorAx&&tt(Rt)?Math.min(Rt,minVal()):minVal()),void 0===Zt?Zt=maxVal():Ot&&(Zt=ht._colorAx&&tt(Zt)?Math.max(Zt,maxVal()):maxVal()),Ot&&void 0!==er&&(Zt-er>er-Rt?Rt=er-(Zt-er):Zt-er<er-Rt&&(Zt=er+(er-Rt))),Rt===Zt&&(Rt-=.5,Zt+=.5),Dt._sync("min",Rt),Dt._sync("max",Zt),Dt.autocolorscale&&(at=Rt*Zt<0?it.colorscale.diverging:Rt>=0?it.colorscale.sequential:it.colorscale.sequentialminus,Dt._sync("colorscale",at))}},{"../../lib":778,"./helpers":654,"fast-isnumeric":241}],652:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./helpers").hasColorscale,nt=Ne("./helpers").extractOpts;Ge.exports=function(Ne,Ge){function replace(Ne,Ge){var Qe=Ne["_"+Ge];void 0!==Qe&&(Ne[Ge]=Qe)}function relinkColorAttrs(Ne,Qe){var rt=Qe.container?tt.nestedProperty(Ne,Qe.container).get():Ne;if(rt)if(rt.coloraxis)rt._colorAx=Ge[rt.coloraxis];else{var at=nt(rt),it=at.auto;(it||void 0===at.min)&&replace(rt,Qe.min),(it||void 0===at.max)&&replace(rt,Qe.max),at.autocolorscale&&replace(rt,"colorscale")}}for(var Qe=0;Qe<Ne.length;Qe++){var at=Ne[Qe],it=at._module.colorbar;if(it)if(Array.isArray(it))for(var ot=0;ot<it.length;ot++)relinkColorAttrs(at,it[ot]);else relinkColorAttrs(at,it);rt(at,"marker.line")&&relinkColorAttrs(at,{container:"marker.line",min:"cmin",max:"cmax"})}for(var dt in Ge._colorAxes)relinkColorAttrs(Ge[dt],{min:"cmin",max:"cmax"})}},{"../../lib":778,"./helpers":654}],653:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../lib"),nt=Ne("../colorbar/has_colorbar"),at=Ne("../colorbar/defaults"),it=Ne("./scales").isValid,ot=Ne("../../registry").traceIs;function npMaybe(Ne,Ge){var Qe=Ge.slice(0,Ge.length-1);return Ge?rt.nestedProperty(Ne,Qe).get()||{}:Ne}Ge.exports=function colorScaleDefaults(Ne,Ge,Qe,dt,ht){var Dt=ht.prefix,Ot=ht.cLetter,Rt="_module"in Ge,Zt=npMaybe(Ne,Dt),er=npMaybe(Ge,Dt),dr=npMaybe(Ge._template||{},Dt)||{},thisFn=function(){return delete Ne.coloraxis,delete Ge.coloraxis,colorScaleDefaults(Ne,Ge,Qe,dt,ht)};if(Rt){var mr=Qe._colorAxes||{},xr=dt(Dt+"coloraxis");if(xr){var br=ot(Ge,"contour")&&rt.nestedProperty(Ge,"contours.coloring").get()||"heatmap",Ar=mr[xr];return void(Ar?(Ar[2].push(thisFn),Ar[0]!==br&&(Ar[0]=!1,rt.warn(["Ignoring coloraxis:",xr,"setting","as it is linked to incompatible colorscales."].join(" ")))):mr[xr]=[br,Ge,[thisFn]])}}var en=Zt[Ot+"min"],mn=Zt[Ot+"max"],xn=tt(en)&&tt(mn)&&en<mn;dt(Dt+Ot+"auto",!xn)?dt(Dt+Ot+"mid"):(dt(Dt+Ot+"min"),dt(Dt+Ot+"max"));var kn,Cn,En=Zt.colorscale,Pn=dr.colorscale;void 0!==En&&(kn=!it(En)),void 0!==Pn&&(kn=!it(Pn)),dt(Dt+"autocolorscale",kn),dt(Dt+"colorscale"),dt(Dt+"reversescale"),"marker.line."!==Dt&&(Dt&&Rt&&(Cn=nt(Zt)),dt(Dt+"showscale",Cn)&&(Dt&&dr&&(er._template=dr),at(Zt,er,Qe)))}},{"../../lib":778,"../../registry":911,"../colorbar/defaults":646,"../colorbar/has_colorbar":648,"./scales":658,"fast-isnumeric":241}],654:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("tinycolor2"),nt=Ne("fast-isnumeric"),at=Ne("../../lib"),it=Ne("../color"),ot=Ne("./scales").isValid;function hasColorscale(Ne,Ge,Qe){var tt=Ge?at.nestedProperty(Ne,Ge).get()||{}:Ne,rt=tt[Qe||"color"],it=!1;if(at.isArrayOrTypedArray(rt))for(var dt=0;dt<rt.length;dt++)if(nt(rt[dt])){it=!0;break}return at.isPlainObject(tt)&&(it||!0===tt.showscale||nt(tt.cmin)&&nt(tt.cmax)||ot(tt.colorscale)||at.isPlainObject(tt.colorbar))}var dt=["showscale","autocolorscale","colorscale","reversescale","colorbar"],ht=["min","max","mid","auto"];function extractOpts(Ne){var Ge,Qe,tt,rt=Ne._colorAx,nt=rt||Ne,at={};for(Qe=0;Qe<dt.length;Qe++)at[tt=dt[Qe]]=nt[tt];if(rt)for(Ge="c",Qe=0;Qe<ht.length;Qe++)at[tt=ht[Qe]]=nt["c"+tt];else{var it;for(Qe=0;Qe<ht.length;Qe++)((it="c"+(tt=ht[Qe]))in nt||(it="z"+tt)in nt)&&(at[tt]=nt[it]);Ge=it.charAt(0)}return at._sync=function(Ne,Qe){var tt=-1!==ht.indexOf(Ne)?Ge+Ne:Ne;nt[tt]=nt["_"+tt]=Qe},at}function extractScale(Ne){for(var Ge=extractOpts(Ne),Qe=Ge.min,tt=Ge.max,rt=Ge.reversescale?flipScale(Ge.colorscale):Ge.colorscale,nt=rt.length,at=new Array(nt),it=new Array(nt),ot=0;ot<nt;ot++){var dt=rt[ot];at[ot]=Qe+dt[0]*(tt-Qe),it[ot]=dt[1]}return{domain:at,range:it}}function flipScale(Ne){for(var Ge=Ne.length,Qe=new Array(Ge),tt=Ge-1,rt=0;tt>=0;tt--,rt++){var nt=Ne[tt];Qe[rt]=[1-nt[0],nt[1]]}return Qe}function makeColorScaleFunc(Ne,Ge){Ge=Ge||{};for(var Qe=Ne.domain,at=Ne.range,ot=at.length,dt=new Array(ot),ht=0;ht<ot;ht++){var Dt=rt(at[ht]).toRgb();dt[ht]=[Dt.r,Dt.g,Dt.b,Dt.a]}var Ot,Rt=tt.scale.linear().domain(Qe).range(dt).clamp(!0),Zt=Ge.noNumericCheck,er=Ge.returnArray;return(Ot=Zt&&er?Rt:Zt?function(Ne){return colorArray2rbga(Rt(Ne))}:er?function(Ne){return nt(Ne)?Rt(Ne):rt(Ne).isValid()?Ne:it.defaultLine}:function(Ne){return nt(Ne)?colorArray2rbga(Rt(Ne)):rt(Ne).isValid()?Ne:it.defaultLine}).domain=Rt.domain,Ot.range=function(){return at},Ot}function makeColorScaleFuncFromTrace(Ne,Ge){return makeColorScaleFunc(extractScale(Ne),Ge)}function colorArray2rbga(Ne){var Ge={r:Ne[0],g:Ne[1],b:Ne[2],a:Ne[3]};return rt(Ge).toRgbString()}Ge.exports={hasColorscale:hasColorscale,extractOpts:extractOpts,extractScale:extractScale,flipScale:flipScale,makeColorScaleFunc:makeColorScaleFunc,makeColorScaleFuncFromTrace:makeColorScaleFuncFromTrace}},{"../../lib":778,"../color":643,"./scales":658,d3:169,"fast-isnumeric":241,tinycolor2:576}],655:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./scales"),rt=Ne("./helpers");Ge.exports={moduleType:"component",name:"colorscale",attributes:Ne("./attributes"),layoutAttributes:Ne("./layout_attributes"),supplyLayoutDefaults:Ne("./layout_defaults"),handleDefaults:Ne("./defaults"),crossTraceDefaults:Ne("./cross_trace_defaults"),calc:Ne("./calc"),scales:tt.scales,defaultScale:tt.defaultScale,getScale:tt.get,isValidScale:tt.isValid,hasColorscale:rt.hasColorscale,extractOpts:rt.extractOpts,extractScale:rt.extractScale,flipScale:rt.flipScale,makeColorScaleFunc:rt.makeColorScaleFunc,makeColorScaleFuncFromTrace:rt.makeColorScaleFuncFromTrace}},{"./attributes":650,"./calc":651,"./cross_trace_defaults":652,"./defaults":653,"./helpers":654,"./layout_attributes":656,"./layout_defaults":657,"./scales":658}],656:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib/extend").extendFlat,rt=Ne("./attributes"),nt=Ne("./scales").scales;Ge.exports={editType:"calc",colorscale:{editType:"calc",sequential:{valType:"colorscale",dflt:nt.Reds,editType:"calc"},sequentialminus:{valType:"colorscale",dflt:nt.Blues,editType:"calc"},diverging:{valType:"colorscale",dflt:nt.RdBu,editType:"calc"}},coloraxis:tt({_isSubplotObj:!0,editType:"calc"},rt("",{colorAttr:"corresponding trace color array(s)",noColorAxis:!0,showScaleDflt:!0}))}},{"../../lib/extend":768,"./attributes":650,"./scales":658}],657:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../plot_api/plot_template"),nt=Ne("./layout_attributes"),at=Ne("./defaults");Ge.exports=function(Ne,Ge){function coerce(Qe,rt){return tt.coerce(Ne,Ge,nt,Qe,rt)}coerce("colorscale.sequential"),coerce("colorscale.sequentialminus"),coerce("colorscale.diverging");var Qe,it,ot=Ge._colorAxes;function coerceAx(Ne,Ge){return tt.coerce(Qe,it,nt.coloraxis,Ne,Ge)}for(var dt in ot){var ht=ot[dt];if(ht[0])Qe=Ne[dt]||{},(it=rt.newContainer(Ge,dt,"coloraxis"))._name=dt,at(Qe,it,Ge,coerceAx,{prefix:"",cLetter:"c"});else{for(var Dt=0;Dt<ht[2].length;Dt++)ht[2][Dt]();delete Ge._colorAxes[dt]}}}},{"../../lib":778,"../../plot_api/plot_template":817,"./defaults":653,"./layout_attributes":656}],658:[function(Ne,Ge,Qe){"use strict";var tt=Ne("tinycolor2"),rt={Greys:[[0,"rgb(0,0,0)"],[1,"rgb(255,255,255)"]],YlGnBu:[[0,"rgb(8,29,88)"],[.125,"rgb(37,52,148)"],[.25,"rgb(34,94,168)"],[.375,"rgb(29,145,192)"],[.5,"rgb(65,182,196)"],[.625,"rgb(127,205,187)"],[.75,"rgb(199,233,180)"],[.875,"rgb(237,248,217)"],[1,"rgb(255,255,217)"]],Greens:[[0,"rgb(0,68,27)"],[.125,"rgb(0,109,44)"],[.25,"rgb(35,139,69)"],[.375,"rgb(65,171,93)"],[.5,"rgb(116,196,118)"],[.625,"rgb(161,217,155)"],[.75,"rgb(199,233,192)"],[.875,"rgb(229,245,224)"],[1,"rgb(247,252,245)"]],YlOrRd:[[0,"rgb(128,0,38)"],[.125,"rgb(189,0,38)"],[.25,"rgb(227,26,28)"],[.375,"rgb(252,78,42)"],[.5,"rgb(253,141,60)"],[.625,"rgb(254,178,76)"],[.75,"rgb(254,217,118)"],[.875,"rgb(255,237,160)"],[1,"rgb(255,255,204)"]],Bluered:[[0,"rgb(0,0,255)"],[1,"rgb(255,0,0)"]],RdBu:[[0,"rgb(5,10,172)"],[.35,"rgb(106,137,247)"],[.5,"rgb(190,190,190)"],[.6,"rgb(220,170,132)"],[.7,"rgb(230,145,90)"],[1,"rgb(178,10,28)"]],Reds:[[0,"rgb(220,220,220)"],[.2,"rgb(245,195,157)"],[.4,"rgb(245,160,105)"],[1,"rgb(178,10,28)"]],Blues:[[0,"rgb(5,10,172)"],[.35,"rgb(40,60,190)"],[.5,"rgb(70,100,245)"],[.6,"rgb(90,120,245)"],[.7,"rgb(106,137,247)"],[1,"rgb(220,220,220)"]],Picnic:[[0,"rgb(0,0,255)"],[.1,"rgb(51,153,255)"],[.2,"rgb(102,204,255)"],[.3,"rgb(153,204,255)"],[.4,"rgb(204,204,255)"],[.5,"rgb(255,255,255)"],[.6,"rgb(255,204,255)"],[.7,"rgb(255,153,255)"],[.8,"rgb(255,102,204)"],[.9,"rgb(255,102,102)"],[1,"rgb(255,0,0)"]],Rainbow:[[0,"rgb(150,0,90)"],[.125,"rgb(0,0,200)"],[.25,"rgb(0,25,255)"],[.375,"rgb(0,152,255)"],[.5,"rgb(44,255,150)"],[.625,"rgb(151,255,0)"],[.75,"rgb(255,234,0)"],[.875,"rgb(255,111,0)"],[1,"rgb(255,0,0)"]],Portland:[[0,"rgb(12,51,131)"],[.25,"rgb(10,136,186)"],[.5,"rgb(242,211,56)"],[.75,"rgb(242,143,56)"],[1,"rgb(217,30,30)"]],Jet:[[0,"rgb(0,0,131)"],[.125,"rgb(0,60,170)"],[.375,"rgb(5,255,255)"],[.625,"rgb(255,255,0)"],[.875,"rgb(250,0,0)"],[1,"rgb(128,0,0)"]],Hot:[[0,"rgb(0,0,0)"],[.3,"rgb(230,0,0)"],[.6,"rgb(255,210,0)"],[1,"rgb(255,255,255)"]],Blackbody:[[0,"rgb(0,0,0)"],[.2,"rgb(230,0,0)"],[.4,"rgb(230,210,0)"],[.7,"rgb(255,255,255)"],[1,"rgb(160,200,255)"]],Earth:[[0,"rgb(0,0,130)"],[.1,"rgb(0,180,180)"],[.2,"rgb(40,210,40)"],[.4,"rgb(230,230,50)"],[.6,"rgb(120,70,20)"],[1,"rgb(255,255,255)"]],Electric:[[0,"rgb(0,0,0)"],[.15,"rgb(30,0,100)"],[.4,"rgb(120,0,100)"],[.6,"rgb(160,90,0)"],[.8,"rgb(230,200,0)"],[1,"rgb(255,250,220)"]],Viridis:[[0,"#440154"],[.06274509803921569,"#48186a"],[.12549019607843137,"#472d7b"],[.18823529411764706,"#424086"],[.25098039215686274,"#3b528b"],[.3137254901960784,"#33638d"],[.3764705882352941,"#2c728e"],[.4392156862745098,"#26828e"],[.5019607843137255,"#21918c"],[.5647058823529412,"#1fa088"],[.6274509803921569,"#28ae80"],[.6901960784313725,"#3fbc73"],[.7529411764705882,"#5ec962"],[.8156862745098039,"#84d44b"],[.8784313725490196,"#addc30"],[.9411764705882353,"#d8e219"],[1,"#fde725"]],Cividis:[[0,"rgb(0,32,76)"],[.058824,"rgb(0,42,102)"],[.117647,"rgb(0,52,110)"],[.176471,"rgb(39,63,108)"],[.235294,"rgb(60,74,107)"],[.294118,"rgb(76,85,107)"],[.352941,"rgb(91,95,109)"],[.411765,"rgb(104,106,112)"],[.470588,"rgb(117,117,117)"],[.529412,"rgb(131,129,120)"],[.588235,"rgb(146,140,120)"],[.647059,"rgb(161,152,118)"],[.705882,"rgb(176,165,114)"],[.764706,"rgb(192,177,109)"],[.823529,"rgb(209,191,102)"],[.882353,"rgb(225,204,92)"],[.941176,"rgb(243,219,79)"],[1,"rgb(255,233,69)"]]},nt=rt.RdBu;function getScale(Ne,Ge){if(Ge||(Ge=nt),!Ne)return Ge;function parseScale(){try{Ne=rt[Ne]||JSON.parse(Ne)}catch(Qe){Ne=Ge}}return"string"==typeof Ne&&(parseScale(),"string"==typeof Ne&&parseScale()),isValidScaleArray(Ne)?Ne:Ge}function isValidScaleArray(Ne){var Ge=0;if(!Array.isArray(Ne)||Ne.length<2)return!1;if(!Ne[0]||!Ne[Ne.length-1])return!1;if(0!=+Ne[0][0]||1!=+Ne[Ne.length-1][0])return!1;for(var Qe=0;Qe<Ne.length;Qe++){var rt=Ne[Qe];if(2!==rt.length||+rt[0]<Ge||!tt(rt[1]).isValid())return!1;Ge=+rt[0]}return!0}function isValidScale(Ne){return void 0!==rt[Ne]||isValidScaleArray(Ne)}Ge.exports={scales:rt,defaultScale:nt,get:getScale,isValid:isValidScale}},{tinycolor2:576}],659:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge,Qe,tt,rt){var nt=(Ne-Qe)/(tt-Qe),at=nt+Ge/(tt-Qe),it=(nt+at)/2;return"left"===rt||"bottom"===rt?nt:"center"===rt||"middle"===rt?it:"right"===rt||"top"===rt?at:nt<2/3-it?nt:at>4/3-it?at:it}},{}],660:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=[["sw-resize","s-resize","se-resize"],["w-resize","move","e-resize"],["nw-resize","n-resize","ne-resize"]];Ge.exports=function(Ne,Ge,Qe,nt){return Ne="left"===Qe?0:"center"===Qe?1:"right"===Qe?2:tt.constrain(Math.floor(3*Ne),0,2),Ge="bottom"===nt?0:"middle"===nt?1:"top"===nt?2:tt.constrain(Math.floor(3*Ge),0,2),rt[Ge][Ne]}},{"../../lib":778}],661:[function(Ne,Ge,Qe){"use strict";Qe.selectMode=function(Ne){return"lasso"===Ne||"select"===Ne},Qe.drawMode=function(Ne){return"drawclosedpath"===Ne||"drawopenpath"===Ne||"drawline"===Ne||"drawrect"===Ne||"drawcircle"===Ne},Qe.openMode=function(Ne){return"drawline"===Ne||"drawopenpath"===Ne},Qe.rectMode=function(Ne){return"select"===Ne||"drawline"===Ne||"drawrect"===Ne||"drawcircle"===Ne},Qe.freeMode=function(Ne){return"lasso"===Ne||"drawclosedpath"===Ne||"drawopenpath"===Ne},Qe.selectingOrDrawing=function(Ne){return Qe.freeMode(Ne)||Qe.rectMode(Ne)}},{}],662:[function(Ne,Ge,Qe){"use strict";var tt=Ne("mouse-event-offset"),rt=Ne("has-hover"),nt=Ne("has-passive-events"),at=Ne("../../lib").removeElement,it=Ne("../../plots/cartesian/constants"),ot=Ge.exports={};ot.align=Ne("./align"),ot.getCursor=Ne("./cursor");var dt=Ne("./unhover");function coverSlip(){var Ne=document.createElement("div");Ne.className="dragcover";var Ge=Ne.style;return Ge.position="fixed",Ge.left=0,Ge.right=0,Ge.top=0,Ge.bottom=0,Ge.zIndex=999999999,Ge.background="none",document.body.appendChild(Ne),Ne}function pointerOffset(Ne){return tt(Ne.changedTouches?Ne.changedTouches[0]:Ne,document.body)}ot.unhover=dt.wrapped,ot.unhoverRaw=dt.raw,ot.init=function(Ne){var Ge,Qe,tt,dt,ht,Dt,Ot,Rt,Zt=Ne.gd,er=1,dr=Zt._context.doubleClickDelay,mr=Ne.element;function _clampFn(Ne,Ge,Qe){return Math.abs(Ne)<Qe&&(Ne=0),Math.abs(Ge)<Qe&&(Ge=0),[Ne,Ge]}Zt._mouseDownTime||(Zt._mouseDownTime=0),mr.style.pointerEvents="all",mr.onmousedown=onStart,nt?(mr._ontouchstart&&mr.removeEventListener("touchstart",mr._ontouchstart),mr._ontouchstart=onStart,mr.addEventListener("touchstart",onStart,{passive:!1})):mr.ontouchstart=onStart;var xr=Ne.clampFn||_clampFn;function onStart(nt){Zt._dragged=!1,Zt._dragging=!0;var at=pointerOffset(nt);Ge=at[0],Qe=at[1],Ot=nt.target,Dt=nt,Rt=2===nt.buttons||nt.ctrlKey,void 0===nt.clientX&&void 0===nt.clientY&&(nt.clientX=Ge,nt.clientY=Qe),(tt=(new Date).getTime())-Zt._mouseDownTime<dr?er+=1:(er=1,Zt._mouseDownTime=tt),Ne.prepFn&&Ne.prepFn(nt,Ge,Qe),rt&&!Rt?(ht=coverSlip()).style.cursor=window.getComputedStyle(mr).cursor:rt||(ht=document,dt=window.getComputedStyle(document.documentElement).cursor,document.documentElement.style.cursor=window.getComputedStyle(mr).cursor),document.addEventListener("mouseup",onDone),document.addEventListener("touchend",onDone),!1!==Ne.dragmode&&(nt.preventDefault(),document.addEventListener("mousemove",onMove),document.addEventListener("touchmove",onMove,{passive:!1}))}function onMove(tt){tt.preventDefault();var rt=pointerOffset(tt),nt=Ne.minDrag||it.MINDRAG,at=xr(rt[0]-Ge,rt[1]-Qe,nt),dt=at[0],ht=at[1];(dt||ht)&&(Zt._dragged=!0,ot.unhover(Zt)),Zt._dragged&&Ne.moveFn&&!Rt&&(Zt._dragdata={element:mr,dx:dt,dy:ht},Ne.moveFn(dt,ht))}function onDone(Ge){if(delete Zt._dragdata,!1!==Ne.dragmode&&(Ge.preventDefault(),document.removeEventListener("mousemove",onMove),document.removeEventListener("touchmove",onMove)),document.removeEventListener("mouseup",onDone),document.removeEventListener("touchend",onDone),rt?at(ht):dt&&(ht.documentElement.style.cursor=dt,dt=null),Zt._dragging){if(Zt._dragging=!1,(new Date).getTime()-Zt._mouseDownTime>dr&&(er=Math.max(er-1,1)),Zt._dragged)Ne.doneFn&&Ne.doneFn();else if(Ne.clickFn&&Ne.clickFn(er,Dt),!Rt){var Qe;try{Qe=new MouseEvent("click",Ge)}catch(Ne){var tt=pointerOffset(Ge);(Qe=document.createEvent("MouseEvents")).initMouseEvent("click",Ge.bubbles,Ge.cancelable,Ge.view,Ge.detail,Ge.screenX,Ge.screenY,tt[0],tt[1],Ge.ctrlKey,Ge.altKey,Ge.shiftKey,Ge.metaKey,Ge.button,Ge.relatedTarget)}Ot.dispatchEvent(Qe)}Zt._dragging=!1,Zt._dragged=!1}else Zt._dragged=!1}},ot.coverSlip=coverSlip},{"../../lib":778,"../../plots/cartesian/constants":834,"./align":659,"./cursor":660,"./unhover":663,"has-hover":440,"has-passive-events":441,"mouse-event-offset":484}],663:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib/events"),rt=Ne("../../lib/throttle"),nt=Ne("../../lib/dom").getGraphDiv,at=Ne("../fx/constants"),it=Ge.exports={};it.wrapped=function(Ne,Ge,Qe){(Ne=nt(Ne))._fullLayout&&rt.clear(Ne._fullLayout._uid+at.HOVERID),it.raw(Ne,Ge,Qe)},it.raw=function(Ne,Ge){var Qe=Ne._fullLayout,rt=Ne._hoverdata;Ge||(Ge={}),Ge.target&&!1===tt.triggerHandler(Ne,"plotly_beforehover",Ge)||(Qe._hoverlayer.selectAll("g").remove(),Qe._hoverlayer.selectAll("line").remove(),Qe._hoverlayer.selectAll("circle").remove(),Ne._hoverdata=void 0,Ge.target&&rt&&Ne.emit("plotly_unhover",{event:Ge,points:rt}))}},{"../../lib/dom":766,"../../lib/events":767,"../../lib/throttle":804,"../fx/constants":677}],664:[function(Ne,Ge,Qe){"use strict";Qe.dash={valType:"string",values:["solid","dot","dash","longdash","dashdot","longdashdot"],dflt:"solid",editType:"style"}},{}],665:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("fast-isnumeric"),nt=Ne("tinycolor2"),at=Ne("../../registry"),it=Ne("../color"),ot=Ne("../colorscale"),dt=Ne("../../lib"),ht=dt.strTranslate,Dt=Ne("../../lib/svg_text_utils"),Ot=Ne("../../constants/xmlns_namespaces"),Rt=Ne("../../constants/alignment").LINE_SPACING,Zt=Ne("../../constants/interactions").DESELECTDIM,er=Ne("../../traces/scatter/subtypes"),dr=Ne("../../traces/scatter/make_bubble_size_func"),mr=Ne("../../components/fx/helpers").appendArrayPointValue,xr=Ge.exports={};xr.font=function(Ne,Ge,Qe,tt){dt.isPlainObject(Ge)&&(tt=Ge.color,Qe=Ge.size,Ge=Ge.family),Ge&&Ne.style("font-family",Ge),Qe+1&&Ne.style("font-size",Qe+"px"),tt&&Ne.call(it.fill,tt)},xr.setPosition=function(Ne,Ge,Qe){Ne.attr("x",Ge).attr("y",Qe)},xr.setSize=function(Ne,Ge,Qe){Ne.attr("width",Ge).attr("height",Qe)},xr.setRect=function(Ne,Ge,Qe,tt,rt){Ne.call(xr.setPosition,Ge,Qe).call(xr.setSize,tt,rt)},xr.translatePoint=function(Ne,Ge,Qe,tt){var nt=Qe.c2p(Ne.x),at=tt.c2p(Ne.y);return!!(rt(nt)&&rt(at)&&Ge.node())&&("text"===Ge.node().nodeName?Ge.attr("x",nt).attr("y",at):Ge.attr("transform",ht(nt,at)),!0)},xr.translatePoints=function(Ne,Ge,Qe){Ne.each((function(Ne){var rt=tt.select(this);xr.translatePoint(Ne,rt,Ge,Qe)}))},xr.hideOutsideRangePoint=function(Ne,Ge,Qe,tt,rt,nt){Ge.attr("display",Qe.isPtWithinRange(Ne,rt)&&tt.isPtWithinRange(Ne,nt)?null:"none")},xr.hideOutsideRangePoints=function(Ne,Ge){if(Ge._hasClipOnAxisFalse){var Qe=Ge.xaxis,rt=Ge.yaxis;Ne.each((function(Ge){var nt=Ge[0].trace,it=nt.xcalendar,ot=nt.ycalendar,dt=at.traceIs(nt,"bar-like")?".bartext":".point,.textpoint";Ne.selectAll(dt).each((function(Ne){xr.hideOutsideRangePoint(Ne,tt.select(this),Qe,rt,it,ot)}))}))}},xr.crispRound=function(Ne,Ge,Qe){return Ge&&rt(Ge)?Ne._context.staticPlot?Ge:Ge<1?1:Math.round(Ge):Qe||0},xr.singleLineStyle=function(Ne,Ge,Qe,tt,rt){Ge.style("fill","none");var nt=(((Ne||[])[0]||{}).trace||{}).line||{},at=Qe||nt.width||0,ot=rt||nt.dash||"";it.stroke(Ge,tt||nt.color),xr.dashLine(Ge,ot,at)},xr.lineGroupStyle=function(Ne,Ge,Qe,rt){Ne.style("fill","none").each((function(Ne){var nt=(((Ne||[])[0]||{}).trace||{}).line||{},at=Ge||nt.width||0,ot=rt||nt.dash||"";tt.select(this).call(it.stroke,Qe||nt.color).call(xr.dashLine,ot,at)}))},xr.dashLine=function(Ne,Ge,Qe){Qe=+Qe||0,Ge=xr.dashStyle(Ge,Qe),Ne.style({"stroke-dasharray":Ge,"stroke-width":Qe+"px"})},xr.dashStyle=function(Ne,Ge){Ge=+Ge||1;var Qe=Math.max(Ge,3);return"solid"===Ne?Ne="":"dot"===Ne?Ne=Qe+"px,"+Qe+"px":"dash"===Ne?Ne=3*Qe+"px,"+3*Qe+"px":"longdash"===Ne?Ne=5*Qe+"px,"+5*Qe+"px":"dashdot"===Ne?Ne=3*Qe+"px,"+Qe+"px,"+Qe+"px,"+Qe+"px":"longdashdot"===Ne&&(Ne=5*Qe+"px,"+2*Qe+"px,"+Qe+"px,"+2*Qe+"px"),Ne},xr.singleFillStyle=function(Ne){var Ge=(((tt.select(Ne.node()).data()[0]||[])[0]||{}).trace||{}).fillcolor;Ge&&Ne.call(it.fill,Ge)},xr.fillGroupStyle=function(Ne){Ne.style("stroke-width",0).each((function(Ne){var Ge=tt.select(this);Ne[0].trace&&Ge.call(it.fill,Ne[0].trace.fillcolor)}))};var br=Ne("./symbol_defs");xr.symbolNames=[],xr.symbolFuncs=[],xr.symbolNeedLines={},xr.symbolNoDot={},xr.symbolNoFill={},xr.symbolList=[],Object.keys(br).forEach((function(Ne){var Ge=br[Ne],Qe=Ge.n;xr.symbolList.push(Qe,String(Qe),Ne,Qe+100,String(Qe+100),Ne+"-open"),xr.symbolNames[Qe]=Ne,xr.symbolFuncs[Qe]=Ge.f,Ge.needLine&&(xr.symbolNeedLines[Qe]=!0),Ge.noDot?xr.symbolNoDot[Qe]=!0:xr.symbolList.push(Qe+200,String(Qe+200),Ne+"-dot",Qe+300,String(Qe+300),Ne+"-open-dot"),Ge.noFill&&(xr.symbolNoFill[Qe]=!0)}));var Ar=xr.symbolNames.length,en="M0,0.5L0.5,0L0,-0.5L-0.5,0Z";function makePointPath(Ne,Ge){var Qe=Ne%100;return xr.symbolFuncs[Qe](Ge)+(Ne>=200?en:"")}xr.symbolNumber=function(Ne){if(rt(Ne))Ne=+Ne;else if("string"==typeof Ne){var Ge=0;Ne.indexOf("-open")>0&&(Ge=100,Ne=Ne.replace("-open","")),Ne.indexOf("-dot")>0&&(Ge+=200,Ne=Ne.replace("-dot","")),(Ne=xr.symbolNames.indexOf(Ne))>=0&&(Ne+=Ge)}return Ne%100>=Ar||Ne>=400?0:Math.floor(Math.max(Ne,0))};var mn={x1:1,x2:0,y1:0,y2:0},xn={x1:0,x2:0,y1:1,y2:0},kn=tt.format("~.1f"),Cn={radial:{node:"radialGradient"},radialreversed:{node:"radialGradient",reversed:!0},horizontal:{node:"linearGradient",attrs:mn},horizontalreversed:{node:"linearGradient",attrs:mn,reversed:!0},vertical:{node:"linearGradient",attrs:xn},verticalreversed:{node:"linearGradient",attrs:xn,reversed:!0}};xr.gradient=function(Ne,Ge,Qe,rt,at,ot){for(var ht=at.length,Dt=Cn[rt],Ot=new Array(ht),Rt=0;Rt<ht;Rt++)Dt.reversed?Ot[ht-1-Rt]=[kn(100*(1-at[Rt][0])),at[Rt][1]]:Ot[Rt]=[kn(100*at[Rt][0]),at[Rt][1]];var Zt=Ge._fullLayout,er="g"+Zt._uid+"-"+Qe,dr=Zt._defs.select(".gradients").selectAll("#"+er).data([rt+Ot.join(";")],dt.identity);dr.exit().remove(),dr.enter().append(Dt.node).each((function(){var Ne=tt.select(this);Dt.attrs&&Ne.attr(Dt.attrs),Ne.attr("id",er);var Ge=Ne.selectAll("stop").data(Ot);Ge.exit().remove(),Ge.enter().append("stop"),Ge.each((function(Ne){var Ge=nt(Ne[1]);tt.select(this).attr({offset:Ne[0]+"%","stop-color":it.tinyRGB(Ge),"stop-opacity":Ge.getAlpha()})}))})),Ne.style(ot,getFullUrl(er,Ge)).style(ot+"-opacity",null);var className2query=function(Ne){return"."+Ne.attr("class").replace(/\s/g,".")},mr=className2query(tt.select(Ne.node().parentNode))+">"+className2query(Ne);Zt._gradientUrlQueryParts[mr]=1},xr.initGradients=function(Ne){var Ge=Ne._fullLayout;dt.ensureSingle(Ge._defs,"g","gradients").selectAll("linearGradient,radialGradient").remove(),Ge._gradientUrlQueryParts={}},xr.pointStyle=function(Ne,Ge,Qe){if(Ne.size()){var rt=xr.makePointStyleFns(Ge);Ne.each((function(Ne){xr.singlePointStyle(Ne,tt.select(this),Ge,rt,Qe)}))}},xr.singlePointStyle=function(Ne,Ge,Qe,tt,rt){var nt=Qe.marker,at=nt.line;if(Ge.style("opacity",tt.selectedOpacityFn?tt.selectedOpacityFn(Ne):void 0===Ne.mo?nt.opacity:Ne.mo),tt.ms2mrc){var ot;ot="various"===Ne.ms||"various"===nt.size?3:tt.ms2mrc(Ne.ms),Ne.mrc=ot,tt.selectedSizeFn&&(ot=Ne.mrc=tt.selectedSizeFn(Ne));var ht=xr.symbolNumber(Ne.mx||nt.symbol)||0;Ne.om=ht%200>=100,Ge.attr("d",makePointPath(ht,ot))}var Dt,Ot,Rt,Zt=!1;if(Ne.so)Rt=at.outlierwidth,Ot=at.outliercolor,Dt=nt.outliercolor;else{var er=(at||{}).width;Rt=(Ne.mlw+1||er+1||(Ne.trace?(Ne.trace.marker.line||{}).width:0)+1)-1||0,Ot="mlc"in Ne?Ne.mlcc=tt.lineScale(Ne.mlc):dt.isArrayOrTypedArray(at.color)?it.defaultLine:at.color,dt.isArrayOrTypedArray(nt.color)&&(Dt=it.defaultLine,Zt=!0),Dt="mc"in Ne?Ne.mcc=tt.markerScale(Ne.mc):nt.color||"rgba(0,0,0,0)",tt.selectedColorFn&&(Dt=tt.selectedColorFn(Ne))}if(Ne.om)Ge.call(it.stroke,Dt).style({"stroke-width":(Rt||1)+"px",fill:"none"});else{Ge.style("stroke-width",(Ne.isBlank?0:Rt)+"px");var dr=nt.gradient,mr=Ne.mgt;if(mr?Zt=!0:mr=dr&&dr.type,Array.isArray(mr)&&(mr=mr[0],Cn[mr]||(mr=0)),mr&&"none"!==mr){var br=Ne.mgc;br?Zt=!0:br=dr.color;var Ar=Qe.uid;Zt&&(Ar+="-"+Ne.i),xr.gradient(Ge,rt,Ar,mr,[[0,br],[1,Dt]],"fill")}else it.fill(Ge,Dt);Rt&&it.stroke(Ge,Ot)}},xr.makePointStyleFns=function(Ne){var Ge={},Qe=Ne.marker;return Ge.markerScale=xr.tryColorscale(Qe,""),Ge.lineScale=xr.tryColorscale(Qe,"line"),at.traceIs(Ne,"symbols")&&(Ge.ms2mrc=er.isBubble(Ne)?dr(Ne):function(){return(Qe.size||6)/2}),Ne.selectedpoints&&dt.extendFlat(Ge,xr.makeSelectedPointStyleFns(Ne)),Ge},xr.makeSelectedPointStyleFns=function(Ne){var Ge={},Qe=Ne.selected||{},tt=Ne.unselected||{},rt=Ne.marker||{},nt=Qe.marker||{},it=tt.marker||{},ot=rt.opacity,ht=nt.opacity,Dt=it.opacity,Ot=void 0!==ht,Rt=void 0!==Dt;(dt.isArrayOrTypedArray(ot)||Ot||Rt)&&(Ge.selectedOpacityFn=function(Ne){var Ge=void 0===Ne.mo?rt.opacity:Ne.mo;return Ne.selected?Ot?ht:Ge:Rt?Dt:Zt*Ge});var er=rt.color,dr=nt.color,mr=it.color;(dr||mr)&&(Ge.selectedColorFn=function(Ne){var Ge=Ne.mcc||er;return Ne.selected?dr||Ge:mr||Ge});var xr=rt.size,br=nt.size,Ar=it.size,en=void 0!==br,mn=void 0!==Ar;return at.traceIs(Ne,"symbols")&&(en||mn)&&(Ge.selectedSizeFn=function(Ne){var Ge=Ne.mrc||xr/2;return Ne.selected?en?br/2:Ge:mn?Ar/2:Ge}),Ge},xr.makeSelectedTextStyleFns=function(Ne){var Ge={},Qe=Ne.selected||{},tt=Ne.unselected||{},rt=Ne.textfont||{},nt=Qe.textfont||{},at=tt.textfont||{},ot=rt.color,dt=nt.color,ht=at.color;return Ge.selectedTextColorFn=function(Ne){var Ge=Ne.tc||ot;return Ne.selected?dt||Ge:ht||(dt?Ge:it.addOpacity(Ge,Zt))},Ge},xr.selectedPointStyle=function(Ne,Ge){if(Ne.size()&&Ge.selectedpoints){var Qe=xr.makeSelectedPointStyleFns(Ge),rt=Ge.marker||{},nt=[];Qe.selectedOpacityFn&&nt.push((function(Ne,Ge){Ne.style("opacity",Qe.selectedOpacityFn(Ge))})),Qe.selectedColorFn&&nt.push((function(Ne,Ge){it.fill(Ne,Qe.selectedColorFn(Ge))})),Qe.selectedSizeFn&&nt.push((function(Ne,Ge){var tt=Ge.mx||rt.symbol||0,nt=Qe.selectedSizeFn(Ge);Ne.attr("d",makePointPath(xr.symbolNumber(tt),nt)),Ge.mrc2=nt})),nt.length&&Ne.each((function(Ne){for(var Ge=tt.select(this),Qe=0;Qe<nt.length;Qe++)nt[Qe](Ge,Ne)}))}},xr.tryColorscale=function(Ne,Ge){var Qe=Ge?dt.nestedProperty(Ne,Ge).get():Ne;if(Qe){var tt=Qe.color;if((Qe.colorscale||Qe._colorAx)&&dt.isArrayOrTypedArray(tt))return ot.makeColorScaleFuncFromTrace(Qe)}return dt.identity};var En={start:1,end:-1,middle:0,bottom:1,top:-1};function textPointPosition(Ne,Ge,Qe,rt){var nt=tt.select(Ne.node().parentNode),at=-1!==Ge.indexOf("top")?"top":-1!==Ge.indexOf("bottom")?"bottom":"middle",it=-1!==Ge.indexOf("left")?"end":-1!==Ge.indexOf("right")?"start":"middle",ot=rt?rt/.8+1:0,dt=(Dt.lineCount(Ne)-1)*Rt+1,Ot=En[it]*ot,Zt=.75*Qe+En[at]*ot+(En[at]-1)*dt*Qe/2;Ne.attr("text-anchor",it),nt.attr("transform",ht(Ot,Zt))}function extracTextFontSize(Ne,Ge){var Qe=Ne.ts||Ge.textfont.size;return rt(Qe)&&Qe>0?Qe:0}xr.textPointStyle=function(Ne,Ge,Qe){if(Ne.size()){var rt;if(Ge.selectedpoints){var nt=xr.makeSelectedTextStyleFns(Ge);rt=nt.selectedTextColorFn}var at=Ge.texttemplate,it=Qe._fullLayout;Ne.each((function(Ne){var nt=tt.select(this),ot=at?dt.extractOption(Ne,Ge,"txt","texttemplate"):dt.extractOption(Ne,Ge,"tx","text");if(ot||0===ot){if(at){var ht=Ge._module.formatLabels?Ge._module.formatLabels(Ne,Ge,it):{},Ot={};mr(Ot,Ge,Ne.i);var Rt=Ge._meta||{};ot=dt.texttemplateString(ot,ht,it._d3locale,Ot,Ne,Rt)}var Zt=Ne.tp||Ge.textposition,er=extracTextFontSize(Ne,Ge),dr=rt?rt(Ne):Ne.tc||Ge.textfont.color;nt.call(xr.font,Ne.tf||Ge.textfont.family,er,dr).text(ot).call(Dt.convertToTspans,Qe).call(textPointPosition,Zt,er,Ne.mrc)}else nt.remove()}))}},xr.selectedTextStyle=function(Ne,Ge){if(Ne.size()&&Ge.selectedpoints){var Qe=xr.makeSelectedTextStyleFns(Ge);Ne.each((function(Ne){var rt=tt.select(this),nt=Qe.selectedTextColorFn(Ne),at=Ne.tp||Ge.textposition,ot=extracTextFontSize(Ne,Ge);it.fill(rt,nt),textPointPosition(rt,at,ot,Ne.mrc2||Ne.mrc)}))}};var Pn=.5;function makeTangent(Ne,Ge,Qe,rt){var nt=Ne[0]-Ge[0],at=Ne[1]-Ge[1],it=Qe[0]-Ge[0],ot=Qe[1]-Ge[1],dt=Math.pow(nt*nt+at*at,Pn/2),ht=Math.pow(it*it+ot*ot,Pn/2),Dt=(ht*ht*nt-dt*dt*it)*rt,Ot=(ht*ht*at-dt*dt*ot)*rt,Rt=3*ht*(dt+ht),Zt=3*dt*(dt+ht);return[[tt.round(Ge[0]+(Rt&&Dt/Rt),2),tt.round(Ge[1]+(Rt&&Ot/Rt),2)],[tt.round(Ge[0]-(Zt&&Dt/Zt),2),tt.round(Ge[1]-(Zt&&Ot/Zt),2)]]}xr.smoothopen=function(Ne,Ge){if(Ne.length<3)return"M"+Ne.join("L");var Qe,tt="M"+Ne[0],rt=[];for(Qe=1;Qe<Ne.length-1;Qe++)rt.push(makeTangent(Ne[Qe-1],Ne[Qe],Ne[Qe+1],Ge));for(tt+="Q"+rt[0][0]+" "+Ne[1],Qe=2;Qe<Ne.length-1;Qe++)tt+="C"+rt[Qe-2][1]+" "+rt[Qe-1][0]+" "+Ne[Qe];return tt+="Q"+rt[Ne.length-3][1]+" "+Ne[Ne.length-1]},xr.smoothclosed=function(Ne,Ge){if(Ne.length<3)return"M"+Ne.join("L")+"Z";var Qe,tt="M"+Ne[0],rt=Ne.length-1,nt=[makeTangent(Ne[rt],Ne[0],Ne[1],Ge)];for(Qe=1;Qe<rt;Qe++)nt.push(makeTangent(Ne[Qe-1],Ne[Qe],Ne[Qe+1],Ge));for(nt.push(makeTangent(Ne[rt-1],Ne[rt],Ne[0],Ge)),Qe=1;Qe<=rt;Qe++)tt+="C"+nt[Qe-1][1]+" "+nt[Qe][0]+" "+Ne[Qe];return tt+="C"+nt[rt][1]+" "+nt[0][0]+" "+Ne[0]+"Z"};var Dn={hv:function(Ne,Ge){return"H"+tt.round(Ge[0],2)+"V"+tt.round(Ge[1],2)},vh:function(Ne,Ge){return"V"+tt.round(Ge[1],2)+"H"+tt.round(Ge[0],2)},hvh:function(Ne,Ge){return"H"+tt.round((Ne[0]+Ge[0])/2,2)+"V"+tt.round(Ge[1],2)+"H"+tt.round(Ge[0],2)},vhv:function(Ne,Ge){return"V"+tt.round((Ne[1]+Ge[1])/2,2)+"H"+tt.round(Ge[0],2)+"V"+tt.round(Ge[1],2)}},STEPLINEAR=function(Ne,Ge){return"L"+tt.round(Ge[0],2)+","+tt.round(Ge[1],2)};xr.steps=function(Ne){var Ge=Dn[Ne]||STEPLINEAR;return function(Ne){for(var Qe="M"+tt.round(Ne[0][0],2)+","+tt.round(Ne[0][1],2),rt=1;rt<Ne.length;rt++)Qe+=Ge(Ne[rt-1],Ne[rt]);return Qe}},xr.makeTester=function(){var Ne=dt.ensureSingleById(tt.select("body"),"svg","js-plotly-tester",(function(Ne){Ne.attr(Ot.svgAttrs).style({position:"absolute",left:"-10000px",top:"-10000px",width:"9000px",height:"9000px","z-index":"1"})})),Ge=dt.ensureSingle(Ne,"path","js-reference-point",(function(Ne){Ne.attr("d","M0,0H1V1H0Z").style({"stroke-width":0,fill:"black"})}));xr.tester=Ne,xr.testref=Ge},xr.savedBBoxes={};var In=0,zn=1e4;function nodeHash(Ne){var Ge=Ne.getAttribute("data-unformatted");if(null!==Ge)return Ge+Ne.getAttribute("data-math")+Ne.getAttribute("text-anchor")+Ne.getAttribute("style")}function getFullUrl(Ne,Ge){if(!Ne)return null;var Qe=Ge._context;return"url('"+(Qe._exportedPlot?"":Qe._baseUrl||"")+"#"+Ne+"')"}xr.bBox=function(Ne,Ge,Qe){var rt,nt,at;if(Qe||(Qe=nodeHash(Ne)),Qe){if(rt=xr.savedBBoxes[Qe])return dt.extendFlat({},rt)}else if(1===Ne.childNodes.length){var it=Ne.childNodes[0];if(Qe=nodeHash(it)){var ot=+it.getAttribute("x")||0,ht=+it.getAttribute("y")||0,Ot=it.getAttribute("transform");if(!Ot){var Rt=xr.bBox(it,!1,Qe);return ot&&(Rt.left+=ot,Rt.right+=ot),ht&&(Rt.top+=ht,Rt.bottom+=ht),Rt}if(Qe+="~"+ot+"~"+ht+"~"+Ot,rt=xr.savedBBoxes[Qe])return dt.extendFlat({},rt)}}Ge?nt=Ne:(at=xr.tester.node(),nt=Ne.cloneNode(!0),at.appendChild(nt)),tt.select(nt).attr("transform",null).call(Dt.positionText,0,0);var Zt=nt.getBoundingClientRect(),er=xr.testref.node().getBoundingClientRect();Ge||at.removeChild(nt);var dr={height:Zt.height,width:Zt.width,left:Zt.left-er.left,top:Zt.top-er.top,right:Zt.right-er.left,bottom:Zt.bottom-er.top};return In>=zn&&(xr.savedBBoxes={},In=0),Qe&&(xr.savedBBoxes[Qe]=dr),In++,dt.extendFlat({},dr)},xr.setClipUrl=function(Ne,Ge,Qe){Ne.attr("clip-path",getFullUrl(Ge,Qe))},xr.getTranslate=function(Ne){var Ge=/.*\btranslate\((-?\d*\.?\d*)[^-\d]*(-?\d*\.?\d*)[^\d].*/,Qe=(Ne[Ne.attr?"attr":"getAttribute"]("transform")||"").replace(Ge,(function(Ne,Ge,Qe){return[Ge,Qe].join(" ")})).split(" ");return{x:+Qe[0]||0,y:+Qe[1]||0}},xr.setTranslate=function(Ne,Ge,Qe){var tt=/(\btranslate\(.*?\);?)/,rt=Ne.attr?"attr":"getAttribute",nt=Ne.attr?"attr":"setAttribute",at=Ne[rt]("transform")||"";return Ge=Ge||0,Qe=Qe||0,at=at.replace(tt,"").trim(),at=(at+=ht(Ge,Qe)).trim(),Ne[nt]("transform",at),at},xr.getScale=function(Ne){var Ge=/.*\bscale\((\d*\.?\d*)[^\d]*(\d*\.?\d*)[^\d].*/,Qe=(Ne[Ne.attr?"attr":"getAttribute"]("transform")||"").replace(Ge,(function(Ne,Ge,Qe){return[Ge,Qe].join(" ")})).split(" ");return{x:+Qe[0]||1,y:+Qe[1]||1}},xr.setScale=function(Ne,Ge,Qe){var tt=/(\bscale\(.*?\);?)/,rt=Ne.attr?"attr":"getAttribute",nt=Ne.attr?"attr":"setAttribute",at=Ne[rt]("transform")||"";return Ge=Ge||1,Qe=Qe||1,at=at.replace(tt,"").trim(),at=(at+="scale("+Ge+","+Qe+")").trim(),Ne[nt]("transform",at),at};var Bn=/\s*sc.*/;xr.setPointGroupScale=function(Ne,Ge,Qe){if(Ge=Ge||1,Qe=Qe||1,Ne){var tt=1===Ge&&1===Qe?"":"scale("+Ge+","+Qe+")";Ne.each((function(){var Ne=(this.getAttribute("transform")||"").replace(Bn,"");Ne=(Ne+=tt).trim(),this.setAttribute("transform",Ne)}))}};var Vn=/translate\([^)]*\)\s*$/;xr.setTextPointsScale=function(Ne,Ge,Qe){Ne&&Ne.each((function(){var Ne,rt=tt.select(this),nt=rt.select("text");if(nt.node()){var at=parseFloat(nt.attr("x")||0),it=parseFloat(nt.attr("y")||0),ot=(rt.attr("transform")||"").match(Vn);Ne=1===Ge&&1===Qe?[]:[ht(at,it),"scale("+Ge+","+Qe+")",ht(-at,-it)],ot&&Ne.push(ot),rt.attr("transform",Ne.join(""))}}))}},{"../../components/fx/helpers":679,"../../constants/alignment":745,"../../constants/interactions":752,"../../constants/xmlns_namespaces":754,"../../lib":778,"../../lib/svg_text_utils":803,"../../registry":911,"../../traces/scatter/make_bubble_size_func":1204,"../../traces/scatter/subtypes":1212,"../color":643,"../colorscale":655,"./symbol_defs":666,d3:169,"fast-isnumeric":241,tinycolor2:576}],666:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3");Ge.exports={circle:{n:0,f:function(Ne){var Ge=tt.round(Ne,2);return"M"+Ge+",0A"+Ge+","+Ge+" 0 1,1 0,-"+Ge+"A"+Ge+","+Ge+" 0 0,1 "+Ge+",0Z"}},square:{n:1,f:function(Ne){var Ge=tt.round(Ne,2);return"M"+Ge+","+Ge+"H-"+Ge+"V-"+Ge+"H"+Ge+"Z"}},diamond:{n:2,f:function(Ne){var Ge=tt.round(1.3*Ne,2);return"M"+Ge+",0L0,"+Ge+"L-"+Ge+",0L0,-"+Ge+"Z"}},cross:{n:3,f:function(Ne){var Ge=tt.round(.4*Ne,2),Qe=tt.round(1.2*Ne,2);return"M"+Qe+","+Ge+"H"+Ge+"V"+Qe+"H-"+Ge+"V"+Ge+"H-"+Qe+"V-"+Ge+"H-"+Ge+"V-"+Qe+"H"+Ge+"V-"+Ge+"H"+Qe+"Z"}},x:{n:4,f:function(Ne){var Ge=tt.round(.8*Ne/Math.sqrt(2),2),Qe="l"+Ge+","+Ge,rt="l"+Ge+",-"+Ge,nt="l-"+Ge+",-"+Ge,at="l-"+Ge+","+Ge;return"M0,"+Ge+Qe+rt+nt+rt+nt+at+nt+at+Qe+at+Qe+"Z"}},"triangle-up":{n:5,f:function(Ne){var Ge=tt.round(2*Ne/Math.sqrt(3),2);return"M-"+Ge+","+tt.round(Ne/2,2)+"H"+Ge+"L0,-"+tt.round(Ne,2)+"Z"}},"triangle-down":{n:6,f:function(Ne){var Ge=tt.round(2*Ne/Math.sqrt(3),2);return"M-"+Ge+",-"+tt.round(Ne/2,2)+"H"+Ge+"L0,"+tt.round(Ne,2)+"Z"}},"triangle-left":{n:7,f:function(Ne){var Ge=tt.round(2*Ne/Math.sqrt(3),2);return"M"+tt.round(Ne/2,2)+",-"+Ge+"V"+Ge+"L-"+tt.round(Ne,2)+",0Z"}},"triangle-right":{n:8,f:function(Ne){var Ge=tt.round(2*Ne/Math.sqrt(3),2);return"M-"+tt.round(Ne/2,2)+",-"+Ge+"V"+Ge+"L"+tt.round(Ne,2)+",0Z"}},"triangle-ne":{n:9,f:function(Ne){var Ge=tt.round(.6*Ne,2),Qe=tt.round(1.2*Ne,2);return"M-"+Qe+",-"+Ge+"H"+Ge+"V"+Qe+"Z"}},"triangle-se":{n:10,f:function(Ne){var Ge=tt.round(.6*Ne,2),Qe=tt.round(1.2*Ne,2);return"M"+Ge+",-"+Qe+"V"+Ge+"H-"+Qe+"Z"}},"triangle-sw":{n:11,f:function(Ne){var Ge=tt.round(.6*Ne,2),Qe=tt.round(1.2*Ne,2);return"M"+Qe+","+Ge+"H-"+Ge+"V-"+Qe+"Z"}},"triangle-nw":{n:12,f:function(Ne){var Ge=tt.round(.6*Ne,2),Qe=tt.round(1.2*Ne,2);return"M-"+Ge+","+Qe+"V-"+Ge+"H"+Qe+"Z"}},pentagon:{n:13,f:function(Ne){var Ge=tt.round(.951*Ne,2),Qe=tt.round(.588*Ne,2),rt=tt.round(-Ne,2),nt=tt.round(-.309*Ne,2);return"M"+Ge+","+nt+"L"+Qe+","+tt.round(.809*Ne,2)+"H-"+Qe+"L-"+Ge+","+nt+"L0,"+rt+"Z"}},hexagon:{n:14,f:function(Ne){var Ge=tt.round(Ne,2),Qe=tt.round(Ne/2,2),rt=tt.round(Ne*Math.sqrt(3)/2,2);return"M"+rt+",-"+Qe+"V"+Qe+"L0,"+Ge+"L-"+rt+","+Qe+"V-"+Qe+"L0,-"+Ge+"Z"}},hexagon2:{n:15,f:function(Ne){var Ge=tt.round(Ne,2),Qe=tt.round(Ne/2,2),rt=tt.round(Ne*Math.sqrt(3)/2,2);return"M-"+Qe+","+rt+"H"+Qe+"L"+Ge+",0L"+Qe+",-"+rt+"H-"+Qe+"L-"+Ge+",0Z"}},octagon:{n:16,f:function(Ne){var Ge=tt.round(.924*Ne,2),Qe=tt.round(.383*Ne,2);return"M-"+Qe+",-"+Ge+"H"+Qe+"L"+Ge+",-"+Qe+"V"+Qe+"L"+Qe+","+Ge+"H-"+Qe+"L-"+Ge+","+Qe+"V-"+Qe+"Z"}},star:{n:17,f:function(Ne){var Ge=1.4*Ne,Qe=tt.round(.225*Ge,2),rt=tt.round(.951*Ge,2),nt=tt.round(.363*Ge,2),at=tt.round(.588*Ge,2),it=tt.round(-Ge,2),ot=tt.round(-.309*Ge,2),dt=tt.round(.118*Ge,2),ht=tt.round(.809*Ge,2);return"M"+Qe+","+ot+"H"+rt+"L"+nt+","+dt+"L"+at+","+ht+"L0,"+tt.round(.382*Ge,2)+"L-"+at+","+ht+"L-"+nt+","+dt+"L-"+rt+","+ot+"H-"+Qe+"L0,"+it+"Z"}},hexagram:{n:18,f:function(Ne){var Ge=tt.round(.66*Ne,2),Qe=tt.round(.38*Ne,2),rt=tt.round(.76*Ne,2);return"M-"+rt+",0l-"+Qe+",-"+Ge+"h"+rt+"l"+Qe+",-"+Ge+"l"+Qe+","+Ge+"h"+rt+"l-"+Qe+","+Ge+"l"+Qe+","+Ge+"h-"+rt+"l-"+Qe+","+Ge+"l-"+Qe+",-"+Ge+"h-"+rt+"Z"}},"star-triangle-up":{n:19,f:function(Ne){var Ge=tt.round(Ne*Math.sqrt(3)*.8,2),Qe=tt.round(.8*Ne,2),rt=tt.round(1.6*Ne,2),nt=tt.round(4*Ne,2),at="A "+nt+","+nt+" 0 0 1 ";return"M-"+Ge+","+Qe+at+Ge+","+Qe+at+"0,-"+rt+at+"-"+Ge+","+Qe+"Z"}},"star-triangle-down":{n:20,f:function(Ne){var Ge=tt.round(Ne*Math.sqrt(3)*.8,2),Qe=tt.round(.8*Ne,2),rt=tt.round(1.6*Ne,2),nt=tt.round(4*Ne,2),at="A "+nt+","+nt+" 0 0 1 ";return"M"+Ge+",-"+Qe+at+"-"+Ge+",-"+Qe+at+"0,"+rt+at+Ge+",-"+Qe+"Z"}},"star-square":{n:21,f:function(Ne){var Ge=tt.round(1.1*Ne,2),Qe=tt.round(2*Ne,2),rt="A "+Qe+","+Qe+" 0 0 1 ";return"M-"+Ge+",-"+Ge+rt+"-"+Ge+","+Ge+rt+Ge+","+Ge+rt+Ge+",-"+Ge+rt+"-"+Ge+",-"+Ge+"Z"}},"star-diamond":{n:22,f:function(Ne){var Ge=tt.round(1.4*Ne,2),Qe=tt.round(1.9*Ne,2),rt="A "+Qe+","+Qe+" 0 0 1 ";return"M-"+Ge+",0"+rt+"0,"+Ge+rt+Ge+",0"+rt+"0,-"+Ge+rt+"-"+Ge+",0Z"}},"diamond-tall":{n:23,f:function(Ne){var Ge=tt.round(.7*Ne,2),Qe=tt.round(1.4*Ne,2);return"M0,"+Qe+"L"+Ge+",0L0,-"+Qe+"L-"+Ge+",0Z"}},"diamond-wide":{n:24,f:function(Ne){var Ge=tt.round(1.4*Ne,2),Qe=tt.round(.7*Ne,2);return"M0,"+Qe+"L"+Ge+",0L0,-"+Qe+"L-"+Ge+",0Z"}},hourglass:{n:25,f:function(Ne){var Ge=tt.round(Ne,2);return"M"+Ge+","+Ge+"H-"+Ge+"L"+Ge+",-"+Ge+"H-"+Ge+"Z"},noDot:!0},bowtie:{n:26,f:function(Ne){var Ge=tt.round(Ne,2);return"M"+Ge+","+Ge+"V-"+Ge+"L-"+Ge+","+Ge+"V-"+Ge+"Z"},noDot:!0},"circle-cross":{n:27,f:function(Ne){var Ge=tt.round(Ne,2);return"M0,"+Ge+"V-"+Ge+"M"+Ge+",0H-"+Ge+"M"+Ge+",0A"+Ge+","+Ge+" 0 1,1 0,-"+Ge+"A"+Ge+","+Ge+" 0 0,1 "+Ge+",0Z"},needLine:!0,noDot:!0},"circle-x":{n:28,f:function(Ne){var Ge=tt.round(Ne,2),Qe=tt.round(Ne/Math.sqrt(2),2);return"M"+Qe+","+Qe+"L-"+Qe+",-"+Qe+"M"+Qe+",-"+Qe+"L-"+Qe+","+Qe+"M"+Ge+",0A"+Ge+","+Ge+" 0 1,1 0,-"+Ge+"A"+Ge+","+Ge+" 0 0,1 "+Ge+",0Z"},needLine:!0,noDot:!0},"square-cross":{n:29,f:function(Ne){var Ge=tt.round(Ne,2);return"M0,"+Ge+"V-"+Ge+"M"+Ge+",0H-"+Ge+"M"+Ge+","+Ge+"H-"+Ge+"V-"+Ge+"H"+Ge+"Z"},needLine:!0,noDot:!0},"square-x":{n:30,f:function(Ne){var Ge=tt.round(Ne,2);return"M"+Ge+","+Ge+"L-"+Ge+",-"+Ge+"M"+Ge+",-"+Ge+"L-"+Ge+","+Ge+"M"+Ge+","+Ge+"H-"+Ge+"V-"+Ge+"H"+Ge+"Z"},needLine:!0,noDot:!0},"diamond-cross":{n:31,f:function(Ne){var Ge=tt.round(1.3*Ne,2);return"M"+Ge+",0L0,"+Ge+"L-"+Ge+",0L0,-"+Ge+"ZM0,-"+Ge+"V"+Ge+"M-"+Ge+",0H"+Ge},needLine:!0,noDot:!0},"diamond-x":{n:32,f:function(Ne){var Ge=tt.round(1.3*Ne,2),Qe=tt.round(.65*Ne,2);return"M"+Ge+",0L0,"+Ge+"L-"+Ge+",0L0,-"+Ge+"ZM-"+Qe+",-"+Qe+"L"+Qe+","+Qe+"M-"+Qe+","+Qe+"L"+Qe+",-"+Qe},needLine:!0,noDot:!0},"cross-thin":{n:33,f:function(Ne){var Ge=tt.round(1.4*Ne,2);return"M0,"+Ge+"V-"+Ge+"M"+Ge+",0H-"+Ge},needLine:!0,noDot:!0,noFill:!0},"x-thin":{n:34,f:function(Ne){var Ge=tt.round(Ne,2);return"M"+Ge+","+Ge+"L-"+Ge+",-"+Ge+"M"+Ge+",-"+Ge+"L-"+Ge+","+Ge},needLine:!0,noDot:!0,noFill:!0},asterisk:{n:35,f:function(Ne){var Ge=tt.round(1.2*Ne,2),Qe=tt.round(.85*Ne,2);return"M0,"+Ge+"V-"+Ge+"M"+Ge+",0H-"+Ge+"M"+Qe+","+Qe+"L-"+Qe+",-"+Qe+"M"+Qe+",-"+Qe+"L-"+Qe+","+Qe},needLine:!0,noDot:!0,noFill:!0},hash:{n:36,f:function(Ne){var Ge=tt.round(Ne/2,2),Qe=tt.round(Ne,2);return"M"+Ge+","+Qe+"V-"+Qe+"m-"+Qe+",0V"+Qe+"M"+Qe+","+Ge+"H-"+Qe+"m0,-"+Qe+"H"+Qe},needLine:!0,noFill:!0},"y-up":{n:37,f:function(Ne){var Ge=tt.round(1.2*Ne,2),Qe=tt.round(1.6*Ne,2),rt=tt.round(.8*Ne,2);return"M-"+Ge+","+rt+"L0,0M"+Ge+","+rt+"L0,0M0,-"+Qe+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-down":{n:38,f:function(Ne){var Ge=tt.round(1.2*Ne,2),Qe=tt.round(1.6*Ne,2),rt=tt.round(.8*Ne,2);return"M-"+Ge+",-"+rt+"L0,0M"+Ge+",-"+rt+"L0,0M0,"+Qe+"L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-left":{n:39,f:function(Ne){var Ge=tt.round(1.2*Ne,2),Qe=tt.round(1.6*Ne,2),rt=tt.round(.8*Ne,2);return"M"+rt+","+Ge+"L0,0M"+rt+",-"+Ge+"L0,0M-"+Qe+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"y-right":{n:40,f:function(Ne){var Ge=tt.round(1.2*Ne,2),Qe=tt.round(1.6*Ne,2),rt=tt.round(.8*Ne,2);return"M-"+rt+","+Ge+"L0,0M-"+rt+",-"+Ge+"L0,0M"+Qe+",0L0,0"},needLine:!0,noDot:!0,noFill:!0},"line-ew":{n:41,f:function(Ne){var Ge=tt.round(1.4*Ne,2);return"M"+Ge+",0H-"+Ge},needLine:!0,noDot:!0,noFill:!0},"line-ns":{n:42,f:function(Ne){var Ge=tt.round(1.4*Ne,2);return"M0,"+Ge+"V-"+Ge},needLine:!0,noDot:!0,noFill:!0},"line-ne":{n:43,f:function(Ne){var Ge=tt.round(Ne,2);return"M"+Ge+",-"+Ge+"L-"+Ge+","+Ge},needLine:!0,noDot:!0,noFill:!0},"line-nw":{n:44,f:function(Ne){var Ge=tt.round(Ne,2);return"M"+Ge+","+Ge+"L-"+Ge+",-"+Ge},needLine:!0,noDot:!0,noFill:!0},"arrow-up":{n:45,f:function(Ne){var Ge=tt.round(Ne,2);return"M0,0L-"+Ge+","+tt.round(2*Ne,2)+"H"+Ge+"Z"},noDot:!0},"arrow-down":{n:46,f:function(Ne){var Ge=tt.round(Ne,2);return"M0,0L-"+Ge+",-"+tt.round(2*Ne,2)+"H"+Ge+"Z"},noDot:!0},"arrow-left":{n:47,f:function(Ne){var Ge=tt.round(2*Ne,2),Qe=tt.round(Ne,2);return"M0,0L"+Ge+",-"+Qe+"V"+Qe+"Z"},noDot:!0},"arrow-right":{n:48,f:function(Ne){var Ge=tt.round(2*Ne,2),Qe=tt.round(Ne,2);return"M0,0L-"+Ge+",-"+Qe+"V"+Qe+"Z"},noDot:!0},"arrow-bar-up":{n:49,f:function(Ne){var Ge=tt.round(Ne,2);return"M-"+Ge+",0H"+Ge+"M0,0L-"+Ge+","+tt.round(2*Ne,2)+"H"+Ge+"Z"},needLine:!0,noDot:!0},"arrow-bar-down":{n:50,f:function(Ne){var Ge=tt.round(Ne,2);return"M-"+Ge+",0H"+Ge+"M0,0L-"+Ge+",-"+tt.round(2*Ne,2)+"H"+Ge+"Z"},needLine:!0,noDot:!0},"arrow-bar-left":{n:51,f:function(Ne){var Ge=tt.round(2*Ne,2),Qe=tt.round(Ne,2);return"M0,-"+Qe+"V"+Qe+"M0,0L"+Ge+",-"+Qe+"V"+Qe+"Z"},needLine:!0,noDot:!0},"arrow-bar-right":{n:52,f:function(Ne){var Ge=tt.round(2*Ne,2),Qe=tt.round(Ne,2);return"M0,-"+Qe+"V"+Qe+"M0,0L-"+Ge+",-"+Qe+"V"+Qe+"Z"},needLine:!0,noDot:!0}}},{d3:169}],667:[function(Ne,Ge,Qe){"use strict";Ge.exports={visible:{valType:"boolean",editType:"calc"},type:{valType:"enumerated",values:["percent","constant","sqrt","data"],editType:"calc"},symmetric:{valType:"boolean",editType:"calc"},array:{valType:"data_array",editType:"calc"},arrayminus:{valType:"data_array",editType:"calc"},value:{valType:"number",min:0,dflt:10,editType:"calc"},valueminus:{valType:"number",min:0,dflt:10,editType:"calc"},traceref:{valType:"integer",min:0,dflt:0,editType:"style"},tracerefminus:{valType:"integer",min:0,dflt:0,editType:"style"},copy_ystyle:{valType:"boolean",editType:"plot"},copy_zstyle:{valType:"boolean",editType:"style"},color:{valType:"color",editType:"style"},thickness:{valType:"number",min:0,dflt:2,editType:"style"},width:{valType:"number",min:0,editType:"plot"},editType:"calc",_deprecated:{opacity:{valType:"number",editType:"style"}}}},{}],668:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../registry"),nt=Ne("../../plots/cartesian/axes"),at=Ne("../../lib"),it=Ne("./compute_error");function calcOneAxis(Ne,Ge,Qe,rt){var ot=Ge["error_"+rt]||{},dt=[];if(ot.visible&&-1!==["linear","log"].indexOf(Qe.type)){for(var ht=it(ot),Dt=0;Dt<Ne.length;Dt++){var Ot=Ne[Dt],Rt=Ot.i;if(void 0===Rt)Rt=Dt;else if(null===Rt)continue;var Zt=Ot[rt];if(tt(Qe.c2l(Zt))){var er=ht(Zt,Rt);if(tt(er[0])&&tt(er[1])){var dr=Ot[rt+"s"]=Zt-er[0],mr=Ot[rt+"h"]=Zt+er[1];dt.push(dr,mr)}}}var xr=Qe._id,br=Ge._extremes[xr],Ar=nt.findExtremes(Qe,dt,at.extendFlat({tozero:br.opts.tozero},{padded:!0}));br.min=br.min.concat(Ar.min),br.max=br.max.concat(Ar.max)}}Ge.exports=function(Ne){for(var Ge=Ne.calcdata,Qe=0;Qe<Ge.length;Qe++){var tt=Ge[Qe],at=tt[0].trace;if(!0===at.visible&&rt.traceIs(at,"errorBarsOK")){var it=nt.getFromId(Ne,at.xaxis),ot=nt.getFromId(Ne,at.yaxis);calcOneAxis(tt,at,it,"x"),calcOneAxis(tt,at,ot,"y")}}}},{"../../lib":778,"../../plots/cartesian/axes":828,"../../registry":911,"./compute_error":669,"fast-isnumeric":241}],669:[function(Ne,Ge,Qe){"use strict";function makeComputeErrorValue(Ne,Ge){return"percent"===Ne?function(Ne){return Math.abs(Ne*Ge/100)}:"constant"===Ne?function(){return Math.abs(Ge)}:"sqrt"===Ne?function(Ne){return Math.sqrt(Math.abs(Ne))}:void 0}Ge.exports=function(Ne){var Ge=Ne.type,Qe=Ne.symmetric;if("data"===Ge){var tt=Ne.array||[];if(Qe)return function(Ne,Ge){var Qe=+tt[Ge];return[Qe,Qe]};var rt=Ne.arrayminus||[];return function(Ne,Ge){var Qe=+tt[Ge],nt=+rt[Ge];return isNaN(Qe)&&isNaN(nt)?[NaN,NaN]:[nt||0,Qe||0]}}var nt=makeComputeErrorValue(Ge,Ne.value),at=makeComputeErrorValue(Ge,Ne.valueminus);return Qe||void 0===Ne.valueminus?function(Ne){var Ge=nt(Ne);return[Ge,Ge]}:function(Ne){return[at(Ne),nt(Ne)]}}},{}],670:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../registry"),nt=Ne("../../lib"),at=Ne("../../plot_api/plot_template"),it=Ne("./attributes");Ge.exports=function(Ne,Ge,Qe,ot){var dt="error_"+ot.axis,ht=at.newContainer(Ge,dt),Dt=Ne[dt]||{};function coerce(Ne,Ge){return nt.coerce(Dt,ht,it,Ne,Ge)}if(!1!==coerce("visible",void 0!==Dt.array||void 0!==Dt.value||"sqrt"===Dt.type)){var Ot=coerce("type","array"in Dt?"data":"percent"),Rt=!0;"sqrt"!==Ot&&(Rt=coerce("symmetric",!(("data"===Ot?"arrayminus":"valueminus")in Dt))),"data"===Ot?(coerce("array"),coerce("traceref"),Rt||(coerce("arrayminus"),coerce("tracerefminus"))):"percent"!==Ot&&"constant"!==Ot||(coerce("value"),Rt||coerce("valueminus"));var Zt="copy_"+ot.inherit+"style";ot.inherit&&(Ge["error_"+ot.inherit]||{}).visible&&coerce(Zt,!(Dt.color||tt(Dt.thickness)||tt(Dt.width))),ot.inherit&&ht[Zt]||(coerce("color",Qe),coerce("thickness"),coerce("width",rt.traceIs(Ge,"gl3d")?0:4))}}},{"../../lib":778,"../../plot_api/plot_template":817,"../../registry":911,"./attributes":667,"fast-isnumeric":241}],671:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../plot_api/edit_types").overrideAll,nt=Ne("./attributes"),at={error_x:tt.extendFlat({},nt),error_y:tt.extendFlat({},nt)};delete at.error_x.copy_zstyle,delete at.error_y.copy_zstyle,delete at.error_y.copy_ystyle;var it={error_x:tt.extendFlat({},nt),error_y:tt.extendFlat({},nt),error_z:tt.extendFlat({},nt)};function hoverInfo(Ne,Ge,Qe){(Ge.error_y||{}).visible&&(Qe.yerr=Ne.yh-Ne.y,Ge.error_y.symmetric||(Qe.yerrneg=Ne.y-Ne.ys)),(Ge.error_x||{}).visible&&(Qe.xerr=Ne.xh-Ne.x,Ge.error_x.symmetric||(Qe.xerrneg=Ne.x-Ne.xs))}delete it.error_x.copy_ystyle,delete it.error_y.copy_ystyle,delete it.error_z.copy_ystyle,delete it.error_z.copy_zstyle,Ge.exports={moduleType:"component",name:"errorbars",schema:{traces:{scatter:at,bar:at,histogram:at,scatter3d:rt(it,"calc","nested"),scattergl:rt(at,"calc","nested")}},supplyDefaults:Ne("./defaults"),calc:Ne("./calc"),makeComputeError:Ne("./compute_error"),plot:Ne("./plot"),style:Ne("./style"),hoverInfo:hoverInfo}},{"../../lib":778,"../../plot_api/edit_types":810,"./attributes":667,"./calc":668,"./compute_error":669,"./defaults":670,"./plot":672,"./style":673}],672:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("fast-isnumeric"),nt=Ne("../drawing"),at=Ne("../../traces/scatter/subtypes");function errorCoords(Ne,Ge,Qe){var tt={x:Ge.c2p(Ne.x),y:Qe.c2p(Ne.y)};return void 0!==Ne.yh&&(tt.yh=Qe.c2p(Ne.yh),tt.ys=Qe.c2p(Ne.ys),rt(tt.ys)||(tt.noYS=!0,tt.ys=Qe.c2p(Ne.ys,!0))),void 0!==Ne.xh&&(tt.xh=Ge.c2p(Ne.xh),tt.xs=Ge.c2p(Ne.xs),rt(tt.xs)||(tt.noXS=!0,tt.xs=Ge.c2p(Ne.xs,!0))),tt}Ge.exports=function(Ne,Ge,Qe,it){var ot=Qe.xaxis,dt=Qe.yaxis,ht=it&&it.duration>0;Ge.each((function(Ge){var Dt,Ot=Ge[0].trace,Rt=Ot.error_x||{},Zt=Ot.error_y||{};Ot.ids&&(Dt=function(Ne){return Ne.id});var er=at.hasMarkers(Ot)&&Ot.marker.maxdisplayed>0;Zt.visible||Rt.visible||(Ge=[]);var dr=tt.select(this).selectAll("g.errorbar").data(Ge,Dt);if(dr.exit().remove(),Ge.length){Rt.visible||dr.selectAll("path.xerror").remove(),Zt.visible||dr.selectAll("path.yerror").remove(),dr.style("opacity",1);var mr=dr.enter().append("g").classed("errorbar",!0);ht&&mr.style("opacity",0).transition().duration(it.duration).style("opacity",1),nt.setClipUrl(dr,Qe.layerClipId,Ne),dr.each((function(Ne){var Ge=tt.select(this),Qe=errorCoords(Ne,ot,dt);if(!er||Ne.vis){var nt,at=Ge.select("path.yerror");if(Zt.visible&&rt(Qe.x)&&rt(Qe.yh)&&rt(Qe.ys)){var Dt=Zt.width;nt="M"+(Qe.x-Dt)+","+Qe.yh+"h"+2*Dt+"m-"+Dt+",0V"+Qe.ys,Qe.noYS||(nt+="m-"+Dt+",0h"+2*Dt),at.size()?ht&&(at=at.transition().duration(it.duration).ease(it.easing)):at=Ge.append("path").style("vector-effect","non-scaling-stroke").classed("yerror",!0),at.attr("d",nt)}else at.remove();var Ot=Ge.select("path.xerror");if(Rt.visible&&rt(Qe.y)&&rt(Qe.xh)&&rt(Qe.xs)){var dr=(Rt.copy_ystyle?Zt:Rt).width;nt="M"+Qe.xh+","+(Qe.y-dr)+"v"+2*dr+"m0,-"+dr+"H"+Qe.xs,Qe.noXS||(nt+="m0,-"+dr+"v"+2*dr),Ot.size()?ht&&(Ot=Ot.transition().duration(it.duration).ease(it.easing)):Ot=Ge.append("path").style("vector-effect","non-scaling-stroke").classed("xerror",!0),Ot.attr("d",nt)}else Ot.remove()}}))}}))}},{"../../traces/scatter/subtypes":1212,"../drawing":665,d3:169,"fast-isnumeric":241}],673:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../color");Ge.exports=function(Ne){Ne.each((function(Ne){var Ge=Ne[0].trace,Qe=Ge.error_y||{},nt=Ge.error_x||{},at=tt.select(this);at.selectAll("path.yerror").style("stroke-width",Qe.thickness+"px").call(rt.stroke,Qe.color),nt.copy_ystyle&&(nt=Qe),at.selectAll("path.xerror").style("stroke-width",nt.thickness+"px").call(rt.stroke,nt.color)}))}},{"../color":643,d3:169}],674:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/font_attributes"),rt=Ne("./layout_attributes").hoverlabel,nt=Ne("../../lib/extend").extendFlat;Ge.exports={hoverlabel:{bgcolor:nt({},rt.bgcolor,{arrayOk:!0}),bordercolor:nt({},rt.bordercolor,{arrayOk:!0}),font:tt({arrayOk:!0,editType:"none"}),align:nt({},rt.align,{arrayOk:!0}),namelength:nt({},rt.namelength,{arrayOk:!0}),editType:"none"}}},{"../../lib/extend":768,"../../plots/font_attributes":856,"./layout_attributes":684}],675:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../registry");function paste(Ne,Ge,Qe,rt){rt=rt||tt.identity,Array.isArray(Ne)&&(Ge[0][Qe]=rt(Ne))}Ge.exports=function(Ne){var Ge=Ne.calcdata,Qe=Ne._fullLayout;function makeCoerceHoverInfo(Ne){return function(Ge){return tt.coerceHoverinfo({hoverinfo:Ge},{_module:Ne._module},Qe)}}for(var nt=0;nt<Ge.length;nt++){var at=Ge[nt],it=at[0].trace;if(!rt.traceIs(it,"pie-like")){var ot=rt.traceIs(it,"2dMap")?paste:tt.fillArray;ot(it.hoverinfo,at,"hi",makeCoerceHoverInfo(it)),it.hovertemplate&&ot(it.hovertemplate,at,"ht"),it.hoverlabel&&(ot(it.hoverlabel.bgcolor,at,"hbg"),ot(it.hoverlabel.bordercolor,at,"hbc"),ot(it.hoverlabel.font.size,at,"hts"),ot(it.hoverlabel.font.color,at,"htc"),ot(it.hoverlabel.font.family,at,"htf"),ot(it.hoverlabel.namelength,at,"hnl"),ot(it.hoverlabel.align,at,"hta"))}}}},{"../../lib":778,"../../registry":911}],676:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../registry"),rt=Ne("./hover").hover;Ge.exports=function(Ne,Ge,Qe){var nt=tt.getComponentMethod("annotations","onClick")(Ne,Ne._hoverdata);function emitClick(){Ne.emit("plotly_click",{points:Ne._hoverdata,event:Ge})}void 0!==Qe&&rt(Ne,Ge,Qe,!0),Ne._hoverdata&&Ge&&Ge.target&&(nt&&nt.then?nt.then(emitClick):emitClick(),Ge.stopImmediatePropagation&&Ge.stopImmediatePropagation())}},{"../../registry":911,"./hover":680}],677:[function(Ne,Ge,Qe){"use strict";Ge.exports={YANGLE:60,HOVERARROWSIZE:6,HOVERTEXTPAD:3,HOVERFONTSIZE:13,HOVERFONT:"Arial, sans-serif",HOVERMINTIME:50,HOVERID:"-hover"}},{}],678:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./attributes"),nt=Ne("./hoverlabel_defaults");Ge.exports=function(Ne,Ge,Qe,at){function coerce(Qe,nt){return tt.coerce(Ne,Ge,rt,Qe,nt)}var it=tt.extendFlat({},at.hoverlabel);Ge.hovertemplate&&(it.namelength=-1),nt(Ne,Ge,coerce,it)}},{"../../lib":778,"./attributes":674,"./hoverlabel_defaults":681}],679:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib");Qe.getSubplot=function(Ne){return Ne.subplot||Ne.xaxis+Ne.yaxis||Ne.geo},Qe.isTraceInSubplots=function(Ne,Ge){if("splom"===Ne.type){for(var tt=Ne.xaxes||[],rt=Ne.yaxes||[],nt=0;nt<tt.length;nt++)for(var at=0;at<rt.length;at++)if(-1!==Ge.indexOf(tt[nt]+rt[at]))return!0;return!1}return-1!==Ge.indexOf(Qe.getSubplot(Ne))},Qe.flat=function(Ne,Ge){for(var Qe=new Array(Ne.length),tt=0;tt<Ne.length;tt++)Qe[tt]=Ge;return Qe},Qe.p2c=function(Ne,Ge){for(var Qe=new Array(Ne.length),tt=0;tt<Ne.length;tt++)Qe[tt]=Ne[tt].p2c(Ge);return Qe},Qe.getDistanceFunction=function(Ne,Ge,tt,rt){return"closest"===Ne?rt||Qe.quadrature(Ge,tt):"x"===Ne.charAt(0)?Ge:tt},Qe.getClosest=function(Ne,Ge,Qe){if(!1!==Qe.index)Qe.index>=0&&Qe.index<Ne.length?Qe.distance=0:Qe.index=!1;else for(var tt=0;tt<Ne.length;tt++){var rt=Ge(Ne[tt]);rt<=Qe.distance&&(Qe.index=tt,Qe.distance=rt)}return Qe},Qe.inbox=function(Ne,Ge,Qe){return Ne*Ge<0||0===Ne?Qe:1/0},Qe.quadrature=function(Ne,Ge){return function(Qe){var tt=Ne(Qe),rt=Ge(Qe);return Math.sqrt(tt*tt+rt*rt)}},Qe.makeEventData=function(Ne,Ge,tt){var rt="index"in Ne?Ne.index:Ne.pointNumber,nt={data:Ge._input,fullData:Ge,curveNumber:Ge.index,pointNumber:rt};if(Ge._indexToPoints){var at=Ge._indexToPoints[rt];1===at.length?nt.pointIndex=at[0]:nt.pointIndices=at}else nt.pointIndex=rt;return Ge._module.eventData?nt=Ge._module.eventData(nt,Ne,Ge,tt,rt):("xVal"in Ne?nt.x=Ne.xVal:"x"in Ne&&(nt.x=Ne.x),"yVal"in Ne?nt.y=Ne.yVal:"y"in Ne&&(nt.y=Ne.y),Ne.xa&&(nt.xaxis=Ne.xa),Ne.ya&&(nt.yaxis=Ne.ya),void 0!==Ne.zLabelVal&&(nt.z=Ne.zLabelVal)),Qe.appendArrayPointValue(nt,Ge,rt),nt},Qe.appendArrayPointValue=function(Ne,Ge,Qe){var rt=Ge._arrayAttrs;if(rt)for(var nt=0;nt<rt.length;nt++){var at=rt[nt],it=getPointKey(at);if(void 0===Ne[it]){var ot=getPointData(tt.nestedProperty(Ge,at).get(),Qe);void 0!==ot&&(Ne[it]=ot)}}},Qe.appendArrayMultiPointValues=function(Ne,Ge,Qe){var rt=Ge._arrayAttrs;if(rt)for(var nt=0;nt<rt.length;nt++){var at=rt[nt],it=getPointKey(at);if(void 0===Ne[it]){for(var ot=tt.nestedProperty(Ge,at).get(),dt=new Array(Qe.length),ht=0;ht<Qe.length;ht++)dt[ht]=getPointData(ot,Qe[ht]);Ne[it]=dt}}};var rt={ids:"id",locations:"location",labels:"label",values:"value","marker.colors":"color",parents:"parent"};function getPointKey(Ne){return rt[Ne]||Ne}function getPointData(Ne,Ge){return Array.isArray(Ge)?Array.isArray(Ne)&&Array.isArray(Ne[Ge[0]])?Ne[Ge[0]][Ge[1]]:void 0:Ne[Ge]}var nt={x:!0,y:!0},at={"x unified":!0,"y unified":!0};Qe.isUnifiedHover=function(Ne){return"string"==typeof Ne&&!!at[Ne]},Qe.isXYhover=function(Ne){return"string"==typeof Ne&&!!nt[Ne]}},{"../../lib":778}],680:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("fast-isnumeric"),nt=Ne("tinycolor2"),at=Ne("../../lib"),it=at.strTranslate,ot=at.strRotate,dt=Ne("../../lib/events"),ht=Ne("../../lib/svg_text_utils"),Dt=Ne("../../lib/override_cursor"),Ot=Ne("../drawing"),Rt=Ne("../color"),Zt=Ne("../dragelement"),er=Ne("../../plots/cartesian/axes"),dr=Ne("../../registry"),mr=Ne("./helpers"),xr=Ne("./constants"),br=Ne("../legend/defaults"),Ar=Ne("../legend/draw"),en=xr.YANGLE,mn=Math.PI*en/180,xn=1/Math.sin(mn),kn=Math.cos(mn),Cn=Math.sin(mn),En=xr.HOVERARROWSIZE,Pn=xr.HOVERTEXTPAD;function _hover(Ne,Ge,Qe,nt){Qe||(Qe="xy");var it=Array.isArray(Qe)?Qe:[Qe],ot=Ne._fullLayout,ht=ot._plots||[],Ot=ht[Qe],er=ot._has("cartesian");if(Ot){var xr=Ot.overlays.map((function(Ne){return Ne.id}));it=it.concat(xr)}for(var br=it.length,Ar=new Array(br),en=new Array(br),mn=!1,xn=0;xn<br;xn++){var kn=it[xn];if(ht[kn])mn=!0,Ar[xn]=ht[kn].xaxis,en[xn]=ht[kn].yaxis;else{if(!ot[kn]||!ot[kn]._subplot)return void at.warn("Unrecognized subplot: "+kn);var Cn=ot[kn]._subplot;Ar[xn]=Cn.xaxis,en[xn]=Cn.yaxis}}var En=Ge.hovermode||ot.hovermode;if(En&&!mn&&(En="closest"),-1===["x","y","closest","x unified","y unified"].indexOf(En)||!Ne.calcdata||Ne.querySelector(".zoombox")||Ne._dragging)return Zt.unhoverRaw(Ne,Ge);var Pn,Dn,In,zn,Bn,Vn,Hn,qn,Yn,$n,ra,oa,pa,ga=-1===ot.hoverdistance?1/0:ot.hoverdistance,ma=-1===ot.spikedistance?1/0:ot.spikedistance,_a=[],Va=[],Wa={hLinePoint:null,vLinePoint:null},Qa=!1;if(Array.isArray(Ge))for(En="array",In=0;In<Ge.length;In++)(Bn=Ne.calcdata[Ge[In].curveNumber||0])&&(Vn=Bn[0].trace,"skip"!==Bn[0].trace.hoverinfo&&(Va.push(Bn),"h"===Vn.orientation&&(Qa=!0)));else{for(zn=0;zn<Ne.calcdata.length;zn++)Bn=Ne.calcdata[zn],"skip"!==(Vn=Bn[0].trace).hoverinfo&&mr.isTraceInSubplots(Vn,it)&&(Va.push(Bn),"h"===Vn.orientation&&(Qa=!0));var ti,ni;if(Ge.target){if(!1===dt.triggerHandler(Ne,"plotly_beforehover",Ge))return;var di=Ge.target.getBoundingClientRect();ti=Ge.clientX-di.left,ni=Ge.clientY-di.top,ot._calcInverseTransform(Ne);var ji=at.apply3DTransform(ot._invTransform)(ti,ni);if(ti=ji[0],ni=ji[1],ti<0||ti>Ar[0]._length||ni<0||ni>en[0]._length)return Zt.unhoverRaw(Ne,Ge)}else ti="xpx"in Ge?Ge.xpx:Ar[0]._length/2,ni="ypx"in Ge?Ge.ypx:en[0]._length/2;if(Ge.pointerX=ti+Ar[0]._offset,Ge.pointerY=ni+en[0]._offset,Pn="xval"in Ge?mr.flat(it,Ge.xval):mr.p2c(Ar,ti),Dn="yval"in Ge?mr.flat(it,Ge.yval):mr.p2c(en,ni),!rt(Pn[0])||!rt(Dn[0]))return at.warn("Fx.hover failed",Ge,Ne),Zt.unhoverRaw(Ne,Ge)}var Hi=1/0;function findHoverPoints(Ne,Qe){for(zn=0;zn<Va.length;zn++)if((Bn=Va[zn])&&Bn[0]&&Bn[0].trace&&!0===(Vn=Bn[0].trace).visible&&0!==Vn._length&&-1===["carpet","contourcarpet"].indexOf(Vn._module.name)){if("splom"===Vn.type?Hn=it[qn=0]:(Hn=mr.getSubplot(Vn),qn=it.indexOf(Hn)),Yn=En,mr.isUnifiedHover(Yn)&&(Yn=Yn.charAt(0)),oa={cd:Bn,trace:Vn,xa:Ar[qn],ya:en[qn],maxHoverDistance:ga,maxSpikeDistance:ma,index:!1,distance:Math.min(Hi,ga),spikeDistance:1/0,xSpike:void 0,ySpike:void 0,color:Rt.defaultLine,name:Vn.name,x0:void 0,x1:void 0,y0:void 0,y1:void 0,xLabelVal:void 0,yLabelVal:void 0,zLabelVal:void 0,text:void 0},ot[Hn]&&(oa.subplot=ot[Hn]._subplot),ot._splomScenes&&ot._splomScenes[Vn.uid]&&(oa.scene=ot._splomScenes[Vn.uid]),pa=_a.length,"array"===Yn){var tt=Ge[zn];"pointNumber"in tt?(oa.index=tt.pointNumber,Yn="closest"):(Yn="","xval"in tt&&($n=tt.xval,Yn="x"),"yval"in tt&&(ra=tt.yval,Yn=Yn?"closest":"y"))}else void 0!==Ne&&void 0!==Qe?($n=Ne,ra=Qe):($n=Pn[qn],ra=Dn[qn]);if(0!==ga)if(Vn._module&&Vn._module.hoverPoints){var nt=Vn._module.hoverPoints(oa,$n,ra,Yn,ot._hoverlayer);if(nt)for(var dt,ht=0;ht<nt.length;ht++)dt=nt[ht],rt(dt.x0)&&rt(dt.y0)&&_a.push(cleanPoint(dt,En))}else at.log("Unrecognized trace type in hover:",Vn);if("closest"===En&&_a.length>pa&&(_a.splice(0,pa),Hi=_a[0].distance),er&&0!==ma&&0===_a.length){oa.distance=ma,oa.index=!1;var Dt=Vn._module.hoverPoints(oa,$n,ra,"closest",ot._hoverlayer);if(Dt&&(Dt=Dt.filter((function(Ne){return Ne.spikeDistance<=ma}))),Dt&&Dt.length){var Ot,Zt=Dt.filter((function(Ne){return Ne.xa.showspikes&&"hovered data"!==Ne.xa.spikesnap}));if(Zt.length){var dr=Zt[0];rt(dr.x0)&&rt(dr.y0)&&(Ot=fillSpikePoint(dr),(!Wa.vLinePoint||Wa.vLinePoint.spikeDistance>Ot.spikeDistance)&&(Wa.vLinePoint=Ot))}var xr=Dt.filter((function(Ne){return Ne.ya.showspikes&&"hovered data"!==Ne.ya.spikesnap}));if(xr.length){var br=xr[0];rt(br.x0)&&rt(br.y0)&&(Ot=fillSpikePoint(br),(!Wa.hLinePoint||Wa.hLinePoint.spikeDistance>Ot.spikeDistance)&&(Wa.hLinePoint=Ot))}}}}}function selectClosestPoint(Ne,Ge){for(var Qe,tt=null,rt=1/0,nt=0;nt<Ne.length;nt++)(Qe=Ne[nt].spikeDistance)<=rt&&Qe<=Ge&&(tt=Ne[nt],rt=Qe);return tt}function fillSpikePoint(Ne){return Ne?{xa:Ne.xa,ya:Ne.ya,x:void 0!==Ne.xSpike?Ne.xSpike:(Ne.x0+Ne.x1)/2,y:void 0!==Ne.ySpike?Ne.ySpike:(Ne.y0+Ne.y1)/2,distance:Ne.distance,spikeDistance:Ne.spikeDistance,curveNumber:Ne.trace.index,color:Ne.color,pointNumber:Ne.index}:null}findHoverPoints();var Yi={fullLayout:ot,container:ot._hoverlayer,outerContainer:ot._paperdiv,event:Ge},uo=Ne._spikepoints,go={vLinePoint:Wa.vLinePoint,hLinePoint:Wa.hLinePoint};if(Ne._spikepoints=go,er&&0!==ma&&0!==_a.length){var ns=selectClosestPoint(_a.filter((function(Ne){return Ne.ya.showspikes})),ma);Wa.hLinePoint=fillSpikePoint(ns);var as=selectClosestPoint(_a.filter((function(Ne){return Ne.xa.showspikes})),ma);Wa.vLinePoint=fillSpikePoint(as)}if(0===_a.length){var is=Zt.unhoverRaw(Ne,Ge);return!er||null===Wa.hLinePoint&&null===Wa.vLinePoint||spikesChanged(uo)&&createSpikelines(Ne,Wa,Yi),is}if(er&&spikesChanged(uo)&&createSpikelines(Ne,Wa,Yi),_a.sort((function(Ne,Ge){return Ne.distance-Ge.distance})),mr.isXYhover(Yn)&&0!==_a[0].length&&"splom"!==_a[0].trace.type){var os=_a[0],ss=os.cd[os.index],cs="group"===ot.boxmode||"group"===ot.violinmode,ds=os.xVal,ms=os.xa;"category"===ms.type&&(ds=ms._categoriesMap[ds]),"date"===ms.type&&(ds=ms.d2c(ds)),ss&&ss.t&&ss.t.posLetter===ms._id&&cs&&(ds+=ss.t.dPos);var vs=os.yVal;"category"===(ms=os.ya).type&&(vs=ms._categoriesMap[vs]),"date"===ms.type&&(vs=ms.d2c(vs)),ss&&ss.t&&ss.t.posLetter===ms._id&&cs&&(vs+=ss.t.dPos),findHoverPoints(ds,vs);var _s={};_a=_a.filter((function(Ne){var Ge=hoverDataKey(Ne);if(!_s[Ge])return _s[Ge]=!0,_s[Ge]}))}var ws=Ne._hoverdata,Ts=[];for(In=0;In<_a.length;In++){var ks=_a[In],Cs=mr.makeEventData(ks,ks.trace,ks.cd);if(!1!==ks.hovertemplate){var Es=!1;ks.cd[ks.index]&&ks.cd[ks.index].ht&&(Es=ks.cd[ks.index].ht),ks.hovertemplate=Es||ks.trace.hovertemplate||!1}ks.eventData=[Cs],Ts.push(Cs)}Ne._hoverdata=Ts;var Ls="y"===En&&(Va.length>1||_a.length>1)||"closest"===En&&Qa&&_a.length>1,Ps=Rt.combine(ot.plot_bgcolor||Rt.background,ot.paper_bgcolor),Ds={hovermode:En,rotateLabels:Ls,bgColor:Ps,container:ot._hoverlayer,outerContainer:ot._paperdiv,commonLabelOpts:ot.hoverlabel,hoverdistance:ot.hoverdistance},Is=createHoverText(_a,Ds,Ne);if(mr.isUnifiedHover(En)||(hoverAvoidOverlaps(Is,Ls?"xa":"ya",ot),alignHoverText(Is,Ls,ot._invScaleX,ot._invScaleY)),Ge.target&&Ge.target.tagName){var Os=dr.getComponentMethod("annotations","hasClickToShow")(Ne,Ts);Dt(tt.select(Ge.target),Os?"pointer":"")}Ge.target&&!nt&&hoverChanged(Ne,Ge,ws)&&(ws&&Ne.emit("plotly_unhover",{event:Ge,points:ws}),Ne.emit("plotly_hover",{event:Ge,points:Ne._hoverdata,xaxes:Ar,yaxes:en,xvals:Pn,yvals:Dn}))}function hoverDataKey(Ne){return[Ne.trace.index,Ne.index,Ne.x0,Ne.y0,Ne.name,Ne.attr,Ne.xa,Ne.ya||""].join(",")}Qe.hover=function(Ne,Ge,Qe,tt){Ne=at.getGraphDiv(Ne),at.throttle(Ne._fullLayout._uid+xr.HOVERID,xr.HOVERMINTIME,(function(){_hover(Ne,Ge,Qe,tt)}))},Qe.loneHover=function(Ne,Ge){var Qe=!0;Array.isArray(Ne)||(Qe=!1,Ne=[Ne]);var rt=Ne.map((function(Ne){return{color:Ne.color||Rt.defaultLine,x0:Ne.x0||Ne.x||0,x1:Ne.x1||Ne.x||0,y0:Ne.y0||Ne.y||0,y1:Ne.y1||Ne.y||0,xLabel:Ne.xLabel,yLabel:Ne.yLabel,zLabel:Ne.zLabel,text:Ne.text,name:Ne.name,idealAlign:Ne.idealAlign,borderColor:Ne.borderColor,fontFamily:Ne.fontFamily,fontSize:Ne.fontSize,fontColor:Ne.fontColor,nameLength:Ne.nameLength,textAlign:Ne.textAlign,trace:Ne.trace||{index:0,hoverinfo:""},xa:{_offset:0},ya:{_offset:0},index:0,hovertemplate:Ne.hovertemplate||!1,eventData:Ne.eventData||!1,hovertemplateLabels:Ne.hovertemplateLabels||!1}})),nt=tt.select(Ge.container),at=Ge.outerContainer?tt.select(Ge.outerContainer):nt,it={hovermode:"closest",rotateLabels:!1,bgColor:Ge.bgColor||Rt.background,container:nt,outerContainer:at},ot=createHoverText(rt,it,Ge.gd),dt=5,ht=0,Dt=0;ot.sort((function(Ne,Ge){return Ne.y0-Ge.y0})).each((function(Ne,Qe){var tt=Ne.y0-Ne.by/2;Ne.offset=tt-dt<ht?ht-tt+dt:0,ht=tt+Ne.by+Ne.offset,Qe===Ge.anchorIndex&&(Dt=Ne.offset)})).each((function(Ne){Ne.offset-=Dt}));var Ot=Ge.gd._fullLayout._invScaleX,Zt=Ge.gd._fullLayout._invScaleY;return alignHoverText(ot,it.rotateLabels,Ot,Zt),Qe?ot:ot.node()};var Dn=/<extra>([\s\S]*)<\/extra>/;function createHoverText(Ne,Ge,Qe){var rt=Qe._fullLayout,nt=Ge.hovermode,dt=Ge.rotateLabels,Dt=Ge.bgColor,Zt=Ge.container,er=Ge.outerContainer,dr=Ge.commonLabelOpts||{},mn=Ge.fontFamily||xr.HOVERFONT,xn=Ge.fontSize||xr.HOVERFONTSIZE,kn=Ne[0],Cn=kn.xa,Dn=kn.ya,In="y"===nt.charAt(0)?"yLabel":"xLabel",zn=kn[In],Bn=(String(zn)||"").split(" ")[0],Vn=er.node().getBoundingClientRect(),Hn=Vn.top,qn=Vn.width,Yn=Vn.height,$n=void 0!==zn&&kn.distance<=Ge.hoverdistance&&("x"===nt||"y"===nt);if($n){var ra,oa,pa=!0;for(ra=0;ra<Ne.length;ra++)if(pa&&void 0===Ne[ra].zLabel&&(pa=!1),oa=Ne[ra].hoverinfo||Ne[ra].trace.hoverinfo){var ga=Array.isArray(oa)?oa:oa.split("+");if(-1===ga.indexOf("all")&&-1===ga.indexOf(nt)){$n=!1;break}}pa&&($n=!1)}var ma=Zt.selectAll("g.axistext").data($n?[0]:[]);function filterClosePoints(Ne){return Ne.filter((function(Ne){return void 0!==Ne.zLabelVal||(Ne[In]||"").split(" ")[0]===Bn}))}if(ma.enter().append("g").classed("axistext",!0),ma.exit().remove(),ma.each((function(){var Ge=tt.select(this),ot=at.ensureSingle(Ge,"path","",(function(Ne){Ne.style({"stroke-width":"1px"})})),dt=at.ensureSingle(Ge,"text","",(function(Ne){Ne.attr("data-notex",1)})),Dt=dr.bgcolor||Rt.defaultLine,Zt=dr.bordercolor||Rt.contrast(Dt),er=Rt.contrast(Dt),mr={family:dr.font.family||mn,size:dr.font.size||xn,color:dr.font.color||er};ot.style({fill:Dt,stroke:Zt}),dt.text(zn).call(Ot.font,mr).call(ht.positionText,0,0).call(ht.convertToTspans,Qe),Ge.attr("transform","");var xr,br,Ar=dt.node().getBoundingClientRect();if("x"===nt){var en="top"===Cn.side?"-":"";dt.attr("text-anchor","middle").call(ht.positionText,0,"top"===Cn.side?Hn-Ar.bottom-En-Pn:Hn-Ar.top+En+Pn),xr=Cn._offset+(kn.x0+kn.x1)/2,br=Dn._offset+("top"===Cn.side?0:Dn._length);var In=Ar.width/2+Pn;xr<In?(xr=In,ot.attr("d","M-"+(In-En)+",0L-"+(In-2*En)+","+en+En+"H"+(Pn+Ar.width/2)+"v"+en+(2*Pn+Ar.height)+"H-"+In+"V"+en+En+"Z")):xr>rt.width-In?(xr=rt.width-In,ot.attr("d","M"+(In-En)+",0L"+In+","+en+En+"v"+en+(2*Pn+Ar.height)+"H-"+In+"V"+en+En+"H"+(In-2*En)+"Z")):ot.attr("d","M0,0L"+En+","+en+En+"H"+(Pn+Ar.width/2)+"v"+en+(2*Pn+Ar.height)+"H-"+(Pn+Ar.width/2)+"V"+en+En+"H-"+En+"Z")}else{var Bn,Vn,qn;"right"===Dn.side?(Bn="start",Vn=1,qn="",xr=Cn._offset+Cn._length):(Bn="end",Vn=-1,qn="-",xr=Cn._offset),br=Dn._offset+(kn.y0+kn.y1)/2,dt.attr("text-anchor",Bn),ot.attr("d","M0,0L"+qn+En+","+En+"V"+(Pn+Ar.height/2)+"h"+qn+(2*Pn+Ar.width)+"V-"+(Pn+Ar.height/2)+"H"+qn+En+"V-"+En+"Z");var Yn,$n=Ar.height/2,ra=Hn-Ar.top-$n,oa="clip"+rt._uid+"commonlabel"+Dn._id;if(xr<Ar.width+2*Pn+En){Yn="M-"+(En+Pn)+"-"+$n+"h-"+(Ar.width-Pn)+"V"+$n+"h"+(Ar.width-Pn)+"Z";var pa=Ar.width-xr+Pn;ht.positionText(dt,pa,ra),"end"===Bn&&dt.selectAll("tspan").each((function(){var Ne=tt.select(this),Ge=Ot.tester.append("text").text(Ne.text()).call(Ot.font,mr),Qe=Ge.node().getBoundingClientRect();Math.round(Qe.width)<Math.round(Ar.width)&&Ne.attr("x",pa-Qe.width),Ge.remove()}))}else ht.positionText(dt,Vn*(Pn+En),ra),Yn=null;var ga=rt._topclips.selectAll("#"+oa).data(Yn?[0]:[]);ga.enter().append("clipPath").attr("id",oa).append("path"),ga.exit().remove(),ga.select("path").attr("d",Yn),Ot.setClipUrl(dt,Yn?oa:null,Qe)}Ge.attr("transform",it(xr,br)),Ne=filterClosePoints(Ne)})),mr.isUnifiedHover(nt)){if(Zt.selectAll("g.hovertext").remove(),void 0!==zn&&kn.distance<=Ge.hoverdistance&&(Ne=filterClosePoints(Ne)),0===Ne.length)return;var _a={showlegend:!0,legend:{title:{text:zn,font:rt.hoverlabel.font},font:rt.hoverlabel.font,bgcolor:rt.hoverlabel.bgcolor,bordercolor:rt.hoverlabel.bordercolor,borderwidth:1,tracegroupgap:7,traceorder:rt.legend?rt.legend.traceorder:void 0,orientation:"v"}},Va={};br(_a,Va,Qe._fullData);var Wa=Va.legend;Wa.entries=[];for(var Qa=0;Qa<Ne.length;Qa++){var ti=getHoverLabelText(Ne[Qa],!0,nt,rt,zn),ni=ti[0],di=ti[1],ji=Ne[Qa];ji.name=di,ji.text=""!==di?di+" : "+ni:ni;var Hi=ji.cd[ji.index];Hi&&(Hi.mc&&(ji.mc=Hi.mc),Hi.mcc&&(ji.mc=Hi.mcc),Hi.mlc&&(ji.mlc=Hi.mlc),Hi.mlcc&&(ji.mlc=Hi.mlcc),Hi.mlw&&(ji.mlw=Hi.mlw),Hi.mrc&&(ji.mrc=Hi.mrc),Hi.dir&&(ji.dir=Hi.dir)),ji._distinct=!0,Wa.entries.push([ji])}Wa.entries.sort((function(Ne,Ge){return Ne[0].trace.index-Ge[0].trace.index})),Wa.layer=Zt,Ar(Qe,Wa);var Yi=at.mean(Ne.map((function(Ne){return(Ne.y0+Ne.y1)/2}))),uo=at.mean(Ne.map((function(Ne){return(Ne.x0+Ne.x1)/2}))),go=Zt.select("g.legend"),ns=go.node().getBoundingClientRect();uo+=Cn._offset,Yi+=Dn._offset-ns.height/2;var as=ns.width+2*Pn;!(uo+as<=qn)&&uo-as>=0?uo-=as:uo+=2*Pn;var is=ns.height+2*Pn,os=Yi+is>=Yn;return is<=Yn&&(Yi<=Hn?Yi=Dn._offset+2*Pn:os&&(Yi=Yn-is)),go.attr("transform",it(uo,Yi)),go}var ss=Zt.selectAll("g.hovertext").data(Ne,(function(Ne){return hoverDataKey(Ne)}));return ss.enter().append("g").classed("hovertext",!0).each((function(){var Ne=tt.select(this);Ne.append("rect").call(Rt.fill,Rt.addOpacity(Dt,.8)),Ne.append("text").classed("name",!0),Ne.append("path").style("stroke-width","1px"),Ne.append("text").classed("nums",!0).call(Ot.font,mn,xn)})),ss.exit().remove(),ss.each((function(Ne){var Ge=tt.select(this).attr("transform",""),at=Ne.color;Array.isArray(at)&&(at=at[Ne.eventData[0].pointNumber]);var Zt=Ne.bgcolor||at,er=Rt.combine(Rt.opacity(Zt)?Zt:Rt.defaultLine,Dt),dr=Rt.combine(Rt.opacity(at)?at:Rt.defaultLine,Dt),mr=Ne.borderColor||Rt.contrast(er),xr=getHoverLabelText(Ne,$n,nt,rt,zn,Ge),br=xr[0],Ar=xr[1],kn=Ge.select("text.nums").call(Ot.font,Ne.fontFamily||mn,Ne.fontSize||xn,Ne.fontColor||mr).text(br).attr("data-notex",1).call(ht.positionText,0,0).call(ht.convertToTspans,Qe),Cn=Ge.select("text.name"),Dn=0,In=0;if(Ar&&Ar!==br){Cn.call(Ot.font,Ne.fontFamily||mn,Ne.fontSize||xn,dr).text(Ar).attr("data-notex",1).call(ht.positionText,0,0).call(ht.convertToTspans,Qe);var Bn=Cn.node().getBoundingClientRect();Dn=Bn.width+2*Pn,In=Bn.height+2*Pn}else Cn.remove(),Ge.select("rect").remove();Ge.select("path").style({fill:er,stroke:mr});var Vn,ra,oa=kn.node().getBoundingClientRect(),pa=Ne.xa._offset+(Ne.x0+Ne.x1)/2,ga=Ne.ya._offset+(Ne.y0+Ne.y1)/2,ma=Math.abs(Ne.x1-Ne.x0),_a=Math.abs(Ne.y1-Ne.y0),Va=oa.width+En+Pn+Dn;if(Ne.ty0=Hn-oa.top,Ne.bx=oa.width+2*Pn,Ne.by=Math.max(oa.height+2*Pn,In),Ne.anchor="start",Ne.txwidth=oa.width,Ne.tx2width=Dn,Ne.offset=0,dt)Ne.pos=pa,Vn=ga+_a/2+Va<=Yn,ra=ga-_a/2-Va>=0,"top"!==Ne.idealAlign&&Vn||!ra?Vn?(ga+=_a/2,Ne.anchor="start"):Ne.anchor="middle":(ga-=_a/2,Ne.anchor="end");else if(Ne.pos=ga,Vn=pa+ma/2+Va<=qn,ra=pa-ma/2-Va>=0,"left"!==Ne.idealAlign&&Vn||!ra)if(Vn)pa+=ma/2,Ne.anchor="start";else{Ne.anchor="middle";var Wa=Va/2,Qa=pa+Wa-qn,ti=pa-Wa;Qa>0&&(pa-=Qa),ti<0&&(pa+=-ti)}else pa-=ma/2,Ne.anchor="end";kn.attr("text-anchor",Ne.anchor),Dn&&Cn.attr("text-anchor",Ne.anchor),Ge.attr("transform",it(pa,ga)+(dt?ot(en):""))})),ss}function getHoverLabelText(Ne,Ge,Qe,tt,rt,nt){var it="",ot="";void 0!==Ne.nameOverride&&(Ne.name=Ne.nameOverride),Ne.name&&(Ne.trace._meta&&(Ne.name=at.templateString(Ne.name,Ne.trace._meta)),it=plainText(Ne.name,Ne.nameLength)),void 0!==Ne.zLabel?(void 0!==Ne.xLabel&&(ot+="x: "+Ne.xLabel+"<br>"),void 0!==Ne.yLabel&&(ot+="y: "+Ne.yLabel+"<br>"),"choropleth"!==Ne.trace.type&&"choroplethmapbox"!==Ne.trace.type&&(ot+=(ot?"z: ":"")+Ne.zLabel)):Ge&&Ne[Qe.charAt(0)+"Label"]===rt?ot=Ne[("x"===Qe.charAt(0)?"y":"x")+"Label"]||"":void 0===Ne.xLabel?void 0!==Ne.yLabel&&"scattercarpet"!==Ne.trace.type&&(ot=Ne.yLabel):ot=void 0===Ne.yLabel?Ne.xLabel:"("+Ne.xLabel+", "+Ne.yLabel+")",!Ne.text&&0!==Ne.text||Array.isArray(Ne.text)||(ot+=(ot?"<br>":"")+Ne.text),void 0!==Ne.extraText&&(ot+=(ot?"<br>":"")+Ne.extraText),nt&&""===ot&&!Ne.hovertemplate&&(""===it&&nt.remove(),ot=it);var dt=tt._d3locale,ht=Ne.hovertemplate||!1,Dt=Ne.hovertemplateLabels||Ne,Ot=Ne.eventData[0]||{};return ht&&(ot=(ot=at.hovertemplateString(ht,Dt,dt,Ot,Ne.trace._meta)).replace(Dn,(function(Ge,Qe){return it=plainText(Qe,Ne.nameLength),""}))),[ot,it]}function hoverAvoidOverlaps(Ne,Ge,Qe){var tt,rt,nt,at,it,ot,dt,ht=0,Dt=1,Ot=Ne.size(),Rt=new Array(Ot),Zt=0;function constrainGroup(Ne){var Ge=Ne[0],Qe=Ne[Ne.length-1];if(rt=Ge.pmin-Ge.pos-Ge.dp+Ge.size,nt=Qe.pos+Qe.dp+Qe.size-Ge.pmax,rt>.01){for(it=Ne.length-1;it>=0;it--)Ne[it].dp+=rt;tt=!1}if(!(nt<.01)){if(rt<-.01){for(it=Ne.length-1;it>=0;it--)Ne[it].dp-=nt;tt=!1}if(tt){var dt=0;for(at=0;at<Ne.length;at++)(ot=Ne[at]).pos+ot.dp+ot.size>Ge.pmax&&dt++;for(at=Ne.length-1;at>=0&&!(dt<=0);at--)(ot=Ne[at]).pos>Ge.pmax-1&&(ot.del=!0,dt--);for(at=0;at<Ne.length&&!(dt<=0);at++)if((ot=Ne[at]).pos<Ge.pmin+1)for(ot.del=!0,dt--,nt=2*ot.size,it=Ne.length-1;it>=0;it--)Ne[it].dp-=nt;for(at=Ne.length-1;at>=0&&!(dt<=0);at--)(ot=Ne[at]).pos+ot.dp+ot.size>Ge.pmax&&(ot.del=!0,dt--)}}}for(Ne.each((function(Ne){var tt=Ne[Ge],rt="x"===tt._id.charAt(0),nt=tt.range;0===Zt&&nt&&nt[0]>nt[1]!==rt&&(Dt=-1),Rt[Zt++]=[{datum:Ne,traceIndex:Ne.trace.index,dp:0,pos:Ne.pos,posref:Ne.posref,size:Ne.by*(rt?xn:1)/2,pmin:0,pmax:rt?Qe.width:Qe.height}]})),Rt.sort((function(Ne,Ge){return Ne[0].posref-Ge[0].posref||Dt*(Ge[0].traceIndex-Ne[0].traceIndex)}));!tt&&ht<=Ot;){for(ht++,tt=!0,at=0;at<Rt.length-1;){var er=Rt[at],dr=Rt[at+1],mr=er[er.length-1],xr=dr[0];if((rt=mr.pos+mr.dp+mr.size-xr.pos-xr.dp+xr.size)>.01&&mr.pmin===xr.pmin&&mr.pmax===xr.pmax){for(it=dr.length-1;it>=0;it--)dr[it].dp+=rt;for(er.push.apply(er,dr),Rt.splice(at+1,1),dt=0,it=er.length-1;it>=0;it--)dt+=er[it].dp;for(nt=dt/er.length,it=er.length-1;it>=0;it--)er[it].dp-=nt;tt=!1}else at++}Rt.forEach(constrainGroup)}for(at=Rt.length-1;at>=0;at--){var br=Rt[at];for(it=br.length-1;it>=0;it--){var Ar=br[it],en=Ar.datum;en.offset=Ar.dp,en.del=Ar.del}}}function alignHoverText(Ne,Ge,Qe,rt){var pX=function(Ne){return Ne*Qe},pY=function(Ne){return Ne*rt};Ne.each((function(Ne){var Qe=tt.select(this);if(Ne.del)return Qe.remove();var rt=Qe.select("text.nums"),nt=Ne.anchor,at="end"===nt?-1:1,it={start:1,end:-1,middle:0}[nt],ot=it*(En+Pn),dt=ot+it*(Ne.txwidth+Pn),Dt=0,Rt=Ne.offset,Zt="middle"===nt;Zt&&(ot-=Ne.tx2width/2,dt+=Ne.txwidth/2+Pn),Ge&&(Rt*=-Cn,Dt=Ne.offset*kn),Qe.select("path").attr("d",Zt?"M-"+pX(Ne.bx/2+Ne.tx2width/2)+","+pY(Rt-Ne.by/2)+"h"+pX(Ne.bx)+"v"+pY(Ne.by)+"h-"+pX(Ne.bx)+"Z":"M0,0L"+pX(at*En+Dt)+","+pY(En+Rt)+"v"+pY(Ne.by/2-En)+"h"+pX(at*Ne.bx)+"v-"+pY(Ne.by)+"H"+pX(at*En+Dt)+"V"+pY(Rt-En)+"Z");var er=Dt+ot,dr=Rt+Ne.ty0-Ne.by/2+Pn,mr=Ne.textAlign||"auto";"auto"!==mr&&("left"===mr&&"start"!==nt?(rt.attr("text-anchor","start"),er=Zt?-Ne.bx/2-Ne.tx2width/2+Pn:-Ne.bx-Pn):"right"===mr&&"end"!==nt&&(rt.attr("text-anchor","end"),er=Zt?Ne.bx/2-Ne.tx2width/2-Pn:Ne.bx+Pn)),rt.call(ht.positionText,pX(er),pY(dr)),Ne.tx2width&&(Qe.select("text.name").call(ht.positionText,pX(dt+it*Pn+Dt),pY(Rt+Ne.ty0-Ne.by/2+Pn)),Qe.select("rect").call(Ot.setRect,pX(dt+(it-1)*Ne.tx2width/2+Dt),pY(Rt-Ne.by/2-1),pX(Ne.tx2width),pY(Ne.by+2)))}))}function cleanPoint(Ne,Ge){var Qe=Ne.index,tt=Ne.trace||{},nt=Ne.cd[0],it=Ne.cd[Qe]||{};function pass(Ne){return Ne||rt(Ne)&&0===Ne}var ot=Array.isArray(Qe)?function(Ne,Ge){var rt=at.castOption(nt,Qe,Ne);return pass(rt)?rt:at.extractOption({},tt,"",Ge)}:function(Ne,Ge){return at.extractOption(it,tt,Ne,Ge)};function fill(Ge,Qe,tt){var rt=ot(Qe,tt);pass(rt)&&(Ne[Ge]=rt)}if(fill("hoverinfo","hi","hoverinfo"),fill("bgcolor","hbg","hoverlabel.bgcolor"),fill("borderColor","hbc","hoverlabel.bordercolor"),fill("fontFamily","htf","hoverlabel.font.family"),fill("fontSize","hts","hoverlabel.font.size"),fill("fontColor","htc","hoverlabel.font.color"),fill("nameLength","hnl","hoverlabel.namelength"),fill("textAlign","hta","hoverlabel.align"),Ne.posref="y"===Ge||"closest"===Ge&&"h"===tt.orientation?Ne.xa._offset+(Ne.x0+Ne.x1)/2:Ne.ya._offset+(Ne.y0+Ne.y1)/2,Ne.x0=at.constrain(Ne.x0,0,Ne.xa._length),Ne.x1=at.constrain(Ne.x1,0,Ne.xa._length),Ne.y0=at.constrain(Ne.y0,0,Ne.ya._length),Ne.y1=at.constrain(Ne.y1,0,Ne.ya._length),void 0!==Ne.xLabelVal&&(Ne.xLabel="xLabel"in Ne?Ne.xLabel:er.hoverLabelText(Ne.xa,Ne.xLabelVal),Ne.xVal=Ne.xa.c2d(Ne.xLabelVal)),void 0!==Ne.yLabelVal&&(Ne.yLabel="yLabel"in Ne?Ne.yLabel:er.hoverLabelText(Ne.ya,Ne.yLabelVal),Ne.yVal=Ne.ya.c2d(Ne.yLabelVal)),void 0!==Ne.zLabelVal&&void 0===Ne.zLabel&&(Ne.zLabel=String(Ne.zLabelVal)),!(isNaN(Ne.xerr)||"log"===Ne.xa.type&&Ne.xerr<=0)){var dt=er.tickText(Ne.xa,Ne.xa.c2l(Ne.xerr),"hover").text;void 0!==Ne.xerrneg?Ne.xLabel+=" +"+dt+" / -"+er.tickText(Ne.xa,Ne.xa.c2l(Ne.xerrneg),"hover").text:Ne.xLabel+=" Â± "+dt,"x"===Ge&&(Ne.distance+=1)}if(!(isNaN(Ne.yerr)||"log"===Ne.ya.type&&Ne.yerr<=0)){var ht=er.tickText(Ne.ya,Ne.ya.c2l(Ne.yerr),"hover").text;void 0!==Ne.yerrneg?Ne.yLabel+=" +"+ht+" / -"+er.tickText(Ne.ya,Ne.ya.c2l(Ne.yerrneg),"hover").text:Ne.yLabel+=" Â± "+ht,"y"===Ge&&(Ne.distance+=1)}var Dt=Ne.hoverinfo||Ne.trace.hoverinfo;return Dt&&"all"!==Dt&&(-1===(Dt=Array.isArray(Dt)?Dt:Dt.split("+")).indexOf("x")&&(Ne.xLabel=void 0),-1===Dt.indexOf("y")&&(Ne.yLabel=void 0),-1===Dt.indexOf("z")&&(Ne.zLabel=void 0),-1===Dt.indexOf("text")&&(Ne.text=void 0),-1===Dt.indexOf("name")&&(Ne.name=void 0)),Ne}function createSpikelines(Ne,Ge,Qe){var tt,rt,at=Qe.container,it=Qe.fullLayout,ot=it._size,dt=Qe.event,ht=!!Ge.hLinePoint,Dt=!!Ge.vLinePoint;if(at.selectAll(".spikeline").remove(),Dt||ht){var Zt=Rt.combine(it.plot_bgcolor,it.paper_bgcolor);if(ht){var dr,mr,xr=Ge.hLinePoint;tt=xr&&xr.xa,"cursor"===(rt=xr&&xr.ya).spikesnap?(dr=dt.pointerX,mr=dt.pointerY):(dr=tt._offset+xr.x,mr=rt._offset+xr.y);var br,Ar,en=nt.readability(xr.color,Zt)<1.5?Rt.contrast(Zt):xr.color,mn=rt.spikemode,xn=rt.spikethickness,kn=rt.spikecolor||en,Cn=er.getPxPosition(Ne,rt);if(-1!==mn.indexOf("toaxis")||-1!==mn.indexOf("across")){if(-1!==mn.indexOf("toaxis")&&(br=Cn,Ar=dr),-1!==mn.indexOf("across")){var En=rt._counterDomainMin,Pn=rt._counterDomainMax;"free"===rt.anchor&&(En=Math.min(En,rt.position),Pn=Math.max(Pn,rt.position)),br=ot.l+En*ot.w,Ar=ot.l+Pn*ot.w}at.insert("line",":first-child").attr({x1:br,x2:Ar,y1:mr,y2:mr,"stroke-width":xn,stroke:kn,"stroke-dasharray":Ot.dashStyle(rt.spikedash,xn)}).classed("spikeline",!0).classed("crisp",!0),at.insert("line",":first-child").attr({x1:br,x2:Ar,y1:mr,y2:mr,"stroke-width":xn+2,stroke:Zt}).classed("spikeline",!0).classed("crisp",!0)}-1!==mn.indexOf("marker")&&at.insert("circle",":first-child").attr({cx:Cn+("right"!==rt.side?xn:-xn),cy:mr,r:xn,fill:kn}).classed("spikeline",!0)}if(Dt){var Dn,In,zn=Ge.vLinePoint;tt=zn&&zn.xa,rt=zn&&zn.ya,"cursor"===tt.spikesnap?(Dn=dt.pointerX,In=dt.pointerY):(Dn=tt._offset+zn.x,In=rt._offset+zn.y);var Bn,Vn,Hn=nt.readability(zn.color,Zt)<1.5?Rt.contrast(Zt):zn.color,qn=tt.spikemode,Yn=tt.spikethickness,$n=tt.spikecolor||Hn,ra=er.getPxPosition(Ne,tt);if(-1!==qn.indexOf("toaxis")||-1!==qn.indexOf("across")){if(-1!==qn.indexOf("toaxis")&&(Bn=ra,Vn=In),-1!==qn.indexOf("across")){var oa=tt._counterDomainMin,pa=tt._counterDomainMax;"free"===tt.anchor&&(oa=Math.min(oa,tt.position),pa=Math.max(pa,tt.position)),Bn=ot.t+(1-pa)*ot.h,Vn=ot.t+(1-oa)*ot.h}at.insert("line",":first-child").attr({x1:Dn,x2:Dn,y1:Bn,y2:Vn,"stroke-width":Yn,stroke:$n,"stroke-dasharray":Ot.dashStyle(tt.spikedash,Yn)}).classed("spikeline",!0).classed("crisp",!0),at.insert("line",":first-child").attr({x1:Dn,x2:Dn,y1:Bn,y2:Vn,"stroke-width":Yn+2,stroke:Zt}).classed("spikeline",!0).classed("crisp",!0)}-1!==qn.indexOf("marker")&&at.insert("circle",":first-child").attr({cx:Dn,cy:ra-("top"!==tt.side?Yn:-Yn),r:Yn,fill:$n}).classed("spikeline",!0)}}}function hoverChanged(Ne,Ge,Qe){if(!Qe||Qe.length!==Ne._hoverdata.length)return!0;for(var tt=Qe.length-1;tt>=0;tt--){var rt=Qe[tt],nt=Ne._hoverdata[tt];if(rt.curveNumber!==nt.curveNumber||String(rt.pointNumber)!==String(nt.pointNumber)||String(rt.pointNumbers)!==String(nt.pointNumbers))return!0}return!1}function spikesChanged(Ne,Ge){return!Ge||Ge.vLinePoint!==Ne._spikepoints.vLinePoint||Ge.hLinePoint!==Ne._spikepoints.hLinePoint}function plainText(Ne,Ge){return ht.plainText(Ne||"",{len:Ge,allowedTags:["br","sub","sup","b","i","em"]})}},{"../../lib":778,"../../lib/events":767,"../../lib/override_cursor":789,"../../lib/svg_text_utils":803,"../../plots/cartesian/axes":828,"../../registry":911,"../color":643,"../dragelement":662,"../drawing":665,"../legend/defaults":695,"../legend/draw":696,"./constants":677,"./helpers":679,d3:169,"fast-isnumeric":241,tinycolor2:576}],681:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../color"),nt=Ne("./helpers").isUnifiedHover;Ge.exports=function(Ne,Ge,Qe,at){function inheritFontAttr(Ne){at.font[Ne]||(at.font[Ne]=Ge.legend?Ge.legend.font[Ne]:Ge.font[Ne])}at=at||{},Ge&&nt(Ge.hovermode)&&(at.font||(at.font={}),inheritFontAttr("size"),inheritFontAttr("family"),inheritFontAttr("color"),Ge.legend?(at.bgcolor||(at.bgcolor=rt.combine(Ge.legend.bgcolor,Ge.paper_bgcolor)),at.bordercolor||(at.bordercolor=Ge.legend.bordercolor)):at.bgcolor||(at.bgcolor=Ge.paper_bgcolor)),Qe("hoverlabel.bgcolor",at.bgcolor),Qe("hoverlabel.bordercolor",at.bordercolor),Qe("hoverlabel.namelength",at.namelength),tt.coerceFont(Qe,"hoverlabel.font",at.font),Qe("hoverlabel.align",at.align)}},{"../../lib":778,"../color":643,"./helpers":679}],682:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./layout_attributes");function isHoriz(Ne,Ge){for(var Qe=Ge._scatterStackOpts||{},tt=0;tt<Ne.length;tt++){var rt=Ne[tt],nt=(Qe[rt.xaxis+rt.yaxis]||{})[rt.stackgroup]||{};if("h"!==rt.orientation&&"h"!==nt.orientation)return!1}return!0}Ge.exports=function(Ne,Ge,Qe){function coerce(Qe,nt){return void 0!==Ge[Qe]?Ge[Qe]:tt.coerce(Ne,Ge,rt,Qe,nt)}var nt,at=coerce("clickmode");return Ge._has("cartesian")?at.indexOf("select")>-1?nt="closest":(Ge._isHoriz=isHoriz(Qe,Ge),nt=Ge._isHoriz?"y":"x"):nt="closest",coerce("hovermode",nt)}},{"../../lib":778,"./layout_attributes":684}],683:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../lib"),nt=Ne("../dragelement"),at=Ne("./helpers"),it=Ne("./layout_attributes"),ot=Ne("./hover");function loneUnhover(Ne){var Ge=rt.isD3Selection(Ne)?Ne:tt.select(Ne);Ge.selectAll("g.hovertext").remove(),Ge.selectAll(".spikeline").remove()}function castHoverOption(Ne,Ge,Qe){return rt.castOption(Ne,Ge,"hoverlabel."+Qe)}function castHoverinfo(Ne,Ge,Qe){function _coerce(Qe){return rt.coerceHoverinfo({hoverinfo:Qe},{_module:Ne._module},Ge)}return rt.castOption(Ne,Qe,"hoverinfo",_coerce)}Ge.exports={moduleType:"component",name:"fx",constants:Ne("./constants"),schema:{layout:it},attributes:Ne("./attributes"),layoutAttributes:it,supplyLayoutGlobalDefaults:Ne("./layout_global_defaults"),supplyDefaults:Ne("./defaults"),supplyLayoutDefaults:Ne("./layout_defaults"),calc:Ne("./calc"),getDistanceFunction:at.getDistanceFunction,getClosest:at.getClosest,inbox:at.inbox,quadrature:at.quadrature,appendArrayPointValue:at.appendArrayPointValue,castHoverOption:castHoverOption,castHoverinfo:castHoverinfo,hover:ot.hover,unhover:nt.unhover,loneHover:ot.loneHover,loneUnhover:loneUnhover,click:Ne("./click")}},{"../../lib":778,"../dragelement":662,"./attributes":674,"./calc":675,"./click":676,"./constants":677,"./defaults":678,"./helpers":679,"./hover":680,"./layout_attributes":684,"./layout_defaults":685,"./layout_global_defaults":686,d3:169}],684:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./constants"),rt=Ne("../../plots/font_attributes")({editType:"none"});rt.family.dflt=tt.HOVERFONT,rt.size.dflt=tt.HOVERFONTSIZE,Ge.exports={clickmode:{valType:"flaglist",flags:["event","select"],dflt:"event",editType:"plot",extras:["none"]},dragmode:{valType:"enumerated",values:["zoom","pan","select","lasso","drawclosedpath","drawopenpath","drawline","drawrect","drawcircle","orbit","turntable",!1],dflt:"zoom",editType:"modebar"},hovermode:{valType:"enumerated",values:["x","y","closest",!1,"x unified","y unified"],editType:"modebar"},hoverdistance:{valType:"integer",min:-1,dflt:20,editType:"none"},spikedistance:{valType:"integer",min:-1,dflt:20,editType:"none"},hoverlabel:{bgcolor:{valType:"color",editType:"none"},bordercolor:{valType:"color",editType:"none"},font:rt,align:{valType:"enumerated",values:["left","right","auto"],dflt:"auto",editType:"none"},namelength:{valType:"integer",min:-1,dflt:15,editType:"none"},editType:"none"},selectdirection:{valType:"enumerated",values:["h","v","d","any"],dflt:"any",editType:"none"}}},{"../../plots/font_attributes":856,"./constants":677}],685:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./helpers").isUnifiedHover,nt=Ne("./layout_attributes"),at=Ne("./hovermode_defaults"),it=Ne("./hoverlabel_defaults");Ge.exports=function(Ne,Ge,Qe){function coerce(Qe,rt){return tt.coerce(Ne,Ge,nt,Qe,rt)}var ot=at(Ne,Ge,Qe);ot&&(coerce("hoverdistance"),coerce("spikedistance",rt(ot)?-1:void 0)),"select"===coerce("dragmode")&&coerce("selectdirection");var dt=Ge._has("mapbox"),ht=Ge._has("geo"),Dt=Ge._basePlotModules.length;"zoom"===Ge.dragmode&&((dt||ht)&&1===Dt||dt&&ht&&2===Dt)&&(Ge.dragmode="pan"),it(Ne,Ge,coerce)}},{"../../lib":778,"./helpers":679,"./hoverlabel_defaults":681,"./hovermode_defaults":682,"./layout_attributes":684}],686:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./hoverlabel_defaults"),nt=Ne("./layout_attributes");Ge.exports=function(Ne,Ge){function coerce(Qe,rt){return tt.coerce(Ne,Ge,nt,Qe,rt)}rt(Ne,Ge,coerce)}},{"../../lib":778,"./hoverlabel_defaults":681,"./layout_attributes":684}],687:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../lib/regex").counter,nt=Ne("../../plots/domain").attributes,at=Ne("../../plots/cartesian/constants").idRegex,it=Ne("../../plot_api/plot_template"),ot={rows:{valType:"integer",min:1,editType:"plot"},roworder:{valType:"enumerated",values:["top to bottom","bottom to top"],dflt:"top to bottom",editType:"plot"},columns:{valType:"integer",min:1,editType:"plot"},subplots:{valType:"info_array",freeLength:!0,dimensions:2,items:{valType:"enumerated",values:[rt("xy").toString(),""],editType:"plot"},editType:"plot"},xaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[at.x.toString(),""],editType:"plot"},editType:"plot"},yaxes:{valType:"info_array",freeLength:!0,items:{valType:"enumerated",values:[at.y.toString(),""],editType:"plot"},editType:"plot"},pattern:{valType:"enumerated",values:["independent","coupled"],dflt:"coupled",editType:"plot"},xgap:{valType:"number",min:0,max:1,editType:"plot"},ygap:{valType:"number",min:0,max:1,editType:"plot"},domain:nt({name:"grid",editType:"plot",noGridCell:!0},{}),xside:{valType:"enumerated",values:["bottom","bottom plot","top plot","top"],dflt:"bottom plot",editType:"plot"},yside:{valType:"enumerated",values:["left","left plot","right plot","right"],dflt:"left plot",editType:"plot"},editType:"plot"};function getAxes(Ne,Ge,Qe){var tt=Ge[Qe+"axes"],rt=Object.keys((Ne._splomAxes||{})[Qe]||{});return Array.isArray(tt)?tt:rt.length?rt:void 0}function sizeDefaults(Ne,Ge){var Qe=Ne.grid||{},rt=getAxes(Ge,Qe,"x"),nt=getAxes(Ge,Qe,"y");if(Ne.grid||rt||nt){var at,dt,ht=Array.isArray(Qe.subplots)&&Array.isArray(Qe.subplots[0]),Dt=Array.isArray(rt),Ot=Array.isArray(nt),Rt=Dt&&rt!==Qe.xaxes&&Ot&&nt!==Qe.yaxes;ht?(at=Qe.subplots.length,dt=Qe.subplots[0].length):(Ot&&(at=nt.length),Dt&&(dt=rt.length));var Zt=it.newContainer(Ge,"grid"),er=coerce("rows",at),dr=coerce("columns",dt);if(er*dr>1){ht||Dt||Ot||"independent"===coerce("pattern")&&(ht=!0),Zt._hasSubplotGrid=ht;var mr,xr,br="top to bottom"===coerce("roworder"),Ar=ht?.2:.1,en=ht?.3:.1;Rt&&Ge._splomGridDflt&&(mr=Ge._splomGridDflt.xside,xr=Ge._splomGridDflt.yside),Zt._domains={x:fillGridPositions("x",coerce,Ar,mr,dr),y:fillGridPositions("y",coerce,en,xr,er,br)}}else delete Ge.grid}function coerce(Ne,Ge){return tt.coerce(Qe,Zt,ot,Ne,Ge)}}function fillGridPositions(Ne,Ge,Qe,tt,rt,nt){var at=Ge(Ne+"gap",Qe),it=Ge("domain."+Ne);Ge(Ne+"side",tt);for(var ot=new Array(rt),dt=it[0],ht=(it[1]-dt)/(rt-at),Dt=ht*(1-at),Ot=0;Ot<rt;Ot++){var Rt=dt+ht*Ot;ot[nt?rt-1-Ot:Ot]=[Rt,Rt+Dt]}return ot}function contentDefaults(Ne,Ge){var Qe=Ge.grid;if(Qe&&Qe._domains){var tt,rt,nt,at,it,ot,dt,ht=Ne.grid||{},Dt=Ge._subplots,Ot=Qe._hasSubplotGrid,Rt=Qe.rows,Zt=Qe.columns,er="independent"===Qe.pattern,dr=Qe._axisMap={};if(Ot){var mr=ht.subplots||[];ot=Qe.subplots=new Array(Rt);var xr=1;for(tt=0;tt<Rt;tt++){var br=ot[tt]=new Array(Zt),Ar=mr[tt]||[];for(rt=0;rt<Zt;rt++)if(er?(it=1===xr?"xy":"x"+xr+"y"+xr,xr++):it=Ar[rt],br[rt]="",-1!==Dt.cartesian.indexOf(it)){if(dt=it.indexOf("y"),nt=it.slice(0,dt),at=it.slice(dt),void 0!==dr[nt]&&dr[nt]!==rt||void 0!==dr[at]&&dr[at]!==tt)continue;br[rt]=it,dr[nt]=rt,dr[at]=tt}}}else{var en=getAxes(Ge,ht,"x"),mn=getAxes(Ge,ht,"y");Qe.xaxes=fillGridAxes(en,Dt.xaxis,Zt,dr,"x"),Qe.yaxes=fillGridAxes(mn,Dt.yaxis,Rt,dr,"y")}var xn=Qe._anchors={},kn="top to bottom"===Qe.roworder;for(var Cn in dr){var En,Pn,Dn,In=Cn.charAt(0),zn=Qe[In+"side"];if(zn.length<8)xn[Cn]="free";else if("x"===In){if("t"===zn.charAt(0)===kn?(En=0,Pn=1,Dn=Rt):(En=Rt-1,Pn=-1,Dn=-1),Ot){var Bn=dr[Cn];for(tt=En;tt!==Dn;tt+=Pn)if((it=ot[tt][Bn])&&(dt=it.indexOf("y"),it.slice(0,dt)===Cn)){xn[Cn]=it.slice(dt);break}}else for(tt=En;tt!==Dn;tt+=Pn)if(at=Qe.yaxes[tt],-1!==Dt.cartesian.indexOf(Cn+at)){xn[Cn]=at;break}}else if("l"===zn.charAt(0)?(En=0,Pn=1,Dn=Zt):(En=Zt-1,Pn=-1,Dn=-1),Ot){var Vn=dr[Cn];for(tt=En;tt!==Dn;tt+=Pn)if((it=ot[Vn][tt])&&(dt=it.indexOf("y"),it.slice(dt)===Cn)){xn[Cn]=it.slice(0,dt);break}}else for(tt=En;tt!==Dn;tt+=Pn)if(nt=Qe.xaxes[tt],-1!==Dt.cartesian.indexOf(nt+Cn)){xn[Cn]=nt;break}}}}function fillGridAxes(Ne,Ge,Qe,tt,rt){var nt,at=new Array(Qe);function fillOneAxis(Ne,Qe){-1!==Ge.indexOf(Qe)&&void 0===tt[Qe]?(at[Ne]=Qe,tt[Qe]=Ne):at[Ne]=""}if(Array.isArray(Ne))for(nt=0;nt<Qe;nt++)fillOneAxis(nt,Ne[nt]);else for(fillOneAxis(0,rt),nt=1;nt<Qe;nt++)fillOneAxis(nt,rt+(nt+1));return at}Ge.exports={moduleType:"component",name:"grid",schema:{layout:{grid:ot}},layoutAttributes:ot,sizeDefaults:sizeDefaults,contentDefaults:contentDefaults}},{"../../lib":778,"../../lib/regex":795,"../../plot_api/plot_template":817,"../../plots/cartesian/constants":834,"../../plots/domain":855}],688:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/cartesian/constants"),rt=Ne("../../plot_api/plot_template").templatedArray;Ne("../../constants/axis_placeable_objects"),Ge.exports=rt("image",{visible:{valType:"boolean",dflt:!0,editType:"arraydraw"},source:{valType:"string",editType:"arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},sizex:{valType:"number",dflt:0,editType:"arraydraw"},sizey:{valType:"number",dflt:0,editType:"arraydraw"},sizing:{valType:"enumerated",values:["fill","contain","stretch"],dflt:"contain",editType:"arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},x:{valType:"any",dflt:0,editType:"arraydraw"},y:{valType:"any",dflt:0,editType:"arraydraw"},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left",editType:"arraydraw"},yanchor:{valType:"enumerated",values:["top","middle","bottom"],dflt:"top",editType:"arraydraw"},xref:{valType:"enumerated",values:["paper",tt.idRegex.x.toString()],dflt:"paper",editType:"arraydraw"},yref:{valType:"enumerated",values:["paper",tt.idRegex.y.toString()],dflt:"paper",editType:"arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":746,"../../plot_api/plot_template":817,"../../plots/cartesian/constants":834}],689:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../lib/to_log_range");Ge.exports=function(Ne,Ge,Qe,nt){Ge=Ge||{};var at="log"===Qe&&"linear"===Ge.type,it="linear"===Qe&&"log"===Ge.type;if(at||it)for(var ot,dt,ht=Ne._fullLayout.images,Dt=Ge._id.charAt(0),Ot=0;Ot<ht.length;Ot++)if(dt="images["+Ot+"].",(ot=ht[Ot])[Dt+"ref"]===Ge._id){var Rt=ot[Dt],Zt=ot["size"+Dt],er=null,dr=null;if(at){er=rt(Rt,Ge.range);var mr=Zt/Math.pow(10,er)/2;dr=2*Math.log(mr+Math.sqrt(1+mr*mr))/Math.LN10}else dr=(er=Math.pow(10,Rt))*(Math.pow(10,Zt/2)-Math.pow(10,-Zt/2));tt(er)?tt(dr)||(dr=null):(er=null,dr=null),nt(dt+Dt,er),nt(dt+"size"+Dt,dr)}}},{"../../lib/to_log_range":805,"fast-isnumeric":241}],690:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../plots/cartesian/axes"),nt=Ne("../../plots/array_container_defaults"),at=Ne("./attributes"),it="images";function imageDefaults(Ne,Ge,Qe){function coerce(Qe,rt){return tt.coerce(Ne,Ge,at,Qe,rt)}var nt=coerce("source");if(!coerce("visible",!!nt))return Ge;coerce("layer"),coerce("xanchor"),coerce("yanchor"),coerce("sizex"),coerce("sizey"),coerce("sizing"),coerce("opacity");for(var it={_fullLayout:Qe},ot=["x","y"],dt=0;dt<2;dt++){var ht=ot[dt],Dt=rt.coerceRef(Ne,Ge,it,ht,"paper",void 0);"paper"!==Dt&&rt.getFromId(it,Dt)._imgIndices.push(Ge._index),rt.coercePosition(Ge,it,coerce,Dt,ht,0)}return Ge}Ge.exports=function(Ne,Ge){nt(Ne,Ge,{name:it,handleItemDefaults:imageDefaults})}},{"../../lib":778,"../../plots/array_container_defaults":823,"../../plots/cartesian/axes":828,"./attributes":688}],691:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../drawing"),nt=Ne("../../plots/cartesian/axes"),at=Ne("../../plots/cartesian/axis_ids"),it=Ne("../../constants/xmlns_namespaces");Ge.exports=function(Ne){var Ge,Qe,ot=Ne._fullLayout,dt=[],ht={},Dt=[];for(Qe=0;Qe<ot.images.length;Qe++){var Ot=ot.images[Qe];if(Ot.visible)if("below"===Ot.layer&&"paper"!==Ot.xref&&"paper"!==Ot.yref){Ge=at.ref2id(Ot.xref)+at.ref2id(Ot.yref);var Rt=ot._plots[Ge];if(!Rt){Dt.push(Ot);continue}Rt.mainplot&&(Ge=Rt.mainplot.id),ht[Ge]||(ht[Ge]=[]),ht[Ge].push(Ot)}else"above"===Ot.layer?dt.push(Ot):Dt.push(Ot)}var Zt={x:{left:{sizing:"xMin",offset:0},center:{sizing:"xMid",offset:-.5},right:{sizing:"xMax",offset:-1}},y:{top:{sizing:"YMin",offset:0},middle:{sizing:"YMid",offset:-.5},bottom:{sizing:"YMax",offset:-1}}};function setImage(Ge){var Qe=tt.select(this);if(this._imgSrc!==Ge.source)if(Qe.attr("xmlns",it.svg),Ge.source&&"data:"===Ge.source.slice(0,5))Qe.attr("xlink:href",Ge.source),this._imgSrc=Ge.source;else{var rt=new Promise(function(Ne){var tt=new Image;function errorHandler(){Qe.remove(),Ne()}this.img=tt,tt.setAttribute("crossOrigin","anonymous"),tt.onerror=errorHandler,tt.onload=function(){var Ge=document.createElement("canvas");Ge.width=this.width,Ge.height=this.height,Ge.getContext("2d").drawImage(this,0,0);var tt=Ge.toDataURL("image/png");Qe.attr("xlink:href",tt),Ne()},Qe.on("error",errorHandler),tt.src=Ge.source,this._imgSrc=Ge.source}.bind(this));Ne._promises.push(rt)}}function applyAttributes(Ge){var Qe,at,it=tt.select(this),dt=nt.getFromId(Ne,Ge.xref),ht=nt.getFromId(Ne,Ge.yref),Dt="domain"===nt.getRefType(Ge.xref),Ot="domain"===nt.getRefType(Ge.yref),Rt=ot._size;Qe=void 0!==dt?"string"==typeof Ge.xref&&Dt?dt._length*Ge.sizex:Math.abs(dt.l2p(Ge.sizex)-dt.l2p(0)):Ge.sizex*Rt.w,at=void 0!==ht?"string"==typeof Ge.yref&&Ot?ht._length*Ge.sizey:Math.abs(ht.l2p(Ge.sizey)-ht.l2p(0)):Ge.sizey*Rt.h;var er,dr,mr=Qe*Zt.x[Ge.xanchor].offset,xr=at*Zt.y[Ge.yanchor].offset,br=Zt.x[Ge.xanchor].sizing+Zt.y[Ge.yanchor].sizing;switch(er=void 0!==dt?"string"==typeof Ge.xref&&Dt?dt._length*Ge.x+dt._offset:dt.r2p(Ge.x)+dt._offset:Ge.x*Rt.w+Rt.l,er+=mr,dr=void 0!==ht?"string"==typeof Ge.yref&&Ot?ht._length*(1-Ge.y)+ht._offset:ht.r2p(Ge.y)+ht._offset:Rt.h-Ge.y*Rt.h+Rt.t,dr+=xr,Ge.sizing){case"fill":br+=" slice";break;case"stretch":br="none"}it.attr({x:er,y:dr,width:Qe,height:at,preserveAspectRatio:br,opacity:Ge.opacity});var Ar=(dt&&"domain"!==nt.getRefType(Ge.xref)?dt._id:"")+(ht&&"domain"!==nt.getRefType(Ge.yref)?ht._id:"");rt.setClipUrl(it,Ar?"clip"+ot._uid+Ar:null,Ne)}var er=ot._imageLowerLayer.selectAll("image").data(Dt),dr=ot._imageUpperLayer.selectAll("image").data(dt);er.enter().append("image"),dr.enter().append("image"),er.exit().remove(),dr.exit().remove(),er.each((function(Ne){setImage.bind(this)(Ne),applyAttributes.bind(this)(Ne)})),dr.each((function(Ne){setImage.bind(this)(Ne),applyAttributes.bind(this)(Ne)}));var mr=Object.keys(ot._plots);for(Qe=0;Qe<mr.length;Qe++){Ge=mr[Qe];var xr=ot._plots[Ge];if(xr.imagelayer){var br=xr.imagelayer.selectAll("image").data(ht[Ge]||[]);br.enter().append("image"),br.exit().remove(),br.each((function(Ne){setImage.bind(this)(Ne),applyAttributes.bind(this)(Ne)}))}}}},{"../../constants/xmlns_namespaces":754,"../../plots/cartesian/axes":828,"../../plots/cartesian/axis_ids":831,"../drawing":665,d3:169}],692:[function(Ne,Ge,Qe){"use strict";Ge.exports={moduleType:"component",name:"images",layoutAttributes:Ne("./attributes"),supplyLayoutDefaults:Ne("./defaults"),includeBasePlot:Ne("../../plots/cartesian/include_components")("images"),draw:Ne("./draw"),convertCoords:Ne("./convert_coords")}},{"../../plots/cartesian/include_components":840,"./attributes":688,"./convert_coords":689,"./defaults":690,"./draw":691}],693:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/font_attributes"),rt=Ne("../color/attributes");Ge.exports={bgcolor:{valType:"color",editType:"legend"},bordercolor:{valType:"color",dflt:rt.defaultLine,editType:"legend"},borderwidth:{valType:"number",min:0,dflt:0,editType:"legend"},font:tt({editType:"legend"}),orientation:{valType:"enumerated",values:["v","h"],dflt:"v",editType:"legend"},traceorder:{valType:"flaglist",flags:["reversed","grouped"],extras:["normal"],editType:"legend"},tracegroupgap:{valType:"number",min:0,dflt:10,editType:"legend"},itemsizing:{valType:"enumerated",values:["trace","constant"],dflt:"trace",editType:"legend"},itemwidth:{valType:"number",min:30,dflt:30,editType:"legend"},itemclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggle",editType:"legend"},itemdoubleclick:{valType:"enumerated",values:["toggle","toggleothers",!1],dflt:"toggleothers",editType:"legend"},x:{valType:"number",min:-2,max:3,editType:"legend"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"legend"},y:{valType:"number",min:-2,max:3,editType:"legend"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],editType:"legend"},uirevision:{valType:"any",editType:"none"},valign:{valType:"enumerated",values:["top","middle","bottom"],dflt:"middle",editType:"legend"},title:{text:{valType:"string",dflt:"",editType:"legend"},font:tt({editType:"legend"}),side:{valType:"enumerated",values:["top","left","top left"],editType:"legend"},editType:"legend"},editType:"legend"}},{"../../plots/font_attributes":856,"../color/attributes":642}],694:[function(Ne,Ge,Qe){"use strict";Ge.exports={scrollBarWidth:6,scrollBarMinHeight:20,scrollBarColor:"#808BA4",scrollBarMargin:4,scrollBarEnterAttrs:{rx:20,ry:3,width:0,height:0},titlePad:2,itemGap:5}},{}],695:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../registry"),rt=Ne("../../lib"),nt=Ne("../../plot_api/plot_template"),at=Ne("./attributes"),it=Ne("../../plots/layout_attributes"),ot=Ne("./helpers");Ge.exports=function(Ne,Ge,Qe){for(var dt=Ne.legend||{},ht=0,Dt=!1,Ot="normal",Rt=0;Rt<Qe.length;Rt++){var Zt=Qe[Rt];Zt.visible&&((Zt.showlegend||Zt._dfltShowLegend&&!(Zt._module&&Zt._module.attributes&&Zt._module.attributes.showlegend&&!1===Zt._module.attributes.showlegend.dflt))&&(ht++,Zt.showlegend&&(Dt=!0,(tt.traceIs(Zt,"pie-like")||!0===Zt._input.showlegend)&&ht++)),(tt.traceIs(Zt,"bar")&&"stack"===Ge.barmode||-1!==["tonextx","tonexty"].indexOf(Zt.fill))&&(Ot=ot.isGrouped({traceorder:Ot})?"grouped+reversed":"reversed"),void 0!==Zt.legendgroup&&""!==Zt.legendgroup&&(Ot=ot.isReversed({traceorder:Ot})?"reversed+grouped":"grouped"))}var er=rt.coerce(Ne,Ge,it,"showlegend",Dt&&ht>1);if(!1!==er||dt.uirevision){var dr=nt.newContainer(Ge,"legend");if(coerce("uirevision",Ge.uirevision),!1!==er){coerce("bgcolor",Ge.paper_bgcolor),coerce("bordercolor"),coerce("borderwidth"),rt.coerceFont(coerce,"font",Ge.font);var mr,xr,br,Ar=coerce("orientation");"h"===Ar?(mr=0,tt.getComponentMethod("rangeslider","isVisible")(Ne.xaxis)?(xr=1.1,br="bottom"):(xr=-.1,br="top")):(mr=1.02,xr=1,br="auto"),coerce("traceorder",Ot),ot.isGrouped(Ge.legend)&&coerce("tracegroupgap"),coerce("itemsizing"),coerce("itemwidth"),coerce("itemclick"),coerce("itemdoubleclick"),coerce("x",mr),coerce("xanchor"),coerce("y",xr),coerce("yanchor",br),coerce("valign"),rt.noneOrAll(dt,dr,["x","y"]),coerce("title.text")&&(coerce("title.side","h"===Ar?"left":"top"),rt.coerceFont(coerce,"title.font",Ge.font))}}function coerce(Ne,Ge){return rt.coerce(dt,dr,at,Ne,Ge)}}},{"../../lib":778,"../../plot_api/plot_template":817,"../../plots/layout_attributes":882,"../../registry":911,"./attributes":693,"./helpers":699}],696:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../lib"),nt=Ne("../../plots/plots"),at=Ne("../../registry"),it=Ne("../../lib/events"),ot=Ne("../dragelement"),dt=Ne("../drawing"),ht=Ne("../color"),Dt=Ne("../../lib/svg_text_utils"),Ot=Ne("./handle_click"),Rt=Ne("./constants"),Zt=Ne("../../constants/alignment"),er=Zt.LINE_SPACING,dr=Zt.FROM_TL,mr=Zt.FROM_BR,xr=Ne("./get_legend_data"),br=Ne("./style"),Ar=Ne("./helpers");function clickOrDoubleClick(Ne,Ge,Qe,tt,rt){var nt=Qe.data()[0][0].trace,ot={event:rt,node:Qe.node(),curveNumber:nt.index,expandedIndex:nt._expandedIndex,data:Ne.data,layout:Ne.layout,frames:Ne._transitionData._frames,config:Ne._context,fullData:Ne._fullData,fullLayout:Ne._fullLayout};nt._group&&(ot.group=nt._group),at.traceIs(nt,"pie-like")&&(ot.label=Qe.datum()[0].label),!1!==it.triggerHandler(Ne,"plotly_legendclick",ot)&&(1===tt?Ge._clickTimeout=setTimeout((function(){Ot(Qe,Ne,tt)}),Ne._context.doubleClickDelay):2===tt&&(Ge._clickTimeout&&clearTimeout(Ge._clickTimeout),Ne._legendMouseDownTime=0,!1!==it.triggerHandler(Ne,"plotly_legenddoubleclick",ot)&&Ot(Qe,Ne,tt)))}function drawTexts(Ne,Ge,Qe){var tt,nt=Ne.data()[0][0],it=nt.trace,ot=at.traceIs(it,"pie-like"),ht=it.index,Ot=Qe._main&&Ge._context.edits.legendText&&!ot,Zt=Qe._maxNameLength;Qe.entries?tt=nt.text:(tt=ot?nt.label:it.name,it._meta&&(tt=rt.templateString(tt,it._meta)));var er=rt.ensureSingle(Ne,"text","legendtext");er.attr("text-anchor","start").call(dt.font,Qe.font).text(Ot?ensureLength(tt,Zt):tt);var dr=Qe.itemwidth+2*Rt.itemGap;Dt.positionText(er,dr,0),Ot?er.call(Dt.makeEditable,{gd:Ge,text:tt}).call(textLayout,Ne,Ge,Qe).on("edit",(function(tt){this.text(ensureLength(tt,Zt)).call(textLayout,Ne,Ge,Qe);var it=nt.trace._fullInput||{},ot={};if(at.hasTransform(it,"groupby")){var dt=at.getTransformIndices(it,"groupby"),Dt=dt[dt.length-1],Ot=rt.keyedContainer(it,"transforms["+Dt+"].styles","target","value.name");Ot.set(nt.trace._group,tt),ot=Ot.constructUpdate()}else ot.name=tt;return at.call("_guiRestyle",Ge,ot,ht)})):textLayout(er,Ne,Ge,Qe)}function ensureLength(Ne,Ge){var Qe=Math.max(4,Ge);if(Ne&&Ne.trim().length>=Qe/2)return Ne;for(var tt=Qe-(Ne=Ne||"").length;tt>0;tt--)Ne+=" ";return Ne}function setupTraceToggle(Ne,Ge){var Qe,nt=Ge._context.doubleClickDelay,at=1,it=rt.ensureSingle(Ne,"rect","legendtoggle",(function(Ne){Ge._context.staticPlot||Ne.style("cursor","pointer").attr("pointer-events","all"),Ne.call(ht.fill,"rgba(0,0,0,0)")}));Ge._context.staticPlot||(it.on("mousedown",(function(){(Qe=(new Date).getTime())-Ge._legendMouseDownTime<nt?at+=1:(at=1,Ge._legendMouseDownTime=Qe)})),it.on("mouseup",(function(){if(!Ge._dragged&&!Ge._editing){var Qe=Ge._fullLayout.legend;(new Date).getTime()-Ge._legendMouseDownTime>nt&&(at=Math.max(at-1,1)),clickOrDoubleClick(Ge,Qe,Ne,at,tt.event)}})))}function textLayout(Ne,Ge,Qe,tt){tt._main||Ne.attr("data-notex",!0),Dt.convertToTspans(Ne,Qe,(function(){computeTextDimensions(Ge,Qe,tt)}))}function computeTextDimensions(Ne,Ge,Qe){var tt=Ne.data()[0][0];if(Qe._main&&tt&&!tt.trace.showlegend)Ne.remove();else{var rt=Ne.select("g[class*=math-group]"),nt=rt.node();Qe||(Qe=Ge._fullLayout.legend);var at,it,ot=Qe.borderwidth,ht=(tt?Qe:Qe.title).font.size*er;if(nt){var Ot=dt.bBox(nt);at=Ot.height,it=Ot.width,tt?dt.setTranslate(rt,0,.25*at):dt.setTranslate(rt,ot,.75*at+ot)}else{var Zt=Ne.select(tt?".legendtext":".legendtitletext"),dr=Dt.lineCount(Zt),mr=Zt.node();at=ht*dr,it=mr?dt.bBox(mr).width:0;var xr=ht*((dr-1)/2-.3);if(tt){var br=Qe.itemwidth+2*Rt.itemGap;Dt.positionText(Zt,br,-xr)}else Dt.positionText(Zt,Rt.titlePad+ot,ht+ot)}tt?(tt.lineHeight=ht,tt.height=Math.max(at,16)+3,tt.width=it):(Qe._titleWidth=it,Qe._titleHeight=at)}}function getTitleSize(Ne){var Ge=0,Qe=0,tt=Ne.title.side;return tt&&(-1!==tt.indexOf("left")&&(Ge=Ne._titleWidth),-1!==tt.indexOf("top")&&(Qe=Ne._titleHeight)),[Ge,Qe]}function computeLegendDimensions(Ne,Ge,Qe,rt){var nt=Ne._fullLayout;rt||(rt=nt.legend);var at=nt._size,it=Ar.isVertical(rt),ot=Ar.isGrouped(rt),ht=rt.borderwidth,Dt=2*ht,Ot=Rt.itemGap,Zt=rt.itemwidth+2*Ot,er=2*(ht+Ot),dr=getYanchor(rt),mr=rt.y<0||0===rt.y&&"top"===dr,xr=rt.y>1||1===rt.y&&"bottom"===dr;rt._maxHeight=Math.max(mr||xr?nt.height/2:at.h,30);var br=0;rt._width=0,rt._height=0;var en=getTitleSize(rt);if(it)Qe.each((function(Ne){var Ge=Ne[0].height;dt.setTranslate(this,ht+en[0],ht+en[1]+rt._height+Ge/2+Ot),rt._height+=Ge,rt._width=Math.max(rt._width,Ne[0].width)})),br=Zt+rt._width,rt._width+=Ot+Zt+Dt,rt._height+=er,ot&&(Ge.each((function(Ne,Ge){dt.setTranslate(this,0,Ge*rt.tracegroupgap)})),rt._height+=(rt._lgroupsLength-1)*rt.tracegroupgap);else{var mn=getXanchor(rt),xn=rt.x<0||0===rt.x&&"right"===mn,kn=rt.x>1||1===rt.x&&"left"===mn,Cn=xr||mr,En=nt.width/2;rt._maxWidth=Math.max(xn?Cn&&"left"===mn?at.l+at.w:En:kn?Cn&&"right"===mn?at.r+at.w:En:at.w,2*Zt);var Pn=0,Dn=0;Qe.each((function(Ne){var Ge=Ne[0].width+Zt;Pn=Math.max(Pn,Ge),Dn+=Ge})),br=null;var In=0;if(ot){var zn=0,Bn=0,Vn=0;Ge.each((function(){var Ne=0,Ge=0;tt.select(this).selectAll("g.traces").each((function(Qe){var tt=Qe[0].height;dt.setTranslate(this,en[0],en[1]+ht+Ot+tt/2+Ge),Ge+=tt,Ne=Math.max(Ne,Zt+Qe[0].width)})),zn=Math.max(zn,Ge);var Qe=Ne+Ot;Qe+ht+Bn>rt._maxWidth&&(In=Math.max(In,Bn),Bn=0,Vn+=zn+rt.tracegroupgap,zn=Ge),dt.setTranslate(this,Bn,Vn),Bn+=Qe})),rt._width=Math.max(In,Bn)+ht,rt._height=Vn+zn+er}else{var Hn=Qe.size(),qn=Dn+Dt+(Hn-1)*Ot<rt._maxWidth,Yn=0,$n=0,ra=0,oa=0;Qe.each((function(Ne){var Ge=Ne[0].height,Qe=Zt+Ne[0].width,tt=(qn?Qe:Pn)+Ot;tt+ht+$n-Ot>=rt._maxWidth&&(In=Math.max(In,oa),$n=0,ra+=Yn,rt._height+=Yn,Yn=0),dt.setTranslate(this,en[0]+ht+$n,en[1]+ht+ra+Ge/2+Ot),oa=$n+Qe+Ot,$n+=tt,Yn=Math.max(Yn,Ge)})),qn?(rt._width=$n+Dt,rt._height=Yn+er):(rt._width=Math.max(In,oa)+Dt,rt._height+=Yn+er)}}rt._width=Math.ceil(Math.max(rt._width+en[0],rt._titleWidth+2*(ht+Rt.titlePad))),rt._height=Math.ceil(Math.max(rt._height+en[1],rt._titleHeight+2*(ht+Rt.itemGap))),rt._effHeight=Math.min(rt._height,rt._maxHeight);var pa=Ne._context.edits,ga=pa.legendText||pa.legendPosition;Qe.each((function(Ne){var Ge=tt.select(this).select(".legendtoggle"),Qe=Ne[0].height,rt=ga?Zt:br||Zt+Ne[0].width;it||(rt+=Ot/2),dt.setRect(Ge,0,-Qe/2,rt,Qe)}))}function expandMargin(Ne){var Ge=Ne._fullLayout.legend,Qe=getXanchor(Ge),tt=getYanchor(Ge);return nt.autoMargin(Ne,"legend",{x:Ge.x,y:Ge.y,l:Ge._width*dr[Qe],r:Ge._width*mr[Qe],b:Ge._effHeight*mr[tt],t:Ge._effHeight*dr[tt]})}function getXanchor(Ne){return rt.isRightAnchor(Ne)?"right":rt.isCenterAnchor(Ne)?"center":"left"}function getYanchor(Ne){return rt.isBottomAnchor(Ne)?"bottom":rt.isMiddleAnchor(Ne)?"middle":"top"}Ge.exports=function(Ne,Ge){var Qe,it=Ne._fullLayout,Dt="legend"+it._uid;if(Ge?(Qe=Ge.layer,Dt+="-hover"):((Ge=it.legend||{})._main=!0,Qe=it._infolayer),Qe){var Ot;if(Ne._legendMouseDownTime||(Ne._legendMouseDownTime=0),Ge._main){if(!Ne.calcdata)return;Ot=it.showlegend&&xr(Ne.calcdata,Ge)}else{if(!Ge.entries)return;Ot=xr(Ge.entries,Ge)}var Zt=it.hiddenlabels||[];if(Ge._main&&(!it.showlegend||!Ot.length))return Qe.selectAll(".legend").remove(),it._topdefs.select("#"+Dt).remove(),nt.autoMargin(Ne,"legend");var er=rt.ensureSingle(Qe,"g","legend",(function(Ne){Ge._main&&Ne.attr("pointer-events","all")})),mr=rt.ensureSingleById(it._topdefs,"clipPath",Dt,(function(Ne){Ne.append("rect")})),Ar=rt.ensureSingle(er,"rect","bg",(function(Ne){Ne.attr("shape-rendering","crispEdges")}));Ar.call(ht.stroke,Ge.bordercolor).call(ht.fill,Ge.bgcolor).style("stroke-width",Ge.borderwidth+"px");var en=rt.ensureSingle(er,"g","scrollbox"),mn=Ge.title;if(Ge._titleWidth=0,Ge._titleHeight=0,mn.text){var xn=rt.ensureSingle(en,"text","legendtitletext");xn.attr("text-anchor","start").call(dt.font,mn.font).text(mn.text),textLayout(xn,en,Ne,Ge)}else en.selectAll(".legendtitletext").remove();var kn=rt.ensureSingle(er,"rect","scrollbar",(function(Ne){Ne.attr(Rt.scrollBarEnterAttrs).call(ht.fill,Rt.scrollBarColor)})),Cn=en.selectAll("g.groups").data(Ot);Cn.enter().append("g").attr("class","groups"),Cn.exit().remove();var En=Cn.selectAll("g.traces").data(rt.identity);En.enter().append("g").attr("class","traces"),En.exit().remove(),En.style("opacity",(function(Ne){var Ge=Ne[0].trace;return at.traceIs(Ge,"pie-like")?-1!==Zt.indexOf(Ne[0].label)?.5:1:"legendonly"===Ge.visible?.5:1})).each((function(){tt.select(this).call(drawTexts,Ne,Ge)})).call(br,Ne,Ge).each((function(){Ge._main&&tt.select(this).call(setupTraceToggle,Ne)})),rt.syncOrAsync([nt.previousPromises,function(){return computeLegendDimensions(Ne,Cn,En,Ge)},function(){if(!Ge._main||!expandMargin(Ne)){var nt,ht,Ot,Zt,xr=it._size,br=Ge.borderwidth,mn=xr.l+xr.w*Ge.x-dr[getXanchor(Ge)]*Ge._width,xn=xr.t+xr.h*(1-Ge.y)-dr[getYanchor(Ge)]*Ge._effHeight;if(Ge._main&&it.margin.autoexpand){var Cn=mn,En=xn;mn=rt.constrain(mn,0,it.width-Ge._width),xn=rt.constrain(xn,0,it.height-Ge._effHeight),mn!==Cn&&rt.log("Constrain legend.x to make legend fit inside graph"),xn!==En&&rt.log("Constrain legend.y to make legend fit inside graph")}if(Ge._main&&dt.setTranslate(er,mn,xn),kn.on(".drag",null),er.on("wheel",null),!Ge._main||Ge._height<=Ge._maxHeight||Ne._context.staticPlot){var Pn=Ge._effHeight;Ge._main||(Pn=Ge._height),Ar.attr({width:Ge._width-br,height:Pn-br,x:br/2,y:br/2}),dt.setTranslate(en,0,0),mr.select("rect").attr({width:Ge._width-2*br,height:Pn-2*br,x:br,y:br}),dt.setClipUrl(en,Dt,Ne),dt.setRect(kn,0,0,0,0),delete Ge._scrollY}else{var Dn,In,zn,Bn=Math.max(Rt.scrollBarMinHeight,Ge._effHeight*Ge._effHeight/Ge._height),Vn=Ge._effHeight-Bn-2*Rt.scrollBarMargin,Hn=Ge._height-Ge._effHeight,qn=Vn/Hn,Yn=Math.min(Ge._scrollY||0,Hn);Ar.attr({width:Ge._width-2*br+Rt.scrollBarWidth+Rt.scrollBarMargin,height:Ge._effHeight-br,x:br/2,y:br/2}),mr.select("rect").attr({width:Ge._width-2*br+Rt.scrollBarWidth+Rt.scrollBarMargin,height:Ge._effHeight-2*br,x:br,y:br+Yn}),dt.setClipUrl(en,Dt,Ne),scrollHandler(Yn,Bn,qn),er.on("wheel",(function(){scrollHandler(Yn=rt.constrain(Ge._scrollY+tt.event.deltaY/Vn*Hn,0,Hn),Bn,qn),0!==Yn&&Yn!==Hn&&tt.event.preventDefault()}));var getScrollBarDragY=function(Ne,Ge,Qe){var tt=(Qe-Ge)/qn+Ne;return rt.constrain(tt,0,Hn)},getNaturalDragY=function(Ne,Ge,Qe){var tt=(Ge-Qe)/qn+Ne;return rt.constrain(tt,0,Hn)},$n=tt.behavior.drag().on("dragstart",(function(){var Ne=tt.event.sourceEvent;Dn="touchstart"===Ne.type?Ne.changedTouches[0].clientY:Ne.clientY,zn=Yn})).on("drag",(function(){var Ne=tt.event.sourceEvent;2===Ne.buttons||Ne.ctrlKey||(In="touchmove"===Ne.type?Ne.changedTouches[0].clientY:Ne.clientY,scrollHandler(Yn=getScrollBarDragY(zn,Dn,In),Bn,qn))}));kn.call($n);var ra=tt.behavior.drag().on("dragstart",(function(){var Ne=tt.event.sourceEvent;"touchstart"===Ne.type&&(Dn=Ne.changedTouches[0].clientY,zn=Yn)})).on("drag",(function(){var Ne=tt.event.sourceEvent;"touchmove"===Ne.type&&(In=Ne.changedTouches[0].clientY,scrollHandler(Yn=getNaturalDragY(zn,Dn,In),Bn,qn))}));en.call(ra)}Ne._context.edits.legendPosition&&(er.classed("cursor-move",!0),ot.init({element:er.node(),gd:Ne,prepFn:function(){var Ne=dt.getTranslate(er);Ot=Ne.x,Zt=Ne.y},moveFn:function(Ne,Qe){var tt=Ot+Ne,rt=Zt+Qe;dt.setTranslate(er,tt,rt),nt=ot.align(tt,0,xr.l,xr.l+xr.w,Ge.xanchor),ht=ot.align(rt,0,xr.t+xr.h,xr.t,Ge.yanchor)},doneFn:function(){void 0!==nt&&void 0!==ht&&at.call("_guiRelayout",Ne,{"legend.x":nt,"legend.y":ht})},clickFn:function(Ge,tt){var rt=Qe.selectAll("g.traces").filter((function(){var Ne=this.getBoundingClientRect();return tt.clientX>=Ne.left&&tt.clientX<=Ne.right&&tt.clientY>=Ne.top&&tt.clientY<=Ne.bottom}));rt.size()>0&&clickOrDoubleClick(Ne,er,rt,Ge,tt)}}))}function scrollHandler(Qe,tt,rt){Ge._scrollY=Ne._fullLayout.legend._scrollY=Qe,dt.setTranslate(en,0,-Qe),dt.setRect(kn,Ge._width,Rt.scrollBarMargin+Qe*rt,Rt.scrollBarWidth,tt),mr.select("rect").attr("y",br+Qe)}}],Ne)}}},{"../../constants/alignment":745,"../../lib":778,"../../lib/events":767,"../../lib/svg_text_utils":803,"../../plots/plots":891,"../../registry":911,"../color":643,"../dragelement":662,"../drawing":665,"./constants":694,"./get_legend_data":697,"./handle_click":698,"./helpers":699,"./style":701,d3:169}],697:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../registry"),rt=Ne("./helpers");Ge.exports=function(Ne,Ge){var Qe,nt,at={},it=[],ot=!1,dt={},ht=0,Dt=0,Ot=Ge._main;function addOneItem(Ne,Qe){if(""!==Ne&&rt.isGrouped(Ge))-1===it.indexOf(Ne)?(it.push(Ne),ot=!0,at[Ne]=[[Qe]]):at[Ne].push([Qe]);else{var tt="~~i"+ht;it.push(tt),at[tt]=[[Qe]],ht++}}for(Qe=0;Qe<Ne.length;Qe++){var Rt=Ne[Qe],Zt=Rt[0],er=Zt.trace,dr=er.legendgroup;if(!Ot||er.visible&&er.showlegend)if(tt.traceIs(er,"pie-like"))for(dt[dr]||(dt[dr]={}),nt=0;nt<Rt.length;nt++){var mr=Rt[nt].label;dt[dr][mr]||(addOneItem(dr,{label:mr,color:Rt[nt].color,i:Rt[nt].i,trace:er,pts:Rt[nt].pts}),dt[dr][mr]=!0,Dt=Math.max(Dt,(mr||"").length))}else addOneItem(dr,Zt),Dt=Math.max(Dt,(er.name||"").length)}if(!it.length)return[];var xr,br,Ar=it.length;if(ot&&rt.isGrouped(Ge))for(br=new Array(Ar),Qe=0;Qe<Ar;Qe++)xr=at[it[Qe]],br[Qe]=rt.isReversed(Ge)?xr.reverse():xr;else{for(br=[new Array(Ar)],Qe=0;Qe<Ar;Qe++)xr=at[it[Qe]][0],br[0][rt.isReversed(Ge)?Ar-Qe-1:Qe]=xr;Ar=1}return Ge._lgroupsLength=Ar,Ge._maxNameLength=Dt,br}},{"../../registry":911,"./helpers":699}],698:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../registry"),nt=!0;Ge.exports=function(Ne,Ge,Qe){var at=Ge._fullLayout;if(!Ge._dragged&&!Ge._editing){var it,ot=at.legend.itemclick,dt=at.legend.itemdoubleclick;if(1===Qe&&"toggle"===ot&&"toggleothers"===dt&&nt&&Ge.data&&Ge._context.showTips?(tt.notifier(tt._(Ge,"Double-click on legend to isolate one trace"),"long"),nt=!1):nt=!1,1===Qe?it=ot:2===Qe&&(it=dt),it){var ht,Dt,Ot,Rt,Zt,er=at.hiddenlabels?at.hiddenlabels.slice():[],dr=Ne.data()[0][0],mr=Ge._fullData,xr=dr.trace,br=xr.legendgroup,Ar={},en=[],mn=[],xn=[];if(rt.traceIs(xr,"pie-like")){var kn=dr.label,Cn=er.indexOf(kn);"toggle"===it?-1===Cn?er.push(kn):er.splice(Cn,1):"toggleothers"===it&&(er=[],Ge.calcdata[0].forEach((function(Ne){kn!==Ne.label&&er.push(Ne.label)})),Ge._fullLayout.hiddenlabels&&Ge._fullLayout.hiddenlabels.length===er.length&&-1===Cn&&(er=[])),rt.call("_guiRelayout",Ge,"hiddenlabels",er)}else{var En,Pn=br&&br.length,Dn=[];if(Pn)for(ht=0;ht<mr.length;ht++)(En=mr[ht]).visible&&En.legendgroup===br&&Dn.push(ht);if("toggle"===it){var In;switch(xr.visible){case!0:In="legendonly";break;case!1:In=!1;break;case"legendonly":In=!0}if(Pn)for(ht=0;ht<mr.length;ht++)!1!==mr[ht].visible&&mr[ht].legendgroup===br&&setVisibility(mr[ht],In);else setVisibility(xr,In)}else if("toggleothers"===it){var zn,Bn,Vn,Hn,qn=!0;for(ht=0;ht<mr.length;ht++)if(zn=mr[ht]===xr,Vn=!0!==mr[ht].showlegend,!(zn||Vn||(Bn=Pn&&mr[ht].legendgroup===br)||!0!==mr[ht].visible||rt.traceIs(mr[ht],"notLegendIsolatable"))){qn=!1;break}for(ht=0;ht<mr.length;ht++)if(!1!==mr[ht].visible&&!rt.traceIs(mr[ht],"notLegendIsolatable"))switch(xr.visible){case"legendonly":setVisibility(mr[ht],!0);break;case!0:Hn=!!qn||"legendonly",zn=mr[ht]===xr,Vn=!0!==mr[ht].showlegend&&!mr[ht].legendgroup,Bn=zn||Pn&&mr[ht].legendgroup===br,setVisibility(mr[ht],!(!Bn&&!Vn)||Hn)}}for(ht=0;ht<mn.length;ht++)if(Ot=mn[ht]){var Yn=Ot.constructUpdate(),$n=Object.keys(Yn);for(Dt=0;Dt<$n.length;Dt++)Rt=$n[Dt],(Ar[Rt]=Ar[Rt]||[])[xn[ht]]=Yn[Rt]}for(Zt=Object.keys(Ar),ht=0;ht<Zt.length;ht++)for(Rt=Zt[ht],Dt=0;Dt<en.length;Dt++)Ar[Rt].hasOwnProperty(Dt)||(Ar[Rt][Dt]=void 0);rt.call("_guiRestyle",Ge,Ar,en)}}}function insertUpdate(Ne,Ge,Qe){var tt=en.indexOf(Ne),rt=Ar[Ge];return rt||(rt=Ar[Ge]=[]),-1===en.indexOf(Ne)&&(en.push(Ne),tt=en.length-1),rt[tt]=Qe,tt}function setVisibility(Ne,Ge){var Qe=Ne._fullInput;if(rt.hasTransform(Qe,"groupby")){var nt=mn[Qe.index];if(!nt){var at=rt.getTransformIndices(Qe,"groupby"),it=at[at.length-1];nt=tt.keyedContainer(Qe,"transforms["+it+"].styles","target","value.visible"),mn[Qe.index]=nt}var ot=nt.get(Ne._group);void 0===ot&&(ot=!0),!1!==ot&&nt.set(Ne._group,Ge),xn[Qe.index]=insertUpdate(Qe.index,"visible",!1!==Qe.visible)}else{var dt=!1!==Qe.visible&&Ge;insertUpdate(Qe.index,"visible",dt)}}}},{"../../lib":778,"../../registry":911}],699:[function(Ne,Ge,Qe){"use strict";Qe.isGrouped=function(Ne){return-1!==(Ne.traceorder||"").indexOf("grouped")},Qe.isVertical=function(Ne){return"h"!==Ne.orientation},Qe.isReversed=function(Ne){return-1!==(Ne.traceorder||"").indexOf("reversed")}},{}],700:[function(Ne,Ge,Qe){"use strict";Ge.exports={moduleType:"component",name:"legend",layoutAttributes:Ne("./attributes"),supplyLayoutDefaults:Ne("./defaults"),draw:Ne("./draw"),style:Ne("./style")}},{"./attributes":693,"./defaults":695,"./draw":696,"./style":701}],701:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../registry"),nt=Ne("../../lib"),at=nt.strTranslate,it=Ne("../drawing"),ot=Ne("../color"),dt=Ne("../colorscale/helpers").extractOpts,ht=Ne("../../traces/scatter/subtypes"),Dt=Ne("../../traces/pie/style_one"),Ot=Ne("../../traces/pie/helpers").castOption,Rt=Ne("./constants"),Zt=12,er=5,dr=2,mr=10,xr=5;function getGradientDirection(Ne,Ge){return(Ge?"radial":"horizontal")+(Ne?"":"reversed")}Ge.exports=function(Ne,Ge,Qe){var br=Ge._fullLayout;Qe||(Qe=br.legend);var Ar="constant"===Qe.itemsizing,en=Qe.itemwidth,mn=(en+2*Rt.itemGap)/2,xn=at(mn,0),boundLineWidth=function(Ne,Ge,Qe,tt){var rt;if(Ne+1)rt=Ne;else{if(!(Ge&&Ge.width>0))return 0;rt=Ge.width}return Ar?tt:Math.min(rt,Qe)};function styleLines(Ne){var Qe,rt,at=Ne[0],ot=at.trace,Dt=ot.visible&&ot.fill&&"none"!==ot.fill,Ot=ht.hasLines(ot),Rt=ot.contours,Zt=!1,dr=!1,xr=dt(ot),br=xr.colorscale,Ar=xr.reversescale,fillGradient=function(Ne){if(Ne.size()){var Qe="legendfill-"+ot.uid;it.gradient(Ne,Ge,Qe,getGradientDirection(Ar),br,"fill")}},lineGradient=function(Ne){if(Ne.size()){var Qe="legendline-"+ot.uid;it.lineGroupStyle(Ne),it.gradient(Ne,Ge,Qe,getGradientDirection(Ar),br,"stroke")}};if(Rt){var mn=Rt.coloring;"lines"===mn?Zt=!0:Ot="none"===mn||"heatmap"===mn||Rt.showlines,"constraint"===Rt.type?Dt="="!==Rt._operation:"fill"!==mn&&"heatmap"!==mn||(dr=!0)}var xn=ht.hasMarkers(ot)||ht.hasText(ot)||!Dt&&!dr?"M5,0":Ot||Zt?"M5,-2":"M5,-3",kn=tt.select(this),Cn=kn.select(".legendfill").selectAll("path").data(Dt||dr?[Ne]:[]);if(Cn.enter().append("path").classed("js-fill",!0),Cn.exit().remove(),Cn.attr("d",xn+"h"+en+"v6h-"+en+"z").call(Dt?it.fillGroupStyle:fillGradient),Ot||Zt){var En=boundLineWidth(void 0,ot.line,mr,er);rt=nt.minExtend(ot,{line:{width:En}}),Qe=[nt.minExtend(at,{trace:rt})]}var Pn=kn.select(".legendlines").selectAll("path").data(Ot||Zt?[Qe]:[]);Pn.enter().append("path").classed("js-line",!0),Pn.exit().remove(),Pn.attr("d",xn+(Zt?"l"+en+",0.0001":"h"+en)).call(Ot?it.lineGroupStyle:lineGradient)}function stylePoints(Ne){var Qe,rt,at=Ne[0],ot=at.trace,dt=ht.hasMarkers(ot),Dt=ht.hasText(ot),Ot=ht.hasLines(ot);function boundVal(Ne,Ge,Qe,tt){var rt=nt.nestedProperty(ot,Ne).get(),at=nt.isArrayOrTypedArray(rt)&&Ge?Ge(rt):rt;if(Ar&&at&&void 0!==tt&&(at=tt),Qe){if(at<Qe[0])return Qe[0];if(at>Qe[1])return Qe[1]}return at}function pickFirst(Ne){return at._distinct&&at.index&&Ne[at.index]?Ne[at.index]:Ne[0]}if(dt||Dt||Ot){var Rt={},mr={};if(dt){Rt.mc=boundVal("marker.color",pickFirst),Rt.mx=boundVal("marker.symbol",pickFirst),Rt.mo=boundVal("marker.opacity",nt.mean,[.2,1]),Rt.mlc=boundVal("marker.line.color",pickFirst),Rt.mlw=boundVal("marker.line.width",nt.mean,[0,5],dr),mr.marker={sizeref:1,sizemin:1,sizemode:"diameter"};var xr=boundVal("marker.size",nt.mean,[2,16],Zt);Rt.ms=xr,mr.marker.size=xr}Ot&&(mr.line={width:boundVal("line.width",pickFirst,[0,10],er)}),Dt&&(Rt.tx="Aa",Rt.tp=boundVal("textposition",pickFirst),Rt.ts=10,Rt.tc=boundVal("textfont.color",pickFirst),Rt.tf=boundVal("textfont.family",pickFirst)),Qe=[nt.minExtend(at,Rt)],(rt=nt.minExtend(ot,mr)).selectedpoints=null,rt.texttemplate=null}var br=tt.select(this).select("g.legendpoints"),en=br.selectAll("path.scatterpts").data(dt?Qe:[]);en.enter().insert("path",":first-child").classed("scatterpts",!0).attr("transform",xn),en.exit().remove(),en.call(it.pointStyle,rt,Ge),dt&&(Qe[0].mrc=3);var mn=br.selectAll("g.pointtext").data(Dt?Qe:[]);mn.enter().append("g").classed("pointtext",!0).append("text").attr("transform",xn),mn.exit().remove(),mn.selectAll("text").call(it.textPointStyle,rt,Ge)}function styleWaterfalls(Ne){var Ge=Ne[0].trace,Qe="waterfall"===Ge.type;if(Ne[0]._distinct&&Qe){var rt=Ne[0].trace[Ne[0].dir].marker;return Ne[0].mc=rt.color,Ne[0].mlw=rt.line.width,Ne[0].mlc=rt.line.color,styleBarLike(Ne,this,"waterfall")}var nt=[];Ge.visible&&Qe&&(nt=Ne[0].hasTotals?[["increasing","M-6,-6V6H0Z"],["totals","M6,6H0L-6,-6H-0Z"],["decreasing","M6,6V-6H0Z"]]:[["increasing","M-6,-6V6H6Z"],["decreasing","M6,6V-6H-6Z"]]);var at=tt.select(this).select("g.legendpoints").selectAll("path.legendwaterfall").data(nt);at.enter().append("path").classed("legendwaterfall",!0).attr("transform",xn).style("stroke-miterlimit",1),at.exit().remove(),at.each((function(Ne){var Qe=tt.select(this),rt=Ge[Ne[0]].marker,nt=boundLineWidth(void 0,rt.line,xr,dr);Qe.attr("d",Ne[1]).style("stroke-width",nt+"px").call(ot.fill,rt.color),nt&&Qe.call(ot.stroke,rt.line.color)}))}function styleBars(Ne){styleBarLike(Ne,this)}function styleFunnels(Ne){styleBarLike(Ne,this,"funnel")}function styleBarLike(Ne,Ge,Qe){var nt=Ne[0].trace,at=nt.marker||{},it=at.line||{},dt=Qe?nt.visible&&nt.type===Qe:rt.traceIs(nt,"bar"),ht=tt.select(Ge).select("g.legendpoints").selectAll("path.legend"+Qe).data(dt?[Ne]:[]);ht.enter().append("path").classed("legend"+Qe,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",xn),ht.exit().remove(),ht.each((function(Ne){var Ge=tt.select(this),Qe=Ne[0],rt=boundLineWidth(Qe.mlw,at.line,xr,dr);Ge.style("stroke-width",rt+"px").call(ot.fill,Qe.mc||at.color),rt&&ot.stroke(Ge,Qe.mlc||it.color)}))}function styleBoxes(Ne){var Qe=Ne[0].trace,at=tt.select(this).select("g.legendpoints").selectAll("path.legendbox").data(Qe.visible&&rt.traceIs(Qe,"box-violin")?[Ne]:[]);at.enter().append("path").classed("legendbox",!0).attr("d","M6,6H-6V-6H6Z").attr("transform",xn),at.exit().remove(),at.each((function(){var Ne=tt.select(this);if("all"!==Qe.boxpoints&&"all"!==Qe.points||0!==ot.opacity(Qe.fillcolor)||0!==ot.opacity((Qe.line||{}).color)){var rt=boundLineWidth(void 0,Qe.line,xr,dr);Ne.style("stroke-width",rt+"px").call(ot.fill,Qe.fillcolor),rt&&ot.stroke(Ne,Qe.line.color)}else{var dt=nt.minExtend(Qe,{marker:{size:Ar?Zt:nt.constrain(Qe.marker.size,2,16),sizeref:1,sizemin:1,sizemode:"diameter"}});at.call(it.pointStyle,dt,Ge)}}))}function styleCandles(Ne){var Ge=Ne[0].trace,Qe=tt.select(this).select("g.legendpoints").selectAll("path.legendcandle").data(Ge.visible&&"candlestick"===Ge.type?[Ne,Ne]:[]);Qe.enter().append("path").classed("legendcandle",!0).attr("d",(function(Ne,Ge){return Ge?"M-15,0H-8M-8,6V-6H8Z":"M15,0H8M8,-6V6H-8Z"})).attr("transform",xn).style("stroke-miterlimit",1),Qe.exit().remove(),Qe.each((function(Ne,Qe){var rt=tt.select(this),nt=Ge[Qe?"increasing":"decreasing"],at=boundLineWidth(void 0,nt.line,xr,dr);rt.style("stroke-width",at+"px").call(ot.fill,nt.fillcolor),at&&ot.stroke(rt,nt.line.color)}))}function styleOHLC(Ne){var Ge=Ne[0].trace,Qe=tt.select(this).select("g.legendpoints").selectAll("path.legendohlc").data(Ge.visible&&"ohlc"===Ge.type?[Ne,Ne]:[]);Qe.enter().append("path").classed("legendohlc",!0).attr("d",(function(Ne,Ge){return Ge?"M-15,0H0M-8,-6V0":"M15,0H0M8,6V0"})).attr("transform",xn).style("stroke-miterlimit",1),Qe.exit().remove(),Qe.each((function(Ne,Qe){var rt=tt.select(this),nt=Ge[Qe?"increasing":"decreasing"],at=boundLineWidth(void 0,nt.line,xr,dr);rt.style("fill","none").call(it.dashLine,nt.line.dash,at),at&&ot.stroke(rt,nt.line.color)}))}function stylePies(Ne){stylePieLike(Ne,this,"pie")}function styleFunnelareas(Ne){stylePieLike(Ne,this,"funnelarea")}function stylePieLike(Ne,Ge,Qe){var at=Ne[0],it=at.trace,ot=Qe?it.visible&&it.type===Qe:rt.traceIs(it,Qe),dt=tt.select(Ge).select("g.legendpoints").selectAll("path.legend"+Qe).data(ot?[Ne]:[]);if(dt.enter().append("path").classed("legend"+Qe,!0).attr("d","M6,6H-6V-6H6Z").attr("transform",xn),dt.exit().remove(),dt.size()){var ht=(it.marker||{}).line,Rt=boundLineWidth(Ot(ht.width,at.pts),ht,xr,dr),Zt=nt.minExtend(it,{marker:{line:{width:Rt}}});Zt.marker.line.color=ht.color;var er=nt.minExtend(at,{trace:Zt});Dt(dt,er,Zt)}}function styleSpatial(Ne){var Qe,rt=Ne[0].trace,at=[];if(rt.visible)switch(rt.type){case"histogram2d":case"heatmap":at=[["M-15,-2V4H15V-2Z"]],Qe=!0;break;case"choropleth":case"choroplethmapbox":at=[["M-6,-6V6H6V-6Z"]],Qe=!0;break;case"densitymapbox":at=[["M-6,0 a6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"]],Qe="radial";break;case"cone":at=[["M-6,2 A2,2 0 0,0 -6,6 V6L6,4Z"],["M-6,-6 A2,2 0 0,0 -6,-2 L6,-4Z"],["M-6,-2 A2,2 0 0,0 -6,2 L6,0Z"]],Qe=!1;break;case"streamtube":at=[["M-6,2 A2,2 0 0,0 -6,6 H6 A2,2 0 0,1 6,2 Z"],["M-6,-6 A2,2 0 0,0 -6,-2 H6 A2,2 0 0,1 6,-6 Z"],["M-6,-2 A2,2 0 0,0 -6,2 H6 A2,2 0 0,1 6,-2 Z"]],Qe=!1;break;case"surface":at=[["M-6,-6 A2,3 0 0,0 -6,0 H6 A2,3 0 0,1 6,-6 Z"],["M-6,1 A2,3 0 0,1 -6,6 H6 A2,3 0 0,0 6,0 Z"]],Qe=!0;break;case"mesh3d":at=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],Qe=!1;break;case"volume":at=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6H6L0,6Z"]],Qe=!0;break;case"isosurface":at=[["M-6,6H0L-6,-6Z"],["M6,6H0L6,-6Z"],["M-6,-6 A12,24 0 0,0 6,-6 L0,6Z"]],Qe=!1}var ht=tt.select(this).select("g.legendpoints").selectAll("path.legend3dandfriends").data(at);ht.enter().append("path").classed("legend3dandfriends",!0).attr("transform",xn).style("stroke-miterlimit",1),ht.exit().remove(),ht.each((function(Ne,at){var ht,Dt=tt.select(this),Ot=dt(rt),Rt=Ot.colorscale,Zt=Ot.reversescale,fillGradient=function(Ne){if(Ne.size()){var tt="legendfill-"+rt.uid;it.gradient(Ne,Ge,tt,getGradientDirection(Zt,"radial"===Qe),Rt,"fill")}};if(Rt){if(!Qe){var er=Rt.length;ht=0===at?Rt[Zt?er-1:0][1]:1===at?Rt[Zt?0:er-1][1]:Rt[Math.floor((er-1)/2)][1]}}else{var dr=rt.vertexcolor||rt.facecolor||rt.color;ht=nt.isArrayOrTypedArray(dr)?dr[at]||dr[0]:dr}Dt.attr("d",Ne[0]),ht?Dt.call(ot.fill,ht):Dt.call(fillGradient)}))}Ne.each((function(Ne){var Ge=tt.select(this),rt=nt.ensureSingle(Ge,"g","layers");rt.style("opacity",Ne[0].trace.opacity);var it=Qe.valign,ot=Ne[0].lineHeight,dt=Ne[0].height;if("middle"!==it&&ot&&dt){var ht={top:1,bottom:-1}[it]*(.5*(ot-dt+3));rt.attr("transform",at(0,ht))}else rt.attr("transform",null);rt.selectAll("g.legendfill").data([Ne]).enter().append("g").classed("legendfill",!0),rt.selectAll("g.legendlines").data([Ne]).enter().append("g").classed("legendlines",!0);var Dt=rt.selectAll("g.legendsymbols").data([Ne]);Dt.enter().append("g").classed("legendsymbols",!0),Dt.selectAll("g.legendpoints").data([Ne]).enter().append("g").classed("legendpoints",!0)})).each(styleSpatial).each(styleWaterfalls).each(styleFunnels).each(styleBars).each(styleBoxes).each(styleFunnelareas).each(stylePies).each(styleLines).each(stylePoints).each(styleCandles).each(styleOHLC)}},{"../../lib":778,"../../registry":911,"../../traces/pie/helpers":1166,"../../traces/pie/style_one":1172,"../../traces/scatter/subtypes":1212,"../color":643,"../colorscale/helpers":654,"../drawing":665,"./constants":694,d3:169}],702:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../registry"),rt=Ne("../../plots/plots"),nt=Ne("../../plots/cartesian/axis_ids"),at=Ne("../../fonts/ploticon"),it=Ne("../shapes/draw").eraseActiveShape,ot=Ne("../../lib"),dt=ot._,ht=Ge.exports={};function handleCartesian(Ne,Ge){var Qe,rt,at=Ge.currentTarget,it=at.getAttribute("data-attr"),ot=at.getAttribute("data-val")||!0,dt=Ne._fullLayout,ht={},Dt=nt.list(Ne,null,!0),Ot=dt._cartesianSpikesEnabled;if("zoom"===it){var Rt,Zt="in"===ot?.5:2,er=(1+Zt)/2,dr=(1-Zt)/2;for(rt=0;rt<Dt.length;rt++)if(!(Qe=Dt[rt]).fixedrange)if(Rt=Qe._name,"auto"===ot)ht[Rt+".autorange"]=!0;else if("reset"===ot){if(void 0===Qe._rangeInitial)ht[Rt+".autorange"]=!0;else{var mr=Qe._rangeInitial.slice();ht[Rt+".range[0]"]=mr[0],ht[Rt+".range[1]"]=mr[1]}void 0!==Qe._showSpikeInitial&&(ht[Rt+".showspikes"]=Qe._showSpikeInitial,"on"!==Ot||Qe._showSpikeInitial||(Ot="off"))}else{var xr=[Qe.r2l(Qe.range[0]),Qe.r2l(Qe.range[1])],br=[er*xr[0]+dr*xr[1],er*xr[1]+dr*xr[0]];ht[Rt+".range[0]"]=Qe.l2r(br[0]),ht[Rt+".range[1]"]=Qe.l2r(br[1])}}else"hovermode"!==it||"x"!==ot&&"y"!==ot||(ot=dt._isHoriz?"y":"x",at.setAttribute("data-val",ot)),ht[it]=ot;dt._cartesianSpikesEnabled=Ot,tt.call("_guiRelayout",Ne,ht)}function handleDrag3d(Ne,Ge){for(var Qe=Ge.currentTarget,rt=Qe.getAttribute("data-attr"),nt=Qe.getAttribute("data-val")||!0,at=Ne._fullLayout._subplots.gl3d||[],it={},ot=rt.split("."),dt=0;dt<at.length;dt++)it[at[dt]+"."+ot[1]]=nt;var ht="pan"===nt?nt:"zoom";it.dragmode=ht,tt.call("_guiRelayout",Ne,it)}function handleCamera3d(Ne,Ge){for(var Qe=Ge.currentTarget.getAttribute("data-attr"),rt="resetLastSave"===Qe,nt="resetDefault"===Qe,at=Ne._fullLayout,it=at._subplots.gl3d||[],ot={},dt=0;dt<it.length;dt++){var ht,Dt=it[dt],Ot=Dt+".camera",Rt=Dt+".aspectratio",Zt=Dt+".aspectmode",er=at[Dt]._scene;rt?(ot[Ot+".up"]=er.viewInitial.up,ot[Ot+".eye"]=er.viewInitial.eye,ot[Ot+".center"]=er.viewInitial.center,ht=!0):nt&&(ot[Ot+".up"]=null,ot[Ot+".eye"]=null,ot[Ot+".center"]=null,ht=!0),ht&&(ot[Rt+".x"]=er.viewInitial.aspectratio.x,ot[Rt+".y"]=er.viewInitial.aspectratio.y,ot[Rt+".z"]=er.viewInitial.aspectratio.z,ot[Zt]=er.viewInitial.aspectmode)}tt.call("_guiRelayout",Ne,ot)}function getNextHover3d(Ne,Ge){var Qe=Ge.currentTarget,tt=Qe._previousVal,rt=Ne._fullLayout,nt=rt._subplots.gl3d||[],at=["xaxis","yaxis","zaxis"],it={},ot={};if(tt)ot=tt,Qe._previousVal=null;else{for(var dt=0;dt<nt.length;dt++){var ht=nt[dt],Dt=rt[ht],Ot=ht+".hovermode";it[Ot]=Dt.hovermode,ot[Ot]=!1;for(var Rt=0;Rt<3;Rt++){var Zt=at[Rt],er=ht+"."+Zt+".showspikes";ot[er]=!1,it[er]=Dt[Zt].showspikes}}Qe._previousVal=it}return ot}function handleHover3d(Ne,Ge){var Qe=getNextHover3d(Ne,Ge);tt.call("_guiRelayout",Ne,Qe)}function handleGeo(Ne,Ge){for(var Qe=Ge.currentTarget,rt=Qe.getAttribute("data-attr"),nt=Qe.getAttribute("data-val")||!0,at=Ne._fullLayout,it=at._subplots.geo||[],ot=0;ot<it.length;ot++){var dt=it[ot],ht=at[dt];if("zoom"===rt){var Dt=ht.projection.scale,Ot="in"===nt?2*Dt:.5*Dt;tt.call("_guiRelayout",Ne,dt+".projection.scale",Ot)}}"reset"===rt&&resetView(Ne,"geo")}function getNextHover(Ne){var Ge=Ne._fullLayout;return!Ge.hovermode&&(Ge._has("cartesian")?Ge._isHoriz?"y":"x":"closest")}function toggleHover(Ne){var Ge=getNextHover(Ne);tt.call("_guiRelayout",Ne,"hovermode",Ge)}function setSpikelineVisibility(Ne){for(var Ge="on"===Ne._fullLayout._cartesianSpikesEnabled,Qe=nt.list(Ne,null,!0),tt={},rt=0;rt<Qe.length;rt++){var at=Qe[rt];tt[at._name+".showspikes"]=!!Ge||at._showSpikeInitial}return tt}function handleMapboxZoom(Ne,Ge){for(var Qe=Ge.currentTarget.getAttribute("data-val"),rt=Ne._fullLayout,nt=rt._subplots.mapbox||[],at=1.05,it={},ot=0;ot<nt.length;ot++){var dt=nt[ot],ht=rt[dt].zoom,Dt="in"===Qe?at*ht:ht/at;it[dt+".zoom"]=Dt}tt.call("_guiRelayout",Ne,it)}function resetView(Ne,Ge){for(var Qe=Ne._fullLayout,rt=Qe._subplots[Ge]||[],nt={},at=0;at<rt.length;at++)for(var it=rt[at],ot=Qe[it]._subplot.viewInitial,dt=Object.keys(ot),ht=0;ht<dt.length;ht++){var Dt=dt[ht];nt[it+"."+Dt]=ot[Dt]}tt.call("_guiRelayout",Ne,nt)}ht.toImage={name:"toImage",title:function(Ne){var Ge=(Ne._context.toImageButtonOptions||{}).format||"png";return dt(Ne,"png"===Ge?"Download plot as a png":"Download plot")},icon:at.camera,click:function(Ne){var Ge=Ne._context.toImageButtonOptions,Qe={format:Ge.format||"png"};ot.notifier(dt(Ne,"Taking snapshot - this may take a few seconds"),"long"),"svg"!==Qe.format&&ot.isIE()&&(ot.notifier(dt(Ne,"IE only supports svg.  Changing format to svg."),"long"),Qe.format="svg"),["filename","width","height","scale"].forEach((function(Ne){Ne in Ge&&(Qe[Ne]=Ge[Ne])})),tt.call("downloadImage",Ne,Qe).then((function(Ge){ot.notifier(dt(Ne,"Snapshot succeeded")+" - "+Ge,"long")})).catch((function(){ot.notifier(dt(Ne,"Sorry, there was a problem downloading your snapshot!"),"long")}))}},ht.sendDataToCloud={name:"sendDataToCloud",title:function(Ne){return dt(Ne,"Edit in Chart Studio")},icon:at.disk,click:function(Ne){rt.sendDataToCloud(Ne)}},ht.editInChartStudio={name:"editInChartStudio",title:function(Ne){return dt(Ne,"Edit in Chart Studio")},icon:at.pencil,click:function(Ne){rt.sendDataToCloud(Ne)}},ht.zoom2d={name:"zoom2d",title:function(Ne){return dt(Ne,"Zoom")},attr:"dragmode",val:"zoom",icon:at.zoombox,click:handleCartesian},ht.pan2d={name:"pan2d",title:function(Ne){return dt(Ne,"Pan")},attr:"dragmode",val:"pan",icon:at.pan,click:handleCartesian},ht.select2d={name:"select2d",title:function(Ne){return dt(Ne,"Box Select")},attr:"dragmode",val:"select",icon:at.selectbox,click:handleCartesian},ht.lasso2d={name:"lasso2d",title:function(Ne){return dt(Ne,"Lasso Select")},attr:"dragmode",val:"lasso",icon:at.lasso,click:handleCartesian},ht.drawclosedpath={name:"drawclosedpath",title:function(Ne){return dt(Ne,"Draw closed freeform")},attr:"dragmode",val:"drawclosedpath",icon:at.drawclosedpath,click:handleCartesian},ht.drawopenpath={name:"drawopenpath",title:function(Ne){return dt(Ne,"Draw open freeform")},attr:"dragmode",val:"drawopenpath",icon:at.drawopenpath,click:handleCartesian},ht.drawline={name:"drawline",title:function(Ne){return dt(Ne,"Draw line")},attr:"dragmode",val:"drawline",icon:at.drawline,click:handleCartesian},ht.drawrect={name:"drawrect",title:function(Ne){return dt(Ne,"Draw rectangle")},attr:"dragmode",val:"drawrect",icon:at.drawrect,click:handleCartesian},ht.drawcircle={name:"drawcircle",title:function(Ne){return dt(Ne,"Draw circle")},attr:"dragmode",val:"drawcircle",icon:at.drawcircle,click:handleCartesian},ht.eraseshape={name:"eraseshape",title:function(Ne){return dt(Ne,"Erase active shape")},icon:at.eraseshape,click:it},ht.zoomIn2d={name:"zoomIn2d",title:function(Ne){return dt(Ne,"Zoom in")},attr:"zoom",val:"in",icon:at.zoom_plus,click:handleCartesian},ht.zoomOut2d={name:"zoomOut2d",title:function(Ne){return dt(Ne,"Zoom out")},attr:"zoom",val:"out",icon:at.zoom_minus,click:handleCartesian},ht.autoScale2d={name:"autoScale2d",title:function(Ne){return dt(Ne,"Autoscale")},attr:"zoom",val:"auto",icon:at.autoscale,click:handleCartesian},ht.resetScale2d={name:"resetScale2d",title:function(Ne){return dt(Ne,"Reset axes")},attr:"zoom",val:"reset",icon:at.home,click:handleCartesian},ht.hoverClosestCartesian={name:"hoverClosestCartesian",title:function(Ne){return dt(Ne,"Show closest data on hover")},attr:"hovermode",val:"closest",icon:at.tooltip_basic,gravity:"ne",click:handleCartesian},ht.hoverCompareCartesian={name:"hoverCompareCartesian",title:function(Ne){return dt(Ne,"Compare data on hover")},attr:"hovermode",val:function(Ne){return Ne._fullLayout._isHoriz?"y":"x"},icon:at.tooltip_compare,gravity:"ne",click:handleCartesian},ht.zoom3d={name:"zoom3d",title:function(Ne){return dt(Ne,"Zoom")},attr:"scene.dragmode",val:"zoom",icon:at.zoombox,click:handleDrag3d},ht.pan3d={name:"pan3d",title:function(Ne){return dt(Ne,"Pan")},attr:"scene.dragmode",val:"pan",icon:at.pan,click:handleDrag3d},ht.orbitRotation={name:"orbitRotation",title:function(Ne){return dt(Ne,"Orbital rotation")},attr:"scene.dragmode",val:"orbit",icon:at["3d_rotate"],click:handleDrag3d},ht.tableRotation={name:"tableRotation",title:function(Ne){return dt(Ne,"Turntable rotation")},attr:"scene.dragmode",val:"turntable",icon:at["z-axis"],click:handleDrag3d},ht.resetCameraDefault3d={name:"resetCameraDefault3d",title:function(Ne){return dt(Ne,"Reset camera to default")},attr:"resetDefault",icon:at.home,click:handleCamera3d},ht.resetCameraLastSave3d={name:"resetCameraLastSave3d",title:function(Ne){return dt(Ne,"Reset camera to last save")},attr:"resetLastSave",icon:at.movie,click:handleCamera3d},ht.hoverClosest3d={name:"hoverClosest3d",title:function(Ne){return dt(Ne,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:at.tooltip_basic,gravity:"ne",click:handleHover3d},ht.zoomInGeo={name:"zoomInGeo",title:function(Ne){return dt(Ne,"Zoom in")},attr:"zoom",val:"in",icon:at.zoom_plus,click:handleGeo},ht.zoomOutGeo={name:"zoomOutGeo",title:function(Ne){return dt(Ne,"Zoom out")},attr:"zoom",val:"out",icon:at.zoom_minus,click:handleGeo},ht.resetGeo={name:"resetGeo",title:function(Ne){return dt(Ne,"Reset")},attr:"reset",val:null,icon:at.autoscale,click:handleGeo},ht.hoverClosestGeo={name:"hoverClosestGeo",title:function(Ne){return dt(Ne,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:at.tooltip_basic,gravity:"ne",click:toggleHover},ht.hoverClosestGl2d={name:"hoverClosestGl2d",title:function(Ne){return dt(Ne,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:at.tooltip_basic,gravity:"ne",click:toggleHover},ht.hoverClosestPie={name:"hoverClosestPie",title:function(Ne){return dt(Ne,"Toggle show closest data on hover")},attr:"hovermode",val:"closest",icon:at.tooltip_basic,gravity:"ne",click:toggleHover},ht.resetViewSankey={name:"resetSankeyGroup",title:function(Ne){return dt(Ne,"Reset view")},icon:at.home,click:function(Ne){for(var Ge={"node.groups":[],"node.x":[],"node.y":[]},Qe=0;Qe<Ne._fullData.length;Qe++){var rt=Ne._fullData[Qe]._viewInitial;Ge["node.groups"].push(rt.node.groups.slice()),Ge["node.x"].push(rt.node.x.slice()),Ge["node.y"].push(rt.node.y.slice())}tt.call("restyle",Ne,Ge)}},ht.toggleHover={name:"toggleHover",title:function(Ne){return dt(Ne,"Toggle show closest data on hover")},attr:"hovermode",val:null,toggle:!0,icon:at.tooltip_basic,gravity:"ne",click:function(Ne,Ge){var Qe=getNextHover3d(Ne,Ge);Qe.hovermode=getNextHover(Ne),tt.call("_guiRelayout",Ne,Qe)}},ht.resetViews={name:"resetViews",title:function(Ne){return dt(Ne,"Reset views")},icon:at.home,click:function(Ne,Ge){var Qe=Ge.currentTarget;Qe.setAttribute("data-attr","zoom"),Qe.setAttribute("data-val","reset"),handleCartesian(Ne,Ge),Qe.setAttribute("data-attr","resetLastSave"),handleCamera3d(Ne,Ge),resetView(Ne,"geo"),resetView(Ne,"mapbox")}},ht.toggleSpikelines={name:"toggleSpikelines",title:function(Ne){return dt(Ne,"Toggle Spike Lines")},icon:at.spikeline,attr:"_cartesianSpikesEnabled",val:"on",click:function(Ne){var Ge=Ne._fullLayout,Qe=Ge._cartesianSpikesEnabled;Ge._cartesianSpikesEnabled="on"===Qe?"off":"on",tt.call("_guiRelayout",Ne,setSpikelineVisibility(Ne))}},ht.resetViewMapbox={name:"resetViewMapbox",title:function(Ne){return dt(Ne,"Reset view")},attr:"reset",icon:at.home,click:function(Ne){resetView(Ne,"mapbox")}},ht.zoomInMapbox={name:"zoomInMapbox",title:function(Ne){return dt(Ne,"Zoom in")},attr:"zoom",val:"in",icon:at.zoom_plus,click:handleMapboxZoom},ht.zoomOutMapbox={name:"zoomOutMapbox",title:function(Ne){return dt(Ne,"Zoom out")},attr:"zoom",val:"out",icon:at.zoom_minus,click:handleMapboxZoom}},{"../../fonts/ploticon":757,"../../lib":778,"../../plots/cartesian/axis_ids":831,"../../plots/plots":891,"../../registry":911,"../shapes/draw":724}],703:[function(Ne,Ge,Qe){"use strict";Qe.manage=Ne("./manage")},{"./manage":704}],704:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/cartesian/axis_ids"),rt=Ne("../../traces/scatter/subtypes"),nt=Ne("../../registry"),at=Ne("../fx/helpers").isUnifiedHover,it=Ne("./modebar"),ot=Ne("./buttons");Ge.exports=function(Ne){var Ge=Ne._fullLayout,Qe=Ne._context,tt=Ge._modeBar;if(Qe.displayModeBar||Qe.watermark){if(!Array.isArray(Qe.modeBarButtonsToRemove))throw new Error(["*modeBarButtonsToRemove* configuration options","must be an array."].join(" "));if(!Array.isArray(Qe.modeBarButtonsToAdd))throw new Error(["*modeBarButtonsToAdd* configuration options","must be an array."].join(" "));var rt,nt=Qe.modeBarButtons;rt=Array.isArray(nt)&&nt.length?fillCustomButton(nt):!Qe.displayModeBar&&Qe.watermark?[]:getButtonGroups(Ne),tt?tt.update(Ne,rt):Ge._modeBar=it(Ne,rt)}else tt&&(tt.destroy(),delete Ge._modeBar)};var dt=["drawline","drawopenpath","drawclosedpath","drawcircle","drawrect","eraseshape"];function getButtonGroups(Ne){var Ge=Ne._fullLayout,Qe=Ne._fullData,tt=Ne._context,rt=tt.modeBarButtonsToRemove,nt=tt.modeBarButtonsToAdd,it=Ge._has("cartesian"),ht=Ge._has("gl3d"),Dt=Ge._has("geo"),Ot=Ge._has("pie"),Rt=Ge._has("funnelarea"),Zt=Ge._has("gl2d"),er=Ge._has("ternary"),dr=Ge._has("mapbox"),mr=Ge._has("polar"),xr=Ge._has("sankey"),br=areAllAxesFixed(Ge),Ar=at(Ge.hovermode),en=[];function addGroup(Ne){if(Ne.length){for(var Ge=[],Qe=0;Qe<Ne.length;Qe++){var tt=Ne[Qe];-1===rt.indexOf(tt)&&Ge.push(ot[tt])}en.push(Ge)}}var mn=["toImage"];tt.showEditInChartStudio?mn.push("editInChartStudio"):tt.showSendToCloud&&mn.push("sendDataToCloud"),addGroup(mn);var xn=[],kn=[],Cn=[],En=[];if((it||Zt||Ot||Rt||er)+Dt+ht+dr+mr>1?(kn=["toggleHover"],Cn=["resetViews"]):Dt?(xn=["zoomInGeo","zoomOutGeo"],kn=["hoverClosestGeo"],Cn=["resetGeo"]):ht?(kn=["hoverClosest3d"],Cn=["resetCameraDefault3d","resetCameraLastSave3d"]):dr?(xn=["zoomInMapbox","zoomOutMapbox"],kn=["toggleHover"],Cn=["resetViewMapbox"]):Zt?kn=["hoverClosestGl2d"]:Ot?kn=["hoverClosestPie"]:xr?(kn=["hoverClosestCartesian","hoverCompareCartesian"],Cn=["resetViewSankey"]):kn=["toggleHover"],it&&(kn=["toggleSpikelines","hoverClosestCartesian","hoverCompareCartesian"]),(hasNoHover(Qe)||Ar)&&(kn=[]),!it&&!Zt||br||(xn=["zoomIn2d","zoomOut2d","autoScale2d"],"resetViews"!==Cn[0]&&(Cn=["resetScale2d"])),ht?En=["zoom3d","pan3d","orbitRotation","tableRotation"]:(it||Zt)&&!br||er?En=["zoom2d","pan2d"]:dr||Dt?En=["pan2d"]:mr&&(En=["zoom2d"]),isSelectable(Qe)&&En.push("select2d","lasso2d"),Array.isArray(nt)){for(var Pn=[],Dn=0;Dn<nt.length;Dn++){var In=nt[Dn];"string"==typeof In?-1!==dt.indexOf(In)&&(Ge._has("mapbox")||Ge._has("cartesian"))&&En.push(In):Pn.push(In)}nt=Pn}return addGroup(En),addGroup(xn.concat(Cn)),addGroup(kn),appendButtonsToGroups(en,nt)}function areAllAxesFixed(Ne){for(var Ge=tt.list({_fullLayout:Ne},null,!0),Qe=0;Qe<Ge.length;Qe++)if(!Ge[Qe].fixedrange)return!1;return!0}function isSelectable(Ne){for(var Ge=!1,Qe=0;Qe<Ne.length&&!Ge;Qe++){var tt=Ne[Qe];tt._module&&tt._module.selectPoints&&(nt.traceIs(tt,"scatter-like")?(rt.hasMarkers(tt)||rt.hasText(tt))&&(Ge=!0):nt.traceIs(tt,"box-violin")&&"all"!==tt.boxpoints&&"all"!==tt.points||(Ge=!0))}return Ge}function hasNoHover(Ne){for(var Ge=0;Ge<Ne.length;Ge++)if(!nt.traceIs(Ne[Ge],"noHover"))return!1;return!0}function appendButtonsToGroups(Ne,Ge){if(Ge.length)if(Array.isArray(Ge[0]))for(var Qe=0;Qe<Ge.length;Qe++)Ne.push(Ge[Qe]);else Ne.push(Ge);return Ne}function fillCustomButton(Ne){for(var Ge=0;Ge<Ne.length;Ge++)for(var Qe=Ne[Ge],tt=0;tt<Qe.length;tt++){var rt=Qe[tt];if("string"==typeof rt){if(void 0===ot[rt])throw new Error(["*modeBarButtons* configuration options","invalid button name"].join(" "));Ne[Ge][tt]=ot[rt]}}return Ne}},{"../../plots/cartesian/axis_ids":831,"../../registry":911,"../../traces/scatter/subtypes":1212,"../fx/helpers":679,"./buttons":702,"./modebar":705}],705:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("fast-isnumeric"),nt=Ne("../../lib"),at=Ne("../../fonts/ploticon"),it=new DOMParser;function ModeBar(Ne){this.container=Ne.container,this.element=document.createElement("div"),this.update(Ne.graphInfo,Ne.buttons),this.container.appendChild(this.element)}var ot=ModeBar.prototype;function createModeBar(Ne,Ge){var Qe=Ne._fullLayout,rt=new ModeBar({graphInfo:Ne,container:Qe._modebardiv.node(),buttons:Ge});return Qe._privateplot&&tt.select(rt.element).append("span").classed("badge-private float--left",!0).text("PRIVATE"),rt}ot.update=function(Ne,Ge){this.graphInfo=Ne;var Qe=this.graphInfo._context,tt=this.graphInfo._fullLayout,rt="modebar-"+tt._uid;this.element.setAttribute("id",rt),this._uid=rt,this.element.className="modebar","hover"===Qe.displayModeBar&&(this.element.className+=" modebar--hover ease-bg"),"v"===tt.modebar.orientation&&(this.element.className+=" vertical",Ge=Ge.reverse());var at=tt.modebar,it="hover"===Qe.displayModeBar?".js-plotly-plot .plotly:hover ":"";nt.deleteRelatedStyleRule(rt),nt.addRelatedStyleRule(rt,it+"#"+rt+" .modebar-group","background-color: "+at.bgcolor),nt.addRelatedStyleRule(rt,"#"+rt+" .modebar-btn .icon path","fill: "+at.color),nt.addRelatedStyleRule(rt,"#"+rt+" .modebar-btn:hover .icon path","fill: "+at.activecolor),nt.addRelatedStyleRule(rt,"#"+rt+" .modebar-btn.active .icon path","fill: "+at.activecolor);var ot=!this.hasButtons(Ge),dt=this.hasLogo!==Qe.displaylogo,ht=this.locale!==Qe.locale;if(this.locale=Qe.locale,(ot||dt||ht)&&(this.removeAllButtons(),this.updateButtons(Ge),Qe.watermark||Qe.displaylogo)){var Dt=this.getLogo();Qe.watermark&&(Dt.className=Dt.className+" watermark"),"v"===tt.modebar.orientation?this.element.insertBefore(Dt,this.element.childNodes[0]):this.element.appendChild(Dt),this.hasLogo=!0}this.updateActiveButton()},ot.updateButtons=function(Ne){var Ge=this;this.buttons=Ne,this.buttonElements=[],this.buttonsNames=[],this.buttons.forEach((function(Ne){var Qe=Ge.createGroup();Ne.forEach((function(Ne){var tt=Ne.name;if(!tt)throw new Error("must provide button 'name' in button config");if(-1!==Ge.buttonsNames.indexOf(tt))throw new Error("button name '"+tt+"' is taken");Ge.buttonsNames.push(tt);var rt=Ge.createButton(Ne);Ge.buttonElements.push(rt),Qe.appendChild(rt)})),Ge.element.appendChild(Qe)}))},ot.createGroup=function(){var Ne=document.createElement("div");return Ne.className="modebar-group",Ne},ot.createButton=function(Ne){var Ge=this,Qe=document.createElement("a");Qe.setAttribute("rel","tooltip"),Qe.className="modebar-btn";var rt=Ne.title;void 0===rt?rt=Ne.name:"function"==typeof rt&&(rt=rt(this.graphInfo)),(rt||0===rt)&&Qe.setAttribute("data-title",rt),void 0!==Ne.attr&&Qe.setAttribute("data-attr",Ne.attr);var nt=Ne.val;if(void 0!==nt&&("function"==typeof nt&&(nt=nt(this.graphInfo)),Qe.setAttribute("data-val",nt)),"function"!=typeof Ne.click)throw new Error("must provide button 'click' function in button config");Qe.addEventListener("click",(function(Qe){Ne.click(Ge.graphInfo,Qe),Ge.updateActiveButton(Qe.currentTarget)})),Qe.setAttribute("data-toggle",Ne.toggle||!1),Ne.toggle&&tt.select(Qe).classed("active",!0);var it=Ne.icon;return"function"==typeof it?Qe.appendChild(it()):Qe.appendChild(this.createIcon(it||at.question)),Qe.setAttribute("data-gravity",Ne.gravity||"n"),Qe},ot.createIcon=function(Ne){var Ge,Qe=rt(Ne.height)?Number(Ne.height):Ne.ascent-Ne.descent,tt="http://www.w3.org/2000/svg";if(Ne.path){(Ge=document.createElementNS(tt,"svg")).setAttribute("viewBox",[0,0,Ne.width,Qe].join(" ")),Ge.setAttribute("class","icon");var nt=document.createElementNS(tt,"path");nt.setAttribute("d",Ne.path),Ne.transform?nt.setAttribute("transform",Ne.transform):void 0!==Ne.ascent&&nt.setAttribute("transform","matrix(1 0 0 -1 0 "+Ne.ascent+")"),Ge.appendChild(nt)}return Ne.svg&&(Ge=it.parseFromString(Ne.svg,"application/xml").childNodes[0]),Ge.setAttribute("height","1em"),Ge.setAttribute("width","1em"),Ge},ot.updateActiveButton=function(Ne){var Ge=this.graphInfo._fullLayout,Qe=void 0!==Ne?Ne.getAttribute("data-attr"):null;this.buttonElements.forEach((function(Ne){var rt=Ne.getAttribute("data-val")||!0,at=Ne.getAttribute("data-attr"),it="true"===Ne.getAttribute("data-toggle"),ot=tt.select(Ne);if(it)at===Qe&&ot.classed("active",!ot.classed("active"));else{var dt=null===at?at:nt.nestedProperty(Ge,at).get();ot.classed("active",dt===rt)}}))},ot.hasButtons=function(Ne){var Ge=this.buttons;if(!Ge)return!1;if(Ne.length!==Ge.length)return!1;for(var Qe=0;Qe<Ne.length;++Qe){if(Ne[Qe].length!==Ge[Qe].length)return!1;for(var tt=0;tt<Ne[Qe].length;tt++)if(Ne[Qe][tt].name!==Ge[Qe][tt].name)return!1}return!0},ot.getLogo=function(){var Ne=this.createGroup(),Ge=document.createElement("a");return Ge.href="https://plotly.com/",Ge.target="_blank",Ge.setAttribute("data-title",nt._(this.graphInfo,"Produced with Plotly")),Ge.className="modebar-btn plotlyjsicon modebar-btn--logo",Ge.appendChild(this.createIcon(at.newplotlylogo)),Ne.appendChild(Ge),Ne},ot.removeAllButtons=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.hasLogo=!1},ot.destroy=function(){nt.removeElement(this.container.querySelector(".modebar")),nt.deleteRelatedStyleRule(this._uid)},Ge.exports=createModeBar},{"../../fonts/ploticon":757,"../../lib":778,d3:169,"fast-isnumeric":241}],706:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/font_attributes"),rt=Ne("../color/attributes"),nt=(0,Ne("../../plot_api/plot_template").templatedArray)("button",{visible:{valType:"boolean",dflt:!0,editType:"plot"},step:{valType:"enumerated",values:["month","year","day","hour","minute","second","all"],dflt:"month",editType:"plot"},stepmode:{valType:"enumerated",values:["backward","todate"],dflt:"backward",editType:"plot"},count:{valType:"number",min:0,dflt:1,editType:"plot"},label:{valType:"string",editType:"plot"},editType:"plot"});Ge.exports={visible:{valType:"boolean",editType:"plot"},buttons:nt,x:{valType:"number",min:-2,max:3,editType:"plot"},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left",editType:"plot"},y:{valType:"number",min:-2,max:3,editType:"plot"},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"bottom",editType:"plot"},font:tt({editType:"plot"}),bgcolor:{valType:"color",dflt:rt.lightLine,editType:"plot"},activecolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:rt.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"}},{"../../plot_api/plot_template":817,"../../plots/font_attributes":856,"../color/attributes":642}],707:[function(Ne,Ge,Qe){"use strict";Ge.exports={yPad:.02,minButtonWidth:30,rx:3,ry:3,lightAmount:25,darkAmount:10}},{}],708:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../color"),nt=Ne("../../plot_api/plot_template"),at=Ne("../../plots/array_container_defaults"),it=Ne("./attributes"),ot=Ne("./constants");function buttonDefaults(Ne,Ge,Qe,rt){var nt=rt.calendar;function coerce(Qe,rt){return tt.coerce(Ne,Ge,it.buttons,Qe,rt)}if(coerce("visible")){var at=coerce("step");"all"!==at&&(!nt||"gregorian"===nt||"month"!==at&&"year"!==at?coerce("stepmode"):Ge.stepmode="backward",coerce("count")),coerce("label")}}function getPosDflt(Ne,Ge,Qe){for(var tt=Qe.filter((function(Qe){return Ge[Qe].anchor===Ne._id})),rt=0,nt=0;nt<tt.length;nt++){var at=Ge[tt[nt]].domain;at&&(rt=Math.max(at[1],rt))}return[Ne.domain[0],rt+ot.yPad]}Ge.exports=function(Ne,Ge,Qe,dt,ht){var Dt=Ne.rangeselector||{},Ot=nt.newContainer(Ge,"rangeselector");function coerce(Ne,Ge){return tt.coerce(Dt,Ot,it,Ne,Ge)}if(coerce("visible",at(Dt,Ot,{name:"buttons",handleItemDefaults:buttonDefaults,calendar:ht}).length>0)){var Rt=getPosDflt(Ge,Qe,dt);coerce("x",Rt[0]),coerce("y",Rt[1]),tt.noneOrAll(Ne,Ge,["x","y"]),coerce("xanchor"),coerce("yanchor"),tt.coerceFont(coerce,"font",Qe.font);var Zt=coerce("bgcolor");coerce("activecolor",rt.contrast(Zt,ot.lightAmount,ot.darkAmount)),coerce("bordercolor"),coerce("borderwidth")}}},{"../../lib":778,"../../plot_api/plot_template":817,"../../plots/array_container_defaults":823,"../color":643,"./attributes":706,"./constants":707}],709:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../registry"),nt=Ne("../../plots/plots"),at=Ne("../color"),it=Ne("../drawing"),ot=Ne("../../lib"),dt=ot.strTranslate,ht=Ne("../../lib/svg_text_utils"),Dt=Ne("../../plots/cartesian/axis_ids"),Ot=Ne("../../constants/alignment"),Rt=Ot.LINE_SPACING,Zt=Ot.FROM_TL,er=Ot.FROM_BR,dr=Ne("./constants"),mr=Ne("./get_update_object");function makeSelectorData(Ne){for(var Ge=Dt.list(Ne,"x",!0),Qe=[],tt=0;tt<Ge.length;tt++){var rt=Ge[tt];rt.rangeselector&&rt.rangeselector.visible&&Qe.push(rt)}return Qe}function selectorKeyFunc(Ne){return Ne._id}function isActive(Ne,Ge,Qe){if("all"===Ge.step)return!0===Ne.autorange;var tt=Object.keys(Qe);return Ne.range[0]===Qe[tt[0]]&&Ne.range[1]===Qe[tt[1]]}function drawButtonRect(Ne,Ge,Qe){var tt=ot.ensureSingle(Ne,"rect","selector-rect",(function(Ne){Ne.attr("shape-rendering","crispEdges")}));tt.attr({rx:dr.rx,ry:dr.ry}),tt.call(at.stroke,Ge.bordercolor).call(at.fill,getFillColor(Ge,Qe)).style("stroke-width",Ge.borderwidth+"px")}function getFillColor(Ne,Ge){return Ge._isActive||Ge._isHovered?Ne.activecolor:Ne.bgcolor}function drawButtonText(Ne,Ge,Qe,tt){function textLayout(Ne){ht.convertToTspans(Ne,tt)}ot.ensureSingle(Ne,"text","selector-text",(function(Ne){Ne.attr("text-anchor","middle")})).call(it.font,Ge.font).text(getLabel(Qe,tt._fullLayout._meta)).call(textLayout)}function getLabel(Ne,Ge){return Ne.label?Ge?ot.templateString(Ne.label,Ge):Ne.label:"all"===Ne.step?"all":Ne.count+Ne.step.charAt(0)}function reposition(Ne,Ge,Qe,rt,at){var Dt=0,Ot=0,mr=Qe.borderwidth;Ge.each((function(){var Ne=tt.select(this).select(".selector-text"),Ge=Qe.font.size*Rt,rt=Math.max(Ge*ht.lineCount(Ne),16)+3;Ot=Math.max(Ot,rt)})),Ge.each((function(){var Ne=tt.select(this),Ge=Ne.select(".selector-rect"),rt=Ne.select(".selector-text"),nt=rt.node()&&it.bBox(rt.node()).width,at=Qe.font.size*Rt,ot=ht.lineCount(rt),Zt=Math.max(nt+10,dr.minButtonWidth);Ne.attr("transform",dt(mr+Dt,mr)),Ge.attr({x:0,y:0,width:Zt,height:Ot}),ht.positionText(rt,Zt/2,Ot/2-(ot-1)*at/2+3),Dt+=Zt+5}));var xr=Ne._fullLayout._size,br=xr.l+xr.w*Qe.x,Ar=xr.t+xr.h*(1-Qe.y),en="left";ot.isRightAnchor(Qe)&&(br-=Dt,en="right"),ot.isCenterAnchor(Qe)&&(br-=Dt/2,en="center");var mn="top";ot.isBottomAnchor(Qe)&&(Ar-=Ot,mn="bottom"),ot.isMiddleAnchor(Qe)&&(Ar-=Ot/2,mn="middle"),Dt=Math.ceil(Dt),Ot=Math.ceil(Ot),br=Math.round(br),Ar=Math.round(Ar),nt.autoMargin(Ne,rt+"-range-selector",{x:Qe.x,y:Qe.y,l:Dt*Zt[en],r:Dt*er[en],b:Ot*er[mn],t:Ot*Zt[mn]}),at.attr("transform",dt(br,Ar))}Ge.exports=function(Ne){var Ge=Ne._fullLayout._infolayer.selectAll(".rangeselector").data(makeSelectorData(Ne),selectorKeyFunc);Ge.enter().append("g").classed("rangeselector",!0),Ge.exit().remove(),Ge.style({cursor:"pointer","pointer-events":"all"}),Ge.each((function(Ge){var Qe=tt.select(this),nt=Ge,at=nt.rangeselector,it=Qe.selectAll("g.button").data(ot.filterVisible(at.buttons));it.enter().append("g").classed("button",!0),it.exit().remove(),it.each((function(Ge){var Qe=tt.select(this),it=mr(nt,Ge);Ge._isActive=isActive(nt,Ge,it),Qe.call(drawButtonRect,at,Ge),Qe.call(drawButtonText,at,Ge,Ne),Qe.on("click",(function(){Ne._dragged||rt.call("_guiRelayout",Ne,it)})),Qe.on("mouseover",(function(){Ge._isHovered=!0,Qe.call(drawButtonRect,at,Ge)})),Qe.on("mouseout",(function(){Ge._isHovered=!1,Qe.call(drawButtonRect,at,Ge)}))})),reposition(Ne,it,at,nt._name,Qe)}))}},{"../../constants/alignment":745,"../../lib":778,"../../lib/svg_text_utils":803,"../../plots/cartesian/axis_ids":831,"../../plots/plots":891,"../../registry":911,"../color":643,"../drawing":665,"./constants":707,"./get_update_object":710,d3:169}],710:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3");function getXRange(Ne,Ge){var Qe,rt=Ne.range,nt=new Date(Ne.r2l(rt[1])),at=Ge.step,it=Ge.count;switch(Ge.stepmode){case"backward":Qe=Ne.l2r(+tt.time[at].utc.offset(nt,-it));break;case"todate":var ot=tt.time[at].utc.offset(nt,-it);Qe=Ne.l2r(+tt.time[at].utc.ceil(ot))}return[Qe,rt[1]]}Ge.exports=function(Ne,Ge){var Qe=Ne._name,tt={};if("all"===Ge.step)tt[Qe+".autorange"]=!0;else{var rt=getXRange(Ne,Ge);tt[Qe+".range[0]"]=rt[0],tt[Qe+".range[1]"]=rt[1]}return tt}},{d3:169}],711:[function(Ne,Ge,Qe){"use strict";Ge.exports={moduleType:"component",name:"rangeselector",schema:{subplots:{xaxis:{rangeselector:Ne("./attributes")}}},layoutAttributes:Ne("./attributes"),handleDefaults:Ne("./defaults"),draw:Ne("./draw")}},{"./attributes":706,"./defaults":708,"./draw":709}],712:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../color/attributes");Ge.exports={bgcolor:{valType:"color",dflt:tt.background,editType:"plot"},bordercolor:{valType:"color",dflt:tt.defaultLine,editType:"plot"},borderwidth:{valType:"integer",dflt:0,min:0,editType:"plot"},autorange:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},range:{valType:"info_array",items:[{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"calc",impliedEdits:{"^autorange":!1}}],editType:"calc",impliedEdits:{autorange:!1}},thickness:{valType:"number",dflt:.15,min:0,max:1,editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"}},{"../color/attributes":642}],713:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/cartesian/axis_ids").list,rt=Ne("../../plots/cartesian/autorange").getAutoRange,nt=Ne("./constants");Ge.exports=function(Ne){for(var Ge=tt(Ne,"x",!0),Qe=0;Qe<Ge.length;Qe++){var at=Ge[Qe],it=at[nt.name];it&&it.visible&&it.autorange&&(it._input.autorange=!0,it._input.range=it.range=rt(Ne,at))}}},{"../../plots/cartesian/autorange":827,"../../plots/cartesian/axis_ids":831,"./constants":714}],714:[function(Ne,Ge,Qe){"use strict";Ge.exports={name:"rangeslider",containerClassName:"rangeslider-container",bgClassName:"rangeslider-bg",rangePlotClassName:"rangeslider-rangeplot",maskMinClassName:"rangeslider-mask-min",maskMaxClassName:"rangeslider-mask-max",slideBoxClassName:"rangeslider-slidebox",grabberMinClassName:"rangeslider-grabber-min",grabAreaMinClassName:"rangeslider-grabarea-min",handleMinClassName:"rangeslider-handle-min",grabberMaxClassName:"rangeslider-grabber-max",grabAreaMaxClassName:"rangeslider-grabarea-max",handleMaxClassName:"rangeslider-handle-max",maskMinOppAxisClassName:"rangeslider-mask-min-opp-axis",maskMaxOppAxisClassName:"rangeslider-mask-max-opp-axis",maskColor:"rgba(0,0,0,0.4)",maskOppAxisColor:"rgba(0,0,0,0.2)",slideBoxFill:"transparent",slideBoxCursor:"ew-resize",grabAreaFill:"transparent",grabAreaCursor:"col-resize",grabAreaWidth:10,handleWidth:4,handleRadius:1,handleStrokeWidth:1,extraPad:15}},{}],715:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../plot_api/plot_template"),nt=Ne("../../plots/cartesian/axis_ids"),at=Ne("./attributes"),it=Ne("./oppaxis_attributes");Ge.exports=function(Ne,Ge,Qe){var ot=Ne[Qe],dt=Ge[Qe];if(ot.rangeslider||Ge._requestRangeslider[dt._id]){tt.isPlainObject(ot.rangeslider)||(ot.rangeslider={});var ht,Dt,Ot=ot.rangeslider,Rt=rt.newContainer(dt,"rangeslider");if(coerce("visible")){coerce("bgcolor",Ge.plot_bgcolor),coerce("bordercolor"),coerce("borderwidth"),coerce("thickness"),coerce("autorange",!dt.isValidRange(Ot.range)),coerce("range");var Zt=Ge._subplots;if(Zt)for(var er=Zt.cartesian.filter((function(Ne){return Ne.substr(0,Ne.indexOf("y"))===nt.name2id(Qe)})).map((function(Ne){return Ne.substr(Ne.indexOf("y"),Ne.length)})),dr=tt.simpleMap(er,nt.id2name),mr=0;mr<dr.length;mr++){var xr=dr[mr];ht=Ot[xr]||{},Dt=rt.newContainer(Rt,xr,"yaxis");var br,Ar=Ge[xr];ht.range&&Ar.isValidRange(ht.range)&&(br="fixed"),"match"!==coerceRange("rangemode",br)&&coerceRange("range",Ar.range.slice())}Rt._input=Ot}}function coerce(Ne,Ge){return tt.coerce(Ot,Rt,at,Ne,Ge)}function coerceRange(Ne,Ge){return tt.coerce(ht,Dt,it,Ne,Ge)}}},{"../../lib":778,"../../plot_api/plot_template":817,"../../plots/cartesian/axis_ids":831,"./attributes":712,"./oppaxis_attributes":719}],716:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../registry"),nt=Ne("../../plots/plots"),at=Ne("../../lib"),it=at.strTranslate,ot=Ne("../drawing"),dt=Ne("../color"),ht=Ne("../titles"),Dt=Ne("../../plots/cartesian"),Ot=Ne("../../plots/cartesian/axis_ids"),Rt=Ne("../dragelement"),Zt=Ne("../../lib/setcursor"),er=Ne("./constants");function setupDragElement(Ne,Ge,Qe,rt){if(!Ge._context.staticPlot){var nt=Ne.select("rect."+er.slideBoxClassName).node(),it=Ne.select("rect."+er.grabAreaMinClassName).node(),ot=Ne.select("rect."+er.grabAreaMaxClassName).node();Ne.on("mousedown",mouseDownHandler),Ne.on("touchstart",mouseDownHandler)}function mouseDownHandler(){var dt=tt.event,ht=dt.target,Dt=dt.clientX||dt.touches[0].clientX,Ot=Dt-Ne.node().getBoundingClientRect().left,er=rt.d2p(Qe._rl[0]),dr=rt.d2p(Qe._rl[1]),mr=Rt.coverSlip();function mouseMove(at){var dt,Rt,xr,br=+(at.clientX||at.touches[0].clientX)-Dt;switch(ht){case nt:xr="ew-resize",dt=er+br,Rt=dr+br;break;case it:xr="col-resize",dt=er+br,Rt=dr;break;case ot:xr="col-resize",dt=er,Rt=dr+br;break;default:xr="ew-resize",dt=Ot,Rt=Ot+br}if(Rt<dt){var Ar=Rt;Rt=dt,dt=Ar}rt._pixelMin=dt,rt._pixelMax=Rt,Zt(tt.select(mr),xr),setDataRange(Ne,Ge,Qe,rt)}function mouseUp(){mr.removeEventListener("mousemove",mouseMove),mr.removeEventListener("mouseup",mouseUp),this.removeEventListener("touchmove",mouseMove),this.removeEventListener("touchend",mouseUp),at.removeElement(mr)}this.addEventListener("touchmove",mouseMove),this.addEventListener("touchend",mouseUp),mr.addEventListener("mousemove",mouseMove),mr.addEventListener("mouseup",mouseUp)}}function setDataRange(Ne,Ge,Qe,tt){function clamp(Ne){return Qe.l2r(at.constrain(Ne,tt._rl[0],tt._rl[1]))}var nt=clamp(tt.p2d(tt._pixelMin)),it=clamp(tt.p2d(tt._pixelMax));window.requestAnimationFrame((function(){rt.call("_guiRelayout",Ge,Qe._name+".range",[nt,it])}))}function setPixelRange(Ne,Ge,Qe,tt,rt,nt){var ot=er.handleWidth/2;function clamp(Ne){return at.constrain(Ne,0,tt._width)}function clampOppAxis(Ne){return at.constrain(Ne,0,tt._height)}function clampHandle(Ne){return at.constrain(Ne,-ot,tt._width+ot)}var dt=clamp(tt.d2p(Qe._rl[0])),ht=clamp(tt.d2p(Qe._rl[1]));if(Ne.select("rect."+er.slideBoxClassName).attr("x",dt).attr("width",ht-dt),Ne.select("rect."+er.maskMinClassName).attr("width",dt),Ne.select("rect."+er.maskMaxClassName).attr("x",ht).attr("width",tt._width-ht),"match"!==nt.rangemode){var Dt=tt._height-clampOppAxis(tt.d2pOppAxis(rt._rl[1])),Ot=tt._height-clampOppAxis(tt.d2pOppAxis(rt._rl[0]));Ne.select("rect."+er.maskMinOppAxisClassName).attr("x",dt).attr("height",Dt).attr("width",ht-dt),Ne.select("rect."+er.maskMaxOppAxisClassName).attr("x",dt).attr("y",Ot).attr("height",tt._height-Ot).attr("width",ht-dt),Ne.select("rect."+er.slideBoxClassName).attr("y",Dt).attr("height",Ot-Dt)}var Rt=.5,Zt=Math.round(clampHandle(dt-ot))-Rt,dr=Math.round(clampHandle(ht-ot))+Rt;Ne.select("g."+er.grabberMinClassName).attr("transform",it(Zt,Rt)),Ne.select("g."+er.grabberMaxClassName).attr("transform",it(dr,Rt))}function drawBg(Ne,Ge,Qe,tt){var rt=at.ensureSingle(Ne,"rect",er.bgClassName,(function(Ne){Ne.attr({x:0,y:0,"shape-rendering":"crispEdges"})})),nt=tt.borderwidth%2==0?tt.borderwidth:tt.borderwidth-1,dt=-tt._offsetShift,ht=ot.crispRound(Ge,tt.borderwidth);rt.attr({width:tt._width+nt,height:tt._height+nt,transform:it(dt,dt),fill:tt.bgcolor,stroke:tt.bordercolor,"stroke-width":ht})}function addClipPath(Ne,Ge,Qe,tt){var rt=Ge._fullLayout;at.ensureSingleById(rt._topdefs,"clipPath",tt._clipId,(function(Ne){Ne.append("rect").attr({x:0,y:0})})).select("rect").attr({width:tt._width,height:tt._height})}function drawRangePlot(Ne,Ge,Qe,rt){var it,dt=Ge.calcdata,ht=Ne.selectAll("g."+er.rangePlotClassName).data(Qe._subplotsWith,at.identity);ht.enter().append("g").attr("class",(function(Ne){return er.rangePlotClassName+" "+Ne})).call(ot.setClipUrl,rt._clipId,Ge),ht.order(),ht.exit().remove(),ht.each((function(Ne,at){var ot=tt.select(this),ht=0===at,Rt=Ot.getFromId(Ge,Ne,"y"),Zt=Rt._name,er=rt[Zt],dr={data:[],layout:{xaxis:{type:Qe.type,domain:[0,1],range:rt.range.slice(),calendar:Qe.calendar},width:rt._width,height:rt._height,margin:{t:0,b:0,l:0,r:0}},_context:Ge._context};Qe.rangebreaks&&(dr.layout.xaxis.rangebreaks=Qe.rangebreaks),dr.layout[Zt]={type:Rt.type,domain:[0,1],range:"match"!==er.rangemode?er.range.slice():Rt.range.slice(),calendar:Rt.calendar},Rt.rangebreaks&&(dr.layout[Zt].rangebreaks=Rt.rangebreaks),nt.supplyDefaults(dr);var mr=dr._fullLayout.xaxis,xr=dr._fullLayout[Zt];mr.clearCalc(),mr.setScale(),xr.clearCalc(),xr.setScale();var br={id:Ne,plotgroup:ot,xaxis:mr,yaxis:xr,isRangePlot:!0};ht?it=br:(br.mainplot="xy",br.mainplotinfo=it),Dt.rangePlot(Ge,br,filterRangePlotCalcData(dt,Ne))}))}function filterRangePlotCalcData(Ne,Ge){for(var Qe=[],tt=0;tt<Ne.length;tt++){var rt=Ne[tt],nt=rt[0].trace;nt.xaxis+nt.yaxis===Ge&&Qe.push(rt)}return Qe}function drawMasks(Ne,Ge,Qe,tt,rt){at.ensureSingle(Ne,"rect",er.maskMinClassName,(function(Ne){Ne.attr({x:0,y:0,"shape-rendering":"crispEdges"})})).attr("height",tt._height).call(dt.fill,er.maskColor),at.ensureSingle(Ne,"rect",er.maskMaxClassName,(function(Ne){Ne.attr({y:0,"shape-rendering":"crispEdges"})})).attr("height",tt._height).call(dt.fill,er.maskColor),"match"!==rt.rangemode&&(at.ensureSingle(Ne,"rect",er.maskMinOppAxisClassName,(function(Ne){Ne.attr({y:0,"shape-rendering":"crispEdges"})})).attr("width",tt._width).call(dt.fill,er.maskOppAxisColor),at.ensureSingle(Ne,"rect",er.maskMaxOppAxisClassName,(function(Ne){Ne.attr({y:0,"shape-rendering":"crispEdges"})})).attr("width",tt._width).style("border-top",er.maskOppBorder).call(dt.fill,er.maskOppAxisColor))}function drawSlideBox(Ne,Ge,Qe,tt){Ge._context.staticPlot||at.ensureSingle(Ne,"rect",er.slideBoxClassName,(function(Ne){Ne.attr({y:0,cursor:er.slideBoxCursor,"shape-rendering":"crispEdges"})})).attr({height:tt._height,fill:er.slideBoxFill})}function drawGrabbers(Ne,Ge,Qe,tt){var rt=at.ensureSingle(Ne,"g",er.grabberMinClassName),nt=at.ensureSingle(Ne,"g",er.grabberMaxClassName),it={x:0,width:er.handleWidth,rx:er.handleRadius,fill:dt.background,stroke:dt.defaultLine,"stroke-width":er.handleStrokeWidth,"shape-rendering":"crispEdges"},ot={y:Math.round(tt._height/4),height:Math.round(tt._height/2)};at.ensureSingle(rt,"rect",er.handleMinClassName,(function(Ne){Ne.attr(it)})).attr(ot),at.ensureSingle(nt,"rect",er.handleMaxClassName,(function(Ne){Ne.attr(it)})).attr(ot);var ht={width:er.grabAreaWidth,x:0,y:0,fill:er.grabAreaFill,cursor:Ge._context.staticPlot?void 0:er.grabAreaCursor};at.ensureSingle(rt,"rect",er.grabAreaMinClassName,(function(Ne){Ne.attr(ht)})).attr("height",tt._height),at.ensureSingle(nt,"rect",er.grabAreaMaxClassName,(function(Ne){Ne.attr(ht)})).attr("height",tt._height)}Ge.exports=function(Ne){for(var Ge=Ne._fullLayout,Qe=Ge._rangeSliderData,rt=0;rt<Qe.length;rt++){var nt=Qe[rt][er.name];nt._clipId=nt._id+"-"+Ge._uid}function keyFunction(Ne){return Ne._name}var ot=Ge._infolayer.selectAll("g."+er.containerClassName).data(Qe,keyFunction);ot.exit().each((function(Ne){var Qe=Ne[er.name];Ge._topdefs.select("#"+Qe._clipId).remove()})).remove(),0!==Qe.length&&(ot.enter().append("g").classed(er.containerClassName,!0).attr("pointer-events","all"),ot.each((function(Qe){var rt=tt.select(this),nt=Qe[er.name],ot=Ge[Ot.id2name(Qe.anchor)],dt=nt[Ot.id2name(Qe.anchor)];if(nt.range){var Dt,Rt=at.simpleMap(nt.range,Qe.r2l),Zt=at.simpleMap(Qe.range,Qe.r2l);Dt=Zt[0]<Zt[1]?[Math.min(Rt[0],Zt[0]),Math.max(Rt[1],Zt[1])]:[Math.max(Rt[0],Zt[0]),Math.min(Rt[1],Zt[1])],nt.range=nt._input.range=at.simpleMap(Dt,Qe.l2r)}Qe.cleanRange("rangeslider.range");var dr=Ge._size,mr=Qe.domain;nt._width=dr.w*(mr[1]-mr[0]);var xr=Math.round(dr.l+dr.w*mr[0]),br=Math.round(dr.t+dr.h*(1-Qe._counterDomainMin)+("bottom"===Qe.side?Qe._depth:0)+nt._offsetShift+er.extraPad);rt.attr("transform",it(xr,br)),nt._rl=at.simpleMap(nt.range,Qe.r2l);var Ar=nt._rl[0],en=nt._rl[1],mn=en-Ar;if(nt.p2d=function(Ne){return Ne/nt._width*mn+Ar},nt.d2p=function(Ne){return(Ne-Ar)/mn*nt._width},Qe.rangebreaks){var xn=Qe.locateBreaks(Ar,en);if(xn.length){var kn,Cn,En=0;for(kn=0;kn<xn.length;kn++)En+=(Cn=xn[kn]).max-Cn.min;var Pn=nt._width/(en-Ar-En),Dn=[-Pn*Ar];for(kn=0;kn<xn.length;kn++)Cn=xn[kn],Dn.push(Dn[Dn.length-1]-Pn*(Cn.max-Cn.min));for(nt.d2p=function(Ne){for(var Ge=Dn[0],Qe=0;Qe<xn.length;Qe++){var tt=xn[Qe];if(Ne>=tt.max)Ge=Dn[Qe+1];else if(Ne<tt.min)break}return Ge+Pn*Ne},kn=0;kn<xn.length;kn++)(Cn=xn[kn]).pmin=nt.d2p(Cn.min),Cn.pmax=nt.d2p(Cn.max);nt.p2d=function(Ne){for(var Ge=Dn[0],Qe=0;Qe<xn.length;Qe++){var tt=xn[Qe];if(Ne>=tt.pmax)Ge=Dn[Qe+1];else if(Ne<tt.pmin)break}return(Ne-Ge)/Pn}}}if("match"!==dt.rangemode){var In=ot.r2l(dt.range[0]),zn=ot.r2l(dt.range[1])-In;nt.d2pOppAxis=function(Ne){return(Ne-In)/zn*nt._height}}rt.call(drawBg,Ne,Qe,nt).call(addClipPath,Ne,Qe,nt).call(drawRangePlot,Ne,Qe,nt).call(drawMasks,Ne,Qe,nt,dt).call(drawSlideBox,Ne,Qe,nt).call(drawGrabbers,Ne,Qe,nt),setupDragElement(rt,Ne,Qe,nt),setPixelRange(rt,Ne,Qe,nt,ot,dt),"bottom"===Qe.side&&ht.draw(Ne,Qe._id+"title",{propContainer:Qe,propName:Qe._name+".title",placeholder:Ge._dfltTitle.x,attributes:{x:Qe._offset+Qe._length/2,y:br+nt._height+nt._offsetShift+10+1.5*Qe.title.font.size,"text-anchor":"middle"}})})))}},{"../../lib":778,"../../lib/setcursor":799,"../../plots/cartesian":841,"../../plots/cartesian/axis_ids":831,"../../plots/plots":891,"../../registry":911,"../color":643,"../dragelement":662,"../drawing":665,"../titles":738,"./constants":714,d3:169}],717:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/cartesian/axis_ids"),rt=Ne("../../lib/svg_text_utils"),nt=Ne("./constants"),at=Ne("../../constants/alignment").LINE_SPACING,it=nt.name;function isVisible(Ne){var Ge=Ne&&Ne[it];return Ge&&Ge.visible}Qe.isVisible=isVisible,Qe.makeData=function(Ne){var Ge=tt.list({_fullLayout:Ne},"x",!0),Qe=Ne.margin,rt=[];if(!Ne._has("gl2d"))for(var nt=0;nt<Ge.length;nt++){var at=Ge[nt];if(isVisible(at)){rt.push(at);var ot=at[it];ot._id=it+at._id,ot._height=(Ne.height-Qe.b-Qe.t)*ot.thickness,ot._offsetShift=Math.floor(ot.borderwidth/2)}}Ne._rangeSliderData=rt},Qe.autoMarginOpts=function(Ne,Ge){var Qe=Ne._fullLayout,tt=Ge[it],ot=Ge._id.charAt(0),dt=0,ht=0;return"bottom"===Ge.side&&(dt=Ge._depth,Ge.title.text!==Qe._dfltTitle[ot]&&(ht=1.5*Ge.title.font.size+10+tt._offsetShift,ht+=(Ge.title.text.match(rt.BR_TAG_ALL)||[]).length*Ge.title.font.size*at)),{x:0,y:Ge._counterDomainMin,l:0,r:0,t:0,b:tt._height+dt+Math.max(Qe.margin.b,ht),pad:nt.extraPad+2*tt._offsetShift}}},{"../../constants/alignment":745,"../../lib/svg_text_utils":803,"../../plots/cartesian/axis_ids":831,"./constants":714}],718:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./attributes"),nt=Ne("./oppaxis_attributes"),at=Ne("./helpers");Ge.exports={moduleType:"component",name:"rangeslider",schema:{subplots:{xaxis:{rangeslider:tt.extendFlat({},rt,{yaxis:nt})}}},layoutAttributes:Ne("./attributes"),handleDefaults:Ne("./defaults"),calcAutorange:Ne("./calc_autorange"),draw:Ne("./draw"),isVisible:at.isVisible,makeData:at.makeData,autoMarginOpts:at.autoMarginOpts}},{"../../lib":778,"./attributes":712,"./calc_autorange":713,"./defaults":715,"./draw":716,"./helpers":717,"./oppaxis_attributes":719}],719:[function(Ne,Ge,Qe){"use strict";Ge.exports={_isSubplotObj:!0,rangemode:{valType:"enumerated",values:["auto","fixed","match"],dflt:"match",editType:"calc"},range:{valType:"info_array",items:[{valType:"any",editType:"plot"},{valType:"any",editType:"plot"}],editType:"plot"},editType:"calc"}},{}],720:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../annotations/attributes"),rt=Ne("../../traces/scatter/attributes").line,nt=Ne("../drawing/attributes").dash,at=Ne("../../lib/extend").extendFlat,it=Ne("../../plot_api/plot_template").templatedArray;Ne("../../constants/axis_placeable_objects"),Ge.exports=it("shape",{visible:{valType:"boolean",dflt:!0,editType:"calc+arraydraw"},type:{valType:"enumerated",values:["circle","rect","path","line"],editType:"calc+arraydraw"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"arraydraw"},xref:at({},tt.xref,{}),xsizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},xanchor:{valType:"any",editType:"calc+arraydraw"},x0:{valType:"any",editType:"calc+arraydraw"},x1:{valType:"any",editType:"calc+arraydraw"},yref:at({},tt.yref,{}),ysizemode:{valType:"enumerated",values:["scaled","pixel"],dflt:"scaled",editType:"calc+arraydraw"},yanchor:{valType:"any",editType:"calc+arraydraw"},y0:{valType:"any",editType:"calc+arraydraw"},y1:{valType:"any",editType:"calc+arraydraw"},path:{valType:"string",editType:"calc+arraydraw"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"arraydraw"},line:{color:at({},rt.color,{editType:"arraydraw"}),width:at({},rt.width,{editType:"calc+arraydraw"}),dash:at({},nt,{editType:"arraydraw"}),editType:"calc+arraydraw"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"arraydraw"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"arraydraw"},editable:{valType:"boolean",dflt:!1,editType:"calc+arraydraw"},editType:"arraydraw"})},{"../../constants/axis_placeable_objects":746,"../../lib/extend":768,"../../plot_api/plot_template":817,"../../traces/scatter/attributes":1187,"../annotations/attributes":626,"../drawing/attributes":664}],721:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../plots/cartesian/axes"),nt=Ne("./constants"),at=Ne("./helpers");function calcXPaddingOptions(Ne){return calcPaddingOptions(Ne.line.width,Ne.xsizemode,Ne.x0,Ne.x1,Ne.path,!1)}function calcYPaddingOptions(Ne){return calcPaddingOptions(Ne.line.width,Ne.ysizemode,Ne.y0,Ne.y1,Ne.path,!0)}function calcPaddingOptions(Ne,Ge,Qe,rt,it,ot){var dt=Ne/2,ht=ot;if("pixel"===Ge){var Dt=it?at.extractPathCoords(it,ot?nt.paramIsY:nt.paramIsX):[Qe,rt],Ot=tt.aggNums(Math.max,null,Dt),Rt=tt.aggNums(Math.min,null,Dt),Zt=Rt<0?Math.abs(Rt)+dt:dt,er=Ot>0?Ot+dt:dt;return{ppad:dt,ppadplus:ht?Zt:er,ppadminus:ht?er:Zt}}return{ppad:dt}}function shapeBounds(Ne,Ge,Qe,tt,rt){var it="category"===Ne.type||"multicategory"===Ne.type?Ne.r2c:Ne.d2c;if(void 0!==Ge)return[it(Ge),it(Qe)];if(tt){var ot,dt,ht,Dt,Ot=1/0,Rt=-1/0,Zt=tt.match(nt.segmentRE);for("date"===Ne.type&&(it=at.decodeDate(it)),ot=0;ot<Zt.length;ot++)void 0!==(dt=rt[Zt[ot].charAt(0)].drawn)&&(!(ht=Zt[ot].substr(1).match(nt.paramRE))||ht.length<dt||((Dt=it(ht[dt]))<Ot&&(Ot=Dt),Dt>Rt&&(Rt=Dt)));return Rt>=Ot?[Ot,Rt]:void 0}}Ge.exports=function(Ne){var Ge=Ne._fullLayout,Qe=tt.filterVisible(Ge.shapes);if(Qe.length&&Ne._fullData.length)for(var at=0;at<Qe.length;at++){var it,ot,dt=Qe[at];dt._extremes={};var ht=rt.getRefType(dt.xref),Dt=rt.getRefType(dt.yref);if("paper"!==dt.xref&&"domain"!==ht){var Ot="pixel"===dt.xsizemode?dt.xanchor:dt.x0,Rt="pixel"===dt.xsizemode?dt.xanchor:dt.x1;(ot=shapeBounds(it=rt.getFromId(Ne,dt.xref),Ot,Rt,dt.path,nt.paramIsX))&&(dt._extremes[it._id]=rt.findExtremes(it,ot,calcXPaddingOptions(dt)))}if("paper"!==dt.yref&&"domain"!==Dt){var Zt="pixel"===dt.ysizemode?dt.yanchor:dt.y0,er="pixel"===dt.ysizemode?dt.yanchor:dt.y1;(ot=shapeBounds(it=rt.getFromId(Ne,dt.yref),Zt,er,dt.path,nt.paramIsY))&&(dt._extremes[it._id]=rt.findExtremes(it,ot,calcYPaddingOptions(dt)))}}}},{"../../lib":778,"../../plots/cartesian/axes":828,"./constants":722,"./helpers":731}],722:[function(Ne,Ge,Qe){"use strict";Ge.exports={segmentRE:/[MLHVQCTSZ][^MLHVQCTSZ]*/g,paramRE:/[^\s,]+/g,paramIsX:{M:{0:!0,drawn:0},L:{0:!0,drawn:0},H:{0:!0,drawn:0},V:{},Q:{0:!0,2:!0,drawn:2},C:{0:!0,2:!0,4:!0,drawn:4},T:{0:!0,drawn:0},S:{0:!0,2:!0,drawn:2},Z:{}},paramIsY:{M:{1:!0,drawn:1},L:{1:!0,drawn:1},H:{},V:{0:!0,drawn:0},Q:{1:!0,3:!0,drawn:3},C:{1:!0,3:!0,5:!0,drawn:5},T:{1:!0,drawn:1},S:{1:!0,3:!0,drawn:5},Z:{}},numParams:{M:2,L:2,H:1,V:1,Q:4,C:6,T:2,S:4,Z:0}}},{}],723:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../plots/cartesian/axes"),nt=Ne("../../plots/array_container_defaults"),at=Ne("./attributes"),it=Ne("./helpers");function handleShapeDefaults(Ne,Ge,Qe){function coerce(Qe,rt){return tt.coerce(Ne,Ge,at,Qe,rt)}if(coerce("visible")){var nt=coerce("path"),ot=coerce("type",nt?"path":"rect");"path"!==Ge.type&&delete Ge.path,coerce("editable"),coerce("layer"),coerce("opacity"),coerce("fillcolor"),coerce("fillrule"),coerce("line.width")&&(coerce("line.color"),coerce("line.dash"));for(var dt=coerce("xsizemode"),ht=coerce("ysizemode"),Dt=["x","y"],Ot=0;Ot<2;Ot++){var Rt,Zt,er,dr=Dt[Ot],mr=dr+"anchor",xr="x"===dr?dt:ht,br={_fullLayout:Qe},Ar=rt.coerceRef(Ne,Ge,br,dr,void 0,"paper");if("range"===rt.getRefType(Ar)?((Rt=rt.getFromId(br,Ar))._shapeIndices.push(Ge._index),er=it.rangeToShapePosition(Rt),Zt=it.shapePositionToRange(Rt)):Zt=er=tt.identity,"path"!==ot){var en=.25,mn=.75,xn=dr+"0",kn=dr+"1",Cn=Ne[xn],En=Ne[kn];Ne[xn]=Zt(Ne[xn],!0),Ne[kn]=Zt(Ne[kn],!0),"pixel"===xr?(coerce(xn,0),coerce(kn,10)):(rt.coercePosition(Ge,br,coerce,Ar,xn,en),rt.coercePosition(Ge,br,coerce,Ar,kn,mn)),Ge[xn]=er(Ge[xn]),Ge[kn]=er(Ge[kn]),Ne[xn]=Cn,Ne[kn]=En}if("pixel"===xr){var Pn=Ne[mr];Ne[mr]=Zt(Ne[mr],!0),rt.coercePosition(Ge,br,coerce,Ar,mr,.25),Ge[mr]=er(Ge[mr]),Ne[mr]=Pn}}"path"===ot?coerce("path"):tt.noneOrAll(Ne,Ge,["x0","x1","y0","y1"])}}Ge.exports=function(Ne,Ge){nt(Ne,Ge,{name:"shapes",handleItemDefaults:handleShapeDefaults})}},{"../../lib":778,"../../plots/array_container_defaults":823,"../../plots/cartesian/axes":828,"./attributes":720,"./helpers":731}],724:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../registry"),rt=Ne("../../lib"),nt=Ne("../../plots/cartesian/axes"),at=Ne("./draw_newshape/helpers").readPaths,it=Ne("./draw_newshape/display_outlines"),ot=Ne("../../plots/cartesian/handle_outline").clearOutlineControllers,dt=Ne("../color"),ht=Ne("../drawing"),Dt=Ne("../../plot_api/plot_template").arrayEditor,Ot=Ne("../dragelement"),Rt=Ne("../../lib/setcursor"),Zt=Ne("./constants"),er=Ne("./helpers");function draw(Ne){var Ge=Ne._fullLayout;for(var Qe in Ge._shapeUpperLayer.selectAll("path").remove(),Ge._shapeLowerLayer.selectAll("path").remove(),Ge._plots){var tt=Ge._plots[Qe].shapelayer;tt&&tt.selectAll("path").remove()}for(var rt=0;rt<Ge.shapes.length;rt++)Ge.shapes[rt].visible&&drawOne(Ne,rt)}function shouldSkipEdits(Ne){return!!Ne._fullLayout._drawing}function couldHaveActiveShape(Ne){return!Ne._context.edits.shapePosition}function drawOne(Ne,Ge){Ne._fullLayout._paperdiv.selectAll('.shapelayer [data-index="'+Ge+'"]').remove();var Qe=er.makeOptionsAndPlotinfo(Ne,Ge),tt=Qe.options,rt=Qe.plotinfo;function drawShape(Qe){var nt=getPathString(Ne,tt),ot={"data-index":Ge,"fill-rule":tt.fillrule,d:nt},Ot=tt.opacity,Rt=tt.fillcolor,Zt=tt.line.width?tt.line.color:"rgba(0,0,0,0)",er=tt.line.width,dr=tt.line.dash;er||!0!==tt.editable||(er=5,dr="solid");var mr="Z"!==nt[nt.length-1],xr=couldHaveActiveShape(Ne)&&tt.editable&&Ne._fullLayout._activeShapeIndex===Ge;xr&&(Rt=mr?"rgba(0,0,0,0)":Ne._fullLayout.activeshape.fillcolor,Ot=Ne._fullLayout.activeshape.opacity);var br,Ar=Qe.append("path").attr(ot).style("opacity",Ot).call(dt.stroke,Zt).call(dt.fill,Rt).call(ht.dashLine,dr,er);if(setClipPath(Ar,Ne,tt),(xr||Ne._context.edits.shapePosition)&&(br=Dt(Ne.layout,"shapes",tt)),xr){Ar.style({cursor:"move"});var en={element:Ar.node(),plotinfo:rt,gd:Ne,editHelpers:br,isActiveShape:!0},mn=at(nt,Ne);it(mn,Ar,en)}else Ne._context.edits.shapePosition?setupDragElement(Ne,Ar,tt,Ge,Qe,br):!0===tt.editable&&Ar.style("pointer-events",mr||dt.opacity(Rt)*Ot<=.5?"stroke":"all");Ar.node().addEventListener("click",(function(){return activateShape(Ne,Ar)}))}tt._input&&!1!==tt.visible&&("below"!==tt.layer?drawShape(Ne._fullLayout._shapeUpperLayer):"paper"===tt.xref||"paper"===tt.yref?drawShape(Ne._fullLayout._shapeLowerLayer):rt._hadPlotinfo?drawShape((rt.mainplotinfo||rt).shapelayer):drawShape(Ne._fullLayout._shapeLowerLayer))}function setClipPath(Ne,Ge,Qe){var tt=(Qe.xref+Qe.yref).replace(/paper/g,"").replace(/[xyz][1-9]* *domain/g,"");ht.setClipUrl(Ne,tt?"clip"+Ge._fullLayout._uid+tt:null,Ge)}function setupDragElement(Ne,Ge,Qe,at,it,ot){var dt,Dt,dr,mr,xr,br,Ar,en,mn,xn,kn,Cn,En,Pn,Dn,In,zn=10,Bn=10,Vn="pixel"===Qe.xsizemode,Hn="pixel"===Qe.ysizemode,qn="line"===Qe.type,Yn="path"===Qe.type,$n=ot.modifyItem,ra=nt.getFromId(Ne,Qe.xref),oa=nt.getRefType(Qe.xref),pa=nt.getFromId(Ne,Qe.yref),ga=nt.getRefType(Qe.yref),ma=er.getDataToPixel(Ne,ra,!1,oa),_a=er.getDataToPixel(Ne,pa,!0,ga),Va=er.getPixelToData(Ne,ra,!1,oa),Wa=er.getPixelToData(Ne,pa,!0,ga),Qa=obtainSensoryElement(),ti={element:Qa.node(),gd:Ne,prepFn:startDrag,doneFn:endDrag,clickFn:abortDrag};function obtainSensoryElement(){return qn?createLineDragHandles():Ge}function createLineDragHandles(){var Ne=10,tt=Math.max(Qe.line.width,Ne),rt=it.append("g").attr("data-index",at);rt.append("path").attr("d",Ge.attr("d")).style({cursor:"move","stroke-width":tt,"stroke-opacity":"0"});var nt={"fill-opacity":"0"},ot=Math.max(tt/2,Ne);return rt.append("circle").attr({"data-line-point":"start-point",cx:Vn?ma(Qe.xanchor)+Qe.x0:ma(Qe.x0),cy:Hn?_a(Qe.yanchor)-Qe.y0:_a(Qe.y0),r:ot}).style(nt).classed("cursor-grab",!0),rt.append("circle").attr({"data-line-point":"end-point",cx:Vn?ma(Qe.xanchor)+Qe.x1:ma(Qe.x1),cy:Hn?_a(Qe.yanchor)-Qe.y1:_a(Qe.y1),r:ot}).style(nt).classed("cursor-grab",!0),rt}function updateDragMode(Qe){if(shouldSkipEdits(Ne))In=null;else if(qn)In="path"===Qe.target.tagName?"move":"start-point"===Qe.target.attributes["data-line-point"].value?"resize-over-start-point":"resize-over-end-point";else{var tt=ti.element.getBoundingClientRect(),rt=tt.right-tt.left,nt=tt.bottom-tt.top,at=Qe.clientX-tt.left,it=Qe.clientY-tt.top,ot=!Yn&&rt>zn&&nt>Bn&&!Qe.shiftKey?Ot.getCursor(at/rt,1-it/nt):"move";Rt(Ge,ot),In=ot.split("-")[0]}}function startDrag(tt){shouldSkipEdits(Ne)||(Vn&&(xr=ma(Qe.xanchor)),Hn&&(br=_a(Qe.yanchor)),"path"===Qe.type?Dn=Qe.path:(dt=Vn?Qe.x0:ma(Qe.x0),Dt=Hn?Qe.y0:_a(Qe.y0),dr=Vn?Qe.x1:ma(Qe.x1),mr=Hn?Qe.y1:_a(Qe.y1)),dt<dr?(mn=dt,En="x0",xn=dr,Pn="x1"):(mn=dr,En="x1",xn=dt,Pn="x0"),!Hn&&Dt<mr||Hn&&Dt>mr?(Ar=Dt,kn="y0",en=mr,Cn="y1"):(Ar=mr,kn="y1",en=Dt,Cn="y0"),updateDragMode(tt),renderVisualCues(it,Qe),deactivateClipPathTemporarily(Ge,Qe,Ne),ti.moveFn="move"===In?moveShape:resizeShape,ti.altKey=tt.altKey)}function endDrag(){shouldSkipEdits(Ne)||(Rt(Ge),removeVisualCues(it),setClipPath(Ge,Ne,Qe),tt.call("_guiRelayout",Ne,ot.getUpdateObj()))}function abortDrag(){shouldSkipEdits(Ne)||removeVisualCues(it)}function moveShape(tt,rt){if("path"===Qe.type){var noOp=function(Ne){return Ne},nt=noOp,at=noOp;Vn?$n("xanchor",Qe.xanchor=Va(xr+tt)):(nt=function(Ne){return Va(ma(Ne)+tt)},ra&&"date"===ra.type&&(nt=er.encodeDate(nt))),Hn?$n("yanchor",Qe.yanchor=Wa(br+rt)):(at=function(Ne){return Wa(_a(Ne)+rt)},pa&&"date"===pa.type&&(at=er.encodeDate(at))),$n("path",Qe.path=movePath(Dn,nt,at))}else Vn?$n("xanchor",Qe.xanchor=Va(xr+tt)):($n("x0",Qe.x0=Va(dt+tt)),$n("x1",Qe.x1=Va(dr+tt))),Hn?$n("yanchor",Qe.yanchor=Wa(br+rt)):($n("y0",Qe.y0=Wa(Dt+rt)),$n("y1",Qe.y1=Wa(mr+rt)));Ge.attr("d",getPathString(Ne,Qe)),renderVisualCues(it,Qe)}function resizeShape(tt,rt){if(Yn){var noOp=function(Ne){return Ne},nt=noOp,at=noOp;Vn?$n("xanchor",Qe.xanchor=Va(xr+tt)):(nt=function(Ne){return Va(ma(Ne)+tt)},ra&&"date"===ra.type&&(nt=er.encodeDate(nt))),Hn?$n("yanchor",Qe.yanchor=Wa(br+rt)):(at=function(Ne){return Wa(_a(Ne)+rt)},pa&&"date"===pa.type&&(at=er.encodeDate(at))),$n("path",Qe.path=movePath(Dn,nt,at))}else if(qn){if("resize-over-start-point"===In){var ot=dt+tt,ht=Hn?Dt-rt:Dt+rt;$n("x0",Qe.x0=Vn?ot:Va(ot)),$n("y0",Qe.y0=Hn?ht:Wa(ht))}else if("resize-over-end-point"===In){var Ot=dr+tt,Rt=Hn?mr-rt:mr+rt;$n("x1",Qe.x1=Vn?Ot:Va(Ot)),$n("y1",Qe.y1=Hn?Rt:Wa(Rt))}}else{var has=function(Ne){return-1!==In.indexOf(Ne)},Zt=has("n"),oa=has("s"),ga=has("w"),Qa=has("e"),ti=Zt?Ar+rt:Ar,ni=oa?en+rt:en,di=ga?mn+tt:mn,ji=Qa?xn+tt:xn;Hn&&(Zt&&(ti=Ar-rt),oa&&(ni=en-rt)),(!Hn&&ni-ti>Bn||Hn&&ti-ni>Bn)&&($n(kn,Qe[kn]=Hn?ti:Wa(ti)),$n(Cn,Qe[Cn]=Hn?ni:Wa(ni))),ji-di>zn&&($n(En,Qe[En]=Vn?di:Va(di)),$n(Pn,Qe[Pn]=Vn?ji:Va(ji)))}Ge.attr("d",getPathString(Ne,Qe)),renderVisualCues(it,Qe)}function renderVisualCues(Ne,Ge){function renderAnchor(){var Qe="path"!==Ge.type,tt=Ne.selectAll(".visual-cue").data([0]),nt=1;tt.enter().append("path").attr({fill:"#fff","fill-rule":"evenodd",stroke:"#000","stroke-width":nt}).classed("visual-cue",!0);var at=ma(Vn?Ge.xanchor:rt.midRange(Qe?[Ge.x0,Ge.x1]:er.extractPathCoords(Ge.path,Zt.paramIsX))),it=_a(Hn?Ge.yanchor:rt.midRange(Qe?[Ge.y0,Ge.y1]:er.extractPathCoords(Ge.path,Zt.paramIsY)));if(at=er.roundPositionForSharpStrokeRendering(at,nt),it=er.roundPositionForSharpStrokeRendering(it,nt),Vn&&Hn){var ot="M"+(at-1-nt)+","+(it-1-nt)+"h-8v2h8 v8h2v-8 h8v-2h-8 v-8h-2 Z";tt.attr("d",ot)}else if(Vn){var dt="M"+(at-1-nt)+","+(it-9-nt)+"v18 h2 v-18 Z";tt.attr("d",dt)}else{var ht="M"+(at-9-nt)+","+(it-1-nt)+"h18 v2 h-18 Z";tt.attr("d",ht)}}(Vn||Hn)&&renderAnchor()}function removeVisualCues(Ne){Ne.selectAll(".visual-cue").remove()}function deactivateClipPathTemporarily(Ne,Ge,Qe){var tt=Ge.xref,rt=Ge.yref,at=nt.getFromId(Qe,tt),it=nt.getFromId(Qe,rt),ot="";"paper"===tt||at.autorange||(ot+=tt),"paper"===rt||it.autorange||(ot+=rt),ht.setClipUrl(Ne,ot?"clip"+Qe._fullLayout._uid+ot:null,Qe)}Ot.init(ti),Qa.node().onmousemove=updateDragMode}function getPathString(Ne,Ge){var Qe,tt,rt,at,it,ot,dt,ht,Dt=Ge.type,Ot=nt.getRefType(Ge.xref),Rt=nt.getRefType(Ge.yref),Zt=nt.getFromId(Ne,Ge.xref),dr=nt.getFromId(Ne,Ge.yref),mr=Ne._fullLayout._size;if(Zt?"domain"===Ot?tt=function(Ne){return Zt._offset+Zt._length*Ne}:(Qe=er.shapePositionToRange(Zt),tt=function(Ne){return Zt._offset+Zt.r2p(Qe(Ne,!0))}):tt=function(Ne){return mr.l+mr.w*Ne},dr?"domain"===Rt?at=function(Ne){return dr._offset+dr._length*(1-Ne)}:(rt=er.shapePositionToRange(dr),at=function(Ne){return dr._offset+dr.r2p(rt(Ne,!0))}):at=function(Ne){return mr.t+mr.h*(1-Ne)},"path"===Dt)return Zt&&"date"===Zt.type&&(tt=er.decodeDate(tt)),dr&&"date"===dr.type&&(at=er.decodeDate(at)),convertPath(Ge,tt,at);if("pixel"===Ge.xsizemode){var xr=tt(Ge.xanchor);it=xr+Ge.x0,ot=xr+Ge.x1}else it=tt(Ge.x0),ot=tt(Ge.x1);if("pixel"===Ge.ysizemode){var br=at(Ge.yanchor);dt=br-Ge.y0,ht=br-Ge.y1}else dt=at(Ge.y0),ht=at(Ge.y1);if("line"===Dt)return"M"+it+","+dt+"L"+ot+","+ht;if("rect"===Dt)return"M"+it+","+dt+"H"+ot+"V"+ht+"H"+it+"Z";var Ar=(it+ot)/2,en=(dt+ht)/2,mn=Math.abs(Ar-it),xn=Math.abs(en-dt),kn="A"+mn+","+xn,Cn=Ar+mn+","+en;return"M"+Cn+kn+" 0 1,1 "+Ar+","+(en-xn)+kn+" 0 0,1 "+Cn+"Z"}function convertPath(Ne,Ge,Qe){var tt=Ne.path,nt=Ne.xsizemode,at=Ne.ysizemode,it=Ne.xanchor,ot=Ne.yanchor;return tt.replace(Zt.segmentRE,(function(Ne){var tt=0,dt=Ne.charAt(0),ht=Zt.paramIsX[dt],Dt=Zt.paramIsY[dt],Ot=Zt.numParams[dt],Rt=Ne.substr(1).replace(Zt.paramRE,(function(Ne){return ht[tt]?Ne="pixel"===nt?Ge(it)+Number(Ne):Ge(Ne):Dt[tt]&&(Ne="pixel"===at?Qe(ot)-Number(Ne):Qe(Ne)),++tt>Ot&&(Ne="X"),Ne}));return tt>Ot&&(Rt=Rt.replace(/[\s,]*X.*/,""),rt.log("Ignoring extra params in segment "+Ne)),dt+Rt}))}function movePath(Ne,Ge,Qe){return Ne.replace(Zt.segmentRE,(function(Ne){var tt=0,rt=Ne.charAt(0),nt=Zt.paramIsX[rt],at=Zt.paramIsY[rt],it=Zt.numParams[rt];return rt+Ne.substr(1).replace(Zt.paramRE,(function(Ne){return tt>=it||(nt[tt]?Ne=Ge(Ne):at[tt]&&(Ne=Qe(Ne)),tt++),Ne}))}))}function activateShape(Ne,Ge){if(couldHaveActiveShape(Ne)){var Qe=+Ge.node().getAttribute("data-index");if(Qe>=0){if(Qe===Ne._fullLayout._activeShapeIndex)return void deactivateShape(Ne);Ne._fullLayout._activeShapeIndex=Qe,Ne._fullLayout._deactivateShape=deactivateShape,draw(Ne)}}}function deactivateShape(Ne){couldHaveActiveShape(Ne)&&Ne._fullLayout._activeShapeIndex>=0&&(ot(Ne),delete Ne._fullLayout._activeShapeIndex,draw(Ne))}function eraseActiveShape(Ne){if(couldHaveActiveShape(Ne)){ot(Ne);var Ge=Ne._fullLayout._activeShapeIndex,Qe=(Ne.layout||{}).shapes||[];if(Ge<Qe.length){for(var rt=[],nt=0;nt<Qe.length;nt++)nt!==Ge&&rt.push(Qe[nt]);delete Ne._fullLayout._activeShapeIndex,tt.call("_guiRelayout",Ne,{shapes:rt})}}}Ge.exports={draw:draw,drawOne:drawOne,eraseActiveShape:eraseActiveShape}},{"../../lib":778,"../../lib/setcursor":799,"../../plot_api/plot_template":817,"../../plots/cartesian/axes":828,"../../plots/cartesian/handle_outline":838,"../../registry":911,"../color":643,"../dragelement":662,"../drawing":665,"./constants":722,"./draw_newshape/display_outlines":728,"./draw_newshape/helpers":729,"./helpers":731}],725:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../drawing/attributes").dash,rt=Ne("../../../lib/extend").extendFlat;Ge.exports={newshape:{line:{color:{valType:"color",editType:"none"},width:{valType:"number",min:0,dflt:4,editType:"none"},dash:rt({},tt,{dflt:"solid",editType:"none"}),editType:"none"},fillcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"none"},fillrule:{valType:"enumerated",values:["evenodd","nonzero"],dflt:"evenodd",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"none"},layer:{valType:"enumerated",values:["below","above"],dflt:"above",editType:"none"},drawdirection:{valType:"enumerated",values:["ortho","horizontal","vertical","diagonal"],dflt:"diagonal",editType:"none"},editType:"none"},activeshape:{fillcolor:{valType:"color",dflt:"rgb(255,0,255)",editType:"none"},opacity:{valType:"number",min:0,max:1,dflt:.5,editType:"none"},editType:"none"}}},{"../../../lib/extend":768,"../../drawing/attributes":664}],726:[function(Ne,Ge,Qe){"use strict";var tt=32;Ge.exports={CIRCLE_SIDES:tt,i000:0,i090:tt/4,i180:tt/2,i270:tt/4*3,cos45:Math.cos(Math.PI/4),sin45:Math.sin(Math.PI/4),SQRT2:Math.sqrt(2)}},{}],727:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../color");Ge.exports=function(Ne,Ge,Qe){if(Qe("newshape.drawdirection"),Qe("newshape.layer"),Qe("newshape.fillcolor"),Qe("newshape.fillrule"),Qe("newshape.opacity"),Qe("newshape.line.width")){var rt=(Ne||{}).plot_bgcolor||"#FFF";Qe("newshape.line.color",tt.contrast(rt)),Qe("newshape.line.dash")}Qe("activeshape.fillcolor"),Qe("activeshape.opacity")}},{"../../color":643}],728:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../dragelement"),rt=Ne("../../dragelement/helpers").drawMode,nt=Ne("../../../registry"),at=Ne("./constants"),it=at.i000,ot=at.i090,dt=at.i180,ht=at.i270,Dt=Ne("../../../plots/cartesian/handle_outline").clearOutlineControllers,Ot=Ne("./helpers"),Rt=Ot.pointsShapeRectangle,Zt=Ot.pointsShapeEllipse,er=Ot.writePaths,dr=Ne("./newshapes");function recordPositions(Ne,Ge){for(var Qe=0;Qe<Ge.length;Qe++){var tt=Ge[Qe];Ne[Qe]=[];for(var rt=0;rt<tt.length;rt++){Ne[Qe][rt]=[];for(var nt=0;nt<tt[rt].length;nt++)Ne[Qe][rt][nt]=tt[rt][nt]}}return Ne}Ge.exports=function displayOutlines(Ne,Ge,Qe,at){at||(at=0);var Ot=Qe.gd;function redraw(){displayOutlines(Ne,Ge,Qe,at++),Zt(Ne[0])&&update({redrawing:!0})}function update(Ne){Qe.isActiveShape=!1;var tt=dr(Ge,Qe);Object.keys(tt).length&&nt.call((Ne||{}).redrawing?"relayout":"_guiRelayout",Ot,tt)}var mr,xr,br,Ar,en,mn=Qe.isActiveShape,xn=Ot._fullLayout._zoomlayer,kn=Qe.dragmode;function startDragVertex(Ne){br=+Ne.srcElement.getAttribute("data-i"),Ar=+Ne.srcElement.getAttribute("data-j"),mr[br][Ar].moveFn=moveVertexController}function moveVertexController(Ge,Qe){if(Ne.length){var tt=en[br][Ar][1],rt=en[br][Ar][2],nt=Ne[br],at=nt.length;if(Rt(nt)){for(var it=0;it<at;it++)if(it!==Ar){var ot=nt[it];ot[1]===nt[Ar][1]&&(ot[1]=tt+Ge),ot[2]===nt[Ar][2]&&(ot[2]=rt+Qe)}if(nt[Ar][1]=tt+Ge,nt[Ar][2]=rt+Qe,!Rt(nt))for(var dt=0;dt<at;dt++)for(var ht=0;ht<nt[dt].length;ht++)nt[dt][ht]=en[br][dt][ht]}else nt[Ar][1]=tt+Ge,nt[Ar][2]=rt+Qe;redraw()}}function endDragVertexController(){update()}function removeVertex(){if(Ne.length&&Ne[br]&&Ne[br].length){for(var Ge=[],Qe=0;Qe<Ne[br].length;Qe++)Qe!==Ar&&Ge.push(Ne[br][Qe]);Ge.length>1&&(2!==Ge.length||"Z"!==Ge[1][0])&&(0===Ar&&(Ge[0][0]="M"),Ne[br]=Ge,redraw(),update())}}function clickVertexController(Ge,Qe){if(2===Ge){br=+Qe.srcElement.getAttribute("data-i"),Ar=+Qe.srcElement.getAttribute("data-j");var tt=Ne[br];Rt(tt)||Zt(tt)||removeVertex()}}function addVertexControllers(Ge){mr=[];for(var Qe=0;Qe<Ne.length;Qe++){var rt=Ne[Qe],nt=!Rt(rt)&&Zt(rt);mr[Qe]=[];for(var at=0;at<rt.length;at++)if("Z"!==rt[at][0]&&(!nt||at===it||at===ot||at===dt||at===ht)){var Dt=rt[at][1],er=rt[at][2],dr=Ge.append("circle").classed("cursor-grab",!0).attr("data-i",Qe).attr("data-j",at).attr("cx",Dt).attr("cy",er).attr("r",4).style({"mix-blend-mode":"luminosity",fill:"black",stroke:"white","stroke-width":1});mr[Qe][at]={element:dr.node(),gd:Ot,prepFn:startDragVertex,doneFn:endDragVertexController,clickFn:clickVertexController},tt.init(mr[Qe][at])}}}function moveShape(Ge,Qe){if(Ne.length)for(var tt=0;tt<Ne.length;tt++)for(var rt=0;rt<Ne[tt].length;rt++)for(var nt=0;nt+2<Ne[tt][rt].length;nt+=2)Ne[tt][rt][nt+1]=en[tt][rt][nt+1]+Ge,Ne[tt][rt][nt+2]=en[tt][rt][nt+2]+Qe}function moveShapeController(Ne,Ge){moveShape(Ne,Ge),redraw()}function startDragShapeController(Ne){(br=+Ne.srcElement.getAttribute("data-i"))||(br=0),xr[br].moveFn=moveShapeController}function endDragShapeController(){update()}function addShapeControllers(){if(xr=[],Ne.length){var Qe=0;xr[Qe]={element:Ge[0][0],gd:Ot,prepFn:startDragShapeController,doneFn:endDragShapeController},tt.init(xr[Qe])}}rt(kn)?Ot._fullLayout._drawing=!0:Ot._fullLayout._activeShapeIndex>=0&&Dt(Ot),Ge.attr("d",er(Ne)),mn&&!at&&(en=recordPositions([],Ne),addVertexControllers(xn.append("g").attr("class","outline-controllers")),addShapeControllers())}},{"../../../plots/cartesian/handle_outline":838,"../../../registry":911,"../../dragelement":662,"../../dragelement/helpers":661,"./constants":726,"./helpers":729,"./newshapes":730}],729:[function(Ne,Ge,Qe){"use strict";var tt=Ne("parse-svg-path"),rt=Ne("./constants"),nt=rt.CIRCLE_SIDES,at=rt.SQRT2,it=Ne("../../../plots/cartesian/helpers"),ot=it.p2r,dt=it.r2p,ht=[0,3,4,5,6,1,2],Dt=[0,3,4,1,2];function almostEq(Ne,Ge){return Math.abs(Ne-Ge)<=1e-6}function dist(Ne,Ge){var Qe=Ge[1]-Ne[1],tt=Ge[2]-Ne[2];return Math.sqrt(Qe*Qe+tt*tt)}Qe.writePaths=function(Ne){var Ge=Ne.length;if(!Ge)return"M0,0Z";for(var Qe="",tt=0;tt<Ge;tt++)for(var rt=Ne[tt].length,nt=0;nt<rt;nt++){var at=Ne[tt][nt][0];if("Z"===at)Qe+="Z";else for(var it=Ne[tt][nt].length,ot=0;ot<it;ot++){var dt=ot;"Q"===at||"S"===at?dt=Dt[ot]:"C"===at&&(dt=ht[ot]),Qe+=Ne[tt][nt][dt],ot>0&&ot<it-1&&(Qe+=",")}}return Qe},Qe.readPaths=function(Ne,Ge,Qe,rt){var at,it,ht,Dt=tt(Ne),Ot=[],Rt=-1,newPoly=function(){Rt++,Ot[Rt]=[]},Zt=0,er=0,recStart=function(){it=Zt,ht=er};recStart();for(var dr=0;dr<Dt.length;dr++){var mr,xr,br,Ar,en=[],mn=Dt[dr][0],xn=mn;switch(mn){case"M":newPoly(),Zt=+Dt[dr][1],er=+Dt[dr][2],en.push([xn,Zt,er]),recStart();break;case"Q":case"S":mr=+Dt[dr][1],br=+Dt[dr][2],Zt=+Dt[dr][3],er=+Dt[dr][4],en.push([xn,Zt,er,mr,br]);break;case"C":mr=+Dt[dr][1],br=+Dt[dr][2],xr=+Dt[dr][3],Ar=+Dt[dr][4],Zt=+Dt[dr][5],er=+Dt[dr][6],en.push([xn,Zt,er,mr,br,xr,Ar]);break;case"T":case"L":Zt=+Dt[dr][1],er=+Dt[dr][2],en.push([xn,Zt,er]);break;case"H":xn="L",Zt=+Dt[dr][1],en.push([xn,Zt,er]);break;case"V":xn="L",er=+Dt[dr][1],en.push([xn,Zt,er]);break;case"A":xn="L";var kn=+Dt[dr][1],Cn=+Dt[dr][2];+Dt[dr][4]||(kn=-kn,Cn=-Cn);var En=Zt-kn,Pn=er;for(at=1;at<=nt/2;at++){var Dn=2*Math.PI*at/nt;en.push([xn,En+kn*Math.cos(Dn),Pn+Cn*Math.sin(Dn)])}break;case"Z":Zt===it&&er===ht||(Zt=it,er=ht,en.push([xn,Zt,er]))}for(var In=(Qe||{}).domain,zn=Ge._fullLayout._size,Bn=Qe&&"pixel"===Qe.xsizemode,Vn=Qe&&"pixel"===Qe.ysizemode,Hn=!1===rt,qn=0;qn<en.length;qn++){for(at=0;at+2<7;at+=2){var Yn=en[qn][at+1],$n=en[qn][at+2];void 0!==Yn&&void 0!==$n&&(Zt=Yn,er=$n,Qe&&(Qe.xaxis&&Qe.xaxis.p2r?(Hn&&(Yn-=Qe.xaxis._offset),Yn=Bn?dt(Qe.xaxis,Qe.xanchor)+Yn:ot(Qe.xaxis,Yn)):(Hn&&(Yn-=zn.l),In?Yn=In.x[0]+Yn/zn.w:Yn/=zn.w),Qe.yaxis&&Qe.yaxis.p2r?(Hn&&($n-=Qe.yaxis._offset),$n=Vn?dt(Qe.yaxis,Qe.yanchor)-$n:ot(Qe.yaxis,$n)):(Hn&&($n-=zn.t),$n=In?In.y[1]-$n/zn.h:1-$n/zn.h)),en[qn][at+1]=Yn,en[qn][at+2]=$n)}Ot[Rt].push(en[qn].slice())}}return Ot},Qe.pointsShapeRectangle=function(Ne){if(5!==Ne.length)return!1;for(var Ge=1;Ge<3;Ge++){if(!almostEq(Ne[0][Ge]-Ne[1][Ge],Ne[3][Ge]-Ne[2][Ge]))return!1;if(!almostEq(Ne[0][Ge]-Ne[3][Ge],Ne[1][Ge]-Ne[2][Ge]))return!1}return!(!almostEq(Ne[0][1],Ne[1][1])&&!almostEq(Ne[0][1],Ne[3][1])||!(dist(Ne[0],Ne[1])*dist(Ne[0],Ne[3])))},Qe.pointsShapeEllipse=function(Ne){var Ge=Ne.length;if(Ge!==nt+1)return!1;Ge=nt;for(var Qe=0;Qe<Ge;Qe++){var tt=(2*Ge-Qe)%Ge,rt=(Ge/2+tt)%Ge,at=(Ge/2+Qe)%Ge;if(!almostEq(dist(Ne[Qe],Ne[at]),dist(Ne[tt],Ne[rt])))return!1}return!0},Qe.handleEllipse=function(Ne,Ge,tt){if(!Ne)return[Ge,tt];var rt=Qe.ellipseOver({x0:Ge[0],y0:Ge[1],x1:tt[0],y1:tt[1]}),it=(rt.x1+rt.x0)/2,ot=(rt.y1+rt.y0)/2,dt=(rt.x1-rt.x0)/2,ht=(rt.y1-rt.y0)/2;dt||(dt=ht/=at),ht||(ht=dt/=at);for(var Dt=[],Ot=0;Ot<nt;Ot++){var Rt=2*Ot*Math.PI/nt;Dt.push([it+dt*Math.cos(Rt),ot+ht*Math.sin(Rt)])}return Dt},Qe.ellipseOver=function(Ne){var Ge=Ne.x0,Qe=Ne.y0,tt=Ne.x1,rt=Ne.y1,nt=tt-Ge,it=rt-Qe,ot=((Ge-=nt)+tt)/2,dt=((Qe-=it)+rt)/2;return{x0:ot-(nt*=at),y0:dt-(it*=at),x1:ot+nt,y1:dt+it}}},{"../../../plots/cartesian/helpers":839,"./constants":726,"parse-svg-path":505}],730:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../dragelement/helpers"),rt=tt.drawMode,nt=tt.openMode,at=Ne("./constants"),it=at.i000,ot=at.i090,dt=at.i180,ht=at.i270,Dt=at.cos45,Ot=at.sin45,Rt=Ne("../../../plots/cartesian/helpers"),Zt=Rt.p2r,er=Rt.r2p,dr=Ne("../../../plots/cartesian/handle_outline").clearSelect,mr=Ne("./helpers"),xr=mr.readPaths,br=mr.writePaths,Ar=mr.ellipseOver;function fixDatesForPaths(Ne,Ge,Qe){var tt="date"===Ge.type,rt="date"===Qe.type;if(!tt&&!rt)return Ne;for(var nt=0;nt<Ne.length;nt++)for(var at=0;at<Ne[nt].length;at++)for(var it=0;it+2<Ne[nt][at].length;it+=2)tt&&(Ne[nt][at][it+1]=Ne[nt][at][it+1].replace(" ","_")),rt&&(Ne[nt][at][it+2]=Ne[nt][at][it+2].replace(" ","_"));return Ne}Ge.exports=function(Ne,Ge){if(Ne.length){var Qe=Ne[0][0];if(Qe){var tt=Qe.getAttribute("d"),at=Ge.gd,Rt=at._fullLayout.newshape,mr=Ge.plotinfo,en=mr.xaxis,mn=mr.yaxis,xn=!!mr.domain||!mr.xaxis,kn=!!mr.domain||!mr.yaxis,Cn=Ge.isActiveShape,En=Ge.dragmode,Pn=(at.layout||{}).shapes||[];if(!rt(En)&&void 0!==Cn){var Dn=at._fullLayout._activeShapeIndex;if(Dn<Pn.length)switch(at._fullLayout.shapes[Dn].type){case"rect":En="drawrect";break;case"circle":En="drawcircle";break;case"line":En="drawline";break;case"path":var In=Pn[Dn].path||"";En="Z"===In[In.length-1]?"drawclosedpath":"drawopenpath"}}var zn,Bn=nt(En),Vn=xr(tt,at,mr,Cn),Hn={editable:!0,xref:xn?"paper":en._id,yref:kn?"paper":mn._id,layer:Rt.layer,opacity:Rt.opacity,line:{color:Rt.line.color,width:Rt.line.width,dash:Rt.line.dash}};if(Bn||(Hn.fillcolor=Rt.fillcolor,Hn.fillrule=Rt.fillrule),1===Vn.length&&(zn=Vn[0]),zn&&"drawrect"===En)Hn.type="rect",Hn.x0=zn[0][1],Hn.y0=zn[0][2],Hn.x1=zn[2][1],Hn.y1=zn[2][2];else if(zn&&"drawline"===En)Hn.type="line",Hn.x0=zn[0][1],Hn.y0=zn[0][2],Hn.x1=zn[1][1],Hn.y1=zn[1][2];else if(zn&&"drawcircle"===En){Hn.type="circle";var qn=zn[it][1],Yn=zn[ot][1],$n=zn[dt][1],ra=zn[ht][1],oa=zn[it][2],pa=zn[ot][2],ga=zn[dt][2],ma=zn[ht][2],_a=mr.xaxis&&("date"===mr.xaxis.type||"log"===mr.xaxis.type),Va=mr.yaxis&&("date"===mr.yaxis.type||"log"===mr.yaxis.type);_a&&(qn=er(mr.xaxis,qn),Yn=er(mr.xaxis,Yn),$n=er(mr.xaxis,$n),ra=er(mr.xaxis,ra)),Va&&(oa=er(mr.yaxis,oa),pa=er(mr.yaxis,pa),ga=er(mr.yaxis,ga),ma=er(mr.yaxis,ma));var Wa=(Yn+ra)/2,Qa=(oa+ga)/2,ti=Ar({x0:Wa,y0:Qa,x1:Wa+(ra-Yn+$n-qn)/2*Dt,y1:Qa+(ma-pa+ga-oa)/2*Ot});_a&&(ti.x0=Zt(mr.xaxis,ti.x0),ti.x1=Zt(mr.xaxis,ti.x1)),Va&&(ti.y0=Zt(mr.yaxis,ti.y0),ti.y1=Zt(mr.yaxis,ti.y1)),Hn.x0=ti.x0,Hn.y0=ti.y0,Hn.x1=ti.x1,Hn.y1=ti.y1}else Hn.type="path",en&&mn&&fixDatesForPaths(Vn,en,mn),Hn.path=br(Vn),zn=null;dr(at);for(var ni=Ge.editHelpers,di=(ni||{}).modifyItem,ji=[],Hi=0;Hi<Pn.length;Hi++){var Yi=at._fullLayout.shapes[Hi];if(ji[Hi]=Yi._input,void 0!==Cn&&Hi===at._fullLayout._activeShapeIndex){var uo=Hn;switch(Yi.type){case"line":case"rect":case"circle":di("x0",uo.x0),di("x1",uo.x1),di("y0",uo.y0),di("y1",uo.y1);break;case"path":di("path",uo.path)}}}return void 0===Cn?(ji.push(Hn),ji):ni?ni.getUpdateObj():{}}}}},{"../../../plots/cartesian/handle_outline":838,"../../../plots/cartesian/helpers":839,"../../dragelement/helpers":661,"./constants":726,"./helpers":729}],731:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./constants"),rt=Ne("../../lib");Qe.rangeToShapePosition=function(Ne){return"log"===Ne.type?Ne.r2d:function(Ne){return Ne}},Qe.shapePositionToRange=function(Ne){return"log"===Ne.type?Ne.d2r:function(Ne){return Ne}},Qe.decodeDate=function(Ne){return function(Ge){return Ge.replace&&(Ge=Ge.replace("_"," ")),Ne(Ge)}},Qe.encodeDate=function(Ne){return function(Ge){return Ne(Ge).replace(" ","_")}},Qe.extractPathCoords=function(Ne,Ge){var Qe=[];return Ne.match(tt.segmentRE).forEach((function(Ne){var nt=Ge[Ne.charAt(0)].drawn;if(void 0!==nt){var at=Ne.substr(1).match(tt.paramRE);!at||at.length<nt||Qe.push(rt.cleanNumber(at[nt]))}})),Qe},Qe.getDataToPixel=function(Ne,Ge,tt,rt){var nt,at=Ne._fullLayout._size;if(Ge)if("domain"===rt)nt=function(Ne){return Ge._length*(tt?1-Ne:Ne)+Ge._offset};else{var it=Qe.shapePositionToRange(Ge);nt=function(Ne){return Ge._offset+Ge.r2p(it(Ne,!0))},"date"===Ge.type&&(nt=Qe.decodeDate(nt))}else nt=tt?function(Ne){return at.t+at.h*(1-Ne)}:function(Ne){return at.l+at.w*Ne};return nt},Qe.getPixelToData=function(Ne,Ge,tt,rt){var nt,at=Ne._fullLayout._size;if(Ge)if("domain"===rt)nt=function(Ne){var Qe=(Ne-Ge._offset)/Ge._length;return tt?1-Qe:Qe};else{var it=Qe.rangeToShapePosition(Ge);nt=function(Ne){return it(Ge.p2r(Ne-Ge._offset))}}else nt=tt?function(Ne){return 1-(Ne-at.t)/at.h}:function(Ne){return(Ne-at.l)/at.w};return nt},Qe.roundPositionForSharpStrokeRendering=function(Ne,Ge){var Qe=1===Math.round(Ge%2),tt=Math.round(Ne);return Qe?tt+.5:tt},Qe.makeOptionsAndPlotinfo=function(Ne,Ge){var Qe=Ne._fullLayout.shapes[Ge]||{},tt=Ne._fullLayout._plots[Qe.xref+Qe.yref];return tt?tt._hadPlotinfo=!0:(tt={},Qe.xref&&"paper"!==Qe.xref&&(tt.xaxis=Ne._fullLayout[Qe.xref+"axis"]),Qe.yref&&"paper"!==Qe.yref&&(tt.yaxis=Ne._fullLayout[Qe.yref+"axis"])),tt.xsizemode=Qe.xsizemode,tt.ysizemode=Qe.ysizemode,tt.xanchor=Qe.xanchor,tt.yanchor=Qe.yanchor,{options:Qe,plotinfo:tt}}},{"../../lib":778,"./constants":722}],732:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./draw");Ge.exports={moduleType:"component",name:"shapes",layoutAttributes:Ne("./attributes"),supplyLayoutDefaults:Ne("./defaults"),supplyDrawNewShapeDefaults:Ne("./draw_newshape/defaults"),includeBasePlot:Ne("../../plots/cartesian/include_components")("shapes"),calcAutorange:Ne("./calc_autorange"),draw:tt.draw,drawOne:tt.drawOne}},{"../../plots/cartesian/include_components":840,"./attributes":720,"./calc_autorange":721,"./defaults":723,"./draw":724,"./draw_newshape/defaults":727}],733:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/font_attributes"),rt=Ne("../../plots/pad_attributes"),nt=Ne("../../lib/extend").extendDeepAll,at=Ne("../../plot_api/edit_types").overrideAll,it=Ne("../../plots/animation_attributes"),ot=Ne("../../plot_api/plot_template").templatedArray,dt=Ne("./constants"),ht=ot("step",{visible:{valType:"boolean",dflt:!0},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string"},value:{valType:"string"},execute:{valType:"boolean",dflt:!0}});Ge.exports=at(ot("slider",{visible:{valType:"boolean",dflt:!0},active:{valType:"number",min:0,dflt:0},steps:ht,lenmode:{valType:"enumerated",values:["fraction","pixels"],dflt:"fraction"},len:{valType:"number",min:0,dflt:1},x:{valType:"number",min:-2,max:3,dflt:0},pad:nt(rt({editType:"arraydraw"}),{},{t:{dflt:20}}),xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"left"},y:{valType:"number",min:-2,max:3,dflt:0},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},transition:{duration:{valType:"number",min:0,dflt:150},easing:{valType:"enumerated",values:it.transition.easing.values,dflt:"cubic-in-out"}},currentvalue:{visible:{valType:"boolean",dflt:!0},xanchor:{valType:"enumerated",values:["left","center","right"],dflt:"left"},offset:{valType:"number",dflt:10},prefix:{valType:"string"},suffix:{valType:"string"},font:tt({})},font:tt({}),activebgcolor:{valType:"color",dflt:dt.gripBgActiveColor},bgcolor:{valType:"color",dflt:dt.railBgColor},bordercolor:{valType:"color",dflt:dt.railBorderColor},borderwidth:{valType:"number",min:0,dflt:dt.railBorderWidth},ticklen:{valType:"number",min:0,dflt:dt.tickLength},tickcolor:{valType:"color",dflt:dt.tickColor},tickwidth:{valType:"number",min:0,dflt:1},minorticklen:{valType:"number",min:0,dflt:dt.minorTickLength}}),"arraydraw","from-root")},{"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plot_api/plot_template":817,"../../plots/animation_attributes":822,"../../plots/font_attributes":856,"../../plots/pad_attributes":890,"./constants":734}],734:[function(Ne,Ge,Qe){"use strict";Ge.exports={name:"sliders",containerClassName:"slider-container",groupClassName:"slider-group",inputAreaClass:"slider-input-area",railRectClass:"slider-rail-rect",railTouchRectClass:"slider-rail-touch-rect",gripRectClass:"slider-grip-rect",tickRectClass:"slider-tick-rect",inputProxyClass:"slider-input-proxy",labelsClass:"slider-labels",labelGroupClass:"slider-label-group",labelClass:"slider-label",currentValueClass:"slider-current-value",railHeight:5,menuIndexAttrName:"slider-active-index",autoMarginIdRoot:"slider-",minWidth:30,minHeight:30,textPadX:40,arrowOffsetX:4,railRadius:2,railWidth:5,railBorder:4,railBorderWidth:1,railBorderColor:"#bec8d9",railBgColor:"#f8fafc",railInset:8,stepInset:10,gripRadius:10,gripWidth:20,gripHeight:20,gripBorder:20,gripBorderWidth:1,gripBorderColor:"#bec8d9",gripBgColor:"#f6f8fa",gripBgActiveColor:"#dbdde0",labelPadding:8,labelOffset:0,tickWidth:1,tickColor:"#333",tickOffset:25,tickLength:7,minorTickOffset:25,minorTickColor:"#333",minorTickLength:4,currentValuePadding:8,currentValueInset:0}},{}],735:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../plots/array_container_defaults"),nt=Ne("./attributes"),at=Ne("./constants").name,it=nt.steps;function sliderDefaults(Ne,Ge,Qe){function coerce(Qe,rt){return tt.coerce(Ne,Ge,nt,Qe,rt)}for(var at=rt(Ne,Ge,{name:"steps",handleItemDefaults:stepDefaults}),it=0,ot=0;ot<at.length;ot++)at[ot].visible&&it++;if(it<2?Ge.visible=!1:coerce("visible")){Ge._stepCount=it;var dt=Ge._visibleSteps=tt.filterVisible(at);(at[coerce("active")]||{}).visible||(Ge.active=dt[0]._index),coerce("x"),coerce("y"),tt.noneOrAll(Ne,Ge,["x","y"]),coerce("xanchor"),coerce("yanchor"),coerce("len"),coerce("lenmode"),coerce("pad.t"),coerce("pad.r"),coerce("pad.b"),coerce("pad.l"),tt.coerceFont(coerce,"font",Qe.font),coerce("currentvalue.visible")&&(coerce("currentvalue.xanchor"),coerce("currentvalue.prefix"),coerce("currentvalue.suffix"),coerce("currentvalue.offset"),tt.coerceFont(coerce,"currentvalue.font",Ge.font)),coerce("transition.duration"),coerce("transition.easing"),coerce("bgcolor"),coerce("activebgcolor"),coerce("bordercolor"),coerce("borderwidth"),coerce("ticklen"),coerce("tickwidth"),coerce("tickcolor"),coerce("minorticklen")}}function stepDefaults(Ne,Ge){function coerce(Qe,rt){return tt.coerce(Ne,Ge,it,Qe,rt)}if("skip"===Ne.method||Array.isArray(Ne.args)?coerce("visible"):Ge.visible=!1){coerce("method"),coerce("args");var Qe=coerce("label","step-"+Ge._index);coerce("value",Qe),coerce("execute")}}Ge.exports=function(Ne,Ge){rt(Ne,Ge,{name:at,handleItemDefaults:sliderDefaults})}},{"../../lib":778,"../../plots/array_container_defaults":823,"./attributes":733,"./constants":734}],736:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../plots/plots"),nt=Ne("../color"),at=Ne("../drawing"),it=Ne("../../lib"),ot=it.strTranslate,dt=Ne("../../lib/svg_text_utils"),ht=Ne("../../plot_api/plot_template").arrayEditor,Dt=Ne("./constants"),Ot=Ne("../../constants/alignment"),Rt=Ot.LINE_SPACING,Zt=Ot.FROM_TL,er=Ot.FROM_BR;function autoMarginId(Ne){return Dt.autoMarginIdRoot+Ne._index}function makeSliderData(Ne,Ge){for(var Qe=Ne[Dt.name],tt=[],rt=0;rt<Qe.length;rt++){var nt=Qe[rt];nt.visible&&(nt._gd=Ge,tt.push(nt))}return tt}function keyFunction(Ne){return Ne._index}function findDimensions(Ne,Ge){var Qe=at.tester.selectAll("g."+Dt.labelGroupClass).data(Ge._visibleSteps);Qe.enter().append("g").classed(Dt.labelGroupClass,!0);var nt=0,ot=0;Qe.each((function(Ne){var Qe=drawLabel(tt.select(this),{step:Ne},Ge).node();if(Qe){var rt=at.bBox(Qe);ot=Math.max(ot,rt.height),nt=Math.max(nt,rt.width)}})),Qe.remove();var ht=Ge._dims={};ht.inputAreaWidth=Math.max(Dt.railWidth,Dt.gripHeight);var Ot=Ne._fullLayout._size;ht.lx=Ot.l+Ot.w*Ge.x,ht.ly=Ot.t+Ot.h*(1-Ge.y),"fraction"===Ge.lenmode?ht.outerLength=Math.round(Ot.w*Ge.len):ht.outerLength=Ge.len,ht.inputAreaStart=0,ht.inputAreaLength=Math.round(ht.outerLength-Ge.pad.l-Ge.pad.r);var Rt=(ht.inputAreaLength-2*Dt.stepInset)/(Ge._stepCount-1),dr=nt+Dt.labelPadding;if(ht.labelStride=Math.max(1,Math.ceil(dr/Rt)),ht.labelHeight=ot,ht.currentValueMaxWidth=0,ht.currentValueHeight=0,ht.currentValueTotalHeight=0,ht.currentValueMaxLines=1,Ge.currentvalue.visible){var mr=at.tester.append("g");Qe.each((function(Ne){var Qe=drawCurrentValue(mr,Ge,Ne.label),tt=Qe.node()&&at.bBox(Qe.node())||{width:0,height:0},rt=dt.lineCount(Qe);ht.currentValueMaxWidth=Math.max(ht.currentValueMaxWidth,Math.ceil(tt.width)),ht.currentValueHeight=Math.max(ht.currentValueHeight,Math.ceil(tt.height)),ht.currentValueMaxLines=Math.max(ht.currentValueMaxLines,rt)})),ht.currentValueTotalHeight=ht.currentValueHeight+Ge.currentvalue.offset,mr.remove()}ht.height=ht.currentValueTotalHeight+Dt.tickOffset+Ge.ticklen+Dt.labelOffset+ht.labelHeight+Ge.pad.t+Ge.pad.b;var xr="left";it.isRightAnchor(Ge)&&(ht.lx-=ht.outerLength,xr="right"),it.isCenterAnchor(Ge)&&(ht.lx-=ht.outerLength/2,xr="center");var br="top";it.isBottomAnchor(Ge)&&(ht.ly-=ht.height,br="bottom"),it.isMiddleAnchor(Ge)&&(ht.ly-=ht.height/2,br="middle"),ht.outerLength=Math.ceil(ht.outerLength),ht.height=Math.ceil(ht.height),ht.lx=Math.round(ht.lx),ht.ly=Math.round(ht.ly);var Ar={y:Ge.y,b:ht.height*er[br],t:ht.height*Zt[br]};"fraction"===Ge.lenmode?(Ar.l=0,Ar.xl=Ge.x-Ge.len*Zt[xr],Ar.r=0,Ar.xr=Ge.x+Ge.len*er[xr]):(Ar.x=Ge.x,Ar.l=ht.outerLength*Zt[xr],Ar.r=ht.outerLength*er[xr]),rt.autoMargin(Ne,autoMarginId(Ge),Ar)}function drawSlider(Ne,Ge,Qe){(Qe.steps[Qe.active]||{}).visible||(Qe.active=Qe._visibleSteps[0]._index),Ge.call(drawCurrentValue,Qe).call(drawRail,Qe).call(drawLabelGroup,Qe).call(drawTicks,Qe).call(drawTouchRect,Ne,Qe).call(drawGrip,Ne,Qe);var tt=Qe._dims;at.setTranslate(Ge,tt.lx+Qe.pad.l,tt.ly+Qe.pad.t),Ge.call(setGripPosition,Qe,!1),Ge.call(drawCurrentValue,Qe)}function drawCurrentValue(Ne,Ge,Qe){if(Ge.currentvalue.visible){var tt,rt,nt=Ge._dims;switch(Ge.currentvalue.xanchor){case"right":tt=nt.inputAreaLength-Dt.currentValueInset-nt.currentValueMaxWidth,rt="left";break;case"center":tt=.5*nt.inputAreaLength,rt="middle";break;default:tt=Dt.currentValueInset,rt="left"}var ot=it.ensureSingle(Ne,"text",Dt.labelClass,(function(Ne){Ne.attr({"text-anchor":rt,"data-notex":1})})),ht=Ge.currentvalue.prefix?Ge.currentvalue.prefix:"";if("string"==typeof Qe)ht+=Qe;else{var Ot=Ge.steps[Ge.active].label,Zt=Ge._gd._fullLayout._meta;Zt&&(Ot=it.templateString(Ot,Zt)),ht+=Ot}Ge.currentvalue.suffix&&(ht+=Ge.currentvalue.suffix),ot.call(at.font,Ge.currentvalue.font).text(ht).call(dt.convertToTspans,Ge._gd);var er=dt.lineCount(ot),dr=(nt.currentValueMaxLines+1-er)*Ge.currentvalue.font.size*Rt;return dt.positionText(ot,tt,dr),ot}}function drawGrip(Ne,Ge,Qe){it.ensureSingle(Ne,"rect",Dt.gripRectClass,(function(tt){tt.call(attachGripEvents,Ge,Ne,Qe).style("pointer-events","all")})).attr({width:Dt.gripWidth,height:Dt.gripHeight,rx:Dt.gripRadius,ry:Dt.gripRadius}).call(nt.stroke,Qe.bordercolor).call(nt.fill,Qe.bgcolor).style("stroke-width",Qe.borderwidth+"px")}function drawLabel(Ne,Ge,Qe){var tt=it.ensureSingle(Ne,"text",Dt.labelClass,(function(Ne){Ne.attr({"text-anchor":"middle","data-notex":1})})),rt=Ge.step.label,nt=Qe._gd._fullLayout._meta;return nt&&(rt=it.templateString(rt,nt)),tt.call(at.font,Qe.font).text(rt).call(dt.convertToTspans,Qe._gd),tt}function drawLabelGroup(Ne,Ge){var Qe=it.ensureSingle(Ne,"g",Dt.labelsClass),rt=Ge._dims,nt=Qe.selectAll("g."+Dt.labelGroupClass).data(rt.labelSteps);nt.enter().append("g").classed(Dt.labelGroupClass,!0),nt.exit().remove(),nt.each((function(Ne){var Qe=tt.select(this);Qe.call(drawLabel,Ne,Ge),at.setTranslate(Qe,normalizedValueToPosition(Ge,Ne.fraction),Dt.tickOffset+Ge.ticklen+Ge.font.size*Rt+Dt.labelOffset+rt.currentValueTotalHeight)}))}function handleInput(Ne,Ge,Qe,tt,rt){var nt=Math.round(tt*(Qe._stepCount-1)),at=Qe._visibleSteps[nt]._index;at!==Qe.active&&setActive(Ne,Ge,Qe,at,!0,rt)}function setActive(Ne,Ge,Qe,tt,nt,at){var it=Qe.active;Qe.active=tt,ht(Ne.layout,Dt.name,Qe).applyUpdate("active",tt);var ot=Qe.steps[Qe.active];Ge.call(setGripPosition,Qe,at),Ge.call(drawCurrentValue,Qe),Ne.emit("plotly_sliderchange",{slider:Qe,step:Qe.steps[Qe.active],interaction:nt,previousActive:it}),ot&&ot.method&&nt&&(Ge._nextMethod?(Ge._nextMethod.step=ot,Ge._nextMethod.doCallback=nt,Ge._nextMethod.doTransition=at):(Ge._nextMethod={step:ot,doCallback:nt,doTransition:at},Ge._nextMethodRaf=window.requestAnimationFrame((function(){var Qe=Ge._nextMethod.step;Qe.method&&(Qe.execute&&rt.executeAPICommand(Ne,Qe.method,Qe.args),Ge._nextMethod=null,Ge._nextMethodRaf=null)}))))}function attachGripEvents(Ne,Ge,Qe){var rt=Qe.node(),at=tt.select(Ge);function getSliderOpts(){return Qe.data()[0]}Ne.on("mousedown",(function(){var Ne=getSliderOpts();Ge.emit("plotly_sliderstart",{slider:Ne});var it=Qe.select("."+Dt.gripRectClass);tt.event.stopPropagation(),tt.event.preventDefault(),it.call(nt.fill,Ne.activebgcolor);var ot=positionToNormalizedValue(Ne,tt.mouse(rt)[0]);handleInput(Ge,Qe,Ne,ot,!0),Ne._dragging=!0,at.on("mousemove",(function(){var Ne=getSliderOpts(),nt=positionToNormalizedValue(Ne,tt.mouse(rt)[0]);handleInput(Ge,Qe,Ne,nt,!1)})),at.on("mouseup",(function(){var Ne=getSliderOpts();Ne._dragging=!1,it.call(nt.fill,Ne.bgcolor),at.on("mouseup",null),at.on("mousemove",null),Ge.emit("plotly_sliderend",{slider:Ne,step:Ne.steps[Ne.active]})}))}))}function drawTicks(Ne,Ge){var Qe=Ne.selectAll("rect."+Dt.tickRectClass).data(Ge._visibleSteps),rt=Ge._dims;Qe.enter().append("rect").classed(Dt.tickRectClass,!0),Qe.exit().remove(),Qe.attr({width:Ge.tickwidth+"px","shape-rendering":"crispEdges"}),Qe.each((function(Ne,Qe){var it=Qe%rt.labelStride==0,ot=tt.select(this);ot.attr({height:it?Ge.ticklen:Ge.minorticklen}).call(nt.fill,Ge.tickcolor),at.setTranslate(ot,normalizedValueToPosition(Ge,Qe/(Ge._stepCount-1))-.5*Ge.tickwidth,(it?Dt.tickOffset:Dt.minorTickOffset)+rt.currentValueTotalHeight)}))}function computeLabelSteps(Ne){var Ge=Ne._dims;Ge.labelSteps=[];for(var Qe=Ne._stepCount,tt=0;tt<Qe;tt+=Ge.labelStride)Ge.labelSteps.push({fraction:tt/(Qe-1),step:Ne._visibleSteps[tt]})}function setGripPosition(Ne,Ge,Qe){for(var tt=Ne.select("rect."+Dt.gripRectClass),rt=0,nt=0;nt<Ge._stepCount;nt++)if(Ge._visibleSteps[nt]._index===Ge.active){rt=nt;break}var at=normalizedValueToPosition(Ge,rt/(Ge._stepCount-1));if(!Ge._invokingCommand){var it=tt;Qe&&Ge.transition.duration>0&&(it=it.transition().duration(Ge.transition.duration).ease(Ge.transition.easing)),it.attr("transform",ot(at-.5*Dt.gripWidth,Ge._dims.currentValueTotalHeight))}}function normalizedValueToPosition(Ne,Ge){var Qe=Ne._dims;return Qe.inputAreaStart+Dt.stepInset+(Qe.inputAreaLength-2*Dt.stepInset)*Math.min(1,Math.max(0,Ge))}function positionToNormalizedValue(Ne,Ge){var Qe=Ne._dims;return Math.min(1,Math.max(0,(Ge-Dt.stepInset-Qe.inputAreaStart)/(Qe.inputAreaLength-2*Dt.stepInset-2*Qe.inputAreaStart)))}function drawTouchRect(Ne,Ge,Qe){var tt=Qe._dims,rt=it.ensureSingle(Ne,"rect",Dt.railTouchRectClass,(function(tt){tt.call(attachGripEvents,Ge,Ne,Qe).style("pointer-events","all")}));rt.attr({width:tt.inputAreaLength,height:Math.max(tt.inputAreaWidth,Dt.tickOffset+Qe.ticklen+tt.labelHeight)}).call(nt.fill,Qe.bgcolor).attr("opacity",0),at.setTranslate(rt,0,tt.currentValueTotalHeight)}function drawRail(Ne,Ge){var Qe=Ge._dims,tt=Qe.inputAreaLength-2*Dt.railInset,rt=it.ensureSingle(Ne,"rect",Dt.railRectClass);rt.attr({width:tt,height:Dt.railWidth,rx:Dt.railRadius,ry:Dt.railRadius,"shape-rendering":"crispEdges"}).call(nt.stroke,Ge.bordercolor).call(nt.fill,Ge.bgcolor).style("stroke-width",Ge.borderwidth+"px"),at.setTranslate(rt,Dt.railInset,.5*(Qe.inputAreaWidth-Dt.railWidth)+Qe.currentValueTotalHeight)}Ge.exports=function(Ne){var Ge=Ne._fullLayout,Qe=makeSliderData(Ge,Ne),nt=Ge._infolayer.selectAll("g."+Dt.containerClassName).data(Qe.length>0?[0]:[]);function clearSlider(Ge){Ge._commandObserver&&(Ge._commandObserver.remove(),delete Ge._commandObserver),rt.autoMargin(Ne,autoMarginId(Ge))}if(nt.enter().append("g").classed(Dt.containerClassName,!0).style("cursor","ew-resize"),nt.exit().each((function(){tt.select(this).selectAll("g."+Dt.groupClassName).each(clearSlider)})).remove(),0!==Qe.length){var at=nt.selectAll("g."+Dt.groupClassName).data(Qe,keyFunction);at.enter().append("g").classed(Dt.groupClassName,!0),at.exit().each(clearSlider).remove();for(var it=0;it<Qe.length;it++){var ot=Qe[it];findDimensions(Ne,ot)}at.each((function(Ge){var Qe=tt.select(this);computeLabelSteps(Ge),rt.manageCommandObserver(Ne,Ge,Ge._visibleSteps,(function(Ge){var tt=Qe.data()[0];tt.active!==Ge.index&&(tt._dragging||setActive(Ne,Qe,tt,Ge.index,!1,!0))})),drawSlider(Ne,tt.select(this),Ge)}))}}},{"../../constants/alignment":745,"../../lib":778,"../../lib/svg_text_utils":803,"../../plot_api/plot_template":817,"../../plots/plots":891,"../color":643,"../drawing":665,"./constants":734,d3:169}],737:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./constants");Ge.exports={moduleType:"component",name:tt.name,layoutAttributes:Ne("./attributes"),supplyLayoutDefaults:Ne("./defaults"),draw:Ne("./draw")}},{"./attributes":733,"./constants":734,"./defaults":735,"./draw":736}],738:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("fast-isnumeric"),nt=Ne("../../plots/plots"),at=Ne("../../registry"),it=Ne("../../lib"),ot=it.strTranslate,dt=Ne("../drawing"),ht=Ne("../color"),Dt=Ne("../../lib/svg_text_utils"),Ot=Ne("../../constants/interactions"),Rt=Ne("../../constants/alignment").OPPOSITE_SIDE,Zt=/ [XY][0-9]* /;function draw(Ne,Ge,Qe){var er,dr=Qe.propContainer,mr=Qe.propName,xr=Qe.placeholder,br=Qe.traceIndex,Ar=Qe.avoid||{},en=Qe.attributes,mn=Qe.transform,xn=Qe.containerGroup,kn=Ne._fullLayout,Cn=1,En=!1,Pn=dr.title,Dn=(Pn&&Pn.text?Pn.text:"").trim(),In=Pn&&Pn.font?Pn.font:{},zn=In.family,Bn=In.size,Vn=In.color;"title.text"===mr?er="titleText":-1!==mr.indexOf("axis")?er="axisTitleText":mr.indexOf(!0)&&(er="colorbarTitleText");var Hn=Ne._context.edits[er];""===Dn?Cn=0:Dn.replace(Zt," % ")===xr.replace(Zt," % ")&&(Cn=.2,En=!0,Hn||(Dn="")),Qe._meta?Dn=it.templateString(Dn,Qe._meta):kn._meta&&(Dn=it.templateString(Dn,kn._meta));var qn=Dn||Hn;xn||(xn=it.ensureSingle(kn._infolayer,"g","g-"+Ge));var Yn=xn.selectAll("text").data(qn?[0]:[]);if(Yn.enter().append("text"),Yn.text(Dn).attr("class",Ge),Yn.exit().remove(),!qn)return xn;function titleLayout(Ne){it.syncOrAsync([drawTitle,scootTitle],Ne)}function drawTitle(Ge){var Qe;return mn?(Qe="",mn.rotate&&(Qe+="rotate("+[mn.rotate,en.x,en.y]+")"),mn.offset&&(Qe+=ot(0,mn.offset))):Qe=null,Ge.attr("transform",Qe),Ge.style({"font-family":zn,"font-size":tt.round(Bn,2)+"px",fill:ht.rgb(Vn),opacity:Cn*ht.opacity(Vn),"font-weight":nt.fontWeight}).attr(en).call(Dt.convertToTspans,Ne),nt.previousPromises(Ne)}function scootTitle(Ne){var Ge=tt.select(Ne.node().parentNode);if(Ar&&Ar.selection&&Ar.side&&Dn){Ge.attr("transform",null);var Qe=Rt[Ar.side],nt="left"===Ar.side||"top"===Ar.side?-1:1,at=rt(Ar.pad)?Ar.pad:2,ht=dt.bBox(Ge.node()),Dt={left:0,top:0,right:kn.width,bottom:kn.height},Ot=Ar.maxShift||nt*(Dt[Ar.side]-ht[Ar.side]),Zt=0;if(Ot<0)Zt=Ot;else{var er=Ar.offsetLeft||0,dr=Ar.offsetTop||0;ht.left-=er,ht.right-=er,ht.top-=dr,ht.bottom-=dr,Ar.selection.each((function(){var Ne=dt.bBox(this);it.bBoxIntersect(ht,Ne,at)&&(Zt=Math.max(Zt,nt*(Ne[Ar.side]-ht[Qe])+at))})),Zt=Math.min(Ot,Zt)}if(Zt>0||Ot<0){var mr={left:[-Zt,0],right:[Zt,0],top:[0,-Zt],bottom:[0,Zt]}[Ar.side];Ge.attr("transform",ot(mr[0],mr[1]))}}}function setPlaceholder(){Cn=0,En=!0,Yn.text(xr).on("mouseover.opacity",(function(){tt.select(this).transition().duration(Ot.SHOW_PLACEHOLDER).style("opacity",1)})).on("mouseout.opacity",(function(){tt.select(this).transition().duration(Ot.HIDE_PLACEHOLDER).style("opacity",0)}))}return Yn.call(titleLayout),Hn&&(Dn?Yn.on(".opacity",null):setPlaceholder(),Yn.call(Dt.makeEditable,{gd:Ne}).on("edit",(function(Ge){void 0!==br?at.call("_guiRestyle",Ne,mr,Ge,br):at.call("_guiRelayout",Ne,mr,Ge)})).on("cancel",(function(){this.text(this.attr("data-unformatted")).call(titleLayout)})).on("input",(function(Ne){this.text(Ne||" ").call(Dt.positionText,en.x,en.y)}))),Yn.classed("js-placeholder",En),xn}Ge.exports={draw:draw}},{"../../constants/alignment":745,"../../constants/interactions":752,"../../lib":778,"../../lib/svg_text_utils":803,"../../plots/plots":891,"../../registry":911,"../color":643,"../drawing":665,d3:169,"fast-isnumeric":241}],739:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/font_attributes"),rt=Ne("../color/attributes"),nt=Ne("../../lib/extend").extendFlat,at=Ne("../../plot_api/edit_types").overrideAll,it=Ne("../../plots/pad_attributes"),ot=Ne("../../plot_api/plot_template").templatedArray,dt=ot("button",{visible:{valType:"boolean"},method:{valType:"enumerated",values:["restyle","relayout","animate","update","skip"],dflt:"restyle"},args:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},args2:{valType:"info_array",freeLength:!0,items:[{valType:"any"},{valType:"any"},{valType:"any"}]},label:{valType:"string",dflt:""},execute:{valType:"boolean",dflt:!0}});Ge.exports=at(ot("updatemenu",{_arrayAttrRegexps:[/^updatemenus\[(0|[1-9][0-9]+)\]\.buttons/],visible:{valType:"boolean"},type:{valType:"enumerated",values:["dropdown","buttons"],dflt:"dropdown"},direction:{valType:"enumerated",values:["left","right","up","down"],dflt:"down"},active:{valType:"integer",min:-1,dflt:0},showactive:{valType:"boolean",dflt:!0},buttons:dt,x:{valType:"number",min:-2,max:3,dflt:-.05},xanchor:{valType:"enumerated",values:["auto","left","center","right"],dflt:"right"},y:{valType:"number",min:-2,max:3,dflt:1},yanchor:{valType:"enumerated",values:["auto","top","middle","bottom"],dflt:"top"},pad:nt(it({editType:"arraydraw"}),{}),font:tt({}),bgcolor:{valType:"color"},bordercolor:{valType:"color",dflt:rt.borderLine},borderwidth:{valType:"number",min:0,dflt:1,editType:"arraydraw"}}),"arraydraw","from-root")},{"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plot_api/plot_template":817,"../../plots/font_attributes":856,"../../plots/pad_attributes":890,"../color/attributes":642}],740:[function(Ne,Ge,Qe){"use strict";Ge.exports={name:"updatemenus",containerClassName:"updatemenu-container",headerGroupClassName:"updatemenu-header-group",headerClassName:"updatemenu-header",headerArrowClassName:"updatemenu-header-arrow",dropdownButtonGroupClassName:"updatemenu-dropdown-button-group",dropdownButtonClassName:"updatemenu-dropdown-button",buttonClassName:"updatemenu-button",itemRectClassName:"updatemenu-item-rect",itemTextClassName:"updatemenu-item-text",menuIndexAttrName:"updatemenu-active-index",autoMarginIdRoot:"updatemenu-",blankHeaderOpts:{label:"  "},minWidth:30,minHeight:30,textPadX:24,arrowPadX:16,rx:2,ry:2,textOffsetX:12,textOffsetY:3,arrowOffsetX:4,gapButtonHeader:5,gapButton:2,activeColor:"#F4FAFF",hoverColor:"#F4FAFF",arrowSymbol:{left:"â",right:"âº",up:"â²",down:"â¼"}}},{}],741:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../plots/array_container_defaults"),nt=Ne("./attributes"),at=Ne("./constants").name,it=nt.buttons;function menuDefaults(Ne,Ge,Qe){function coerce(Qe,rt){return tt.coerce(Ne,Ge,nt,Qe,rt)}coerce("visible",rt(Ne,Ge,{name:"buttons",handleItemDefaults:buttonDefaults}).length>0)&&(coerce("active"),coerce("direction"),coerce("type"),coerce("showactive"),coerce("x"),coerce("y"),tt.noneOrAll(Ne,Ge,["x","y"]),coerce("xanchor"),coerce("yanchor"),coerce("pad.t"),coerce("pad.r"),coerce("pad.b"),coerce("pad.l"),tt.coerceFont(coerce,"font",Qe.font),coerce("bgcolor",Qe.paper_bgcolor),coerce("bordercolor"),coerce("borderwidth"))}function buttonDefaults(Ne,Ge){function coerce(Qe,rt){return tt.coerce(Ne,Ge,it,Qe,rt)}coerce("visible","skip"===Ne.method||Array.isArray(Ne.args))&&(coerce("method"),coerce("args"),coerce("args2"),coerce("label"),coerce("execute"))}Ge.exports=function(Ne,Ge){rt(Ne,Ge,{name:at,handleItemDefaults:menuDefaults})}},{"../../lib":778,"../../plots/array_container_defaults":823,"./attributes":739,"./constants":740}],742:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../plots/plots"),nt=Ne("../color"),at=Ne("../drawing"),it=Ne("../../lib"),ot=Ne("../../lib/svg_text_utils"),dt=Ne("../../plot_api/plot_template").arrayEditor,ht=Ne("../../constants/alignment").LINE_SPACING,Dt=Ne("./constants"),Ot=Ne("./scrollbox");function keyFunction(Ne){return Ne._index}function isFolded(Ne){return-1==+Ne.attr(Dt.menuIndexAttrName)}function isActive(Ne,Ge){return+Ne.attr(Dt.menuIndexAttrName)===Ge._index}function setActive(Ne,Ge,Qe,tt,rt,nt,at,it){Ge.active=at,dt(Ne.layout,Dt.name,Ge).applyUpdate("active",at),"buttons"===Ge.type?drawButtons(Ne,tt,null,null,Ge):"dropdown"===Ge.type&&(rt.attr(Dt.menuIndexAttrName,"-1"),drawHeader(Ne,tt,rt,nt,Ge),it||drawButtons(Ne,tt,rt,nt,Ge))}function drawHeader(Ne,Ge,Qe,tt,rt){var nt=it.ensureSingle(Ge,"g",Dt.headerClassName,(function(Ne){Ne.style("pointer-events","all")})),ot=rt._dims,dt=rt.active,ht=rt.buttons[dt]||Dt.blankHeaderOpts,Ot={y:rt.pad.t,yPad:0,x:rt.pad.l,xPad:0,index:0},Rt={width:ot.headerWidth,height:ot.headerHeight};nt.call(drawItem,rt,ht,Ne).call(setItemPosition,rt,Ot,Rt),it.ensureSingle(Ge,"text",Dt.headerArrowClassName,(function(Ne){Ne.attr("text-anchor","end").call(at.font,rt.font).text(Dt.arrowSymbol[rt.direction])})).attr({x:ot.headerWidth-Dt.arrowOffsetX+rt.pad.l,y:ot.headerHeight/2+Dt.textOffsetY+rt.pad.t}),nt.on("click",(function(){Qe.call(removeAllButtons,String(isActive(Qe,rt)?-1:rt._index)),drawButtons(Ne,Ge,Qe,tt,rt)})),nt.on("mouseover",(function(){nt.call(styleOnMouseOver)})),nt.on("mouseout",(function(){nt.call(styleOnMouseOut,rt)})),at.setTranslate(Ge,ot.lx,ot.ly)}function drawButtons(Ne,Ge,Qe,nt,at){Qe||(Qe=Ge).attr("pointer-events","all");var ot=isFolded(Qe)&&"buttons"!==at.type?[]:at.buttons,dt="dropdown"===at.type?Dt.dropdownButtonClassName:Dt.buttonClassName,ht=Qe.selectAll("g."+dt).data(it.filterVisible(ot)),Ot=ht.enter().append("g").classed(dt,!0),Rt=ht.exit();"dropdown"===at.type?(Ot.attr("opacity","0").transition().attr("opacity","1"),Rt.transition().attr("opacity","0").remove()):Rt.remove();var Zt=0,er=0,dr=at._dims,mr=-1!==["up","down"].indexOf(at.direction);"dropdown"===at.type&&(mr?er=dr.headerHeight+Dt.gapButtonHeader:Zt=dr.headerWidth+Dt.gapButtonHeader),"dropdown"===at.type&&"up"===at.direction&&(er=-Dt.gapButtonHeader+Dt.gapButton-dr.openHeight),"dropdown"===at.type&&"left"===at.direction&&(Zt=-Dt.gapButtonHeader+Dt.gapButton-dr.openWidth);var xr={x:dr.lx+Zt+at.pad.l,y:dr.ly+er+at.pad.t,yPad:Dt.gapButton,xPad:Dt.gapButton,index:0},br={l:xr.x+at.borderwidth,t:xr.y+at.borderwidth};ht.each((function(it,ot){var dt=tt.select(this);dt.call(drawItem,at,it,Ne).call(setItemPosition,at,xr),dt.on("click",(function(){tt.event.defaultPrevented||(it.execute&&(it.args2&&at.active===ot?(setActive(Ne,at,it,Ge,Qe,nt,-1),rt.executeAPICommand(Ne,it.method,it.args2)):(setActive(Ne,at,it,Ge,Qe,nt,ot),rt.executeAPICommand(Ne,it.method,it.args))),Ne.emit("plotly_buttonclicked",{menu:at,button:it,active:at.active}))})),dt.on("mouseover",(function(){dt.call(styleOnMouseOver)})),dt.on("mouseout",(function(){dt.call(styleOnMouseOut,at),ht.call(styleButtons,at)}))})),ht.call(styleButtons,at),mr?(br.w=Math.max(dr.openWidth,dr.headerWidth),br.h=xr.y-br.t):(br.w=xr.x-br.l,br.h=Math.max(dr.openHeight,dr.headerHeight)),br.direction=at.direction,nt&&(ht.size()?drawScrollBox(Ne,Ge,Qe,nt,at,br):hideScrollBox(nt))}function drawScrollBox(Ne,Ge,Qe,tt,rt,nt){var at,it,ot,dt=rt.direction,ht="up"===dt||"down"===dt,Ot=rt._dims,Rt=rt.active;if(ht)for(it=0,ot=0;ot<Rt;ot++)it+=Ot.heights[ot]+Dt.gapButton;else for(at=0,ot=0;ot<Rt;ot++)at+=Ot.widths[ot]+Dt.gapButton;tt.enable(nt,at,it),tt.hbar&&tt.hbar.attr("opacity","0").transition().attr("opacity","1"),tt.vbar&&tt.vbar.attr("opacity","0").transition().attr("opacity","1")}function hideScrollBox(Ne){var Ge=!!Ne.hbar,Qe=!!Ne.vbar;Ge&&Ne.hbar.transition().attr("opacity","0").each("end",(function(){Ge=!1,Qe||Ne.disable()})),Qe&&Ne.vbar.transition().attr("opacity","0").each("end",(function(){Qe=!1,Ge||Ne.disable()}))}function drawItem(Ne,Ge,Qe,tt){Ne.call(drawItemRect,Ge).call(drawItemText,Ge,Qe,tt)}function drawItemRect(Ne,Ge){it.ensureSingle(Ne,"rect",Dt.itemRectClassName,(function(Ne){Ne.attr({rx:Dt.rx,ry:Dt.ry,"shape-rendering":"crispEdges"})})).call(nt.stroke,Ge.bordercolor).call(nt.fill,Ge.bgcolor).style("stroke-width",Ge.borderwidth+"px")}function drawItemText(Ne,Ge,Qe,tt){var rt=it.ensureSingle(Ne,"text",Dt.itemTextClassName,(function(Ne){Ne.attr({"text-anchor":"start","data-notex":1})})),nt=Qe.label,dt=tt._fullLayout._meta;dt&&(nt=it.templateString(nt,dt)),rt.call(at.font,Ge.font).text(nt).call(ot.convertToTspans,tt)}function styleButtons(Ne,Ge){var Qe=Ge.active;Ne.each((function(Ne,rt){var at=tt.select(this);rt===Qe&&Ge.showactive&&at.select("rect."+Dt.itemRectClassName).call(nt.fill,Dt.activeColor)}))}function styleOnMouseOver(Ne){Ne.select("rect."+Dt.itemRectClassName).call(nt.fill,Dt.hoverColor)}function styleOnMouseOut(Ne,Ge){Ne.select("rect."+Dt.itemRectClassName).call(nt.fill,Ge.bgcolor)}function findDimensions(Ne,Ge){var Qe=Ge._dims={width1:0,height1:0,heights:[],widths:[],totalWidth:0,totalHeight:0,openWidth:0,openHeight:0,lx:0,ly:0},nt=at.tester.selectAll("g."+Dt.dropdownButtonClassName).data(it.filterVisible(Ge.buttons));nt.enter().append("g").classed(Dt.dropdownButtonClassName,!0);var dt=-1!==["up","down"].indexOf(Ge.direction);nt.each((function(rt,nt){var it=tt.select(this);it.call(drawItem,Ge,rt,Ne);var Ot=it.select("."+Dt.itemTextClassName),Rt=Ot.node()&&at.bBox(Ot.node()).width,Zt=Math.max(Rt+Dt.textPadX,Dt.minWidth),er=Ge.font.size*ht,dr=ot.lineCount(Ot),mr=Math.max(er*dr,Dt.minHeight)+Dt.textOffsetY;mr=Math.ceil(mr),Zt=Math.ceil(Zt),Qe.widths[nt]=Zt,Qe.heights[nt]=mr,Qe.height1=Math.max(Qe.height1,mr),Qe.width1=Math.max(Qe.width1,Zt),dt?(Qe.totalWidth=Math.max(Qe.totalWidth,Zt),Qe.openWidth=Qe.totalWidth,Qe.totalHeight+=mr+Dt.gapButton,Qe.openHeight+=mr+Dt.gapButton):(Qe.totalWidth+=Zt+Dt.gapButton,Qe.openWidth+=Zt+Dt.gapButton,Qe.totalHeight=Math.max(Qe.totalHeight,mr),Qe.openHeight=Qe.totalHeight)})),dt?Qe.totalHeight-=Dt.gapButton:Qe.totalWidth-=Dt.gapButton,Qe.headerWidth=Qe.width1+Dt.arrowPadX,Qe.headerHeight=Qe.height1,"dropdown"===Ge.type&&(dt?(Qe.width1+=Dt.arrowPadX,Qe.totalHeight=Qe.height1):Qe.totalWidth=Qe.width1,Qe.totalWidth+=Dt.arrowPadX),nt.remove();var Ot=Qe.totalWidth+Ge.pad.l+Ge.pad.r,Rt=Qe.totalHeight+Ge.pad.t+Ge.pad.b,Zt=Ne._fullLayout._size;Qe.lx=Zt.l+Zt.w*Ge.x,Qe.ly=Zt.t+Zt.h*(1-Ge.y);var er="left";it.isRightAnchor(Ge)&&(Qe.lx-=Ot,er="right"),it.isCenterAnchor(Ge)&&(Qe.lx-=Ot/2,er="center");var dr="top";it.isBottomAnchor(Ge)&&(Qe.ly-=Rt,dr="bottom"),it.isMiddleAnchor(Ge)&&(Qe.ly-=Rt/2,dr="middle"),Qe.totalWidth=Math.ceil(Qe.totalWidth),Qe.totalHeight=Math.ceil(Qe.totalHeight),Qe.lx=Math.round(Qe.lx),Qe.ly=Math.round(Qe.ly),rt.autoMargin(Ne,autoMarginId(Ge),{x:Ge.x,y:Ge.y,l:Ot*({right:1,center:.5}[er]||0),r:Ot*({left:1,center:.5}[er]||0),b:Rt*({top:1,middle:.5}[dr]||0),t:Rt*({bottom:1,middle:.5}[dr]||0)})}function autoMarginId(Ne){return Dt.autoMarginIdRoot+Ne._index}function setItemPosition(Ne,Ge,Qe,tt){tt=tt||{};var rt=Ne.select("."+Dt.itemRectClassName),nt=Ne.select("."+Dt.itemTextClassName),it=Ge.borderwidth,dt=Qe.index,Ot=Ge._dims;at.setTranslate(Ne,it+Qe.x,it+Qe.y);var Rt=-1!==["up","down"].indexOf(Ge.direction),Zt=tt.height||(Rt?Ot.heights[dt]:Ot.height1);rt.attr({x:0,y:0,width:tt.width||(Rt?Ot.width1:Ot.widths[dt]),height:Zt});var er=Ge.font.size*ht,dr=(ot.lineCount(nt)-1)*er/2;ot.positionText(nt,Dt.textOffsetX,Zt/2-dr+Dt.textOffsetY),Rt?Qe.y+=Ot.heights[dt]+Qe.yPad:Qe.x+=Ot.widths[dt]+Qe.xPad,Qe.index++}function removeAllButtons(Ne,Ge){Ne.attr(Dt.menuIndexAttrName,Ge||"-1").selectAll("g."+Dt.dropdownButtonClassName).remove()}Ge.exports=function(Ne){var Ge=Ne._fullLayout,Qe=it.filterVisible(Ge[Dt.name]);function clearAutoMargin(Ge){rt.autoMargin(Ne,autoMarginId(Ge))}var nt=Ge._menulayer.selectAll("g."+Dt.containerClassName).data(Qe.length>0?[0]:[]);if(nt.enter().append("g").classed(Dt.containerClassName,!0).style("cursor","pointer"),nt.exit().each((function(){tt.select(this).selectAll("g."+Dt.headerGroupClassName).each(clearAutoMargin)})).remove(),0!==Qe.length){var at=nt.selectAll("g."+Dt.headerGroupClassName).data(Qe,keyFunction);at.enter().append("g").classed(Dt.headerGroupClassName,!0);for(var ot=it.ensureSingle(nt,"g",Dt.dropdownButtonGroupClassName,(function(Ne){Ne.style("pointer-events","all")})),dt=0;dt<Qe.length;dt++){var ht=Qe[dt];findDimensions(Ne,ht)}var Rt="updatemenus"+Ge._uid,Zt=new Ot(Ne,ot,Rt);at.enter().size()&&(ot.node().parentNode.appendChild(ot.node()),ot.call(removeAllButtons)),at.exit().each((function(Ne){ot.call(removeAllButtons),clearAutoMargin(Ne)})).remove(),at.each((function(Ge){var Qe=tt.select(this),nt="dropdown"===Ge.type?ot:null;rt.manageCommandObserver(Ne,Ge,Ge.buttons,(function(tt){setActive(Ne,Ge,Ge.buttons[tt.index],Qe,nt,Zt,tt.index,!0)})),"dropdown"===Ge.type?(drawHeader(Ne,Qe,ot,Zt,Ge),isActive(ot,Ge)&&drawButtons(Ne,Qe,ot,Zt,Ge)):drawButtons(Ne,Qe,null,null,Ge)}))}}},{"../../constants/alignment":745,"../../lib":778,"../../lib/svg_text_utils":803,"../../plot_api/plot_template":817,"../../plots/plots":891,"../color":643,"../drawing":665,"./constants":740,"./scrollbox":744,d3:169}],743:[function(Ne,Ge,Qe){arguments[4][737][0].apply(Qe,arguments)},{"./attributes":739,"./constants":740,"./defaults":741,"./draw":742,dup:737}],744:[function(Ne,Ge,Qe){"use strict";Ge.exports=ScrollBox;var tt=Ne("d3"),rt=Ne("../color"),nt=Ne("../drawing"),at=Ne("../../lib");function ScrollBox(Ne,Ge,Qe){this.gd=Ne,this.container=Ge,this.id=Qe,this.position=null,this.translateX=null,this.translateY=null,this.hbar=null,this.vbar=null,this.bg=this.container.selectAll("rect.scrollbox-bg").data([0]),this.bg.exit().on(".drag",null).on("wheel",null).remove(),this.bg.enter().append("rect").classed("scrollbox-bg",!0).style("pointer-events","all").attr({opacity:0,x:0,y:0,width:0,height:0})}ScrollBox.barWidth=2,ScrollBox.barLength=20,ScrollBox.barRadius=2,ScrollBox.barPad=1,ScrollBox.barColor="#808BA4",ScrollBox.prototype.enable=function(Ne,Ge,Qe){var at=this.gd._fullLayout,it=at.width,ot=at.height;this.position=Ne;var dt,ht,Dt,Ot,Rt=this.position.l,Zt=this.position.w,er=this.position.t,dr=this.position.h,mr=this.position.direction,xr="down"===mr,br="left"===mr,Ar="up"===mr,en=Zt,mn=dr;xr||br||"right"===mr||Ar||(this.position.direction="down",xr=!0),xr||Ar?(ht=(dt=Rt)+en,xr?(Dt=er,mn=(Ot=Math.min(Dt+mn,ot))-Dt):mn=(Ot=er+mn)-(Dt=Math.max(Ot-mn,0))):(Ot=(Dt=er)+mn,br?en=(ht=Rt+en)-(dt=Math.max(ht-en,0)):(dt=Rt,en=(ht=Math.min(dt+en,it))-dt)),this._box={l:dt,t:Dt,w:en,h:mn};var xn=Zt>en,kn=ScrollBox.barLength+2*ScrollBox.barPad,Cn=ScrollBox.barWidth+2*ScrollBox.barPad,En=Rt,Pn=er+dr;Pn+Cn>ot&&(Pn=ot-Cn);var Dn=this.container.selectAll("rect.scrollbar-horizontal").data(xn?[0]:[]);Dn.exit().on(".drag",null).remove(),Dn.enter().append("rect").classed("scrollbar-horizontal",!0).call(rt.fill,ScrollBox.barColor),xn?(this.hbar=Dn.attr({rx:ScrollBox.barRadius,ry:ScrollBox.barRadius,x:En,y:Pn,width:kn,height:Cn}),this._hbarXMin=En+kn/2,this._hbarTranslateMax=en-kn):(delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax);var In=dr>mn,zn=ScrollBox.barWidth+2*ScrollBox.barPad,Bn=ScrollBox.barLength+2*ScrollBox.barPad,Vn=Rt+Zt,Hn=er;Vn+zn>it&&(Vn=it-zn);var qn=this.container.selectAll("rect.scrollbar-vertical").data(In?[0]:[]);qn.exit().on(".drag",null).remove(),qn.enter().append("rect").classed("scrollbar-vertical",!0).call(rt.fill,ScrollBox.barColor),In?(this.vbar=qn.attr({rx:ScrollBox.barRadius,ry:ScrollBox.barRadius,x:Vn,y:Hn,width:zn,height:Bn}),this._vbarYMin=Hn+Bn/2,this._vbarTranslateMax=mn-Bn):(delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax);var Yn=this.id,$n=dt-.5,ra=In?ht+zn+.5:ht+.5,oa=Dt-.5,pa=xn?Ot+Cn+.5:Ot+.5,ga=at._topdefs.selectAll("#"+Yn).data(xn||In?[0]:[]);if(ga.exit().remove(),ga.enter().append("clipPath").attr("id",Yn).append("rect"),xn||In?(this._clipRect=ga.select("rect").attr({x:Math.floor($n),y:Math.floor(oa),width:Math.ceil(ra)-Math.floor($n),height:Math.ceil(pa)-Math.floor(oa)}),this.container.call(nt.setClipUrl,Yn,this.gd),this.bg.attr({x:Rt,y:er,width:Zt,height:dr})):(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(nt.setClipUrl,null),delete this._clipRect),xn||In){var ma=tt.behavior.drag().on("dragstart",(function(){tt.event.sourceEvent.preventDefault()})).on("drag",this._onBoxDrag.bind(this));this.container.on("wheel",null).on("wheel",this._onBoxWheel.bind(this)).on(".drag",null).call(ma);var _a=tt.behavior.drag().on("dragstart",(function(){tt.event.sourceEvent.preventDefault(),tt.event.sourceEvent.stopPropagation()})).on("drag",this._onBarDrag.bind(this));xn&&this.hbar.on(".drag",null).call(_a),In&&this.vbar.on(".drag",null).call(_a)}this.setTranslate(Ge,Qe)},ScrollBox.prototype.disable=function(){(this.hbar||this.vbar)&&(this.bg.attr({width:0,height:0}),this.container.on("wheel",null).on(".drag",null).call(nt.setClipUrl,null),delete this._clipRect),this.hbar&&(this.hbar.on(".drag",null),this.hbar.remove(),delete this.hbar,delete this._hbarXMin,delete this._hbarTranslateMax),this.vbar&&(this.vbar.on(".drag",null),this.vbar.remove(),delete this.vbar,delete this._vbarYMin,delete this._vbarTranslateMax)},ScrollBox.prototype._onBoxDrag=function(){var Ne=this.translateX,Ge=this.translateY;this.hbar&&(Ne-=tt.event.dx),this.vbar&&(Ge-=tt.event.dy),this.setTranslate(Ne,Ge)},ScrollBox.prototype._onBoxWheel=function(){var Ne=this.translateX,Ge=this.translateY;this.hbar&&(Ne+=tt.event.deltaY),this.vbar&&(Ge+=tt.event.deltaY),this.setTranslate(Ne,Ge)},ScrollBox.prototype._onBarDrag=function(){var Ne=this.translateX,Ge=this.translateY;if(this.hbar){var Qe=Ne+this._hbarXMin,rt=Qe+this._hbarTranslateMax;Ne=(at.constrain(tt.event.x,Qe,rt)-Qe)/(rt-Qe)*(this.position.w-this._box.w)}if(this.vbar){var nt=Ge+this._vbarYMin,it=nt+this._vbarTranslateMax;Ge=(at.constrain(tt.event.y,nt,it)-nt)/(it-nt)*(this.position.h-this._box.h)}this.setTranslate(Ne,Ge)},ScrollBox.prototype.setTranslate=function(Ne,Ge){var Qe=this.position.w-this._box.w,tt=this.position.h-this._box.h;if(Ne=at.constrain(Ne||0,0,Qe),Ge=at.constrain(Ge||0,0,tt),this.translateX=Ne,this.translateY=Ge,this.container.call(nt.setTranslate,this._box.l-this.position.l-Ne,this._box.t-this.position.t-Ge),this._clipRect&&this._clipRect.attr({x:Math.floor(this.position.l+Ne-.5),y:Math.floor(this.position.t+Ge-.5)}),this.hbar){var rt=Ne/Qe;this.hbar.call(nt.setTranslate,Ne+rt*this._hbarTranslateMax,Ge)}if(this.vbar){var it=Ge/tt;this.vbar.call(nt.setTranslate,Ne,Ge+it*this._vbarTranslateMax)}}},{"../../lib":778,"../color":643,"../drawing":665,d3:169}],745:[function(Ne,Ge,Qe){"use strict";Ge.exports={FROM_BL:{left:0,center:.5,right:1,bottom:0,middle:.5,top:1},FROM_TL:{left:0,center:.5,right:1,bottom:1,middle:.5,top:0},FROM_BR:{left:1,center:.5,right:0,bottom:0,middle:.5,top:1},LINE_SPACING:1.3,CAP_SHIFT:.7,MID_SHIFT:.35,OPPOSITE_SIDE:{left:"right",right:"left",top:"bottom",bottom:"top"}}},{}],746:[function(Ne,Ge,Qe){"use strict";Ge.exports={axisRefDescription:function(Ne,Ge,Qe){return["If set to a",Ne,"axis id (e.g. *"+Ne+"* or","*"+Ne+"2*), the `"+Ne+"` position refers to a",Ne,"coordinate. If set to *paper*, the `"+Ne+"`","position refers to the distance from the",Ge,"of the plotting","area in normalized coordinates where *0* (*1*) corresponds to the",Ge,"("+Qe+"). If set to a",Ne,"axis ID followed by","*domain* (separated by a space), the position behaves like for","*paper*, but refers to the distance in fractions of the domain","length from the",Ge,"of the domain of that axis: e.g.,","*"+Ne+"2 domain* refers to the domain of the second",Ne," axis and a",Ne,"position of 0.5 refers to the","point between the",Ge,"and the",Qe,"of the domain of the","second",Ne,"axis."].join(" ")}}},{}],747:[function(Ne,Ge,Qe){"use strict";Ge.exports={INCREASING:{COLOR:"#3D9970",SYMBOL:"â²"},DECREASING:{COLOR:"#FF4136",SYMBOL:"â¼"}}},{}],748:[function(Ne,Ge,Qe){"use strict";Ge.exports={FORMAT_LINK:"https://github.com/d3/d3-3.x-api-reference/blob/master/Formatting.md#d3_format",DATE_FORMAT_LINK:"https://github.com/d3/d3-time-format#locale_format"}},{}],749:[function(Ne,Ge,Qe){"use strict";Ge.exports={COMPARISON_OPS:["=","!=","<",">=",">","<="],COMPARISON_OPS2:["=","<",">=",">","<="],INTERVAL_OPS:["[]","()","[)","(]","][",")(","](",")["],SET_OPS:["{}","}{"],CONSTRAINT_REDUCTION:{"=":"=","<":"<","<=":"<",">":">",">=":">","[]":"[]","()":"[]","[)":"[]","(]":"[]","][":"][",")(":"][","](":"][",")[":"]["}}},{}],750:[function(Ne,Ge,Qe){"use strict";Ge.exports={solid:[[],0],dot:[[.5,1],200],dash:[[.5,1],50],longdash:[[.5,1],10],dashdot:[[.5,.625,.875,1],50],longdashdot:[[.5,.7,.8,1],10]}},{}],751:[function(Ne,Ge,Qe){"use strict";Ge.exports={circle:"â","circle-open":"â",square:"â ","square-open":"â¡",diamond:"â","diamond-open":"â",cross:"+",x:"â"}},{}],752:[function(Ne,Ge,Qe){"use strict";Ge.exports={SHOW_PLACEHOLDER:100,HIDE_PLACEHOLDER:1e3,DESELECTDIM:.2}},{}],753:[function(Ne,Ge,Qe){"use strict";Ge.exports={BADNUM:void 0,FP_SAFE:Number.MAX_VALUE/1e4,ONEMAXYEAR:316224e5,ONEAVGYEAR:315576e5,ONEMINYEAR:31536e6,ONEMAXQUARTER:79488e5,ONEAVGQUARTER:78894e5,ONEMINQUARTER:76896e5,ONEMAXMONTH:26784e5,ONEAVGMONTH:26298e5,ONEMINMONTH:24192e5,ONEWEEK:6048e5,ONEDAY:864e5,ONEHOUR:36e5,ONEMIN:6e4,ONESEC:1e3,EPOCHJD:2440587.5,ALMOST_EQUAL:.999999,LOG_CLIP:10,MINUS_SIGN:"â"}},{}],754:[function(Ne,Ge,Qe){"use strict";Qe.xmlns="http://www.w3.org/2000/xmlns/",Qe.svg="http://www.w3.org/2000/svg",Qe.xlink="http://www.w3.org/1999/xlink",Qe.svgAttrs={xmlns:Qe.svg,"xmlns:xlink":Qe.xlink}},{}],755:[function(Ne,Ge,Qe){"use strict";Qe.version=Ne("./version").version,Ne("es6-promise").polyfill(),Ne("../build/plotcss"),Ne("./fonts/mathjax_config")();for(var tt=Ne("./registry"),rt=Qe.register=tt.register,nt=Ne("./plot_api"),at=Object.keys(nt),it=0;it<at.length;it++){var ot=at[it];"_"!==ot.charAt(0)&&(Qe[ot]=nt[ot]),rt({moduleType:"apiMethod",name:ot,fn:nt[ot]})}rt(Ne("./traces/scatter")),rt([Ne("./components/legend"),Ne("./components/fx"),Ne("./components/annotations"),Ne("./components/annotations3d"),Ne("./components/shapes"),Ne("./components/images"),Ne("./components/updatemenus"),Ne("./components/sliders"),Ne("./components/rangeslider"),Ne("./components/rangeselector"),Ne("./components/grid"),Ne("./components/errorbars"),Ne("./components/colorscale"),Ne("./components/colorbar")]),rt([Ne("./locale-en"),Ne("./locale-en-us")]),window.PlotlyLocales&&Array.isArray(window.PlotlyLocales)&&(rt(window.PlotlyLocales),delete window.PlotlyLocales),Qe.Icons=Ne("./fonts/ploticon"),Qe.Plots=Ne("./plots/plots"),Qe.Fx=Ne("./components/fx"),Qe.Snapshot=Ne("./snapshot"),Qe.PlotSchema=Ne("./plot_api/plot_schema"),Qe.Queue=Ne("./lib/queue"),Qe.d3=Ne("d3")},{"../build/plotcss":1,"./components/annotations":634,"./components/annotations3d":639,"./components/colorbar":649,"./components/colorscale":655,"./components/errorbars":671,"./components/fx":683,"./components/grid":687,"./components/images":692,"./components/legend":700,"./components/rangeselector":711,"./components/rangeslider":718,"./components/shapes":732,"./components/sliders":737,"./components/updatemenus":743,"./fonts/mathjax_config":756,"./fonts/ploticon":757,"./lib/queue":794,"./locale-en":808,"./locale-en-us":807,"./plot_api":812,"./plot_api/plot_schema":816,"./plots/plots":891,"./registry":911,"./snapshot":916,"./traces/scatter":1199,"./version":1370,d3:169,"es6-promise":224}],756:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(){"undefined"!=typeof MathJax&&"local"!==(window.PlotlyConfig||{}).MathJaxConfig&&(MathJax.Hub.Config({messageStyle:"none",skipStartupTypeset:!0,displayAlign:"left",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]}}),MathJax.Hub.Configured())}},{}],757:[function(Ne,Ge,Qe){"use strict";Ge.exports={undo:{width:857.1,height:1e3,path:"m857 350q0-87-34-166t-91-137-137-92-166-34q-96 0-183 41t-147 114q-4 6-4 13t5 11l76 77q6 5 14 5 9-1 13-7 41-53 100-82t126-29q58 0 110 23t92 61 61 91 22 111-22 111-61 91-92 61-110 23q-55 0-105-20t-90-57l77-77q17-16 8-38-10-23-33-23h-250q-15 0-25 11t-11 25v250q0 24 22 33 22 10 39-8l72-72q60 57 137 88t159 31q87 0 166-34t137-92 91-137 34-166z",transform:"matrix(1 0 0 -1 0 850)"},home:{width:928.6,height:1e3,path:"m786 296v-267q0-15-11-26t-25-10h-214v214h-143v-214h-214q-15 0-25 10t-11 26v267q0 1 0 2t0 2l321 264 321-264q1-1 1-4z m124 39l-34-41q-5-5-12-6h-2q-7 0-12 3l-386 322-386-322q-7-4-13-4-7 2-12 7l-35 41q-4 5-3 13t6 12l401 334q18 15 42 15t43-15l136-114v109q0 8 5 13t13 5h107q8 0 13-5t5-13v-227l122-102q5-5 6-12t-4-13z",transform:"matrix(1 0 0 -1 0 850)"},"camera-retro":{width:1e3,height:1e3,path:"m518 386q0 8-5 13t-13 5q-37 0-63-27t-26-63q0-8 5-13t13-5 12 5 5 13q0 23 16 38t38 16q8 0 13 5t5 13z m125-73q0-59-42-101t-101-42-101 42-42 101 42 101 101 42 101-42 42-101z m-572-320h858v71h-858v-71z m643 320q0 89-62 152t-152 62-151-62-63-152 63-151 151-63 152 63 62 151z m-571 358h214v72h-214v-72z m-72-107h858v143h-462l-36-71h-360v-72z m929 143v-714q0-30-21-51t-50-21h-858q-29 0-50 21t-21 51v714q0 30 21 51t50 21h858q29 0 50-21t21-51z",transform:"matrix(1 0 0 -1 0 850)"},zoombox:{width:1e3,height:1e3,path:"m1000-25l-250 251c40 63 63 138 63 218 0 224-182 406-407 406-224 0-406-182-406-406s183-406 407-406c80 0 155 22 218 62l250-250 125 125z m-812 250l0 438 437 0 0-438-437 0z m62 375l313 0 0-312-313 0 0 312z",transform:"matrix(1 0 0 -1 0 850)"},pan:{width:1e3,height:1e3,path:"m1000 350l-187 188 0-125-250 0 0 250 125 0-188 187-187-187 125 0 0-250-250 0 0 125-188-188 186-187 0 125 252 0 0-250-125 0 187-188 188 188-125 0 0 250 250 0 0-126 187 188z",transform:"matrix(1 0 0 -1 0 850)"},zoom_plus:{width:875,height:1e3,path:"m1 787l0-875 875 0 0 875-875 0z m687-500l-187 0 0-187-125 0 0 187-188 0 0 125 188 0 0 187 125 0 0-187 187 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},zoom_minus:{width:875,height:1e3,path:"m0 788l0-876 875 0 0 876-875 0z m688-500l-500 0 0 125 500 0 0-125z",transform:"matrix(1 0 0 -1 0 850)"},autoscale:{width:1e3,height:1e3,path:"m250 850l-187 0-63 0 0-62 0-188 63 0 0 188 187 0 0 62z m688 0l-188 0 0-62 188 0 0-188 62 0 0 188 0 62-62 0z m-875-938l0 188-63 0 0-188 0-62 63 0 187 0 0 62-187 0z m875 188l0-188-188 0 0-62 188 0 62 0 0 62 0 188-62 0z m-125 188l-1 0-93-94-156 156 156 156 92-93 2 0 0 250-250 0 0-2 93-92-156-156-156 156 94 92 0 2-250 0 0-250 0 0 93 93 157-156-157-156-93 94 0 0 0-250 250 0 0 0-94 93 156 157 156-157-93-93 0 0 250 0 0 250z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_basic:{width:1500,height:1e3,path:"m375 725l0 0-375-375 375-374 0-1 1125 0 0 750-1125 0z",transform:"matrix(1 0 0 -1 0 850)"},tooltip_compare:{width:1125,height:1e3,path:"m187 786l0 2-187-188 188-187 0 0 937 0 0 373-938 0z m0-499l0 1-187-188 188-188 0 0 937 0 0 376-938-1z",transform:"matrix(1 0 0 -1 0 850)"},plotlylogo:{width:1542,height:1e3,path:"m0-10h182v-140h-182v140z m228 146h183v-286h-183v286z m225 714h182v-1000h-182v1000z m225-285h182v-715h-182v715z m225 142h183v-857h-183v857z m231-428h182v-429h-182v429z m225-291h183v-138h-183v138z",transform:"matrix(1 0 0 -1 0 850)"},"z-axis":{width:1e3,height:1e3,path:"m833 5l-17 108v41l-130-65 130-66c0 0 0 38 0 39 0-1 36-14 39-25 4-15-6-22-16-30-15-12-39-16-56-20-90-22-187-23-279-23-261 0-341 34-353 59 3 60 228 110 228 110-140-8-351-35-351-116 0-120 293-142 474-142 155 0 477 22 477 142 0 50-74 79-163 96z m-374 94c-58-5-99-21-99-40 0-24 65-43 144-43 79 0 143 19 143 43 0 19-42 34-98 40v216h87l-132 135-133-135h88v-216z m167 515h-136v1c16 16 31 34 46 52l84 109v54h-230v-71h124v-1c-16-17-28-32-44-51l-89-114v-51h245v72z",transform:"matrix(1 0 0 -1 0 850)"},"3d_rotate":{width:1e3,height:1e3,path:"m922 660c-5 4-9 7-14 11-359 263-580-31-580-31l-102 28 58-400c0 1 1 1 2 2 118 108 351 249 351 249s-62 27-100 42c88 83 222 183 347 122 16-8 30-17 44-27-2 1-4 2-6 4z m36-329c0 0 64 229-88 296-62 27-124 14-175-11 157-78 225-208 249-266 8-19 11-31 11-31 2 5 6 15 11 32-5-13-8-20-8-20z m-775-239c70-31 117-50 198-32-121 80-199 346-199 346l-96-15-58-12c0 0 55-226 155-287z m603 133l-317-139c0 0 4-4 19-14 7-5 24-15 24-15s-177-147-389 4c235-287 536-112 536-112l31-22 100 299-4-1z m-298-153c6-4 14-9 24-15 0 0-17 10-24 15z",transform:"matrix(1 0 0 -1 0 850)"},camera:{width:1e3,height:1e3,path:"m500 450c-83 0-150-67-150-150 0-83 67-150 150-150 83 0 150 67 150 150 0 83-67 150-150 150z m400 150h-120c-16 0-34 13-39 29l-31 93c-6 15-23 28-40 28h-340c-16 0-34-13-39-28l-31-94c-6-15-23-28-40-28h-120c-55 0-100-45-100-100v-450c0-55 45-100 100-100h800c55 0 100 45 100 100v450c0 55-45 100-100 100z m-400-550c-138 0-250 112-250 250 0 138 112 250 250 250 138 0 250-112 250-250 0-138-112-250-250-250z m365 380c-19 0-35 16-35 35 0 19 16 35 35 35 19 0 35-16 35-35 0-19-16-35-35-35z",transform:"matrix(1 0 0 -1 0 850)"},movie:{width:1e3,height:1e3,path:"m938 413l-188-125c0 37-17 71-44 94 64 38 107 107 107 187 0 121-98 219-219 219-121 0-219-98-219-219 0-61 25-117 66-156h-115c30 33 49 76 49 125 0 103-84 187-187 187s-188-84-188-187c0-57 26-107 65-141-38-22-65-62-65-109v-250c0-70 56-126 125-126h500c69 0 125 56 125 126l188-126c34 0 62 28 62 63v375c0 35-28 63-62 63z m-750 0c-69 0-125 56-125 125s56 125 125 125 125-56 125-125-56-125-125-125z m406-1c-87 0-157 70-157 157 0 86 70 156 157 156s156-70 156-156-70-157-156-157z",transform:"matrix(1 0 0 -1 0 850)"},question:{width:857.1,height:1e3,path:"m500 82v107q0 8-5 13t-13 5h-107q-8 0-13-5t-5-13v-107q0-8 5-13t13-5h107q8 0 13 5t5 13z m143 375q0 49-31 91t-77 65-95 23q-136 0-207-119-9-14 4-24l74-55q4-4 10-4 9 0 14 7 30 38 48 51 19 14 48 14 27 0 48-15t21-33q0-21-11-34t-38-25q-35-16-65-48t-29-70v-20q0-8 5-13t13-5h107q8 0 13 5t5 13q0 10 12 27t30 28q18 10 28 16t25 19 25 27 16 34 7 45z m214-107q0-117-57-215t-156-156-215-58-216 58-155 156-58 215 58 215 155 156 216 58 215-58 156-156 57-215z",transform:"matrix(1 0 0 -1 0 850)"},disk:{width:857.1,height:1e3,path:"m214-7h429v214h-429v-214z m500 0h72v500q0 8-6 21t-11 20l-157 156q-5 6-19 12t-22 5v-232q0-22-15-38t-38-16h-322q-22 0-37 16t-16 38v232h-72v-714h72v232q0 22 16 38t37 16h465q22 0 38-16t15-38v-232z m-214 518v178q0 8-5 13t-13 5h-107q-7 0-13-5t-5-13v-178q0-8 5-13t13-5h107q7 0 13 5t5 13z m357-18v-518q0-22-15-38t-38-16h-750q-23 0-38 16t-16 38v750q0 22 16 38t38 16h517q23 0 50-12t42-26l156-157q16-15 27-42t11-49z",transform:"matrix(1 0 0 -1 0 850)"},drawopenpath:{width:70,height:70,path:"M33.21,85.65a7.31,7.31,0,0,1-2.59-.48c-8.16-3.11-9.27-19.8-9.88-41.3-.1-3.58-.19-6.68-.35-9-.15-2.1-.67-3.48-1.43-3.79-2.13-.88-7.91,2.32-12,5.86L3,32.38c1.87-1.64,11.55-9.66,18.27-6.9,2.13.87,4.75,3.14,5.17,9,.17,2.43.26,5.59.36,9.25a224.17,224.17,0,0,0,1.5,23.4c1.54,10.76,4,12.22,4.48,12.4.84.32,2.79-.46,5.76-3.59L43,80.07C41.53,81.57,37.68,85.64,33.21,85.65ZM74.81,69a11.34,11.34,0,0,0,6.09-6.72L87.26,44.5,74.72,32,56.9,38.35c-2.37.86-5.57,3.42-6.61,6L38.65,72.14l8.42,8.43ZM55,46.27a7.91,7.91,0,0,1,3.64-3.17l14.8-5.3,8,8L76.11,60.6l-.06.19a6.37,6.37,0,0,1-3,3.43L48.25,74.59,44.62,71Zm16.57,7.82A6.9,6.9,0,1,0,64.64,61,6.91,6.91,0,0,0,71.54,54.09Zm-4.05,0a2.85,2.85,0,1,1-2.85-2.85A2.86,2.86,0,0,1,67.49,54.09Zm-4.13,5.22L60.5,56.45,44.26,72.7l2.86,2.86ZM97.83,35.67,84.14,22l-8.57,8.57L89.26,44.24Zm-13.69-8,8,8-2.85,2.85-8-8Z",transform:"matrix(1 0 0 1 -15 -15)"},drawclosedpath:{width:90,height:90,path:"M88.41,21.12a26.56,26.56,0,0,0-36.18,0l-2.07,2-2.07-2a26.57,26.57,0,0,0-36.18,0,23.74,23.74,0,0,0,0,34.8L48,90.12a3.22,3.22,0,0,0,4.42,0l36-34.21a23.73,23.73,0,0,0,0-34.79ZM84,51.24,50.16,83.35,16.35,51.25a17.28,17.28,0,0,1,0-25.47,20,20,0,0,1,27.3,0l4.29,4.07a3.23,3.23,0,0,0,4.44,0l4.29-4.07a20,20,0,0,1,27.3,0,17.27,17.27,0,0,1,0,25.46ZM66.76,47.68h-33v6.91h33ZM53.35,35H46.44V68h6.91Z",transform:"matrix(1 0 0 1 -5 -5)"},lasso:{width:1031,height:1e3,path:"m1018 538c-36 207-290 336-568 286-277-48-473-256-436-463 10-57 36-108 76-151-13-66 11-137 68-183 34-28 75-41 114-42l-55-70 0 0c-2-1-3-2-4-3-10-14-8-34 5-45 14-11 34-8 45 4 1 1 2 3 2 5l0 0 113 140c16 11 31 24 45 40 4 3 6 7 8 11 48-3 100 0 151 9 278 48 473 255 436 462z m-624-379c-80 14-149 48-197 96 42 42 109 47 156 9 33-26 47-66 41-105z m-187-74c-19 16-33 37-39 60 50-32 109-55 174-68-42-25-95-24-135 8z m360 75c-34-7-69-9-102-8 8 62-16 128-68 170-73 59-175 54-244-5-9 20-16 40-20 61-28 159 121 317 333 354s407-60 434-217c28-159-121-318-333-355z",transform:"matrix(1 0 0 -1 0 850)"},selectbox:{width:1e3,height:1e3,path:"m0 850l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-285l0-143 143 0 0 143-143 0z m857 0l0-143 143 0 0 143-143 0z m-857-286l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z m285 0l0-143 143 0 0 143-143 0z m286 0l0-143 143 0 0 143-143 0z",transform:"matrix(1 0 0 -1 0 850)"},drawline:{width:70,height:70,path:"M60.64,62.3a11.29,11.29,0,0,0,6.09-6.72l6.35-17.72L60.54,25.31l-17.82,6.4c-2.36.86-5.57,3.41-6.6,6L24.48,65.5l8.42,8.42ZM40.79,39.63a7.89,7.89,0,0,1,3.65-3.17l14.79-5.31,8,8L61.94,54l-.06.19a6.44,6.44,0,0,1-3,3.43L34.07,68l-3.62-3.63Zm16.57,7.81a6.9,6.9,0,1,0-6.89,6.9A6.9,6.9,0,0,0,57.36,47.44Zm-4,0a2.86,2.86,0,1,1-2.85-2.85A2.86,2.86,0,0,1,53.32,47.44Zm-4.13,5.22L46.33,49.8,30.08,66.05l2.86,2.86ZM83.65,29,70,15.34,61.4,23.9,75.09,37.59ZM70,21.06l8,8-2.84,2.85-8-8ZM87,80.49H10.67V87H87Z",transform:"matrix(1 0 0 1 -15 -15)"},drawrect:{width:80,height:80,path:"M78,22V79H21V22H78m9-9H12V88H87V13ZM68,46.22H31V54H68ZM53,32H45.22V69H53Z",transform:"matrix(1 0 0 1 -10 -10)"},drawcircle:{width:80,height:80,path:"M50,84.72C26.84,84.72,8,69.28,8,50.3S26.84,15.87,50,15.87,92,31.31,92,50.3,73.16,84.72,50,84.72Zm0-60.59c-18.6,0-33.74,11.74-33.74,26.17S31.4,76.46,50,76.46,83.74,64.72,83.74,50.3,68.6,24.13,50,24.13Zm17.15,22h-34v7.11h34Zm-13.8-13H46.24v34h7.11Z",transform:"matrix(1 0 0 1 -10 -10)"},eraseshape:{width:80,height:80,path:"M82.77,78H31.85L6,49.57,31.85,21.14H82.77a8.72,8.72,0,0,1,8.65,8.77V69.24A8.72,8.72,0,0,1,82.77,78ZM35.46,69.84H82.77a.57.57,0,0,0,.49-.6V29.91a.57.57,0,0,0-.49-.61H35.46L17,49.57Zm32.68-34.7-24,24,5,5,24-24Zm-19,.53-5,5,24,24,5-5Z",transform:"matrix(1 0 0 1 -10 -10)"},spikeline:{width:1e3,height:1e3,path:"M512 409c0-57-46-104-103-104-57 0-104 47-104 104 0 57 47 103 104 103 57 0 103-46 103-103z m-327-39l92 0 0 92-92 0z m-185 0l92 0 0 92-92 0z m370-186l92 0 0 93-92 0z m0-184l92 0 0 92-92 0z",transform:"matrix(1.5 0 0 -1.5 0 850)"},pencil:{width:1792,height:1792,path:"M491 1536l91-91-235-235-91 91v107h128v128h107zm523-928q0-22-22-22-10 0-17 7l-542 542q-7 7-7 17 0 22 22 22 10 0 17-7l542-542q7-7 7-17zm-54-192l416 416-832 832h-416v-416zm683 96q0 53-37 90l-166 166-416-416 166-165q36-38 90-38 53 0 91 38l235 234q37 39 37 91z",transform:"matrix(1 0 0 1 0 1)"},newplotlylogo:{name:"newplotlylogo",svg:"<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 132 132'><defs><style>.cls-1 {fill: #3f4f75;} .cls-2 {fill: #80cfbe;} .cls-3 {fill: #fff;}</style></defs><title>plotly-logomark</title><g id='symbol'><rect class='cls-1' width='132' height='132' rx='6' ry='6'/><circle class='cls-2' cx='78' cy='54' r='6'/><circle class='cls-2' cx='102' cy='30' r='6'/><circle class='cls-2' cx='78' cy='30' r='6'/><circle class='cls-2' cx='54' cy='30' r='6'/><circle class='cls-2' cx='30' cy='30' r='6'/><circle class='cls-2' cx='30' cy='54' r='6'/><path class='cls-3' d='M30,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,30,72Z'/><path class='cls-3' d='M78,72a6,6,0,0,0-6,6v24a6,6,0,0,0,12,0V78A6,6,0,0,0,78,72Z'/><path class='cls-3' d='M54,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,54,48Z'/><path class='cls-3' d='M102,48a6,6,0,0,0-6,6v48a6,6,0,0,0,12,0V54A6,6,0,0,0,102,48Z'/></g></svg>"}}},{}],758:[function(Ne,Ge,Qe){"use strict";Qe.isLeftAnchor=function(Ne){return"left"===Ne.xanchor||"auto"===Ne.xanchor&&Ne.x<=1/3},Qe.isCenterAnchor=function(Ne){return"center"===Ne.xanchor||"auto"===Ne.xanchor&&Ne.x>1/3&&Ne.x<2/3},Qe.isRightAnchor=function(Ne){return"right"===Ne.xanchor||"auto"===Ne.xanchor&&Ne.x>=2/3},Qe.isTopAnchor=function(Ne){return"top"===Ne.yanchor||"auto"===Ne.yanchor&&Ne.y>=2/3},Qe.isMiddleAnchor=function(Ne){return"middle"===Ne.yanchor||"auto"===Ne.yanchor&&Ne.y>1/3&&Ne.y<2/3},Qe.isBottomAnchor=function(Ne){return"bottom"===Ne.yanchor||"auto"===Ne.yanchor&&Ne.y<=1/3}},{}],759:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./mod"),rt=tt.mod,nt=tt.modHalf,at=Math.PI,it=2*at;function deg2rad(Ne){return Ne/180*at}function rad2deg(Ne){return Ne/at*180}function isFullCircle(Ne){return Math.abs(Ne[1]-Ne[0])>it-1e-14}function angleDelta(Ne,Ge){return nt(Ge-Ne,it)}function angleDist(Ne,Ge){return Math.abs(angleDelta(Ne,Ge))}function isAngleInsideSector(Ne,Ge){if(isFullCircle(Ge))return!0;var Qe,tt;Ge[0]<Ge[1]?(Qe=Ge[0],tt=Ge[1]):(Qe=Ge[1],tt=Ge[0]),(Qe=rt(Qe,it))>(tt=rt(tt,it))&&(tt+=it);var nt=rt(Ne,it),at=nt+it;return nt>=Qe&&nt<=tt||at>=Qe&&at<=tt}function isPtInsideSector(Ne,Ge,Qe,tt){return!!isAngleInsideSector(Ge,tt)&&(Qe[0]<Qe[1]?(rt=Qe[0],nt=Qe[1]):(rt=Qe[1],nt=Qe[0]),Ne>=rt&&Ne<=nt);var rt,nt}function _path(Ne,Ge,Qe,tt,rt,nt,ot){rt=rt||0,nt=nt||0;var dt,ht,Dt,Ot,Rt,Zt=isFullCircle([Qe,tt]);function pt(Ne,Ge){return[Ne*Math.cos(Ge)+rt,nt-Ne*Math.sin(Ge)]}Zt?(dt=0,ht=at,Dt=it):Qe<tt?(dt=Qe,Dt=tt):(dt=tt,Dt=Qe),Ne<Ge?(Ot=Ne,Rt=Ge):(Ot=Ge,Rt=Ne);var er,dr=Math.abs(Dt-dt)<=at?0:1;function arc(Ne,Ge,Qe){return"A"+[Ne,Ne]+" "+[0,dr,Qe]+" "+pt(Ne,Ge)}return Zt?er=null===Ot?"M"+pt(Rt,dt)+arc(Rt,ht,0)+arc(Rt,Dt,0)+"Z":"M"+pt(Ot,dt)+arc(Ot,ht,0)+arc(Ot,Dt,0)+"ZM"+pt(Rt,dt)+arc(Rt,ht,1)+arc(Rt,Dt,1)+"Z":null===Ot?(er="M"+pt(Rt,dt)+arc(Rt,Dt,0),ot&&(er+="L0,0Z")):er="M"+pt(Ot,dt)+"L"+pt(Rt,dt)+arc(Rt,Dt,0)+"L"+pt(Ot,Dt)+arc(Ot,dt,1)+"Z",er}function pathArc(Ne,Ge,Qe,tt,rt){return _path(null,Ne,Ge,Qe,tt,rt,0)}function pathSector(Ne,Ge,Qe,tt,rt){return _path(null,Ne,Ge,Qe,tt,rt,1)}function pathAnnulus(Ne,Ge,Qe,tt,rt,nt){return _path(Ne,Ge,Qe,tt,rt,nt,1)}Ge.exports={deg2rad:deg2rad,rad2deg:rad2deg,angleDelta:angleDelta,angleDist:angleDist,isFullCircle:isFullCircle,isAngleInsideSector:isAngleInsideSector,isPtInsideSector:isPtInsideSector,pathArc:pathArc,pathSector:pathSector,pathAnnulus:pathAnnulus}},{"./mod":785}],760:[function(Ne,Ge,Qe){"use strict";var tt=Array.isArray,rt="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer:{isView:function(){return!1}},nt="undefined"==typeof DataView?function(){}:DataView;function isTypedArray(Ne){return rt.isView(Ne)&&!(Ne instanceof nt)}function isArrayOrTypedArray(Ne){return tt(Ne)||isTypedArray(Ne)}function isArray1D(Ne){return!isArrayOrTypedArray(Ne[0])}function _rowLength(Ne,Ge,Qe){if(isArrayOrTypedArray(Ne)){if(isArrayOrTypedArray(Ne[0])){for(var tt=Qe,rt=0;rt<Ne.length;rt++)tt=Ge(tt,Ne[rt].length);return tt}return Ne.length}return 0}Qe.isTypedArray=isTypedArray,Qe.isArrayOrTypedArray=isArrayOrTypedArray,Qe.isArray1D=isArray1D,Qe.ensureArray=function(Ne,Ge){return tt(Ne)||(Ne=[]),Ne.length=Ge,Ne},Qe.concat=function(){var Ne,Ge,Qe,rt,nt,at,it,ot,dt=[],ht=!0,Dt=0;for(Qe=0;Qe<arguments.length;Qe++)(at=(rt=arguments[Qe]).length)&&(Ge?dt.push(rt):(Ge=rt,nt=at),tt(rt)?Ne=!1:(ht=!1,Dt?Ne!==rt.constructor&&(Ne=!1):Ne=rt.constructor),Dt+=at);if(!Dt)return[];if(!dt.length)return Ge;if(ht)return Ge.concat.apply(Ge,dt);if(Ne){for((it=new Ne(Dt)).set(Ge),Qe=0;Qe<dt.length;Qe++)rt=dt[Qe],it.set(rt,nt),nt+=rt.length;return it}for(it=new Array(Dt),ot=0;ot<Ge.length;ot++)it[ot]=Ge[ot];for(Qe=0;Qe<dt.length;Qe++){for(rt=dt[Qe],ot=0;ot<rt.length;ot++)it[nt+ot]=rt[ot];nt+=ot}return it},Qe.maxRowLength=function(Ne){return _rowLength(Ne,Math.max,0)},Qe.minRowLength=function(Ne){return _rowLength(Ne,Math.min,1/0)}},{}],761:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../constants/numerical").BADNUM,nt=/^['"%,$#\s']+|[, ]|['"%,$#\s']+$/g;Ge.exports=function(Ne){return"string"==typeof Ne&&(Ne=Ne.replace(nt,"")),tt(Ne)?Number(Ne):rt}},{"../constants/numerical":753,"fast-isnumeric":241}],762:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne){var Ge=Ne._fullLayout;Ge._glcanvas&&Ge._glcanvas.size()&&Ge._glcanvas.each((function(Ne){Ne.regl&&Ne.regl.clear({color:!0,depth:!0})}))}},{}],763:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne){Ne._responsiveChartHandler&&(window.removeEventListener("resize",Ne._responsiveChartHandler),delete Ne._responsiveChartHandler)}},{}],764:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("tinycolor2"),nt=Ne("../plots/attributes"),at=Ne("../components/colorscale/scales"),it=Ne("../constants/interactions").DESELECTDIM,ot=Ne("./nested_property"),dt=Ne("./regex").counter,ht=Ne("./mod").modHalf,Dt=Ne("./array").isArrayOrTypedArray;function validate(Ne,Ge){var tt=Qe.valObjectMeta[Ge.valType];if(Ge.arrayOk&&Dt(Ne))return!0;if(tt.validateFunction)return tt.validateFunction(Ne,Ge);var rt={},nt=rt,at={set:function(Ne){nt=Ne}};return tt.coerceFunction(Ne,at,rt,Ge),nt!==rt}Qe.valObjectMeta={data_array:{coerceFunction:function(Ne,Ge,Qe){Dt(Ne)?Ge.set(Ne):void 0!==Qe&&Ge.set(Qe)}},enumerated:{coerceFunction:function(Ne,Ge,Qe,tt){tt.coerceNumber&&(Ne=+Ne),-1===tt.values.indexOf(Ne)?Ge.set(Qe):Ge.set(Ne)},validateFunction:function(Ne,Ge){Ge.coerceNumber&&(Ne=+Ne);for(var Qe=Ge.values,tt=0;tt<Qe.length;tt++){var rt=String(Qe[tt]);if("/"===rt.charAt(0)&&"/"===rt.charAt(rt.length-1)){if(new RegExp(rt.substr(1,rt.length-2)).test(Ne))return!0}else if(Ne===Qe[tt])return!0}return!1}},boolean:{coerceFunction:function(Ne,Ge,Qe){!0===Ne||!1===Ne?Ge.set(Ne):Ge.set(Qe)}},number:{coerceFunction:function(Ne,Ge,Qe,rt){!tt(Ne)||void 0!==rt.min&&Ne<rt.min||void 0!==rt.max&&Ne>rt.max?Ge.set(Qe):Ge.set(+Ne)}},integer:{coerceFunction:function(Ne,Ge,Qe,rt){Ne%1||!tt(Ne)||void 0!==rt.min&&Ne<rt.min||void 0!==rt.max&&Ne>rt.max?Ge.set(Qe):Ge.set(+Ne)}},string:{coerceFunction:function(Ne,Ge,Qe,tt){if("string"!=typeof Ne){var rt="number"==typeof Ne;!0!==tt.strict&&rt?Ge.set(String(Ne)):Ge.set(Qe)}else tt.noBlank&&!Ne?Ge.set(Qe):Ge.set(Ne)}},color:{coerceFunction:function(Ne,Ge,Qe){rt(Ne).isValid()?Ge.set(Ne):Ge.set(Qe)}},colorlist:{coerceFunction:function(Ne,Ge,Qe){function isColor(Ne){return rt(Ne).isValid()}Array.isArray(Ne)&&Ne.length&&Ne.every(isColor)?Ge.set(Ne):Ge.set(Qe)}},colorscale:{coerceFunction:function(Ne,Ge,Qe){Ge.set(at.get(Ne,Qe))}},angle:{coerceFunction:function(Ne,Ge,Qe){"auto"===Ne?Ge.set("auto"):tt(Ne)?Ge.set(ht(+Ne,360)):Ge.set(Qe)}},subplotid:{coerceFunction:function(Ne,Ge,Qe,tt){var rt=tt.regex||dt(Qe);"string"==typeof Ne&&rt.test(Ne)?Ge.set(Ne):Ge.set(Qe)},validateFunction:function(Ne,Ge){var Qe=Ge.dflt;return Ne===Qe||"string"==typeof Ne&&!!dt(Qe).test(Ne)}},flaglist:{coerceFunction:function(Ne,Ge,Qe,tt){if("string"==typeof Ne)if(-1===(tt.extras||[]).indexOf(Ne)){for(var rt=Ne.split("+"),nt=0;nt<rt.length;){var at=rt[nt];-1===tt.flags.indexOf(at)||rt.indexOf(at)<nt?rt.splice(nt,1):nt++}rt.length?Ge.set(rt.join("+")):Ge.set(Qe)}else Ge.set(Ne);else Ge.set(Qe)}},any:{coerceFunction:function(Ne,Ge,Qe){void 0===Ne?Ge.set(Qe):Ge.set(Ne)}},info_array:{coerceFunction:function(Ne,Ge,tt,rt){function coercePart(Ne,Ge,tt){var rt,nt={set:function(Ne){rt=Ne}};return void 0===tt&&(tt=Ge.dflt),Qe.valObjectMeta[Ge.valType].coerceFunction(Ne,nt,tt,Ge),rt}var nt=2===rt.dimensions||"1-2"===rt.dimensions&&Array.isArray(Ne)&&Array.isArray(Ne[0]);if(Array.isArray(Ne)){var at,it,ot,dt,ht,Dt,Ot=rt.items,Rt=[],Zt=Array.isArray(Ot),er=Zt&&nt&&Array.isArray(Ot[0]),dr=nt&&Zt&&!er,mr=Zt&&!dr?Ot.length:Ne.length;if(tt=Array.isArray(tt)?tt:[],nt)for(at=0;at<mr;at++)for(Rt[at]=[],ot=Array.isArray(Ne[at])?Ne[at]:[],ht=dr?Ot.length:Zt?Ot[at].length:ot.length,it=0;it<ht;it++)dt=dr?Ot[it]:Zt?Ot[at][it]:Ot,void 0!==(Dt=coercePart(ot[it],dt,(tt[at]||[])[it]))&&(Rt[at][it]=Dt);else for(at=0;at<mr;at++)void 0!==(Dt=coercePart(Ne[at],Zt?Ot[at]:Ot,tt[at]))&&(Rt[at]=Dt);Ge.set(Rt)}else Ge.set(tt)},validateFunction:function(Ne,Ge){if(!Array.isArray(Ne))return!1;var Qe=Ge.items,tt=Array.isArray(Qe),rt=2===Ge.dimensions;if(!Ge.freeLength&&Ne.length!==Qe.length)return!1;for(var nt=0;nt<Ne.length;nt++)if(rt){if(!Array.isArray(Ne[nt])||!Ge.freeLength&&Ne[nt].length!==Qe[nt].length)return!1;for(var at=0;at<Ne[nt].length;at++)if(!validate(Ne[nt][at],tt?Qe[nt][at]:Qe))return!1}else if(!validate(Ne[nt],tt?Qe[nt]:Qe))return!1;return!0}}},Qe.coerce=function(Ne,Ge,tt,rt,nt){var at=ot(tt,rt).get(),it=ot(Ne,rt),dt=ot(Ge,rt),ht=it.get(),Ot=Ge._template;if(void 0===ht&&Ot&&(ht=ot(Ot,rt).get(),Ot=0),void 0===nt&&(nt=at.dflt),at.arrayOk&&Dt(ht))return dt.set(ht),ht;var Rt=Qe.valObjectMeta[at.valType].coerceFunction;Rt(ht,dt,nt,at);var Zt=dt.get();return Ot&&Zt===nt&&!validate(ht,at)&&(Rt(ht=ot(Ot,rt).get(),dt,nt,at),Zt=dt.get()),Zt},Qe.coerce2=function(Ne,Ge,tt,rt,nt){var at=ot(Ne,rt),it=Qe.coerce(Ne,Ge,tt,rt,nt),dt=at.get();return null!=dt&&it},Qe.coerceFont=function(Ne,Ge,Qe){var tt={};return Qe=Qe||{},tt.family=Ne(Ge+".family",Qe.family),tt.size=Ne(Ge+".size",Qe.size),tt.color=Ne(Ge+".color",Qe.color),tt},Qe.coerceHoverinfo=function(Ne,Ge,tt){var rt,at=Ge._module.attributes,it=at.hoverinfo?at:nt,ot=it.hoverinfo;if(1===tt._dataLength){var dt="all"===ot.dflt?ot.flags.slice():ot.dflt.split("+");dt.splice(dt.indexOf("name"),1),rt=dt.join("+")}return Qe.coerce(Ne,Ge,it,"hoverinfo",rt)},Qe.coerceSelectionMarkerOpacity=function(Ne,Ge){if(Ne.marker){var Qe,tt,rt=Ne.marker.opacity;void 0!==rt&&(Dt(rt)||Ne.selected||Ne.unselected||(Qe=rt,tt=it*rt),Ge("selected.marker.opacity",Qe),Ge("unselected.marker.opacity",tt))}},Qe.validate=validate},{"../components/colorscale/scales":658,"../constants/interactions":752,"../plots/attributes":824,"./array":760,"./mod":785,"./nested_property":786,"./regex":795,"fast-isnumeric":241,tinycolor2:576}],765:[function(Ne,Ge,Qe){"use strict";var tt,rt,nt=Ne("d3-time-format").timeFormat,at=Ne("fast-isnumeric"),it=Ne("./loggers"),ot=Ne("./mod").mod,dt=Ne("../constants/numerical"),ht=dt.BADNUM,Dt=dt.ONEDAY,Ot=dt.ONEHOUR,Rt=dt.ONEMIN,Zt=dt.ONESEC,er=dt.EPOCHJD,dr=Ne("../registry"),mr=Ne("d3-time-format").utcFormat,xr=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\d)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,br=/^\s*(-?\d\d\d\d|\d\d)(-(\d?\di?)(-(\d?\d)([ Tt]([01]?\d|2[0-3])(:([0-5]\d)(:([0-5]\d(\.\d+)?))?(Z|z|[+\-]\d\d(:?\d\d)?)?)?)?)?)?\s*$/m,Ar=(new Date).getFullYear()-70;function isWorldCalendar(Ne){return Ne&&dr.componentsRegistry.calendars&&"string"==typeof Ne&&"gregorian"!==Ne}function _dateTick0(Ne,Ge){return isWorldCalendar(Ne)?Ge?dr.getComponentMethod("calendars","CANONICAL_SUNDAY")[Ne]:dr.getComponentMethod("calendars","CANONICAL_TICK")[Ne]:Ge?"2000-01-02":"2000-01-01"}function lpad(Ne,Ge){return String(Ne+Math.pow(10,Ge)).substr(1)}Qe.dateTick0=function(Ne,Ge){var tt=_dateTick0(Ne,!!Ge);if(Ge<2)return tt;var rt=Qe.dateTime2ms(tt,Ne);return rt+=Dt*(Ge-1),Qe.ms2DateTime(rt,0,Ne)},Qe.dfltRange=function(Ne){return isWorldCalendar(Ne)?dr.getComponentMethod("calendars","DFLTRANGE")[Ne]:["2000-01-01","2001-01-01"]},Qe.isJSDate=function(Ne){return"object"==typeof Ne&&null!==Ne&&"function"==typeof Ne.getTime},Qe.dateTime2ms=function(Ne,Ge){if(Qe.isJSDate(Ne)){var nt=Ne.getTimezoneOffset()*Rt,at=(Ne.getUTCMinutes()-Ne.getMinutes())*Rt+(Ne.getUTCSeconds()-Ne.getSeconds())*Zt+(Ne.getUTCMilliseconds()-Ne.getMilliseconds());if(at){var it=3*Rt;nt=nt-it/2+ot(at-nt+it/2,it)}return(Ne=Number(Ne)-nt)>=tt&&Ne<=rt?Ne:ht}if("string"!=typeof Ne&&"number"!=typeof Ne)return ht;Ne=String(Ne);var dt=isWorldCalendar(Ge),mr=Ne.charAt(0);!dt||"G"!==mr&&"g"!==mr||(Ne=Ne.substr(1),Ge="");var en=dt&&"chinese"===Ge.substr(0,7),mn=Ne.match(en?br:xr);if(!mn)return ht;var xn=mn[1],kn=mn[3]||"1",Cn=Number(mn[5]||1),En=Number(mn[7]||0),Pn=Number(mn[9]||0),Dn=Number(mn[11]||0);if(dt){if(2===xn.length)return ht;var In;xn=Number(xn);try{var zn=dr.getComponentMethod("calendars","getCal")(Ge);if(en){var Bn="i"===kn.charAt(kn.length-1);kn=parseInt(kn,10),In=zn.newDate(xn,zn.toMonthIndex(xn,kn,Bn),Cn)}else In=zn.newDate(xn,Number(kn),Cn)}catch(Ne){return ht}return In?(In.toJD()-er)*Dt+En*Ot+Pn*Rt+Dn*Zt:ht}xn=2===xn.length?(Number(xn)+2e3-Ar)%100+Ar:Number(xn),kn-=1;var Vn=new Date(Date.UTC(2e3,kn,Cn,En,Pn));return Vn.setUTCFullYear(xn),Vn.getUTCMonth()!==kn||Vn.getUTCDate()!==Cn?ht:Vn.getTime()+Dn*Zt},tt=Qe.MIN_MS=Qe.dateTime2ms("-9999"),rt=Qe.MAX_MS=Qe.dateTime2ms("9999-12-31 23:59:59.9999"),Qe.isDateTime=function(Ne,Ge){return Qe.dateTime2ms(Ne,Ge)!==ht};var en=90*Dt,mn=3*Ot,xn=5*Rt;function includeTime(Ne,Ge,Qe,tt,rt){if((Ge||Qe||tt||rt)&&(Ne+=" "+lpad(Ge,2)+":"+lpad(Qe,2),(tt||rt)&&(Ne+=":"+lpad(tt,2),rt))){for(var nt=4;rt%10==0;)nt-=1,rt/=10;Ne+="."+lpad(rt,nt)}return Ne}Qe.ms2DateTime=function(Ne,Ge,Qe){if("number"!=typeof Ne||!(Ne>=tt&&Ne<=rt))return ht;Ge||(Ge=0);var nt,at,it,dt,xr,br,Ar=Math.floor(10*ot(Ne+.05,1)),kn=Math.round(Ne-Ar/10);if(isWorldCalendar(Qe)){var Cn=Math.floor(kn/Dt)+er,En=Math.floor(ot(Ne,Dt));try{nt=dr.getComponentMethod("calendars","getCal")(Qe).fromJD(Cn).formatDate("yyyy-mm-dd")}catch(Ne){nt=mr("G%Y-%m-%d")(new Date(kn))}if("-"===nt.charAt(0))for(;nt.length<11;)nt="-0"+nt.substr(1);else for(;nt.length<10;)nt="0"+nt;at=Ge<en?Math.floor(En/Ot):0,it=Ge<en?Math.floor(En%Ot/Rt):0,dt=Ge<mn?Math.floor(En%Rt/Zt):0,xr=Ge<xn?En%Zt*10+Ar:0}else br=new Date(kn),nt=mr("%Y-%m-%d")(br),at=Ge<en?br.getUTCHours():0,it=Ge<en?br.getUTCMinutes():0,dt=Ge<mn?br.getUTCSeconds():0,xr=Ge<xn?10*br.getUTCMilliseconds()+Ar:0;return includeTime(nt,at,it,dt,xr)},Qe.ms2DateTimeLocal=function(Ne){if(!(Ne>=tt+Dt&&Ne<=rt-Dt))return ht;var Ge=Math.floor(10*ot(Ne+.05,1)),Qe=new Date(Math.round(Ne-Ge/10));return includeTime(nt("%Y-%m-%d")(Qe),Qe.getHours(),Qe.getMinutes(),Qe.getSeconds(),10*Qe.getUTCMilliseconds()+Ge)},Qe.cleanDate=function(Ne,Ge,tt){if(Ne===ht)return Ge;if(Qe.isJSDate(Ne)||"number"==typeof Ne&&isFinite(Ne)){if(isWorldCalendar(tt))return it.error("JS Dates and milliseconds are incompatible with world calendars",Ne),Ge;if(!(Ne=Qe.ms2DateTimeLocal(+Ne))&&void 0!==Ge)return Ge}else if(!Qe.isDateTime(Ne,tt))return it.error("unrecognized date",Ne),Ge;return Ne};var kn=/%\d?f/g;function modDateFormat(Ne,Ge,Qe,tt){Ne=Ne.replace(kn,(function(Ne){var Qe=Math.min(+Ne.charAt(1)||6,6);return(Ge/1e3%1+2).toFixed(Qe).substr(2).replace(/0+$/,"")||"0"}));var rt=new Date(Math.floor(Ge+.05));if(isWorldCalendar(tt))try{Ne=dr.getComponentMethod("calendars","worldCalFmt")(Ne,Ge,tt)}catch(Ne){return"Invalid"}return Qe(Ne)(rt)}var Cn=[59,59.9,59.99,59.999,59.9999];function formatTime(Ne,Ge){var Qe=ot(Ne+.05,Dt),tt=lpad(Math.floor(Qe/Ot),2)+":"+lpad(ot(Math.floor(Qe/Rt),60),2);if("M"!==Ge){at(Ge)||(Ge=0);var rt=(100+Math.min(ot(Ne/Zt,60),Cn[Ge])).toFixed(Ge).substr(1);Ge>0&&(rt=rt.replace(/0+$/,"").replace(/[\.]$/,"")),tt+=":"+rt}return tt}Qe.formatDate=function(Ne,Ge,Qe,tt,rt,nt){if(rt=isWorldCalendar(rt)&&rt,!Ge)if("y"===Qe)Ge=nt.year;else if("m"===Qe)Ge=nt.month;else{if("d"!==Qe)return formatTime(Ne,Qe)+"\n"+modDateFormat(nt.dayMonthYear,Ne,tt,rt);Ge=nt.dayMonth+"\n"+nt.year}return modDateFormat(Ge,Ne,tt,rt)};var En=3*Dt;Qe.incrementMonth=function(Ne,Ge,Qe){Qe=isWorldCalendar(Qe)&&Qe;var tt=ot(Ne,Dt);if(Ne=Math.round(Ne-tt),Qe)try{var rt=Math.round(Ne/Dt)+er,nt=dr.getComponentMethod("calendars","getCal")(Qe),at=nt.fromJD(rt);return Ge%12?nt.add(at,Ge,"m"):nt.add(at,Ge/12,"y"),(at.toJD()-er)*Dt+tt}catch(Ge){it.error("invalid ms "+Ne+" in calendar "+Qe)}var dt=new Date(Ne+En);return dt.setUTCMonth(dt.getUTCMonth()+Ge)+tt-En},Qe.findExactDates=function(Ne,Ge){for(var Qe,tt,rt=0,nt=0,it=0,ot=0,dt=isWorldCalendar(Ge)&&dr.getComponentMethod("calendars","getCal")(Ge),ht=0;ht<Ne.length;ht++)if(tt=Ne[ht],at(tt)){if(!(tt%Dt))if(dt)try{1===(Qe=dt.fromJD(tt/Dt+er)).day()?1===Qe.month()?rt++:nt++:it++}catch(Ne){}else 1===(Qe=new Date(tt)).getUTCDate()?0===Qe.getUTCMonth()?rt++:nt++:it++}else ot++;it+=nt+=rt;var Ot=Ne.length-ot;return{exactYears:rt/Ot,exactMonths:nt/Ot,exactDays:it/Ot}}},{"../constants/numerical":753,"../registry":911,"./loggers":782,"./mod":785,"d3-time-format":166,"fast-isnumeric":241}],766:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("./loggers"),nt=Ne("./matrix"),at=Ne("gl-mat4");function getGraphDiv(Ne){var Ge;if("string"==typeof Ne){if(null===(Ge=document.getElementById(Ne)))throw new Error("No DOM element with id '"+Ne+"' exists on the page.");return Ge}if(null==Ne)throw new Error("DOM element provided is null or undefined");return Ne}function isPlotDiv(Ne){var Ge=tt.select(Ne);return Ge.node()instanceof HTMLElement&&Ge.size()&&Ge.classed("js-plotly-plot")}function removeElement(Ne){var Ge=Ne&&Ne.parentNode;Ge&&Ge.removeChild(Ne)}function addStyleRule(Ne,Ge){addRelatedStyleRule("global",Ne,Ge)}function addRelatedStyleRule(Ne,Ge,Qe){var tt="plotly.js-style-"+Ne,nt=document.getElementById(tt);nt||((nt=document.createElement("style")).setAttribute("id",tt),nt.appendChild(document.createTextNode("")),document.head.appendChild(nt));var at=nt.sheet;at.insertRule?at.insertRule(Ge+"{"+Qe+"}",0):at.addRule?at.addRule(Ge,Qe,0):rt.warn("addStyleRule failed")}function deleteRelatedStyleRule(Ne){var Ge="plotly.js-style-"+Ne,Qe=document.getElementById(Ge);Qe&&removeElement(Qe)}function getFullTransformMatrix(Ne){var Ge=getElementAndAncestors(Ne),Qe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];return Ge.forEach((function(Ne){var Ge=getElementTransformMatrix(Ne);if(Ge){var tt=nt.convertCssMatrix(Ge);Qe=at.multiply(Qe,Qe,tt)}})),Qe}function getElementTransformMatrix(Ne){var Ge=window.getComputedStyle(Ne,null),Qe=Ge.getPropertyValue("-webkit-transform")||Ge.getPropertyValue("-moz-transform")||Ge.getPropertyValue("-ms-transform")||Ge.getPropertyValue("-o-transform")||Ge.getPropertyValue("transform");return"none"===Qe?null:Qe.replace("matrix","").replace("3d","").slice(1,-1).split(",").map((function(Ne){return+Ne}))}function getElementAndAncestors(Ne){for(var Ge=[];isTransformableElement(Ne);)Ge.push(Ne),Ne=Ne.parentNode;return Ge}function isTransformableElement(Ne){return Ne&&(Ne instanceof Element||Ne instanceof HTMLElement)}function equalDomRects(Ne,Ge){return Ne&&Ge&&Ne.x===Ge.x&&Ne.y===Ge.y&&Ne.top===Ge.top&&Ne.left===Ge.left&&Ne.right===Ge.right&&Ne.bottom===Ge.bottom}Ge.exports={getGraphDiv:getGraphDiv,isPlotDiv:isPlotDiv,removeElement:removeElement,addStyleRule:addStyleRule,addRelatedStyleRule:addRelatedStyleRule,deleteRelatedStyleRule:deleteRelatedStyleRule,getFullTransformMatrix:getFullTransformMatrix,getElementTransformMatrix:getElementTransformMatrix,getElementAndAncestors:getElementAndAncestors,equalDomRects:equalDomRects}},{"./loggers":782,"./matrix":784,d3:169,"gl-mat4":292}],767:[function(Ne,Ge,Qe){"use strict";var tt=Ne("events").EventEmitter,nt={init:function(Ne){if(Ne._ev instanceof tt)return Ne;var Ge=new tt,Qe=new tt;return Ne._ev=Ge,Ne._internalEv=Qe,Ne.on=Ge.on.bind(Ge),Ne.once=Ge.once.bind(Ge),Ne.removeListener=Ge.removeListener.bind(Ge),Ne.removeAllListeners=Ge.removeAllListeners.bind(Ge),Ne._internalOn=Qe.on.bind(Qe),Ne._internalOnce=Qe.once.bind(Qe),Ne._removeInternalListener=Qe.removeListener.bind(Qe),Ne._removeAllInternalListeners=Qe.removeAllListeners.bind(Qe),Ne.emit=function(tt,nt){void 0!==rt&&rt(Ne).trigger(tt,nt),Ge.emit(tt,nt),Qe.emit(tt,nt)},Ne},triggerHandler:function(Ne,Ge,Qe){var tt,nt;void 0!==rt&&(tt=rt(Ne).triggerHandler(Ge,Qe));var at=Ne._ev;if(!at)return tt;var it,ot=at._events[Ge];if(!ot)return tt;function apply(Ne){return Ne.listener?(at.removeListener(Ge,Ne.listener),Ne.fired?void 0:(Ne.fired=!0,Ne.listener.apply(at,[Qe]))):Ne.apply(at,[Qe])}for(ot=Array.isArray(ot)?ot:[ot],it=0;it<ot.length-1;it++)apply(ot[it]);return nt=apply(ot[it]),void 0!==tt?tt:nt},purge:function(Ne){return delete Ne._ev,delete Ne.on,delete Ne.once,delete Ne.removeListener,delete Ne.removeAllListeners,delete Ne.emit,delete Ne._ev,delete Ne._internalEv,delete Ne._internalOn,delete Ne._internalOnce,delete Ne._removeInternalListener,delete Ne._removeAllInternalListeners,Ne}};Ge.exports=nt},{events:110}],768:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./is_plain_object.js"),rt=Array.isArray;function primitivesLoopSplice(Ne,Ge){var Qe,tt;for(Qe=0;Qe<Ne.length;Qe++){if(null!==(tt=Ne[Qe])&&"object"==typeof tt)return!1;void 0!==tt&&(Ge[Qe]=tt)}return!0}function _extend(Ne,Ge,Qe,nt){var at,it,ot,dt,ht,Dt,Ot=Ne[0],Rt=Ne.length;if(2===Rt&&rt(Ot)&&rt(Ne[1])&&0===Ot.length){if(primitivesLoopSplice(Ne[1],Ot))return Ot;Ot.splice(0,Ot.length)}for(var Zt=1;Zt<Rt;Zt++)for(it in at=Ne[Zt])ot=Ot[it],dt=at[it],nt&&rt(dt)?Ot[it]=dt:Ge&&dt&&(tt(dt)||(ht=rt(dt)))?(ht?(ht=!1,Dt=ot&&rt(ot)?ot:[]):Dt=ot&&tt(ot)?ot:{},Ot[it]=_extend([Dt,dt],Ge,Qe,nt)):(void 0!==dt||Qe)&&(Ot[it]=dt);return Ot}Qe.extendFlat=function(){return _extend(arguments,!1,!1,!1)},Qe.extendDeep=function(){return _extend(arguments,!0,!1,!1)},Qe.extendDeepAll=function(){return _extend(arguments,!0,!0,!1)},Qe.extendDeepNoArrays=function(){return _extend(arguments,!0,!1,!0)}},{"./is_plain_object.js":779}],769:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne){for(var Ge={},Qe=[],tt=0,rt=0;rt<Ne.length;rt++){var nt=Ne[rt];1!==Ge[nt]&&(Ge[nt]=1,Qe[tt++]=nt)}return Qe}},{}],770:[function(Ne,Ge,Qe){"use strict";function baseFilter(Ne){return!0===Ne.visible}function calcDataFilter(Ne){var Ge=Ne[0].trace;return!0===Ge.visible&&0!==Ge._length}function isCalcData(Ne){return Array.isArray(Ne)&&Array.isArray(Ne[0])&&Ne[0][0]&&Ne[0][0].trace}Ge.exports=function(Ne){for(var Ge=isCalcData(Ne)?calcDataFilter:baseFilter,Qe=[],tt=0;tt<Ne.length;tt++){var rt=Ne[tt];Ge(rt)&&Qe.push(rt)}return Qe}},{}],771:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("country-regex"),nt=Ne("@turf/area"),at=Ne("@turf/centroid"),it=Ne("@turf/bbox"),ot=Ne("./identity"),dt=Ne("./loggers"),ht=Ne("./is_plain_object"),Dt=Ne("./nested_property"),Ot=Ne("./polygon"),Rt=Object.keys(rt),Zt={"ISO-3":ot,"USA-states":ot,"country names":countryNameToISO3};function countryNameToISO3(Ne){for(var Ge=0;Ge<Rt.length;Ge++){var Qe=Rt[Ge];if(new RegExp(rt[Qe]).test(Ne.trim().toLowerCase()))return Qe}return dt.log("Unrecognized country name: "+Ne+"."),!1}function locationToFeature(Ne,Ge,Qe){if(!Ge||"string"!=typeof Ge)return!1;var tt,rt,nt,at=Zt[Ne](Ge);if(at){if("USA-states"===Ne)for(tt=[],nt=0;nt<Qe.length;nt++)(rt=Qe[nt]).properties&&rt.properties.gu&&"USA"===rt.properties.gu&&tt.push(rt);else tt=Qe;for(nt=0;nt<tt.length;nt++)if((rt=tt[nt]).id===at)return rt;dt.log(["Location with id",at,"does not have a matching topojson feature at this resolution."].join(" "))}return!1}function feature2polygons(Ne){var Ge,Qe,tt,rt,nt=Ne.geometry,at=nt.coordinates,it=Ne.id,ot=[];function doesCrossAntiMerdian(Ne){for(var Ge=0;Ge<Ne.length-1;Ge++)if(Ne[Ge][0]>0&&Ne[Ge+1][0]<0)return Ge;return null}switch(Ge="RUS"===it||"FJI"===it?function(Ne){var Ge;if(null===doesCrossAntiMerdian(Ne))Ge=Ne;else for(Ge=new Array(Ne.length),rt=0;rt<Ne.length;rt++)Ge[rt]=[Ne[rt][0]<0?Ne[rt][0]+360:Ne[rt][0],Ne[rt][1]];ot.push(Ot.tester(Ge))}:"ATA"===it?function(Ne){var Ge=doesCrossAntiMerdian(Ne);if(null===Ge)return ot.push(Ot.tester(Ne));var Qe=new Array(Ne.length+1),tt=0;for(rt=0;rt<Ne.length;rt++)rt>Ge?Qe[tt++]=[Ne[rt][0]+360,Ne[rt][1]]:rt===Ge?(Qe[tt++]=Ne[rt],Qe[tt++]=[Ne[rt][0],-90]):Qe[tt++]=Ne[rt];var nt=Ot.tester(Qe);nt.pts.pop(),ot.push(nt)}:function(Ne){ot.push(Ot.tester(Ne))},nt.type){case"MultiPolygon":for(Qe=0;Qe<at.length;Qe++)for(tt=0;tt<at[Qe].length;tt++)Ge(at[Qe][tt]);break;case"Polygon":for(Qe=0;Qe<at.length;Qe++)Ge(at[Qe])}return ot}function getTraceGeojson(Ne){var Ge=Ne.geojson,Qe=window.PlotlyGeoAssets||{},tt="string"==typeof Ge?Qe[Ge]:Ge;return ht(tt)?tt:(dt.error("Oops ... something went wrong when fetching "+Ge),!1)}function extractTraceFeature(Ne){var Ge=Ne[0].trace,Qe=getTraceGeojson(Ge);if(!Qe)return!1;var tt,rt={},nt=[];for(tt=0;tt<Ge._length;tt++){var at=Ne[tt];(at.loc||0===at.loc)&&(rt[at.loc]=at)}function appendFeature(Ne){var Qe=Dt(Ne,Ge.featureidkey||"id").get(),tt=rt[Qe];if(tt){var at=Ne.geometry;if("Polygon"===at.type||"MultiPolygon"===at.type){var it={type:"Feature",id:Qe,geometry:at,properties:{}};it.properties.ct=findCentroid(it),tt.fIn=Ne,tt.fOut=it,nt.push(it)}else dt.log(["Location",tt.loc,"does not have a valid GeoJSON geometry.","Traces with locationmode *geojson-id* only support","*Polygon* and *MultiPolygon* geometries."].join(" "))}delete rt[Qe]}switch(Qe.type){case"FeatureCollection":var it=Qe.features;for(tt=0;tt<it.length;tt++)appendFeature(it[tt]);break;case"Feature":appendFeature(Qe);break;default:return dt.warn(["Invalid GeoJSON type",(Qe.type||"none")+".","Traces with locationmode *geojson-id* only support","*FeatureCollection* and *Feature* types."].join(" ")),!1}for(var ot in rt)dt.log(["Location *"+ot+"*","does not have a matching feature with id-key","*"+Ge.featureidkey+"*."].join(" "));return nt}function findCentroid(Ne){var Ge,Qe=Ne.geometry;if("MultiPolygon"===Qe.type)for(var tt=Qe.coordinates,rt=0,it=0;it<tt.length;it++){var ot={type:"Polygon",coordinates:tt[it]},dt=nt.default(ot);dt>rt&&(rt=dt,Ge=ot)}else Ge=Qe;return at.default(Ge).geometry.coordinates}function fetchTraceGeoData(Ne){var Ge=window.PlotlyGeoAssets||{},Qe=[];function fetch(Ne){return new Promise((function(Qe,rt){tt.json(Ne,(function(tt,nt){if(tt){delete Ge[Ne];var at=404===tt.status?'GeoJSON at URL "'+Ne+'" does not exist.':"Unexpected error while fetching from "+Ne;return rt(new Error(at))}return Ge[Ne]=nt,Qe(nt)}))}))}function wait(Ne){return new Promise((function(Qe,tt){var rt=0,nt=setInterval((function(){return Ge[Ne]&&"pending"!==Ge[Ne]?(clearInterval(nt),Qe(Ge[Ne])):rt>100?(clearInterval(nt),tt("Unexpected error while fetching from "+Ne)):void rt++}),50)}))}for(var rt=0;rt<Ne.length;rt++){var nt=Ne[rt][0].trace.geojson;"string"==typeof nt&&(Ge[nt]?"pending"===Ge[nt]&&Qe.push(wait(nt)):(Ge[nt]="pending",Qe.push(fetch(nt))))}return Qe}function computeBbox(Ne){return it.default(Ne)}Ge.exports={locationToFeature:locationToFeature,feature2polygons:feature2polygons,getTraceGeojson:getTraceGeojson,extractTraceFeature:extractTraceFeature,fetchTraceGeoData:fetchTraceGeoData,computeBbox:computeBbox}},{"./identity":776,"./is_plain_object":779,"./loggers":782,"./nested_property":786,"./polygon":790,"@turf/area":59,"@turf/bbox":60,"@turf/centroid":61,"country-regex":139,d3:169}],772:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../constants/numerical").BADNUM;Qe.calcTraceToLineCoords=function(Ne){for(var Ge=Ne[0].trace.connectgaps,Qe=[],rt=[],nt=0;nt<Ne.length;nt++){var at=Ne[nt].lonlat;at[0]!==tt?rt.push(at):!Ge&&rt.length>0&&(Qe.push(rt),rt=[])}return rt.length>0&&Qe.push(rt),Qe},Qe.makeLine=function(Ne){return 1===Ne.length?{type:"LineString",coordinates:Ne[0]}:{type:"MultiLineString",coordinates:Ne}},Qe.makePolygon=function(Ne){if(1===Ne.length)return{type:"Polygon",coordinates:Ne};for(var Ge=new Array(Ne.length),Qe=0;Qe<Ne.length;Qe++)Ge[Qe]=[Ne[Qe]];return{type:"MultiPolygon",coordinates:Ge}},Qe.makeBlank=function(){return{type:"Point",coordinates:[]}}},{"../constants/numerical":753}],773:[function(Ne,Ge,Qe){"use strict";var tt,rt,nt,at=Ne("./mod").mod;function segmentsIntersect(Ne,Ge,Qe,tt,rt,nt,at,it){var ot=Qe-Ne,dt=rt-Ne,ht=at-rt,Dt=tt-Ge,Ot=nt-Ge,Rt=it-nt,Zt=ot*Rt-ht*Dt;if(0===Zt)return null;var er=(dt*Rt-ht*Ot)/Zt,dr=(dt*Dt-ot*Ot)/Zt;return dr<0||dr>1||er<0||er>1?null:{x:Ne+ot*er,y:Ge+Dt*er}}function perpDistance2(Ne,Ge,Qe,tt,rt){var nt=tt*Ne+rt*Ge;if(nt<0)return tt*tt+rt*rt;if(nt>Qe){var at=tt-Ne,it=rt-Ge;return at*at+it*it}var ot=tt*Ge-rt*Ne;return ot*ot/Qe}Qe.segmentsIntersect=segmentsIntersect,Qe.segmentDistance=function(Ne,Ge,Qe,tt,rt,nt,at,it){if(segmentsIntersect(Ne,Ge,Qe,tt,rt,nt,at,it))return 0;var ot=Qe-Ne,dt=tt-Ge,ht=at-rt,Dt=it-nt,Ot=ot*ot+dt*dt,Rt=ht*ht+Dt*Dt,Zt=Math.min(perpDistance2(ot,dt,Ot,rt-Ne,nt-Ge),perpDistance2(ot,dt,Ot,at-Ne,it-Ge),perpDistance2(ht,Dt,Rt,Ne-rt,Ge-nt),perpDistance2(ht,Dt,Rt,Qe-rt,tt-nt));return Math.sqrt(Zt)},Qe.getTextLocation=function(Ne,Ge,Qe,it){if(Ne===rt&&it===nt||(tt={},rt=Ne,nt=it),tt[Qe])return tt[Qe];var ot=Ne.getPointAtLength(at(Qe-it/2,Ge)),dt=Ne.getPointAtLength(at(Qe+it/2,Ge)),ht=Math.atan((dt.y-ot.y)/(dt.x-ot.x)),Dt=Ne.getPointAtLength(at(Qe,Ge)),Ot={x:(4*Dt.x+ot.x+dt.x)/6,y:(4*Dt.y+ot.y+dt.y)/6,theta:ht};return tt[Qe]=Ot,Ot},Qe.clearLocationCache=function(){rt=null},Qe.getVisibleSegment=function(Ne,Ge,Qe){var tt,rt,nt=Ge.left,at=Ge.right,it=Ge.top,ot=Ge.bottom,dt=0,ht=Ne.getTotalLength(),Dt=ht;function getDistToPlot(Ge){var Qe=Ne.getPointAtLength(Ge);0===Ge?tt=Qe:Ge===ht&&(rt=Qe);var dt=Qe.x<nt?nt-Qe.x:Qe.x>at?Qe.x-at:0,Dt=Qe.y<it?it-Qe.y:Qe.y>ot?Qe.y-ot:0;return Math.sqrt(dt*dt+Dt*Dt)}for(var Ot=getDistToPlot(dt);Ot;){if((dt+=Ot+Qe)>Dt)return;Ot=getDistToPlot(dt)}for(Ot=getDistToPlot(Dt);Ot;){if(dt>(Dt-=Ot+Qe))return;Ot=getDistToPlot(Dt)}return{min:dt,max:Dt,len:Dt-dt,total:ht,isClosed:0===dt&&Dt===ht&&Math.abs(tt.x-rt.x)<.1&&Math.abs(tt.y-rt.y)<.1}},Qe.findPointOnPath=function(Ne,Ge,Qe,tt){for(var rt,nt,at,it=(tt=tt||{}).pathLength||Ne.getTotalLength(),ot=tt.tolerance||.001,dt=tt.iterationLimit||30,ht=Ne.getPointAtLength(0)[Qe]>Ne.getPointAtLength(it)[Qe]?-1:1,Dt=0,Ot=0,Rt=it;Dt<dt;){if(rt=(Ot+Rt)/2,at=(nt=Ne.getPointAtLength(rt))[Qe]-Ge,Math.abs(at)<ot)return nt;ht*at>0?Rt=rt:Ot=rt,Dt++}return nt}},{"./mod":785}],774:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("tinycolor2"),nt=Ne("color-normalize"),at=Ne("../components/colorscale"),it=Ne("../components/color/attributes").defaultLine,ot=Ne("./array").isArrayOrTypedArray,dt=nt(it),ht=1;function calculateColor(Ne,Ge){var Qe=Ne;return Qe[3]*=Ge,Qe}function validateColor(Ne){if(tt(Ne))return dt;var Ge=nt(Ne);return Ge.length?Ge:dt}function validateOpacity(Ne){return tt(Ne)?Ne:ht}function formatColor(Ne,Ge,Qe){var tt,rt,it,Dt,Ot,Rt=Ne.color,Zt=ot(Rt),er=ot(Ge),dr=at.extractOpts(Ne),mr=[];if(tt=void 0!==dr.colorscale?at.makeColorScaleFuncFromTrace(Ne):validateColor,rt=Zt?function(Ne,Ge){return void 0===Ne[Ge]?dt:nt(tt(Ne[Ge]))}:validateColor,it=er?function(Ne,Ge){return void 0===Ne[Ge]?ht:validateOpacity(Ne[Ge])}:validateOpacity,Zt||er)for(var xr=0;xr<Qe;xr++)Dt=rt(Rt,xr),Ot=it(Ge,xr),mr[xr]=calculateColor(Dt,Ot);else mr=calculateColor(nt(Rt),Ge);return mr}function parseColorScale(Ne){var Ge=at.extractOpts(Ne),Qe=Ge.colorscale;return Ge.reversescale&&(Qe=at.flipScale(Ge.colorscale)),Qe.map((function(Ne){var Ge=Ne[0],Qe=rt(Ne[1]).toRgb();return{index:Ge,rgb:[Qe.r,Qe.g,Qe.b,Qe.a]}}))}Ge.exports={formatColor:formatColor,parseColorScale:parseColorScale}},{"../components/color/attributes":642,"../components/colorscale":655,"./array":760,"color-normalize":125,"fast-isnumeric":241,tinycolor2:576}],775:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./identity");function wrap(Ne){return[Ne]}Ge.exports={keyFun:function(Ne){return Ne.key},repeat:wrap,descend:tt,wrap:wrap,unwrap:function(Ne){return Ne[0]}}},{"./identity":776}],776:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne){return Ne}},{}],777:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge){if(!Ge)return Ne;var Qe=1/Math.abs(Ge),tt=Qe>1?(Qe*Ne+Qe*Ge)/Qe:Ne+Ge,rt=String(tt).length;if(rt>16){var nt=String(Ge).length;if(rt>=String(Ne).length+nt){var at=parseFloat(tt).toPrecision(12);-1===at.indexOf("e+")&&(tt=+at)}}return tt}},{}],778:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("d3-time-format").utcFormat,nt=Ne("fast-isnumeric"),at=Ne("../constants/numerical"),it=at.FP_SAFE,ot=at.BADNUM,dt=Ge.exports={};dt.nestedProperty=Ne("./nested_property"),dt.keyedContainer=Ne("./keyed_container"),dt.relativeAttr=Ne("./relative_attr"),dt.isPlainObject=Ne("./is_plain_object"),dt.toLogRange=Ne("./to_log_range"),dt.relinkPrivateKeys=Ne("./relink_private");var ht=Ne("./array");dt.isTypedArray=ht.isTypedArray,dt.isArrayOrTypedArray=ht.isArrayOrTypedArray,dt.isArray1D=ht.isArray1D,dt.ensureArray=ht.ensureArray,dt.concat=ht.concat,dt.maxRowLength=ht.maxRowLength,dt.minRowLength=ht.minRowLength;var Dt=Ne("./mod");dt.mod=Dt.mod,dt.modHalf=Dt.modHalf;var Ot=Ne("./coerce");dt.valObjectMeta=Ot.valObjectMeta,dt.coerce=Ot.coerce,dt.coerce2=Ot.coerce2,dt.coerceFont=Ot.coerceFont,dt.coerceHoverinfo=Ot.coerceHoverinfo,dt.coerceSelectionMarkerOpacity=Ot.coerceSelectionMarkerOpacity,dt.validate=Ot.validate;var Rt=Ne("./dates");dt.dateTime2ms=Rt.dateTime2ms,dt.isDateTime=Rt.isDateTime,dt.ms2DateTime=Rt.ms2DateTime,dt.ms2DateTimeLocal=Rt.ms2DateTimeLocal,dt.cleanDate=Rt.cleanDate,dt.isJSDate=Rt.isJSDate,dt.formatDate=Rt.formatDate,dt.incrementMonth=Rt.incrementMonth,dt.dateTick0=Rt.dateTick0,dt.dfltRange=Rt.dfltRange,dt.findExactDates=Rt.findExactDates,dt.MIN_MS=Rt.MIN_MS,dt.MAX_MS=Rt.MAX_MS;var Zt=Ne("./search");dt.findBin=Zt.findBin,dt.sorterAsc=Zt.sorterAsc,dt.sorterDes=Zt.sorterDes,dt.distinctVals=Zt.distinctVals,dt.roundUp=Zt.roundUp,dt.sort=Zt.sort,dt.findIndexOfMin=Zt.findIndexOfMin;var er=Ne("./stats");dt.aggNums=er.aggNums,dt.len=er.len,dt.mean=er.mean,dt.median=er.median,dt.midRange=er.midRange,dt.variance=er.variance,dt.stdev=er.stdev,dt.interp=er.interp;var dr=Ne("./matrix");dt.init2dArray=dr.init2dArray,dt.transposeRagged=dr.transposeRagged,dt.dot=dr.dot,dt.translationMatrix=dr.translationMatrix,dt.rotationMatrix=dr.rotationMatrix,dt.rotationXYMatrix=dr.rotationXYMatrix,dt.apply3DTransform=dr.apply3DTransform,dt.apply2DTransform=dr.apply2DTransform,dt.apply2DTransform2=dr.apply2DTransform2,dt.convertCssMatrix=dr.convertCssMatrix,dt.inverseTransformMatrix=dr.inverseTransformMatrix;var mr=Ne("./angles");dt.deg2rad=mr.deg2rad,dt.rad2deg=mr.rad2deg,dt.angleDelta=mr.angleDelta,dt.angleDist=mr.angleDist,dt.isFullCircle=mr.isFullCircle,dt.isAngleInsideSector=mr.isAngleInsideSector,dt.isPtInsideSector=mr.isPtInsideSector,dt.pathArc=mr.pathArc,dt.pathSector=mr.pathSector,dt.pathAnnulus=mr.pathAnnulus;var xr=Ne("./anchor_utils");dt.isLeftAnchor=xr.isLeftAnchor,dt.isCenterAnchor=xr.isCenterAnchor,dt.isRightAnchor=xr.isRightAnchor,dt.isTopAnchor=xr.isTopAnchor,dt.isMiddleAnchor=xr.isMiddleAnchor,dt.isBottomAnchor=xr.isBottomAnchor;var br=Ne("./geometry2d");dt.segmentsIntersect=br.segmentsIntersect,dt.segmentDistance=br.segmentDistance,dt.getTextLocation=br.getTextLocation,dt.clearLocationCache=br.clearLocationCache,dt.getVisibleSegment=br.getVisibleSegment,dt.findPointOnPath=br.findPointOnPath;var Ar=Ne("./extend");dt.extendFlat=Ar.extendFlat,dt.extendDeep=Ar.extendDeep,dt.extendDeepAll=Ar.extendDeepAll,dt.extendDeepNoArrays=Ar.extendDeepNoArrays;var en=Ne("./loggers");dt.log=en.log,dt.warn=en.warn,dt.error=en.error;var mn=Ne("./regex");dt.counterRegex=mn.counter;var xn=Ne("./throttle");dt.throttle=xn.throttle,dt.throttleDone=xn.done,dt.clearThrottle=xn.clear;var kn=Ne("./dom");function makePtIndex2PtNumber(Ne){var Ge={};for(var Qe in Ne)for(var tt=Ne[Qe],rt=0;rt<tt.length;rt++)Ge[tt[rt]]=+Qe;return Ge}dt.getGraphDiv=kn.getGraphDiv,dt.isPlotDiv=kn.isPlotDiv,dt.removeElement=kn.removeElement,dt.addStyleRule=kn.addStyleRule,dt.addRelatedStyleRule=kn.addRelatedStyleRule,dt.deleteRelatedStyleRule=kn.deleteRelatedStyleRule,dt.getFullTransformMatrix=kn.getFullTransformMatrix,dt.getElementTransformMatrix=kn.getElementTransformMatrix,dt.getElementAndAncestors=kn.getElementAndAncestors,dt.equalDomRects=kn.equalDomRects,dt.clearResponsive=Ne("./clear_responsive"),dt.preserveDrawingBuffer=Ne("./preserve_drawing_buffer"),dt.makeTraceGroups=Ne("./make_trace_groups"),dt._=Ne("./localize"),dt.notifier=Ne("./notifier"),dt.filterUnique=Ne("./filter_unique"),dt.filterVisible=Ne("./filter_visible"),dt.pushUnique=Ne("./push_unique"),dt.increment=Ne("./increment"),dt.cleanNumber=Ne("./clean_number"),dt.ensureNumber=function(Ne){return nt(Ne)?(Ne=Number(Ne))<-it||Ne>it?ot:nt(Ne)?Number(Ne):ot:ot},dt.isIndex=function(Ne,Ge){return!(void 0!==Ge&&Ne>=Ge)&&nt(Ne)&&Ne>=0&&Ne%1==0},dt.noop=Ne("./noop"),dt.identity=Ne("./identity"),dt.repeat=function(Ne,Ge){for(var Qe=new Array(Ge),tt=0;tt<Ge;tt++)Qe[tt]=Ne;return Qe},dt.swapAttrs=function(Ne,Ge,Qe,tt){Qe||(Qe="x"),tt||(tt="y");for(var rt=0;rt<Ge.length;rt++){var nt=Ge[rt],at=dt.nestedProperty(Ne,nt.replace("?",Qe)),it=dt.nestedProperty(Ne,nt.replace("?",tt)),ot=at.get();at.set(it.get()),it.set(ot)}},dt.raiseToTop=function(Ne){Ne.parentNode.appendChild(Ne)},dt.cancelTransition=function(Ne){return Ne.transition().duration(0)},dt.constrain=function(Ne,Ge,Qe){return Ge>Qe?Math.max(Qe,Math.min(Ge,Ne)):Math.max(Ge,Math.min(Qe,Ne))},dt.bBoxIntersect=function(Ne,Ge,Qe){return Qe=Qe||0,Ne.left<=Ge.right+Qe&&Ge.left<=Ne.right+Qe&&Ne.top<=Ge.bottom+Qe&&Ge.top<=Ne.bottom+Qe},dt.simpleMap=function(Ne,Ge,Qe,tt,rt){for(var nt=Ne.length,at=new Array(nt),it=0;it<nt;it++)at[it]=Ge(Ne[it],Qe,tt,rt);return at},dt.randstr=function randstr(Ne,Ge,Qe,tt){if(Qe||(Qe=16),void 0===Ge&&(Ge=24),Ge<=0)return"0";var rt,nt,at=Math.log(Math.pow(2,Ge))/Math.log(Qe),it="";for(rt=2;at===1/0;rt*=2)at=Math.log(Math.pow(2,Ge/rt))/Math.log(Qe)*rt;var ot=at-Math.floor(at);for(rt=0;rt<Math.floor(at);rt++)it=Math.floor(Math.random()*Qe).toString(Qe)+it;ot&&(nt=Math.pow(Qe,ot),it=Math.floor(Math.random()*nt).toString(Qe)+it);var ht=parseInt(it,Qe);return Ne&&Ne[it]||ht!==1/0&&ht>=Math.pow(2,Ge)?tt>10?(dt.warn("randstr failed uniqueness"),it):randstr(Ne,Ge,Qe,(tt||0)+1):it},dt.OptionControl=function(Ne,Ge){Ne||(Ne={}),Ge||(Ge="opt");var Qe={optionList:[],_newoption:function(tt){tt[Ge]=Ne,Qe[tt.name]=tt,Qe.optionList.push(tt)}};return Qe["_"+Ge]=Ne,Qe},dt.smooth=function(Ne,Ge){if((Ge=Math.round(Ge)||0)<2)return Ne;var Qe,tt,rt,nt,at=Ne.length,it=2*at,ot=2*Ge-1,dt=new Array(ot),ht=new Array(at);for(Qe=0;Qe<ot;Qe++)dt[Qe]=(1-Math.cos(Math.PI*(Qe+1)/Ge))/(2*Ge);for(Qe=0;Qe<at;Qe++){for(nt=0,tt=0;tt<ot;tt++)(rt=Qe+tt+1-Ge)<-at?rt-=it*Math.round(rt/it):rt>=it&&(rt-=it*Math.floor(rt/it)),rt<0?rt=-1-rt:rt>=at&&(rt=it-1-rt),nt+=Ne[rt]*dt[tt];ht[Qe]=nt}return ht},dt.syncOrAsync=function(Ne,Ge,Qe){var tt;function continueAsync(){return dt.syncOrAsync(Ne,Ge,Qe)}for(;Ne.length;)if((tt=(0,Ne.splice(0,1)[0])(Ge))&&tt.then)return tt.then(continueAsync).then(void 0,dt.promiseError);return Qe&&Qe(Ge)},dt.stripTrailingSlash=function(Ne){return"/"===Ne.substr(-1)?Ne.substr(0,Ne.length-1):Ne},dt.noneOrAll=function(Ne,Ge,Qe){if(Ne){var tt,rt=!1,nt=!0;for(tt=0;tt<Qe.length;tt++)null!=Ne[Qe[tt]]?rt=!0:nt=!1;if(rt&&!nt)for(tt=0;tt<Qe.length;tt++)Ne[Qe[tt]]=Ge[Qe[tt]]}},dt.mergeArray=function(Ne,Ge,Qe,tt){var rt="function"==typeof tt;if(dt.isArrayOrTypedArray(Ne))for(var nt=Math.min(Ne.length,Ge.length),at=0;at<nt;at++){var it=Ne[at];Ge[at][Qe]=rt?tt(it):it}},dt.mergeArrayCastPositive=function(Ne,Ge,Qe){return dt.mergeArray(Ne,Ge,Qe,(function(Ne){var Ge=+Ne;return isFinite(Ge)&&Ge>0?Ge:0}))},dt.fillArray=function(Ne,Ge,Qe,tt){if(tt=tt||dt.identity,dt.isArrayOrTypedArray(Ne))for(var rt=0;rt<Ge.length;rt++)Ge[rt][Qe]=tt(Ne[rt])},dt.castOption=function(Ne,Ge,Qe,tt){tt=tt||dt.identity;var rt=dt.nestedProperty(Ne,Qe).get();return dt.isArrayOrTypedArray(rt)?Array.isArray(Ge)&&dt.isArrayOrTypedArray(rt[Ge[0]])?tt(rt[Ge[0]][Ge[1]]):tt(rt[Ge]):rt},dt.extractOption=function(Ne,Ge,Qe,tt){if(Qe in Ne)return Ne[Qe];var rt=dt.nestedProperty(Ge,tt).get();return Array.isArray(rt)?void 0:rt},dt.tagSelected=function(Ne,Ge,Qe){var tt,rt=Ge.selectedpoints,nt=Ge._indexToPoints;function isCdIndexValid(Ge){return void 0!==Ge&&Ge<Ne.length}nt&&(tt=makePtIndex2PtNumber(nt));for(var at=0;at<rt.length;at++){var it=rt[at];if(dt.isIndex(it)||dt.isArrayOrTypedArray(it)&&dt.isIndex(it[0])&&dt.isIndex(it[1])){var ot=tt?tt[it]:it,ht=Qe?Qe[ot]:ot;isCdIndexValid(ht)&&(Ne[ht].selected=1)}}},dt.selIndices2selPoints=function(Ne){var Ge=Ne.selectedpoints,Qe=Ne._indexToPoints;if(Qe){for(var tt=makePtIndex2PtNumber(Qe),rt=[],nt=0;nt<Ge.length;nt++){var at=Ge[nt];if(dt.isIndex(at)){var it=tt[at];dt.isIndex(it)&&rt.push(it)}}return rt}return Ge},dt.getTargetArray=function(Ne,Ge){var Qe=Ge.target;if("string"==typeof Qe&&Qe){var tt=dt.nestedProperty(Ne,Qe).get();return!!Array.isArray(tt)&&tt}return!!Array.isArray(Qe)&&Qe},dt.minExtend=function(Ne,Ge){var Qe={};"object"!=typeof Ge&&(Ge={});var tt,rt,nt,at=3,it=Object.keys(Ne);for(tt=0;tt<it.length;tt++)nt=Ne[rt=it[tt]],"_"!==rt.charAt(0)&&"function"!=typeof nt&&("module"===rt?Qe[rt]=nt:Array.isArray(nt)?Qe[rt]="colorscale"===rt?nt.slice():nt.slice(0,at):dt.isTypedArray(nt)?Qe[rt]=nt.subarray(0,at):Qe[rt]=nt&&"object"==typeof nt?dt.minExtend(Ne[rt],Ge[rt]):nt);for(it=Object.keys(Ge),tt=0;tt<it.length;tt++)"object"==typeof(nt=Ge[rt=it[tt]])&&rt in Qe&&"object"==typeof Qe[rt]||(Qe[rt]=nt);return Qe},dt.titleCase=function(Ne){return Ne.charAt(0).toUpperCase()+Ne.substr(1)},dt.containsAny=function(Ne,Ge){for(var Qe=0;Qe<Ge.length;Qe++)if(-1!==Ne.indexOf(Ge[Qe]))return!0;return!1},dt.isIE=function(){return void 0!==window.navigator.msSaveBlob};var Cn=/MSIE [1-9]\./;dt.isIE9orBelow=function(){return dt.isIE()&&Cn.test(window.navigator.userAgent)};var En=/Version\/[\d\.]+.*Safari/;dt.isSafari=function(){return En.test(window.navigator.userAgent)};var Pn=/iPad|iPhone|iPod/;dt.isIOS=function(){return Pn.test(window.navigator.userAgent)},dt.isD3Selection=function(Ne){return Ne&&"function"==typeof Ne.classed},dt.ensureSingle=function(Ne,Ge,Qe,tt){var rt=Ne.select(Ge+(Qe?"."+Qe:""));if(rt.size())return rt;var nt=Ne.append(Ge);return Qe&&nt.classed(Qe,!0),tt&&nt.call(tt),nt},dt.ensureSingleById=function(Ne,Ge,Qe,tt){var rt=Ne.select(Ge+"#"+Qe);if(rt.size())return rt;var nt=Ne.append(Ge).attr("id",Qe);return tt&&nt.call(tt),nt},dt.objectFromPath=function(Ne,Ge){for(var Qe,tt=Ne.split("."),rt=Qe={},nt=0;nt<tt.length;nt++){var at=tt[nt],it=null,ot=tt[nt].match(/(.*)\[([0-9]+)\]/);ot?(at=ot[1],it=ot[2],Qe=Qe[at]=[],nt===tt.length-1?Qe[it]=Ge:Qe[it]={},Qe=Qe[it]):(nt===tt.length-1?Qe[at]=Ge:Qe[at]={},Qe=Qe[at])}return rt};var Dn=/^([^\[\.]+)\.(.+)?/,In=/^([^\.]+)\[([0-9]+)\](\.)?(.+)?/;dt.expandObjectPaths=function(Ne){var Ge,Qe,tt,rt,nt,at,it;if("object"==typeof Ne&&!Array.isArray(Ne))for(Qe in Ne)Ne.hasOwnProperty(Qe)&&((Ge=Qe.match(Dn))?(rt=Ne[Qe],tt=Ge[1],delete Ne[Qe],Ne[tt]=dt.extendDeepNoArrays(Ne[tt]||{},dt.objectFromPath(Qe,dt.expandObjectPaths(rt))[tt])):(Ge=Qe.match(In))?(rt=Ne[Qe],tt=Ge[1],nt=parseInt(Ge[2]),delete Ne[Qe],Ne[tt]=Ne[tt]||[],"."===Ge[3]?(it=Ge[4],at=Ne[tt][nt]=Ne[tt][nt]||{},dt.extendDeepNoArrays(at,dt.objectFromPath(it,dt.expandObjectPaths(rt)))):Ne[tt][nt]=dt.expandObjectPaths(rt)):Ne[Qe]=dt.expandObjectPaths(Ne[Qe]));return Ne},dt.numSeparate=function(Ne,Ge,Qe){if(Qe||(Qe=!1),"string"!=typeof Ge||0===Ge.length)throw new Error("Separator string required for formatting!");"number"==typeof Ne&&(Ne=String(Ne));var tt=/(\d+)(\d{3})/,rt=Ge.charAt(0),nt=Ge.charAt(1),at=Ne.split("."),it=at[0],ot=at.length>1?rt+at[1]:"";if(nt&&(at.length>1||it.length>4||Qe))for(;tt.test(it);)it=it.replace(tt,"$1"+nt+"$2");return it+ot},dt.TEMPLATE_STRING_REGEX=/%{([^\s%{}:]*)([:|\|][^}]*)?}/g;var zn=/^\w*$/;dt.templateString=function(Ne,Ge){var Qe={};return Ne.replace(dt.TEMPLATE_STRING_REGEX,(function(Ne,tt){var rt;return zn.test(tt)?rt=Ge[tt]:(Qe[tt]=Qe[tt]||dt.nestedProperty(Ge,tt).get,rt=Qe[tt]()),dt.isValidTextValue(rt)?rt:""}))};var Bn={max:10,count:0,name:"hovertemplate"};dt.hovertemplateString=function(){return templateFormatString.apply(Bn,arguments)};var Vn={max:10,count:0,name:"texttemplate"};dt.texttemplateString=function(){return templateFormatString.apply(Vn,arguments)};var Hn=/^[:|\|]/;function templateFormatString(Ne,Ge,Qe){var nt=this,at=arguments;Ge||(Ge={});var it={};return Ne.replace(dt.TEMPLATE_STRING_REGEX,(function(Ne,ot,ht){var Dt,Ot,Rt,Zt;for(Rt=3;Rt<at.length;Rt++)if(Dt=at[Rt]){if(Dt.hasOwnProperty(ot)){Ot=Dt[ot];break}if(zn.test(ot)||(Ot=it[ot]||dt.nestedProperty(Dt,ot).get())&&(it[ot]=Ot),void 0!==Ot)break}if(void 0===Ot&&nt)return nt.count<nt.max&&(dt.warn("Variable '"+ot+"' in "+nt.name+" could not be found!"),Ot=Ne),nt.count===nt.max&&dt.warn("Too many "+nt.name+" warnings - additional warnings will be suppressed"),nt.count++,Ne;if(ht){if(":"===ht[0]&&(Ot=(Zt=Qe?Qe.numberFormat:tt.format)(ht.replace(Hn,""))(Ot)),"|"===ht[0]){Zt=Qe?Qe.timeFormat:rt;var er=dt.dateTime2ms(Ot);Ot=dt.formatDate(er,ht.replace(Hn,""),!1,Zt)}}else Ge.hasOwnProperty(ot+"Label")&&(Ot=Ge[ot+"Label"]);return Ot}))}var qn=48,Yn=57;dt.subplotSort=function(Ne,Ge){for(var Qe=Math.min(Ne.length,Ge.length)+1,tt=0,rt=0,nt=0;nt<Qe;nt++){var at=Ne.charCodeAt(nt)||0,it=Ge.charCodeAt(nt)||0,ot=at>=qn&&at<=Yn,dt=it>=qn&&it<=Yn;if(ot&&(tt=10*tt+at-qn),dt&&(rt=10*rt+it-qn),!ot||!dt){if(tt!==rt)return tt-rt;if(at!==it)return at-it}}return rt-tt};var $n=2e9;dt.seedPseudoRandom=function(){$n=2e9},dt.pseudoRandom=function(){var Ne=$n;return $n=(69069*$n+1)%4294967296,Math.abs($n-Ne)<429496729?dt.pseudoRandom():$n/4294967296},dt.fillText=function(Ne,Ge,Qe){var tt=Array.isArray(Qe)?function(Ne){Qe.push(Ne)}:function(Ne){Qe.text=Ne},rt=dt.extractOption(Ne,Ge,"htx","hovertext");if(dt.isValidTextValue(rt))return tt(rt);var nt=dt.extractOption(Ne,Ge,"tx","text");return dt.isValidTextValue(nt)?tt(nt):void 0},dt.isValidTextValue=function(Ne){return Ne||0===Ne},dt.formatPercent=function(Ne,Ge){Ge=Ge||0;for(var Qe=(Math.round(100*Ne*Math.pow(10,Ge))*Math.pow(.1,Ge)).toFixed(Ge)+"%",tt=0;tt<Ge;tt++)-1!==Qe.indexOf(".")&&(Qe=(Qe=Qe.replace("0%","%")).replace(".%","%"));return Qe},dt.isHidden=function(Ne){var Ge=window.getComputedStyle(Ne).display;return!Ge||"none"===Ge},dt.strTranslate=function(Ne,Ge){return Ne||Ge?"translate("+Ne+","+Ge+")":""},dt.strRotate=function(Ne){return Ne?"rotate("+Ne+")":""},dt.strScale=function(Ne){return 1!==Ne?"scale("+Ne+")":""},dt.getTextTransform=function(Ne){var Ge=Ne.noCenter,Qe=Ne.textX,tt=Ne.textY,rt=Ne.targetX,nt=Ne.targetY,at=Ne.anchorX||0,it=Ne.anchorY||0,ot=Ne.rotate,ht=Ne.scale;return ht?ht>1&&(ht=1):ht=0,dt.strTranslate(rt-ht*(Qe+at),nt-ht*(tt+it))+dt.strScale(ht)+(ot?"rotate("+ot+(Ge?"":" "+Qe+" "+tt)+")":"")},dt.ensureUniformFontSize=function(Ne,Ge){var Qe=dt.extendFlat({},Ge);return Qe.size=Math.max(Ge.size,Ne._fullLayout.uniformtext.minsize||0),Qe},dt.join2=function(Ne,Ge,Qe){var tt=Ne.length;return tt>1?Ne.slice(0,-1).join(Ge)+Qe+Ne[tt-1]:Ne.join(Ge)}},{"../constants/numerical":753,"./anchor_utils":758,"./angles":759,"./array":760,"./clean_number":761,"./clear_responsive":763,"./coerce":764,"./dates":765,"./dom":766,"./extend":768,"./filter_unique":769,"./filter_visible":770,"./geometry2d":773,"./identity":776,"./increment":777,"./is_plain_object":779,"./keyed_container":780,"./localize":781,"./loggers":782,"./make_trace_groups":783,"./matrix":784,"./mod":785,"./nested_property":786,"./noop":787,"./notifier":788,"./preserve_drawing_buffer":792,"./push_unique":793,"./regex":795,"./relative_attr":796,"./relink_private":797,"./search":798,"./stats":801,"./throttle":804,"./to_log_range":805,d3:169,"d3-time-format":166,"fast-isnumeric":241}],779:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne){return window&&window.process&&window.process.versions?"[object Object]"===Object.prototype.toString.call(Ne):"[object Object]"===Object.prototype.toString.call(Ne)&&Object.getPrototypeOf(Ne)===Object.prototype}},{}],780:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./nested_property"),rt=/^\w*$/,nt=0,at=1,it=2,ot=3,dt=4;Ge.exports=function(Ne,Ge,Qe,ht){var Dt,Ot,Rt;Qe=Qe||"name",ht=ht||"value";var Zt={};Ge&&Ge.length?(Rt=tt(Ne,Ge),Ot=Rt.get()):Ot=Ne,Ge=Ge||"";var er={};if(Ot)for(Dt=0;Dt<Ot.length;Dt++)er[Ot[Dt][Qe]]=Dt;var dr=rt.test(ht),mr={set:function(Ne,Ge){var rt=null===Ge?dt:nt;if(!Ot){if(!Rt||rt===dt)return;Ot=[],Rt.set(Ot)}var at=er[Ne];if(void 0===at){if(rt===dt)return;rt|=ot,at=Ot.length,er[Ne]=at}else Ge!==(dr?Ot[at][ht]:tt(Ot[at],ht).get())&&(rt|=it);var Dt=Ot[at]=Ot[at]||{};return Dt[Qe]=Ne,dr?Dt[ht]=Ge:tt(Dt,ht).set(Ge),null!==Ge&&(rt&=~dt),Zt[at]=Zt[at]|rt,mr},get:function(Ne){if(Ot){var Ge=er[Ne];return void 0===Ge?void 0:dr?Ot[Ge][ht]:tt(Ot[Ge],ht).get()}},rename:function(Ne,Ge){var tt=er[Ne];return void 0===tt||(Zt[tt]=Zt[tt]|at,er[Ge]=tt,delete er[Ne],Ot[tt][Qe]=Ge),mr},remove:function(Ne){var Ge=er[Ne];if(void 0===Ge)return mr;var rt=Ot[Ge];if(Object.keys(rt).length>2)return Zt[Ge]=Zt[Ge]|it,mr.set(Ne,null);if(dr){for(Dt=Ge;Dt<Ot.length;Dt++)Zt[Dt]=Zt[Dt]|ot;for(Dt=Ge;Dt<Ot.length;Dt++)er[Ot[Dt][Qe]]--;Ot.splice(Ge,1),delete er[Ne]}else tt(rt,ht).set(null),Zt[Ge]=Zt[Ge]|it|dt;return mr},constructUpdate:function(){for(var Ne,rt,nt={},ot=Object.keys(Zt),Dt=0;Dt<ot.length;Dt++)rt=ot[Dt],Ne=Ge+"["+rt+"]",Ot[rt]?(Zt[rt]&at&&(nt[Ne+"."+Qe]=Ot[rt][Qe]),Zt[rt]&it&&(nt[Ne+"."+ht]=dr?Zt[rt]&dt?null:Ot[rt][ht]:Zt[rt]&dt?null:tt(Ot[rt],ht).get())):nt[Ne]=null;return nt}};return mr}},{"./nested_property":786}],781:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../registry");Ge.exports=function(Ne,Ge){for(var Qe=Ne._context.locale,rt=0;rt<2;rt++){for(var nt=Ne._context.locales,at=0;at<2;at++){var it=(nt[Qe]||{}).dictionary;if(it){var ot=it[Ge];if(ot)return ot}nt=tt.localeRegistry}var dt=Qe.split("-")[0];if(dt===Qe)break;Qe=dt}return Ge}},{"../registry":911}],782:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../plot_api/plot_config").dfltConfig,rt=Ne("./notifier"),nt=Ge.exports={};function apply(Ne,Ge){if(Ne&&Ne.apply)try{return void Ne.apply(console,Ge)}catch(Ne){}for(var Qe=0;Qe<Ge.length;Qe++)try{Ne(Ge[Qe])}catch(Ne){console.log(Ge[Qe])}}nt.log=function(){var Ne;if(tt.logging>1){var Ge=["LOG:"];for(Ne=0;Ne<arguments.length;Ne++)Ge.push(arguments[Ne]);apply(console.trace||console.log,Ge)}if(tt.notifyOnLogging>1){var Qe=[];for(Ne=0;Ne<arguments.length;Ne++)Qe.push(arguments[Ne]);rt(Qe.join("<br>"),"long")}},nt.warn=function(){var Ne;if(tt.logging>0){var Ge=["WARN:"];for(Ne=0;Ne<arguments.length;Ne++)Ge.push(arguments[Ne]);apply(console.trace||console.log,Ge)}if(tt.notifyOnLogging>0){var Qe=[];for(Ne=0;Ne<arguments.length;Ne++)Qe.push(arguments[Ne]);rt(Qe.join("<br>"),"stick")}},nt.error=function(){var Ne;if(tt.logging>0){var Ge=["ERROR:"];for(Ne=0;Ne<arguments.length;Ne++)Ge.push(arguments[Ne]);apply(console.error,Ge)}if(tt.notifyOnLogging>0){var Qe=[];for(Ne=0;Ne<arguments.length;Ne++)Qe.push(arguments[Ne]);rt(Qe.join("<br>"),"stick")}}},{"../plot_api/plot_config":815,"./notifier":788}],783:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3");Ge.exports=function(Ne,Ge,Qe){var rt=Ne.selectAll("g."+Qe.replace(/\s/g,".")).data(Ge,(function(Ne){return Ne[0].trace.uid}));rt.exit().remove(),rt.enter().append("g").attr("class",Qe),rt.order();var nt=Ne.classed("rangeplot")?"nodeRangePlot3":"node3";return rt.each((function(Ne){Ne[0][nt]=tt.select(this)})),rt}},{d3:169}],784:[function(Ne,Ge,Qe){"use strict";var tt=Ne("gl-mat4");Qe.init2dArray=function(Ne,Ge){for(var Qe=new Array(Ne),tt=0;tt<Ne;tt++)Qe[tt]=new Array(Ge);return Qe},Qe.transposeRagged=function(Ne){var Ge,Qe,tt=0,rt=Ne.length;for(Ge=0;Ge<rt;Ge++)tt=Math.max(tt,Ne[Ge].length);var nt=new Array(tt);for(Ge=0;Ge<tt;Ge++)for(nt[Ge]=new Array(rt),Qe=0;Qe<rt;Qe++)nt[Ge][Qe]=Ne[Qe][Ge];return nt},Qe.dot=function(Ne,Ge){if(!Ne.length||!Ge.length||Ne.length!==Ge.length)return null;var tt,rt,nt=Ne.length;if(Ne[0].length)for(tt=new Array(nt),rt=0;rt<nt;rt++)tt[rt]=Qe.dot(Ne[rt],Ge);else if(Ge[0].length){var at=Qe.transposeRagged(Ge);for(tt=new Array(at.length),rt=0;rt<at.length;rt++)tt[rt]=Qe.dot(Ne,at[rt])}else for(tt=0,rt=0;rt<nt;rt++)tt+=Ne[rt]*Ge[rt];return tt},Qe.translationMatrix=function(Ne,Ge){return[[1,0,Ne],[0,1,Ge],[0,0,1]]},Qe.rotationMatrix=function(Ne){var Ge=Ne*Math.PI/180;return[[Math.cos(Ge),-Math.sin(Ge),0],[Math.sin(Ge),Math.cos(Ge),0],[0,0,1]]},Qe.rotationXYMatrix=function(Ne,Ge,tt){return Qe.dot(Qe.dot(Qe.translationMatrix(Ge,tt),Qe.rotationMatrix(Ne)),Qe.translationMatrix(-Ge,-tt))},Qe.apply3DTransform=function(Ne){return function(){var Ge=arguments,tt=1===arguments.length?Ge[0]:[Ge[0],Ge[1],Ge[2]||0];return Qe.dot(Ne,[tt[0],tt[1],tt[2],1]).slice(0,3)}},Qe.apply2DTransform=function(Ne){return function(){var Ge=arguments;3===Ge.length&&(Ge=Ge[0]);var tt=1===arguments.length?Ge[0]:[Ge[0],Ge[1]];return Qe.dot(Ne,[tt[0],tt[1],1]).slice(0,2)}},Qe.apply2DTransform2=function(Ne){var Ge=Qe.apply2DTransform(Ne);return function(Ne){return Ge(Ne.slice(0,2)).concat(Ge(Ne.slice(2,4)))}},Qe.convertCssMatrix=function(Ne){if(Ne){var Ge=Ne.length;if(16===Ge)return Ne;if(6===Ge)return[Ne[0],Ne[1],0,0,Ne[2],Ne[3],0,0,0,0,1,0,Ne[4],Ne[5],0,1]}return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},Qe.inverseTransformMatrix=function(Ne){var Ge=[];return tt.invert(Ge,Ne),[[Ge[0],Ge[1],Ge[2],Ge[3]],[Ge[4],Ge[5],Ge[6],Ge[7]],[Ge[8],Ge[9],Ge[10],Ge[11]],[Ge[12],Ge[13],Ge[14],Ge[15]]]}},{"gl-mat4":292}],785:[function(Ne,Ge,Qe){"use strict";function mod(Ne,Ge){var Qe=Ne%Ge;return Qe<0?Qe+Ge:Qe}function modHalf(Ne,Ge){return Math.abs(Ne)>Ge/2?Ne-Math.round(Ne/Ge)*Ge:Ne}Ge.exports={mod:mod,modHalf:modHalf}},{}],786:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("./array").isArrayOrTypedArray;function npGet(Ne,Ge){return function(){var Qe,tt,nt,at,it,ot=Ne;for(at=0;at<Ge.length-1;at++){if(-1===(Qe=Ge[at])){for(tt=!0,nt=[],it=0;it<ot.length;it++)nt[it]=npGet(ot[it],Ge.slice(at+1))(),nt[it]!==nt[0]&&(tt=!1);return tt?nt[0]:nt}if("number"==typeof Qe&&!rt(ot))return;if("object"!=typeof(ot=ot[Qe])||null===ot)return}if("object"==typeof ot&&null!==ot&&null!==(nt=ot[Ge[at]]))return nt}}Ge.exports=function(Ne,Ge){if(tt(Ge))Ge=String(Ge);else if("string"!=typeof Ge||"[-1]"===Ge.substr(Ge.length-4))throw"bad property string";for(var Qe,rt,nt,at=0,it=Ge.split(".");at<it.length;){if(Qe=String(it[at]).match(/^([^\[\]]*)((\[\-?[0-9]*\])+)$/)){if(Qe[1])it[at]=Qe[1];else{if(0!==at)throw"bad property string";it.splice(0,1)}for(rt=Qe[2].substr(1,Qe[2].length-2).split("]["),nt=0;nt<rt.length;nt++)at++,it.splice(at,0,Number(rt[nt]))}at++}return"object"!=typeof Ne?badContainer(Ne,Ge,it):{set:npSet(Ne,it,Ge),get:npGet(Ne,it),astr:Ge,parts:it,obj:Ne}};var nt=/(^|\.)args\[/;function isDeletable(Ne,Ge){return void 0===Ne||null===Ne&&!Ge.match(nt)}function npSet(Ne,Ge,Qe){return function(tt){var nt,at,it=Ne,ot="",dt=[[Ne,ot]],ht=isDeletable(tt,Qe);for(at=0;at<Ge.length-1;at++){if("number"==typeof(nt=Ge[at])&&!rt(it))throw"array index but container is not an array";if(-1===nt){if(ht=!setArrayAll(it,Ge.slice(at+1),tt,Qe))break;return}if(!checkNewContainer(it,nt,Ge[at+1],ht))break;if("object"!=typeof(it=it[nt])||null===it)throw"container is not an object";ot=joinPropStr(ot,nt),dt.push([it,ot])}if(ht){if(at===Ge.length-1&&(delete it[Ge[at]],Array.isArray(it)&&+Ge[at]==it.length-1))for(;it.length&&void 0===it[it.length-1];)it.pop()}else it[Ge[at]]=tt}}function joinPropStr(Ne,Ge){var Qe=Ge;return tt(Ge)?Qe="["+Ge+"]":Ne&&(Qe="."+Ge),Ne+Qe}function setArrayAll(Ne,Ge,Qe,tt){var nt,at=rt(Qe),it=!0,ot=Qe,dt=tt.replace("-1",0),ht=!at&&isDeletable(Qe,dt),Dt=Ge[0];for(nt=0;nt<Ne.length;nt++)dt=tt.replace("-1",nt),at&&(ht=isDeletable(ot=Qe[nt%Qe.length],dt)),ht&&(it=!1),checkNewContainer(Ne,nt,Dt,ht)&&npSet(Ne[nt],Ge,tt.replace("-1",nt))(ot);return it}function checkNewContainer(Ne,Ge,Qe,tt){if(void 0===Ne[Ge]){if(tt)return!1;Ne[Ge]="number"==typeof Qe?[]:{}}return!0}function badContainer(Ne,Ge,Qe){return{set:function(){throw"bad container"},get:function(){},astr:Ge,parts:Qe,obj:Ne}}},{"./array":760,"fast-isnumeric":241}],787:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(){}},{}],788:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("fast-isnumeric"),nt=[];Ge.exports=function(Ne,Ge){if(-1===nt.indexOf(Ne)){nt.push(Ne);var Qe=1e3;rt(Ge)?Qe=Ge:"long"===Ge&&(Qe=3e3);var at=tt.select("body").selectAll(".plotly-notifier").data([0]);at.enter().append("div").classed("plotly-notifier",!0),at.selectAll(".notifier-note").data(nt).enter().append("div").classed("notifier-note",!0).style("opacity",0).each((function(Ne){var rt=tt.select(this);rt.append("button").classed("notifier-close",!0).html("&times;").on("click",(function(){rt.transition().call(killNote)}));for(var nt=rt.append("p"),at=Ne.split(/<br\s*\/?>/g),it=0;it<at.length;it++)it&&nt.append("br"),nt.append("span").text(at[it]);"stick"===Ge?rt.transition().duration(350).style("opacity",1):rt.transition().duration(700).style("opacity",1).transition().delay(Qe).call(killNote)}))}function killNote(Ne){Ne.duration(700).style("opacity",0).each("end",(function(Ne){var Ge=nt.indexOf(Ne);-1!==Ge&&nt.splice(Ge,1),tt.select(this).remove()}))}}},{d3:169,"fast-isnumeric":241}],789:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./setcursor"),rt="data-savedcursor",nt="!!";Ge.exports=function(Ne,Ge){var Qe=Ne.attr(rt);if(Ge){if(!Qe){for(var at=(Ne.attr("class")||"").split(" "),it=0;it<at.length;it++){var ot=at[it];0===ot.indexOf("cursor-")&&Ne.attr(rt,ot.substr(7)).classed(ot,!1)}Ne.attr(rt)||Ne.attr(rt,nt)}tt(Ne,Ge)}else Qe&&(Ne.attr(rt,null),Qe===nt?tt(Ne):tt(Ne,Qe))}},{"./setcursor":799}],790:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./matrix").dot,rt=Ne("../constants/numerical").BADNUM,nt=Ge.exports={};nt.tester=function(Ne){var Ge,Qe=Ne.slice(),tt=Qe[0][0],nt=tt,at=Qe[0][1],it=at;for(Qe.push(Qe[0]),Ge=1;Ge<Qe.length;Ge++)tt=Math.min(tt,Qe[Ge][0]),nt=Math.max(nt,Qe[Ge][0]),at=Math.min(at,Qe[Ge][1]),it=Math.max(it,Qe[Ge][1]);var ot,dt=!1;function rectContains(Ne,Ge){var Qe=Ne[0],dt=Ne[1];return!(Qe===rt||Qe<tt||Qe>nt||dt===rt||dt<at||dt>it||Ge&&ot(Ne))}function contains(Ne,Ge){var ot=Ne[0],dt=Ne[1];if(ot===rt||ot<tt||ot>nt||dt===rt||dt<at||dt>it)return!1;var ht,Dt,Ot,Rt,Zt,er=Qe.length,dr=Qe[0][0],mr=Qe[0][1],xr=0;for(ht=1;ht<er;ht++)if(Dt=dr,Ot=mr,dr=Qe[ht][0],mr=Qe[ht][1],!(ot<(Rt=Math.min(Dt,dr))||ot>Math.max(Dt,dr)||dt>Math.max(Ot,mr)))if(dt<Math.min(Ot,mr))ot!==Rt&&xr++;else{if(dt===(Zt=dr===Dt?dt:Ot+(ot-Dt)*(mr-Ot)/(dr-Dt)))return 1!==ht||!Ge;dt<=Zt&&ot!==Rt&&xr++}return xr%2==1}5===Qe.length&&(Qe[0][0]===Qe[1][0]?Qe[2][0]===Qe[3][0]&&Qe[0][1]===Qe[3][1]&&Qe[1][1]===Qe[2][1]&&(dt=!0,ot=function(Ne){return Ne[0]===Qe[0][0]}):Qe[0][1]===Qe[1][1]&&Qe[2][1]===Qe[3][1]&&Qe[0][0]===Qe[3][0]&&Qe[1][0]===Qe[2][0]&&(dt=!0,ot=function(Ne){return Ne[1]===Qe[0][1]}));var ht=!0,Dt=Qe[0];for(Ge=1;Ge<Qe.length;Ge++)if(Dt[0]!==Qe[Ge][0]||Dt[1]!==Qe[Ge][1]){ht=!1;break}return{xmin:tt,xmax:nt,ymin:at,ymax:it,pts:Qe,contains:dt?rectContains:contains,isRect:dt,degenerate:ht}},nt.isSegmentBent=function(Ne,Ge,Qe,rt){var nt,at,it,ot=Ne[Ge],dt=[Ne[Qe][0]-ot[0],Ne[Qe][1]-ot[1]],ht=tt(dt,dt),Dt=Math.sqrt(ht),Ot=[-dt[1]/Dt,dt[0]/Dt];for(nt=Ge+1;nt<Qe;nt++)if(at=[Ne[nt][0]-ot[0],Ne[nt][1]-ot[1]],(it=tt(at,dt))<0||it>ht||Math.abs(tt(at,Ot))>rt)return!0;return!1},nt.filter=function(Ne,Ge){var Qe=[Ne[0]],tt=0,rt=0;function addPt(at){Ne.push(at);var it=Qe.length,ot=tt;Qe.splice(rt+1);for(var dt=ot+1;dt<Ne.length;dt++)(dt===Ne.length-1||nt.isSegmentBent(Ne,ot,dt+1,Ge))&&(Qe.push(Ne[dt]),Qe.length<it-2&&(tt=dt,rt=Qe.length-1),ot=dt)}return Ne.length>1&&addPt(Ne.pop()),{addPt:addPt,raw:Ne,filtered:Qe}}},{"../constants/numerical":753,"./matrix":784}],791:[function(Ne,Ge,tt){(function(Qe){(function(){"use strict";var tt=Ne("./show_no_webgl_msg"),rt=Ne("regl");Ge.exports=function(Ne,Ge){var nt=Ne._fullLayout,at=!0;return nt._glcanvas.each((function(tt){if(!tt.regl&&(!tt.pick||nt._has("parcoords"))){try{tt.regl=rt({canvas:this,attributes:{antialias:!tt.pick,preserveDrawingBuffer:!0},pixelRatio:Ne._context.plotGlPixelRatio||Qe.devicePixelRatio,extensions:Ge||[]})}catch(Ne){at=!1}tt.regl||(at=!1),at&&this.addEventListener("webglcontextlost",(function(Ge){Ne&&Ne.emit&&Ne.emit("plotly_webglcontextlost",{event:Ge,layer:tt.key})}),!1)}})),at||tt({container:nt._glcontainer.node()}),at}}).call(this)}).call(this,void 0!==Qe.g?Qe.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./show_no_webgl_msg":800,regl:540}],792:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("is-mobile");function getUserAgent(){var Ne;return"undefined"!=typeof navigator&&(Ne=navigator.userAgent),Ne&&Ne.headers&&"string"==typeof Ne.headers["user-agent"]&&(Ne=Ne.headers["user-agent"]),Ne}Ge.exports=function(Ne){var Ge;if("string"!=typeof(Ge=Ne&&Ne.hasOwnProperty("userAgent")?Ne.userAgent:getUserAgent()))return!0;var Qe=rt({ua:{headers:{"user-agent":Ge}},tablet:!0,featureDetect:!1});if(!Qe)for(var nt=Ge.split(" "),at=1;at<nt.length;at++)if(-1!==nt[at].indexOf("Safari"))for(var it=at-1;it>-1;it--){var ot=nt[it];if("Version/"===ot.substr(0,8)){var dt=ot.substr(8).split(".")[0];if(tt(dt)&&(dt=+dt),dt>=13)return!0}}return Qe}},{"fast-isnumeric":241,"is-mobile":467}],793:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge){if(Ge instanceof RegExp){for(var Qe=Ge.toString(),tt=0;tt<Ne.length;tt++)if(Ne[tt]instanceof RegExp&&Ne[tt].toString()===Qe)return Ne;Ne.push(Ge)}else!Ge&&0!==Ge||-1!==Ne.indexOf(Ge)||Ne.push(Ge);return Ne}},{}],794:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../lib"),rt=Ne("../plot_api/plot_config").dfltConfig;function copyArgArray(Ne,Ge){for(var Qe,rt=[],nt=0;nt<Ge.length;nt++)Qe=Ge[nt],rt[nt]=Qe===Ne?Qe:"object"==typeof Qe?Array.isArray(Qe)?tt.extendDeep([],Qe):tt.extendDeepAll({},Qe):Qe;return rt}var nt={add:function(Ne,Ge,Qe,tt,nt){var at,it;Ne.undoQueue=Ne.undoQueue||{index:0,queue:[],sequence:!1},it=Ne.undoQueue.index,Ne.autoplay?Ne.undoQueue.inSequence||(Ne.autoplay=!1):(!Ne.undoQueue.sequence||Ne.undoQueue.beginSequence?(at={undo:{calls:[],args:[]},redo:{calls:[],args:[]}},Ne.undoQueue.queue.splice(it,Ne.undoQueue.queue.length-it,at),Ne.undoQueue.index+=1):at=Ne.undoQueue.queue[it-1],Ne.undoQueue.beginSequence=!1,at&&(at.undo.calls.unshift(Ge),at.undo.args.unshift(Qe),at.redo.calls.push(tt),at.redo.args.push(nt)),Ne.undoQueue.queue.length>rt.queueLength&&(Ne.undoQueue.queue.shift(),Ne.undoQueue.index--))},startSequence:function(Ne){Ne.undoQueue=Ne.undoQueue||{index:0,queue:[],sequence:!1},Ne.undoQueue.sequence=!0,Ne.undoQueue.beginSequence=!0},stopSequence:function(Ne){Ne.undoQueue=Ne.undoQueue||{index:0,queue:[],sequence:!1},Ne.undoQueue.sequence=!1,Ne.undoQueue.beginSequence=!1},undo:function(Ne){var Ge,Qe;if(Ne.framework&&Ne.framework.isPolar)Ne.framework.undo();else if(!(void 0===Ne.undoQueue||isNaN(Ne.undoQueue.index)||Ne.undoQueue.index<=0)){for(Ne.undoQueue.index--,Ge=Ne.undoQueue.queue[Ne.undoQueue.index],Ne.undoQueue.inSequence=!0,Qe=0;Qe<Ge.undo.calls.length;Qe++)nt.plotDo(Ne,Ge.undo.calls[Qe],Ge.undo.args[Qe]);Ne.undoQueue.inSequence=!1,Ne.autoplay=!1}},redo:function(Ne){var Ge,Qe;if(Ne.framework&&Ne.framework.isPolar)Ne.framework.redo();else if(!(void 0===Ne.undoQueue||isNaN(Ne.undoQueue.index)||Ne.undoQueue.index>=Ne.undoQueue.queue.length)){for(Ge=Ne.undoQueue.queue[Ne.undoQueue.index],Ne.undoQueue.inSequence=!0,Qe=0;Qe<Ge.redo.calls.length;Qe++)nt.plotDo(Ne,Ge.redo.calls[Qe],Ge.redo.args[Qe]);Ne.undoQueue.inSequence=!1,Ne.autoplay=!1,Ne.undoQueue.index++}},plotDo:function(Ne,Ge,Qe){Ne.autoplay=!0,Qe=copyArgArray(Ne,Qe),Ge.apply(null,Qe)}};Ge.exports=nt},{"../lib":778,"../plot_api/plot_config":815}],795:[function(Ne,Ge,Qe){"use strict";Qe.counter=function(Ne,Ge,Qe,tt){var rt=(Ge||"")+(Qe?"":"$"),nt=!1===tt?"":"^";return"xy"===Ne?new RegExp(nt+"x([2-9]|[1-9][0-9]+)?y([2-9]|[1-9][0-9]+)?"+rt):new RegExp(nt+Ne+"([2-9]|[1-9][0-9]+)?"+rt)}},{}],796:[function(Ne,Ge,Qe){"use strict";var tt=/^(.*)(\.[^\.\[\]]+|\[\d\])$/,rt=/^[^\.\[\]]+$/;Ge.exports=function(Ne,Ge){for(;Ge;){var Qe=Ne.match(tt);if(Qe)Ne=Qe[1];else{if(!Ne.match(rt))throw new Error("bad relativeAttr call:"+[Ne,Ge]);Ne=""}if("^"!==Ge.charAt(0))break;Ge=Ge.slice(1)}return Ne&&"["!==Ge.charAt(0)?Ne+"."+Ge:Ne+Ge}},{}],797:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./array").isArrayOrTypedArray,rt=Ne("./is_plain_object");Ge.exports=function relinkPrivateKeys(Ne,Ge){for(var Qe in Ge){var nt=Ge[Qe],at=Ne[Qe];if(at!==nt)if("_"===Qe.charAt(0)||"function"==typeof nt){if(Qe in Ne)continue;Ne[Qe]=nt}else if(tt(nt)&&tt(at)&&rt(nt[0])){if("customdata"===Qe||"ids"===Qe)continue;for(var it=Math.min(nt.length,at.length),ot=0;ot<it;ot++)at[ot]!==nt[ot]&&rt(nt[ot])&&rt(at[ot])&&relinkPrivateKeys(at[ot],nt[ot])}else rt(nt)&&rt(at)&&(relinkPrivateKeys(at,nt),Object.keys(at).length||delete Ne[Qe])}}},{"./array":760,"./is_plain_object":779}],798:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("./loggers"),nt=Ne("./identity"),at=Ne("../constants/numerical").BADNUM,it=1e-9;function lessThan(Ne,Ge){return Ne<Ge}function lessOrEqual(Ne,Ge){return Ne<=Ge}function greaterThan(Ne,Ge){return Ne>Ge}function greaterOrEqual(Ne,Ge){return Ne>=Ge}Qe.findBin=function(Ne,Ge,Qe){if(tt(Ge.start))return Qe?Math.ceil((Ne-Ge.start)/Ge.size-it)-1:Math.floor((Ne-Ge.start)/Ge.size+it);var nt,at,ot=0,dt=Ge.length,ht=0,Dt=dt>1?(Ge[dt-1]-Ge[0])/(dt-1):1;for(at=Dt>=0?Qe?lessThan:lessOrEqual:Qe?greaterOrEqual:greaterThan,Ne+=Dt*it*(Qe?-1:1)*(Dt>=0?1:-1);ot<dt&&ht++<100;)at(Ge[nt=Math.floor((ot+dt)/2)],Ne)?ot=nt+1:dt=nt;return ht>90&&rt.log("Long binary search..."),ot-1},Qe.sorterAsc=function(Ne,Ge){return Ne-Ge},Qe.sorterDes=function(Ne,Ge){return Ge-Ne},Qe.distinctVals=function(Ne,Ge){var tt,rt=(Ge||{}).unitMinDiff,nt=Ne.slice();for(nt.sort(Qe.sorterAsc),tt=nt.length-1;tt>-1&&nt[tt]===at;tt--);var it=1;rt||(it=nt[tt]-nt[0]||1);for(var ot,dt=it/(tt||1)/1e4,ht=[],Dt=0;Dt<=tt;Dt++){var Ot=nt[Dt],Rt=Ot-ot;void 0===ot?(ht.push(Ot),ot=Ot):Rt>dt&&(it=Math.min(it,Rt),ht.push(Ot),ot=Ot)}return{vals:ht,minDiff:it}},Qe.roundUp=function(Ne,Ge,Qe){for(var tt,rt=0,nt=Ge.length-1,at=0,it=Qe?0:1,ot=Qe?1:0,dt=Qe?Math.ceil:Math.floor;rt<nt&&at++<100;)Ge[tt=dt((rt+nt)/2)]<=Ne?rt=tt+it:nt=tt-ot;return Ge[rt]},Qe.sort=function(Ne,Ge){for(var Qe=0,tt=0,rt=1;rt<Ne.length;rt++){var nt=Ge(Ne[rt],Ne[rt-1]);if(nt<0?Qe=1:nt>0&&(tt=1),Qe&&tt)return Ne.sort(Ge)}return tt?Ne:Ne.reverse()},Qe.findIndexOfMin=function(Ne,Ge){Ge=Ge||nt;for(var Qe,tt=1/0,rt=0;rt<Ne.length;rt++){var at=Ge(Ne[rt]);at<tt&&(tt=at,Qe=rt)}return Qe}},{"../constants/numerical":753,"./identity":776,"./loggers":782,"fast-isnumeric":241}],799:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge){(Ne.attr("class")||"").split(" ").forEach((function(Ge){0===Ge.indexOf("cursor-")&&Ne.classed(Ge,!1)})),Ge&&Ne.classed("cursor-"+Ge,!0)}},{}],800:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../components/color"),noop=function(){};Ge.exports=function(Ne){for(var Ge in Ne)"function"==typeof Ne[Ge]&&(Ne[Ge]=noop);Ne.destroy=function(){Ne.container.parentNode.removeChild(Ne.container)};var Qe=document.createElement("div");Qe.className="no-webgl",Qe.style.cursor="pointer",Qe.style.fontSize="24px",Qe.style.color=tt.defaults[0],Qe.style.position="absolute",Qe.style.left=Qe.style.top="0px",Qe.style.width=Qe.style.height="100%",Qe.style["background-color"]=tt.lightLine,Qe.style["z-index"]=30;var rt=document.createElement("p");return rt.textContent="WebGL is not supported by your browser - visit https://get.webgl.org for more info",rt.style.position="relative",rt.style.top="50%",rt.style.left="50%",rt.style.height="30%",rt.style.width="50%",rt.style.margin="-15% 0 0 -25%",Qe.appendChild(rt),Ne.container.appendChild(Qe),Ne.container.style.background="#FFFFFF",Ne.container.onclick=function(){window.open("https://get.webgl.org")},!1}},{"../components/color":643}],801:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("./array").isArrayOrTypedArray;Qe.aggNums=function(Ne,Ge,nt,at){var it,ot;if((!at||at>nt.length)&&(at=nt.length),tt(Ge)||(Ge=!1),rt(nt[0])){for(ot=new Array(at),it=0;it<at;it++)ot[it]=Qe.aggNums(Ne,Ge,nt[it]);nt=ot}for(it=0;it<at;it++)tt(Ge)?tt(nt[it])&&(Ge=Ne(+Ge,+nt[it])):Ge=nt[it];return Ge},Qe.len=function(Ne){return Qe.aggNums((function(Ne){return Ne+1}),0,Ne)},Qe.mean=function(Ne,Ge){return Ge||(Ge=Qe.len(Ne)),Qe.aggNums((function(Ne,Ge){return Ne+Ge}),0,Ne)/Ge},Qe.midRange=function(Ne){if(void 0!==Ne&&0!==Ne.length)return(Qe.aggNums(Math.max,null,Ne)+Qe.aggNums(Math.min,null,Ne))/2},Qe.variance=function(Ne,Ge,rt){return Ge||(Ge=Qe.len(Ne)),tt(rt)||(rt=Qe.mean(Ne,Ge)),Qe.aggNums((function(Ne,Ge){return Ne+Math.pow(Ge-rt,2)}),0,Ne)/Ge},Qe.stdev=function(Ne,Ge,tt){return Math.sqrt(Qe.variance(Ne,Ge,tt))},Qe.median=function(Ne){var Ge=Ne.slice().sort();return Qe.interp(Ge,.5)},Qe.interp=function(Ne,Ge){if(!tt(Ge))throw"n should be a finite number";if((Ge=Ge*Ne.length-.5)<0)return Ne[0];if(Ge>Ne.length-1)return Ne[Ne.length-1];var Qe=Ge%1;return Qe*Ne[Math.ceil(Ge)]+(1-Qe)*Ne[Math.floor(Ge)]}},{"./array":760,"fast-isnumeric":241}],802:[function(Ne,Ge,Qe){"use strict";var tt=Ne("color-normalize");function str2RgbaArray(Ne){return Ne?tt(Ne):[0,0,0,1]}Ge.exports=str2RgbaArray},{"color-normalize":125}],803:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../lib"),nt=rt.strTranslate,at=Ne("../constants/xmlns_namespaces"),it=Ne("../constants/alignment").LINE_SPACING;function getSize(Ne,Ge){return Ne.node().getBoundingClientRect()[Ge]}var ot=/([^$]*)([$]+[^$]*[$]+)([^$]*)/;Qe.convertToTspans=function(Ne,Ge,rt){var at=Ne.text(),it=!Ne.attr("data-notex")&&"undefined"!=typeof MathJax&&at.match(ot),dt=tt.select(Ne.node().parentNode);if(!dt.empty()){var ht=Ne.attr("class")?Ne.attr("class").split(" ")[0]:"text";return ht+="-math",dt.selectAll("svg."+ht).remove(),dt.selectAll("g."+ht+"-group").remove(),Ne.style("display",null).attr({"data-unformatted":at,"data-math":"N"}),it?(Ge&&Ge._promises||[]).push(new Promise((function(Ge){Ne.style("display","none");var Qe=parseInt(Ne.node().style.fontSize,10),tt={fontSize:Qe};texToSVG(it[2],tt,(function(tt,it,ot){dt.selectAll("svg."+ht).remove(),dt.selectAll("g."+ht+"-group").remove();var Dt=tt&&tt.select("svg");if(!Dt||!Dt.node())return showText(),void Ge();var Ot=dt.append("g").classed(ht+"-group",!0).attr({"pointer-events":"none","data-unformatted":at,"data-math":"Y"});Ot.node().appendChild(Dt.node()),it&&it.node()&&Dt.node().insertBefore(it.node().cloneNode(!0),Dt.node().firstChild),Dt.attr({class:ht,height:ot.height,preserveAspectRatio:"xMinYMin meet"}).style({overflow:"visible","pointer-events":"none"});var Rt=Ne.node().style.fill||"black",Zt=Dt.select("g");Zt.attr({fill:Rt,stroke:Rt});var er=getSize(Zt,"width"),dr=getSize(Zt,"height"),mr=+Ne.attr("x")-er*{start:0,middle:.5,end:1}[Ne.attr("text-anchor")||"start"],xr=-(Qe||getSize(Ne,"height"))/4;"y"===ht[0]?(Ot.attr({transform:"rotate("+[-90,+Ne.attr("x"),+Ne.attr("y")]+")"+nt(-er/2,xr-dr/2)}),Dt.attr({x:+Ne.attr("x"),y:+Ne.attr("y")})):"l"===ht[0]?Dt.attr({x:Ne.attr("x"),y:xr-dr/2}):"a"===ht[0]&&0!==ht.indexOf("atitle")?Dt.attr({x:0,y:xr}):Dt.attr({x:mr,y:+Ne.attr("y")+xr-dr/2}),rt&&rt.call(Ne,Ot),Ge(Ot)}))}))):showText(),Ne}function showText(){dt.empty()||(ht=Ne.attr("class")+"-math",dt.select("svg."+ht).remove()),Ne.text("").style("white-space","pre"),buildSVGText(Ne.node(),at)&&Ne.style("pointer-events","all"),Qe.positionText(Ne),rt&&rt.call(Ne)}};var dt=/(<|&lt;|&#60;)/g,ht=/(>|&gt;|&#62;)/g;function cleanEscapesForTex(Ne){return Ne.replace(dt,"\\lt ").replace(ht,"\\gt ")}function texToSVG(Ne,Ge,Qe){var nt,at,it,ot;MathJax.Hub.Queue((function(){return at=rt.extendDeepAll({},MathJax.Hub.config),it=MathJax.Hub.processSectionDelay,void 0!==MathJax.Hub.processSectionDelay&&(MathJax.Hub.processSectionDelay=0),MathJax.Hub.Config({messageStyle:"none",tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]]},displayAlign:"left"})}),(function(){if("SVG"!==(nt=MathJax.Hub.config.menuSettings.renderer))return MathJax.Hub.setRenderer("SVG")}),(function(){var Qe="math-output-"+rt.randstr({},64);return ot=tt.select("body").append("div").attr({id:Qe}).style({visibility:"hidden",position:"absolute"}).style({"font-size":Ge.fontSize+"px"}).text(cleanEscapesForTex(Ne)),MathJax.Hub.Typeset(ot.node())}),(function(){var Ge=tt.select("body").select("#MathJax_SVG_glyphs");if(ot.select(".MathJax_SVG").empty()||!ot.select("svg").node())rt.log("There was an error in the tex syntax.",Ne),Qe();else{var at=ot.select("svg").node().getBoundingClientRect();Qe(ot.select(".MathJax_SVG"),Ge,at)}if(ot.remove(),"SVG"!==nt)return MathJax.Hub.setRenderer(nt)}),(function(){return void 0!==it&&(MathJax.Hub.processSectionDelay=it),MathJax.Hub.Config(at)}))}var Dt={sup:"font-size:70%",sub:"font-size:70%",b:"font-weight:bold",i:"font-style:italic",a:"cursor:pointer",span:"",em:"font-style:italic;font-weight:bold"},Ot={sub:"0.3em",sup:"-0.6em"},Rt={sub:"-0.21em",sup:"0.42em"},Zt="â",er=["http:","https:","mailto:","",void 0,":"],dr=Qe.NEWLINES=/(\r\n?|\n)/g,mr=/(<[^<>]*>)/,xr=/<(\/?)([^ >]*)(\s+(.*))?>/i,br=/<br(\s+.*)?>/i;Qe.BR_TAG_ALL=/<br(\s+.*)?>/gi;var Ar=/(^|[\s"'])style\s*=\s*("([^"]*);?"|'([^']*);?')/i,en=/(^|[\s"'])href\s*=\s*("([^"]*)"|'([^']*)')/i,mn=/(^|[\s"'])target\s*=\s*("([^"\s]*)"|'([^'\s]*)')/i,xn=/(^|[\s"'])popup\s*=\s*("([\w=,]*)"|'([\w=,]*)')/i;function getQuotedMatch(Ne,Ge){if(!Ne)return null;var Qe=Ne.match(Ge),tt=Qe&&(Qe[3]||Qe[4]);return tt&&convertEntities(tt)}var kn=/(^|;)\s*color:/;Qe.plainText=function(Ne,Ge){for(var Qe=void 0!==(Ge=Ge||{}).len&&-1!==Ge.len?Ge.len:1/0,tt=void 0!==Ge.allowedTags?Ge.allowedTags:["br"],rt="...",nt=rt.length,at=Ne.split(mr),it=[],ot="",dt=0,ht=0;ht<at.length;ht++){var Dt=at[ht],Ot=Dt.match(xr),Rt=Ot&&Ot[2].toLowerCase();if(Rt)-1!==tt.indexOf(Rt)&&(it.push(Dt),ot=Rt);else{var Zt=Dt.length;if(dt+Zt<Qe)it.push(Dt),dt+=Zt;else if(dt<Qe){var er=Qe-dt;ot&&("br"!==ot||er<=nt||Zt<=nt)&&it.pop(),Qe>nt?it.push(Dt.substr(0,er-nt)+rt):it.push(Dt.substr(0,er));break}ot=""}}return it.join("")};var Cn={mu:"Î¼",amp:"&",lt:"<",gt:">",nbsp:"Â ",times:"Ã",plusmn:"Â±",deg:"Â°"},En=/&(#\d+|#x[\da-fA-F]+|[a-z]+);/g;function convertEntities(Ne){return Ne.replace(En,(function(Ne,Ge){return("#"===Ge.charAt(0)?fromCodePoint("x"===Ge.charAt(1)?parseInt(Ge.substr(2),16):parseInt(Ge.substr(1),10)):Cn[Ge])||Ne}))}function fromCodePoint(Ne){if(!(Ne>1114111)){var Ge=String.fromCodePoint;if(Ge)return Ge(Ne);var Qe=String.fromCharCode;return Ne<=65535?Qe(Ne):Qe(55232+(Ne>>10),Ne%1024+56320)}}function buildSVGText(Ne,Ge){Ge=Ge.replace(dr," ");var Qe,nt=!1,ot=[],dt=-1;function newLine(){dt++;var Ge=document.createElementNS(at.svg,"tspan");tt.select(Ge).attr({class:"line",dy:dt*it+"em"}),Ne.appendChild(Ge),Qe=Ge;var rt=ot;if(ot=[{node:Ge}],rt.length>1)for(var nt=1;nt<rt.length;nt++)enterNode(rt[nt])}function enterNode(Ne){var Ge,rt=Ne.type,nt={};if("a"===rt){Ge="a";var it=Ne.target,dt=Ne.href,ht=Ne.popup;dt&&(nt={"xlink:xlink:show":"_blank"===it||"_"!==it.charAt(0)?"new":"replace",target:it,"xlink:xlink:href":dt},ht&&(nt.onclick='window.open(this.href.baseVal,this.target.baseVal,"'+ht+'");return false;'))}else Ge="tspan";Ne.style&&(nt.style=Ne.style);var Dt=document.createElementNS(at.svg,Ge);if("sup"===rt||"sub"===rt){addTextNode(Qe,Zt),Qe.appendChild(Dt);var er=document.createElementNS(at.svg,"tspan");addTextNode(er,Zt),tt.select(er).attr("dy",Rt[rt]),nt.dy=Ot[rt],Qe.appendChild(Dt),Qe.appendChild(er)}else Qe.appendChild(Dt);tt.select(Dt).attr(nt),Qe=Ne.node=Dt,ot.push(Ne)}function addTextNode(Ne,Ge){Ne.appendChild(document.createTextNode(Ge))}function exitNode(Ne){if(1!==ot.length){var tt=ot.pop();Ne!==tt.type&&rt.log("Start tag <"+tt.type+"> doesnt match end tag <"+Ne+">. Pretending it did match.",Ge),Qe=ot[ot.length-1].node}else rt.log("Ignoring unexpected end tag </"+Ne+">.",Ge)}br.test(Ge)?newLine():(Qe=Ne,ot=[{node:Ne}]);for(var ht=Ge.split(mr),er=0;er<ht.length;er++){var Cn=ht[er],En=Cn.match(xr),Pn=En&&En[2].toLowerCase(),Dn=Dt[Pn];if("br"===Pn)newLine();else if(void 0===Dn)addTextNode(Qe,convertEntities(Cn));else if(En[1])exitNode(Pn);else{var In=En[4],zn={type:Pn},Bn=getQuotedMatch(In,Ar);if(Bn?(Bn=Bn.replace(kn,"$1 fill:"),Dn&&(Bn+=";"+Dn)):Dn&&(Bn=Dn),Bn&&(zn.style=Bn),"a"===Pn){nt=!0;var Vn=getQuotedMatch(In,en);if(Vn){var Hn=sanitizeHref(Vn);Hn&&(zn.href=Hn,zn.target=getQuotedMatch(In,mn)||"_blank",zn.popup=getQuotedMatch(In,xn))}}enterNode(zn)}}return nt}function sanitizeHref(Ne){var Ge=encodeURI(decodeURI(Ne)),Qe=document.createElement("a"),tt=document.createElement("a");Qe.href=Ne,tt.href=Ge;var rt=Qe.protocol,nt=tt.protocol;return-1!==er.indexOf(rt)&&-1!==er.indexOf(nt)?Ge:""}function alignHTMLWith(Ne,Ge,Qe){var tt,nt,at,it=Qe.horizontalAlign,ot=Qe.verticalAlign||"top",dt=Ne.node().getBoundingClientRect(),ht=Ge.node().getBoundingClientRect();return nt="bottom"===ot?function(){return dt.bottom-tt.height}:"middle"===ot?function(){return dt.top+(dt.height-tt.height)/2}:function(){return dt.top},at="right"===it?function(){return dt.right-tt.width}:"center"===it?function(){return dt.left+(dt.width-tt.width)/2}:function(){return dt.left},function(){tt=this.node().getBoundingClientRect();var Ne=at()-ht.left,Ge=nt()-ht.top,it=Qe.gd||{};if(Qe.gd){it._fullLayout._calcInverseTransform(it);var ot=rt.apply3DTransform(it._fullLayout._invTransform)(Ne,Ge);Ne=ot[0],Ge=ot[1]}return this.style({top:Ge+"px",left:Ne+"px","z-index":1e3}),this}}Qe.convertEntities=convertEntities,Qe.sanitizeHTML=function(Ne){Ne=Ne.replace(dr," ");for(var Ge=document.createElement("p"),Qe=Ge,rt=[],nt=Ne.split(mr),at=0;at<nt.length;at++){var it=nt[at],ot=it.match(xr),dt=ot&&ot[2].toLowerCase();if(dt in Dt)if(ot[1])rt.length&&(Qe=rt.pop());else{var ht=ot[4],Ot=getQuotedMatch(ht,Ar),Rt=Ot?{style:Ot}:{};if("a"===dt){var Zt=getQuotedMatch(ht,en);if(Zt){var er=sanitizeHref(Zt);if(er){Rt.href=er;var br=getQuotedMatch(ht,mn);br&&(Rt.target=br)}}}var xn=document.createElement(dt);Qe.appendChild(xn),tt.select(xn).attr(Rt),Qe=xn,rt.push(xn)}else Qe.appendChild(document.createTextNode(convertEntities(it)))}return Ge.innerHTML},Qe.lineCount=function(Ne){return Ne.selectAll("tspan.line").size()||1},Qe.positionText=function(Ne,Ge,Qe){return Ne.each((function(){var Ne=tt.select(this);function setOrGet(Ge,Qe){return void 0===Qe?null===(Qe=Ne.attr(Ge))&&(Ne.attr(Ge,0),Qe=0):Ne.attr(Ge,Qe),Qe}var rt=setOrGet("x",Ge),nt=setOrGet("y",Qe);"text"===this.nodeName&&Ne.selectAll("tspan.line").attr({x:rt,y:nt})}))},Qe.makeEditable=function(Ne,Ge){var Qe=Ge.gd,rt=Ge.delegate,nt=tt.dispatch("edit","input","cancel"),at=rt||Ne;if(Ne.style({"pointer-events":rt?"none":"all"}),1!==Ne.size())throw new Error("boo");function handleClick(){appendEditable(),Ne.style({opacity:0});var Ge,Qe=at.attr("class");(Ge=Qe?"."+Qe.split(" ")[0]+"-math-group":"[class*=-math-group]")&&tt.select(Ne.node().parentNode).select(Ge).style({opacity:0})}function selectElementContents(Ne){var Ge=Ne.node(),Qe=document.createRange();Qe.selectNodeContents(Ge);var tt=window.getSelection();tt.removeAllRanges(),tt.addRange(Qe),Ge.focus()}function appendEditable(){var rt=tt.select(Qe).select(".svg-container"),at=rt.append("div"),it=Ne.node().style,ot=parseFloat(it.fontSize||12),dt=Ge.text;void 0===dt&&(dt=Ne.attr("data-unformatted")),at.classed("plugin-editable editable",!0).style({position:"absolute","font-family":it.fontFamily||"Arial","font-size":ot,color:Ge.fill||it.fill||"black",opacity:1,"background-color":Ge.background||"transparent",outline:"#ffffff33 1px solid",margin:[-ot/8+1,0,0,-1].join("px ")+"px",padding:"0","box-sizing":"border-box"}).attr({contenteditable:!0}).text(dt).call(alignHTMLWith(Ne,rt,Ge)).on("blur",(function(){Qe._editing=!1,Ne.text(this.textContent).style({opacity:1});var Ge,rt=tt.select(this).attr("class");(Ge=rt?"."+rt.split(" ")[0]+"-math-group":"[class*=-math-group]")&&tt.select(Ne.node().parentNode).select(Ge).style({opacity:0});var at=this.textContent;tt.select(this).transition().duration(0).remove(),tt.select(document).on("mouseup",null),nt.edit.call(Ne,at)})).on("focus",(function(){var Ne=this;Qe._editing=!0,tt.select(document).on("mouseup",(function(){if(tt.event.target===Ne)return!1;document.activeElement===at.node()&&at.node().blur()}))})).on("keyup",(function(){27===tt.event.which?(Qe._editing=!1,Ne.style({opacity:1}),tt.select(this).style({opacity:0}).on("blur",(function(){return!1})).transition().remove(),nt.cancel.call(Ne,this.textContent)):(nt.input.call(Ne,this.textContent),tt.select(this).call(alignHTMLWith(Ne,rt,Ge)))})).on("keydown",(function(){13===tt.event.which&&this.blur()})).call(selectElementContents)}return Ge.immediate?handleClick():at.on("click",handleClick),tt.rebind(Ne,nt,"on")}},{"../constants/alignment":745,"../constants/xmlns_namespaces":754,"../lib":778,d3:169}],804:[function(Ne,Ge,Qe){"use strict";var tt={};function _clearTimeout(Ne){Ne&&null!==Ne.timer&&(clearTimeout(Ne.timer),Ne.timer=null)}Qe.throttle=function(Ne,Ge,Qe){var rt=tt[Ne],nt=Date.now();if(!rt){for(var at in tt)tt[at].ts<nt-6e4&&delete tt[at];rt=tt[Ne]={ts:0,timer:null}}function exec(){Qe(),rt.ts=Date.now(),rt.onDone&&(rt.onDone(),rt.onDone=null)}_clearTimeout(rt),nt>rt.ts+Ge?exec():rt.timer=setTimeout((function(){exec(),rt.timer=null}),Ge)},Qe.done=function(Ne){var Ge=tt[Ne];return Ge&&Ge.timer?new Promise((function(Ne){var Qe=Ge.onDone;Ge.onDone=function(){Qe&&Qe(),Ne(),Ge.onDone=null}})):Promise.resolve()},Qe.clear=function(Ne){if(Ne)_clearTimeout(tt[Ne]),delete tt[Ne];else for(var Ge in tt)Qe.clear(Ge)}},{}],805:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric");Ge.exports=function(Ne,Ge){if(Ne>0)return Math.log(Ne)/Math.LN10;var Qe=Math.log(Math.min(Ge[0],Ge[1]))/Math.LN10;return tt(Qe)||(Qe=Math.log(Math.max(Ge[0],Ge[1]))/Math.LN10-6),Qe}},{"fast-isnumeric":241}],806:[function(Ne,Ge,Qe){"use strict";var tt=Ge.exports={},rt=Ne("../plots/geo/constants").locationmodeToLayer,nt=Ne("topojson-client").feature;tt.getTopojsonName=function(Ne){return[Ne.scope.replace(/ /g,"-"),"_",Ne.resolution.toString(),"m"].join("")},tt.getTopojsonPath=function(Ne,Ge){return Ne+Ge+".json"},tt.getTopojsonFeatures=function(Ne,Ge){var Qe=rt[Ne.locationmode],tt=Ge.objects[Qe];return nt(Ge,tt).features}},{"../plots/geo/constants":858,"topojson-client":579}],807:[function(Ne,Ge,Qe){"use strict";Ge.exports={moduleType:"locale",name:"en-US",dictionary:{"Click to enter Colorscale title":"Click to enter Colorscale title"},format:{date:"%m/%d/%Y"}}},{}],808:[function(Ne,Ge,Qe){"use strict";Ge.exports={moduleType:"locale",name:"en",dictionary:{"Click to enter Colorscale title":"Click to enter Colourscale title"},format:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],periods:["AM","PM"],dateTime:"%a %b %e %X %Y",date:"%d/%m/%Y",time:"%H:%M:%S",decimal:".",thousands:",",grouping:[3],currency:["$",""],year:"%Y",month:"%b %Y",dayMonth:"%b %-d",dayMonthYear:"%b %-d, %Y"}}},{}],809:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../registry");Ge.exports=function(Ne){for(var Ge,Qe,rt=tt.layoutArrayContainers,nt=tt.layoutArrayRegexes,at=Ne.split("[")[0],it=0;it<nt.length;it++)if((Qe=Ne.match(nt[it]))&&0===Qe.index){Ge=Qe[0];break}if(Ge||(Ge=rt[rt.indexOf(at)]),!Ge)return!1;var ot=Ne.substr(Ge.length);return ot?!!(Qe=ot.match(/^\[(0|[1-9][0-9]*)\](\.(.+))?$/))&&{array:Ge,index:Number(Qe[1]),property:Qe[3]||""}:{array:Ge,index:"",property:""}}},{"../registry":911}],810:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../lib"),rt=tt.extendFlat,nt=tt.isPlainObject,at={valType:"flaglist",extras:["none"],flags:["calc","clearAxisTypes","plot","style","markerSize","colorbars"]},it={valType:"flaglist",extras:["none"],flags:["calc","plot","legend","ticks","axrange","layoutstyle","modebar","camera","arraydraw","colorbars"]},ot=at.flags.slice().concat(["fullReplot"]),dt=it.flags.slice().concat("layoutReplot");function falseObj(Ne){for(var Ge={},Qe=0;Qe<Ne.length;Qe++)Ge[Ne[Qe]]=!1;return Ge}function overrideAll(Ne,Ge,Qe){var tt=rt({},Ne);for(var at in tt){var it=tt[at];nt(it)&&(tt[at]=overrideOne(it,Ge,Qe,at))}return"from-root"===Qe&&(tt.editType=Ge),tt}function overrideOne(Ne,Ge,Qe,tt){if(Ne.valType){var nt=rt({},Ne);if(nt.editType=Ge,Array.isArray(Ne.items)){nt.items=new Array(Ne.items.length);for(var at=0;at<Ne.items.length;at++)nt.items[at]=overrideOne(Ne.items[at],Ge,"from-root")}return nt}return overrideAll(Ne,Ge,"_"===tt.charAt(0)?"nested":"from-root")}Ge.exports={traces:at,layout:it,traceFlags:function(){return falseObj(ot)},layoutFlags:function(){return falseObj(dt)},update:function(Ne,Ge){var Qe=Ge.editType;if(Qe&&"none"!==Qe)for(var tt=Qe.split("+"),rt=0;rt<tt.length;rt++)Ne[tt[rt]]=!0},overrideAll:overrideAll}},{"../lib":778}],811:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("gl-mat4/fromQuat"),nt=Ne("../registry"),at=Ne("../lib"),it=Ne("../plots/plots"),ot=Ne("../plots/cartesian/axis_ids"),dt=Ne("../components/color"),ht=ot.cleanId,Dt=ot.getFromTrace,Ot=nt.traceIs;function cleanAxRef(Ne,Ge){var Qe=Ne[Ge],tt=Ge.charAt(0);Qe&&"paper"!==Qe&&(Ne[Ge]=ht(Qe,tt,!0))}function cleanTitle(Ne){function rewireAttr(Ge,Qe){var tt=Ne[Ge],rt=Ne.title&&Ne.title[Qe];tt&&!rt&&(Ne.title||(Ne.title={}),Ne.title[Qe]=Ne[Ge],delete Ne[Ge])}Ne&&("string"!=typeof Ne.title&&"number"!=typeof Ne.title||(Ne.title={text:Ne.title}),rewireAttr("titlefont","font"),rewireAttr("titleposition","position"),rewireAttr("titleside","side"),rewireAttr("titleoffset","offset"))}function cleanFinanceDir(Ne){if(!at.isPlainObject(Ne))return!1;var Ge=Ne.name;return delete Ne.name,delete Ne.showlegend,("string"==typeof Ge||"number"==typeof Ge)&&String(Ge)}function commonPrefix(Ne,Ge,Qe,tt){if(Qe&&!tt)return Ne;if(tt&&!Qe)return Ge;if(!Ne.trim())return Ge;if(!Ge.trim())return Ne;var rt,nt=Math.min(Ne.length,Ge.length);for(rt=0;rt<nt&&Ne.charAt(rt)===Ge.charAt(rt);rt++);return Ne.substr(0,rt).trim()}function cleanTextPosition(Ne){var Ge="middle",Qe="center";return"string"==typeof Ne&&(-1!==Ne.indexOf("top")?Ge="top":-1!==Ne.indexOf("bottom")&&(Ge="bottom"),-1!==Ne.indexOf("left")?Qe="left":-1!==Ne.indexOf("right")&&(Qe="right")),Ge+" "+Qe}function emptyContainer(Ne,Ge){return Ge in Ne&&"object"==typeof Ne[Ge]&&0===Object.keys(Ne[Ge]).length}Qe.clearPromiseQueue=function(Ne){Array.isArray(Ne._promises)&&Ne._promises.length>0&&at.log("Clearing previous rejected promises from queue."),Ne._promises=[]},Qe.cleanLayout=function(Ne){var Ge,tt;Ne||(Ne={}),Ne.xaxis1&&(Ne.xaxis||(Ne.xaxis=Ne.xaxis1),delete Ne.xaxis1),Ne.yaxis1&&(Ne.yaxis||(Ne.yaxis=Ne.yaxis1),delete Ne.yaxis1),Ne.scene1&&(Ne.scene||(Ne.scene=Ne.scene1),delete Ne.scene1);var nt=(it.subplotsRegistry.cartesian||{}).attrRegex,ot=(it.subplotsRegistry.polar||{}).attrRegex,Dt=(it.subplotsRegistry.ternary||{}).attrRegex,Ot=(it.subplotsRegistry.gl3d||{}).attrRegex,Rt=Object.keys(Ne);for(Ge=0;Ge<Rt.length;Ge++){var Zt=Rt[Ge];if(nt&&nt.test(Zt)){var er=Ne[Zt];er.anchor&&"free"!==er.anchor&&(er.anchor=ht(er.anchor)),er.overlaying&&(er.overlaying=ht(er.overlaying)),er.type||(er.isdate?er.type="date":er.islog?er.type="log":!1===er.isdate&&!1===er.islog&&(er.type="linear")),"withzero"!==er.autorange&&"tozero"!==er.autorange||(er.autorange=!0,er.rangemode="tozero"),delete er.islog,delete er.isdate,delete er.categories,emptyContainer(er,"domain")&&delete er.domain,void 0!==er.autotick&&(void 0===er.tickmode&&(er.tickmode=er.autotick?"auto":"linear"),delete er.autotick),cleanTitle(er)}else if(ot&&ot.test(Zt))cleanTitle(Ne[Zt].radialaxis);else if(Dt&&Dt.test(Zt)){var dr=Ne[Zt];cleanTitle(dr.aaxis),cleanTitle(dr.baxis),cleanTitle(dr.caxis)}else if(Ot&&Ot.test(Zt)){var mr=Ne[Zt],xr=mr.cameraposition;if(Array.isArray(xr)&&4===xr[0].length){var br=xr[0],Ar=xr[1],en=xr[2],mn=rt([],br),xn=[];for(tt=0;tt<3;++tt)xn[tt]=Ar[tt]+en*mn[2+4*tt];mr.camera={eye:{x:xn[0],y:xn[1],z:xn[2]},center:{x:Ar[0],y:Ar[1],z:Ar[2]},up:{x:0,y:0,z:1}},delete mr.cameraposition}cleanTitle(mr.xaxis),cleanTitle(mr.yaxis),cleanTitle(mr.zaxis)}}var kn=Array.isArray(Ne.annotations)?Ne.annotations.length:0;for(Ge=0;Ge<kn;Ge++){var Cn=Ne.annotations[Ge];at.isPlainObject(Cn)&&(Cn.ref&&("paper"===Cn.ref?(Cn.xref="paper",Cn.yref="paper"):"data"===Cn.ref&&(Cn.xref="x",Cn.yref="y"),delete Cn.ref),cleanAxRef(Cn,"xref"),cleanAxRef(Cn,"yref"))}var En=Array.isArray(Ne.shapes)?Ne.shapes.length:0;for(Ge=0;Ge<En;Ge++){var Pn=Ne.shapes[Ge];at.isPlainObject(Pn)&&(cleanAxRef(Pn,"xref"),cleanAxRef(Pn,"yref"))}var Dn=Array.isArray(Ne.images)?Ne.images.length:0;for(Ge=0;Ge<Dn;Ge++){var In=Ne.images[Ge];at.isPlainObject(In)&&(cleanAxRef(In,"xref"),cleanAxRef(In,"yref"))}var zn=Ne.legend;return zn&&(zn.x>3?(zn.x=1.02,zn.xanchor="left"):zn.x<-2&&(zn.x=-.02,zn.xanchor="right"),zn.y>3?(zn.y=1.02,zn.yanchor="bottom"):zn.y<-2&&(zn.y=-.02,zn.yanchor="top")),cleanTitle(Ne),"rotate"===Ne.dragmode&&(Ne.dragmode="orbit"),dt.clean(Ne),Ne.template&&Ne.template.layout&&Qe.cleanLayout(Ne.template.layout),Ne},Qe.cleanData=function(Ne){for(var Ge=0;Ge<Ne.length;Ge++){var tt,rt=Ne[Ge];if("histogramy"===rt.type&&"xbins"in rt&&!("ybins"in rt)&&(rt.ybins=rt.xbins,delete rt.xbins),rt.error_y&&"opacity"in rt.error_y){var ot=dt.defaults,Dt=rt.error_y.color||(Ot(rt,"bar")?dt.defaultLine:ot[Ge%ot.length]);rt.error_y.color=dt.addOpacity(dt.rgb(Dt),dt.opacity(Dt)*rt.error_y.opacity),delete rt.error_y.opacity}if("bardir"in rt&&("h"!==rt.bardir||!Ot(rt,"bar")&&"histogram"!==rt.type.substr(0,9)||(rt.orientation="h",Qe.swapXYData(rt)),delete rt.bardir),"histogramy"===rt.type&&Qe.swapXYData(rt),"histogramx"!==rt.type&&"histogramy"!==rt.type||(rt.type="histogram"),"scl"in rt&&!("colorscale"in rt)&&(rt.colorscale=rt.scl,delete rt.scl),"reversescl"in rt&&!("reversescale"in rt)&&(rt.reversescale=rt.reversescl,delete rt.reversescl),rt.xaxis&&(rt.xaxis=ht(rt.xaxis,"x")),rt.yaxis&&(rt.yaxis=ht(rt.yaxis,"y")),Ot(rt,"gl3d")&&rt.scene&&(rt.scene=it.subplotsRegistry.gl3d.cleanId(rt.scene)),!Ot(rt,"pie-like")&&!Ot(rt,"bar-like"))if(Array.isArray(rt.textposition))for(tt=0;tt<rt.textposition.length;tt++)rt.textposition[tt]=cleanTextPosition(rt.textposition[tt]);else rt.textposition&&(rt.textposition=cleanTextPosition(rt.textposition));var Rt=nt.getModule(rt);if(Rt&&Rt.colorbar){var Zt=Rt.colorbar.container,er=Zt?rt[Zt]:rt;er&&er.colorscale&&("YIGnBu"===er.colorscale&&(er.colorscale="YlGnBu"),"YIOrRd"===er.colorscale&&(er.colorscale="YlOrRd"))}if("surface"===rt.type&&at.isPlainObject(rt.contours)){var dr=["x","y","z"];for(tt=0;tt<dr.length;tt++){var mr=rt.contours[dr[tt]];at.isPlainObject(mr)&&(mr.highlightColor&&(mr.highlightcolor=mr.highlightColor,delete mr.highlightColor),mr.highlightWidth&&(mr.highlightwidth=mr.highlightWidth,delete mr.highlightWidth))}}if("candlestick"===rt.type||"ohlc"===rt.type){var xr=!1!==(rt.increasing||{}).showlegend,br=!1!==(rt.decreasing||{}).showlegend,Ar=cleanFinanceDir(rt.increasing),en=cleanFinanceDir(rt.decreasing);if(!1!==Ar&&!1!==en){var mn=commonPrefix(Ar,en,xr,br);mn&&(rt.name=mn)}else!Ar&&!en||rt.name||(rt.name=Ar||en)}if(Array.isArray(rt.transforms)){var xn=rt.transforms;for(tt=0;tt<xn.length;tt++){var kn=xn[tt];if(at.isPlainObject(kn))switch(kn.type){case"filter":kn.filtersrc&&(kn.target=kn.filtersrc,delete kn.filtersrc),kn.calendar&&(kn.valuecalendar||(kn.valuecalendar=kn.calendar),delete kn.calendar);break;case"groupby":if(kn.styles=kn.styles||kn.style,kn.styles&&!Array.isArray(kn.styles)){var Cn=kn.styles,En=Object.keys(Cn);kn.styles=[];for(var Pn=0;Pn<En.length;Pn++)kn.styles.push({target:En[Pn],value:Cn[En[Pn]]})}}}}emptyContainer(rt,"line")&&delete rt.line,"marker"in rt&&(emptyContainer(rt.marker,"line")&&delete rt.marker.line,emptyContainer(rt,"marker")&&delete rt.marker),dt.clean(rt),rt.autobinx&&(delete rt.autobinx,delete rt.xbins),rt.autobiny&&(delete rt.autobiny,delete rt.ybins),cleanTitle(rt),rt.colorbar&&cleanTitle(rt.colorbar),rt.marker&&rt.marker.colorbar&&cleanTitle(rt.marker.colorbar),rt.line&&rt.line.colorbar&&cleanTitle(rt.line.colorbar),rt.aaxis&&cleanTitle(rt.aaxis),rt.baxis&&cleanTitle(rt.baxis)}},Qe.swapXYData=function(Ne){var Ge;if(at.swapAttrs(Ne,["?","?0","d?","?bins","nbins?","autobin?","?src","error_?"]),Array.isArray(Ne.z)&&Array.isArray(Ne.z[0])&&(Ne.transpose?delete Ne.transpose:Ne.transpose=!0),Ne.error_x&&Ne.error_y){var Qe=Ne.error_y,tt="copy_ystyle"in Qe?Qe.copy_ystyle:!(Qe.color||Qe.thickness||Qe.width);at.swapAttrs(Ne,["error_?.copy_ystyle"]),tt&&at.swapAttrs(Ne,["error_?.color","error_?.thickness","error_?.width"])}if("string"==typeof Ne.hoverinfo){var rt=Ne.hoverinfo.split("+");for(Ge=0;Ge<rt.length;Ge++)"x"===rt[Ge]?rt[Ge]="y":"y"===rt[Ge]&&(rt[Ge]="x");Ne.hoverinfo=rt.join("+")}},Qe.coerceTraceIndices=function(Ne,Ge){if(tt(Ge))return[Ge];if(!Array.isArray(Ge)||!Ge.length)return Ne.data.map((function(Ne,Ge){return Ge}));if(Array.isArray(Ge)){for(var Qe=[],rt=0;rt<Ge.length;rt++)at.isIndex(Ge[rt],Ne.data.length)?Qe.push(Ge[rt]):at.warn("trace index (",Ge[rt],") is not a number or is out of bounds");return Qe}return Ge},Qe.manageArrayContainers=function(Ne,Ge,Qe){var rt=Ne.obj,nt=Ne.parts,it=nt.length,ot=nt[it-1],dt=tt(ot);if(dt&&null===Ge){var ht=nt.slice(0,it-1).join(".");at.nestedProperty(rt,ht).get().splice(ot,1)}else dt&&void 0===Ne.get()?(void 0===Ne.get()&&(Qe[Ne.astr]=null),Ne.set(Ge)):Ne.set(Ge)};var Rt=/(\.[^\[\]\.]+|\[[^\[\]\.]+\])$/;function getParent(Ne){var Ge=Ne.search(Rt);if(Ge>0)return Ne.substr(0,Ge)}Qe.hasParent=function(Ne,Ge){for(var Qe=getParent(Ge);Qe;){if(Qe in Ne)return!0;Qe=getParent(Qe)}return!1};var Zt=["x","y","z"];Qe.clearAxisTypes=function(Ne,Ge,Qe){for(var tt=0;tt<Ge.length;tt++)for(var rt=Ne._fullData[tt],nt=0;nt<3;nt++){var it=Dt(Ne,rt,Zt[nt]);if(it&&"log"!==it.type){var ot=it._name,dt=it._id.substr(1);if("scene"===dt.substr(0,5)){if(void 0!==Qe[dt])continue;ot=dt+"."+ot}var ht=ot+".type";void 0===Qe[ot]&&void 0===Qe[ht]&&at.nestedProperty(Ne.layout,ht).set(null)}}}},{"../components/color":643,"../lib":778,"../plots/cartesian/axis_ids":831,"../plots/plots":891,"../registry":911,"fast-isnumeric":241,"gl-mat4/fromQuat":282}],812:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./plot_api");Qe.plot=tt.plot,Qe.newPlot=tt.newPlot,Qe.restyle=tt.restyle,Qe.relayout=tt.relayout,Qe.redraw=tt.redraw,Qe.update=tt.update,Qe._guiRestyle=tt._guiRestyle,Qe._guiRelayout=tt._guiRelayout,Qe._guiUpdate=tt._guiUpdate,Qe._storeDirectGUIEdit=tt._storeDirectGUIEdit,Qe.react=tt.react,Qe.extendTraces=tt.extendTraces,Qe.prependTraces=tt.prependTraces,Qe.addTraces=tt.addTraces,Qe.deleteTraces=tt.deleteTraces,Qe.moveTraces=tt.moveTraces,Qe.purge=tt.purge,Qe.addFrames=tt.addFrames,Qe.deleteFrames=tt.deleteFrames,Qe.animate=tt.animate,Qe.setPlotConfig=tt.setPlotConfig,Qe.toImage=Ne("./to_image"),Qe.validate=Ne("./validate"),Qe.downloadImage=Ne("../snapshot/download");var rt=Ne("./template_api");Qe.makeTemplate=rt.makeTemplate,Qe.validateTemplate=rt.validateTemplate},{"../snapshot/download":913,"./plot_api":814,"./template_api":819,"./to_image":820,"./validate":821}],813:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../lib/is_plain_object"),rt=Ne("../lib/noop"),nt=Ne("../lib/loggers"),at=Ne("../lib/search").sorterAsc,it=Ne("../registry");Qe.containerArrayMatch=Ne("./container_array_match");var ot=Qe.isAddVal=function(Ne){return"add"===Ne||tt(Ne)},dt=Qe.isRemoveVal=function(Ne){return null===Ne||"remove"===Ne};Qe.applyContainerArrayChanges=function(Ne,Ge,Qe,tt,ht){var Dt=Ge.astr,Ot=it.getComponentMethod(Dt,"supplyLayoutDefaults"),Rt=it.getComponentMethod(Dt,"draw"),Zt=it.getComponentMethod(Dt,"drawOne"),er=tt.replot||tt.recalc||Ot===rt||Rt===rt,dr=Ne.layout,mr=Ne._fullLayout;if(Qe[""]){Object.keys(Qe).length>1&&nt.warn("Full array edits are incompatible with other edits",Dt);var xr=Qe[""][""];if(dt(xr))Ge.set(null);else{if(!Array.isArray(xr))return nt.warn("Unrecognized full array edit value",Dt,xr),!0;Ge.set(xr)}return!er&&(Ot(dr,mr),Rt(Ne),!0)}var br,Ar,en,mn,xn,kn,Cn,En,Pn=Object.keys(Qe).map(Number).sort(at),Dn=Ge.get(),In=Dn||[],zn=ht(mr,Dt).get(),Bn=[],Vn=-1,Hn=In.length;for(br=0;br<Pn.length;br++)if(mn=Qe[en=Pn[br]],xn=Object.keys(mn),kn=mn[""],Cn=ot(kn),en<0||en>In.length-(Cn?0:1))nt.warn("index out of range",Dt,en);else if(void 0!==kn)xn.length>1&&nt.warn("Insertion & removal are incompatible with edits to the same index.",Dt,en),dt(kn)?Bn.push(en):Cn?("add"===kn&&(kn={}),In.splice(en,0,kn),zn&&zn.splice(en,0,{})):nt.warn("Unrecognized full object edit value",Dt,en,kn),-1===Vn&&(Vn=en);else for(Ar=0;Ar<xn.length;Ar++)En=Dt+"["+en+"].",ht(In[en],xn[Ar],En).set(mn[xn[Ar]]);for(br=Bn.length-1;br>=0;br--)In.splice(Bn[br],1),zn&&zn.splice(Bn[br],1);if(In.length?Dn||Ge.set(In):Ge.set(null),er)return!1;if(Ot(dr,mr),Zt!==rt){var qn;if(-1===Vn)qn=Pn;else{for(Hn=Math.max(In.length,Hn),qn=[],br=0;br<Pn.length&&!((en=Pn[br])>=Vn);br++)qn.push(en);for(br=Vn;br<Hn;br++)qn.push(br)}for(br=0;br<qn.length;br++)Zt(Ne,qn[br])}else Rt(Ne);return!0}},{"../lib/is_plain_object":779,"../lib/loggers":782,"../lib/noop":787,"../lib/search":798,"../registry":911,"./container_array_match":809}],814:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("fast-isnumeric"),nt=Ne("has-hover"),at=Ne("../lib"),it=at.nestedProperty,ot=Ne("../lib/events"),dt=Ne("../lib/queue"),ht=Ne("../registry"),Dt=Ne("./plot_schema"),Ot=Ne("../plots/plots"),Rt=Ne("../plots/polar/legacy"),Zt=Ne("../plots/cartesian/axes"),er=Ne("../components/drawing"),dr=Ne("../components/color"),mr=Ne("../plots/cartesian/graph_interact").initInteractions,xr=Ne("../constants/xmlns_namespaces"),br=Ne("../lib/svg_text_utils"),Ar=Ne("../plots/cartesian/select").clearSelect,en=Ne("./plot_config").dfltConfig,mn=Ne("./manage_arrays"),xn=Ne("./helpers"),kn=Ne("./subroutines"),Cn=Ne("./edit_types"),En=Ne("../plots/cartesian/constants").AX_NAME_PATTERN,Pn=0,Dn=5;function plot(Ne,Ge,rt,nt){var it;if(Ne=at.getGraphDiv(Ne),ot.init(Ne),at.isPlainObject(Ge)){var dt=Ge;Ge=dt.data,rt=dt.layout,nt=dt.config,it=dt.frames}if(!1===ot.triggerHandler(Ne,"plotly_beforeplot",[Ge,rt,nt]))return Promise.reject();function addFrames(){if(it)return Qe.addFrames(Ne,it)}Ge||rt||at.isPlotDiv(Ne)||at.warn("Calling Plotly.plot as if redrawing but this container doesn't yet have a plot.",Ne),setPlotContext(Ne,nt),rt||(rt={}),tt.select(Ne).classed("js-plotly-plot",!0),er.makeTester(),Array.isArray(Ne._promises)||(Ne._promises=[]);var Dt=0===(Ne.data||[]).length&&Array.isArray(Ge);Array.isArray(Ge)&&(xn.cleanData(Ge),Dt?Ne.data=Ge:Ne.data.push.apply(Ne.data,Ge),Ne.empty=!1),Ne.layout&&!Dt||(Ne.layout=xn.cleanLayout(rt)),Ot.supplyDefaults(Ne);var Rt=Ne._fullLayout,dr=Rt._has("cartesian");if(!Rt._has("polar")&&Ge&&Ge[0]&&Ge[0].r)return at.log("Legacy polar charts are deprecated!"),plotLegacyPolar(Ne,Ge,rt);Rt._replotting=!0,(Dt||Rt._shouldCreateBgLayer)&&(makePlotFramework(Ne),Rt._shouldCreateBgLayer&&delete Rt._shouldCreateBgLayer),Ne.framework!==makePlotFramework&&(Ne.framework=makePlotFramework,makePlotFramework(Ne)),er.initGradients(Ne),Dt&&Zt.saveShowSpikeInitial(Ne);var xr=!Ne.calcdata||Ne.calcdata.length!==(Ne._fullData||[]).length;xr&&Ot.doCalcdata(Ne);for(var br=0;br<Ne.calcdata.length;br++)Ne.calcdata[br][0].trace=Ne._fullData[br];Ne._context.responsive?Ne._responsiveChartHandler||(Ne._responsiveChartHandler=function(){at.isHidden(Ne)||Ot.resize(Ne)},window.addEventListener("resize",Ne._responsiveChartHandler)):at.clearResponsive(Ne);var Ar=at.extendFlat({},Rt._size),en=0;function drawFramework(){for(var Ge=Rt._basePlotModules,Qe=0;Qe<Ge.length;Qe++)Ge[Qe].drawFramework&&Ge[Qe].drawFramework(Ne);if(!Rt._glcanvas&&Rt._has("gl")&&(Rt._glcanvas=Rt._glcontainer.selectAll(".gl-canvas").data([{key:"contextLayer",context:!0,pick:!1},{key:"focusLayer",context:!1,pick:!1},{key:"pickLayer",context:!1,pick:!0}],(function(Ne){return Ne.key})),Rt._glcanvas.enter().append("canvas").attr("class",(function(Ne){return"gl-canvas gl-canvas-"+Ne.key.replace("Layer","")})).style({position:"absolute",top:0,left:0,overflow:"visible","pointer-events":"none"})),Rt._glcanvas){Rt._glcanvas.attr("width",Rt.width).attr("height",Rt.height);var tt=Rt._glcanvas.data()[0].regl;if(tt&&(Math.floor(Rt.width)!==tt._gl.drawingBufferWidth||Math.floor(Rt.height)!==tt._gl.drawingBufferHeight)){var rt="WebGL context buffer and canvas dimensions do not match due to browser/WebGL bug.";if(!en)return at.log(rt+" Clearing graph and plotting again."),Ot.cleanPlot([],{},Ne._fullData,Rt),Ot.supplyDefaults(Ne),Rt=Ne._fullLayout,Ot.doCalcdata(Ne),en++,drawFramework();at.error(rt)}}return"h"===Rt.modebar.orientation?Rt._modebardiv.style("height",null).style("width","100%"):Rt._modebardiv.style("width",null).style("height",Rt.height+"px"),Ot.previousPromises(Ne)}function marginPushers(){if(Ot.clearAutoMarginIds(Ne),kn.drawMarginPushers(Ne),Zt.allowAutoMargin(Ne),Rt._has("pie"))for(var Ge=Ne._fullData,Qe=0;Qe<Ge.length;Qe++){var tt=Ge[Qe];"pie"===tt.type&&tt.automargin&&Ot.allowAutoMargin(Ne,"pie."+tt.uid+".automargin")}return Ot.doAutoMargin(Ne),Ot.previousPromises(Ne)}function marginPushersAgain(){if(Ot.didMarginChange(Ar,Rt._size))return at.syncOrAsync([marginPushers,kn.layoutStyles],Ne)}function positionAndAutorange(){if(xr)return at.syncOrAsync([ht.getComponentMethod("shapes","calcAutorange"),ht.getComponentMethod("annotations","calcAutorange"),doAutoRangeAndConstraints],Ne);doAutoRangeAndConstraints()}function doAutoRangeAndConstraints(){Ne._transitioning||(kn.doAutoRangeAndConstraints(Ne),Dt&&Zt.saveRangeInitial(Ne),ht.getComponentMethod("rangeslider","calcAutorange")(Ne))}function drawAxes(){return Zt.draw(Ne,Dt?"":"redraw")}var mn=[Ot.previousPromises,addFrames,drawFramework,marginPushers,marginPushersAgain];function saveRangeInitialForInsideTickLabels(Ne){Ne._fullLayout._insideTickLabelsAutorange&&Dt&&Zt.saveRangeInitial(Ne,!0)}dr&&mn.push(positionAndAutorange),mn.push(kn.layoutStyles),dr&&mn.push(drawAxes,(function(Ne){Ne._fullLayout._insideTickLabelsAutorange&&relayout(Ne,Ne._fullLayout._insideTickLabelsAutorange).then((function(){Ne._fullLayout._insideTickLabelsAutorange=void 0}))})),mn.push(kn.drawData,kn.finalDraw,mr,Ot.addLinks,Ot.rehover,Ot.redrag,Ot.doAutoMargin,saveRangeInitialForInsideTickLabels,Ot.previousPromises);var Cn=at.syncOrAsync(mn,Ne);return Cn&&Cn.then||(Cn=Promise.resolve()),Cn.then((function(){return emitAfterPlot(Ne),Ne}))}function emitAfterPlot(Ne){var Ge=Ne._fullLayout;Ge._redrawFromAutoMarginCount?Ge._redrawFromAutoMarginCount--:Ne.emit("plotly_afterplot")}function setPlotConfig(Ne){return at.extendFlat(en,Ne)}function setBackground(Ne,Ge){try{Ne._fullLayout._paper.style("background",Ge)}catch(Ne){at.error(Ne)}}function opaqueSetBackground(Ne,Ge){setBackground(Ne,dr.combine(Ge,"white"))}function setPlotContext(Ne,Ge){if(!Ne._context){Ne._context=at.extendDeep({},en);var Qe=tt.select("base");Ne._context._baseUrl=Qe.size()&&Qe.attr("href")?window.location.href.split("#")[0]:""}var rt,it,ot,dt=Ne._context;if(Ge){for(it=Object.keys(Ge),rt=0;rt<it.length;rt++)"editable"!==(ot=it[rt])&&"edits"!==ot&&ot in dt&&("setBackground"===ot&&"opaque"===Ge[ot]?dt[ot]=opaqueSetBackground:dt[ot]=Ge[ot]);Ge.plot3dPixelRatio&&!dt.plotGlPixelRatio&&(dt.plotGlPixelRatio=dt.plot3dPixelRatio);var ht=Ge.editable;if(void 0!==ht)for(dt.editable=ht,it=Object.keys(dt.edits),rt=0;rt<it.length;rt++)dt.edits[it[rt]]=ht;if(Ge.edits)for(it=Object.keys(Ge.edits),rt=0;rt<it.length;rt++)(ot=it[rt])in dt.edits&&(dt.edits[ot]=Ge.edits[ot]);dt._exportedPlot=Ge._exportedPlot}dt.staticPlot&&(dt.editable=!1,dt.edits={},dt.autosizable=!1,dt.scrollZoom=!1,dt.doubleClick=!1,dt.showTips=!1,dt.showLink=!1,dt.displayModeBar=!1),"hover"!==dt.displayModeBar||nt||(dt.displayModeBar=!0),"transparent"!==dt.setBackground&&"function"==typeof dt.setBackground||(dt.setBackground=setBackground),dt._hasZeroHeight=dt._hasZeroHeight||0===Ne.clientHeight,dt._hasZeroWidth=dt._hasZeroWidth||0===Ne.clientWidth;var Dt=dt.scrollZoom,Ot=dt._scrollZoom={};if(!0===Dt)Ot.cartesian=1,Ot.gl3d=1,Ot.geo=1,Ot.mapbox=1;else if("string"==typeof Dt){var Rt=Dt.split("+");for(rt=0;rt<Rt.length;rt++)Ot[Rt[rt]]=1}else!1!==Dt&&(Ot.gl3d=1,Ot.geo=1,Ot.mapbox=1)}function plotLegacyPolar(Ne,Ge,Qe){var rt=tt.select(Ne).selectAll(".plot-container").data([0]);rt.enter().insert("div",":first-child").classed("plot-container plotly",!0);var nt=rt.selectAll(".svg-container").data([0]);nt.enter().append("div").classed("svg-container",!0).style("position","relative"),nt.html(""),Ge&&(Ne.data=Ge),Qe&&(Ne.layout=Qe),Rt.manager.fillLayout(Ne),nt.style({width:Ne._fullLayout.width+"px",height:Ne._fullLayout.height+"px"}),Ne.framework=Rt.manager.framework(Ne),Ne.framework({data:Ne.data,layout:Ne.layout},nt.node()),Ne.framework.setUndoPoint();var it=Ne.framework.svg(),ot=1,dt=Ne._fullLayout.title?Ne._fullLayout.title.text:"";""!==dt&&dt||(ot=0);var titleLayout=function(){this.call(br.convertToTspans,Ne)},ht=it.select(".title-group text").call(titleLayout);if(Ne._context.edits.titleText){var Dt=at._(Ne,"Click to enter Plot title");dt&&dt!==Dt||(ot=.2,ht.attr({"data-unformatted":Dt}).text(Dt).style({opacity:ot}).on("mouseover.opacity",(function(){tt.select(this).transition().duration(100).style("opacity",1)})).on("mouseout.opacity",(function(){tt.select(this).transition().duration(1e3).style("opacity",0)})));var setContenteditable=function(){this.call(br.makeEditable,{gd:Ne}).on("edit",(function(Ge){Ne.framework({layout:{title:{text:Ge}}}),this.text(Ge).call(titleLayout),this.call(setContenteditable)})).on("cancel",(function(){var Ne=this.attr("data-unformatted");this.text(Ne).call(titleLayout)}))};ht.call(setContenteditable)}return Ne._context.setBackground(Ne,Ne._fullLayout.paper_bgcolor),Ot.addLinks(Ne),Promise.resolve()}function redraw(Ne){if(Ne=at.getGraphDiv(Ne),!at.isPlotDiv(Ne))throw new Error("This element is not a Plotly plot: "+Ne);return xn.cleanData(Ne.data),xn.cleanLayout(Ne.layout),Ne.calcdata=void 0,Qe.plot(Ne).then((function(){return Ne.emit("plotly_redraw"),Ne}))}function newPlot(Ne,Ge,tt,rt){return Ne=at.getGraphDiv(Ne),Ot.cleanPlot([],{},Ne._fullData||[],Ne._fullLayout||{}),Ot.purge(Ne),Qe.plot(Ne,Ge,tt,rt)}function positivifyIndices(Ne,Ge){var Qe,tt,rt=Ge+1,nt=[];for(Qe=0;Qe<Ne.length;Qe++)(tt=Ne[Qe])<0?nt.push(rt+tt):nt.push(tt);return nt}function assertIndexArray(Ne,Ge,Qe){var tt,rt;for(tt=0;tt<Ge.length;tt++){if((rt=Ge[tt])!==parseInt(rt,10))throw new Error("all values in "+Qe+" must be integers");if(rt>=Ne.data.length||rt<-Ne.data.length)throw new Error(Qe+" must be valid indices for gd.data.");if(Ge.indexOf(rt,tt+1)>-1||rt>=0&&Ge.indexOf(-Ne.data.length+rt)>-1||rt<0&&Ge.indexOf(Ne.data.length+rt)>-1)throw new Error("each index in "+Qe+" must be unique.")}}function checkMoveTracesArgs(Ne,Ge,Qe){if(!Array.isArray(Ne.data))throw new Error("gd.data must be an array.");if(void 0===Ge)throw new Error("currentIndices is a required argument.");if(Array.isArray(Ge)||(Ge=[Ge]),assertIndexArray(Ne,Ge,"currentIndices"),void 0===Qe||Array.isArray(Qe)||(Qe=[Qe]),void 0!==Qe&&assertIndexArray(Ne,Qe,"newIndices"),void 0!==Qe&&Ge.length!==Qe.length)throw new Error("current and new indices must be of equal length.")}function checkAddTracesArgs(Ne,Ge,Qe){var tt,rt;if(!Array.isArray(Ne.data))throw new Error("gd.data must be an array.");if(void 0===Ge)throw new Error("traces must be defined.");for(Array.isArray(Ge)||(Ge=[Ge]),tt=0;tt<Ge.length;tt++)if("object"!=typeof(rt=Ge[tt])||Array.isArray(rt)||null===rt)throw new Error("all values in traces array must be non-array objects");if(void 0===Qe||Array.isArray(Qe)||(Qe=[Qe]),void 0!==Qe&&Qe.length!==Ge.length)throw new Error("if indices is specified, traces.length must equal indices.length")}function assertExtendTracesArgs(Ne,Ge,Qe,tt){var rt=at.isPlainObject(tt);if(!Array.isArray(Ne.data))throw new Error("gd.data must be an array");if(!at.isPlainObject(Ge))throw new Error("update must be a key:value object");if(void 0===Qe)throw new Error("indices must be an integer or array of integers");for(var nt in assertIndexArray(Ne,Qe,"indices"),Ge){if(!Array.isArray(Ge[nt])||Ge[nt].length!==Qe.length)throw new Error("attribute "+nt+" must be an array of length equal to indices array length");if(rt&&(!(nt in tt)||!Array.isArray(tt[nt])||tt[nt].length!==Ge[nt].length))throw new Error("when maxPoints is set as a key:value object it must contain a 1:1 corrispondence with the keys and number of traces in the update object")}}function getExtendProperties(Ne,Ge,Qe,tt){var nt,ot,dt,ht,Dt,Ot=at.isPlainObject(tt),Rt=[];for(var Zt in Array.isArray(Qe)||(Qe=[Qe]),Qe=positivifyIndices(Qe,Ne.data.length-1),Ge)for(var er=0;er<Qe.length;er++){if(nt=Ne.data[Qe[er]],ot=(dt=it(nt,Zt)).get(),ht=Ge[Zt][er],!at.isArrayOrTypedArray(ht))throw new Error("attribute: "+Zt+" index: "+er+" must be an array");if(!at.isArrayOrTypedArray(ot))throw new Error("cannot extend missing or non-array attribute: "+Zt);if(ot.constructor!==ht.constructor)throw new Error("cannot extend array with an array of a different type: "+Zt);Dt=Ot?tt[Zt][er]:tt,rt(Dt)||(Dt=-1),Rt.push({prop:dt,target:ot,insert:ht,maxp:Math.floor(Dt)})}return Rt}function spliceTraces(Ne,Ge,Qe,tt,rt){assertExtendTracesArgs(Ne,Ge,Qe,tt);for(var nt=getExtendProperties(Ne,Ge,Qe,tt),at={},it={},ot=0;ot<nt.length;ot++){var dt=nt[ot].prop,ht=nt[ot].maxp,Dt=rt(nt[ot].target,nt[ot].insert,ht);dt.set(Dt[0]),Array.isArray(at[dt.astr])||(at[dt.astr]=[]),at[dt.astr].push(Dt[1]),Array.isArray(it[dt.astr])||(it[dt.astr]=[]),it[dt.astr].push(nt[ot].target.length)}return{update:at,maxPoints:it}}function concatTypedArray(Ne,Ge){var Qe=new Ne.constructor(Ne.length+Ge.length);return Qe.set(Ne),Qe.set(Ge,Ne.length),Qe}function extendTraces(Ne,Ge,tt,rt){function updateArray(Ne,Ge,Qe){var tt,rt;if(at.isTypedArray(Ne))if(Qe<0){var nt=new Ne.constructor(0),it=concatTypedArray(Ne,Ge);Qe<0?(tt=it,rt=nt):(tt=nt,rt=it)}else if(tt=new Ne.constructor(Qe),rt=new Ne.constructor(Ne.length+Ge.length-Qe),Qe===Ge.length)tt.set(Ge),rt.set(Ne);else if(Qe<Ge.length){var ot=Ge.length-Qe;tt.set(Ge.subarray(ot)),rt.set(Ne),rt.set(Ge.subarray(0,ot),Ne.length)}else{var dt=Qe-Ge.length,ht=Ne.length-dt;tt.set(Ne.subarray(ht)),tt.set(Ge,dt),rt.set(Ne.subarray(0,ht))}else tt=Ne.concat(Ge),rt=Qe>=0&&Qe<tt.length?tt.splice(0,tt.length-Qe):[];return[tt,rt]}var nt=spliceTraces(Ne=at.getGraphDiv(Ne),Ge,tt,rt,updateArray),it=Qe.redraw(Ne),ot=[Ne,nt.update,tt,nt.maxPoints];return dt.add(Ne,Qe.prependTraces,ot,extendTraces,arguments),it}function prependTraces(Ne,Ge,tt,rt){function updateArray(Ne,Ge,Qe){var tt,rt;if(at.isTypedArray(Ne))if(Qe<=0){var nt=new Ne.constructor(0),it=concatTypedArray(Ge,Ne);Qe<0?(tt=it,rt=nt):(tt=nt,rt=it)}else if(tt=new Ne.constructor(Qe),rt=new Ne.constructor(Ne.length+Ge.length-Qe),Qe===Ge.length)tt.set(Ge),rt.set(Ne);else if(Qe<Ge.length){var ot=Ge.length-Qe;tt.set(Ge.subarray(0,ot)),rt.set(Ge.subarray(ot)),rt.set(Ne,ot)}else{var dt=Qe-Ge.length;tt.set(Ge),tt.set(Ne.subarray(0,dt),Ge.length),rt.set(Ne.subarray(dt))}else tt=Ge.concat(Ne),rt=Qe>=0&&Qe<tt.length?tt.splice(Qe,tt.length):[];return[tt,rt]}var nt=spliceTraces(Ne=at.getGraphDiv(Ne),Ge,tt,rt,updateArray),it=Qe.redraw(Ne),ot=[Ne,nt.update,tt,nt.maxPoints];return dt.add(Ne,Qe.extendTraces,ot,prependTraces,arguments),it}function addTraces(Ne,Ge,tt){Ne=at.getGraphDiv(Ne);var rt,nt,it=[],ot=Qe.deleteTraces,ht=addTraces,Dt=[Ne,it],Ot=[Ne,Ge];for(checkAddTracesArgs(Ne,Ge,tt),Array.isArray(Ge)||(Ge=[Ge]),Ge=Ge.map((function(Ne){return at.extendFlat({},Ne)})),xn.cleanData(Ge),rt=0;rt<Ge.length;rt++)Ne.data.push(Ge[rt]);for(rt=0;rt<Ge.length;rt++)it.push(-Ge.length+rt);if(void 0===tt)return nt=Qe.redraw(Ne),dt.add(Ne,ot,Dt,ht,Ot),nt;Array.isArray(tt)||(tt=[tt]);try{checkMoveTracesArgs(Ne,it,tt)}catch(Qe){throw Ne.data.splice(Ne.data.length-Ge.length,Ge.length),Qe}return dt.startSequence(Ne),dt.add(Ne,ot,Dt,ht,Ot),nt=Qe.moveTraces(Ne,it,tt),dt.stopSequence(Ne),nt}function deleteTraces(Ne,Ge){Ne=at.getGraphDiv(Ne);var tt,rt,nt=[],it=Qe.addTraces,ot=deleteTraces,ht=[Ne,nt,Ge],Dt=[Ne,Ge];if(void 0===Ge)throw new Error("indices must be an integer or array of integers.");for(Array.isArray(Ge)||(Ge=[Ge]),assertIndexArray(Ne,Ge,"indices"),(Ge=positivifyIndices(Ge,Ne.data.length-1)).sort(at.sorterDes),tt=0;tt<Ge.length;tt+=1)rt=Ne.data.splice(Ge[tt],1)[0],nt.push(rt);var Ot=Qe.redraw(Ne);return dt.add(Ne,it,ht,ot,Dt),Ot}function moveTraces(Ne,Ge,tt){var rt,nt=[],it=[],ot=moveTraces,ht=moveTraces,Dt=[Ne=at.getGraphDiv(Ne),tt,Ge],Ot=[Ne,Ge,tt];if(checkMoveTracesArgs(Ne,Ge,tt),Ge=Array.isArray(Ge)?Ge:[Ge],void 0===tt)for(tt=[],rt=0;rt<Ge.length;rt++)tt.push(-Ge.length+rt);for(tt=Array.isArray(tt)?tt:[tt],Ge=positivifyIndices(Ge,Ne.data.length-1),tt=positivifyIndices(tt,Ne.data.length-1),rt=0;rt<Ne.data.length;rt++)-1===Ge.indexOf(rt)&&nt.push(Ne.data[rt]);for(rt=0;rt<Ge.length;rt++)it.push({newIndex:tt[rt],trace:Ne.data[Ge[rt]]});for(it.sort((function(Ne,Ge){return Ne.newIndex-Ge.newIndex})),rt=0;rt<it.length;rt+=1)nt.splice(it[rt].newIndex,0,it[rt].trace);Ne.data=nt;var Rt=Qe.redraw(Ne);return dt.add(Ne,ot,Dt,ht,Ot),Rt}function restyle(Ne,Ge,tt,rt){Ne=at.getGraphDiv(Ne),xn.clearPromiseQueue(Ne);var nt={};if("string"==typeof Ge)nt[Ge]=tt;else{if(!at.isPlainObject(Ge))return at.warn("Restyle fail.",Ge,tt,rt),Promise.reject();nt=at.extendFlat({},Ge),void 0===rt&&(rt=tt)}Object.keys(nt).length&&(Ne.changed=!0);var it=xn.coerceTraceIndices(Ne,rt),ot=_restyle(Ne,nt,it),ht=ot.flags;ht.calc&&(Ne.calcdata=void 0),ht.clearAxisTypes&&xn.clearAxisTypes(Ne,it,{});var Dt=[];ht.fullReplot?Dt.push(Qe.plot):(Dt.push(Ot.previousPromises),Ot.supplyDefaults(Ne),ht.markerSize&&(Ot.doCalcdata(Ne),addAxRangeSequence(Dt)),ht.style&&Dt.push(kn.doTraceStyle),ht.colorbars&&Dt.push(kn.doColorBars),Dt.push(emitAfterPlot)),Dt.push(Ot.rehover,Ot.redrag),dt.add(Ne,restyle,[Ne,ot.undoit,ot.traces],restyle,[Ne,ot.redoit,ot.traces]);var Rt=at.syncOrAsync(Dt,Ne);return Rt&&Rt.then||(Rt=Promise.resolve()),Rt.then((function(){return Ne.emit("plotly_restyle",ot.eventData),Ne}))}function undefinedToNull(Ne){return void 0===Ne?null:Ne}function makeNP(Ne,Ge){return Ge?function(Ge,Qe,tt){var rt=it(Ge,Qe),nt=rt.set;return rt.set=function(Ge){storeCurrent((tt||"")+Qe,rt.get(),Ge,Ne),nt(Ge)},rt}:it}function storeCurrent(Ne,Ge,Qe,tt){if(Array.isArray(Ge)||Array.isArray(Qe))for(var rt=Array.isArray(Ge)?Ge:[],nt=Array.isArray(Qe)?Qe:[],it=Math.max(rt.length,nt.length),ot=0;ot<it;ot++)storeCurrent(Ne+"["+ot+"]",rt[ot],nt[ot],tt);else if(at.isPlainObject(Ge)||at.isPlainObject(Qe)){var dt=at.isPlainObject(Ge)?Ge:{},ht=at.isPlainObject(Qe)?Qe:{},Dt=at.extendFlat({},dt,ht);for(var Ot in Dt)storeCurrent(Ne+"."+Ot,dt[Ot],ht[Ot],tt)}else void 0===tt[Ne]&&(tt[Ne]=undefinedToNull(Ge))}function _storeDirectGUIEdit(Ne,Ge,Qe){for(var tt in Qe)storeCurrent(tt,it(Ne,tt).get(),Qe[tt],Ge)}function _restyle(Ne,Ge,Qe){var tt,rt=Ne._fullLayout,nt=Ne._fullData,ot=Ne.data,dt=rt._guiEditing,Rt=makeNP(rt._preGUI,dt),er=at.extendDeepAll({},Ge);cleanDeprecatedAttributeKeys(Ge);var dr,mr=Cn.traceFlags(),xr={},br={};function a0(){return Qe.map((function(){}))}function addToAxlist(Ne){var Ge=Zt.id2name(Ne);-1===dr.indexOf(Ge)&&dr.push(Ge)}function autorangeAttr(Ne){return"LAYOUT"+Ne+".autorange"}function rangeAttr(Ne){return"LAYOUT"+Ne+".range"}function getFullTrace(Ne){for(var Ge=Ne;Ge<nt.length;Ge++)if(nt[Ge]._input===ot[Ne])return nt[Ge]}function doextra(tt,nt,at){if(Array.isArray(tt))tt.forEach((function(Ne){doextra(Ne,nt,at)}));else if(!(tt in Ge)&&!xn.hasParent(Ge,tt)){var it;if("LAYOUT"===tt.substr(0,6))it=Rt(Ne.layout,tt.replace("LAYOUT",""));else{var ht=Qe[at];it=makeNP(rt._tracePreGUI[getFullTrace(ht)._fullInput.uid],dt)(ot[ht],tt)}tt in br||(br[tt]=a0()),void 0===br[tt][at]&&(br[tt][at]=undefinedToNull(it.get())),void 0!==nt&&it.set(nt)}}function allBins(Ne){return function(Ge){return nt[Ge][Ne]}}function arrayBins(Ne){return function(Ge,tt){return!1===Ge?nt[Qe[tt]][Ne]:null}}for(var Ar in Ge){if(xn.hasParent(Ge,Ar))throw new Error("cannot set "+Ar+" and a parent attribute simultaneously");var en,mn,kn,En,Pn,Dn,In=Ge[Ar];if("autobinx"!==Ar&&"autobiny"!==Ar||(Ar=Ar.charAt(Ar.length-1)+"bins",In=Array.isArray(In)?In.map(arrayBins(Ar)):!1===In?Qe.map(allBins(Ar)):null),xr[Ar]=In,"LAYOUT"!==Ar.substr(0,6)){for(br[Ar]=a0(),tt=0;tt<Qe.length;tt++)if(en=ot[Qe[tt]],mn=getFullTrace(Qe[tt]),En=(kn=makeNP(rt._tracePreGUI[mn._fullInput.uid],dt)(en,Ar)).get(),void 0!==(Pn=Array.isArray(In)?In[tt%In.length]:In)){var zn=kn.parts[kn.parts.length-1],Bn=Ar.substr(0,Ar.length-zn.length-1),Vn=Bn?Bn+".":"",Hn=Bn?it(mn,Bn).get():mn;if((Dn=Dt.getTraceValObject(mn,kn.parts))&&Dn.impliedEdits&&null!==Pn)for(var qn in Dn.impliedEdits)doextra(at.relativeAttr(Ar,qn),Dn.impliedEdits[qn],tt);else if("thicknessmode"!==zn&&"lenmode"!==zn||En===Pn||"fraction"!==Pn&&"pixels"!==Pn||!Hn){if("type"===Ar&&("pie"===Pn!=("pie"===En)||"funnelarea"===Pn!=("funnelarea"===En))){var Yn="x",$n="y";"bar"!==Pn&&"bar"!==En||"h"!==en.orientation||(Yn="y",$n="x"),at.swapAttrs(en,["?","?src"],"labels",Yn),at.swapAttrs(en,["d?","?0"],"label",Yn),at.swapAttrs(en,["?","?src"],"values",$n),"pie"===En||"funnelarea"===En?(it(en,"marker.color").set(it(en,"marker.colors").get()),rt._pielayer.selectAll("g.trace").remove()):ht.traceIs(en,"cartesian")&&it(en,"marker.colors").set(it(en,"marker.color").get())}}else{var ra=rt._size,oa=Hn.orient,pa="top"===oa||"bottom"===oa;if("thicknessmode"===zn){var ga=pa?ra.h:ra.w;doextra(Vn+"thickness",Hn.thickness*("fraction"===Pn?1/ga:ga),tt)}else{var ma=pa?ra.w:ra.h;doextra(Vn+"len",Hn.len*("fraction"===Pn?1/ma:ma),tt)}}if(br[Ar][tt]=undefinedToNull(En),-1!==["swapxy","swapxyaxes","orientation","orientationaxes"].indexOf(Ar)){if("orientation"===Ar){kn.set(Pn);var _a=en.x&&!en.y?"h":"v";if((kn.get()||_a)===mn.orientation)continue}else"orientationaxes"===Ar&&(en.orientation={v:"h",h:"v"}[mn.orientation]);xn.swapXYData(en),mr.calc=mr.clearAxisTypes=!0}else-1!==Ot.dataArrayContainers.indexOf(kn.parts[0])?(xn.manageArrayContainers(kn,Pn,br),mr.calc=!0):(Dn?Dn.arrayOk&&!ht.traceIs(mn,"regl")&&(at.isArrayOrTypedArray(Pn)||at.isArrayOrTypedArray(En))?mr.calc=!0:Cn.update(mr,Dn):mr.calc=!0,kn.set(Pn))}if(-1!==["swapxyaxes","orientationaxes"].indexOf(Ar)&&Zt.swap(Ne,Qe),"orientationaxes"===Ar){var Va=it(Ne.layout,"hovermode"),Wa=Va.get();"x"===Wa?Va.set("y"):"y"===Wa?Va.set("x"):"x unified"===Wa?Va.set("y unified"):"y unified"===Wa&&Va.set("x unified")}if(-1!==["orientation","type"].indexOf(Ar)){for(dr=[],tt=0;tt<Qe.length;tt++){var Qa=ot[Qe[tt]];ht.traceIs(Qa,"cartesian")&&(addToAxlist(Qa.xaxis||"x"),addToAxlist(Qa.yaxis||"y"))}doextra(dr.map(autorangeAttr),!0,0),doextra(dr.map(rangeAttr),[0,1],0)}}else kn=Rt(Ne.layout,Ar.replace("LAYOUT","")),br[Ar]=[undefinedToNull(kn.get())],kn.set(Array.isArray(In)?In[0]:In),mr.calc=!0}return(mr.calc||mr.plot)&&(mr.fullReplot=!0),{flags:mr,undoit:br,redoit:xr,traces:Qe,eventData:at.extendDeepNoArrays([],[er,Qe])}}function cleanDeprecatedAttributeKeys(Ne){var Ge,Qe,tt,rt=at.counterRegex("axis",".title",!1,!1),nt=/colorbar\.title$/,it=Object.keys(Ne);for(Ge=0;Ge<it.length;Ge++)Qe=it[Ge],tt=Ne[Qe],"title"!==Qe&&!rt.test(Qe)&&!nt.test(Qe)||"string"!=typeof tt&&"number"!=typeof tt?Qe.indexOf("titlefont")>-1?replace(Qe,Qe.replace("titlefont","title.font")):Qe.indexOf("titleposition")>-1?replace(Qe,Qe.replace("titleposition","title.position")):Qe.indexOf("titleside")>-1?replace(Qe,Qe.replace("titleside","title.side")):Qe.indexOf("titleoffset")>-1&&replace(Qe,Qe.replace("titleoffset","title.offset")):replace(Qe,Qe.replace("title","title.text"));function replace(Ge,Qe){Ne[Qe]=Ne[Ge],delete Ne[Ge]}}function relayout(Ne,Ge,Qe){if(Ne=at.getGraphDiv(Ne),xn.clearPromiseQueue(Ne),Ne.framework&&Ne.framework.isPolar)return Promise.resolve(Ne);var tt={};if("string"==typeof Ge)tt[Ge]=Qe;else{if(!at.isPlainObject(Ge))return at.warn("Relayout fail.",Ge,Qe),Promise.reject();tt=at.extendFlat({},Ge)}Object.keys(tt).length&&(Ne.changed=!0);var rt=_relayout(Ne,tt),nt=rt.flags;nt.calc&&(Ne.calcdata=void 0);var it=[Ot.previousPromises];nt.layoutReplot?it.push(kn.layoutReplot):Object.keys(tt).length&&(axRangeSupplyDefaultsByPass(Ne,nt,rt)||Ot.supplyDefaults(Ne),nt.legend&&it.push(kn.doLegend),nt.layoutstyle&&it.push(kn.layoutStyles),nt.axrange&&addAxRangeSequence(it,rt.rangesAltered),nt.ticks&&it.push(kn.doTicksRelayout),nt.modebar&&it.push(kn.doModeBar),nt.camera&&it.push(kn.doCamera),nt.colorbars&&it.push(kn.doColorBars),it.push(emitAfterPlot)),it.push(Ot.rehover,Ot.redrag),dt.add(Ne,relayout,[Ne,rt.undoit],relayout,[Ne,rt.redoit]);var ot=at.syncOrAsync(it,Ne);return ot&&ot.then||(ot=Promise.resolve(Ne)),ot.then((function(){return Ne.emit("plotly_relayout",rt.eventData),Ne}))}function axRangeSupplyDefaultsByPass(Ne,Ge,Qe){var tt=Ne._fullLayout;if(!Ge.axrange)return!1;for(var rt in Ge)if("axrange"!==rt&&Ge[rt])return!1;for(var nt in Qe.rangesAltered){var at=Zt.id2name(nt),it=Ne.layout[at],ot=tt[at];if(ot.autorange=it.autorange,it.range&&(ot.range=it.range.slice()),ot.cleanRange(),ot._matchGroup)for(var dt in ot._matchGroup)if(dt!==nt){var ht=tt[Zt.id2name(dt)];ht.autorange=ot.autorange,ht.range=ot.range.slice(),ht._input.range=ot.range.slice()}}return!0}function addAxRangeSequence(Ne,Ge){var Qe=Ge?function(Ne){var Qe=[],tt=!0;for(var rt in Ge){var nt=Zt.getFromId(Ne,rt);if(Qe.push(rt),-1!==(nt.ticklabelposition||"").indexOf("inside")&&nt._anchorAxis&&Qe.push(nt._anchorAxis._id),nt._matchGroup)for(var at in nt._matchGroup)Ge[at]||Qe.push(at);nt.automargin&&(tt=!1)}return Zt.draw(Ne,Qe,{skipTitle:tt})}:function(Ne){return Zt.draw(Ne,"redraw")};Ne.push(Ar,kn.doAutoRangeAndConstraints,Qe,kn.drawData,kn.finalDraw)}var In=/^[xyz]axis[0-9]*\.range(\[[0|1]\])?$/,zn=/^[xyz]axis[0-9]*\.autorange$/,Bn=/^[xyz]axis[0-9]*\.domain(\[[0|1]\])?$/;function _relayout(Ne,Ge){var Qe,tt,rt,nt=Ne.layout,ot=Ne._fullLayout,dt=ot._guiEditing,Ot=makeNP(ot._preGUI,dt),Rt=Object.keys(Ge),er=Zt.list(Ne),dr=at.extendDeepAll({},Ge),mr={};for(cleanDeprecatedAttributeKeys(Ge),Rt=Object.keys(Ge),tt=0;tt<Rt.length;tt++)if(0===Rt[tt].indexOf("allaxes")){for(rt=0;rt<er.length;rt++){var xr=er[rt]._id.substr(1),br=-1!==xr.indexOf("scene")?xr+".":"",Ar=Rt[tt].replace("allaxes",br+er[rt]._name);Ge[Ar]||(Ge[Ar]=Ge[Rt[tt]])}delete Ge[Rt[tt]]}var en=Cn.layoutFlags(),kn={},Pn={};function doextra(Ne,Qe){if(Array.isArray(Ne))Ne.forEach((function(Ne){doextra(Ne,Qe)}));else if(!(Ne in Ge)&&!xn.hasParent(Ge,Ne)){var tt=Ot(nt,Ne);Ne in Pn||(Pn[Ne]=undefinedToNull(tt.get())),void 0!==Qe&&tt.set(Qe)}}var Dn,Vn={};function recordAlteredAxis(Ne){var Ge=Zt.name2id(Ne.split(".")[0]);return Vn[Ge]=1,Ge}for(var Hn in Ge){if(xn.hasParent(Ge,Hn))throw new Error("cannot set "+Hn+" and a parent attribute simultaneously");for(var qn=Ot(nt,Hn),Yn=Ge[Hn],$n=qn.parts.length-1;$n>0&&"string"!=typeof qn.parts[$n];)$n--;var ra=qn.parts[$n],oa=qn.parts[$n-1]+"."+ra,pa=qn.parts.slice(0,$n).join("."),ga=it(Ne.layout,pa).get(),ma=it(ot,pa).get(),_a=qn.get();if(void 0!==Yn){kn[Hn]=Yn,Pn[Hn]="reverse"===ra?Yn:undefinedToNull(_a);var Va=Dt.getLayoutValObject(ot,qn.parts);if(Va&&Va.impliedEdits&&null!==Yn)for(var Wa in Va.impliedEdits)doextra(at.relativeAttr(Hn,Wa),Va.impliedEdits[Wa]);if(-1!==["width","height"].indexOf(Hn))if(Yn){doextra("autosize",null);var Qa="height"===Hn?"width":"height";doextra(Qa,ot[Qa])}else ot[Hn]=Ne._initialAutoSize[Hn];else if("autosize"===Hn)doextra("width",Yn?null:ot.width),doextra("height",Yn?null:ot.height);else if(oa.match(In))recordAlteredAxis(oa),it(ot,pa+"._inputRange").set(null);else if(oa.match(zn)){recordAlteredAxis(oa),it(ot,pa+"._inputRange").set(null);var ti=it(ot,pa).get();ti._inputDomain&&(ti._input.domain=ti._inputDomain.slice())}else oa.match(Bn)&&it(ot,pa+"._inputDomain").set(null);if("type"===ra){Dn=ga;var ni="linear"===ma.type&&"log"===Yn,di="log"===ma.type&&"linear"===Yn;if(ni||di){if(Dn&&Dn.range)if(ma.autorange)ni&&(Dn.range=Dn.range[1]>Dn.range[0]?[1,2]:[2,1]);else{var ji=Dn.range[0],Hi=Dn.range[1];ni?(ji<=0&&Hi<=0&&doextra(pa+".autorange",!0),ji<=0?ji=Hi/1e6:Hi<=0&&(Hi=ji/1e6),doextra(pa+".range[0]",Math.log(ji)/Math.LN10),doextra(pa+".range[1]",Math.log(Hi)/Math.LN10)):(doextra(pa+".range[0]",Math.pow(10,ji)),doextra(pa+".range[1]",Math.pow(10,Hi)))}else doextra(pa+".autorange",!0);Array.isArray(ot._subplots.polar)&&ot._subplots.polar.length&&ot[qn.parts[0]]&&"radialaxis"===qn.parts[1]&&delete ot[qn.parts[0]]._subplot.viewInitial["radialaxis.range"],ht.getComponentMethod("annotations","convertCoords")(Ne,ma,Yn,doextra),ht.getComponentMethod("images","convertCoords")(Ne,ma,Yn,doextra)}else doextra(pa+".autorange",!0),doextra(pa+".range",null);it(ot,pa+"._inputRange").set(null)}else if(ra.match(En)){var Yi=it(ot,Hn).get(),uo=(Yn||{}).type;uo&&"-"!==uo||(uo="linear"),ht.getComponentMethod("annotations","convertCoords")(Ne,Yi,uo,doextra),ht.getComponentMethod("images","convertCoords")(Ne,Yi,uo,doextra)}var go=mn.containerArrayMatch(Hn);if(go){Qe=go.array,tt=go.index;var ns=go.property,as=Va||{editType:"calc"};""!==tt&&""===ns&&(mn.isAddVal(Yn)?Pn[Hn]=null:mn.isRemoveVal(Yn)?Pn[Hn]=(it(nt,Qe).get()||[])[tt]:at.warn("unrecognized full object value",Ge)),Cn.update(en,as),mr[Qe]||(mr[Qe]={});var is=mr[Qe][tt];is||(is=mr[Qe][tt]={}),is[ns]=Yn,delete Ge[Hn]}else"reverse"===ra?(ga.range?ga.range.reverse():(doextra(pa+".autorange",!0),ga.range=[1,0]),ma.autorange?en.calc=!0:en.plot=!0):(ot._has("scatter-like")&&ot._has("regl")&&"dragmode"===Hn&&("lasso"===Yn||"select"===Yn)&&"lasso"!==_a&&"select"!==_a||ot._has("gl2d")?en.plot=!0:Va?Cn.update(en,Va):en.calc=!0,qn.set(Yn))}}for(Qe in mr)mn.applyContainerArrayChanges(Ne,Ot(nt,Qe),mr[Qe],en,Ot)||(en.plot=!0);for(var os in Vn){var ss=(Dn=Zt.getFromId(Ne,os))&&Dn._constraintGroup;if(ss)for(var cs in en.calc=!0,ss)Vn[cs]||(Zt.getFromId(Ne,cs)._constraintShrinkable=!0)}return(updateAutosize(Ne)||Ge.height||Ge.width)&&(en.plot=!0),(en.plot||en.calc)&&(en.layoutReplot=!0),{flags:en,rangesAltered:Vn,undoit:Pn,redoit:kn,eventData:dr}}function updateAutosize(Ne){var Ge=Ne._fullLayout,Qe=Ge.width,tt=Ge.height;return Ne.layout.autosize&&Ot.plotAutoSize(Ne,Ne.layout,Ge),Ge.width!==Qe||Ge.height!==tt}function update(Ne,Ge,tt,rt){if(Ne=at.getGraphDiv(Ne),xn.clearPromiseQueue(Ne),Ne.framework&&Ne.framework.isPolar)return Promise.resolve(Ne);at.isPlainObject(Ge)||(Ge={}),at.isPlainObject(tt)||(tt={}),Object.keys(Ge).length&&(Ne.changed=!0),Object.keys(tt).length&&(Ne.changed=!0);var nt=xn.coerceTraceIndices(Ne,rt),it=_restyle(Ne,at.extendFlat({},Ge),nt),ot=it.flags,ht=_relayout(Ne,at.extendFlat({},tt)),Dt=ht.flags;(ot.calc||Dt.calc)&&(Ne.calcdata=void 0),ot.clearAxisTypes&&xn.clearAxisTypes(Ne,nt,tt);var Rt=[];Dt.layoutReplot?Rt.push(kn.layoutReplot):ot.fullReplot?Rt.push(Qe.plot):(Rt.push(Ot.previousPromises),axRangeSupplyDefaultsByPass(Ne,Dt,ht)||Ot.supplyDefaults(Ne),ot.style&&Rt.push(kn.doTraceStyle),(ot.colorbars||Dt.colorbars)&&Rt.push(kn.doColorBars),Dt.legend&&Rt.push(kn.doLegend),Dt.layoutstyle&&Rt.push(kn.layoutStyles),Dt.axrange&&addAxRangeSequence(Rt,ht.rangesAltered),Dt.ticks&&Rt.push(kn.doTicksRelayout),Dt.modebar&&Rt.push(kn.doModeBar),Dt.camera&&Rt.push(kn.doCamera),Rt.push(emitAfterPlot)),Rt.push(Ot.rehover,Ot.redrag),dt.add(Ne,update,[Ne,it.undoit,ht.undoit,it.traces],update,[Ne,it.redoit,ht.redoit,it.traces]);var Zt=at.syncOrAsync(Rt,Ne);return Zt&&Zt.then||(Zt=Promise.resolve(Ne)),Zt.then((function(){return Ne.emit("plotly_update",{data:it.eventData,layout:ht.eventData}),Ne}))}function guiEdit(Ne){return function(Ge){Ge._fullLayout._guiEditing=!0;var Qe=Ne.apply(null,arguments);return Ge._fullLayout._guiEditing=!1,Qe}}var Vn=[{pattern:/^hiddenlabels/,attr:"legend.uirevision"},{pattern:/^((x|y)axis\d*)\.((auto)?range|title\.text)/},{pattern:/axis\d*\.showspikes$/,attr:"modebar.uirevision"},{pattern:/(hover|drag)mode$/,attr:"modebar.uirevision"},{pattern:/^(scene\d*)\.camera/},{pattern:/^(geo\d*)\.(projection|center|fitbounds)/},{pattern:/^(ternary\d*\.[abc]axis)\.(min|title\.text)$/},{pattern:/^(polar\d*\.radialaxis)\.((auto)?range|angle|title\.text)/},{pattern:/^(polar\d*\.angularaxis)\.rotation/},{pattern:/^(mapbox\d*)\.(center|zoom|bearing|pitch)/},{pattern:/^legend\.(x|y)$/,attr:"editrevision"},{pattern:/^(shapes|annotations)/,attr:"editrevision"},{pattern:/^title\.text$/,attr:"editrevision"}],Hn=[{pattern:/^selectedpoints$/,attr:"selectionrevision"},{pattern:/(^|value\.)visible$/,attr:"legend.uirevision"},{pattern:/^dimensions\[\d+\]\.constraintrange/},{pattern:/^node\.(x|y|groups)/},{pattern:/^level$/},{pattern:/(^|value\.)name$/},{pattern:/colorbar\.title\.text$/},{pattern:/colorbar\.(x|y)$/,attr:"editrevision"}];function findUIPattern(Ne,Ge){for(var Qe=0;Qe<Ge.length;Qe++){var tt=Ge[Qe],rt=Ne.match(tt.pattern);if(rt)return{head:rt[1],attr:tt.attr}}}function getNewRev(Ne,Ge){var Qe=it(Ge,Ne).get();if(void 0!==Qe)return Qe;var tt=Ne.split(".");for(tt.pop();tt.length>1;)if(tt.pop(),void 0!==(Qe=it(Ge,tt.join(".")+".uirevision").get()))return Qe;return Ge.uirevision}function getFullTraceIndexFromUid(Ne,Ge){for(var Qe=0;Qe<Ge.length;Qe++)if(Ge[Qe]._fullInput.uid===Ne)return Qe;return-1}function getTraceIndexFromUid(Ne,Ge,Qe){for(var tt=0;tt<Ge.length;tt++)if(Ge[tt].uid===Ne)return tt;return!Ge[Qe]||Ge[Qe].uid?-1:Qe}function valsMatch(Ne,Ge){var Qe=at.isPlainObject(Ne),tt=Array.isArray(Ne);return Qe||tt?(Qe&&at.isPlainObject(Ge)||tt&&Array.isArray(Ge))&&JSON.stringify(Ne)===JSON.stringify(Ge):Ne===Ge}function applyUIRevisions(Ne,Ge,Qe,tt){var rt,nt,ot,dt,ht,Dt,Ot,Rt,Zt=tt._preGUI,er=[],dr={};for(rt in Zt){if(ht=findUIPattern(rt,Vn)){if(nt=ht.attr||ht.head+".uirevision",(dt=(ot=it(tt,nt).get())&&getNewRev(nt,Ge))&&dt===ot&&(null===(Dt=Zt[rt])&&(Dt=void 0),valsMatch(Rt=(Ot=it(Ge,rt)).get(),Dt))){void 0===Rt&&"autorange"===rt.substr(rt.length-9)&&er.push(rt.substr(0,rt.length-10)),Ot.set(undefinedToNull(it(tt,rt).get()));continue}}else at.warn("unrecognized GUI edit: "+rt);delete Zt[rt],"range["===rt.substr(rt.length-8,6)&&(dr[rt.substr(0,rt.length-9)]=1)}for(var mr=0;mr<er.length;mr++){var xr=er[mr];if(dr[xr]){var br=it(Ge,xr).get();br&&delete br.autorange}}var Ar=tt._tracePreGUI;for(var en in Ar){var mn,xn=Ar[en],kn=null;for(rt in xn){if(!kn){var Cn=getFullTraceIndexFromUid(en,Qe);if(Cn<0){delete Ar[en];break}var En=getTraceIndexFromUid(en,Ne,(mn=Qe[Cn]._fullInput).index);if(En<0){delete Ar[en];break}kn=Ne[En]}if(ht=findUIPattern(rt,Hn)){if(ht.attr?dt=(ot=it(tt,ht.attr).get())&&getNewRev(ht.attr,Ge):(ot=mn.uirevision,void 0===(dt=kn.uirevision)&&(dt=Ge.uirevision)),dt&&dt===ot&&(null===(Dt=xn[rt])&&(Dt=void 0),valsMatch(Rt=(Ot=it(kn,rt)).get(),Dt))){Ot.set(undefinedToNull(it(mn,rt).get()));continue}}else at.warn("unrecognized GUI edit: "+rt+" in trace uid "+en);delete xn[rt]}}}function react(Ne,Ge,tt,rt){var nt,it;function addFrames(){return Qe.addFrames(Ne,nt)}Ne=at.getGraphDiv(Ne),xn.clearPromiseQueue(Ne);var ot=Ne._fullData,dt=Ne._fullLayout;if(at.isPlotDiv(Ne)&&ot&&dt){if(at.isPlainObject(Ge)){var Dt=Ge;Ge=Dt.data,tt=Dt.layout,rt=Dt.config,nt=Dt.frames}var Rt=!1;if(rt){var Zt=at.extendDeep({},Ne._context);Ne._context=void 0,setPlotContext(Ne,rt),Rt=diffConfig(Zt,Ne._context)}Ne.data=Ge||[],xn.cleanData(Ne.data),Ne.layout=tt||{},xn.cleanLayout(Ne.layout),applyUIRevisions(Ne.data,Ne.layout,ot,dt),Ot.supplyDefaults(Ne,{skipUpdateCalc:!0});var er=Ne._fullData,dr=Ne._fullLayout,mr=void 0===dr.datarevision,xr=dr.transition,br=diffLayout(Ne,dt,dr,mr,xr),Ar=br.newDataRevision,en=diffData(Ne,ot,er,mr,xr,Ar);if(updateAutosize(Ne)&&(br.layoutReplot=!0),en.calc||br.calc){Ne.calcdata=void 0;for(var mn=Object.getOwnPropertyNames(dr),Cn=0;Cn<mn.length;Cn++){var En=mn[Cn],Pn=En.substring(0,5);if("xaxis"===Pn||"yaxis"===Pn){var Dn=dr[En]._emptyCategories;Dn&&Dn()}}}else Ot.supplyDefaultsUpdateCalc(Ne.calcdata,er);var In=[];if(nt&&(Ne._transitionData={},Ot.createTransitionData(Ne),In.push(addFrames)),dr.transition&&!Rt&&(en.anim||br.anim))br.ticks&&In.push(kn.doTicksRelayout),Ot.doCalcdata(Ne),kn.doAutoRangeAndConstraints(Ne),In.push((function(){return Ot.transitionFromReact(Ne,en,br,dt)}));else if(en.fullReplot||br.layoutReplot||Rt)Ne._fullLayout._skipDefaults=!0,In.push(Qe.plot);else{for(var zn in br.arrays){var Bn=br.arrays[zn];if(Bn.length){var Vn=ht.getComponentMethod(zn,"drawOne");if(Vn!==at.noop)for(var Hn=0;Hn<Bn.length;Hn++)Vn(Ne,Bn[Hn]);else{var qn=ht.getComponentMethod(zn,"draw");if(qn===at.noop)throw new Error("cannot draw components: "+zn);qn(Ne)}}}In.push(Ot.previousPromises),en.style&&In.push(kn.doTraceStyle),(en.colorbars||br.colorbars)&&In.push(kn.doColorBars),br.legend&&In.push(kn.doLegend),br.layoutstyle&&In.push(kn.layoutStyles),br.axrange&&addAxRangeSequence(In),br.ticks&&In.push(kn.doTicksRelayout),br.modebar&&In.push(kn.doModeBar),br.camera&&In.push(kn.doCamera),In.push(emitAfterPlot)}In.push(Ot.rehover,Ot.redrag),(it=at.syncOrAsync(In,Ne))&&it.then||(it=Promise.resolve(Ne))}else it=Qe.newPlot(Ne,Ge,tt,rt);return it.then((function(){return Ne.emit("plotly_react",{data:Ge,layout:tt}),Ne}))}function diffData(Ne,Ge,Qe,tt,rt,nt){var at=Ge.length===Qe.length;if(!rt&&!at)return{fullReplot:!0,calc:!0};var it,ot,dt=Cn.traceFlags();function getTraceValObject(Ne){var Ge=Dt.getTraceValObject(ot,Ne);return!ot._module.animatable&&Ge.anim&&(Ge.anim=!1),Ge}dt.arrays={},dt.nChanges=0,dt.nChangesAnim=0;var ht={getValObject:getTraceValObject,flags:dt,immutable:tt,transition:rt,newDataRevision:nt,gd:Ne},Rt={};for(it=0;it<Ge.length;it++)if(Qe[it]){if(ot=Qe[it]._fullInput,Ot.hasMakesDataTransform(ot)&&(ot=Qe[it]),Rt[ot.uid])continue;Rt[ot.uid]=1,getDiffFlags(Ge[it]._fullInput,ot,[],ht)}return(dt.calc||dt.plot)&&(dt.fullReplot=!0),rt&&dt.nChanges&&dt.nChangesAnim&&(dt.anim=dt.nChanges===dt.nChangesAnim&&at?"all":"some"),dt}function diffLayout(Ne,Ge,Qe,tt,rt){var nt=Cn.layoutFlags();function getLayoutValObject(Ne){return Dt.getLayoutValObject(Qe,Ne)}return nt.arrays={},nt.rangesAltered={},nt.nChanges=0,nt.nChangesAnim=0,getDiffFlags(Ge,Qe,[],{getValObject:getLayoutValObject,flags:nt,immutable:tt,transition:rt,gd:Ne}),(nt.plot||nt.calc)&&(nt.layoutReplot=!0),rt&&nt.nChanges&&nt.nChangesAnim&&(nt.anim=nt.nChanges===nt.nChangesAnim?"all":"some"),nt}function getDiffFlags(Ne,Ge,Qe,tt){var rt,nt,ot,dt=tt.getValObject,ht=tt.flags,Dt=tt.immutable,Ot=tt.inArray,Rt=tt.arrayIndex;function changed(){var Ne=rt.editType;Ot&&-1!==Ne.indexOf("arraydraw")?at.pushUnique(ht.arrays[Ot],Rt):(Cn.update(ht,rt),"none"!==Ne&&ht.nChanges++,tt.transition&&rt.anim&&ht.nChangesAnim++,(In.test(ot)||zn.test(ot))&&(ht.rangesAltered[Qe[0]]=1),Bn.test(ot)&&it(Ge,"_inputDomain").set(null),"datarevision"===nt&&(ht.newDataRevision=1))}function valObjectCanBeDataArray(Ne){return"data_array"===Ne.valType||Ne.arrayOk}for(nt in Ne){if(ht.calc&&!tt.transition)return;var Zt=Ne[nt],er=Ge[nt],dr=Qe.concat(nt);if(ot=dr.join("."),"_"!==nt.charAt(0)&&"function"!=typeof Zt&&Zt!==er){if(("tick0"===nt||"dtick"===nt)&&"geo"!==Qe[0]){var mr=Ge.tickmode;if("auto"===mr||"array"===mr||!mr)continue}if(("range"!==nt||!Ge.autorange)&&("zmin"!==nt&&"zmax"!==nt||"contourcarpet"!==Ge.type)&&(rt=dt(dr))&&(!rt._compareAsJSON||JSON.stringify(Zt)!==JSON.stringify(er))){var xr,br=rt.valType,Ar=valObjectCanBeDataArray(rt),en=Array.isArray(Zt),mn=Array.isArray(er);if(en&&mn){var xn="_input_"+nt,kn=Ne[xn],En=Ge[xn];if(Array.isArray(kn)&&kn===En)continue}if(void 0===er)Ar&&en?ht.calc=!0:changed();else if(rt._isLinkedToArray){var Pn=[],Dn=!1;Ot||(ht.arrays[nt]=Pn);var Vn=Math.min(Zt.length,er.length),Hn=Math.max(Zt.length,er.length);if(Vn!==Hn){if("arraydraw"!==rt.editType){changed();continue}Dn=!0}for(xr=0;xr<Vn;xr++)getDiffFlags(Zt[xr],er[xr],dr.concat(xr),at.extendFlat({inArray:nt,arrayIndex:xr},tt));if(Dn)for(xr=Vn;xr<Hn;xr++)Pn.push(xr)}else!br&&at.isPlainObject(Zt)?getDiffFlags(Zt,er,dr,tt):Ar?en&&mn?(Dt&&(ht.calc=!0),(Dt||tt.newDataRevision)&&changed()):en!==mn?ht.calc=!0:changed():en&&mn&&Zt.length===er.length&&String(Zt)===String(er)||changed()}}}for(nt in Ge)if(!(nt in Ne)&&"_"!==nt.charAt(0)&&"function"!=typeof Ge[nt]){if(valObjectCanBeDataArray(rt=dt(Qe.concat(nt)))&&Array.isArray(Ge[nt]))return void(ht.calc=!0);changed()}}function diffConfig(Ne,Ge){var Qe;for(Qe in Ne)if("_"!==Qe.charAt(0)){var tt=Ne[Qe],rt=Ge[Qe];if(tt!==rt)if(at.isPlainObject(tt)&&at.isPlainObject(rt)){if(diffConfig(tt,rt))return!0}else{if(!Array.isArray(tt)||!Array.isArray(rt))return!0;if(tt.length!==rt.length)return!0;for(var nt=0;nt<tt.length;nt++)if(tt[nt]!==rt[nt]){if(!at.isPlainObject(tt[nt])||!at.isPlainObject(rt[nt]))return!0;if(diffConfig(tt[nt],rt[nt]))return!0}}}}function animate(Ne,Ge,Qe){if(Ne=at.getGraphDiv(Ne),!at.isPlotDiv(Ne))throw new Error("This element is not a Plotly plot: "+Ne+". It's likely that you've failed to create a plot before animating it. For more details, see https://plotly.com/javascript/animations/");var tt=Ne._transitionData;tt._frameQueue||(tt._frameQueue=[]);var rt=(Qe=Ot.supplyAnimationDefaults(Qe)).transition,nt=Qe.frame;function getTransitionOpts(Ne){return Array.isArray(rt)?Ne>=rt.length?rt[0]:rt[Ne]:rt}function getFrameOpts(Ne){return Array.isArray(nt)?Ne>=nt.length?nt[0]:nt[Ne]:nt}function callbackOnNthTime(Ne,Ge){var Qe=0;return function(){if(Ne&&++Qe===Ge)return Ne()}}return void 0===tt._frameWaitingCnt&&(tt._frameWaitingCnt=0),new Promise((function(nt,it){function discardExistingFrames(){if(0!==tt._frameQueue.length){for(;tt._frameQueue.length;){var Ge=tt._frameQueue.pop();Ge.onInterrupt&&Ge.onInterrupt()}Ne.emit("plotly_animationinterrupted",[])}}function queueFrames(Ge){if(0!==Ge.length){for(var rt=0;rt<Ge.length;rt++){var at;at="byname"===Ge[rt].type?Ot.computeFrame(Ne,Ge[rt].name):Ge[rt].data;var ot=getFrameOpts(rt),dt=getTransitionOpts(rt);dt.duration=Math.min(dt.duration,ot.duration);var ht={frame:at,name:Ge[rt].name,frameOpts:ot,transitionOpts:dt};rt===Ge.length-1&&(ht.onComplete=callbackOnNthTime(nt,2),ht.onInterrupt=it),tt._frameQueue.push(ht)}"immediate"===Qe.mode&&(tt._lastFrameAt=-1/0),tt._animationRaf||beginAnimationLoop()}}function stopAnimationLoop(){Ne.emit("plotly_animated"),window.cancelAnimationFrame(tt._animationRaf),tt._animationRaf=null}function nextFrame(){tt._currentFrame&&tt._currentFrame.onComplete&&tt._currentFrame.onComplete();var Ge=tt._currentFrame=tt._frameQueue.shift();if(Ge){var Qe=Ge.name?Ge.name.toString():null;Ne._fullLayout._currentFrame=Qe,tt._lastFrameAt=Date.now(),tt._timeToNext=Ge.frameOpts.duration,Ot.transition(Ne,Ge.frame.data,Ge.frame.layout,xn.coerceTraceIndices(Ne,Ge.frame.traces),Ge.frameOpts,Ge.transitionOpts).then((function(){Ge.onComplete&&Ge.onComplete()})),Ne.emit("plotly_animatingframe",{name:Qe,frame:Ge.frame,animation:{frame:Ge.frameOpts,transition:Ge.transitionOpts}})}else stopAnimationLoop()}function beginAnimationLoop(){Ne.emit("plotly_animating"),tt._lastFrameAt=-1/0,tt._timeToNext=0,tt._runningTransitions=0,tt._currentFrame=null;var doFrame=function(){tt._animationRaf=window.requestAnimationFrame(doFrame),Date.now()-tt._lastFrameAt>tt._timeToNext&&nextFrame()};doFrame()}var ot,dt,ht=0;function setTransitionConfig(Ne){return Array.isArray(rt)?ht>=rt.length?Ne.transitionOpts=rt[ht]:Ne.transitionOpts=rt[0]:Ne.transitionOpts=rt,ht++,Ne}var Dt=[],Rt=null==Ge,Zt=Array.isArray(Ge);if(Rt||Zt||!at.isPlainObject(Ge)){if(Rt||-1!==["string","number"].indexOf(typeof Ge))for(ot=0;ot<tt._frames.length;ot++)(dt=tt._frames[ot])&&(Rt||String(dt.group)===String(Ge))&&Dt.push({type:"byname",name:String(dt.name),data:setTransitionConfig({name:dt.name})});else if(Zt)for(ot=0;ot<Ge.length;ot++){var er=Ge[ot];-1!==["number","string"].indexOf(typeof er)?(er=String(er),Dt.push({type:"byname",name:er,data:setTransitionConfig({name:er})})):at.isPlainObject(er)&&Dt.push({type:"object",data:setTransitionConfig(at.extendFlat({},er))})}}else Dt.push({type:"object",data:setTransitionConfig(at.extendFlat({},Ge))});for(ot=0;ot<Dt.length;ot++)if("byname"===(dt=Dt[ot]).type&&!tt._frameHash[dt.data.name])return at.warn('animate failure: frame not found: "'+dt.data.name+'"'),void it();-1!==["next","immediate"].indexOf(Qe.mode)&&discardExistingFrames(),"reverse"===Qe.direction&&Dt.reverse();var dr=Ne._fullLayout._currentFrame;if(dr&&Qe.fromcurrent){var mr=-1;for(ot=0;ot<Dt.length;ot++)if("byname"===(dt=Dt[ot]).type&&dt.name===dr){mr=ot;break}if(mr>0&&mr<Dt.length-1){var xr=[];for(ot=0;ot<Dt.length;ot++)dt=Dt[ot],("byname"!==Dt[ot].type||ot>mr)&&xr.push(dt);Dt=xr}}Dt.length>0?queueFrames(Dt):(Ne.emit("plotly_animated"),nt())}))}function addFrames(Ne,Ge,Qe){if(Ne=at.getGraphDiv(Ne),null==Ge)return Promise.resolve();if(!at.isPlotDiv(Ne))throw new Error("This element is not a Plotly plot: "+Ne+". It's likely that you've failed to create a plot before adding frames. For more details, see https://plotly.com/javascript/animations/");var tt,rt,nt,it,ot=Ne._transitionData._frames,ht=Ne._transitionData._frameHash;if(!Array.isArray(Ge))throw new Error("addFrames failure: frameList must be an Array of frame definitions"+Ge);var Dt=ot.length+2*Ge.length,Rt=[],Zt={};for(tt=Ge.length-1;tt>=0;tt--)if(at.isPlainObject(Ge[tt])){var er=Ge[tt].name,dr=(ht[er]||Zt[er]||{}).name,mr=Ge[tt].name,xr=ht[dr]||Zt[dr];dr&&mr&&"number"==typeof mr&&xr&&Pn<Dn&&(Pn++,at.warn('addFrames: overwriting frame "'+(ht[dr]||Zt[dr]).name+'" with a frame whose name of type "number" also equates to "'+dr+'". This is valid but may potentially lead to unexpected behavior since all plotly.js frame names are stored internally as strings.'),Pn===Dn&&at.warn("addFrames: This API call has yielded too many of these warnings. For the rest of this call, further warnings about numeric frame names will be suppressed.")),Zt[er]={name:er},Rt.push({frame:Ot.supplyFrameDefaults(Ge[tt]),index:Qe&&void 0!==Qe[tt]&&null!==Qe[tt]?Qe[tt]:Dt+tt})}Rt.sort((function(Ne,Ge){return Ne.index>Ge.index?-1:Ne.index<Ge.index?1:0}));var br=[],Ar=[],en=ot.length;for(tt=Rt.length-1;tt>=0;tt--){if("number"==typeof(rt=Rt[tt].frame).name&&at.warn("Warning: addFrames accepts frames with numeric names, but the numbers areimplicitly cast to strings"),!rt.name)for(;ht[rt.name="frame "+Ne._transitionData._counter++];);if(ht[rt.name]){for(nt=0;nt<ot.length&&(ot[nt]||{}).name!==rt.name;nt++);br.push({type:"replace",index:nt,value:rt}),Ar.unshift({type:"replace",index:nt,value:ot[nt]})}else it=Math.max(0,Math.min(Rt[tt].index,en)),br.push({type:"insert",index:it,value:rt}),Ar.unshift({type:"delete",index:it}),en++}var mn=Ot.modifyFrames,xn=Ot.modifyFrames,kn=[Ne,Ar],Cn=[Ne,br];return dt&&dt.add(Ne,mn,kn,xn,Cn),Ot.modifyFrames(Ne,br)}function deleteFrames(Ne,Ge){if(Ne=at.getGraphDiv(Ne),!at.isPlotDiv(Ne))throw new Error("This element is not a Plotly plot: "+Ne);var Qe,tt,rt=Ne._transitionData._frames,nt=[],it=[];if(!Ge)for(Ge=[],Qe=0;Qe<rt.length;Qe++)Ge.push(Qe);for((Ge=Ge.slice()).sort(),Qe=Ge.length-1;Qe>=0;Qe--)tt=Ge[Qe],nt.push({type:"delete",index:tt}),it.unshift({type:"insert",index:tt,value:rt[tt]});var ot=Ot.modifyFrames,ht=Ot.modifyFrames,Dt=[Ne,it],Rt=[Ne,nt];return dt&&dt.add(Ne,ot,Dt,ht,Rt),Ot.modifyFrames(Ne,nt)}function purge(Ne){var Ge=(Ne=at.getGraphDiv(Ne))._fullLayout||{},Qe=Ne._fullData||[];return Ot.cleanPlot([],{},Qe,Ge),Ot.purge(Ne),ot.purge(Ne),Ge._container&&Ge._container.remove(),delete Ne._context,Ne}function calcInverseTransform(Ne){var Ge=Ne._fullLayout,Qe=Ne.getBoundingClientRect();if(!at.equalDomRects(Qe,Ge._lastBBox)){var tt=Ge._invTransform=at.inverseTransformMatrix(at.getFullTransformMatrix(Ne));Ge._invScaleX=Math.sqrt(tt[0][0]*tt[0][0]+tt[0][1]*tt[0][1]+tt[0][2]*tt[0][2]),Ge._invScaleY=Math.sqrt(tt[1][0]*tt[1][0]+tt[1][1]*tt[1][1]+tt[1][2]*tt[1][2]),Ge._lastBBox=Qe}}function makePlotFramework(Ne){var Ge=tt.select(Ne),Qe=Ne._fullLayout;if(Qe._calcInverseTransform=calcInverseTransform,Qe._calcInverseTransform(Ne),Qe._container=Ge.selectAll(".plot-container").data([0]),Qe._container.enter().insert("div",":first-child").classed("plot-container",!0).classed("plotly",!0),Qe._paperdiv=Qe._container.selectAll(".svg-container").data([0]),Qe._paperdiv.enter().append("div").classed("user-select-none",!0).classed("svg-container",!0).style("position","relative"),Qe._glcontainer=Qe._paperdiv.selectAll(".gl-container").data([{}]),Qe._glcontainer.enter().append("div").classed("gl-container",!0),Qe._paperdiv.selectAll(".main-svg").remove(),Qe._paperdiv.select(".modebar-container").remove(),Qe._paper=Qe._paperdiv.insert("svg",":first-child").classed("main-svg",!0),Qe._toppaper=Qe._paperdiv.append("svg").classed("main-svg",!0),Qe._modebardiv=Qe._paperdiv.append("div"),delete Qe._modeBar,Qe._hoverpaper=Qe._paperdiv.append("svg").classed("main-svg",!0),!Qe._uid){var rt={};tt.selectAll("defs").each((function(){this.id&&(rt[this.id.split("-")[1]]=1)})),Qe._uid=at.randstr(rt)}Qe._paperdiv.selectAll(".main-svg").attr(xr.svgAttrs),Qe._defs=Qe._paper.append("defs").attr("id","defs-"+Qe._uid),Qe._clips=Qe._defs.append("g").classed("clips",!0),Qe._topdefs=Qe._toppaper.append("defs").attr("id","topdefs-"+Qe._uid),Qe._topclips=Qe._topdefs.append("g").classed("clips",!0),Qe._bgLayer=Qe._paper.append("g").classed("bglayer",!0),Qe._draggers=Qe._paper.append("g").classed("draglayer",!0);var nt=Qe._paper.append("g").classed("layer-below",!0);Qe._imageLowerLayer=nt.append("g").classed("imagelayer",!0),Qe._shapeLowerLayer=nt.append("g").classed("shapelayer",!0),Qe._cartesianlayer=Qe._paper.append("g").classed("cartesianlayer",!0),Qe._polarlayer=Qe._paper.append("g").classed("polarlayer",!0),Qe._ternarylayer=Qe._paper.append("g").classed("ternarylayer",!0),Qe._geolayer=Qe._paper.append("g").classed("geolayer",!0),Qe._funnelarealayer=Qe._paper.append("g").classed("funnelarealayer",!0),Qe._pielayer=Qe._paper.append("g").classed("pielayer",!0),Qe._treemaplayer=Qe._paper.append("g").classed("treemaplayer",!0),Qe._sunburstlayer=Qe._paper.append("g").classed("sunburstlayer",!0),Qe._indicatorlayer=Qe._toppaper.append("g").classed("indicatorlayer",!0),Qe._glimages=Qe._paper.append("g").classed("glimages",!0);var it=Qe._toppaper.append("g").classed("layer-above",!0);Qe._imageUpperLayer=it.append("g").classed("imagelayer",!0),Qe._shapeUpperLayer=it.append("g").classed("shapelayer",!0),Qe._infolayer=Qe._toppaper.append("g").classed("infolayer",!0),Qe._menulayer=Qe._toppaper.append("g").classed("menulayer",!0),Qe._zoomlayer=Qe._toppaper.append("g").classed("zoomlayer",!0),Qe._hoverlayer=Qe._hoverpaper.append("g").classed("hoverlayer",!0),Qe._modebardiv.classed("modebar-container",!0).style("position","absolute").style("top","0px").style("right","0px"),Ne.emit("plotly_framework")}Qe.animate=animate,Qe.addFrames=addFrames,Qe.deleteFrames=deleteFrames,Qe.addTraces=addTraces,Qe.deleteTraces=deleteTraces,Qe.extendTraces=extendTraces,Qe.moveTraces=moveTraces,Qe.prependTraces=prependTraces,Qe.newPlot=newPlot,Qe.plot=plot,Qe.purge=purge,Qe.react=react,Qe.redraw=redraw,Qe.relayout=relayout,Qe.restyle=restyle,Qe.setPlotConfig=setPlotConfig,Qe.update=update,Qe._guiRelayout=guiEdit(relayout),Qe._guiRestyle=guiEdit(restyle),Qe._guiUpdate=guiEdit(update),Qe._storeDirectGUIEdit=_storeDirectGUIEdit},{"../components/color":643,"../components/drawing":665,"../constants/xmlns_namespaces":754,"../lib":778,"../lib/events":767,"../lib/queue":794,"../lib/svg_text_utils":803,"../plots/cartesian/axes":828,"../plots/cartesian/constants":834,"../plots/cartesian/graph_interact":837,"../plots/cartesian/select":847,"../plots/plots":891,"../plots/polar/legacy":899,"../registry":911,"./edit_types":810,"./helpers":811,"./manage_arrays":813,"./plot_config":815,"./plot_schema":816,"./subroutines":818,d3:169,"fast-isnumeric":241,"has-hover":440}],815:[function(Ne,Ge,Qe){"use strict";var tt={staticPlot:{valType:"boolean",dflt:!1},plotlyServerURL:{valType:"string",dflt:""},editable:{valType:"boolean",dflt:!1},edits:{annotationPosition:{valType:"boolean",dflt:!1},annotationTail:{valType:"boolean",dflt:!1},annotationText:{valType:"boolean",dflt:!1},axisTitleText:{valType:"boolean",dflt:!1},colorbarPosition:{valType:"boolean",dflt:!1},colorbarTitleText:{valType:"boolean",dflt:!1},legendPosition:{valType:"boolean",dflt:!1},legendText:{valType:"boolean",dflt:!1},shapePosition:{valType:"boolean",dflt:!1},titleText:{valType:"boolean",dflt:!1}},autosizable:{valType:"boolean",dflt:!1},responsive:{valType:"boolean",dflt:!1},fillFrame:{valType:"boolean",dflt:!1},frameMargins:{valType:"number",dflt:0,min:0,max:.5},scrollZoom:{valType:"flaglist",flags:["cartesian","gl3d","geo","mapbox"],extras:[!0,!1],dflt:"gl3d+geo+mapbox"},doubleClick:{valType:"enumerated",values:[!1,"reset","autosize","reset+autosize"],dflt:"reset+autosize"},doubleClickDelay:{valType:"number",dflt:300,min:0},showAxisDragHandles:{valType:"boolean",dflt:!0},showAxisRangeEntryBoxes:{valType:"boolean",dflt:!0},showTips:{valType:"boolean",dflt:!0},showLink:{valType:"boolean",dflt:!1},linkText:{valType:"string",dflt:"Edit chart",noBlank:!0},sendData:{valType:"boolean",dflt:!0},showSources:{valType:"any",dflt:!1},displayModeBar:{valType:"enumerated",values:["hover",!0,!1],dflt:"hover"},showSendToCloud:{valType:"boolean",dflt:!1},showEditInChartStudio:{valType:"boolean",dflt:!1},modeBarButtonsToRemove:{valType:"any",dflt:[]},modeBarButtonsToAdd:{valType:"any",dflt:[]},modeBarButtons:{valType:"any",dflt:!1},toImageButtonOptions:{valType:"any",dflt:{}},displaylogo:{valType:"boolean",dflt:!0},watermark:{valType:"boolean",dflt:!1},plotGlPixelRatio:{valType:"number",dflt:2,min:1,max:4},setBackground:{valType:"any",dflt:"transparent"},topojsonURL:{valType:"string",noBlank:!0,dflt:"https://cdn.plot.ly/"},mapboxAccessToken:{valType:"string",dflt:null},logging:{valType:"integer",min:0,max:2,dflt:1},notifyOnLogging:{valType:"integer",min:0,max:2,dflt:0},queueLength:{valType:"integer",min:0,dflt:0},globalTransforms:{valType:"any",dflt:[]},locale:{valType:"string",dflt:"en-US"},locales:{valType:"any",dflt:{}}},rt={};function crawl(Ne,Ge){for(var Qe in Ne){var tt=Ne[Qe];tt.valType?Ge[Qe]=tt.dflt:(Ge[Qe]||(Ge[Qe]={}),crawl(tt,Ge[Qe]))}}crawl(tt,rt),Ge.exports={configAttributes:tt,dfltConfig:rt}},{}],816:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../registry"),rt=Ne("../lib"),nt=Ne("../plots/attributes"),at=Ne("../plots/layout_attributes"),it=Ne("../plots/frame_attributes"),ot=Ne("../plots/animation_attributes"),dt=Ne("./plot_config").configAttributes,ht=Ne("../plots/polar/legacy/area_attributes"),Dt=Ne("../plots/polar/legacy/axis_attributes"),Ot=Ne("./edit_types"),Rt=rt.extendFlat,Zt=rt.extendDeepAll,er=rt.isPlainObject,dr=rt.isArrayOrTypedArray,mr=rt.nestedProperty,xr=rt.valObjectMeta,br="_isSubplotObj",Ar="_isLinkedToArray",en="_deprecated",mn=[br,Ar,"_arrayAttrRegexps",en];function layoutHeadAttr(Ne,Ge){var Qe,rt,nt,it,ot=Ne._basePlotModules;if(ot){var dt;for(Qe=0;Qe<ot.length;Qe++){if((nt=ot[Qe]).attrRegex&&nt.attrRegex.test(Ge)){if(nt.layoutAttrOverrides)return nt.layoutAttrOverrides;!dt&&nt.layoutAttributes&&(dt=nt.layoutAttributes)}var ht=nt.baseLayoutAttrOverrides;if(ht&&Ge in ht)return ht[Ge]}if(dt)return dt}var Ot=Ne._modules;if(Ot)for(Qe=0;Qe<Ot.length;Qe++)if((it=Ot[Qe].layoutAttributes)&&Ge in it)return it[Ge];for(rt in tt.componentsRegistry){if("colorscale"===(nt=tt.componentsRegistry[rt]).name&&0===Ge.indexOf("coloraxis"))return nt.layoutAttributes[Ge];if(!nt.schema&&Ge===nt.name)return nt.layoutAttributes}return Ge in at?at[Ge]:"radialaxis"===Ge||"angularaxis"===Ge?Dt[Ge]:Dt.layout[Ge]||!1}function recurseIntoValObject(Ne,Ge,Qe){if(!Ne)return!1;if(Ne._isLinkedToArray)if(isIndex(Ge[Qe]))Qe++;else if(Qe<Ge.length)return!1;for(;Qe<Ge.length;Qe++){var tt=Ne[Ge[Qe]];if(!er(tt))break;if(Ne=tt,Qe===Ge.length-1)break;if(Ne._isLinkedToArray){if(!isIndex(Ge[++Qe]))return!1}else if("info_array"===Ne.valType){var rt=Ge[++Qe];if(!isIndex(rt))return!1;var nt=Ne.items;if(Array.isArray(nt)){if(rt>=nt.length)return!1;if(2===Ne.dimensions){if(Qe++,Ge.length===Qe)return Ne;var at=Ge[Qe];if(!isIndex(at))return!1;Ne=nt[rt][at]}else Ne=nt[rt]}else Ne=nt}}return Ne}function isIndex(Ne){return Ne===Math.round(Ne)&&Ne>=0}function getTraceAttributes(Ne){var Ge,rt;"area"===Ne?(Ge={attributes:ht},rt={}):rt=(Ge=tt.modules[Ne]._module).basePlotModule;var at={type:null},it=Zt({},nt),ot=Zt({},Ge.attributes);Qe.crawl(ot,(function(Ne,Ge,Qe,tt,rt){mr(it,rt).set(void 0),void 0===Ne&&mr(ot,rt).set(void 0)})),Zt(at,it),tt.traceIs(Ne,"noOpacity")&&delete at.opacity,tt.traceIs(Ne,"showLegend")||(delete at.showlegend,delete at.legendgroup),tt.traceIs(Ne,"noHover")&&(delete at.hoverinfo,delete at.hoverlabel),Ge.selectPoints||delete at.selectedpoints,Zt(at,ot),rt.attributes&&Zt(at,rt.attributes),at.type=Ne;var dt={meta:Ge.meta||{},categories:Ge.categories||{},animatable:Boolean(Ge.animatable),type:Ne,attributes:formatAttributes(at)};if(Ge.layoutAttributes){var Dt={};Zt(Dt,Ge.layoutAttributes),dt.layoutAttributes=formatAttributes(Dt)}return Ge.animatable||Qe.crawl(dt,(function(Ne){Qe.isValObject(Ne)&&"anim"in Ne&&delete Ne.anim})),dt}function getLayoutAttributes(){var Ne,Ge,Qe={};for(Ne in Zt(Qe,at),tt.subplotsRegistry)if((Ge=tt.subplotsRegistry[Ne]).layoutAttributes)if(Array.isArray(Ge.attr))for(var rt=0;rt<Ge.attr.length;rt++)handleBasePlotModule(Qe,Ge,Ge.attr[rt]);else handleBasePlotModule(Qe,Ge,"subplot"===Ge.attr?Ge.name:Ge.attr);for(Ne in Qe=assignPolarLayoutAttrs(Qe),tt.componentsRegistry){var nt=(Ge=tt.componentsRegistry[Ne]).schema;if(nt&&(nt.subplots||nt.layout)){var it=nt.subplots;if(it&&it.xaxis&&!it.yaxis)for(var ot in it.xaxis)delete Qe.yaxis[ot]}else"colorscale"===Ge.name?Zt(Qe,Ge.layoutAttributes):Ge.layoutAttributes&&insertAttrs(Qe,Ge.layoutAttributes,Ge.name)}return{layoutAttributes:formatAttributes(Qe)}}function getTransformAttributes(Ne){var Ge=tt.transformsRegistry[Ne],Qe=Zt({},Ge.attributes);return Object.keys(tt.componentsRegistry).forEach((function(Ge){var rt=tt.componentsRegistry[Ge];rt.schema&&rt.schema.transforms&&rt.schema.transforms[Ne]&&Object.keys(rt.schema.transforms[Ne]).forEach((function(Ge){insertAttrs(Qe,rt.schema.transforms[Ne][Ge],Ge)}))})),{attributes:formatAttributes(Qe)}}function getFramesAttributes(){var Ne={frames:Zt({},it)};return formatAttributes(Ne),Ne.frames}function formatAttributes(Ne){return mergeValTypeAndRole(Ne),formatArrayContainers(Ne),stringify(Ne),Ne}function mergeValTypeAndRole(Ne){function makeSrcAttr(Ne){return{valType:"string",editType:"none"}}function callback(Ne,Ge,tt){Qe.isValObject(Ne)?"data_array"===Ne.valType?(Ne.role="data",tt[Ge+"src"]=makeSrcAttr(Ge)):!0===Ne.arrayOk&&(tt[Ge+"src"]=makeSrcAttr(Ge)):er(Ne)&&(Ne.role="object")}Qe.crawl(Ne,callback)}function formatArrayContainers(Ne){function callback(Ne,Ge,Qe){if(Ne){var tt=Ne[Ar];tt&&(delete Ne[Ar],Qe[Ge]={items:{}},Qe[Ge].items[tt]=Ne,Qe[Ge].role="object")}}Qe.crawl(Ne,callback)}function stringify(Ne){function walk(Ne){for(var Ge in Ne)if(er(Ne[Ge]))walk(Ne[Ge]);else if(Array.isArray(Ne[Ge]))for(var Qe=0;Qe<Ne[Ge].length;Qe++)walk(Ne[Ge][Qe]);else Ne[Ge]instanceof RegExp&&(Ne[Ge]=Ne[Ge].toString())}walk(Ne)}function assignPolarLayoutAttrs(Ne){return Rt(Ne,{radialaxis:Dt.radialaxis,angularaxis:Dt.angularaxis}),Rt(Ne,Dt.layout),Ne}function handleBasePlotModule(Ne,Ge,Qe){var tt=mr(Ne,Qe),rt=Zt({},Ge.layoutAttributes);rt[br]=!0,tt.set(rt)}function insertAttrs(Ne,Ge,Qe){var tt=mr(Ne,Qe);tt.set(Zt(tt.get()||{},Ge))}Qe.IS_SUBPLOT_OBJ=br,Qe.IS_LINKED_TO_ARRAY=Ar,Qe.DEPRECATED=en,Qe.UNDERSCORE_ATTRS=mn,Qe.get=function(){var Ne={};tt.allTypes.concat("area").forEach((function(Ge){Ne[Ge]=getTraceAttributes(Ge)}));var Ge={};return Object.keys(tt.transformsRegistry).forEach((function(Ne){Ge[Ne]=getTransformAttributes(Ne)})),{defs:{valObjects:xr,metaKeys:mn.concat(["description","role","editType","impliedEdits"]),editType:{traces:Ot.traces,layout:Ot.layout},impliedEdits:{}},traces:Ne,layout:getLayoutAttributes(),transforms:Ge,frames:getFramesAttributes(),animation:formatAttributes(ot),config:formatAttributes(dt)}},Qe.crawl=function(Ne,Ge,tt,rt){var nt=tt||0;rt=rt||"",Object.keys(Ne).forEach((function(tt){var at=Ne[tt];if(-1===mn.indexOf(tt)){var it=(rt?rt+".":"")+tt;Ge(at,tt,Ne,nt,it),Qe.isValObject(at)||er(at)&&"impliedEdits"!==tt&&Qe.crawl(at,Ge,nt+1,it)}}))},Qe.isValObject=function(Ne){return Ne&&void 0!==Ne.valType},Qe.findArrayAttributes=function(Ne){var Ge,tt,rt=[],at=[],it=[];function callback(Ne,Qe,tt,rt){at=at.slice(0,rt).concat([Qe]),it=it.slice(0,rt).concat([Ne&&Ne._isLinkedToArray]),Ne&&("data_array"===Ne.valType||!0===Ne.arrayOk)&&("colorbar"!==at[rt-1]||"ticktext"!==Qe&&"tickvals"!==Qe)&&crawlIntoTrace(Ge,0,"")}function crawlIntoTrace(Ne,Ge,Qe){var nt=Ne[at[Ge]],ot=Qe+at[Ge];if(Ge===at.length-1)dr(nt)&&rt.push(tt+ot);else if(it[Ge]){if(Array.isArray(nt))for(var dt=0;dt<nt.length;dt++)er(nt[dt])&&crawlIntoTrace(nt[dt],Ge+1,ot+"["+dt+"].")}else er(nt)&&crawlIntoTrace(nt,Ge+1,ot+".")}Ge=Ne,tt="",Qe.crawl(nt,callback),Ne._module&&Ne._module.attributes&&Qe.crawl(Ne._module.attributes,callback);var ot=Ne.transforms;if(ot)for(var dt=0;dt<ot.length;dt++){var ht=ot[dt],Dt=ht._module;Dt&&(tt="transforms["+dt+"].",Ge=ht,Qe.crawl(Dt.attributes,callback))}return rt},Qe.getTraceValObject=function(Ne,Ge){var Qe,rt,at=Ge[0],it=1;if("transforms"===at){if(1===Ge.length)return nt.transforms;var ot=Ne.transforms;if(!Array.isArray(ot)||!ot.length)return!1;var dt=Ge[1];if(!isIndex(dt)||dt>=ot.length)return!1;rt=(Qe=(tt.transformsRegistry[ot[dt].type]||{}).attributes)&&Qe[Ge[2]],it=3}else if("area"===Ne.type)rt=ht[at];else{var Dt=Ne._module;if(Dt||(Dt=(tt.modules[Ne.type||nt.type.dflt]||{})._module),!Dt)return!1;if(!(rt=(Qe=Dt.attributes)&&Qe[at])){var Ot=Dt.basePlotModule;Ot&&Ot.attributes&&(rt=Ot.attributes[at])}rt||(rt=nt[at])}return recurseIntoValObject(rt,Ge,it)},Qe.getLayoutValObject=function(Ne,Ge){return recurseIntoValObject(layoutHeadAttr(Ne,Ge[0]),Ge,1)}},{"../lib":778,"../plots/animation_attributes":822,"../plots/attributes":824,"../plots/frame_attributes":857,"../plots/layout_attributes":882,"../plots/polar/legacy/area_attributes":897,"../plots/polar/legacy/axis_attributes":898,"../registry":911,"./edit_types":810,"./plot_config":815}],817:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../lib"),rt=Ne("../plots/attributes"),nt="templateitemname",at={name:{valType:"string",editType:"none"}};function validItemName(Ne){return Ne&&"string"==typeof Ne}function arrayDefaultKey(Ne){var Ge=Ne.length-1;return"s"!==Ne.charAt(Ge)&&tt.warn("bad argument to arrayDefaultKey: "+Ne),Ne.substr(0,Ne.length-1)+"defaults"}at[nt]={valType:"string",editType:"calc"},Qe.templatedArray=function(Ne,Ge){return Ge._isLinkedToArray=Ne,Ge.name=at.name,Ge[nt]=at[nt],Ge},Qe.traceTemplater=function(Ne){var Ge,Qe,nt={};for(Ge in Ne)Qe=Ne[Ge],Array.isArray(Qe)&&Qe.length&&(nt[Ge]=0);function newTrace(at){var it={type:Ge=tt.coerce(at,{},rt,"type"),_template:null};if(Ge in nt){Qe=Ne[Ge];var ot=nt[Ge]%Qe.length;nt[Ge]++,it._template=Qe[ot]}return it}return{newTrace:newTrace}},Qe.newContainer=function(Ne,Ge,Qe){var rt=Ne._template,nt=rt&&(rt[Ge]||Qe&&rt[Qe]);return tt.isPlainObject(nt)||(nt=null),Ne[Ge]={_template:nt}},Qe.arrayTemplater=function(Ne,Ge,Qe){var tt=Ne._template,rt=tt&&tt[arrayDefaultKey(Ge)],at=tt&&tt[Ge];Array.isArray(at)&&at.length||(at=[]);var it={};function newItem(Ne){var Ge={name:Ne.name,_input:Ne},tt=Ge[nt]=Ne[nt];if(!validItemName(tt))return Ge._template=rt,Ge;for(var ot=0;ot<at.length;ot++){var dt=at[ot];if(dt.name===tt)return it[tt]=1,Ge._template=dt,Ge}return Ge[Qe]=Ne[Qe]||!1,Ge._template=!1,Ge}function defaultItems(){for(var Ne=[],Ge=0;Ge<at.length;Ge++){var Qe=at[Ge],tt=Qe.name;if(validItemName(tt)&&!it[tt]){var rt={_template:Qe,name:tt,_input:{_templateitemname:tt}};rt[nt]=Qe[nt],Ne.push(rt),it[tt]=1}}return Ne}return{newItem:newItem,defaultItems:defaultItems}},Qe.arrayDefaultKey=arrayDefaultKey,Qe.arrayEditor=function(Ne,Ge,Qe){var rt=(tt.nestedProperty(Ne,Ge).get()||[]).length,at=Qe._index,it=at>=rt&&(Qe._input||{})._templateitemname;it&&(at=rt);var ot,dt=Ge+"["+at+"]";function resetUpdate(){ot={},it&&(ot[dt]={},ot[dt][nt]=it)}function modifyBase(Ne,Ge){ot[Ne]=Ge}function modifyItem(Ne,Ge){it?tt.nestedProperty(ot[dt],Ne).set(Ge):ot[dt+"."+Ne]=Ge}function getUpdateObj(){var Ne=ot;return resetUpdate(),Ne}function applyUpdate(Ge,Qe){Ge&&modifyItem(Ge,Qe);var rt=getUpdateObj();for(var nt in rt)tt.nestedProperty(Ne,nt).set(rt[nt])}return resetUpdate(),{modifyBase:modifyBase,modifyItem:modifyItem,getUpdateObj:getUpdateObj,applyUpdate:applyUpdate}}},{"../lib":778,"../plots/attributes":824}],818:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../registry"),nt=Ne("../plots/plots"),at=Ne("../lib"),it=Ne("../lib/clear_gl_canvases"),ot=Ne("../components/color"),dt=Ne("../components/drawing"),ht=Ne("../components/titles"),Dt=Ne("../components/modebar"),Ot=Ne("../plots/cartesian/axes"),Rt=Ne("../constants/alignment"),Zt=Ne("../plots/cartesian/constraints"),er=Zt.enforce,dr=Zt.clean,mr=Ne("../plots/cartesian/autorange").doAutoRange,xr="start",br="middle",Ar="end";function overlappingDomain(Ne,Ge,Qe){for(var tt=0;tt<Qe.length;tt++){var rt=Qe[tt][0],nt=Qe[tt][1];if(!(rt[0]>=Ne[1]||rt[1]<=Ne[0])&&nt[0]<Ge[1]&&nt[1]>Ge[0])return!0}return!1}function lsInner(Ne){var Ge,rt,it,ht,Zt,er,dr=Ne._fullLayout,mr=dr._size,xr=mr.p,br=Ot.list(Ne,"",!0);if(dr._paperdiv.style({width:Ne._context.responsive&&dr.autosize&&!Ne._context._hasZeroWidth&&!Ne.layout.width?"100%":dr.width+"px",height:Ne._context.responsive&&dr.autosize&&!Ne._context._hasZeroHeight&&!Ne.layout.height?"100%":dr.height+"px"}).selectAll(".main-svg").call(dt.setSize,dr.width,dr.height),Ne._context.setBackground(Ne,dr.paper_bgcolor),Qe.drawMainTitle(Ne),Dt.manage(Ne),!dr._has("cartesian"))return nt.previousPromises(Ne);function getLinePosition(Ne,Ge,Qe){var tt=Ne._lw/2;return"x"===Ne._id.charAt(0)?Ge?"top"===Qe?Ge._offset-xr-tt:Ge._offset+Ge._length+xr+tt:mr.t+mr.h*(1-(Ne.position||0))+tt%1:Ge?"right"===Qe?Ge._offset+Ge._length+xr+tt:Ge._offset-xr-tt:mr.l+mr.w*(Ne.position||0)+tt%1}for(Ge=0;Ge<br.length;Ge++){var Ar=(ht=br[Ge])._anchorAxis;ht._linepositions={},ht._lw=dt.crispRound(Ne,ht.linewidth,1),ht._mainLinePosition=getLinePosition(ht,Ar,ht.side),ht._mainMirrorPosition=ht.mirror&&Ar?getLinePosition(ht,Ar,Rt.OPPOSITE_SIDE[ht.side]):null}var en=[],mn=[],xn=[],kn=1===ot.opacity(dr.paper_bgcolor)&&1===ot.opacity(dr.plot_bgcolor)&&dr.paper_bgcolor===dr.plot_bgcolor;for(rt in dr._plots)if((it=dr._plots[rt]).mainplot)it.bg&&it.bg.remove(),it.bg=void 0;else{var Cn=it.xaxis.domain,En=it.yaxis.domain,Pn=it.plotgroup;if(overlappingDomain(Cn,En,xn)){var Dn=Pn.node(),In=it.bg=at.ensureSingle(Pn,"rect","bg");Dn.insertBefore(In.node(),Dn.childNodes[0]),mn.push(rt)}else Pn.select("rect.bg").remove(),xn.push([Cn,En]),kn||(en.push(rt),mn.push(rt))}var zn,Bn,Vn,Hn,qn,Yn,$n,ra,oa,pa,ga,ma,_a,Va=dr._bgLayer.selectAll(".bg").data(en);for(Va.enter().append("rect").classed("bg",!0),Va.exit().remove(),Va.each((function(Ne){dr._plots[Ne].bg=tt.select(this)})),Ge=0;Ge<mn.length;Ge++)it=dr._plots[mn[Ge]],Zt=it.xaxis,er=it.yaxis,it.bg&&void 0!==Zt._offset&&void 0!==er._offset&&it.bg.call(dt.setRect,Zt._offset-xr,er._offset-xr,Zt._length+2*xr,er._length+2*xr).call(ot.fill,dr.plot_bgcolor).style("stroke-width",0);if(!dr._hasOnlyLargeSploms)for(rt in dr._plots){it=dr._plots[rt],Zt=it.xaxis,er=it.yaxis;var Wa,Qa,ti=it.clipId="clip"+dr._uid+rt+"plot",ni=at.ensureSingleById(dr._clips,"clipPath",ti,(function(Ne){Ne.classed("plotclip",!0).append("rect")}));it.clipRect=ni.select("rect").attr({width:Zt._length,height:er._length}),dt.setTranslate(it.plot,Zt._offset,er._offset),it._hasClipOnAxisFalse?(Wa=null,Qa=ti):(Wa=ti,Qa=null),dt.setClipUrl(it.plot,Wa,Ne),it.layerClipId=Qa}function xLinePath(Ne){return"M"+zn+","+Ne+"H"+Bn}function xLinePathFree(Ne){return"M"+Zt._offset+","+Ne+"h"+Zt._length}function yLinePath(Ne){return"M"+Ne+","+ra+"V"+$n}function yLinePathFree(Ne){return"M"+Ne+","+er._offset+"v"+er._length}function mainPath(Ne,Ge,Qe){if(!Ne.showline||rt!==Ne._mainSubplot)return"";if(!Ne._anchorAxis)return Qe(Ne._mainLinePosition);var tt=Ge(Ne._mainLinePosition);return Ne.mirror&&(tt+=Ge(Ne._mainMirrorPosition)),tt}for(rt in dr._plots){it=dr._plots[rt],Zt=it.xaxis,er=it.yaxis;var di="M0,0";shouldShowLinesOrTicks(Zt,rt)&&(qn=findCounterAxisLineWidth(Zt,"left",er,br),zn=Zt._offset-(qn?xr+qn:0),Yn=findCounterAxisLineWidth(Zt,"right",er,br),Bn=Zt._offset+Zt._length+(Yn?xr+Yn:0),Vn=getLinePosition(Zt,er,"bottom"),Hn=getLinePosition(Zt,er,"top"),!(_a=!Zt._anchorAxis||rt!==Zt._mainSubplot)||"allticks"!==Zt.mirror&&"all"!==Zt.mirror||(Zt._linepositions[rt]=[Vn,Hn]),di=mainPath(Zt,xLinePath,xLinePathFree),_a&&Zt.showline&&("all"===Zt.mirror||"allticks"===Zt.mirror)&&(di+=xLinePath(Vn)+xLinePath(Hn)),it.xlines.style("stroke-width",Zt._lw+"px").call(ot.stroke,Zt.showline?Zt.linecolor:"rgba(0,0,0,0)")),it.xlines.attr("d",di);var ji="M0,0";shouldShowLinesOrTicks(er,rt)&&(ga=findCounterAxisLineWidth(er,"bottom",Zt,br),$n=er._offset+er._length+(ga?xr:0),ma=findCounterAxisLineWidth(er,"top",Zt,br),ra=er._offset-(ma?xr:0),oa=getLinePosition(er,Zt,"left"),pa=getLinePosition(er,Zt,"right"),!(_a=!er._anchorAxis||rt!==er._mainSubplot)||"allticks"!==er.mirror&&"all"!==er.mirror||(er._linepositions[rt]=[oa,pa]),ji=mainPath(er,yLinePath,yLinePathFree),_a&&er.showline&&("all"===er.mirror||"allticks"===er.mirror)&&(ji+=yLinePath(oa)+yLinePath(pa)),it.ylines.style("stroke-width",er._lw+"px").call(ot.stroke,er.showline?er.linecolor:"rgba(0,0,0,0)")),it.ylines.attr("d",ji)}return Ot.makeClipPaths(Ne),nt.previousPromises(Ne)}function shouldShowLinesOrTicks(Ne,Ge){return(Ne.ticks||Ne.showline)&&(Ge===Ne._mainSubplot||"all"===Ne.mirror||"allticks"===Ne.mirror)}function shouldShowLineThisSide(Ne,Ge,Qe){if(!Qe.showline||!Qe._lw)return!1;if("all"===Qe.mirror||"allticks"===Qe.mirror)return!0;var tt=Qe._anchorAxis;if(!tt)return!1;var rt=Rt.FROM_BL[Ge];return Qe.side===Ge?tt.domain[rt]===Ne.domain[rt]:Qe.mirror&&tt.domain[1-rt]===Ne.domain[1-rt]}function findCounterAxisLineWidth(Ne,Ge,Qe,tt){if(shouldShowLineThisSide(Ne,Ge,Qe))return Qe._lw;for(var rt=0;rt<tt.length;rt++){var nt=tt[rt];if(nt._mainAxis===Qe._mainAxis&&shouldShowLineThisSide(Ne,Ge,nt))return nt._lw}return 0}function getMainTitleX(Ne,Ge){var Qe=Ne.title,tt=Ne._size,rt=0;return Ge===xr?rt=Qe.pad.l:Ge===Ar&&(rt=-Qe.pad.r),"paper"===Qe.xref?tt.l+tt.w*Qe.x+rt:Ne.width*Qe.x+rt}function getMainTitleY(Ne,Ge){var Qe=Ne.title,tt=Ne._size,rt=0;return"0em"!==Ge&&Ge?Ge===Rt.CAP_SHIFT+"em"&&(rt=Qe.pad.t):rt=-Qe.pad.b,"auto"===Qe.y?tt.t/2:"paper"===Qe.yref?tt.t+tt.h-tt.h*Qe.y+rt:Ne.height-Ne.height*Qe.y+rt}function getMainTitleTextAnchor(Ne){var Ge=Ne.title,Qe=br;return at.isRightAnchor(Ge)?Qe=Ar:at.isLeftAnchor(Ge)&&(Qe=xr),Qe}function getMainTitleDy(Ne){var Ge=Ne.title,Qe="0em";return at.isTopAnchor(Ge)?Qe=Rt.CAP_SHIFT+"em":at.isMiddleAnchor(Ge)&&(Qe=Rt.MID_SHIFT+"em"),Qe}Qe.layoutStyles=function(Ne){return at.syncOrAsync([nt.doAutoMargin,lsInner],Ne)},Qe.drawMainTitle=function(Ne){var Ge=Ne._fullLayout,Qe=getMainTitleTextAnchor(Ge),tt=getMainTitleDy(Ge);ht.draw(Ne,"gtitle",{propContainer:Ge,propName:"title.text",placeholder:Ge._dfltTitle.plot,attributes:{x:getMainTitleX(Ge,Qe),y:getMainTitleY(Ge,tt),"text-anchor":Qe,dy:tt}})},Qe.doTraceStyle=function(Ne){var Ge,tt=Ne.calcdata,at=[];for(Ge=0;Ge<tt.length;Ge++){var ot=tt[Ge],dt=ot[0]||{},ht=dt.trace||{},Dt=ht._module||{},Ot=Dt.arraysToCalcdata;Ot&&Ot(ot,ht);var Rt=Dt.editStyle;Rt&&at.push({fn:Rt,cd0:dt})}if(at.length){for(Ge=0;Ge<at.length;Ge++){var Zt=at[Ge];Zt.fn(Ne,Zt.cd0)}it(Ne),Qe.redrawReglTraces(Ne)}return nt.style(Ne),rt.getComponentMethod("legend","draw")(Ne),nt.previousPromises(Ne)},Qe.doColorBars=function(Ne){return rt.getComponentMethod("colorbar","draw")(Ne),nt.previousPromises(Ne)},Qe.layoutReplot=function(Ne){var Ge=Ne.layout;return Ne.layout=void 0,rt.call("plot",Ne,"",Ge)},Qe.doLegend=function(Ne){return rt.getComponentMethod("legend","draw")(Ne),nt.previousPromises(Ne)},Qe.doTicksRelayout=function(Ne){return Ot.draw(Ne,"redraw"),Ne._fullLayout._hasOnlyLargeSploms&&(rt.subplotsRegistry.splom.updateGrid(Ne),it(Ne),Qe.redrawReglTraces(Ne)),Qe.drawMainTitle(Ne),nt.previousPromises(Ne)},Qe.doModeBar=function(Ne){var Ge=Ne._fullLayout;Dt.manage(Ne);for(var Qe=0;Qe<Ge._basePlotModules.length;Qe++){var tt=Ge._basePlotModules[Qe].updateFx;tt&&tt(Ne)}return nt.previousPromises(Ne)},Qe.doCamera=function(Ne){for(var Ge=Ne._fullLayout,Qe=Ge._subplots.gl3d,tt=0;tt<Qe.length;tt++){var rt=Ge[Qe[tt]];rt._scene.setViewport(rt)}},Qe.drawData=function(Ne){var Ge=Ne._fullLayout;it(Ne);for(var tt=Ge._basePlotModules,at=0;at<tt.length;at++)tt[at].plot(Ne);return Qe.redrawReglTraces(Ne),nt.style(Ne),rt.getComponentMethod("shapes","draw")(Ne),rt.getComponentMethod("annotations","draw")(Ne),rt.getComponentMethod("images","draw")(Ne),Ge._replotting=!1,nt.previousPromises(Ne)},Qe.redrawReglTraces=function(Ne){var Ge=Ne._fullLayout;if(Ge._has("regl")){var Qe,tt,rt=Ne._fullData,nt=[],it=[];for(Ge._hasOnlyLargeSploms&&Ge._splomGrid.draw(),Qe=0;Qe<rt.length;Qe++){var ot=rt[Qe];!0===ot.visible&&0!==ot._length&&("splom"===ot.type?Ge._splomScenes[ot.uid].draw():"scattergl"===ot.type?at.pushUnique(nt,ot.xaxis+ot.yaxis):"scatterpolargl"===ot.type&&at.pushUnique(it,ot.subplot))}for(Qe=0;Qe<nt.length;Qe++)(tt=Ge._plots[nt[Qe]])._scene&&tt._scene.draw();for(Qe=0;Qe<it.length;Qe++)(tt=Ge[it[Qe]]._subplot)._scene&&tt._scene.draw()}},Qe.doAutoRangeAndConstraints=function(Ne){for(var Ge,Qe=Ot.list(Ne,"",!0),tt={},rt=0;rt<Qe.length;rt++)if(!tt[(Ge=Qe[rt])._id]){tt[Ge._id]=1,dr(Ne,Ge),mr(Ne,Ge);var nt=Ge._matchGroup;if(nt)for(var at in nt){var it=Ot.getFromId(Ne,at);mr(Ne,it,Ge.range),tt[at]=1}}er(Ne)},Qe.finalDraw=function(Ne){rt.getComponentMethod("rangeslider","draw")(Ne),rt.getComponentMethod("rangeselector","draw")(Ne)},Qe.drawMarginPushers=function(Ne){rt.getComponentMethod("legend","draw")(Ne),rt.getComponentMethod("rangeselector","draw")(Ne),rt.getComponentMethod("sliders","draw")(Ne),rt.getComponentMethod("updatemenus","draw")(Ne),rt.getComponentMethod("colorbar","draw")(Ne)}},{"../components/color":643,"../components/drawing":665,"../components/modebar":703,"../components/titles":738,"../constants/alignment":745,"../lib":778,"../lib/clear_gl_canvases":762,"../plots/cartesian/autorange":827,"../plots/cartesian/axes":828,"../plots/cartesian/constraints":835,"../plots/plots":891,"../registry":911,d3:169}],819:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../lib"),rt=tt.isPlainObject,nt=Ne("./plot_schema"),at=Ne("../plots/plots"),it=Ne("../plots/attributes"),ot=Ne("./plot_template"),dt=Ne("./plot_config").dfltConfig;function mergeTemplates(Ne,Ge){Ne=tt.extendDeep({},Ne);var Qe,nt,at=Object.keys(Ne).sort();function mergeOne(Ge,Qe,tt){if(rt(Qe)&&rt(Ge))mergeTemplates(Ge,Qe);else if(Array.isArray(Qe)&&Array.isArray(Ge)){var at=ot.arrayTemplater({_template:Ne},tt);for(nt=0;nt<Qe.length;nt++){var it=Qe[nt],dt=at.newItem(it)._template;dt&&mergeTemplates(dt,it)}var ht=at.defaultItems();for(nt=0;nt<ht.length;nt++)Qe.push(ht[nt]._template);for(nt=0;nt<Qe.length;nt++)delete Qe[nt].templateitemname}}for(Qe=0;Qe<at.length;Qe++){var it=at[Qe],dt=Ne[it];if(it in Ge?mergeOne(dt,Ge[it],it):Ge[it]=dt,getBaseKey(it)===it)for(var ht in Ge){var Dt=getBaseKey(ht);ht===Dt||Dt!==it||ht in Ne||mergeOne(dt,Ge[ht],it)}}}function getBaseKey(Ne){return Ne.replace(/[0-9]+$/,"")}function walkStyleKeys(Ne,Ge,Qe,nt,at){var it=at&&Qe(at);for(var dt in Ne){var ht=Ne[dt],Dt=getNextPath(Ne,dt,nt),Ot=getNextPath(Ne,dt,at),Rt=Qe(Ot);if(!Rt){var Zt=getBaseKey(dt);Zt!==dt&&(Rt=Qe(Ot=getNextPath(Ne,Zt,at)))}if(!(it&&it===Rt||!Rt||Rt._noTemplating||"data_array"===Rt.valType||Rt.arrayOk&&Array.isArray(ht)))if(!Rt.valType&&rt(ht))walkStyleKeys(ht,Ge,Qe,Dt,Ot);else if(Rt._isLinkedToArray&&Array.isArray(ht))for(var er=!1,dr=0,mr={},xr=0;xr<ht.length;xr++){var br=ht[xr];if(rt(br)){var Ar=br.name;if(Ar)mr[Ar]||(walkStyleKeys(br,Ge,Qe,getNextPath(ht,dr,Dt),getNextPath(ht,dr,Ot)),dr++,mr[Ar]=1);else if(!er){var en=getNextPath(Ne,ot.arrayDefaultKey(dt),nt),mn=getNextPath(ht,dr,Dt);walkStyleKeys(br,Ge,Qe,mn,getNextPath(ht,dr,Ot));var xn=tt.nestedProperty(Ge,mn);tt.nestedProperty(Ge,en).set(xn.get()),xn.set(null),er=!0}}}else tt.nestedProperty(Ge,Dt).set(ht)}}function getLayoutInfo(Ne,Ge){return nt.getLayoutValObject(Ne,tt.nestedProperty({},Ge).parts)}function getTraceInfo(Ne,Ge){return nt.getTraceValObject(Ne,tt.nestedProperty({},Ge).parts)}function getNextPath(Ne,Ge,Qe){return Qe?Array.isArray(Ne)?Qe+"["+Ge+"]":Qe+"."+Ge:Ge}function hasPlainObject(Ne){for(var Ge=0;Ge<Ne.length;Ge++)if(rt(Ne[Ge]))return!0}function format(Ne){var Ge;switch(Ne.code){case"data":Ge="The template has no key data.";break;case"layout":Ge="The template has no key layout.";break;case"missing":Ge=Ne.path?"There are no templates for item "+Ne.path+" with name "+Ne.templateitemname:"There are no templates for trace "+Ne.index+", of type "+Ne.traceType+".";break;case"unused":Ge=Ne.path?"The template item at "+Ne.path+" was not used in constructing the plot.":Ne.dataCount?"Some of the templates of type "+Ne.traceType+" were not used. The template has "+Ne.templateCount+" traces, the data only has "+Ne.dataCount+" of this type.":"The template has "+Ne.templateCount+" traces of type "+Ne.traceType+" but there are none in the data.";break;case"reused":Ge="Some of the templates of type "+Ne.traceType+" were used more than once. The template has "+Ne.templateCount+" traces, the data has "+Ne.dataCount+" of this type."}return Ne.msg=Ge,Ne}Qe.makeTemplate=function(Ne){Ne=tt.isPlainObject(Ne)?Ne:tt.getGraphDiv(Ne),Ne=tt.extendDeep({_context:dt},{data:Ne.data,layout:Ne.layout}),at.supplyDefaults(Ne);var Ge=Ne.data||[],Qe=Ne.layout||{};Qe._basePlotModules=Ne._fullLayout._basePlotModules,Qe._modules=Ne._fullLayout._modules;var nt={data:{},layout:{}};Ge.forEach((function(Ne){var Ge={};walkStyleKeys(Ne,Ge,getTraceInfo.bind(null,Ne));var Qe=tt.coerce(Ne,{},it,"type"),rt=nt.data[Qe];rt||(rt=nt.data[Qe]=[]),rt.push(Ge)})),walkStyleKeys(Qe,nt.layout,getLayoutInfo.bind(null,Qe)),delete nt.layout.template;var ot=Qe.template;if(rt(ot)){var ht,Dt,Ot,Rt,Zt,er,dr=ot.layout;rt(dr)&&mergeTemplates(dr,nt.layout);var mr=ot.data;if(rt(mr)){for(Dt in nt.data)if(Ot=mr[Dt],Array.isArray(Ot)){for(er=(Zt=nt.data[Dt]).length,Rt=Ot.length,ht=0;ht<er;ht++)mergeTemplates(Ot[ht%Rt],Zt[ht]);for(ht=er;ht<Rt;ht++)Zt.push(tt.extendDeep({},Ot[ht]))}for(Dt in mr)Dt in nt.data||(nt.data[Dt]=tt.extendDeep([],mr[Dt]))}}return nt},Qe.validateTemplate=function(Ne,Ge){var Qe=tt.extendDeep({},{_context:dt,data:Ne.data,layout:Ne.layout}),nt=Qe.layout||{};rt(Ge)||(Ge=nt.template||{});var it=Ge.layout,ot=Ge.data,ht=[];Qe.layout=nt,Qe.layout.template=Ge,at.supplyDefaults(Qe);var Dt=Qe._fullLayout,Ot=Qe._fullData,Rt={};function crawlLayoutForContainers(Ne,Ge){for(var Qe in Ne)if("_"!==Qe.charAt(0)&&rt(Ne[Qe])){var tt,nt=getBaseKey(Qe),at=[];for(tt=0;tt<Ge.length;tt++)at.push(getNextPath(Ne,Qe,Ge[tt])),nt!==Qe&&at.push(getNextPath(Ne,nt,Ge[tt]));for(tt=0;tt<at.length;tt++)Rt[at[tt]]=1;crawlLayoutForContainers(Ne[Qe],at)}}function crawlLayoutTemplateForContainers(Ne,Ge){for(var Qe in Ne)if(-1===Qe.indexOf("defaults")&&rt(Ne[Qe])){var tt=getNextPath(Ne,Qe,Ge);Rt[tt]?crawlLayoutTemplateForContainers(Ne[Qe],tt):ht.push({code:"unused",path:tt})}}if(rt(it)?(crawlLayoutForContainers(Dt,["layout"]),crawlLayoutTemplateForContainers(it,"layout")):ht.push({code:"layout"}),rt(ot)){for(var Zt,er={},dr=0;dr<Ot.length;dr++){var mr=Ot[dr];er[Zt=mr.type]=(er[Zt]||0)+1,mr._fullInput._template||ht.push({code:"missing",index:mr._fullInput.index,traceType:Zt})}for(Zt in ot){var xr=ot[Zt].length,br=er[Zt]||0;xr>br?ht.push({code:"unused",traceType:Zt,templateCount:xr,dataCount:br}):br>xr&&ht.push({code:"reused",traceType:Zt,templateCount:xr,dataCount:br})}}else ht.push({code:"data"});function crawlForMissingTemplates(Ne,Ge){for(var Qe in Ne)if("_"!==Qe.charAt(0)){var tt=Ne[Qe],nt=getNextPath(Ne,Qe,Ge);rt(tt)?(Array.isArray(Ne)&&!1===tt._template&&tt.templateitemname&&ht.push({code:"missing",path:nt,templateitemname:tt.templateitemname}),crawlForMissingTemplates(tt,nt)):Array.isArray(tt)&&hasPlainObject(tt)&&crawlForMissingTemplates(tt,nt)}}if(crawlForMissingTemplates({data:Ot,layout:Dt},""),ht.length)return ht.map(format)}},{"../lib":778,"../plots/attributes":824,"../plots/plots":891,"./plot_config":815,"./plot_schema":816,"./plot_template":817}],820:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("./plot_api"),nt=Ne("../plots/plots"),at=Ne("../lib"),it=Ne("../snapshot/helpers"),ot=Ne("../snapshot/tosvg"),dt=Ne("../snapshot/svgtoimg"),ht=Ne("../version").version,Dt={format:{valType:"enumerated",values:["png","jpeg","webp","svg","full-json"],dflt:"png"},width:{valType:"number",min:1},height:{valType:"number",min:1},scale:{valType:"number",min:0,dflt:1},setBackground:{valType:"any",dflt:!1},imageDataOnly:{valType:"boolean",dflt:!1}};function toImage(Ne,Ge){var Qe,Ot,Rt,Zt;function isImpliedOrValid(Ne){return!(Ne in Ge)||at.validate(Ge[Ne],Dt[Ne])}if(Ge=Ge||{},at.isPlainObject(Ne)?(Qe=Ne.data||[],Ot=Ne.layout||{},Rt=Ne.config||{},Zt={}):(Ne=at.getGraphDiv(Ne),Qe=at.extendDeep([],Ne.data),Ot=at.extendDeep({},Ne.layout),Rt=Ne._context,Zt=Ne._fullLayout||{}),!isImpliedOrValid("width")&&null!==Ge.width||!isImpliedOrValid("height")&&null!==Ge.height)throw new Error("Height and width should be pixel values.");if(!isImpliedOrValid("format"))throw new Error("Export format is not "+at.join2(Dt.format.values,", "," or ")+".");var er={};function coerce(Ne,Qe){return at.coerce(Ge,er,Dt,Ne,Qe)}var dr=coerce("format"),mr=coerce("width"),xr=coerce("height"),br=coerce("scale"),Ar=coerce("setBackground"),en=coerce("imageDataOnly"),mn=document.createElement("div");mn.style.position="absolute",mn.style.left="-5000px",document.body.appendChild(mn);var xn=at.extendFlat({},Ot);mr?xn.width=mr:null===Ge.width&&tt(Zt.width)&&(xn.width=Zt.width),xr?xn.height=xr:null===Ge.height&&tt(Zt.height)&&(xn.height=Zt.height);var kn=at.extendFlat({},Rt,{_exportedPlot:!0,staticPlot:!0,setBackground:Ar}),Cn=it.getRedrawFunc(mn);function wait(){return new Promise((function(Ne){setTimeout(Ne,it.getDelay(mn._fullLayout))}))}function convert(){return new Promise((function(Ne,Ge){var Qe=ot(mn,dr,br),tt=mn._fullLayout.width,Dt=mn._fullLayout.height;function cleanup(){rt.purge(mn),document.body.removeChild(mn)}if("full-json"===dr){var Ot=nt.graphJson(mn,!1,"keepdata","object",!0,!0);return Ot.version=ht,Ot=JSON.stringify(Ot),cleanup(),Ne(en?Ot:it.encodeJSON(Ot))}if(cleanup(),"svg"===dr)return Ne(en?Qe:it.encodeSVG(Qe));var Rt=document.createElement("canvas");Rt.id=at.randstr(),dt({format:dr,width:tt,height:Dt,scale:br,canvas:Rt,svg:Qe,promise:!0}).then(Ne).catch(Ge)}))}function urlToImageData(Ne){return en?Ne.replace(it.IMAGE_URL_PREFIX,""):Ne}return new Promise((function(Ne,Ge){rt.plot(mn,Qe,xn,kn).then(Cn).then(wait).then(convert).then((function(Ge){Ne(urlToImageData(Ge))})).catch((function(Ne){Ge(Ne)}))}))}Ge.exports=toImage},{"../lib":778,"../plots/plots":891,"../snapshot/helpers":915,"../snapshot/svgtoimg":917,"../snapshot/tosvg":919,"../version":1370,"./plot_api":814,"fast-isnumeric":241}],821:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../lib"),rt=Ne("../plots/plots"),nt=Ne("./plot_schema"),at=Ne("./plot_config").dfltConfig,it=tt.isPlainObject,ot=Array.isArray,dt=tt.isArrayOrTypedArray;function crawl(Ne,Ge,Qe,rt,nt,at){at=at||[];for(var ht=Object.keys(Ne),Dt=0;Dt<ht.length;Dt++){var Ot=ht[Dt];if("transforms"!==Ot){var Rt=at.slice();Rt.push(Ot);var Zt=Ne[Ot],er=Ge[Ot],dr=getNestedSchema(Qe,Ot),mr=(dr||{}).valType,xr="info_array"===mr,br="colorscale"===mr,Ar=(dr||{}).items;if(isInSchema(Qe,Ot))if(it(Zt)&&it(er)&&"any"!==mr)crawl(Zt,er,dr,rt,nt,Rt);else if(xr&&ot(Zt)){Zt.length>er.length&&rt.push(format("unused",nt,Rt.concat(er.length)));var en,mn,xn,kn,Cn,En=er.length,Pn=Array.isArray(Ar);if(Pn&&(En=Math.min(En,Ar.length)),2===dr.dimensions)for(mn=0;mn<En;mn++)if(ot(Zt[mn])){Zt[mn].length>er[mn].length&&rt.push(format("unused",nt,Rt.concat(mn,er[mn].length)));var Dn=er[mn].length;for(en=0;en<(Pn?Math.min(Dn,Ar[mn].length):Dn);en++)xn=Pn?Ar[mn][en]:Ar,kn=Zt[mn][en],Cn=er[mn][en],tt.validate(kn,xn)?Cn!==kn&&Cn!==+kn&&rt.push(format("dynamic",nt,Rt.concat(mn,en),kn,Cn)):rt.push(format("value",nt,Rt.concat(mn,en),kn))}else rt.push(format("array",nt,Rt.concat(mn),Zt[mn]));else for(mn=0;mn<En;mn++)xn=Pn?Ar[mn]:Ar,kn=Zt[mn],Cn=er[mn],tt.validate(kn,xn)?Cn!==kn&&Cn!==+kn&&rt.push(format("dynamic",nt,Rt.concat(mn),kn,Cn)):rt.push(format("value",nt,Rt.concat(mn),kn))}else if(dr.items&&!xr&&ot(Zt)){var In,zn,Bn=Ar[Object.keys(Ar)[0]],Vn=[];for(In=0;In<er.length;In++){var Hn=er[In]._index||In;if((zn=Rt.slice()).push(Hn),it(Zt[Hn])&&it(er[In])){Vn.push(Hn);var qn=Zt[Hn],Yn=er[In];it(qn)&&!1!==qn.visible&&!1===Yn.visible?rt.push(format("invisible",nt,zn)):crawl(qn,Yn,Bn,rt,nt,zn)}}for(In=0;In<Zt.length;In++)(zn=Rt.slice()).push(In),it(Zt[In])?-1===Vn.indexOf(In)&&rt.push(format("unused",nt,zn)):rt.push(format("object",nt,zn,Zt[In]))}else!it(Zt)&&it(er)?rt.push(format("object",nt,Rt,Zt)):dt(Zt)||!dt(er)||xr||br?Ot in Ge?tt.validate(Zt,dr)?"enumerated"===dr.valType&&(dr.coerceNumber&&Zt!==+er||Zt!==er)&&rt.push(format("dynamic",nt,Rt,Zt,er)):rt.push(format("value",nt,Rt,Zt)):rt.push(format("unused",nt,Rt,Zt)):rt.push(format("array",nt,Rt,Zt));else rt.push(format("schema",nt,Rt))}}return rt}function fillLayoutSchema(Ne,Ge){for(var Qe=Ne.layout.layoutAttributes,rt=0;rt<Ge.length;rt++){var nt=Ge[rt],at=Ne.traces[nt.type],it=at.layoutAttributes;it&&(nt.subplot?tt.extendFlat(Qe[at.attributes.subplot.dflt],it):tt.extendFlat(Qe,it))}return Qe}Ge.exports=function(Ne,Ge){void 0===Ne&&(Ne=[]),void 0===Ge&&(Ge={});var Qe,dt,ht=nt.get(),Dt=[],Ot={_context:tt.extendFlat({},at)};ot(Ne)?(Ot.data=tt.extendDeep([],Ne),Qe=Ne):(Ot.data=[],Qe=[],Dt.push(format("array","data"))),it(Ge)?(Ot.layout=tt.extendDeep({},Ge),dt=Ge):(Ot.layout={},dt={},arguments.length>1&&Dt.push(format("object","layout"))),rt.supplyDefaults(Ot);for(var Rt=Ot._fullData,Zt=Qe.length,er=0;er<Zt;er++){var dr=Qe[er],mr=["data",er];if(it(dr)){var xr=Rt[er],br=xr.type,Ar=ht.traces[br].attributes;Ar.type={valType:"enumerated",values:[br]},!1===xr.visible&&!1!==dr.visible&&Dt.push(format("invisible",mr)),crawl(dr,xr,Ar,Dt,mr);var en=dr.transforms,mn=xr.transforms;if(en){ot(en)||Dt.push(format("array",mr,["transforms"])),mr.push("transforms");for(var xn=0;xn<en.length;xn++){var kn=["transforms",xn],Cn=en[xn].type;if(it(en[xn])){var En=ht.transforms[Cn]?ht.transforms[Cn].attributes:{};En.type={valType:"enumerated",values:Object.keys(ht.transforms)},crawl(en[xn],mn[xn],En,Dt,mr,kn)}else Dt.push(format("object",mr,kn))}}}else Dt.push(format("object",mr))}return crawl(dt,Ot._fullLayout,fillLayoutSchema(ht,Rt),Dt,"layout"),0===Dt.length?void 0:Dt};var ht={object:function(Ne,Ge){return("layout"===Ne&&""===Ge?"The layout argument":"data"===Ne[0]&&""===Ge?"Trace "+Ne[1]+" in the data argument":inBase(Ne)+"key "+Ge)+" must be linked to an object container"},array:function(Ne,Ge){return("data"===Ne?"The data argument":inBase(Ne)+"key "+Ge)+" must be linked to an array container"},schema:function(Ne,Ge){return inBase(Ne)+"key "+Ge+" is not part of the schema"},unused:function(Ne,Ge,Qe){var tt=it(Qe)?"container":"key";return inBase(Ne)+tt+" "+Ge+" did not get coerced"},dynamic:function(Ne,Ge,Qe,tt){return[inBase(Ne)+"key",Ge,"(set to '"+Qe+"')","got reset to","'"+tt+"'","during defaults."].join(" ")},invisible:function(Ne,Ge){return(Ge?inBase(Ne)+"item "+Ge:"Trace "+Ne[1])+" got defaulted to be not visible"},value:function(Ne,Ge,Qe){return[inBase(Ne)+"key "+Ge,"is set to an invalid value ("+Qe+")"].join(" ")}};function inBase(Ne){return ot(Ne)?"In data trace "+Ne[1]+", ":"In "+Ne+", "}function format(Ne,Ge,Qe,rt,nt){var at,it;Qe=Qe||"",ot(Ge)?(at=Ge[0],it=Ge[1]):(at=Ge,it=null);var dt=convertPathToAttributeString(Qe),Dt=ht[Ne](Ge,dt,rt,nt);return tt.log(Dt),{code:Ne,container:at,trace:it,path:Qe,astr:dt,msg:Dt}}function isInSchema(Ne,Ge){var Qe=splitKey(Ge),tt=Qe.keyMinusId,rt=Qe.id;return!!(tt in Ne&&Ne[tt]._isSubplotObj&&rt)||Ge in Ne}function getNestedSchema(Ne,Ge){return Ge in Ne?Ne[Ge]:Ne[splitKey(Ge).keyMinusId]}var Dt=tt.counterRegex("([a-z]+)");function splitKey(Ne){var Ge=Ne.match(Dt);return{keyMinusId:Ge&&Ge[1],id:Ge&&Ge[2]}}function convertPathToAttributeString(Ne){if(!ot(Ne))return String(Ne);for(var Ge="",Qe=0;Qe<Ne.length;Qe++){var tt=Ne[Qe];"number"==typeof tt?Ge=Ge.substr(0,Ge.length-1)+"["+tt+"]":Ge+=tt,Qe<Ne.length-1&&(Ge+=".")}return Ge}},{"../lib":778,"../plots/plots":891,"./plot_config":815,"./plot_schema":816}],822:[function(Ne,Ge,Qe){"use strict";Ge.exports={mode:{valType:"enumerated",dflt:"afterall",values:["immediate","next","afterall"]},direction:{valType:"enumerated",values:["forward","reverse"],dflt:"forward"},fromcurrent:{valType:"boolean",dflt:!1},frame:{duration:{valType:"number",min:0,dflt:500},redraw:{valType:"boolean",dflt:!0}},transition:{duration:{valType:"number",min:0,dflt:500,editType:"none"},easing:{valType:"enumerated",dflt:"cubic-in-out",values:["linear","quad","cubic","sin","exp","circle","elastic","back","bounce","linear-in","quad-in","cubic-in","sin-in","exp-in","circle-in","elastic-in","back-in","bounce-in","linear-out","quad-out","cubic-out","sin-out","exp-out","circle-out","elastic-out","back-out","bounce-out","linear-in-out","quad-in-out","cubic-in-out","sin-in-out","exp-in-out","circle-in-out","elastic-in-out","back-in-out","bounce-in-out"],editType:"none"},ordering:{valType:"enumerated",values:["layout first","traces first"],dflt:"layout first",editType:"none"}}}},{}],823:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../lib"),rt=Ne("../plot_api/plot_template");Ge.exports=function(Ne,Ge,Qe){var nt,at,it=Qe.name,ot=Qe.inclusionAttr||"visible",dt=Ge[it],ht=tt.isArrayOrTypedArray(Ne[it])?Ne[it]:[],Dt=Ge[it]=[],Ot=rt.arrayTemplater(Ge,it,ot);for(nt=0;nt<ht.length;nt++){var Rt=ht[nt];tt.isPlainObject(Rt)?at=Ot.newItem(Rt):(at=Ot.newItem({}))[ot]=!1,at._index=nt,!1!==at[ot]&&Qe.handleItemDefaults(Rt,at,Ge,Qe),Dt.push(at)}var Zt=Ot.defaultItems();for(nt=0;nt<Zt.length;nt++)(at=Zt[nt])._index=Dt.length,Qe.handleItemDefaults({},at,Ge,Qe,{}),Dt.push(at);if(tt.isArrayOrTypedArray(dt)){var er=Math.min(dt.length,Dt.length);for(nt=0;nt<er;nt++)tt.relinkPrivateKeys(Dt[nt],dt[nt])}return Dt}},{"../lib":778,"../plot_api/plot_template":817}],824:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../components/fx/attributes");Ge.exports={type:{valType:"enumerated",values:[],dflt:"scatter",editType:"calc+clearAxisTypes",_noTemplating:!0},visible:{valType:"enumerated",values:[!0,!1,"legendonly"],dflt:!0,editType:"calc"},showlegend:{valType:"boolean",dflt:!0,editType:"style"},legendgroup:{valType:"string",dflt:"",editType:"style"},opacity:{valType:"number",min:0,max:1,dflt:1,editType:"style"},name:{valType:"string",editType:"style"},uid:{valType:"string",editType:"plot",anim:!0},ids:{valType:"data_array",editType:"calc",anim:!0},customdata:{valType:"data_array",editType:"calc"},meta:{valType:"any",arrayOk:!0,editType:"plot"},selectedpoints:{valType:"any",editType:"calc"},hoverinfo:{valType:"flaglist",flags:["x","y","z","text","name"],extras:["all","none","skip"],arrayOk:!0,dflt:"all",editType:"none"},hoverlabel:tt.hoverlabel,stream:{token:{valType:"string",noBlank:!0,strict:!0,editType:"calc"},maxpoints:{valType:"number",min:0,max:1e4,dflt:500,editType:"calc"},editType:"calc"},transforms:{_isLinkedToArray:"transform",editType:"calc"},uirevision:{valType:"any",editType:"none"}}},{"../components/fx/attributes":674}],825:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../lib"),nt=rt.dateTime2ms,at=rt.incrementMonth,it=Ne("../../constants/numerical").ONEAVGMONTH;Ge.exports=function(Ne,Ge,Qe,rt){if("date"!==Ge.type)return rt;var ot=Ne[Qe+"periodalignment"];if(!ot)return rt;var dt,ht=Ne[Qe+"period"];if(tt(ht)){if((ht=+ht)<=0)return rt}else if("string"==typeof ht&&"M"===ht.charAt(0)){var Dt=+ht.substring(1);if(!(Dt>0&&Math.round(Dt)===Dt))return rt;dt=Dt}for(var Ot=Ge.calendar,Rt="start"===ot,Zt="end"===ot,er=Ne[Qe+"period0"],dr=nt(er,Ot)||0,mr=[],xr=rt.length,br=0;br<xr;br++){var Ar,en,mn,xn=rt[br];if(dt){for(Ar=Math.round((xn-dr)/(dt*it)),mn=at(dr,dt*Ar,Ot);mn>xn;)mn=at(mn,-dt,Ot);for(;mn<=xn;)mn=at(mn,dt,Ot);en=at(mn,-dt,Ot)}else{for(mn=dr+(Ar=Math.round((xn-dr)/ht))*ht;mn>xn;)mn-=ht;for(;mn<=xn;)mn+=ht;en=mn-ht}mr[br]=Rt?en:Zt?mn:(en+mn)/2}return mr}},{"../../constants/numerical":753,"../../lib":778,"fast-isnumeric":241}],826:[function(Ne,Ge,Qe){"use strict";Ge.exports={xaxis:{valType:"subplotid",dflt:"x",editType:"calc+clearAxisTypes"},yaxis:{valType:"subplotid",dflt:"y",editType:"calc+clearAxisTypes"}}},{}],827:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../lib"),nt=Ne("../../constants/numerical").FP_SAFE,at=Ne("../../registry"),it=Ne("./axis_ids"),ot=it.getFromId,dt=it.isLinked;function getAutoRange(Ne,Ge){var Qe,tt,nt=[],at=Ne._fullLayout,it=makePadFn(at,Ge,0),ot=makePadFn(at,Ge,1),dt=concatExtremes(Ne,Ge),ht=dt.min,Dt=dt.max;if(0===ht.length||0===Dt.length)return rt.simpleMap(Ge.range,Ge.r2l);var Ot=ht[0].val,Rt=Dt[0].val;for(Qe=1;Qe<ht.length&&Ot===Rt;Qe++)Ot=Math.min(Ot,ht[Qe].val);for(Qe=1;Qe<Dt.length&&Ot===Rt;Qe++)Rt=Math.max(Rt,Dt[Qe].val);var Zt=!1;if(Ge.range){var er=rt.simpleMap(Ge.range,Ge.r2l);Zt=er[1]<er[0]}"reversed"===Ge.autorange&&(Zt=!0,Ge.autorange=!0);var dr,mr,xr,br,Ar,en,mn=Ge.rangemode,xn="tozero"===mn,kn="nonnegative"===mn,Cn=Ge._length,En=Cn/10,Pn=0;for(Qe=0;Qe<ht.length;Qe++)for(dr=ht[Qe],tt=0;tt<Dt.length;tt++)(en=(mr=Dt[tt]).val-dr.val-calcBreaksLength(Ge,dr.val,mr.val))>0&&((Ar=Cn-it(dr)-ot(mr))>En?en/Ar>Pn&&(xr=dr,br=mr,Pn=en/Ar):en/Cn>Pn&&(xr={val:dr.val,nopad:1},br={val:mr.val,nopad:1},Pn=en/Cn));function maximumPad(Ne,Ge){return Math.max(Ne,ot(Ge))}if(Ot===Rt){var Dn=Ot-1,In=Ot+1;if(xn)if(0===Ot)nt=[0,1];else{var zn=(Ot>0?Dt:ht).reduce(maximumPad,0),Bn=Ot/(1-Math.min(.5,zn/Cn));nt=Ot>0?[0,Bn]:[Bn,0]}else nt=kn?[Math.max(0,Dn),Math.max(1,In)]:[Dn,In]}else xn?(xr.val>=0&&(xr={val:0,nopad:1}),br.val<=0&&(br={val:0,nopad:1})):kn&&(xr.val-Pn*it(xr)<0&&(xr={val:0,nopad:1}),br.val<=0&&(br={val:1,nopad:1})),Pn=(br.val-xr.val-calcBreaksLength(Ge,dr.val,mr.val))/(Cn-it(xr)-ot(br)),nt=[xr.val-Pn*it(xr),br.val+Pn*ot(br)];return Zt&&nt.reverse(),rt.simpleMap(nt,Ge.l2r||Number)}function calcBreaksLength(Ne,Ge,Qe){var tt=0;if(Ne.rangebreaks)for(var rt=Ne.locateBreaks(Ge,Qe),nt=0;nt<rt.length;nt++){var at=rt[nt];tt+=at.max-at.min}return tt}function makePadFn(Ne,Ge,Qe){var tt=.05*Ge._length,nt=Ge._anchorAxis||{};if(-1!==(Ge.ticklabelposition||"").indexOf("inside")||-1!==(nt.ticklabelposition||"").indexOf("inside")){var at="reversed"===Ge.autorange;if(!at){var it=rt.simpleMap(Ge.range,Ge.r2l);at=it[1]<it[0]}at&&(Qe=!Qe)}var ot=0;return dt(Ne,Ge._id)||(ot=padInsideLabelsOnAnchorAxis(Ge,Qe)),tt=Math.max(ot,tt),"domain"===Ge.constrain&&Ge._inputDomain&&(tt*=(Ge._inputDomain[1]-Ge._inputDomain[0])/(Ge.domain[1]-Ge.domain[0])),function(Ne){return Ne.nopad?0:Ne.pad+(Ne.extrapad?tt:ot)}}Ge.exports={getAutoRange:getAutoRange,makePadFn:makePadFn,doAutoRange:doAutoRange,findExtremes:findExtremes,concatExtremes:concatExtremes};var ht=3;function padInsideLabelsOnAnchorAxis(Ne,Ge){var Qe=0,tt=Ne._anchorAxis||{};if(-1!==(tt.ticklabelposition||"").indexOf("inside")&&(!Ge&&("left"===tt.side||"bottom"===tt.side)||Ge&&("top"===tt.side||"right"===tt.side))){var nt="x"===Ne._id.charAt(0);if(tt._vals){var at=rt.deg2rad(tt._tickAngles[tt._id+"tick"]||0),it=Math.abs(Math.cos(at)),ot=Math.abs(Math.sin(at));tt._vals.forEach((function(Ne){if(Ne.bb){var Ge=2*ht+Ne.bb.width,tt=2*ht+Ne.bb.height;Qe=Math.max(Qe,nt?Math.max(Ge*it,tt*ot):Math.max(tt*it,Ge*ot))}}))}"inside"===tt.ticks&&"inside"===tt.ticklabelposition&&(Qe+=tt.ticklen||0)}return Qe}function concatExtremes(Ne,Ge,Qe){var tt,rt,nt,at=Ge._id,it=Ne._fullData,dt=Ne._fullLayout,ht=[],Dt=[];function _concat(Ne,Ge){for(tt=0;tt<Ge.length;tt++){var Qe=Ne[Ge[tt]],it=(Qe._extremes||{})[at];if(!0===Qe.visible&&it){for(rt=0;rt<it.min.length;rt++)nt=it.min[rt],collapseMinArray(ht,nt.val,nt.pad,{extrapad:nt.extrapad});for(rt=0;rt<it.max.length;rt++)nt=it.max[rt],collapseMaxArray(Dt,nt.val,nt.pad,{extrapad:nt.extrapad})}}}if(_concat(it,Ge._traceIndices),_concat(dt.annotations||[],Ge._annIndices||[]),_concat(dt.shapes||[],Ge._shapeIndices||[]),Ge._matchGroup&&!Qe)for(var Ot in Ge._matchGroup)if(Ot!==Ge._id){var Rt=ot(Ne,Ot),Zt=concatExtremes(Ne,Rt,!0),er=Ge._length/Rt._length;for(rt=0;rt<Zt.min.length;rt++)nt=Zt.min[rt],collapseMinArray(ht,nt.val,nt.pad*er,{extrapad:nt.extrapad});for(rt=0;rt<Zt.max.length;rt++)nt=Zt.max[rt],collapseMaxArray(Dt,nt.val,nt.pad*er,{extrapad:nt.extrapad})}return{min:ht,max:Dt}}function doAutoRange(Ne,Ge,Qe){if(Ge.setScale(),Ge.autorange){Ge.range=Qe?Qe.slice():getAutoRange(Ne,Ge),Ge._r=Ge.range.slice(),Ge._rl=rt.simpleMap(Ge._r,Ge.r2l);var tt=Ge._input,nt={};nt[Ge._attr+".range"]=Ge.range,nt[Ge._attr+".autorange"]=Ge.autorange,at.call("_storeDirectGUIEdit",Ne.layout,Ne._fullLayout._preGUI,nt),tt.range=Ge.range.slice(),tt.autorange=Ge.autorange}var it=Ge._anchorAxis;if(it&&it.rangeslider){var ot=it.rangeslider[Ge._name];ot&&"auto"===ot.rangemode&&(ot.range=getAutoRange(Ne,Ge)),it._input.rangeslider[Ge._name]=rt.extendFlat({},ot)}}function findExtremes(Ne,Ge,Qe){Qe||(Qe={}),Ne._m||Ne.setScale();var rt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt=[],er=[],dr=Ge.length,mr=Qe.padded||!1,xr=Qe.tozero&&("linear"===Ne.type||"-"===Ne.type),br="log"===Ne.type,Ar=!1,en=Qe.vpadLinearized||!1;function makePadAccessor(Ne){if(Array.isArray(Ne))return Ar=!0,function(Ge){return Math.max(Number(Ne[Ge]||0),0)};var Ge=Math.max(Number(Ne||0),0);return function(){return Ge}}var mn=makePadAccessor((Ne._m>0?Qe.ppadplus:Qe.ppadminus)||Qe.ppad||0),xn=makePadAccessor((Ne._m>0?Qe.ppadminus:Qe.ppadplus)||Qe.ppad||0),kn=makePadAccessor(Qe.vpadplus||Qe.vpad),Cn=makePadAccessor(Qe.vpadminus||Qe.vpad);if(!Ar){if(Ot=1/0,Rt=-1/0,br)for(rt=0;rt<dr;rt++)(at=Ge[rt])<Ot&&at>0&&(Ot=at),at>Rt&&at<nt&&(Rt=at);else for(rt=0;rt<dr;rt++)(at=Ge[rt])<Ot&&at>-nt&&(Ot=at),at>Rt&&at<nt&&(Rt=at);Ge=[Ot,Rt],dr=2}var En={tozero:xr,extrapad:mr};function addItem(Qe){it=Ge[Qe],tt(it)&&(ht=mn(Qe),Dt=xn(Qe),en?(ot=Ne.c2l(it)-Cn(Qe),dt=Ne.c2l(it)+kn(Qe)):(Ot=it-Cn(Qe),Rt=it+kn(Qe),br&&Ot<Rt/10&&(Ot=Rt/10),ot=Ne.c2l(Ot),dt=Ne.c2l(Rt)),xr&&(ot=Math.min(0,ot),dt=Math.max(0,dt)),goodNumber(ot)&&collapseMinArray(Zt,ot,Dt,En),goodNumber(dt)&&collapseMaxArray(er,dt,ht,En))}var Pn=Math.min(6,dr);for(rt=0;rt<Pn;rt++)addItem(rt);for(rt=dr-1;rt>=Pn;rt--)addItem(rt);return{min:Zt,max:er,opts:Qe}}function collapseMinArray(Ne,Ge,Qe,tt){collapseArray(Ne,Ge,Qe,tt,lessOrEqual)}function collapseMaxArray(Ne,Ge,Qe,tt){collapseArray(Ne,Ge,Qe,tt,greaterOrEqual)}function collapseArray(Ne,Ge,Qe,tt,rt){for(var nt=tt.tozero,at=tt.extrapad,it=!0,ot=0;ot<Ne.length&&it;ot++){var dt=Ne[ot];if(rt(dt.val,Ge)&&dt.pad>=Qe&&(dt.extrapad||!at)){it=!1;break}rt(Ge,dt.val)&&dt.pad<=Qe&&(at||!dt.extrapad)&&(Ne.splice(ot,1),ot--)}if(it){var ht=nt&&0===Ge;Ne.push({val:Ge,pad:ht?0:Qe,extrapad:!ht&&at})}}function goodNumber(Ne){return tt(Ne)&&Math.abs(Ne)<nt}function lessOrEqual(Ne,Ge){return Ne<=Ge}function greaterOrEqual(Ne,Ge){return Ne>=Ge}},{"../../constants/numerical":753,"../../lib":778,"../../registry":911,"./axis_ids":831,"fast-isnumeric":241}],828:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("fast-isnumeric"),nt=Ne("../../plots/plots"),at=Ne("../../registry"),it=Ne("../../lib"),ot=it.strTranslate,dt=Ne("../../lib/svg_text_utils"),ht=Ne("../../components/titles"),Dt=Ne("../../components/color"),Ot=Ne("../../components/drawing"),Rt=Ne("./layout_attributes"),Zt=Ne("./clean_ticks"),er=Ne("../../constants/numerical"),dr=er.ONEMAXYEAR,mr=er.ONEAVGYEAR,xr=er.ONEMINYEAR,br=er.ONEMAXQUARTER,Ar=er.ONEAVGQUARTER,en=er.ONEMINQUARTER,mn=er.ONEMAXMONTH,xn=er.ONEAVGMONTH,kn=er.ONEMINMONTH,Cn=er.ONEWEEK,En=er.ONEDAY,Pn=En/2,Dn=er.ONEHOUR,In=er.ONEMIN,zn=er.ONESEC,Bn=er.MINUS_SIGN,Vn=er.BADNUM,Hn=Ne("../../constants/alignment"),qn=Hn.MID_SHIFT,Yn=Hn.CAP_SHIFT,$n=Hn.LINE_SPACING,ra=Hn.OPPOSITE_SIDE,oa=3,pa=Ge.exports={};pa.setConvert=Ne("./set_convert");var ga=Ne("./axis_autotype"),ma=Ne("./axis_ids"),_a=ma.idSort,Va=ma.isLinked;pa.id2name=ma.id2name,pa.name2id=ma.name2id,pa.cleanId=ma.cleanId,pa.list=ma.list,pa.listIds=ma.listIds,pa.getFromId=ma.getFromId,pa.getFromTrace=ma.getFromTrace;var Wa=Ne("./autorange");pa.getAutoRange=Wa.getAutoRange,pa.findExtremes=Wa.findExtremes;var Qa=1e-4;function expandRange(Ne){var Ge=(Ne[1]-Ne[0])*Qa;return[Ne[0]-Ge,Ne[1]+Ge]}pa.coerceRef=function(Ne,Ge,Qe,tt,rt,nt){var at=tt.charAt(tt.length-1),ot=Qe._fullLayout._subplots[at+"axis"],dt=tt+"ref",ht={};return rt||(rt=ot[0]||("string"==typeof nt?nt:nt[0])),nt||(nt=rt),ot=ot.concat(ot.map((function(Ne){return Ne+" domain"}))),ht[dt]={valType:"enumerated",values:ot.concat(nt?"string"==typeof nt?[nt]:nt:[]),dflt:rt},it.coerce(Ne,Ge,ht,dt)},pa.getRefType=function(Ne){return void 0===Ne?Ne:"paper"===Ne?"paper":"pixel"===Ne?"pixel":/( domain)$/.test(Ne)?"domain":"range"},pa.coercePosition=function(Ne,Ge,Qe,tt,rt,nt){var at,ot;if("range"!==pa.getRefType(tt))at=it.ensureNumber,ot=Qe(rt,nt);else{var dt=pa.getFromId(Ge,tt);ot=Qe(rt,nt=dt.fraction2r(nt)),at=dt.cleanPos}Ne[rt]=at(ot)},pa.cleanPosition=function(Ne,Ge,Qe){return("paper"===Qe||"pixel"===Qe?it.ensureNumber:pa.getFromId(Ge,Qe).cleanPos)(Ne)},pa.redrawComponents=function(Ne,Ge){Ge=Ge||pa.listIds(Ne);var Qe=Ne._fullLayout;function _redrawOneComp(tt,rt,nt,it){for(var ot=at.getComponentMethod(tt,rt),dt={},ht=0;ht<Ge.length;ht++)for(var Dt=Qe[pa.id2name(Ge[ht])][nt],Ot=0;Ot<Dt.length;Ot++){var Rt=Dt[Ot];if(!dt[Rt]&&(ot(Ne,Rt),dt[Rt]=1,it))return}}_redrawOneComp("annotations","drawOne","_annIndices"),_redrawOneComp("shapes","drawOne","_shapeIndices"),_redrawOneComp("images","draw","_imgIndices",!0)};var ti=pa.getDataConversions=function(Ne,Ge,Qe,tt){var rt,nt="x"===Qe||"y"===Qe||"z"===Qe?Qe:tt;if(Array.isArray(nt)){if(rt={type:ga(tt,void 0,{autotypenumbers:Ne._fullLayout.autotypenumbers}),_categories:[]},pa.setConvert(rt),"category"===rt.type)for(var at=0;at<tt.length;at++)rt.d2c(tt[at])}else rt=pa.getFromTrace(Ne,Ge,nt);return rt?{d2c:rt.d2c,c2d:rt.c2d}:"ids"===nt?{d2c:toString,c2d:toString}:{d2c:toNum,c2d:toNum}};function toNum(Ne){return+Ne}function toString(Ne){return String(Ne)}function autoShiftNumericBins(Ne,Ge,Qe,tt,nt){var at=0,it=0,ot=0,dt=0;function nearEdge(Ge){return(1+100*(Ge-Ne)/Qe.dtick)%100<2}for(var ht=0;ht<Ge.length;ht++)Ge[ht]%1==0?ot++:rt(Ge[ht])||dt++,nearEdge(Ge[ht])&&at++,nearEdge(Ge[ht]+Qe.dtick/2)&&it++;var Dt=Ge.length-dt;if(ot===Dt&&"date"!==Qe.type)Qe.dtick<1?Ne=tt-.5*Qe.dtick:(Ne-=.5)+Qe.dtick<tt&&(Ne+=Qe.dtick);else if(it<.1*Dt&&(at>.3*Dt||nearEdge(tt)||nearEdge(nt))){var Ot=Qe.dtick/2;Ne+=Ne+Ot<tt?Ot:-Ot}return Ne}function autoShiftMonthBins(Ne,Ge,Qe,tt,rt){var nt=it.findExactDates(Ge,rt),at=.8;if(nt.exactDays>at){var ot=Number(Qe.substr(1));nt.exactYears>at&&ot%12==0?Ne=pa.tickIncrement(Ne,"M6","reverse")+1.5*En:nt.exactMonths>at?Ne=pa.tickIncrement(Ne,"M1","reverse")+15.5*En:Ne-=Pn;var dt=pa.tickIncrement(Ne,Qe);if(dt<=tt)return dt}return Ne}function nMonths(Ne){return+Ne.substring(1)}function adjustPeriodDelta(Ne){var Ge;function mDate(){return!(rt(Ne.dtick)||"M"!==Ne.dtick.charAt(0))}var Qe=mDate(),tt=pa.getTickFormat(Ne);if(tt){var nt=Ne._dtickInit!==Ne.dtick;/%[fLQsSMX]/.test(tt)||(/%[HI]/.test(tt)?(Ge=Dn,nt&&!Qe&&Ne.dtick<Dn&&(Ne.dtick=Dn)):/%p/.test(tt)?(Ge=Pn,nt&&!Qe&&Ne.dtick<Pn&&(Ne.dtick=Pn)):/%[Aadejuwx]/.test(tt)?(Ge=En,nt&&!Qe&&Ne.dtick<En&&(Ne.dtick=En)):/%[UVW]/.test(tt)?(Ge=Cn,nt&&!Qe&&Ne.dtick<Cn&&(Ne.dtick=Cn)):/%[Bbm]/.test(tt)?(Ge=xn,nt&&(Qe?nMonths(Ne.dtick)<1:Ne.dtick<kn)&&(Ne.dtick="M1")):/%[q]/.test(tt)?(Ge=Ar,nt&&(Qe?nMonths(Ne.dtick)<3:Ne.dtick<en)&&(Ne.dtick="M3")):/%[Yy]/.test(tt)&&(Ge=mr,nt&&(Qe?nMonths(Ne.dtick)<12:Ne.dtick<xr)&&(Ne.dtick="M12")))}(Qe=mDate())&&Ne.tick0===Ne._dowTick0&&(Ne.tick0=Ne._rawTick0),Ne._definedDelta=Ge}function positionPeriodTicks(Ne,Ge,Qe){for(var tt=0;tt<Ne.length;tt++){var rt=Ne[tt].value,nt=tt,at=tt+1;tt<Ne.length-1?(nt=tt,at=tt+1):tt>0?(nt=tt-1,at=tt):(nt=tt,at=tt);var it,ot=Ne[nt].value,dt=Ne[at].value,ht=Math.abs(dt-ot),Dt=Qe||ht,Ot=0;Dt>=xr?Ot=ht>=xr&&ht<=dr?ht:mr:Qe===Ar&&Dt>=en?Ot=ht>=en&&ht<=br?ht:Ar:Dt>=kn?Ot=ht>=kn&&ht<=mn?ht:xn:Qe===Cn&&Dt>=Cn?Ot=Cn:Dt>=En?Ot=En:Qe===Pn&&Dt>=Pn?Ot=Pn:Qe===Dn&&Dt>=Dn&&(Ot=Dn),Ot>=ht&&(Ot=ht,it=!0);var Rt=rt+Ot;if(Ge.rangebreaks&&Ot>0){for(var Zt=84,er=0,In=0;In<Zt;In++){var zn=(In+.5)/Zt;Ge.maskBreaks(rt*(1-zn)+zn*Rt)!==Vn&&er++}(Ot*=er/Zt)||(Ne[tt].drop=!0),it&&ht>Cn&&(Ot=ht)}(Ot>0||0===tt)&&(Ne[tt].periodX=rt+Ot/2)}}function arrayTicks(Ne){var Ge=Ne.tickvals,Qe=Ne.ticktext,tt=new Array(Ge.length),rt=expandRange(it.simpleMap(Ne.range,Ne.r2l)),nt=Math.min(rt[0],rt[1]),at=Math.max(rt[0],rt[1]),ot=0;Array.isArray(Qe)||(Qe=[]);var dt="category"===Ne.type?Ne.d2l_noadd:Ne.d2l;"log"===Ne.type&&"L"!==String(Ne.dtick).charAt(0)&&(Ne.dtick="L"+Math.pow(10,Math.floor(Math.min(Ne.range[0],Ne.range[1]))-1));for(var ht=0;ht<Ge.length;ht++){var Dt=dt(Ge[ht]);Dt>nt&&Dt<at&&(void 0===Qe[ht]?tt[ot]=pa.tickText(Ne,Dt):tt[ot]=tickTextObj(Ne,Dt,String(Qe[ht])),ot++)}return ot<Ge.length&&tt.splice(ot,Ge.length-ot),Ne.rangebreaks&&(tt=tt.filter((function(Ge){return Ne.maskBreaks(Ge.x)!==Vn}))),tt}pa.getDataToCoordFunc=function(Ne,Ge,Qe,tt){return ti(Ne,Ge,Qe,tt).d2c},pa.counterLetter=function(Ne){var Ge=Ne.charAt(0);return"x"===Ge?"y":"y"===Ge?"x":void 0},pa.minDtick=function(Ne,Ge,Qe,tt){-1===["log","category","multicategory"].indexOf(Ne.type)&&tt?void 0===Ne._minDtick?(Ne._minDtick=Ge,Ne._forceTick0=Qe):Ne._minDtick&&((Ne._minDtick/Ge+1e-6)%1<2e-6&&((Qe-Ne._forceTick0)/Ge%1+1.000001)%1<2e-6?(Ne._minDtick=Ge,Ne._forceTick0=Qe):((Ge/Ne._minDtick+1e-6)%1>2e-6||((Qe-Ne._forceTick0)/Ne._minDtick%1+1.000001)%1>2e-6)&&(Ne._minDtick=0)):Ne._minDtick=0},pa.saveRangeInitial=function(Ne,Ge){for(var Qe=pa.list(Ne,"",!0),tt=!1,rt=0;rt<Qe.length;rt++){var nt=Qe[rt],at=void 0===nt._rangeInitial,it=at||!(nt.range[0]===nt._rangeInitial[0]&&nt.range[1]===nt._rangeInitial[1]);(at&&!1===nt.autorange||Ge&&it)&&(nt._rangeInitial=nt.range.slice(),tt=!0)}return tt},pa.saveShowSpikeInitial=function(Ne,Ge){for(var Qe=pa.list(Ne,"",!0),tt=!1,rt="on",nt=0;nt<Qe.length;nt++){var at=Qe[nt],it=void 0===at._showSpikeInitial,ot=it||!(at.showspikes===at._showspikes);(it||Ge&&ot)&&(at._showSpikeInitial=at.showspikes,tt=!0),"on"!==rt||at.showspikes||(rt="off")}return Ne._fullLayout._cartesianSpikesEnabled=rt,tt},pa.autoBin=function(Ne,Ge,Qe,tt,nt,at){var ot,dt=it.aggNums(Math.min,null,Ne),ht=it.aggNums(Math.max,null,Ne);if("category"===Ge.type||"multicategory"===Ge.type)return{start:dt-.5,end:ht+.5,size:Math.max(1,Math.round(at)||1),_dataSpan:ht-dt};if(nt||(nt=Ge.calendar),ot="log"===Ge.type?{type:"linear",range:[dt,ht]}:{type:Ge.type,range:it.simpleMap([dt,ht],Ge.c2r,0,nt),calendar:nt},pa.setConvert(ot),at=at&&Zt.dtick(at,ot.type))ot.dtick=at,ot.tick0=Zt.tick0(void 0,ot.type,nt);else{var Dt;if(Qe)Dt=(ht-dt)/Qe;else{var Ot=it.distinctVals(Ne),Rt=Math.pow(10,Math.floor(Math.log(Ot.minDiff)/Math.LN10)),er=Rt*it.roundUp(Ot.minDiff/Rt,[.9,1.9,4.9,9.9],!0);Dt=Math.max(er,2*it.stdev(Ne)/Math.pow(Ne.length,tt?.25:.4)),rt(Dt)||(Dt=1)}pa.autoTicks(ot,Dt)}var dr,mr=ot.dtick,xr=pa.tickIncrement(pa.tickFirst(ot),mr,"reverse",nt);if("number"==typeof mr)dr=(xr=autoShiftNumericBins(xr,Ne,ot,dt,ht))+(1+Math.floor((ht-xr)/mr))*mr;else for("M"===ot.dtick.charAt(0)&&(xr=autoShiftMonthBins(xr,Ne,mr,dt,nt)),dr=xr;dr<=ht;)dr=pa.tickIncrement(dr,mr,!1,nt);return{start:Ge.c2r(xr,0,nt),end:Ge.c2r(dr,0,nt),size:mr,_dataSpan:ht-dt}},pa.prepTicks=function(Ne,Ge){var Qe=it.simpleMap(Ne.range,Ne.r2l,void 0,void 0,Ge);if(Ne._dtickInit=Ne.dtick,Ne._tick0Init=Ne.tick0,"auto"===Ne.tickmode||!Ne.dtick){var tt,rt=Ne.nticks;rt||("category"===Ne.type||"multicategory"===Ne.type?(tt=Ne.tickfont?1.2*(Ne.tickfont.size||12):15,rt=Ne._length/tt):(tt="y"===Ne._id.charAt(0)?40:80,rt=it.constrain(Ne._length/tt,4,9)+1),"radialaxis"===Ne._name&&(rt*=2)),"array"===Ne.tickmode&&(rt*=100),Ne._roughDTick=Math.abs(Qe[1]-Qe[0])/rt,pa.autoTicks(Ne,Ne._roughDTick),Ne._minDtick>0&&Ne.dtick<2*Ne._minDtick&&(Ne.dtick=Ne._minDtick,Ne.tick0=Ne.l2r(Ne._forceTick0))}"period"===Ne.ticklabelmode&&adjustPeriodDelta(Ne),Ne.tick0||(Ne.tick0="date"===Ne.type?"2000-01-01":0),"date"===Ne.type&&Ne.dtick<.1&&(Ne.dtick=.1),autoTickRound(Ne)},pa.calcTicks=function(Ne,Ge){pa.prepTicks(Ne,Ge);var Qe=it.simpleMap(Ne.range,Ne.r2l,void 0,void 0,Ge);if("array"===Ne.tickmode)return arrayTicks(Ne);var tt=expandRange(Qe),nt=tt[0],at=tt[1],ot=Qe[1]<Qe[0],dt=Math.min(Qe[0],Qe[1]),ht=Math.max(Qe[0],Qe[1]),Dt="log"===Ne.type&&!(rt(Ne.dtick)||"L"===Ne.dtick.charAt(0)),Ot="period"===Ne.ticklabelmode;if(Ne._tmin=pa.tickFirst(Ne,Ge),Ne._tmin<nt!==ot)return[];"category"!==Ne.type&&"multicategory"!==Ne.type||(at=ot?Math.max(-.5,at):Math.min(Ne._categories.length-.5,at));var Rt=Ne._tmin;Ne.rangebreaks&&Ne._tick0Init!==Ne.tick0&&(Rt=moveOutsideBreak(Rt,Ne),ot||(Rt=pa.tickIncrement(Rt,Ne.dtick,!ot,Ne.calendar))),Ot&&(Rt=pa.tickIncrement(Rt,Ne.dtick,!ot,Ne.calendar));for(var Zt,er=Math.max(1e3,Ne._length||0),dr=[],mr=null;ot?Rt>=at:Rt<=at;Rt=pa.tickIncrement(Rt,Ne.dtick,ot,Ne.calendar)){if(Ne.rangebreaks&&!ot){if(Rt<nt)continue;if(Ne.maskBreaks(Rt)===Vn&&moveOutsideBreak(Rt,Ne)>=ht)break}if(dr.length>er||Rt===mr)break;mr=Rt;var xr=!1;Dt&&Rt!==(0|Rt)&&(xr=!0),dr.push({minor:xr,value:Rt})}if(Ot&&positionPeriodTicks(dr,Ne,Ne._definedDelta),Ne.rangebreaks){var br="y"===Ne._id.charAt(0),Ar=1;"auto"===Ne.tickmode&&(Ar=Ne.tickfont?Ne.tickfont.size:12);var en=NaN;for(Zt=dr.length-1;Zt>-1;Zt--)if(dr[Zt].drop)dr.splice(Zt,1);else{dr[Zt].value=moveOutsideBreak(dr[Zt].value,Ne);var mn=Ne.c2p(dr[Zt].value);(br?en>mn-Ar:en<mn+Ar)?dr.splice(ot?Zt+1:Zt,1):en=mn}}isAngular(Ne)&&360===Math.abs(Qe[1]-Qe[0])&&dr.pop(),Ne._tmax=(dr[dr.length-1]||{}).value,Ne._prevDateHead="",Ne._inCalcTicks=!0;var xn,kn,Cn=[];for(Zt=0;Zt<dr.length;Zt++){var En=dr[Zt].minor,Pn=dr[Zt].value;xn=pa.tickText(Ne,Pn,!1,En),void 0!==(kn=dr[Zt].periodX)&&(xn.periodX=kn,(kn>ht||kn<dt)&&(kn>ht&&(xn.periodX=ht),kn<dt&&(xn.periodX=dt),xn.text=" ",Ne._prevDateHead="")),Cn.push(xn)}return Ne._inCalcTicks=!1,Cn};var ni=[2,5,10],di=[1,2,3,6,12],ji=[1,2,5,10,15,30],Hi=[1,2,3,7,14],Yi=[-.046,0,.301,.477,.602,.699,.778,.845,.903,.954,1],uo=[-.301,0,.301,.699,1],go=[15,30,45,90,180];function roundDTick(Ne,Ge,Qe){return Ge*it.roundUp(Ne/Ge,Qe)}function autoTickRound(Ne){var Ge=Ne.dtick;if(Ne._tickexponent=0,rt(Ge)||"string"==typeof Ge||(Ge=1),"category"!==Ne.type&&"multicategory"!==Ne.type||(Ne._tickround=null),"date"===Ne.type){var Qe=Ne.r2l(Ne.tick0),tt=Ne.l2r(Qe).replace(/(^-|i)/g,""),nt=tt.length;if("M"===String(Ge).charAt(0))nt>10||"01-01"!==tt.substr(5)?Ne._tickround="d":Ne._tickround=+Ge.substr(1)%12==0?"y":"m";else if(Ge>=En&&nt<=10||Ge>=15*En)Ne._tickround="d";else if(Ge>=In&&nt<=16||Ge>=Dn)Ne._tickround="M";else if(Ge>=zn&&nt<=19||Ge>=In)Ne._tickround="S";else{var at=Ne.l2r(Qe+Ge).replace(/^-/,"").length;Ne._tickround=Math.max(nt,at)-20,Ne._tickround<0&&(Ne._tickround=4)}}else if(rt(Ge)||"L"===Ge.charAt(0)){var it=Ne.range.map(Ne.r2d||Number);rt(Ge)||(Ge=Number(Ge.substr(1))),Ne._tickround=2-Math.floor(Math.log(Ge)/Math.LN10+.01);var ot=Math.max(Math.abs(it[0]),Math.abs(it[1])),dt=Math.floor(Math.log(ot)/Math.LN10+.01),ht=void 0===Ne.minexponent?3:Ne.minexponent;Math.abs(dt)>ht&&(isSIFormat(Ne.exponentformat)&&!beyondSI(dt)?Ne._tickexponent=3*Math.round((dt-1)/3):Ne._tickexponent=dt)}else Ne._tickround=null}function tickTextObj(Ne,Ge,Qe){var tt=Ne.tickfont||{};return{x:Ge,dx:0,dy:0,text:Qe||"",fontSize:tt.size,font:tt.family,fontColor:tt.color}}function formatDate(Ne,Ge,Qe,tt){var nt=Ne._tickround,at=Qe&&Ne.hoverformat||pa.getTickFormat(Ne);tt&&(nt=rt(nt)?4:{y:"m",m:"d",d:"M",M:"S",S:4}[nt]);var ot,dt=it.formatDate(Ge.x,at,nt,Ne._dateFormat,Ne.calendar,Ne._extraFormat),ht=dt.indexOf("\n");if(-1!==ht&&(ot=dt.substr(ht+1),dt=dt.substr(0,ht)),tt&&("00:00:00"===dt||"00:00"===dt?(dt=ot,ot=""):8===dt.length&&(dt=dt.replace(/:00$/,""))),ot)if(Qe)"d"===nt?dt+=", "+ot:dt=ot+(dt?", "+dt:"");else if(Ne._inCalcTicks&&Ne._prevDateHead===ot){var Dt=-1!==(Ne.ticklabelposition||"").indexOf("inside"),Ot=Ne._realSide||Ne.side;(!Dt&&"top"===Ot||Dt&&"bottom"===Ot)&&(dt+="<br> ")}else Ne._prevDateHead=ot,dt+="<br>"+ot;Ge.text=dt}function formatLog(Ne,Ge,Qe,tt,nt){var at=Ne.dtick,ot=Ge.x,dt=Ne.tickformat,ht="string"==typeof at&&at.charAt(0);if("never"===nt&&(nt=""),tt&&"L"!==ht&&(at="L3",ht="L"),dt||"L"===ht)Ge.text=numFormat(Math.pow(10,ot),Ne,nt,tt);else if(rt(at)||"D"===ht&&it.mod(ot+.01,1)<.1){var Dt=Math.round(ot),Ot=Math.abs(Dt),Rt=Ne.exponentformat;"power"===Rt||isSIFormat(Rt)&&beyondSI(Dt)?(Ge.text=0===Dt?1:1===Dt?"10":"10<sup>"+(Dt>1?"":Bn)+Ot+"</sup>",Ge.fontSize*=1.25):("e"===Rt||"E"===Rt)&&Ot>2?Ge.text="1"+Rt+(Dt>0?"+":Bn)+Ot:(Ge.text=numFormat(Math.pow(10,ot),Ne,"","fakehover"),"D1"===at&&"y"===Ne._id.charAt(0)&&(Ge.dy-=Ge.fontSize/6))}else{if("D"!==ht)throw"unrecognized dtick "+String(at);Ge.text=String(Math.round(Math.pow(10,it.mod(ot,1)))),Ge.fontSize*=.75}if("D1"===Ne.dtick){var Zt=String(Ge.text).charAt(0);"0"!==Zt&&"1"!==Zt||("y"===Ne._id.charAt(0)?Ge.dx-=Ge.fontSize/4:(Ge.dy+=Ge.fontSize/2,Ge.dx+=(Ne.range[1]>Ne.range[0]?1:-1)*Ge.fontSize*(ot<0?.5:.25)))}}function formatCategory(Ne,Ge){var Qe=Ne._categories[Math.round(Ge.x)];void 0===Qe&&(Qe=""),Ge.text=String(Qe)}function formatMultiCategory(Ne,Ge,Qe){var tt=Math.round(Ge.x),rt=Ne._categories[tt]||[],nt=void 0===rt[1]?"":String(rt[1]),at=void 0===rt[0]?"":String(rt[0]);Qe?Ge.text=at+" - "+nt:(Ge.text=nt,Ge.text2=at)}function formatLinear(Ne,Ge,Qe,tt,rt){"never"===rt?rt="":"all"===Ne.showexponent&&Math.abs(Ge.x/Ne.dtick)<1e-6&&(rt="hide"),Ge.text=numFormat(Ge.x,Ne,rt,tt)}function formatAngle(Ne,Ge,Qe,tt,rt){if("radians"!==Ne.thetaunit||Qe)Ge.text=numFormat(Ge.x,Ne,rt,tt);else{var nt=Ge.x/180;if(0===nt)Ge.text="0";else{var at=num2frac(nt);if(at[1]>=100)Ge.text=numFormat(it.deg2rad(Ge.x),Ne,rt,tt);else{var ot=Ge.x<0;1===at[1]?1===at[0]?Ge.text="Ï":Ge.text=at[0]+"Ï":Ge.text=["<sup>",at[0],"</sup>","â","<sub>",at[1],"</sub>","Ï"].join(""),ot&&(Ge.text=Bn+Ge.text)}}}}function num2frac(Ne){function almostEq(Ne,Ge){return Math.abs(Ne-Ge)<=1e-6}function findGCD(Ne,Ge){return almostEq(Ge,0)?Ne:findGCD(Ge,Ne%Ge)}function findPrecision(Ne){for(var Ge=1;!almostEq(Math.round(Ne*Ge)/Ge,Ne);)Ge*=10;return Ge}var Ge=findPrecision(Ne),Qe=Ne*Ge,tt=Math.abs(findGCD(Qe,Ge));return[Math.round(Qe/tt),Math.round(Ge/tt)]}pa.autoTicks=function(Ne,Ge){var Qe;function getBase(Ne){return Math.pow(Ne,Math.floor(Math.log(Ge)/Math.LN10))}if("date"===Ne.type){Ne.tick0=it.dateTick0(Ne.calendar,0);var tt=2*Ge;if(tt>mr)Ge/=mr,Qe=getBase(10),Ne.dtick="M"+12*roundDTick(Ge,Qe,ni);else if(tt>xn)Ge/=xn,Ne.dtick="M"+roundDTick(Ge,1,di);else if(tt>En){Ne.dtick=roundDTick(Ge,En,Ne._hasDayOfWeekBreaks?[1,2,7,14]:Hi);var nt=pa.getTickFormat(Ne),at="period"===Ne.ticklabelmode;at&&(Ne._rawTick0=Ne.tick0),/%[uVW]/.test(nt)?Ne.tick0=it.dateTick0(Ne.calendar,2):Ne.tick0=it.dateTick0(Ne.calendar,1),at&&(Ne._dowTick0=Ne.tick0)}else tt>Dn?Ne.dtick=roundDTick(Ge,Dn,di):tt>In?Ne.dtick=roundDTick(Ge,In,ji):tt>zn?Ne.dtick=roundDTick(Ge,zn,ji):(Qe=getBase(10),Ne.dtick=roundDTick(Ge,Qe,ni))}else if("log"===Ne.type){Ne.tick0=0;var ot=it.simpleMap(Ne.range,Ne.r2l);if(Ge>.7)Ne.dtick=Math.ceil(Ge);else if(Math.abs(ot[1]-ot[0])<1){var dt=1.5*Math.abs((ot[1]-ot[0])/Ge);Ge=Math.abs(Math.pow(10,ot[1])-Math.pow(10,ot[0]))/dt,Qe=getBase(10),Ne.dtick="L"+roundDTick(Ge,Qe,ni)}else Ne.dtick=Ge>.3?"D2":"D1"}else"category"===Ne.type||"multicategory"===Ne.type?(Ne.tick0=0,Ne.dtick=Math.ceil(Math.max(Ge,1))):isAngular(Ne)?(Ne.tick0=0,Qe=1,Ne.dtick=roundDTick(Ge,Qe,go)):(Ne.tick0=0,Qe=getBase(10),Ne.dtick=roundDTick(Ge,Qe,ni));if(0===Ne.dtick&&(Ne.dtick=1),!rt(Ne.dtick)&&"string"!=typeof Ne.dtick){var ht=Ne.dtick;throw Ne.dtick=1,"ax.dtick error: "+String(ht)}},pa.tickIncrement=function(Ne,Ge,Qe,nt){var at=Qe?-1:1;if(rt(Ge))return it.increment(Ne,at*Ge);var ot=Ge.charAt(0),dt=at*Number(Ge.substr(1));if("M"===ot)return it.incrementMonth(Ne,dt,nt);if("L"===ot)return Math.log(Math.pow(10,Ne)+dt)/Math.LN10;if("D"===ot){var ht="D2"===Ge?uo:Yi,Dt=Ne+.01*at,Ot=it.roundUp(it.mod(Dt,1),ht,Qe);return Math.floor(Dt)+Math.log(tt.round(Math.pow(10,Ot),1))/Math.LN10}throw"unrecognized dtick "+String(Ge)},pa.tickFirst=function(Ne,Ge){var Qe=Ne.r2l||Number,nt=it.simpleMap(Ne.range,Qe,void 0,void 0,Ge),at=nt[1]<nt[0],ot=at?Math.floor:Math.ceil,dt=expandRange(nt)[0],ht=Ne.dtick,Dt=Qe(Ne.tick0);if(rt(ht)){var Ot=ot((dt-Dt)/ht)*ht+Dt;return"category"!==Ne.type&&"multicategory"!==Ne.type||(Ot=it.constrain(Ot,0,Ne._categories.length-1)),Ot}var Rt=ht.charAt(0),Zt=Number(ht.substr(1));if("M"===Rt){for(var er,dr,mr,xr=0,br=Dt;xr<10;){if(((er=pa.tickIncrement(br,ht,at,Ne.calendar))-dt)*(br-dt)<=0)return at?Math.min(br,er):Math.max(br,er);dr=(dt-(br+er)/2)/(er-br),mr=Rt+(Math.abs(Math.round(dr))||1)*Zt,br=pa.tickIncrement(br,mr,dr<0?!at:at,Ne.calendar),xr++}return it.error("tickFirst did not converge",Ne),br}if("L"===Rt)return Math.log(ot((Math.pow(10,dt)-Dt)/Zt)*Zt+Dt)/Math.LN10;if("D"===Rt){var Ar="D2"===ht?uo:Yi,en=it.roundUp(it.mod(dt,1),Ar,at);return Math.floor(dt)+Math.log(tt.round(Math.pow(10,en),1))/Math.LN10}throw"unrecognized dtick "+String(ht)},pa.tickText=function(Ne,Ge,Qe,tt){var rt,nt=tickTextObj(Ne,Ge),at="array"===Ne.tickmode,ot=Qe||at,dt=Ne.type,ht="category"===dt?Ne.d2l_noadd:Ne.d2l;if(at&&Array.isArray(Ne.ticktext)){var Dt=it.simpleMap(Ne.range,Ne.r2l),Ot=(Math.abs(Dt[1]-Dt[0])-(Ne._lBreaks||0))/1e4;for(rt=0;rt<Ne.ticktext.length&&!(Math.abs(Ge-ht(Ne.tickvals[rt]))<Ot);rt++);if(rt<Ne.ticktext.length)return nt.text=String(Ne.ticktext[rt]),nt}function isHidden(tt){if(void 0===tt)return!0;if(Qe)return"none"===tt;var rt={first:Ne._tmin,last:Ne._tmax}[tt];return"all"!==tt&&Ge!==rt}var Rt=Qe?"never":"none"!==Ne.exponentformat&&isHidden(Ne.showexponent)?"hide":"";if("date"===dt?formatDate(Ne,nt,Qe,ot):"log"===dt?formatLog(Ne,nt,Qe,ot,Rt):"category"===dt?formatCategory(Ne,nt):"multicategory"===dt?formatMultiCategory(Ne,nt,Qe):isAngular(Ne)?formatAngle(Ne,nt,Qe,ot,Rt):formatLinear(Ne,nt,Qe,ot,Rt),tt||(Ne.tickprefix&&!isHidden(Ne.showtickprefix)&&(nt.text=Ne.tickprefix+nt.text),Ne.ticksuffix&&!isHidden(Ne.showticksuffix)&&(nt.text+=Ne.ticksuffix)),"boundaries"===Ne.tickson||Ne.showdividers){var inbounds=function(Ge){var Qe=Ne.l2p(Ge);return Qe>=0&&Qe<=Ne._length?Ge:null};nt.xbnd=[inbounds(nt.x-.5),inbounds(nt.x+Ne.dtick-.5)]}return nt},pa.hoverLabelText=function(Ne,Ge,Qe){if(Qe!==Vn&&Qe!==Ge)return pa.hoverLabelText(Ne,Ge)+" - "+pa.hoverLabelText(Ne,Qe);var tt="log"===Ne.type&&Ge<=0,rt=pa.tickText(Ne,Ne.c2l(tt?-Ge:Ge),"hover").text;return tt?0===Ge?"0":Bn+rt:rt};var ns=["f","p","n","Î¼","m","","k","M","G","T"];function isSIFormat(Ne){return"SI"===Ne||"B"===Ne}function beyondSI(Ne){return Ne>14||Ne<-15}function numFormat(Ne,Ge,Qe,tt){var nt=Ne<0,at=Ge._tickround,ot=Qe||Ge.exponentformat||"B",dt=Ge._tickexponent,ht=pa.getTickFormat(Ge),Dt=Ge.separatethousands;if(tt){var Ot={exponentformat:ot,minexponent:Ge.minexponent,dtick:"none"===Ge.showexponent?Ge.dtick:rt(Ne)&&Math.abs(Ne)||1,range:"none"===Ge.showexponent?Ge.range.map(Ge.r2d):[0,Ne||1]};autoTickRound(Ot),at=(Number(Ot._tickround)||0)+4,dt=Ot._tickexponent,Ge.hoverformat&&(ht=Ge.hoverformat)}if(ht)return Ge._numFormat(ht)(Ne).replace(/-/g,Bn);var Rt,Zt=Math.pow(10,-at)/2;if("none"===ot&&(dt=0),(Ne=Math.abs(Ne))<Zt)Ne="0",nt=!1;else{if(Ne+=Zt,dt&&(Ne*=Math.pow(10,-dt),at+=dt),0===at)Ne=String(Math.floor(Ne));else if(at<0){Ne=(Ne=String(Math.round(Ne))).substr(0,Ne.length+at);for(var er=at;er<0;er++)Ne+="0"}else{var dr=(Ne=String(Ne)).indexOf(".")+1;dr&&(Ne=Ne.substr(0,dr+at).replace(/\.?0+$/,""))}Ne=it.numSeparate(Ne,Ge._separators,Dt)}return dt&&"hide"!==ot&&(isSIFormat(ot)&&beyondSI(dt)&&(ot="power"),Rt=dt<0?Bn+-dt:"power"!==ot?"+"+dt:String(dt),"e"===ot||"E"===ot?Ne+=ot+Rt:"power"===ot?Ne+="Ã10<sup>"+Rt+"</sup>":"B"===ot&&9===dt?Ne+="B":isSIFormat(ot)&&(Ne+=ns[dt/3+5])),nt?Bn+Ne:Ne}function getBoundaryVals(Ne,Ge){var Qe,tt=[],_push=function(Ne,Ge){var Qe=Ne.xbnd[Ge];null!==Qe&&tt.push(it.extendFlat({},Ne,{x:Qe}))};if(Ge.length){for(Qe=0;Qe<Ge.length;Qe++)_push(Ge[Qe],0);_push(Ge[Qe-1],1)}return tt}function getSecondaryLabelVals(Ne,Ge){for(var Qe=[],tt={},rt=0;rt<Ge.length;rt++){var nt=Ge[rt];tt[nt.text2]?tt[nt.text2].push(nt.x):tt[nt.text2]=[nt.x]}for(var at in tt)Qe.push(tickTextObj(Ne,it.interp(tt[at],.5),at));return Qe}function getDividerVals(Ne,Ge){var Qe,tt,rt=[],nt=Ge.length&&Ge[Ge.length-1].x<Ge[0].x,_push=function(Ne,Ge){var Qe=Ne.xbnd[Ge];null!==Qe&&rt.push(it.extendFlat({},Ne,{x:Qe}))};if(Ne.showdividers&&Ge.length){for(Qe=0;Qe<Ge.length;Qe++){var at=Ge[Qe];at.text2!==tt&&_push(at,nt?1:0),tt=at.text2}_push(Ge[Qe-1],nt?0:1)}return rt}function calcLabelLevelBbox(Ne,Ge){var Qe,tt,rt,nt;return Ne._selections[Ge].size()?(Qe=1/0,tt=-1/0,rt=1/0,nt=-1/0,Ne._selections[Ge].each((function(){var Ne=selectTickLabel(this),Ge=Ot.bBox(Ne.node().parentNode);Qe=Math.min(Qe,Ge.top),tt=Math.max(tt,Ge.bottom),rt=Math.min(rt,Ge.left),nt=Math.max(nt,Ge.right)}))):(Qe=0,tt=0,rt=0,nt=0),{top:Qe,bottom:tt,left:rt,right:nt,height:tt-Qe,width:nt-rt}}function getPosX(Ne){return void 0!==Ne.periodX?Ne.periodX:Ne.x}function getTickLabelUV(Ne){var Ge=Ne.ticklabelposition||"",has=function(Ne){return-1!==Ge.indexOf(Ne)},Qe=has("top"),tt=has("left"),rt=has("right"),nt=has("bottom"),at=has("inside"),it=nt||tt||Qe||rt;if(!it&&!at)return[0,0];var ot=Ne.side,dt=it?(Ne.tickwidth||0)/2:0,ht=oa,Dt=Ne.tickfont?Ne.tickfont.size:12;return(nt||Qe)&&(dt+=Dt*Yn,ht+=(Ne.linewidth||0)/2),(tt||rt)&&(dt+=(Ne.linewidth||0)/2,ht+=oa),at&&"top"===ot&&(ht-=Dt*(1-Yn)),(tt||Qe)&&(dt=-dt),"bottom"!==ot&&"right"!==ot||(ht=-ht),[it?dt:0,at?ht:0]}function tickDataFn(Ne){return[Ne.text,Ne.x,Ne.axInfo,Ne.font,Ne.fontSize,Ne.fontColor].join("_")}function drawDividers(Ne,Ge,Qe){var tt=Ge._id+"divider",rt=Qe.vals,nt=Qe.layer.selectAll("path."+tt).data(rt,tickDataFn);nt.exit().remove(),nt.enter().insert("path",":first-child").classed(tt,1).classed("crisp",1).call(Dt.stroke,Ge.dividercolor).style("stroke-width",Ot.crispRound(Ne,Ge.dividerwidth,1)+"px"),nt.attr("transform",Qe.transFn).attr("d",Qe.path)}function approxTitleDepth(Ne){var Ge=Ne.title.font.size,Qe=(Ne.title.text.match(dt.BR_TAG_ALL)||[]).length;return Ne.title.hasOwnProperty("standoff")?Qe?Ge*(Yn+Qe*$n):Ge*Yn:Qe?Ge*(Qe+1)*$n:Ge}function drawTitle(Ne,Ge){var Qe,tt=Ne._fullLayout,rt=Ge._id,nt=rt.charAt(0),at=Ge.title.font.size;if(Ge.title.hasOwnProperty("standoff"))Qe=Ge._depth+Ge.title.standoff+approxTitleDepth(Ge);else{var it=-1!==(Ge.ticklabelposition||"").indexOf("inside");if("multicategory"===Ge.type)Qe=Ge._depth;else{var ot=1.5*at;it&&(ot=.5*at,"outside"===Ge.ticks&&(ot+=Ge.ticklen)),Qe=10+ot+(Ge.linewidth?Ge.linewidth-1:0)}it||(Qe+="x"===nt?"top"===Ge.side?at*(Ge.showticklabels?1:0):at*(Ge.showticklabels?1.5:.5):"right"===Ge.side?at*(Ge.showticklabels?1:.5):at*(Ge.showticklabels?.5:0))}var dt,Dt,Rt,Zt,er=pa.getPxPosition(Ne,Ge);if("x"===nt?(Dt=Ge._offset+Ge._length/2,Rt="top"===Ge.side?er-Qe:er+Qe):(Rt=Ge._offset+Ge._length/2,Dt="right"===Ge.side?er+Qe:er-Qe,dt={rotate:"-90",offset:0}),"multicategory"!==Ge.type){var dr=Ge._selections[Ge._id+"tick"];if(Zt={selection:dr,side:Ge.side},dr&&dr.node()&&dr.node().parentNode){var mr=Ot.getTranslate(dr.node().parentNode);Zt.offsetLeft=mr.x,Zt.offsetTop=mr.y}Ge.title.hasOwnProperty("standoff")&&(Zt.pad=0)}return ht.draw(Ne,rt+"title",{propContainer:Ge,propName:Ge._name+".title.text",placeholder:tt._dfltTitle[nt],avoid:Zt,transform:dt,attributes:{x:Dt,y:Rt,"text-anchor":"middle"}})}function clipEnds(Ne,Ge){var Qe=Ne.l2p(Ge);return Qe>1&&Qe<Ne._length-1}function anyCounterAxLineAtZero(Ne,Ge,Qe,tt){var rt=Qe._mainAxis;if(rt){var nt=Ne._fullLayout,at=Ge._id.charAt(0),it=pa.counterLetter(Ge._id),ot=Ge._offset+(Math.abs(tt[0])<Math.abs(tt[1])==("x"===at)?0:Ge._length),dt=nt._plots[Qe._mainSubplot];if(!(dt.mainplotinfo||dt).overlays.length)return lineNearZero(Qe,ot);for(var ht=pa.list(Ne,it),Dt=0;Dt<ht.length;Dt++){var Ot=ht[Dt];if(Ot._mainAxis===rt&&lineNearZero(Ot,ot))return!0}}function lineNearZero(Ne){if(!Ne.showline||!Ne.linewidth)return!1;var Qe=Math.max((Ne.linewidth+Ge.zerolinewidth)/2,1);function closeEnough(Ne){return"number"==typeof Ne&&Math.abs(Ne-ot)<Qe}if(closeEnough(Ne._mainLinePosition)||closeEnough(Ne._mainMirrorPosition))return!0;var tt=Ne._linepositions||{};for(var rt in tt)if(closeEnough(tt[rt][0])||closeEnough(tt[rt][1]))return!0}}function hasBarsOrFill(Ne,Ge){for(var Qe=Ne._fullData,tt=Ge._mainSubplot,rt=Ge._id.charAt(0),nt=0;nt<Qe.length;nt++){var it=Qe[nt];if(!0===it.visible&&it.xaxis+it.yaxis===tt){if(at.traceIs(it,"bar-like")&&it.orientation==={x:"h",y:"v"}[rt])return!0;if(it.fill&&it.fill.charAt(it.fill.length-1)===rt)return!0}}return!1}function selectTickLabel(Ne){var Ge=tt.select(Ne),Qe=Ge.select(".text-math-group");return Qe.empty()?Ge.select("text"):Qe}function axAutoMarginID(Ne){return Ne._id+".automargin"}function axMirrorAutoMarginID(Ne){return axAutoMarginID(Ne)+".mirror"}function rangeSliderAutoMarginID(Ne){return Ne._id+".rangeslider"}function makeAxisGroups(Ne,Ge){var Qe,tt,rt=[];for(Qe=0;Qe<Ge.length;Qe++){var nt=[],at=Ne._fullData[Ge[Qe]].xaxis,it=Ne._fullData[Ge[Qe]].yaxis;if(at&&it){for(tt=0;tt<rt.length;tt++)-1===rt[tt].x.indexOf(at)&&-1===rt[tt].y.indexOf(it)||nt.push(tt);if(nt.length){var ot,dt=rt[nt[0]];if(nt.length>1)for(tt=1;tt<nt.length;tt++)ot=rt[nt[tt]],mergeAxisGroups(dt.x,ot.x),mergeAxisGroups(dt.y,ot.y);mergeAxisGroups(dt.x,[at]),mergeAxisGroups(dt.y,[it])}else rt.push({x:[at],y:[it]})}}return rt}function mergeAxisGroups(Ne,Ge){for(var Qe=0;Qe<Ge.length;Qe++)-1===Ne.indexOf(Ge[Qe])&&Ne.push(Ge[Qe])}function swapAxisGroup(Ne,Ge,Qe){var tt,rt,nt=[],at=[],ot=Ne.layout;for(tt=0;tt<Ge.length;tt++)nt.push(pa.getFromId(Ne,Ge[tt]));for(tt=0;tt<Qe.length;tt++)at.push(pa.getFromId(Ne,Qe[tt]));var dt=Object.keys(Rt),ht=["anchor","domain","overlaying","position","side","tickangle","editType"],Dt=["linear","log"];for(tt=0;tt<dt.length;tt++){var Ot=dt[tt],Zt=nt[0][Ot],er=at[0][Ot],dr=!0,mr=!1,xr=!1;if("_"!==Ot.charAt(0)&&"function"!=typeof Zt&&-1===ht.indexOf(Ot)){for(rt=1;rt<nt.length&&dr;rt++){var br=nt[rt][Ot];"type"===Ot&&-1!==Dt.indexOf(Zt)&&-1!==Dt.indexOf(br)&&Zt!==br?mr=!0:br!==Zt&&(dr=!1)}for(rt=1;rt<at.length&&dr;rt++){var Ar=at[rt][Ot];"type"===Ot&&-1!==Dt.indexOf(er)&&-1!==Dt.indexOf(Ar)&&er!==Ar?xr=!0:at[rt][Ot]!==er&&(dr=!1)}dr&&(mr&&(ot[nt[0]._name].type="linear"),xr&&(ot[at[0]._name].type="linear"),swapAxisAttrs(ot,Ot,nt,at,Ne._fullLayout._dfltTitle))}}for(tt=0;tt<Ne._fullLayout.annotations.length;tt++){var en=Ne._fullLayout.annotations[tt];-1!==Ge.indexOf(en.xref)&&-1!==Qe.indexOf(en.yref)&&it.swapAttrs(ot.annotations[tt],["?"])}}function swapAxisAttrs(Ne,Ge,Qe,tt,rt){var nt,at=it.nestedProperty,ot=at(Ne[Qe[0]._name],Ge).get(),dt=at(Ne[tt[0]._name],Ge).get();for("title"===Ge&&(ot&&ot.text===rt.x&&(ot.text=rt.y),dt&&dt.text===rt.y&&(dt.text=rt.x)),nt=0;nt<Qe.length;nt++)at(Ne,Qe[nt]._name+"."+Ge).set(dt);for(nt=0;nt<tt.length;nt++)at(Ne,tt[nt]._name+"."+Ge).set(ot)}function isAngular(Ne){return"angularaxis"===Ne._id}function moveOutsideBreak(Ne,Ge){for(var Qe=Ge._rangebreaks.length,tt=0;tt<Qe;tt++){var rt=Ge._rangebreaks[tt];if(Ne>=rt.min&&Ne<rt.max)return rt.max}return Ne}pa.getTickFormat=function(Ne){var Ge,Qe,tt;function convertToMs(Ne){return"string"!=typeof Ne?Ne:Number(Ne.replace("M",""))*xn}function compareLogTicks(Ne,Ge){var Qe=["L","D"];if(typeof Ne==typeof Ge){if("number"==typeof Ne)return Ne-Ge;var tt=Qe.indexOf(Ne.charAt(0)),rt=Qe.indexOf(Ge.charAt(0));return tt===rt?Number(Ne.replace(/(L|D)/g,""))-Number(Ge.replace(/(L|D)/g,"")):tt-rt}return"number"==typeof Ne?1:-1}function isProperStop(Ne,Ge,Qe){var tt=Qe||function(Ne){return Ne},rt=Ge[0],nt=Ge[1];return(!rt&&"number"!=typeof rt||tt(rt)<=tt(Ne))&&(!nt&&"number"!=typeof nt||tt(nt)>=tt(Ne))}function isProperLogStop(Ne,Ge){var Qe=null===Ge[0],tt=null===Ge[1],rt=compareLogTicks(Ne,Ge[0])>=0,nt=compareLogTicks(Ne,Ge[1])<=0;return(Qe||rt)&&(tt||nt)}if(Ne.tickformatstops&&Ne.tickformatstops.length>0)switch(Ne.type){case"date":case"linear":for(Ge=0;Ge<Ne.tickformatstops.length;Ge++)if((tt=Ne.tickformatstops[Ge]).enabled&&isProperStop(Ne.dtick,tt.dtickrange,convertToMs)){Qe=tt;break}break;case"log":for(Ge=0;Ge<Ne.tickformatstops.length;Ge++)if((tt=Ne.tickformatstops[Ge]).enabled&&isProperLogStop(Ne.dtick,tt.dtickrange)){Qe=tt;break}}return Qe?Qe.value:Ne.tickformat},pa.getSubplots=function(Ne,Ge){var Qe=Ne._fullLayout._subplots,tt=Qe.cartesian.concat(Qe.gl2d||[]),rt=Ge?pa.findSubplotsWithAxis(tt,Ge):tt;return rt.sort((function(Ne,Ge){var Qe=Ne.substr(1).split("y"),tt=Ge.substr(1).split("y");return Qe[0]===tt[0]?+Qe[1]-+tt[1]:+Qe[0]-+tt[0]})),rt},pa.findSubplotsWithAxis=function(Ne,Ge){for(var Qe=new RegExp("x"===Ge._id.charAt(0)?"^"+Ge._id+"y":Ge._id+"$"),tt=[],rt=0;rt<Ne.length;rt++){var nt=Ne[rt];Qe.test(nt)&&tt.push(nt)}return tt},pa.makeClipPaths=function(Ne){var Ge=Ne._fullLayout;if(!Ge._hasOnlyLargeSploms){var Qe,rt,nt={_offset:0,_length:Ge.width,_id:""},at={_offset:0,_length:Ge.height,_id:""},it=pa.list(Ne,"x",!0),ot=pa.list(Ne,"y",!0),dt=[];for(Qe=0;Qe<it.length;Qe++)for(dt.push({x:it[Qe],y:at}),rt=0;rt<ot.length;rt++)0===Qe&&dt.push({x:nt,y:ot[rt]}),dt.push({x:it[Qe],y:ot[rt]});var ht=Ge._clips.selectAll(".axesclip").data(dt,(function(Ne){return Ne.x._id+Ne.y._id}));ht.enter().append("clipPath").classed("axesclip",!0).attr("id",(function(Ne){return"clip"+Ge._uid+Ne.x._id+Ne.y._id})).append("rect"),ht.exit().remove(),ht.each((function(Ne){tt.select(this).select("rect").attr({x:Ne.x._offset||0,y:Ne.y._offset||0,width:Ne.x._length||1,height:Ne.y._length||1})}))}},pa.draw=function(Ne,Ge,Qe){var tt=Ne._fullLayout;"redraw"===Ge&&tt._paper.selectAll("g.subplot").each((function(Ne){var Ge=Ne[0],Qe=tt._plots[Ge];if(Qe){var rt=Qe.xaxis,nt=Qe.yaxis;Qe.xaxislayer.selectAll("."+rt._id+"tick").remove(),Qe.yaxislayer.selectAll("."+nt._id+"tick").remove(),Qe.xaxislayer.selectAll("."+rt._id+"tick2").remove(),Qe.yaxislayer.selectAll("."+nt._id+"tick2").remove(),Qe.xaxislayer.selectAll("."+rt._id+"divider").remove(),Qe.yaxislayer.selectAll("."+nt._id+"divider").remove(),Qe.gridlayer&&Qe.gridlayer.selectAll("path").remove(),Qe.zerolinelayer&&Qe.zerolinelayer.selectAll("path").remove(),tt._infolayer.select(".g-"+rt._id+"title").remove(),tt._infolayer.select(".g-"+nt._id+"title").remove()}}));var rt=Ge&&"redraw"!==Ge?Ge:pa.listIds(Ne);return it.syncOrAsync(rt.map((function(Ge){return function(){if(Ge){var tt=pa.getFromId(Ne,Ge),rt=pa.drawOne(Ne,tt,Qe);return tt._r=tt.range.slice(),tt._rl=it.simpleMap(tt._r,tt.r2l),rt}}})))},pa.drawOne=function(Ne,Ge,Qe){var tt,rt,ot;Qe=Qe||{},Ge.setScale();var dt=Ne._fullLayout,ht=Ge._id,Dt=ht.charAt(0),Ot=pa.counterLetter(ht),Rt=dt._plots[Ge._mainSubplot];if(Rt){var Zt=Rt[Dt+"axislayer"],er=Ge._mainLinePosition,dr=Ge._mainMirrorPosition,mr=Ge._vals=pa.calcTicks(Ge),xr=[Ge.mirror,er,dr].join("_");for(tt=0;tt<mr.length;tt++)mr[tt].axInfo=xr;Ge._selections={},Ge._tickAngles&&(Ge._prevTickAngles=Ge._tickAngles),Ge._tickAngles={},Ge._depth=null;var br={};if(Ge.visible){var Ar,en,mn=pa.makeTransTickFn(Ge),xn=pa.makeTransTickLabelFn(Ge),kn="inside"===Ge.ticks,Cn="outside"===Ge.ticks;if("boundaries"===Ge.tickson){var En=getBoundaryVals(Ge,mr);en=pa.clipEnds(Ge,En),Ar=kn?en:En}else en=pa.clipEnds(Ge,mr),Ar=kn&&"period"!==Ge.ticklabelmode?en:mr;var Pn=Ge._gridVals=en,Dn=getDividerVals(Ge,mr);if(!dt._hasOnlyLargeSploms){var In=Ge._subplotsWith,zn={};for(tt=0;tt<In.length;tt++){rt=In[tt];var Bn=(ot=dt._plots[rt])[Ot+"axis"],Vn=Bn._mainAxis._id;if(!zn[Vn]){zn[Vn]=1;var Hn="x"===Dt?"M0,"+Bn._offset+"v"+Bn._length:"M"+Bn._offset+",0h"+Bn._length;pa.drawGrid(Ne,Ge,{vals:Pn,counterAxis:Bn,layer:ot.gridlayer.select("."+ht),path:Hn,transFn:mn}),pa.drawZeroLine(Ne,Ge,{counterAxis:Bn,layer:ot.zerolinelayer,path:Hn,transFn:mn})}}}var qn=pa.getTickSigns(Ge),Yn=[];if(Ge.ticks){var oa,ga,ma,_a=pa.makeTickPath(Ge,er,qn[2]);if(Ge._anchorAxis&&Ge.mirror&&!0!==Ge.mirror?(oa=pa.makeTickPath(Ge,dr,qn[3]),ga=_a+oa):(oa="",ga=_a),Ge.showdividers&&Cn&&"boundaries"===Ge.tickson){var Va={};for(tt=0;tt<Dn.length;tt++)Va[Dn[tt].x]=1;ma=function(Ne){return Va[Ne.x]?oa:ga}}else ma=ga;pa.drawTicks(Ne,Ge,{vals:Ar,layer:Zt,path:ma,transFn:mn}),"allticks"===Ge.mirror&&(Yn=Object.keys(Ge._linepositions||{}))}for(tt=0;tt<Yn.length;tt++){rt=Yn[tt],ot=dt._plots[rt];var Wa=Ge._linepositions[rt]||[],Qa=pa.makeTickPath(Ge,Wa[0],qn[0])+pa.makeTickPath(Ge,Wa[1],qn[1]);pa.drawTicks(Ne,Ge,{vals:Ar,layer:ot[Dt+"axislayer"],path:Qa,transFn:mn})}var ti=[];if(ti.push((function(){return pa.drawLabels(Ne,Ge,{vals:mr,layer:Zt,transFn:xn,labelFns:pa.makeLabelFns(Ge,er)})})),"multicategory"===Ge.type){var ni={x:2,y:10}[Dt];ti.push((function(){var Qe={x:"height",y:"width"}[Dt],tt=getLabelLevelBbox()[Qe]+ni+(Ge._tickAngles[ht+"tick"]?Ge.tickfont.size*$n:0);return pa.drawLabels(Ne,Ge,{vals:getSecondaryLabelVals(Ge,mr),layer:Zt,cls:ht+"tick2",repositionOnUpdate:!0,secondary:!0,transFn:mn,labelFns:pa.makeLabelFns(Ge,er+tt*qn[4])})})),ti.push((function(){return Ge._depth=qn[4]*(getLabelLevelBbox("tick2")[Ge.side]-er),drawDividers(Ne,Ge,{vals:Dn,layer:Zt,path:pa.makeTickPath(Ge,er,qn[4],Ge._depth),transFn:mn})}))}else Ge.title.hasOwnProperty("standoff")&&ti.push((function(){Ge._depth=qn[4]*(getLabelLevelBbox()[Ge.side]-er)}));var di=at.getComponentMethod("rangeslider","isVisible")(Ge);return ti.push((function(){var Qe,tt,rt,it,ot=Ge.side.charAt(0),ht=ra[Ge.side].charAt(0),Rt=pa.getPxPosition(Ne,Ge),Zt=Cn?Ge.ticklen:0;if((Ge.automargin||di)&&("multicategory"===Ge.type?Qe=getLabelLevelBbox("tick2"):(Qe=getLabelLevelBbox(),"x"===Dt&&"b"===ot&&(Ge._depth=Math.max(Qe.width>0?Qe.bottom-Rt:0,Zt)))),Ge.automargin){tt={x:0,y:0,r:0,l:0,t:0,b:0};var er=[0,1];if("x"===Dt){if("b"===ot?tt[ot]=Ge._depth:(tt[ot]=Ge._depth=Math.max(Qe.width>0?Rt-Qe.top:0,Zt),er.reverse()),Qe.width>0){var dr=Qe.right-(Ge._offset+Ge._length);dr>0&&(tt.xr=1,tt.r=dr);var mr=Ge._offset-Qe.left;mr>0&&(tt.xl=0,tt.l=mr)}}else if("l"===ot?tt[ot]=Ge._depth=Math.max(Qe.height>0?Rt-Qe.left:0,Zt):(tt[ot]=Ge._depth=Math.max(Qe.height>0?Qe.right-Rt:0,Zt),er.reverse()),Qe.height>0){var xr=Qe.bottom-(Ge._offset+Ge._length);xr>0&&(tt.yb=0,tt.b=xr);var br=Ge._offset-Qe.top;br>0&&(tt.yt=1,tt.t=br)}tt[Ot]="free"===Ge.anchor?Ge.position:Ge._anchorAxis.domain[er[0]],Ge.title.text!==dt._dfltTitle[Dt]&&(tt[ot]+=approxTitleDepth(Ge)+(Ge.title.standoff||0)),Ge.mirror&&"free"!==Ge.anchor&&((rt={x:0,y:0,r:0,l:0,t:0,b:0})[ht]=Ge.linewidth,Ge.mirror&&!0!==Ge.mirror&&(rt[ht]+=Zt),!0===Ge.mirror||"ticks"===Ge.mirror?rt[Ot]=Ge._anchorAxis.domain[er[1]]:"all"!==Ge.mirror&&"allticks"!==Ge.mirror||(rt[Ot]=[Ge._counterDomainMin,Ge._counterDomainMax][er[1]]))}di&&(it=at.getComponentMethod("rangeslider","autoMarginOpts")(Ne,Ge)),nt.autoMargin(Ne,axAutoMarginID(Ge),tt),nt.autoMargin(Ne,axMirrorAutoMarginID(Ge),rt),nt.autoMargin(Ne,rangeSliderAutoMarginID(Ge),it)})),Qe.skipTitle||di&&"bottom"===Ge.side||ti.push((function(){return drawTitle(Ne,Ge)})),it.syncOrAsync(ti)}}function getLabelLevelBbox(Ne){var Qe=ht+(Ne||"tick");return br[Qe]||(br[Qe]=calcLabelLevelBbox(Ge,Qe)),br[Qe]}},pa.getTickSigns=function(Ne){var Ge=Ne._id.charAt(0),Qe={x:"top",y:"right"}[Ge],tt=Ne.side===Qe?1:-1,rt=[-1,1,tt,-tt];return"inside"!==Ne.ticks==("x"===Ge)&&(rt=rt.map((function(Ne){return-Ne}))),Ne.side&&rt.push({l:-1,t:-1,r:1,b:1}[Ne.side.charAt(0)]),rt},pa.makeTransTickFn=function(Ne){return"x"===Ne._id.charAt(0)?function(Ge){return ot(Ne._offset+Ne.l2p(Ge.x),0)}:function(Ge){return ot(0,Ne._offset+Ne.l2p(Ge.x))}},pa.makeTransTickLabelFn=function(Ne){var Ge=getTickLabelUV(Ne),Qe=Ge[0],tt=Ge[1];return"x"===Ne._id.charAt(0)?function(Ge){return ot(Qe+Ne._offset+Ne.l2p(getPosX(Ge)),tt)}:function(Ge){return ot(tt,Qe+Ne._offset+Ne.l2p(getPosX(Ge)))}},pa.makeTickPath=function(Ne,Ge,Qe,tt){tt=void 0!==tt?tt:Ne.ticklen;var rt=Ne._id.charAt(0),nt=(Ne.linewidth||1)/2;return"x"===rt?"M0,"+(Ge+nt*Qe)+"v"+tt*Qe:"M"+(Ge+nt*Qe)+",0h"+tt*Qe},pa.makeLabelFns=function(Ne,Ge,Qe){var tt=Ne.ticklabelposition||"",has=function(Ne){return-1!==tt.indexOf(Ne)},nt=has("top"),at=has("left"),ot=has("right"),dt=has("bottom")||at||nt||ot,ht=has("inside"),Dt="inside"===tt&&"inside"===Ne.ticks||!ht&&"outside"===Ne.ticks&&"boundaries"!==Ne.tickson,Ot=0,Rt=0,Zt=Dt?Ne.ticklen:0;if(ht?Zt*=-1:dt&&(Zt=0),Dt&&(Ot+=Zt,Qe)){var er=it.deg2rad(Qe);Ot=Zt*Math.cos(er)+1,Rt=Zt*Math.sin(er)}Ne.showticklabels&&(Dt||Ne.showline)&&(Ot+=.2*Ne.tickfont.size);var dr,mr,xr,br,Ar,en={labelStandoff:Ot+=(Ne.linewidth||1)/2*(ht?-1:1),labelShift:Rt},mn=0,xn=Ne.side,kn=Ne._id.charAt(0),Cn=Ne.tickangle;if("x"===kn)br=(Ar=!ht&&"bottom"===xn||ht&&"top"===xn)?1:-1,ht&&(br*=-1),dr=Rt*br,mr=Ge+Ot*br,xr=Ar?1:-.2,90===Math.abs(Cn)&&(ht?xr+=qn:xr=-90===Cn&&"bottom"===xn?Yn:90===Cn&&"top"===xn?qn:.5,mn=qn/2*(Cn/90)),en.xFn=function(Ne){return Ne.dx+dr+mn*Ne.fontSize},en.yFn=function(Ne){return Ne.dy+mr+Ne.fontSize*xr},en.anchorFn=function(Ne,Ge){if(dt){if(at)return"end";if(ot)return"start"}return rt(Ge)&&0!==Ge&&180!==Ge?Ge*br<0!==ht?"end":"start":"middle"},en.heightFn=function(Ge,Qe,tt){return Qe<-60||Qe>60?-.5*tt:"top"===Ne.side!==ht?-tt:0};else if("y"===kn){if(br=(Ar=!ht&&"left"===xn||ht&&"right"===xn)?1:-1,ht&&(br*=-1),dr=Ot,mr=Rt*br,xr=0,ht||90!==Math.abs(Cn)||(xr=-90===Cn&&"left"===xn||90===Cn&&"right"===xn?Yn:.5),ht){var En=rt(Cn)?+Cn:0;if(0!==En){var Pn=it.deg2rad(En);mn=Math.abs(Math.sin(Pn))*Yn*br,xr=0}}en.xFn=function(Ne){return Ne.dx+Ge-(dr+Ne.fontSize*xr)*br+mn*Ne.fontSize},en.yFn=function(Ne){return Ne.dy+mr+Ne.fontSize*qn},en.anchorFn=function(Ne,Ge){return rt(Ge)&&90===Math.abs(Ge)?"middle":Ar?"end":"start"},en.heightFn=function(Ge,Qe,tt){return"right"===Ne.side&&(Qe*=-1),Qe<-30?-tt:Qe<30?-.5*tt:0}}return en},pa.drawTicks=function(Ne,Ge,Qe){Qe=Qe||{};var tt=Ge._id+"tick",rt=Qe.vals;"period"===Ge.ticklabelmode&&(rt=rt.slice()).shift();var nt=Qe.layer.selectAll("path."+tt).data(Ge.ticks?rt:[],tickDataFn);nt.exit().remove(),nt.enter().append("path").classed(tt,1).classed("ticks",1).classed("crisp",!1!==Qe.crisp).call(Dt.stroke,Ge.tickcolor).style("stroke-width",Ot.crispRound(Ne,Ge.tickwidth,1)+"px").attr("d",Qe.path),nt.attr("transform",Qe.transFn)},pa.drawGrid=function(Ne,Ge,Qe){Qe=Qe||{};var tt=Ge._id+"grid",rt=Qe.vals,nt=Qe.counterAxis;if(!1===Ge.showgrid)rt=[];else if(nt&&pa.shouldShowZeroLine(Ne,Ge,nt))for(var at="array"===Ge.tickmode,it=0;it<rt.length;it++){var ot=rt[it].x;if(at?!ot:Math.abs(ot)<Ge.dtick/100){if(rt=rt.slice(0,it).concat(rt.slice(it+1)),!at)break;it--}}var dt=Qe.layer.selectAll("path."+tt).data(rt,tickDataFn);dt.exit().remove(),dt.enter().append("path").classed(tt,1).classed("crisp",!1!==Qe.crisp),Ge._gw=Ot.crispRound(Ne,Ge.gridwidth,1),dt.attr("transform",Qe.transFn).attr("d",Qe.path).call(Dt.stroke,Ge.gridcolor||"#ddd").style("stroke-width",Ge._gw+"px"),"function"==typeof Qe.path&&dt.attr("d",Qe.path)},pa.drawZeroLine=function(Ne,Ge,Qe){Qe=Qe||Qe;var tt=Ge._id+"zl",rt=pa.shouldShowZeroLine(Ne,Ge,Qe.counterAxis),nt=Qe.layer.selectAll("path."+tt).data(rt?[{x:0,id:Ge._id}]:[]);nt.exit().remove(),nt.enter().append("path").classed(tt,1).classed("zl",1).classed("crisp",!1!==Qe.crisp).each((function(){Qe.layer.selectAll("path").sort((function(Ne,Ge){return _a(Ne.id,Ge.id)}))})),nt.attr("transform",Qe.transFn).attr("d",Qe.path).call(Dt.stroke,Ge.zerolinecolor||Dt.defaultLine).style("stroke-width",Ot.crispRound(Ne,Ge.zerolinewidth,Ge._gw||1)+"px")},pa.drawLabels=function(Ne,Ge,Qe){Qe=Qe||{};var nt=Ne._fullLayout,at=Ge._id,ht=at.charAt(0),Dt=Qe.cls||at+"tick",Rt=Qe.vals,Zt=Qe.labelFns,er=Qe.secondary?0:Ge.tickangle,dr=(Ge._prevTickAngles||{})[Dt],mr=Qe.layer.selectAll("g."+Dt).data(Ge.showticklabels?Rt:[],tickDataFn),xr=[];function positionLabels(Ne,nt){var at=-1!==(Ge.ticklabelposition||"").indexOf("inside");Ne.each((function(Ne){var it=tt.select(this),ht=it.select(".text-math-group"),Dt=Zt.anchorFn(Ne,nt),Rt=Qe.transFn.call(it.node(),Ne)+(rt(nt)&&0!=+nt?" rotate("+nt+","+Zt.xFn(Ne)+","+(Zt.yFn(Ne)-Ne.fontSize/2)+")":""),er=dt.lineCount(it),dr=$n*Ne.fontSize,mr=Zt.heightFn(Ne,rt(nt)?+nt:0,(er-1)*dr);if(mr&&(Rt+=ot(0,mr)),ht.empty()){var xr=it.select("text");xr.attr({transform:Rt,"text-anchor":Dt}),at&&(xr.style({opacity:100}),Ge._hideOutOfRangeInsideTickLabels&&Ge._hideOutOfRangeInsideTickLabels())}else{var br=Ot.bBox(ht.node()).width*{end:-.5,start:.5}[Dt];ht.attr("transform",Rt+ot(br,0))}}))}function allLabelsReady(){return xr.length&&Promise.all(xr)}mr.enter().append("g").classed(Dt,1).append("text").attr("text-anchor","middle").each((function(Ge){var Qe=tt.select(this),rt=Ne._promises.length;Qe.call(dt.positionText,Zt.xFn(Ge),Zt.yFn(Ge)).call(Ot.font,Ge.font,Ge.fontSize,Ge.fontColor).text(Ge.text).call(dt.convertToTspans,Ne),Ne._promises[rt]?xr.push(Ne._promises.pop().then((function(){positionLabels(Qe,er)}))):positionLabels(Qe,er)})),mr.exit().remove(),Qe.repositionOnUpdate&&mr.each((function(Ne){tt.select(this).select("text").call(dt.positionText,Zt.xFn(Ne),Zt.yFn(Ne))})),Ge._hideOutOfRangeInsideTickLabels=void 0,-1!==(Ge.ticklabelposition||"").indexOf("inside")&&(Ge._hideOutOfRangeInsideTickLabels=function(){var Ne=it.simpleMap(Ge.range,Ge.r2l),Qe=Ge.l2p(Ne[0]),rt=Ge.l2p(Ne[1]),nt=Math.min(Qe,rt)+Ge._offset,at=Math.max(Qe,rt)+Ge._offset,ot="x"===Ge._id.charAt(0);mr.each((function(Ne){var Qe=tt.select(this);if(Qe.select(".text-math-group").empty()){var rt=Ot.bBox(Qe.node()),it=!1;ot?(rt.right>at||rt.left<nt)&&(it=!0):(rt.bottom>at||rt.top+(Ge.tickangle?0:Ne.fontSize/4)<nt)&&(it=!0),it&&Qe.select("text").style({opacity:0})}}))}),positionLabels(mr,dr+1?dr:er);var br=null;function fixLabelOverlaps(){if(positionLabels(mr,er),Rt.length&&"x"===ht&&!rt(er)&&("log"!==Ge.type||"D"!==String(Ge.dtick).charAt(0))){br=0;var Ne,tt=0,nt=[];if(mr.each((function(Ne){tt=Math.max(tt,Ne.fontSize);var Qe=Ge.l2p(Ne.x),rt=selectTickLabel(this),at=Ot.bBox(rt.node());nt.push({top:0,bottom:10,height:10,left:Qe-at.width/2,right:Qe+at.width/2+2,width:at.width+2})})),"boundaries"!==Ge.tickson&&!Ge.showdividers||Qe.secondary){var at=Rt.length,ot=Math.abs((Rt[at-1].x-Rt[0].x)*Ge._m)/(at-1),dt=Ge.ticklabelposition||"",has=function(Ne){return-1!==dt.indexOf(Ne)},Dt=has("top"),Zt=has("left"),dr=has("right"),xr=has("bottom")||Zt||Dt||dr?(Ge.tickwidth||0)+2*oa:0,Ar=ot<2.5*tt||"multicategory"===Ge.type;for(Ne=0;Ne<nt.length-1;Ne++)if(it.bBoxIntersect(nt[Ne],nt[Ne+1],xr)){br=Ar?90:30;break}}else{var en=2;for(Ge.ticks&&(en+=Ge.tickwidth/2),Ne=0;Ne<nt.length;Ne++){var mn=Rt[Ne].xbnd,xn=nt[Ne];if(null!==mn[0]&&xn.left-Ge.l2p(mn[0])<en||null!==mn[1]&&Ge.l2p(mn[1])-xn.right<en){br=90;break}}}br&&positionLabels(mr,br)}}Ge._selections&&(Ge._selections[Dt]=mr);var Ar=[allLabelsReady];Ge.automargin&&nt._redrawFromAutoMarginCount&&90===dr?(br=90,Ar.push((function(){positionLabels(mr,dr)}))):Ar.push(fixLabelOverlaps),Ge._tickAngles&&Ar.push((function(){Ge._tickAngles[Dt]=null===br?rt(er)?er:0:br}));var en=Ge._anchorAxis;en&&en.autorange&&-1!==(Ge.ticklabelposition||"").indexOf("inside")&&!Va(nt,Ge._id)&&(nt._insideTickLabelsAutorange||(nt._insideTickLabelsAutorange={}),nt._insideTickLabelsAutorange[en._name+".autorange"]=en.autorange,Ar.push((function(){mr.each((function(Ne,Qe){var tt=selectTickLabel(this);Ge._vals[Qe].bb=Ot.bBox(tt.node())}))})));var mn=it.syncOrAsync(Ar);return mn&&mn.then&&Ne._promises.push(mn),mn},pa.getPxPosition=function(Ne,Ge){var Qe,tt=Ne._fullLayout._size,rt=Ge._id.charAt(0),nt=Ge.side;return"free"!==Ge.anchor?Qe=Ge._anchorAxis:"x"===rt?Qe={_offset:tt.t+(1-(Ge.position||0))*tt.h,_length:0}:"y"===rt&&(Qe={_offset:tt.l+(Ge.position||0)*tt.w,_length:0}),"top"===nt||"left"===nt?Qe._offset:"bottom"===nt||"right"===nt?Qe._offset+Qe._length:void 0},pa.shouldShowZeroLine=function(Ne,Ge,Qe){var tt=it.simpleMap(Ge.range,Ge.r2l);return tt[0]*tt[1]<=0&&Ge.zeroline&&("linear"===Ge.type||"-"===Ge.type)&&!(Ge.rangebreaks&&Ge.maskBreaks(0)===Vn)&&(clipEnds(Ge,0)||!anyCounterAxLineAtZero(Ne,Ge,Qe,tt)||hasBarsOrFill(Ne,Ge))},pa.clipEnds=function(Ne,Ge){return Ge.filter((function(Ge){return clipEnds(Ne,Ge.x)}))},pa.allowAutoMargin=function(Ne){for(var Ge=pa.list(Ne,"",!0),Qe=0;Qe<Ge.length;Qe++){var tt=Ge[Qe];tt.automargin&&(nt.allowAutoMargin(Ne,axAutoMarginID(tt)),tt.mirror&&nt.allowAutoMargin(Ne,axMirrorAutoMarginID(tt))),at.getComponentMethod("rangeslider","isVisible")(tt)&&nt.allowAutoMargin(Ne,rangeSliderAutoMarginID(tt))}},pa.swap=function(Ne,Ge){for(var Qe=makeAxisGroups(Ne,Ge),tt=0;tt<Qe.length;tt++)swapAxisGroup(Ne,Qe[tt].x,Qe[tt].y)}},{"../../components/color":643,"../../components/drawing":665,"../../components/titles":738,"../../constants/alignment":745,"../../constants/numerical":753,"../../lib":778,"../../lib/svg_text_utils":803,"../../plots/plots":891,"../../registry":911,"./autorange":827,"./axis_autotype":829,"./axis_ids":831,"./clean_ticks":833,"./layout_attributes":842,"./set_convert":848,d3:169,"fast-isnumeric":241}],829:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../lib"),nt=Ne("../../constants/numerical").BADNUM,at=rt.isArrayOrTypedArray,it=rt.isDateTime,ot=rt.cleanNumber,dt=Math.round;function hasTypeNumber(Ne,Ge){return Ge?tt(Ne):"number"==typeof Ne}function linearOK(Ne,Ge){for(var Qe=Ne.length,tt=0;tt<Qe;tt++)if(hasTypeNumber(Ne[tt],Ge))return!0;return!1}function moreDates(Ne,Ge){for(var Qe=Ne.length,rt=getIncrement(Qe),nt=0,at=0,ot={},ht=0;ht<Qe;ht+=rt){var Dt=Ne[dt(ht)],Ot=String(Dt);ot[Ot]||(ot[Ot]=1,it(Dt,Ge)&&nt++,tt(Dt)&&at++)}return nt>2*at}function getIncrement(Ne){return Math.max(1,(Ne-1)/1e3)}function category(Ne,Ge){for(var Qe=Ne.length,tt=getIncrement(Qe),rt=0,at=0,it={},ht=0;ht<Qe;ht+=tt){var Dt=Ne[dt(ht)],Ot=String(Dt);if(!it[Ot]){it[Ot]=1;var Rt=typeof Dt;"boolean"===Rt?at++:(Ge?ot(Dt)!==nt:"number"===Rt)?rt++:"string"===Rt&&at++}}return at>2*rt}function multiCategory(Ne){return at(Ne[0])&&at(Ne[1])}Ge.exports=function(Ne,Ge,Qe){var tt=Ne,rt=Qe.noMultiCategory;if(at(tt)&&!tt.length)return"-";if(!rt&&multiCategory(tt))return"multicategory";if(rt&&Array.isArray(tt[0])){for(var nt=[],it=0;it<tt.length;it++)if(at(tt[it]))for(var ot=0;ot<tt[it].length;ot++)nt.push(tt[it][ot]);tt=nt}if(moreDates(tt,Ge))return"date";var dt="strict"!==Qe.autotypenumbers;return category(tt,dt)?"category":linearOK(tt,dt)?"linear":"-"}},{"../../constants/numerical":753,"../../lib":778,"fast-isnumeric":241}],830:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../registry"),nt=Ne("../../lib"),at=Ne("../array_container_defaults"),it=Ne("./layout_attributes"),ot=Ne("./tick_value_defaults"),dt=Ne("./tick_mark_defaults"),ht=Ne("./tick_label_defaults"),Dt=Ne("./category_order_defaults"),Ot=Ne("./line_grid_defaults"),Rt=Ne("./set_convert"),Zt=Ne("./constants").WEEKDAY_PATTERN,er=Ne("./constants").HOUR_PATTERN;function rangebreaksDefaults(Ne,Ge,Qe){function coerce(Qe,tt){return nt.coerce(Ne,Ge,it.rangebreaks,Qe,tt)}if(coerce("enabled")){var rt=coerce("bounds");if(rt&&rt.length>=2){var at,ot,dt="";if(2===rt.length)for(at=0;at<2;at++)if(ot=indexOfDay(rt[at])){dt=Zt;break}var ht=coerce("pattern",dt);if(ht===Zt)for(at=0;at<2;at++)(ot=indexOfDay(rt[at]))&&(Ge.bounds[at]=rt[at]=ot-1);if(ht)for(at=0;at<2;at++)switch(ot=rt[at],ht){case Zt:if(!tt(ot))return void(Ge.enabled=!1);if((ot=+ot)!==Math.floor(ot)||ot<0||ot>=7)return void(Ge.enabled=!1);Ge.bounds[at]=rt[at]=ot;break;case er:if(!tt(ot))return void(Ge.enabled=!1);if((ot=+ot)<0||ot>24)return void(Ge.enabled=!1);Ge.bounds[at]=rt[at]=ot}if(!1===Qe.autorange){var Dt=Qe.range;if(Dt[0]<Dt[1]){if(rt[0]<Dt[0]&&rt[1]>Dt[1])return void(Ge.enabled=!1)}else if(rt[0]>Dt[0]&&rt[1]<Dt[1])return void(Ge.enabled=!1)}}else{var Ot=coerce("values");if(!Ot||!Ot.length)return void(Ge.enabled=!1);coerce("dvalue")}}}Ge.exports=function(Ne,Ge,Qe,tt,er){var dr,mr=tt.letter,xr=tt.font||{},br=tt.splomStash||{},Ar=Qe("visible",!tt.visibleDflt),en=Ge._template||{},mn=Ge.type||en.type||"-";"date"===mn&&(rt.getComponentMethod("calendars","handleDefaults")(Ne,Ge,"calendar",tt.calendar),tt.noTicklabelmode||(dr=Qe("ticklabelmode"))),tt.noTicklabelposition&&"multicategory"!==mn||nt.coerce(Ne,Ge,{ticklabelposition:{valType:"enumerated",dflt:"outside",values:"period"===dr?["outside","inside"]:"x"===mr?["outside","inside","outside left","inside left","outside right","inside right"]:["outside","inside","outside top","inside top","outside bottom","inside bottom"]}},"ticklabelposition"),Rt(Ge,er);var xn=!Ge.isValidRange(Ne.range);xn&&tt.reverseDflt&&(xn="reversed"),!Qe("autorange",xn)||"linear"!==mn&&"-"!==mn||Qe("rangemode"),Qe("range"),Ge.cleanRange(),Dt(Ne,Ge,Qe,tt),"category"===mn||tt.noHover||Qe("hoverformat");var kn=Qe("color"),Cn=kn!==it.color.dflt?kn:xr.color,En=br.label||er._dfltTitle[mr];if(ht(Ne,Ge,Qe,mn,tt,{pass:1}),!Ar)return Ge;Qe("title.text",En),nt.coerceFont(Qe,"title.font",{family:xr.family,size:Math.round(1.2*xr.size),color:Cn}),ot(Ne,Ge,Qe,mn),ht(Ne,Ge,Qe,mn,tt,{pass:2}),dt(Ne,Ge,Qe,tt),Ot(Ne,Ge,Qe,{dfltColor:kn,bgColor:tt.bgColor,showGrid:tt.showGrid,attributes:it}),(Ge.showline||Ge.ticks)&&Qe("mirror"),tt.automargin&&Qe("automargin");var Pn,Dn="multicategory"===mn;if(tt.noTickson||"category"!==mn&&!Dn||!Ge.ticks&&!Ge.showgrid||(Dn&&(Pn="boundaries"),"boundaries"===Qe("tickson",Pn)&&delete Ge.ticklabelposition),Dn&&Qe("showdividers")&&(Qe("dividercolor"),Qe("dividerwidth")),"date"===mn)if(at(Ne,Ge,{name:"rangebreaks",inclusionAttr:"enabled",handleItemDefaults:rangebreaksDefaults}),Ge.rangebreaks.length){for(var In=0;In<Ge.rangebreaks.length;In++)if(Ge.rangebreaks[In].pattern===Zt){Ge._hasDayOfWeekBreaks=!0;break}if(Rt(Ge,er),er._has("scattergl")||er._has("splom"))for(var zn=0;zn<tt.data.length;zn++){var Bn=tt.data[zn];"scattergl"!==Bn.type&&"splom"!==Bn.type||(Bn.visible=!1,nt.warn(Bn.type+" traces do not work on axes with rangebreaks. Setting trace "+Bn.index+" to `visible: false`."))}}else delete Ge.rangebreaks;return Ge};var dr={sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7};function indexOfDay(Ne){if("string"==typeof Ne)return dr[Ne.substr(0,3).toLowerCase()]}},{"../../lib":778,"../../registry":911,"../array_container_defaults":823,"./category_order_defaults":832,"./constants":834,"./layout_attributes":842,"./line_grid_defaults":844,"./set_convert":848,"./tick_label_defaults":849,"./tick_mark_defaults":850,"./tick_value_defaults":851,"fast-isnumeric":241}],831:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../registry"),rt=Ne("./constants");function isFound(Ne,Ge){if(Ge&&Ge.length)for(var Qe=0;Qe<Ge.length;Qe++)if(Ge[Qe][Ne])return!0;return!1}Qe.id2name=function(Ne){if("string"==typeof Ne&&Ne.match(rt.AX_ID_PATTERN)){var Ge=Ne.split(" ")[0].substr(1);return"1"===Ge&&(Ge=""),Ne.charAt(0)+"axis"+Ge}},Qe.name2id=function(Ne){if(Ne.match(rt.AX_NAME_PATTERN)){var Ge=Ne.substr(5);return"1"===Ge&&(Ge=""),Ne.charAt(0)+Ge}},Qe.cleanId=function(Ne,Ge,Qe){var tt=/( domain)$/.test(Ne);if("string"==typeof Ne&&Ne.match(rt.AX_ID_PATTERN)&&(!Ge||Ne.charAt(0)===Ge)&&(!tt||Qe)){var nt=Ne.split(" ")[0].substr(1).replace(/^0+/,"");return"1"===nt&&(nt=""),Ne.charAt(0)+nt+(tt&&Qe?" domain":"")}},Qe.list=function(Ne,Ge,tt){var rt=Ne._fullLayout;if(!rt)return[];var nt,at=Qe.listIds(Ne,Ge),it=new Array(at.length);for(nt=0;nt<at.length;nt++){var ot=at[nt];it[nt]=rt[ot.charAt(0)+"axis"+ot.substr(1)]}if(!tt){var dt=rt._subplots.gl3d||[];for(nt=0;nt<dt.length;nt++){var ht=rt[dt[nt]];Ge?it.push(ht[Ge+"axis"]):it.push(ht.xaxis,ht.yaxis,ht.zaxis)}}return it},Qe.listIds=function(Ne,Ge){var Qe=Ne._fullLayout;if(!Qe)return[];var tt=Qe._subplots;return Ge?tt[Ge+"axis"]:tt.xaxis.concat(tt.yaxis)},Qe.getFromId=function(Ne,Ge,tt){var rt=Ne._fullLayout;return Ge=void 0===Ge||"string"!=typeof Ge?Ge:Ge.replace(" domain",""),"x"===tt?Ge=Ge.replace(/y[0-9]*/,""):"y"===tt&&(Ge=Ge.replace(/x[0-9]*/,"")),rt[Qe.id2name(Ge)]},Qe.getFromTrace=function(Ne,Ge,rt){var nt=Ne._fullLayout,at=null;if(tt.traceIs(Ge,"gl3d")){var it=Ge.scene;"scene"===it.substr(0,5)&&(at=nt[it][rt+"axis"])}else at=Qe.getFromId(Ne,Ge[rt+"axis"]||rt);return at},Qe.idSort=function(Ne,Ge){var Qe=Ne.charAt(0),tt=Ge.charAt(0);return Qe!==tt?Qe>tt?1:-1:+(Ne.substr(1)||1)-+(Ge.substr(1)||1)},Qe.ref2id=function(Ne){return!!/^[xyz]/.test(Ne)&&Ne.split(" ")[0]},Qe.isLinked=function(Ne,Ge){return isFound(Ge,Ne._axisMatchGroups)||isFound(Ge,Ne._axisConstraintGroups)}},{"../../registry":911,"./constants":834}],832:[function(Ne,Ge,Qe){"use strict";function findCategories(Ne,Ge){var Qe,tt,rt,nt=Ge.dataAttr||Ne._id.charAt(0),at={};if(Ge.axData)Qe=Ge.axData;else for(Qe=[],tt=0;tt<Ge.data.length;tt++){var it=Ge.data[tt];it[nt+"axis"]===Ne._id&&Qe.push(it)}for(tt=0;tt<Qe.length;tt++){var ot=Qe[tt][nt];for(rt=0;rt<ot.length;rt++){var dt=ot[rt];null!=dt&&(at[dt]=1)}}return Object.keys(at)}Ge.exports=function(Ne,Ge,Qe,tt){if("category"===Ge.type){var rt,nt=Ne.categoryarray,at=Array.isArray(nt)&&nt.length>0;at&&(rt="array");var it,ot=Qe("categoryorder",rt);"array"===ot&&(it=Qe("categoryarray")),at||"array"!==ot||(ot=Ge.categoryorder="trace"),"trace"===ot?Ge._initialCategories=[]:"array"===ot?Ge._initialCategories=it.slice():(it=findCategories(Ge,tt).sort(),"category ascending"===ot?Ge._initialCategories=it:"category descending"===ot&&(Ge._initialCategories=it.reverse()))}}},{}],833:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../lib"),nt=Ne("../../constants/numerical"),at=nt.ONEDAY,it=nt.ONEWEEK;Qe.dtick=function(Ne,Ge){var Qe="log"===Ge,rt="date"===Ge,nt="category"===Ge,it=rt?at:1;if(!Ne)return it;if(tt(Ne))return(Ne=Number(Ne))<=0?it:nt?Math.max(1,Math.round(Ne)):rt?Math.max(.1,Ne):Ne;if("string"!=typeof Ne||!rt&&!Qe)return it;var ot=Ne.charAt(0),dt=Ne.substr(1);return(dt=tt(dt)?Number(dt):0)<=0||!(rt&&"M"===ot&&dt===Math.round(dt)||Qe&&"L"===ot||Qe&&"D"===ot&&(1===dt||2===dt))?it:Ne},Qe.tick0=function(Ne,Ge,Qe,nt){return"date"===Ge?rt.cleanDate(Ne,rt.dateTick0(Qe,nt%it==0?1:0)):"D1"!==nt&&"D2"!==nt?tt(Ne)?Number(Ne):0:void 0}},{"../../constants/numerical":753,"../../lib":778,"fast-isnumeric":241}],834:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib/regex").counter;Ge.exports={idRegex:{x:tt("x","( domain)?"),y:tt("y","( domain)?")},attrRegex:tt("[xy]axis"),xAxisMatch:tt("xaxis"),yAxisMatch:tt("yaxis"),AX_ID_PATTERN:/^[xyz][0-9]*( domain)?$/,AX_NAME_PATTERN:/^[xyz]axis[0-9]*$/,SUBPLOT_PATTERN:/^x([0-9]*)y([0-9]*)$/,HOUR_PATTERN:"hour",WEEKDAY_PATTERN:"day of week",MINDRAG:8,MINSELECT:12,MINZOOM:20,DRAGGERSIZE:20,BENDPX:1.5,REDRAWDELAY:50,SELECTDELAY:100,SELECTID:"-select",DFLTRANGEX:[-1,6],DFLTRANGEY:[-1,4],traceLayerClasses:["imagelayer","heatmaplayer","contourcarpetlayer","contourlayer","funnellayer","waterfalllayer","barlayer","carpetlayer","violinlayer","boxlayer","ohlclayer","scattercarpetlayer","scatterlayer"],clipOnAxisFalseQuery:[".scatterlayer",".barlayer",".funnellayer",".waterfalllayer"],layerValue2layerClass:{"above traces":"above","below traces":"below"}}},{"../../lib/regex":795}],835:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./autorange"),nt=Ne("./axis_ids").id2name,at=Ne("./layout_attributes"),it=Ne("./scale_zoom"),ot=Ne("./set_convert"),dt=Ne("../../constants/numerical").ALMOST_EQUAL,ht=Ne("../../constants/alignment").FROM_BL;function handleOneAxDefaults(Ne,Ge,Qe){var rt=Qe.axIds,it=Qe.layoutOut,ot=Qe.hasImage,dt=it._axisConstraintGroups,ht=it._axisMatchGroups,Dt=Ge._id,Ot=Dt.charAt(0),Rt=((it._splomAxes||{})[Ot]||{})[Dt]||{},Zt=Ge._id,er="x"===Zt.charAt(0);function coerce(Qe,rt){return tt.coerce(Ne,Ge,at,Qe,rt)}Ge._matchGroup=null,Ge._constraintGroup=null,coerce("constrain",ot?"domain":"range"),tt.coerce(Ne,Ge,{constraintoward:{valType:"enumerated",values:er?["left","center","right"]:["bottom","middle","top"],dflt:er?"center":"middle"}},"constraintoward");var dr,mr,xr=Ge.type,br=[];for(dr=0;dr<rt.length;dr++)(mr=rt[dr])!==Zt&&it[nt(mr)].type===xr&&br.push(mr);var Ar=getConstraintGroup(dt,Zt);if(Ar){var en=[];for(dr=0;dr<br.length;dr++)Ar[mr=br[dr]]||en.push(mr);br=en}var mn,xn,kn=br.length;kn&&(Ne.matches||Rt.matches)&&(mn=tt.coerce(Ne,Ge,{matches:{valType:"enumerated",values:br,dflt:-1!==br.indexOf(Rt.matches)?Rt.matches:void 0}},"matches"));var Cn=ot&&!er?Ge.anchor:void 0;if(kn&&!mn&&(Ne.scaleanchor||Cn)&&(xn=tt.coerce(Ne,Ge,{scaleanchor:{valType:"enumerated",values:br}},"scaleanchor",Cn)),mn){Ge._matchGroup=updateConstraintGroups(ht,Zt,mn,1);var En=it[nt(mn)],Pn=extent(it,Ge)/extent(it,En);er!==("x"===mn.charAt(0))&&(Pn=(er?"x":"y")+Pn),updateConstraintGroups(dt,Zt,mn,Pn)}else Ne.matches&&-1!==rt.indexOf(Ne.matches)&&tt.warn("ignored "+Ge._name+'.matches: "'+Ne.matches+'" to avoid an infinite loop');if(xn){var Dn=coerce("scaleratio");Dn||(Dn=Ge.scaleratio=1),updateConstraintGroups(dt,Zt,xn,Dn)}else Ne.scaleanchor&&-1!==rt.indexOf(Ne.scaleanchor)&&tt.warn("ignored "+Ge._name+'.scaleanchor: "'+Ne.scaleanchor+'" to avoid either an infinite loop and possibly inconsistent scaleratios, or because this axis declares a *matches* constraint.')}function extent(Ne,Ge){var Qe=Ge.domain;return Qe||(Qe=Ne[nt(Ge.overlaying)].domain),Qe[1]-Qe[0]}function getConstraintGroup(Ne,Ge){for(var Qe=0;Qe<Ne.length;Qe++)if(Ne[Qe][Ge])return Ne[Qe];return null}function updateConstraintGroups(Ne,Ge,Qe,tt){var rt,nt,at,it,ot,dt=getConstraintGroup(Ne,Ge);null===dt?((dt={})[Ge]=1,ot=Ne.length,Ne.push(dt)):ot=Ne.indexOf(dt);var ht=Object.keys(dt);for(rt=0;rt<Ne.length;rt++)if(at=Ne[rt],rt!==ot&&at[Qe]){var Dt=at[Qe];for(nt=0;nt<ht.length;nt++)at[it=ht[nt]]=multiplyScales(Dt,multiplyScales(tt,dt[it]));return void Ne.splice(ot,1)}if(1!==tt)for(nt=0;nt<ht.length;nt++){var Ot=ht[nt];dt[Ot]=multiplyScales(tt,dt[Ot])}dt[Qe]=1}function multiplyScales(Ne,Ge){var Qe,tt,rt="",nt="";"string"==typeof Ne&&(Qe=(rt=Ne.match(/^[xy]*/)[0]).length,Ne=+Ne.substr(Qe)),"string"==typeof Ge&&(tt=(nt=Ge.match(/^[xy]*/)[0]).length,Ge=+Ge.substr(tt));var at=Ne*Ge;return Qe||tt?Qe&&tt&&rt.charAt(0)!==nt.charAt(0)?Qe===tt?at:(Qe>tt?rt.substr(tt):nt.substr(Qe))+at:rt+nt+Ne*Ge:at}function finalRatios(Ne,Ge){for(var Qe=Ge._size,tt=Qe.h/Qe.w,rt={},nt=Object.keys(Ne),at=0;at<nt.length;at++){var it=nt[at],ot=Ne[it];if("string"==typeof ot){var dt=ot.match(/^[xy]*/)[0],ht=dt.length;ot=+ot.substr(ht);for(var Dt="y"===dt.charAt(0)?tt:1/tt,Ot=0;Ot<ht;Ot++)ot*=Dt}rt[it]=ot}return rt}function updateDomain(Ne,Ge){var Qe=Ne._inputDomain,tt=ht[Ne.constraintoward],rt=Qe[0]+(Qe[1]-Qe[0])*tt;Ne.domain=Ne._input.domain=[rt+(Qe[0]-rt)/Ge,rt+(Qe[1]-rt)/Ge],Ne.setScale()}Qe.handleDefaults=function(Ne,Ge,Qe){var rt,at,it,dt,ht,Dt,Ot,Rt,Zt=Qe.axIds,er=Qe.axHasImage,dr=Ge._axisConstraintGroups=[],mr=Ge._axisMatchGroups=[];for(rt=0;rt<Zt.length;rt++)handleOneAxDefaults(ht=Ne[dt=nt(Zt[rt])],Dt=Ge[dt],{axIds:Zt,layoutOut:Ge,hasImage:er[dt]});function stash(Ne,Qe){for(rt=0;rt<Ne.length;rt++)for(it in at=Ne[rt])Ge[nt(it)][Qe]=at}for(stash(mr,"_matchGroup"),rt=0;rt<dr.length;rt++)for(it in at=dr[rt])if((Dt=Ge[nt(it)]).fixedrange){for(var xr in at){var br=nt(xr);!1===(Ne[br]||{}).fixedrange&&tt.warn("fixedrange was specified as false for axis "+br+" but was overridden because another axis in its constraint group has fixedrange true"),Ge[br].fixedrange=!0}break}for(rt=0;rt<dr.length;){for(it in at=dr[rt]){(Dt=Ge[nt(it)])._matchGroup&&Object.keys(Dt._matchGroup).length===Object.keys(at).length&&(dr.splice(rt,1),rt--);break}rt++}stash(dr,"_constraintGroup");var Ar=["constrain","range","autorange","rangemode","rangebreaks","categoryorder","categoryarray"],en=!1,mn=!1;function setAttrVal(){Rt=Dt[Ot],"rangebreaks"===Ot&&(mn=Dt._hasDayOfWeekBreaks)}for(rt=0;rt<mr.length;rt++){at=mr[rt];for(var xn=0;xn<Ar.length;xn++){var kn;for(it in Ot=Ar[xn],Rt=null,at)if(ht=Ne[dt=nt(it)],Dt=Ge[dt],Ot in Dt){if(!Dt.matches&&(kn=Dt,Ot in ht)){setAttrVal();break}null===Rt&&Ot in ht&&setAttrVal()}if("range"===Ot&&Rt&&(en=!0),"autorange"===Ot&&null===Rt&&en&&(Rt=!1),null===Rt&&Ot in kn&&(Rt=kn[Ot]),null!==Rt)for(it in at)(Dt=Ge[nt(it)])[Ot]="range"===Ot?Rt.slice():Rt,"rangebreaks"===Ot&&(Dt._hasDayOfWeekBreaks=mn,ot(Dt,Ge))}}},Qe.enforce=function(Ne){var Ge,Qe,tt,at,ot,ht,Dt,Ot,Rt=Ne._fullLayout,Zt=Rt._axisConstraintGroups||[];for(Ge=0;Ge<Zt.length;Ge++){tt=finalRatios(Zt[Ge],Rt);var er=Object.keys(tt),dr=1/0,mr=0,xr=1/0,br={},Ar={},en=!1;for(Qe=0;Qe<er.length;Qe++)Ar[at=er[Qe]]=ot=Rt[nt(at)],ot._inputDomain?ot.domain=ot._inputDomain.slice():ot._inputDomain=ot.domain.slice(),ot._inputRange||(ot._inputRange=ot.range.slice()),ot.setScale(),br[at]=ht=Math.abs(ot._m)/tt[at],dr=Math.min(dr,ht),"domain"!==ot.constrain&&ot._constraintShrinkable||(xr=Math.min(xr,ht)),delete ot._constraintShrinkable,mr=Math.max(mr,ht),"domain"===ot.constrain&&(en=!0);if(!(dr>dt*mr)||en)for(Qe=0;Qe<er.length;Qe++)if(ht=br[at=er[Qe]],Dt=(ot=Ar[at]).constrain,ht!==xr||"domain"===Dt)if(Ot=ht/xr,"range"===Dt)it(ot,Ot);else{var mn=ot._inputDomain,xn=(ot.domain[1]-ot.domain[0])/(mn[1]-mn[0]),kn=(ot.r2l(ot.range[1])-ot.r2l(ot.range[0]))/(ot.r2l(ot._inputRange[1])-ot.r2l(ot._inputRange[0]));if((Ot/=xn)*kn<1){ot.domain=ot._input.domain=mn.slice(),it(ot,Ot);continue}if(kn<1&&(ot.range=ot._input.range=ot._inputRange.slice(),Ot*=kn),ot.autorange){var Cn=ot.r2l(ot.range[0]),En=ot.r2l(ot.range[1]),Pn=(Cn+En)/2,Dn=Pn,In=Pn,zn=Math.abs(En-Pn),Bn=Pn-zn*Ot*1.0001,Vn=Pn+zn*Ot*1.0001,Hn=rt.makePadFn(Rt,ot,0),qn=rt.makePadFn(Rt,ot,1);updateDomain(ot,Ot);var Yn,$n,ra=Math.abs(ot._m),oa=rt.concatExtremes(Ne,ot),pa=oa.min,ga=oa.max;for($n=0;$n<pa.length;$n++)(Yn=pa[$n].val-Hn(pa[$n])/ra)>Bn&&Yn<Dn&&(Dn=Yn);for($n=0;$n<ga.length;$n++)(Yn=ga[$n].val+qn(ga[$n])/ra)<Vn&&Yn>In&&(In=Yn);Ot/=(In-Dn)/(2*zn),Dn=ot.l2r(Dn),In=ot.l2r(In),ot.range=ot._input.range=Cn<En?[Dn,In]:[In,Dn]}updateDomain(ot,Ot)}}},Qe.getAxisGroup=function(Ne,Ge){for(var Qe=Ne._axisMatchGroups,tt=0;tt<Qe.length;tt++)if(Qe[tt][Ge])return"g"+tt;return Ge},Qe.clean=function(Ne,Ge){if(Ge._inputDomain){for(var Qe=!1,tt=Ge._id,rt=Ne._fullLayout._axisConstraintGroups,nt=0;nt<rt.length;nt++)if(rt[nt][tt]){Qe=!0;break}Qe&&"domain"===Ge.constrain||(Ge._input.domain=Ge.domain=Ge._inputDomain,delete Ge._inputDomain)}}},{"../../constants/alignment":745,"../../constants/numerical":753,"../../lib":778,"./autorange":827,"./axis_ids":831,"./layout_attributes":842,"./scale_zoom":846,"./set_convert":848}],836:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("tinycolor2"),nt=Ne("has-passive-events"),at=Ne("../../registry"),it=Ne("../../lib"),ot=it.strTranslate,dt=Ne("../../lib/svg_text_utils"),ht=Ne("../../components/color"),Dt=Ne("../../components/drawing"),Ot=Ne("../../components/fx"),Rt=Ne("./axes"),Zt=Ne("../../lib/setcursor"),er=Ne("../../components/dragelement"),dr=Ne("../../components/dragelement/helpers"),mr=dr.selectingOrDrawing,xr=dr.freeMode,br=Ne("../../constants/alignment").FROM_TL,Ar=Ne("../../lib/clear_gl_canvases"),en=Ne("../../plot_api/subroutines").redrawReglTraces,mn=Ne("../plots"),xn=Ne("./axis_ids").getFromId,kn=Ne("./select").prepSelect,Cn=Ne("./select").clearSelect,En=Ne("./select").selectOnClick,Pn=Ne("./scale_zoom"),Dn=Ne("./constants"),In=Dn.MINDRAG,zn=Dn.MINZOOM,Bn=!0;function makeDragBox(Ne,Ge,Qe,nt,ot,ht,Zt,dr){var Bn,Vn,Hn,qn,Yn,$n,ra,oa,pa,ga,ma,_a,Va,Wa,Qa,ti,ni,di,ji,Hi,Yi,uo,go,ns=Ne._fullLayout._zoomlayer,as=Zt+dr==="nsew",is=1===(Zt+dr).length;function recomputeAxisLists(){if(Bn=Ge.xaxis,Vn=Ge.yaxis,pa=Bn._length,ga=Vn._length,ra=Bn._offset,oa=Vn._offset,(Hn={})[Bn._id]=Bn,(qn={})[Vn._id]=Vn,Zt&&dr)for(var Qe=Ge.overlays,tt=0;tt<Qe.length;tt++){var rt=Qe[tt].xaxis;Hn[rt._id]=rt;var nt=Qe[tt].yaxis;qn[nt._id]=nt}Yn=hashValues(Hn),$n=hashValues(qn),Va=isDirectionActive(Yn,dr),Wa=isDirectionActive($n,Zt),Qa=!Wa&&!Va,_a=calcLinks(Ne,Ne._fullLayout._axisMatchGroups,Hn,qn);var at=(ma=calcLinks(Ne,Ne._fullLayout._axisConstraintGroups,Hn,qn,_a)).isSubplotConstrained||_a.isSubplotConstrained;ti=dr||at,ni=Zt||at;var it=Ne._fullLayout;di=it._has("scattergl"),ji=it._has("splom"),Hi=it._has("svg")}recomputeAxisLists();var os=getDragCursor(Wa+Va,Ne._fullLayout.dragmode,as),ss=makeRectDragger(Ge,Zt+dr+"drag",os,Qe,nt,ot,ht);if(Qa&&!as)return ss.onmousedown=null,ss.style.pointerEvents="none",ss;var cs,ds,ms,vs,_s,ws,Ts,ks,Cs,Es,Ls={element:ss,gd:Ne,plotinfo:Ge};function clearAndResetSelect(){Ls.plotinfo.selection=!1,Cn(Ne)}function clickFn(Ne,Qe){var rt=Ls.gd;if(rt._fullLayout._activeShapeIndex>=0)rt._fullLayout._deactivateShape(rt);else{var nt=rt._fullLayout.clickmode;if(removeZoombox(rt),2!==Ne||is||doubleClick(),as)nt.indexOf("select")>-1&&En(Qe,rt,Yn,$n,Ge.id,Ls),nt.indexOf("event")>-1&&Ot.click(rt,Qe,Ge.id);else if(1===Ne&&is){var it=Zt?Vn:Bn,ot="s"===Zt||"w"===dr?0:1,ht=it._name+".range["+ot+"]",Dt=getEndText(it,ot),Rt="left",er="middle";if(it.fixedrange)return;Zt?(er="n"===Zt?"top":"bottom","right"===it.side&&(Rt="right")):"e"===dr&&(Rt="right"),rt._context.showAxisRangeEntryBoxes&&tt.select(ss).call(dt.makeEditable,{gd:rt,immediate:!0,background:rt._fullLayout.paper_bgcolor,text:String(Dt),fill:it.tickfont?it.tickfont.color:"#444",horizontalAlign:Rt,verticalAlign:er}).on("edit",(function(Ne){var Ge=it.d2r(Ne);void 0!==Ge&&at.call("_guiRelayout",rt,ht,Ge)}))}}}function zoomPrep(Ge,Qe,tt){var nt=ss.getBoundingClientRect();cs=Qe-nt.left,ds=tt-nt.top,Ne._fullLayout._calcInverseTransform(Ne);var at=it.apply3DTransform(Ne._fullLayout._invTransform)(cs,ds);cs=at[0],ds=at[1],ms={l:cs,r:cs,w:0,t:ds,b:ds,h:0},vs=Ne._hmpixcount?Ne._hmlumcount/Ne._hmpixcount:rt(Ne._fullLayout.plot_bgcolor).getLuminance(),ws=!1,Ts="xy",Es=!1,ks=makeZoombox(ns,vs,ra,oa,_s="M0,0H"+pa+"V"+ga+"H0V0"),Cs=makeCorners(ns,ra,oa)}function zoomMove(Ge,Qe){if(Ne._transitioningWithDuration)return!1;var tt=Math.max(0,Math.min(pa,uo*Ge+cs)),rt=Math.max(0,Math.min(ga,go*Qe+ds)),nt=Math.abs(tt-cs),at=Math.abs(rt-ds);function noZoom(){Ts="",ms.r=ms.l,ms.t=ms.b,Cs.attr("d","M0,0Z")}if(ms.l=Math.min(cs,tt),ms.r=Math.max(cs,tt),ms.t=Math.min(ds,rt),ms.b=Math.max(ds,rt),ma.isSubplotConstrained)nt>zn||at>zn?(Ts="xy",nt/pa>at/ga?(at=nt*ga/pa,ds>rt?ms.t=ds-at:ms.b=ds+at):(nt=at*pa/ga,cs>tt?ms.l=cs-nt:ms.r=cs+nt),Cs.attr("d",xyCorners(ms))):noZoom();else if(_a.isSubplotConstrained)if(nt>zn||at>zn){Ts="xy";var it=Math.min(ms.l/pa,(ga-ms.b)/ga),ot=Math.max(ms.r/pa,(ga-ms.t)/ga);ms.l=it*pa,ms.r=ot*pa,ms.b=(1-it)*ga,ms.t=(1-ot)*ga,Cs.attr("d",xyCorners(ms))}else noZoom();else!Wa||at<Math.min(Math.max(.6*nt,In),zn)?nt<In||!Va?noZoom():(ms.t=0,ms.b=ga,Ts="x",Cs.attr("d",xCorners(ms,ds))):!Va||nt<Math.min(.6*at,zn)?(ms.l=0,ms.r=pa,Ts="y",Cs.attr("d",yCorners(ms,cs))):(Ts="xy",Cs.attr("d",xyCorners(ms)));ms.w=ms.r-ms.l,ms.h=ms.b-ms.t,Ts&&(Es=!0),Ne._dragged=Es,updateZoombox(ks,Cs,ms,_s,ws,vs),computeZoomUpdates(),Ne.emit("plotly_relayouting",Yi),ws=!0}function computeZoomUpdates(){Yi={},"xy"!==Ts&&"x"!==Ts||(zoomAxRanges(Yn,ms.l/pa,ms.r/pa,Yi,ma.xaxes),updateMatchedAxRange("x",Yi)),"xy"!==Ts&&"y"!==Ts||(zoomAxRanges($n,(ga-ms.b)/ga,(ga-ms.t)/ga,Yi,ma.yaxes),updateMatchedAxRange("y",Yi))}function zoomDone(){computeZoomUpdates(),removeZoombox(Ne),dragTail(),showDoubleClickNotifier(Ne)}Ls.prepFn=function(Ge,Qe,tt){var rt=Ls.dragmode,nt=Ne._fullLayout.dragmode;nt!==rt&&(Ls.dragmode=nt),recomputeAxisLists(),uo=Ne._fullLayout._invScaleX,go=Ne._fullLayout._invScaleY,Qa||(as?Ge.shiftKey?"pan"===nt?nt="zoom":mr(nt)||(nt="pan"):Ge.ctrlKey&&(nt="pan"):nt="pan"),xr(nt)?Ls.minDrag=1:Ls.minDrag=void 0,mr(nt)?(Ls.xaxes=Yn,Ls.yaxes=$n,kn(Ge,Qe,tt,Ls,nt)):(Ls.clickFn=clickFn,mr(rt)&&clearAndResetSelect(),Qa||("zoom"===nt?(Ls.moveFn=zoomMove,Ls.doneFn=zoomDone,Ls.minDrag=1,zoomPrep(Ge,Qe,tt)):"pan"===nt&&(Ls.moveFn=plotDrag,Ls.doneFn=dragTail))),Ne._fullLayout._redrag=function(){var Ge=Ne._dragdata;if(Ge&&Ge.element===ss){var Qe=Ne._fullLayout.dragmode;mr(Qe)||(recomputeAxisLists(),updateSubplots([0,0,pa,ga]),Ls.moveFn(Ge.dx,Ge.dy))}}},er.init(Ls);var Ps=[0,0,pa,ga],Ds=null,Is=Dn.REDRAWDELAY,Os=Ge.mainplot?Ne._fullLayout._plots[Ge.mainplot]:Ge;function zoomWheel(Ge){if(Ne._context._scrollZoom.cartesian||Ne._fullLayout._enablescrollzoom){if(clearAndResetSelect(),Ne._transitioningWithDuration)return Ge.preventDefault(),void Ge.stopPropagation();recomputeAxisLists(),clearTimeout(Ds);var Qe=-Ge.deltaY;if(isFinite(Qe)||(Qe=Ge.wheelDelta/10),isFinite(Qe)){var tt,rt=Math.exp(-Math.min(Math.max(Qe,-20),20)/200),nt=Os.draglayer.select(".nsewdrag").node().getBoundingClientRect(),at=(Ge.clientX-nt.left)/nt.width,ot=(nt.bottom-Ge.clientY)/nt.height;if(ti){for(dr||(at=.5),tt=0;tt<Yn.length;tt++)zoomWheelOneAxis(Yn[tt],at,rt);updateMatchedAxRange("x"),Ps[2]*=rt,Ps[0]+=Ps[2]*at*(1/rt-1)}if(ni){for(Zt||(ot=.5),tt=0;tt<$n.length;tt++)zoomWheelOneAxis($n[tt],ot,rt);updateMatchedAxRange("y"),Ps[3]*=rt,Ps[1]+=Ps[3]*(1-ot)*(1/rt-1)}updateSubplots(Ps),ticksAndAnnotations(),Ne.emit("plotly_relayouting",Yi),Ds=setTimeout((function(){Ps=[0,0,pa,ga],dragTail()}),Is),Ge.preventDefault()}else it.log("Did not find wheel motion attributes: ",Ge)}function zoomWheelOneAxis(Ne,Ge,Qe){if(!Ne.fixedrange){var tt=it.simpleMap(Ne.range,Ne.r2l),rt=tt[0]+(tt[1]-tt[0])*Ge;Ne.range=tt.map(doZoom)}function doZoom(Ge){return Ne.l2r(rt+(Ge-rt)*Qe)}}}function plotDrag(Ge,Qe){if(Ge*=uo,Qe*=go,!Ne._transitioningWithDuration){if(Ne._fullLayout._replotting=!0,"ew"===Va||"ns"===Wa){var tt=Va?-Ge:0,rt=Wa?-Qe:0;if(_a.isSubplotConstrained){if(Va&&Wa){var nt=(Ge/pa-Qe/ga)/2;tt=-(Ge=nt*pa),rt=-(Qe=-nt*ga)}Wa?tt=-rt*pa/ga:rt=-tt*ga/pa}return Va&&(dragAxList(Yn,Ge),updateMatchedAxRange("x")),Wa&&(dragAxList($n,Qe),updateMatchedAxRange("y")),updateSubplots([tt,rt,pa,ga]),ticksAndAnnotations(),void Ne.emit("plotly_relayouting",Yi)}var at,it,ot="w"===Va==("n"===Wa)?1:-1;if(Va&&Wa&&(ma.isSubplotConstrained||_a.isSubplotConstrained)){var dt=(Ge/pa+ot*Qe/ga)/2;Ge=dt*pa,Qe=ot*dt*ga}if("w"===Va?Ge=dz(Yn,0,Ge):"e"===Va?Ge=dz(Yn,1,-Ge):Va||(Ge=0),"n"===Wa?Qe=dz($n,1,Qe):"s"===Wa?Qe=dz($n,0,-Qe):Wa||(Qe=0),at="w"===Va?Ge:0,it="n"===Wa?Qe:0,ma.isSubplotConstrained&&!_a.isSubplotConstrained||_a.isSubplotConstrained&&Va&&Wa&&ot>0){var ht;if(_a.isSubplotConstrained||!Va&&1===Wa.length){for(ht=0;ht<Yn.length;ht++)Yn[ht].range=Yn[ht]._r.slice(),Pn(Yn[ht],1-Qe/ga);at=(Ge=Qe*pa/ga)/2}if(_a.isSubplotConstrained||!Wa&&1===Va.length){for(ht=0;ht<$n.length;ht++)$n[ht].range=$n[ht]._r.slice(),Pn($n[ht],1-Ge/pa);it=(Qe=Ge*ga/pa)/2}}_a.isSubplotConstrained&&Wa||updateMatchedAxRange("x"),_a.isSubplotConstrained&&Va||updateMatchedAxRange("y");var Dt=pa-Ge,Ot=ga-Qe;!_a.isSubplotConstrained||Va&&Wa||(Va?(it=at?0:Ge*ga/pa,Ot=Dt*ga/pa):(at=it?0:Qe*pa/ga,Dt=Ot*pa/ga)),updateSubplots([at,it,Dt,Ot]),ticksAndAnnotations(),Ne.emit("plotly_relayouting",Yi)}function dz(Ne,Ge,Qe){for(var tt,rt,nt=1-Ge,at=0;at<Ne.length;at++){var it=Ne[at];if(!it.fixedrange){tt=it,rt=it._rl[nt]+(it._rl[Ge]-it._rl[nt])/dZoom(Qe/it._length);var ot=it.l2r(rt);!1!==ot&&void 0!==ot&&(it.range[Ge]=ot)}}return tt._length*(tt._rl[Ge]-rt)/(tt._rl[Ge]-tt._rl[nt])}}function updateMatchedAxRange(Ne,Ge){for(var Qe=_a.isSubplotConstrained?{x:$n,y:Yn}[Ne]:_a[Ne+"axes"],tt=_a.isSubplotConstrained?{x:Yn,y:$n}[Ne]:[],rt=0;rt<Qe.length;rt++){var nt=Qe[rt],at=nt._id,it=_a.xLinks[at]||_a.yLinks[at],ot=tt[0]||Hn[it]||qn[it];ot&&(Ge?(Ge[nt._name+".range[0]"]=Ge[ot._name+".range[0]"],Ge[nt._name+".range[1]"]=Ge[ot._name+".range[1]"]):nt.range=ot.range.slice())}}function ticksAndAnnotations(){var Ge,Qe=[];function pushActiveAxIds(Ne){for(Ge=0;Ge<Ne.length;Ge++)Ne[Ge].fixedrange||Qe.push(Ne[Ge]._id)}for(ti&&(pushActiveAxIds(Yn),pushActiveAxIds(ma.xaxes),pushActiveAxIds(_a.xaxes)),ni&&(pushActiveAxIds($n),pushActiveAxIds(ma.yaxes),pushActiveAxIds(_a.yaxes)),Yi={},Ge=0;Ge<Qe.length;Ge++){var tt=Qe[Ge],rt=xn(Ne,tt);Rt.drawOne(Ne,rt,{skipTitle:!0}),Yi[rt._name+".range[0]"]=rt.range[0],Yi[rt._name+".range[1]"]=rt.range[1]}Rt.redrawComponents(Ne,Qe)}function doubleClick(){if(!Ne._transitioningWithDuration){var Ge=Ne._context.doubleClick,Qe=[];Va&&(Qe=Qe.concat(Yn)),Wa&&(Qe=Qe.concat($n)),_a.xaxes&&(Qe=Qe.concat(_a.xaxes)),_a.yaxes&&(Qe=Qe.concat(_a.yaxes));var tt,rt,nt,it={};if("reset+autosize"===Ge)for(Ge="autosize",rt=0;rt<Qe.length;rt++)if((tt=Qe[rt])._rangeInitial&&(tt.range[0]!==tt._rangeInitial[0]||tt.range[1]!==tt._rangeInitial[1])||!tt._rangeInitial&&!tt.autorange){Ge="reset";break}if("autosize"===Ge)for(rt=0;rt<Qe.length;rt++)(tt=Qe[rt]).fixedrange||(it[tt._name+".autorange"]=!0);else if("reset"===Ge)for((Va||ma.isSubplotConstrained)&&(Qe=Qe.concat(ma.xaxes)),Wa&&!ma.isSubplotConstrained&&(Qe=Qe.concat(ma.yaxes)),ma.isSubplotConstrained&&(Va?Wa||(Qe=Qe.concat($n)):Qe=Qe.concat(Yn)),rt=0;rt<Qe.length;rt++)(tt=Qe[rt]).fixedrange||(tt._rangeInitial?(nt=tt._rangeInitial,it[tt._name+".range[0]"]=nt[0],it[tt._name+".range[1]"]=nt[1]):it[tt._name+".autorange"]=!0);Ne.emit("plotly_doubleclick",null),at.call("_guiRelayout",Ne,it)}}function dragTail(){updateSubplots([0,0,pa,ga]),it.syncOrAsync([mn.previousPromises,function(){Ne._fullLayout._replotting=!1,at.call("_guiRelayout",Ne,Yi)}],Ne)}function updateSubplots(Ge){var Qe,tt,rt,nt,ot=Ne._fullLayout,dt=ot._plots,ht=ot._subplots.cartesian;if(ji&&at.subplotsRegistry.splom.drag(Ne),di)for(Qe=0;Qe<ht.length;Qe++)if(rt=(tt=dt[ht[Qe]]).xaxis,nt=tt.yaxis,tt._scene){var Ot=it.simpleMap(rt.range,rt.r2l),Rt=it.simpleMap(nt.range,nt.r2l);tt._scene.update({range:[Ot[0],Rt[0],Ot[1],Rt[1]]})}if((ji||di)&&(Ar(Ne),en(Ne)),Hi){var er=Ge[2]/Bn._length,mr=Ge[3]/Vn._length;for(Qe=0;Qe<ht.length;Qe++){rt=(tt=dt[ht[Qe]]).xaxis,nt=tt.yaxis;var xr,br,mn,xn,kn=(ti||_a.isSubplotConstrained)&&!rt.fixedrange&&Hn[rt._id],Cn=(ni||_a.isSubplotConstrained)&&!nt.fixedrange&&qn[nt._id];if(kn?(xr=er,mn=dr||_a.isSubplotConstrained?Ge[0]:getShift(rt,xr)):_a.xaHash[rt._id]?(xr=er,mn=Ge[0]*rt._length/Bn._length):_a.yaHash[rt._id]?(xr=mr,mn="ns"===Wa?-Ge[1]*rt._length/Vn._length:getShift(rt,xr,{n:"top",s:"bottom"}[Wa])):mn=scaleAndGetShift(rt,xr=getLinkedScaleFactor(rt,er,mr)),Cn?(br=mr,xn=Zt||_a.isSubplotConstrained?Ge[1]:getShift(nt,br)):_a.yaHash[nt._id]?(br=mr,xn=Ge[1]*nt._length/Vn._length):_a.xaHash[nt._id]?(br=er,xn="ew"===Va?-Ge[0]*nt._length/Bn._length:getShift(nt,br,{e:"right",w:"left"}[Va])):xn=scaleAndGetShift(nt,br=getLinkedScaleFactor(nt,er,mr)),xr||br){xr||(xr=1),br||(br=1);var En=rt._offset-mn/xr,Pn=nt._offset-xn/br;tt.clipRect.call(Dt.setTranslate,mn,xn).call(Dt.setScale,xr,br),tt.plot.call(Dt.setTranslate,En,Pn).call(Dt.setScale,1/xr,1/br),xr===tt.xScaleFactor&&br===tt.yScaleFactor||(Dt.setPointGroupScale(tt.zoomScalePts,xr,br),Dt.setTextPointsScale(tt.zoomScaleTxt,xr,br)),Dt.hideOutsideRangePoints(tt.clipOnAxisFalseTraces,tt),tt.xScaleFactor=xr,tt.yScaleFactor=br}}}}function getLinkedScaleFactor(Ne,Ge,Qe){return Ne.fixedrange?0:ti&&ma.xaHash[Ne._id]?Ge:ni&&(ma.isSubplotConstrained?ma.xaHash:ma.yaHash)[Ne._id]?Qe:0}function scaleAndGetShift(Ne,Ge){return Ge?(Ne.range=Ne._r.slice(),Pn(Ne,Ge),getShift(Ne,Ge)):0}function getShift(Ne,Ge,Qe){return Ne._length*(1-Ge)*br[Qe||Ne.constraintoward||"middle"]}return Zt.length*dr.length!=1&&attachWheelEventHandler(ss,zoomWheel),ss}function makeDragger(Ne,Ge,Qe,tt){var rt=it.ensureSingle(Ne.draglayer,Ge,Qe,(function(Ge){Ge.classed("drag",!0).style({fill:"transparent","stroke-width":0}).attr("data-subplot",Ne.id)}));return rt.call(Zt,tt),rt.node()}function makeRectDragger(Ne,Ge,Qe,rt,nt,at,it){var ot=makeDragger(Ne,"rect",Ge,Qe);return tt.select(ot).call(Dt.setRect,rt,nt,at,it),ot}function isDirectionActive(Ne,Ge){for(var Qe=0;Qe<Ne.length;Qe++)if(!Ne[Qe].fixedrange)return Ge;return""}function getEndText(Ne,Ge){var Qe,rt=Ne.range[Ge],nt=Math.abs(rt-Ne.range[1-Ge]);return"date"===Ne.type?rt:"log"===Ne.type?(Qe=Math.ceil(Math.max(0,-Math.log(nt)/Math.LN10))+3,tt.format("."+Qe+"g")(Math.pow(10,rt))):(Qe=Math.floor(Math.log(Math.abs(rt))/Math.LN10)-Math.floor(Math.log(nt)/Math.LN10)+4,tt.format("."+String(Qe)+"g")(rt))}function zoomAxRanges(Ne,Ge,Qe,tt,rt){for(var nt=0;nt<Ne.length;nt++){var at=Ne[nt];if(!at.fixedrange)if(at.rangebreaks){var it="y"===at._id.charAt(0),ot=it?1-Ge:Ge,dt=it?1-Qe:Qe;tt[at._name+".range[0]"]=at.l2r(at.p2l(ot*at._length)),tt[at._name+".range[1]"]=at.l2r(at.p2l(dt*at._length))}else{var ht=at._rl[0],Dt=at._rl[1]-ht;tt[at._name+".range[0]"]=at.l2r(ht+Dt*Ge),tt[at._name+".range[1]"]=at.l2r(ht+Dt*Qe)}}if(rt&&rt.length){var Ot=(Ge+(1-Qe))/2;zoomAxRanges(rt,Ot,1-Ot,tt,[])}}function dragAxList(Ne,Ge){for(var Qe=0;Qe<Ne.length;Qe++){var tt=Ne[Qe];if(!tt.fixedrange)if(tt.rangebreaks){var rt=0,nt=tt._length,at=(tt.p2l(rt+Ge)-tt.p2l(rt)+(tt.p2l(nt+Ge)-tt.p2l(nt)))/2;tt.range=[tt.l2r(tt._rl[0]-at),tt.l2r(tt._rl[1]-at)]}else tt.range=[tt.l2r(tt._rl[0]-Ge/tt._m),tt.l2r(tt._rl[1]-Ge/tt._m)]}}function dZoom(Ne){return 1-(Ne>=0?Math.min(Ne,.9):1/(1/Math.max(Ne,-.3)+3.222))}function getDragCursor(Ne,Ge,Qe){return Ne?"nsew"===Ne?Qe?"":"pan"===Ge?"move":"crosshair":Ne.toLowerCase()+"-resize":"pointer"}function makeZoombox(Ne,Ge,Qe,tt,rt){return Ne.append("path").attr("class","zoombox").style({fill:Ge>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("transform",ot(Qe,tt)).attr("d",rt+"Z")}function makeCorners(Ne,Ge,Qe){return Ne.append("path").attr("class","zoombox-corners").style({fill:ht.background,stroke:ht.defaultLine,"stroke-width":1,opacity:0}).attr("transform",ot(Ge,Qe)).attr("d","M0,0Z")}function updateZoombox(Ne,Ge,Qe,tt,rt,nt){Ne.attr("d",tt+"M"+Qe.l+","+Qe.t+"v"+Qe.h+"h"+Qe.w+"v-"+Qe.h+"h-"+Qe.w+"Z"),transitionZoombox(Ne,Ge,rt,nt)}function transitionZoombox(Ne,Ge,Qe,tt){Qe||(Ne.transition().style("fill",tt>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),Ge.transition().style("opacity",1).duration(200))}function removeZoombox(Ne){tt.select(Ne).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}function showDoubleClickNotifier(Ne){Bn&&Ne.data&&Ne._context.showTips&&(it.notifier(it._(Ne,"Double-click to zoom back out"),"long"),Bn=!1)}function xCorners(Ne,Ge){return"M"+(Ne.l-.5)+","+(Ge-zn-.5)+"h-3v"+(2*zn+1)+"h3ZM"+(Ne.r+.5)+","+(Ge-zn-.5)+"h3v"+(2*zn+1)+"h-3Z"}function yCorners(Ne,Ge){return"M"+(Ge-zn-.5)+","+(Ne.t-.5)+"v-3h"+(2*zn+1)+"v3ZM"+(Ge-zn-.5)+","+(Ne.b+.5)+"v3h"+(2*zn+1)+"v-3Z"}function xyCorners(Ne){var Ge=Math.floor(Math.min(Ne.b-Ne.t,Ne.r-Ne.l,zn)/2);return"M"+(Ne.l-3.5)+","+(Ne.t-.5+Ge)+"h3v"+-Ge+"h"+Ge+"v-3h-"+(Ge+3)+"ZM"+(Ne.r+3.5)+","+(Ne.t-.5+Ge)+"h-3v"+-Ge+"h"+-Ge+"v-3h"+(Ge+3)+"ZM"+(Ne.r+3.5)+","+(Ne.b+.5-Ge)+"h-3v"+Ge+"h"+-Ge+"v3h"+(Ge+3)+"ZM"+(Ne.l-3.5)+","+(Ne.b+.5-Ge)+"h3v"+Ge+"h"+Ge+"v3h-"+(Ge+3)+"Z"}function calcLinks(Ne,Ge,Qe,tt,rt){for(var nt,at,ot,dt,ht=!1,Dt={},Ot={},Rt=(rt||{}).xaHash,Zt=(rt||{}).yaHash,er=0;er<Ge.length;er++){var dr=Ge[er];for(nt in Qe)if(dr[nt]){for(ot in dr)rt&&(Rt[ot]||Zt[ot])||("x"===ot.charAt(0)?Qe:tt)[ot]||(Dt[ot]=nt);for(at in tt)rt&&(Rt[at]||Zt[at])||!dr[at]||(ht=!0)}for(at in tt)if(dr[at])for(dt in dr)rt&&(Rt[dt]||Zt[dt])||("x"===dt.charAt(0)?Qe:tt)[dt]||(Ot[dt]=at)}ht&&(it.extendFlat(Dt,Ot),Ot={});var mr={},xr=[];for(ot in Dt){var br=xn(Ne,ot);xr.push(br),mr[br._id]=br}var Ar={},en=[];for(dt in Ot){var mn=xn(Ne,dt);en.push(mn),Ar[mn._id]=mn}return{xaHash:mr,yaHash:Ar,xaxes:xr,yaxes:en,xLinks:Dt,yLinks:Ot,isSubplotConstrained:ht}}function attachWheelEventHandler(Ne,Ge){if(nt){var Qe=void 0!==Ne.onwheel?"wheel":"mousewheel";Ne._onwheel&&Ne.removeEventListener(Qe,Ne._onwheel),Ne._onwheel=Ge,Ne.addEventListener(Qe,Ge,{passive:!1})}else void 0!==Ne.onwheel?Ne.onwheel=Ge:void 0!==Ne.onmousewheel?Ne.onmousewheel=Ge:Ne.isAddedWheelEvent||(Ne.isAddedWheelEvent=!0,Ne.addEventListener("wheel",Ge,{passive:!1}))}function hashValues(Ne){var Ge=[];for(var Qe in Ne)Ge.push(Ne[Qe]);return Ge}Ge.exports={makeDragBox:makeDragBox,makeDragger:makeDragger,makeRectDragger:makeRectDragger,makeZoombox:makeZoombox,makeCorners:makeCorners,updateZoombox:updateZoombox,xyCorners:xyCorners,transitionZoombox:transitionZoombox,removeZoombox:removeZoombox,showDoubleClickNotifier:showDoubleClickNotifier,attachWheelEventHandler:attachWheelEventHandler}},{"../../components/color":643,"../../components/dragelement":662,"../../components/dragelement/helpers":661,"../../components/drawing":665,"../../components/fx":683,"../../constants/alignment":745,"../../lib":778,"../../lib/clear_gl_canvases":762,"../../lib/setcursor":799,"../../lib/svg_text_utils":803,"../../plot_api/subroutines":818,"../../registry":911,"../plots":891,"./axes":828,"./axis_ids":831,"./constants":834,"./scale_zoom":846,"./select":847,d3:169,"has-passive-events":441,tinycolor2:576}],837:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../components/fx"),nt=Ne("../../components/dragelement"),at=Ne("../../lib/setcursor"),it=Ne("./dragbox").makeDragBox,ot=Ne("./constants").DRAGGERSIZE;Qe.initInteractions=function(Ne){var Ge=Ne._fullLayout;if(Ne._context.staticPlot)tt.select(Ne).selectAll(".drag").remove();else if(Ge._has("cartesian")||Ge._has("splom")){Object.keys(Ge._plots||{}).sort((function(Ne,Qe){if((Ge._plots[Ne].mainplot&&!0)===(Ge._plots[Qe].mainplot&&!0)){var tt=Ne.split("y"),rt=Qe.split("y");return tt[0]===rt[0]?Number(tt[1]||1)-Number(rt[1]||1):Number(tt[0]||1)-Number(rt[0]||1)}return Ge._plots[Ne].mainplot?1:-1})).forEach((function(Qe){var tt=Ge._plots[Qe],at=tt.xaxis,dt=tt.yaxis;if(!tt.mainplot){var ht=it(Ne,tt,at._offset,dt._offset,at._length,dt._length,"ns","ew");ht.onmousemove=function(Ge){Ne._fullLayout._rehover=function(){Ne._fullLayout._hoversubplot===Qe&&Ne._fullLayout._plots[Qe]&&rt.hover(Ne,Ge,Qe)},rt.hover(Ne,Ge,Qe),Ne._fullLayout._lasthover=ht,Ne._fullLayout._hoversubplot=Qe},ht.onmouseout=function(Ge){Ne._dragging||(Ne._fullLayout._hoversubplot=null,nt.unhover(Ne,Ge))},Ne._context.showAxisDragHandles&&(it(Ne,tt,at._offset-ot,dt._offset-ot,ot,ot,"n","w"),it(Ne,tt,at._offset+at._length,dt._offset-ot,ot,ot,"n","e"),it(Ne,tt,at._offset-ot,dt._offset+dt._length,ot,ot,"s","w"),it(Ne,tt,at._offset+at._length,dt._offset+dt._length,ot,ot,"s","e"))}if(Ne._context.showAxisDragHandles){if(Qe===at._mainSubplot){var Dt=at._mainLinePosition;"top"===at.side&&(Dt-=ot),it(Ne,tt,at._offset+.1*at._length,Dt,.8*at._length,ot,"","ew"),it(Ne,tt,at._offset,Dt,.1*at._length,ot,"","w"),it(Ne,tt,at._offset+.9*at._length,Dt,.1*at._length,ot,"","e")}if(Qe===dt._mainSubplot){var Ot=dt._mainLinePosition;"right"!==dt.side&&(Ot-=ot),it(Ne,tt,Ot,dt._offset+.1*dt._length,ot,.8*dt._length,"ns",""),it(Ne,tt,Ot,dt._offset+.9*dt._length,ot,.1*dt._length,"s",""),it(Ne,tt,Ot,dt._offset,ot,.1*dt._length,"n","")}}}));var at=Ge._hoverlayer.node();at.onmousemove=function(Qe){Qe.target=Ne._fullLayout._lasthover,rt.hover(Ne,Qe,Ge._hoversubplot)},at.onclick=function(Ge){Ge.target=Ne._fullLayout._lasthover,rt.click(Ne,Ge)},at.onmousedown=function(Ge){Ne._fullLayout._lasthover.onmousedown(Ge)},Qe.updateFx(Ne)}},Qe.updateFx=function(Ne){var Ge=Ne._fullLayout,Qe="pan"===Ge.dragmode?"move":"crosshair";at(Ge._draggers,Qe)}},{"../../components/dragelement":662,"../../components/fx":683,"../../lib/setcursor":799,"./constants":834,"./dragbox":836,d3:169}],838:[function(Ne,Ge,Qe){"use strict";function clearOutlineControllers(Ne){var Ge=Ne._fullLayout._zoomlayer;Ge&&Ge.selectAll(".outline-controllers").remove()}function clearSelect(Ne){var Ge=Ne._fullLayout._zoomlayer;Ge&&Ge.selectAll(".select-outline").remove(),Ne._fullLayout._drawing=!1}Ge.exports={clearOutlineControllers:clearOutlineControllers,clearSelect:clearSelect}},{}],839:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib").strTranslate;function p2r(Ne,Ge){switch(Ne.type){case"log":return Ne.p2d(Ge);case"date":return Ne.p2r(Ge,0,Ne.calendar);default:return Ne.p2r(Ge)}}function r2p(Ne,Ge){switch(Ne.type){case"log":return Ne.d2p(Ge);case"date":return Ne.r2p(Ge,0,Ne.calendar);default:return Ne.r2p(Ge)}}function axValue(Ne){var Ge="y"===Ne._id.charAt(0)?1:0;return function(Qe){return p2r(Ne,Qe[Ge])}}function getTransform(Ne){return tt(Ne.xaxis._offset,Ne.yaxis._offset)}Ge.exports={p2r:p2r,r2p:r2p,axValue:axValue,getTransform:getTransform}},{"../../lib":778}],840:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../registry"),rt=Ne("../../lib"),nt=Ne("./axis_ids");Ge.exports=function(Ne){return function(Ge,Qe){var at=Ge[Ne];if(Array.isArray(at))for(var it=tt.subplotsRegistry.cartesian,ot=it.idRegex,dt=Qe._subplots,ht=dt.xaxis,Dt=dt.yaxis,Ot=dt.cartesian,Rt=Qe._has("cartesian")||Qe._has("gl2d"),Zt=0;Zt<at.length;Zt++){var er=at[Zt];if(rt.isPlainObject(er)){var dr=nt.cleanId(er.xref,"x",!1),mr=nt.cleanId(er.yref,"y",!1),xr=ot.x.test(dr),br=ot.y.test(mr);if(xr||br){Rt||rt.pushUnique(Qe._basePlotModules,it);var Ar=!1;xr&&-1===ht.indexOf(dr)&&(ht.push(dr),Ar=!0),br&&-1===Dt.indexOf(mr)&&(Dt.push(mr),Ar=!0),Ar&&xr&&br&&Ot.push(dr+mr)}}}}}},{"../../lib":778,"../../registry":911,"./axis_ids":831}],841:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../registry"),nt=Ne("../../lib"),at=Ne("../plots"),it=Ne("../../components/drawing"),ot=Ne("../get_data").getModuleCalcData,dt=Ne("./axis_ids"),ht=Ne("./constants"),Dt=Ne("../../constants/xmlns_namespaces"),Ot=nt.ensureSingle;function ensureSingleAndAddDatum(Ne,Ge,Qe){return nt.ensureSingle(Ne,Ge,Qe,(function(Ne){Ne.datum(Qe)}))}function plotOne(Ne,Ge,Qe,nt,at){for(var dt,Dt,Ot,Rt=ht.traceLayerClasses,Zt=Ne._fullLayout,er=Zt._modules,dr=[],mr=[],xr=0;xr<er.length;xr++){var br=(dt=er[xr]).name,Ar=rt.modules[br].categories;if(Ar.svg){var en=dt.layerName||br+"layer",mn=dt.plot;Ot=(Dt=ot(Qe,mn))[0],Qe=Dt[1],Ot.length&&dr.push({i:Rt.indexOf(en),className:en,plotMethod:mn,cdModule:Ot}),Ar.zoomScale&&mr.push("."+en)}}dr.sort((function(Ne,Ge){return Ne.i-Ge.i}));var xn=Ge.plot.selectAll("g.mlayer").data(dr,(function(Ne){return Ne.className}));if(xn.enter().append("g").attr("class",(function(Ne){return Ne.className})).classed("mlayer",!0).classed("rangeplot",Ge.isRangePlot),xn.exit().remove(),xn.order(),xn.each((function(Qe){var rt=tt.select(this),ot=Qe.className;Qe.plotMethod(Ne,Ge,Qe.cdModule,rt,nt,at),-1===ht.clipOnAxisFalseQuery.indexOf("."+ot)&&it.setClipUrl(rt,Ge.layerClipId,Ne)})),Zt._has("scattergl")&&(dt=rt.getModule("scattergl"),Ot=ot(Qe,dt)[0],dt.plot(Ne,Ge,Ot)),!Ne._context.staticPlot&&(Ge._hasClipOnAxisFalse&&(Ge.clipOnAxisFalseTraces=Ge.plot.selectAll(ht.clipOnAxisFalseQuery.join(",")).selectAll(".trace")),mr.length)){var kn=Ge.plot.selectAll(mr.join(",")).selectAll(".trace");Ge.zoomScalePts=kn.selectAll("path.point"),Ge.zoomScaleTxt=kn.selectAll(".textpoint")}}function makeSubplotData(Ne){var Ge,Qe,tt,rt,nt,at,it=Ne._fullLayout,ot=it._subplots.cartesian,dt=ot.length,ht=[],Dt=[];for(Ge=0;Ge<dt;Ge++){tt=ot[Ge],nt=(rt=it._plots[tt]).xaxis,at=rt.yaxis;var Ot=nt._mainAxis,Rt=at._mainAxis,Zt=Ot._id+Rt._id,er=it._plots[Zt];rt.overlays=[],Zt!==tt&&er?(rt.mainplot=Zt,rt.mainplotinfo=er,Dt.push(tt)):(rt.mainplot=void 0,rt.mainplotinfo=void 0,ht.push(tt))}for(Ge=0;Ge<Dt.length;Ge++)tt=Dt[Ge],(rt=it._plots[tt]).mainplotinfo.overlays.push(rt);var dr=ht.concat(Dt),mr=new Array(dt);for(Ge=0;Ge<dt;Ge++){tt=dr[Ge],nt=(rt=it._plots[tt]).xaxis,at=rt.yaxis;var xr=[tt,nt.layer,at.layer,nt.overlaying||"",at.overlaying||""];for(Qe=0;Qe<rt.overlays.length;Qe++)xr.push(rt.overlays[Qe].id);mr[Ge]=xr}return mr}function makeSubplotLayer(Ne,Ge){var Qe=Ge.plotgroup,tt=Ge.id,rt=ht.layerValue2layerClass[Ge.xaxis.layer],nt=ht.layerValue2layerClass[Ge.yaxis.layer],at=Ne._fullLayout._hasOnlyLargeSploms;if(Ge.mainplot){var it=Ge.mainplotinfo,ot=it.plotgroup,Dt=tt+"-x",Rt=tt+"-y";Ge.gridlayer=it.gridlayer,Ge.zerolinelayer=it.zerolinelayer,Ot(it.overlinesBelow,"path",Dt),Ot(it.overlinesBelow,"path",Rt),Ot(it.overaxesBelow,"g",Dt),Ot(it.overaxesBelow,"g",Rt),Ge.plot=Ot(it.overplot,"g",tt),Ot(it.overlinesAbove,"path",Dt),Ot(it.overlinesAbove,"path",Rt),Ot(it.overaxesAbove,"g",Dt),Ot(it.overaxesAbove,"g",Rt),Ge.xlines=ot.select(".overlines-"+rt).select("."+Dt),Ge.ylines=ot.select(".overlines-"+nt).select("."+Rt),Ge.xaxislayer=ot.select(".overaxes-"+rt).select("."+Dt),Ge.yaxislayer=ot.select(".overaxes-"+nt).select("."+Rt)}else if(at)Ge.xlines=Ot(Qe,"path","xlines-above"),Ge.ylines=Ot(Qe,"path","ylines-above"),Ge.xaxislayer=Ot(Qe,"g","xaxislayer-above"),Ge.yaxislayer=Ot(Qe,"g","yaxislayer-above");else{var Zt=Ot(Qe,"g","layer-subplot");Ge.shapelayer=Ot(Zt,"g","shapelayer"),Ge.imagelayer=Ot(Zt,"g","imagelayer"),Ge.gridlayer=Ot(Qe,"g","gridlayer"),Ge.zerolinelayer=Ot(Qe,"g","zerolinelayer"),Ot(Qe,"path","xlines-below"),Ot(Qe,"path","ylines-below"),Ge.overlinesBelow=Ot(Qe,"g","overlines-below"),Ot(Qe,"g","xaxislayer-below"),Ot(Qe,"g","yaxislayer-below"),Ge.overaxesBelow=Ot(Qe,"g","overaxes-below"),Ge.plot=Ot(Qe,"g","plot"),Ge.overplot=Ot(Qe,"g","overplot"),Ge.xlines=Ot(Qe,"path","xlines-above"),Ge.ylines=Ot(Qe,"path","ylines-above"),Ge.overlinesAbove=Ot(Qe,"g","overlines-above"),Ot(Qe,"g","xaxislayer-above"),Ot(Qe,"g","yaxislayer-above"),Ge.overaxesAbove=Ot(Qe,"g","overaxes-above"),Ge.xlines=Qe.select(".xlines-"+rt),Ge.ylines=Qe.select(".ylines-"+nt),Ge.xaxislayer=Qe.select(".xaxislayer-"+rt),Ge.yaxislayer=Qe.select(".yaxislayer-"+nt)}at||(ensureSingleAndAddDatum(Ge.gridlayer,"g",Ge.xaxis._id),ensureSingleAndAddDatum(Ge.gridlayer,"g",Ge.yaxis._id),Ge.gridlayer.selectAll("g").map((function(Ne){return Ne[0]})).sort(dt.idSort)),Ge.xlines.style("fill","none").classed("crisp",!0),Ge.ylines.style("fill","none").classed("crisp",!0)}function purgeSubplotLayers(Ne,Ge){if(Ne){var Qe={};for(var rt in Ne.each((function(Ne){var rt=Ne[0];tt.select(this).remove(),removeSubplotExtras(rt,Ge),Qe[rt]=!0})),Ge._plots)for(var nt=Ge._plots[rt].overlays||[],at=0;at<nt.length;at++){var it=nt[at];Qe[it.id]&&it.plot.selectAll(".trace").remove()}}}function removeSubplotExtras(Ne,Ge){Ge._draggers.selectAll("g."+Ne).remove(),Ge._defs.select("#clip"+Ge._uid+Ne+"plot").remove()}Qe.name="cartesian",Qe.attr=["xaxis","yaxis"],Qe.idRoot=["x","y"],Qe.idRegex=ht.idRegex,Qe.attrRegex=ht.attrRegex,Qe.attributes=Ne("./attributes"),Qe.layoutAttributes=Ne("./layout_attributes"),Qe.supplyLayoutDefaults=Ne("./layout_defaults"),Qe.transitionAxes=Ne("./transition_axes"),Qe.finalizeSubplots=function(Ne,Ge){var Qe,tt,rt,at=Ge._subplots,it=at.xaxis,ot=at.yaxis,Dt=at.cartesian,Ot=Dt.concat(at.gl2d||[]),Rt={},Zt={};for(Qe=0;Qe<Ot.length;Qe++){var er=Ot[Qe].split("y");Rt[er[0]]=1,Zt["y"+er[1]]=1}for(Qe=0;Qe<it.length;Qe++)Rt[tt=it[Qe]]||(rt=(Ne[dt.id2name(tt)]||{}).anchor,ht.idRegex.y.test(rt)||(rt="y"),Dt.push(tt+rt),Ot.push(tt+rt),Zt[rt]||(Zt[rt]=1,nt.pushUnique(ot,rt)));for(Qe=0;Qe<ot.length;Qe++)Zt[rt=ot[Qe]]||(tt=(Ne[dt.id2name(rt)]||{}).anchor,ht.idRegex.x.test(tt)||(tt="x"),Dt.push(tt+rt),Ot.push(tt+rt),Rt[tt]||(Rt[tt]=1,nt.pushUnique(it,tt)));if(!Ot.length){for(var dr in tt="",rt="",Ne)ht.attrRegex.test(dr)&&("x"===dr.charAt(0)?(!tt||+dr.substr(5)<+tt.substr(5))&&(tt=dr):(!rt||+dr.substr(5)<+rt.substr(5))&&(rt=dr));tt=tt?dt.name2id(tt):"x",rt=rt?dt.name2id(rt):"y",it.push(tt),ot.push(rt),Dt.push(tt+rt)}},Qe.plot=function(Ne,Ge,Qe,tt){var rt,nt=Ne._fullLayout,at=nt._subplots.cartesian,it=Ne.calcdata;if(!Array.isArray(Ge))for(Ge=[],rt=0;rt<it.length;rt++)Ge.push(rt);for(rt=0;rt<at.length;rt++){for(var ot,dt=at[rt],ht=nt._plots[dt],Dt=[],Ot=0;Ot<it.length;Ot++){var Rt=it[Ot],Zt=Rt[0].trace;Zt.xaxis+Zt.yaxis===dt&&((-1!==Ge.indexOf(Zt.index)||Zt.carpet)&&(ot&&ot[0].trace.xaxis+ot[0].trace.yaxis===dt&&-1!==["tonextx","tonexty","tonext"].indexOf(Zt.fill)&&-1===Dt.indexOf(ot)&&Dt.push(ot),Dt.push(Rt)),ot=Rt)}plotOne(Ne,ht,Dt,Qe,tt)}},Qe.clean=function(Ne,Ge,Qe,tt){var rt,nt,at,it=tt._plots||{},ot=Ge._plots||{},ht=tt._subplots||{};if(tt._hasOnlyLargeSploms&&!Ge._hasOnlyLargeSploms)for(at in it)(rt=it[at]).plotgroup&&rt.plotgroup.remove();var Dt=tt._has&&tt._has("gl"),Ot=Ge._has&&Ge._has("gl");if(Dt&&!Ot)for(at in it)(rt=it[at])._scene&&rt._scene.destroy();if(ht.xaxis&&ht.yaxis){var Rt=dt.listIds({_fullLayout:tt});for(nt=0;nt<Rt.length;nt++){var Zt=Rt[nt];Ge[dt.id2name(Zt)]||tt._infolayer.selectAll(".g-"+Zt+"title").remove()}}var er=tt._has&&tt._has("cartesian"),dr=Ge._has&&Ge._has("cartesian");if(er&&!dr)purgeSubplotLayers(tt._cartesianlayer.selectAll(".subplot"),tt),tt._defs.selectAll(".axesclip").remove(),delete tt._axisConstraintGroups,delete tt._axisMatchGroups;else if(ht.cartesian)for(nt=0;nt<ht.cartesian.length;nt++){var mr=ht.cartesian[nt];if(!ot[mr]){var xr="."+mr+",."+mr+"-x,."+mr+"-y";tt._cartesianlayer.selectAll(xr).remove(),removeSubplotExtras(mr,tt)}}},Qe.drawFramework=function(Ne){var Ge=Ne._fullLayout,Qe=makeSubplotData(Ne),rt=Ge._cartesianlayer.selectAll(".subplot").data(Qe,String);rt.enter().append("g").attr("class",(function(Ne){return"subplot "+Ne[0]})),rt.order(),rt.exit().call(purgeSubplotLayers,Ge),rt.each((function(Qe){var rt=Qe[0],nt=Ge._plots[rt];nt.plotgroup=tt.select(this),makeSubplotLayer(Ne,nt),nt.draglayer=Ot(Ge._draggers,"g",rt)}))},Qe.rangePlot=function(Ne,Ge,Qe){makeSubplotLayer(Ne,Ge),plotOne(Ne,Ge,Qe),at.style(Ne)},Qe.toSVG=function(Ne){var Ge=Ne._fullLayout._glimages,Qe=tt.select(Ne).selectAll(".svg-container");function canvasToImage(){var Ne=this,Qe=Ne.toDataURL("image/png");Ge.append("svg:image").attr({xmlns:Dt.svg,"xlink:href":Qe,preserveAspectRatio:"none",x:0,y:0,width:Ne.width,height:Ne.height})}Qe.filter((function(Ne,Ge){return Ge===Qe.size()-1})).selectAll(".gl-canvas-context, .gl-canvas-focus").each(canvasToImage)},Qe.updateFx=Ne("./graph_interact").updateFx},{"../../components/drawing":665,"../../constants/xmlns_namespaces":754,"../../lib":778,"../../registry":911,"../get_data":865,"../plots":891,"./attributes":826,"./axis_ids":831,"./constants":834,"./graph_interact":837,"./layout_attributes":842,"./layout_defaults":843,"./transition_axes":852,d3:169}],842:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../font_attributes"),rt=Ne("../../components/color/attributes"),nt=Ne("../../components/drawing/attributes").dash,at=Ne("../../lib/extend").extendFlat,it=Ne("../../plot_api/plot_template").templatedArray,ot=(Ne("../../constants/docs").FORMAT_LINK,Ne("../../constants/docs").DATE_FORMAT_LINK,Ne("../../constants/numerical").ONEDAY),dt=Ne("./constants"),ht=dt.HOUR_PATTERN,Dt=dt.WEEKDAY_PATTERN;Ge.exports={visible:{valType:"boolean",editType:"plot"},color:{valType:"color",dflt:rt.defaultLine,editType:"ticks"},title:{text:{valType:"string",editType:"ticks"},font:tt({editType:"ticks"}),standoff:{valType:"number",min:0,editType:"ticks"},editType:"ticks"},type:{valType:"enumerated",values:["-","linear","log","date","category","multicategory"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"axrange",impliedEdits:{"range[0]":void 0,"range[1]":void 0}},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"plot"},range:{valType:"info_array",items:[{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0},{valType:"any",editType:"axrange",impliedEdits:{"^autorange":!1},anim:!0}],editType:"axrange",impliedEdits:{autorange:!1},anim:!0},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},scaleanchor:{valType:"enumerated",values:[dt.idRegex.x.toString(),dt.idRegex.y.toString()],editType:"plot"},scaleratio:{valType:"number",min:0,dflt:1,editType:"plot"},constrain:{valType:"enumerated",values:["range","domain"],editType:"plot"},constraintoward:{valType:"enumerated",values:["left","center","right","top","middle","bottom"],editType:"plot"},matches:{valType:"enumerated",values:[dt.idRegex.x.toString(),dt.idRegex.y.toString()],editType:"calc"},rangebreaks:it("rangebreak",{enabled:{valType:"boolean",dflt:!0,editType:"calc"},bounds:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},pattern:{valType:"enumerated",values:[Dt,ht,""],editType:"calc"},values:{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"any",editType:"calc"}},dvalue:{valType:"number",editType:"calc",min:0,dflt:ot},editType:"calc"}),tickmode:{valType:"enumerated",values:["auto","linear","array"],editType:"ticks",impliedEdits:{tick0:void 0,dtick:void 0}},nticks:{valType:"integer",min:0,dflt:0,editType:"ticks"},tick0:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},dtick:{valType:"any",editType:"ticks",impliedEdits:{tickmode:"linear"}},tickvals:{valType:"data_array",editType:"ticks"},ticktext:{valType:"data_array",editType:"ticks"},ticks:{valType:"enumerated",values:["outside","inside",""],editType:"ticks"},tickson:{valType:"enumerated",values:["labels","boundaries"],dflt:"labels",editType:"ticks"},ticklabelmode:{valType:"enumerated",values:["instant","period"],dflt:"instant",editType:"ticks"},ticklabelposition:{valType:"enumerated",values:["outside","inside","outside top","inside top","outside left","inside left","outside right","inside right","outside bottom","inside bottom"],dflt:"outside",editType:"calc"},mirror:{valType:"enumerated",values:[!0,"ticks",!1,"all","allticks"],dflt:!1,editType:"ticks+layoutstyle"},ticklen:{valType:"number",min:0,dflt:5,editType:"ticks"},tickwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},tickcolor:{valType:"color",dflt:rt.defaultLine,editType:"ticks"},showticklabels:{valType:"boolean",dflt:!0,editType:"ticks"},automargin:{valType:"boolean",dflt:!1,editType:"ticks"},showspikes:{valType:"boolean",dflt:!1,editType:"modebar"},spikecolor:{valType:"color",dflt:null,editType:"none"},spikethickness:{valType:"number",dflt:3,editType:"none"},spikedash:at({},nt,{dflt:"dash",editType:"none"}),spikemode:{valType:"flaglist",flags:["toaxis","across","marker"],dflt:"toaxis",editType:"none"},spikesnap:{valType:"enumerated",values:["data","cursor","hovered data"],dflt:"data",editType:"none"},tickfont:tt({editType:"ticks"}),tickangle:{valType:"angle",dflt:"auto",editType:"ticks"},tickprefix:{valType:"string",dflt:"",editType:"ticks"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},ticksuffix:{valType:"string",dflt:"",editType:"ticks"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"ticks"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"ticks"},minexponent:{valType:"number",dflt:3,min:0,editType:"ticks"},separatethousands:{valType:"boolean",dflt:!1,editType:"ticks"},tickformat:{valType:"string",dflt:"",editType:"ticks"},tickformatstops:it("tickformatstop",{enabled:{valType:"boolean",dflt:!0,editType:"ticks"},dtickrange:{valType:"info_array",items:[{valType:"any",editType:"ticks"},{valType:"any",editType:"ticks"}],editType:"ticks"},value:{valType:"string",dflt:"",editType:"ticks"},editType:"ticks"}),hoverformat:{valType:"string",dflt:"",editType:"none"},showline:{valType:"boolean",dflt:!1,editType:"ticks+layoutstyle"},linecolor:{valType:"color",dflt:rt.defaultLine,editType:"layoutstyle"},linewidth:{valType:"number",min:0,dflt:1,editType:"ticks+layoutstyle"},showgrid:{valType:"boolean",editType:"ticks"},gridcolor:{valType:"color",dflt:rt.lightLine,editType:"ticks"},gridwidth:{valType:"number",min:0,dflt:1,editType:"ticks"},zeroline:{valType:"boolean",editType:"ticks"},zerolinecolor:{valType:"color",dflt:rt.defaultLine,editType:"ticks"},zerolinewidth:{valType:"number",dflt:1,editType:"ticks"},showdividers:{valType:"boolean",dflt:!0,editType:"ticks"},dividercolor:{valType:"color",dflt:rt.defaultLine,editType:"ticks"},dividerwidth:{valType:"number",dflt:1,editType:"ticks"},anchor:{valType:"enumerated",values:["free",dt.idRegex.x.toString(),dt.idRegex.y.toString()],editType:"plot"},side:{valType:"enumerated",values:["top","bottom","left","right"],editType:"plot"},overlaying:{valType:"enumerated",values:["free",dt.idRegex.x.toString(),dt.idRegex.y.toString()],editType:"plot"},layer:{valType:"enumerated",values:["above traces","below traces"],dflt:"above traces",editType:"plot"},domain:{valType:"info_array",items:[{valType:"number",min:0,max:1,editType:"plot"},{valType:"number",min:0,max:1,editType:"plot"}],dflt:[0,1],editType:"plot"},position:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array","total ascending","total descending","min ascending","min descending","max ascending","max descending","sum ascending","sum descending","mean ascending","mean descending","median ascending","median descending"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{autotick:{valType:"boolean",editType:"ticks"},title:{valType:"string",editType:"ticks"},titlefont:tt({editType:"ticks"})}}},{"../../components/color/attributes":642,"../../components/drawing/attributes":664,"../../constants/docs":748,"../../constants/numerical":753,"../../lib/extend":768,"../../plot_api/plot_template":817,"../font_attributes":856,"./constants":834}],843:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../components/color"),nt=Ne("../../components/fx/helpers").isUnifiedHover,at=Ne("../../components/fx/hovermode_defaults"),it=Ne("../../plot_api/plot_template"),ot=Ne("../layout_attributes"),dt=Ne("./layout_attributes"),ht=Ne("./type_defaults"),Dt=Ne("./axis_defaults"),Ot=Ne("./constraints"),Rt=Ne("./position_defaults"),Zt=Ne("./axis_ids"),er=Zt.id2name,dr=Zt.name2id,mr=Ne("./constants").AX_ID_PATTERN,xr=Ne("../../registry"),br=xr.traceIs,Ar=xr.getComponentMethod;function appendList(Ne,Ge,Qe){Array.isArray(Ne[Ge])?Ne[Ge].push(Qe):Ne[Ge]=[Qe]}Ge.exports=function(Ne,Ge,Qe){var xr,en,mn=Ge.autotypenumbers,xn={},kn={},Cn={},En={},Pn={},Dn={},In={},zn={},Bn={},Vn={};for(xr=0;xr<Qe.length;xr++){var Hn=Qe[xr];if(br(Hn,"cartesian")||br(Hn,"gl2d")){var qn,Yn;if(Hn.xaxis)qn=er(Hn.xaxis),appendList(xn,qn,Hn);else if(Hn.xaxes)for(en=0;en<Hn.xaxes.length;en++)appendList(xn,er(Hn.xaxes[en]),Hn);if(Hn.yaxis)Yn=er(Hn.yaxis),appendList(xn,Yn,Hn);else if(Hn.yaxes)for(en=0;en<Hn.yaxes.length;en++)appendList(xn,er(Hn.yaxes[en]),Hn);"funnel"===Hn.type?"h"===Hn.orientation?(qn&&(kn[qn]=!0),Yn&&(In[Yn]=!0)):Yn&&(Cn[Yn]=!0):"image"===Hn.type?(Yn&&(zn[Yn]=!0),qn&&(zn[qn]=!0)):(Yn&&(Pn[Yn]=!0,Dn[Yn]=!0),br(Hn,"carpet")&&("carpet"!==Hn.type||Hn._cheater)||qn&&(En[qn]=!0)),"carpet"===Hn.type&&Hn._cheater&&qn&&(kn[qn]=!0),br(Hn,"2dMap")&&(Bn[qn]=!0,Bn[Yn]=!0),br(Hn,"oriented")&&(Vn["h"===Hn.orientation?Yn:qn]=!0)}}var $n=Ge._subplots,ra=$n.xaxis,oa=$n.yaxis,pa=tt.simpleMap(ra,er),ga=tt.simpleMap(oa,er),ma=pa.concat(ga),_a=rt.background;ra.length&&oa.length&&(_a=tt.coerce(Ne,Ge,ot,"plot_bgcolor"));var Va,Wa,Qa,ti,ni,di=rt.combine(_a,Ge.paper_bgcolor);function newAxLayoutOut(){var Ne=xn[Va]||[];ni._traceIndices=Ne.map((function(Ne){return Ne._expandedIndex})),ni._annIndices=[],ni._shapeIndices=[],ni._imgIndices=[],ni._subplotsWith=[],ni._counterAxes=[],ni._name=ni._attr=Va,ni._id=Wa}function coerce(Ne,Ge){return tt.coerce(ti,ni,dt,Ne,Ge)}function coerce2(Ne,Ge){return tt.coerce2(ti,ni,dt,Ne,Ge)}function getCounterAxes(Ne){return"x"===Ne?oa:ra}function getOverlayableAxes(Ge,Qe){for(var tt="x"===Ge?pa:ga,rt=[],nt=0;nt<tt.length;nt++){var at=tt[nt];at===Qe||(Ne[at]||{}).overlaying||rt.push(dr(at))}return rt}var ji={x:getCounterAxes("x"),y:getCounterAxes("y")},Hi=ji.x.concat(ji.y),Yi={},uo=[];function addMissingMatchedAxis(){var Ne=ti.matches;mr.test(Ne)&&-1===Hi.indexOf(Ne)&&(Yi[Ne]=ti.type,uo=Object.keys(Yi))}var go=at(Ne,Ge,Qe),ns=nt(go);for(xr=0;xr<ma.length;xr++){Va=ma[xr],Wa=dr(Va),Qa=Va.charAt(0),tt.isPlainObject(Ne[Va])||(Ne[Va]={}),ti=Ne[Va],ni=it.newContainer(Ge,Va,Qa+"axis"),newAxLayoutOut();var as="x"===Qa&&!En[Va]&&kn[Va]||"y"===Qa&&!Pn[Va]&&Cn[Va],is="y"===Qa&&(!Dn[Va]&&In[Va]||zn[Va]),os={letter:Qa,font:Ge.font,outerTicks:Bn[Va],showGrid:!Vn[Va],data:xn[Va]||[],bgColor:di,calendar:Ge.calendar,automargin:!0,visibleDflt:as,reverseDflt:is,autotypenumbersDflt:mn,splomStash:((Ge._splomAxes||{})[Qa]||{})[Wa]};coerce("uirevision",Ge.uirevision),ht(ti,ni,coerce,os),Dt(ti,ni,coerce,os,Ge);var ss=ns&&Qa===go.charAt(0),cs=coerce2("spikecolor",ns?ni.color:void 0),ds=coerce2("spikethickness",ns?1.5:void 0),ms=coerce2("spikedash",ns?"dot":void 0),vs=coerce2("spikemode",ns?"across":void 0),_s=coerce2("spikesnap",ns?"hovered data":void 0);coerce("showspikes",!!(ss||cs||ds||ms||vs||_s))||(delete ni.spikecolor,delete ni.spikethickness,delete ni.spikedash,delete ni.spikemode,delete ni.spikesnap),Rt(ti,ni,coerce,{letter:Qa,counterAxes:ji[Qa],overlayableAxes:getOverlayableAxes(Qa,Va),grid:Ge.grid}),coerce("title.standoff"),addMissingMatchedAxis(),ni._input=ti}for(xr=0;xr<uo.length;){Wa=uo[xr++],Qa=(Va=er(Wa)).charAt(0),tt.isPlainObject(Ne[Va])||(Ne[Va]={}),ti=Ne[Va],ni=it.newContainer(Ge,Va,Qa+"axis"),newAxLayoutOut();var ws={letter:Qa,font:Ge.font,outerTicks:Bn[Va],showGrid:!Vn[Va],data:[],bgColor:di,calendar:Ge.calendar,automargin:!0,visibleDflt:!1,reverseDflt:!1,autotypenumbersDflt:mn,splomStash:((Ge._splomAxes||{})[Qa]||{})[Wa]};coerce("uirevision",Ge.uirevision),ni.type=Yi[Wa]||"linear",Dt(ti,ni,coerce,ws,Ge),Rt(ti,ni,coerce,{letter:Qa,counterAxes:ji[Qa],overlayableAxes:getOverlayableAxes(Qa,Va),grid:Ge.grid}),coerce("fixedrange"),addMissingMatchedAxis(),ni._input=ti}var Ts=Ar("rangeslider","handleDefaults"),ks=Ar("rangeselector","handleDefaults");for(xr=0;xr<pa.length;xr++)Va=pa[xr],ti=Ne[Va],ni=Ge[Va],Ts(Ne,Ge,Va),"date"===ni.type&&ks(ti,ni,Ge,ga,ni.calendar),coerce("fixedrange");for(xr=0;xr<ga.length;xr++){Va=ga[xr],ti=Ne[Va],ni=Ge[Va];var Cs=Ge[er(ni.anchor)];coerce("fixedrange",Ar("rangeslider","isVisible")(Cs))}Ot.handleDefaults(Ne,Ge,{axIds:Hi.concat(uo).sort(Zt.idSort),axHasImage:zn})}},{"../../components/color":643,"../../components/fx/helpers":679,"../../components/fx/hovermode_defaults":682,"../../lib":778,"../../plot_api/plot_template":817,"../../registry":911,"../layout_attributes":882,"./axis_defaults":830,"./axis_ids":831,"./constants":834,"./constraints":835,"./layout_attributes":842,"./position_defaults":845,"./type_defaults":853}],844:[function(Ne,Ge,Qe){"use strict";var tt=Ne("tinycolor2").mix,rt=Ne("../../components/color/attributes").lightFraction,nt=Ne("../../lib");Ge.exports=function(Ne,Ge,Qe,at){var it=(at=at||{}).dfltColor;function coerce2(Qe,tt){return nt.coerce2(Ne,Ge,at.attributes,Qe,tt)}var ot=coerce2("linecolor",it),dt=coerce2("linewidth");Qe("showline",at.showLine||!!ot||!!dt)||(delete Ge.linecolor,delete Ge.linewidth);var ht=coerce2("gridcolor",tt(it,at.bgColor,at.blend||rt).toRgbString()),Dt=coerce2("gridwidth");if(Qe("showgrid",at.showGrid||!!ht||!!Dt)||(delete Ge.gridcolor,delete Ge.gridwidth),!at.noZeroLine){var Ot=coerce2("zerolinecolor",it),Rt=coerce2("zerolinewidth");Qe("zeroline",at.showGrid||!!Ot||!!Rt)||(delete Ge.zerolinecolor,delete Ge.zerolinewidth)}}},{"../../components/color/attributes":642,"../../lib":778,tinycolor2:576}],845:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../lib");Ge.exports=function(Ne,Ge,Qe,nt){var at,it,ot,dt,ht=nt.counterAxes||[],Dt=nt.overlayableAxes||[],Ot=nt.letter,Rt=nt.grid;Rt&&(it=Rt._domains[Ot][Rt._axisMap[Ge._id]],at=Rt._anchors[Ge._id],it&&(ot=Rt[Ot+"side"].split(" ")[0],dt=Rt.domain[Ot]["right"===ot||"top"===ot?1:0])),it=it||[0,1],at=at||(tt(Ne.position)?"free":ht[0]||"free"),ot=ot||("x"===Ot?"bottom":"left"),dt=dt||0,"free"===rt.coerce(Ne,Ge,{anchor:{valType:"enumerated",values:["free"].concat(ht),dflt:at}},"anchor")&&Qe("position",dt),rt.coerce(Ne,Ge,{side:{valType:"enumerated",values:"x"===Ot?["bottom","top"]:["left","right"],dflt:ot}},"side");var Zt=!1;if(Dt.length&&(Zt=rt.coerce(Ne,Ge,{overlaying:{valType:"enumerated",values:[!1].concat(Dt),dflt:!1}},"overlaying")),!Zt){var er=Qe("domain",it);er[0]>er[1]-1/4096&&(Ge.domain=it),rt.noneOrAll(Ne.domain,Ge.domain,it)}return Qe("layer"),Ge}},{"../../lib":778,"fast-isnumeric":241}],846:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../constants/alignment").FROM_BL;Ge.exports=function(Ne,Ge,Qe){void 0===Qe&&(Qe=tt[Ne.constraintoward||"center"]);var rt=[Ne.r2l(Ne.range[0]),Ne.r2l(Ne.range[1])],nt=rt[0]+(rt[1]-rt[0])*Qe;Ne.range=Ne._input.range=[Ne.l2r(nt+(rt[0]-nt)*Ge),Ne.l2r(nt+(rt[1]-nt)*Ge)],Ne.setScale()}},{"../../constants/alignment":745}],847:[function(Ne,Ge,Qe){"use strict";var tt=Ne("polybooljs"),rt=Ne("../../registry"),nt=Ne("../../components/drawing").dashStyle,at=Ne("../../components/color"),it=Ne("../../components/fx"),ot=Ne("../../components/fx/helpers").makeEventData,dt=Ne("../../components/dragelement/helpers"),ht=dt.freeMode,Dt=dt.rectMode,Ot=dt.drawMode,Rt=dt.openMode,Zt=dt.selectMode,er=Ne("../../components/shapes/draw_newshape/display_outlines"),dr=Ne("../../components/shapes/draw_newshape/helpers").handleEllipse,mr=Ne("../../components/shapes/draw_newshape/newshapes"),xr=Ne("../../lib"),br=Ne("../../lib/polygon"),Ar=Ne("../../lib/throttle"),en=Ne("./axis_ids").getFromId,mn=Ne("../../lib/clear_gl_canvases"),xn=Ne("../../plot_api/subroutines").redrawReglTraces,kn=Ne("./constants"),Cn=kn.MINSELECT,En=br.filter,Pn=br.tester,Dn=Ne("./handle_outline").clearSelect,In=Ne("./helpers"),zn=In.p2r,Bn=In.axValue,Vn=In.getTransform;function prepSelect(Ne,Ge,Qe,tt,rt){var ot=ht(rt),dt=Dt(rt),mr=Rt(rt),br=Ot(rt),en=Zt(rt),mn="drawcircle"===rt,xn="drawline"===rt||mn,Dn=tt.gd,In=Dn._fullLayout,Hn=In._zoomlayer,qn=tt.element.getBoundingClientRect(),Yn=tt.plotinfo,$n=Vn(Yn),ra=Ge-qn.left,oa=Qe-qn.top;In._calcInverseTransform(Dn);var pa=xr.apply3DTransform(In._invTransform)(ra,oa);ra=pa[0],oa=pa[1];var ga,ma,_a,Va,Wa,Qa,ti,ni=In._invScaleX,di=In._invScaleY,ji=ra,Hi=oa,Yi="M"+ra+","+oa,uo=tt.xaxes[0]._length,go=tt.yaxes[0]._length,ns=tt.xaxes.concat(tt.yaxes),as=Ne.altKey&&!(Ot(rt)&&mr);coerceSelectionsCache(Ne,Dn,tt),ot&&(ga=En([[ra,oa]],kn.BENDPX));var is=Hn.selectAll("path.select-outline-"+Yn.id).data(br?[0]:[1,2]),os=In.newshape;is.enter().append("path").attr("class",(function(Ne){return"select-outline select-outline-"+Ne+" select-outline-"+Yn.id})).style(br?{opacity:os.opacity/2,fill:mr?void 0:os.fillcolor,stroke:os.line.color,"stroke-dasharray":nt(os.line.dash,os.line.width),"stroke-width":os.line.width+"px"}:{}).attr("fill-rule",os.fillrule).classed("cursor-move",!!br).attr("transform",$n).attr("d",Yi+"Z");var ss,cs=Hn.append("path").attr("class","zoombox-corners").style({fill:at.background,stroke:at.defaultLine,"stroke-width":1}).attr("transform",$n).attr("d","M0,0Z"),ds=In._uid+kn.SELECTID,ms=[],vs=determineSearchTraces(Dn,tt.xaxes,tt.yaxes,tt.subplot);function ascending(Ne,Ge){return Ne-Ge}ss=Yn.fillRangeItems?Yn.fillRangeItems:dt?function(Ne,Ge){var Qe=Ne.range={};for(Wa=0;Wa<ns.length;Wa++){var tt=ns[Wa],rt=tt._id.charAt(0);Qe[tt._id]=[zn(tt,Ge[rt+"min"]),zn(tt,Ge[rt+"max"])].sort(ascending)}}:function(Ne,Ge,Qe){var tt=Ne.lassoPoints={};for(Wa=0;Wa<ns.length;Wa++){var rt=ns[Wa];tt[rt._id]=Qe.filtered.map(Bn(rt))}},tt.moveFn=function(Ne,Ge){ji=Math.max(0,Math.min(uo,ni*Ne+ra)),Hi=Math.max(0,Math.min(go,di*Ge+oa));var Qe=Math.abs(ji-ra),rt=Math.abs(Hi-oa);if(dt){var nt,at,it;if(en){var ht=In.selectdirection;switch(nt="any"===ht?rt<Math.min(.6*Qe,Cn)?"h":Qe<Math.min(.6*rt,Cn)?"v":"d":ht){case"h":at=mn?go/2:0,it=go;break;case"v":at=mn?uo/2:0,it=uo}}if(br)switch(In.newshape.drawdirection){case"vertical":nt="h",at=mn?go/2:0,it=go;break;case"horizontal":nt="v",at=mn?uo/2:0,it=uo;break;case"ortho":Qe<rt?(nt="h",at=oa,it=Hi):(nt="v",at=ra,it=ji);break;default:nt="d"}"h"===nt?((Va=xn?dr(mn,[ji,at],[ji,it]):[[ra,at],[ra,it],[ji,it],[ji,at]]).xmin=xn?ji:Math.min(ra,ji),Va.xmax=xn?ji:Math.max(ra,ji),Va.ymin=Math.min(at,it),Va.ymax=Math.max(at,it),cs.attr("d","M"+Va.xmin+","+(oa-Cn)+"h-4v"+2*Cn+"h4ZM"+(Va.xmax-1)+","+(oa-Cn)+"h4v"+2*Cn+"h-4Z")):"v"===nt?((Va=xn?dr(mn,[at,Hi],[it,Hi]):[[at,oa],[at,Hi],[it,Hi],[it,oa]]).xmin=Math.min(at,it),Va.xmax=Math.max(at,it),Va.ymin=xn?Hi:Math.min(oa,Hi),Va.ymax=xn?Hi:Math.max(oa,Hi),cs.attr("d","M"+(ra-Cn)+","+Va.ymin+"v-4h"+2*Cn+"v4ZM"+(ra-Cn)+","+(Va.ymax-1)+"v4h"+2*Cn+"v-4Z")):"d"===nt&&((Va=xn?dr(mn,[ra,oa],[ji,Hi]):[[ra,oa],[ra,Hi],[ji,Hi],[ji,oa]]).xmin=Math.min(ra,ji),Va.xmax=Math.max(ra,ji),Va.ymin=Math.min(oa,Hi),Va.ymax=Math.max(oa,Hi),cs.attr("d","M0,0Z"))}else ot&&(ga.addPt([ji,Hi]),Va=ga.filtered);tt.selectionDefs&&tt.selectionDefs.length?(_a=mergePolygons(tt.mergedPolygons,Va,as),Va.subtract=as,ma=multiTester(tt.selectionDefs.concat([Va]))):(_a=[Va],ma=Pn(Va)),er(convertPoly(_a,mr),is,tt),en&&Ar.throttle(ds,kn.SELECTDELAY,(function(){var Ne;ms=[];var Ge,Qe=[];for(Wa=0;Wa<vs.length;Wa++)if(Ge=(Qa=vs[Wa])._module.selectPoints(Qa,ma),Qe.push(Ge),Ne=fillSelectionItem(Ge,Qa),ms.length)for(var rt=0;rt<Ne.length;rt++)ms.push(Ne[rt]);else ms=Ne;updateSelectedState(Dn,vs,ti={points:ms}),ss(ti,Va,ga),tt.gd.emit("plotly_selecting",ti)}))},tt.clickFn=function(Ne,Ge){if(cs.remove(),Dn._fullLayout._activeShapeIndex>=0)Dn._fullLayout._deactivateShape(Dn);else if(!br){var Qe=In.clickmode;Ar.done(ds).then((function(){if(Ar.clear(ds),2===Ne){for(is.remove(),Wa=0;Wa<vs.length;Wa++)(Qa=vs[Wa])._module.selectPoints(Qa,!1);updateSelectedState(Dn,vs),clearSelectionsCache(tt),Dn.emit("plotly_deselect",null)}else Qe.indexOf("select")>-1&&selectOnClick(Ge,Dn,tt.xaxes,tt.yaxes,tt.subplot,tt,is),"event"===Qe&&Dn.emit("plotly_selected",void 0);it.click(Dn,Ge)})).catch(xr.error)}},tt.doneFn=function(){cs.remove(),Ar.done(ds).then((function(){Ar.clear(ds),tt.gd.emit("plotly_selected",ti),Va&&tt.selectionDefs&&(Va.subtract=as,tt.selectionDefs.push(Va),tt.mergedPolygons.length=0,[].push.apply(tt.mergedPolygons,_a)),tt.doneFnCompleted&&tt.doneFnCompleted(ms)})).catch(xr.error),br&&clearSelectionsCache(tt)}}function selectOnClick(Ne,Ge,Qe,tt,rt,nt,at){var it,ot,dt,ht,Dt,Ot,Zt,dr,mr,xr=Ge._hoverdata,br=Ge._fullLayout.clickmode.indexOf("event")>-1,Ar=[];if(isHoverDataSet(xr)){coerceSelectionsCache(Ne,Ge,nt);var en=extractClickedPtInfo(xr,it=determineSearchTraces(Ge,Qe,tt,rt));if(en.pointNumbers.length>0?isOnlyThisBinSelected(it,en):isOnlyOnePointSelected(it)&&(Ot=isPointOrBinSelected(en))){for(at&&at.remove(),mr=0;mr<it.length;mr++)(ot=it[mr])._module.selectPoints(ot,!1);updateSelectedState(Ge,it),clearSelectionsCache(nt),br&&Ge.emit("plotly_deselect",null)}else{for(Zt=Ne.shiftKey&&(void 0!==Ot?Ot:isPointOrBinSelected(en)),dt=newPointSelectionDef(en.pointNumber,en.searchInfo,Zt),ht=multiTester(nt.selectionDefs.concat([dt])),mr=0;mr<it.length;mr++)if(Dt=fillSelectionItem(it[mr]._module.selectPoints(it[mr],ht),it[mr]),Ar.length)for(var mn=0;mn<Dt.length;mn++)Ar.push(Dt[mn]);else Ar=Dt;if(updateSelectedState(Ge,it,dr={points:Ar}),dt&&nt&&nt.selectionDefs.push(dt),at){var xn=nt.mergedPolygons,kn=Rt(nt.dragmode);er(convertPoly(xn,kn),at,nt)}br&&Ge.emit("plotly_selected",dr)}}}function newPointSelectionDef(Ne,Ge,Qe){return{pointNumber:Ne,searchInfo:Ge,subtract:Qe}}function isPointSelectionDef(Ne){return"pointNumber"in Ne&&"searchInfo"in Ne}function newPointNumTester(Ne){return{xmin:0,xmax:0,ymin:0,ymax:0,pts:[],contains:function(Ge,Qe,tt,rt){var nt=Ne.searchInfo.cd[0].trace._expandedIndex;return rt.cd[0].trace._expandedIndex===nt&&tt===Ne.pointNumber},isRect:!1,degenerate:!1,subtract:Ne.subtract}}function multiTester(Ne){for(var Ge=[],Qe=isPointSelectionDef(Ne[0])?0:Ne[0][0][0],tt=Qe,rt=isPointSelectionDef(Ne[0])?0:Ne[0][0][1],nt=rt,at=0;at<Ne.length;at++)if(isPointSelectionDef(Ne[at]))Ge.push(newPointNumTester(Ne[at]));else{var it=br.tester(Ne[at]);it.subtract=Ne[at].subtract,Ge.push(it),Qe=Math.min(Qe,it.xmin),tt=Math.max(tt,it.xmax),rt=Math.min(rt,it.ymin),nt=Math.max(nt,it.ymax)}function contains(Ne,Qe,tt,rt){for(var nt=!1,at=0;at<Ge.length;at++)Ge[at].contains(Ne,Qe,tt,rt)&&(nt=!1===Ge[at].subtract);return nt}return{xmin:Qe,xmax:tt,ymin:rt,ymax:nt,pts:[],contains:contains,isRect:!1,degenerate:!1}}function coerceSelectionsCache(Ne,Ge,Qe){Ge._fullLayout._drawing=!1;var tt=Ge._fullLayout,rt=Qe.plotinfo,nt=Qe.dragmode,at=tt._lastSelectedSubplot&&tt._lastSelectedSubplot===rt.id,it=(Ne.shiftKey||Ne.altKey)&&!(Ot(nt)&&Rt(nt));at&&it&&rt.selection&&rt.selection.selectionDefs&&!Qe.selectionDefs?(Qe.selectionDefs=rt.selection.selectionDefs,Qe.mergedPolygons=rt.selection.mergedPolygons):it&&rt.selection||clearSelectionsCache(Qe),at||(Dn(Ge),tt._lastSelectedSubplot=rt.id)}function clearSelectionsCache(Ne){var Ge=Ne.dragmode,Qe=Ne.plotinfo,tt=Ne.gd;if(tt._fullLayout._activeShapeIndex>=0&&tt._fullLayout._deactivateShape(tt),Ot(Ge)){var nt=tt._fullLayout._zoomlayer.selectAll(".select-outline-"+Qe.id);if(nt&&tt._fullLayout._drawing){var at=mr(nt,Ne);at&&rt.call("_guiRelayout",tt,{shapes:at}),tt._fullLayout._drawing=!1}}Qe.selection={},Qe.selection.selectionDefs=Ne.selectionDefs=[],Qe.selection.mergedPolygons=Ne.mergedPolygons=[]}function determineSearchTraces(Ne,Ge,Qe,tt){var rt,nt,at,it=[],ot=Ge.map((function(Ne){return Ne._id})),dt=Qe.map((function(Ne){return Ne._id}));for(at=0;at<Ne.calcdata.length;at++)if(!0===(nt=(rt=Ne.calcdata[at])[0].trace).visible&&nt._module&&nt._module.selectPoints)if(!tt||nt.subplot!==tt&&nt.geo!==tt)if("splom"===nt.type&&nt._xaxes[ot[0]]&&nt._yaxes[dt[0]]){var ht=createSearchInfo(nt._module,rt,Ge[0],Qe[0]);ht.scene=Ne._fullLayout._splomScenes[nt.uid],it.push(ht)}else if("sankey"===nt.type){var Dt=createSearchInfo(nt._module,rt,Ge[0],Qe[0]);it.push(Dt)}else{if(-1===ot.indexOf(nt.xaxis))continue;if(-1===dt.indexOf(nt.yaxis))continue;it.push(createSearchInfo(nt._module,rt,en(Ne,nt.xaxis),en(Ne,nt.yaxis)))}else it.push(createSearchInfo(nt._module,rt,Ge[0],Qe[0]));return it;function createSearchInfo(Ne,Ge,Qe,tt){return{_module:Ne,cd:Ge,xaxis:Qe,yaxis:tt}}}function isHoverDataSet(Ne){return Ne&&Array.isArray(Ne)&&!0!==Ne[0].hoverOnBox}function extractClickedPtInfo(Ne,Ge){var Qe,tt,rt=Ne[0],nt=-1,at=[];for(tt=0;tt<Ge.length;tt++)if(Qe=Ge[tt],rt.fullData._expandedIndex===Qe.cd[0].trace._expandedIndex){if(!0===rt.hoverOnBox)break;void 0!==rt.pointNumber?nt=rt.pointNumber:void 0!==rt.binNumber&&(nt=rt.binNumber,at=rt.pointNumbers);break}return{pointNumber:nt,pointNumbers:at,searchInfo:Qe}}function isPointOrBinSelected(Ne){var Ge=Ne.searchInfo.cd[0].trace,Qe=Ne.pointNumber,tt=Ne.pointNumbers,rt=tt.length>0?tt[0]:Qe;return!!Ge.selectedpoints&&Ge.selectedpoints.indexOf(rt)>-1}function isOnlyThisBinSelected(Ne,Ge){var Qe,tt,rt,nt=[];for(rt=0;rt<Ne.length;rt++)(Qe=Ne[rt]).cd[0].trace.selectedpoints&&Qe.cd[0].trace.selectedpoints.length>0&&nt.push(Qe);if(1===nt.length&&nt[0]===Ge.searchInfo&&(tt=Ge.searchInfo.cd[0].trace).selectedpoints.length===Ge.pointNumbers.length){for(rt=0;rt<Ge.pointNumbers.length;rt++)if(tt.selectedpoints.indexOf(Ge.pointNumbers[rt])<0)return!1;return!0}return!1}function isOnlyOnePointSelected(Ne){var Ge,Qe,tt=0;for(Qe=0;Qe<Ne.length;Qe++)if((Ge=Ne[Qe].cd[0].trace).selectedpoints){if(Ge.selectedpoints.length>1)return!1;if((tt+=Ge.selectedpoints.length)>1)return!1}return 1===tt}function updateSelectedState(Ne,Ge,Qe){var tt,nt,at,it;for(tt=0;tt<Ge.length;tt++){var ot=Ge[tt].cd[0].trace._fullInput,dt=Ne._fullLayout._tracePreGUI[ot.uid]||{};void 0===dt.selectedpoints&&(dt.selectedpoints=ot._input.selectedpoints||null)}if(Qe){var ht=Qe.points||[];for(tt=0;tt<Ge.length;tt++)(it=Ge[tt].cd[0].trace)._input.selectedpoints=it._fullInput.selectedpoints=[],it._fullInput!==it&&(it.selectedpoints=[]);for(tt=0;tt<ht.length;tt++){var Dt=ht[tt],Ot=Dt.data,Rt=Dt.fullData;Dt.pointIndices?([].push.apply(Ot.selectedpoints,Dt.pointIndices),it._fullInput!==it&&[].push.apply(Rt.selectedpoints,Dt.pointIndices)):(Ot.selectedpoints.push(Dt.pointIndex),it._fullInput!==it&&Rt.selectedpoints.push(Dt.pointIndex))}}else for(tt=0;tt<Ge.length;tt++)delete(it=Ge[tt].cd[0].trace).selectedpoints,delete it._input.selectedpoints,it._fullInput!==it&&delete it._fullInput.selectedpoints;var Zt=!1;for(tt=0;tt<Ge.length;tt++){it=(at=(nt=Ge[tt]).cd)[0].trace,rt.traceIs(it,"regl")&&(Zt=!0);var er=nt._module,dr=er.styleOnSelect||er.style;dr&&(dr(Ne,at,at[0].node3),at[0].nodeRangePlot3&&dr(Ne,at,at[0].nodeRangePlot3))}Zt&&(mn(Ne),xn(Ne))}function mergePolygons(Ne,Ge,Qe){return Qe?tt.difference({regions:Ne,inverted:!1},{regions:[Ge],inverted:!1}).regions:tt.union({regions:Ne,inverted:!1},{regions:[Ge],inverted:!1}).regions}function fillSelectionItem(Ne,Ge){if(Array.isArray(Ne))for(var Qe=Ge.cd,tt=Ge.cd[0].trace,rt=0;rt<Ne.length;rt++)Ne[rt]=ot(Ne[rt],tt,Qe);return Ne}function convertPoly(Ne,Ge){for(var Qe=[],tt=0;tt<Ne.length;tt++){Qe[tt]=[];for(var rt=0;rt<Ne[tt].length;rt++){Qe[tt][rt]=[],Qe[tt][rt][0]=rt?"L":"M";for(var nt=0;nt<Ne[tt][rt].length;nt++)Qe[tt][rt].push(Ne[tt][rt][nt])}Ge||Qe[tt].push(["Z",Qe[tt][0][1],Qe[tt][0][2]])}return Qe}Ge.exports={prepSelect:prepSelect,clearSelect:Dn,clearSelectionsCache:clearSelectionsCache,selectOnClick:selectOnClick}},{"../../components/color":643,"../../components/dragelement/helpers":661,"../../components/drawing":665,"../../components/fx":683,"../../components/fx/helpers":679,"../../components/shapes/draw_newshape/display_outlines":728,"../../components/shapes/draw_newshape/helpers":729,"../../components/shapes/draw_newshape/newshapes":730,"../../lib":778,"../../lib/clear_gl_canvases":762,"../../lib/polygon":790,"../../lib/throttle":804,"../../plot_api/subroutines":818,"../../registry":911,"./axis_ids":831,"./constants":834,"./handle_outline":838,"./helpers":839,polybooljs:517}],848:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("d3-time-format").utcFormat,nt=Ne("fast-isnumeric"),at=Ne("../../lib"),it=at.cleanNumber,ot=at.ms2DateTime,dt=at.dateTime2ms,ht=at.ensureNumber,Dt=at.isArrayOrTypedArray,Ot=Ne("../../constants/numerical"),Rt=Ot.FP_SAFE,Zt=Ot.BADNUM,er=Ot.LOG_CLIP,dr=Ot.ONEWEEK,mr=Ot.ONEDAY,xr=Ot.ONEHOUR,br=Ot.ONEMIN,Ar=Ot.ONESEC,en=Ne("./axis_ids"),mn=Ne("./constants"),xn=mn.HOUR_PATTERN,kn=mn.WEEKDAY_PATTERN;function fromLog(Ne){return Math.pow(10,Ne)}function isValidCategory(Ne){return null!=Ne}Ge.exports=function(Ne,Ge){Ge=Ge||{};var Qe=Ne._id||"x",Ot=Qe.charAt(0);function toLog(Ge,Qe){if(Ge>0)return Math.log(Ge)/Math.LN10;if(Ge<=0&&Qe&&Ne.range&&2===Ne.range.length){var tt=Ne.range[0],rt=Ne.range[1];return.5*(tt+rt-2*er*Math.abs(tt-rt))}return Zt}function dt2ms(Ge,Qe,tt,rt){if((rt||{}).msUTC&&nt(Ge))return+Ge;var it=dt(Ge,tt||Ne.calendar);if(it===Zt){if(!nt(Ge))return Zt;Ge=+Ge;var ot=Math.floor(10*at.mod(Ge+.05,1)),ht=Math.round(Ge-ot/10);it=dt(new Date(ht))+ot/10}return it}function ms2dt(Ge,Qe,tt){return ot(Ge,Qe,tt||Ne.calendar)}function getCategoryName(Ge){return Ne._categories[Math.round(Ge)]}function setCategoryIndex(Ge){if(isValidCategory(Ge)){if(void 0===Ne._categoriesMap&&(Ne._categoriesMap={}),void 0!==Ne._categoriesMap[Ge])return Ne._categoriesMap[Ge];Ne._categories.push("number"==typeof Ge?String(Ge):Ge);var Qe=Ne._categories.length-1;return Ne._categoriesMap[Ge]=Qe,Qe}return Zt}function setMultiCategoryIndex(Ne,Ge){for(var Qe=new Array(Ge),tt=0;tt<Ge;tt++){var rt=(Ne[0]||[])[tt],nt=(Ne[1]||[])[tt];Qe[tt]=getCategoryIndex([rt,nt])}return Qe}function getCategoryIndex(Ge){if(Ne._categoriesMap)return Ne._categoriesMap[Ge]}function getCategoryPosition(Ne){var Ge=getCategoryIndex(Ne);return void 0!==Ge?Ge:nt(Ne)?+Ne:void 0}function getRangePosition(Ne){return nt(Ne)?+Ne:getCategoryIndex(Ne)}function _l2p(Ne,Ge,Qe){return tt.round(Qe+Ge*Ne,2)}function _p2l(Ne,Ge,Qe){return(Ne-Qe)/Ge}var l2p=function(Ge){return nt(Ge)?_l2p(Ge,Ne._m,Ne._b):Zt},p2l=function(Ge){return _p2l(Ge,Ne._m,Ne._b)};if(Ne.rangebreaks){var Cn="y"===Ot;l2p=function(Ge){if(!nt(Ge))return Zt;var Qe=Ne._rangebreaks.length;if(!Qe)return _l2p(Ge,Ne._m,Ne._b);var tt=Cn;Ne.range[0]>Ne.range[1]&&(tt=!tt);for(var rt=tt?-1:1,at=rt*Ge,it=0,ot=0;ot<Qe;ot++){var dt=rt*Ne._rangebreaks[ot].min,ht=rt*Ne._rangebreaks[ot].max;if(at<dt)break;if(!(at>ht)){it=at<(dt+ht)/2?ot:ot+1;break}it=ot+1}var Dt=Ne._B[it]||0;return isFinite(Dt)?_l2p(Ge,Ne._m2,Dt):0},p2l=function(Ge){var Qe=Ne._rangebreaks.length;if(!Qe)return _p2l(Ge,Ne._m,Ne._b);for(var tt=0,rt=0;rt<Qe&&!(Ge<Ne._rangebreaks[rt].pmin);rt++)Ge>Ne._rangebreaks[rt].pmax&&(tt=rt+1);return _p2l(Ge,Ne._m2,Ne._B[tt])}}Ne.c2l="log"===Ne.type?toLog:ht,Ne.l2c="log"===Ne.type?fromLog:ht,Ne.l2p=l2p,Ne.p2l=p2l,Ne.c2p="log"===Ne.type?function(Ne,Ge){return l2p(toLog(Ne,Ge))}:l2p,Ne.p2c="log"===Ne.type?function(Ne){return fromLog(p2l(Ne))}:p2l,-1!==["linear","-"].indexOf(Ne.type)?(Ne.d2r=Ne.r2d=Ne.d2c=Ne.r2c=Ne.d2l=Ne.r2l=it,Ne.c2d=Ne.c2r=Ne.l2d=Ne.l2r=ht,Ne.d2p=Ne.r2p=function(Ge){return Ne.l2p(it(Ge))},Ne.p2d=Ne.p2r=p2l,Ne.cleanPos=ht):"log"===Ne.type?(Ne.d2r=Ne.d2l=function(Ne,Ge){return toLog(it(Ne),Ge)},Ne.r2d=Ne.r2c=function(Ne){return fromLog(it(Ne))},Ne.d2c=Ne.r2l=it,Ne.c2d=Ne.l2r=ht,Ne.c2r=toLog,Ne.l2d=fromLog,Ne.d2p=function(Ge,Qe){return Ne.l2p(Ne.d2r(Ge,Qe))},Ne.p2d=function(Ne){return fromLog(p2l(Ne))},Ne.r2p=function(Ge){return Ne.l2p(it(Ge))},Ne.p2r=p2l,Ne.cleanPos=ht):"date"===Ne.type?(Ne.d2r=Ne.r2d=at.identity,Ne.d2c=Ne.r2c=Ne.d2l=Ne.r2l=dt2ms,Ne.c2d=Ne.c2r=Ne.l2d=Ne.l2r=ms2dt,Ne.d2p=Ne.r2p=function(Ge,Qe,tt){return Ne.l2p(dt2ms(Ge,0,tt))},Ne.p2d=Ne.p2r=function(Ne,Ge,Qe){return ms2dt(p2l(Ne),Ge,Qe)},Ne.cleanPos=function(Ge){return at.cleanDate(Ge,Zt,Ne.calendar)}):"category"===Ne.type?(Ne.d2c=Ne.d2l=setCategoryIndex,Ne.r2d=Ne.c2d=Ne.l2d=getCategoryName,Ne.d2r=Ne.d2l_noadd=getCategoryPosition,Ne.r2c=function(Ge){var Qe=getRangePosition(Ge);return void 0!==Qe?Qe:Ne.fraction2r(.5)},Ne.l2r=Ne.c2r=ht,Ne.r2l=getRangePosition,Ne.d2p=function(Ge){return Ne.l2p(Ne.r2c(Ge))},Ne.p2d=function(Ne){return getCategoryName(p2l(Ne))},Ne.r2p=Ne.d2p,Ne.p2r=p2l,Ne.cleanPos=function(Ne){return"string"==typeof Ne&&""!==Ne?Ne:ht(Ne)}):"multicategory"===Ne.type&&(Ne.r2d=Ne.c2d=Ne.l2d=getCategoryName,Ne.d2r=Ne.d2l_noadd=getCategoryPosition,Ne.r2c=function(Ge){var Qe=getCategoryPosition(Ge);return void 0!==Qe?Qe:Ne.fraction2r(.5)},Ne.r2c_just_indices=getCategoryIndex,Ne.l2r=Ne.c2r=ht,Ne.r2l=getCategoryPosition,Ne.d2p=function(Ge){return Ne.l2p(Ne.r2c(Ge))},Ne.p2d=function(Ne){return getCategoryName(p2l(Ne))},Ne.r2p=Ne.d2p,Ne.p2r=p2l,Ne.cleanPos=function(Ne){return Array.isArray(Ne)||"string"==typeof Ne&&""!==Ne?Ne:ht(Ne)},Ne.setupMultiCategory=function(tt){var rt,nt,it=Ne._traceIndices,ot=Ne._matchGroup;if(ot&&0===Ne._categories.length)for(var dt in ot)if(dt!==Qe){var ht=Ge[en.id2name(dt)];it=it.concat(ht._traceIndices)}var Rt=[[0,{}],[0,{}]],Zt=[];for(rt=0;rt<it.length;rt++){var er=tt[it[rt]];if(Ot in er){var dr=er[Ot],mr=er._length||at.minRowLength(dr);if(Dt(dr[0])&&Dt(dr[1]))for(nt=0;nt<mr;nt++){var xr=dr[0][nt],br=dr[1][nt];isValidCategory(xr)&&isValidCategory(br)&&(Zt.push([xr,br]),xr in Rt[0][1]||(Rt[0][1][xr]=Rt[0][0]++),br in Rt[1][1]||(Rt[1][1][br]=Rt[1][0]++))}}}for(Zt.sort((function(Ne,Ge){var Qe=Rt[0][1],tt=Qe[Ne[0]]-Qe[Ge[0]];if(tt)return tt;var rt=Rt[1][1];return rt[Ne[1]]-rt[Ge[1]]})),rt=0;rt<Zt.length;rt++)setCategoryIndex(Zt[rt])}),Ne.fraction2r=function(Ge){var Qe=Ne.r2l(Ne.range[0]),tt=Ne.r2l(Ne.range[1]);return Ne.l2r(Qe+Ge*(tt-Qe))},Ne.r2fraction=function(Ge){var Qe=Ne.r2l(Ne.range[0]),tt=Ne.r2l(Ne.range[1]);return(Ne.r2l(Ge)-Qe)/(tt-Qe)},Ne.cleanRange=function(Ge,Qe){Qe||(Qe={}),Ge||(Ge="range");var tt,rt,it=at.nestedProperty(Ne,Ge).get();if(rt=(rt="date"===Ne.type?at.dfltRange(Ne.calendar):"y"===Ot?mn.DFLTRANGEY:Qe.dfltRange||mn.DFLTRANGEX).slice(),"tozero"!==Ne.rangemode&&"nonnegative"!==Ne.rangemode||(rt[0]=0),it&&2===it.length)for("date"!==Ne.type||Ne.autorange||(it[0]=at.cleanDate(it[0],Zt,Ne.calendar),it[1]=at.cleanDate(it[1],Zt,Ne.calendar)),tt=0;tt<2;tt++)if("date"===Ne.type){if(!at.isDateTime(it[tt],Ne.calendar)){Ne[Ge]=rt;break}if(Ne.r2l(it[0])===Ne.r2l(it[1])){var ot=at.constrain(Ne.r2l(it[0]),at.MIN_MS+1e3,at.MAX_MS-1e3);it[0]=Ne.l2r(ot-1e3),it[1]=Ne.l2r(ot+1e3);break}}else{if(!nt(it[tt])){if(!nt(it[1-tt])){Ne[Ge]=rt;break}it[tt]=it[1-tt]*(tt?10:.1)}if(it[tt]<-Rt?it[tt]=-Rt:it[tt]>Rt&&(it[tt]=Rt),it[0]===it[1]){var dt=Math.max(1,Math.abs(1e-6*it[0]));it[0]-=dt,it[1]+=dt}}else at.nestedProperty(Ne,Ge).set(rt)},Ne.setScale=function(Qe){var tt=Ge._size;if(Ne.overlaying){var rt=en.getFromId({_fullLayout:Ge},Ne.overlaying);Ne.domain=rt.domain}var nt=Qe&&Ne._r?"_r":"range",at=Ne.calendar;Ne.cleanRange(nt);var it,ot,dt=Ne.r2l(Ne[nt][0],at),ht=Ne.r2l(Ne[nt][1],at),Dt="y"===Ot;if(Dt?(Ne._offset=tt.t+(1-Ne.domain[1])*tt.h,Ne._length=tt.h*(Ne.domain[1]-Ne.domain[0]),Ne._m=Ne._length/(dt-ht),Ne._b=-Ne._m*ht):(Ne._offset=tt.l+Ne.domain[0]*tt.w,Ne._length=tt.w*(Ne.domain[1]-Ne.domain[0]),Ne._m=Ne._length/(ht-dt),Ne._b=-Ne._m*dt),Ne._rangebreaks=[],Ne._lBreaks=0,Ne._m2=0,Ne._B=[],Ne.rangebreaks&&(Ne._rangebreaks=Ne.locateBreaks(Math.min(dt,ht),Math.max(dt,ht)),Ne._rangebreaks.length)){for(it=0;it<Ne._rangebreaks.length;it++)ot=Ne._rangebreaks[it],Ne._lBreaks+=Math.abs(ot.max-ot.min);var Rt=Dt;dt>ht&&(Rt=!Rt),Rt&&Ne._rangebreaks.reverse();var Zt=Rt?-1:1;for(Ne._m2=Zt*Ne._length/(Math.abs(ht-dt)-Ne._lBreaks),Ne._B.push(-Ne._m2*(Dt?ht:dt)),it=0;it<Ne._rangebreaks.length;it++)ot=Ne._rangebreaks[it],Ne._B.push(Ne._B[Ne._B.length-1]-Zt*Ne._m2*(ot.max-ot.min));for(it=0;it<Ne._rangebreaks.length;it++)(ot=Ne._rangebreaks[it]).pmin=l2p(ot.min),ot.pmax=l2p(ot.max)}if(!isFinite(Ne._m)||!isFinite(Ne._b)||Ne._length<0)throw Ge._replotting=!1,new Error("Something went wrong with axis scaling")},Ne.maskBreaks=function(Ge){for(var Qe,tt,rt,nt,ot,dt=Ne.rangebreaks||[],ht=0;ht<dt.length;ht++){var Dt=dt[ht];if(Dt.enabled)if(Dt.bounds){var Ot=Dt.pattern;switch(tt=(Qe=at.simpleMap(Dt.bounds,Ot?it:Ne.d2c))[0],rt=Qe[1],Ot){case kn:nt=(ot=new Date(Ge)).getUTCDay(),tt>rt&&(rt+=7,nt<tt&&(nt+=7));break;case xn:nt=(ot=new Date(Ge)).getUTCHours()+(ot.getUTCMinutes()/60+ot.getUTCSeconds()/3600+ot.getUTCMilliseconds()/36e5),tt>rt&&(rt+=24,nt<tt&&(nt+=24));break;case"":nt=Ge}if(nt>=tt&&nt<rt)return Zt}else for(var Rt=at.simpleMap(Dt.values,Ne.d2c).sort(at.sorterAsc),er=0;er<Rt.length;er++)if(rt=(tt=Rt[er])+Dt.dvalue,Ge>=tt&&Ge<rt)return Zt}return Ge},Ne.locateBreaks=function(Ge,Qe){var tt,rt,nt,ot,dt=[];if(!Ne.rangebreaks)return dt;var ht=Ne.rangebreaks.slice().sort((function(Ne,Ge){return Ne.pattern===kn&&Ge.pattern===xn?-1:Ge.pattern===kn&&Ne.pattern===xn?1:0})),addBreak=function(Ne,tt){if((Ne=at.constrain(Ne,Ge,Qe))!==(tt=at.constrain(tt,Ge,Qe))){for(var rt=!0,nt=0;nt<dt.length;nt++){var it=dt[nt];Ne<it.max&&tt>=it.min&&(Ne<it.min&&(it.min=Ne),tt>it.max&&(it.max=tt),rt=!1)}rt&&dt.push({min:Ne,max:tt})}};for(tt=0;tt<ht.length;tt++){var Dt=ht[tt];if(Dt.enabled)if(Dt.bounds){var Ot=Ge,Rt=Qe;Dt.pattern&&(Ot=Math.floor(Ot)),nt=(rt=at.simpleMap(Dt.bounds,Dt.pattern?it:Ne.r2l))[0],ot=rt[1];var Zt,er,en=new Date(Ot);switch(Dt.pattern){case kn:er=dr,Zt=(ot-nt+(ot<nt?7:0))*mr,Ot+=nt*mr-(en.getUTCDay()*mr+en.getUTCHours()*xr+en.getUTCMinutes()*br+en.getUTCSeconds()*Ar+en.getUTCMilliseconds());break;case xn:er=mr,Zt=(ot-nt+(ot<nt?24:0))*xr,Ot+=nt*xr-(en.getUTCHours()*xr+en.getUTCMinutes()*br+en.getUTCSeconds()*Ar+en.getUTCMilliseconds());break;default:Ot=Math.min(rt[0],rt[1]),Zt=er=(Rt=Math.max(rt[0],rt[1]))-Ot}for(var mn=Ot;mn<Rt;mn+=er)addBreak(mn,mn+Zt)}else for(var Cn=at.simpleMap(Dt.values,Ne.d2c),En=0;En<Cn.length;En++)addBreak(nt=Cn[En],ot=nt+Dt.dvalue)}return dt.sort((function(Ne,Ge){return Ne.min-Ge.min})),dt},Ne.makeCalcdata=function(Ge,Qe,tt){var rt,nt,it,ot,dt=Ne.type,ht="date"===dt&&Ge[Qe+"calendar"];if(Qe in Ge){if(rt=Ge[Qe],ot=Ge._length||at.minRowLength(rt),at.isTypedArray(rt)&&("linear"===dt||"log"===dt)){if(ot===rt.length)return rt;if(rt.subarray)return rt.subarray(0,ot)}if("multicategory"===dt)return setMultiCategoryIndex(rt,ot);for(nt=new Array(ot),it=0;it<ot;it++)nt[it]=Ne.d2c(rt[it],0,ht,tt)}else{var Dt=Qe+"0"in Ge?Ne.d2c(Ge[Qe+"0"],0,ht):0,Ot=Ge["d"+Qe]?Number(Ge["d"+Qe]):1;for(rt=Ge[{x:"y",y:"x"}[Qe]],ot=Ge._length||rt.length,nt=new Array(ot),it=0;it<ot;it++)nt[it]=Dt+it*Ot}if(Ne.rangebreaks)for(it=0;it<ot;it++)nt[it]=Ne.maskBreaks(nt[it]);return nt},Ne.isValidRange=function(Ge){return Array.isArray(Ge)&&2===Ge.length&&nt(Ne.r2l(Ge[0]))&&nt(Ne.r2l(Ge[1]))},Ne.isPtWithinRange=function(Ge,Qe){var tt=Ne.c2l(Ge[Ot],null,Qe),rt=Ne.r2l(Ne.range[0]),nt=Ne.r2l(Ne.range[1]);return rt<nt?rt<=tt&&tt<=nt:nt<=tt&&tt<=rt},Ne._emptyCategories=function(){Ne._categories=[],Ne._categoriesMap={}},Ne.clearCalc=function(){var Qe=Ne._matchGroup;if(Qe){var tt=null,rt=null;for(var nt in Qe){var at=Ge[en.id2name(nt)];if(at._categories){tt=at._categories,rt=at._categoriesMap;break}}tt&&rt?(Ne._categories=tt,Ne._categoriesMap=rt):Ne._emptyCategories()}else Ne._emptyCategories();if(Ne._initialCategories)for(var it=0;it<Ne._initialCategories.length;it++)setCategoryIndex(Ne._initialCategories[it])},Ne.sortByInitialCategories=function(){var tt=[];if(Ne._emptyCategories(),Ne._initialCategories)for(var rt=0;rt<Ne._initialCategories.length;rt++)setCategoryIndex(Ne._initialCategories[rt]);tt=tt.concat(Ne._traceIndices);var nt=Ne._matchGroup;for(var at in nt)if(Qe!==at){var it=Ge[en.id2name(at)];it._categories=Ne._categories,it._categoriesMap=Ne._categoriesMap,tt=tt.concat(it._traceIndices)}return tt};var En=Ge._d3locale;"date"===Ne.type&&(Ne._dateFormat=En?En.timeFormat:rt,Ne._extraFormat=Ge._extraFormat),Ne._separators=Ge.separators,Ne._numFormat=En?En.numberFormat:tt.format,delete Ne._minDtick,delete Ne._forceTick0}},{"../../constants/numerical":753,"../../lib":778,"./axis_ids":831,"./constants":834,d3:169,"d3-time-format":166,"fast-isnumeric":241}],849:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../components/color").contrast,nt=Ne("./layout_attributes"),at=Ne("../array_container_defaults");function handlePrefixSuffix(Ne,Ge,Qe,tt,rt){var nt=getShowAttrDflt(Ne);Qe("tickprefix")&&Qe("showtickprefix",nt),Qe("ticksuffix",rt.tickSuffixDflt)&&Qe("showticksuffix",nt)}function handleOtherDefaults(Ne,Ge,Qe,it,ot){var dt=getShowAttrDflt(Ne);if(Qe("tickprefix")&&Qe("showtickprefix",dt),Qe("ticksuffix",ot.tickSuffixDflt)&&Qe("showticksuffix",dt),Qe("showticklabels")){var ht=ot.font||{},Dt=Ge.color,Ot=-1!==(Ge.ticklabelposition||"").indexOf("inside")?rt(ot.bgColor):Dt&&Dt!==nt.color.dflt?Dt:ht.color;if(tt.coerceFont(Qe,"tickfont",{family:ht.family,size:ht.size,color:Ot}),Qe("tickangle"),"category"!==it){var Rt=Qe("tickformat");at(Ne,Ge,{name:"tickformatstops",inclusionAttr:"enabled",handleItemDefaults:tickformatstopDefaults}),Ge.tickformatstops.length||delete Ge.tickformatstops,Rt||"date"===it||(Qe("showexponent",dt),Qe("exponentformat"),Qe("minexponent"),Qe("separatethousands"))}}}function getShowAttrDflt(Ne){var Ge=["showexponent","showtickprefix","showticksuffix"].filter((function(Ge){return void 0!==Ne[Ge]})),sameVal=function(Qe){return Ne[Qe]===Ne[Ge[0]]};if(Ge.every(sameVal)||1===Ge.length)return Ne[Ge[0]]}function tickformatstopDefaults(Ne,Ge){function coerce(Qe,rt){return tt.coerce(Ne,Ge,nt.tickformatstops,Qe,rt)}coerce("enabled")&&(coerce("dtickrange"),coerce("value"))}Ge.exports=function(Ne,Ge,Qe,tt,rt,nt){nt&&1!==nt.pass||handlePrefixSuffix(Ne,Ge,Qe,tt,rt),nt&&2!==nt.pass||handleOtherDefaults(Ne,Ge,Qe,tt,rt)}},{"../../components/color":643,"../../lib":778,"../array_container_defaults":823,"./layout_attributes":842}],850:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./layout_attributes");Ge.exports=function(Ne,Ge,Qe,nt){var at=tt.coerce2(Ne,Ge,rt,"ticklen"),it=tt.coerce2(Ne,Ge,rt,"tickwidth"),ot=tt.coerce2(Ne,Ge,rt,"tickcolor",Ge.color);Qe("ticks",nt.outerTicks||at||it||ot?"outside":"")||(delete Ge.ticklen,delete Ge.tickwidth,delete Ge.tickcolor)}},{"../../lib":778,"./layout_attributes":842}],851:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./clean_ticks"),rt=Ne("../../lib").isArrayOrTypedArray;Ge.exports=function(Ne,Ge,Qe,nt){function readInput(Qe){var tt=Ne[Qe];return void 0!==tt?tt:(Ge._template||{})[Qe]}var at=readInput("tick0"),it=readInput("dtick"),ot=readInput("tickvals"),dt=Qe("tickmode",rt(ot)?"array":it?"linear":"auto");if("auto"===dt)Qe("nticks");else if("linear"===dt){var ht=Ge.dtick=tt.dtick(it,nt);Ge.tick0=tt.tick0(at,nt,Ge.calendar,ht)}else"multicategory"!==nt&&(void 0===Qe("tickvals")?Ge.tickmode="auto":Qe("ticktext"))}},{"../../lib":778,"./clean_ticks":833}],852:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../registry"),nt=Ne("../../lib"),at=Ne("../../components/drawing"),it=Ne("./axes");Ge.exports=function(Ne,Ge,Qe,ot){var dt=Ne._fullLayout;if(0!==Ge.length){var ht,Dt,Ot,Rt;ot&&(ht=ot());var Zt=tt.ease(Qe.easing);return Ne._transitionData._interruptCallbacks.push((function(){return window.cancelAnimationFrame(Rt),Rt=null,transitionInterrupt()})),Dt=Date.now(),Rt=window.requestAnimationFrame(doFrame),Promise.resolve()}function unsetSubplotTransform(Ne){var Ge=Ne.xaxis,Qe=Ne.yaxis;dt._defs.select("#"+Ne.clipId+"> rect").call(at.setTranslate,0,0).call(at.setScale,1,1),Ne.plot.call(at.setTranslate,Ge._offset,Qe._offset).call(at.setScale,1,1);var tt=Ne.plot.selectAll(".scatterlayer .trace");tt.selectAll(".point").call(at.setPointGroupScale,1,1),tt.selectAll(".textpoint").call(at.setTextPointsScale,1,1),tt.call(at.hideOutsideRangePoints,Ne)}function updateSubplot(Ge,Qe){var tt=Ge.plotinfo,rt=tt.xaxis,ot=tt.yaxis,dt=rt._length,ht=ot._length,Dt=!!Ge.xr1,Ot=!!Ge.yr1,Rt=[];if(Dt){var Zt=nt.simpleMap(Ge.xr0,rt.r2l),er=nt.simpleMap(Ge.xr1,rt.r2l),dr=Zt[1]-Zt[0],mr=er[1]-er[0];Rt[0]=(Zt[0]*(1-Qe)+Qe*er[0]-Zt[0])/(Zt[1]-Zt[0])*dt,Rt[2]=dt*(1-Qe+Qe*mr/dr),rt.range[0]=rt.l2r(Zt[0]*(1-Qe)+Qe*er[0]),rt.range[1]=rt.l2r(Zt[1]*(1-Qe)+Qe*er[1])}else Rt[0]=0,Rt[2]=dt;if(Ot){var xr=nt.simpleMap(Ge.yr0,ot.r2l),br=nt.simpleMap(Ge.yr1,ot.r2l),Ar=xr[1]-xr[0],en=br[1]-br[0];Rt[1]=(xr[1]*(1-Qe)+Qe*br[1]-xr[1])/(xr[0]-xr[1])*ht,Rt[3]=ht*(1-Qe+Qe*en/Ar),ot.range[0]=rt.l2r(xr[0]*(1-Qe)+Qe*br[0]),ot.range[1]=ot.l2r(xr[1]*(1-Qe)+Qe*br[1])}else Rt[1]=0,Rt[3]=ht;it.drawOne(Ne,rt,{skipTitle:!0}),it.drawOne(Ne,ot,{skipTitle:!0}),it.redrawComponents(Ne,[rt._id,ot._id]);var mn=Dt?dt/Rt[2]:1,xn=Ot?ht/Rt[3]:1,kn=Dt?Rt[0]:0,Cn=Ot?Rt[1]:0,En=Dt?Rt[0]/Rt[2]*dt:0,Pn=Ot?Rt[1]/Rt[3]*ht:0,Dn=rt._offset-En,In=ot._offset-Pn;tt.clipRect.call(at.setTranslate,kn,Cn).call(at.setScale,1/mn,1/xn),tt.plot.call(at.setTranslate,Dn,In).call(at.setScale,mn,xn),at.setPointGroupScale(tt.zoomScalePts,1/mn,1/xn),at.setTextPointsScale(tt.zoomScaleTxt,1/mn,1/xn)}function transitionComplete(){for(var Qe={},tt=0;tt<Ge.length;tt++){var nt=Ge[tt],at=nt.plotinfo.xaxis,it=nt.plotinfo.yaxis;nt.xr1&&(Qe[at._name+".range"]=nt.xr1.slice()),nt.yr1&&(Qe[it._name+".range"]=nt.yr1.slice())}return ht&&ht(),rt.call("relayout",Ne,Qe).then((function(){for(var Ne=0;Ne<Ge.length;Ne++)unsetSubplotTransform(Ge[Ne].plotinfo)}))}function transitionInterrupt(){for(var Qe={},tt=0;tt<Ge.length;tt++){var nt=Ge[tt],at=nt.plotinfo.xaxis,it=nt.plotinfo.yaxis;nt.xr0&&(Qe[at._name+".range"]=nt.xr0.slice()),nt.yr0&&(Qe[it._name+".range"]=nt.yr0.slice())}return rt.call("relayout",Ne,Qe).then((function(){for(var Ne=0;Ne<Ge.length;Ne++)unsetSubplotTransform(Ge[Ne].plotinfo)}))}function doFrame(){Ot=Date.now();for(var Ne=Math.min(1,(Ot-Dt)/Qe.duration),tt=Zt(Ne),rt=0;rt<Ge.length;rt++)updateSubplot(Ge[rt],tt);Ot-Dt>Qe.duration?(transitionComplete(),Rt=window.cancelAnimationFrame(doFrame)):Rt=window.requestAnimationFrame(doFrame)}it.redrawComponents(Ne)}},{"../../components/drawing":665,"../../lib":778,"../../registry":911,"./axes":828,d3:169}],853:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../registry").traceIs,rt=Ne("./axis_autotype");function setAutoType(Ne,Ge){if("-"===Ne.type){var Qe,nt=Ne._id,at=nt.charAt(0);-1!==nt.indexOf("scene")&&(nt=at);var it=getFirstNonEmptyTrace(Ge,nt,at);if(it)if("histogram"!==it.type||at!=={v:"y",h:"x"}[it.orientation||"v"]){var ot=at+"calendar",dt=it[ot],ht={noMultiCategory:!tt(it,"cartesian")||tt(it,"noMultiCategory")};if("box"===it.type&&it._hasPreCompStats&&at==={h:"x",v:"y"}[it.orientation||"v"]&&(ht.noMultiCategory=!0),ht.autotypenumbers=Ne.autotypenumbers,isBoxWithoutPositionCoords(it,at)){var Dt=getBoxPosLetter(it),Ot=[];for(Qe=0;Qe<Ge.length;Qe++){var Rt=Ge[Qe];tt(Rt,"box-violin")&&(Rt[at+"axis"]||at)===nt&&(void 0!==Rt[Dt]?Ot.push(Rt[Dt][0]):void 0!==Rt.name?Ot.push(Rt.name):Ot.push("text"),Rt[ot]!==dt&&(dt=void 0))}Ne.type=rt(Ot,dt,ht)}else if("splom"===it.type){var Zt=it.dimensions[it._axesDim[nt]];Zt.visible&&(Ne.type=rt(Zt.values,dt,ht))}else Ne.type=rt(it[at]||[it[at+"0"]],dt,ht)}else Ne.type="linear"}}function getFirstNonEmptyTrace(Ne,Ge,Qe){for(var tt=0;tt<Ne.length;tt++){var rt=Ne[tt];if("splom"===rt.type&&rt._length>0&&(rt["_"+Qe+"axes"]||{})[Ge])return rt;if((rt[Qe+"axis"]||Qe)===Ge){if(isBoxWithoutPositionCoords(rt,Qe))return rt;if((rt[Qe]||[]).length||rt[Qe+"0"])return rt}}}function getBoxPosLetter(Ne){return{v:"x",h:"y"}[Ne.orientation||"v"]}function isBoxWithoutPositionCoords(Ne,Ge){var Qe=getBoxPosLetter(Ne),rt=tt(Ne,"box-violin"),nt=tt(Ne._fullInput||{},"candlestick");return rt&&!nt&&Ge===Qe&&void 0===Ne[Qe]&&void 0===Ne[Qe+"0"]}Ge.exports=function(Ne,Ge,Qe,tt){Qe("autotypenumbers",tt.autotypenumbersDflt),"-"===Qe("type",(tt.splomStash||{}).type)&&(setAutoType(Ge,tt.data),"-"===Ge.type?Ge.type="linear":Ne.type=Ge.type)}},{"../../registry":911,"./axis_autotype":829}],854:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../registry"),rt=Ne("../lib");function bindingValueHasChanged(Ne,Ge,Qe){var tt,nt,at,it=!1;if("data"===Ge.type)tt=Ne._fullData[null!==Ge.traces?Ge.traces[0]:0];else{if("layout"!==Ge.type)return!1;tt=Ne._fullLayout}return nt=rt.nestedProperty(tt,Ge.prop).get(),(at=Qe[Ge.type]=Qe[Ge.type]||{}).hasOwnProperty(Ge.prop)&&at[Ge.prop]!==nt&&(it=!0),at[Ge.prop]=nt,{changed:it,value:nt}}function computeAnimateBindings(Ne,Ge){return Array.isArray(Ge[0])&&1===Ge[0].length&&-1!==["string","number"].indexOf(typeof Ge[0][0])?[{type:"layout",prop:"_currentFrame",value:Ge[0][0].toString()}]:[]}function computeLayoutBindings(Ne,Ge){var Qe=[],tt=Ge[0],nt={};if("string"==typeof tt)nt[tt]=Ge[1];else{if(!rt.isPlainObject(tt))return Qe;nt=tt}return crawl(nt,(function(Ne,Ge,tt){Qe.push({type:"layout",prop:Ne,value:tt})}),"",0),Qe}function computeDataBindings(Ne,Ge){var Qe,tt,nt,at,it=[];if(tt=Ge[0],nt=Ge[1],Qe=Ge[2],at={},"string"==typeof tt)at[tt]=nt;else{if(!rt.isPlainObject(tt))return it;at=tt,void 0===Qe&&(Qe=nt)}return void 0===Qe&&(Qe=null),crawl(at,(function(Ge,tt,rt){var nt,at;if(Array.isArray(rt)){at=rt.slice();var ot=Math.min(at.length,Ne.data.length);Qe&&(ot=Math.min(ot,Qe.length)),nt=[];for(var dt=0;dt<ot;dt++)nt[dt]=Qe?Qe[dt]:dt}else at=rt,nt=Qe?Qe.slice():null;if(null===nt)Array.isArray(at)&&(at=at[0]);else if(Array.isArray(nt)){if(!Array.isArray(at)){var ht=at;at=[];for(var Dt=0;Dt<nt.length;Dt++)at[Dt]=ht}at.length=Math.min(nt.length,at.length)}it.push({type:"data",prop:Ge,traces:nt,value:at})}),"",0),it}function crawl(Ne,Ge,Qe,tt){Object.keys(Ne).forEach((function(nt){var at=Ne[nt];if("_"!==nt[0]){var it=Qe+(tt>0?".":"")+nt;rt.isPlainObject(at)?crawl(at,Ge,it,tt+1):Ge(it,nt,at)}}))}Qe.manageCommandObserver=function(Ne,Ge,tt,nt){var at={},it=!0;Ge&&Ge._commandObserver&&(at=Ge._commandObserver),at.cache||(at.cache={}),at.lookupTable={};var ot=Qe.hasSimpleAPICommandBindings(Ne,tt,at.lookupTable);if(Ge&&Ge._commandObserver){if(ot)return at;if(Ge._commandObserver.remove)return Ge._commandObserver.remove(),Ge._commandObserver=null,at}if(ot){bindingValueHasChanged(Ne,ot,at.cache),at.check=function(){if(it){var Ge=bindingValueHasChanged(Ne,ot,at.cache);return Ge.changed&&nt&&void 0!==at.lookupTable[Ge.value]&&(at.disable(),Promise.resolve(nt({value:Ge.value,type:ot.type,prop:ot.prop,traces:ot.traces,index:at.lookupTable[Ge.value]})).then(at.enable,at.enable)),Ge.changed}};for(var dt=["plotly_relayout","plotly_redraw","plotly_restyle","plotly_update","plotly_animatingframe","plotly_afterplot"],ht=0;ht<dt.length;ht++)Ne._internalOn(dt[ht],at.check);at.remove=function(){for(var Ge=0;Ge<dt.length;Ge++)Ne._removeInternalListener(dt[Ge],at.check)}}else rt.log("Unable to automatically bind plot updates to API command"),at.lookupTable={},at.remove=function(){};return at.disable=function(){it=!1},at.enable=function(){it=!0},Ge&&(Ge._commandObserver=at),at},Qe.hasSimpleAPICommandBindings=function(Ne,Ge,tt){var rt,nt,at=Ge.length;for(rt=0;rt<at;rt++){var it,ot=Ge[rt],dt=ot.method,ht=ot.args;if(Array.isArray(ht)||(ht=[]),!dt)return!1;var Dt=Qe.computeAPICommandBindings(Ne,dt,ht);if(1!==Dt.length)return!1;if(nt){if((it=Dt[0]).type!==nt.type)return!1;if(it.prop!==nt.prop)return!1;if(Array.isArray(nt.traces)){if(!Array.isArray(it.traces))return!1;it.traces.sort();for(var Ot=0;Ot<nt.traces.length;Ot++)if(nt.traces[Ot]!==it.traces[Ot])return!1}else if(it.prop!==nt.prop)return!1}else nt=Dt[0],Array.isArray(nt.traces)&&nt.traces.sort();var Rt=(it=Dt[0]).value;if(Array.isArray(Rt)){if(1!==Rt.length)return!1;Rt=Rt[0]}tt&&(tt[Rt]=rt)}return nt},Qe.executeAPICommand=function(Ne,Ge,Qe){if("skip"===Ge)return Promise.resolve();var nt=tt.apiMethodRegistry[Ge],at=[Ne];Array.isArray(Qe)||(Qe=[]);for(var it=0;it<Qe.length;it++)at.push(Qe[it]);return nt.apply(null,at).catch((function(Ne){return rt.warn("API call to Plotly."+Ge+" rejected.",Ne),Promise.reject(Ne)}))},Qe.computeAPICommandBindings=function(Ne,Ge,Qe){var tt;switch(Array.isArray(Qe)||(Qe=[]),Ge){case"restyle":tt=computeDataBindings(Ne,Qe);break;case"relayout":tt=computeLayoutBindings(Ne,Qe);break;case"update":tt=computeDataBindings(Ne,[Qe[0],Qe[2]]).concat(computeLayoutBindings(Ne,[Qe[1]]));break;case"animate":tt=computeAnimateBindings(Ne,Qe);break;default:tt=[]}return tt}},{"../lib":778,"../registry":911}],855:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../lib/extend").extendFlat;Qe.attributes=function(Ne,Ge){Ge=Ge||{};var Qe={valType:"info_array",editType:(Ne=Ne||{}).editType,items:[{valType:"number",min:0,max:1,editType:Ne.editType},{valType:"number",min:0,max:1,editType:Ne.editType}],dflt:[0,1]},rt=(Ne.name&&Ne.name,Ne.trace,Ge.description&&Ge.description,{x:tt({},Qe,{}),y:tt({},Qe,{}),editType:Ne.editType});return Ne.noGridCell||(rt.row={valType:"integer",min:0,dflt:0,editType:Ne.editType},rt.column={valType:"integer",min:0,dflt:0,editType:Ne.editType}),rt},Qe.defaults=function(Ne,Ge,Qe,tt){var rt=tt&&tt.x||[0,1],nt=tt&&tt.y||[0,1],at=Ge.grid;if(at){var it=Qe("domain.column");void 0!==it&&(it<at.columns?rt=at._domains.x[it]:delete Ne.domain.column);var ot=Qe("domain.row");void 0!==ot&&(ot<at.rows?nt=at._domains.y[ot]:delete Ne.domain.row)}var dt=Qe("domain.x",rt),ht=Qe("domain.y",nt);dt[0]<dt[1]||(Ne.domain.x=rt.slice()),ht[0]<ht[1]||(Ne.domain.y=nt.slice())}},{"../lib/extend":768}],856:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne){var Ge=Ne.editType,Qe=Ne.colorEditType;void 0===Qe&&(Qe=Ge);var tt={family:{valType:"string",noBlank:!0,strict:!0,editType:Ge},size:{valType:"number",min:1,editType:Ge},color:{valType:"color",editType:Qe},editType:Ge};return Ne.arrayOk&&(tt.family.arrayOk=!0,tt.size.arrayOk=!0,tt.color.arrayOk=!0),tt}},{}],857:[function(Ne,Ge,Qe){"use strict";Ge.exports={_isLinkedToArray:"frames_entry",group:{valType:"string"},name:{valType:"string"},traces:{valType:"any"},baseframe:{valType:"string"},data:{valType:"any"},layout:{valType:"any"}}},{}],858:[function(Ne,Ge,Qe){"use strict";Qe.projNames={equirectangular:"equirectangular",mercator:"mercator",orthographic:"orthographic","natural earth":"naturalEarth",kavrayskiy7:"kavrayskiy7",miller:"miller",robinson:"robinson",eckert4:"eckert4","azimuthal equal area":"azimuthalEqualArea","azimuthal equidistant":"azimuthalEquidistant","conic equal area":"conicEqualArea","conic conformal":"conicConformal","conic equidistant":"conicEquidistant",gnomonic:"gnomonic",stereographic:"stereographic",mollweide:"mollweide",hammer:"hammer","transverse mercator":"transverseMercator","albers usa":"albersUsa","winkel tripel":"winkel3",aitoff:"aitoff",sinusoidal:"sinusoidal"},Qe.axesNames=["lonaxis","lataxis"],Qe.lonaxisSpan={orthographic:180,"azimuthal equal area":360,"azimuthal equidistant":360,"conic conformal":180,gnomonic:160,stereographic:180,"transverse mercator":180,"*":360},Qe.lataxisSpan={"conic conformal":150,stereographic:179.5,"*":180},Qe.scopeDefaults={world:{lonaxisRange:[-180,180],lataxisRange:[-90,90],projType:"equirectangular",projRotate:[0,0,0]},usa:{lonaxisRange:[-180,-50],lataxisRange:[15,80],projType:"albers usa"},europe:{lonaxisRange:[-30,60],lataxisRange:[30,85],projType:"conic conformal",projRotate:[15,0,0],projParallels:[0,60]},asia:{lonaxisRange:[22,160],lataxisRange:[-15,55],projType:"mercator",projRotate:[0,0,0]},africa:{lonaxisRange:[-30,60],lataxisRange:[-40,40],projType:"mercator",projRotate:[0,0,0]},"north america":{lonaxisRange:[-180,-45],lataxisRange:[5,85],projType:"conic conformal",projRotate:[-100,0,0],projParallels:[29.5,45.5]},"south america":{lonaxisRange:[-100,-30],lataxisRange:[-60,15],projType:"mercator",projRotate:[0,0,0]}},Qe.clipPad=.001,Qe.precision=.1,Qe.landColor="#F0DC82",Qe.waterColor="#3399FF",Qe.locationmodeToLayer={"ISO-3":"countries","USA-states":"subunits","country names":"countries"},Qe.sphereSVG={type:"Sphere"},Qe.fillLayers={ocean:1,land:1,lakes:1},Qe.lineLayers={subunits:1,countries:1,coastlines:1,rivers:1,frame:1},Qe.layers=["bg","ocean","land","lakes","subunits","countries","coastlines","rivers","lataxis","lonaxis","frame","backplot","frontplot"],Qe.layersForChoropleth=["bg","ocean","land","subunits","countries","coastlines","lataxis","lonaxis","frame","backplot","rivers","lakes","frontplot"],Qe.layerNameToAdjective={ocean:"ocean",land:"land",lakes:"lake",subunits:"subunit",countries:"country",coastlines:"coastline",rivers:"river",frame:"frame"}},{}],859:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../registry"),nt=Ne("../../lib"),at=nt.strTranslate,it=Ne("../../components/color"),ot=Ne("../../components/drawing"),dt=Ne("../../components/fx"),ht=Ne("../plots"),Dt=Ne("../cartesian/axes"),Ot=Ne("../cartesian/autorange").getAutoRange,Rt=Ne("../../components/dragelement"),Zt=Ne("../cartesian/select").prepSelect,er=Ne("../cartesian/select").clearSelect,dr=Ne("../cartesian/select").selectOnClick,mr=Ne("./zoom"),xr=Ne("./constants"),br=Ne("../../lib/geo_location_utils"),Ar=Ne("../../lib/topojson_utils"),en=Ne("topojson-client").feature;function Geo(Ne){this.id=Ne.id,this.graphDiv=Ne.graphDiv,this.container=Ne.container,this.topojsonURL=Ne.topojsonURL,this.isStatic=Ne.staticPlot,this.topojsonName=null,this.topojson=null,this.projection=null,this.scope=null,this.viewInitial=null,this.fitScale=null,this.bounds=null,this.midPt=null,this.hasChoropleth=!1,this.traceHash={},this.layers={},this.basePaths={},this.dataPaths={},this.dataPoints={},this.clipDef=null,this.clipRect=null,this.bgRect=null,this.makeFramework()}Ne("./projections")(tt);var mn=Geo.prototype;function getProjection(Ne){for(var Ge=Ne.projection.type,Qe=tt.geo[xr.projNames[Ge]](),rt=Ne._isClipped?xr.lonaxisSpan[Ge]/2:null,nt=["center","rotate","parallels","clipExtent"],dummyFn=function(Ne){return Ne?Qe:[]},at=0;at<nt.length;at++){var it=nt[at];"function"!=typeof Qe[it]&&(Qe[it]=dummyFn)}return Qe.isLonLatOverEdges=function(Ne){if(null===Qe(Ne))return!0;if(rt){var Ge=Qe.rotate();return tt.geo.distance(Ne,[-Ge[0],-Ge[1]])>rt*Math.PI/180}return!1},Qe.getPath=function(){return tt.geo.path().projection(Qe)},Qe.getBounds=function(Ne){return Qe.getPath().bounds(Ne)},Qe.fitExtent=function(Ne,Ge){var tt=Ne[1][0]-Ne[0][0],rt=Ne[1][1]-Ne[0][1],nt=Qe.clipExtent&&Qe.clipExtent();Qe.scale(150).translate([0,0]),nt&&Qe.clipExtent(null);var at=Qe.getBounds(Ge),it=Math.min(tt/(at[1][0]-at[0][0]),rt/(at[1][1]-at[0][1])),ot=+Ne[0][0]+(tt-it*(at[1][0]+at[0][0]))/2,dt=+Ne[0][1]+(rt-it*(at[1][1]+at[0][1]))/2;return nt&&Qe.clipExtent(nt),Qe.scale(150*it).translate([ot,dt])},Qe.precision(xr.precision),rt&&Qe.clipAngle(rt-xr.clipPad),Qe}function makeGraticule(Ne,Ge,Qe){var tt,rt,nt,at=1e-6,it=2.5,ot=Ge[Ne],dt=xr.scopeDefaults[Ge.scope];"lonaxis"===Ne?(tt=dt.lonaxisRange,rt=dt.lataxisRange,nt=function(Ne,Ge){return[Ne,Ge]}):"lataxis"===Ne&&(tt=dt.lataxisRange,rt=dt.lonaxisRange,nt=function(Ne,Ge){return[Ge,Ne]});var ht={type:"linear",range:[tt[0],tt[1]-at],tick0:ot.tick0,dtick:ot.dtick};Dt.setConvert(ht,Qe);var Ot=Dt.calcTicks(ht);Ge.isScoped||"lonaxis"!==Ne||Ot.pop();for(var Rt=Ot.length,Zt=new Array(Rt),er=0;er<Rt;er++)for(var dr=Ot[er].x,mr=Zt[er]=[],br=rt[0];br<rt[1]+it;br+=it)mr.push(nt(dr,br));return{type:"MultiLineString",coordinates:Zt}}function makeRangeBox(Ne,Ge){var Qe=xr.clipPad,tt=Ne[0]+Qe,rt=Ne[1]-Qe,nt=Ge[0]+Qe,at=Ge[1]-Qe;tt>0&&rt<0&&(rt+=360);var it=(rt-tt)/4;return{type:"Polygon",coordinates:[[[tt,nt],[tt,at],[tt+it,at],[tt+2*it,at],[tt+3*it,at],[rt,at],[rt,nt],[rt-it,nt],[rt-2*it,nt],[rt-3*it,nt],[tt,nt]]]}}Ge.exports=function(Ne){return new Geo(Ne)},mn.plot=function(Ne,Ge,Qe){var tt=this,rt=Ge[this.id],nt=[],at=!1;for(var it in xr.layerNameToAdjective)if("frame"!==it&&rt["show"+it]){at=!0;break}for(var ot=0;ot<Ne.length;ot++)if(Ne[0][0].trace.locationmode){at=!0;break}if(at){var dt=Ar.getTopojsonName(rt);null!==tt.topojson&&dt===tt.topojsonName||(tt.topojsonName=dt,void 0===PlotlyGeoAssets.topojson[tt.topojsonName]&&nt.push(tt.fetchTopojson()))}nt=nt.concat(br.fetchTraceGeoData(Ne)),Qe.push(new Promise((function(Qe,rt){Promise.all(nt).then((function(){tt.topojson=PlotlyGeoAssets.topojson[tt.topojsonName],tt.update(Ne,Ge),Qe()})).catch(rt)})))},mn.fetchTopojson=function(){var Ne=this,Ge=Ar.getTopojsonPath(Ne.topojsonURL,Ne.topojsonName);return new Promise((function(Qe,rt){tt.json(Ge,(function(tt,nt){if(tt)return 404===tt.status?rt(new Error(["plotly.js could not find topojson file at",Ge,".","Make sure the *topojsonURL* plot config option","is set properly."].join(" "))):rt(new Error(["unexpected error while fetching topojson file at",Ge].join(" ")));PlotlyGeoAssets.topojson[Ne.topojsonName]=nt,Qe()}))}))},mn.update=function(Ne,Ge){var Qe=Ge[this.id];this.hasChoropleth=!1;for(var tt=0;tt<Ne.length;tt++){var rt=Ne[tt],nt=rt[0].trace;"choropleth"===nt.type&&(this.hasChoropleth=!0),!0===nt.visible&&nt._length>0&&nt._module.calcGeoJSON(rt,Ge)}if(!this.updateProjection(Ne,Ge)){this.viewInitial&&this.scope===Qe.scope||this.saveViewInitial(Qe),this.scope=Qe.scope,this.updateBaseLayers(Ge,Qe),this.updateDims(Ge,Qe),this.updateFx(Ge,Qe),ht.generalUpdatePerTraceModule(this.graphDiv,this,Ne,Qe);var at=this.layers.frontplot.select(".scatterlayer");this.dataPoints.point=at.selectAll(".point"),this.dataPoints.text=at.selectAll("text"),this.dataPaths.line=at.selectAll(".js-line");var it=this.layers.backplot.select(".choroplethlayer");this.dataPaths.choropleth=it.selectAll("path"),this.render()}},mn.updateProjection=function(Ne,Ge){var Qe=this.graphDiv,tt=Ge[this.id],at=Ge._size,it=tt.domain,ot=tt.projection,dt=tt.lonaxis,ht=tt.lataxis,Dt=dt._ax,Rt=ht._ax,Zt=this.projection=getProjection(tt),er=[[at.l+at.w*it.x[0],at.t+at.h*(1-it.y[1])],[at.l+at.w*it.x[1],at.t+at.h*(1-it.y[0])]],dr=tt.center||{},mr=ot.rotation||{},br=dt.range||[],Ar=ht.range||[];if(tt.fitbounds){Dt._length=er[1][0]-er[0][0],Rt._length=er[1][1]-er[0][1],Dt.range=Ot(Qe,Dt),Rt.range=Ot(Qe,Rt);var en=(Dt.range[0]+Dt.range[1])/2,mn=(Rt.range[0]+Rt.range[1])/2;if(tt._isScoped)dr={lon:en,lat:mn};else if(tt._isClipped){dr={lon:en,lat:mn},mr={lon:en,lat:mn,roll:mr.roll};var xn=ot.type,kn=xr.lonaxisSpan[xn]/2||180,Cn=xr.lataxisSpan[xn]/2||90;br=[en-kn,en+kn],Ar=[mn-Cn,mn+Cn]}else dr={lon:en,lat:mn},mr={lon:en,lat:mr.lat,roll:mr.roll}}Zt.center([dr.lon-mr.lon,dr.lat-mr.lat]).rotate([-mr.lon,-mr.lat,mr.roll]).parallels(ot.parallels);var En=makeRangeBox(br,Ar);Zt.fitExtent(er,En);var Pn=this.bounds=Zt.getBounds(En),Dn=this.fitScale=Zt.scale(),In=Zt.translate();if(!isFinite(Pn[0][0])||!isFinite(Pn[0][1])||!isFinite(Pn[1][0])||!isFinite(Pn[1][1])||isNaN(In[0])||isNaN(In[0])){for(var zn=["fitbounds","projection.rotation","center","lonaxis.range","lataxis.range"],Bn="Invalid geo settings, relayout'ing to default view.",Vn={},Hn=0;Hn<zn.length;Hn++)Vn[this.id+"."+zn[Hn]]=null;return this.viewInitial=null,nt.warn(Bn),Qe._promises.push(rt.call("relayout",Qe,Vn)),Bn}if(tt.fitbounds){var qn=Zt.getBounds(makeRangeBox(Dt.range,Rt.range)),Yn=Math.min((Pn[1][0]-Pn[0][0])/(qn[1][0]-qn[0][0]),(Pn[1][1]-Pn[0][1])/(qn[1][1]-qn[0][1]));isFinite(Yn)?Zt.scale(Yn*Dn):nt.warn("Something went wrong during"+this.id+"fitbounds computations.")}else Zt.scale(ot.scale*Dn);var $n=this.midPt=[(Pn[0][0]+Pn[1][0])/2,(Pn[0][1]+Pn[1][1])/2];if(Zt.translate([In[0]+($n[0]-In[0]),In[1]+($n[1]-In[1])]).clipExtent(Pn),tt._isAlbersUsa){var ra=Zt([dr.lon,dr.lat]),oa=Zt.translate();Zt.translate([oa[0]-(ra[0]-oa[0]),oa[1]-(ra[1]-oa[1])])}},mn.updateBaseLayers=function(Ne,Ge){var Qe=this,rt=Qe.topojson,nt=Qe.layers,at=Qe.basePaths;function isAxisLayer(Ne){return"lonaxis"===Ne||"lataxis"===Ne}function isLineLayer(Ne){return Boolean(xr.lineLayers[Ne])}function isFillLayer(Ne){return Boolean(xr.fillLayers[Ne])}var dt=(this.hasChoropleth?xr.layersForChoropleth:xr.layers).filter((function(Ne){return isLineLayer(Ne)||isFillLayer(Ne)?Ge["show"+Ne]:!isAxisLayer(Ne)||Ge[Ne].showgrid})),ht=Qe.framework.selectAll(".layer").data(dt,String);ht.exit().each((function(Ne){delete nt[Ne],delete at[Ne],tt.select(this).remove()})),ht.enter().append("g").attr("class",(function(Ne){return"layer "+Ne})).each((function(Ne){var Ge=nt[Ne]=tt.select(this);"bg"===Ne?Qe.bgRect=Ge.append("rect").style("pointer-events","all"):isAxisLayer(Ne)?at[Ne]=Ge.append("path").style("fill","none"):"backplot"===Ne?Ge.append("g").classed("choroplethlayer",!0):"frontplot"===Ne?Ge.append("g").classed("scatterlayer",!0):isLineLayer(Ne)?at[Ne]=Ge.append("path").style("fill","none").style("stroke-miterlimit",2):isFillLayer(Ne)&&(at[Ne]=Ge.append("path").style("stroke","none"))})),ht.order(),ht.each((function(Qe){var tt=at[Qe],nt=xr.layerNameToAdjective[Qe];"frame"===Qe?tt.datum(xr.sphereSVG):isLineLayer(Qe)||isFillLayer(Qe)?tt.datum(en(rt,rt.objects[Qe])):isAxisLayer(Qe)&&tt.datum(makeGraticule(Qe,Ge,Ne)).call(it.stroke,Ge[Qe].gridcolor).call(ot.dashLine,"",Ge[Qe].gridwidth),isLineLayer(Qe)?tt.call(it.stroke,Ge[nt+"color"]).call(ot.dashLine,"",Ge[nt+"width"]):isFillLayer(Qe)&&tt.call(it.fill,Ge[nt+"color"])}))},mn.updateDims=function(Ne,Ge){var Qe=this.bounds,tt=(Ge.framewidth||0)/2,rt=Qe[0][0]-tt,nt=Qe[0][1]-tt,at=Qe[1][0]-rt+tt,dt=Qe[1][1]-nt+tt;ot.setRect(this.clipRect,rt,nt,at,dt),this.bgRect.call(ot.setRect,rt,nt,at,dt).call(it.fill,Ge.bgcolor),this.xaxis._offset=rt,this.xaxis._length=at,this.yaxis._offset=nt,this.yaxis._length=dt},mn.updateFx=function(Ne,Ge){var Qe=this,nt=Qe.graphDiv,at=Qe.bgRect,it=Ne.dragmode,ot=Ne.clickmode;if(!Qe.isStatic){var ht;"select"===it?ht=function(Ne,Ge){(Ne.range={})[Qe.id]=[invert([Ge.xmin,Ge.ymin]),invert([Ge.xmax,Ge.ymax])]}:"lasso"===it&&(ht=function(Ne,Ge,tt){(Ne.lassoPoints={})[Qe.id]=tt.filtered.map(invert)});var Dt={element:Qe.bgRect.node(),gd:nt,plotinfo:{id:Qe.id,xaxis:Qe.xaxis,yaxis:Qe.yaxis,fillRangeItems:ht},xaxes:[Qe.xaxis],yaxes:[Qe.yaxis],subplot:Qe.id,clickFn:function(Ne){2===Ne&&er(nt)}};"pan"===it?(at.node().onmousedown=null,at.call(mr(Qe,Ge)),at.on("dblclick.zoom",zoomReset),nt._context._scrollZoom.geo||at.on("wheel.zoom",null)):"select"!==it&&"lasso"!==it||(at.on(".zoom",null),Dt.prepFn=function(Ne,Ge,Qe){Zt(Ne,Ge,Qe,Dt,it)},Rt.init(Dt)),at.on("mousemove",(function(){var Ne=Qe.projection.invert(tt.mouse(this));if(!Ne||isNaN(Ne[0])||isNaN(Ne[1]))return Rt.unhover(nt,tt.event);Qe.xaxis.p2c=function(){return Ne[0]},Qe.yaxis.p2c=function(){return Ne[1]},dt.hover(nt,tt.event,Qe.id)})),at.on("mouseout",(function(){nt._dragging||Rt.unhover(nt,tt.event)})),at.on("click",(function(){"select"!==it&&"lasso"!==it&&(ot.indexOf("select")>-1&&dr(tt.event,nt,[Qe.xaxis],[Qe.yaxis],Qe.id,Dt),ot.indexOf("event")>-1&&dt.click(nt,tt.event))}))}function zoomReset(){var Ne=Qe.viewInitial,Ge={};for(var tt in Ne)Ge[Qe.id+"."+tt]=Ne[tt];rt.call("_guiRelayout",nt,Ge),nt.emit("plotly_doubleclick",null)}function invert(Ne){return Qe.projection.invert([Ne[0]+Qe.xaxis._offset,Ne[1]+Qe.yaxis._offset])}},mn.makeFramework=function(){var Ne=this,Ge=Ne.graphDiv,Qe=Ge._fullLayout,rt="clip"+Qe._uid+Ne.id;Ne.clipDef=Qe._clips.append("clipPath").attr("id",rt),Ne.clipRect=Ne.clipDef.append("rect"),Ne.framework=tt.select(Ne.container).append("g").attr("class","geo "+Ne.id).call(ot.setClipUrl,rt,Ge),Ne.project=function(Ge){var Qe=Ne.projection(Ge);return Qe?[Qe[0]-Ne.xaxis._offset,Qe[1]-Ne.yaxis._offset]:[null,null]},Ne.xaxis={_id:"x",c2p:function(Ge){return Ne.project(Ge)[0]}},Ne.yaxis={_id:"y",c2p:function(Ge){return Ne.project(Ge)[1]}},Ne.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},Dt.setConvert(Ne.mockAxis,Qe)},mn.saveViewInitial=function(Ne){var Ge,Qe=Ne.center||{},tt=Ne.projection,rt=tt.rotation||{};this.viewInitial={fitbounds:Ne.fitbounds,"projection.scale":tt.scale},Ge=Ne._isScoped?{"center.lon":Qe.lon,"center.lat":Qe.lat}:Ne._isClipped?{"projection.rotation.lon":rt.lon,"projection.rotation.lat":rt.lat}:{"center.lon":Qe.lon,"center.lat":Qe.lat,"projection.rotation.lon":rt.lon},nt.extendFlat(this.viewInitial,Ge)},mn.render=function(){var Ne,Ge=this.projection,Qe=Ge.getPath();function translatePoints(Ne){var Qe=Ge(Ne.lonlat);return Qe?at(Qe[0],Qe[1]):null}function hideShowPoints(Ne){return Ge.isLonLatOverEdges(Ne.lonlat)?"none":null}for(Ne in this.basePaths)this.basePaths[Ne].attr("d",Qe);for(Ne in this.dataPaths)this.dataPaths[Ne].attr("d",(function(Ne){return Qe(Ne.geojson)}));for(Ne in this.dataPoints)this.dataPoints[Ne].attr("display",hideShowPoints).attr("transform",translatePoints)}},{"../../components/color":643,"../../components/dragelement":662,"../../components/drawing":665,"../../components/fx":683,"../../lib":778,"../../lib/geo_location_utils":771,"../../lib/topojson_utils":806,"../../registry":911,"../cartesian/autorange":827,"../cartesian/axes":828,"../cartesian/select":847,"../plots":891,"./constants":858,"./projections":863,"./zoom":864,d3:169,"topojson-client":579}],860:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/get_data").getSubplotCalcData,rt=Ne("../../lib").counterRegex,nt=Ne("./geo"),at="geo",it=rt(at),ot={};function plotGeo(Ne){for(var Ge=Ne._fullLayout,Qe=Ne.calcdata,rt=Ge._subplots[at],it=0;it<rt.length;it++){var ot=rt[it],dt=tt(Qe,at,ot),ht=Ge[ot]._subplot;ht||(ht=nt({id:ot,graphDiv:Ne,container:Ge._geolayer.node(),topojsonURL:Ne._context.topojsonURL,staticPlot:Ne._context.staticPlot}),Ge[ot]._subplot=ht),ht.plot(dt,Ge,Ne._promises)}}function clean(Ne,Ge,Qe,tt){for(var rt=tt._subplots[at]||[],nt=0;nt<rt.length;nt++){var it=rt[nt],ot=tt[it]._subplot;!Ge[it]&&ot&&(ot.framework.remove(),ot.clipDef.remove())}}function updateFx(Ne){for(var Ge=Ne._fullLayout,Qe=Ge._subplots[at],tt=0;tt<Qe.length;tt++){var rt=Ge[Qe[tt]];rt._subplot.updateFx(Ge,rt)}}ot[at]={valType:"subplotid",dflt:at,editType:"calc"},Ge.exports={attr:at,name:at,idRoot:at,idRegex:it,attrRegex:it,attributes:ot,layoutAttributes:Ne("./layout_attributes"),supplyLayoutDefaults:Ne("./layout_defaults"),plot:plotGeo,updateFx:updateFx,clean:clean}},{"../../lib":778,"../../plots/get_data":865,"./geo":859,"./layout_attributes":861,"./layout_defaults":862}],861:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/color/attributes"),rt=Ne("../domain").attributes,nt=Ne("./constants"),at=Ne("../../plot_api/edit_types").overrideAll,it={range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},showgrid:{valType:"boolean",dflt:!1},tick0:{valType:"number",dflt:0},dtick:{valType:"number"},gridcolor:{valType:"color",dflt:tt.lightLine},gridwidth:{valType:"number",min:0,dflt:1}};(Ge.exports=at({domain:rt({name:"geo"},{}),fitbounds:{valType:"enumerated",values:[!1,"locations","geojson"],dflt:!1,editType:"plot"},resolution:{valType:"enumerated",values:[110,50],dflt:110,coerceNumber:!0},scope:{valType:"enumerated",values:Object.keys(nt.scopeDefaults),dflt:"world"},projection:{type:{valType:"enumerated",values:Object.keys(nt.projNames)},rotation:{lon:{valType:"number"},lat:{valType:"number"},roll:{valType:"number"}},parallels:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},scale:{valType:"number",min:0,dflt:1}},center:{lon:{valType:"number"},lat:{valType:"number"}},visible:{valType:"boolean",dflt:!0},showcoastlines:{valType:"boolean"},coastlinecolor:{valType:"color",dflt:tt.defaultLine},coastlinewidth:{valType:"number",min:0,dflt:1},showland:{valType:"boolean",dflt:!1},landcolor:{valType:"color",dflt:nt.landColor},showocean:{valType:"boolean",dflt:!1},oceancolor:{valType:"color",dflt:nt.waterColor},showlakes:{valType:"boolean",dflt:!1},lakecolor:{valType:"color",dflt:nt.waterColor},showrivers:{valType:"boolean",dflt:!1},rivercolor:{valType:"color",dflt:nt.waterColor},riverwidth:{valType:"number",min:0,dflt:1},showcountries:{valType:"boolean"},countrycolor:{valType:"color",dflt:tt.defaultLine},countrywidth:{valType:"number",min:0,dflt:1},showsubunits:{valType:"boolean"},subunitcolor:{valType:"color",dflt:tt.defaultLine},subunitwidth:{valType:"number",min:0,dflt:1},showframe:{valType:"boolean"},framecolor:{valType:"color",dflt:tt.defaultLine},framewidth:{valType:"number",min:0,dflt:1},bgcolor:{valType:"color",dflt:tt.background},lonaxis:it,lataxis:it},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":642,"../../plot_api/edit_types":810,"../domain":855,"./constants":858}],862:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../subplot_defaults"),nt=Ne("../get_data").getSubplotData,at=Ne("./constants"),it=Ne("./layout_attributes"),ot=at.axesNames;function handleGeoDefaults(Ne,Ge,Qe,rt){var it=nt(rt.fullData,"geo",rt.id).map((function(Ne){return Ne._expandedIndex})),dt=Qe("resolution"),ht=Qe("scope"),Dt=at.scopeDefaults[ht],Ot=Qe("projection.type",Dt.projType),Rt=Ge._isAlbersUsa="albers usa"===Ot;Rt&&(ht=Ge.scope="usa");var Zt=Ge._isScoped="world"!==ht,er=Ge._isConic=-1!==Ot.indexOf("conic"),dr=Ge._isClipped=!!at.lonaxisSpan[Ot];if(!1===Ne.visible){var mr=tt.extendDeep({},Ge._template);mr.showcoastlines=!1,mr.showcountries=!1,mr.showframe=!1,mr.showlakes=!1,mr.showland=!1,mr.showocean=!1,mr.showrivers=!1,mr.showsubunits=!1,mr.lonaxis&&(mr.lonaxis.showgrid=!1),mr.lataxis&&(mr.lataxis.showgrid=!1),Ge._template=mr}for(var xr=Qe("visible"),br=0;br<ot.length;br++){var Ar,en=ot[br],mn=[30,10][br];if(Zt)Ar=Dt[en+"Range"];else{var xn=at[en+"Span"],kn=(xn[Ot]||xn["*"])/2,Cn=Qe("projection.rotation."+en.substr(0,3),Dt.projRotate[br]);Ar=[Cn-kn,Cn+kn]}var En=Qe(en+".range",Ar);Qe(en+".tick0"),Qe(en+".dtick",mn),Qe(en+".showgrid",!!xr&&void 0)&&(Qe(en+".gridcolor"),Qe(en+".gridwidth")),Ge[en]._ax={type:"linear",_id:en.slice(0,3),_traceIndices:it,setScale:tt.identity,c2l:tt.identity,r2l:tt.identity,autorange:!0,range:En.slice(),_m:1,_input:{}}}var Pn=Ge.lonaxis.range,Dn=Ge.lataxis.range,In=Pn[0],zn=Pn[1];In>0&&zn<0&&(zn+=360);var Bn,Vn,Hn,qn=(In+zn)/2;if(!Rt){var Yn=Zt?Dt.projRotate:[qn,0,0];Bn=Qe("projection.rotation.lon",Yn[0]),Qe("projection.rotation.lat",Yn[1]),Qe("projection.rotation.roll",Yn[2]),Qe("showcoastlines",!Zt&&xr)&&(Qe("coastlinecolor"),Qe("coastlinewidth")),Qe("showocean",!!xr&&void 0)&&Qe("oceancolor")}Rt?(Vn=-96.6,Hn=38.7):(Vn=Zt?qn:Bn,Hn=(Dn[0]+Dn[1])/2),Qe("center.lon",Vn),Qe("center.lat",Hn),er&&Qe("projection.parallels",Dt.projParallels||[0,60]),Qe("projection.scale"),Qe("showland",!!xr&&void 0)&&Qe("landcolor"),Qe("showlakes",!!xr&&void 0)&&Qe("lakecolor"),Qe("showrivers",!!xr&&void 0)&&(Qe("rivercolor"),Qe("riverwidth")),Qe("showcountries",Zt&&"usa"!==ht&&xr)&&(Qe("countrycolor"),Qe("countrywidth")),("usa"===ht||"north america"===ht&&50===dt)&&(Qe("showsubunits",xr),Qe("subunitcolor"),Qe("subunitwidth")),Zt||Qe("showframe",xr)&&(Qe("framecolor"),Qe("framewidth")),Qe("bgcolor"),Qe("fitbounds")&&(delete Ge.projection.scale,Zt?(delete Ge.center.lon,delete Ge.center.lat):dr?(delete Ge.center.lon,delete Ge.center.lat,delete Ge.projection.rotation.lon,delete Ge.projection.rotation.lat,delete Ge.lonaxis.range,delete Ge.lataxis.range):(delete Ge.center.lon,delete Ge.center.lat,delete Ge.projection.rotation.lon))}Ge.exports=function(Ne,Ge,Qe){rt(Ne,Ge,Qe,{type:"geo",attributes:it,handleDefaults:handleGeoDefaults,fullData:Qe,partition:"y"})}},{"../../lib":778,"../get_data":865,"../subplot_defaults":905,"./constants":858,"./layout_attributes":861}],863:[function(Ne,Ge,Qe){"use strict";function addProjectionsToD3(Ne){function d3_geo_projectFeature(Ne,Ge){return{type:"Feature",id:Ne.id,properties:Ne.properties,geometry:d3_geo_projectGeometry(Ne.geometry,Ge)}}function d3_geo_projectGeometry(Ge,Qe){if(!Ge)return null;if("GeometryCollection"===Ge.type)return{type:"GeometryCollection",geometries:object.geometries.map((function(Ne){return d3_geo_projectGeometry(Ne,Qe)}))};if(!it.hasOwnProperty(Ge.type))return null;var tt=it[Ge.type];return Ne.geo.stream(Ge,Qe(tt)),tt.result()}Ne.geo.project=function(Ne,Qe){var tt=Qe.stream;if(!tt)throw new Error("not yet supported");return(Ne&&Ge.hasOwnProperty(Ne.type)?Ge[Ne.type]:d3_geo_projectGeometry)(Ne,tt)};var Ge={Feature:d3_geo_projectFeature,FeatureCollection:function(Ne,Ge){return{type:"FeatureCollection",features:Ne.features.map((function(Ne){return d3_geo_projectFeature(Ne,Ge)}))}}},Qe=[],tt=[],rt={point:function(Ne,Ge){Qe.push([Ne,Ge])},result:function(){var Ne=Qe.length?Qe.length<2?{type:"Point",coordinates:Qe[0]}:{type:"MultiPoint",coordinates:Qe}:null;return Qe=[],Ne}},nt={lineStart:d3_geo_projectNoop,point:function(Ne,Ge){Qe.push([Ne,Ge])},lineEnd:function(){Qe.length&&(tt.push(Qe),Qe=[])},result:function(){var Ne=tt.length?tt.length<2?{type:"LineString",coordinates:tt[0]}:{type:"MultiLineString",coordinates:tt}:null;return tt=[],Ne}},at={polygonStart:d3_geo_projectNoop,lineStart:d3_geo_projectNoop,point:function(Ne,Ge){Qe.push([Ne,Ge])},lineEnd:function(){var Ne=Qe.length;if(Ne){do{Qe.push(Qe[0].slice())}while(++Ne<4);tt.push(Qe),Qe=[]}},polygonEnd:d3_geo_projectNoop,result:function(){if(!tt.length)return null;var Ne=[],Ge=[];return tt.forEach((function(Qe){d3_geo_projectClockwise(Qe)?Ne.push([Qe]):Ge.push(Qe)})),Ge.forEach((function(Ge){var Qe=Ge[0];Ne.some((function(Ne){if(d3_geo_projectContains(Ne[0],Qe))return Ne.push(Ge),!0}))||Ne.push([Ge])})),tt=[],Ne.length?Ne.length>1?{type:"MultiPolygon",coordinates:Ne}:{type:"Polygon",coordinates:Ne[0]}:null}},it={Point:rt,MultiPoint:rt,LineString:nt,MultiLineString:nt,Polygon:at,MultiPolygon:at,Sphere:at};function d3_geo_projectNoop(){}function d3_geo_projectClockwise(Ne){if((Ge=Ne.length)<4)return!1;for(var Ge,Qe=0,tt=Ne[Ge-1][1]*Ne[0][0]-Ne[Ge-1][0]*Ne[0][1];++Qe<Ge;)tt+=Ne[Qe-1][1]*Ne[Qe][0]-Ne[Qe-1][0]*Ne[Qe][1];return tt<=0}function d3_geo_projectContains(Ne,Ge){for(var Qe=Ge[0],tt=Ge[1],rt=!1,nt=0,at=Ne.length,it=at-1;nt<at;it=nt++){var ot=Ne[nt],dt=ot[0],ht=ot[1],Dt=Ne[it],Ot=Dt[0],Rt=Dt[1];ht>tt^Rt>tt&&Qe<(Ot-dt)*(tt-ht)/(Rt-ht)+dt&&(rt=!rt)}return rt}var ot=1e-6,dt=ot*ot,ht=Math.PI,Dt=ht/2,Ot=(Math.sqrt(ht),ht/180),Rt=180/ht;function sinci(Ne){return Ne?Ne/Math.sin(Ne):1}function asin(Ne){return Ne>1?Dt:Ne<-1?-Dt:Math.asin(Ne)}function acos(Ne){return Ne>1?0:Ne<-1?ht:Math.acos(Ne)}var Zt=Ne.geo.projection,er=Ne.geo.projectionMutator;function eckert4(Ne,Ge){var Qe=(2+Dt)*Math.sin(Ge);Ge/=2;for(var tt=0,rt=1/0;tt<10&&Math.abs(rt)>ot;tt++){var nt=Math.cos(Ge);Ge-=rt=(Ge+Math.sin(Ge)*(nt+2)-Qe)/(2*nt*(1+nt))}return[2/Math.sqrt(ht*(4+ht))*Ne*(1+Math.cos(Ge)),2*Math.sqrt(ht/(4+ht))*Math.sin(Ge)]}Ne.geo.interrupt=function(Ge){var Qe,tt=[[[[-ht,0],[0,Dt],[ht,0]]],[[[-ht,0],[0,-Dt],[ht,0]]]];function forward(Ne,Qe){for(var rt=Qe<0?-1:1,nt=tt[+(Qe<0)],at=0,it=nt.length-1;at<it&&Ne>nt[at][2][0];++at);var ot=Ge(Ne-nt[at][1][0],Qe);return ot[0]+=Ge(nt[at][1][0],rt*Qe>rt*nt[at][0][1]?nt[at][0][1]:Qe)[0],ot}function reset(){Qe=tt.map((function(Ne){return Ne.map((function(Ne){var Qe,tt=Ge(Ne[0][0],Ne[0][1])[0],rt=Ge(Ne[2][0],Ne[2][1])[0],nt=Ge(Ne[1][0],Ne[0][1])[1],at=Ge(Ne[1][0],Ne[1][1])[1];return nt>at&&(Qe=nt,nt=at,at=Qe),[[tt,nt],[rt,at]]}))}))}Ge.invert&&(forward.invert=function(Ne,rt){for(var nt=Qe[+(rt<0)],at=tt[+(rt<0)],it=0,ot=nt.length;it<ot;++it){var dt=nt[it];if(dt[0][0]<=Ne&&Ne<dt[1][0]&&dt[0][1]<=rt&&rt<dt[1][1]){var ht=Ge.invert(Ne-Ge(at[it][1][0],0)[0],rt);return ht[0]+=at[it][1][0],pointEqual(forward(ht[0],ht[1]),[Ne,rt])?ht:null}}});var rt=Ne.geo.projection(forward),nt=rt.stream;function sphere(){for(var Ge=1e-6,Qe=[],rt=0,nt=tt[0].length;rt<nt;++rt){var at=180*(Ot=tt[0][rt])[0][0]/ht,it=180*Ot[0][1]/ht,ot=180*Ot[1][1]/ht,dt=180*Ot[2][0]/ht,Dt=180*Ot[2][1]/ht;Qe.push(resample([[at+Ge,it+Ge],[at+Ge,ot-Ge],[dt-Ge,ot-Ge],[dt-Ge,Dt+Ge]],30))}for(rt=tt[1].length-1;rt>=0;--rt){var Ot;at=180*(Ot=tt[1][rt])[0][0]/ht,it=180*Ot[0][1]/ht,ot=180*Ot[1][1]/ht,dt=180*Ot[2][0]/ht,Dt=180*Ot[2][1]/ht,Qe.push(resample([[dt-Ge,Dt-Ge],[dt-Ge,ot+Ge],[at+Ge,ot+Ge],[at+Ge,it-Ge]],30))}return{type:"Polygon",coordinates:[Ne.merge(Qe)]}}function resample(Ne,Ge){for(var Qe,tt,rt,nt=-1,at=Ne.length,it=Ne[0],ot=[];++nt<at;){tt=((Qe=Ne[nt])[0]-it[0])/Ge,rt=(Qe[1]-it[1])/Ge;for(var dt=0;dt<Ge;++dt)ot.push([it[0]+dt*tt,it[1]+dt*rt]);it=Qe}return ot.push(Qe),ot}function pointEqual(Ne,Ge){return Math.abs(Ne[0]-Ge[0])<ot&&Math.abs(Ne[1]-Ge[1])<ot}return rt.stream=function(Ge){var Qe=rt.rotate(),tt=nt(Ge),at=(rt.rotate([0,0]),nt(Ge));return rt.rotate(Qe),tt.sphere=function(){Ne.geo.stream(sphere(),at)},tt},rt.lobes=function(Ne){return arguments.length?(tt=Ne.map((function(Ne){return Ne.map((function(Ne){return[[Ne[0][0]*ht/180,Ne[0][1]*ht/180],[Ne[1][0]*ht/180,Ne[1][1]*ht/180],[Ne[2][0]*ht/180,Ne[2][1]*ht/180]]}))})),reset(),rt):tt.map((function(Ne){return Ne.map((function(Ne){return[[180*Ne[0][0]/ht,180*Ne[0][1]/ht],[180*Ne[1][0]/ht,180*Ne[1][1]/ht],[180*Ne[2][0]/ht,180*Ne[2][1]/ht]]}))}))},rt},eckert4.invert=function(Ne,Ge){var Qe=.5*Ge*Math.sqrt((4+ht)/ht),tt=asin(Qe),rt=Math.cos(tt);return[Ne/(2/Math.sqrt(ht*(4+ht))*(1+rt)),asin((tt+Qe*(rt+2))/(2+Dt))]},(Ne.geo.eckert4=function(){return Zt(eckert4)}).raw=eckert4;var dr=Ne.geo.azimuthalEqualArea.raw;function hammer(Ne,Ge){if(arguments.length<2&&(Ge=Ne),1===Ge)return dr;if(Ge===1/0)return hammerQuarticAuthalic;function forward(Qe,tt){var rt=dr(Qe/Ge,tt);return rt[0]*=Ne,rt}return forward.invert=function(Qe,tt){var rt=dr.invert(Qe/Ne,tt);return rt[0]*=Ge,rt},forward}function hammerProjection(){var Ne=2,Ge=er(hammer),Qe=Ge(Ne);return Qe.coefficient=function(Qe){return arguments.length?Ge(Ne=+Qe):Ne},Qe}function hammerQuarticAuthalic(Ne,Ge){return[Ne*Math.cos(Ge)/Math.cos(Ge/=2),2*Math.sin(Ge)]}function kavrayskiy7(Ne,Ge){return[3*Ne/(2*ht)*Math.sqrt(ht*ht/3-Ge*Ge),Ge]}function miller(Ne,Ge){return[Ne,1.25*Math.log(Math.tan(ht/4+.4*Ge))]}function mollweideBromleyÎ¸(Ne){return function(Ge){var Qe,tt=Ne*Math.sin(Ge),rt=30;do{Ge-=Qe=(Ge+Math.sin(Ge)-tt)/(1+Math.cos(Ge))}while(Math.abs(Qe)>ot&&--rt>0);return Ge/2}}function mollweideBromley(Ne,Ge,Qe){var tt=mollweideBromleyÎ¸(Qe);function forward(Qe,rt){return[Ne*Qe*Math.cos(rt=tt(rt)),Ge*Math.sin(rt)]}return forward.invert=function(tt,rt){var nt=asin(rt/Ge);return[tt/(Ne*Math.cos(nt)),asin((2*nt+Math.sin(2*nt))/Qe)]},forward}hammerQuarticAuthalic.invert=function(Ne,Ge){var Qe=2*asin(Ge/2);return[Ne*Math.cos(Qe/2)/Math.cos(Qe),Qe]},(Ne.geo.hammer=hammerProjection).raw=hammer,kavrayskiy7.invert=function(Ne,Ge){return[2/3*ht*Ne/Math.sqrt(ht*ht/3-Ge*Ge),Ge]},(Ne.geo.kavrayskiy7=function(){return Zt(kavrayskiy7)}).raw=kavrayskiy7,miller.invert=function(Ne,Ge){return[Ne,2.5*Math.atan(Math.exp(.8*Ge))-.625*ht]},(Ne.geo.miller=function(){return Zt(miller)}).raw=miller,mollweideBromleyÎ¸(ht);var mr=mollweideBromley(Math.SQRT2/Dt,Math.SQRT2,ht);function naturalEarth(Ne,Ge){var Qe=Ge*Ge,tt=Qe*Qe;return[Ne*(.8707-.131979*Qe+tt*(tt*(.003971*Qe-.001529*tt)-.013791)),Ge*(1.007226+Qe*(.015085+tt*(.028874*Qe-.044475-.005916*tt)))]}(Ne.geo.mollweide=function(){return Zt(mr)}).raw=mr,naturalEarth.invert=function(Ne,Ge){var Qe,tt=Ge,rt=25;do{var nt=tt*tt,at=nt*nt;tt-=Qe=(tt*(1.007226+nt*(.015085+at*(.028874*nt-.044475-.005916*at)))-Ge)/(1.007226+nt*(.045255+at*(.259866*nt-.311325-.005916*11*at)))}while(Math.abs(Qe)>ot&&--rt>0);return[Ne/(.8707+(nt=tt*tt)*(nt*(nt*nt*nt*(.003971-.001529*nt)-.013791)-.131979)),tt]},(Ne.geo.naturalEarth=function(){return Zt(naturalEarth)}).raw=naturalEarth;var xr=[[.9986,-.062],[1,0],[.9986,.062],[.9954,.124],[.99,.186],[.9822,.248],[.973,.31],[.96,.372],[.9427,.434],[.9216,.4958],[.8962,.5571],[.8679,.6176],[.835,.6769],[.7986,.7346],[.7597,.7903],[.7186,.8435],[.6732,.8936],[.6213,.9394],[.5722,.9761],[.5322,1]];function robinson(Ne,Ge){var Qe,tt=Math.min(18,36*Math.abs(Ge)/ht),rt=Math.floor(tt),nt=tt-rt,at=(Qe=xr[rt])[0],it=Qe[1],ot=(Qe=xr[++rt])[0],dt=Qe[1],Ot=(Qe=xr[Math.min(19,++rt)])[0],Rt=Qe[1];return[Ne*(ot+nt*(Ot-at)/2+nt*nt*(Ot-2*ot+at)/2),(Ge>0?Dt:-Dt)*(dt+nt*(Rt-it)/2+nt*nt*(Rt-2*dt+it)/2)]}function sinusoidal(Ne,Ge){return[Ne*Math.cos(Ge),Ge]}function aitoff(Ne,Ge){var Qe=Math.cos(Ge),tt=sinci(acos(Qe*Math.cos(Ne/=2)));return[2*Qe*Math.sin(Ne)*tt,Math.sin(Ge)*tt]}function winkel3(Ne,Ge){var Qe=aitoff(Ne,Ge);return[(Qe[0]+Ne/Dt)/2,(Qe[1]+Ge)/2]}xr.forEach((function(Ne){Ne[1]*=1.0144})),robinson.invert=function(Ne,Ge){var Qe=Ge/Dt,tt=90*Qe,rt=Math.min(18,Math.abs(tt/5)),nt=Math.max(0,Math.floor(rt));do{var at=xr[nt][1],it=xr[nt+1][1],ot=xr[Math.min(19,nt+2)][1],ht=ot-at,Zt=ot-2*it+at,er=2*(Math.abs(Qe)-it)/ht,dr=Zt/ht,mr=er*(1-dr*er*(1-2*dr*er));if(mr>=0||1===nt){tt=(Ge>=0?5:-5)*(mr+rt);var br,Ar=50;do{mr=(rt=Math.min(18,Math.abs(tt)/5))-(nt=Math.floor(rt)),at=xr[nt][1],it=xr[nt+1][1],ot=xr[Math.min(19,nt+2)][1],tt-=(br=(Ge>=0?Dt:-Dt)*(it+mr*(ot-at)/2+mr*mr*(ot-2*it+at)/2)-Ge)*Rt}while(Math.abs(br)>dt&&--Ar>0);break}}while(--nt>=0);var en=xr[nt][0],mn=xr[nt+1][0],xn=xr[Math.min(19,nt+2)][0];return[Ne/(mn+mr*(xn-en)/2+mr*mr*(xn-2*mn+en)/2),tt*Ot]},(Ne.geo.robinson=function(){return Zt(robinson)}).raw=robinson,sinusoidal.invert=function(Ne,Ge){return[Ne/Math.cos(Ge),Ge]},(Ne.geo.sinusoidal=function(){return Zt(sinusoidal)}).raw=sinusoidal,aitoff.invert=function(Ne,Ge){if(!(Ne*Ne+4*Ge*Ge>ht*ht+ot)){var Qe=Ne,tt=Ge,rt=25;do{var nt,at=Math.sin(Qe),it=Math.sin(Qe/2),dt=Math.cos(Qe/2),Dt=Math.sin(tt),Ot=Math.cos(tt),Rt=Math.sin(2*tt),Zt=Dt*Dt,er=Ot*Ot,dr=it*it,mr=1-er*dt*dt,xr=mr?acos(Ot*dt)*Math.sqrt(nt=1/mr):nt=0,br=2*xr*Ot*it-Ne,Ar=xr*Dt-Ge,en=nt*(er*dr+xr*Ot*dt*Zt),mn=nt*(.5*at*Rt-2*xr*Dt*it),xn=.25*nt*(Rt*it-xr*Dt*er*at),kn=nt*(Zt*dt+xr*dr*Ot),Cn=mn*xn-kn*en;if(!Cn)break;var En=(Ar*mn-br*kn)/Cn,Pn=(br*xn-Ar*en)/Cn;Qe-=En,tt-=Pn}while((Math.abs(En)>ot||Math.abs(Pn)>ot)&&--rt>0);return[Qe,tt]}},(Ne.geo.aitoff=function(){return Zt(aitoff)}).raw=aitoff,winkel3.invert=function(Ne,Ge){var Qe=Ne,tt=Ge,rt=25;do{var nt,at=Math.cos(tt),it=Math.sin(tt),dt=Math.sin(2*tt),ht=it*it,Ot=at*at,Rt=Math.sin(Qe),Zt=Math.cos(Qe/2),er=Math.sin(Qe/2),dr=er*er,mr=1-Ot*Zt*Zt,xr=mr?acos(at*Zt)*Math.sqrt(nt=1/mr):nt=0,br=.5*(2*xr*at*er+Qe/Dt)-Ne,Ar=.5*(xr*it+tt)-Ge,en=.5*nt*(Ot*dr+xr*at*Zt*ht)+.5/Dt,mn=nt*(Rt*dt/4-xr*it*er),xn=.125*nt*(dt*er-xr*it*Ot*Rt),kn=.5*nt*(ht*Zt+xr*dr*at)+.5,Cn=mn*xn-kn*en,En=(Ar*mn-br*kn)/Cn,Pn=(br*xn-Ar*en)/Cn;Qe-=En,tt-=Pn}while((Math.abs(En)>ot||Math.abs(Pn)>ot)&&--rt>0);return[Qe,tt]},(Ne.geo.winkel3=function(){return Zt(winkel3)}).raw=winkel3}Ge.exports=addProjectionsToD3},{}],864:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../lib"),nt=Ne("../../registry"),at=Math.PI/180,it=180/Math.PI,ot={cursor:"pointer"},dt={cursor:"auto"};function createGeoZoom(Ne,Ge){var Qe=Ne.projection;return(Ge._isScoped?zoomScoped:Ge._isClipped?zoomClipped:zoomNonClipped)(Ne,Qe)}function initZoom(Ne,Ge){return tt.behavior.zoom().translate(Ge.translate()).scale(Ge.scale())}function sync(Ne,Ge,Qe){var tt=Ne.id,at=Ne.graphDiv,it=at.layout,ot=it[tt],dt=at._fullLayout,ht=dt[tt],Dt={},Ot={};function set(Ne,Ge){Dt[tt+"."+Ne]=rt.nestedProperty(ot,Ne).get(),nt.call("_storeDirectGUIEdit",it,dt._preGUI,Dt);var Qe=rt.nestedProperty(ht,Ne);Qe.get()!==Ge&&(Qe.set(Ge),rt.nestedProperty(ot,Ne).set(Ge),Ot[tt+"."+Ne]=Ge)}Qe(set),set("projection.scale",Ge.scale()/Ne.fitScale),set("fitbounds",!1),at.emit("plotly_relayout",Ot)}function zoomScoped(Ne,Ge){var Qe=initZoom(Ne,Ge);function handleZoomstart(){tt.select(this).style(ot)}function handleZoom(){Ge.scale(tt.event.scale).translate(tt.event.translate),Ne.render();var Qe=Ge.invert(Ne.midPt);Ne.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":Ge.scale()/Ne.fitScale,"geo.center.lon":Qe[0],"geo.center.lat":Qe[1]})}function syncCb(Qe){var tt=Ge.invert(Ne.midPt);Qe("center.lon",tt[0]),Qe("center.lat",tt[1])}function handleZoomend(){tt.select(this).style(dt),sync(Ne,Ge,syncCb)}return Qe.on("zoomstart",handleZoomstart).on("zoom",handleZoom).on("zoomend",handleZoomend),Qe}function zoomNonClipped(Ne,Ge){var Qe,rt,nt,at,it,ht,Dt,Ot,Rt,Zt=initZoom(Ne,Ge),er=2;function position(Ne){return Ge.invert(Ne)}function outside(Ne){var Qe=position(Ne);if(!Qe)return!0;var tt=Ge(Qe);return Math.abs(tt[0]-Ne[0])>er||Math.abs(tt[1]-Ne[1])>er}function handleZoomstart(){tt.select(this).style(ot),Qe=tt.mouse(this),rt=Ge.rotate(),nt=Ge.translate(),at=rt,it=position(Qe)}function handleZoom(){if(ht=tt.mouse(this),outside(Qe))return Zt.scale(Ge.scale()),void Zt.translate(Ge.translate());Ge.scale(tt.event.scale),Ge.translate([nt[0],tt.event.translate[1]]),it?position(ht)&&(Ot=position(ht),Dt=[at[0]+(Ot[0]-it[0]),rt[1],rt[2]],Ge.rotate(Dt),at=Dt):it=position(Qe=ht),Rt=!0,Ne.render();var ot=Ge.rotate(),dt=Ge.invert(Ne.midPt);Ne.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":Ge.scale()/Ne.fitScale,"geo.center.lon":dt[0],"geo.center.lat":dt[1],"geo.projection.rotation.lon":-ot[0]})}function handleZoomend(){tt.select(this).style(dt),Rt&&sync(Ne,Ge,syncCb)}function syncCb(Qe){var tt=Ge.rotate(),rt=Ge.invert(Ne.midPt);Qe("projection.rotation.lon",-tt[0]),Qe("center.lon",rt[0]),Qe("center.lat",rt[1])}return Zt.on("zoomstart",handleZoomstart).on("zoom",handleZoom).on("zoomend",handleZoomend),Zt}function zoomClipped(Ne,Ge){var Qe,rt={r:Ge.rotate(),k:Ge.scale()},nt=initZoom(Ne,Ge),at=d3eventDispatch(nt,"zoomstart","zoom","zoomend"),it=0,ht=nt.on;function zoomstarted(Ne){it++||Ne({type:"zoomstart"})}function zoomed(Ne){Ne({type:"zoom"})}function zoomended(Ne){--it||Ne({type:"zoomend"})}function syncCb(Ne){var Qe=Ge.rotate();Ne("projection.rotation.lon",-Qe[0]),Ne("projection.rotation.lat",-Qe[1])}return nt.on("zoomstart",(function(){tt.select(this).style(ot);var Ne=tt.mouse(this),it=Ge.rotate(),dt=it,Dt=Ge.translate(),Ot=quaternionFromEuler(it);Qe=position(Ge,Ne),ht.call(nt,"zoom",(function(){var nt=tt.mouse(this);if(Ge.scale(rt.k=tt.event.scale),Qe){if(position(Ge,nt)){Ge.rotate(it).translate(Dt);var ot=position(Ge,nt),ht=rotateBetween(Qe,ot),Rt=eulerFromQuaternion(multiply(Ot,ht)),Zt=rt.r=unRoll(Rt,Qe,dt);isFinite(Zt[0])&&isFinite(Zt[1])&&isFinite(Zt[2])||(Zt=dt),Ge.rotate(Zt),dt=Zt}}else Qe=position(Ge,Ne=nt);zoomed(at.of(this,arguments))})),zoomstarted(at.of(this,arguments))})).on("zoomend",(function(){tt.select(this).style(dt),ht.call(nt,"zoom",null),zoomended(at.of(this,arguments)),sync(Ne,Ge,syncCb)})).on("zoom.redraw",(function(){Ne.render();var Qe=Ge.rotate();Ne.graphDiv.emit("plotly_relayouting",{"geo.projection.scale":Ge.scale()/Ne.fitScale,"geo.projection.rotation.lon":-Qe[0],"geo.projection.rotation.lat":-Qe[1]})})),tt.rebind(nt,at,"on")}function position(Ne,Ge){var Qe=Ne.invert(Ge);return Qe&&isFinite(Qe[0])&&isFinite(Qe[1])&&cartesian(Qe)}function quaternionFromEuler(Ne){var Ge=.5*Ne[0]*at,Qe=.5*Ne[1]*at,tt=.5*Ne[2]*at,rt=Math.sin(Ge),nt=Math.cos(Ge),it=Math.sin(Qe),ot=Math.cos(Qe),dt=Math.sin(tt),ht=Math.cos(tt);return[nt*ot*ht+rt*it*dt,rt*ot*ht-nt*it*dt,nt*it*ht+rt*ot*dt,nt*ot*dt-rt*it*ht]}function multiply(Ne,Ge){var Qe=Ne[0],tt=Ne[1],rt=Ne[2],nt=Ne[3],at=Ge[0],it=Ge[1],ot=Ge[2],dt=Ge[3];return[Qe*at-tt*it-rt*ot-nt*dt,Qe*it+tt*at+rt*dt-nt*ot,Qe*ot-tt*dt+rt*at+nt*it,Qe*dt+tt*ot-rt*it+nt*at]}function rotateBetween(Ne,Ge){if(Ne&&Ge){var Qe=cross(Ne,Ge),tt=Math.sqrt(dot(Qe,Qe)),rt=.5*Math.acos(Math.max(-1,Math.min(1,dot(Ne,Ge)))),nt=Math.sin(rt)/tt;return tt&&[Math.cos(rt),Qe[2]*nt,-Qe[1]*nt,Qe[0]*nt]}}function unRoll(Ne,Ge,Qe){var tt=rotateCartesian(Ge,2,Ne[0]);tt=rotateCartesian(tt,1,Ne[1]),tt=rotateCartesian(tt,0,Ne[2]-Qe[2]);var rt,nt,at=Ge[0],ot=Ge[1],dt=Ge[2],ht=tt[0],Dt=tt[1],Ot=tt[2],Rt=Math.atan2(ot,at)*it,Zt=Math.sqrt(at*at+ot*ot);Math.abs(Dt)>Zt?(nt=(Dt>0?90:-90)-Rt,rt=0):(nt=Math.asin(Dt/Zt)*it-Rt,rt=Math.sqrt(Zt*Zt-Dt*Dt));var er=180-nt-2*Rt,dr=(Math.atan2(Ot,ht)-Math.atan2(dt,rt))*it,mr=(Math.atan2(Ot,ht)-Math.atan2(dt,-rt))*it;return angleDistance(Qe[0],Qe[1],nt,dr)<=angleDistance(Qe[0],Qe[1],er,mr)?[nt,dr,Qe[2]]:[er,mr,Qe[2]]}function angleDistance(Ne,Ge,Qe,tt){var rt=angleMod(Qe-Ne),nt=angleMod(tt-Ge);return Math.sqrt(rt*rt+nt*nt)}function angleMod(Ne){return(Ne%360+540)%360-180}function rotateCartesian(Ne,Ge,Qe){var tt=Qe*at,rt=Ne.slice(),nt=0===Ge?1:0,it=2===Ge?1:2,ot=Math.cos(tt),dt=Math.sin(tt);return rt[nt]=Ne[nt]*ot-Ne[it]*dt,rt[it]=Ne[it]*ot+Ne[nt]*dt,rt}function eulerFromQuaternion(Ne){return[Math.atan2(2*(Ne[0]*Ne[1]+Ne[2]*Ne[3]),1-2*(Ne[1]*Ne[1]+Ne[2]*Ne[2]))*it,Math.asin(Math.max(-1,Math.min(1,2*(Ne[0]*Ne[2]-Ne[3]*Ne[1]))))*it,Math.atan2(2*(Ne[0]*Ne[3]+Ne[1]*Ne[2]),1-2*(Ne[2]*Ne[2]+Ne[3]*Ne[3]))*it]}function cartesian(Ne){var Ge=Ne[0]*at,Qe=Ne[1]*at,tt=Math.cos(Qe);return[tt*Math.cos(Ge),tt*Math.sin(Ge),Math.sin(Qe)]}function dot(Ne,Ge){for(var Qe=0,tt=0,rt=Ne.length;tt<rt;++tt)Qe+=Ne[tt]*Ge[tt];return Qe}function cross(Ne,Ge){return[Ne[1]*Ge[2]-Ne[2]*Ge[1],Ne[2]*Ge[0]-Ne[0]*Ge[2],Ne[0]*Ge[1]-Ne[1]*Ge[0]]}function d3eventDispatch(Ne){for(var Ge=0,Qe=arguments.length,rt=[];++Ge<Qe;)rt.push(arguments[Ge]);var nt=tt.dispatch.apply(null,rt);return nt.of=function(Ge,Qe){return function(rt){var at;try{at=rt.sourceEvent=tt.event,rt.target=Ne,tt.event=rt,nt[rt.type].apply(Ge,Qe)}finally{tt.event=at}}},nt}Ge.exports=createGeoZoom},{"../../lib":778,"../../registry":911,d3:169}],865:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../registry"),rt=Ne("./cartesian/constants").SUBPLOT_PATTERN;Qe.getSubplotCalcData=function(Ne,Ge,Qe){var rt=tt.subplotsRegistry[Ge];if(!rt)return[];for(var nt=rt.attr,at=[],it=0;it<Ne.length;it++){var ot=Ne[it];ot[0].trace[nt]===Qe&&at.push(ot)}return at},Qe.getModuleCalcData=function(Ne,Ge){var Qe,rt=[],nt=[];if(!(Qe="string"==typeof Ge?tt.getModule(Ge).plot:"function"==typeof Ge?Ge:Ge.plot))return[rt,Ne];for(var at=0;at<Ne.length;at++){var it=Ne[at],ot=it[0].trace;!0===ot.visible&&0!==ot._length&&(ot._module.plot===Qe?rt.push(it):nt.push(it))}return[rt,nt]},Qe.getSubplotData=function(Ne,Ge,Qe){if(!tt.subplotsRegistry[Ge])return[];var nt,at,it,ot=tt.subplotsRegistry[Ge].attr,dt=[];if("gl2d"===Ge){var ht=Qe.match(rt);at="x"+ht[1],it="y"+ht[2]}for(var Dt=0;Dt<Ne.length;Dt++)nt=Ne[Dt],"gl2d"===Ge&&tt.traceIs(nt,"gl2d")?nt[ot[0]]===at&&nt[ot[1]]===it&&dt.push(nt):nt[ot]===Qe&&dt.push(nt);return dt}},{"../registry":911,"./cartesian/constants":834}],866:[function(Ne,Ge,Qe){"use strict";var tt=Ne("mouse-change"),rt=Ne("mouse-wheel"),nt=Ne("mouse-event-offset"),at=Ne("../cartesian/constants"),it=Ne("has-passive-events");function Camera2D(Ne,Ge){this.element=Ne,this.plot=Ge,this.mouseListener=null,this.wheelListener=null,this.lastInputTime=Date.now(),this.lastPos=[0,0],this.boxEnabled=!1,this.boxInited=!1,this.boxStart=[0,0],this.boxEnd=[0,0],this.dragStart=[0,0]}function createCamera(Ne){var Ge=Ne.mouseContainer,Qe=Ne.glplot,ot=new Camera2D(Ge,Qe);function unSetAutoRange(){Ne.xaxis.autorange=!1,Ne.yaxis.autorange=!1}function getSubplotConstraint(){for(var Ge=Ne.graphDiv._fullLayout._axisConstraintGroups,Qe=Ne.xaxis._id,tt=Ne.yaxis._id,rt=0;rt<Ge.length;rt++)if(-1!==Ge[rt][Qe]){if(-1!==Ge[rt][tt])return!0;break}return!1}function handleInteraction(Ge,tt,rt){var nt,it,dt=Ne.calcDataBox(),ht=Qe.viewBox,Dt=ot.lastPos[0],Ot=ot.lastPos[1],Rt=at.MINDRAG*Qe.pixelRatio,Zt=at.MINZOOM*Qe.pixelRatio;function updateRange(Ge,Qe,tt){var rt=Math.min(Qe,tt),nt=Math.max(Qe,tt);rt!==nt?(dt[Ge]=rt,dt[Ge+2]=nt,ot.dataBox=dt,Ne.setRanges(dt)):(Ne.selectBox.selectBox=[0,0,1,1],Ne.glplot.setDirty())}switch(tt*=Qe.pixelRatio,rt*=Qe.pixelRatio,rt=ht[3]-ht[1]-rt,Ne.fullLayout.dragmode){case"zoom":if(Ge){var er=tt/(ht[2]-ht[0])*(dt[2]-dt[0])+dt[0],dr=rt/(ht[3]-ht[1])*(dt[3]-dt[1])+dt[1];ot.boxInited||(ot.boxStart[0]=er,ot.boxStart[1]=dr,ot.dragStart[0]=tt,ot.dragStart[1]=rt),ot.boxEnd[0]=er,ot.boxEnd[1]=dr,ot.boxInited=!0,ot.boxEnabled||ot.boxStart[0]===ot.boxEnd[0]&&ot.boxStart[1]===ot.boxEnd[1]||(ot.boxEnabled=!0);var mr=Math.abs(ot.dragStart[0]-tt)<Zt,xr=Math.abs(ot.dragStart[1]-rt)<Zt;if(!getSubplotConstraint()||mr&&xr)mr&&(ot.boxEnd[0]=ot.boxStart[0]),xr&&(ot.boxEnd[1]=ot.boxStart[1]);else{nt=ot.boxEnd[0]-ot.boxStart[0],it=ot.boxEnd[1]-ot.boxStart[1];var br=(dt[3]-dt[1])/(dt[2]-dt[0]);Math.abs(nt*br)>Math.abs(it)?(ot.boxEnd[1]=ot.boxStart[1]+Math.abs(nt)*br*(it>=0?1:-1),ot.boxEnd[1]<dt[1]?(ot.boxEnd[1]=dt[1],ot.boxEnd[0]=ot.boxStart[0]+(dt[1]-ot.boxStart[1])/Math.abs(br)):ot.boxEnd[1]>dt[3]&&(ot.boxEnd[1]=dt[3],ot.boxEnd[0]=ot.boxStart[0]+(dt[3]-ot.boxStart[1])/Math.abs(br))):(ot.boxEnd[0]=ot.boxStart[0]+Math.abs(it)/br*(nt>=0?1:-1),ot.boxEnd[0]<dt[0]?(ot.boxEnd[0]=dt[0],ot.boxEnd[1]=ot.boxStart[1]+(dt[0]-ot.boxStart[0])*Math.abs(br)):ot.boxEnd[0]>dt[2]&&(ot.boxEnd[0]=dt[2],ot.boxEnd[1]=ot.boxStart[1]+(dt[2]-ot.boxStart[0])*Math.abs(br)))}}else ot.boxEnabled?(nt=ot.boxStart[0]!==ot.boxEnd[0],it=ot.boxStart[1]!==ot.boxEnd[1],nt||it?(nt&&(updateRange(0,ot.boxStart[0],ot.boxEnd[0]),Ne.xaxis.autorange=!1),it&&(updateRange(1,ot.boxStart[1],ot.boxEnd[1]),Ne.yaxis.autorange=!1),Ne.relayoutCallback()):Ne.glplot.setDirty(),ot.boxEnabled=!1,ot.boxInited=!1):ot.boxInited&&(ot.boxInited=!1);break;case"pan":ot.boxEnabled=!1,ot.boxInited=!1,Ge?(ot.panning||(ot.dragStart[0]=tt,ot.dragStart[1]=rt),Math.abs(ot.dragStart[0]-tt)<Rt&&(tt=ot.dragStart[0]),Math.abs(ot.dragStart[1]-rt)<Rt&&(rt=ot.dragStart[1]),nt=(Dt-tt)*(dt[2]-dt[0])/(Qe.viewBox[2]-Qe.viewBox[0]),it=(Ot-rt)*(dt[3]-dt[1])/(Qe.viewBox[3]-Qe.viewBox[1]),dt[0]+=nt,dt[2]+=nt,dt[1]+=it,dt[3]+=it,Ne.setRanges(dt),ot.panning=!0,ot.lastInputTime=Date.now(),unSetAutoRange(),Ne.cameraChanged(),Ne.handleAnnotations()):ot.panning&&(ot.panning=!1,Ne.relayoutCallback())}ot.lastPos[0]=tt,ot.lastPos[1]=rt}return ot.mouseListener=tt(Ge,handleInteraction),Ge.addEventListener("touchstart",(function(Ne){var Qe=nt(Ne.changedTouches[0],Ge);handleInteraction(0,Qe[0],Qe[1]),handleInteraction(1,Qe[0],Qe[1]),Ne.preventDefault()}),!!it&&{passive:!1}),Ge.addEventListener("touchmove",(function(Ne){Ne.preventDefault();var Qe=nt(Ne.changedTouches[0],Ge);handleInteraction(1,Qe[0],Qe[1]),Ne.preventDefault()}),!!it&&{passive:!1}),Ge.addEventListener("touchend",(function(Ne){handleInteraction(0,ot.lastPos[0],ot.lastPos[1]),Ne.preventDefault()}),!!it&&{passive:!1}),ot.wheelListener=rt(Ge,(function(Ge,tt){if(!Ne.scrollZoom)return!1;var rt=Ne.calcDataBox(),nt=Qe.viewBox,at=ot.lastPos[0],it=ot.lastPos[1],dt=Math.exp(5*tt/(nt[3]-nt[1])),ht=at/(nt[2]-nt[0])*(rt[2]-rt[0])+rt[0],Dt=it/(nt[3]-nt[1])*(rt[3]-rt[1])+rt[1];return rt[0]=(rt[0]-ht)*dt+ht,rt[2]=(rt[2]-ht)*dt+ht,rt[1]=(rt[1]-Dt)*dt+Dt,rt[3]=(rt[3]-Dt)*dt+Dt,Ne.setRanges(rt),ot.lastInputTime=Date.now(),unSetAutoRange(),Ne.cameraChanged(),Ne.handleAnnotations(),Ne.relayoutCallback(),!0}),!0),ot}Ge.exports=createCamera},{"../cartesian/constants":834,"has-passive-events":441,"mouse-change":483,"mouse-event-offset":484,"mouse-wheel":486}],867:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../cartesian/axes"),rt=Ne("../../lib/str2rgbarray");function Axes2DOptions(Ne){this.scene=Ne,this.gl=Ne.gl,this.pixelRatio=Ne.pixelRatio,this.screenBox=[0,0,1,1],this.viewBox=[0,0,1,1],this.dataBox=[-1,-1,1,1],this.borderLineEnable=[!1,!1,!1,!1],this.borderLineWidth=[1,1,1,1],this.borderLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.ticks=[[],[]],this.tickEnable=[!0,!0,!1,!1],this.tickPad=[15,15,15,15],this.tickAngle=[0,0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickMarkLength=[0,0,0,0],this.tickMarkWidth=[0,0,0,0],this.tickMarkColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labels=["x","y"],this.labelEnable=[!0,!0,!1,!1],this.labelAngle=[0,Math.PI/2,0,3*Math.PI/2],this.labelPad=[15,15,15,15],this.labelSize=[12,12],this.labelFont=["sans-serif","sans-serif"],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.title="",this.titleEnable=!0,this.titleCenter=[0,0,0,0],this.titleAngle=0,this.titleColor=[0,0,0,1],this.titleFont="sans-serif",this.titleSize=18,this.gridLineEnable=[!0,!0],this.gridLineColor=[[0,0,0,.5],[0,0,0,.5]],this.gridLineWidth=[1,1],this.zeroLineEnable=[!0,!0],this.zeroLineWidth=[1,1],this.zeroLineColor=[[0,0,0,1],[0,0,0,1]],this.borderColor=[0,0,0,0],this.backgroundColor=[0,0,0,0],this.static=this.scene.staticPlot}var nt=Axes2DOptions.prototype,at=["xaxis","yaxis"];function createAxes2D(Ne){return new Axes2DOptions(Ne)}nt.merge=function(Ne){var Ge,Qe,tt,nt,it,ot,dt,ht,Dt,Ot,Rt;for(this.titleEnable=!1,this.backgroundColor=rt(Ne.plot_bgcolor),Ot=0;Ot<2;++Ot){var Zt=(Ge=at[Ot]).charAt(0);for(tt=(Qe=Ne[this.scene[Ge]._name]).title.text===this.scene.fullLayout._dfltTitle[Zt]?"":Qe.title.text,Rt=0;Rt<=2;Rt+=2)this.labelEnable[Ot+Rt]=!1,this.labels[Ot+Rt]=tt,this.labelColor[Ot+Rt]=rt(Qe.title.font.color),this.labelFont[Ot+Rt]=Qe.title.font.family,this.labelSize[Ot+Rt]=Qe.title.font.size,this.labelPad[Ot+Rt]=this.getLabelPad(Ge,Qe),this.tickEnable[Ot+Rt]=!1,this.tickColor[Ot+Rt]=rt((Qe.tickfont||{}).color),this.tickAngle[Ot+Rt]="auto"===Qe.tickangle?0:Math.PI*-Qe.tickangle/180,this.tickPad[Ot+Rt]=this.getTickPad(Qe),this.tickMarkLength[Ot+Rt]=0,this.tickMarkWidth[Ot+Rt]=Qe.tickwidth||0,this.tickMarkColor[Ot+Rt]=rt(Qe.tickcolor),this.borderLineEnable[Ot+Rt]=!1,this.borderLineColor[Ot+Rt]=rt(Qe.linecolor),this.borderLineWidth[Ot+Rt]=Qe.linewidth||0;dt=this.hasSharedAxis(Qe),it=this.hasAxisInDfltPos(Ge,Qe)&&!dt,ot=this.hasAxisInAltrPos(Ge,Qe)&&!dt,nt=Qe.mirror||!1,ht=dt?-1!==String(nt).indexOf("all"):!!nt,Dt=dt?"allticks"===nt:-1!==String(nt).indexOf("ticks"),it?this.labelEnable[Ot]=!0:ot&&(this.labelEnable[Ot+2]=!0),it?this.tickEnable[Ot]=Qe.showticklabels:ot&&(this.tickEnable[Ot+2]=Qe.showticklabels),(it||ht)&&(this.borderLineEnable[Ot]=Qe.showline),(ot||ht)&&(this.borderLineEnable[Ot+2]=Qe.showline),(it||Dt)&&(this.tickMarkLength[Ot]=this.getTickMarkLength(Qe)),(ot||Dt)&&(this.tickMarkLength[Ot+2]=this.getTickMarkLength(Qe)),this.gridLineEnable[Ot]=Qe.showgrid,this.gridLineColor[Ot]=rt(Qe.gridcolor),this.gridLineWidth[Ot]=Qe.gridwidth,this.zeroLineEnable[Ot]=Qe.zeroline,this.zeroLineColor[Ot]=rt(Qe.zerolinecolor),this.zeroLineWidth[Ot]=Qe.zerolinewidth}},nt.hasSharedAxis=function(Ne){var Ge=this.scene,Qe=Ge.fullLayout._subplots.gl2d;return 0!==tt.findSubplotsWithAxis(Qe,Ne).indexOf(Ge.id)},nt.hasAxisInDfltPos=function(Ne,Ge){var Qe=Ge.side;return"xaxis"===Ne?"bottom"===Qe:"yaxis"===Ne?"left"===Qe:void 0},nt.hasAxisInAltrPos=function(Ne,Ge){var Qe=Ge.side;return"xaxis"===Ne?"top"===Qe:"yaxis"===Ne?"right"===Qe:void 0},nt.getLabelPad=function(Ne,Ge){var Qe=1.5,tt=Ge.title.font.size,rt=Ge.showticklabels;return"xaxis"===Ne?"top"===Ge.side?tt*(Qe+(rt?1:0))-10:tt*(Qe+(rt?.5:0))-10:"yaxis"===Ne?"right"===Ge.side?10+tt*(Qe+(rt?1:.5)):10+tt*(Qe+(rt?.5:0)):void 0},nt.getTickPad=function(Ne){return"outside"===Ne.ticks?10+Ne.ticklen:15},nt.getTickMarkLength=function(Ne){if(!Ne.ticks)return 0;var Ge=Ne.ticklen;return"inside"===Ne.ticks?-Ge:Ge},Ge.exports=createAxes2D},{"../../lib/str2rgbarray":802,"../cartesian/axes":828}],868:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plot_api/edit_types").overrideAll,rt=Ne("./scene2d"),nt=Ne("../layout_attributes"),at=Ne("../../constants/xmlns_namespaces"),it=Ne("../cartesian/constants"),ot=Ne("../cartesian"),dt=Ne("../../components/fx/layout_attributes"),ht=Ne("../get_data").getSubplotData;Qe.name="gl2d",Qe.attr=["xaxis","yaxis"],Qe.idRoot=["x","y"],Qe.idRegex=it.idRegex,Qe.attrRegex=it.attrRegex,Qe.attributes=Ne("../cartesian/attributes"),Qe.supplyLayoutDefaults=function(Ne,Ge,Qe){Ge._has("cartesian")||ot.supplyLayoutDefaults(Ne,Ge,Qe)},Qe.layoutAttrOverrides=tt(ot.layoutAttributes,"plot","from-root"),Qe.baseLayoutAttrOverrides=tt({plot_bgcolor:nt.plot_bgcolor,hoverlabel:dt.hoverlabel},"plot","nested"),Qe.plot=function(Ne){for(var Ge=Ne._fullLayout,Qe=Ne._fullData,tt=Ge._subplots.gl2d,nt=0;nt<tt.length;nt++){var at=tt[nt],it=Ge._plots[at],ot=ht(Qe,"gl2d",at),dt=it._scene2d;void 0===dt&&(dt=new rt({id:at,graphDiv:Ne,container:Ne.querySelector(".gl-container"),staticPlot:Ne._context.staticPlot,plotGlPixelRatio:Ne._context.plotGlPixelRatio},Ge),it._scene2d=dt),dt.plot(ot,Ne.calcdata,Ge,Ne.layout)}},Qe.clean=function(Ne,Ge,Qe,tt){for(var rt=tt._subplots.gl2d||[],nt=0;nt<rt.length;nt++){var at=rt[nt],it=tt._plots[at];it._scene2d&&0===ht(Ne,"gl2d",at).length&&(it._scene2d.destroy(),delete tt._plots[at])}ot.clean.apply(this,arguments)},Qe.drawFramework=function(Ne){Ne._context.staticPlot||ot.drawFramework(Ne)},Qe.toSVG=function(Ne){for(var Ge=Ne._fullLayout,Qe=Ge._subplots.gl2d,tt=0;tt<Qe.length;tt++){var rt=Ge._plots[Qe[tt]]._scene2d,nt=rt.toImage("png");Ge._glimages.append("svg:image").attr({xmlns:at.svg,"xlink:href":nt,x:0,y:0,width:"100%",height:"100%",preserveAspectRatio:"none"}),rt.destroy()}},Qe.updateFx=function(Ne){for(var Ge=Ne._fullLayout,Qe=Ge._subplots.gl2d,tt=0;tt<Qe.length;tt++)Ge._plots[Qe[tt]]._scene2d.updateFx(Ge.dragmode)}},{"../../components/fx/layout_attributes":684,"../../constants/xmlns_namespaces":754,"../../plot_api/edit_types":810,"../cartesian":841,"../cartesian/attributes":826,"../cartesian/constants":834,"../get_data":865,"../layout_attributes":882,"./scene2d":869}],869:[function(Ne,Ge,Qe){"use strict";var tt,rt,nt=Ne("../../registry"),at=Ne("../../plots/cartesian/axes"),it=Ne("../../components/fx"),ot=Ne("gl-plot2d"),dt=Ne("gl-spikes2d"),ht=Ne("gl-select-box"),Dt=Ne("webgl-context"),Ot=Ne("./convert"),Rt=Ne("./camera"),Zt=Ne("../../lib/show_no_webgl_msg"),er=Ne("../cartesian/constraints"),dr=er.enforce,mr=er.clean,xr=Ne("../cartesian/autorange").doAutoRange,br=Ne("../../components/dragelement/helpers"),Ar=br.drawMode,en=br.selectMode,mn=["xaxis","yaxis"],xn=Ne("../cartesian/constants").SUBPLOT_PATTERN;function Scene2D(Ne,Ge){this.container=Ne.container,this.graphDiv=Ne.graphDiv,this.pixelRatio=Ne.plotGlPixelRatio||window.devicePixelRatio,this.id=Ne.id,this.staticPlot=!!Ne.staticPlot,this.scrollZoom=this.graphDiv._context._scrollZoom.cartesian,this.fullData=null,this.updateRefs(Ge),this.makeFramework(),this.stopped||(this.glplotOptions=Ot(this),this.glplotOptions.merge(Ge),this.glplot=ot(this.glplotOptions),this.camera=Rt(this),this.traces={},this.spikes=dt(this.glplot),this.selectBox=ht(this.glplot,{innerFill:!1,outerFill:!0}),this.lastButtonState=0,this.pickResult=null,this.isMouseOver=!0,this.stopped=!1,this.redraw=this.draw.bind(this),this.redraw())}Ge.exports=Scene2D;var kn=Scene2D.prototype;function compareTicks(Ne,Ge){for(var Qe=0;Qe<2;++Qe){var tt=Ne[Qe],rt=Ge[Qe];if(tt.length!==rt.length)return!0;for(var nt=0;nt<tt.length;++nt)if(tt[nt].x!==rt[nt].x)return!0}return!1}kn.makeFramework=function(){if(this.staticPlot){if(!(rt||(tt=document.createElement("canvas"),rt=Dt({canvas:tt,preserveDrawingBuffer:!1,premultipliedAlpha:!0,antialias:!0}))))throw new Error("Error creating static canvas/context for image server");this.canvas=tt,this.gl=rt}else{var Ne=this.container.querySelector(".gl-canvas-focus"),Ge=Dt({canvas:Ne,preserveDrawingBuffer:!0,premultipliedAlpha:!0});if(!Ge)return Zt(this),void(this.stopped=!0);this.canvas=Ne,this.gl=Ge}var Qe=this.canvas;Qe.style.width="100%",Qe.style.height="100%",Qe.style.position="absolute",Qe.style.top="0px",Qe.style.left="0px",Qe.style["pointer-events"]="none",this.updateSize(Qe);var nt=this.svgContainer=document.createElementNS("http://www.w3.org/2000/svg","svg");nt.style.position="absolute",nt.style.top=nt.style.left="0px",nt.style.width=nt.style.height="100%",nt.style["z-index"]=20,nt.style["pointer-events"]="none";var at=this.mouseContainer=document.createElement("div");at.style.position="absolute",at.style["pointer-events"]="auto",this.pickCanvas=this.container.querySelector(".gl-canvas-pick");var it=this.container;it.appendChild(nt),it.appendChild(at);var ot=this;at.addEventListener("mouseout",(function(){ot.isMouseOver=!1,ot.unhover()})),at.addEventListener("mouseover",(function(){ot.isMouseOver=!0}))},kn.toImage=function(Ne){Ne||(Ne="png"),this.stopped=!0,this.staticPlot&&this.container.appendChild(tt),this.updateSize(this.canvas);var Ge=this.glplot.gl,Qe=Ge.drawingBufferWidth,rt=Ge.drawingBufferHeight;Ge.clearColor(1,1,1,0),Ge.clear(Ge.COLOR_BUFFER_BIT|Ge.DEPTH_BUFFER_BIT),this.glplot.setDirty(),this.glplot.draw(),Ge.bindFramebuffer(Ge.FRAMEBUFFER,null);var nt=new Uint8Array(Qe*rt*4);Ge.readPixels(0,0,Qe,rt,Ge.RGBA,Ge.UNSIGNED_BYTE,nt);for(var at=0,it=rt-1;at<it;++at,--it)for(var ot=0;ot<Qe;++ot)for(var dt=0;dt<4;++dt){var ht=nt[4*(Qe*at+ot)+dt];nt[4*(Qe*at+ot)+dt]=nt[4*(Qe*it+ot)+dt],nt[4*(Qe*it+ot)+dt]=ht}var Dt=document.createElement("canvas");Dt.width=Qe,Dt.height=rt;var Ot,Rt=Dt.getContext("2d"),Zt=Rt.createImageData(Qe,rt);switch(Zt.data.set(nt),Rt.putImageData(Zt,0,0),Ne){case"jpeg":Ot=Dt.toDataURL("image/jpeg");break;case"webp":Ot=Dt.toDataURL("image/webp");break;default:Ot=Dt.toDataURL("image/png")}return this.staticPlot&&this.container.removeChild(tt),Ot},kn.updateSize=function(Ne){Ne||(Ne=this.canvas);var Ge=this.pixelRatio,Qe=this.fullLayout,tt=Qe.width,rt=Qe.height,nt=0|Math.ceil(Ge*tt),at=0|Math.ceil(Ge*rt);return Ne.width===nt&&Ne.height===at||(Ne.width=nt,Ne.height=at),Ne},kn.computeTickMarks=function(){this.xaxis.setScale(),this.yaxis.setScale();for(var Ne=[at.calcTicks(this.xaxis),at.calcTicks(this.yaxis)],Ge=0;Ge<2;++Ge)for(var Qe=0;Qe<Ne[Ge].length;++Qe)Ne[Ge][Qe].text=Ne[Ge][Qe].text+"";return Ne},kn.updateRefs=function(Ne){this.fullLayout=Ne;var Ge=this.id.match(xn),Qe="xaxis"+Ge[1],tt="yaxis"+Ge[2];this.xaxis=this.fullLayout[Qe],this.yaxis=this.fullLayout[tt]},kn.relayoutCallback=function(){var Ne=this.graphDiv,Ge=this.xaxis,Qe=this.yaxis,tt=Ne.layout,rt={},at=rt[Ge._name+".range"]=Ge.range.slice(),it=rt[Qe._name+".range"]=Qe.range.slice();rt[Ge._name+".autorange"]=Ge.autorange,rt[Qe._name+".autorange"]=Qe.autorange,nt.call("_storeDirectGUIEdit",Ne.layout,Ne._fullLayout._preGUI,rt);var ot=tt[Ge._name];ot.range=at,ot.autorange=Ge.autorange;var dt=tt[Qe._name];dt.range=it,dt.autorange=Qe.autorange,rt.lastInputTime=this.camera.lastInputTime,Ne.emit("plotly_relayout",rt)},kn.cameraChanged=function(){var Ne=this.camera;this.glplot.setDataBox(this.calcDataBox());var Ge=this.computeTickMarks();compareTicks(Ge,this.glplotOptions.ticks)&&(this.glplotOptions.ticks=Ge,this.glplotOptions.dataBox=Ne.dataBox,this.glplot.update(this.glplotOptions),this.handleAnnotations())},kn.handleAnnotations=function(){for(var Ne=this.graphDiv,Ge=this.fullLayout.annotations,Qe=0;Qe<Ge.length;Qe++){var tt=Ge[Qe];tt.xref===this.xaxis._id&&tt.yref===this.yaxis._id&&nt.getComponentMethod("annotations","drawOne")(Ne,Qe)}},kn.destroy=function(){if(this.glplot){var Ne=this.traces;Ne&&Object.keys(Ne).map((function(Ge){Ne[Ge].dispose(),delete Ne[Ge]})),this.glplot.dispose(),this.container.removeChild(this.svgContainer),this.container.removeChild(this.mouseContainer),this.fullData=null,this.glplot=null,this.stopped=!0,this.camera.mouseListener.enabled=!1,this.mouseContainer.removeEventListener("wheel",this.camera.wheelListener),this.camera=null}},kn.plot=function(Ne,Ge,Qe){var tt=this.glplot;this.updateRefs(Qe),this.xaxis.clearCalc(),this.yaxis.clearCalc(),this.updateTraces(Ne,Ge),this.updateFx(Qe.dragmode);var rt=Qe.width,nt=Qe.height;this.updateSize(this.canvas);var at=this.glplotOptions;at.merge(Qe),at.screenBox=[0,0,rt,nt];var it={_fullLayout:{_axisConstraintGroups:this.graphDiv._fullLayout._axisConstraintGroups,xaxis:this.xaxis,yaxis:this.yaxis}};mr(it,this.xaxis),mr(it,this.yaxis);var ot,dt,ht=Qe._size,Dt=this.xaxis.domain,Ot=this.yaxis.domain;for(at.viewBox=[ht.l+Dt[0]*ht.w,ht.b+Ot[0]*ht.h,rt-ht.r-(1-Dt[1])*ht.w,nt-ht.t-(1-Ot[1])*ht.h],this.mouseContainer.style.width=ht.w*(Dt[1]-Dt[0])+"px",this.mouseContainer.style.height=ht.h*(Ot[1]-Ot[0])+"px",this.mouseContainer.height=ht.h*(Ot[1]-Ot[0]),this.mouseContainer.style.left=ht.l+Dt[0]*ht.w+"px",this.mouseContainer.style.top=ht.t+(1-Ot[1])*ht.h+"px",dt=0;dt<2;++dt)(ot=this[mn[dt]])._length=at.viewBox[dt+2]-at.viewBox[dt],xr(this.graphDiv,ot),ot.setScale();dr(it),at.ticks=this.computeTickMarks(),at.dataBox=this.calcDataBox(),at.merge(Qe),tt.update(at),this.glplot.draw()},kn.calcDataBox=function(){var Ne=this.xaxis,Ge=this.yaxis,Qe=Ne.range,tt=Ge.range,rt=Ne.r2l,nt=Ge.r2l;return[rt(Qe[0]),nt(tt[0]),rt(Qe[1]),nt(tt[1])]},kn.setRanges=function(Ne){var Ge=this.xaxis,Qe=this.yaxis,tt=Ge.l2r,rt=Qe.l2r;Ge.range=[tt(Ne[0]),tt(Ne[2])],Qe.range=[rt(Ne[1]),rt(Ne[3])]},kn.updateTraces=function(Ne,Ge){var Qe,tt,rt,nt=Object.keys(this.traces);this.fullData=Ne;e:for(Qe=0;Qe<nt.length;Qe++){var at=nt[Qe],it=this.traces[at];for(tt=0;tt<Ne.length;tt++)if((rt=Ne[tt]).uid===at&&rt.type===it.type)continue e;it.dispose(),delete this.traces[at]}for(Qe=0;Qe<Ne.length;Qe++){rt=Ne[Qe];var ot=Ge[Qe],dt=this.traces[rt.uid];dt?dt.update(rt,ot):(dt=rt._module.plot(this,rt,ot),this.traces[rt.uid]=dt)}this.glplot.objects.sort((function(Ne,Ge){return Ne._trace.index-Ge._trace.index}))},kn.updateFx=function(Ne){en(Ne)||Ar(Ne)?(this.pickCanvas.style["pointer-events"]="none",this.mouseContainer.style["pointer-events"]="none"):(this.pickCanvas.style["pointer-events"]="auto",this.mouseContainer.style["pointer-events"]="auto"),this.mouseContainer.style.cursor="pan"===Ne?"move":"zoom"===Ne?"crosshair":null},kn.emitPointAction=function(Ne,Ge){for(var Qe,tt=Ne.trace.uid,rt=Ne.pointIndex,nt=0;nt<this.fullData.length;nt++)this.fullData[nt].uid===tt&&(Qe=this.fullData[nt]);var at={x:Ne.traceCoord[0],y:Ne.traceCoord[1],curveNumber:Qe.index,pointNumber:rt,data:Qe._input,fullData:this.fullData,xaxis:this.xaxis,yaxis:this.yaxis};it.appendArrayPointValue(at,Qe,rt),this.graphDiv.emit(Ge,{points:[at]})},kn.draw=function(){if(!this.stopped){requestAnimationFrame(this.redraw);var Ne=this.glplot,Ge=this.camera,Qe=Ge.mouseListener,tt=1===this.lastButtonState&&0===Qe.buttons,rt=this.fullLayout;this.lastButtonState=Qe.buttons,this.cameraChanged();var nt,at=Qe.x*Ne.pixelRatio,ot=this.canvas.height-Ne.pixelRatio*Qe.y;if(Ge.boxEnabled&&"zoom"===rt.dragmode){this.selectBox.enabled=!0;for(var dt=this.selectBox.selectBox=[Math.min(Ge.boxStart[0],Ge.boxEnd[0]),Math.min(Ge.boxStart[1],Ge.boxEnd[1]),Math.max(Ge.boxStart[0],Ge.boxEnd[0]),Math.max(Ge.boxStart[1],Ge.boxEnd[1])],ht=0;ht<2;ht++)Ge.boxStart[ht]===Ge.boxEnd[ht]&&(dt[ht]=Ne.dataBox[ht],dt[ht+2]=Ne.dataBox[ht+2]);Ne.setDirty()}else if(!Ge.panning&&this.isMouseOver){this.selectBox.enabled=!1;var Dt=rt._size,Ot=this.xaxis.domain,Rt=this.yaxis.domain,Zt=(nt=Ne.pick(at/Ne.pixelRatio+Dt.l+Ot[0]*Dt.w,ot/Ne.pixelRatio-(Dt.t+(1-Rt[1])*Dt.h)))&&nt.object._trace.handlePick(nt);if(Zt&&tt&&this.emitPointAction(Zt,"plotly_click"),nt&&"skip"!==nt.object._trace.hoverinfo&&rt.hovermode&&Zt&&(!this.lastPickResult||this.lastPickResult.traceUid!==Zt.trace.uid||this.lastPickResult.dataCoord[0]!==Zt.dataCoord[0]||this.lastPickResult.dataCoord[1]!==Zt.dataCoord[1])){var er=Zt;this.lastPickResult={traceUid:Zt.trace?Zt.trace.uid:null,dataCoord:Zt.dataCoord.slice()},this.spikes.update({center:nt.dataCoord}),er.screenCoord=[((Ne.viewBox[2]-Ne.viewBox[0])*(nt.dataCoord[0]-Ne.dataBox[0])/(Ne.dataBox[2]-Ne.dataBox[0])+Ne.viewBox[0])/Ne.pixelRatio,(this.canvas.height-(Ne.viewBox[3]-Ne.viewBox[1])*(nt.dataCoord[1]-Ne.dataBox[1])/(Ne.dataBox[3]-Ne.dataBox[1])-Ne.viewBox[1])/Ne.pixelRatio],this.emitPointAction(Zt,"plotly_hover");var dr=this.fullData[er.trace.index]||{},mr=er.pointIndex,xr=it.castHoverinfo(dr,rt,mr);if(xr&&"all"!==xr){var br=xr.split("+");-1===br.indexOf("x")&&(er.traceCoord[0]=void 0),-1===br.indexOf("y")&&(er.traceCoord[1]=void 0),-1===br.indexOf("z")&&(er.traceCoord[2]=void 0),-1===br.indexOf("text")&&(er.textLabel=void 0),-1===br.indexOf("name")&&(er.name=void 0)}it.loneHover({x:er.screenCoord[0],y:er.screenCoord[1],xLabel:this.hoverFormatter("xaxis",er.traceCoord[0]),yLabel:this.hoverFormatter("yaxis",er.traceCoord[1]),zLabel:er.traceCoord[2],text:er.textLabel,name:er.name,color:it.castHoverOption(dr,mr,"bgcolor")||er.color,borderColor:it.castHoverOption(dr,mr,"bordercolor"),fontFamily:it.castHoverOption(dr,mr,"font.family"),fontSize:it.castHoverOption(dr,mr,"font.size"),fontColor:it.castHoverOption(dr,mr,"font.color"),nameLength:it.castHoverOption(dr,mr,"namelength"),textAlign:it.castHoverOption(dr,mr,"align")},{container:this.svgContainer,gd:this.graphDiv})}}nt||this.unhover(),Ne.draw()}},kn.unhover=function(){this.lastPickResult&&(this.spikes.update({}),this.lastPickResult=null,this.graphDiv.emit("plotly_unhover"),it.loneUnhover(this.svgContainer))},kn.hoverFormatter=function(Ne,Ge){if(void 0!==Ge){var Qe=this[Ne];return at.tickText(Qe,Qe.c2l(Ge),"hover").text}}},{"../../components/dragelement/helpers":661,"../../components/fx":683,"../../lib/show_no_webgl_msg":800,"../../plots/cartesian/axes":828,"../../registry":911,"../cartesian/autorange":827,"../cartesian/constants":834,"../cartesian/constraints":835,"./camera":866,"./convert":867,"gl-plot2d":317,"gl-select-box":333,"gl-spikes2d":342,"webgl-context":606}],870:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plot_api/edit_types").overrideAll,rt=Ne("../../components/fx/layout_attributes"),nt=Ne("./scene"),at=Ne("../get_data").getSubplotData,it=Ne("../../lib"),ot=Ne("../../constants/xmlns_namespaces"),dt="gl3d",ht="scene";Qe.name=dt,Qe.attr=ht,Qe.idRoot=ht,Qe.idRegex=Qe.attrRegex=it.counterRegex("scene"),Qe.attributes=Ne("./layout/attributes"),Qe.layoutAttributes=Ne("./layout/layout_attributes"),Qe.baseLayoutAttrOverrides=tt({hoverlabel:rt.hoverlabel},"plot","nested"),Qe.supplyLayoutDefaults=Ne("./layout/defaults"),Qe.plot=function(Ne){for(var Ge=Ne._fullLayout,Qe=Ne._fullData,tt=Ge._subplots[dt],rt=0;rt<tt.length;rt++){var it=tt[rt],ot=at(Qe,dt,it),ht=Ge[it],Dt=ht.camera,Ot=ht._scene;Ot||(Ot=new nt({id:it,graphDiv:Ne,container:Ne.querySelector(".gl-container"),staticPlot:Ne._context.staticPlot,plotGlPixelRatio:Ne._context.plotGlPixelRatio,camera:Dt},Ge),ht._scene=Ot),Ot.viewInitial||(Ot.viewInitial={up:{x:Dt.up.x,y:Dt.up.y,z:Dt.up.z},eye:{x:Dt.eye.x,y:Dt.eye.y,z:Dt.eye.z},center:{x:Dt.center.x,y:Dt.center.y,z:Dt.center.z}}),Ot.plot(ot,Ge,Ne.layout)}},Qe.clean=function(Ne,Ge,Qe,tt){for(var rt=tt._subplots[dt]||[],nt=0;nt<rt.length;nt++){var at=rt[nt];!Ge[at]&&tt[at]._scene&&(tt[at]._scene.destroy(),tt._infolayer&&tt._infolayer.selectAll(".annotation-"+at).remove())}},Qe.toSVG=function(Ne){for(var Ge=Ne._fullLayout,Qe=Ge._subplots[dt],tt=Ge._size,rt=0;rt<Qe.length;rt++){var nt=Ge[Qe[rt]],at=nt.domain,it=nt._scene,ht=it.toImage("png");Ge._glimages.append("svg:image").attr({xmlns:ot.svg,"xlink:href":ht,x:tt.l+tt.w*at.x[0],y:tt.t+tt.h*(1-at.y[1]),width:tt.w*(at.x[1]-at.x[0]),height:tt.h*(at.y[1]-at.y[0]),preserveAspectRatio:"none"}),it.destroy()}},Qe.cleanId=function(Ne){if(Ne.match(/^scene[0-9]*$/)){var Ge=Ne.substr(5);return"1"===Ge&&(Ge=""),ht+Ge}},Qe.updateFx=function(Ne){for(var Ge=Ne._fullLayout,Qe=Ge._subplots[dt],tt=0;tt<Qe.length;tt++)Ge[Qe[tt]]._scene.updateFx(Ge.dragmode,Ge.hovermode)}},{"../../components/fx/layout_attributes":684,"../../constants/xmlns_namespaces":754,"../../lib":778,"../../plot_api/edit_types":810,"../get_data":865,"./layout/attributes":871,"./layout/defaults":875,"./layout/layout_attributes":876,"./scene":880}],871:[function(Ne,Ge,Qe){"use strict";Ge.exports={scene:{valType:"subplotid",dflt:"scene",editType:"calc+clearAxisTypes"}}},{}],872:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../../components/color"),rt=Ne("../../cartesian/layout_attributes"),nt=Ne("../../../lib/extend").extendFlat,at=Ne("../../../plot_api/edit_types").overrideAll;Ge.exports=at({visible:rt.visible,showspikes:{valType:"boolean",dflt:!0},spikesides:{valType:"boolean",dflt:!0},spikethickness:{valType:"number",min:0,dflt:2},spikecolor:{valType:"color",dflt:tt.defaultLine},showbackground:{valType:"boolean",dflt:!1},backgroundcolor:{valType:"color",dflt:"rgba(204, 204, 204, 0.5)"},showaxeslabels:{valType:"boolean",dflt:!0},color:rt.color,categoryorder:rt.categoryorder,categoryarray:rt.categoryarray,title:{text:rt.title.text,font:rt.title.font},type:nt({},rt.type,{values:["-","linear","log","date","category"]}),autotypenumbers:rt.autotypenumbers,autorange:rt.autorange,rangemode:rt.rangemode,range:nt({},rt.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],anim:!1}),tickmode:rt.tickmode,nticks:rt.nticks,tick0:rt.tick0,dtick:rt.dtick,tickvals:rt.tickvals,ticktext:rt.ticktext,ticks:rt.ticks,mirror:rt.mirror,ticklen:rt.ticklen,tickwidth:rt.tickwidth,tickcolor:rt.tickcolor,showticklabels:rt.showticklabels,tickfont:rt.tickfont,tickangle:rt.tickangle,tickprefix:rt.tickprefix,showtickprefix:rt.showtickprefix,ticksuffix:rt.ticksuffix,showticksuffix:rt.showticksuffix,showexponent:rt.showexponent,exponentformat:rt.exponentformat,minexponent:rt.minexponent,separatethousands:rt.separatethousands,tickformat:rt.tickformat,tickformatstops:rt.tickformatstops,hoverformat:rt.hoverformat,showline:rt.showline,linecolor:rt.linecolor,linewidth:rt.linewidth,showgrid:rt.showgrid,gridcolor:nt({},rt.gridcolor,{dflt:"rgb(204, 204, 204)"}),gridwidth:rt.gridwidth,zeroline:rt.zeroline,zerolinecolor:rt.zerolinecolor,zerolinewidth:rt.zerolinewidth,_deprecated:{title:rt._deprecated.title,titlefont:rt._deprecated.titlefont}},"plot","from-root")},{"../../../components/color":643,"../../../lib/extend":768,"../../../plot_api/edit_types":810,"../../cartesian/layout_attributes":842}],873:[function(Ne,Ge,Qe){"use strict";var tt=Ne("tinycolor2").mix,rt=Ne("../../../lib"),nt=Ne("../../../plot_api/plot_template"),at=Ne("./axis_attributes"),it=Ne("../../cartesian/type_defaults"),ot=Ne("../../cartesian/axis_defaults"),dt=["xaxis","yaxis","zaxis"],ht=13600/187;Ge.exports=function(Ne,Ge,Qe){var Dt,Ot;function coerce(Ne,Ge){return rt.coerce(Dt,Ot,at,Ne,Ge)}for(var Rt=0;Rt<dt.length;Rt++){var Zt=dt[Rt];Dt=Ne[Zt]||{},(Ot=nt.newContainer(Ge,Zt))._id=Zt[0]+Qe.scene,Ot._name=Zt,it(Dt,Ot,coerce,Qe),ot(Dt,Ot,coerce,{font:Qe.font,letter:Zt[0],data:Qe.data,showGrid:!0,noTickson:!0,noTicklabelmode:!0,noTicklabelposition:!0,bgColor:Qe.bgColor,calendar:Qe.calendar},Qe.fullLayout),coerce("gridcolor",tt(Ot.color,Qe.bgColor,ht).toRgbString()),coerce("title.text",Zt[0]),Ot.setScale=rt.noop,coerce("showspikes")&&(coerce("spikesides"),coerce("spikethickness"),coerce("spikecolor",Ot.color)),coerce("showaxeslabels"),coerce("showbackground")&&coerce("backgroundcolor")}}},{"../../../lib":778,"../../../plot_api/plot_template":817,"../../cartesian/axis_defaults":830,"../../cartesian/type_defaults":853,"./axis_attributes":872,tinycolor2:576}],874:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../../lib/str2rgbarray"),rt=Ne("../../../lib"),nt=["xaxis","yaxis","zaxis"];function AxesOptions(){this.bounds=[[-10,-10,-10],[10,10,10]],this.ticks=[[],[],[]],this.tickEnable=[!0,!0,!0],this.tickFont=["sans-serif","sans-serif","sans-serif"],this.tickSize=[12,12,12],this.tickAngle=[0,0,0],this.tickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.tickPad=[18,18,18],this.labels=["x","y","z"],this.labelEnable=[!0,!0,!0],this.labelFont=["Open Sans","Open Sans","Open Sans"],this.labelSize=[20,20,20],this.labelColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.labelPad=[30,30,30],this.lineEnable=[!0,!0,!0],this.lineMirror=[!1,!1,!1],this.lineWidth=[1,1,1],this.lineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.lineTickEnable=[!0,!0,!0],this.lineTickMirror=[!1,!1,!1],this.lineTickLength=[10,10,10],this.lineTickWidth=[1,1,1],this.lineTickColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.gridEnable=[!0,!0,!0],this.gridWidth=[1,1,1],this.gridColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroEnable=[!0,!0,!0],this.zeroLineColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.zeroLineWidth=[2,2,2],this.backgroundEnable=[!0,!0,!0],this.backgroundColor=[[.8,.8,.8,.5],[.8,.8,.8,.5],[.8,.8,.8,.5]],this._defaultTickPad=this.tickPad.slice(),this._defaultLabelPad=this.labelPad.slice(),this._defaultLineTickLength=this.lineTickLength.slice()}function createAxesOptions(Ne,Ge){var Qe=new AxesOptions;return Qe.merge(Ne,Ge),Qe}AxesOptions.prototype.merge=function(Ne,Ge){for(var Qe=this,at=0;at<3;++at){var it=Ge[nt[at]];it.visible?(Qe.labels[at]=Ne._meta?rt.templateString(it.title.text,Ne._meta):it.title.text,"font"in it.title&&(it.title.font.color&&(Qe.labelColor[at]=tt(it.title.font.color)),it.title.font.family&&(Qe.labelFont[at]=it.title.font.family),it.title.font.size&&(Qe.labelSize[at]=it.title.font.size)),"showline"in it&&(Qe.lineEnable[at]=it.showline),"linecolor"in it&&(Qe.lineColor[at]=tt(it.linecolor)),"linewidth"in it&&(Qe.lineWidth[at]=it.linewidth),"showgrid"in it&&(Qe.gridEnable[at]=it.showgrid),"gridcolor"in it&&(Qe.gridColor[at]=tt(it.gridcolor)),"gridwidth"in it&&(Qe.gridWidth[at]=it.gridwidth),"log"===it.type?Qe.zeroEnable[at]=!1:"zeroline"in it&&(Qe.zeroEnable[at]=it.zeroline),"zerolinecolor"in it&&(Qe.zeroLineColor[at]=tt(it.zerolinecolor)),"zerolinewidth"in it&&(Qe.zeroLineWidth[at]=it.zerolinewidth),"ticks"in it&&it.ticks?Qe.lineTickEnable[at]=!0:Qe.lineTickEnable[at]=!1,"ticklen"in it&&(Qe.lineTickLength[at]=Qe._defaultLineTickLength[at]=it.ticklen),"tickcolor"in it&&(Qe.lineTickColor[at]=tt(it.tickcolor)),"tickwidth"in it&&(Qe.lineTickWidth[at]=it.tickwidth),"tickangle"in it&&(Qe.tickAngle[at]="auto"===it.tickangle?-3600:Math.PI*-it.tickangle/180),"showticklabels"in it&&(Qe.tickEnable[at]=it.showticklabels),"tickfont"in it&&(it.tickfont.color&&(Qe.tickColor[at]=tt(it.tickfont.color)),it.tickfont.family&&(Qe.tickFont[at]=it.tickfont.family),it.tickfont.size&&(Qe.tickSize[at]=it.tickfont.size)),"mirror"in it?-1!==["ticks","all","allticks"].indexOf(it.mirror)?(Qe.lineTickMirror[at]=!0,Qe.lineMirror[at]=!0):!0===it.mirror?(Qe.lineTickMirror[at]=!1,Qe.lineMirror[at]=!0):(Qe.lineTickMirror[at]=!1,Qe.lineMirror[at]=!1):Qe.lineMirror[at]=!1,"showbackground"in it&&!1!==it.showbackground?(Qe.backgroundEnable[at]=!0,Qe.backgroundColor[at]=tt(it.backgroundcolor)):Qe.backgroundEnable[at]=!1):(Qe.tickEnable[at]=!1,Qe.labelEnable[at]=!1,Qe.lineEnable[at]=!1,Qe.lineTickEnable[at]=!1,Qe.gridEnable[at]=!1,Qe.zeroEnable[at]=!1,Qe.backgroundEnable[at]=!1)}},Ge.exports=createAxesOptions},{"../../../lib":778,"../../../lib/str2rgbarray":802}],875:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../../lib"),rt=Ne("../../../components/color"),nt=Ne("../../../registry"),at=Ne("../../subplot_defaults"),it=Ne("./axis_defaults"),ot=Ne("./layout_attributes"),dt=Ne("../../get_data").getSubplotData,ht="gl3d";function handleGl3dDefaults(Ne,Ge,Qe,tt){for(var at=Qe("bgcolor"),ot=rt.combine(at,tt.paper_bgcolor),Dt=["up","center","eye"],Ot=0;Ot<Dt.length;Ot++)Qe("camera."+Dt[Ot]+".x"),Qe("camera."+Dt[Ot]+".y"),Qe("camera."+Dt[Ot]+".z");Qe("camera.projection.type");var Rt=!!Qe("aspectratio.x")&&!!Qe("aspectratio.y")&&!!Qe("aspectratio.z"),Zt=Qe("aspectmode",Rt?"manual":"auto");Rt||(Ne.aspectratio=Ge.aspectratio={x:1,y:1,z:1},"manual"===Zt&&(Ge.aspectmode="auto"),Ne.aspectmode=Ge.aspectmode);var er=dt(tt.fullData,ht,tt.id);it(Ne,Ge,{font:tt.font,scene:tt.id,data:er,bgColor:ot,calendar:tt.calendar,autotypenumbersDflt:tt.autotypenumbersDflt,fullLayout:tt.fullLayout}),nt.getComponentMethod("annotations3d","handleDefaults")(Ne,Ge,tt);var dr=tt.getDfltFromLayout("dragmode");if(!1!==dr&&!dr)if(dr="orbit",Ne.camera&&Ne.camera.up){var mr=Ne.camera.up.x,xr=Ne.camera.up.y,br=Ne.camera.up.z;0!==br&&(mr&&xr&&br?br/Math.sqrt(mr*mr+xr*xr+br*br)>.999&&(dr="turntable"):dr="turntable")}else dr="turntable";Qe("dragmode",dr),Qe("hovermode",tt.getDfltFromLayout("hovermode"))}Ge.exports=function(Ne,Ge,Qe){var rt=Ge._basePlotModules.length>1;function getDfltFromLayout(Ge){if(!rt)return tt.validate(Ne[Ge],ot[Ge])?Ne[Ge]:void 0}at(Ne,Ge,Qe,{type:ht,attributes:ot,handleDefaults:handleGl3dDefaults,fullLayout:Ge,font:Ge.font,fullData:Qe,getDfltFromLayout:getDfltFromLayout,autotypenumbersDflt:Ge.autotypenumbers,paper_bgcolor:Ge.paper_bgcolor,calendar:Ge.calendar})}},{"../../../components/color":643,"../../../lib":778,"../../../registry":911,"../../get_data":865,"../../subplot_defaults":905,"./axis_defaults":873,"./layout_attributes":876}],876:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./axis_attributes"),rt=Ne("../../domain").attributes,nt=Ne("../../../lib/extend").extendFlat,at=Ne("../../../lib").counterRegex;function makeCameraVector(Ne,Ge,Qe){return{x:{valType:"number",dflt:Ne,editType:"camera"},y:{valType:"number",dflt:Ge,editType:"camera"},z:{valType:"number",dflt:Qe,editType:"camera"},editType:"camera"}}Ge.exports={_arrayAttrRegexps:[at("scene",".annotations",!0)],bgcolor:{valType:"color",dflt:"rgba(0,0,0,0)",editType:"plot"},camera:{up:nt(makeCameraVector(0,0,1),{}),center:nt(makeCameraVector(0,0,0),{}),eye:nt(makeCameraVector(1.25,1.25,1.25),{}),projection:{type:{valType:"enumerated",values:["perspective","orthographic"],dflt:"perspective",editType:"calc"},editType:"calc"},editType:"camera"},domain:rt({name:"scene",editType:"plot"}),aspectmode:{valType:"enumerated",values:["auto","cube","data","manual"],dflt:"auto",editType:"plot",impliedEdits:{"aspectratio.x":void 0,"aspectratio.y":void 0,"aspectratio.z":void 0}},aspectratio:{x:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},y:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},z:{valType:"number",min:0,editType:"plot",impliedEdits:{"^aspectmode":"manual"}},editType:"plot",impliedEdits:{aspectmode:"manual"}},xaxis:tt,yaxis:tt,zaxis:tt,dragmode:{valType:"enumerated",values:["orbit","turntable","zoom","pan",!1],editType:"plot"},hovermode:{valType:"enumerated",values:["closest",!1],dflt:"closest",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"plot",_deprecated:{cameraposition:{valType:"info_array",editType:"camera"}}}},{"../../../lib":778,"../../../lib/extend":768,"../../domain":855,"./axis_attributes":872}],877:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../../lib/str2rgbarray"),rt=["xaxis","yaxis","zaxis"];function SpikeOptions(){this.enabled=[!0,!0,!0],this.colors=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.drawSides=[!0,!0,!0],this.lineWidth=[1,1,1]}function createSpikeOptions(Ne){var Ge=new SpikeOptions;return Ge.merge(Ne),Ge}SpikeOptions.prototype.merge=function(Ne){for(var Ge=0;Ge<3;++Ge){var Qe=Ne[rt[Ge]];Qe.visible?(this.enabled[Ge]=Qe.showspikes,this.colors[Ge]=tt(Qe.spikecolor),this.drawSides[Ge]=Qe.spikesides,this.lineWidth[Ge]=Qe.spikethickness):(this.enabled[Ge]=!1,this.drawSides[Ge]=!1)}},Ge.exports=createSpikeOptions},{"../../../lib/str2rgbarray":802}],878:[function(Ne,Ge,Qe){"use strict";Ge.exports=computeTickMarks;var tt=Ne("../../cartesian/axes"),rt=Ne("../../../lib"),nt=["xaxis","yaxis","zaxis"],at=[0,0,0];function contourLevelsFromTicks(Ne){for(var Ge=new Array(3),Qe=0;Qe<3;++Qe){for(var tt=Ne[Qe],rt=new Array(tt.length),nt=0;nt<tt.length;++nt)rt[nt]=tt[nt].x;Ge[Qe]=rt}return Ge}function computeTickMarks(Ne){for(var Ge=Ne.axesOptions,Qe=Ne.glplot.axesPixels,it=Ne.fullSceneLayout,ot=[[],[],[]],dt=0;dt<3;++dt){var ht=it[nt[dt]];if(ht._length=(Qe[dt].hi-Qe[dt].lo)*Qe[dt].pixelsPerDataUnit/Ne.dataScale[dt],Math.abs(ht._length)===1/0||isNaN(ht._length))ot[dt]=[];else{ht._input_range=ht.range.slice(),ht.range[0]=Qe[dt].lo/Ne.dataScale[dt],ht.range[1]=Qe[dt].hi/Ne.dataScale[dt],ht._m=1/(Ne.dataScale[dt]*Qe[dt].pixelsPerDataUnit),ht.range[0]===ht.range[1]&&(ht.range[0]-=1,ht.range[1]+=1);var Dt=ht.tickmode;if("auto"===ht.tickmode){ht.tickmode="linear";var Ot=ht.nticks||rt.constrain(ht._length/40,4,9);tt.autoTicks(ht,Math.abs(ht.range[1]-ht.range[0])/Ot)}for(var Rt=tt.calcTicks(ht,{msUTC:!0}),Zt=0;Zt<Rt.length;++Zt)Rt[Zt].x=Rt[Zt].x*Ne.dataScale[dt],"date"===ht.type&&(Rt[Zt].text=Rt[Zt].text.replace(/\<br\>/g," "));ot[dt]=Rt,ht.tickmode=Dt}}for(Ge.ticks=ot,dt=0;dt<3;++dt)for(at[dt]=.5*(Ne.glplot.bounds[0][dt]+Ne.glplot.bounds[1][dt]),Zt=0;Zt<2;++Zt)Ge.bounds[Zt][dt]=Ne.glplot.bounds[Zt][dt];Ne.contourLevels=contourLevelsFromTicks(ot)}},{"../../../lib":778,"../../cartesian/axes":828}],879:[function(Ne,Ge,Qe){"use strict";function xformMatrix(Ne,Ge){var Qe,tt,rt=[0,0,0,0];for(Qe=0;Qe<4;++Qe)for(tt=0;tt<4;++tt)rt[tt]+=Ne[4*Qe+tt]*Ge[Qe];return rt}function project(Ne,Ge){return xformMatrix(Ne.projection,xformMatrix(Ne.view,xformMatrix(Ne.model,[Ge[0],Ge[1],Ge[2],1])))}Ge.exports=project},{}],880:[function(Ne,Ge,Qe){"use strict";var tt,rt,nt=Ne("gl-plot3d"),at=nt.createCamera,it=nt.createScene,ot=Ne("webgl-context"),dt=Ne("has-passive-events"),ht=Ne("../../registry"),Dt=Ne("../../lib"),Ot=Dt.preserveDrawingBuffer(),Rt=Ne("../../plots/cartesian/axes"),Zt=Ne("../../components/fx"),er=Ne("../../lib/str2rgbarray"),dr=Ne("../../lib/show_no_webgl_msg"),mr=Ne("./project"),xr=Ne("./layout/convert"),br=Ne("./layout/spikes"),Ar=Ne("./layout/tick_marks");function Scene(Ne,Ge){var Qe=document.createElement("div"),tt=Ne.container;this.graphDiv=Ne.graphDiv;var rt=document.createElementNS("http://www.w3.org/2000/svg","svg");rt.style.position="absolute",rt.style.top=rt.style.left="0px",rt.style.width=rt.style.height="100%",rt.style["z-index"]=20,rt.style["pointer-events"]="none",Qe.appendChild(rt),this.svgContainer=rt,Qe.id=Ne.id,Qe.style.position="absolute",Qe.style.top=Qe.style.left="0px",Qe.style.width=Qe.style.height="100%",tt.appendChild(Qe),this.fullLayout=Ge,this.id=Ne.id||"scene",this.fullSceneLayout=Ge[this.id],this.plotArgs=[[],{},{}],this.axesOptions=xr(Ge,Ge[this.id]),this.spikeOptions=br(Ge[this.id]),this.container=Qe,this.staticMode=!!Ne.staticPlot,this.pixelRatio=this.pixelRatio||Ne.plotGlPixelRatio||2,this.dataScale=[1,1,1],this.contourLevels=[[],[],[]],this.convertAnnotations=ht.getComponentMethod("annotations3d","convert"),this.drawAnnotations=ht.getComponentMethod("annotations3d","draw"),this.initializeGLPlot()}var en=Scene.prototype;en.prepareOptions=function(){var Ne=this,Ge={canvas:Ne.canvas,gl:Ne.gl,glOptions:{preserveDrawingBuffer:Ot,premultipliedAlpha:!0,antialias:!0},container:Ne.container,axes:Ne.axesOptions,spikes:Ne.spikeOptions,pickRadius:10,snapToData:!0,autoScale:!0,autoBounds:!1,cameraObject:Ne.camera,pixelRatio:Ne.pixelRatio};if(Ne.staticMode){if(!(rt||(tt=document.createElement("canvas"),rt=ot({canvas:tt,preserveDrawingBuffer:!0,premultipliedAlpha:!0,antialias:!0}))))throw new Error("error creating static canvas/context for image server");Ge.gl=rt,Ge.canvas=tt}return Ge};var mn=!0;en.tryCreatePlot=function(){var Ne=this,Ge=Ne.prepareOptions(),Qe=!0;try{Ne.glplot=it(Ge)}catch(tt){if(Ne.staticMode||!mn||Ot)Qe=!1;else{Dt.warn(["webgl setup failed possibly due to","false preserveDrawingBuffer config.","The mobile/tablet device may not be detected by is-mobile module.","Enabling preserveDrawingBuffer in second attempt to create webgl scene..."].join(" "));try{Ot=Ge.glOptions.preserveDrawingBuffer=!0,Ne.glplot=it(Ge)}catch(Ne){Ot=Ge.glOptions.preserveDrawingBuffer=!1,Qe=!1}}}return mn=!1,Qe},en.initializeGLCamera=function(){var Ne=this,Ge=Ne.fullSceneLayout.camera,Qe="orthographic"===Ge.projection.type;Ne.camera=at(Ne.container,{center:[Ge.center.x,Ge.center.y,Ge.center.z],eye:[Ge.eye.x,Ge.eye.y,Ge.eye.z],up:[Ge.up.x,Ge.up.y,Ge.up.z],_ortho:Qe,zoomMin:.01,zoomMax:100,mode:"orbit"})},en.initializeGLPlot=function(){var Ne=this;if(Ne.initializeGLCamera(),!Ne.tryCreatePlot())return dr(Ne);Ne.traces={},Ne.make4thDimension();var Ge=Ne.graphDiv,Qe=Ge.layout,makeUpdate=function(){var Ge={};return Ne.isCameraChanged(Qe)&&(Ge[Ne.id+".camera"]=Ne.getCamera()),Ne.isAspectChanged(Qe)&&(Ge[Ne.id+".aspectratio"]=Ne.glplot.getAspectratio(),"manual"!==Qe[Ne.id].aspectmode&&(Ne.fullSceneLayout.aspectmode=Qe[Ne.id].aspectmode=Ge[Ne.id+".aspectmode"]="manual")),Ge},relayoutCallback=function(Ne){if(!1!==Ne.fullSceneLayout.dragmode){var Ge=makeUpdate();Ne.saveLayout(Qe),Ne.graphDiv.emit("plotly_relayout",Ge)}};return Ne.glplot.canvas&&(Ne.glplot.canvas.addEventListener("mouseup",(function(){relayoutCallback(Ne)})),Ne.glplot.canvas.addEventListener("wheel",(function(Qe){if(Ge._context._scrollZoom.gl3d){if(Ne.camera._ortho){var tt=Qe.deltaX>Qe.deltaY?1.1:1/1.1,rt=Ne.glplot.getAspectratio();Ne.glplot.setAspectratio({x:tt*rt.x,y:tt*rt.y,z:tt*rt.z})}relayoutCallback(Ne)}}),!!dt&&{passive:!1}),Ne.glplot.canvas.addEventListener("mousemove",(function(){if(!1!==Ne.fullSceneLayout.dragmode&&0!==Ne.camera.mouseListener.buttons){var Ge=makeUpdate();Ne.graphDiv.emit("plotly_relayouting",Ge)}})),Ne.staticMode||Ne.glplot.canvas.addEventListener("webglcontextlost",(function(Qe){Ge&&Ge.emit&&Ge.emit("plotly_webglcontextlost",{event:Qe,layer:Ne.id})}),!1)),Ne.glplot.oncontextloss=function(){Ne.recoverContext()},Ne.glplot.onrender=function(){Ne.render()},!0},en.render=function(){var Ne,Ge=this,Qe=Ge.graphDiv,tt=Ge.svgContainer,rt=Ge.container.getBoundingClientRect();Qe._fullLayout._calcInverseTransform(Qe);var nt=Qe._fullLayout._invScaleX,at=Qe._fullLayout._invScaleY,it=rt.width*nt,ot=rt.height*at;tt.setAttributeNS(null,"viewBox","0 0 "+it+" "+ot),tt.setAttributeNS(null,"width",it),tt.setAttributeNS(null,"height",ot),Ar(Ge),Ge.glplot.axes.update(Ge.axesOptions);for(var dt,ht=Object.keys(Ge.traces),Ot=null,er=Ge.glplot.selection,dr=0;dr<ht.length;++dr)"skip"!==(Ne=Ge.traces[ht[dr]]).data.hoverinfo&&Ne.handlePick(er)&&(Ot=Ne),Ne.setContourLevels&&Ne.setContourLevels();function formatter(Ne,Qe){var tt=Ge.fullSceneLayout[Ne];return Rt.tickText(tt,tt.d2l(Qe),"hover").text}if(null!==Ot){var xr=mr(Ge.glplot.cameraParams,er.dataCoordinate);Ne=Ot.data;var br,en=Qe._fullData[Ne.index],mn=er.index,xn={xLabel:formatter("xaxis",er.traceCoordinate[0]),yLabel:formatter("yaxis",er.traceCoordinate[1]),zLabel:formatter("zaxis",er.traceCoordinate[2])},kn=Zt.castHoverinfo(en,Ge.fullLayout,mn),Cn=(kn||"").split("+"),En=kn&&"all"===kn;en.hovertemplate||En||(-1===Cn.indexOf("x")&&(xn.xLabel=void 0),-1===Cn.indexOf("y")&&(xn.yLabel=void 0),-1===Cn.indexOf("z")&&(xn.zLabel=void 0),-1===Cn.indexOf("text")&&(er.textLabel=void 0),-1===Cn.indexOf("name")&&(Ot.name=void 0));var Pn=[];"cone"===Ne.type||"streamtube"===Ne.type?(xn.uLabel=formatter("xaxis",er.traceCoordinate[3]),(En||-1!==Cn.indexOf("u"))&&Pn.push("u: "+xn.uLabel),xn.vLabel=formatter("yaxis",er.traceCoordinate[4]),(En||-1!==Cn.indexOf("v"))&&Pn.push("v: "+xn.vLabel),xn.wLabel=formatter("zaxis",er.traceCoordinate[5]),(En||-1!==Cn.indexOf("w"))&&Pn.push("w: "+xn.wLabel),xn.normLabel=er.traceCoordinate[6].toPrecision(3),(En||-1!==Cn.indexOf("norm"))&&Pn.push("norm: "+xn.normLabel),"streamtube"===Ne.type&&(xn.divergenceLabel=er.traceCoordinate[7].toPrecision(3),(En||-1!==Cn.indexOf("divergence"))&&Pn.push("divergence: "+xn.divergenceLabel)),er.textLabel&&Pn.push(er.textLabel),br=Pn.join("<br>")):"isosurface"===Ne.type||"volume"===Ne.type?(xn.valueLabel=Rt.tickText(Ge._mockAxis,Ge._mockAxis.d2l(er.traceCoordinate[3]),"hover").text,Pn.push("value: "+xn.valueLabel),er.textLabel&&Pn.push(er.textLabel),br=Pn.join("<br>")):br=er.textLabel;var Dn={x:er.traceCoordinate[0],y:er.traceCoordinate[1],z:er.traceCoordinate[2],data:en._input,fullData:en,curveNumber:en.index,pointNumber:mn};Zt.appendArrayPointValue(Dn,en,mn),Ne._module.eventData&&(Dn=en._module.eventData(Dn,er,en,{},mn));var In={points:[Dn]};Ge.fullSceneLayout.hovermode&&Zt.loneHover({trace:en,x:(.5+.5*xr[0]/xr[3])*it,y:(.5-.5*xr[1]/xr[3])*ot,xLabel:xn.xLabel,yLabel:xn.yLabel,zLabel:xn.zLabel,text:br,name:Ot.name,color:Zt.castHoverOption(en,mn,"bgcolor")||Ot.color,borderColor:Zt.castHoverOption(en,mn,"bordercolor"),fontFamily:Zt.castHoverOption(en,mn,"font.family"),fontSize:Zt.castHoverOption(en,mn,"font.size"),fontColor:Zt.castHoverOption(en,mn,"font.color"),nameLength:Zt.castHoverOption(en,mn,"namelength"),textAlign:Zt.castHoverOption(en,mn,"align"),hovertemplate:Dt.castOption(en,mn,"hovertemplate"),hovertemplateLabels:Dt.extendFlat({},Dn,xn),eventData:[Dn]},{container:tt,gd:Qe}),er.buttons&&er.distance<5?Qe.emit("plotly_click",In):Qe.emit("plotly_hover",In),dt=In}else Zt.loneUnhover(tt),Qe.emit("plotly_unhover",dt);Ge.drawAnnotations(Ge)},en.recoverContext=function(){var Ne=this;Ne.glplot.dispose();var tryRecover=function(){Ne.glplot.gl.isContextLost()?requestAnimationFrame(tryRecover):Ne.initializeGLPlot()?Ne.plot.apply(Ne,Ne.plotArgs):Dt.error("Catastrophic and unrecoverable WebGL error. Context lost.")};requestAnimationFrame(tryRecover)};var xn=["xaxis","yaxis","zaxis"];function computeTraceBounds(Ne,Ge,Qe){for(var tt=Ne.fullSceneLayout,rt=0;rt<3;rt++){var nt=xn[rt],at=nt.charAt(0),it=tt[nt],ot=Ge[at],dt=Ge[at+"calendar"],ht=Ge["_"+at+"length"];if(Dt.isArrayOrTypedArray(ot))for(var Ot,Rt=0;Rt<(ht||ot.length);Rt++)if(Dt.isArrayOrTypedArray(ot[Rt]))for(var Zt=0;Zt<ot[Rt].length;++Zt)Ot=it.d2l(ot[Rt][Zt],0,dt),!isNaN(Ot)&&isFinite(Ot)&&(Qe[0][rt]=Math.min(Qe[0][rt],Ot),Qe[1][rt]=Math.max(Qe[1][rt],Ot));else Ot=it.d2l(ot[Rt],0,dt),!isNaN(Ot)&&isFinite(Ot)&&(Qe[0][rt]=Math.min(Qe[0][rt],Ot),Qe[1][rt]=Math.max(Qe[1][rt],Ot));else Qe[0][rt]=Math.min(Qe[0][rt],0),Qe[1][rt]=Math.max(Qe[1][rt],ht-1)}}function computeAnnotationBounds(Ne,Ge){for(var Qe=Ne.fullSceneLayout,tt=Qe.annotations||[],rt=0;rt<3;rt++)for(var nt=xn[rt],at=nt.charAt(0),it=Qe[nt],ot=0;ot<tt.length;ot++){var dt=tt[ot];if(dt.visible){var ht=it.r2l(dt[at]);!isNaN(ht)&&isFinite(ht)&&(Ge[0][rt]=Math.min(Ge[0][rt],ht),Ge[1][rt]=Math.max(Ge[1][rt],ht))}}}function getCameraArrays(Ne){return[[Ne.eye.x,Ne.eye.y,Ne.eye.z],[Ne.center.x,Ne.center.y,Ne.center.z],[Ne.up.x,Ne.up.y,Ne.up.z]]}function getLayoutCamera(Ne){return{up:{x:Ne.up[0],y:Ne.up[1],z:Ne.up[2]},center:{x:Ne.center[0],y:Ne.center[1],z:Ne.center[2]},eye:{x:Ne.eye[0],y:Ne.eye[1],z:Ne.eye[2]},projection:{type:!0===Ne._ortho?"orthographic":"perspective"}}}function flipPixels(Ne,Ge,Qe){for(var tt=0,rt=Qe-1;tt<rt;++tt,--rt)for(var nt=0;nt<Ge;++nt)for(var at=0;at<4;++at){var it=4*(Ge*tt+nt)+at,ot=4*(Ge*rt+nt)+at,dt=Ne[it];Ne[it]=Ne[ot],Ne[ot]=dt}}function correctRGB(Ne,Ge,Qe){for(var tt=0;tt<Qe;++tt)for(var rt=0;rt<Ge;++rt){var nt=4*(Ge*tt+rt),at=Ne[nt+3];if(at>0)for(var it=255/at,ot=0;ot<3;++ot)Ne[nt+ot]=Math.min(it*Ne[nt+ot],255)}}en.plot=function(Ne,Ge,Qe){var tt=this;if(tt.plotArgs=[Ne,Ge,Qe],!tt.glplot.contextLost){var rt,nt,at,it,ot,dt,ht=Ge[tt.id],Dt=Qe[tt.id];tt.fullLayout=Ge,tt.fullSceneLayout=ht,tt.axesOptions.merge(Ge,ht),tt.spikeOptions.merge(ht),tt.setViewport(ht),tt.updateFx(ht.dragmode,ht.hovermode),tt.camera.enableWheel=tt.graphDiv._context._scrollZoom.gl3d,tt.glplot.setClearColor(er(ht.bgcolor)),tt.setConvert(ot),Ne?Array.isArray(Ne)||(Ne=[Ne]):Ne=[];var Ot=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];for(at=0;at<Ne.length;++at)!0===(rt=Ne[at]).visible&&0!==rt._length&&computeTraceBounds(this,rt,Ot);computeAnnotationBounds(this,Ot);var Rt=[1,1,1];for(it=0;it<3;++it)Ot[1][it]===Ot[0][it]?Rt[it]=1:Rt[it]=1/(Ot[1][it]-Ot[0][it]);for(tt.dataScale=Rt,tt.convertAnnotations(this),at=0;at<Ne.length;++at)!0===(rt=Ne[at]).visible&&0!==rt._length&&((nt=tt.traces[rt.uid])?nt.data.type===rt.type?nt.update(rt):(nt.dispose(),nt=rt._module.plot(this,rt),tt.traces[rt.uid]=nt):(nt=rt._module.plot(this,rt),tt.traces[rt.uid]=nt),nt.name=rt.name);var Zt=Object.keys(tt.traces);e:for(at=0;at<Zt.length;++at){for(it=0;it<Ne.length;++it)if(Ne[it].uid===Zt[at]&&!0===Ne[it].visible&&0!==Ne[it]._length)continue e;(nt=tt.traces[Zt[at]]).dispose(),delete tt.traces[Zt[at]]}tt.glplot.objects.sort((function(Ne,Ge){return Ne._trace.data.index-Ge._trace.data.index}));var dr,mr=[[0,0,0],[0,0,0]],xr=[],br={};for(at=0;at<3;++at){if((dt=(ot=ht[xn[at]]).type)in br?(br[dt].acc*=Rt[at],br[dt].count+=1):br[dt]={acc:Rt[at],count:1},ot.autorange){mr[0][at]=1/0,mr[1][at]=-1/0;var Ar=tt.glplot.objects,en=tt.fullSceneLayout.annotations||[],mn=ot._name.charAt(0);for(it=0;it<Ar.length;it++){var kn=Ar[it],Cn=kn.bounds,En=kn._trace.data._pad||0;"ErrorBars"===kn.constructor.name&&ot._lowerLogErrorBound?mr[0][at]=Math.min(mr[0][at],ot._lowerLogErrorBound):mr[0][at]=Math.min(mr[0][at],Cn[0][at]/Rt[at]-En),mr[1][at]=Math.max(mr[1][at],Cn[1][at]/Rt[at]+En)}for(it=0;it<en.length;it++){var Pn=en[it];if(Pn.visible){var Dn=ot.r2l(Pn[mn]);mr[0][at]=Math.min(mr[0][at],Dn),mr[1][at]=Math.max(mr[1][at],Dn)}}if("rangemode"in ot&&"tozero"===ot.rangemode&&(mr[0][at]=Math.min(mr[0][at],0),mr[1][at]=Math.max(mr[1][at],0)),mr[0][at]>mr[1][at])mr[0][at]=-1,mr[1][at]=1;else{var In=mr[1][at]-mr[0][at];mr[0][at]-=In/32,mr[1][at]+=In/32}if("reversed"===ot.autorange){var zn=mr[0][at];mr[0][at]=mr[1][at],mr[1][at]=zn}}else{var Bn=ot.range;mr[0][at]=ot.r2l(Bn[0]),mr[1][at]=ot.r2l(Bn[1])}mr[0][at]===mr[1][at]&&(mr[0][at]-=1,mr[1][at]+=1),xr[at]=mr[1][at]-mr[0][at],tt.glplot.setBounds(at,{min:mr[0][at]*Rt[at],max:mr[1][at]*Rt[at]})}var Vn=ht.aspectmode;if("cube"===Vn)dr=[1,1,1];else if("manual"===Vn){var Hn=ht.aspectratio;dr=[Hn.x,Hn.y,Hn.z]}else{if("auto"!==Vn&&"data"!==Vn)throw new Error("scene.js aspectRatio was not one of the enumerated types");var qn=[1,1,1];for(at=0;at<3;++at){var Yn=br[dt=(ot=ht[xn[at]]).type];qn[at]=Math.pow(Yn.acc,1/Yn.count)/Rt[at]}dr="data"===Vn||Math.max.apply(null,qn)/Math.min.apply(null,qn)<=4?qn:[1,1,1]}ht.aspectratio.x=Dt.aspectratio.x=dr[0],ht.aspectratio.y=Dt.aspectratio.y=dr[1],ht.aspectratio.z=Dt.aspectratio.z=dr[2],tt.glplot.setAspectratio(ht.aspectratio),tt.viewInitial.aspectratio||(tt.viewInitial.aspectratio={x:ht.aspectratio.x,y:ht.aspectratio.y,z:ht.aspectratio.z}),tt.viewInitial.aspectmode||(tt.viewInitial.aspectmode=ht.aspectmode);var $n=ht.domain||null,ra=Ge._size||null;if($n&&ra){var oa=tt.container.style;oa.position="absolute",oa.left=ra.l+$n.x[0]*ra.w+"px",oa.top=ra.t+(1-$n.y[1])*ra.h+"px",oa.width=ra.w*($n.x[1]-$n.x[0])+"px",oa.height=ra.h*($n.y[1]-$n.y[0])+"px"}tt.glplot.redraw()}},en.destroy=function(){var Ne=this;Ne.glplot&&(Ne.camera.mouseListener.enabled=!1,Ne.container.removeEventListener("wheel",Ne.camera.wheelListener),Ne.camera=null,Ne.glplot.dispose(),Ne.container.parentNode.removeChild(Ne.container),Ne.glplot=null)},en.getCamera=function(){var Ne=this;return Ne.camera.view.recalcMatrix(Ne.camera.view.lastT()),getLayoutCamera(Ne.camera)},en.setViewport=function(Ne){var Ge=this,Qe=Ne.camera;Ge.camera.lookAt.apply(this,getCameraArrays(Qe)),Ge.glplot.setAspectratio(Ne.aspectratio),"orthographic"===Qe.projection.type!==Ge.camera._ortho&&(Ge.glplot.redraw(),Ge.glplot.clearRGBA(),Ge.glplot.dispose(),Ge.initializeGLPlot())},en.isCameraChanged=function(Ne){var Ge=this,Qe=Ge.getCamera(),tt=Dt.nestedProperty(Ne,Ge.id+".camera").get();function same(Ne,Ge,Qe,tt){var rt=["up","center","eye"],nt=["x","y","z"];return Ge[rt[Qe]]&&Ne[rt[Qe]][nt[tt]]===Ge[rt[Qe]][nt[tt]]}var rt=!1;if(void 0===tt)rt=!0;else{for(var nt=0;nt<3;nt++)for(var at=0;at<3;at++)if(!same(Qe,tt,nt,at)){rt=!0;break}(!tt.projection||Qe.projection&&Qe.projection.type!==tt.projection.type)&&(rt=!0)}return rt},en.isAspectChanged=function(Ne){var Ge=this,Qe=Ge.glplot.getAspectratio(),tt=Dt.nestedProperty(Ne,Ge.id+".aspectratio").get();return void 0===tt||tt.x!==Qe.x||tt.y!==Qe.y||tt.z!==Qe.z},en.saveLayout=function(Ne){var Ge,Qe,tt,rt,nt,at,it=this,ot=it.fullLayout,dt=it.isCameraChanged(Ne),Ot=it.isAspectChanged(Ne),Rt=dt||Ot;if(Rt){var Zt={};dt&&(Ge=it.getCamera(),tt=(Qe=Dt.nestedProperty(Ne,it.id+".camera")).get(),Zt[it.id+".camera"]=tt),Ot&&(rt=it.glplot.getAspectratio(),at=(nt=Dt.nestedProperty(Ne,it.id+".aspectratio")).get(),Zt[it.id+".aspectratio"]=at),ht.call("_storeDirectGUIEdit",Ne,ot._preGUI,Zt),dt&&(Qe.set(Ge),Dt.nestedProperty(ot,it.id+".camera").set(Ge)),Ot&&(nt.set(rt),Dt.nestedProperty(ot,it.id+".aspectratio").set(rt),it.glplot.redraw())}return Rt},en.updateFx=function(Ne,Ge){var Qe=this,tt=Qe.camera;if(tt)if("orbit"===Ne)tt.mode="orbit",tt.keyBindingMode="rotate";else if("turntable"===Ne){tt.up=[0,0,1],tt.mode="turntable",tt.keyBindingMode="rotate";var rt=Qe.graphDiv,nt=rt._fullLayout,at=Qe.fullSceneLayout.camera,it=at.up.x,ot=at.up.y,dt=at.up.z;if(dt/Math.sqrt(it*it+ot*ot+dt*dt)<.999){var Ot=Qe.id+".camera.up",Rt={x:0,y:0,z:1},Zt={};Zt[Ot]=Rt;var er=rt.layout;ht.call("_storeDirectGUIEdit",er,nt._preGUI,Zt),at.up=Rt,Dt.nestedProperty(er,Ot).set(Rt)}}else tt.keyBindingMode=Ne;Qe.fullSceneLayout.hovermode=Ge},en.toImage=function(Ne){var Ge=this;Ne||(Ne="png"),Ge.staticMode&&Ge.container.appendChild(tt),Ge.glplot.redraw();var Qe=Ge.glplot.gl,rt=Qe.drawingBufferWidth,nt=Qe.drawingBufferHeight;Qe.bindFramebuffer(Qe.FRAMEBUFFER,null);var at=new Uint8Array(rt*nt*4);Qe.readPixels(0,0,rt,nt,Qe.RGBA,Qe.UNSIGNED_BYTE,at),flipPixels(at,rt,nt),correctRGB(at,rt,nt);var it=document.createElement("canvas");it.width=rt,it.height=nt;var ot,dt=it.getContext("2d"),ht=dt.createImageData(rt,nt);switch(ht.data.set(at),dt.putImageData(ht,0,0),Ne){case"jpeg":ot=it.toDataURL("image/jpeg");break;case"webp":ot=it.toDataURL("image/webp");break;default:ot=it.toDataURL("image/png")}return Ge.staticMode&&Ge.container.removeChild(tt),ot},en.setConvert=function(){for(var Ne=this,Ge=0;Ge<3;Ge++){var Qe=Ne.fullSceneLayout[xn[Ge]];Rt.setConvert(Qe,Ne.fullLayout),Qe.setScale=Dt.noop}},en.make4thDimension=function(){var Ne=this,Ge=Ne.graphDiv._fullLayout;Ne._mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},Rt.setConvert(Ne._mockAxis,Ge)},Ge.exports=Scene},{"../../components/fx":683,"../../lib":778,"../../lib/show_no_webgl_msg":800,"../../lib/str2rgbarray":802,"../../plots/cartesian/axes":828,"../../registry":911,"./layout/convert":874,"./layout/spikes":877,"./layout/tick_marks":878,"./project":879,"gl-plot3d":321,"has-passive-events":441,"webgl-context":606}],881:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge,Qe,tt){tt=tt||Ne.length;for(var rt=new Array(tt),nt=0;nt<tt;nt++)rt[nt]=[Ne[nt],Ge[nt],Qe[nt]];return rt}},{}],882:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./font_attributes"),rt=Ne("./animation_attributes"),nt=Ne("../components/color/attributes"),at=Ne("../components/shapes/draw_newshape/attributes"),it=Ne("./pad_attributes"),ot=Ne("../lib/extend").extendFlat,dt=tt({editType:"calc"});dt.family.dflt='"Open Sans", verdana, arial, sans-serif',dt.size.dflt=12,dt.color.dflt=nt.defaultLine,Ge.exports={font:dt,title:{text:{valType:"string",editType:"layoutstyle"},font:tt({editType:"layoutstyle"}),xref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},yref:{valType:"enumerated",dflt:"container",values:["container","paper"],editType:"layoutstyle"},x:{valType:"number",min:0,max:1,dflt:.5,editType:"layoutstyle"},y:{valType:"number",min:0,max:1,dflt:"auto",editType:"layoutstyle"},xanchor:{valType:"enumerated",dflt:"auto",values:["auto","left","center","right"],editType:"layoutstyle"},yanchor:{valType:"enumerated",dflt:"auto",values:["auto","top","middle","bottom"],editType:"layoutstyle"},pad:ot(it({editType:"layoutstyle"}),{}),editType:"layoutstyle"},uniformtext:{mode:{valType:"enumerated",values:[!1,"hide","show"],dflt:!1,editType:"plot"},minsize:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"plot"},autosize:{valType:"boolean",dflt:!1,editType:"none"},width:{valType:"number",min:10,dflt:700,editType:"plot"},height:{valType:"number",min:10,dflt:450,editType:"plot"},margin:{l:{valType:"number",min:0,dflt:80,editType:"plot"},r:{valType:"number",min:0,dflt:80,editType:"plot"},t:{valType:"number",min:0,dflt:100,editType:"plot"},b:{valType:"number",min:0,dflt:80,editType:"plot"},pad:{valType:"number",min:0,dflt:0,editType:"plot"},autoexpand:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},computed:{valType:"any",editType:"none"},paper_bgcolor:{valType:"color",dflt:nt.background,editType:"plot"},plot_bgcolor:{valType:"color",dflt:nt.background,editType:"layoutstyle"},autotypenumbers:{valType:"enumerated",values:["convert types","strict"],dflt:"convert types",editType:"calc"},separators:{valType:"string",editType:"plot"},hidesources:{valType:"boolean",dflt:!1,editType:"plot"},showlegend:{valType:"boolean",editType:"legend"},colorway:{valType:"colorlist",dflt:nt.defaults,editType:"calc"},datarevision:{valType:"any",editType:"calc"},uirevision:{valType:"any",editType:"none"},editrevision:{valType:"any",editType:"none"},selectionrevision:{valType:"any",editType:"none"},template:{valType:"any",editType:"calc"},modebar:{orientation:{valType:"enumerated",values:["v","h"],dflt:"h",editType:"modebar"},bgcolor:{valType:"color",editType:"modebar"},color:{valType:"color",editType:"modebar"},activecolor:{valType:"color",editType:"modebar"},uirevision:{valType:"any",editType:"none"},editType:"modebar"},newshape:at.newshape,activeshape:at.activeshape,meta:{valType:"any",arrayOk:!0,editType:"plot"},transition:ot({},rt.transition,{editType:"none"}),_deprecated:{title:{valType:"string",editType:"layoutstyle"},titlefont:tt({editType:"layoutstyle"})}}},{"../components/color/attributes":642,"../components/shapes/draw_newshape/attributes":725,"../lib/extend":768,"./animation_attributes":822,"./font_attributes":856,"./pad_attributes":890}],883:[function(Ne,Ge,Qe){"use strict";var tt="1.10.1",rt={"open-street-map":{id:"osm",version:8,sources:{"plotly-osm-tiles":{type:"raster",attribution:'<a href="http://www.openstreetmap.org/about/" target="_blank">Â© OpenStreetMap</a>',tiles:["https://a.tile.openstreetmap.org/{z}/{x}/{y}.png","https://b.tile.openstreetmap.org/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-osm-tiles",type:"raster",source:"plotly-osm-tiles",minzoom:0,maxzoom:22}]},"white-bg":{id:"white-bg",version:8,sources:{},layers:[{id:"white-bg",type:"background",paint:{"background-color":"#FFFFFF"},minzoom:0,maxzoom:22}]},"carto-positron":{id:"carto-positron",version:8,sources:{"plotly-carto-positron":{type:"raster",attribution:'<a href="https://carto.com/" target="_blank">Â© CARTO</a>',tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-positron",type:"raster",source:"plotly-carto-positron",minzoom:0,maxzoom:22}]},"carto-darkmatter":{id:"carto-darkmatter",version:8,sources:{"plotly-carto-darkmatter":{type:"raster",attribution:'<a href="https://carto.com/" target="_blank">Â© CARTO</a>',tiles:["https://cartodb-basemaps-c.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-carto-darkmatter",type:"raster",source:"plotly-carto-darkmatter",minzoom:0,maxzoom:22}]},"stamen-terrain":{id:"stamen-terrain",version:8,sources:{"plotly-stamen-terrain":{type:"raster",attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> | Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.',tiles:["https://stamen-tiles.a.ssl.fastly.net/terrain/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-terrain",type:"raster",source:"plotly-stamen-terrain",minzoom:0,maxzoom:22}]},"stamen-toner":{id:"stamen-toner",version:8,sources:{"plotly-stamen-toner":{type:"raster",attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> | Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.',tiles:["https://stamen-tiles.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-toner",type:"raster",source:"plotly-stamen-toner",minzoom:0,maxzoom:22}]},"stamen-watercolor":{id:"stamen-watercolor",version:8,sources:{"plotly-stamen-watercolor":{type:"raster",attribution:'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> | Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://creativecommons.org/licenses/by-sa/3.0">CC BY SA</a>.',tiles:["https://stamen-tiles.a.ssl.fastly.net/watercolor/{z}/{x}/{y}.png"],tileSize:256}},layers:[{id:"plotly-stamen-watercolor",type:"raster",source:"plotly-stamen-watercolor",minzoom:0,maxzoom:22}]}},nt=Object.keys(rt);Ge.exports={requiredVersion:tt,styleUrlPrefix:"mapbox://styles/mapbox/",styleUrlSuffix:"v9",styleValuesMapbox:["basic","streets","outdoors","light","dark","satellite","satellite-streets"],styleValueDflt:"basic",stylesNonMapbox:rt,styleValuesNonMapbox:nt,traceLayerPrefix:"plotly-trace-layer-",layoutLayerPrefix:"plotly-layout-layer-",wrongVersionErrorMsg:["Your custom plotly.js bundle is not using the correct mapbox-gl version","Please install mapbox-gl@"+tt+"."].join("\n"),noAccessTokenErrorMsg:["Missing Mapbox access token.","Mapbox trace type require a Mapbox access token to be registered.","For example:","  Plotly.plot(gd, data, layout, { mapboxAccessToken: 'my-access-token' });","More info here: https://www.mapbox.com/help/define-access-token/"].join("\n"),missingStyleErrorMsg:["No valid mapbox style found, please set `mapbox.style` to one of:",nt.join(", "),"or register a Mapbox access token to use a Mapbox-served style."].join("\n"),multipleTokensErrorMsg:["Set multiple mapbox access token across different mapbox subplot,","using first token found as mapbox-gl does not allow multipleaccess tokens on the same page."].join("\n"),mapOnErrorMsg:"Mapbox error.",mapboxLogo:{path0:"m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z",path1:"M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z",path2:"M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z",polygon:"11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34"},styleRules:{map:"overflow:hidden;position:relative;","missing-css":"display:none;",canary:"background-color:salmon;","ctrl-bottom-left":"position: absolute; pointer-events: none; z-index: 2; bottom: 0; left: 0;","ctrl-bottom-right":"position: absolute; pointer-events: none; z-index: 2; right: 0; bottom: 0;",ctrl:"clear: both; pointer-events: auto; transform: translate(0, 0);","ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner":"display: none;","ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner":"display: block; margin-top:2px","ctrl-attrib.mapboxgl-compact:hover":"padding: 2px 24px 2px 4px; visibility: visible; margin-top: 6px;","ctrl-attrib.mapboxgl-compact::after":'content: ""; cursor: pointer; position: absolute; background-image: url(\'data:image/svg+xml;charset=utf-8,%3Csvg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"%3E %3Cpath fill="%23333333" fill-rule="evenodd" d="M4,10a6,6 0 1,0 12,0a6,6 0 1,0 -12,0 M9,7a1,1 0 1,0 2,0a1,1 0 1,0 -2,0 M9,10a1,1 0 1,1 2,0l0,3a1,1 0 1,1 -2,0"/%3E %3C/svg%3E\'); background-color: rgba(255, 255, 255, 0.5); width: 24px; height: 24px; box-sizing: border-box; border-radius: 12px;',"ctrl-attrib.mapboxgl-compact":"min-height: 20px; padding: 0; margin: 10px; position: relative; background-color: #fff; border-radius: 3px 12px 12px 3px;","ctrl-bottom-right > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; right: 0","ctrl-bottom-left > .mapboxgl-ctrl-attrib.mapboxgl-compact::after":"bottom: 0; left: 0","ctrl-bottom-left .mapboxgl-ctrl":"margin: 0 0 10px 10px; float: left;","ctrl-bottom-right .mapboxgl-ctrl":"margin: 0 10px 10px 0; float: right;","ctrl-attrib":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a":"color: rgba(0, 0, 0, 0.75); text-decoration: none; font-size: 12px","ctrl-attrib a:hover":"color: inherit; text-decoration: underline;","ctrl-attrib .mapbox-improve-map":"font-weight: bold; margin-left: 2px;","attrib-empty":"display: none;","ctrl-logo":'display:block; width: 21px; height: 21px; background-image: url(\'data:image/svg+xml;charset=utf-8,%3C?xml version="1.0" encoding="utf-8"?%3E %3Csvg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 21 21" style="enable-background:new 0 0 21 21;" xml:space="preserve"%3E%3Cg transform="translate(0,0.01)"%3E%3Cpath d="m 10.5,1.24 c -5.11,0 -9.25,4.15 -9.25,9.25 0,5.1 4.15,9.25 9.25,9.25 5.1,0 9.25,-4.15 9.25,-9.25 0,-5.11 -4.14,-9.25 -9.25,-9.25 z m 4.39,11.53 c -1.93,1.93 -4.78,2.31 -6.7,2.31 -0.7,0 -1.41,-0.05 -2.1,-0.16 0,0 -1.02,-5.64 2.14,-8.81 0.83,-0.83 1.95,-1.28 3.13,-1.28 1.27,0 2.49,0.51 3.39,1.42 1.84,1.84 1.89,4.75 0.14,6.52 z" style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3Cpath d="M 10.5,-0.01 C 4.7,-0.01 0,4.7 0,10.49 c 0,5.79 4.7,10.5 10.5,10.5 5.8,0 10.5,-4.7 10.5,-10.5 C 20.99,4.7 16.3,-0.01 10.5,-0.01 Z m 0,19.75 c -5.11,0 -9.25,-4.15 -9.25,-9.25 0,-5.1 4.14,-9.26 9.25,-9.26 5.11,0 9.25,4.15 9.25,9.25 0,5.13 -4.14,9.26 -9.25,9.26 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpath d="M 14.74,6.25 C 12.9,4.41 9.98,4.35 8.23,6.1 5.07,9.27 6.09,14.91 6.09,14.91 c 0,0 5.64,1.02 8.81,-2.14 C 16.64,11 16.59,8.09 14.74,6.25 Z m -2.27,4.09 -0.91,1.87 -0.9,-1.87 -1.86,-0.91 1.86,-0.9 0.9,-1.87 0.91,1.87 1.86,0.9 z" style="opacity:0.35;enable-background:new" class="st1"/%3E%3Cpolygon points="11.56,12.21 10.66,10.34 8.8,9.43 10.66,8.53 11.56,6.66 12.47,8.53 14.33,9.43 12.47,10.34 " style="opacity:0.9;fill:%23ffffff;enable-background:new" class="st0"/%3E%3C/g%3E%3C/svg%3E\')'}}},{}],884:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib");Ge.exports=function(Ne,Ge){var Qe=Ne.split(" "),rt=Qe[0],nt=Qe[1],at=tt.isArrayOrTypedArray(Ge)?tt.mean(Ge):Ge,it=.5+at/100,ot=1.5+at/100,dt=["",""],ht=[0,0];switch(rt){case"top":dt[0]="top",ht[1]=-ot;break;case"bottom":dt[0]="bottom",ht[1]=ot}switch(nt){case"left":dt[1]="right",ht[0]=-it;break;case"right":dt[1]="left",ht[0]=it}return{anchor:dt[0]&&dt[1]?dt.join("-"):dt[0]?dt[0]:dt[1]?dt[1]:"center",offset:ht}}},{"../../lib":778}],885:[function(Ne,Ge,Qe){"use strict";var tt=Ne("mapbox-gl"),rt=Ne("../../lib"),nt=rt.strTranslate,at=rt.strScale,it=Ne("../../plots/get_data").getSubplotCalcData,ot=Ne("../../constants/xmlns_namespaces"),dt=Ne("d3"),ht=Ne("../../components/drawing"),Dt=Ne("../../lib/svg_text_utils"),Ot=Ne("./mapbox"),Rt="mapbox",Zt=Qe.constants=Ne("./constants");function findAccessToken(Ne,Ge){var Qe=Ne._fullLayout;if(""===Ne._context.mapboxAccessToken)return"";for(var tt=[],nt=[],at=!1,it=!1,ot=0;ot<Ge.length;ot++){var dt=Qe[Ge[ot]],ht=dt.accesstoken;isMapboxStyle(dt.style)&&(ht?rt.pushUnique(tt,ht):(isMapboxStyle(dt._input.style)&&(rt.error("Uses Mapbox map style, but did not set an access token."),at=!0),it=!0)),ht&&rt.pushUnique(nt,ht)}if(it){var Dt=at?Zt.noAccessTokenErrorMsg:Zt.missingStyleErrorMsg;throw rt.error(Dt),new Error(Dt)}return tt.length?(tt.length>1&&rt.warn(Zt.multipleTokensErrorMsg),tt[0]):(nt.length&&rt.log(["Listed mapbox access token(s)",nt.join(","),"but did not use a Mapbox map style, ignoring token(s)."].join(" ")),"")}function isMapboxStyle(Ne){return"string"==typeof Ne&&(-1!==Zt.styleValuesMapbox.indexOf(Ne)||0===Ne.indexOf("mapbox://"))}Qe.name=Rt,Qe.attr="subplot",Qe.idRoot=Rt,Qe.idRegex=Qe.attrRegex=rt.counterRegex(Rt),Qe.attributes={subplot:{valType:"subplotid",dflt:"mapbox",editType:"calc"}},Qe.layoutAttributes=Ne("./layout_attributes"),Qe.supplyLayoutDefaults=Ne("./layout_defaults"),Qe.plot=function(Ne){var Ge=Ne._fullLayout,Qe=Ne.calcdata,nt=Ge._subplots[Rt];if(tt.version!==Zt.requiredVersion)throw new Error(Zt.wrongVersionErrorMsg);var at=findAccessToken(Ne,nt);tt.accessToken=at;for(var ot=0;ot<nt.length;ot++){var dt=nt[ot],ht=it(Qe,Rt,dt),Dt=Ge[dt],er=Dt._subplot;er||(er=new Ot(Ne,dt),Ge[dt]._subplot=er),er.viewInitial||(er.viewInitial={center:rt.extendFlat({},Dt.center),zoom:Dt.zoom,bearing:Dt.bearing,pitch:Dt.pitch}),er.plot(ht,Ge,Ne._promises)}},Qe.clean=function(Ne,Ge,Qe,tt){for(var rt=tt._subplots[Rt]||[],nt=0;nt<rt.length;nt++){var at=rt[nt];!Ge[at]&&tt[at]._subplot&&tt[at]._subplot.destroy()}},Qe.toSVG=function(Ne){for(var Ge=Ne._fullLayout,Qe=Ge._subplots[Rt],tt=Ge._size,rt=0;rt<Qe.length;rt++){var it=Ge[Qe[rt]],Ot=it.domain,er=it._subplot.toImage("png");Ge._glimages.append("svg:image").attr({xmlns:ot.svg,"xlink:href":er,x:tt.l+tt.w*Ot.x[0],y:tt.t+tt.h*(1-Ot.y[1]),width:tt.w*(Ot.x[1]-Ot.x[0]),height:tt.h*(Ot.y[1]-Ot.y[0]),preserveAspectRatio:"none"});var dr=dt.select(it._subplot.div);if(null!==dr.select(".mapboxgl-ctrl-logo").node().offsetParent){var mr=Ge._glimages.append("g");mr.attr("transform",nt(tt.l+tt.w*Ot.x[0]+10,tt.t+tt.h*(1-Ot.y[0])-31)),mr.append("path").attr("d",Zt.mapboxLogo.path0).style({opacity:.9,fill:"#ffffff","enable-background":"new"}),mr.append("path").attr("d",Zt.mapboxLogo.path1).style("opacity",.35).style("enable-background","new"),mr.append("path").attr("d",Zt.mapboxLogo.path2).style("opacity",.35).style("enable-background","new"),mr.append("polygon").attr("points",Zt.mapboxLogo.polygon).style({opacity:.9,fill:"#ffffff","enable-background":"new"})}var xr=dr.select(".mapboxgl-ctrl-attrib").text().replace("Improve this map",""),br=Ge._glimages.append("g"),Ar=br.append("text");Ar.text(xr).classed("static-attribution",!0).attr({"font-size":12,"font-family":"Arial",color:"rgba(0, 0, 0, 0.75)","text-anchor":"end","data-unformatted":xr});var en=ht.bBox(Ar.node()),mn=tt.w*(Ot.x[1]-Ot.x[0]);if(en.width>mn/2){var xn=xr.split("|").join("<br>");Ar.text(xn).attr("data-unformatted",xn).call(Dt.convertToTspans,Ne),en=ht.bBox(Ar.node())}Ar.attr("transform",nt(-3,8-en.height)),br.insert("rect",".static-attribution").attr({x:-en.width-6,y:-en.height-3,width:en.width+6,height:en.height+3,fill:"rgba(255, 255, 255, 0.75)"});var kn=1;en.width+6>mn&&(kn=mn/(en.width+6));var Cn=[tt.l+tt.w*Ot.x[1],tt.t+tt.h*(1-Ot.y[0])];br.attr("transform",nt(Cn[0],Cn[1])+at(kn))}},Qe.updateFx=function(Ne){for(var Ge=Ne._fullLayout,Qe=Ge._subplots[Rt],tt=0;tt<Qe.length;tt++)Ge[Qe[tt]]._subplot.updateFx(Ge)}},{"../../components/drawing":665,"../../constants/xmlns_namespaces":754,"../../lib":778,"../../lib/svg_text_utils":803,"../../plots/get_data":865,"./constants":883,"./layout_attributes":887,"./layout_defaults":888,"./mapbox":889,d3:169,"mapbox-gl":473}],886:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../lib/svg_text_utils").sanitizeHTML,nt=Ne("./convert_text_opts"),at=Ne("./constants");function MapboxLayer(Ne,Ge){this.subplot=Ne,this.uid=Ne.uid+"-"+Ge,this.index=Ge,this.idSource="source-"+this.uid,this.idLayer=at.layoutLayerPrefix+this.uid,this.sourceType=null,this.source=null,this.layerType=null,this.below=null,this.visible=!1}var it=MapboxLayer.prototype;function isVisible(Ne){if(!Ne.visible)return!1;var Ge=Ne.source;if(Array.isArray(Ge)&&Ge.length>0){for(var Qe=0;Qe<Ge.length;Qe++)if("string"!=typeof Ge[Qe]||0===Ge[Qe].length)return!1;return!0}return tt.isPlainObject(Ge)||"string"==typeof Ge&&Ge.length>0}function convertOpts(Ne){var Ge={},Qe={};switch(Ne.type){case"circle":tt.extendFlat(Qe,{"circle-radius":Ne.circle.radius,"circle-color":Ne.color,"circle-opacity":Ne.opacity});break;case"line":tt.extendFlat(Qe,{"line-width":Ne.line.width,"line-color":Ne.color,"line-opacity":Ne.opacity,"line-dasharray":Ne.line.dash});break;case"fill":tt.extendFlat(Qe,{"fill-color":Ne.color,"fill-outline-color":Ne.fill.outlinecolor,"fill-opacity":Ne.opacity});break;case"symbol":var rt=Ne.symbol,at=nt(rt.textposition,rt.iconsize);tt.extendFlat(Ge,{"icon-image":rt.icon+"-15","icon-size":rt.iconsize/10,"text-field":rt.text,"text-size":rt.textfont.size,"text-anchor":at.anchor,"text-offset":at.offset,"symbol-placement":rt.placement}),tt.extendFlat(Qe,{"icon-color":Ne.color,"text-color":rt.textfont.color,"text-opacity":Ne.opacity});break;case"raster":tt.extendFlat(Qe,{"raster-fade-duration":0,"raster-opacity":Ne.opacity})}return{layout:Ge,paint:Qe}}function convertSourceOpts(Ne){var Ge,Qe=Ne.sourcetype,tt=Ne.source,nt={type:Qe};return"geojson"===Qe?Ge="data":"vector"===Qe?Ge="string"==typeof tt?"url":"tiles":"raster"===Qe?(Ge="tiles",nt.tileSize=256):"image"===Qe&&(Ge="url",nt.coordinates=Ne.coordinates),nt[Ge]=tt,Ne.sourceattribution&&(nt.attribution=rt(Ne.sourceattribution)),nt}it.update=function(Ne){this.visible?this.needsNewImage(Ne)?this.updateImage(Ne):this.needsNewSource(Ne)?(this.removeLayer(),this.updateSource(Ne),this.updateLayer(Ne)):this.needsNewLayer(Ne)?this.updateLayer(Ne):this.updateStyle(Ne):(this.updateSource(Ne),this.updateLayer(Ne)),this.visible=isVisible(Ne)},it.needsNewImage=function(Ne){return this.subplot.map.getSource(this.idSource)&&"image"===this.sourceType&&"image"===Ne.sourcetype&&(this.source!==Ne.source||JSON.stringify(this.coordinates)!==JSON.stringify(Ne.coordinates))},it.needsNewSource=function(Ne){return this.sourceType!==Ne.sourcetype||JSON.stringify(this.source)!==JSON.stringify(Ne.source)||this.layerType!==Ne.type},it.needsNewLayer=function(Ne){return this.layerType!==Ne.type||this.below!==this.subplot.belowLookup["layout-"+this.index]},it.lookupBelow=function(){return this.subplot.belowLookup["layout-"+this.index]},it.updateImage=function(Ne){this.subplot.map.getSource(this.idSource).updateImage({url:Ne.source,coordinates:Ne.coordinates});var Ge=this.findFollowingMapboxLayerId(this.lookupBelow());null!==Ge&&this.subplot.map.moveLayer(this.idLayer,Ge)},it.updateSource=function(Ne){var Ge=this.subplot.map;if(Ge.getSource(this.idSource)&&Ge.removeSource(this.idSource),this.sourceType=Ne.sourcetype,this.source=Ne.source,isVisible(Ne)){var Qe=convertSourceOpts(Ne);Ge.addSource(this.idSource,Qe)}},it.findFollowingMapboxLayerId=function(Ne){if("traces"===Ne)for(var Ge=this.subplot.getMapLayers(),Qe=0;Qe<Ge.length;Qe++){var tt=Ge[Qe].id;if("string"==typeof tt&&0===tt.indexOf(at.traceLayerPrefix)){Ne=tt;break}}return Ne},it.updateLayer=function(Ne){var Ge=this.subplot,Qe=convertOpts(Ne),tt=this.lookupBelow(),rt=this.findFollowingMapboxLayerId(tt);this.removeLayer(),isVisible(Ne)&&Ge.addLayer({id:this.idLayer,source:this.idSource,"source-layer":Ne.sourcelayer||"",type:Ne.type,minzoom:Ne.minzoom,maxzoom:Ne.maxzoom,layout:Qe.layout,paint:Qe.paint},rt),this.layerType=Ne.type,this.below=tt},it.updateStyle=function(Ne){if(isVisible(Ne)){var Ge=convertOpts(Ne);this.subplot.setOptions(this.idLayer,"setLayoutProperty",Ge.layout),this.subplot.setOptions(this.idLayer,"setPaintProperty",Ge.paint)}},it.removeLayer=function(){var Ne=this.subplot.map;Ne.getLayer(this.idLayer)&&Ne.removeLayer(this.idLayer)},it.dispose=function(){var Ne=this.subplot.map;Ne.getLayer(this.idLayer)&&Ne.removeLayer(this.idLayer),Ne.getSource(this.idSource)&&Ne.removeSource(this.idSource)},Ge.exports=function(Ne,Ge,Qe){var tt=new MapboxLayer(Ne,Ge);return tt.update(Qe),tt}},{"../../lib":778,"../../lib/svg_text_utils":803,"./constants":883,"./convert_text_opts":884}],887:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../components/color").defaultLine,nt=Ne("../domain").attributes,at=Ne("../font_attributes"),it=Ne("../../traces/scatter/attributes").textposition,ot=Ne("../../plot_api/edit_types").overrideAll,dt=Ne("../../plot_api/plot_template").templatedArray,ht=Ne("./constants"),Dt=at({});Dt.family.dflt="Open Sans Regular, Arial Unicode MS Regular",(Ge.exports=ot({_arrayAttrRegexps:[tt.counterRegex("mapbox",".layers",!0)],domain:nt({name:"mapbox"}),accesstoken:{valType:"string",noBlank:!0,strict:!0},style:{valType:"any",values:ht.styleValuesMapbox.concat(ht.styleValuesNonMapbox),dflt:ht.styleValueDflt},center:{lon:{valType:"number",dflt:0},lat:{valType:"number",dflt:0}},zoom:{valType:"number",dflt:1},bearing:{valType:"number",dflt:0},pitch:{valType:"number",dflt:0},layers:dt("layer",{visible:{valType:"boolean",dflt:!0},sourcetype:{valType:"enumerated",values:["geojson","vector","raster","image"],dflt:"geojson"},source:{valType:"any"},sourcelayer:{valType:"string",dflt:""},sourceattribution:{valType:"string"},type:{valType:"enumerated",values:["circle","line","fill","symbol","raster"],dflt:"circle"},coordinates:{valType:"any"},below:{valType:"string"},color:{valType:"color",dflt:rt},opacity:{valType:"number",min:0,max:1,dflt:1},minzoom:{valType:"number",min:0,max:24,dflt:0},maxzoom:{valType:"number",min:0,max:24,dflt:24},circle:{radius:{valType:"number",dflt:15}},line:{width:{valType:"number",dflt:2},dash:{valType:"data_array"}},fill:{outlinecolor:{valType:"color",dflt:rt}},symbol:{icon:{valType:"string",dflt:"marker"},iconsize:{valType:"number",dflt:10},text:{valType:"string",dflt:""},placement:{valType:"enumerated",values:["point","line","line-center"],dflt:"point"},textfont:Dt,textposition:tt.extendFlat({},it,{arrayOk:!1})}})},"plot","from-root")).uirevision={valType:"any",editType:"none"}},{"../../components/color":643,"../../lib":778,"../../plot_api/edit_types":810,"../../plot_api/plot_template":817,"../../traces/scatter/attributes":1187,"../domain":855,"../font_attributes":856,"./constants":883}],888:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../subplot_defaults"),nt=Ne("../array_container_defaults"),at=Ne("./layout_attributes");function handleDefaults(Ne,Ge,Qe,tt){Qe("accesstoken",tt.accessToken),Qe("style"),Qe("center.lon"),Qe("center.lat"),Qe("zoom"),Qe("bearing"),Qe("pitch"),nt(Ne,Ge,{name:"layers",handleItemDefaults:handleLayerDefaults}),Ge._input=Ne}function handleLayerDefaults(Ne,Ge){function coerce(Qe,rt){return tt.coerce(Ne,Ge,at.layers,Qe,rt)}if(coerce("visible")){var Qe,rt=coerce("sourcetype"),nt="raster"===rt||"image"===rt;coerce("source"),coerce("sourceattribution"),"vector"===rt&&coerce("sourcelayer"),"image"===rt&&coerce("coordinates"),nt&&(Qe="raster");var it=coerce("type",Qe);nt&&"raster"!==it&&(it=Ge.type="raster",tt.log("Source types *raster* and *image* must drawn *raster* layer type.")),coerce("below"),coerce("color"),coerce("opacity"),coerce("minzoom"),coerce("maxzoom"),"circle"===it&&coerce("circle.radius"),"line"===it&&(coerce("line.width"),coerce("line.dash")),"fill"===it&&coerce("fill.outlinecolor"),"symbol"===it&&(coerce("symbol.icon"),coerce("symbol.iconsize"),coerce("symbol.text"),tt.coerceFont(coerce,"symbol.textfont"),coerce("symbol.textposition"),coerce("symbol.placement"))}}Ge.exports=function(Ne,Ge,Qe){rt(Ne,Ge,Qe,{type:"mapbox",attributes:at,handleDefaults:handleDefaults,partition:"y",accessToken:Ge._mapboxAccessToken})}},{"../../lib":778,"../array_container_defaults":823,"../subplot_defaults":905,"./layout_attributes":887}],889:[function(Ne,Ge,Qe){"use strict";var tt=Ne("mapbox-gl"),rt=Ne("../../lib"),nt=Ne("../../lib/geo_location_utils"),at=Ne("../../registry"),it=Ne("../cartesian/axes"),ot=Ne("../../components/dragelement"),dt=Ne("../../components/fx"),ht=Ne("../../components/dragelement/helpers"),Dt=ht.rectMode,Ot=ht.drawMode,Rt=ht.selectMode,Zt=Ne("../cartesian/select").prepSelect,er=Ne("../cartesian/select").clearSelect,dr=Ne("../cartesian/select").clearSelectionsCache,mr=Ne("../cartesian/select").selectOnClick,xr=Ne("./constants"),br=Ne("./layers");function Mapbox(Ne,Ge){this.id=Ge,this.gd=Ne;var Qe=Ne._fullLayout,tt=Ne._context;this.container=Qe._glcontainer.node(),this.isStatic=tt.staticPlot,this.uid=Qe._uid+"-"+this.id,this.div=null,this.xaxis=null,this.yaxis=null,this.createFramework(Qe),this.map=null,this.accessToken=null,this.styleObj=null,this.traceHash={},this.layerList=[],this.belowLookup={},this.dragging=!1,this.wheeling=!1}var Ar=Mapbox.prototype;Ar.plot=function(Ne,Ge,Qe){var tt,rt=this,nt=Ge[rt.id];rt.map&&nt.accesstoken!==rt.accessToken&&(rt.map.remove(),rt.map=null,rt.styleObj=null,rt.traceHash={},rt.layerList=[]),tt=rt.map?new Promise((function(Qe,tt){rt.updateMap(Ne,Ge,Qe,tt)})):new Promise((function(Qe,tt){rt.createMap(Ne,Ge,Qe,tt)})),Qe.push(tt)},Ar.createMap=function(Ne,Ge,Qe,rt){var at=this,it=Ge[at.id],ot=at.styleObj=getStyleObj(it.style);at.accessToken=it.accesstoken;var dt=at.map=new tt.Map({container:at.div,style:ot.style,center:convertCenter(it.center),zoom:it.zoom,bearing:it.bearing,pitch:it.pitch,interactive:!at.isStatic,preserveDrawingBuffer:at.isStatic,doubleClickZoom:!1,boxZoom:!1,attributionControl:!1}).addControl(new tt.AttributionControl({compact:!0}));dt._canvas.style.left="0px",dt._canvas.style.top="0px",at.rejectOnError(rt),at.isStatic||at.initFx(Ne,Ge);var ht=[];ht.push(new Promise((function(Ne){dt.once("load",Ne)}))),ht=ht.concat(nt.fetchTraceGeoData(Ne)),Promise.all(ht).then((function(){at.fillBelowLookup(Ne,Ge),at.updateData(Ne),at.updateLayout(Ge),at.resolveOnRender(Qe)})).catch(rt)},Ar.updateMap=function(Ne,Ge,Qe,tt){var rt=this,at=rt.map,it=Ge[this.id];rt.rejectOnError(tt);var ot=[],dt=getStyleObj(it.style);JSON.stringify(rt.styleObj)!==JSON.stringify(dt)&&(rt.styleObj=dt,at.setStyle(dt.style),rt.traceHash={},ot.push(new Promise((function(Ne){at.once("styledata",Ne)})))),ot=ot.concat(nt.fetchTraceGeoData(Ne)),Promise.all(ot).then((function(){rt.fillBelowLookup(Ne,Ge),rt.updateData(Ne),rt.updateLayout(Ge),rt.resolveOnRender(Qe)})).catch(tt)},Ar.fillBelowLookup=function(Ne,Ge){var Qe,tt,rt=Ge[this.id].layers,nt=this.belowLookup={},at=!1;for(Qe=0;Qe<Ne.length;Qe++){var it=Ne[Qe][0].trace,ot=it._module;"string"==typeof it.below?tt=it.below:ot.getBelow&&(tt=ot.getBelow(it,this)),""===tt&&(at=!0),nt["trace-"+it.uid]=tt||""}for(Qe=0;Qe<rt.length;Qe++){var dt=rt[Qe];tt="string"==typeof dt.below?dt.below:at?"traces":"",nt["layout-"+Qe]=tt}var ht,Dt,Ot={};for(ht in nt)Ot[tt=nt[ht]]?Ot[tt].push(ht):Ot[tt]=[ht];for(tt in Ot){var Rt=Ot[tt];if(Rt.length>1)for(Qe=0;Qe<Rt.length;Qe++)0===(ht=Rt[Qe]).indexOf("trace-")?(Dt=ht.split("trace-")[1],this.traceHash[Dt]&&(this.traceHash[Dt].below=null)):0===ht.indexOf("layout-")&&(Dt=ht.split("layout-")[1],this.layerList[Dt]&&(this.layerList[Dt].below=null))}};var en={choroplethmapbox:0,densitymapbox:1,scattermapbox:2};function getStyleObj(Ne){var Ge={};return rt.isPlainObject(Ne)?(Ge.id=Ne.id,Ge.style=Ne):"string"==typeof Ne?(Ge.id=Ne,-1!==xr.styleValuesMapbox.indexOf(Ne)?Ge.style=convertStyleVal(Ne):xr.stylesNonMapbox[Ne]?Ge.style=xr.stylesNonMapbox[Ne]:Ge.style=Ne):(Ge.id=xr.styleValueDflt,Ge.style=convertStyleVal(xr.styleValueDflt)),Ge.transition={duration:0,delay:0},Ge}function convertStyleVal(Ne){return xr.styleUrlPrefix+Ne+"-"+xr.styleUrlSuffix}function convertCenter(Ne){return[Ne.lon,Ne.lat]}Ar.updateData=function(Ne){var Ge,Qe,tt,rt,nt=this.traceHash,at=Ne.slice().sort((function(Ne,Ge){return en[Ne[0].trace.type]-en[Ge[0].trace.type]}));for(tt=0;tt<at.length;tt++){var it=at[tt],ot=!1;(Ge=nt[(Qe=it[0].trace).uid])&&(Ge.type===Qe.type?(Ge.update(it),ot=!0):Ge.dispose()),!ot&&Qe._module&&(nt[Qe.uid]=Qe._module.plot(this,it))}var dt=Object.keys(nt);e:for(tt=0;tt<dt.length;tt++){var ht=dt[tt];for(rt=0;rt<Ne.length;rt++)if(ht===(Qe=Ne[rt][0].trace).uid)continue e;(Ge=nt[ht]).dispose(),delete nt[ht]}},Ar.updateLayout=function(Ne){var Ge=this.map,Qe=Ne[this.id];this.dragging||this.wheeling||(Ge.setCenter(convertCenter(Qe.center)),Ge.setZoom(Qe.zoom),Ge.setBearing(Qe.bearing),Ge.setPitch(Qe.pitch)),this.updateLayers(Ne),this.updateFramework(Ne),this.updateFx(Ne),this.map.resize(),this.gd._context._scrollZoom.mapbox?Ge.scrollZoom.enable():Ge.scrollZoom.disable()},Ar.resolveOnRender=function(Ne){var Ge=this.map;Ge.on("render",(function onRender(){Ge.loaded()&&(Ge.off("render",onRender),setTimeout(Ne,10))}))},Ar.rejectOnError=function(Ne){var Ge=this.map;function handler(){Ne(new Error(xr.mapOnErrorMsg))}Ge.once("error",handler),Ge.once("style.error",handler),Ge.once("source.error",handler),Ge.once("tile.error",handler),Ge.once("layer.error",handler)},Ar.createFramework=function(Ne){var Ge=this,Qe=Ge.div=document.createElement("div");Qe.id=Ge.uid,Qe.style.position="absolute",Ge.container.appendChild(Qe),Ge.xaxis={_id:"x",c2p:function(Ne){return Ge.project(Ne).x}},Ge.yaxis={_id:"y",c2p:function(Ne){return Ge.project(Ne).y}},Ge.updateFramework(Ne),Ge.mockAxis={type:"linear",showexponent:"all",exponentformat:"B"},it.setConvert(Ge.mockAxis,Ne)},Ar.initFx=function(Ne,Ge){var Qe=this,tt=Qe.gd,rt=Qe.map;function unhover(){dt.loneUnhover(Ge._hoverlayer)}function emitUpdate(){var Ne=Qe.getView();tt.emit("plotly_relayouting",Qe.getViewEditsWithDerived(Ne))}rt.on("moveend",(function(Ne){if(Qe.map){var Ge=tt._fullLayout;if(Ne.originalEvent||Qe.wheeling){var rt=Ge[Qe.id];at.call("_storeDirectGUIEdit",tt.layout,Ge._preGUI,Qe.getViewEdits(rt));var nt=Qe.getView();rt._input.center=rt.center=nt.center,rt._input.zoom=rt.zoom=nt.zoom,rt._input.bearing=rt.bearing=nt.bearing,rt._input.pitch=rt.pitch=nt.pitch,tt.emit("plotly_relayout",Qe.getViewEditsWithDerived(nt))}Ne.originalEvent&&"mouseup"===Ne.originalEvent.type?Qe.dragging=!1:Qe.wheeling&&(Qe.wheeling=!1),Ge._rehover&&Ge._rehover()}})),rt.on("wheel",(function(){Qe.wheeling=!0})),rt.on("mousemove",(function(Ne){var Ge=Qe.div.getBoundingClientRect(),nt=[Ne.originalEvent.offsetX,Ne.originalEvent.offsetY];Ne.target.getBoundingClientRect=function(){return Ge},Qe.xaxis.p2c=function(){return rt.unproject(nt).lng},Qe.yaxis.p2c=function(){return rt.unproject(nt).lat},tt._fullLayout._rehover=function(){tt._fullLayout._hoversubplot===Qe.id&&tt._fullLayout[Qe.id]&&dt.hover(tt,Ne,Qe.id)},dt.hover(tt,Ne,Qe.id),tt._fullLayout._hoversubplot=Qe.id})),rt.on("dragstart",(function(){Qe.dragging=!0,unhover()})),rt.on("zoomstart",unhover),rt.on("mouseout",(function(){tt._fullLayout._hoversubplot=null})),rt.on("drag",emitUpdate),rt.on("zoom",emitUpdate),rt.on("dblclick",(function(){var Ne=tt._fullLayout[Qe.id];at.call("_storeDirectGUIEdit",tt.layout,tt._fullLayout._preGUI,Qe.getViewEdits(Ne));var Ge=Qe.viewInitial;rt.setCenter(convertCenter(Ge.center)),rt.setZoom(Ge.zoom),rt.setBearing(Ge.bearing),rt.setPitch(Ge.pitch);var nt=Qe.getView();Ne._input.center=Ne.center=nt.center,Ne._input.zoom=Ne.zoom=nt.zoom,Ne._input.bearing=Ne.bearing=nt.bearing,Ne._input.pitch=Ne.pitch=nt.pitch,tt.emit("plotly_doubleclick",null),tt.emit("plotly_relayout",Qe.getViewEditsWithDerived(nt))})),Qe.clearSelect=function(){dr(Qe.dragOptions),er(Qe.dragOptions.gd)},Qe.onClickInPanFn=function(Ne){return function(Ge){var rt=tt._fullLayout.clickmode;rt.indexOf("select")>-1&&mr(Ge.originalEvent,tt,[Qe.xaxis],[Qe.yaxis],Qe.id,Ne),rt.indexOf("event")>-1&&dt.click(tt,Ge.originalEvent)}}},Ar.updateFx=function(Ne){var Ge=this,Qe=Ge.map,tt=Ge.gd;if(!Ge.isStatic){var nt,at=Ne.dragmode;nt=Dt(at)?function(Ne,Qe){(Ne.range={})[Ge.id]=[invert([Qe.xmin,Qe.ymin]),invert([Qe.xmax,Qe.ymax])]}:function(Ne,Qe,tt){(Ne.lassoPoints={})[Ge.id]=tt.filtered.map(invert)};var it=Ge.dragOptions;Ge.dragOptions=rt.extendDeep(it||{},{dragmode:Ne.dragmode,element:Ge.div,gd:tt,plotinfo:{id:Ge.id,domain:Ne[Ge.id].domain,xaxis:Ge.xaxis,yaxis:Ge.yaxis,fillRangeItems:nt},xaxes:[Ge.xaxis],yaxes:[Ge.yaxis],subplot:Ge.id}),Qe.off("click",Ge.onClickInPanHandler),Rt(at)||Ot(at)?(Qe.dragPan.disable(),Qe.on("zoomstart",Ge.clearSelect),Ge.dragOptions.prepFn=function(Ne,Qe,tt){Zt(Ne,Qe,tt,Ge.dragOptions,at)},ot.init(Ge.dragOptions)):(Qe.dragPan.enable(),Qe.off("zoomstart",Ge.clearSelect),Ge.div.onmousedown=null,Ge.onClickInPanHandler=Ge.onClickInPanFn(Ge.dragOptions),Qe.on("click",Ge.onClickInPanHandler))}function invert(Ne){var Qe=Ge.map.unproject(Ne);return[Qe.lng,Qe.lat]}},Ar.updateFramework=function(Ne){var Ge=Ne[this.id].domain,Qe=Ne._size,tt=this.div.style;tt.width=Qe.w*(Ge.x[1]-Ge.x[0])+"px",tt.height=Qe.h*(Ge.y[1]-Ge.y[0])+"px",tt.left=Qe.l+Ge.x[0]*Qe.w+"px",tt.top=Qe.t+(1-Ge.y[1])*Qe.h+"px",this.xaxis._offset=Qe.l+Ge.x[0]*Qe.w,this.xaxis._length=Qe.w*(Ge.x[1]-Ge.x[0]),this.yaxis._offset=Qe.t+(1-Ge.y[1])*Qe.h,this.yaxis._length=Qe.h*(Ge.y[1]-Ge.y[0])},Ar.updateLayers=function(Ne){var Ge,Qe=Ne[this.id].layers,tt=this.layerList;if(Qe.length!==tt.length){for(Ge=0;Ge<tt.length;Ge++)tt[Ge].dispose();for(tt=this.layerList=[],Ge=0;Ge<Qe.length;Ge++)tt.push(br(this,Ge,Qe[Ge]))}else for(Ge=0;Ge<Qe.length;Ge++)tt[Ge].update(Qe[Ge])},Ar.destroy=function(){this.map&&(this.map.remove(),this.map=null,this.container.removeChild(this.div))},Ar.toImage=function(){return this.map.stop(),this.map.getCanvas().toDataURL()},Ar.setOptions=function(Ne,Ge,Qe){for(var tt in Qe)this.map[Ge](Ne,tt,Qe[tt])},Ar.getMapLayers=function(){return this.map.getStyle().layers},Ar.addLayer=function(Ne,Ge){var Qe=this.map;if("string"==typeof Ge){if(""===Ge)return void Qe.addLayer(Ne,Ge);for(var tt=this.getMapLayers(),nt=0;nt<tt.length;nt++)if(Ge===tt[nt].id)return void Qe.addLayer(Ne,Ge);rt.warn(["Trying to add layer with *below* value",Ge,"referencing a layer that does not exist","or that does not yet exist."].join(" "))}Qe.addLayer(Ne)},Ar.project=function(Ne){return this.map.project(new tt.LngLat(Ne[0],Ne[1]))},Ar.getView=function(){var Ne=this.map,Ge=Ne.getCenter(),Qe={lon:Ge.lng,lat:Ge.lat},tt=Ne.getCanvas(),rt=tt.width,nt=tt.height;return{center:Qe,zoom:Ne.getZoom(),bearing:Ne.getBearing(),pitch:Ne.getPitch(),_derived:{coordinates:[Ne.unproject([0,0]).toArray(),Ne.unproject([rt,0]).toArray(),Ne.unproject([rt,nt]).toArray(),Ne.unproject([0,nt]).toArray()]}}},Ar.getViewEdits=function(Ne){for(var Ge=this.id,Qe=["center","zoom","bearing","pitch"],tt={},rt=0;rt<Qe.length;rt++){var nt=Qe[rt];tt[Ge+"."+nt]=Ne[nt]}return tt},Ar.getViewEditsWithDerived=function(Ne){var Ge=this.id,Qe=this.getViewEdits(Ne);return Qe[Ge+"._derived"]=Ne._derived,Qe},Ge.exports=Mapbox},{"../../components/dragelement":662,"../../components/dragelement/helpers":661,"../../components/fx":683,"../../lib":778,"../../lib/geo_location_utils":771,"../../registry":911,"../cartesian/axes":828,"../cartesian/select":847,"./constants":883,"./layers":886,"mapbox-gl":473}],890:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne){var Ge=Ne.editType;return{t:{valType:"number",dflt:0,editType:Ge},r:{valType:"number",dflt:0,editType:Ge},b:{valType:"number",dflt:0,editType:Ge},l:{valType:"number",dflt:0,editType:Ge},editType:Ge}}},{}],891:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("d3-time-format").timeFormatLocale,nt=Ne("fast-isnumeric"),at=Ne("../registry"),it=Ne("../plot_api/plot_schema"),ot=Ne("../plot_api/plot_template"),dt=Ne("../lib"),ht=Ne("../components/color"),Dt=Ne("../constants/numerical").BADNUM,Ot=Ne("./cartesian/axis_ids"),Rt=Ne("./cartesian/handle_outline").clearSelect,Zt=Ne("./animation_attributes"),er=Ne("./frame_attributes"),dr=Ne("../plots/get_data").getModuleCalcData,mr=dt.relinkPrivateKeys,xr=dt._,br=Ge.exports={};dt.extendFlat(br,at),br.attributes=Ne("./attributes"),br.attributes.type.values=br.allTypes,br.fontAttrs=Ne("./font_attributes"),br.layoutAttributes=Ne("./layout_attributes"),br.fontWeight="normal";var Ar=br.transformsRegistry,en=Ne("./command");function positionPlayWithData(Ne,Ge){Ge.text("");var Qe=Ge.append("a").attr({"xlink:xlink:href":"#",class:"link--impt link--embedview","font-weight":"bold"}).text(Ne._context.linkText+" "+String.fromCharCode(187));if(Ne._context.sendData)Qe.on("click",(function(){br.sendDataToCloud(Ne)}));else{var tt=window.location.pathname.split("/"),rt=window.location.search;Qe.attr({"xlink:xlink:show":"new","xlink:xlink:href":"/"+tt[2].split(".")[0]+"/"+tt[1]+rt})}}br.executeAPICommand=en.executeAPICommand,br.computeAPICommandBindings=en.computeAPICommandBindings,br.manageCommandObserver=en.manageCommandObserver,br.hasSimpleAPICommandBindings=en.hasSimpleAPICommandBindings,br.redrawText=function(Ne){var Ge=(Ne=dt.getGraphDiv(Ne))._fullLayout||{};if(Ge._has&&Ge._has("polar")||!Ne.data||!Ne.data[0]||!Ne.data[0].r)return new Promise((function(Ge){setTimeout((function(){at.getComponentMethod("annotations","draw")(Ne),at.getComponentMethod("legend","draw")(Ne),at.getComponentMethod("colorbar","draw")(Ne),Ge(br.previousPromises(Ne))}),300)}))},br.resize=function(Ne){var Ge;Ne=dt.getGraphDiv(Ne);var Qe=new Promise((function(Qe,tt){Ne&&!dt.isHidden(Ne)||tt(new Error("Resize must be passed a displayed plot div element.")),Ne._redrawTimer&&clearTimeout(Ne._redrawTimer),Ne._resolveResize&&(Ge=Ne._resolveResize),Ne._resolveResize=Qe,Ne._redrawTimer=setTimeout((function(){if(!Ne.layout||Ne.layout.width&&Ne.layout.height||dt.isHidden(Ne))Qe(Ne);else{delete Ne.layout.width,delete Ne.layout.height;var Ge=Ne.changed;Ne.autoplay=!0,at.call("relayout",Ne,{autosize:!0}).then((function(){Ne.changed=Ge,Ne._resolveResize===Qe&&(delete Ne._resolveResize,Qe(Ne))}))}}),100)}));return Ge&&Ge(Qe),Qe},br.previousPromises=function(Ne){if((Ne._promises||[]).length)return Promise.all(Ne._promises).then((function(){Ne._promises=[]}))},br.addLinks=function(Ne){if(Ne._context.showLink||Ne._context.showSources){var Ge=Ne._fullLayout,Qe=dt.ensureSingle(Ge._paper,"text","js-plot-link-container",(function(Ne){Ne.style({"font-family":'"Open Sans", Arial, sans-serif',"font-size":"12px",fill:ht.defaultLine,"pointer-events":"all"}).each((function(){var Ne=tt.select(this);Ne.append("tspan").classed("js-link-to-tool",!0),Ne.append("tspan").classed("js-link-spacer",!0),Ne.append("tspan").classed("js-sourcelinks",!0)}))})),rt=Qe.node(),nt={y:Ge._paper.attr("height")-9};document.body.contains(rt)&&rt.getComputedTextLength()>=Ge.width-20?(nt["text-anchor"]="start",nt.x=5):(nt["text-anchor"]="end",nt.x=Ge._paper.attr("width")-7),Qe.attr(nt);var at=Qe.select(".js-link-to-tool"),it=Qe.select(".js-link-spacer"),ot=Qe.select(".js-sourcelinks");Ne._context.showSources&&Ne._context.showSources(Ne),Ne._context.showLink&&positionPlayWithData(Ne,at),it.text(at.text()&&ot.text()?" - ":"")}},br.sendDataToCloud=function(Ne){var Ge=(window.PLOTLYENV||{}).BASE_URL||Ne._context.plotlyServerURL;if(Ge){Ne.emit("plotly_beforeexport");var Qe=tt.select(Ne).append("div").attr("id","hiddenform").style("display","none"),rt=Qe.append("form").attr({action:Ge+"/external",method:"post",target:"_blank"});return rt.append("input").attr({type:"text",name:"data"}).node().value=br.graphJson(Ne,!1,"keepdata"),rt.node().submit(),Qe.remove(),Ne.emit("plotly_afterexport"),!1}};var mn=["days","shortDays","months","shortMonths","periods","dateTime","date","time","decimal","thousands","grouping","currency"],xn=["year","month","dayMonth","dayMonthYear"];function getTraceUids(Ne,Ge){var Qe,tt,rt=Ge.length,nt=[];for(Qe=0;Qe<Ne.length;Qe++){var at=Ne[Qe]._fullInput;at!==tt&&nt.push(at),tt=at}var it=nt.length,ot=new Array(rt),ht={};function setUid(Ne,Ge){ot[Ge]=Ne,ht[Ne]=1}function tryUid(Ne,Ge){if(Ne&&"string"==typeof Ne&&!ht[Ne])return setUid(Ne,Ge),!0}for(Qe=0;Qe<rt;Qe++){var Dt=Ge[Qe].uid;"number"==typeof Dt&&(Dt=String(Dt)),tryUid(Dt,Qe)||Qe<it&&tryUid(nt[Qe].uid,Qe)||setUid(dt.randstr(ht),Qe)}return ot}function emptySubplotLists(){var Ne,Ge,Qe=at.collectableSubplotTypes,tt={};if(!Qe){Qe=[];var rt=at.subplotsRegistry;for(var nt in rt){var it=rt[nt].attr;if(it&&(Qe.push(nt),Array.isArray(it)))for(Ge=0;Ge<it.length;Ge++)dt.pushUnique(Qe,it[Ge])}}for(Ne=0;Ne<Qe.length;Ne++)tt[Qe[Ne]]=[];return tt}function getFormatObj(Ne,Ge){var Qe=Ne._context.locale;Qe||(Qe="en-US");var tt=!1,rt={};function includeFormat(Ne){for(var Qe=!0,nt=0;nt<Ge.length;nt++){var at=Ge[nt];rt[at]||(Ne[at]?rt[at]=Ne[at]:Qe=!1)}Qe&&(tt=!0)}for(var nt=0;nt<2;nt++){for(var it=Ne._context.locales,ot=0;ot<2;ot++){var dt=(it[Qe]||{}).format;if(dt&&(includeFormat(dt),tt))break;it=at.localeRegistry}var ht=Qe.split("-")[0];if(tt||ht===Qe)break;Qe=ht}return tt||includeFormat(at.localeRegistry.en.format),rt}function getFormatter(Ne,Ge){return Ne.decimal=Ge.charAt(0),Ne.thousands=Ge.charAt(1),{numberFormat:tt.locale(Ne).numberFormat,timeFormat:rt(Ne).utcFormat}}function fillMetaTextHelpers(Ne,Ge){var Qe,tt=[];Ge.meta&&(Qe=Ge._meta={meta:Ge.meta,layout:{meta:Ge.meta}});for(var rt=0;rt<Ne.length;rt++){var nt=Ne[rt];nt.meta?tt[nt.index]=nt._meta={meta:nt.meta}:Ge.meta&&(nt._meta={meta:Ge.meta}),Ge.meta&&(nt._meta.layout={meta:Ge.meta})}tt.length&&(Qe||(Qe=Ge._meta={}),Qe.data=tt)}function findMainSubplot(Ne,Ge){var Qe={_fullLayout:Ge},tt="x"===Ne._id.charAt(0),rt=Ne._mainAxis._anchorAxis,nt="",at="",it="";if(rt&&(it=rt._mainAxis._id,nt=tt?Ne._id+it:it+Ne._id),!nt||!Ge._plots[nt]){nt="";for(var ot=Ne._counterAxes,dt=0;dt<ot.length;dt++){var ht=ot[dt],Dt=tt?Ne._id+ht:ht+Ne._id;at||(at=Dt);var Rt=Ot.getFromId(Qe,ht);if(it&&Rt.overlaying===it){nt=Dt;break}}}return nt||at}function hasMakesDataTransform(Ne){var Ge=Ne.transforms;if(Array.isArray(Ge)&&Ge.length)for(var Qe=0;Qe<Ge.length;Qe++){var tt=Ge[Qe],rt=tt._module||Ar[tt.type];if(rt&&rt.makesData)return!0}return!1}function applyTransforms(Ne,Ge,Qe,tt){for(var rt=Ne.transforms,nt=[Ne],at=0;at<rt.length;at++){var it=rt[at],ot=Ar[it.type];ot&&ot.transform&&(nt=ot.transform(nt,{transform:it,fullTrace:Ne,fullData:Ge,layout:Qe,fullLayout:tt,transformIndex:at}))}return nt}function getComputedSize(Ne){return"string"==typeof Ne&&"px"===Ne.substr(Ne.length-2)&&parseFloat(Ne)}function initMargins(Ne){var Ge=Ne.margin;if(!Ne._size){var Qe=Ne._size={l:Math.round(Ge.l),r:Math.round(Ge.r),t:Math.round(Ge.t),b:Math.round(Ge.b),p:Math.round(Ge.pad)};Qe.w=Math.round(Ne.width)-Qe.l-Qe.r,Qe.h=Math.round(Ne.height)-Qe.t-Qe.b}Ne._pushmargin||(Ne._pushmargin={}),Ne._pushmarginIds||(Ne._pushmarginIds={})}br.supplyDefaults=function(Ne,Ge){var Qe=Ge&&Ge.skipUpdateCalc,tt=Ne._fullLayout||{};if(tt._skipDefaults)delete tt._skipDefaults;else{var rt,nt=Ne._fullLayout={},it=Ne.layout||{},ot=Ne._fullData||[],ht=Ne._fullData=[],Dt=Ne.data||[],Ot=Ne.calcdata||[],Zt=Ne._context||{};Ne._transitionData||br.createTransitionData(Ne),nt._dfltTitle={plot:xr(Ne,"Click to enter Plot title"),x:xr(Ne,"Click to enter X axis title"),y:xr(Ne,"Click to enter Y axis title"),colorbar:xr(Ne,"Click to enter Colorscale title"),annotation:xr(Ne,"new text")},nt._traceWord=xr(Ne,"trace");var er=getFormatObj(Ne,mn);if(nt._mapboxAccessToken=Zt.mapboxAccessToken,tt._initialAutoSizeIsDone){var dr=tt.width,Ar=tt.height;br.supplyLayoutGlobalDefaults(it,nt,er),it.width||(nt.width=dr),it.height||(nt.height=Ar),br.sanitizeMargins(nt)}else{br.supplyLayoutGlobalDefaults(it,nt,er);var en=!it.width||!it.height,kn=nt.autosize,Cn=Zt.autosizable;en&&(kn||Cn)?br.plotAutoSize(Ne,it,nt):en&&br.sanitizeMargins(nt),!kn&&en&&(it.width=nt.width,it.height=nt.height)}nt._d3locale=getFormatter(er,nt.separators),nt._extraFormat=getFormatObj(Ne,xn),nt._initialAutoSizeIsDone=!0,nt._dataLength=Dt.length,nt._modules=[],nt._visibleModules=[],nt._basePlotModules=[];var En=nt._subplots=emptySubplotLists(),Pn=nt._splomAxes={x:{},y:{}},Dn=nt._splomSubplots={};nt._splomGridDflt={},nt._scatterStackOpts={},nt._firstScatter={},nt._alignmentOpts={},nt._colorAxes={},nt._requestRangeslider={},nt._traceUids=getTraceUids(ot,Dt),nt._globalTransforms=(Ne._context||{}).globalTransforms,br.supplyDataDefaults(Dt,ht,it,nt);var In=Object.keys(Pn.x),zn=Object.keys(Pn.y);if(In.length>1&&zn.length>1){for(at.getComponentMethod("grid","sizeDefaults")(it,nt),rt=0;rt<In.length;rt++)dt.pushUnique(En.xaxis,In[rt]);for(rt=0;rt<zn.length;rt++)dt.pushUnique(En.yaxis,zn[rt]);for(var Bn in Dn)dt.pushUnique(En.cartesian,Bn)}if(nt._has=br._hasPlotType.bind(nt),ot.length===ht.length)for(rt=0;rt<ht.length;rt++)mr(ht[rt],ot[rt]);br.supplyLayoutModuleDefaults(it,nt,ht,Ne._transitionData);var Vn=nt._visibleModules,Hn=[];for(rt=0;rt<Vn.length;rt++){var qn=Vn[rt].crossTraceDefaults;qn&&dt.pushUnique(Hn,qn)}for(rt=0;rt<Hn.length;rt++)Hn[rt](ht,nt);nt._hasOnlyLargeSploms=1===nt._basePlotModules.length&&"splom"===nt._basePlotModules[0].name&&In.length>15&&zn.length>15&&0===nt.shapes.length&&0===nt.images.length,nt._hasCartesian=nt._has("cartesian"),nt._hasGeo=nt._has("geo"),nt._hasGL3D=nt._has("gl3d"),nt._hasGL2D=nt._has("gl2d"),nt._hasTernary=nt._has("ternary"),nt._hasPie=nt._has("pie"),br.linkSubplots(ht,nt,ot,tt),br.cleanPlot(ht,nt,ot,tt);var Yn=!(!tt._has||!tt._has("gl2d")),$n=!(!nt._has||!nt._has("gl2d")),ra=!(!tt._has||!tt._has("cartesian"))||Yn,oa=!(!nt._has||!nt._has("cartesian"))||$n;ra&&!oa?tt._bgLayer.remove():oa&&!ra&&(nt._shouldCreateBgLayer=!0),tt._zoomlayer&&!Ne._dragging&&Rt({_fullLayout:tt}),fillMetaTextHelpers(ht,nt),mr(nt,tt),at.getComponentMethod("colorscale","crossTraceDefaults")(ht,nt),nt._preGUI||(nt._preGUI={}),nt._tracePreGUI||(nt._tracePreGUI={});var pa,ga=nt._tracePreGUI,ma={};for(pa in ga)ma[pa]="old";for(rt=0;rt<ht.length;rt++)ma[pa=ht[rt]._fullInput.uid]||(ga[pa]={}),ma[pa]="new";for(pa in ma)"old"===ma[pa]&&delete ga[pa];initMargins(nt),at.getComponentMethod("rangeslider","makeData")(nt),Qe||Ot.length!==ht.length||br.supplyDefaultsUpdateCalc(Ot,ht)}},br.supplyDefaultsUpdateCalc=function(Ne,Ge){for(var Qe=0;Qe<Ge.length;Qe++){var tt=Ge[Qe],rt=(Ne[Qe]||[])[0];if(rt&&rt.trace){var nt=rt.trace;if(nt._hasCalcTransform){var at,it,ot,ht=nt._arrayAttrs;for(at=0;at<ht.length;at++)it=ht[at],ot=dt.nestedProperty(nt,it).get().slice(),dt.nestedProperty(tt,it).set(ot)}rt.trace=tt}}},br.createTransitionData=function(Ne){Ne._transitionData||(Ne._transitionData={}),Ne._transitionData._frames||(Ne._transitionData._frames=[]),Ne._transitionData._frameHash||(Ne._transitionData._frameHash={}),Ne._transitionData._counter||(Ne._transitionData._counter=0),Ne._transitionData._interruptCallbacks||(Ne._transitionData._interruptCallbacks=[])},br._hasPlotType=function(Ne){var Ge,Qe=this._basePlotModules||[];for(Ge=0;Ge<Qe.length;Ge++)if(Qe[Ge].name===Ne)return!0;var tt=this._modules||[];for(Ge=0;Ge<tt.length;Ge++){var rt=tt[Ge].name;if(rt===Ne)return!0;var nt=at.modules[rt];if(nt&&nt.categories[Ne])return!0}return!1},br.cleanPlot=function(Ne,Ge,Qe,tt){var rt,nt,at=tt._basePlotModules||[];for(rt=0;rt<at.length;rt++){var it=at[rt];it.clean&&it.clean(Ne,Ge,Qe,tt)}var ot=tt._has&&tt._has("gl"),dt=Ge._has&&Ge._has("gl");ot&&!dt&&void 0!==tt._glcontainer&&(tt._glcontainer.selectAll(".gl-canvas").remove(),tt._glcontainer.selectAll(".no-webgl").remove(),tt._glcanvas=null);var ht=!!tt._infolayer;e:for(rt=0;rt<Qe.length;rt++){var Dt=Qe[rt].uid;for(nt=0;nt<Ne.length;nt++)if(Dt===Ne[nt].uid)continue e;ht&&tt._infolayer.select(".cb"+Dt).remove()}},br.linkSubplots=function(Ne,Ge,Qe,tt){var rt,nt,it=tt._plots||{},ot=Ge._plots={},ht=Ge._subplots,Dt={_fullData:Ne,_fullLayout:Ge},Rt=ht.cartesian.concat(ht.gl2d||[]);for(rt=0;rt<Rt.length;rt++){var Zt,er=Rt[rt],dr=it[er],mr=Ot.getFromId(Dt,er,"x"),xr=Ot.getFromId(Dt,er,"y");for(dr?Zt=ot[er]=dr:(Zt=ot[er]={}).id=er,mr._counterAxes.push(xr._id),xr._counterAxes.push(mr._id),mr._subplotsWith.push(er),xr._subplotsWith.push(er),Zt.xaxis=mr,Zt.yaxis=xr,Zt._hasClipOnAxisFalse=!1,nt=0;nt<Ne.length;nt++){var br=Ne[nt];if(br.xaxis===Zt.xaxis._id&&br.yaxis===Zt.yaxis._id&&!1===br.cliponaxis){Zt._hasClipOnAxisFalse=!0;break}}}var Ar,en=Ot.list(Dt,null,!0);for(rt=0;rt<en.length;rt++){var mn=null;(Ar=en[rt]).overlaying&&(mn=Ot.getFromId(Dt,Ar.overlaying))&&mn.overlaying&&(Ar.overlaying=!1,mn=null),Ar._mainAxis=mn||Ar,mn&&(Ar.domain=mn.domain.slice()),Ar._anchorAxis="free"===Ar.anchor?null:Ot.getFromId(Dt,Ar.anchor)}for(rt=0;rt<en.length;rt++)if((Ar=en[rt])._counterAxes.sort(Ot.idSort),Ar._subplotsWith.sort(dt.subplotSort),Ar._mainSubplot=findMainSubplot(Ar,Ge),Ar._counterAxes.length&&(Ar.spikemode&&-1!==Ar.spikemode.indexOf("across")||Ar.automargin&&Ar.mirror&&"free"!==Ar.anchor||at.getComponentMethod("rangeslider","isVisible")(Ar))){var xn=1,kn=0;for(nt=0;nt<Ar._counterAxes.length;nt++){var Cn=Ot.getFromId(Dt,Ar._counterAxes[nt]);xn=Math.min(xn,Cn.domain[0]),kn=Math.max(kn,Cn.domain[1])}xn<kn&&(Ar._counterDomainMin=xn,Ar._counterDomainMax=kn)}},br.clearExpandedTraceDefaultColors=function(Ne){var Ge,Qe,tt;function locateColorAttrs(Ne,tt,rt,nt){Qe[nt]=tt,Qe.length=nt+1,"color"===Ne.valType&&void 0===Ne.dflt&&Ge.push(Qe.join("."))}for(Qe=[],(Ge=Ne._module._colorAttrs)||(Ne._module._colorAttrs=Ge=[],it.crawl(Ne._module.attributes,locateColorAttrs)),tt=0;tt<Ge.length;tt++)dt.nestedProperty(Ne,"_input."+Ge[tt]).get()||dt.nestedProperty(Ne,Ge[tt]).set(null)},br.supplyDataDefaults=function(Ne,Ge,Qe,tt){var rt,nt,it,ht=tt._modules,Dt=tt._visibleModules,Ot=tt._basePlotModules,Rt=0,Zt=0;function pushModule(Ne){Ge.push(Ne);var Qe=Ne._module;Qe&&(dt.pushUnique(ht,Qe),!0===Ne.visible&&dt.pushUnique(Dt,Qe),dt.pushUnique(Ot,Ne._module.basePlotModule),Rt++,!1!==Ne._input.visible&&Zt++)}tt._transformModules=[];var er={},dr=[],xr=(Qe.template||{}).data||{},Ar=ot.traceTemplater(xr);for(rt=0;rt<Ne.length;rt++){if(it=Ne[rt],(nt=Ar.newTrace(it)).uid=tt._traceUids[rt],br.supplyTraceDefaults(it,nt,Zt,tt,rt),nt.index=rt,nt._input=it,nt._expandedIndex=Rt,nt.transforms&&nt.transforms.length)for(var en=!1!==it.visible&&!1===nt.visible,mn=applyTransforms(nt,Ge,Qe,tt),xn=0;xn<mn.length;xn++){var kn=mn[xn],Cn={_template:nt._template,type:nt.type,uid:nt.uid+xn};en&&!1===kn.visible&&delete kn.visible,br.supplyTraceDefaults(kn,Cn,Rt,tt,rt),mr(Cn,kn),Cn.index=rt,Cn._input=it,Cn._fullInput=nt,Cn._expandedIndex=Rt,Cn._expandedInput=kn,pushModule(Cn)}else nt._fullInput=nt,nt._expandedInput=nt,pushModule(nt);at.traceIs(nt,"carpetAxis")&&(er[nt.carpet]=nt),at.traceIs(nt,"carpetDependent")&&dr.push(rt)}for(rt=0;rt<dr.length;rt++)if((nt=Ge[dr[rt]]).visible){var En=er[nt.carpet];nt._carpet=En,En&&En.visible?(nt.xaxis=En.xaxis,nt.yaxis=En.yaxis):nt.visible=!1}},br.supplyAnimationDefaults=function(Ne){var Ge;Ne=Ne||{};var Qe={};function coerce(Ge,tt){return dt.coerce(Ne||{},Qe,Zt,Ge,tt)}if(coerce("mode"),coerce("direction"),coerce("fromcurrent"),Array.isArray(Ne.frame))for(Qe.frame=[],Ge=0;Ge<Ne.frame.length;Ge++)Qe.frame[Ge]=br.supplyAnimationFrameDefaults(Ne.frame[Ge]||{});else Qe.frame=br.supplyAnimationFrameDefaults(Ne.frame||{});if(Array.isArray(Ne.transition))for(Qe.transition=[],Ge=0;Ge<Ne.transition.length;Ge++)Qe.transition[Ge]=br.supplyAnimationTransitionDefaults(Ne.transition[Ge]||{});else Qe.transition=br.supplyAnimationTransitionDefaults(Ne.transition||{});return Qe},br.supplyAnimationFrameDefaults=function(Ne){var Ge={};function coerce(Qe,tt){return dt.coerce(Ne||{},Ge,Zt.frame,Qe,tt)}return coerce("duration"),coerce("redraw"),Ge},br.supplyAnimationTransitionDefaults=function(Ne){var Ge={};function coerce(Qe,tt){return dt.coerce(Ne||{},Ge,Zt.transition,Qe,tt)}return coerce("duration"),coerce("easing"),Ge},br.supplyFrameDefaults=function(Ne){var Ge={};function coerce(Qe,tt){return dt.coerce(Ne,Ge,er,Qe,tt)}return coerce("group"),coerce("name"),coerce("traces"),coerce("baseframe"),coerce("data"),coerce("layout"),Ge},br.supplyTraceDefaults=function(Ne,Ge,Qe,tt,rt){var nt,it=tt.colorway||ht.defaults,ot=it[Qe%it.length];function coerce(Qe,tt){return dt.coerce(Ne,Ge,br.attributes,Qe,tt)}var Dt=coerce("visible");coerce("type"),coerce("name",tt._traceWord+" "+rt),coerce("uirevision",tt.uirevision);var Ot=br.getModule(Ge);if(Ge._module=Ot,Ot){var Rt=Ot.basePlotModule,Zt=Rt.attr,er=Rt.attributes;if(Zt&&er){var dr=tt._subplots,mr="";if(Dt||"gl2d"!==Rt.name){if(Array.isArray(Zt))for(nt=0;nt<Zt.length;nt++){var xr=Zt[nt],Ar=dt.coerce(Ne,Ge,er,xr);dr[xr]&&dt.pushUnique(dr[xr],Ar),mr+=Ar}else mr=dt.coerce(Ne,Ge,er,Zt);dr[Rt.name]&&dt.pushUnique(dr[Rt.name],mr)}}}return Dt&&(coerce("customdata"),coerce("ids"),coerce("meta"),at.traceIs(Ge,"showLegend")?(dt.coerce(Ne,Ge,Ot.attributes.showlegend?Ot.attributes:br.attributes,"showlegend"),coerce("legendgroup"),Ge._dfltShowLegend=!0):Ge._dfltShowLegend=!1,Ot&&Ot.supplyDefaults(Ne,Ge,ot,tt),at.traceIs(Ge,"noOpacity")||coerce("opacity"),at.traceIs(Ge,"notLegendIsolatable")&&(Ge.visible=!!Ge.visible),at.traceIs(Ge,"noHover")||(Ge.hovertemplate||dt.coerceHoverinfo(Ne,Ge,tt),"parcats"!==Ge.type&&at.getComponentMethod("fx","supplyDefaults")(Ne,Ge,ot,tt)),Ot&&Ot.selectPoints&&coerce("selectedpoints"),br.supplyTransformDefaults(Ne,Ge,tt)),Ge},br.hasMakesDataTransform=hasMakesDataTransform,br.supplyTransformDefaults=function(Ne,Ge,Qe){if(Ge._length||hasMakesDataTransform(Ne)){var tt=Qe._globalTransforms||[],rt=Qe._transformModules||[];if(Array.isArray(Ne.transforms)||0!==tt.length)for(var nt=Ne.transforms||[],at=tt.concat(nt),it=Ge.transforms=[],ot=0;ot<at.length;ot++){var ht,Dt=at[ot],Ot=Dt.type,Rt=Ar[Ot],Zt=!(Dt._module&&Dt._module===Rt),er=Rt&&"function"==typeof Rt.transform;Rt||dt.warn("Unrecognized transform type "+Ot+"."),Rt&&Rt.supplyDefaults&&(Zt||er)?((ht=Rt.supplyDefaults(Dt,Ge,Qe,Ne)).type=Ot,ht._module=Rt,dt.pushUnique(rt,Rt)):ht=dt.extendFlat({},Dt),it.push(ht)}}},br.supplyLayoutGlobalDefaults=function(Ne,Ge,Qe){function coerce(Qe,tt){return dt.coerce(Ne,Ge,br.layoutAttributes,Qe,tt)}var tt=Ne.template;dt.isPlainObject(tt)&&(Ge.template=tt,Ge._template=tt.layout,Ge._dataTemplate=tt.data),coerce("autotypenumbers");var rt=dt.coerceFont(coerce,"font");coerce("title.text",Ge._dfltTitle.plot),dt.coerceFont(coerce,"title.font",{family:rt.family,size:Math.round(1.4*rt.size),color:rt.color}),coerce("title.xref"),coerce("title.yref"),coerce("title.x"),coerce("title.y"),coerce("title.xanchor"),coerce("title.yanchor"),coerce("title.pad.t"),coerce("title.pad.r"),coerce("title.pad.b"),coerce("title.pad.l"),coerce("uniformtext.mode")&&coerce("uniformtext.minsize"),coerce("autosize",!(Ne.width&&Ne.height)),coerce("width"),coerce("height"),coerce("margin.l"),coerce("margin.r"),coerce("margin.t"),coerce("margin.b"),coerce("margin.pad"),coerce("margin.autoexpand"),Ne.width&&Ne.height&&br.sanitizeMargins(Ge),at.getComponentMethod("grid","sizeDefaults")(Ne,Ge),coerce("paper_bgcolor"),coerce("separators",Qe.decimal+Qe.thousands),coerce("hidesources"),coerce("colorway"),coerce("datarevision");var nt=coerce("uirevision");coerce("editrevision",nt),coerce("selectionrevision",nt),coerce("modebar.orientation"),coerce("modebar.bgcolor",ht.addOpacity(Ge.paper_bgcolor,.5));var it=ht.contrast(ht.rgb(Ge.modebar.bgcolor));coerce("modebar.color",ht.addOpacity(it,.3)),coerce("modebar.activecolor",ht.addOpacity(it,.7)),coerce("modebar.uirevision",nt),at.getComponentMethod("shapes","supplyDrawNewShapeDefaults")(Ne,Ge,coerce),coerce("meta"),dt.isPlainObject(Ne.transition)&&(coerce("transition.duration"),coerce("transition.easing"),coerce("transition.ordering")),at.getComponentMethod("calendars","handleDefaults")(Ne,Ge,"calendar"),at.getComponentMethod("fx","supplyLayoutGlobalDefaults")(Ne,Ge,coerce)},br.plotAutoSize=function(Ne,Ge,Qe){var tt,rt,at=Ne._context||{},it=at.frameMargins,ot=dt.isPlotDiv(Ne);if(ot&&Ne.emit("plotly_autosize"),at.fillFrame)tt=window.innerWidth,rt=window.innerHeight,document.body.style.overflow="hidden";else{var ht=ot?window.getComputedStyle(Ne):{};if(tt=getComputedSize(ht.width)||getComputedSize(ht.maxWidth)||Qe.width,rt=getComputedSize(ht.height)||getComputedSize(ht.maxHeight)||Qe.height,nt(it)&&it>0){var Dt=1-2*it;tt=Math.round(Dt*tt),rt=Math.round(Dt*rt)}}var Ot=br.layoutAttributes.width.min,Rt=br.layoutAttributes.height.min;tt<Ot&&(tt=Ot),rt<Rt&&(rt=Rt);var Zt=!Ge.width&&Math.abs(Qe.width-tt)>1,er=!Ge.height&&Math.abs(Qe.height-rt)>1;(er||Zt)&&(Zt&&(Qe.width=tt),er&&(Qe.height=rt)),Ne._initialAutoSize||(Ne._initialAutoSize={width:tt,height:rt}),br.sanitizeMargins(Qe)},br.supplyLayoutModuleDefaults=function(Ne,Ge,Qe,tt){var rt,nt,it,ot=at.componentsRegistry,ht=Ge._basePlotModules,Dt=at.subplotsRegistry.cartesian;for(rt in ot)(it=ot[rt]).includeBasePlot&&it.includeBasePlot(Ne,Ge);for(var Ot in ht.length||ht.push(Dt),Ge._has("cartesian")&&(at.getComponentMethod("grid","contentDefaults")(Ne,Ge),Dt.finalizeSubplots(Ne,Ge)),Ge._subplots)Ge._subplots[Ot].sort(dt.subplotSort);for(nt=0;nt<ht.length;nt++)(it=ht[nt]).supplyLayoutDefaults&&it.supplyLayoutDefaults(Ne,Ge,Qe);var Rt=Ge._modules;for(nt=0;nt<Rt.length;nt++)(it=Rt[nt]).supplyLayoutDefaults&&it.supplyLayoutDefaults(Ne,Ge,Qe);var Zt=Ge._transformModules;for(nt=0;nt<Zt.length;nt++)(it=Zt[nt]).supplyLayoutDefaults&&it.supplyLayoutDefaults(Ne,Ge,Qe,tt);for(rt in ot)(it=ot[rt]).supplyLayoutDefaults&&it.supplyLayoutDefaults(Ne,Ge,Qe)},br.purge=function(Ne){var Ge=Ne._fullLayout||{};void 0!==Ge._glcontainer&&(Ge._glcontainer.selectAll(".gl-canvas").remove(),Ge._glcontainer.remove(),Ge._glcanvas=null),Ge._modeBar&&Ge._modeBar.destroy(),Ne._transitionData&&(Ne._transitionData._interruptCallbacks&&(Ne._transitionData._interruptCallbacks.length=0),Ne._transitionData._animationRaf&&window.cancelAnimationFrame(Ne._transitionData._animationRaf)),dt.clearThrottle(),dt.clearResponsive(Ne),delete Ne.data,delete Ne.layout,delete Ne._fullData,delete Ne._fullLayout,delete Ne.calcdata,delete Ne.framework,delete Ne.empty,delete Ne.fid,delete Ne.undoqueue,delete Ne.undonum,delete Ne.autoplay,delete Ne.changed,delete Ne._promises,delete Ne._redrawTimer,delete Ne._hmlumcount,delete Ne._hmpixcount,delete Ne._transitionData,delete Ne._transitioning,delete Ne._initialAutoSize,delete Ne._transitioningWithDuration,delete Ne._dragging,delete Ne._dragged,delete Ne._dragdata,delete Ne._hoverdata,delete Ne._snapshotInProgress,delete Ne._editing,delete Ne._mouseDownTime,delete Ne._legendMouseDownTime,Ne.removeAllListeners&&Ne.removeAllListeners()},br.style=function(Ne){var Ge,Qe=Ne._fullLayout._visibleModules,tt=[];for(Ge=0;Ge<Qe.length;Ge++){var rt=Qe[Ge];rt.style&&dt.pushUnique(tt,rt.style)}for(Ge=0;Ge<tt.length;Ge++)tt[Ge](Ne)},br.sanitizeMargins=function(Ne){if(Ne&&Ne.margin){var Ge,Qe=Ne.width,tt=Ne.height,rt=Ne.margin,nt=Qe-(rt.l+rt.r),at=tt-(rt.t+rt.b);nt<0&&(Ge=(Qe-1)/(rt.l+rt.r),rt.l=Math.floor(Ge*rt.l),rt.r=Math.floor(Ge*rt.r)),at<0&&(Ge=(tt-1)/(rt.t+rt.b),rt.t=Math.floor(Ge*rt.t),rt.b=Math.floor(Ge*rt.b))}},br.clearAutoMarginIds=function(Ne){Ne._fullLayout._pushmarginIds={}},br.allowAutoMargin=function(Ne,Ge){Ne._fullLayout._pushmarginIds[Ge]=1};var kn=2,Cn=2,En=64,Pn=64;function hideOutOfRangeInsideTickLabels(Ne){for(var Ge=Ot.list(Ne,"",!0),Qe=0;Qe<Ge.length;Qe++){var tt=Ge[Qe]._hideOutOfRangeInsideTickLabels;tt&&tt()}}br.autoMargin=function(Ne,Ge,Qe){var tt=Ne._fullLayout,rt=tt.width,nt=tt.height,at=tt.margin,it=dt.constrain(rt-at.l-at.r,kn,En),ot=dt.constrain(nt-at.t-at.b,Cn,Pn),ht=Math.max(0,rt-it),Dt=Math.max(0,nt-ot),Ot=tt._pushmargin,Rt=tt._pushmarginIds;if(!1!==at.autoexpand){if(Qe){var Zt=Qe.pad;if(void 0===Zt&&(Zt=Math.min(12,at.l,at.r,at.t,at.b)),ht){var er=(Qe.l+Qe.r)/ht;er>1&&(Qe.l/=er,Qe.r/=er)}if(Dt){var dr=(Qe.t+Qe.b)/Dt;dr>1&&(Qe.t/=dr,Qe.b/=dr)}var mr=void 0!==Qe.xl?Qe.xl:Qe.x,xr=void 0!==Qe.xr?Qe.xr:Qe.x,Ar=void 0!==Qe.yt?Qe.yt:Qe.y,en=void 0!==Qe.yb?Qe.yb:Qe.y;Ot[Ge]={l:{val:mr,size:Qe.l+Zt},r:{val:xr,size:Qe.r+Zt},b:{val:en,size:Qe.b+Zt},t:{val:Ar,size:Qe.t+Zt}},Rt[Ge]=1}else delete Ot[Ge],delete Rt[Ge];if(!tt._replotting)return br.doAutoMargin(Ne)}},br.doAutoMargin=function(Ne){var Ge=Ne._fullLayout,Qe=Ge.width,tt=Ge.height;Ge._size||(Ge._size={}),initMargins(Ge);var rt=Ge._size,it=Ge.margin,ot=dt.extendFlat({},rt),ht=it.l,Dt=it.r,Ot=it.t,Rt=it.b,Zt=Ge._pushmargin,er=Ge._pushmarginIds;if(!1!==Ge.margin.autoexpand){for(var dr in Zt)er[dr]||delete Zt[dr];for(var mr in Zt.base={l:{val:0,size:ht},r:{val:1,size:Dt},t:{val:1,size:Ot},b:{val:0,size:Rt}},Zt){var xr=Zt[mr].l||{},Ar=Zt[mr].b||{},en=xr.val,mn=xr.size,xn=Ar.val,Dn=Ar.size;for(var In in Zt){if(nt(mn)&&Zt[In].r){var zn=Zt[In].r.val,Bn=Zt[In].r.size;if(zn>en){var Vn=(mn*zn+(Bn-Qe)*en)/(zn-en),Hn=(Bn*(1-en)+(mn-Qe)*(1-zn))/(zn-en);Vn+Hn>ht+Dt&&(ht=Vn,Dt=Hn)}}if(nt(Dn)&&Zt[In].t){var qn=Zt[In].t.val,Yn=Zt[In].t.size;if(qn>xn){var $n=(Dn*qn+(Yn-tt)*xn)/(qn-xn),ra=(Yn*(1-xn)+(Dn-tt)*(1-qn))/(qn-xn);$n+ra>Rt+Ot&&(Rt=$n,Ot=ra)}}}}}var oa=dt.constrain(Qe-it.l-it.r,kn,En),pa=dt.constrain(tt-it.t-it.b,Cn,Pn),ga=Math.max(0,Qe-oa),ma=Math.max(0,tt-pa);if(ga){var _a=(ht+Dt)/ga;_a>1&&(ht/=_a,Dt/=_a)}if(ma){var Va=(Rt+Ot)/ma;Va>1&&(Rt/=Va,Ot/=Va)}if(rt.l=Math.round(ht),rt.r=Math.round(Dt),rt.t=Math.round(Ot),rt.b=Math.round(Rt),rt.p=Math.round(it.pad),rt.w=Math.round(Qe)-rt.l-rt.r,rt.h=Math.round(tt)-rt.t-rt.b,!Ge._replotting&&br.didMarginChange(ot,rt)){"_redrawFromAutoMarginCount"in Ge?Ge._redrawFromAutoMarginCount++:Ge._redrawFromAutoMarginCount=1;var Wa=3*(1+Object.keys(er).length);if(Ge._redrawFromAutoMarginCount<Wa)return at.call("plot",Ne);Ge._size=ot,dt.warn("Too many auto-margin redraws.")}hideOutOfRangeInsideTickLabels(Ne)};var Dn=["l","r","t","b","p","w","h"];function _transition(Ne,Ge,Qe){var tt=!1;function executeCallbacks(Ne){var Ge=Promise.resolve();if(!Ne)return Ge;for(;Ne.length;)Ge=Ge.then(Ne.shift());return Ge}function flushCallbacks(Ne){if(Ne)for(;Ne.length;)Ne.shift()}function executeTransitions(){return Ne.emit("plotly_transitioning",[]),new Promise((function(rt){Ne._transitioning=!0,Ge.duration>0&&(Ne._transitioningWithDuration=!0),Ne._transitionData._interruptCallbacks.push((function(){tt=!0})),Qe.redraw&&Ne._transitionData._interruptCallbacks.push((function(){return at.call("redraw",Ne)})),Ne._transitionData._interruptCallbacks.push((function(){Ne.emit("plotly_transitioninterrupted",[])}));var nt=0,it=0;function makeCallback(){return nt++,function(){it++,tt||it!==nt||completeTransition(rt)}}Qe.runFn(makeCallback),setTimeout(makeCallback())}))}function completeTransition(Ge){if(Ne._transitionData)return flushCallbacks(Ne._transitionData._interruptCallbacks),Promise.resolve().then((function(){if(Qe.redraw)return at.call("redraw",Ne)})).then((function(){Ne._transitioning=!1,Ne._transitioningWithDuration=!1,Ne.emit("plotly_transitioned",[])})).then(Ge)}function interruptPreviousTransitions(){if(Ne._transitionData)return Ne._transitioning=!1,executeCallbacks(Ne._transitionData._interruptCallbacks)}var rt=[br.previousPromises,interruptPreviousTransitions,Qe.prepareFn,br.rehover,executeTransitions],nt=dt.syncOrAsync(rt,Ne);return nt&&nt.then||(nt=Promise.resolve()),nt.then((function(){return Ne}))}br.didMarginChange=function(Ne,Ge){for(var Qe=0;Qe<Dn.length;Qe++){var tt=Dn[Qe],rt=Ne[tt],at=Ge[tt];if(!nt(rt)||Math.abs(at-rt)>1)return!0}return!1},br.graphJson=function(Ne,Ge,Qe,tt,rt,nt){(rt&&Ge&&!Ne._fullData||rt&&!Ge&&!Ne._fullLayout)&&br.supplyDefaults(Ne);var at=rt?Ne._fullData:Ne.data,it=rt?Ne._fullLayout:Ne.layout,ot=(Ne._transitionData||{})._frames;function stripObj(Ne,Ge){if("function"==typeof Ne)return Ge?"_function_":null;if(dt.isPlainObject(Ne)){var tt,rt={};return Object.keys(Ne).sort().forEach((function(nt){if(-1===["_","["].indexOf(nt.charAt(0)))if("function"!=typeof Ne[nt]){if("keepdata"===Qe){if("src"===nt.substr(nt.length-3))return}else if("keepstream"===Qe){if("string"==typeof(tt=Ne[nt+"src"])&&tt.indexOf(":")>0&&!dt.isPlainObject(Ne.stream))return}else if("keepall"!==Qe&&"string"==typeof(tt=Ne[nt+"src"])&&tt.indexOf(":")>0)return;rt[nt]=stripObj(Ne[nt],Ge)}else Ge&&(rt[nt]="_function")})),rt}return Array.isArray(Ne)?Ne.map((function(Ne){return stripObj(Ne,Ge)})):dt.isTypedArray(Ne)?dt.simpleMap(Ne,dt.identity):dt.isJSDate(Ne)?dt.ms2DateTimeLocal(+Ne):Ne}var ht={data:(at||[]).map((function(Ne){var Qe=stripObj(Ne);return Ge&&delete Qe.fit,Qe}))};if(!Ge&&(ht.layout=stripObj(it),rt)){var Dt=it._size;ht.layout.computed={margin:{b:Dt.b,l:Dt.l,r:Dt.r,t:Dt.t}}}return Ne.framework&&Ne.framework.isPolar&&(ht=Ne.framework.getConfig()),ot&&(ht.frames=stripObj(ot)),nt&&(ht.config=stripObj(Ne._context,!0)),"object"===tt?ht:JSON.stringify(ht)},br.modifyFrames=function(Ne,Ge){var Qe,tt,rt,nt=Ne._transitionData._frames,at=Ne._transitionData._frameHash;for(Qe=0;Qe<Ge.length;Qe++)switch((tt=Ge[Qe]).type){case"replace":rt=tt.value;var it=(nt[tt.index]||{}).name,ot=rt.name;nt[tt.index]=at[ot]=rt,ot!==it&&(delete at[it],at[ot]=rt);break;case"insert":at[(rt=tt.value).name]=rt,nt.splice(tt.index,0,rt);break;case"delete":delete at[(rt=nt[tt.index]).name],nt.splice(tt.index,1)}return Promise.resolve()},br.computeFrame=function(Ne,Ge){var Qe,tt,rt,nt,at=Ne._transitionData._frameHash;if(!Ge)throw new Error("computeFrame must be given a string frame name");var it=at[Ge.toString()];if(!it)return!1;for(var ot=[it],dt=[it.name];it.baseframe&&(it=at[it.baseframe.toString()])&&-1===dt.indexOf(it.name);)ot.push(it),dt.push(it.name);for(var ht={};it=ot.pop();)if(it.layout&&(ht.layout=br.extendLayout(ht.layout,it.layout)),it.data){if(ht.data||(ht.data=[]),!(tt=it.traces))for(tt=[],Qe=0;Qe<it.data.length;Qe++)tt[Qe]=Qe;for(ht.traces||(ht.traces=[]),Qe=0;Qe<it.data.length;Qe++)null!=(rt=tt[Qe])&&(-1===(nt=ht.traces.indexOf(rt))&&(nt=ht.data.length,ht.traces[nt]=rt),ht.data[nt]=br.extendTrace(ht.data[nt],it.data[Qe]))}return ht},br.recomputeFrameHash=function(Ne){for(var Ge=Ne._transitionData._frameHash={},Qe=Ne._transitionData._frames,tt=0;tt<Qe.length;tt++){var rt=Qe[tt];rt&&rt.name&&(Ge[rt.name]=rt)}},br.extendObjectWithContainers=function(Ne,Ge,Qe){var tt,rt,nt,at,it,ot,ht,Dt=dt.extendDeepNoArrays({},Ge||{}),Ot=dt.expandObjectPaths(Dt),Rt={};if(Qe&&Qe.length)for(nt=0;nt<Qe.length;nt++)void 0===(rt=(tt=dt.nestedProperty(Ot,Qe[nt])).get())?dt.nestedProperty(Rt,Qe[nt]).set(null):(tt.set(null),dt.nestedProperty(Rt,Qe[nt]).set(rt));if(Ne=dt.extendDeepNoArrays(Ne||{},Ot),Qe&&Qe.length)for(nt=0;nt<Qe.length;nt++)if(ot=dt.nestedProperty(Rt,Qe[nt]).get()){for(ht=(it=dt.nestedProperty(Ne,Qe[nt])).get(),Array.isArray(ht)||(ht=[],it.set(ht)),at=0;at<ot.length;at++){var Zt=ot[at];ht[at]=null===Zt?null:br.extendObjectWithContainers(ht[at],Zt)}it.set(ht)}return Ne},br.dataArrayContainers=["transforms","dimensions"],br.layoutArrayContainers=at.layoutArrayContainers,br.extendTrace=function(Ne,Ge){return br.extendObjectWithContainers(Ne,Ge,br.dataArrayContainers)},br.extendLayout=function(Ne,Ge){return br.extendObjectWithContainers(Ne,Ge,br.layoutArrayContainers)},br.transition=function(Ne,Ge,Qe,tt,rt,nt){var at={redraw:rt.redraw},it={},ot=[];return at.prepareFn=function(){for(var rt=Array.isArray(Ge)?Ge.length:0,nt=tt.slice(0,rt),at=0;at<nt.length;at++){var ht=nt[at],Dt=Ne._fullData[ht]._module;if(Dt){if(Dt.animatable){var Ot=Dt.basePlotModule.name;it[Ot]||(it[Ot]=[]),it[Ot].push(ht)}Ne.data[nt[at]]=br.extendTrace(Ne.data[nt[at]],Ge[at])}}var Rt=dt.expandObjectPaths(dt.extendDeepNoArrays({},Qe)),Zt=/^[xy]axis[0-9]*$/;for(var er in Rt)Zt.test(er)&&delete Rt[er].range;br.extendLayout(Ne.layout,Rt),delete Ne.calcdata,br.supplyDefaults(Ne),br.doCalcdata(Ne);var dr=dt.expandObjectPaths(Qe);if(dr){var mr=Ne._fullLayout._plots;for(var xr in mr){var Ar=mr[xr],en=Ar.xaxis,mn=Ar.yaxis,xn=en.range.slice(),kn=mn.range.slice(),Cn=null,En=null,Pn=null,Dn=null;Array.isArray(dr[en._name+".range"])?Cn=dr[en._name+".range"].slice():Array.isArray((dr[en._name]||{}).range)&&(Cn=dr[en._name].range.slice()),Array.isArray(dr[mn._name+".range"])?En=dr[mn._name+".range"].slice():Array.isArray((dr[mn._name]||{}).range)&&(En=dr[mn._name].range.slice()),xn&&Cn&&(en.r2l(xn[0])!==en.r2l(Cn[0])||en.r2l(xn[1])!==en.r2l(Cn[1]))&&(Pn={xr0:xn,xr1:Cn}),kn&&En&&(mn.r2l(kn[0])!==mn.r2l(En[0])||mn.r2l(kn[1])!==mn.r2l(En[1]))&&(Dn={yr0:kn,yr1:En}),(Pn||Dn)&&ot.push(dt.extendFlat({plotinfo:Ar},Pn,Dn))}}return Promise.resolve()},at.runFn=function(Ge){var tt,rt,at=Ne._fullLayout._basePlotModules,ht=ot.length;if(Qe)for(rt=0;rt<at.length;rt++)at[rt].transitionAxes&&at[rt].transitionAxes(Ne,ot,nt,Ge);for(var Dt in ht?((tt=dt.extendFlat({},nt)).duration=0,delete it.cartesian):tt=nt,it){var Ot=it[Dt];Ne._fullData[Ot[0]]._module.basePlotModule.plot(Ne,Ot,tt,Ge)}},_transition(Ne,nt,at)},br.transitionFromReact=function(Ne,Ge,Qe,tt){var rt=Ne._fullLayout,nt=rt.transition,at={},it=[];return at.prepareFn=function(){var Ne=rt._plots;for(var nt in at.redraw=!1,"some"===Ge.anim&&(at.redraw=!0),"some"===Qe.anim&&(at.redraw=!0),Ne){var ot=Ne[nt],ht=ot.xaxis,Dt=ot.yaxis,Ot=tt[ht._name].range.slice(),Rt=tt[Dt._name].range.slice(),Zt=ht.range.slice(),er=Dt.range.slice();ht.setScale(),Dt.setScale();var dr=null,mr=null;ht.r2l(Ot[0])===ht.r2l(Zt[0])&&ht.r2l(Ot[1])===ht.r2l(Zt[1])||(dr={xr0:Ot,xr1:Zt}),Dt.r2l(Rt[0])===Dt.r2l(er[0])&&Dt.r2l(Rt[1])===Dt.r2l(er[1])||(mr={yr0:Rt,yr1:er}),(dr||mr)&&it.push(dt.extendFlat({plotinfo:ot},dr,mr))}return Promise.resolve()},at.runFn=function(Qe){for(var tt,rt,at,ot=Ne._fullData,ht=Ne._fullLayout._basePlotModules,Dt=[],Ot=0;Ot<ot.length;Ot++)Dt.push(Ot);function transitionAxes(){for(var Ge=0;Ge<ht.length;Ge++)ht[Ge].transitionAxes&&ht[Ge].transitionAxes(Ne,it,tt,Qe)}function transitionTraces(){for(var Ge=0;Ge<ht.length;Ge++)ht[Ge].plot(Ne,at,rt,Qe)}it.length&&Ge.anim?"traces first"===nt.ordering?(tt=dt.extendFlat({},nt,{duration:0}),at=Dt,rt=nt,setTimeout(transitionAxes,nt.duration),transitionTraces()):(tt=nt,at=null,rt=dt.extendFlat({},nt,{duration:0}),setTimeout(transitionTraces,tt.duration),transitionAxes()):it.length?(tt=nt,transitionAxes()):Ge.anim&&(at=Dt,rt=nt,transitionTraces())},_transition(Ne,nt,at)},br.doCalcdata=function(Ne,Ge){var Qe,tt,rt,nt,ot=Ot.list(Ne),dt=Ne._fullData,ht=Ne._fullLayout,Rt=new Array(dt.length),Zt=(Ne.calcdata||[]).slice();for(Ne.calcdata=Rt,ht._numBoxes=0,ht._numViolins=0,ht._violinScaleGroupStats={},Ne._hmpixcount=0,Ne._hmlumcount=0,ht._piecolormap={},ht._sunburstcolormap={},ht._treemapcolormap={},ht._funnelareacolormap={},rt=0;rt<dt.length;rt++)Array.isArray(Ge)&&-1===Ge.indexOf(rt)&&(Rt[rt]=Zt[rt]);for(rt=0;rt<dt.length;rt++)(Qe=dt[rt])._arrayAttrs=it.findArrayAttributes(Qe),Qe._extremes={};var er=ht._subplots.polar||[];for(rt=0;rt<er.length;rt++)ot.push(ht[er[rt]].radialaxis,ht[er[rt]].angularaxis);for(var dr in ht._colorAxes){var mr=ht[dr];!1!==mr.cauto&&(delete mr.cmin,delete mr.cmax)}var xr=!1;function transformCalci(Ge){if(Qe=dt[Ge],tt=Qe._module,!0===Qe.visible&&Qe.transforms){if(tt&&tt.calc){var rt=tt.calc(Ne,Qe);rt[0]&&rt[0].t&&rt[0].t._scene&&delete rt[0].t._scene.dirty}for(nt=0;nt<Qe.transforms.length;nt++){var at=Qe.transforms[nt];(tt=Ar[at.type])&&tt.calcTransform&&(Qe._hasCalcTransform=!0,xr=!0,tt.calcTransform(Ne,Qe,at))}}}function calci(Ge,rt){if(Qe=dt[Ge],!!(tt=Qe._module).isContainer===rt){var at=[];if(!0===Qe.visible&&0!==Qe._length){delete Qe._indexToPoints;var it=Qe.transforms||[];for(nt=it.length-1;nt>=0;nt--)if(it[nt].enabled){Qe._indexToPoints=it[nt]._indexToPoints;break}tt&&tt.calc&&(at=tt.calc(Ne,Qe))}Array.isArray(at)&&at[0]||(at=[{x:Dt,y:Dt}]),at[0].t||(at[0].t={}),at[0].trace=Qe,Rt[Ge]=at}}for(setupAxisCategories(ot,dt,ht),rt=0;rt<dt.length;rt++)calci(rt,!0);for(rt=0;rt<dt.length;rt++)transformCalci(rt);for(xr&&setupAxisCategories(ot,dt,ht),rt=0;rt<dt.length;rt++)calci(rt,!0);for(rt=0;rt<dt.length;rt++)calci(rt,!1);doCrossTraceCalc(Ne);var br=sortAxisCategoriesByValue(ot,Ne);if(br.length){for(ht._numBoxes=0,ht._numViolins=0,rt=0;rt<br.length;rt++)calci(br[rt],!0);for(rt=0;rt<br.length;rt++)calci(br[rt],!1);doCrossTraceCalc(Ne)}at.getComponentMethod("fx","calc")(Ne),at.getComponentMethod("errorbars","calc")(Ne)};var In=/(total|sum|min|max|mean|median) (ascending|descending)/;function sortAxisCategoriesByValue(Ne,Ge){var Qe,tt,rt,nt,it,ot=[];function zMapCategory(Ne,Qe,tt){var rt=Qe._id.charAt(0);if("histogram2dcontour"===Ne){var nt=Qe._counterAxes[0],at=Ot.getFromId(Ge,nt),it="x"===rt||"x"===nt&&"category"===at.type,ot="y"===rt||"y"===nt&&"category"===at.type;return function(Ne,Ge){return 0===Ne||0===Ge||it&&Ne===tt[Ge].length-1||ot&&Ge===tt.length-1?-1:("y"===rt?Ge:Ne)-1}}return function(Ne,Ge){return"y"===rt?Ge:Ne}}var ht={min:function(Ne){return dt.aggNums(Math.min,null,Ne)},max:function(Ne){return dt.aggNums(Math.max,null,Ne)},sum:function(Ne){return dt.aggNums((function(Ne,Ge){return Ne+Ge}),null,Ne)},total:function(Ne){return dt.aggNums((function(Ne,Ge){return Ne+Ge}),null,Ne)},mean:function(Ne){return dt.mean(Ne)},median:function(Ne){return dt.median(Ne)}};for(Qe=0;Qe<Ne.length;Qe++){var Dt=Ne[Qe];if("category"===Dt.type){var Rt=Dt.categoryorder.match(In);if(Rt){var Zt=Rt[1],er=Rt[2],dr=Dt._id.charAt(0),mr="x"===dr,xr=[];for(tt=0;tt<Dt._categories.length;tt++)xr.push([Dt._categories[tt],[]]);for(tt=0;tt<Dt._traceIndices.length;tt++){var br=Dt._traceIndices[tt],Ar=Ge._fullData[br];if(!0===Ar.visible){var en=Ar.type;at.traceIs(Ar,"histogram")&&(delete Ar._xautoBinFinished,delete Ar._yautoBinFinished);var mn="splom"===en,xn="scattergl"===en,kn=Ge.calcdata[br];for(rt=0;rt<kn.length;rt++){var Cn,En,Pn=kn[rt];if(mn){var Dn=Ar._axesDim[Dt._id];if(!mr){var zn=Ar._diag[Dn][0];zn&&(Dt=Ge._fullLayout[Ot.id2name(zn)])}var Bn=Pn.trace.dimensions[Dn].values;for(nt=0;nt<Bn.length;nt++)for(Cn=Dt._categoriesMap[Bn[nt]],it=0;it<Pn.trace.dimensions.length;it++)if(it!==Dn){var Vn=Pn.trace.dimensions[it];xr[Cn][1].push(Vn.values[nt])}}else if(xn){for(nt=0;nt<Pn.t.x.length;nt++)mr?(Cn=Pn.t.x[nt],En=Pn.t.y[nt]):(Cn=Pn.t.y[nt],En=Pn.t.x[nt]),xr[Cn][1].push(En);Pn.t&&Pn.t._scene&&delete Pn.t._scene.dirty}else if(Pn.hasOwnProperty("z")){En=Pn.z;var Hn=zMapCategory(Ar.type,Dt,En);for(nt=0;nt<En.length;nt++)for(it=0;it<En[nt].length;it++)(Cn=Hn(it,nt))+1&&xr[Cn][1].push(En[nt][it])}else for(void 0===(Cn=Pn.p)&&(Cn=Pn[dr]),void 0===(En=Pn.s)&&(En=Pn.v),void 0===En&&(En=mr?Pn.y:Pn.x),Array.isArray(En)||(En=void 0===En?[]:[En]),nt=0;nt<En.length;nt++)xr[Cn][1].push(En[nt])}}}Dt._categoriesValue=xr;var qn=[];for(tt=0;tt<xr.length;tt++)qn.push([xr[tt][0],ht[Zt](xr[tt][1])]);qn.sort((function(Ne,Ge){return Ne[1]-Ge[1]})),Dt._categoriesAggregatedValue=qn,Dt._initialCategories=qn.map((function(Ne){return Ne[0]})),"descending"===er&&Dt._initialCategories.reverse(),ot=ot.concat(Dt.sortByInitialCategories())}}}return ot}function setupAxisCategories(Ne,Ge,Qe){var tt={};function setupOne(Ne){Ne.clearCalc(),"multicategory"===Ne.type&&Ne.setupMultiCategory(Ge),tt[Ne._id]=1}dt.simpleMap(Ne,setupOne);for(var rt=Qe._axisMatchGroups||[],nt=0;nt<rt.length;nt++)for(var at in rt[nt])tt[at]||setupOne(Qe[Ot.id2name(at)])}function doCrossTraceCalc(Ne){var Ge,Qe,tt,rt=Ne._fullLayout,nt=rt._visibleModules,at={};for(Qe=0;Qe<nt.length;Qe++){var it=nt[Qe],ot=it.crossTraceCalc;if(ot){var ht=it.basePlotModule.name;at[ht]?dt.pushUnique(at[ht],ot):at[ht]=[ot]}}for(tt in at){var Dt=at[tt],Ot=rt._subplots[tt];if(Array.isArray(Ot))for(Ge=0;Ge<Ot.length;Ge++){var Rt=Ot[Ge],Zt="cartesian"===tt?rt._plots[Rt]:rt[Rt];for(Qe=0;Qe<Dt.length;Qe++)Dt[Qe](Ne,Zt,Rt)}else for(Qe=0;Qe<Dt.length;Qe++)Dt[Qe](Ne)}}br.rehover=function(Ne){Ne._fullLayout._rehover&&Ne._fullLayout._rehover()},br.redrag=function(Ne){Ne._fullLayout._redrag&&Ne._fullLayout._redrag()},br.generalUpdatePerTraceModule=function(Ne,Ge,Qe,tt){var rt,nt=Ge.traceHash,at={};for(rt=0;rt<Qe.length;rt++){var it=Qe[rt],ot=it[0].trace;ot.visible&&(at[ot.type]=at[ot.type]||[],at[ot.type].push(it))}for(var ht in nt)if(!at[ht]){var Dt=nt[ht][0];Dt[0].trace.visible=!1,at[ht]=[Dt]}for(var Ot in at){var Rt=at[Ot];Rt[0][0].trace._module.plot(Ne,Ge,dt.filterVisible(Rt),tt)}Ge.traceHash=at},br.plotBasePlot=function(Ne,Ge,Qe,tt,rt){var nt=at.getModule(Ne),it=dr(Ge.calcdata,nt)[0];nt.plot(Ge,it,tt,rt)},br.cleanBasePlot=function(Ne,Ge,Qe,tt,rt){var nt=rt._has&&rt._has(Ne),at=Qe._has&&Qe._has(Ne);nt&&!at&&rt["_"+Ne+"layer"].selectAll("g.trace").remove()}},{"../components/color":643,"../constants/numerical":753,"../lib":778,"../plot_api/plot_schema":816,"../plot_api/plot_template":817,"../plots/get_data":865,"../registry":911,"./animation_attributes":822,"./attributes":824,"./cartesian/axis_ids":831,"./cartesian/handle_outline":838,"./command":854,"./font_attributes":856,"./frame_attributes":857,"./layout_attributes":882,d3:169,"d3-time-format":166,"fast-isnumeric":241}],892:[function(Ne,Ge,Qe){"use strict";Ge.exports={attr:"subplot",name:"polar",axisNames:["angularaxis","radialaxis"],axisName2dataArray:{angularaxis:"theta",radialaxis:"r"},layerNames:["draglayer","plotbg","backplot","angular-grid","radial-grid","frontplot","angular-line","radial-line","angular-axis","radial-axis"],radialDragBoxSize:50,angularDragBoxSize:30,cornerLen:25,cornerHalfWidth:2,MINDRAG:8,MINZOOM:20,OFFEDGE:20}},{}],893:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../lib/polygon").tester,nt=tt.findIndexOfMin,at=tt.isAngleInsideSector,it=tt.angleDelta,ot=tt.angleDist;function isPtInsidePolygon(Ne,Ge,Qe,tt,nt){if(!at(Ge,tt))return!1;var it,ot;Qe[0]<Qe[1]?(it=Qe[0],ot=Qe[1]):(it=Qe[1],ot=Qe[0]);var dt=rt(makePolygon(it,tt[0],tt[1],nt)),ht=rt(makePolygon(ot,tt[0],tt[1],nt)),Dt=[Ne*Math.cos(Ge),Ne*Math.sin(Ge)];return ht.contains(Dt)&&!dt.contains(Dt)}function findIntersectionXY(Ne,Ge,Qe,tt){var rt,nt,at=tt[0],it=tt[1],ot=clampTiny(Math.sin(Ge)-Math.sin(Ne)),dt=clampTiny(Math.cos(Ge)-Math.cos(Ne)),ht=Math.tan(Qe),Dt=clampTiny(1/ht),Ot=ot/dt,Rt=it-Ot*at;return Dt?ot&&dt?nt=ht*(rt=Rt/(ht-Ot)):dt?(rt=it*Dt,nt=it):(rt=at,nt=at*ht):ot&&dt?(rt=0,nt=Rt):dt?(rt=0,nt=it):rt=nt=NaN,[rt,nt]}function findXYatLength(Ne,Ge,Qe,tt){var rt=-Ge*Qe,nt=Ge*Ge+1,at=2*(Ge*rt-Qe),it=rt*rt+Qe*Qe-Ne*Ne,ot=Math.sqrt(at*at-4*nt*it),dt=(-at+ot)/(2*nt),ht=(-at-ot)/(2*nt);return[[dt,Ge*dt+rt+tt],[ht,Ge*ht+rt+tt]]}function makeRegularPolygon(Ne,Ge){var Qe,tt=Ge.length,rt=new Array(tt+1);for(Qe=0;Qe<tt;Qe++){var nt=Ge[Qe];rt[Qe]=[Ne*Math.cos(nt),Ne*Math.sin(nt)]}return rt[Qe]=rt[0].slice(),rt}function makeClippedPolygon(Ne,Ge,Qe,rt){var it,dt,ht=rt.length,Dt=[];function a2xy(Ge){return[Ne*Math.cos(Ge),Ne*Math.sin(Ge)]}function findXY(Ne,Ge,Qe){return findIntersectionXY(Ne,Ge,Qe,a2xy(Ne))}function cycleIndex(Ne){return tt.mod(Ne,ht)}function isInside(Ne){return at(Ne,[Ge,Qe])}var Ot=nt(rt,(function(Ne){return isInside(Ne)?ot(Ne,Ge):1/0})),Rt=findXY(rt[Ot],rt[cycleIndex(Ot-1)],Ge);for(Dt.push(Rt),it=Ot,dt=0;dt<ht;it++,dt++){var Zt=rt[cycleIndex(it)];if(!isInside(Zt))break;Dt.push(a2xy(Zt))}var er=nt(rt,(function(Ne){return isInside(Ne)?ot(Ne,Qe):1/0})),dr=findXY(rt[er],rt[cycleIndex(er+1)],Qe);return Dt.push(dr),Dt.push([0,0]),Dt.push(Dt[0].slice()),Dt}function makePolygon(Ne,Ge,Qe,rt){return tt.isFullCircle([Ge,Qe])?makeRegularPolygon(Ne,rt):makeClippedPolygon(Ne,Ge,Qe,rt)}function findPolygonOffset(Ne,Ge,Qe,tt){for(var rt=1/0,nt=1/0,at=makePolygon(Ne,Ge,Qe,tt),it=0;it<at.length;it++){var ot=at[it];rt=Math.min(rt,ot[0]),nt=Math.min(nt,-ot[1])}return[rt,nt]}function findEnclosingVertexAngles(Ne,Ge){var Qe=nt(Ge,(function(Ge){var Qe=it(Ge,Ne);return Qe>0?Qe:1/0})),rt=tt.mod(Qe+1,Ge.length);return[Ge[Qe],Ge[rt]]}function clampTiny(Ne){return Math.abs(Ne)>1e-10?Ne:0}function transformForSVG(Ne,Ge,Qe){Ge=Ge||0,Qe=Qe||0;for(var tt=Ne.length,rt=new Array(tt),nt=0;nt<tt;nt++){var at=Ne[nt];rt[nt]=[Ge+at[0],Qe-at[1]]}return rt}function pathPolygon(Ne,Ge,Qe,tt,rt,nt){return"M"+transformForSVG(makePolygon(Ne,Ge,Qe,tt),rt,nt).join("L")}function pathPolygonAnnulus(Ne,Ge,Qe,tt,rt,nt,at){var it,ot;Ne<Ge?(it=Ne,ot=Ge):(it=Ge,ot=Ne);var dt=transformForSVG(makePolygon(it,Qe,tt,rt),nt,at);return"M"+transformForSVG(makePolygon(ot,Qe,tt,rt),nt,at).reverse().join("L")+"M"+dt.join("L")}Ge.exports={isPtInsidePolygon:isPtInsidePolygon,findPolygonOffset:findPolygonOffset,findEnclosingVertexAngles:findEnclosingVertexAngles,findIntersectionXY:findIntersectionXY,findXYatLength:findXYatLength,clampTiny:clampTiny,pathPolygon:pathPolygon,pathPolygonAnnulus:pathPolygonAnnulus}},{"../../lib":778,"../../lib/polygon":790}],894:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../get_data").getSubplotCalcData,rt=Ne("../../lib").counterRegex,nt=Ne("./polar"),at=Ne("./constants"),it=at.attr,ot=at.name,dt=rt(ot),ht={};function plot(Ne){for(var Ge=Ne._fullLayout,Qe=Ne.calcdata,rt=Ge._subplots[ot],at=0;at<rt.length;at++){var it=rt[at],dt=tt(Qe,ot,it),ht=Ge[it]._subplot;ht||(ht=nt(Ne,it),Ge[it]._subplot=ht),ht.plot(dt,Ge,Ne._promises)}}function clean(Ne,Ge,Qe,tt){for(var rt=tt._subplots[ot]||[],nt=tt._has&&tt._has("gl"),at=Ge._has&&Ge._has("gl"),it=nt&&!at,dt=0;dt<rt.length;dt++){var ht=rt[dt],Dt=tt[ht]._subplot;if(!Ge[ht]&&Dt)for(var Ot in Dt.framework.remove(),Dt.layers["radial-axis-title"].remove(),Dt.clipPaths)Dt.clipPaths[Ot].remove();it&&Dt._scene&&(Dt._scene.destroy(),Dt._scene=null)}}ht[it]={valType:"subplotid",dflt:ot,editType:"calc"},Ge.exports={attr:it,name:ot,idRoot:ot,idRegex:dt,attrRegex:dt,attributes:ht,layoutAttributes:Ne("./layout_attributes"),supplyLayoutDefaults:Ne("./layout_defaults"),plot:plot,clean:clean,toSVG:Ne("../cartesian").toSVG}},{"../../lib":778,"../cartesian":841,"../get_data":865,"./constants":892,"./layout_attributes":895,"./layout_defaults":896,"./polar":903}],895:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/color/attributes"),rt=Ne("../cartesian/layout_attributes"),nt=Ne("../domain").attributes,at=Ne("../../lib").extendFlat,it=Ne("../../plot_api/edit_types").overrideAll,ot=it({color:rt.color,showline:at({},rt.showline,{dflt:!0}),linecolor:rt.linecolor,linewidth:rt.linewidth,showgrid:at({},rt.showgrid,{dflt:!0}),gridcolor:rt.gridcolor,gridwidth:rt.gridwidth},"plot","from-root"),dt=it({tickmode:rt.tickmode,nticks:rt.nticks,tick0:rt.tick0,dtick:rt.dtick,tickvals:rt.tickvals,ticktext:rt.ticktext,ticks:rt.ticks,ticklen:rt.ticklen,tickwidth:rt.tickwidth,tickcolor:rt.tickcolor,showticklabels:rt.showticklabels,showtickprefix:rt.showtickprefix,tickprefix:rt.tickprefix,showticksuffix:rt.showticksuffix,ticksuffix:rt.ticksuffix,showexponent:rt.showexponent,exponentformat:rt.exponentformat,minexponent:rt.minexponent,separatethousands:rt.separatethousands,tickfont:rt.tickfont,tickangle:rt.tickangle,tickformat:rt.tickformat,tickformatstops:rt.tickformatstops,layer:rt.layer},"plot","from-root"),ht={visible:at({},rt.visible,{dflt:!0}),type:at({},rt.type,{values:["-","linear","log","date","category"]}),autotypenumbers:rt.autotypenumbers,autorange:at({},rt.autorange,{editType:"plot"}),rangemode:{valType:"enumerated",values:["tozero","nonnegative","normal"],dflt:"tozero",editType:"calc"},range:at({},rt.range,{items:[{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}},{valType:"any",editType:"plot",impliedEdits:{"^autorange":!1}}],editType:"plot"}),categoryorder:rt.categoryorder,categoryarray:rt.categoryarray,angle:{valType:"angle",editType:"plot"},side:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"clockwise",editType:"plot"},title:{text:at({},rt.title.text,{editType:"plot",dflt:""}),font:at({},rt.title.font,{editType:"plot"}),editType:"plot"},hoverformat:rt.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc",_deprecated:{title:rt._deprecated.title,titlefont:rt._deprecated.titlefont}};at(ht,ot,dt);var Dt={visible:at({},rt.visible,{dflt:!0}),type:{valType:"enumerated",values:["-","linear","category"],dflt:"-",editType:"calc",_noTemplating:!0},autotypenumbers:rt.autotypenumbers,categoryorder:rt.categoryorder,categoryarray:rt.categoryarray,thetaunit:{valType:"enumerated",values:["radians","degrees"],dflt:"degrees",editType:"calc"},period:{valType:"number",editType:"calc",min:0},direction:{valType:"enumerated",values:["counterclockwise","clockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"angle",editType:"calc"},hoverformat:rt.hoverformat,uirevision:{valType:"any",editType:"none"},editType:"calc"};at(Dt,ot,dt),Ge.exports={domain:nt({name:"polar",editType:"plot"}),sector:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],dflt:[0,360],editType:"plot"},hole:{valType:"number",min:0,max:1,dflt:0,editType:"plot"},bgcolor:{valType:"color",editType:"plot",dflt:tt.background},radialaxis:ht,angularaxis:Dt,gridshape:{valType:"enumerated",values:["circular","linear"],dflt:"circular",editType:"plot"},uirevision:{valType:"any",editType:"none"},editType:"calc"}},{"../../components/color/attributes":642,"../../lib":778,"../../plot_api/edit_types":810,"../cartesian/layout_attributes":842,"../domain":855}],896:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../components/color"),nt=Ne("../../plot_api/plot_template"),at=Ne("../subplot_defaults"),it=Ne("../get_data").getSubplotData,ot=Ne("../cartesian/tick_value_defaults"),dt=Ne("../cartesian/tick_mark_defaults"),ht=Ne("../cartesian/tick_label_defaults"),Dt=Ne("../cartesian/category_order_defaults"),Ot=Ne("../cartesian/line_grid_defaults"),Rt=Ne("../cartesian/axis_autotype"),Zt=Ne("./layout_attributes"),er=Ne("./set_convert"),dr=Ne("./constants"),mr=dr.axisNames;function handleDefaults(Ne,Ge,Qe,at){var Rt=Qe("bgcolor");at.bgColor=rt.combine(Rt,at.paper_bgcolor);var xr=Qe("sector");Qe("hole");var br,Ar=it(at.fullData,dr.name,at.id),en=at.layoutOut;function coerceAxis(Ne,Ge){return Qe(br+"."+Ne,Ge)}for(var mn=0;mn<mr.length;mn++){br=mr[mn],tt.isPlainObject(Ne[br])||(Ne[br]={});var xn=Ne[br],kn=nt.newContainer(Ge,br);kn._id=kn._name=br,kn._attr=at.id+"."+br,kn._traceIndices=Ar.map((function(Ne){return Ne._expandedIndex}));var Cn=dr.axisName2dataArray[br],En=handleAxisTypeDefaults(xn,kn,coerceAxis,Ar,Cn,at);Dt(xn,kn,coerceAxis,{axData:Ar,dataAttr:Cn});var Pn,Dn,In=coerceAxis("visible");switch(er(kn,Ge,en),coerceAxis("uirevision",Ge.uirevision),In&&(Dn=(Pn=coerceAxis("color"))===xn.color?Pn:at.font.color),kn._m=1,br){case"radialaxis":var zn=coerceAxis("autorange",!kn.isValidRange(xn.range));xn.autorange=zn,!zn||"linear"!==En&&"-"!==En||coerceAxis("rangemode"),"reversed"===zn&&(kn._m=-1),coerceAxis("range"),kn.cleanRange("range",{dfltRange:[0,1]}),In&&(coerceAxis("side"),coerceAxis("angle",xr[0]),coerceAxis("title.text"),tt.coerceFont(coerceAxis,"title.font",{family:at.font.family,size:Math.round(1.2*at.font.size),color:Dn}));break;case"angularaxis":if("date"===En){tt.log("Polar plots do not support date angular axes yet.");for(var Bn=0;Bn<Ar.length;Bn++)Ar[Bn].visible=!1;En=xn.type=kn.type="linear"}coerceAxis("linear"===En?"thetaunit":"period");var Vn=coerceAxis("direction");coerceAxis("rotation",{counterclockwise:0,clockwise:90}[Vn])}In&&(ot(xn,kn,coerceAxis,kn.type),ht(xn,kn,coerceAxis,kn.type,{tickSuffixDflt:"degrees"===kn.thetaunit?"Â°":void 0}),dt(xn,kn,coerceAxis,{outerTicks:!0}),coerceAxis("showticklabels")&&(tt.coerceFont(coerceAxis,"tickfont",{family:at.font.family,size:at.font.size,color:Dn}),coerceAxis("tickangle"),coerceAxis("tickformat")),Ot(xn,kn,coerceAxis,{dfltColor:Pn,bgColor:at.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:Zt[br]}),coerceAxis("layer")),"category"!==En&&coerceAxis("hoverformat"),kn._input=xn}"category"===Ge.angularaxis.type&&Qe("gridshape")}function handleAxisTypeDefaults(Ne,Ge,Qe,tt,rt,nt){var at=Qe("autotypenumbers",nt.autotypenumbersDflt);if("-"===Qe("type")){for(var it,ot=0;ot<tt.length;ot++)if(tt[ot].visible){it=tt[ot];break}it&&it[rt]&&(Ge.type=Rt(it[rt],"gregorian",{noMultiCategory:!0,autotypenumbers:at})),"-"===Ge.type?Ge.type="linear":Ne.type=Ge.type}return Ge.type}Ge.exports=function(Ne,Ge,Qe){at(Ne,Ge,Qe,{type:dr.name,attributes:Zt,handleDefaults:handleDefaults,font:Ge.font,autotypenumbersDflt:Ge.autotypenumbers,paper_bgcolor:Ge.paper_bgcolor,fullData:Qe,layoutOut:Ge})}},{"../../components/color":643,"../../lib":778,"../../plot_api/plot_template":817,"../cartesian/axis_autotype":829,"../cartesian/category_order_defaults":832,"../cartesian/line_grid_defaults":844,"../cartesian/tick_label_defaults":849,"../cartesian/tick_mark_defaults":850,"../cartesian/tick_value_defaults":851,"../get_data":865,"../subplot_defaults":905,"./constants":892,"./layout_attributes":895,"./set_convert":904}],897:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../../traces/scatter/attributes"),rt=tt.marker,nt=Ne("../../../lib/extend").extendFlat;["Area traces are deprecated!","Please switch to the *barpolar* trace type."].join(" "),Ge.exports={r:nt({},tt.r,{}),t:nt({},tt.t,{}),marker:{color:nt({},rt.color,{}),size:nt({},rt.size,{}),symbol:nt({},rt.symbol,{}),opacity:nt({},rt.opacity,{}),editType:"calc"}}},{"../../../lib/extend":768,"../../../traces/scatter/attributes":1187}],898:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../cartesian/layout_attributes"),rt=Ne("../../../lib/extend").extendFlat,nt=Ne("../../../plot_api/edit_types").overrideAll,at=["Legacy polar charts are deprecated!","Please switch to *polar* subplots."].join(" "),it=rt({},tt.domain,{});function mergeAttrs(Ne,Ge){return rt({},Ge,{showline:{valType:"boolean"},showticklabels:{valType:"boolean"},tickorientation:{valType:"enumerated",values:["horizontal","vertical"]},ticklen:{valType:"number",min:0},tickcolor:{valType:"color"},ticksuffix:{valType:"string"},endpadding:{valType:"number",description:at},visible:{valType:"boolean"}})}Ge.exports=nt({radialaxis:mergeAttrs("radial",{range:{valType:"info_array",items:[{valType:"number"},{valType:"number"}]},domain:it,orientation:{valType:"number"}}),angularaxis:mergeAttrs("angular",{range:{valType:"info_array",items:[{valType:"number",dflt:0},{valType:"number",dflt:360}]},domain:it}),layout:{direction:{valType:"enumerated",values:["clockwise","counterclockwise"]},orientation:{valType:"angle"}}},"plot","nested")},{"../../../lib/extend":768,"../../../plot_api/edit_types":810,"../../cartesian/layout_attributes":842}],899:[function(Ne,Ge,Qe){"use strict";(Ge.exports=Ne("./micropolar")).manager=Ne("./micropolar_manager")},{"./micropolar":900,"./micropolar_manager":901}],900:[function(Ne,Ge,Qe){var tt=Ne("d3"),rt=Ne("../../../lib").extendDeepAll,nt=Ne("../../../constants/alignment").MID_SHIFT,at=Ge.exports={version:"0.2.2"};at.Axis=function(){var Ne,Ge,Qe,it,ot={data:[],layout:{}},dt={},ht={},Dt=tt.dispatch("hover"),Ot={};function render(dt){Ge=dt||Ge;var Dt=ot.data,Rt=ot.layout;return("string"==typeof Ge||Ge.nodeName)&&(Ge=tt.select(Ge)),Ge.datum(Dt).each((function(Ge,ot){var dt=Ge.slice();ht={data:at.util.cloneJson(dt),layout:at.util.cloneJson(Rt)};var Dt=0;dt.forEach((function(Ne,Ge){Ne.color||(Ne.color=Rt.defaultColorRange[Dt],Dt=(Dt+1)%Rt.defaultColorRange.length),Ne.strokeColor||(Ne.strokeColor="LinePlot"===Ne.geometry?Ne.color:tt.rgb(Ne.color).darker().toString()),ht.data[Ge].color=Ne.color,ht.data[Ge].strokeColor=Ne.strokeColor,ht.data[Ge].strokeDash=Ne.strokeDash,ht.data[Ge].strokeSize=Ne.strokeSize}));var Ot=dt.filter((function(Ne,Ge){var Qe=Ne.visible;return void 0===Qe||!0===Qe})),Zt=!1,er=Ot.map((function(Ne,Ge){return Zt=Zt||void 0!==Ne.groupId,Ne}));if(Zt){var dr=tt.nest().key((function(Ne,Ge){return void 0!==Ne.groupId?Ne.groupId:"unstacked"})).entries(er),mr=[],xr=dr.map((function(Ne,Ge){if("unstacked"===Ne.key)return Ne.values;var Qe=Ne.values[0].r.map((function(Ne,Ge){return 0}));return Ne.values.forEach((function(Ne,Ge,tt){Ne.yStack=[Qe],mr.push(Qe),Qe=at.util.sumArrays(Ne.r,Qe)})),Ne.values}));Ot=tt.merge(xr)}Ot.forEach((function(Ne,Ge){Ne.t=Array.isArray(Ne.t[0])?Ne.t:[Ne.t],Ne.r=Array.isArray(Ne.r[0])?Ne.r:[Ne.r]}));var br=Math.min(Rt.width-Rt.margin.left-Rt.margin.right,Rt.height-Rt.margin.top-Rt.margin.bottom)/2;br=Math.max(10,br);var Ar,en=[Rt.margin.left+br,Rt.margin.top+br];Ar=Zt?[0,tt.max(at.util.sumArrays(at.util.arrayLast(Ot).r[0],at.util.arrayLast(mr)))]:tt.extent(at.util.flattenArray(Ot.map((function(Ne,Ge){return Ne.r})))),Rt.radialAxis.domain!=at.DATAEXTENT&&(Ar[0]=0),Qe=tt.scale.linear().domain(Rt.radialAxis.domain!=at.DATAEXTENT&&Rt.radialAxis.domain?Rt.radialAxis.domain:Ar).range([0,br]),ht.layout.radialAxis.domain=Qe.domain();var mn,xn=at.util.flattenArray(Ot.map((function(Ne,Ge){return Ne.t}))),kn="string"==typeof xn[0];kn&&(xn=at.util.deduplicate(xn),mn=xn.slice(),xn=tt.range(xn.length),Ot=Ot.map((function(Ne,Ge){var Qe=Ne;return Ne.t=[xn],Zt&&(Qe.yStack=Ne.yStack),Qe})));var Cn=Ot.filter((function(Ne,Ge){return"LinePlot"===Ne.geometry||"DotPlot"===Ne.geometry})).length===Ot.length,En=null===Rt.needsEndSpacing?kn||!Cn:Rt.needsEndSpacing,Pn=Rt.angularAxis.domain&&Rt.angularAxis.domain!=at.DATAEXTENT&&!kn&&Rt.angularAxis.domain[0]>=0?Rt.angularAxis.domain:tt.extent(xn),Dn=Math.abs(xn[1]-xn[0]);Cn&&!kn&&(Dn=0);var In=Pn.slice();En&&kn&&(In[1]+=Dn);var zn=Rt.angularAxis.ticksCount||4;zn>8&&(zn=zn/(zn/8)+zn%8),Rt.angularAxis.ticksStep&&(zn=(In[1]-In[0])/zn);var Bn=Rt.angularAxis.ticksStep||(In[1]-In[0])/(zn*(Rt.minorTicks+1));mn&&(Bn=Math.max(Math.round(Bn),1)),In[2]||(In[2]=Bn);var Vn=tt.range.apply(this,In);if(Vn=Vn.map((function(Ne,Ge){return parseFloat(Ne.toPrecision(12))})),it=tt.scale.linear().domain(In.slice(0,2)).range("clockwise"===Rt.direction?[0,360]:[360,0]),ht.layout.angularAxis.domain=it.domain(),ht.layout.angularAxis.endPadding=En?Dn:0,void 0===(Ne=tt.select(this).select("svg.chart-root"))||Ne.empty()){var Hn="<svg xmlns='http://www.w3.org/2000/svg' class='chart-root'>' + '<g class='outer-group'>' + '<g class='chart-group'>' + '<circle class='background-circle'></circle>' + '<g class='geometry-group'></g>' + '<g class='radial axis-group'>' + '<circle class='outside-circle'></circle>' + '</g>' + '<g class='angular axis-group'></g>' + '<g class='guides-group'><line></line><circle r='0'></circle></g>' + '</g>' + '<g class='legend-group'></g>' + '<g class='tooltips-group'></g>' + '<g class='title-group'><text></text></g>' + '</g>' + '</svg>",qn=(new DOMParser).parseFromString(Hn,"application/xml"),Yn=this.appendChild(this.ownerDocument.importNode(qn.documentElement,!0));Ne=tt.select(Yn)}Ne.select(".guides-group").style({"pointer-events":"none"}),Ne.select(".angular.axis-group").style({"pointer-events":"none"}),Ne.select(".radial.axis-group").style({"pointer-events":"none"});var $n,ra=Ne.select(".chart-group"),oa={fill:"none",stroke:Rt.tickColor},pa={"font-size":Rt.font.size,"font-family":Rt.font.family,fill:Rt.font.color,"text-shadow":["-1px 0px","1px -1px","-1px 1px","1px 1px"].map((function(Ne,Ge){return" "+Ne+" 0 "+Rt.font.outlineColor})).join(",")};if(Rt.showLegend){$n=Ne.select(".legend-group").attr({transform:"translate("+[br,Rt.margin.top]+")"}).style({display:"block"});var ga=Ot.map((function(Ne,Ge){var Qe=at.util.cloneJson(Ne);return Qe.symbol="DotPlot"===Ne.geometry?Ne.dotType||"circle":"LinePlot"!=Ne.geometry?"square":"line",Qe.visibleInLegend=void 0===Ne.visibleInLegend||Ne.visibleInLegend,Qe.color="LinePlot"===Ne.geometry?Ne.strokeColor:Ne.color,Qe}));at.Legend().config({data:Ot.map((function(Ne,Ge){return Ne.name||"Element"+Ge})),legendConfig:rt({},at.Legend.defaultConfig().legendConfig,{container:$n,elements:ga,reverseOrder:Rt.legend.reverseOrder})})();var ma=$n.node().getBBox();br=Math.min(Rt.width-ma.width-Rt.margin.left-Rt.margin.right,Rt.height-Rt.margin.top-Rt.margin.bottom)/2,br=Math.max(10,br),en=[Rt.margin.left+br,Rt.margin.top+br],Qe.range([0,br]),ht.layout.radialAxis.domain=Qe.domain(),$n.attr("transform","translate("+[en[0]+br,en[1]-br]+")")}else $n=Ne.select(".legend-group").style({display:"none"});Ne.attr({width:Rt.width,height:Rt.height}).style({opacity:Rt.opacity}),ra.attr("transform","translate("+en+")").style({cursor:"crosshair"});var _a=[(Rt.width-(Rt.margin.left+Rt.margin.right+2*br+(ma?ma.width:0)))/2,(Rt.height-(Rt.margin.top+Rt.margin.bottom+2*br))/2];if(_a[0]=Math.max(0,_a[0]),_a[1]=Math.max(0,_a[1]),Ne.select(".outer-group").attr("transform","translate("+_a+")"),Rt.title&&Rt.title.text){var Va=Ne.select("g.title-group text").style(pa).text(Rt.title.text),Wa=Va.node().getBBox();Va.attr({x:en[0]-Wa.width/2,y:en[1]-br-20})}var Qa=Ne.select(".radial.axis-group");if(Rt.radialAxis.gridLinesVisible){var ti=Qa.selectAll("circle.grid-circle").data(Qe.ticks(5));ti.enter().append("circle").attr({class:"grid-circle"}).style(oa),ti.attr("r",Qe),ti.exit().remove()}Qa.select("circle.outside-circle").attr({r:br}).style(oa);var ni=Ne.select("circle.background-circle").attr({r:br}).style({fill:Rt.backgroundColor,stroke:Rt.stroke});function currentAngle(Ne,Ge){return it(Ne)%360+Rt.orientation}if(Rt.radialAxis.visible){var di=tt.svg.axis().scale(Qe).ticks(5).tickSize(5);Qa.call(di).attr({transform:"rotate("+Rt.radialAxis.orientation+")"}),Qa.selectAll(".domain").style(oa),Qa.selectAll("g>text").text((function(Ne,Ge){return this.textContent+Rt.radialAxis.ticksSuffix})).style(pa).style({"text-anchor":"start"}).attr({x:0,y:0,dx:0,dy:0,transform:function(Ne,Ge){return"horizontal"===Rt.radialAxis.tickOrientation?"rotate("+-Rt.radialAxis.orientation+") translate("+[0,pa["font-size"]]+")":"translate("+[0,pa["font-size"]]+")"}}),Qa.selectAll("g>line").style({stroke:"black"})}var ji=Ne.select(".angular.axis-group").selectAll("g.angular-tick").data(Vn),Hi=ji.enter().append("g").classed("angular-tick",!0);ji.attr({transform:function(Ne,Ge){return"rotate("+currentAngle(Ne,Ge)+")"}}).style({display:Rt.angularAxis.visible?"block":"none"}),ji.exit().remove(),Hi.append("line").classed("grid-line",!0).classed("major",(function(Ne,Ge){return Ge%(Rt.minorTicks+1)==0})).classed("minor",(function(Ne,Ge){return!(Ge%(Rt.minorTicks+1)==0)})).style(oa),Hi.selectAll(".minor").style({stroke:Rt.minorTickColor}),ji.select("line.grid-line").attr({x1:Rt.tickLength?br-Rt.tickLength:0,x2:br}).style({display:Rt.angularAxis.gridLinesVisible?"block":"none"}),Hi.append("text").classed("axis-text",!0).style(pa);var Yi=ji.select("text.axis-text").attr({x:br+Rt.labelOffset,dy:nt+"em",transform:function(Ne,Ge){var Qe=currentAngle(Ne,Ge),tt=br+Rt.labelOffset,rt=Rt.angularAxis.tickOrientation;return"horizontal"==rt?"rotate("+-Qe+" "+tt+" 0)":"radial"==rt?Qe<270&&Qe>90?"rotate(180 "+tt+" 0)":null:"rotate("+(Qe<=180&&Qe>0?-90:90)+" "+tt+" 0)"}}).style({"text-anchor":"middle",display:Rt.angularAxis.labelsVisible?"block":"none"}).text((function(Ne,Ge){return Ge%(Rt.minorTicks+1)!=0?"":mn?mn[Ne]+Rt.angularAxis.ticksSuffix:Ne+Rt.angularAxis.ticksSuffix})).style(pa);Rt.angularAxis.rewriteTicks&&Yi.text((function(Ne,Ge){return Ge%(Rt.minorTicks+1)!=0?"":Rt.angularAxis.rewriteTicks(this.textContent,Ge)}));var uo=tt.max(ra.selectAll(".angular-tick text")[0].map((function(Ne,Ge){return Ne.getCTM().e+Ne.getBBox().width})));$n.attr({transform:"translate("+[br+uo,Rt.margin.top]+")"});var go=Ne.select("g.geometry-group").selectAll("g").size()>0,ns=Ne.select("g.geometry-group").selectAll("g.geometry").data(Ot);if(ns.enter().append("g").attr({class:function(Ne,Ge){return"geometry geometry"+Ge}}),ns.exit().remove(),Ot[0]||go){var as=[];Ot.forEach((function(Ne,Ge){var tt={};tt.radialScale=Qe,tt.angularScale=it,tt.container=ns.filter((function(Ne,Qe){return Qe==Ge})),tt.geometry=Ne.geometry,tt.orientation=Rt.orientation,tt.direction=Rt.direction,tt.index=Ge,as.push({data:Ne,geometryConfig:tt})}));var is=tt.nest().key((function(Ne,Ge){return void 0!==Ne.data.groupId||"unstacked"})).entries(as),os=[];is.forEach((function(Ne,Ge){"unstacked"===Ne.key?os=os.concat(Ne.values.map((function(Ne,Ge){return[Ne]}))):os.push(Ne.values)})),os.forEach((function(Ne,Ge){var Qe;Qe=Array.isArray(Ne)?Ne[0].geometryConfig.geometry:Ne.geometryConfig.geometry;var tt=Ne.map((function(Ne,Ge){return rt(at[Qe].defaultConfig(),Ne)}));at[Qe]().config(tt)()}))}var ss,cs,ds=Ne.select(".guides-group"),ms=Ne.select(".tooltips-group"),vs=at.tooltipPanel().config({container:ms,fontSize:8})(),_s=at.tooltipPanel().config({container:ms,fontSize:8})(),ws=at.tooltipPanel().config({container:ms,hasTick:!0})();if(!kn){var Ts=ds.select("line").attr({x1:0,y1:0,y2:0}).style({stroke:"grey","pointer-events":"none"});ra.on("mousemove.angular-guide",(function(Ne,Ge){var Qe=at.util.getMousePos(ni).angle;Ts.attr({x2:-br,transform:"rotate("+Qe+")"}).style({opacity:.5});var tt=(Qe+180+360-Rt.orientation)%360;ss=it.invert(tt);var rt=at.util.convertToCartesian(br+12,Qe+180);vs.text(at.util.round(ss)).move([rt[0]+en[0],rt[1]+en[1]])})).on("mouseout.angular-guide",(function(Ne,Ge){ds.select("line").style({opacity:0})}))}var ks=ds.select("circle").style({stroke:"grey",fill:"none"});ra.on("mousemove.radial-guide",(function(Ne,Ge){var tt=at.util.getMousePos(ni).radius;ks.attr({r:tt}).style({opacity:.5}),cs=Qe.invert(at.util.getMousePos(ni).radius);var rt=at.util.convertToCartesian(tt,Rt.radialAxis.orientation);_s.text(at.util.round(cs)).move([rt[0]+en[0],rt[1]+en[1]])})).on("mouseout.radial-guide",(function(Ne,Ge){ks.style({opacity:0}),ws.hide(),vs.hide(),_s.hide()})),Ne.selectAll(".geometry-group .mark").on("mouseover.tooltip",(function(Ge,Qe){var rt=tt.select(this),nt=this.style.fill,it="black",ot=this.style.opacity||1;if(rt.attr({"data-opacity":ot}),nt&&"none"!==nt){rt.attr({"data-fill":nt}),it=tt.hsl(nt).darker().toString(),rt.style({fill:it,opacity:1});var dt={t:at.util.round(Ge[0]),r:at.util.round(Ge[1])};kn&&(dt.t=mn[Ge[0]]);var ht="t: "+dt.t+", r: "+dt.r,Dt=this.getBoundingClientRect(),Ot=Ne.node().getBoundingClientRect(),Rt=[Dt.left+Dt.width/2-_a[0]-Ot.left,Dt.top+Dt.height/2-_a[1]-Ot.top];ws.config({color:it}).text(ht),ws.move(Rt)}else nt=this.style.stroke||"black",rt.attr({"data-stroke":nt}),it=tt.hsl(nt).darker().toString(),rt.style({stroke:it,opacity:1})})).on("mousemove.tooltip",(function(Ne,Ge){if(0!=tt.event.which)return!1;tt.select(this).attr("data-fill")&&ws.show()})).on("mouseout.tooltip",(function(Ne,Ge){ws.hide();var Qe=tt.select(this),rt=Qe.attr("data-fill");rt?Qe.style({fill:rt,opacity:Qe.attr("data-opacity")}):Qe.style({stroke:Qe.attr("data-stroke"),opacity:Qe.attr("data-opacity")})}))})),Ot}return Ot.render=function(Ne){return render(Ne),this},Ot.config=function(Ne){if(!arguments.length)return ot;var Ge=at.util.cloneJson(Ne);return Ge.data.forEach((function(Ne,Ge){ot.data[Ge]||(ot.data[Ge]={}),rt(ot.data[Ge],at.Axis.defaultConfig().data[0]),rt(ot.data[Ge],Ne)})),rt(ot.layout,at.Axis.defaultConfig().layout),rt(ot.layout,Ge.layout),this},Ot.getLiveConfig=function(){return ht},Ot.getinputConfig=function(){return dt},Ot.radialScale=function(Ne){return Qe},Ot.angularScale=function(Ne){return it},Ot.svg=function(){return Ne},tt.rebind(Ot,Dt,"on"),Ot},at.Axis.defaultConfig=function(Ne,Ge){return{data:[{t:[1,2,3,4],r:[10,11,12,13],name:"Line1",geometry:"LinePlot",color:null,strokeDash:"solid",strokeColor:null,strokeSize:"1",visibleInLegend:!0,opacity:1}],layout:{defaultColorRange:tt.scale.category10().range(),title:null,height:450,width:500,margin:{top:40,right:40,bottom:40,left:40},font:{size:12,color:"gray",outlineColor:"white",family:"Tahoma, sans-serif"},direction:"clockwise",orientation:0,labelOffset:10,radialAxis:{domain:null,orientation:-45,ticksSuffix:"",visible:!0,gridLinesVisible:!0,tickOrientation:"horizontal",rewriteTicks:null},angularAxis:{domain:[0,360],ticksSuffix:"",visible:!0,gridLinesVisible:!0,labelsVisible:!0,tickOrientation:"horizontal",rewriteTicks:null,ticksCount:null,ticksStep:null},minorTicks:0,tickLength:null,tickColor:"silver",minorTickColor:"#eee",backgroundColor:"none",needsEndSpacing:null,showLegend:!0,legend:{reverseOrder:!1},opacity:1}}},at.util={},at.DATAEXTENT="dataExtent",at.AREA="AreaChart",at.LINE="LinePlot",at.DOT="DotPlot",at.BAR="BarChart",at.util._override=function(Ne,Ge){for(var Qe in Ne)Qe in Ge&&(Ge[Qe]=Ne[Qe])},at.util._extend=function(Ne,Ge){for(var Qe in Ne)Ge[Qe]=Ne[Qe]},at.util._rndSnd=function(){return 2*Math.random()-1+(2*Math.random()-1)+(2*Math.random()-1)},at.util.dataFromEquation2=function(Ne,Ge){var Qe=Ge||6;return tt.range(0,360+Qe,Qe).map((function(Ge,Qe){var tt=Ge*Math.PI/180;return[Ge,Ne(tt)]}))},at.util.dataFromEquation=function(Ne,Ge,Qe){var rt=Ge||6,nt=[],at=[];tt.range(0,360+rt,rt).forEach((function(Ge,Qe){var tt=Ge*Math.PI/180,rt=Ne(tt);nt.push(Ge),at.push(rt)}));var it={t:nt,r:at};return Qe&&(it.name=Qe),it},at.util.ensureArray=function(Ne,Ge){if(void 0===Ne)return null;var Qe=[].concat(Ne);return tt.range(Ge).map((function(Ne,Ge){return Qe[Ge]||Qe[0]}))},at.util.fillArrays=function(Ne,Ge,Qe){return Ge.forEach((function(Ge,tt){Ne[Ge]=at.util.ensureArray(Ne[Ge],Qe)})),Ne},at.util.cloneJson=function(Ne){return JSON.parse(JSON.stringify(Ne))},at.util.validateKeys=function(Ne,Ge){"string"==typeof Ge&&(Ge=Ge.split("."));var Qe=Ge.shift();return Ne[Qe]&&(!Ge.length||objHasKeys(Ne[Qe],Ge))},at.util.sumArrays=function(Ne,Ge){return tt.zip(Ne,Ge).map((function(Ne,Ge){return tt.sum(Ne)}))},at.util.arrayLast=function(Ne){return Ne[Ne.length-1]},at.util.arrayEqual=function(Ne,Ge){for(var Qe=Math.max(Ne.length,Ge.length,1);Qe-- >=0&&Ne[Qe]===Ge[Qe];);return-2===Qe},at.util.flattenArray=function(Ne){for(var Ge=[];!at.util.arrayEqual(Ge,Ne);)Ge=Ne,Ne=[].concat.apply([],Ne);return Ne},at.util.deduplicate=function(Ne){return Ne.filter((function(Ne,Ge,Qe){return Qe.indexOf(Ne)==Ge}))},at.util.convertToCartesian=function(Ne,Ge){var Qe=Ge*Math.PI/180;return[Ne*Math.cos(Qe),Ne*Math.sin(Qe)]},at.util.round=function(Ne,Ge){var Qe=Ge||2,tt=Math.pow(10,Qe);return Math.round(Ne*tt)/tt},at.util.getMousePos=function(Ne){var Ge=tt.mouse(Ne.node()),Qe=Ge[0],rt=Ge[1],nt={};return nt.x=Qe,nt.y=rt,nt.pos=Ge,nt.angle=180*(Math.atan2(rt,Qe)+Math.PI)/Math.PI,nt.radius=Math.sqrt(Qe*Qe+rt*rt),nt},at.util.duplicatesCount=function(Ne){for(var Ge,Qe={},tt={},rt=0,nt=Ne.length;rt<nt;rt++)(Ge=Ne[rt])in Qe?(Qe[Ge]++,tt[Ge]=Qe[Ge]):Qe[Ge]=1;return tt},at.util.duplicates=function(Ne){return Object.keys(at.util.duplicatesCount(Ne))},at.util.translator=function(Ne,Ge,Qe,tt){if(tt){var rt=Qe.slice();Qe=Ge,Ge=rt}var nt=Ge.reduce((function(Ne,Ge){if(void 0!==Ne)return Ne[Ge]}),Ne);void 0!==nt&&(Ge.reduce((function(Ne,Qe,tt){if(void 0!==Ne)return tt===Ge.length-1&&delete Ne[Qe],Ne[Qe]}),Ne),Qe.reduce((function(Ne,Ge,tt){return void 0===Ne[Ge]&&(Ne[Ge]={}),tt===Qe.length-1&&(Ne[Ge]=nt),Ne[Ge]}),Ne))},at.PolyChart=function(){var Ne,Ge=[at.PolyChart.defaultConfig()],Qe=tt.dispatch("hover"),nt={solid:"none",dash:[5,2],dot:[2,5]};function exports(){var Ne=Ge[0].geometryConfig,Qe=Ne.container;"string"==typeof Qe&&(Qe=tt.select(Qe)),Qe.datum(Ge).each((function(Ge,Qe){var rt=!!Ge[0].data.yStack,at=Ge.map((function(Ne,Ge){return rt?tt.zip(Ne.data.t[0],Ne.data.r[0],Ne.data.yStack[0]):tt.zip(Ne.data.t[0],Ne.data.r[0])})),it=Ne.angularScale,ot=Ne.radialScale.domain()[0],dt={bar:function(Qe,rt,nt){var at=Ge[nt].data,ot=Ne.radialScale(Qe[1])-Ne.radialScale(0),dt=Ne.radialScale(Qe[2]||0),ht=at.barWidth;tt.select(this).attr({class:"mark bar",d:"M"+[[ot+dt,-ht/2],[ot+dt,ht/2],[dt,ht/2],[dt,-ht/2]].join("L")+"Z",transform:function(Ge,Qe){return"rotate("+(Ne.orientation+it(Ge[0]))+")"}})},dot:function(Ne,Qe,rt){var nt=Ne[2]?[Ne[0],Ne[1]+Ne[2]]:Ne,at=tt.svg.symbol().size(Ge[rt].data.dotSize).type(Ge[rt].data.dotType)(Ne,Qe);tt.select(this).attr({class:"mark dot",d:at,transform:function(Ne,Ge){var Qe=convertToCartesian(getPolarCoordinates(nt));return"translate("+[Qe.x,Qe.y]+")"}})}},ht=tt.svg.line.radial().interpolate(Ge[0].data.lineInterpolation).radius((function(Ge){return Ne.radialScale(Ge[1])})).angle((function(Ge){return Ne.angularScale(Ge[0])*Math.PI/180}));dt.line=function(Qe,rt,nt){var it=Qe[2]?at[nt].map((function(Ne,Ge){return[Ne[0],Ne[1]+Ne[2]]})):at[nt];if(tt.select(this).each(dt.dot).style({opacity:function(Ne,Qe){return+Ge[nt].data.dotVisible},fill:Zt.stroke(Qe,rt,nt)}).attr({class:"mark dot"}),!(rt>0)){var ot=tt.select(this.parentNode).selectAll("path.line").data([0]);ot.enter().insert("path"),ot.attr({class:"line",d:ht(it),transform:function(Ge,Qe){return"rotate("+(Ne.orientation+90)+")"},"pointer-events":"none"}).style({fill:function(Ne,Ge){return Zt.fill(Qe,rt,nt)},"fill-opacity":0,stroke:function(Ne,Ge){return Zt.stroke(Qe,rt,nt)},"stroke-width":function(Ne,Ge){return Zt["stroke-width"](Qe,rt,nt)},"stroke-dasharray":function(Ne,Ge){return Zt["stroke-dasharray"](Qe,rt,nt)},opacity:function(Ne,Ge){return Zt.opacity(Qe,rt,nt)},display:function(Ne,Ge){return Zt.display(Qe,rt,nt)}})}};var Dt=Ne.angularScale.range(),Ot=Math.abs(Dt[1]-Dt[0])/at[0].length*Math.PI/180,Rt=tt.svg.arc().startAngle((function(Ne){return-Ot/2})).endAngle((function(Ne){return Ot/2})).innerRadius((function(Ge){return Ne.radialScale(ot+(Ge[2]||0))})).outerRadius((function(Ge){return Ne.radialScale(ot+(Ge[2]||0))+Ne.radialScale(Ge[1])}));dt.arc=function(Ge,Qe,rt){tt.select(this).attr({class:"mark arc",d:Rt,transform:function(Ge,Qe){return"rotate("+(Ne.orientation+it(Ge[0])+90)+")"}})};var Zt={fill:function(Ne,Qe,tt){return Ge[tt].data.color},stroke:function(Ne,Qe,tt){return Ge[tt].data.strokeColor},"stroke-width":function(Ne,Qe,tt){return Ge[tt].data.strokeSize+"px"},"stroke-dasharray":function(Ne,Qe,tt){return nt[Ge[tt].data.strokeDash]},opacity:function(Ne,Qe,tt){return Ge[tt].data.opacity},display:function(Ne,Qe,tt){return void 0===Ge[tt].data.visible||Ge[tt].data.visible?"block":"none"}},er=tt.select(this).selectAll("g.layer").data(at);er.enter().append("g").attr({class:"layer"});var dr=er.selectAll("path.mark").data((function(Ne,Ge){return Ne}));function getPolarCoordinates(Ge,Qe){return{r:Ne.radialScale(Ge[1]),t:(Ne.angularScale(Ge[0])+Ne.orientation)*Math.PI/180}}function convertToCartesian(Ne){return{x:Ne.r*Math.cos(Ne.t),y:Ne.r*Math.sin(Ne.t)}}dr.enter().append("path").attr({class:"mark"}),dr.style(Zt).each(dt[Ne.geometryType]),dr.exit().remove(),er.exit().remove()}))}return exports.config=function(Ne){return arguments.length?(Ne.forEach((function(Ne,Qe){Ge[Qe]||(Ge[Qe]={}),rt(Ge[Qe],at.PolyChart.defaultConfig()),rt(Ge[Qe],Ne)})),this):Ge},exports.getColorScale=function(){return Ne},tt.rebind(exports,Qe,"on"),exports},at.PolyChart.defaultConfig=function(){return{data:{name:"geom1",t:[[1,2,3,4]],r:[[1,2,3,4]],dotType:"circle",dotSize:64,dotVisible:!1,barWidth:20,color:"#ffa500",strokeSize:1,strokeColor:"silver",strokeDash:"solid",opacity:1,index:0,visible:!0,visibleInLegend:!0},geometryConfig:{geometry:"LinePlot",geometryType:"arc",direction:"clockwise",orientation:0,container:"body",radialScale:null,angularScale:null,colorScale:tt.scale.category20()}}},at.BarChart=function(){return at.PolyChart()},at.BarChart.defaultConfig=function(){return{geometryConfig:{geometryType:"bar"}}},at.AreaChart=function(){return at.PolyChart()},at.AreaChart.defaultConfig=function(){return{geometryConfig:{geometryType:"arc"}}},at.DotPlot=function(){return at.PolyChart()},at.DotPlot.defaultConfig=function(){return{geometryConfig:{geometryType:"dot",dotType:"circle"}}},at.LinePlot=function(){return at.PolyChart()},at.LinePlot.defaultConfig=function(){return{geometryConfig:{geometryType:"line"}}},at.Legend=function(){var Ne=at.Legend.defaultConfig(),Ge=tt.dispatch("hover");function exports(){var Ge=Ne.legendConfig,Qe=Ne.data.map((function(Ne,Qe){return[].concat(Ne).map((function(Ne,tt){var nt=rt({},Ge.elements[Qe]);return nt.name=Ne,nt.color=[].concat(Ge.elements[Qe].color)[tt],nt}))})),nt=tt.merge(Qe);nt=nt.filter((function(Ne,Qe){return Ge.elements[Qe]&&(Ge.elements[Qe].visibleInLegend||void 0===Ge.elements[Qe].visibleInLegend)})),Ge.reverseOrder&&(nt=nt.reverse());var at=Ge.container;("string"==typeof at||at.nodeName)&&(at=tt.select(at));var it=nt.map((function(Ne,Ge){return Ne.color})),ot=Ge.fontSize,dt=null==Ge.isContinuous?"number"==typeof nt[0]:Ge.isContinuous,ht=dt?Ge.height:ot*nt.length,Dt=at.classed("legend-group",!0).selectAll("svg").data([0]),Ot=Dt.enter().append("svg").attr({width:300,height:ht+ot,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"});Ot.append("g").classed("legend-axis",!0),Ot.append("g").classed("legend-marks",!0);var Rt=tt.range(nt.length),Zt=tt.scale[dt?"linear":"ordinal"]().domain(Rt).range(it),er=tt.scale[dt?"linear":"ordinal"]().domain(Rt)[dt?"range":"rangePoints"]([0,ht]),shapeGenerator=function(Ne,Ge){var Qe=3*Ge;return"line"===Ne?"M"+[[-Ge/2,-Ge/12],[Ge/2,-Ge/12],[Ge/2,Ge/12],[-Ge/2,Ge/12]]+"Z":-1!=tt.svg.symbolTypes.indexOf(Ne)?tt.svg.symbol().type(Ne).size(Qe)():tt.svg.symbol().type("square").size(Qe)()};if(dt){var dr=Dt.select(".legend-marks").append("defs").append("linearGradient").attr({id:"grad1",x1:"0%",y1:"0%",x2:"0%",y2:"100%"}).selectAll("stop").data(it);dr.enter().append("stop"),dr.attr({offset:function(Ne,Ge){return Ge/(it.length-1)*100+"%"}}).style({"stop-color":function(Ne,Ge){return Ne}}),Dt.append("rect").classed("legend-mark",!0).attr({height:Ge.height,width:Ge.colorBandWidth,fill:"url(#grad1)"})}else{var mr=Dt.select(".legend-marks").selectAll("path.legend-mark").data(nt);mr.enter().append("path").classed("legend-mark",!0),mr.attr({transform:function(Ne,Ge){return"translate("+[ot/2,er(Ge)+ot/2]+")"},d:function(Ne,Ge){var Qe=Ne.symbol;return shapeGenerator(Qe,ot)},fill:function(Ne,Ge){return Zt(Ge)}}),mr.exit().remove()}var xr=tt.svg.axis().scale(er).orient("right"),br=Dt.select("g.legend-axis").attr({transform:"translate("+[dt?Ge.colorBandWidth:ot,ot/2]+")"}).call(xr);return br.selectAll(".domain").style({fill:"none",stroke:"none"}),br.selectAll("line").style({fill:"none",stroke:dt?Ge.textColor:"none"}),br.selectAll("text").style({fill:Ge.textColor,"font-size":Ge.fontSize}).text((function(Ne,Ge){return nt[Ge].name})),exports}return exports.config=function(Ge){return arguments.length?(rt(Ne,Ge),this):Ne},tt.rebind(exports,Ge,"on"),exports},at.Legend.defaultConfig=function(Ne,Ge){return{data:["a","b","c"],legendConfig:{elements:[{symbol:"line",color:"red"},{symbol:"square",color:"yellow"},{symbol:"diamond",color:"limegreen"}],height:150,colorBandWidth:30,fontSize:12,container:"body",isContinuous:null,textColor:"grey",reverseOrder:!1}}},at.tooltipPanel=function(){var Ne,Ge,Qe,nt={container:null,hasTick:!1,fontSize:12,color:"white",padding:5},it="tooltip-"+at.tooltipPanel.uid++,ot=10,exports=function(){var tt=(Ne=nt.container.selectAll("g."+it).data([0])).enter().append("g").classed(it,!0).style({"pointer-events":"none",display:"none"});return Qe=tt.append("path").style({fill:"white","fill-opacity":.9}).attr({d:"M0 0"}),Ge=tt.append("text").attr({dx:nt.padding+ot,dy:.3*+nt.fontSize}),exports};return exports.text=function(rt){var at=tt.hsl(nt.color).l,it=at>=.5?"#aaa":"white",dt=at>=.5?"black":"white",ht=rt||"";Ge.style({fill:dt,"font-size":nt.fontSize+"px"}).text(ht);var Dt=nt.padding,Ot=Ge.node().getBBox(),Rt={fill:nt.color,stroke:it,"stroke-width":"2px"},Zt=Ot.width+2*Dt+ot,er=Ot.height+2*Dt;return Qe.attr({d:"M"+[[ot,-er/2],[ot,-er/4],[nt.hasTick?0:ot,0],[ot,er/4],[ot,er/2],[Zt,er/2],[Zt,-er/2]].join("L")+"Z"}).style(Rt),Ne.attr({transform:"translate("+[ot,-er/2+2*Dt]+")"}),Ne.style({display:"block"}),exports},exports.move=function(Ge){if(Ne)return Ne.attr({transform:"translate("+[Ge[0],Ge[1]]+")"}).style({display:"block"}),exports},exports.hide=function(){if(Ne)return Ne.style({display:"none"}),exports},exports.show=function(){if(Ne)return Ne.style({display:"block"}),exports},exports.config=function(Ne){return rt(nt,Ne),exports},exports},at.tooltipPanel.uid=1,at.adapter={},at.adapter.plotly=function(){var Ne={convert:function(Ne,Ge){var Qe={};if(Ne.data&&(Qe.data=Ne.data.map((function(Ne,Qe){var tt=rt({},Ne);return[[tt,["marker","color"],["color"]],[tt,["marker","opacity"],["opacity"]],[tt,["marker","line","color"],["strokeColor"]],[tt,["marker","line","dash"],["strokeDash"]],[tt,["marker","line","width"],["strokeSize"]],[tt,["marker","symbol"],["dotType"]],[tt,["marker","size"],["dotSize"]],[tt,["marker","barWidth"],["barWidth"]],[tt,["line","interpolation"],["lineInterpolation"]],[tt,["showlegend"],["visibleInLegend"]]].forEach((function(Ne,Qe){at.util.translator.apply(null,Ne.concat(Ge))})),Ge||delete tt.marker,Ge&&delete tt.groupId,Ge?("LinePlot"===tt.geometry?(tt.type="scatter",!0===tt.dotVisible?(delete tt.dotVisible,tt.mode="lines+markers"):tt.mode="lines"):"DotPlot"===tt.geometry?(tt.type="scatter",tt.mode="markers"):"AreaChart"===tt.geometry?tt.type="area":"BarChart"===tt.geometry&&(tt.type="bar"),delete tt.geometry):("scatter"===tt.type?"lines"===tt.mode?tt.geometry="LinePlot":"markers"===tt.mode?tt.geometry="DotPlot":"lines+markers"===tt.mode&&(tt.geometry="LinePlot",tt.dotVisible=!0):"area"===tt.type?tt.geometry="AreaChart":"bar"===tt.type&&(tt.geometry="BarChart"),delete tt.mode,delete tt.type),tt})),!Ge&&Ne.layout&&"stack"===Ne.layout.barmode)){var nt=at.util.duplicates(Qe.data.map((function(Ne,Ge){return Ne.geometry})));Qe.data.forEach((function(Ne,Ge){var tt=nt.indexOf(Ne.geometry);-1!=tt&&(Qe.data[Ge].groupId=tt)}))}if(Ne.layout){var it=rt({},Ne.layout);if([[it,["plot_bgcolor"],["backgroundColor"]],[it,["showlegend"],["showLegend"]],[it,["radialaxis"],["radialAxis"]],[it,["angularaxis"],["angularAxis"]],[it.angularaxis,["showline"],["gridLinesVisible"]],[it.angularaxis,["showticklabels"],["labelsVisible"]],[it.angularaxis,["nticks"],["ticksCount"]],[it.angularaxis,["tickorientation"],["tickOrientation"]],[it.angularaxis,["ticksuffix"],["ticksSuffix"]],[it.angularaxis,["range"],["domain"]],[it.angularaxis,["endpadding"],["endPadding"]],[it.radialaxis,["showline"],["gridLinesVisible"]],[it.radialaxis,["tickorientation"],["tickOrientation"]],[it.radialaxis,["ticksuffix"],["ticksSuffix"]],[it.radialaxis,["range"],["domain"]],[it.angularAxis,["showline"],["gridLinesVisible"]],[it.angularAxis,["showticklabels"],["labelsVisible"]],[it.angularAxis,["nticks"],["ticksCount"]],[it.angularAxis,["tickorientation"],["tickOrientation"]],[it.angularAxis,["ticksuffix"],["ticksSuffix"]],[it.angularAxis,["range"],["domain"]],[it.angularAxis,["endpadding"],["endPadding"]],[it.radialAxis,["showline"],["gridLinesVisible"]],[it.radialAxis,["tickorientation"],["tickOrientation"]],[it.radialAxis,["ticksuffix"],["ticksSuffix"]],[it.radialAxis,["range"],["domain"]],[it.font,["outlinecolor"],["outlineColor"]],[it.legend,["traceorder"],["reverseOrder"]],[it,["labeloffset"],["labelOffset"]],[it,["defaultcolorrange"],["defaultColorRange"]]].forEach((function(Ne,Qe){at.util.translator.apply(null,Ne.concat(Ge))})),Ge?(void 0!==it.tickLength&&(it.angularaxis.ticklen=it.tickLength,delete it.tickLength),it.tickColor&&(it.angularaxis.tickcolor=it.tickColor,delete it.tickColor)):(it.angularAxis&&void 0!==it.angularAxis.ticklen&&(it.tickLength=it.angularAxis.ticklen),it.angularAxis&&void 0!==it.angularAxis.tickcolor&&(it.tickColor=it.angularAxis.tickcolor)),it.legend&&"boolean"!=typeof it.legend.reverseOrder&&(it.legend.reverseOrder="normal"!=it.legend.reverseOrder),it.legend&&"boolean"==typeof it.legend.traceorder&&(it.legend.traceorder=it.legend.traceorder?"reversed":"normal",delete it.legend.reverseOrder),it.margin&&void 0!==it.margin.t){var ot=["t","r","b","l","pad"],dt=["top","right","bottom","left","pad"],ht={};tt.entries(it.margin).forEach((function(Ne,Ge){ht[dt[ot.indexOf(Ne.key)]]=Ne.value})),it.margin=ht}Ge&&(delete it.needsEndSpacing,delete it.minorTickColor,delete it.minorTicks,delete it.angularaxis.ticksCount,delete it.angularaxis.ticksCount,delete it.angularaxis.ticksStep,delete it.angularaxis.rewriteTicks,delete it.angularaxis.nticks,delete it.radialaxis.ticksCount,delete it.radialaxis.ticksCount,delete it.radialaxis.ticksStep,delete it.radialaxis.rewriteTicks,delete it.radialaxis.nticks),Qe.layout=it}return Qe}};return Ne}},{"../../../constants/alignment":745,"../../../lib":778,d3:169}],901:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../../lib"),nt=Ne("../../../components/color"),at=Ne("./micropolar"),it=Ne("./undo_manager"),ot=rt.extendDeepAll,dt=Ge.exports={};dt.framework=function(Ne){var Ge,Qe,rt,nt,ht,Dt=new it;function exports(Qe,it){return it&&(ht=it),tt.select(tt.select(ht).node().parentNode).selectAll(".svg-container>*:not(.chart-root)").remove(),Ge=Ge?ot(Ge,Qe):Qe,rt||(rt=at.Axis()),nt=at.adapter.plotly().convert(Ge),rt.config(nt).render(ht),Ne.data=Ge.data,Ne.layout=Ge.layout,dt.fillLayout(Ne),Ge}return exports.isPolar=!0,exports.svg=function(){return rt.svg()},exports.getConfig=function(){return Ge},exports.getLiveConfig=function(){return at.adapter.plotly().convert(rt.getLiveConfig(),!0)},exports.getLiveScales=function(){return{t:rt.angularScale(),r:rt.radialScale()}},exports.setUndoPoint=function(){var Ne,tt,rt=this,nt=at.util.cloneJson(Ge);Ne=nt,tt=Qe,Dt.add({undo:function(){tt&&rt(tt)},redo:function(){rt(Ne)}}),Qe=at.util.cloneJson(nt)},exports.undo=function(){Dt.undo()},exports.redo=function(){Dt.redo()},exports},dt.fillLayout=function(Ne){var Ge=tt.select(Ne).selectAll(".plot-container"),Qe=Ge.selectAll(".svg-container"),rt=Ne.framework&&Ne.framework.svg&&Ne.framework.svg(),at={width:800,height:600,paper_bgcolor:nt.background,_container:Ge,_paperdiv:Qe,_paper:rt};Ne._fullLayout=ot(at,Ne.layout)}},{"../../../components/color":643,"../../../lib":778,"./micropolar":900,"./undo_manager":902,d3:169}],902:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(){var Ne,Ge=[],Qe=-1,tt=!1;function execute(Ne,Ge){return Ne?(tt=!0,Ne[Ge](),tt=!1,this):this}return{add:function(Ne){return tt||(Ge.splice(Qe+1,Ge.length-Qe),Ge.push(Ne),Qe=Ge.length-1),this},setCallback:function(Ge){Ne=Ge},undo:function(){var tt=Ge[Qe];return tt?(execute(tt,"undo"),Qe-=1,Ne&&Ne(tt.undo),this):this},redo:function(){var tt=Ge[Qe+1];return tt?(execute(tt,"redo"),Qe+=1,Ne&&Ne(tt.redo),this):this},clear:function(){Ge=[],Qe=-1},hasUndo:function(){return-1!==Qe},hasRedo:function(){return Qe<Ge.length-1},getCommands:function(){return Ge},getPreviousCommand:function(){return Ge[Qe-1]},getIndex:function(){return Qe}}}},{}],903:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("tinycolor2"),nt=Ne("../../registry"),at=Ne("../../lib"),it=at.strRotate,ot=at.strTranslate,dt=Ne("../../components/color"),ht=Ne("../../components/drawing"),Dt=Ne("../plots"),Ot=Ne("../../plots/cartesian/axes"),Rt=Ne("../cartesian/set_convert"),Zt=Ne("./set_convert"),er=Ne("../cartesian/autorange").doAutoRange,dr=Ne("../cartesian/dragbox"),mr=Ne("../../components/dragelement"),xr=Ne("../../components/fx"),br=Ne("../../components/titles"),Ar=Ne("../cartesian/select").prepSelect,en=Ne("../cartesian/select").selectOnClick,mn=Ne("../cartesian/select").clearSelect,xn=Ne("../../lib/setcursor"),kn=Ne("../../lib/clear_gl_canvases"),Cn=Ne("../../plot_api/subroutines").redrawReglTraces,En=Ne("../../constants/alignment").MID_SHIFT,Pn=Ne("./constants"),Dn=Ne("./helpers"),In=at._,zn=at.mod,Bn=at.deg2rad,Vn=at.rad2deg;function Polar(Ne,Ge){this.id=Ge,this.gd=Ne,this._hasClipOnAxisFalse=null,this.vangles=null,this.radialAxisAngle=null,this.traceHash={},this.layers={},this.clipPaths={},this.clipIds={},this.viewInitial={};var Qe=Ne._fullLayout,tt="clip"+Qe._uid+Ge;this.clipIds.forTraces=tt+"-for-traces",this.clipPaths.forTraces=Qe._clips.append("clipPath").attr("id",this.clipIds.forTraces),this.clipPaths.forTraces.append("path"),this.framework=Qe._polarlayer.append("g").attr("class",Ge),this.radialTickLayout=null,this.angularTickLayout=null}var Hn=Polar.prototype;function strTickLayout(Ne){var Ge=Ne.ticks+String(Ne.ticklen)+String(Ne.showticklabels);return"side"in Ne&&(Ge+=Ne.side),Ge}function computeSectorBBox(Ne){var Ge,Qe=Ne[0],tt=Ne[1]-Qe,rt=zn(Qe,360),nt=rt+tt,at=Math.cos(Bn(rt)),it=Math.sin(Bn(rt)),ot=Math.cos(Bn(nt)),dt=Math.sin(Bn(nt));return Ge=rt<=90&&nt>=90||rt>90&&nt>=450?1:it<=0&&dt<=0?0:Math.max(it,dt),[rt<=180&&nt>=180||rt>180&&nt>=540?-1:at>=0&&ot>=0?0:Math.min(at,ot),rt<=270&&nt>=270||rt>270&&nt>=630?-1:it>=0&&dt>=0?0:Math.min(it,dt),nt>=360?1:at<=0&&ot<=0?0:Math.max(at,ot),Ge]}function snapToVertexAngle(Ne,Ge){var fn=function(Ge){return at.angleDist(Ne,Ge)};return Ge[at.findIndexOfMin(Ge,fn)]}function updateElement(Ne,Ge,Qe){return Ge?(Ne.attr("display",null),Ne.attr(Qe)):Ne&&Ne.attr("display","none"),Ne}Ge.exports=function(Ne,Ge){return new Polar(Ne,Ge)},Hn.plot=function(Ne,Ge){var Qe=this,tt=Ge[Qe.id];Qe._hasClipOnAxisFalse=!1;for(var rt=0;rt<Ne.length;rt++)if(!1===Ne[rt][0].trace.cliponaxis){Qe._hasClipOnAxisFalse=!0;break}Qe.updateLayers(Ge,tt),Qe.updateLayout(Ge,tt),Dt.generalUpdatePerTraceModule(Qe.gd,Qe,Ne,tt),Qe.updateFx(Ge,tt)},Hn.updateLayers=function(Ne,Ge){var Qe=this,rt=Qe.layers,nt=Ge.radialaxis,at=Ge.angularaxis,it=Pn.layerNames,ot=it.indexOf("frontplot"),dt=it.slice(0,ot),ht="below traces"===at.layer,Dt="below traces"===nt.layer;ht&&dt.push("angular-line"),Dt&&dt.push("radial-line"),ht&&dt.push("angular-axis"),Dt&&dt.push("radial-axis"),dt.push("frontplot"),ht||dt.push("angular-line"),Dt||dt.push("radial-line"),ht||dt.push("angular-axis"),Dt||dt.push("radial-axis");var Ot=Qe.framework.selectAll(".polarsublayer").data(dt,String);Ot.enter().append("g").attr("class",(function(Ne){return"polarsublayer "+Ne})).each((function(Ne){var Ge=rt[Ne]=tt.select(this);switch(Ne){case"frontplot":Ge.append("g").classed("barlayer",!0),Ge.append("g").classed("scatterlayer",!0);break;case"backplot":Ge.append("g").classed("maplayer",!0);break;case"plotbg":rt.bg=Ge.append("path");break;case"radial-grid":case"angular-grid":Ge.style("fill","none");break;case"radial-line":Ge.append("line").style("fill","none");break;case"angular-line":Ge.append("path").style("fill","none")}})),Ot.order()},Hn.updateLayout=function(Ne,Ge){var Qe=this,tt=Qe.layers,rt=Ne._size,nt=Ge.radialaxis,at=Ge.angularaxis,it=Ge.domain.x,Dt=Ge.domain.y;Qe.xOffset=rt.l+rt.w*it[0],Qe.yOffset=rt.t+rt.h*(1-Dt[1]);var Ot=Qe.xLength=rt.w*(it[1]-it[0]),Rt=Qe.yLength=rt.h*(Dt[1]-Dt[0]),Zt=Ge.sector;Qe.sectorInRad=Zt.map(Bn);var er,dr,mr,xr,br,Ar=Qe.sectorBBox=computeSectorBBox(Zt),en=Ar[2]-Ar[0],mn=Ar[3]-Ar[1],xn=Rt/Ot,kn=Math.abs(mn/en);xn>kn?(er=Ot,br=(Rt-(dr=Ot*kn))/rt.h/2,mr=[it[0],it[1]],xr=[Dt[0]+br,Dt[1]-br]):(dr=Rt,br=(Ot-(er=Rt/kn))/rt.w/2,mr=[it[0]+br,it[1]-br],xr=[Dt[0],Dt[1]]),Qe.xLength2=er,Qe.yLength2=dr,Qe.xDomain2=mr,Qe.yDomain2=xr;var Cn=Qe.xOffset2=rt.l+rt.w*mr[0],En=Qe.yOffset2=rt.t+rt.h*(1-xr[1]),Pn=Qe.radius=er/en,Dn=Qe.innerRadius=Ge.hole*Pn,In=Qe.cx=Cn-Pn*Ar[0],zn=Qe.cy=En+Pn*Ar[3],Vn=Qe.cxx=In-Cn,Hn=Qe.cyy=zn-En;Qe.radialAxis=Qe.mockAxis(Ne,Ge,nt,{_id:"x",side:{counterclockwise:"top",clockwise:"bottom"}[nt.side],_realSide:nt.side,domain:[Dn/rt.w,Pn/rt.w]}),Qe.angularAxis=Qe.mockAxis(Ne,Ge,at,{side:"right",domain:[0,Math.PI],autorange:!1}),Qe.doAutoRange(Ne,Ge),Qe.updateAngularAxis(Ne,Ge),Qe.updateRadialAxis(Ne,Ge),Qe.updateRadialAxisTitle(Ne,Ge),Qe.xaxis=Qe.mockCartesianAxis(Ne,Ge,{_id:"x",domain:mr}),Qe.yaxis=Qe.mockCartesianAxis(Ne,Ge,{_id:"y",domain:xr});var qn=Qe.pathSubplot();Qe.clipPaths.forTraces.select("path").attr("d",qn).attr("transform",ot(Vn,Hn)),tt.frontplot.attr("transform",ot(Cn,En)).call(ht.setClipUrl,Qe._hasClipOnAxisFalse?null:Qe.clipIds.forTraces,Qe.gd),tt.bg.attr("d",qn).attr("transform",ot(In,zn)).call(dt.fill,Ge.bgcolor)},Hn.mockAxis=function(Ne,Ge,Qe,tt){var rt=at.extendFlat({},Qe,tt);return Zt(rt,Ge,Ne),rt},Hn.mockCartesianAxis=function(Ne,Ge,Qe){var tt=this,rt=Qe._id,nt=at.extendFlat({type:"linear"},Qe);Rt(nt,Ne);var it={x:[0,2],y:[1,3]};return nt.setRange=function(){var Ne=tt.sectorBBox,Qe=it[rt],at=tt.radialAxis._rl,ot=(at[1]-at[0])/(1-Ge.hole);nt.range=[Ne[Qe[0]]*ot,Ne[Qe[1]]*ot]},nt.isPtWithinRange="x"===rt?function(Ne){return tt.isPtInside(Ne)}:function(){return!0},nt.setRange(),nt.setScale(),nt},Hn.doAutoRange=function(Ne,Ge){var Qe=this.gd,tt=this.radialAxis,rt=Ge.radialaxis;tt.setScale(),er(Qe,tt);var nt=tt.range;rt.range=nt.slice(),rt._input.range=nt.slice(),tt._rl=[tt.r2l(nt[0],null,"gregorian"),tt.r2l(nt[1],null,"gregorian")]},Hn.updateRadialAxis=function(Ne,Ge){var Qe=this,tt=Qe.gd,rt=Qe.layers,nt=Qe.radius,ht=Qe.innerRadius,Dt=Qe.cx,Rt=Qe.cy,Zt=Ge.radialaxis,er=zn(Ge.sector[0],360),dr=Qe.radialAxis,mr=ht<nt;Qe.fillViewInitialKey("radialaxis.angle",Zt.angle),Qe.fillViewInitialKey("radialaxis.range",dr.range.slice()),dr.setGeometry(),"auto"===dr.tickangle&&er>90&&er<=270&&(dr.tickangle=180);var transFn=function(Ne){return ot(dr.l2p(Ne.x)+ht,0)},gridPathFn=function(Ne){return Qe.pathArc(dr.r2p(Ne.x)+ht)},xr=strTickLayout(Zt);if(Qe.radialTickLayout!==xr&&(rt["radial-axis"].selectAll(".xtick").remove(),Qe.radialTickLayout=xr),mr){dr.setScale();var br=Ot.calcTicks(dr),Ar=Ot.clipEnds(dr,br),en=Ot.getTickSigns(dr)[2];Ot.drawTicks(tt,dr,{vals:br,layer:rt["radial-axis"],path:Ot.makeTickPath(dr,0,en),transFn:transFn,crisp:!1}),Ot.drawGrid(tt,dr,{vals:Ar,layer:rt["radial-grid"],path:gridPathFn,transFn:at.noop,crisp:!1}),Ot.drawLabels(tt,dr,{vals:br,layer:rt["radial-axis"],transFn:transFn,labelFns:Ot.makeLabelFns(dr,0)})}var mn=Qe.radialAxisAngle=Qe.vangles?Vn(snapToVertexAngle(Bn(Zt.angle),Qe.vangles)):Zt.angle,xn=ot(Dt,Rt),kn=xn+it(-mn);updateElement(rt["radial-axis"],mr&&(Zt.showticklabels||Zt.ticks),{transform:kn}),updateElement(rt["radial-grid"],mr&&Zt.showgrid,{transform:xn}),updateElement(rt["radial-line"].select("line"),mr&&Zt.showline,{x1:ht,y1:0,x2:nt,y2:0,transform:kn}).attr("stroke-width",Zt.linewidth).call(dt.stroke,Zt.linecolor)},Hn.updateRadialAxisTitle=function(Ne,Ge,Qe){var tt=this,rt=tt.gd,nt=tt.radius,at=tt.cx,it=tt.cy,ot=Ge.radialaxis,dt=tt.id+"title",Dt=void 0!==Qe?Qe:tt.radialAxisAngle,Ot=Bn(Dt),Rt=Math.cos(Ot),Zt=Math.sin(Ot),er=0;if(ot.title){var dr=ht.bBox(tt.layers["radial-axis"].node()).height,mr=ot.title.font.size;er="counterclockwise"===ot.side?-dr-.4*mr:dr+.8*mr}tt.layers["radial-axis-title"]=br.draw(rt,dt,{propContainer:ot,propName:tt.id+".radialaxis.title",placeholder:In(rt,"Click to enter radial axis title"),attributes:{x:at+nt/2*Rt+er*Zt,y:it-nt/2*Zt+er*Rt,"text-anchor":"middle"},transform:{rotate:-Dt}})},Hn.updateAngularAxis=function(Ne,Ge){var Qe=this,tt=Qe.gd,rt=Qe.layers,nt=Qe.radius,ht=Qe.innerRadius,Dt=Qe.cx,Rt=Qe.cy,Zt=Ge.angularaxis,er=Qe.angularAxis;Qe.fillViewInitialKey("angularaxis.rotation",Zt.rotation),er.setGeometry(),er.setScale();var t2g=function(Ne){return er.t2g(Ne.x)};"linear"===er.type&&"radians"===er.thetaunit&&(er.tick0=Vn(er.tick0),er.dtick=Vn(er.dtick));var _transFn=function(Ne){return ot(Dt+nt*Math.cos(Ne),Rt-nt*Math.sin(Ne))},transFn=function(Ne){return _transFn(t2g(Ne))},transFn2=function(Ne){var Ge=t2g(Ne);return _transFn(Ge)+it(-Vn(Ge))},gridPathFn=function(Ne){var Ge=t2g(Ne),Qe=Math.cos(Ge),tt=Math.sin(Ge);return"M"+[Dt+ht*Qe,Rt-ht*tt]+"L"+[Dt+nt*Qe,Rt-nt*tt]},dr=Ot.makeLabelFns(er,0).labelStandoff,mr={xFn:function(Ne){var Ge=t2g(Ne);return Math.cos(Ge)*dr},yFn:function(Ne){var Ge=t2g(Ne),Qe=Math.sin(Ge)>0?.2:1;return-Math.sin(Ge)*(dr+Ne.fontSize*Qe)+Math.abs(Math.cos(Ge))*(Ne.fontSize*En)},anchorFn:function(Ne){var Ge=t2g(Ne),Qe=Math.cos(Ge);return Math.abs(Qe)<.1?"middle":Qe>0?"start":"end"},heightFn:function(Ne,Ge,Qe){var tt=t2g(Ne);return-.5*(1+Math.sin(tt))*Qe}},xr=strTickLayout(Zt);Qe.angularTickLayout!==xr&&(rt["angular-axis"].selectAll("."+er._id+"tick").remove(),Qe.angularTickLayout=xr);var br,Ar=Ot.calcTicks(er);if("linear"===Ge.gridshape?(br=Ar.map(t2g),at.angleDelta(br[0],br[1])<0&&(br=br.slice().reverse())):br=null,Qe.vangles=br,"category"===er.type&&(Ar=Ar.filter((function(Ne){return at.isAngleInsideSector(t2g(Ne),Qe.sectorInRad)}))),er.visible){var en="inside"===er.ticks?-1:1,mn=(er.linewidth||1)/2;Ot.drawTicks(tt,er,{vals:Ar,layer:rt["angular-axis"],path:"M"+en*mn+",0h"+en*er.ticklen,transFn:transFn2,crisp:!1}),Ot.drawGrid(tt,er,{vals:Ar,layer:rt["angular-grid"],path:gridPathFn,transFn:at.noop,crisp:!1}),Ot.drawLabels(tt,er,{vals:Ar,layer:rt["angular-axis"],repositionOnUpdate:!0,transFn:transFn,labelFns:mr})}updateElement(rt["angular-line"].select("path"),Zt.showline,{d:Qe.pathSubplot(),transform:ot(Dt,Rt)}).attr("stroke-width",Zt.linewidth).call(dt.stroke,Zt.linecolor)},Hn.updateFx=function(Ne,Ge){this.gd._context.staticPlot||(this.updateAngularDrag(Ne),this.updateRadialDrag(Ne,Ge,0),this.updateRadialDrag(Ne,Ge,1),this.updateMainDrag(Ne))},Hn.updateMainDrag=function(Ne){var Ge,Qe,it=this,dt=it.gd,ht=it.layers,Dt=Ne._zoomlayer,Ot=Pn.MINZOOM,Rt=Pn.OFFEDGE,Zt=it.radius,er=it.innerRadius,br=it.cx,xn=it.cy,kn=it.cxx,Cn=it.cyy,En=it.sectorInRad,In=it.vangles,zn=it.radialAxis,Bn=Dn.clampTiny,Vn=Dn.findXYatLength,Hn=Dn.findEnclosingVertexAngles,qn=Pn.cornerHalfWidth,Yn=Pn.cornerLen/2,$n=dr.makeDragger(ht,"path","maindrag","crosshair");tt.select($n).attr("d",it.pathSubplot()).attr("transform",ot(br,xn));var ra,oa,pa,ga,ma,_a,Va,Wa,Qa,ti={element:$n,gd:dt,subplot:it.id,plotinfo:{id:it.id,xaxis:it.xaxis,yaxis:it.yaxis},xaxes:[it.xaxis],yaxes:[it.yaxis]};function norm(Ne,Ge){return Math.sqrt(Ne*Ne+Ge*Ge)}function xy2r(Ne,Ge){return norm(Ne-kn,Ge-Cn)}function xy2a(Ne,Ge){return Math.atan2(Cn-Ge,Ne-kn)}function ra2xy(Ne,Ge){return[Ne*Math.cos(Ge),Ne*Math.sin(-Ge)]}function pathCorner(Ne,Ge){if(0===Ne)return it.pathSector(2*qn);var Qe=Yn/Ne,tt=Ge-Qe,rt=Ge+Qe,nt=Math.max(0,Math.min(Ne,Zt)),at=nt-qn,ot=nt+qn;return"M"+ra2xy(at,tt)+"A"+[at,at]+" 0,0,0 "+ra2xy(at,rt)+"L"+ra2xy(ot,rt)+"A"+[ot,ot]+" 0,0,1 "+ra2xy(ot,tt)+"Z"}function pathCornerForPolygons(Ne,Ge,Qe){if(0===Ne)return it.pathSector(2*qn);var tt,rt,nt=ra2xy(Ne,Ge),at=ra2xy(Ne,Qe),ot=Bn((nt[0]+at[0])/2),dt=Bn((nt[1]+at[1])/2);if(ot&&dt){var ht=dt/ot,Dt=-1/ht,Ot=Vn(qn,ht,ot,dt);tt=Vn(Yn,Dt,Ot[0][0],Ot[0][1]),rt=Vn(Yn,Dt,Ot[1][0],Ot[1][1])}else{var Rt,Zt;dt?(Rt=Yn,Zt=qn):(Rt=qn,Zt=Yn),tt=[[ot-Rt,dt-Zt],[ot+Rt,dt-Zt]],rt=[[ot-Rt,dt+Zt],[ot+Rt,dt+Zt]]}return"M"+tt.join("L")+"L"+rt.reverse().join("L")+"Z"}function zoomPrep(){pa=null,ga=null,ma=it.pathSubplot(),_a=!1;var Ne=dt._fullLayout[it.id];Va=rt(Ne.bgcolor).getLuminance(),(Wa=dr.makeZoombox(Dt,Va,br,xn,ma)).attr("fill-rule","evenodd"),Qa=dr.makeCorners(Dt,br,xn),mn(dt)}function clampAndSetR0R1(Ne,Ge){return Ge=Math.max(Math.min(Ge,Zt),er),Ne<Rt?Ne=0:Zt-Ne<Rt?Ne=Zt:Ge<Rt?Ge=0:Zt-Ge<Rt&&(Ge=Zt),Math.abs(Ge-Ne)>Ot?(Ne<Ge?(pa=Ne,ga=Ge):(pa=Ge,ga=Ne),!0):(pa=null,ga=null,!1)}function applyZoomMove(Ne,Ge){Ne=Ne||ma,Ge=Ge||"M0,0Z",Wa.attr("d",Ne),Qa.attr("d",Ge),dr.transitionZoombox(Wa,Qa,_a,Va),_a=!0;var Qe={};computeZoomUpdates(Qe),dt.emit("plotly_relayouting",Qe)}function zoomMove(Ne,tt){var rt,nt,at=ra+(Ne*=Ge),ot=oa+(tt*=Qe),dt=xy2r(ra,oa),ht=Math.min(xy2r(at,ot),Zt),Dt=xy2a(ra,oa);clampAndSetR0R1(dt,ht)&&(rt=ma+it.pathSector(ga),pa&&(rt+=it.pathSector(pa)),nt=pathCorner(pa,Dt)+pathCorner(ga,Dt)),applyZoomMove(rt,nt)}function findPolygonRadius(Ne,Ge,Qe,tt){var rt=Dn.findIntersectionXY(Qe,tt,Qe,[Ne-kn,Cn-Ge]);return norm(rt[0],rt[1])}function zoomMoveForPolygons(Ne,Ge){var Qe,tt,rt=ra+Ne,nt=oa+Ge,at=xy2a(ra,oa),ot=xy2a(rt,nt),dt=Hn(at,In),ht=Hn(ot,In);clampAndSetR0R1(findPolygonRadius(ra,oa,dt[0],dt[1]),Math.min(findPolygonRadius(rt,nt,ht[0],ht[1]),Zt))&&(Qe=ma+it.pathSector(ga),pa&&(Qe+=it.pathSector(pa)),tt=[pathCornerForPolygons(pa,dt[0],dt[1]),pathCornerForPolygons(ga,dt[0],dt[1])].join(" ")),applyZoomMove(Qe,tt)}function zoomDone(){if(dr.removeZoombox(dt),null!==pa&&null!==ga){var Ne={};computeZoomUpdates(Ne),dr.showDoubleClickNotifier(dt),nt.call("_guiRelayout",dt,Ne)}}function computeZoomUpdates(Ne){var Ge=zn._rl,Qe=(Ge[1]-Ge[0])/(1-er/Zt)/Zt,tt=[Ge[0]+(pa-er)*Qe,Ge[0]+(ga-er)*Qe];Ne[it.id+".radialaxis.range"]=tt}function zoomClick(Ne,Ge){var Qe=dt._fullLayout.clickmode;if(dr.removeZoombox(dt),2===Ne){var tt={};for(var rt in it.viewInitial)tt[it.id+"."+rt]=it.viewInitial[rt];dt.emit("plotly_doubleclick",null),nt.call("_guiRelayout",dt,tt)}Qe.indexOf("select")>-1&&1===Ne&&en(Ge,dt,[it.xaxis],[it.yaxis],it.id,ti),Qe.indexOf("event")>-1&&xr.click(dt,Ge,it.id)}ti.prepFn=function(Ne,tt,rt){var nt=dt._fullLayout.dragmode,it=$n.getBoundingClientRect();dt._fullLayout._calcInverseTransform(dt);var ot=dt._fullLayout._invTransform;Ge=dt._fullLayout._invScaleX,Qe=dt._fullLayout._invScaleY;var ht=at.apply3DTransform(ot)(tt-it.left,rt-it.top);if(ra=ht[0],oa=ht[1],In){var Dt=Dn.findPolygonOffset(Zt,En[0],En[1],In);ra+=kn+Dt[0],oa+=Cn+Dt[1]}switch(nt){case"zoom":ti.moveFn=In?zoomMoveForPolygons:zoomMove,ti.clickFn=zoomClick,ti.doneFn=zoomDone,zoomPrep(Ne,tt,rt);break;case"select":case"lasso":Ar(Ne,tt,rt,ti,nt)}},$n.onmousemove=function(Ne){xr.hover(dt,Ne,it.id),dt._fullLayout._lasthover=$n,dt._fullLayout._hoversubplot=it.id},$n.onmouseout=function(Ne){dt._dragging||mr.unhover(dt,Ne)},mr.init(ti)},Hn.updateRadialDrag=function(Ne,Ge,Qe){var rt=this,dt=rt.gd,ht=rt.layers,Dt=rt.radius,Ot=rt.innerRadius,Rt=rt.cx,Zt=rt.cy,er=rt.radialAxis,xr=Pn.radialDragBoxSize,br=xr/2;if(er.visible){var Ar,en,xn,En=Bn(rt.radialAxisAngle),Dn=er._rl,In=Dn[0],zn=Dn[1],Hn=Dn[Qe],qn=.75*(Dn[1]-Dn[0])/(1-Ge.hole)/Dt;Qe?(Ar=Rt+(Dt+br)*Math.cos(En),en=Zt-(Dt+br)*Math.sin(En),xn="radialdrag"):(Ar=Rt+(Ot-br)*Math.cos(En),en=Zt-(Ot-br)*Math.sin(En),xn="radialdrag-inner");var Yn,$n,ra,oa=dr.makeRectDragger(ht,xn,"crosshair",-br,-br,xr,xr),pa={element:oa,gd:dt};updateElement(tt.select(oa),er.visible&&Ot<Dt,{transform:ot(Ar,en)}),pa.prepFn=function(){Yn=null,$n=null,ra=null,pa.moveFn=moveFn,pa.doneFn=doneFn,mn(dt)},pa.clampFn=function(Ne,Ge){return Math.sqrt(Ne*Ne+Ge*Ge)<Pn.MINDRAG&&(Ne=0,Ge=0),[Ne,Ge]},mr.init(pa)}function moveFn(Ne,Ge){if(Yn)Yn(Ne,Ge);else{var Qe=[Ne,-Ge],tt=[Math.cos(En),Math.sin(En)],rt=Math.abs(at.dot(Qe,tt)/Math.sqrt(at.dot(Qe,Qe)));isNaN(rt)||(Yn=rt<.5?rotateMove:rerangeMove)}var nt={};computeRadialAxisUpdates(nt),dt.emit("plotly_relayouting",nt)}function computeRadialAxisUpdates(Ne){null!==$n?Ne[rt.id+".radialaxis.angle"]=$n:null!==ra&&(Ne[rt.id+".radialaxis.range["+Qe+"]"]=ra)}function doneFn(){null!==$n?nt.call("_guiRelayout",dt,rt.id+".radialaxis.angle",$n):null!==ra&&nt.call("_guiRelayout",dt,rt.id+".radialaxis.range["+Qe+"]",ra)}function rotateMove(Ne,Ge){if(0!==Qe){var tt=Ar+Ne,nt=en+Ge;$n=Math.atan2(Zt-nt,tt-Rt),rt.vangles&&($n=snapToVertexAngle($n,rt.vangles)),$n=Vn($n);var at=ot(Rt,Zt)+it(-$n);ht["radial-axis"].attr("transform",at),ht["radial-line"].select("line").attr("transform",at);var dt=rt.gd._fullLayout,Dt=dt[rt.id];rt.updateRadialAxisTitle(dt,Dt,$n)}}function rerangeMove(Ne,Ge){var tt=at.dot([Ne,-Ge],[Math.cos(En),Math.sin(En)]);if(ra=Hn-qn*tt,qn>0==(Qe?ra>In:ra<zn)){var it=dt._fullLayout,ot=it[rt.id];er.range[Qe]=ra,er._rl[Qe]=ra,rt.updateRadialAxis(it,ot),rt.xaxis.setRange(),rt.xaxis.setScale(),rt.yaxis.setRange(),rt.yaxis.setScale();var ht=!1;for(var Dt in rt.traceHash){var Ot=rt.traceHash[Dt],Rt=at.filterVisible(Ot);Ot[0][0].trace._module.plot(dt,rt,Rt,ot),nt.traceIs(Dt,"gl")&&Rt.length&&(ht=!0)}ht&&(kn(dt),Cn(dt))}else ra=null}},Hn.updateAngularDrag=function(Ne){var Ge=this,Qe=Ge.gd,rt=Ge.layers,dt=Ge.radius,Dt=Ge.angularAxis,Ot=Ge.cx,Rt=Ge.cy,Zt=Ge.cxx,er=Ge.cyy,xr=Pn.angularDragBoxSize,br=dr.makeDragger(rt,"path","angulardrag","move"),Ar={element:br,gd:Qe};function xy2a(Ne,Ge){return Math.atan2(er+xr-Ge,Ne-Zt-xr)}tt.select(br).attr("d",Ge.pathAnnulus(dt,dt+xr)).attr("transform",ot(Ot,Rt)).call(xn,"move");var en,En,Dn,In,zn,Bn,Hn=rt.frontplot.select(".scatterlayer").selectAll(".trace"),qn=Hn.selectAll(".point"),Yn=Hn.selectAll(".textpoint");function moveFn(dt,dr){var mr=Ge.gd._fullLayout,xr=mr[Ge.id],br=xy2a(en+dt*Ne._invScaleX,En+dr*Ne._invScaleY),Ar=Vn(br-Bn);if(In=Dn+Ar,rt.frontplot.attr("transform",ot(Ge.xOffset2,Ge.yOffset2)+it([-Ar,Zt,er])),Ge.vangles){zn=Ge.radialAxisAngle+Ar;var mn=ot(Ot,Rt)+it(-Ar),xn=ot(Ot,Rt)+it(-zn);rt.bg.attr("transform",mn),rt["radial-grid"].attr("transform",mn),rt["radial-axis"].attr("transform",xn),rt["radial-line"].select("line").attr("transform",xn),Ge.updateRadialAxisTitle(mr,xr,zn)}else Ge.clipPaths.forTraces.select("path").attr("transform",ot(Zt,er)+it(Ar));qn.each((function(){var Ne=tt.select(this),Ge=ht.getTranslate(Ne);Ne.attr("transform",ot(Ge.x,Ge.y)+it([Ar]))})),Yn.each((function(){var Ne=tt.select(this),Ge=Ne.select("text"),Qe=ht.getTranslate(Ne);Ne.attr("transform",it([Ar,Ge.attr("x"),Ge.attr("y")])+ot(Qe.x,Qe.y))})),Dt.rotation=at.modHalf(In,360),Ge.updateAngularAxis(mr,xr),Ge._hasClipOnAxisFalse&&!at.isFullCircle(Ge.sectorInRad)&&Hn.call(ht.hideOutsideRangePoints,Ge);var Pn=!1;for(var $n in Ge.traceHash)if(nt.traceIs($n,"gl")){var ra=Ge.traceHash[$n],oa=at.filterVisible(ra);ra[0][0].trace._module.plot(Qe,Ge,oa,xr),oa.length&&(Pn=!0)}Pn&&(kn(Qe),Cn(Qe));var pa={};computeRotationUpdates(pa),Qe.emit("plotly_relayouting",pa)}function computeRotationUpdates(Ne){Ne[Ge.id+".angularaxis.rotation"]=In,Ge.vangles&&(Ne[Ge.id+".radialaxis.angle"]=zn)}function doneFn(){Yn.select("text").attr("transform",null);var Ne={};computeRotationUpdates(Ne),nt.call("_guiRelayout",Qe,Ne)}Ar.prepFn=function(tt,rt,nt){var it=Ne[Ge.id];Dn=it.angularaxis.rotation;var ot=br.getBoundingClientRect();en=rt-ot.left,En=nt-ot.top,Qe._fullLayout._calcInverseTransform(Qe);var dt=at.apply3DTransform(Ne._invTransform)(en,En);en=dt[0],En=dt[1],Bn=xy2a(en,En),Ar.moveFn=moveFn,Ar.doneFn=doneFn,mn(Qe)},Ge.vangles&&!at.isFullCircle(Ge.sectorInRad)&&(Ar.prepFn=at.noop,xn(tt.select(br),null)),mr.init(Ar)},Hn.isPtInside=function(Ne){var Ge=this.sectorInRad,Qe=this.vangles,tt=this.angularAxis.c2g(Ne.theta),rt=this.radialAxis,nt=rt.c2l(Ne.r),it=rt._rl;return(Qe?Dn.isPtInsidePolygon:at.isPtInsideSector)(nt,tt,it,Ge,Qe)},Hn.pathArc=function(Ne){var Ge=this.sectorInRad,Qe=this.vangles;return(Qe?Dn.pathPolygon:at.pathArc)(Ne,Ge[0],Ge[1],Qe)},Hn.pathSector=function(Ne){var Ge=this.sectorInRad,Qe=this.vangles;return(Qe?Dn.pathPolygon:at.pathSector)(Ne,Ge[0],Ge[1],Qe)},Hn.pathAnnulus=function(Ne,Ge){var Qe=this.sectorInRad,tt=this.vangles;return(tt?Dn.pathPolygonAnnulus:at.pathAnnulus)(Ne,Ge,Qe[0],Qe[1],tt)},Hn.pathSubplot=function(){var Ne=this.innerRadius,Ge=this.radius;return Ne?this.pathAnnulus(Ne,Ge):this.pathSector(Ge)},Hn.fillViewInitialKey=function(Ne,Ge){Ne in this.viewInitial||(this.viewInitial[Ne]=Ge)}},{"../../components/color":643,"../../components/dragelement":662,"../../components/drawing":665,"../../components/fx":683,"../../components/titles":738,"../../constants/alignment":745,"../../lib":778,"../../lib/clear_gl_canvases":762,"../../lib/setcursor":799,"../../plot_api/subroutines":818,"../../plots/cartesian/axes":828,"../../registry":911,"../cartesian/autorange":827,"../cartesian/dragbox":836,"../cartesian/select":847,"../cartesian/set_convert":848,"../plots":891,"./constants":892,"./helpers":893,"./set_convert":904,d3:169,tinycolor2:576}],904:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../cartesian/set_convert"),nt=tt.deg2rad,at=tt.rad2deg;function setConvertRadial(Ne,Ge){var Qe=Ge._subplot;Ne.setGeometry=function(){var Ge=Ne._rl[0],tt=Ne._rl[1],rt=Qe.innerRadius,nt=(Qe.radius-rt)/(tt-Ge),at=rt/nt,it=Ge>tt?function(Ne){return Ne<=0}:function(Ne){return Ne>=0};Ne.c2g=function(Qe){var tt=Ne.c2l(Qe)-Ge;return(it(tt)?tt:0)+at},Ne.g2c=function(Qe){return Ne.l2c(Qe+Ge-at)},Ne.g2p=function(Ne){return Ne*nt},Ne.c2p=function(Ge){return Ne.g2p(Ne.c2g(Ge))}}}function toRadians(Ne,Ge){return"degrees"===Ge?nt(Ne):Ne}function fromRadians(Ne,Ge){return"degrees"===Ge?at(Ne):Ne}function setConvertAngular(Ne,Ge){var Qe=Ne.type;if("linear"===Qe){var rt=Ne.d2c,it=Ne.c2d;Ne.d2c=function(Ne,Ge){return toRadians(rt(Ne),Ge)},Ne.c2d=function(Ne,Ge){return it(fromRadians(Ne,Ge))}}Ne.makeCalcdata=function(Ge,rt){var nt,at,it=Ge[rt],ot=Ge._length,_d2c=function(Qe){return Ne.d2c(Qe,Ge.thetaunit)};if(it){if(tt.isTypedArray(it)&&"linear"===Qe){if(ot===it.length)return it;if(it.subarray)return it.subarray(0,ot)}for(nt=new Array(ot),at=0;at<ot;at++)nt[at]=_d2c(it[at])}else{var dt=rt+"0",ht="d"+rt,Dt=dt in Ge?_d2c(Ge[dt]):0,Ot=Ge[ht]?_d2c(Ge[ht]):(Ne.period||2*Math.PI)/ot;for(nt=new Array(ot),at=0;at<ot;at++)nt[at]=Dt+at*Ot}return nt},Ne.setGeometry=function(){var rt,it,ot,dt,ht=Ge.sector,Dt=ht.map(nt),Ot={clockwise:-1,counterclockwise:1}[Ne.direction],Rt=nt(Ne.rotation),rad2g=function(Ne){return Ot*Ne+Rt},g2rad=function(Ne){return(Ne-Rt)/Ot};switch(Qe){case"linear":it=rt=tt.identity,dt=nt,ot=at,Ne.range=tt.isFullCircle(Dt)?[ht[0],ht[0]+360]:Dt.map(g2rad).map(at);break;case"category":var Zt=Ne._categories.length,er=Ne.period?Math.max(Ne.period,Zt):Zt;0===er&&(er=1),it=dt=function(Ne){return 2*Ne*Math.PI/er},rt=ot=function(Ne){return Ne*er/Math.PI/2},Ne.range=[0,er]}Ne.c2g=function(Ne){return rad2g(it(Ne))},Ne.g2c=function(Ne){return rt(g2rad(Ne))},Ne.t2g=function(Ne){return rad2g(dt(Ne))},Ne.g2t=function(Ne){return ot(g2rad(Ne))}}}Ge.exports=function(Ne,Ge,Qe){switch(rt(Ne,Qe),Ne._id){case"x":case"radialaxis":setConvertRadial(Ne,Ge);break;case"angularaxis":setConvertAngular(Ne,Ge)}}},{"../../lib":778,"../cartesian/set_convert":848}],905:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../lib"),rt=Ne("../plot_api/plot_template"),nt=Ne("./domain").defaults;Ge.exports=function(Ne,Ge,Qe,at){var it,ot,dt=at.type,ht=at.attributes,Dt=at.handleDefaults,Ot=at.partition||"x",Rt=Ge._subplots[dt],Zt=Rt.length,er=Zt&&Rt[0].replace(/\d+$/,"");function coerce(Ne,Ge){return tt.coerce(it,ot,ht,Ne,Ge)}for(var dr=0;dr<Zt;dr++){var mr=Rt[dr];it=Ne[mr]?Ne[mr]:Ne[mr]={},ot=rt.newContainer(Ge,mr,er),coerce("uirevision",Ge.uirevision);var xr={};xr[Ot]=[dr/Zt,(dr+1)/Zt],nt(ot,Ge,coerce,xr),at.id=mr,Dt(it,ot,coerce,at)}}},{"../lib":778,"../plot_api/plot_template":817,"./domain":855}],906:[function(Ne,Ge,Qe){"use strict";function describeVariables(Ne){var Ge=Ne.description?" "+Ne.description:"",Qe=Ne.keys||[];if(Qe.length>0){for(var tt=[],rt=0;rt<Qe.length;rt++)tt[rt]="`"+Qe[rt]+"`";Ge+="Finally, the template string has access to ",Ge=1===Qe.length?"variable "+tt[0]:"variables "+tt.slice(0,-1).join(", ")+" and "+tt.slice(-1)+"."}return Ge}['Variables are inserted using %{variable}, for example "y: %{y}".','Numbers are formatted using d3-format\'s syntax %{variable:d3-format}, for example "Price: %{y:$.2f}".',Ne("../constants/docs").FORMAT_LINK,"for details on the formatting syntax.",'Dates are formatted using d3-time-format\'s syntax %{variable|d3-time-format}, for example "Day: %{2019-01-01|%A}".',Ne("../constants/docs").DATE_FORMAT_LINK,"for details on the date formatting syntax."].join(" "),Qe.hovertemplateAttrs=function(Ne,Ge){Ne=Ne||{},describeVariables(Ge=Ge||{});var Qe={valType:"string",dflt:"",editType:Ne.editType||"none"};return!1!==Ne.arrayOk&&(Qe.arrayOk=!0),Qe},Qe.texttemplateAttrs=function(Ne,Ge){Ne=Ne||{},describeVariables(Ge=Ge||{});var Qe={valType:"string",dflt:"",editType:Ne.editType||"calc"};return!1!==Ne.arrayOk&&(Qe.arrayOk=!0),Qe}},{"../constants/docs":748}],907:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./ternary"),rt=Ne("../../plots/get_data").getSubplotCalcData,nt=Ne("../../lib").counterRegex,at="ternary";Qe.name=at;var it=Qe.attr="subplot";Qe.idRoot=at,Qe.idRegex=Qe.attrRegex=nt(at),(Qe.attributes={})[it]={valType:"subplotid",dflt:"ternary",editType:"calc"},Qe.layoutAttributes=Ne("./layout_attributes"),Qe.supplyLayoutDefaults=Ne("./layout_defaults"),Qe.plot=function(Ne){for(var Ge=Ne._fullLayout,Qe=Ne.calcdata,nt=Ge._subplots[at],it=0;it<nt.length;it++){var ot=nt[it],dt=rt(Qe,at,ot),ht=Ge[ot]._subplot;ht||(ht=new tt({id:ot,graphDiv:Ne,container:Ge._ternarylayer.node()},Ge),Ge[ot]._subplot=ht),ht.plot(dt,Ge,Ne._promises)}},Qe.clean=function(Ne,Ge,Qe,tt){for(var rt=tt._subplots[at]||[],nt=0;nt<rt.length;nt++){var it=rt[nt],ot=tt[it]._subplot;!Ge[it]&&ot&&(ot.plotContainer.remove(),ot.clipDef.remove(),ot.clipDefRelative.remove(),ot.layers["a-title"].remove(),ot.layers["b-title"].remove(),ot.layers["c-title"].remove())}}},{"../../lib":778,"../../plots/get_data":865,"./layout_attributes":908,"./layout_defaults":909,"./ternary":910}],908:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/color/attributes"),rt=Ne("../domain").attributes,nt=Ne("../cartesian/layout_attributes"),at=Ne("../../plot_api/edit_types").overrideAll,it=Ne("../../lib/extend").extendFlat,ot={title:{text:nt.title.text,font:nt.title.font},color:nt.color,tickmode:nt.tickmode,nticks:it({},nt.nticks,{dflt:6,min:1}),tick0:nt.tick0,dtick:nt.dtick,tickvals:nt.tickvals,ticktext:nt.ticktext,ticks:nt.ticks,ticklen:nt.ticklen,tickwidth:nt.tickwidth,tickcolor:nt.tickcolor,showticklabels:nt.showticklabels,showtickprefix:nt.showtickprefix,tickprefix:nt.tickprefix,showticksuffix:nt.showticksuffix,ticksuffix:nt.ticksuffix,showexponent:nt.showexponent,exponentformat:nt.exponentformat,minexponent:nt.minexponent,separatethousands:nt.separatethousands,tickfont:nt.tickfont,tickangle:nt.tickangle,tickformat:nt.tickformat,tickformatstops:nt.tickformatstops,hoverformat:nt.hoverformat,showline:it({},nt.showline,{dflt:!0}),linecolor:nt.linecolor,linewidth:nt.linewidth,showgrid:it({},nt.showgrid,{dflt:!0}),gridcolor:nt.gridcolor,gridwidth:nt.gridwidth,layer:nt.layer,min:{valType:"number",dflt:0,min:0},_deprecated:{title:nt._deprecated.title,titlefont:nt._deprecated.titlefont}},dt=Ge.exports=at({domain:rt({name:"ternary"}),bgcolor:{valType:"color",dflt:tt.background},sum:{valType:"number",dflt:1,min:0},aaxis:ot,baxis:ot,caxis:ot},"plot","from-root");dt.uirevision={valType:"any",editType:"none"},dt.aaxis.uirevision=dt.baxis.uirevision=dt.caxis.uirevision={valType:"any",editType:"none"}},{"../../components/color/attributes":642,"../../lib/extend":768,"../../plot_api/edit_types":810,"../cartesian/layout_attributes":842,"../domain":855}],909:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/color"),rt=Ne("../../plot_api/plot_template"),nt=Ne("../../lib"),at=Ne("../subplot_defaults"),it=Ne("../cartesian/tick_label_defaults"),ot=Ne("../cartesian/tick_mark_defaults"),dt=Ne("../cartesian/tick_value_defaults"),ht=Ne("../cartesian/line_grid_defaults"),Dt=Ne("./layout_attributes"),Ot=["aaxis","baxis","caxis"];function handleTernaryDefaults(Ne,Ge,Qe,nt){var at,it,ot,dt=Qe("bgcolor"),ht=Qe("sum");nt.bgColor=tt.combine(dt,nt.paper_bgcolor);for(var Dt=0;Dt<Ot.length;Dt++)it=Ne[at=Ot[Dt]]||{},(ot=rt.newContainer(Ge,at))._name=at,handleAxisDefaults(it,ot,nt,Ge);var Rt=Ge.aaxis,Zt=Ge.baxis,er=Ge.caxis;Rt.min+Zt.min+er.min>=ht&&(Rt.min=0,Zt.min=0,er.min=0,Ne.aaxis&&delete Ne.aaxis.min,Ne.baxis&&delete Ne.baxis.min,Ne.caxis&&delete Ne.caxis.min)}function handleAxisDefaults(Ne,Ge,Qe,tt){var rt=Dt[Ge._name];function coerce(Qe,tt){return nt.coerce(Ne,Ge,rt,Qe,tt)}coerce("uirevision",tt.uirevision),Ge.type="linear";var at=coerce("color"),Ot=at!==rt.color.dflt?at:Qe.font.color,Rt=Ge._name.charAt(0).toUpperCase(),Zt="Component "+Rt,er=coerce("title.text",Zt);Ge._hovertitle=er===Zt?er:Rt,nt.coerceFont(coerce,"title.font",{family:Qe.font.family,size:Math.round(1.2*Qe.font.size),color:Ot}),coerce("min"),dt(Ne,Ge,coerce,"linear"),it(Ne,Ge,coerce,"linear",{}),ot(Ne,Ge,coerce,{outerTicks:!0}),coerce("showticklabels")&&(nt.coerceFont(coerce,"tickfont",{family:Qe.font.family,size:Qe.font.size,color:Ot}),coerce("tickangle"),coerce("tickformat")),ht(Ne,Ge,coerce,{dfltColor:at,bgColor:Qe.bgColor,blend:60,showLine:!0,showGrid:!0,noZeroLine:!0,attributes:rt}),coerce("hoverformat"),coerce("layer")}Ge.exports=function(Ne,Ge,Qe){at(Ne,Ge,Qe,{type:"ternary",attributes:Dt,handleDefaults:handleTernaryDefaults,font:Ge.font,paper_bgcolor:Ge.paper_bgcolor})}},{"../../components/color":643,"../../lib":778,"../../plot_api/plot_template":817,"../cartesian/line_grid_defaults":844,"../cartesian/tick_label_defaults":849,"../cartesian/tick_mark_defaults":850,"../cartesian/tick_value_defaults":851,"../subplot_defaults":905,"./layout_attributes":908}],910:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("tinycolor2"),nt=Ne("../../registry"),at=Ne("../../lib"),it=at.strTranslate,ot=at._,dt=Ne("../../components/color"),ht=Ne("../../components/drawing"),Dt=Ne("../cartesian/set_convert"),Ot=Ne("../../lib/extend").extendFlat,Rt=Ne("../plots"),Zt=Ne("../cartesian/axes"),er=Ne("../../components/dragelement"),dr=Ne("../../components/fx"),mr=Ne("../../components/dragelement/helpers"),xr=mr.freeMode,br=mr.rectMode,Ar=Ne("../../components/titles"),en=Ne("../cartesian/select").prepSelect,mn=Ne("../cartesian/select").selectOnClick,xn=Ne("../cartesian/select").clearSelect,kn=Ne("../cartesian/select").clearSelectionsCache,Cn=Ne("../cartesian/constants");function Ternary(Ne,Ge){this.id=Ne.id,this.graphDiv=Ne.graphDiv,this.init(Ge),this.makeFramework(Ge),this.aTickLayout=null,this.bTickLayout=null,this.cTickLayout=null}Ge.exports=Ternary;var En=Ternary.prototype;En.init=function(Ne){this.container=Ne._ternarylayer,this.defs=Ne._defs,this.layoutId=Ne._uid,this.traceHash={},this.layers={}},En.plot=function(Ne,Ge){var Qe=this,tt=Ge[Qe.id],rt=Ge._size;Qe._hasClipOnAxisFalse=!1;for(var nt=0;nt<Ne.length;nt++)if(!1===Ne[nt][0].trace.cliponaxis){Qe._hasClipOnAxisFalse=!0;break}Qe.updateLayers(tt),Qe.adjustLayout(tt,rt),Rt.generalUpdatePerTraceModule(Qe.graphDiv,Qe,Ne,tt),Qe.layers.plotbg.select("path").call(dt.fill,tt.bgcolor)},En.makeFramework=function(Ne){var Ge=this,Qe=Ge.graphDiv,tt=Ne[Ge.id],rt=Ge.clipId="clip"+Ge.layoutId+Ge.id,nt=Ge.clipIdRelative="clip-relative"+Ge.layoutId+Ge.id;Ge.clipDef=at.ensureSingleById(Ne._clips,"clipPath",rt,(function(Ne){Ne.append("path").attr("d","M0,0Z")})),Ge.clipDefRelative=at.ensureSingleById(Ne._clips,"clipPath",nt,(function(Ne){Ne.append("path").attr("d","M0,0Z")})),Ge.plotContainer=at.ensureSingle(Ge.container,"g",Ge.id),Ge.updateLayers(tt),ht.setClipUrl(Ge.layers.backplot,rt,Qe),ht.setClipUrl(Ge.layers.grids,rt,Qe)},En.updateLayers=function(Ne){var Ge=this,Qe=Ge.layers,rt=["draglayer","plotbg","backplot","grids"];"below traces"===Ne.aaxis.layer&&rt.push("aaxis","aline"),"below traces"===Ne.baxis.layer&&rt.push("baxis","bline"),"below traces"===Ne.caxis.layer&&rt.push("caxis","cline"),rt.push("frontplot"),"above traces"===Ne.aaxis.layer&&rt.push("aaxis","aline"),"above traces"===Ne.baxis.layer&&rt.push("baxis","bline"),"above traces"===Ne.caxis.layer&&rt.push("caxis","cline");var nt=Ge.plotContainer.selectAll("g.toplevel").data(rt,String),at=["agrid","bgrid","cgrid"];nt.enter().append("g").attr("class",(function(Ne){return"toplevel "+Ne})).each((function(Ne){var Ge=tt.select(this);Qe[Ne]=Ge,"frontplot"===Ne?Ge.append("g").classed("scatterlayer",!0):"backplot"===Ne?Ge.append("g").classed("maplayer",!0):"plotbg"===Ne?Ge.append("path").attr("d","M0,0Z"):"aline"===Ne||"bline"===Ne||"cline"===Ne?Ge.append("path"):"grids"===Ne&&at.forEach((function(Ne){Qe[Ne]=Ge.append("g").classed("grid "+Ne,!0)}))})),nt.order()};var Pn=Math.sqrt(4/3);function strTickLayout(Ne){return Ne.ticks+String(Ne.ticklen)+String(Ne.showticklabels)}En.adjustLayout=function(Ne,Ge){var Qe,tt,rt,nt,at,ot,Rt=this,Zt=Ne.domain,er=(Zt.x[0]+Zt.x[1])/2,dr=(Zt.y[0]+Zt.y[1])/2,mr=Zt.x[1]-Zt.x[0],xr=Zt.y[1]-Zt.y[0],br=mr*Ge.w,Ar=xr*Ge.h,en=Ne.sum,mn=Ne.aaxis.min,xn=Ne.baxis.min,kn=Ne.caxis.min;br>Pn*Ar?rt=(nt=Ar)*Pn:nt=(rt=br)/Pn,at=mr*rt/br,ot=xr*nt/Ar,Qe=Ge.l+Ge.w*er-rt/2,tt=Ge.t+Ge.h*(1-dr)-nt/2,Rt.x0=Qe,Rt.y0=tt,Rt.w=rt,Rt.h=nt,Rt.sum=en,Rt.xaxis={type:"linear",range:[mn+2*kn-en,en-mn-2*xn],domain:[er-at/2,er+at/2],_id:"x"},Dt(Rt.xaxis,Rt.graphDiv._fullLayout),Rt.xaxis.setScale(),Rt.xaxis.isPtWithinRange=function(Ne){return Ne.a>=Rt.aaxis.range[0]&&Ne.a<=Rt.aaxis.range[1]&&Ne.b>=Rt.baxis.range[1]&&Ne.b<=Rt.baxis.range[0]&&Ne.c>=Rt.caxis.range[1]&&Ne.c<=Rt.caxis.range[0]},Rt.yaxis={type:"linear",range:[mn,en-xn-kn],domain:[dr-ot/2,dr+ot/2],_id:"y"},Dt(Rt.yaxis,Rt.graphDiv._fullLayout),Rt.yaxis.setScale(),Rt.yaxis.isPtWithinRange=function(){return!0};var Cn=Rt.yaxis.domain[0],En=Rt.aaxis=Ot({},Ne.aaxis,{range:[mn,en-xn-kn],side:"left",tickangle:(+Ne.aaxis.tickangle||0)-30,domain:[Cn,Cn+ot*Pn],anchor:"free",position:0,_id:"y",_length:rt});Dt(En,Rt.graphDiv._fullLayout),En.setScale();var Dn=Rt.baxis=Ot({},Ne.baxis,{range:[en-mn-kn,xn],side:"bottom",domain:Rt.xaxis.domain,anchor:"free",position:0,_id:"x",_length:rt});Dt(Dn,Rt.graphDiv._fullLayout),Dn.setScale();var In=Rt.caxis=Ot({},Ne.caxis,{range:[en-mn-xn,kn],side:"right",tickangle:(+Ne.caxis.tickangle||0)+30,domain:[Cn,Cn+ot*Pn],anchor:"free",position:0,_id:"y",_length:rt});Dt(In,Rt.graphDiv._fullLayout),In.setScale();var zn="M"+Qe+","+(tt+nt)+"h"+rt+"l-"+rt/2+",-"+nt+"Z";Rt.clipDef.select("path").attr("d",zn),Rt.layers.plotbg.select("path").attr("d",zn);var Bn="M0,"+nt+"h"+rt+"l-"+rt/2+",-"+nt+"Z";Rt.clipDefRelative.select("path").attr("d",Bn);var Vn=it(Qe,tt);Rt.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",Vn),Rt.clipDefRelative.select("path").attr("transform",null);var Hn=it(Qe-Dn._offset,tt+nt);Rt.layers.baxis.attr("transform",Hn),Rt.layers.bgrid.attr("transform",Hn);var qn=it(Qe+rt/2,tt)+"rotate(30)"+it(0,-En._offset);Rt.layers.aaxis.attr("transform",qn),Rt.layers.agrid.attr("transform",qn);var Yn=it(Qe+rt/2,tt)+"rotate(-30)"+it(0,-In._offset);Rt.layers.caxis.attr("transform",Yn),Rt.layers.cgrid.attr("transform",Yn),Rt.drawAxes(!0),Rt.layers.aline.select("path").attr("d",En.showline?"M"+Qe+","+(tt+nt)+"l"+rt/2+",-"+nt:"M0,0").call(dt.stroke,En.linecolor||"#000").style("stroke-width",(En.linewidth||0)+"px"),Rt.layers.bline.select("path").attr("d",Dn.showline?"M"+Qe+","+(tt+nt)+"h"+rt:"M0,0").call(dt.stroke,Dn.linecolor||"#000").style("stroke-width",(Dn.linewidth||0)+"px"),Rt.layers.cline.select("path").attr("d",In.showline?"M"+(Qe+rt/2)+","+tt+"l"+rt/2+","+nt:"M0,0").call(dt.stroke,In.linecolor||"#000").style("stroke-width",(In.linewidth||0)+"px"),Rt.graphDiv._context.staticPlot||Rt.initInteractions(),ht.setClipUrl(Rt.layers.frontplot,Rt._hasClipOnAxisFalse?null:Rt.clipId,Rt.graphDiv)},En.drawAxes=function(Ne){var Ge=this,Qe=Ge.graphDiv,tt=Ge.id.substr(7)+"title",rt=Ge.layers,nt=Ge.aaxis,at=Ge.baxis,it=Ge.caxis;if(Ge.drawAx(nt),Ge.drawAx(at),Ge.drawAx(it),Ne){var dt=Math.max(nt.showticklabels?nt.tickfont.size/2:0,(it.showticklabels?.75*it.tickfont.size:0)+("outside"===it.ticks?.87*it.ticklen:0)),ht=(at.showticklabels?at.tickfont.size:0)+("outside"===at.ticks?at.ticklen:0)+3;rt["a-title"]=Ar.draw(Qe,"a"+tt,{propContainer:nt,propName:Ge.id+".aaxis.title",placeholder:ot(Qe,"Click to enter Component A title"),attributes:{x:Ge.x0+Ge.w/2,y:Ge.y0-nt.title.font.size/3-dt,"text-anchor":"middle"}}),rt["b-title"]=Ar.draw(Qe,"b"+tt,{propContainer:at,propName:Ge.id+".baxis.title",placeholder:ot(Qe,"Click to enter Component B title"),attributes:{x:Ge.x0-ht,y:Ge.y0+Ge.h+.83*at.title.font.size+ht,"text-anchor":"middle"}}),rt["c-title"]=Ar.draw(Qe,"c"+tt,{propContainer:it,propName:Ge.id+".caxis.title",placeholder:ot(Qe,"Click to enter Component C title"),attributes:{x:Ge.x0+Ge.w+ht,y:Ge.y0+Ge.h+.83*it.title.font.size+ht,"text-anchor":"middle"}})}},En.drawAx=function(Ne){var Ge=this,Qe=Ge.graphDiv,tt=Ne._name,rt=tt.charAt(0),nt=Ne._id,it=Ge.layers[tt],ot=30,dt=rt+"tickLayout",ht=strTickLayout(Ne);Ge[dt]!==ht&&(it.selectAll("."+nt+"tick").remove(),Ge[dt]=ht),Ne.setScale();var Dt=Zt.calcTicks(Ne),Ot=Zt.clipEnds(Ne,Dt),Rt=Zt.makeTransTickFn(Ne),er=Zt.getTickSigns(Ne)[2],dr=at.deg2rad(ot),mr=er*(Ne.linewidth||1)/2,xr=er*Ne.ticklen,br=Ge.w,Ar=Ge.h,en="b"===rt?"M0,"+mr+"l"+Math.sin(dr)*xr+","+Math.cos(dr)*xr:"M"+mr+",0l"+Math.cos(dr)*xr+","+-Math.sin(dr)*xr,mn={a:"M0,0l"+Ar+",-"+br/2,b:"M0,0l-"+br/2+",-"+Ar,c:"M0,0l-"+Ar+","+br/2}[rt];Zt.drawTicks(Qe,Ne,{vals:"inside"===Ne.ticks?Ot:Dt,layer:it,path:en,transFn:Rt,crisp:!1}),Zt.drawGrid(Qe,Ne,{vals:Ot,layer:Ge.layers[rt+"grid"],path:mn,transFn:Rt,crisp:!1}),Zt.drawLabels(Qe,Ne,{vals:Dt,layer:it,transFn:Rt,labelFns:Zt.makeLabelFns(Ne,0,ot)})};var Dn=Cn.MINZOOM/2+.87,In="m-0.87,.5h"+Dn+"v3h-"+(Dn+5.2)+"l"+(Dn/2+2.6)+",-"+(.87*Dn+4.5)+"l2.6,1.5l-"+Dn/2+","+.87*Dn+"Z",zn="m0.87,.5h-"+Dn+"v3h"+(Dn+5.2)+"l-"+(Dn/2+2.6)+",-"+(.87*Dn+4.5)+"l-2.6,1.5l"+Dn/2+","+.87*Dn+"Z",Bn="m0,1l"+Dn/2+","+.87*Dn+"l2.6,-1.5l-"+(Dn/2+2.6)+",-"+(.87*Dn+4.5)+"l-"+(Dn/2+2.6)+","+(.87*Dn+4.5)+"l2.6,1.5l"+Dn/2+",-"+.87*Dn+"Z",Vn="m0.5,0.5h5v-2h-5v-5h-2v5h-5v2h5v5h2Z",Hn=!0;function removeZoombox(Ne){tt.select(Ne).selectAll(".zoombox,.js-zoombox-backdrop,.js-zoombox-menu,.zoombox-corners").remove()}En.clearSelect=function(){kn(this.dragOptions),xn(this.dragOptions.gd)},En.initInteractions=function(){var Ne,Ge,Qe,tt,Dt,Ot,Rt,Zt,mr,Ar,xn,kn,En=this,Dn=En.layers.plotbg.select("path").node(),qn=En.graphDiv,Yn=qn._fullLayout._zoomlayer;function makeUpdate(Ne){var Ge={};return Ge[En.id+".aaxis.min"]=Ne.a,Ge[En.id+".baxis.min"]=Ne.b,Ge[En.id+".caxis.min"]=Ne.c,Ge}function clickZoomPan(Ne,Ge){var Qe=qn._fullLayout.clickmode;removeZoombox(qn),2===Ne&&(qn.emit("plotly_doubleclick",null),nt.call("_guiRelayout",qn,makeUpdate({a:0,b:0,c:0}))),Qe.indexOf("select")>-1&&1===Ne&&mn(Ge,qn,[En.xaxis],[En.yaxis],En.id,En.dragOptions),Qe.indexOf("event")>-1&&dr.click(qn,Ge,En.id)}function zoomPrep(Ne,Ge,nt){var ot=Dn.getBoundingClientRect();Qe=Ge-ot.left,tt=nt-ot.top,qn._fullLayout._calcInverseTransform(qn);var ht=qn._fullLayout._invTransform,er=at.apply3DTransform(ht)(Qe,tt);Qe=er[0],tt=er[1],Dt={a:En.aaxis.range[0],b:En.baxis.range[1],c:En.caxis.range[1]},Rt=Dt,Ot=En.aaxis.range[1]-Dt.a,Zt=rt(En.graphDiv._fullLayout[En.id].bgcolor).getLuminance(),mr="M0,"+En.h+"L"+En.w/2+", 0L"+En.w+","+En.h+"Z",Ar=!1,xn=Yn.append("path").attr("class","zoombox").attr("transform",it(En.x0,En.y0)).style({fill:Zt>.2?"rgba(0,0,0,0)":"rgba(255,255,255,0)","stroke-width":0}).attr("d",mr),kn=Yn.append("path").attr("class","zoombox-corners").attr("transform",it(En.x0,En.y0)).style({fill:dt.background,stroke:dt.defaultLine,"stroke-width":1,opacity:0}).attr("d","M0,0Z"),En.clearSelect(qn)}function getAFrac(Ne,Ge){return 1-Ge/En.h}function getBFrac(Ne,Ge){return 1-(Ne+(En.h-Ge)/Math.sqrt(3))/En.w}function getCFrac(Ne,Ge){return(Ne-(En.h-Ge)/Math.sqrt(3))/En.w}function zoomMove(rt,nt){var at=Qe+rt*Ne,it=tt+nt*Ge,ot=Math.max(0,Math.min(1,getAFrac(Qe,tt),getAFrac(at,it))),dt=Math.max(0,Math.min(1,getBFrac(Qe,tt),getBFrac(at,it))),ht=Math.max(0,Math.min(1,getCFrac(Qe,tt),getCFrac(at,it))),er=(ot/2+ht)*En.w,dr=(1-ot/2-dt)*En.w,xr=(er+dr)/2,br=dr-er,en=(1-ot)*En.h,mn=en-br/Pn;br<Cn.MINZOOM?(Rt=Dt,xn.attr("d",mr),kn.attr("d","M0,0Z")):(Rt={a:Dt.a+ot*Ot,b:Dt.b+dt*Ot,c:Dt.c+ht*Ot},xn.attr("d",mr+"M"+er+","+en+"H"+dr+"L"+xr+","+mn+"L"+er+","+en+"Z"),kn.attr("d","M"+Qe+","+tt+Vn+"M"+er+","+en+In+"M"+dr+","+en+zn+"M"+xr+","+mn+Bn)),Ar||(xn.transition().style("fill",Zt>.2?"rgba(0,0,0,0.4)":"rgba(255,255,255,0.3)").duration(200),kn.transition().style("opacity",1).duration(200),Ar=!0),qn.emit("plotly_relayouting",makeUpdate(Rt))}function zoomDone(){removeZoombox(qn),Rt!==Dt&&(nt.call("_guiRelayout",qn,makeUpdate(Rt)),Hn&&qn.data&&qn._context.showTips&&(at.notifier(ot(qn,"Double-click to zoom back out"),"long"),Hn=!1))}function panPrep(){Dt={a:En.aaxis.range[0],b:En.baxis.range[1],c:En.caxis.range[1]},Rt=Dt}function plotDrag(Ne,Ge){var Qe=Ne/En.xaxis._m,tt=Ge/En.yaxis._m,rt=[(Rt={a:Dt.a-tt,b:Dt.b+(Qe+tt)/2,c:Dt.c-(Qe-tt)/2}).a,Rt.b,Rt.c].sort(at.sorterAsc),nt={a:rt.indexOf(Rt.a),b:rt.indexOf(Rt.b),c:rt.indexOf(Rt.c)};rt[0]<0&&(rt[1]+rt[0]/2<0?(rt[2]+=rt[0]+rt[1],rt[0]=rt[1]=0):(rt[2]+=rt[0]/2,rt[1]+=rt[0]/2,rt[0]=0),Rt={a:rt[nt.a],b:rt[nt.b],c:rt[nt.c]},Ge=(Dt.a-Rt.a)*En.yaxis._m,Ne=(Dt.c-Rt.c-Dt.b+Rt.b)*En.xaxis._m);var ot=it(En.x0+Ne,En.y0+Ge);En.plotContainer.selectAll(".scatterlayer,.maplayer").attr("transform",ot);var dt=it(-Ne,-Ge);En.clipDefRelative.select("path").attr("transform",dt),En.aaxis.range=[Rt.a,En.sum-Rt.b-Rt.c],En.baxis.range=[En.sum-Rt.a-Rt.c,Rt.b],En.caxis.range=[En.sum-Rt.a-Rt.b,Rt.c],En.drawAxes(!1),En._hasClipOnAxisFalse&&En.plotContainer.select(".scatterlayer").selectAll(".trace").call(ht.hideOutsideRangePoints,En),qn.emit("plotly_relayouting",makeUpdate(Rt))}function dragDone(){nt.call("_guiRelayout",qn,makeUpdate(Rt))}this.dragOptions={element:Dn,gd:qn,plotinfo:{id:En.id,domain:qn._fullLayout[En.id].domain,xaxis:En.xaxis,yaxis:En.yaxis},subplot:En.id,prepFn:function(Qe,tt,rt){En.dragOptions.xaxes=[En.xaxis],En.dragOptions.yaxes=[En.yaxis],Ne=qn._fullLayout._invScaleX,Ge=qn._fullLayout._invScaleY;var nt=En.dragOptions.dragmode=qn._fullLayout.dragmode;xr(nt)?En.dragOptions.minDrag=1:En.dragOptions.minDrag=void 0,"zoom"===nt?(En.dragOptions.moveFn=zoomMove,En.dragOptions.clickFn=clickZoomPan,En.dragOptions.doneFn=zoomDone,zoomPrep(Qe,tt,rt)):"pan"===nt?(En.dragOptions.moveFn=plotDrag,En.dragOptions.clickFn=clickZoomPan,En.dragOptions.doneFn=dragDone,panPrep(),En.clearSelect(qn)):(br(nt)||xr(nt))&&en(Qe,tt,rt,En.dragOptions,nt)}},Dn.onmousemove=function(Ne){dr.hover(qn,Ne,En.id),qn._fullLayout._lasthover=Dn,qn._fullLayout._hoversubplot=En.id},Dn.onmouseout=function(Ne){qn._dragging||er.unhover(qn,Ne)},er.init(this.dragOptions)}},{"../../components/color":643,"../../components/dragelement":662,"../../components/dragelement/helpers":661,"../../components/drawing":665,"../../components/fx":683,"../../components/titles":738,"../../lib":778,"../../lib/extend":768,"../../registry":911,"../cartesian/axes":828,"../cartesian/constants":834,"../cartesian/select":847,"../cartesian/set_convert":848,"../plots":891,d3:169,tinycolor2:576}],911:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./lib/loggers"),rt=Ne("./lib/noop"),nt=Ne("./lib/push_unique"),at=Ne("./lib/is_plain_object"),it=Ne("./lib/dom").addStyleRule,ot=Ne("./lib/extend"),dt=Ne("./plots/attributes"),ht=Ne("./plots/layout_attributes"),Dt=ot.extendFlat,Ot=ot.extendDeepAll;function registerTraceModule(Ne){var Ge=Ne.name,rt=Ne.categories,nt=Ne.meta;if(Qe.modules[Ge])tt.log("Type "+Ge+" already registered");else{Qe.subplotsRegistry[Ne.basePlotModule.name]||registerSubplot(Ne.basePlotModule);for(var at={},ot=0;ot<rt.length;ot++)at[rt[ot]]=!0,Qe.allCategories[rt[ot]]=!0;for(var dt in Qe.modules[Ge]={_module:Ne,categories:at},nt&&Object.keys(nt).length&&(Qe.modules[Ge].meta=nt),Qe.allTypes.push(Ge),Qe.componentsRegistry)mergeComponentAttrsToTrace(dt,Ge);Ne.layoutAttributes&&Dt(Qe.traceLayoutAttributes,Ne.layoutAttributes);var ht=Ne.basePlotModule,Ot=ht.name;if("mapbox"===Ot){var Rt=ht.constants.styleRules;for(var Zt in Rt)it(".js-plotly-plot .plotly .mapboxgl-"+Zt,Rt[Zt])}"geo"!==Ot&&"mapbox"!==Ot||void 0===typeof window||void 0!==window.PlotlyGeoAssets||(window.PlotlyGeoAssets={topojson:{}})}}function registerSubplot(Ne){var Ge=Ne.name;if(Qe.subplotsRegistry[Ge])tt.log("Plot type "+Ge+" already registered.");else for(var rt in findArrayRegexps(Ne),Qe.subplotsRegistry[Ge]=Ne,Qe.componentsRegistry)mergeComponentAttrsToSubplot(rt,Ne.name)}function registerComponentModule(Ne){if("string"!=typeof Ne.name)throw new Error("Component module *name* must be a string.");var Ge=Ne.name;for(var tt in Qe.componentsRegistry[Ge]=Ne,Ne.layoutAttributes&&(Ne.layoutAttributes._isLinkedToArray&&nt(Qe.layoutArrayContainers,Ge),findArrayRegexps(Ne)),Qe.modules)mergeComponentAttrsToTrace(Ge,tt);for(var rt in Qe.subplotsRegistry)mergeComponentAttrsToSubplot(Ge,rt);for(var at in Qe.transformsRegistry)mergeComponentAttrsToTransform(Ge,at);Ne.schema&&Ne.schema.layout&&Ot(ht,Ne.schema.layout)}function registerTransformModule(Ne){if("string"!=typeof Ne.name)throw new Error("Transform module *name* must be a string.");var Ge="Transform module "+Ne.name,rt="function"==typeof Ne.transform,nt="function"==typeof Ne.calcTransform;if(!rt&&!nt)throw new Error(Ge+" is missing a *transform* or *calcTransform* method.");for(var it in rt&&nt&&tt.log([Ge+" has both a *transform* and *calcTransform* methods.","Please note that all *transform* methods are executed","before all *calcTransform* methods."].join(" ")),at(Ne.attributes)||tt.log(Ge+" registered without an *attributes* object."),"function"!=typeof Ne.supplyDefaults&&tt.log(Ge+" registered without a *supplyDefaults* method."),Qe.transformsRegistry[Ne.name]=Ne,Qe.componentsRegistry)mergeComponentAttrsToTransform(it,Ne.name)}function registerLocale(Ne){var Ge=Ne.name,tt=Ge.split("-")[0],rt=Ne.dictionary,nt=Ne.format,at=rt&&Object.keys(rt).length,it=nt&&Object.keys(nt).length,ot=Qe.localeRegistry,dt=ot[Ge];if(dt||(ot[Ge]=dt={}),tt!==Ge){var ht=ot[tt];ht||(ot[tt]=ht={}),at&&ht.dictionary===dt.dictionary&&(ht.dictionary=rt),it&&ht.format===dt.format&&(ht.format=nt)}at&&(dt.dictionary=rt),it&&(dt.format=nt)}function findArrayRegexps(Ne){if(Ne.layoutAttributes){var Ge=Ne.layoutAttributes._arrayAttrRegexps;if(Ge)for(var tt=0;tt<Ge.length;tt++)nt(Qe.layoutArrayRegexes,Ge[tt])}}function mergeComponentAttrsToTrace(Ne,Ge){var tt=Qe.componentsRegistry[Ne].schema;if(tt&&tt.traces){var rt=tt.traces[Ge];rt&&Ot(Qe.modules[Ge]._module.attributes,rt)}}function mergeComponentAttrsToTransform(Ne,Ge){var tt=Qe.componentsRegistry[Ne].schema;if(tt&&tt.transforms){var rt=tt.transforms[Ge];rt&&Ot(Qe.transformsRegistry[Ge].attributes,rt)}}function mergeComponentAttrsToSubplot(Ne,Ge){var tt=Qe.componentsRegistry[Ne].schema;if(tt&&tt.subplots){var rt=Qe.subplotsRegistry[Ge],nt=rt.layoutAttributes,at="subplot"===rt.attr?rt.name:rt.attr;Array.isArray(at)&&(at=at[0]);var it=tt.subplots[at];nt&&it&&Ot(nt,it)}}function getTraceType(Ne){return"object"==typeof Ne&&(Ne=Ne.type),Ne}Qe.modules={},Qe.allCategories={},Qe.allTypes=[],Qe.subplotsRegistry={},Qe.transformsRegistry={},Qe.componentsRegistry={},Qe.layoutArrayContainers=[],Qe.layoutArrayRegexes=[],Qe.traceLayoutAttributes={},Qe.localeRegistry={},Qe.apiMethodRegistry={},Qe.collectableSubplotTypes=null,Qe.register=function(Ne){if(Qe.collectableSubplotTypes=null,!Ne)throw new Error("No argument passed to Plotly.register.");Ne&&!Array.isArray(Ne)&&(Ne=[Ne]);for(var Ge=0;Ge<Ne.length;Ge++){var tt=Ne[Ge];if(!tt)throw new Error("Invalid module was attempted to be registered!");switch(tt.moduleType){case"trace":registerTraceModule(tt);break;case"transform":registerTransformModule(tt);break;case"component":registerComponentModule(tt);break;case"locale":registerLocale(tt);break;case"apiMethod":var rt=tt.name;Qe.apiMethodRegistry[rt]=tt.fn;break;default:throw new Error("Invalid module was attempted to be registered!")}}},Qe.getModule=function(Ne){var Ge=Qe.modules[getTraceType(Ne)];return!!Ge&&Ge._module},Qe.traceIs=function(Ne,Ge){if("various"===(Ne=getTraceType(Ne)))return!1;var rt=Qe.modules[Ne];return rt||(Ne&&"area"!==Ne&&tt.log("Unrecognized trace type "+Ne+"."),rt=Qe.modules[dt.type.dflt]),!!rt.categories[Ge]},Qe.getTransformIndices=function(Ne,Ge){for(var Qe=[],tt=Ne.transforms||[],rt=0;rt<tt.length;rt++)tt[rt].type===Ge&&Qe.push(rt);return Qe},Qe.hasTransform=function(Ne,Ge){for(var Qe=Ne.transforms||[],tt=0;tt<Qe.length;tt++)if(Qe[tt].type===Ge)return!0;return!1},Qe.getComponentMethod=function(Ne,Ge){var tt=Qe.componentsRegistry[Ne];return tt&&tt[Ge]||rt},Qe.call=function(){var Ne=arguments[0],Ge=[].slice.call(arguments,1);return Qe.apiMethodRegistry[Ne].apply(null,Ge)}},{"./lib/dom":766,"./lib/extend":768,"./lib/is_plain_object":779,"./lib/loggers":782,"./lib/noop":787,"./lib/push_unique":793,"./plots/attributes":824,"./plots/layout_attributes":882}],912:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../registry"),rt=Ne("../lib"),nt=rt.extendFlat,at=rt.extendDeep;function cloneLayoutOverride(Ne){var Ge;switch(Ne){case"themes__thumb":Ge={autosize:!0,width:150,height:150,title:{text:""},showlegend:!1,margin:{l:5,r:5,t:5,b:5,pad:0},annotations:[]};break;case"thumbnail":Ge={title:{text:""},hidesources:!0,showlegend:!1,borderwidth:0,bordercolor:"",margin:{l:1,r:1,t:1,b:1,pad:0},annotations:[]};break;default:Ge={}}return Ge}function keyIsAxis(Ne){return["xaxis","yaxis","zaxis"].indexOf(Ne.slice(0,5))>-1}Ge.exports=function(Ne,Ge){var Qe;Ne.framework&&Ne.framework.isPolar&&(Ne=Ne.framework.getConfig());var rt=Ne.data,it=Ne.layout,ot=at([],rt),dt=at({},it,cloneLayoutOverride(Ge.tileClass)),ht=Ne._context||{};if(Ge.width&&(dt.width=Ge.width),Ge.height&&(dt.height=Ge.height),"thumbnail"===Ge.tileClass||"themes__thumb"===Ge.tileClass){dt.annotations=[];var Dt=Object.keys(dt);for(Qe=0;Qe<Dt.length;Qe++)keyIsAxis(Dt[Qe])&&(dt[Dt[Qe]].title={text:""});for(Qe=0;Qe<ot.length;Qe++){var Ot=ot[Qe];Ot.showscale=!1,Ot.marker&&(Ot.marker.showscale=!1),tt.traceIs(Ot,"pie-like")&&(Ot.textposition="none")}}if(Array.isArray(Ge.annotations))for(Qe=0;Qe<Ge.annotations.length;Qe++)dt.annotations.push(Ge.annotations[Qe]);var Rt=Object.keys(dt).filter((function(Ne){return Ne.match(/^scene\d*$/)}));if(Rt.length){var Zt={};for("thumbnail"===Ge.tileClass&&(Zt={title:{text:""},showaxeslabels:!1,showticklabels:!1,linetickenable:!1}),Qe=0;Qe<Rt.length;Qe++){var er=dt[Rt[Qe]];er.xaxis||(er.xaxis={}),er.yaxis||(er.yaxis={}),er.zaxis||(er.zaxis={}),nt(er.xaxis,Zt),nt(er.yaxis,Zt),nt(er.zaxis,Zt),er._scene=null}}var dr=document.createElement("div");Ge.tileClass&&(dr.className=Ge.tileClass);var mr={gd:dr,td:dr,layout:dt,data:ot,config:{staticPlot:void 0===Ge.staticPlot||Ge.staticPlot,plotGlPixelRatio:void 0===Ge.plotGlPixelRatio?2:Ge.plotGlPixelRatio,displaylogo:Ge.displaylogo||!1,showLink:Ge.showLink||!1,showTips:Ge.showTips||!1,mapboxAccessToken:ht.mapboxAccessToken}};return"transparent"!==Ge.setBackground&&(mr.config.setBackground=Ge.setBackground||"opaque"),mr.gd.defaultLayout=cloneLayoutOverride(Ge.tileClass),mr}},{"../lib":778,"../registry":911}],913:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../lib"),rt=Ne("../plot_api/to_image"),nt=Ne("./filesaver"),at=Ne("./helpers");function downloadImage(Ne,Ge){var Qe;return tt.isPlainObject(Ne)||(Qe=tt.getGraphDiv(Ne)),(Ge=Ge||{}).format=Ge.format||"png",Ge.width=Ge.width||null,Ge.height=Ge.height||null,Ge.imageDataOnly=!0,new Promise((function(it,ot){Qe&&Qe._snapshotInProgress&&ot(new Error("Snapshotting already in progress.")),tt.isIE()&&"svg"!==Ge.format&&ot(new Error(at.MSG_IE_BAD_FORMAT)),Qe&&(Qe._snapshotInProgress=!0);var dt=rt(Ne,Ge),ht=Ge.filename||Ne.fn||"newplot";ht+="."+Ge.format.replace("-","."),dt.then((function(Ne){return Qe&&(Qe._snapshotInProgress=!1),nt(Ne,ht,Ge.format)})).then((function(Ne){it(Ne)})).catch((function(Ne){Qe&&(Qe._snapshotInProgress=!1),ot(Ne)}))}))}Ge.exports=downloadImage},{"../lib":778,"../plot_api/to_image":820,"./filesaver":914,"./helpers":915}],914:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../lib"),rt=Ne("./helpers");function fileSaver(Ne,Ge,Qe){var nt=document.createElement("a"),at="download"in nt;return new Promise((function(it,ot){var dt,ht;if(tt.isIE9orBelow()&&ot(new Error("IE < 10 unsupported")),tt.isSafari()){var Dt="svg"===Qe?",":";base64,";return rt.octetStream(Dt+encodeURIComponent(Ne)),it(Ge)}return tt.isIE()?(dt=rt.createBlob(Ne,"svg"),window.navigator.msSaveBlob(dt,Ge),dt=null,it(Ge)):at?(dt=rt.createBlob(Ne,Qe),ht=rt.createObjectURL(dt),nt.href=ht,nt.download=Ge,document.body.appendChild(nt),nt.click(),document.body.removeChild(nt),rt.revokeObjectURL(ht),dt=null,it(Ge)):void ot(new Error("download error"))}))}Ge.exports=fileSaver},{"../lib":778,"./helpers":915}],915:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../registry");Qe.getDelay=function(Ne){return Ne._has&&(Ne._has("gl3d")||Ne._has("gl2d")||Ne._has("mapbox"))?500:0},Qe.getRedrawFunc=function(Ne){return function(){var Ge=Ne._fullLayout||{};(!Ge._has||!Ge._has("polar"))&&Ne.data&&Ne.data[0]&&Ne.data[0].r||tt.getComponentMethod("colorbar","draw")(Ne)}},Qe.encodeSVG=function(Ne){return"data:image/svg+xml,"+encodeURIComponent(Ne)},Qe.encodeJSON=function(Ne){return"data:application/json,"+encodeURIComponent(Ne)};var rt=window.URL||window.webkitURL;function fixBinary(Ne){for(var Ge=Ne.length,Qe=new ArrayBuffer(Ge),tt=new Uint8Array(Qe),rt=0;rt<Ge;rt++)tt[rt]=Ne.charCodeAt(rt);return Qe}Qe.createObjectURL=function(Ne){return rt.createObjectURL(Ne)},Qe.revokeObjectURL=function(Ne){return rt.revokeObjectURL(Ne)},Qe.createBlob=function(Ne,Ge){if("svg"===Ge)return new window.Blob([Ne],{type:"image/svg+xml;charset=utf-8"});if("full-json"===Ge)return new window.Blob([Ne],{type:"application/json;charset=utf-8"});var Qe=fixBinary(window.atob(Ne));return new window.Blob([Qe],{type:"image/"+Ge})},Qe.octetStream=function(Ne){document.location.href="data:application/octet-stream"+Ne},Qe.IMAGE_URL_PREFIX=/^data:image\/\w+;base64,/,Qe.MSG_IE_BAD_FORMAT="Sorry IE does not support downloading from canvas. Try {format:'svg'} instead."},{"../registry":911}],916:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./helpers"),rt={getDelay:tt.getDelay,getRedrawFunc:tt.getRedrawFunc,clone:Ne("./cloneplot"),toSVG:Ne("./tosvg"),svgToImg:Ne("./svgtoimg"),toImage:Ne("./toimage"),downloadImage:Ne("./download")};Ge.exports=rt},{"./cloneplot":912,"./download":913,"./helpers":915,"./svgtoimg":917,"./toimage":918,"./tosvg":919}],917:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../lib"),rt=Ne("events").EventEmitter,nt=Ne("./helpers");function svgToImg(Ne){var Ge=Ne.emitter||new rt,Qe=new Promise((function(rt,at){var it=window.Image,ot=Ne.svg,dt=Ne.format||"png";if(tt.isIE()&&"svg"!==dt){var ht=new Error(nt.MSG_IE_BAD_FORMAT);return at(ht),Ne.promise?Qe:Ge.emit("error",ht)}var Dt,Ot,Rt=Ne.canvas,Zt=Ne.scale||1,er=Ne.width||300,dr=Ne.height||150,mr=Zt*er,xr=Zt*dr,br=Rt.getContext("2d"),Ar=new it;"svg"===dt||tt.isIE9orBelow()||tt.isSafari()?Ot=nt.encodeSVG(ot):(Dt=nt.createBlob(ot,"svg"),Ot=nt.createObjectURL(Dt)),Rt.width=mr,Rt.height=xr,Ar.onload=function(){var Qe;switch(Dt=null,nt.revokeObjectURL(Ot),"svg"!==dt&&br.drawImage(Ar,0,0,mr,xr),dt){case"jpeg":Qe=Rt.toDataURL("image/jpeg");break;case"png":Qe=Rt.toDataURL("image/png");break;case"webp":Qe=Rt.toDataURL("image/webp");break;case"svg":Qe=Ot;break;default:var tt="Image format is not jpeg, png, svg or webp.";if(at(new Error(tt)),!Ne.promise)return Ge.emit("error",tt)}rt(Qe),Ne.promise||Ge.emit("success",Qe)},Ar.onerror=function(Qe){if(Dt=null,nt.revokeObjectURL(Ot),at(Qe),!Ne.promise)return Ge.emit("error",Qe)},Ar.src=Ot}));return Ne.promise?Qe:Ge}Ge.exports=svgToImg},{"../lib":778,"./helpers":915,events:110}],918:[function(Ne,Ge,Qe){"use strict";var tt=Ne("events").EventEmitter,rt=Ne("../registry"),nt=Ne("../lib"),at=Ne("./helpers"),it=Ne("./cloneplot"),ot=Ne("./tosvg"),dt=Ne("./svgtoimg");function toImage(Ne,Ge){var Qe=new tt,ht=it(Ne,{format:"png"}),Dt=ht.gd;function wait(){var Ne=at.getDelay(Dt._fullLayout);setTimeout((function(){var Ne=ot(Dt),tt=document.createElement("canvas");tt.id=nt.randstr(),(Qe=dt({format:Ge.format,width:Dt._fullLayout.width,height:Dt._fullLayout.height,canvas:tt,emitter:Qe,svg:Ne})).clean=function(){Dt&&document.body.removeChild(Dt)}}),Ne)}Dt.style.position="absolute",Dt.style.left="-5000px",document.body.appendChild(Dt);var Ot=at.getRedrawFunc(Dt);return rt.call("plot",Dt,ht.data,ht.layout,ht.config).then(Ot).then(wait).catch((function(Ne){Qe.emit("error",Ne)})),Qe}Ge.exports=toImage},{"../lib":778,"../registry":911,"./cloneplot":912,"./helpers":915,"./svgtoimg":917,"./tosvg":919,events:110}],919:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../lib"),nt=Ne("../components/drawing"),at=Ne("../components/color"),it=Ne("../constants/xmlns_namespaces"),ot=/"/g,dt="TOBESTRIPPED",ht=new RegExp('("'+dt+")|("+dt+'")',"g");function htmlEntityDecode(Ne){var Ge=tt.select("body").append("div").style({display:"none"}).html(""),Qe=Ne.replace(/(&[^;]*;)/gi,(function(Ne){return"&lt;"===Ne?"&#60;":"&rt;"===Ne?"&#62;":-1!==Ne.indexOf("<")||-1!==Ne.indexOf(">")?"":Ge.html(Ne).text()}));return Ge.remove(),Qe}function xmlEntityEncode(Ne){return Ne.replace(/&(?!\w+;|\#[0-9]+;| \#x[0-9A-F]+;)/g,"&amp;")}Ge.exports=function(Ne,Ge,Qe){var Dt,Ot=Ne._fullLayout,Rt=Ot._paper,Zt=Ot._toppaper,er=Ot.width,dr=Ot.height;Rt.insert("rect",":first-child").call(nt.setRect,0,0,er,dr).call(at.fill,Ot.paper_bgcolor);var mr=Ot._basePlotModules||[];for(Dt=0;Dt<mr.length;Dt++){var xr=mr[Dt];xr.toSVG&&xr.toSVG(Ne)}if(Zt){var br=Zt.node().childNodes,Ar=Array.prototype.slice.call(br);for(Dt=0;Dt<Ar.length;Dt++){var en=Ar[Dt];en.childNodes.length&&Rt.node().appendChild(en)}}if(Ot._draggers&&Ot._draggers.remove(),Rt.node().style.background="",Rt.selectAll("text").attr({"data-unformatted":null,"data-math":null}).each((function(){var Ne=tt.select(this);if("hidden"!==this.style.visibility&&"none"!==this.style.display){Ne.style({visibility:null,display:null});var Ge=this.style.fontFamily;Ge&&-1!==Ge.indexOf('"')&&Ne.style("font-family",Ge.replace(ot,dt))}else Ne.remove()})),Ot._gradientUrlQueryParts){var mn=[];for(var xn in Ot._gradientUrlQueryParts)mn.push(xn);mn.length&&Rt.selectAll(mn.join(",")).each((function(){var Ne=tt.select(this),Ge=this.style.fill;Ge&&-1!==Ge.indexOf("url(")&&Ne.style("fill",Ge.replace(ot,dt));var Qe=this.style.stroke;Qe&&-1!==Qe.indexOf("url(")&&Ne.style("stroke",Qe.replace(ot,dt))}))}"pdf"!==Ge&&"eps"!==Ge||Rt.selectAll("#MathJax_SVG_glyphs path").attr("stroke-width",0),Rt.node().setAttributeNS(it.xmlns,"xmlns",it.svg),Rt.node().setAttributeNS(it.xmlns,"xmlns:xlink",it.xlink),"svg"===Ge&&Qe&&(Rt.attr("width",Qe*er),Rt.attr("height",Qe*dr),Rt.attr("viewBox","0 0 "+er+" "+dr));var kn=(new window.XMLSerializer).serializeToString(Rt.node());return kn=(kn=xmlEntityEncode(kn=htmlEntityDecode(kn))).replace(ht,"'"),rt.isIE()&&(kn=(kn=(kn=kn.replace(/"/gi,"'")).replace(/(\('#)([^']*)('\))/gi,'("#$2")')).replace(/(\\')/gi,'"')),kn}},{"../components/color":643,"../components/drawing":665,"../constants/xmlns_namespaces":754,"../lib":778,d3:169}],920:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib");Ge.exports=function(Ne,Ge){for(var Qe=0;Qe<Ne.length;Qe++)Ne[Qe].i=Qe;tt.mergeArray(Ge.text,Ne,"tx"),tt.mergeArray(Ge.hovertext,Ne,"htx");var rt=Ge.marker;if(rt){tt.mergeArray(rt.opacity,Ne,"mo",!0),tt.mergeArray(rt.color,Ne,"mc");var nt=rt.line;nt&&(tt.mergeArray(nt.color,Ne,"mlc"),tt.mergeArrayCastPositive(nt.width,Ne,"mlw"))}}},{"../../lib":778}],921:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../scatter/attributes"),rt=Ne("../../plots/template_attributes").hovertemplateAttrs,nt=Ne("../../plots/template_attributes").texttemplateAttrs,at=Ne("../../components/colorscale/attributes"),it=Ne("../../plots/font_attributes"),ot=Ne("./constants"),dt=Ne("../../lib/extend").extendFlat,ht=it({editType:"calc",arrayOk:!0,colorEditType:"style"}),Dt=dt({},tt.marker.line.width,{dflt:0}),Ot=dt({width:Dt,editType:"calc"},at("marker.line")),Rt=dt({line:Ot,editType:"calc"},at("marker"),{opacity:{valType:"number",arrayOk:!0,dflt:1,min:0,max:1,editType:"style"}});Ge.exports={x:tt.x,x0:tt.x0,dx:tt.dx,y:tt.y,y0:tt.y0,dy:tt.dy,xperiod:tt.xperiod,yperiod:tt.yperiod,xperiod0:tt.xperiod0,yperiod0:tt.yperiod0,xperiodalignment:tt.xperiodalignment,yperiodalignment:tt.yperiodalignment,text:tt.text,texttemplate:nt({editType:"plot"},{keys:ot.eventDataKeys}),hovertext:tt.hovertext,hovertemplate:rt({},{keys:ot.eventDataKeys}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"none",arrayOk:!0,editType:"calc"},insidetextanchor:{valType:"enumerated",values:["end","middle","start"],dflt:"end",editType:"plot"},textangle:{valType:"angle",dflt:"auto",editType:"plot"},textfont:dt({},ht,{}),insidetextfont:dt({},ht,{}),outsidetextfont:dt({},ht,{}),constraintext:{valType:"enumerated",values:["inside","outside","both","none"],dflt:"both",editType:"calc"},cliponaxis:dt({},tt.cliponaxis,{}),orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},base:{valType:"any",dflt:null,arrayOk:!0,editType:"calc"},offset:{valType:"number",dflt:null,arrayOk:!0,editType:"calc"},width:{valType:"number",dflt:null,min:0,arrayOk:!0,editType:"calc"},marker:Rt,offsetgroup:{valType:"string",dflt:"",editType:"calc"},alignmentgroup:{valType:"string",dflt:"",editType:"calc"},selected:{marker:{opacity:tt.selected.marker.opacity,color:tt.selected.marker.color,editType:"style"},textfont:tt.selected.textfont,editType:"style"},unselected:{marker:{opacity:tt.unselected.marker.opacity,color:tt.unselected.marker.color,editType:"style"},textfont:tt.unselected.textfont,editType:"style"},r:tt.r,t:tt.t,_deprecated:{bardir:{valType:"enumerated",editType:"calc",values:["v","h"]}}}},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/font_attributes":856,"../../plots/template_attributes":906,"../scatter/attributes":1187,"./constants":923}],922:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/cartesian/axes"),rt=Ne("../../plots/cartesian/align_period"),nt=Ne("../../components/colorscale/helpers").hasColorscale,at=Ne("../../components/colorscale/calc"),it=Ne("./arrays_to_calcdata"),ot=Ne("../scatter/calc_selection");Ge.exports=function(Ne,Ge){var Qe,dt,ht,Dt,Ot=tt.getFromId(Ne,Ge.xaxis||"x"),Rt=tt.getFromId(Ne,Ge.yaxis||"y"),Zt={msUTC:!(!Ge.base&&0!==Ge.base)};"h"===Ge.orientation?(Qe=Ot.makeCalcdata(Ge,"x",Zt),ht=Rt.makeCalcdata(Ge,"y"),dt=rt(Ge,Rt,"y",ht),Dt=!!Ge.yperiodalignment):(Qe=Rt.makeCalcdata(Ge,"y",Zt),ht=Ot.makeCalcdata(Ge,"x"),dt=rt(Ge,Ot,"x",ht),Dt=!!Ge.xperiodalignment);for(var er=Math.min(dt.length,Qe.length),dr=new Array(er),mr=0;mr<er;mr++)dr[mr]={p:dt[mr],s:Qe[mr]},Dt&&(dr[mr].orig_p=ht[mr]),Ge.ids&&(dr[mr].id=String(Ge.ids[mr]));return nt(Ge,"marker")&&at(Ne,Ge,{vals:Ge.marker.color,containerStr:"marker",cLetter:"c"}),nt(Ge,"marker.line")&&at(Ne,Ge,{vals:Ge.marker.line.color,containerStr:"marker.line",cLetter:"c"}),it(dr,Ge),ot(dr,Ge),dr}},{"../../components/colorscale/calc":651,"../../components/colorscale/helpers":654,"../../plots/cartesian/align_period":825,"../../plots/cartesian/axes":828,"../scatter/calc_selection":1189,"./arrays_to_calcdata":920}],923:[function(Ne,Ge,Qe){"use strict";Ge.exports={TEXTPAD:3,eventDataKeys:["value","label"]}},{}],924:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../lib").isArrayOrTypedArray,nt=Ne("../../constants/numerical").BADNUM,at=Ne("../../registry"),it=Ne("../../plots/cartesian/axes"),ot=Ne("../../plots/cartesian/constraints").getAxisGroup,dt=Ne("./sieve.js");function crossTraceCalc(Ne,Ge){for(var Qe=Ge.xaxis,tt=Ge.yaxis,rt=Ne._fullLayout,nt=Ne._fullData,it=Ne.calcdata,ot=[],dt=[],ht=0;ht<nt.length;ht++){var Dt=nt[ht];if(!0===Dt.visible&&at.traceIs(Dt,"bar")&&Dt.xaxis===Qe._id&&Dt.yaxis===tt._id&&("h"===Dt.orientation?ot.push(it[ht]):dt.push(it[ht]),Dt._computePh))for(var Ot=Ne.calcdata[ht],Rt=0;Rt<Ot.length;Rt++)"function"==typeof Ot[Rt].ph0&&(Ot[Rt].ph0=Ot[Rt].ph0()),"function"==typeof Ot[Rt].ph1&&(Ot[Rt].ph1=Ot[Rt].ph1())}var Zt={xCat:"category"===Qe.type||"multicategory"===Qe.type,yCat:"category"===tt.type||"multicategory"===tt.type,mode:rt.barmode,norm:rt.barnorm,gap:rt.bargap,groupgap:rt.bargroupgap};setGroupPositions(Ne,Qe,tt,dt,Zt),setGroupPositions(Ne,tt,Qe,ot,Zt)}function setGroupPositions(Ne,Ge,Qe,tt,rt){if(tt.length){var nt,at,it,ot;switch(initBase(Qe,tt),rt.mode){case"overlay":setGroupPositionsInOverlayMode(Ge,Qe,tt,rt);break;case"group":for(nt=[],at=[],it=0;it<tt.length;it++)void 0===(ot=tt[it])[0].trace.offset?at.push(ot):nt.push(ot);at.length&&setGroupPositionsInGroupMode(Ne,Ge,Qe,at,rt),nt.length&&setGroupPositionsInOverlayMode(Ge,Qe,nt,rt);break;case"stack":case"relative":for(nt=[],at=[],it=0;it<tt.length;it++)void 0===(ot=tt[it])[0].trace.base?at.push(ot):nt.push(ot);at.length&&setGroupPositionsInStackOrRelativeMode(Ne,Ge,Qe,at,rt),nt.length&&setGroupPositionsInOverlayMode(Ge,Qe,nt,rt)}collectExtents(tt,Ge)}}function initBase(Ne,Ge){var Qe,nt;for(Qe=0;Qe<Ge.length;Qe++){var at,it=Ge[Qe],ot=it[0].trace,dt="funnel"===ot.type?ot._base:ot.base,ht="h"===ot.orientation?ot.xcalendar:ot.ycalendar,Dt="category"===Ne.type||"multicategory"===Ne.type?function(){return null}:Ne.d2c;if(rt(dt)){for(nt=0;nt<Math.min(dt.length,it.length);nt++)at=Dt(dt[nt],0,ht),tt(at)?(it[nt].b=+at,it[nt].hasB=1):it[nt].b=0;for(;nt<it.length;nt++)it[nt].b=0}else{at=Dt(dt,0,ht);var Ot=tt(at);for(at=Ot?at:0,nt=0;nt<it.length;nt++)it[nt].b=at,Ot&&(it[nt].hasB=1)}}}function setGroupPositionsInOverlayMode(Ne,Ge,Qe,tt){for(var rt=0;rt<Qe.length;rt++){var nt=Qe[rt],at=new dt([nt],{unitMinDiff:tt.xCat||tt.yCat,sepNegVal:!1,overlapNoMerge:!tt.norm});setOffsetAndWidth(Ne,at,tt),tt.norm?(sieveBars(at),normalizeBars(Ge,at,tt)):setBaseAndTop(Ge,at)}}function setGroupPositionsInGroupMode(Ne,Ge,Qe,tt,rt){var nt=new dt(tt,{sepNegVal:!1,overlapNoMerge:!rt.norm});setOffsetAndWidthInGroupMode(Ne,Ge,nt,rt),unhideBarsWithinTrace(nt),rt.norm?(sieveBars(nt),normalizeBars(Qe,nt,rt)):setBaseAndTop(Qe,nt)}function setGroupPositionsInStackOrRelativeMode(Ne,Ge,Qe,tt,rt){var at=new dt(tt,{sepNegVal:"relative"===rt.mode,overlapNoMerge:!(rt.norm||"stack"===rt.mode||"relative"===rt.mode)});setOffsetAndWidth(Ge,at,rt),stackBars(Qe,at,rt);for(var it=0;it<tt.length;it++)for(var ot=tt[it],ht=0;ht<ot.length;ht++){var Dt=ot[ht];Dt.s!==nt&&Dt.b+Dt.s===at.get(Dt.p,Dt.s)&&(Dt._outmost=!0)}rt.norm&&normalizeBars(Qe,at,rt)}function setOffsetAndWidth(Ne,Ge,Qe){for(var tt=Ge.minDiff,rt=Ge.traces,nt=tt*(1-Qe.gap),at=nt*(1-(Qe.groupgap||0)),it=-at/2,ot=0;ot<rt.length;ot++){var dt=rt[ot][0].t;dt.barwidth=at,dt.poffset=it,dt.bargroupwidth=nt,dt.bardelta=tt}Ge.binWidth=rt[0][0].t.barwidth/100,applyAttributes(Ge),setBarCenterAndWidth(Ne,Ge),updatePositionAxis(Ne,Ge)}function setOffsetAndWidthInGroupMode(Ne,Ge,Qe,tt){for(var rt=Ne._fullLayout,nt=Qe.positions,at=Qe.distinctPositions,it=Qe.minDiff,dt=Qe.traces,ht=dt.length,Dt=nt.length!==at.length,Ot=it*(1-tt.gap),Rt=ot(rt,Ge._id)+dt[0][0].trace.orientation,Zt=rt._alignmentOpts[Rt]||{},er=0;er<ht;er++){var dr,mr,xr=dt[er],br=xr[0].trace,Ar=Zt[br.alignmentgroup]||{},en=Object.keys(Ar.offsetGroups||{}).length,mn=(dr=en?Ot/en:Dt?Ot/ht:Ot)*(1-(tt.groupgap||0));mr=en?((2*br._offsetIndex+1-en)*dr-mn)/2:Dt?((2*er+1-ht)*dr-mn)/2:-mn/2;var xn=xr[0].t;xn.barwidth=mn,xn.poffset=mr,xn.bargroupwidth=Ot,xn.bardelta=it}Qe.binWidth=dt[0][0].t.barwidth/100,applyAttributes(Qe),setBarCenterAndWidth(Ge,Qe),updatePositionAxis(Ge,Qe,Dt)}function applyAttributes(Ne){var Ge,Qe,nt=Ne.traces;for(Ge=0;Ge<nt.length;Ge++){var at,it=nt[Ge],ot=it[0],dt=ot.trace,ht=ot.t,Dt=dt._offset||dt.offset,Ot=ht.poffset;if(rt(Dt)){for(at=Array.prototype.slice.call(Dt,0,it.length),Qe=0;Qe<at.length;Qe++)tt(at[Qe])||(at[Qe]=Ot);for(Qe=at.length;Qe<it.length;Qe++)at.push(Ot);ht.poffset=at}else void 0!==Dt&&(ht.poffset=Dt);var Rt=dt._width||dt.width,Zt=ht.barwidth;if(rt(Rt)){var er=Array.prototype.slice.call(Rt,0,it.length);for(Qe=0;Qe<er.length;Qe++)tt(er[Qe])||(er[Qe]=Zt);for(Qe=er.length;Qe<it.length;Qe++)er.push(Zt);if(ht.barwidth=er,void 0===Dt){for(at=[],Qe=0;Qe<it.length;Qe++)at.push(Ot+(Zt-er[Qe])/2);ht.poffset=at}}else void 0!==Rt&&(ht.barwidth=Rt,void 0===Dt&&(ht.poffset=Ot+(Zt-Rt)/2))}}function setBarCenterAndWidth(Ne,Ge){for(var Qe=Ge.traces,tt=getAxisLetter(Ne),rt=0;rt<Qe.length;rt++)for(var nt=Qe[rt],at=nt[0].t,it=at.poffset,ot=Array.isArray(it),dt=at.barwidth,ht=Array.isArray(dt),Dt=0;Dt<nt.length;Dt++){var Ot=nt[Dt],Rt=Ot.w=ht?dt[Dt]:dt;Ot[tt]=Ot.p+(ot?it[Dt]:it)+Rt/2}}function updatePositionAxis(Ne,Ge,Qe){var tt=Ge.traces,rt=Ge.minDiff/2;it.minDtick(Ne,Ge.minDiff,Ge.distinctPositions[0],Qe);for(var nt=0;nt<tt.length;nt++){var at,ot,dt,ht,Dt=tt[nt],Ot=Dt[0],Rt=Ot.trace,Zt=[];for(ht=0;ht<Dt.length;ht++)ot=(at=Dt[ht]).p-rt,dt=at.p+rt,Zt.push(ot,dt);if(Rt.width||Rt.offset){var er=Ot.t,dr=er.poffset,mr=er.barwidth,xr=Array.isArray(dr),br=Array.isArray(mr);for(ht=0;ht<Dt.length;ht++){at=Dt[ht];var Ar=xr?dr[ht]:dr,en=br?mr[ht]:mr;dt=(ot=at.p+Ar)+en,Zt.push(ot,dt)}}Rt._extremes[Ne._id]=it.findExtremes(Ne,Zt,{padded:!1})}}function setBaseAndTop(Ne,Ge){for(var Qe=Ge.traces,tt=getAxisLetter(Ne),rt=0;rt<Qe.length;rt++){for(var nt=Qe[rt],at=nt[0].trace,ot=[],dt=!1,ht=0;ht<nt.length;ht++){var Dt=nt[ht],Ot=Dt.b,Rt=Ot+Dt.s;Dt[tt]=Rt,ot.push(Rt),Dt.hasB&&ot.push(Ot),Dt.hasB&&Dt.b||(dt=!0)}at._extremes[Ne._id]=it.findExtremes(Ne,ot,{tozero:dt,padded:!0})}}function stackBars(Ne,Ge,Qe){var tt,rt,at,ot,dt,ht,Dt=getAxisLetter(Ne),Ot=Ge.traces;for(ot=0;ot<Ot.length;ot++)if("funnel"===(rt=(tt=Ot[ot])[0].trace).type)for(dt=0;dt<tt.length;dt++)(ht=tt[dt]).s!==nt&&Ge.put(ht.p,-.5*ht.s);for(ot=0;ot<Ot.length;ot++){at="funnel"===(rt=(tt=Ot[ot])[0].trace).type;var Rt=[];for(dt=0;dt<tt.length;dt++)if((ht=tt[dt]).s!==nt){var Zt;Zt=at?ht.s:ht.s+ht.b;var er=Ge.put(ht.p,Zt),dr=er+Zt;ht.b=er,ht[Dt]=dr,Qe.norm||(Rt.push(dr),ht.hasB&&Rt.push(er))}Qe.norm||(rt._extremes[Ne._id]=it.findExtremes(Ne,Rt,{tozero:!0,padded:!0}))}}function sieveBars(Ne){for(var Ge=Ne.traces,Qe=0;Qe<Ge.length;Qe++)for(var tt=Ge[Qe],rt=0;rt<tt.length;rt++){var at=tt[rt];at.s!==nt&&Ne.put(at.p,at.b+at.s)}}function unhideBarsWithinTrace(Ne){for(var Ge=Ne.traces,Qe=0;Qe<Ge.length;Qe++){var tt=Ge[Qe];if(void 0===tt[0].trace.base)for(var rt=new dt([tt],{sepNegVal:!0,overlapNoMerge:!0}),at=0;at<tt.length;at++){var it=tt[at];if(it.p!==nt){var ot=rt.put(it.p,it.b+it.s);ot&&(it.b=ot)}}}}function normalizeBars(Ne,Ge,Qe){var rt=Ge.traces,at=getAxisLetter(Ne),ot="fraction"===Qe.norm?1:100,dt=ot/1e9,ht=Ne.l2c(Ne.c2l(0)),Dt="stack"===Qe.mode?ot:ht;function needsPadding(Ge){return tt(Ne.c2l(Ge))&&(Ge<ht-dt||Ge>Dt+dt||!tt(ht))}for(var Ot=0;Ot<rt.length;Ot++){for(var Rt=rt[Ot],Zt=Rt[0].trace,er=[],dr=!1,mr=!1,xr=0;xr<Rt.length;xr++){var br=Rt[xr];if(br.s!==nt){var Ar=Math.abs(ot/Ge.get(br.p,br.s));br.b*=Ar,br.s*=Ar;var en=br.b,mn=en+br.s;br[at]=mn,er.push(mn),mr=mr||needsPadding(mn),br.hasB&&(er.push(en),mr=mr||needsPadding(en)),br.hasB&&br.b||(dr=!0)}}Zt._extremes[Ne._id]=it.findExtremes(Ne,er,{tozero:dr,padded:mr})}}function collectExtents(Ne,Ge){var Qe,rt,nt,at=getAxisLetter(Ge),it={},ot=1/0,dt=-1/0;for(Qe=0;Qe<Ne.length;Qe++)for(nt=Ne[Qe],rt=0;rt<nt.length;rt++){var ht=nt[rt].p;tt(ht)&&(ot=Math.min(ot,ht),dt=Math.max(dt,ht))}var Dt=1e4/(dt-ot),Ot=it.round=function(Ne){return String(Math.round(Dt*(Ne-ot)))};for(Qe=0;Qe<Ne.length;Qe++){(nt=Ne[Qe])[0].t.extents=it;var Rt=nt[0].t.poffset,Zt=Array.isArray(Rt);for(rt=0;rt<nt.length;rt++){var er=nt[rt],dr=er[at]-er.w/2;if(tt(dr)){var mr=er[at]+er.w/2,xr=Ot(er.p);it[xr]?it[xr]=[Math.min(dr,it[xr][0]),Math.max(mr,it[xr][1])]:it[xr]=[dr,mr]}er.p0=er.p+(Zt?Rt[rt]:Rt),er.p1=er.p0+er.w,er.s0=er.b,er.s1=er.s0+er.s}}}function getAxisLetter(Ne){return Ne._id.charAt(0)}Ge.exports={crossTraceCalc:crossTraceCalc,setGroupPositions:setGroupPositions}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/axes":828,"../../plots/cartesian/constraints":835,"../../registry":911,"./sieve.js":934,"fast-isnumeric":241}],925:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../components/color"),nt=Ne("../../registry"),at=Ne("../scatter/xy_defaults"),it=Ne("../scatter/period_defaults"),ot=Ne("./style_defaults"),dt=Ne("../../plots/cartesian/constraints").getAxisGroup,ht=Ne("./attributes"),Dt=tt.coerceFont;function supplyDefaults(Ne,Ge,Qe,dt){function coerce(Qe,rt){return tt.coerce(Ne,Ge,ht,Qe,rt)}if(at(Ne,Ge,dt,coerce)){it(Ne,Ge,dt,coerce),coerce("orientation",Ge.x&&!Ge.y?"h":"v"),coerce("base"),coerce("offset"),coerce("width"),coerce("text"),coerce("hovertext"),coerce("hovertemplate");var Dt=coerce("textposition");handleText(Ne,Ge,dt,coerce,Dt,{moduleHasSelected:!0,moduleHasUnselected:!0,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),ot(Ne,Ge,coerce,Qe,dt);var Ot=(Ge.marker.line||{}).color,Rt=nt.getComponentMethod("errorbars","supplyDefaults");Rt(Ne,Ge,Ot||rt.defaultLine,{axis:"y"}),Rt(Ne,Ge,Ot||rt.defaultLine,{axis:"x",inherit:"y"}),tt.coerceSelectionMarkerOpacity(Ge,coerce)}else Ge.visible=!1}function handleGroupingDefaults(Ne,Ge,Qe,tt){var rt=Ge.orientation,nt=Ge[{v:"x",h:"y"}[rt]+"axis"],at=dt(Qe,nt)+rt,it=Qe._alignmentOpts||{},ot=tt("alignmentgroup"),ht=it[at];ht||(ht=it[at]={});var Dt=ht[ot];Dt?Dt.traces.push(Ge):Dt=ht[ot]={traces:[Ge],alignmentIndex:Object.keys(ht).length,offsetGroups:{}};var Ot=tt("offsetgroup"),Rt=Dt.offsetGroups,Zt=Rt[Ot];Ot&&(Zt||(Zt=Rt[Ot]={offsetIndex:Object.keys(Rt).length}),Ge._offsetIndex=Zt.offsetIndex)}function crossTraceDefaults(Ne,Ge){var Qe;function coerce(Ne){return tt.coerce(Qe._input,Qe,ht,Ne)}if("group"===Ge.barmode)for(var rt=0;rt<Ne.length;rt++)"bar"===(Qe=Ne[rt]).type&&handleGroupingDefaults(Qe._input,Qe,Ge,coerce)}function handleText(Ne,Ge,Qe,rt,nt,at){var it=!(!1===(at=at||{}).moduleHasSelected),ot=!(!1===at.moduleHasUnselected),dt=!(!1===at.moduleHasConstrain),ht=!(!1===at.moduleHasCliponaxis),Ot=!(!1===at.moduleHasTextangle),Rt=!(!1===at.moduleHasInsideanchor),Zt=!!at.hasPathbar,er=Array.isArray(nt)||"auto"===nt,dr=er||"inside"===nt,mr=er||"outside"===nt;if(dr||mr){var xr=Dt(rt,"textfont",Qe.font),br=tt.extendFlat({},xr),Ar=!(Ne.textfont&&Ne.textfont.color);if(Ar&&delete br.color,Dt(rt,"insidetextfont",br),Zt){var en=tt.extendFlat({},xr);Ar&&delete en.color,Dt(rt,"pathbar.textfont",en)}mr&&Dt(rt,"outsidetextfont",xr),it&&rt("selected.textfont.color"),ot&&rt("unselected.textfont.color"),dt&&rt("constraintext"),ht&&rt("cliponaxis"),Ot&&rt("textangle"),rt("texttemplate")}dr&&Rt&&rt("insidetextanchor")}Ge.exports={supplyDefaults:supplyDefaults,crossTraceDefaults:crossTraceDefaults,handleGroupingDefaults:handleGroupingDefaults,handleText:handleText}},{"../../components/color":643,"../../lib":778,"../../plots/cartesian/constraints":835,"../../registry":911,"../scatter/period_defaults":1207,"../scatter/xy_defaults":1214,"./attributes":921,"./style_defaults":936}],926:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge,Qe){return Ne.x="xVal"in Ge?Ge.xVal:Ge.x,Ne.y="yVal"in Ge?Ge.yVal:Ge.y,Ge.xa&&(Ne.xaxis=Ge.xa),Ge.ya&&(Ne.yaxis=Ge.ya),"h"===Qe.orientation?(Ne.label=Ne.y,Ne.value=Ne.x):(Ne.label=Ne.x,Ne.value=Ne.y),Ne}},{}],927:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("tinycolor2"),nt=Ne("../../lib").isArrayOrTypedArray;Qe.coerceString=function(Ne,Ge,Qe){if("string"==typeof Ge){if(Ge||!Ne.noBlank)return Ge}else if(("number"==typeof Ge||!0===Ge)&&!Ne.strict)return String(Ge);return void 0!==Qe?Qe:Ne.dflt},Qe.coerceNumber=function(Ne,Ge,Qe){if(tt(Ge)){Ge=+Ge;var rt=Ne.min,nt=Ne.max;if(!(void 0!==rt&&Ge<rt||void 0!==nt&&Ge>nt))return Ge}return void 0!==Qe?Qe:Ne.dflt},Qe.coerceColor=function(Ne,Ge,Qe){return rt(Ge).isValid()?Ge:void 0!==Qe?Qe:Ne.dflt},Qe.coerceEnumerated=function(Ne,Ge,Qe){return Ne.coerceNumber&&(Ge=+Ge),-1!==Ne.values.indexOf(Ge)?Ge:void 0!==Qe?Qe:Ne.dflt},Qe.getValue=function(Ne,Ge){var Qe;return Array.isArray(Ne)?Ge<Ne.length&&(Qe=Ne[Ge]):Qe=Ne,Qe},Qe.getLineWidth=function(Ne,Ge){return 0<Ge.mlw?Ge.mlw:nt(Ne.marker.line.width)?0:Ne.marker.line.width}},{"../../lib":778,"fast-isnumeric":241,tinycolor2:576}],928:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/fx"),rt=Ne("../../registry"),nt=Ne("../../components/color"),at=Ne("../../lib").fillText,it=Ne("./helpers").getLineWidth,ot=Ne("../../plots/cartesian/axes").hoverLabelText,dt=Ne("../../constants/numerical").BADNUM;function hoverPoints(Ne,Ge,Qe,tt){var nt=hoverOnBars(Ne,Ge,Qe,tt);if(nt){var at=nt.cd,it=at[0].trace,ot=at[nt.index];return nt.color=getTraceColor(it,ot),rt.getComponentMethod("errorbars","hoverInfo")(ot,it,nt),[nt]}}function hoverOnBars(Ne,Ge,Qe,rt){var nt,it,ht,Dt,Ot,Rt,Zt,er=Ne.cd,dr=er[0].trace,mr=er[0].t,xr="closest"===rt,br="waterfall"===dr.type,Ar=Ne.maxHoverDistance;function thisBarMinPos(Ne){return Ne[ht]-Ne.w/2}function thisBarMaxPos(Ne){return Ne[ht]+Ne.w/2}var en=xr?thisBarMinPos:function(Ne){return Math.min(thisBarMinPos(Ne),Ne.p-mr.bardelta/2)},mn=xr?thisBarMaxPos:function(Ne){return Math.max(thisBarMaxPos(Ne),Ne.p+mr.bardelta/2)};function _positionFn(Ne,Ge){return tt.inbox(Ne-nt,Ge-nt,Ar+Math.min(1,Math.abs(Ge-Ne)/Zt)-1)}function positionFn(Ne){return _positionFn(en(Ne),mn(Ne))}function thisBarPositionFn(Ne){return _positionFn(thisBarMinPos(Ne),thisBarMaxPos(Ne))}function sizeFn(Ne){var Ge=it,Qe=Ne.b,rt=Ne[Dt];if(br){var nt=Math.abs(Ne.rawS)||0;Ge>0?rt+=nt:Ge<0&&(rt-=nt)}return tt.inbox(Qe-Ge,rt-Ge,Ar+(rt-Ge)/(rt-Qe)-1)}"h"===dr.orientation?(nt=Qe,it=Ge,ht="y",Dt="x",Ot=sizeFn,Rt=positionFn):(nt=Ge,it=Qe,ht="x",Dt="y",Rt=sizeFn,Ot=positionFn);var xn=Ne[ht+"a"],kn=Ne[Dt+"a"];function dxy(Ne){return(Ot(Ne)+Rt(Ne))/2}Zt=Math.abs(xn.r2c(xn.range[1])-xn.r2c(xn.range[0]));var Cn=tt.getDistanceFunction(rt,Ot,Rt,dxy);if(tt.getClosest(er,Cn,Ne),!1!==Ne.index&&er[Ne.index].p!==dt){xr||(en=function(Ne){return Math.min(thisBarMinPos(Ne),Ne.p-mr.bargroupwidth/2)},mn=function(Ne){return Math.max(thisBarMaxPos(Ne),Ne.p+mr.bargroupwidth/2)});var En=er[Ne.index],Pn=dr.base?En.b+En.s:En.s;Ne[Dt+"0"]=Ne[Dt+"1"]=kn.c2p(En[Dt],!0),Ne[Dt+"LabelVal"]=Pn;var Dn=mr.extents[mr.extents.round(En.p)];Ne[ht+"0"]=xn.c2p(xr?en(En):Dn[0],!0),Ne[ht+"1"]=xn.c2p(xr?mn(En):Dn[1],!0);var In=void 0!==En.orig_p;return Ne[ht+"LabelVal"]=In?En.orig_p:En.p,Ne.labelLabel=ot(xn,Ne[ht+"LabelVal"]),Ne.valueLabel=ot(kn,Ne[Dt+"LabelVal"]),Ne.baseLabel=ot(kn,En.b),Ne.spikeDistance=(sizeFn(En)+thisBarPositionFn(En))/2-Ar,Ne[ht+"Spike"]=xn.c2p(En.p,!0),at(En,dr,Ne),Ne.hovertemplate=dr.hovertemplate,Ne}}function getTraceColor(Ne,Ge){var Qe=Ge.mcc||Ne.marker.color,tt=Ge.mlcc||Ne.marker.line.color,rt=it(Ne,Ge);return nt.opacity(Qe)?Qe:nt.opacity(tt)&&rt?tt:void 0}Ge.exports={hoverPoints:hoverPoints,hoverOnBars:hoverOnBars,getTraceColor:getTraceColor}},{"../../components/color":643,"../../components/fx":683,"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/axes":828,"../../registry":911,"./helpers":927}],929:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),layoutAttributes:Ne("./layout_attributes"),supplyDefaults:Ne("./defaults").supplyDefaults,crossTraceDefaults:Ne("./defaults").crossTraceDefaults,supplyLayoutDefaults:Ne("./layout_defaults"),calc:Ne("./calc"),crossTraceCalc:Ne("./cross_trace_calc").crossTraceCalc,colorbar:Ne("../scatter/marker_colorbar"),arraysToCalcdata:Ne("./arrays_to_calcdata"),plot:Ne("./plot").plot,style:Ne("./style").style,styleOnSelect:Ne("./style").styleOnSelect,hoverPoints:Ne("./hover").hoverPoints,eventData:Ne("./event_data"),selectPoints:Ne("./select"),moduleType:"trace",name:"bar",basePlotModule:Ne("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","oriented","errorBarsOK","showLegend","zoomScale"],animatable:!0,meta:{}}},{"../../plots/cartesian":841,"../scatter/marker_colorbar":1205,"./arrays_to_calcdata":920,"./attributes":921,"./calc":922,"./cross_trace_calc":924,"./defaults":925,"./event_data":926,"./hover":928,"./layout_attributes":930,"./layout_defaults":931,"./plot":932,"./select":933,"./style":935}],930:[function(Ne,Ge,Qe){"use strict";Ge.exports={barmode:{valType:"enumerated",values:["stack","group","overlay","relative"],dflt:"group",editType:"calc"},barnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},bargap:{valType:"number",min:0,max:1,editType:"calc"},bargroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],931:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../registry"),rt=Ne("../../plots/cartesian/axes"),nt=Ne("../../lib"),at=Ne("./layout_attributes");Ge.exports=function(Ne,Ge,Qe){function coerce(Qe,tt){return nt.coerce(Ne,Ge,at,Qe,tt)}for(var it=!1,ot=!1,dt=!1,ht={},Dt=coerce("barmode"),Ot=0;Ot<Qe.length;Ot++){var Rt=Qe[Ot];if(tt.traceIs(Rt,"bar")&&Rt.visible){if(it=!0,"group"===Dt){var Zt=Rt.xaxis+Rt.yaxis;ht[Zt]&&(dt=!0),ht[Zt]=!0}Rt.visible&&"histogram"===Rt.type&&"category"!==rt.getFromId({_fullLayout:Ge},Rt["v"===Rt.orientation?"xaxis":"yaxis"]).type&&(ot=!0)}}it?("overlay"!==Dt&&coerce("barnorm"),coerce("bargap",ot&&!dt?0:.2),coerce("bargroupgap")):delete Ge.barmode}},{"../../lib":778,"../../plots/cartesian/axes":828,"../../registry":911,"./layout_attributes":930}],932:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("fast-isnumeric"),nt=Ne("../../lib"),at=Ne("../../lib/svg_text_utils"),it=Ne("../../components/color"),ot=Ne("../../components/drawing"),dt=Ne("../../registry"),ht=Ne("../../plots/cartesian/axes").tickText,Dt=Ne("./uniform_text"),Ot=Dt.recordMinTextSize,Rt=Dt.clearMinTextSize,Zt=Ne("./style"),er=Ne("./helpers"),dr=Ne("./constants"),mr=Ne("./attributes"),xr=mr.text,br=mr.textposition,Ar=Ne("../../components/fx/helpers").appendArrayPointValue,en=dr.TEXTPAD;function keyFunc(Ne){return Ne.id}function getKeyFunc(Ne){if(Ne.ids)return keyFunc}function dirSign(Ne,Ge){return Ne<Ge?1:-1}function getXY(Ne,Ge,Qe,tt){var rt=[],nt=[],at=tt?Ge:Qe,it=tt?Qe:Ge;return rt[0]=at.c2p(Ne.s0,!0),nt[0]=it.c2p(Ne.p0,!0),rt[1]=at.c2p(Ne.s1,!0),nt[1]=it.c2p(Ne.p1,!0),tt?[rt,nt]:[nt,rt]}function transition(Ne,Ge,Qe,tt){var rt;return!Ge.uniformtext.mode&&hasTransition(Qe)?(tt&&(rt=tt()),Ne.transition().duration(Qe.duration).ease(Qe.easing).each("end",(function(){rt&&rt()})).each("interrupt",(function(){rt&&rt()}))):Ne}function hasTransition(Ne){return Ne&&Ne.duration>0}function plot(Ne,Ge,Qe,at,ht,Dt){var Ot=Ge.xaxis,Zt=Ge.yaxis,dr=Ne._fullLayout;ht||(ht={mode:dr.barmode,norm:dr.barmode,gap:dr.bargap,groupgap:dr.bargroupgap},Rt("bar",dr));var mr=nt.makeTraceGroups(at,Qe,"trace bars").each((function(Qe){var at=tt.select(this),dt=Qe[0].trace,Rt="waterfall"===dt.type,mr="funnel"===dt.type,xr="bar"===dt.type||mr,br=0;Rt&&dt.connector.visible&&"between"===dt.connector.mode&&(br=dt.connector.line.width/2);var Ar="h"===dt.orientation,en=hasTransition(ht),mn=nt.ensureSingle(at,"g","points"),xn=getKeyFunc(dt),kn=mn.selectAll("g.point").data(nt.identity,xn);kn.enter().append("g").classed("point",!0),kn.exit().remove(),kn.each((function(at,Rt){var mr,mn,xn=tt.select(this),kn=getXY(at,Ot,Zt,Ar),Cn=kn[0][0],En=kn[0][1],Pn=kn[1][0],Dn=kn[1][1],In=0==(Ar?En-Cn:Dn-Pn);if(In&&xr&&er.getLineWidth(dt,at)&&(In=!1),In||(In=!(rt(Cn)&&rt(En)&&rt(Pn)&&rt(Dn))),at.isBlank=In,In&&(Ar?En=Cn:Dn=Pn),br&&!In&&(Ar?(Cn-=dirSign(Cn,En)*br,En+=dirSign(Cn,En)*br):(Pn-=dirSign(Pn,Dn)*br,Dn+=dirSign(Pn,Dn)*br)),"waterfall"===dt.type){if(!In){var zn=dt[at.dir].marker;mr=zn.line.width,mn=zn.color}}else mr=er.getLineWidth(dt,at),mn=at.mc||dt.marker.color;function roundWithLine(Ne){var Ge=tt.round(mr/2%1,2);return 0===ht.gap&&0===ht.groupgap?tt.round(Math.round(Ne)-Ge,2):Ne}function expandToVisible(Ne,Ge,Qe){return Qe&&Ne===Ge?Ne:Math.abs(Ne-Ge)>=2?roundWithLine(Ne):Ne>Ge?Math.ceil(Ne):Math.floor(Ne)}if(!Ne._context.staticPlot){var Bn=it.opacity(mn)<1||mr>.01?roundWithLine:expandToVisible;Cn=Bn(Cn,En,Ar),En=Bn(En,Cn,Ar),Pn=Bn(Pn,Dn,!Ar),Dn=Bn(Dn,Pn,!Ar)}var Vn=transition(nt.ensureSingle(xn,"path"),dr,ht,Dt);if(Vn.style("vector-effect","non-scaling-stroke").attr("d",isNaN((En-Cn)*(Dn-Pn))||In&&Ne._context.staticPlot?"M0,0Z":"M"+Cn+","+Pn+"V"+Dn+"H"+En+"V"+Pn+"Z").call(ot.setClipUrl,Ge.layerClipId,Ne),!dr.uniformtext.mode&&en){var Hn=ot.makePointStyleFns(dt);ot.singlePointStyle(at,Vn,dt,Hn,Ne)}appendBarText(Ne,Ge,xn,Qe,Rt,Cn,En,Pn,Dn,ht,Dt),Ge.layerClipId&&ot.hideOutsideRangePoint(at,xn.select("text"),Ot,Zt,dt.xcalendar,dt.ycalendar)}));var Cn=!1===dt.cliponaxis;ot.setClipUrl(at,Cn?null:Ge.layerClipId,Ne)}));dt.getComponentMethod("errorbars","plot")(Ne,mr,Ge,ht)}function appendBarText(Ne,Ge,Qe,tt,rt,it,dt,ht,Dt,Rt,er){var dr,mr=Ge.xaxis,xr=Ge.yaxis,br=Ne._fullLayout;function appendTextNode(Ge,Qe,tt){return nt.ensureSingle(Ge,"text").text(Qe).attr({class:"bartext bartext-"+dr,"text-anchor":"middle","data-notex":1}).call(ot.font,tt).call(at.convertToTspans,Ne)}var Ar=tt[0].trace,mn="h"===Ar.orientation,xn=getText(br,tt,rt,mr,xr);dr=getTextPosition(Ar,rt);var kn="stack"===Rt.mode||"relative"===Rt.mode,Cn=tt[rt],En=!kn||Cn._outmost;if(xn&&"none"!==dr&&(!Cn.isBlank&&it!==dt&&ht!==Dt||"auto"!==dr&&"inside"!==dr)){var Pn=br.font,Dn=Zt.getBarColor(tt[rt],Ar),In=Zt.getInsideTextFont(Ar,rt,Pn,Dn),zn=Zt.getOutsideTextFont(Ar,rt,Pn),Bn=Qe.datum();mn?"log"===mr.type&&Bn.s0<=0&&(it=mr.range[0]<mr.range[1]?0:mr._length):"log"===xr.type&&Bn.s0<=0&&(ht=xr.range[0]<xr.range[1]?xr._length:0);var Vn,Hn,qn,Yn,$n,ra=Math.abs(dt-it)-2*en,oa=Math.abs(Dt-ht)-2*en;if("outside"===dr&&(En||Cn.hasB||(dr="inside")),"auto"===dr&&(En?(dr="inside",Vn=appendTextNode(Qe,xn,$n=nt.ensureUniformFontSize(Ne,In)),qn=(Hn=ot.bBox(Vn.node())).width,Yn=Hn.height,qn>0&&Yn>0&&(qn<=ra&&Yn<=oa||qn<=oa&&Yn<=ra||(mn?ra>=qn*(oa/Yn):oa>=Yn*(ra/qn)))?dr="inside":(dr="outside",Vn.remove(),Vn=null)):dr="inside"),!Vn){var pa=(Vn=appendTextNode(Qe,xn,$n=nt.ensureUniformFontSize(Ne,"outside"===dr?zn:In))).attr("transform");if(Vn.attr("transform",""),qn=(Hn=ot.bBox(Vn.node())).width,Yn=Hn.height,Vn.attr("transform",pa),qn<=0||Yn<=0)return void Vn.remove()}var ga,ma=Ar.textangle;(ga="outside"===dr?toMoveOutsideBar(it,dt,ht,Dt,Hn,{isHorizontal:mn,constrained:"both"===Ar.constraintext||"outside"===Ar.constraintext,angle:ma}):toMoveInsideBar(it,dt,ht,Dt,Hn,{isHorizontal:mn,constrained:"both"===Ar.constraintext||"inside"===Ar.constraintext,angle:ma,anchor:Ar.insidetextanchor})).fontSize=$n.size,Ot(Ar.type,ga,br),Cn.transform=ga,transition(Vn,br,Rt,er).attr("transform",nt.getTextTransform(ga))}else Qe.select("text").remove()}function getRotateFromAngle(Ne){return"auto"===Ne?0:Ne}function getRotatedTextSize(Ne,Ge){var Qe=Math.PI/180*Ge,tt=Math.abs(Math.sin(Qe)),rt=Math.abs(Math.cos(Qe));return{x:Ne.width*rt+Ne.height*tt,y:Ne.width*tt+Ne.height*rt}}function toMoveInsideBar(Ne,Ge,Qe,tt,rt,nt){var at=!!nt.isHorizontal,it=!!nt.constrained,ot=nt.angle||0,dt=nt.anchor||"end",ht="end"===dt,Dt="start"===dt,Ot=((nt.leftToRight||0)+1)/2,Rt=1-Ot,Zt=rt.width,er=rt.height,dr=Math.abs(Ge-Ne),mr=Math.abs(tt-Qe),xr=dr>2*en&&mr>2*en?en:0;dr-=2*xr,mr-=2*xr;var br=getRotateFromAngle(ot);"auto"!==ot||Zt<=dr&&er<=mr||!(Zt>dr||er>mr)||(Zt>mr||er>dr)&&Zt<er==dr<mr||(br+=90);var Ar=getRotatedTextSize(rt,br),mn=1;it&&(mn=Math.min(1,dr/Ar.x,mr/Ar.y));var xn=rt.left*Rt+rt.right*Ot,kn=(rt.top+rt.bottom)/2,Cn=(Ne+en)*Rt+(Ge-en)*Ot,En=(Qe+tt)/2,Pn=0,Dn=0;if(Dt||ht){var In=(at?Ar.x:Ar.y)/2,zn=at?dirSign(Ne,Ge):dirSign(Qe,tt);at?Dt?(Cn=Ne+zn*xr,Pn=-zn*In):(Cn=Ge-zn*xr,Pn=zn*In):Dt?(En=Qe+zn*xr,Dn=-zn*In):(En=tt-zn*xr,Dn=zn*In)}return{textX:xn,textY:kn,targetX:Cn,targetY:En,anchorX:Pn,anchorY:Dn,scale:mn,rotate:br}}function toMoveOutsideBar(Ne,Ge,Qe,tt,rt,nt){var at,it=!!nt.isHorizontal,ot=!!nt.constrained,dt=nt.angle||0,ht=rt.width,Dt=rt.height,Ot=Math.abs(Ge-Ne),Rt=Math.abs(tt-Qe);at=it?Rt>2*en?en:0:Ot>2*en?en:0;var Zt=1;ot&&(Zt=it?Math.min(1,Rt/Dt):Math.min(1,Ot/ht));var er=getRotateFromAngle(dt),dr=getRotatedTextSize(rt,er),mr=(it?dr.x:dr.y)/2,xr=(rt.left+rt.right)/2,br=(rt.top+rt.bottom)/2,Ar=(Ne+Ge)/2,mn=(Qe+tt)/2,xn=0,kn=0,Cn=it?dirSign(Ge,Ne):dirSign(Qe,tt);return it?(Ar=Ge-Cn*at,xn=Cn*mr):(mn=tt+Cn*at,kn=-Cn*mr),{textX:xr,textY:br,targetX:Ar,targetY:mn,anchorX:xn,anchorY:kn,scale:Zt,rotate:er}}function getText(Ne,Ge,Qe,tt,rt){var nt,at=Ge[0].trace;return nt=at.texttemplate?calcTexttemplate(Ne,Ge,Qe,tt,rt):at.textinfo?calcTextinfo(Ge,Qe,tt,rt):er.getValue(at.text,Qe),er.coerceString(xr,nt)}function getTextPosition(Ne,Ge){var Qe=er.getValue(Ne.textposition,Ge);return er.coerceEnumerated(br,Qe)}function calcTexttemplate(Ne,Ge,Qe,tt,rt){var at=Ge[0].trace,it=nt.castOption(at,Qe,"texttemplate");if(!it)return"";var ot,dt,Dt,Ot,Rt="waterfall"===at.type,Zt="funnel"===at.type;function formatLabel(Ne){return ht(dt,Ne,!0).text}function formatNumber(Ne){return ht(Ot,+Ne,!0).text}"h"===at.orientation?(ot="y",dt=rt,Dt="x",Ot=tt):(ot="x",dt=tt,Dt="y",Ot=rt);var er=Ge[Qe],dr={};dr.label=er.p,dr.labelLabel=dr[ot+"Label"]=formatLabel(er.p);var mr=nt.castOption(at,er.i,"text");(0===mr||mr)&&(dr.text=mr),dr.value=er.s,dr.valueLabel=dr[Dt+"Label"]=formatNumber(er.s);var xr={};Ar(xr,at,er.i),Rt&&(dr.delta=+er.rawS||er.s,dr.deltaLabel=formatNumber(dr.delta),dr.final=er.v,dr.finalLabel=formatNumber(dr.final),dr.initial=dr.final-dr.delta,dr.initialLabel=formatNumber(dr.initial)),Zt&&(dr.value=er.s,dr.valueLabel=formatNumber(dr.value),dr.percentInitial=er.begR,dr.percentInitialLabel=nt.formatPercent(er.begR),dr.percentPrevious=er.difR,dr.percentPreviousLabel=nt.formatPercent(er.difR),dr.percentTotal=er.sumR,dr.percenTotalLabel=nt.formatPercent(er.sumR));var br=nt.castOption(at,er.i,"customdata");return br&&(dr.customdata=br),nt.texttemplateString(it,dr,Ne._d3locale,xr,dr,at._meta||{})}function calcTextinfo(Ne,Ge,Qe,tt){var rt=Ne[0].trace,at="h"===rt.orientation,it="waterfall"===rt.type,ot="funnel"===rt.type;function formatLabel(Ne){return ht(at?tt:Qe,Ne,!0).text}function formatNumber(Ne){return ht(at?Qe:tt,+Ne,!0).text}var dt,Dt=rt.textinfo,Ot=Ne[Ge],Rt=Dt.split("+"),Zt=[],hasFlag=function(Ne){return-1!==Rt.indexOf(Ne)};if(hasFlag("label")&&Zt.push(formatLabel(Ne[Ge].p)),hasFlag("text")&&(0===(dt=nt.castOption(rt,Ot.i,"text"))||dt)&&Zt.push(dt),it){var er=+Ot.rawS||Ot.s,dr=Ot.v,mr=dr-er;hasFlag("initial")&&Zt.push(formatNumber(mr)),hasFlag("delta")&&Zt.push(formatNumber(er)),hasFlag("final")&&Zt.push(formatNumber(dr))}if(ot){hasFlag("value")&&Zt.push(formatNumber(Ot.s));var xr=0;hasFlag("percent initial")&&xr++,hasFlag("percent previous")&&xr++,hasFlag("percent total")&&xr++;var br=xr>1;hasFlag("percent initial")&&(dt=nt.formatPercent(Ot.begR),br&&(dt+=" of initial"),Zt.push(dt)),hasFlag("percent previous")&&(dt=nt.formatPercent(Ot.difR),br&&(dt+=" of previous"),Zt.push(dt)),hasFlag("percent total")&&(dt=nt.formatPercent(Ot.sumR),br&&(dt+=" of total"),Zt.push(dt))}return Zt.join("<br>")}Ge.exports={plot:plot,toMoveInsideBar:toMoveInsideBar}},{"../../components/color":643,"../../components/drawing":665,"../../components/fx/helpers":679,"../../lib":778,"../../lib/svg_text_utils":803,"../../plots/cartesian/axes":828,"../../registry":911,"./attributes":921,"./constants":923,"./helpers":927,"./style":935,"./uniform_text":937,d3:169,"fast-isnumeric":241}],933:[function(Ne,Ge,Qe){"use strict";function getCentroid(Ne,Ge,Qe,tt,rt){var nt=Ge.c2p(tt?Ne.s0:Ne.p0,!0),at=Ge.c2p(tt?Ne.s1:Ne.p1,!0),it=Qe.c2p(tt?Ne.p0:Ne.s0,!0),ot=Qe.c2p(tt?Ne.p1:Ne.s1,!0);return rt?[(nt+at)/2,(it+ot)/2]:tt?[at,(it+ot)/2]:[(nt+at)/2,ot]}Ge.exports=function(Ne,Ge){var Qe,tt=Ne.cd,rt=Ne.xaxis,nt=Ne.yaxis,at=tt[0].trace,it="funnel"===at.type,ot="h"===at.orientation,dt=[];if(!1===Ge)for(Qe=0;Qe<tt.length;Qe++)tt[Qe].selected=0;else for(Qe=0;Qe<tt.length;Qe++){var ht=tt[Qe],Dt="ct"in ht?ht.ct:getCentroid(ht,rt,nt,ot,it);Ge.contains(Dt,!1,Qe,Ne)?(dt.push({pointNumber:Qe,x:rt.c2d(ht.x),y:nt.c2d(ht.y)}),ht.selected=1):ht.selected=0}return dt}},{}],934:[function(Ne,Ge,Qe){"use strict";Ge.exports=Sieve;var tt=Ne("../../lib").distinctVals,rt=Ne("../../constants/numerical").BADNUM;function Sieve(Ne,Ge){this.traces=Ne,this.sepNegVal=Ge.sepNegVal,this.overlapNoMerge=Ge.overlapNoMerge;for(var Qe=1/0,nt=[],at=0;at<Ne.length;at++){for(var it=Ne[at],ot=0;ot<it.length;ot++){var dt=it[ot];dt.p!==rt&&nt.push(dt.p)}it[0]&&it[0].width1&&(Qe=Math.min(it[0].width1,Qe))}this.positions=nt;var ht=tt(nt,{unitMinDiff:Ge.unitMinDiff});this.distinctPositions=ht.vals,1===ht.vals.length&&Qe!==1/0?this.minDiff=Qe:this.minDiff=Math.min(ht.minDiff,Qe),this.binWidth=this.minDiff,this.bins={}}Sieve.prototype.put=function(Ne,Ge){var Qe=this.getLabel(Ne,Ge),tt=this.bins[Qe]||0;return this.bins[Qe]=tt+Ge,tt},Sieve.prototype.get=function(Ne,Ge){var Qe=this.getLabel(Ne,Ge);return this.bins[Qe]||0},Sieve.prototype.getLabel=function(Ne,Ge){return(Ge<0&&this.sepNegVal?"v":"^")+(this.overlapNoMerge?Ne:Math.round(Ne/this.binWidth))}},{"../../constants/numerical":753,"../../lib":778}],935:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../components/color"),nt=Ne("../../components/drawing"),at=Ne("../../lib"),it=Ne("../../registry"),ot=Ne("./uniform_text").resizeText,dt=Ne("./attributes"),ht=dt.textfont,Dt=dt.insidetextfont,Ot=dt.outsidetextfont,Rt=Ne("./helpers");function style(Ne){var Ge=tt.select(Ne).selectAll("g.barlayer").selectAll("g.trace");ot(Ne,Ge,"bar");var Qe=Ge.size(),rt=Ne._fullLayout;Ge.style("opacity",(function(Ne){return Ne[0].trace.opacity})).each((function(Ne){("stack"===rt.barmode&&Qe>1||0===rt.bargap&&0===rt.bargroupgap&&!Ne[0].trace.marker.line.width)&&tt.select(this).attr("shape-rendering","crispEdges")})),Ge.selectAll("g.points").each((function(Ge){stylePoints(tt.select(this),Ge[0].trace,Ne)})),it.getComponentMethod("errorbars","style")(Ge)}function stylePoints(Ne,Ge,Qe){nt.pointStyle(Ne.selectAll("path"),Ge,Qe),styleTextPoints(Ne,Ge,Qe)}function styleTextPoints(Ne,Ge,Qe){Ne.selectAll("text").each((function(Ne){var rt=tt.select(this),it=at.ensureUniformFontSize(Qe,determineFont(rt,Ne,Ge,Qe));nt.font(rt,it)}))}function styleOnSelect(Ne,Ge,Qe){var tt=Ge[0].trace;tt.selectedpoints?stylePointsInSelectionMode(Qe,tt,Ne):(stylePoints(Qe,tt,Ne),it.getComponentMethod("errorbars","style")(Qe))}function stylePointsInSelectionMode(Ne,Ge,Qe){nt.selectedPointStyle(Ne.selectAll("path"),Ge),styleTextInSelectionMode(Ne.selectAll("text"),Ge,Qe)}function styleTextInSelectionMode(Ne,Ge,Qe){Ne.each((function(Ne){var rt,it=tt.select(this);if(Ne.selected){rt=at.ensureUniformFontSize(Qe,determineFont(it,Ne,Ge,Qe));var ot=Ge.selected.textfont&&Ge.selected.textfont.color;ot&&(rt.color=ot),nt.font(it,rt)}else nt.selectedTextStyle(it,Ge)}))}function determineFont(Ne,Ge,Qe,tt){var rt=tt._fullLayout.font,nt=Qe.textfont;if(Ne.classed("bartext-inside")){var at=getBarColor(Ge,Qe);nt=getInsideTextFont(Qe,Ge.i,rt,at)}else Ne.classed("bartext-outside")&&(nt=getOutsideTextFont(Qe,Ge.i,rt));return nt}function getTextFont(Ne,Ge,Qe){return getFontValue(ht,Ne.textfont,Ge,Qe)}function getInsideTextFont(Ne,Ge,Qe,tt){var nt=getTextFont(Ne,Ge,Qe);return(void 0===Ne._input.textfont||void 0===Ne._input.textfont.color||Array.isArray(Ne.textfont.color)&&void 0===Ne.textfont.color[Ge])&&(nt={color:rt.contrast(tt),family:nt.family,size:nt.size}),getFontValue(Dt,Ne.insidetextfont,Ge,nt)}function getOutsideTextFont(Ne,Ge,Qe){var tt=getTextFont(Ne,Ge,Qe);return getFontValue(Ot,Ne.outsidetextfont,Ge,tt)}function getFontValue(Ne,Ge,Qe,tt){Ge=Ge||{};var rt=Rt.getValue(Ge.family,Qe),nt=Rt.getValue(Ge.size,Qe),at=Rt.getValue(Ge.color,Qe);return{family:Rt.coerceString(Ne.family,rt,tt.family),size:Rt.coerceNumber(Ne.size,nt,tt.size),color:Rt.coerceColor(Ne.color,at,tt.color)}}function getBarColor(Ne,Ge){return"waterfall"===Ge.type?Ge[Ne.dir].marker.color:Ne.mc||Ge.marker.color}Ge.exports={style:style,styleTextPoints:styleTextPoints,styleOnSelect:styleOnSelect,getInsideTextFont:getInsideTextFont,getOutsideTextFont:getOutsideTextFont,getBarColor:getBarColor,resizeText:ot}},{"../../components/color":643,"../../components/drawing":665,"../../lib":778,"../../registry":911,"./attributes":921,"./helpers":927,"./uniform_text":937,d3:169}],936:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/color"),rt=Ne("../../components/colorscale/helpers").hasColorscale,nt=Ne("../../components/colorscale/defaults");Ge.exports=function(Ne,Ge,Qe,at,it){Qe("marker.color",at),rt(Ne,"marker")&&nt(Ne,Ge,it,Qe,{prefix:"marker.",cLetter:"c"}),Qe("marker.line.color",tt.defaultLine),rt(Ne,"marker.line")&&nt(Ne,Ge,it,Qe,{prefix:"marker.line.",cLetter:"c"}),Qe("marker.line.width"),Qe("marker.opacity"),Qe("selected.marker.color"),Qe("unselected.marker.color")}},{"../../components/color":643,"../../components/colorscale/defaults":653,"../../components/colorscale/helpers":654}],937:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../lib");function resizeText(Ne,Ge,Qe){var nt=Ne._fullLayout,at=nt["_"+Qe+"Text_minsize"];if(at){var it,ot="hide"===nt.uniformtext.mode;switch(Qe){case"funnelarea":case"pie":case"sunburst":it="g.slice";break;case"treemap":it="g.slice, g.pathbar";break;default:it="g.points > g.point"}Ge.selectAll(it).each((function(Ne){var Ge=Ne.transform;Ge&&(Ge.scale=ot&&Ge.hide?0:at/Ge.fontSize,tt.select(this).select("text").attr("transform",rt.getTextTransform(Ge)))}))}}function recordMinTextSize(Ne,Ge,Qe){if(Qe.uniformtext.mode){var tt=getMinKey(Ne),rt=Qe.uniformtext.minsize,nt=Ge.scale*Ge.fontSize;Ge.hide=nt<rt,Qe[tt]=Qe[tt]||1/0,Ge.hide||(Qe[tt]=Math.min(Qe[tt],Math.max(nt,rt)))}}function clearMinTextSize(Ne,Ge){Ge[getMinKey(Ne)]=void 0}function getMinKey(Ne){return"_"+Ne+"Text_minsize"}Ge.exports={recordMinTextSize:recordMinTextSize,clearMinTextSize:clearMinTextSize,resizeText:resizeText}},{"../../lib":778,d3:169}],938:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/template_attributes").hovertemplateAttrs,rt=Ne("../../lib/extend").extendFlat,nt=Ne("../scatterpolar/attributes"),at=Ne("../bar/attributes");Ge.exports={r:nt.r,theta:nt.theta,r0:nt.r0,dr:nt.dr,theta0:nt.theta0,dtheta:nt.dtheta,thetaunit:nt.thetaunit,base:rt({},at.base,{}),offset:rt({},at.offset,{}),width:rt({},at.width,{}),text:rt({},at.text,{}),hovertext:rt({},at.hovertext,{}),marker:at.marker,hoverinfo:nt.hoverinfo,hovertemplate:tt(),selected:at.selected,unselected:at.unselected}},{"../../lib/extend":768,"../../plots/template_attributes":906,"../bar/attributes":921,"../scatterpolar/attributes":1261}],939:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/colorscale/helpers").hasColorscale,rt=Ne("../../components/colorscale/calc"),nt=Ne("../bar/arrays_to_calcdata"),at=Ne("../bar/cross_trace_calc").setGroupPositions,it=Ne("../scatter/calc_selection"),ot=Ne("../../registry").traceIs,dt=Ne("../../lib").extendFlat;function calc(Ne,Ge){for(var Qe=Ne._fullLayout,at=Ge.subplot,ot=Qe[at].radialaxis,dt=Qe[at].angularaxis,ht=ot.makeCalcdata(Ge,"r"),Dt=dt.makeCalcdata(Ge,"theta"),Ot=Ge._length,Rt=new Array(Ot),Zt=ht,er=Dt,dr=0;dr<Ot;dr++)Rt[dr]={p:er[dr],s:Zt[dr]};function d2c(Ne){var Qe=Ge[Ne];void 0!==Qe&&(Ge["_"+Ne]=Array.isArray(Qe)?dt.makeCalcdata(Ge,Ne):dt.d2c(Qe,Ge.thetaunit))}return"linear"===dt.type&&(d2c("width"),d2c("offset")),tt(Ge,"marker")&&rt(Ne,Ge,{vals:Ge.marker.color,containerStr:"marker",cLetter:"c"}),tt(Ge,"marker.line")&&rt(Ne,Ge,{vals:Ge.marker.line.color,containerStr:"marker.line",cLetter:"c"}),nt(Rt,Ge),it(Rt,Ge),Rt}function crossTraceCalc(Ne,Ge,Qe){for(var tt=Ne.calcdata,rt=[],nt=0;nt<tt.length;nt++){var it=tt[nt],ht=it[0].trace;!0===ht.visible&&ot(ht,"bar")&&ht.subplot===Qe&&rt.push(it)}var Dt=dt({},Ge.radialaxis,{_id:"x"}),Ot=Ge.angularaxis;at(Ne,Ot,Dt,rt,{mode:Ge.barmode,norm:Ge.barnorm,gap:Ge.bargap,groupgap:Ge.bargroupgap})}Ge.exports={calc:calc,crossTraceCalc:crossTraceCalc}},{"../../components/colorscale/calc":651,"../../components/colorscale/helpers":654,"../../lib":778,"../../registry":911,"../bar/arrays_to_calcdata":920,"../bar/cross_trace_calc":924,"../scatter/calc_selection":1189}],940:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../scatterpolar/defaults").handleRThetaDefaults,nt=Ne("../bar/style_defaults"),at=Ne("./attributes");Ge.exports=function(Ne,Ge,Qe,it){function coerce(Qe,rt){return tt.coerce(Ne,Ge,at,Qe,rt)}rt(Ne,Ge,it,coerce)?(coerce("thetaunit"),coerce("base"),coerce("offset"),coerce("width"),coerce("text"),coerce("hovertext"),coerce("hovertemplate"),nt(Ne,Ge,coerce,Qe,it),tt.coerceSelectionMarkerOpacity(Ge,coerce)):Ge.visible=!1}},{"../../lib":778,"../bar/style_defaults":936,"../scatterpolar/defaults":1263,"./attributes":938}],941:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/fx"),rt=Ne("../../lib"),nt=Ne("../bar/hover").getTraceColor,at=rt.fillText,it=Ne("../scatterpolar/hover").makeHoverPointText,ot=Ne("../../plots/polar/helpers").isPtInsidePolygon;Ge.exports=function(Ne,Ge,Qe){var dt=Ne.cd,ht=dt[0].trace,Dt=Ne.subplot,Ot=Dt.radialAxis,Rt=Dt.angularAxis,Zt=Dt.vangles,er=Zt?ot:rt.isPtInsideSector,dr=Ne.maxHoverDistance,mr=Rt._period||2*Math.PI,xr=Math.abs(Ot.g2p(Math.sqrt(Ge*Ge+Qe*Qe))),br=Math.atan2(Qe,Ge);Ot.range[0]>Ot.range[1]&&(br+=Math.PI);var distFn=function(Ne){return er(xr,br,[Ne.rp0,Ne.rp1],[Ne.thetag0,Ne.thetag1],Zt)?dr+Math.min(1,Math.abs(Ne.thetag1-Ne.thetag0)/mr)-1+(Ne.rp1-xr)/(Ne.rp1-Ne.rp0)-1:1/0};if(tt.getClosest(dt,distFn,Ne),!1!==Ne.index){var Ar=dt[Ne.index];Ne.x0=Ne.x1=Ar.ct[0],Ne.y0=Ne.y1=Ar.ct[1];var en=rt.extendFlat({},Ar,{r:Ar.s,theta:Ar.p});return at(Ar,ht,Ne),it(en,ht,Dt,Ne),Ne.hovertemplate=ht.hovertemplate,Ne.color=nt(ht,Ar),Ne.xLabelVal=Ne.yLabelVal=void 0,Ar.s<0&&(Ne.idealAlign="left"),[Ne]}}},{"../../components/fx":683,"../../lib":778,"../../plots/polar/helpers":893,"../bar/hover":928,"../scatterpolar/hover":1265}],942:[function(Ne,Ge,Qe){"use strict";Ge.exports={moduleType:"trace",name:"barpolar",basePlotModule:Ne("../../plots/polar"),categories:["polar","bar","showLegend"],attributes:Ne("./attributes"),layoutAttributes:Ne("./layout_attributes"),supplyDefaults:Ne("./defaults"),supplyLayoutDefaults:Ne("./layout_defaults"),calc:Ne("./calc").calc,crossTraceCalc:Ne("./calc").crossTraceCalc,plot:Ne("./plot"),colorbar:Ne("../scatter/marker_colorbar"),formatLabels:Ne("../scatterpolar/format_labels"),style:Ne("../bar/style").style,styleOnSelect:Ne("../bar/style").styleOnSelect,hoverPoints:Ne("./hover"),selectPoints:Ne("../bar/select"),meta:{}}},{"../../plots/polar":894,"../bar/select":933,"../bar/style":935,"../scatter/marker_colorbar":1205,"../scatterpolar/format_labels":1264,"./attributes":938,"./calc":939,"./defaults":940,"./hover":941,"./layout_attributes":943,"./layout_defaults":944,"./plot":945}],943:[function(Ne,Ge,Qe){"use strict";Ge.exports={barmode:{valType:"enumerated",values:["stack","overlay"],dflt:"stack",editType:"calc"},bargap:{valType:"number",dflt:.1,min:0,max:1,editType:"calc"}}},{}],944:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./layout_attributes");Ge.exports=function(Ne,Ge,Qe){var nt,at={};function coerce(Qe,at){return tt.coerce(Ne[nt]||{},Ge[nt],rt,Qe,at)}for(var it=0;it<Qe.length;it++){var ot=Qe[it];"barpolar"===ot.type&&!0===ot.visible&&(at[nt=ot.subplot]||(coerce("barmode"),coerce("bargap"),at[nt]=1))}}},{"../../lib":778,"./layout_attributes":943}],945:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("fast-isnumeric"),nt=Ne("../../lib"),at=Ne("../../components/drawing"),it=Ne("../../plots/polar/helpers");function makePathFn(Ne){var Ge=Ne.cxx,Qe=Ne.cyy;return Ne.vangles?function(tt,rt,at,ot){var dt,ht;nt.angleDelta(at,ot)>0?(dt=at,ht=ot):(dt=ot,ht=at);var Dt=[it.findEnclosingVertexAngles(dt,Ne.vangles)[0],(dt+ht)/2,it.findEnclosingVertexAngles(ht,Ne.vangles)[1]];return it.pathPolygonAnnulus(tt,rt,dt,ht,Dt,Ge,Qe)}:function(Ne,tt,rt,at){return nt.pathAnnulus(Ne,tt,rt,at,Ge,Qe)}}Ge.exports=function(Ne,Ge,Qe){var it=Ge.xaxis,ot=Ge.yaxis,dt=Ge.radialAxis,ht=Ge.angularAxis,Dt=makePathFn(Ge),Ot=Ge.layers.frontplot.select("g.barlayer");nt.makeTraceGroups(Ot,Qe,"trace bars").each((function(){var Qe=tt.select(this),Ot=nt.ensureSingle(Qe,"g","points").selectAll("g.point").data(nt.identity);Ot.enter().append("g").style("vector-effect","non-scaling-stroke").style("stroke-miterlimit",2).classed("point",!0),Ot.exit().remove(),Ot.each((function(Ne){var Ge,Qe=tt.select(this),at=Ne.rp0=dt.c2p(Ne.s0),Ot=Ne.rp1=dt.c2p(Ne.s1),Rt=Ne.thetag0=ht.c2g(Ne.p0),Zt=Ne.thetag1=ht.c2g(Ne.p1);if(rt(at)&&rt(Ot)&&rt(Rt)&&rt(Zt)&&at!==Ot&&Rt!==Zt){var er=dt.c2g(Ne.s1),dr=(Rt+Zt)/2;Ne.ct=[it.c2p(er*Math.cos(dr)),ot.c2p(er*Math.sin(dr))],Ge=Dt(at,Ot,Rt,Zt)}else Ge="M0,0Z";nt.ensureSingle(Qe,"path").attr("d",Ge)})),at.setClipUrl(Qe,Ge._hasClipOnAxisFalse?Ge.clipIds.forTraces:null,Ne)}))}},{"../../components/drawing":665,"../../lib":778,"../../plots/polar/helpers":893,d3:169,"fast-isnumeric":241}],946:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../scatter/attributes"),rt=Ne("../bar/attributes"),nt=Ne("../../components/color/attributes"),at=Ne("../../plots/template_attributes").hovertemplateAttrs,it=Ne("../../lib/extend").extendFlat,ot=tt.marker,dt=ot.line;Ge.exports={y:{valType:"data_array",editType:"calc+clearAxisTypes"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},x0:{valType:"any",editType:"calc+clearAxisTypes"},y0:{valType:"any",editType:"calc+clearAxisTypes"},dx:{valType:"number",editType:"calc"},dy:{valType:"number",editType:"calc"},xperiod:tt.xperiod,yperiod:tt.yperiod,xperiod0:tt.xperiod0,yperiod0:tt.yperiod0,xperiodalignment:tt.xperiodalignment,yperiodalignment:tt.yperiodalignment,name:{valType:"string",editType:"calc+clearAxisTypes"},q1:{valType:"data_array",editType:"calc+clearAxisTypes"},median:{valType:"data_array",editType:"calc+clearAxisTypes"},q3:{valType:"data_array",editType:"calc+clearAxisTypes"},lowerfence:{valType:"data_array",editType:"calc"},upperfence:{valType:"data_array",editType:"calc"},notched:{valType:"boolean",editType:"calc"},notchwidth:{valType:"number",min:0,max:.5,dflt:.25,editType:"calc"},notchspan:{valType:"data_array",editType:"calc"},boxpoints:{valType:"enumerated",values:["all","outliers","suspectedoutliers",!1],editType:"calc"},jitter:{valType:"number",min:0,max:1,editType:"calc"},pointpos:{valType:"number",min:-2,max:2,editType:"calc"},boxmean:{valType:"enumerated",values:[!0,"sd",!1],editType:"calc"},mean:{valType:"data_array",editType:"calc"},sd:{valType:"data_array",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc+clearAxisTypes"},quartilemethod:{valType:"enumerated",values:["linear","exclusive","inclusive"],dflt:"linear",editType:"calc"},width:{valType:"number",min:0,dflt:0,editType:"calc"},marker:{outliercolor:{valType:"color",dflt:"rgba(0, 0, 0, 0)",editType:"style"},symbol:it({},ot.symbol,{arrayOk:!1,editType:"plot"}),opacity:it({},ot.opacity,{arrayOk:!1,dflt:1,editType:"style"}),size:it({},ot.size,{arrayOk:!1,editType:"calc"}),color:it({},ot.color,{arrayOk:!1,editType:"style"}),line:{color:it({},dt.color,{arrayOk:!1,dflt:nt.defaultLine,editType:"style"}),width:it({},dt.width,{arrayOk:!1,dflt:0,editType:"style"}),outliercolor:{valType:"color",editType:"style"},outlierwidth:{valType:"number",min:0,dflt:1,editType:"style"},editType:"style"},editType:"plot"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:tt.fillcolor,whiskerwidth:{valType:"number",min:0,max:1,dflt:.5,editType:"calc"},offsetgroup:rt.offsetgroup,alignmentgroup:rt.alignmentgroup,selected:{marker:tt.selected.marker,editType:"style"},unselected:{marker:tt.unselected.marker,editType:"style"},text:it({},tt.text,{}),hovertext:it({},tt.hovertext,{}),hovertemplate:at({}),hoveron:{valType:"flaglist",flags:["boxes","points"],dflt:"boxes+points",editType:"style"}}},{"../../components/color/attributes":642,"../../lib/extend":768,"../../plots/template_attributes":906,"../bar/attributes":921,"../scatter/attributes":1187}],947:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../plots/cartesian/axes"),nt=Ne("../../plots/cartesian/align_period"),at=Ne("../../lib"),it=Ne("../../constants/numerical").BADNUM,ot=at._;function getPosArrays(Ne,Ge,Qe,rt){var it,ot=Ge+"0"in Ne;if(Ge in Ne||ot&&"d"+Ge in Ne){var dt=Qe.makeCalcdata(Ne,Ge);return[nt(Ne,Qe,Ge,dt),dt]}it=ot?Ne[Ge+"0"]:"name"in Ne&&("category"===Qe.type||tt(Ne.name)&&-1!==["linear","log"].indexOf(Qe.type)||at.isDateTime(Ne.name)&&"date"===Qe.type)?Ne.name:rt;for(var ht="multicategory"===Qe.type?Qe.r2c_just_indices(it):Qe.d2c(it,0,Ne[Ge+"calendar"]),Dt=Ne._length,Ot=new Array(Dt),Rt=0;Rt<Dt;Rt++)Ot[Rt]=ht;return[Ot]}function makeBins(Ne,Ge){for(var Qe=Ne.length,tt=new Array(Qe+1),rt=0;rt<Qe;rt++)tt[rt]=Ne[rt]-Ge;return tt[Qe]=Ne[Qe-1]+Ge,tt}function initNestedArray(Ne){for(var Ge=new Array(Ne),Qe=0;Qe<Ne;Qe++)Ge[Qe]=[];return Ge}Ge.exports=function(Ne,Ge){var Qe,nt,dt,ht,Dt,Ot,Rt,Zt=Ne._fullLayout,er=rt.getFromId(Ne,Ge.xaxis||"x"),dr=rt.getFromId(Ne,Ge.yaxis||"y"),mr=[],xr="violin"===Ge.type?"_numViolins":"_numBoxes";"h"===Ge.orientation?(dt=er,ht="x",Dt=dr,Ot="y",Rt=!!Ge.yperiodalignment):(dt=dr,ht="y",Dt=er,Ot="x",Rt=!!Ge.xperiodalignment);var br,Ar,en,mn,xn,kn,Cn=getPosArrays(Ge,Ot,Dt,Zt[xr]),En=Cn[0],Pn=Cn[1],Dn=at.distinctVals(En),In=Dn.vals,zn=Dn.minDiff/2,Bn="all"===(Ge.boxpoints||Ge.points)?at.identity:function(Ne){return Ne.v<br.lf||Ne.v>br.uf};if(Ge._hasPreCompStats){var Vn=Ge[ht],d2c=function(Ne){return dt.d2c((Ge[Ne]||[])[Qe])},Hn=1/0,qn=-1/0;for(Qe=0;Qe<Ge._length;Qe++){var Yn=En[Qe];if(tt(Yn)){if((br={}).pos=br[Ot]=Yn,Rt&&Pn&&(br.orig_p=Pn[Qe]),br.q1=d2c("q1"),br.med=d2c("median"),br.q3=d2c("q3"),Ar=[],Vn&&at.isArrayOrTypedArray(Vn[Qe]))for(nt=0;nt<Vn[Qe].length;nt++)(kn=dt.d2c(Vn[Qe][nt]))!==it&&(arraysToCalcdata(xn={v:kn,i:[Qe,nt]},Ge,[Qe,nt]),Ar.push(xn));if(br.pts=Ar.sort(sortByVal),mn=(en=br[ht]=Ar.map(extractVal)).length,br.med!==it&&br.q1!==it&&br.q3!==it&&br.med>=br.q1&&br.q3>=br.med){var $n=d2c("lowerfence");br.lf=$n!==it&&$n<=br.q1?$n:computeLowerFence(br,en,mn);var ra=d2c("upperfence");br.uf=ra!==it&&ra>=br.q3?ra:computeUpperFence(br,en,mn);var oa=d2c("mean");br.mean=oa!==it?oa:mn?at.mean(en,mn):(br.q1+br.q3)/2;var pa=d2c("sd");br.sd=oa!==it&&pa>=0?pa:mn?at.stdev(en,mn,br.mean):br.q3-br.q1,br.lo=computeLowerOutlierBound(br),br.uo=computeUpperOutlierBound(br);var ga=d2c("notchspan");ga=ga!==it&&ga>0?ga:computeNotchSpan(br,mn),br.ln=br.med-ga,br.un=br.med+ga;var ma=br.lf,_a=br.uf;Ge.boxpoints&&en.length&&(ma=Math.min(ma,en[0]),_a=Math.max(_a,en[mn-1])),Ge.notched&&(ma=Math.min(ma,br.ln),_a=Math.max(_a,br.un)),br.min=ma,br.max=_a}else{var Va;at.warn(["Invalid input - make sure that q1 <= median <= q3","q1 = "+br.q1,"median = "+br.med,"q3 = "+br.q3].join("\n")),Va=br.med!==it?br.med:br.q1!==it?br.q3!==it?(br.q1+br.q3)/2:br.q1:br.q3!==it?br.q3:0,br.med=Va,br.q1=br.q3=Va,br.lf=br.uf=Va,br.mean=br.sd=Va,br.ln=br.un=Va,br.min=br.max=Va}Hn=Math.min(Hn,br.min),qn=Math.max(qn,br.max),br.pts2=Ar.filter(Bn),mr.push(br)}}Ge._extremes[dt._id]=rt.findExtremes(dt,[Hn,qn],{padded:!0})}else{var Wa=dt.makeCalcdata(Ge,ht),Qa=makeBins(In,zn),ti=In.length,ni=initNestedArray(ti);for(Qe=0;Qe<Ge._length;Qe++)if(kn=Wa[Qe],tt(kn)){var di=at.findBin(En[Qe],Qa);di>=0&&di<ti&&(arraysToCalcdata(xn={v:kn,i:Qe},Ge,Qe),ni[di].push(xn))}var ji=1/0,Hi=-1/0,Yi=Ge.quartilemethod,uo="exclusive"===Yi,go="inclusive"===Yi;for(Qe=0;Qe<ti;Qe++)if(ni[Qe].length>0){var ns,as;(br={}).pos=br[Ot]=In[Qe],Ar=br.pts=ni[Qe].sort(sortByVal),mn=(en=br[ht]=Ar.map(extractVal)).length,br.min=en[0],br.max=en[mn-1],br.mean=at.mean(en,mn),br.sd=at.stdev(en,mn,br.mean),br.med=at.interp(en,.5),mn%2&&(uo||go)?(uo?(ns=en.slice(0,mn/2),as=en.slice(mn/2+1)):go&&(ns=en.slice(0,mn/2+1),as=en.slice(mn/2)),br.q1=at.interp(ns,.5),br.q3=at.interp(as,.5)):(br.q1=at.interp(en,.25),br.q3=at.interp(en,.75)),br.lf=computeLowerFence(br,en,mn),br.uf=computeUpperFence(br,en,mn),br.lo=computeLowerOutlierBound(br),br.uo=computeUpperOutlierBound(br);var is=computeNotchSpan(br,mn);br.ln=br.med-is,br.un=br.med+is,ji=Math.min(ji,br.ln),Hi=Math.max(Hi,br.un),br.pts2=Ar.filter(Bn),mr.push(br)}Ge._extremes[dt._id]=rt.findExtremes(dt,Ge.notched?Wa.concat([ji,Hi]):Wa,{padded:!0})}return calcSelection(mr,Ge),mr.length>0?(mr[0].t={num:Zt[xr],dPos:zn,posLetter:Ot,valLetter:ht,labels:{med:ot(Ne,"median:"),min:ot(Ne,"min:"),q1:ot(Ne,"q1:"),q3:ot(Ne,"q3:"),max:ot(Ne,"max:"),mean:"sd"===Ge.boxmean?ot(Ne,"mean Â± Ï:"):ot(Ne,"mean:"),lf:ot(Ne,"lower fence:"),uf:ot(Ne,"upper fence:")}},Zt[xr]++,mr):[{t:{empty:!0}}]};var dt={text:"tx",hovertext:"htx"};function arraysToCalcdata(Ne,Ge,Qe){for(var tt in dt)at.isArrayOrTypedArray(Ge[tt])&&(Array.isArray(Qe)?at.isArrayOrTypedArray(Ge[tt][Qe[0]])&&(Ne[dt[tt]]=Ge[tt][Qe[0]][Qe[1]]):Ne[dt[tt]]=Ge[tt][Qe])}function calcSelection(Ne,Ge){if(at.isArrayOrTypedArray(Ge.selectedpoints))for(var Qe=0;Qe<Ne.length;Qe++){for(var tt=Ne[Qe].pts||[],rt={},nt=0;nt<tt.length;nt++)rt[tt[nt].i]=nt;at.tagSelected(tt,Ge,rt)}}function sortByVal(Ne,Ge){return Ne.v-Ge.v}function extractVal(Ne){return Ne.v}function computeLowerFence(Ne,Ge,Qe){return 0===Qe?Ne.q1:Math.min(Ne.q1,Ge[Math.min(at.findBin(2.5*Ne.q1-1.5*Ne.q3,Ge,!0)+1,Qe-1)])}function computeUpperFence(Ne,Ge,Qe){return 0===Qe?Ne.q3:Math.max(Ne.q3,Ge[Math.max(at.findBin(2.5*Ne.q3-1.5*Ne.q1,Ge),0)])}function computeLowerOutlierBound(Ne){return 4*Ne.q1-3*Ne.q3}function computeUpperOutlierBound(Ne){return 4*Ne.q3-3*Ne.q1}function computeNotchSpan(Ne,Ge){return 0===Ge?0:1.57*(Ne.q3-Ne.q1)/Math.sqrt(Ge)}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/align_period":825,"../../plots/cartesian/axes":828,"fast-isnumeric":241}],948:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/cartesian/axes"),rt=Ne("../../lib"),nt=Ne("../../plots/cartesian/constraints").getAxisGroup,at=["v","h"];function crossTraceCalc(Ne,Ge){for(var Qe=Ne.calcdata,tt=Ge.xaxis,rt=Ge.yaxis,nt=0;nt<at.length;nt++){for(var it=at[nt],ot="h"===it?rt:tt,dt=[],ht=0;ht<Qe.length;ht++){var Dt=Qe[ht],Ot=Dt[0].t,Rt=Dt[0].trace;!0!==Rt.visible||"box"!==Rt.type&&"candlestick"!==Rt.type||Ot.empty||(Rt.orientation||"v")!==it||Rt.xaxis!==tt._id||Rt.yaxis!==rt._id||dt.push(ht)}setPositionOffset("box",Ne,dt,ot)}}function setPositionOffset(Ne,Ge,Qe,at){var it,ot,dt,ht=Ge.calcdata,Dt=Ge._fullLayout,Ot=at._id,Rt=Ot.charAt(0),Zt=[],er=0;for(it=0;it<Qe.length;it++)for(dt=ht[Qe[it]],ot=0;ot<dt.length;ot++)Zt.push(at.c2l(dt[ot].pos,!0)),er+=(dt[ot].pts2||[]).length;if(Zt.length){var dr=rt.distinctVals(Zt,{unitMinDiff:"category"===at.type||"multicategory"===at.type}),mr=dr.minDiff/2;tt.minDtick(at,dr.minDiff,dr.vals[0],!0);var xr=Dt["violin"===Ne?"_numViolins":"_numBoxes"],br="group"===Dt[Ne+"mode"]&&xr>1,Ar=1-Dt[Ne+"gap"],en=1-Dt[Ne+"groupgap"];for(it=0;it<Qe.length;it++){var mn,xn,kn,Cn,En,Pn,Dn=(dt=ht[Qe[it]])[0].trace,In=dt[0].t,zn=Dn.width,Bn=Dn.side;if(zn)mn=xn=Cn=zn/2,kn=0;else if(mn=mr,br){var Vn=nt(Dt,at._id)+Dn.orientation,Hn=(Dt._alignmentOpts[Vn]||{})[Dn.alignmentgroup]||{},qn=Object.keys(Hn.offsetGroups||{}).length,Yn=qn||xr;xn=mn*Ar*en/Yn,kn=2*mn*(((qn?Dn._offsetIndex:In.num)+.5)/Yn-.5)*Ar,Cn=mn*Ar/Yn}else xn=mn*Ar*en,kn=0,Cn=mn;In.dPos=mn,In.bPos=kn,In.bdPos=xn,In.wHover=Cn;var $n,ra,oa,pa,ga,ma,_a=kn+xn,Va=Boolean(zn);if("positive"===Bn?(En=mn*(zn?1:.5),$n=_a,Pn=$n=kn):"negative"===Bn?(En=$n=kn,Pn=mn*(zn?1:.5),ra=_a):(En=Pn=mn,$n=ra=_a),(Dn.boxpoints||Dn.points)&&er>0){var Wa=Dn.pointpos,Qa=Dn.jitter,ti=Dn.marker.size/2,ni=0;Wa+Qa>=0&&((ni=_a*(Wa+Qa))>En?(Va=!0,ga=ti,oa=ni):ni>$n&&(ga=ti,oa=En)),ni<=En&&(oa=En);var di=0;Wa-Qa<=0&&((di=-_a*(Wa-Qa))>Pn?(Va=!0,ma=ti,pa=di):di>ra&&(ma=ti,pa=Pn)),di<=Pn&&(pa=Pn)}else oa=En,pa=Pn;var ji=new Array(dt.length);for(ot=0;ot<dt.length;ot++)ji[ot]=dt[ot].pos;Dn._extremes[Ot]=tt.findExtremes(at,ji,{padded:Va,vpadminus:pa,vpadplus:oa,vpadLinearized:!0,ppadminus:{x:ma,y:ga}[Rt],ppadplus:{x:ga,y:ma}[Rt]})}}}Ge.exports={crossTraceCalc:crossTraceCalc,setPositionOffset:setPositionOffset}},{"../../lib":778,"../../plots/cartesian/axes":828,"../../plots/cartesian/constraints":835}],949:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../registry"),nt=Ne("../../components/color"),at=Ne("../scatter/period_defaults"),it=Ne("../bar/defaults").handleGroupingDefaults,ot=Ne("../../plots/cartesian/axis_autotype"),dt=Ne("./attributes");function supplyDefaults(Ne,Ge,Qe,rt){function coerce(Qe,rt){return tt.coerce(Ne,Ge,dt,Qe,rt)}if(handleSampleDefaults(Ne,Ge,coerce,rt),!1!==Ge.visible){at(Ne,Ge,rt,coerce);var it=Ge._hasPreCompStats;it&&(coerce("lowerfence"),coerce("upperfence")),coerce("line.color",(Ne.marker||{}).color||Qe),coerce("line.width"),coerce("fillcolor",nt.addOpacity(Ge.line.color,.5));var ot=!1;if(it){var ht=coerce("mean"),Dt=coerce("sd");ht&&ht.length&&(ot=!0,Dt&&Dt.length&&(ot="sd"))}coerce("boxmean",ot),coerce("whiskerwidth"),coerce("width"),coerce("quartilemethod");var Ot=!1;if(it){var Rt=coerce("notchspan");Rt&&Rt.length&&(Ot=!0)}else tt.validate(Ne.notchwidth,dt.notchwidth)&&(Ot=!0);coerce("notched",Ot)&&coerce("notchwidth"),handlePointsDefaults(Ne,Ge,coerce,{prefix:"box"})}}function handleSampleDefaults(Ne,Ge,Qe,nt){function getDims(Ne){var Ge=0;return Ne&&Ne.length&&(Ge+=1,tt.isArrayOrTypedArray(Ne[0])&&Ne[0].length&&(Ge+=1)),Ge}function valid(Ge){return tt.validate(Ne[Ge],dt[Ge])}var at,it=Qe("y"),ht=Qe("x");if("box"===Ge.type){var Dt=Qe("q1"),Ot=Qe("median"),Rt=Qe("q3");Ge._hasPreCompStats=Dt&&Dt.length&&Ot&&Ot.length&&Rt&&Rt.length,at=Math.min(tt.minRowLength(Dt),tt.minRowLength(Ot),tt.minRowLength(Rt))}var Zt,er,dr=getDims(it),mr=getDims(ht),xr=dr&&tt.minRowLength(it),br=mr&&tt.minRowLength(ht),Ar=nt.calendar,en={autotypenumbers:nt.autotypenumbers};if(Ge._hasPreCompStats)switch(String(mr)+String(dr)){case"00":var mn=valid("x0")||valid("dx");Zt=!valid("y0")&&!valid("dy")||mn?"v":"h",er=at;break;case"10":Zt="v",er=Math.min(at,br);break;case"20":Zt="h",er=Math.min(at,ht.length);break;case"01":Zt="h",er=Math.min(at,xr);break;case"02":Zt="v",er=Math.min(at,it.length);break;case"12":Zt="v",er=Math.min(at,br,it.length);break;case"21":Zt="h",er=Math.min(at,ht.length,xr);break;case"11":er=0;break;case"22":var xn,kn=!1;for(xn=0;xn<ht.length;xn++)if("category"===ot(ht[xn],Ar,en)){kn=!0;break}if(kn)Zt="v",er=Math.min(at,br,it.length);else{for(xn=0;xn<it.length;xn++)if("category"===ot(it[xn],Ar,en)){kn=!0;break}kn?(Zt="h",er=Math.min(at,ht.length,xr)):(Zt="v",er=Math.min(at,br,it.length))}}else dr>0?(Zt="v",er=mr>0?Math.min(br,xr):Math.min(xr)):mr>0?(Zt="h",er=Math.min(br)):er=0;if(er){Ge._length=er;var Cn=Qe("orientation",Zt);Ge._hasPreCompStats?"v"===Cn&&0===mr?(Qe("x0",0),Qe("dx",1)):"h"===Cn&&0===dr&&(Qe("y0",0),Qe("dy",1)):"v"===Cn&&0===mr?Qe("x0"):"h"===Cn&&0===dr&&Qe("y0"),rt.getComponentMethod("calendars","handleTraceDefaults")(Ne,Ge,["x","y"],nt)}else Ge.visible=!1}function handlePointsDefaults(Ne,Ge,Qe,rt){var nt=rt.prefix,at=tt.coerce2(Ne,Ge,dt,"marker.outliercolor"),it=Qe("marker.line.outliercolor"),ot="outliers";Ge._hasPreCompStats?ot="all":(at||it)&&(ot="suspectedoutliers");var ht=Qe(nt+"points",ot);ht?(Qe("jitter","all"===ht?.3:0),Qe("pointpos","all"===ht?-1.5:0),Qe("marker.symbol"),Qe("marker.opacity"),Qe("marker.size"),Qe("marker.color",Ge.line.color),Qe("marker.line.color"),Qe("marker.line.width"),"suspectedoutliers"===ht&&(Qe("marker.line.outliercolor",Ge.marker.color),Qe("marker.line.outlierwidth")),Qe("selected.marker.color"),Qe("unselected.marker.color"),Qe("selected.marker.size"),Qe("unselected.marker.size"),Qe("text"),Qe("hovertext")):delete Ge.marker;var Dt=Qe("hoveron");"all"!==Dt&&-1===Dt.indexOf("points")||Qe("hovertemplate"),tt.coerceSelectionMarkerOpacity(Ge,Qe)}function crossTraceDefaults(Ne,Ge){var Qe,rt;function coerce(Ne){return tt.coerce(rt._input,rt,dt,Ne)}for(var nt=0;nt<Ne.length;nt++){var at=(rt=Ne[nt]).type;"box"!==at&&"violin"!==at||(Qe=rt._input,"group"===Ge[at+"mode"]&&it(Qe,rt,Ge,coerce))}}Ge.exports={supplyDefaults:supplyDefaults,crossTraceDefaults:crossTraceDefaults,handleSampleDefaults:handleSampleDefaults,handlePointsDefaults:handlePointsDefaults}},{"../../components/color":643,"../../lib":778,"../../plots/cartesian/axis_autotype":829,"../../registry":911,"../bar/defaults":925,"../scatter/period_defaults":1207,"./attributes":946}],950:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge){return Ge.hoverOnBox&&(Ne.hoverOnBox=Ge.hoverOnBox),"xVal"in Ge&&(Ne.x=Ge.xVal),"yVal"in Ge&&(Ne.y=Ge.yVal),Ge.xa&&(Ne.xaxis=Ge.xa),Ge.ya&&(Ne.yaxis=Ge.ya),Ne}},{}],951:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/cartesian/axes"),rt=Ne("../../lib"),nt=Ne("../../components/fx"),at=Ne("../../components/color"),it=rt.fillText;function hoverPoints(Ne,Ge,Qe,tt){var rt,nt=Ne.cd[0].trace.hoveron,at=[];return-1!==nt.indexOf("boxes")&&(at=at.concat(hoverOnBoxes(Ne,Ge,Qe,tt))),-1!==nt.indexOf("points")&&(rt=hoverOnPoints(Ne,Ge,Qe)),"closest"===tt?rt?[rt]:at:rt?(at.push(rt),at):at}function hoverOnBoxes(Ne,Ge,Qe,it){var ot,dt,ht,Dt,Ot,Rt,Zt,er,dr,mr,xr,br,Ar,en,mn=Ne.cd,xn=Ne.xa,kn=Ne.ya,Cn=mn[0].trace,En=mn[0].t,Pn="violin"===Cn.type,Dn=[],In=En.bdPos,zn=En.wHover,shiftPos=function(Ne){return ht.c2l(Ne.pos)+En.bPos-ht.c2l(Rt)};Pn&&"both"!==Cn.side?("positive"===Cn.side&&(dr=function(Ne){var Ge=shiftPos(Ne);return nt.inbox(Ge,Ge+zn,mr)},br=In,Ar=0),"negative"===Cn.side&&(dr=function(Ne){var Ge=shiftPos(Ne);return nt.inbox(Ge-zn,Ge,mr)},br=0,Ar=In)):(dr=function(Ne){var Ge=shiftPos(Ne);return nt.inbox(Ge-zn,Ge+zn,mr)},br=Ar=In),en=Pn?function(Ne){return nt.inbox(Ne.span[0]-Ot,Ne.span[1]-Ot,mr)}:function(Ne){return nt.inbox(Ne.min-Ot,Ne.max-Ot,mr)},"h"===Cn.orientation?(Ot=Ge,Rt=Qe,Zt=en,er=dr,ot="y",ht=kn,dt="x",Dt=xn):(Ot=Qe,Rt=Ge,Zt=dr,er=en,ot="x",ht=xn,dt="y",Dt=kn);var Bn=Math.min(1,In/Math.abs(ht.r2c(ht.range[1])-ht.r2c(ht.range[0])));function dxy(Ne){return(Zt(Ne)+er(Ne))/2}mr=Ne.maxHoverDistance-Bn,xr=Ne.maxSpikeDistance-Bn;var Vn=nt.getDistanceFunction(it,Zt,er,dxy);if(nt.getClosest(mn,Vn,Ne),!1===Ne.index)return[];var Hn=mn[Ne.index],qn=Cn.line.color,Yn=(Cn.marker||{}).color;at.opacity(qn)&&Cn.line.width?Ne.color=qn:at.opacity(Yn)&&Cn.boxpoints?Ne.color=Yn:Ne.color=Cn.fillcolor,Ne[ot+"0"]=ht.c2p(Hn.pos+En.bPos-Ar,!0),Ne[ot+"1"]=ht.c2p(Hn.pos+En.bPos+br,!0),Ne[ot+"LabelVal"]=void 0!==Hn.orig_p?Hn.orig_p:Hn.pos;var $n=ot+"Spike";Ne.spikeDistance=dxy(Hn)*xr/mr,Ne[$n]=ht.c2p(Hn.pos,!0);var ra={},oa=["med","q1","q3","min","max"];(Cn.boxmean||(Cn.meanline||{}).visible)&&oa.push("mean"),(Cn.boxpoints||Cn.points)&&oa.push("lf","uf");for(var pa=0;pa<oa.length;pa++){var ga=oa[pa];if(ga in Hn&&!(Hn[ga]in ra)){ra[Hn[ga]]=!0;var ma=Hn[ga],_a=Dt.c2p(ma,!0),Va=rt.extendFlat({},Ne);Va.attr=ga,Va[dt+"0"]=Va[dt+"1"]=_a,Va[dt+"LabelVal"]=ma,Va[dt+"Label"]=(En.labels?En.labels[ga]+" ":"")+tt.hoverLabelText(Dt,ma),Va.hoverOnBox=!0,"mean"===ga&&"sd"in Hn&&"sd"===Cn.boxmean&&(Va[dt+"err"]=Hn.sd),Ne.name="",Ne.spikeDistance=void 0,Ne[$n]=void 0,Va.hovertemplate=!1,Dn.push(Va)}}return Dn}function hoverOnPoints(Ne,Ge,Qe){for(var tt,at,ot,dt=Ne.cd,ht=Ne.xa,Dt=Ne.ya,Ot=dt[0].trace,Rt=ht.c2p(Ge),Zt=Dt.c2p(Qe),dx=function(Ne){var Ge=Math.max(3,Ne.mrc||0);return Math.max(Math.abs(ht.c2p(Ne.x)-Rt)-Ge,1-3/Ge)},dy=function(Ne){var Ge=Math.max(3,Ne.mrc||0);return Math.max(Math.abs(Dt.c2p(Ne.y)-Zt)-Ge,1-3/Ge)},er=nt.quadrature(dx,dy),dr=!1,mr=0;mr<dt.length;mr++){at=dt[mr];for(var xr=0;xr<(at.pts||[]).length;xr++){var br=er(ot=at.pts[xr]);br<=Ne.distance&&(Ne.distance=br,dr=[mr,xr])}}if(!dr)return!1;ot=(at=dt[dr[0]]).pts[dr[1]];var Ar=ht.c2p(ot.x,!0),en=Dt.c2p(ot.y,!0),mn=ot.mrc||1;tt=rt.extendFlat({},Ne,{index:ot.i,color:(Ot.marker||{}).color,name:Ot.name,x0:Ar-mn,x1:Ar+mn,y0:en-mn,y1:en+mn,spikeDistance:Ne.distance,hovertemplate:Ot.hovertemplate});var xn,kn=at.orig_p,Cn=void 0!==kn?kn:at.pos;return"h"===Ot.orientation?(xn=Dt,tt.xLabelVal=ot.x,tt.yLabelVal=Cn):(xn=ht,tt.xLabelVal=Cn,tt.yLabelVal=ot.y),tt[xn._id.charAt(0)+"Spike"]=xn.c2p(at.pos,!0),it(ot,Ot,tt),tt}Ge.exports={hoverPoints:hoverPoints,hoverOnBoxes:hoverOnBoxes,hoverOnPoints:hoverOnPoints}},{"../../components/color":643,"../../components/fx":683,"../../lib":778,"../../plots/cartesian/axes":828}],952:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),layoutAttributes:Ne("./layout_attributes"),supplyDefaults:Ne("./defaults").supplyDefaults,crossTraceDefaults:Ne("./defaults").crossTraceDefaults,supplyLayoutDefaults:Ne("./layout_defaults").supplyLayoutDefaults,calc:Ne("./calc"),crossTraceCalc:Ne("./cross_trace_calc").crossTraceCalc,plot:Ne("./plot").plot,style:Ne("./style").style,styleOnSelect:Ne("./style").styleOnSelect,hoverPoints:Ne("./hover").hoverPoints,eventData:Ne("./event_data"),selectPoints:Ne("./select"),moduleType:"trace",name:"box",basePlotModule:Ne("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","boxLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":841,"./attributes":946,"./calc":947,"./cross_trace_calc":948,"./defaults":949,"./event_data":950,"./hover":951,"./layout_attributes":953,"./layout_defaults":954,"./plot":955,"./select":956,"./style":957}],953:[function(Ne,Ge,Qe){"use strict";Ge.exports={boxmode:{valType:"enumerated",values:["group","overlay"],dflt:"overlay",editType:"calc"},boxgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"},boxgroupgap:{valType:"number",min:0,max:1,dflt:.3,editType:"calc"}}},{}],954:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../registry"),rt=Ne("../../lib"),nt=Ne("./layout_attributes");function _supply(Ne,Ge,Qe,rt,nt){for(var at=nt+"Layout",it=!1,ot=0;ot<Qe.length;ot++){var dt=Qe[ot];if(tt.traceIs(dt,at)){it=!0;break}}it&&(rt(nt+"mode"),rt(nt+"gap"),rt(nt+"groupgap"))}function supplyLayoutDefaults(Ne,Ge,Qe){function coerce(Qe,tt){return rt.coerce(Ne,Ge,nt,Qe,tt)}_supply(Ne,Ge,Qe,coerce,"box")}Ge.exports={supplyLayoutDefaults:supplyLayoutDefaults,_supply:_supply}},{"../../lib":778,"../../registry":911,"./layout_attributes":953}],955:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../lib"),nt=Ne("../../components/drawing"),at=5,it=.01;function plot(Ne,Ge,Qe,nt){var at=Ge.xaxis,it=Ge.yaxis;rt.makeTraceGroups(nt,Qe,"trace boxes").each((function(Ne){var Ge,Qe,rt=tt.select(this),nt=Ne[0],ot=nt.t,dt=nt.trace;ot.wdPos=ot.bdPos*dt.whiskerwidth,!0!==dt.visible||ot.empty?rt.remove():("h"===dt.orientation?(Ge=it,Qe=at):(Ge=at,Qe=it),plotBoxAndWhiskers(rt,{pos:Ge,val:Qe},dt,ot),plotPoints(rt,{x:at,y:it},dt,ot),plotBoxMean(rt,{pos:Ge,val:Qe},dt,ot))}))}function plotBoxAndWhiskers(Ne,Ge,Qe,nt){var at,it,ot="h"===Qe.orientation,dt=Ge.val,ht=Ge.pos,Dt=!!ht.rangebreaks,Ot=nt.bPos,Rt=nt.wdPos||0,Zt=nt.bPosPxOffset||0,er=Qe.whiskerwidth||0,dr=Qe.notched||!1,mr=dr?1-2*Qe.notchwidth:1;Array.isArray(nt.bdPos)?(at=nt.bdPos[0],it=nt.bdPos[1]):(at=nt.bdPos,it=nt.bdPos);var xr=Ne.selectAll("path.box").data("violin"!==Qe.type||Qe.box.visible?rt.identity:[]);xr.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","box"),xr.exit().remove(),xr.each((function(Ne){if(Ne.empty)return"M0,0Z";var Ge=ht.c2l(Ne.pos+Ot,!0),nt=ht.l2p(Ge-at)+Zt,xr=ht.l2p(Ge+it)+Zt,br=Dt?(nt+xr)/2:ht.l2p(Ge)+Zt,Ar=Qe.whiskerwidth,en=Dt?nt*Ar+(1-Ar)*br:ht.l2p(Ge-Rt)+Zt,mn=Dt?xr*Ar+(1-Ar)*br:ht.l2p(Ge+Rt)+Zt,xn=ht.l2p(Ge-at*mr)+Zt,kn=ht.l2p(Ge+it*mr)+Zt,Cn=dt.c2p(Ne.q1,!0),En=dt.c2p(Ne.q3,!0),Pn=rt.constrain(dt.c2p(Ne.med,!0),Math.min(Cn,En)+1,Math.max(Cn,En)-1),Dn=void 0===Ne.lf||!1===Qe.boxpoints,In=dt.c2p(Dn?Ne.min:Ne.lf,!0),zn=dt.c2p(Dn?Ne.max:Ne.uf,!0),Bn=dt.c2p(Ne.ln,!0),Vn=dt.c2p(Ne.un,!0);ot?tt.select(this).attr("d","M"+Pn+","+xn+"V"+kn+"M"+Cn+","+nt+"V"+xr+(dr?"H"+Bn+"L"+Pn+","+kn+"L"+Vn+","+xr:"")+"H"+En+"V"+nt+(dr?"H"+Vn+"L"+Pn+","+xn+"L"+Bn+","+nt:"")+"ZM"+Cn+","+br+"H"+In+"M"+En+","+br+"H"+zn+(0===er?"":"M"+In+","+en+"V"+mn+"M"+zn+","+en+"V"+mn)):tt.select(this).attr("d","M"+xn+","+Pn+"H"+kn+"M"+nt+","+Cn+"H"+xr+(dr?"V"+Bn+"L"+kn+","+Pn+"L"+xr+","+Vn:"")+"V"+En+"H"+nt+(dr?"V"+Vn+"L"+xn+","+Pn+"L"+nt+","+Bn:"")+"ZM"+br+","+Cn+"V"+In+"M"+br+","+En+"V"+zn+(0===er?"":"M"+en+","+In+"H"+mn+"M"+en+","+zn+"H"+mn))}))}function plotPoints(Ne,Ge,Qe,tt){var ot=Ge.x,dt=Ge.y,ht=tt.bdPos,Dt=tt.bPos,Ot=Qe.boxpoints||Qe.points;rt.seedPseudoRandom();var fn=function(Ne){return Ne.forEach((function(Ne){Ne.t=tt,Ne.trace=Qe})),Ne},Rt=Ne.selectAll("g.points").data(Ot?fn:[]);Rt.enter().append("g").attr("class","points"),Rt.exit().remove();var Zt=Rt.selectAll("path").data((function(Ne){var Ge,tt,nt=Ne.pts2,ot=Math.max((Ne.max-Ne.min)/10,Ne.q3-Ne.q1),dt=1e-9*ot,Rt=ot*it,Zt=[],er=0;if(Qe.jitter){if(0===ot)for(er=1,Zt=new Array(nt.length),Ge=0;Ge<nt.length;Ge++)Zt[Ge]=1;else for(Ge=0;Ge<nt.length;Ge++){var dr=Math.max(0,Ge-at),mr=nt[dr].v,xr=Math.min(nt.length-1,Ge+at),br=nt[xr].v;"all"!==Ot&&(nt[Ge].v<Ne.lf?br=Math.min(br,Ne.lf):mr=Math.max(mr,Ne.uf));var Ar=Math.sqrt(Rt*(xr-dr)/(br-mr+dt))||0;Ar=rt.constrain(Math.abs(Ar),0,1),Zt.push(Ar),er=Math.max(Ar,er)}tt=2*Qe.jitter/(er||1)}for(Ge=0;Ge<nt.length;Ge++){var en=nt[Ge],mn=en.v,xn=Qe.jitter?tt*Zt[Ge]*(rt.pseudoRandom()-.5):0,kn=Ne.pos+Dt+ht*(Qe.pointpos+xn);"h"===Qe.orientation?(en.y=kn,en.x=mn):(en.x=kn,en.y=mn),"suspectedoutliers"===Ot&&mn<Ne.uo&&mn>Ne.lo&&(en.so=!0)}return nt}));Zt.enter().append("path").classed("point",!0),Zt.exit().remove(),Zt.call(nt.translatePoints,ot,dt)}function plotBoxMean(Ne,Ge,Qe,nt){var at,it,ot=Ge.val,dt=Ge.pos,ht=!!dt.rangebreaks,Dt=nt.bPos,Ot=nt.bPosPxOffset||0,Rt=Qe.boxmean||(Qe.meanline||{}).visible;Array.isArray(nt.bdPos)?(at=nt.bdPos[0],it=nt.bdPos[1]):(at=nt.bdPos,it=nt.bdPos);var Zt=Ne.selectAll("path.mean").data("box"===Qe.type&&Qe.boxmean||"violin"===Qe.type&&Qe.box.visible&&Qe.meanline.visible?rt.identity:[]);Zt.enter().append("path").attr("class","mean").style({fill:"none","vector-effect":"non-scaling-stroke"}),Zt.exit().remove(),Zt.each((function(Ne){var Ge=dt.c2l(Ne.pos+Dt,!0),rt=dt.l2p(Ge-at)+Ot,nt=dt.l2p(Ge+it)+Ot,Zt=ht?(rt+nt)/2:dt.l2p(Ge)+Ot,er=ot.c2p(Ne.mean,!0),dr=ot.c2p(Ne.mean-Ne.sd,!0),mr=ot.c2p(Ne.mean+Ne.sd,!0);"h"===Qe.orientation?tt.select(this).attr("d","M"+er+","+rt+"V"+nt+("sd"===Rt?"m0,0L"+dr+","+Zt+"L"+er+","+rt+"L"+mr+","+Zt+"Z":"")):tt.select(this).attr("d","M"+rt+","+er+"H"+nt+("sd"===Rt?"m0,0L"+Zt+","+dr+"L"+rt+","+er+"L"+Zt+","+mr+"Z":""))}))}Ge.exports={plot:plot,plotBoxAndWhiskers:plotBoxAndWhiskers,plotPoints:plotPoints,plotBoxMean:plotBoxMean}},{"../../components/drawing":665,"../../lib":778,d3:169}],956:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge){var Qe,tt,rt=Ne.cd,nt=Ne.xaxis,at=Ne.yaxis,it=[];if(!1===Ge)for(Qe=0;Qe<rt.length;Qe++)for(tt=0;tt<(rt[Qe].pts||[]).length;tt++)rt[Qe].pts[tt].selected=0;else for(Qe=0;Qe<rt.length;Qe++)for(tt=0;tt<(rt[Qe].pts||[]).length;tt++){var ot=rt[Qe].pts[tt],dt=nt.c2p(ot.x),ht=at.c2p(ot.y);Ge.contains([dt,ht],null,ot.i,Ne)?(it.push({pointNumber:ot.i,x:nt.c2d(ot.x),y:at.c2d(ot.y)}),ot.selected=1):ot.selected=0}return it}},{}],957:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../components/color"),nt=Ne("../../components/drawing");function style(Ne,Ge,Qe){var at=Qe||tt.select(Ne).selectAll("g.trace.boxes");at.style("opacity",(function(Ne){return Ne[0].trace.opacity})),at.each((function(Ge){var Qe=tt.select(this),at=Ge[0].trace,it=at.line.width;function styleBox(Ne,Ge,Qe,tt){Ne.style("stroke-width",Ge+"px").call(rt.stroke,Qe).call(rt.fill,tt)}var ot=Qe.selectAll("path.box");if("candlestick"===at.type)ot.each((function(Ne){if(!Ne.empty){var Ge=tt.select(this),Qe=at[Ne.dir];styleBox(Ge,Qe.line.width,Qe.line.color,Qe.fillcolor),Ge.style("opacity",at.selectedpoints&&!Ne.selected?.3:1)}}));else{styleBox(ot,it,at.line.color,at.fillcolor),Qe.selectAll("path.mean").style({"stroke-width":it,"stroke-dasharray":2*it+"px,"+it+"px"}).call(rt.stroke,at.line.color);var dt=Qe.selectAll("path.point");nt.pointStyle(dt,at,Ne)}}))}function styleOnSelect(Ne,Ge,Qe){var tt=Ge[0].trace,rt=Qe.selectAll("path.point");tt.selectedpoints?nt.selectedPointStyle(rt,tt):nt.pointStyle(rt,tt,Ne)}Ge.exports={style:style,styleOnSelect:styleOnSelect}},{"../../components/color":643,"../../components/drawing":665,d3:169}],958:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib").extendFlat,rt=Ne("../ohlc/attributes"),nt=Ne("../box/attributes");function directionAttrs(Ne){return{line:{color:tt({},nt.line.color,{dflt:Ne}),width:nt.line.width,editType:"style"},fillcolor:nt.fillcolor,editType:"style"}}Ge.exports={xperiod:rt.xperiod,xperiod0:rt.xperiod0,xperiodalignment:rt.xperiodalignment,x:rt.x,open:rt.open,high:rt.high,low:rt.low,close:rt.close,line:{width:tt({},nt.line.width,{}),editType:"style"},increasing:directionAttrs(rt.increasing.line.color.dflt),decreasing:directionAttrs(rt.decreasing.line.color.dflt),text:rt.text,hovertext:rt.hovertext,whiskerwidth:tt({},nt.whiskerwidth,{dflt:0}),hoverlabel:rt.hoverlabel}},{"../../lib":778,"../box/attributes":946,"../ohlc/attributes":1133}],959:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../plots/cartesian/axes"),nt=Ne("../../plots/cartesian/align_period"),at=Ne("../ohlc/calc").calcCommon;function ptFunc(Ne,Ge,Qe,tt){return{min:Qe,q1:Math.min(Ne,tt),med:tt,q3:Math.max(Ne,tt),max:Ge}}Ge.exports=function(Ne,Ge){var Qe=Ne._fullLayout,it=rt.getFromId(Ne,Ge.xaxis),ot=rt.getFromId(Ne,Ge.yaxis),dt=it.makeCalcdata(Ge,"x"),ht=nt(Ge,it,"x",dt),Dt=at(Ne,Ge,dt,ht,ot,ptFunc);return Dt.length?(tt.extendFlat(Dt[0].t,{num:Qe._numBoxes,dPos:tt.distinctVals(ht).minDiff/2,posLetter:"x",valLetter:"y"}),Qe._numBoxes++,Dt):[{t:{empty:!0}}]}},{"../../lib":778,"../../plots/cartesian/align_period":825,"../../plots/cartesian/axes":828,"../ohlc/calc":1134}],960:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../components/color"),nt=Ne("../ohlc/ohlc_defaults"),at=Ne("../scatter/period_defaults"),it=Ne("./attributes");function handleDirection(Ne,Ge,Qe,tt){var nt=Qe(tt+".line.color");Qe(tt+".line.width",Ge.line.width),Qe(tt+".fillcolor",rt.addOpacity(nt,.5))}Ge.exports=function(Ne,Ge,Qe,rt){function coerce(Qe,rt){return tt.coerce(Ne,Ge,it,Qe,rt)}nt(Ne,Ge,coerce,rt)?(at(Ne,Ge,rt,coerce,{x:!0}),coerce("line.width"),handleDirection(Ne,Ge,coerce,"increasing"),handleDirection(Ne,Ge,coerce,"decreasing"),coerce("text"),coerce("hovertext"),coerce("whiskerwidth"),rt._requestRangeslider[Ge.xaxis]=!0):Ge.visible=!1}},{"../../components/color":643,"../../lib":778,"../ohlc/ohlc_defaults":1138,"../scatter/period_defaults":1207,"./attributes":958}],961:[function(Ne,Ge,Qe){"use strict";Ge.exports={moduleType:"trace",name:"candlestick",basePlotModule:Ne("../../plots/cartesian"),categories:["cartesian","svg","showLegend","candlestick","boxLayout"],meta:{},attributes:Ne("./attributes"),layoutAttributes:Ne("../box/layout_attributes"),supplyLayoutDefaults:Ne("../box/layout_defaults").supplyLayoutDefaults,crossTraceCalc:Ne("../box/cross_trace_calc").crossTraceCalc,supplyDefaults:Ne("./defaults"),calc:Ne("./calc"),plot:Ne("../box/plot").plot,layerName:"boxlayer",style:Ne("../box/style").style,hoverPoints:Ne("../ohlc/hover").hoverPoints,selectPoints:Ne("../ohlc/select")}},{"../../plots/cartesian":841,"../box/cross_trace_calc":948,"../box/layout_attributes":953,"../box/layout_defaults":954,"../box/plot":955,"../box/style":957,"../ohlc/hover":1136,"../ohlc/select":1140,"./attributes":958,"./calc":959,"./defaults":960}],962:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./axis_defaults"),rt=Ne("../../plot_api/plot_template");function mimickAxisDefaults(Ne,Ge,Qe,nt){["aaxis","baxis"].forEach((function(at){var it=at.charAt(0),ot=Ne[at]||{},dt=rt.newContainer(Ge,at),ht={tickfont:"x",id:it+"axis",letter:it,font:Ge.font,name:at,data:Ne[it],calendar:Ge.calendar,dfltColor:nt,bgColor:Qe.paper_bgcolor,autotypenumbersDflt:Qe.autotypenumbers,fullLayout:Qe};tt(ot,dt,ht),dt._categories=dt._categories||[],Ne[at]||"-"===ot.type||(Ne[at]={type:ot.type})}))}Ge.exports=function(Ne,Ge,Qe,tt,rt){tt("a")||(tt("da"),tt("a0")),tt("b")||(tt("db"),tt("b0")),mimickAxisDefaults(Ne,Ge,Qe,rt)}},{"../../plot_api/plot_template":817,"./axis_defaults":967}],963:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib").isArrayOrTypedArray;function minMax(Ne,Ge){if(!tt(Ne)||Ge>=10)return null;for(var Qe=1/0,rt=-1/0,nt=Ne.length,at=0;at<nt;at++){var it=Ne[at];if(tt(it)){var ot=minMax(it,Ge+1);ot&&(Qe=Math.min(ot[0],Qe),rt=Math.max(ot[1],rt))}else Qe=Math.min(it,Qe),rt=Math.max(it,rt)}return[Qe,rt]}Ge.exports=function(Ne){return minMax(Ne,0)}},{"../../lib":778}],964:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/font_attributes"),rt=Ne("./axis_attributes"),nt=Ne("../../components/color/attributes"),at=tt({editType:"calc"});at.family.dflt='"Open Sans", verdana, arial, sans-serif',at.size.dflt=12,at.color.dflt=nt.defaultLine,Ge.exports={carpet:{valType:"string",editType:"calc"},x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},a:{valType:"data_array",editType:"calc"},a0:{valType:"number",dflt:0,editType:"calc"},da:{valType:"number",dflt:1,editType:"calc"},b:{valType:"data_array",editType:"calc"},b0:{valType:"number",dflt:0,editType:"calc"},db:{valType:"number",dflt:1,editType:"calc"},cheaterslope:{valType:"number",dflt:1,editType:"calc"},aaxis:rt,baxis:rt,font:at,color:{valType:"color",dflt:nt.defaultLine,editType:"plot"},transforms:void 0}},{"../../components/color/attributes":642,"../../plots/font_attributes":856,"./axis_attributes":966}],965:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib").isArrayOrTypedArray;Ge.exports=function(Ne,Ge,Qe,rt){var nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt,er,dr,mr,xr=tt(Qe)?"a":"b",br=("a"===xr?Ne.aaxis:Ne.baxis).smoothing,Ar="a"===xr?Ne.a2i:Ne.b2j,en="a"===xr?Qe:rt,mn="a"===xr?rt:Qe,xn="a"===xr?Ge.a.length:Ge.b.length,kn="a"===xr?Ge.b.length:Ge.a.length,Cn=Math.floor("a"===xr?Ne.b2j(mn):Ne.a2i(mn)),En="a"===xr?function(Ge){return Ne.evalxy([],Ge,Cn)}:function(Ge){return Ne.evalxy([],Cn,Ge)};br&&(it=Math.max(0,Math.min(kn-2,Cn)),ot=Cn-it,at="a"===xr?function(Ge,Qe){return Ne.dxydi([],Ge,it,Qe,ot)}:function(Ge,Qe){return Ne.dxydj([],it,Ge,ot,Qe)});var Pn=Ar(en[0]),Dn=Ar(en[1]),In=Pn<Dn?1:-1,zn=1e-8*(Dn-Pn),Bn=In>0?Math.floor:Math.ceil,Vn=In>0?Math.ceil:Math.floor,Hn=In>0?Math.min:Math.max,qn=In>0?Math.max:Math.min,Yn=Bn(Pn+zn),$n=Vn(Dn-zn),ra=[[Dt=En(Pn)]];for(nt=Yn;nt*In<$n*In;nt+=In)dt=[],er=qn(Pn,nt),mr=(dr=Hn(Dn,nt+In))-er,ht=Math.max(0,Math.min(xn-2,Math.floor(.5*(er+dr)))),Ot=En(dr),br&&(Rt=at(ht,er-ht),Zt=at(ht,dr-ht),dt.push([Dt[0]+Rt[0]/3*mr,Dt[1]+Rt[1]/3*mr]),dt.push([Ot[0]-Zt[0]/3*mr,Ot[1]-Zt[1]/3*mr])),dt.push(Ot),ra.push(dt),Dt=Ot;return ra}},{"../../lib":778}],966:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/font_attributes"),rt=Ne("../../components/color/attributes"),nt=Ne("../../plots/cartesian/layout_attributes"),at=Ne("../../plot_api/edit_types").overrideAll;Ne("../../constants/docs").FORMAT_LINK,Ne("../../constants/docs").TIME_FORMAT_LINK,Ge.exports={color:{valType:"color",editType:"calc"},smoothing:{valType:"number",dflt:1,min:0,max:1.3,editType:"calc"},title:{text:{valType:"string",dflt:"",editType:"calc"},font:tt({editType:"calc"}),offset:{valType:"number",dflt:10,editType:"calc"},editType:"calc"},type:{valType:"enumerated",values:["-","linear","date","category"],dflt:"-",editType:"calc"},autotypenumbers:nt.autotypenumbers,autorange:{valType:"enumerated",values:[!0,!1,"reversed"],dflt:!0,editType:"calc"},rangemode:{valType:"enumerated",values:["normal","tozero","nonnegative"],dflt:"normal",editType:"calc"},range:{valType:"info_array",editType:"calc",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}]},fixedrange:{valType:"boolean",dflt:!1,editType:"calc"},cheatertype:{valType:"enumerated",values:["index","value"],dflt:"value",editType:"calc"},tickmode:{valType:"enumerated",values:["linear","array"],dflt:"array",editType:"calc"},nticks:{valType:"integer",min:0,dflt:0,editType:"calc"},tickvals:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},showticklabels:{valType:"enumerated",values:["start","end","both","none"],dflt:"start",editType:"calc"},tickfont:tt({editType:"calc"}),tickangle:{valType:"angle",dflt:"auto",editType:"calc"},tickprefix:{valType:"string",dflt:"",editType:"calc"},showtickprefix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},ticksuffix:{valType:"string",dflt:"",editType:"calc"},showticksuffix:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},showexponent:{valType:"enumerated",values:["all","first","last","none"],dflt:"all",editType:"calc"},exponentformat:{valType:"enumerated",values:["none","e","E","power","SI","B"],dflt:"B",editType:"calc"},minexponent:{valType:"number",dflt:3,min:0,editType:"calc"},separatethousands:{valType:"boolean",dflt:!1,editType:"calc"},tickformat:{valType:"string",dflt:"",editType:"calc"},tickformatstops:at(nt.tickformatstops,"calc","from-root"),categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},labelpadding:{valType:"integer",dflt:10,editType:"calc"},labelprefix:{valType:"string",editType:"calc"},labelsuffix:{valType:"string",dflt:"",editType:"calc"},showline:{valType:"boolean",dflt:!1,editType:"calc"},linecolor:{valType:"color",dflt:rt.defaultLine,editType:"calc"},linewidth:{valType:"number",min:0,dflt:1,editType:"calc"},gridcolor:{valType:"color",editType:"calc"},gridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},showgrid:{valType:"boolean",dflt:!0,editType:"calc"},minorgridcount:{valType:"integer",min:0,dflt:0,editType:"calc"},minorgridwidth:{valType:"number",min:0,dflt:1,editType:"calc"},minorgridcolor:{valType:"color",dflt:rt.lightLine,editType:"calc"},startline:{valType:"boolean",editType:"calc"},startlinecolor:{valType:"color",editType:"calc"},startlinewidth:{valType:"number",dflt:1,editType:"calc"},endline:{valType:"boolean",editType:"calc"},endlinewidth:{valType:"number",dflt:1,editType:"calc"},endlinecolor:{valType:"color",editType:"calc"},tick0:{valType:"number",min:0,dflt:0,editType:"calc"},dtick:{valType:"number",min:0,dflt:1,editType:"calc"},arraytick0:{valType:"integer",min:0,dflt:0,editType:"calc"},arraydtick:{valType:"integer",min:1,dflt:1,editType:"calc"},_deprecated:{title:{valType:"string",editType:"calc"},titlefont:tt({editType:"calc"}),titleoffset:{valType:"number",dflt:10,editType:"calc"}},editType:"calc"}},{"../../components/color/attributes":642,"../../constants/docs":748,"../../plot_api/edit_types":810,"../../plots/cartesian/layout_attributes":842,"../../plots/font_attributes":856}],967:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./attributes"),rt=Ne("../../components/color").addOpacity,nt=Ne("../../registry"),at=Ne("../../lib"),it=Ne("../../plots/cartesian/tick_value_defaults"),ot=Ne("../../plots/cartesian/tick_label_defaults"),dt=Ne("../../plots/cartesian/category_order_defaults"),ht=Ne("../../plots/cartesian/set_convert"),Dt=Ne("../../plots/cartesian/axis_autotype");function setAutoType(Ne,Ge){if("-"===Ne.type){var Qe=Ne[Ne._id.charAt(0)+"calendar"];Ne.type=Dt(Ge,Qe,{autotypenumbers:Ne.autotypenumbers})}}Ge.exports=function(Ne,Ge,Qe){var Dt=Qe.letter,Ot=Qe.font||{},Rt=tt[Dt+"axis"];function coerce(Qe,tt){return at.coerce(Ne,Ge,Rt,Qe,tt)}function coerce2(Qe,tt){return at.coerce2(Ne,Ge,Rt,Qe,tt)}Qe.name&&(Ge._name=Qe.name,Ge._id=Qe.name),coerce("autotypenumbers",Qe.autotypenumbersDflt);var Zt=coerce("type");"-"===Zt&&(Qe.data&&setAutoType(Ge,Qe.data),"-"===Ge.type?Ge.type="linear":Zt=Ne.type=Ge.type),coerce("smoothing"),coerce("cheatertype"),coerce("showticklabels"),coerce("labelprefix",Dt+" = "),coerce("labelsuffix"),coerce("showtickprefix"),coerce("showticksuffix"),coerce("separatethousands"),coerce("tickformat"),coerce("exponentformat"),coerce("minexponent"),coerce("showexponent"),coerce("categoryorder"),coerce("tickmode"),coerce("tickvals"),coerce("ticktext"),coerce("tick0"),coerce("dtick"),"array"===Ge.tickmode&&(coerce("arraytick0"),coerce("arraydtick")),coerce("labelpadding"),Ge._hovertitle=Dt,"date"===Zt&&nt.getComponentMethod("calendars","handleDefaults")(Ne,Ge,"calendar",Qe.calendar),ht(Ge,Qe.fullLayout),Ge.c2p=at.identity;var er=coerce("color",Qe.dfltColor),dr=er===Ne.color?er:Ot.color;coerce("title.text")&&(at.coerceFont(coerce,"title.font",{family:Ot.family,size:Math.round(1.2*Ot.size),color:dr}),coerce("title.offset")),coerce("tickangle"),coerce("autorange",!Ge.isValidRange(Ne.range))&&coerce("rangemode"),coerce("range"),Ge.cleanRange(),coerce("fixedrange"),it(Ne,Ge,coerce,Zt),ot(Ne,Ge,coerce,Zt,Qe),dt(Ne,Ge,coerce,{data:Qe.data,dataAttr:Dt});var mr=coerce2("gridcolor",rt(er,.3)),xr=coerce2("gridwidth"),br=coerce("showgrid");br||(delete Ge.gridcolor,delete Ge.gridwidth);var Ar=coerce2("startlinecolor",er),en=coerce2("startlinewidth",xr);coerce("startline",Ge.showgrid||!!Ar||!!en)||(delete Ge.startlinecolor,delete Ge.startlinewidth);var mn=coerce2("endlinecolor",er),xn=coerce2("endlinewidth",xr);return coerce("endline",Ge.showgrid||!!mn||!!xn)||(delete Ge.endlinecolor,delete Ge.endlinewidth),br?(coerce("minorgridcount"),coerce("minorgridwidth",xr),coerce("minorgridcolor",rt(mr,.06)),Ge.minorgridcount||(delete Ge.minorgridwidth,delete Ge.minorgridcolor)):(delete Ge.gridcolor,delete Ge.gridWidth),"none"===Ge.showticklabels&&(delete Ge.tickfont,delete Ge.tickangle,delete Ge.showexponent,delete Ge.exponentformat,delete Ge.minexponent,delete Ge.tickformat,delete Ge.showticksuffix,delete Ge.showtickprefix),Ge.showticksuffix||delete Ge.ticksuffix,Ge.showtickprefix||delete Ge.tickprefix,coerce("tickmode"),Ge}},{"../../components/color":643,"../../lib":778,"../../plots/cartesian/axis_autotype":829,"../../plots/cartesian/category_order_defaults":832,"../../plots/cartesian/set_convert":848,"../../plots/cartesian/tick_label_defaults":849,"../../plots/cartesian/tick_value_defaults":851,"../../registry":911,"./attributes":964}],968:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/cartesian/axes"),rt=Ne("../../lib").isArray1D,nt=Ne("./cheater_basis"),at=Ne("./array_minmax"),it=Ne("./calc_gridlines"),ot=Ne("./calc_labels"),dt=Ne("./calc_clippath"),ht=Ne("../heatmap/clean_2d_array"),Dt=Ne("./smooth_fill_2d_array"),Ot=Ne("../heatmap/convert_column_xyz"),Rt=Ne("./set_convert");Ge.exports=function(Ne,Ge){var Qe=tt.getFromId(Ne,Ge.xaxis),Zt=tt.getFromId(Ne,Ge.yaxis),er=Ge.aaxis,dr=Ge.baxis,mr=Ge.x,xr=Ge.y,br=[];mr&&rt(mr)&&br.push("x"),xr&&rt(xr)&&br.push("y"),br.length&&Ot(Ge,er,dr,"a","b",br);var Ar=Ge._a=Ge._a||Ge.a,en=Ge._b=Ge._b||Ge.b;mr=Ge._x||Ge.x,xr=Ge._y||Ge.y;var mn={};if(Ge._cheater){var xn="index"===er.cheatertype?Ar.length:Ar,kn="index"===dr.cheatertype?en.length:en;mr=nt(xn,kn,Ge.cheaterslope)}Ge._x=mr=ht(mr),Ge._y=xr=ht(xr),Dt(mr,Ar,en),Dt(xr,Ar,en),Rt(Ge),Ge.setScale();var Cn=at(mr),En=at(xr),Pn=.5*(Cn[1]-Cn[0]),Dn=.5*(Cn[1]+Cn[0]),In=.5*(En[1]-En[0]),zn=.5*(En[1]+En[0]),Bn=1.3;return Cn=[Dn-Pn*Bn,Dn+Pn*Bn],En=[zn-In*Bn,zn+In*Bn],Ge._extremes[Qe._id]=tt.findExtremes(Qe,Cn,{padded:!0}),Ge._extremes[Zt._id]=tt.findExtremes(Zt,En,{padded:!0}),it(Ge,"a","b"),it(Ge,"b","a"),ot(Ge,er),ot(Ge,dr),mn.clipsegments=dt(Ge._xctrl,Ge._yctrl,er,dr),mn.x=mr,mn.y=xr,mn.a=Ar,mn.b=en,[mn]}},{"../../lib":778,"../../plots/cartesian/axes":828,"../heatmap/clean_2d_array":1067,"../heatmap/convert_column_xyz":1069,"./array_minmax":963,"./calc_clippath":969,"./calc_gridlines":970,"./calc_labels":971,"./cheater_basis":973,"./set_convert":986,"./smooth_fill_2d_array":987}],969:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge,Qe,tt){var rt,nt,at,it=[],ot=!!Qe.smoothing,dt=!!tt.smoothing,ht=Ne[0].length-1,Dt=Ne.length-1;for(rt=0,nt=[],at=[];rt<=ht;rt++)nt[rt]=Ne[0][rt],at[rt]=Ge[0][rt];for(it.push({x:nt,y:at,bicubic:ot}),rt=0,nt=[],at=[];rt<=Dt;rt++)nt[rt]=Ne[rt][ht],at[rt]=Ge[rt][ht];for(it.push({x:nt,y:at,bicubic:dt}),rt=ht,nt=[],at=[];rt>=0;rt--)nt[ht-rt]=Ne[Dt][rt],at[ht-rt]=Ge[Dt][rt];for(it.push({x:nt,y:at,bicubic:ot}),rt=Dt,nt=[],at=[];rt>=0;rt--)nt[Dt-rt]=Ne[rt][0],at[Dt-rt]=Ge[rt][0];return it.push({x:nt,y:at,bicubic:dt}),it}},{}],970:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/cartesian/axes"),rt=Ne("../../lib/extend").extendFlat;Ge.exports=function(Ne,Ge,Qe){var nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt,er,dr,mr,xr,br=Ne["_"+Ge],Ar=Ne[Ge+"axis"],en=Ar._gridlines=[],mn=Ar._minorgridlines=[],xn=Ar._boundarylines=[],kn=Ne["_"+Qe],Cn=Ne[Qe+"axis"];"array"===Ar.tickmode&&(Ar.tickvals=br.slice());var En=Ne._xctrl,Pn=Ne._yctrl,Dn=En[0].length,In=En.length,zn=Ne._a.length,Bn=Ne._b.length;tt.prepTicks(Ar),"array"===Ar.tickmode&&delete Ar.tickvals;var Vn=Ar.smoothing?3:1;function constructValueGridline(tt){var rt,nt,at,it,ot,dt,ht,Dt,Rt,Zt,er,dr,mr=[],xr=[],br={};if("b"===Ge)for(nt=Ne.b2j(tt),at=Math.floor(Math.max(0,Math.min(Bn-2,nt))),it=nt-at,br.length=Bn,br.crossLength=zn,br.xy=function(Ge){return Ne.evalxy([],Ge,nt)},br.dxy=function(Ge,Qe){return Ne.dxydi([],Ge,at,Qe,it)},rt=0;rt<zn;rt++)dt=Math.min(zn-2,rt),ht=rt-dt,Dt=Ne.evalxy([],rt,nt),Cn.smoothing&&rt>0&&(Rt=Ne.dxydi([],rt-1,at,0,it),mr.push(ot[0]+Rt[0]/3),xr.push(ot[1]+Rt[1]/3),Zt=Ne.dxydi([],rt-1,at,1,it),mr.push(Dt[0]-Zt[0]/3),xr.push(Dt[1]-Zt[1]/3)),mr.push(Dt[0]),xr.push(Dt[1]),ot=Dt;else for(rt=Ne.a2i(tt),dt=Math.floor(Math.max(0,Math.min(zn-2,rt))),ht=rt-dt,br.length=zn,br.crossLength=Bn,br.xy=function(Ge){return Ne.evalxy([],rt,Ge)},br.dxy=function(Ge,Qe){return Ne.dxydj([],dt,Ge,ht,Qe)},nt=0;nt<Bn;nt++)at=Math.min(Bn-2,nt),it=nt-at,Dt=Ne.evalxy([],rt,nt),Cn.smoothing&&nt>0&&(er=Ne.dxydj([],dt,nt-1,ht,0),mr.push(ot[0]+er[0]/3),xr.push(ot[1]+er[1]/3),dr=Ne.dxydj([],dt,nt-1,ht,1),mr.push(Dt[0]-dr[0]/3),xr.push(Dt[1]-dr[1]/3)),mr.push(Dt[0]),xr.push(Dt[1]),ot=Dt;return br.axisLetter=Ge,br.axis=Ar,br.crossAxis=Cn,br.value=tt,br.constvar=Qe,br.index=Ot,br.x=mr,br.y=xr,br.smoothing=Cn.smoothing,br}function constructArrayGridline(tt){var rt,nt,at,it,ot,dt=[],ht=[],Dt={};if(Dt.length=br.length,Dt.crossLength=kn.length,"b"===Ge)for(at=Math.max(0,Math.min(Bn-2,tt)),ot=Math.min(1,Math.max(0,tt-at)),Dt.xy=function(Ge){return Ne.evalxy([],Ge,tt)},Dt.dxy=function(Ge,Qe){return Ne.dxydi([],Ge,at,Qe,ot)},rt=0;rt<Dn;rt++)dt[rt]=En[tt*Vn][rt],ht[rt]=Pn[tt*Vn][rt];else for(nt=Math.max(0,Math.min(zn-2,tt)),it=Math.min(1,Math.max(0,tt-nt)),Dt.xy=function(Ge){return Ne.evalxy([],tt,Ge)},Dt.dxy=function(Ge,Qe){return Ne.dxydj([],nt,Ge,it,Qe)},rt=0;rt<In;rt++)dt[rt]=En[rt][tt*Vn],ht[rt]=Pn[rt][tt*Vn];return Dt.axisLetter=Ge,Dt.axis=Ar,Dt.crossAxis=Cn,Dt.value=br[tt],Dt.constvar=Qe,Dt.index=tt,Dt.x=dt,Dt.y=ht,Dt.smoothing=Cn.smoothing,Dt}if("array"===Ar.tickmode){for(ot=5e-15,ht=(dt=[Math.floor((br.length-1-Ar.arraytick0)/Ar.arraydtick*(1+ot)),Math.ceil(-Ar.arraytick0/Ar.arraydtick/(1+ot))].sort((function(Ne,Ge){return Ne-Ge})))[0]-1,Dt=dt[1]+1,Ot=ht;Ot<Dt;Ot++)(at=Ar.arraytick0+Ar.arraydtick*Ot)<0||at>br.length-1||en.push(rt(constructArrayGridline(at),{color:Ar.gridcolor,width:Ar.gridwidth}));for(Ot=ht;Ot<Dt;Ot++)if(it=Ar.arraytick0+Ar.arraydtick*Ot,er=Math.min(it+Ar.arraydtick,br.length-1),!(it<0||it>br.length-1||er<0||er>br.length-1))for(dr=br[it],mr=br[er],nt=0;nt<Ar.minorgridcount;nt++)(xr=er-it)<=0||(Zt=dr+(mr-dr)*(nt+1)/(Ar.minorgridcount+1)*(Ar.arraydtick/xr))<br[0]||Zt>br[br.length-1]||mn.push(rt(constructValueGridline(Zt),{color:Ar.minorgridcolor,width:Ar.minorgridwidth}));Ar.startline&&xn.push(rt(constructArrayGridline(0),{color:Ar.startlinecolor,width:Ar.startlinewidth})),Ar.endline&&xn.push(rt(constructArrayGridline(br.length-1),{color:Ar.endlinecolor,width:Ar.endlinewidth}))}else{for(ot=5e-15,ht=(dt=[Math.floor((br[br.length-1]-Ar.tick0)/Ar.dtick*(1+ot)),Math.ceil((br[0]-Ar.tick0)/Ar.dtick/(1+ot))].sort((function(Ne,Ge){return Ne-Ge})))[0],Dt=dt[1],Ot=ht;Ot<=Dt;Ot++)Rt=Ar.tick0+Ar.dtick*Ot,en.push(rt(constructValueGridline(Rt),{color:Ar.gridcolor,width:Ar.gridwidth}));for(Ot=ht-1;Ot<Dt+1;Ot++)for(Rt=Ar.tick0+Ar.dtick*Ot,nt=0;nt<Ar.minorgridcount;nt++)(Zt=Rt+Ar.dtick*(nt+1)/(Ar.minorgridcount+1))<br[0]||Zt>br[br.length-1]||mn.push(rt(constructValueGridline(Zt),{color:Ar.minorgridcolor,width:Ar.minorgridwidth}));Ar.startline&&xn.push(rt(constructValueGridline(br[0]),{color:Ar.startlinecolor,width:Ar.startlinewidth})),Ar.endline&&xn.push(rt(constructValueGridline(br[br.length-1]),{color:Ar.endlinecolor,width:Ar.endlinewidth}))}}},{"../../lib/extend":768,"../../plots/cartesian/axes":828}],971:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/cartesian/axes"),rt=Ne("../../lib/extend").extendFlat;Ge.exports=function(Ne,Ge){var Qe,nt,at,it,ot,dt=Ge._labels=[],ht=Ge._gridlines;for(Qe=0;Qe<ht.length;Qe++)ot=ht[Qe],-1!==["start","both"].indexOf(Ge.showticklabels)&&(nt=tt.tickText(Ge,ot.value),rt(nt,{prefix:at,suffix:it,endAnchor:!0,xy:ot.xy(0),dxy:ot.dxy(0,0),axis:ot.axis,length:ot.crossAxis.length,font:ot.axis.tickfont,isFirst:0===Qe,isLast:Qe===ht.length-1}),dt.push(nt)),-1!==["end","both"].indexOf(Ge.showticklabels)&&(nt=tt.tickText(Ge,ot.value),rt(nt,{endAnchor:!1,xy:ot.xy(ot.crossLength-1),dxy:ot.dxy(ot.crossLength-2,1),axis:ot.axis,length:ot.crossAxis.length,font:ot.axis.tickfont,isFirst:0===Qe,isLast:Qe===ht.length-1}),dt.push(nt))}},{"../../lib/extend":768,"../../plots/cartesian/axes":828}],972:[function(Ne,Ge,Qe){"use strict";var tt=.5;Ge.exports=function(Ne,Ge,Qe,rt){var nt=Ne[0]-Ge[0],at=Ne[1]-Ge[1],it=Qe[0]-Ge[0],ot=Qe[1]-Ge[1],dt=Math.pow(nt*nt+at*at,tt/2),ht=Math.pow(it*it+ot*ot,tt/2),Dt=(ht*ht*nt-dt*dt*it)*rt,Ot=(ht*ht*at-dt*dt*ot)*rt,Rt=ht*(dt+ht)*3,Zt=dt*(dt+ht)*3;return[[Ge[0]+(Rt&&Dt/Rt),Ge[1]+(Rt&&Ot/Rt)],[Ge[0]-(Zt&&Dt/Zt),Ge[1]-(Zt&&Ot/Zt)]]}},{}],973:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib").isArrayOrTypedArray;Ge.exports=function(Ne,Ge,Qe){var rt,nt,at,it,ot,dt,ht=[],Dt=tt(Ne)?Ne.length:Ne,Ot=tt(Ge)?Ge.length:Ge,Rt=tt(Ne)?Ne:null,Zt=tt(Ge)?Ge:null;Rt&&(at=(Rt.length-1)/(Rt[Rt.length-1]-Rt[0])/(Dt-1)),Zt&&(it=(Zt.length-1)/(Zt[Zt.length-1]-Zt[0])/(Ot-1));var er=1/0,dr=-1/0;for(nt=0;nt<Ot;nt++)for(ht[nt]=[],ot=Zt?(Zt[nt]-Zt[0])*it:nt/(Ot-1),rt=0;rt<Dt;rt++)dt=(Rt?(Rt[rt]-Rt[0])*at:rt/(Dt-1))-ot*Qe,er=Math.min(dt,er),dr=Math.max(dt,dr),ht[nt][rt]=dt;var mr=1/(dr-er),xr=-er*mr;for(nt=0;nt<Ot;nt++)for(rt=0;rt<Dt;rt++)ht[nt][rt]=mr*ht[nt][rt]+xr;return ht}},{"../../lib":778}],974:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./catmull_rom"),rt=Ne("../../lib").ensureArray;function inferCubicControlPoint(Ne,Ge,Qe){var tt=-.5*Qe[0]+1.5*Ge[0],rt=-.5*Qe[1]+1.5*Ge[1];return[(2*tt+Ne[0])/3,(2*rt+Ne[1])/3]}Ge.exports=function(Ne,Ge,Qe,nt,at,it){var ot,dt,ht,Dt,Ot,Rt,Zt,er,dr,mr,xr=Qe[0].length,br=Qe.length,Ar=at?3*xr-2:xr,en=it?3*br-2:br;for(Ne=rt(Ne,en),Ge=rt(Ge,en),ht=0;ht<en;ht++)Ne[ht]=rt(Ne[ht],Ar),Ge[ht]=rt(Ge[ht],Ar);for(dt=0,Dt=0;dt<br;dt++,Dt+=it?3:1)for(Ot=Ne[Dt],Rt=Ge[Dt],Zt=Qe[dt],er=nt[dt],ot=0,ht=0;ot<xr;ot++,ht+=at?3:1)Ot[ht]=Zt[ot],Rt[ht]=er[ot];if(at)for(dt=0,Dt=0;dt<br;dt++,Dt+=it?3:1){for(ot=1,ht=3;ot<xr-1;ot++,ht+=3)dr=tt([Qe[dt][ot-1],nt[dt][ot-1]],[Qe[dt][ot],nt[dt][ot]],[Qe[dt][ot+1],nt[dt][ot+1]],at),Ne[Dt][ht-1]=dr[0][0],Ge[Dt][ht-1]=dr[0][1],Ne[Dt][ht+1]=dr[1][0],Ge[Dt][ht+1]=dr[1][1];mr=inferCubicControlPoint([Ne[Dt][0],Ge[Dt][0]],[Ne[Dt][2],Ge[Dt][2]],[Ne[Dt][3],Ge[Dt][3]]),Ne[Dt][1]=mr[0],Ge[Dt][1]=mr[1],mr=inferCubicControlPoint([Ne[Dt][Ar-1],Ge[Dt][Ar-1]],[Ne[Dt][Ar-3],Ge[Dt][Ar-3]],[Ne[Dt][Ar-4],Ge[Dt][Ar-4]]),Ne[Dt][Ar-2]=mr[0],Ge[Dt][Ar-2]=mr[1]}if(it)for(ht=0;ht<Ar;ht++){for(Dt=3;Dt<en-3;Dt+=3)dr=tt([Ne[Dt-3][ht],Ge[Dt-3][ht]],[Ne[Dt][ht],Ge[Dt][ht]],[Ne[Dt+3][ht],Ge[Dt+3][ht]],it),Ne[Dt-1][ht]=dr[0][0],Ge[Dt-1][ht]=dr[0][1],Ne[Dt+1][ht]=dr[1][0],Ge[Dt+1][ht]=dr[1][1];mr=inferCubicControlPoint([Ne[0][ht],Ge[0][ht]],[Ne[2][ht],Ge[2][ht]],[Ne[3][ht],Ge[3][ht]]),Ne[1][ht]=mr[0],Ge[1][ht]=mr[1],mr=inferCubicControlPoint([Ne[en-1][ht],Ge[en-1][ht]],[Ne[en-3][ht],Ge[en-3][ht]],[Ne[en-4][ht],Ge[en-4][ht]]),Ne[en-2][ht]=mr[0],Ge[en-2][ht]=mr[1]}if(at&&it)for(Dt=1;Dt<en;Dt+=(Dt+1)%3==0?2:1){for(ht=3;ht<Ar-3;ht+=3)dr=tt([Ne[Dt][ht-3],Ge[Dt][ht-3]],[Ne[Dt][ht],Ge[Dt][ht]],[Ne[Dt][ht+3],Ge[Dt][ht+3]],at),Ne[Dt][ht-1]=.5*(Ne[Dt][ht-1]+dr[0][0]),Ge[Dt][ht-1]=.5*(Ge[Dt][ht-1]+dr[0][1]),Ne[Dt][ht+1]=.5*(Ne[Dt][ht+1]+dr[1][0]),Ge[Dt][ht+1]=.5*(Ge[Dt][ht+1]+dr[1][1]);mr=inferCubicControlPoint([Ne[Dt][0],Ge[Dt][0]],[Ne[Dt][2],Ge[Dt][2]],[Ne[Dt][3],Ge[Dt][3]]),Ne[Dt][1]=.5*(Ne[Dt][1]+mr[0]),Ge[Dt][1]=.5*(Ge[Dt][1]+mr[1]),mr=inferCubicControlPoint([Ne[Dt][Ar-1],Ge[Dt][Ar-1]],[Ne[Dt][Ar-3],Ge[Dt][Ar-3]],[Ne[Dt][Ar-4],Ge[Dt][Ar-4]]),Ne[Dt][Ar-2]=.5*(Ne[Dt][Ar-2]+mr[0]),Ge[Dt][Ar-2]=.5*(Ge[Dt][Ar-2]+mr[1])}return[Ne,Ge]}},{"../../lib":778,"./catmull_rom":972}],975:[function(Ne,Ge,Qe){"use strict";Ge.exports={RELATIVE_CULL_TOLERANCE:1e-6}},{}],976:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge,Qe){return Ge&&Qe?function(Ge,Qe,tt,rt,nt){var at,it,ot,dt,ht,Dt;Ge||(Ge=[]),Qe*=3,tt*=3;var Ot=rt*rt,Rt=1-rt,Zt=Rt*Rt,er=Rt*rt*2,dr=-3*Zt,mr=3*(Zt-er),xr=3*(er-Ot),br=3*Ot,Ar=nt*nt,en=Ar*nt,mn=1-nt,xn=mn*mn,kn=xn*mn;for(Dt=0;Dt<Ne.length;Dt++)at=dr*(ht=Ne[Dt])[tt][Qe]+mr*ht[tt][Qe+1]+xr*ht[tt][Qe+2]+br*ht[tt][Qe+3],it=dr*ht[tt+1][Qe]+mr*ht[tt+1][Qe+1]+xr*ht[tt+1][Qe+2]+br*ht[tt+1][Qe+3],ot=dr*ht[tt+2][Qe]+mr*ht[tt+2][Qe+1]+xr*ht[tt+2][Qe+2]+br*ht[tt+2][Qe+3],dt=dr*ht[tt+3][Qe]+mr*ht[tt+3][Qe+1]+xr*ht[tt+3][Qe+2]+br*ht[tt+3][Qe+3],Ge[Dt]=kn*at+3*(xn*nt*it+mn*Ar*ot)+en*dt;return Ge}:Ge?function(Ge,Qe,tt,rt,nt){var at,it,ot,dt;Ge||(Ge=[]),Qe*=3;var ht=rt*rt,Dt=1-rt,Ot=Dt*Dt,Rt=Dt*rt*2,Zt=-3*Ot,er=3*(Ot-Rt),dr=3*(Rt-ht),mr=3*ht,xr=1-nt;for(ot=0;ot<Ne.length;ot++)at=Zt*(dt=Ne[ot])[tt][Qe]+er*dt[tt][Qe+1]+dr*dt[tt][Qe+2]+mr*dt[tt][Qe+3],it=Zt*dt[tt+1][Qe]+er*dt[tt+1][Qe+1]+dr*dt[tt+1][Qe+2]+mr*dt[tt+1][Qe+3],Ge[ot]=xr*at+nt*it;return Ge}:Qe?function(Ge,Qe,tt,rt,nt){var at,it,ot,dt,ht,Dt;Ge||(Ge=[]),tt*=3;var Ot=nt*nt,Rt=Ot*nt,Zt=1-nt,er=Zt*Zt,dr=er*Zt;for(ht=0;ht<Ne.length;ht++)at=(Dt=Ne[ht])[tt][Qe+1]-Dt[tt][Qe],it=Dt[tt+1][Qe+1]-Dt[tt+1][Qe],ot=Dt[tt+2][Qe+1]-Dt[tt+2][Qe],dt=Dt[tt+3][Qe+1]-Dt[tt+3][Qe],Ge[ht]=dr*at+3*(er*nt*it+Zt*Ot*ot)+Rt*dt;return Ge}:function(Ge,Qe,tt,rt,nt){var at,it,ot,dt;Ge||(Ge=[]);var ht=1-nt;for(ot=0;ot<Ne.length;ot++)at=(dt=Ne[ot])[tt][Qe+1]-dt[tt][Qe],it=dt[tt+1][Qe+1]-dt[tt+1][Qe],Ge[ot]=ht*at+nt*it;return Ge}}},{}],977:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge,Qe){return Ge&&Qe?function(Ge,Qe,tt,rt,nt){var at,it,ot,dt,ht,Dt;Ge||(Ge=[]),Qe*=3,tt*=3;var Ot=rt*rt,Rt=Ot*rt,Zt=1-rt,er=Zt*Zt,dr=er*Zt,mr=nt*nt,xr=1-nt,br=xr*xr,Ar=xr*nt*2,en=-3*br,mn=3*(br-Ar),xn=3*(Ar-mr),kn=3*mr;for(Dt=0;Dt<Ne.length;Dt++)at=en*(ht=Ne[Dt])[tt][Qe]+mn*ht[tt+1][Qe]+xn*ht[tt+2][Qe]+kn*ht[tt+3][Qe],it=en*ht[tt][Qe+1]+mn*ht[tt+1][Qe+1]+xn*ht[tt+2][Qe+1]+kn*ht[tt+3][Qe+1],ot=en*ht[tt][Qe+2]+mn*ht[tt+1][Qe+2]+xn*ht[tt+2][Qe+2]+kn*ht[tt+3][Qe+2],dt=en*ht[tt][Qe+3]+mn*ht[tt+1][Qe+3]+xn*ht[tt+2][Qe+3]+kn*ht[tt+3][Qe+3],Ge[Dt]=dr*at+3*(er*rt*it+Zt*Ot*ot)+Rt*dt;return Ge}:Ge?function(Ge,Qe,tt,rt,nt){var at,it,ot,dt,ht,Dt;Ge||(Ge=[]),Qe*=3;var Ot=nt*nt,Rt=Ot*nt,Zt=1-nt,er=Zt*Zt,dr=er*Zt;for(ht=0;ht<Ne.length;ht++)at=(Dt=Ne[ht])[tt+1][Qe]-Dt[tt][Qe],it=Dt[tt+1][Qe+1]-Dt[tt][Qe+1],ot=Dt[tt+1][Qe+2]-Dt[tt][Qe+2],dt=Dt[tt+1][Qe+3]-Dt[tt][Qe+3],Ge[ht]=dr*at+3*(er*nt*it+Zt*Ot*ot)+Rt*dt;return Ge}:Qe?function(Ge,Qe,tt,rt,nt){var at,it,ot,dt;Ge||(Ge=[]),tt*=3;var ht=1-rt,Dt=nt*nt,Ot=1-nt,Rt=Ot*Ot,Zt=Ot*nt*2,er=-3*Rt,dr=3*(Rt-Zt),mr=3*(Zt-Dt),xr=3*Dt;for(ot=0;ot<Ne.length;ot++)at=er*(dt=Ne[ot])[tt][Qe]+dr*dt[tt+1][Qe]+mr*dt[tt+2][Qe]+xr*dt[tt+3][Qe],it=er*dt[tt][Qe+1]+dr*dt[tt+1][Qe+1]+mr*dt[tt+2][Qe+1]+xr*dt[tt+3][Qe+1],Ge[ot]=ht*at+rt*it;return Ge}:function(Ge,Qe,tt,rt,nt){var at,it,ot,dt;Ge||(Ge=[]);var ht=1-rt;for(ot=0;ot<Ne.length;ot++)at=(dt=Ne[ot])[tt+1][Qe]-dt[tt][Qe],it=dt[tt+1][Qe+1]-dt[tt][Qe+1],Ge[ot]=ht*at+rt*it;return Ge}}},{}],978:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge,Qe,tt,rt){var nt=Ge-2,at=Qe-2;return tt&&rt?function(Ge,Qe,tt){var rt,it,ot,dt,ht,Dt;Ge||(Ge=[]);var Ot=Math.max(0,Math.min(Math.floor(Qe),nt)),Rt=Math.max(0,Math.min(Math.floor(tt),at)),Zt=Math.max(0,Math.min(1,Qe-Ot)),er=Math.max(0,Math.min(1,tt-Rt));Ot*=3,Rt*=3;var dr=Zt*Zt,mr=dr*Zt,xr=1-Zt,br=xr*xr,Ar=br*xr,en=er*er,mn=en*er,xn=1-er,kn=xn*xn,Cn=kn*xn;for(Dt=0;Dt<Ne.length;Dt++)rt=Ar*(ht=Ne[Dt])[Rt][Ot]+3*(br*Zt*ht[Rt][Ot+1]+xr*dr*ht[Rt][Ot+2])+mr*ht[Rt][Ot+3],it=Ar*ht[Rt+1][Ot]+3*(br*Zt*ht[Rt+1][Ot+1]+xr*dr*ht[Rt+1][Ot+2])+mr*ht[Rt+1][Ot+3],ot=Ar*ht[Rt+2][Ot]+3*(br*Zt*ht[Rt+2][Ot+1]+xr*dr*ht[Rt+2][Ot+2])+mr*ht[Rt+2][Ot+3],dt=Ar*ht[Rt+3][Ot]+3*(br*Zt*ht[Rt+3][Ot+1]+xr*dr*ht[Rt+3][Ot+2])+mr*ht[Rt+3][Ot+3],Ge[Dt]=Cn*rt+3*(kn*er*it+xn*en*ot)+mn*dt;return Ge}:tt?function(Ge,Qe,tt){Ge||(Ge=[]);var rt,it,ot,dt,ht,Dt,Ot=Math.max(0,Math.min(Math.floor(Qe),nt)),Rt=Math.max(0,Math.min(Math.floor(tt),at)),Zt=Math.max(0,Math.min(1,Qe-Ot)),er=Math.max(0,Math.min(1,tt-Rt));Ot*=3;var dr=Zt*Zt,mr=dr*Zt,xr=1-Zt,br=xr*xr,Ar=br*xr,en=1-er;for(ht=0;ht<Ne.length;ht++)rt=en*(Dt=Ne[ht])[Rt][Ot]+er*Dt[Rt+1][Ot],it=en*Dt[Rt][Ot+1]+er*Dt[Rt+1][Ot+1],ot=en*Dt[Rt][Ot+2]+er*Dt[Rt+1][Ot+1],dt=en*Dt[Rt][Ot+3]+er*Dt[Rt+1][Ot+1],Ge[ht]=Ar*rt+3*(br*Zt*it+xr*dr*ot)+mr*dt;return Ge}:rt?function(Ge,Qe,tt){Ge||(Ge=[]);var rt,it,ot,dt,ht,Dt,Ot=Math.max(0,Math.min(Math.floor(Qe),nt)),Rt=Math.max(0,Math.min(Math.floor(tt),at)),Zt=Math.max(0,Math.min(1,Qe-Ot)),er=Math.max(0,Math.min(1,tt-Rt));Rt*=3;var dr=er*er,mr=dr*er,xr=1-er,br=xr*xr,Ar=br*xr,en=1-Zt;for(ht=0;ht<Ne.length;ht++)rt=en*(Dt=Ne[ht])[Rt][Ot]+Zt*Dt[Rt][Ot+1],it=en*Dt[Rt+1][Ot]+Zt*Dt[Rt+1][Ot+1],ot=en*Dt[Rt+2][Ot]+Zt*Dt[Rt+2][Ot+1],dt=en*Dt[Rt+3][Ot]+Zt*Dt[Rt+3][Ot+1],Ge[ht]=Ar*rt+3*(br*er*it+xr*dr*ot)+mr*dt;return Ge}:function(Ge,Qe,tt){Ge||(Ge=[]);var rt,it,ot,dt,ht=Math.max(0,Math.min(Math.floor(Qe),nt)),Dt=Math.max(0,Math.min(Math.floor(tt),at)),Ot=Math.max(0,Math.min(1,Qe-ht)),Rt=Math.max(0,Math.min(1,tt-Dt)),Zt=1-Rt,er=1-Ot;for(ot=0;ot<Ne.length;ot++)rt=er*(dt=Ne[ot])[Dt][ht]+Ot*dt[Dt][ht+1],it=er*dt[Dt+1][ht]+Ot*dt[Dt+1][ht+1],Ge[ot]=Zt*rt+Rt*it;return Ge}}},{}],979:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./xy_defaults"),nt=Ne("./ab_defaults"),at=Ne("./attributes"),it=Ne("../../components/color/attributes");Ge.exports=function(Ne,Ge,Qe,ot){function coerce(Qe,rt){return tt.coerce(Ne,Ge,at,Qe,rt)}Ge._clipPathId="clip"+Ge.uid+"carpet";var dt=coerce("color",it.defaultLine);tt.coerceFont(coerce,"font"),coerce("carpet"),nt(Ne,Ge,ot,coerce,dt),Ge.a&&Ge.b?(Ge.a.length<3&&(Ge.aaxis.smoothing=0),Ge.b.length<3&&(Ge.baxis.smoothing=0),rt(Ne,Ge,coerce)||(Ge.visible=!1),Ge._cheater&&coerce("cheaterslope")):Ge.visible=!1}},{"../../components/color/attributes":642,"../../lib":778,"./ab_defaults":962,"./attributes":964,"./xy_defaults":988}],980:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),plot:Ne("./plot"),calc:Ne("./calc"),animatable:!0,isContainer:!0,moduleType:"trace",name:"carpet",basePlotModule:Ne("../../plots/cartesian"),categories:["cartesian","svg","carpet","carpetAxis","notLegendIsolatable","noMultiCategory","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":841,"./attributes":964,"./calc":968,"./defaults":979,"./plot":985}],981:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge){for(var Qe,tt=Ne._fullData.length,rt=0;rt<tt;rt++){var nt=Ne._fullData[rt];if(nt.index!==Ge.index&&"carpet"===nt.type&&(Qe||(Qe=nt),nt.carpet===Ge.carpet))return nt}return Qe}},{}],982:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge,Qe){if(0===Ne.length)return"";var tt,rt=[],nt=Qe?3:1;for(tt=0;tt<Ne.length;tt+=nt)rt.push(Ne[tt]+","+Ge[tt]),Qe&&tt<Ne.length-nt&&(rt.push("C"),rt.push([Ne[tt+1]+","+Ge[tt+1],Ne[tt+2]+","+Ge[tt+2]+" "].join(" ")));return rt.join(Qe?"":"L")}},{}],983:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib").isArrayOrTypedArray;Ge.exports=function(Ne,Ge,Qe){var rt;for(tt(Ne)?Ne.length>Ge.length&&(Ne=Ne.slice(0,Ge.length)):Ne=[],rt=0;rt<Ge.length;rt++)Ne[rt]=Qe(Ge[rt]);return Ne}},{"../../lib":778}],984:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge,Qe,tt,rt,nt){var at=rt[0]*Ne.dpdx(Ge),it=rt[1]*Ne.dpdy(Qe),ot=1,dt=1;if(nt){var ht=Math.sqrt(rt[0]*rt[0]+rt[1]*rt[1]),Dt=Math.sqrt(nt[0]*nt[0]+nt[1]*nt[1]),Ot=(rt[0]*nt[0]+rt[1]*nt[1])/ht/Dt;dt=Math.max(0,Ot)}var Rt=180*Math.atan2(it,at)/Math.PI;return Rt<-90?(Rt+=180,ot=-ot):Rt>90&&(Rt-=180,ot=-ot),{angle:Rt,flip:ot,p:Ne.c2p(tt,Ge,Qe),offsetMultplier:dt}}},{}],985:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../components/drawing"),nt=Ne("./map_1d_array"),at=Ne("./makepath"),it=Ne("./orient_text"),ot=Ne("../../lib/svg_text_utils"),dt=Ne("../../lib"),ht=dt.strRotate,Dt=dt.strTranslate,Ot=Ne("../../constants/alignment");function drawClipPath(Ne,Ge,Qe,tt,rt){var it,ot,ht,Dt,Ot=Qe.select("#"+Ne._clipPathId);Ot.size()||(Ot=Qe.append("clipPath").classed("carpetclip",!0));var Rt=dt.ensureSingle(Ot,"path","carpetboundary"),Zt=Ge.clipsegments,er=[];for(Dt=0;Dt<Zt.length;Dt++)it=Zt[Dt],ot=nt([],it.x,tt.c2p),ht=nt([],it.y,rt.c2p),er.push(at(ot,ht,it.bicubic));var dr="M"+er.join("L")+"Z";Ot.attr("id",Ne._clipPathId),Rt.attr("d",dr)}function drawGridLines(Ne,Ge,Qe,rt,it,ot){var dt="const-"+it+"-lines",ht=Qe.selectAll("."+dt).data(ot);ht.enter().append("path").classed(dt,!0).style("vector-effect","non-scaling-stroke"),ht.each((function(Qe){var rt=Qe,it=rt.x,ot=rt.y,dt=nt([],it,Ne.c2p),ht=nt([],ot,Ge.c2p),Dt="M"+at(dt,ht,rt.smoothing);tt.select(this).attr("d",Dt).style("stroke-width",rt.width).style("stroke",rt.color).style("fill","none")})),ht.exit().remove()}function drawAxisLabels(Ne,Ge,Qe,nt,at,dt,Ot,Rt){var Zt=dt.selectAll("text."+Rt).data(Ot);Zt.enter().append("text").classed(Rt,!0);var er=0,dr={};return Zt.each((function(at,dt){var Ot;if("auto"===at.axis.tickangle)Ot=it(nt,Ge,Qe,at.xy,at.dxy);else{var Rt=(at.axis.tickangle+180)*Math.PI/180;Ot=it(nt,Ge,Qe,at.xy,[Math.cos(Rt),Math.sin(Rt)])}dt||(dr={angle:Ot.angle,flip:Ot.flip});var Zt=(at.endAnchor?-1:1)*Ot.flip,mr=tt.select(this).attr({"text-anchor":Zt>0?"start":"end","data-notex":1}).call(rt.font,at.font).text(at.text).call(ot.convertToTspans,Ne),xr=rt.bBox(this);mr.attr("transform",Dt(Ot.p[0],Ot.p[1])+ht(Ot.angle)+Dt(at.axis.labelpadding*Zt,.3*xr.height)),er=Math.max(er,xr.width+at.axis.labelpadding)})),Zt.exit().remove(),dr.maxExtent=er,dr}function drawAxisTitles(Ne,Ge,Qe,tt,rt,nt,at,ot){var ht,Dt,Ot,Rt,Zt=dt.aggNums(Math.min,null,Qe.a),er=dt.aggNums(Math.max,null,Qe.a),dr=dt.aggNums(Math.min,null,Qe.b),mr=dt.aggNums(Math.max,null,Qe.b);ht=.5*(Zt+er),Dt=dr,Ot=Qe.ab2xy(ht,Dt,!0),Rt=Qe.dxyda_rough(ht,Dt),void 0===at.angle&&dt.extendFlat(at,it(Qe,rt,nt,Ot,Qe.dxydb_rough(ht,Dt))),drawAxisTitle(Ne,Ge,Qe,tt,Ot,Rt,Qe.aaxis,rt,nt,at,"a-title"),ht=Zt,Dt=.5*(dr+mr),Ot=Qe.ab2xy(ht,Dt,!0),Rt=Qe.dxydb_rough(ht,Dt),void 0===ot.angle&&dt.extendFlat(ot,it(Qe,rt,nt,Ot,Qe.dxyda_rough(ht,Dt))),drawAxisTitle(Ne,Ge,Qe,tt,Ot,Rt,Qe.baxis,rt,nt,ot,"b-title")}Ge.exports=function(Ne,Ge,Qe,rt){var nt=Ge.xaxis,at=Ge.yaxis,it=Ne._fullLayout._clips;dt.makeTraceGroups(rt,Qe,"trace").each((function(Ge){var Qe=tt.select(this),rt=Ge[0],ot=rt.trace,ht=ot.aaxis,Dt=ot.baxis,Ot=dt.ensureSingle(Qe,"g","minorlayer"),Rt=dt.ensureSingle(Qe,"g","majorlayer"),Zt=dt.ensureSingle(Qe,"g","boundarylayer"),er=dt.ensureSingle(Qe,"g","labellayer");Qe.style("opacity",ot.opacity),drawGridLines(nt,at,Rt,ht,"a",ht._gridlines,!0),drawGridLines(nt,at,Rt,Dt,"b",Dt._gridlines,!0),drawGridLines(nt,at,Ot,ht,"a",ht._minorgridlines,!0),drawGridLines(nt,at,Ot,Dt,"b",Dt._minorgridlines,!0),drawGridLines(nt,at,Zt,ht,"a-boundary",ht._boundarylines),drawGridLines(nt,at,Zt,Dt,"b-boundary",Dt._boundarylines);var dr=drawAxisLabels(Ne,nt,at,ot,rt,er,ht._labels,"a-label"),mr=drawAxisLabels(Ne,nt,at,ot,rt,er,Dt._labels,"b-label");drawAxisTitles(Ne,er,ot,rt,nt,at,dr,mr),drawClipPath(ot,rt,it,nt,at)}))};var Rt=Ot.LINE_SPACING,Zt=(1-Ot.MID_SHIFT)/Rt+1;function drawAxisTitle(Ne,Ge,Qe,nt,at,dt,Ot,er,dr,mr,xr){var br=[];Ot.title.text&&br.push(Ot.title.text);var Ar=Ge.selectAll("text."+xr).data(br),en=mr.maxExtent;Ar.enter().append("text").classed(xr,!0),Ar.each((function(){var Ge=it(Qe,er,dr,at,dt);-1===["start","both"].indexOf(Ot.showticklabels)&&(en=0);var nt=Ot.title.font.size;en+=nt+Ot.title.offset;var xr=(mr.angle+(mr.flip<0?180:0)-Ge.angle+450)%360,br=xr>90&&xr<270,Ar=tt.select(this);Ar.text(Ot.title.text).call(ot.convertToTspans,Ne),br&&(en=(-ot.lineCount(Ar)+Zt)*Rt*nt-en),Ar.attr("transform",Dt(Ge.p[0],Ge.p[1])+ht(Ge.angle)+Dt(0,en)).attr("text-anchor","middle").call(rt.font,Ot.title.font)})),Ar.exit().remove()}},{"../../components/drawing":665,"../../constants/alignment":745,"../../lib":778,"../../lib/svg_text_utils":803,"./makepath":982,"./map_1d_array":983,"./orient_text":984,d3:169}],986:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./constants"),rt=Ne("../../lib/search").findBin,nt=Ne("./compute_control_points"),at=Ne("./create_spline_evaluator"),it=Ne("./create_i_derivative_evaluator"),ot=Ne("./create_j_derivative_evaluator");Ge.exports=function(Ne){var Ge=Ne._a,Qe=Ne._b,dt=Ge.length,ht=Qe.length,Dt=Ne.aaxis,Ot=Ne.baxis,Rt=Ge[0],Zt=Ge[dt-1],er=Qe[0],dr=Qe[ht-1],mr=Ge[Ge.length-1]-Ge[0],xr=Qe[Qe.length-1]-Qe[0],br=mr*tt.RELATIVE_CULL_TOLERANCE,Ar=xr*tt.RELATIVE_CULL_TOLERANCE;Rt-=br,Zt+=br,er-=Ar,dr+=Ar,Ne.isVisible=function(Ne,Ge){return Ne>Rt&&Ne<Zt&&Ge>er&&Ge<dr},Ne.isOccluded=function(Ne,Ge){return Ne<Rt||Ne>Zt||Ge<er||Ge>dr},Ne.setScale=function(){var Ge=Ne._x,Qe=Ne._y,tt=nt(Ne._xctrl,Ne._yctrl,Ge,Qe,Dt.smoothing,Ot.smoothing);Ne._xctrl=tt[0],Ne._yctrl=tt[1],Ne.evalxy=at([Ne._xctrl,Ne._yctrl],dt,ht,Dt.smoothing,Ot.smoothing),Ne.dxydi=it([Ne._xctrl,Ne._yctrl],Dt.smoothing,Ot.smoothing),Ne.dxydj=ot([Ne._xctrl,Ne._yctrl],Dt.smoothing,Ot.smoothing)},Ne.i2a=function(Ne){var Qe=Math.max(0,Math.floor(Ne[0]),dt-2),tt=Ne[0]-Qe;return(1-tt)*Ge[Qe]+tt*Ge[Qe+1]},Ne.j2b=function(Ne){var Ge=Math.max(0,Math.floor(Ne[1]),dt-2),tt=Ne[1]-Ge;return(1-tt)*Qe[Ge]+tt*Qe[Ge+1]},Ne.ij2ab=function(Ge){return[Ne.i2a(Ge[0]),Ne.j2b(Ge[1])]},Ne.a2i=function(Ne){var Qe=Math.max(0,Math.min(rt(Ne,Ge),dt-2)),tt=Ge[Qe],nt=Ge[Qe+1];return Math.max(0,Math.min(dt-1,Qe+(Ne-tt)/(nt-tt)))},Ne.b2j=function(Ne){var Ge=Math.max(0,Math.min(rt(Ne,Qe),ht-2)),tt=Qe[Ge],nt=Qe[Ge+1];return Math.max(0,Math.min(ht-1,Ge+(Ne-tt)/(nt-tt)))},Ne.ab2ij=function(Ge){return[Ne.a2i(Ge[0]),Ne.b2j(Ge[1])]},Ne.i2c=function(Ge,Qe){return Ne.evalxy([],Ge,Qe)},Ne.ab2xy=function(tt,rt,nt){if(!nt&&(tt<Ge[0]||tt>Ge[dt-1]|rt<Qe[0]||rt>Qe[ht-1]))return[!1,!1];var at=Ne.a2i(tt),it=Ne.b2j(rt),ot=Ne.evalxy([],at,it);if(nt){var Dt,Ot,Rt,Zt,er=0,dr=0,mr=[];tt<Ge[0]?(Dt=0,Ot=0,er=(tt-Ge[0])/(Ge[1]-Ge[0])):tt>Ge[dt-1]?(Dt=dt-2,Ot=1,er=(tt-Ge[dt-1])/(Ge[dt-1]-Ge[dt-2])):Ot=at-(Dt=Math.max(0,Math.min(dt-2,Math.floor(at)))),rt<Qe[0]?(Rt=0,Zt=0,dr=(rt-Qe[0])/(Qe[1]-Qe[0])):rt>Qe[ht-1]?(Rt=ht-2,Zt=1,dr=(rt-Qe[ht-1])/(Qe[ht-1]-Qe[ht-2])):Zt=it-(Rt=Math.max(0,Math.min(ht-2,Math.floor(it)))),er&&(Ne.dxydi(mr,Dt,Rt,Ot,Zt),ot[0]+=mr[0]*er,ot[1]+=mr[1]*er),dr&&(Ne.dxydj(mr,Dt,Rt,Ot,Zt),ot[0]+=mr[0]*dr,ot[1]+=mr[1]*dr)}return ot},Ne.c2p=function(Ne,Ge,Qe){return[Ge.c2p(Ne[0]),Qe.c2p(Ne[1])]},Ne.p2x=function(Ne,Ge,Qe){return[Ge.p2c(Ne[0]),Qe.p2c(Ne[1])]},Ne.dadi=function(Ne){var Qe=Math.max(0,Math.min(Ge.length-2,Ne));return Ge[Qe+1]-Ge[Qe]},Ne.dbdj=function(Ne){var Ge=Math.max(0,Math.min(Qe.length-2,Ne));return Qe[Ge+1]-Qe[Ge]},Ne.dxyda=function(Ge,Qe,tt,rt){var nt=Ne.dxydi(null,Ge,Qe,tt,rt),at=Ne.dadi(Ge,tt);return[nt[0]/at,nt[1]/at]},Ne.dxydb=function(Ge,Qe,tt,rt){var nt=Ne.dxydj(null,Ge,Qe,tt,rt),at=Ne.dbdj(Qe,rt);return[nt[0]/at,nt[1]/at]},Ne.dxyda_rough=function(Ge,Qe,tt){var rt=mr*(tt||.1),nt=Ne.ab2xy(Ge+rt,Qe,!0),at=Ne.ab2xy(Ge-rt,Qe,!0);return[.5*(nt[0]-at[0])/rt,.5*(nt[1]-at[1])/rt]},Ne.dxydb_rough=function(Ge,Qe,tt){var rt=xr*(tt||.1),nt=Ne.ab2xy(Ge,Qe+rt,!0),at=Ne.ab2xy(Ge,Qe-rt,!0);return[.5*(nt[0]-at[0])/rt,.5*(nt[1]-at[1])/rt]},Ne.dpdx=function(Ne){return Ne._m},Ne.dpdy=function(Ne){return Ne._m}}},{"../../lib/search":798,"./compute_control_points":974,"./constants":975,"./create_i_derivative_evaluator":976,"./create_j_derivative_evaluator":977,"./create_spline_evaluator":978}],987:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib");Ge.exports=function(Ne,Ge,Qe){var rt,nt,at,it=[],ot=[],dt=Ne[0].length,ht=Ne.length;function avgSurrounding(Ge,Qe){var tt,rt=0,nt=0;return Ge>0&&void 0!==(tt=Ne[Qe][Ge-1])&&(nt++,rt+=tt),Ge<dt-1&&void 0!==(tt=Ne[Qe][Ge+1])&&(nt++,rt+=tt),Qe>0&&void 0!==(tt=Ne[Qe-1][Ge])&&(nt++,rt+=tt),Qe<ht-1&&void 0!==(tt=Ne[Qe+1][Ge])&&(nt++,rt+=tt),rt/Math.max(1,nt)}var Dt,Ot,Rt,Zt,er,dr,mr,xr,br,Ar,en,mn=0;for(rt=0;rt<dt;rt++)for(nt=0;nt<ht;nt++)void 0===Ne[nt][rt]&&(it.push(rt),ot.push(nt),Ne[nt][rt]=avgSurrounding(rt,nt)),mn=Math.max(mn,Math.abs(Ne[nt][rt]));if(!it.length)return Ne;var xn=1e-5,kn=0,Cn=100,En=0,Pn=it.length;do{for(kn=0,at=0;at<Pn;at++){rt=it[at],nt=ot[at];var Dn,In,zn,Bn,Vn,Hn,qn=0,Yn=0;0===rt?(zn=Ge[Vn=Math.min(dt-1,2)],Bn=Ge[1],Dn=Ne[nt][Vn],Yn+=(In=Ne[nt][1])+(In-Dn)*(Ge[0]-Bn)/(Bn-zn),qn++):rt===dt-1&&(zn=Ge[Vn=Math.max(0,dt-3)],Bn=Ge[dt-2],Dn=Ne[nt][Vn],Yn+=(In=Ne[nt][dt-2])+(In-Dn)*(Ge[dt-1]-Bn)/(Bn-zn),qn++),(0===rt||rt===dt-1)&&nt>0&&nt<ht-1&&(Dt=Qe[nt+1]-Qe[nt],Yn+=((Ot=Qe[nt]-Qe[nt-1])*Ne[nt+1][rt]+Dt*Ne[nt-1][rt])/(Ot+Dt),qn++),0===nt?(zn=Qe[Hn=Math.min(ht-1,2)],Bn=Qe[1],Dn=Ne[Hn][rt],Yn+=(In=Ne[1][rt])+(In-Dn)*(Qe[0]-Bn)/(Bn-zn),qn++):nt===ht-1&&(zn=Qe[Hn=Math.max(0,ht-3)],Bn=Qe[ht-2],Dn=Ne[Hn][rt],Yn+=(In=Ne[ht-2][rt])+(In-Dn)*(Qe[ht-1]-Bn)/(Bn-zn),qn++),(0===nt||nt===ht-1)&&rt>0&&rt<dt-1&&(Dt=Ge[rt+1]-Ge[rt],Yn+=((Ot=Ge[rt]-Ge[rt-1])*Ne[nt][rt+1]+Dt*Ne[nt][rt-1])/(Ot+Dt),qn++),qn?Yn/=qn:(Rt=Ge[rt+1]-Ge[rt],Zt=Ge[rt]-Ge[rt-1],xr=(er=Qe[nt+1]-Qe[nt])*(dr=Qe[nt]-Qe[nt-1])*(er+dr),Yn=((mr=Rt*Zt*(Rt+Zt))*(dr*Ne[nt+1][rt]+er*Ne[nt-1][rt])+xr*(Zt*Ne[nt][rt+1]+Rt*Ne[nt][rt-1]))/(xr*(Zt+Rt)+mr*(dr+er))),kn+=(Ar=(br=Yn-Ne[nt][rt])/mn)*Ar,en=qn?0:.85,Ne[nt][rt]+=br*(1+en)}kn=Math.sqrt(kn)}while(En++<Cn&&kn>xn);return tt.log("Smoother converged to",kn,"after",En,"iterations"),Ne}},{"../../lib":778}],988:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib").isArray1D;Ge.exports=function(Ne,Ge,Qe){var rt=Qe("x"),nt=rt&&rt.length,at=Qe("y"),it=at&&at.length;if(!nt&&!it)return!1;if(Ge._cheater=!rt,nt&&!tt(rt)||it&&!tt(at))Ge._length=null;else{var ot=nt?rt.length:1/0;it&&(ot=Math.min(ot,at.length)),Ge.a&&Ge.a.length&&(ot=Math.min(ot,Ge.a.length)),Ge.b&&Ge.b.length&&(ot=Math.min(ot,Ge.b.length)),Ge._length=ot}return!0}},{"../../lib":778}],989:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/template_attributes").hovertemplateAttrs,rt=Ne("../scattergeo/attributes"),nt=Ne("../../components/colorscale/attributes"),at=Ne("../../plots/attributes"),it=Ne("../../components/color/attributes").defaultLine,ot=Ne("../../lib/extend").extendFlat,dt=rt.marker.line;Ge.exports=ot({locations:{valType:"data_array",editType:"calc"},locationmode:rt.locationmode,z:{valType:"data_array",editType:"calc"},geojson:ot({},rt.geojson,{}),featureidkey:rt.featureidkey,text:ot({},rt.text,{}),hovertext:ot({},rt.hovertext,{}),marker:{line:{color:ot({},dt.color,{dflt:it}),width:ot({},dt.width,{dflt:1}),editType:"calc"},opacity:{valType:"number",arrayOk:!0,min:0,max:1,dflt:1,editType:"style"},editType:"calc"},selected:{marker:{opacity:rt.selected.marker.opacity,editType:"plot"},editType:"plot"},unselected:{marker:{opacity:rt.unselected.marker.opacity,editType:"plot"},editType:"plot"},hoverinfo:ot({},at.hoverinfo,{editType:"calc",flags:["location","z","text","name"]}),hovertemplate:tt(),showlegend:ot({},at.showlegend,{dflt:!1})},nt("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/color/attributes":642,"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../scattergeo/attributes":1229}],990:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../constants/numerical").BADNUM,nt=Ne("../../components/colorscale/calc"),at=Ne("../scatter/arrays_to_calcdata"),it=Ne("../scatter/calc_selection");function isNonBlankString(Ne){return Ne&&"string"==typeof Ne}Ge.exports=function(Ne,Ge){var Qe,ot=Ge._length,dt=new Array(ot);Qe=Ge.geojson?function(Ne){return isNonBlankString(Ne)||tt(Ne)}:isNonBlankString;for(var ht=0;ht<ot;ht++){var Dt=dt[ht]={},Ot=Ge.locations[ht],Rt=Ge.z[ht];Qe(Ot)&&tt(Rt)?(Dt.loc=Ot,Dt.z=Rt):(Dt.loc=null,Dt.z=rt),Dt.index=ht}return at(dt,Ge),nt(Ne,Ge,{vals:Ge.z,containerStr:"",cLetter:"z"}),it(dt,Ge),dt}},{"../../components/colorscale/calc":651,"../../constants/numerical":753,"../scatter/arrays_to_calcdata":1186,"../scatter/calc_selection":1189,"fast-isnumeric":241}],991:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../components/colorscale/defaults"),nt=Ne("./attributes");Ge.exports=function(Ne,Ge,Qe,at){function coerce(Qe,rt){return tt.coerce(Ne,Ge,nt,Qe,rt)}var it=coerce("locations"),ot=coerce("z");if(it&&it.length&&tt.isArrayOrTypedArray(ot)&&ot.length){Ge._length=Math.min(it.length,ot.length);var dt,ht=coerce("geojson");("string"==typeof ht&&""!==ht||tt.isPlainObject(ht))&&(dt="geojson-id"),"geojson-id"===coerce("locationmode",dt)&&coerce("featureidkey"),coerce("text"),coerce("hovertext"),coerce("hovertemplate"),coerce("marker.line.width")&&coerce("marker.line.color"),coerce("marker.opacity"),rt(Ne,Ge,at,coerce,{prefix:"",cLetter:"z"}),tt.coerceSelectionMarkerOpacity(Ge,coerce)}else Ge.visible=!1}},{"../../components/colorscale/defaults":653,"../../lib":778,"./attributes":989}],992:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge,Qe,tt,rt){Ne.location=Ge.location,Ne.z=Ge.z;var nt=tt[rt];return nt.fIn&&nt.fIn.properties&&(Ne.properties=nt.fIn.properties),Ne.ct=nt.ct,Ne}},{}],993:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/cartesian/axes"),rt=Ne("./attributes"),nt=Ne("../../lib").fillText;function makeHoverInfo(Ne,Ge,Qe){if(!Ge.hovertemplate){var tt=Qe.hi||Ge.hoverinfo,at=String(Qe.loc),it="all"===tt?rt.hoverinfo.flags:tt.split("+"),ot=-1!==it.indexOf("name"),dt=-1!==it.indexOf("location"),ht=-1!==it.indexOf("z"),Dt=-1!==it.indexOf("text"),Ot=[];!ot&&dt?Ne.nameOverride=at:(ot&&(Ne.nameOverride=Ge.name),dt&&Ot.push(at)),ht&&Ot.push(Ne.zLabel),Dt&&nt(Qe,Ge,Ot),Ne.extraText=Ot.join("<br>")}}Ge.exports=function(Ne,Ge,Qe){var rt,nt,at,it,ot=Ne.cd,dt=ot[0].trace,ht=Ne.subplot,Dt=[Ge,Qe],Ot=[Ge+360,Qe];for(nt=0;nt<ot.length;nt++)if(it=!1,(rt=ot[nt])._polygons){for(at=0;at<rt._polygons.length;at++)rt._polygons[at].contains(Dt)&&(it=!it),rt._polygons[at].contains(Ot)&&(it=!it);if(it)break}if(it&&rt)return Ne.x0=Ne.x1=Ne.xa.c2p(rt.ct),Ne.y0=Ne.y1=Ne.ya.c2p(rt.ct),Ne.index=rt.index,Ne.location=rt.loc,Ne.z=rt.z,Ne.zLabel=tt.tickText(ht.mockAxis,ht.mockAxis.c2l(rt.z),"hover").text,Ne.hovertemplate=rt.hovertemplate,makeHoverInfo(Ne,dt,rt),[Ne]}},{"../../lib":778,"../../plots/cartesian/axes":828,"./attributes":989}],994:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),colorbar:Ne("../heatmap/colorbar"),calc:Ne("./calc"),calcGeoJSON:Ne("./plot").calcGeoJSON,plot:Ne("./plot").plot,style:Ne("./style").style,styleOnSelect:Ne("./style").styleOnSelect,hoverPoints:Ne("./hover"),eventData:Ne("./event_data"),selectPoints:Ne("./select"),moduleType:"trace",name:"choropleth",basePlotModule:Ne("../../plots/geo"),categories:["geo","noOpacity","showLegend"],meta:{}}},{"../../plots/geo":860,"../heatmap/colorbar":1068,"./attributes":989,"./calc":990,"./defaults":991,"./event_data":992,"./hover":993,"./plot":995,"./select":996,"./style":997}],995:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../lib"),nt=Ne("../../lib/geo_location_utils"),at=Ne("../../lib/topojson_utils").getTopojsonFeatures,it=Ne("../../plots/cartesian/autorange").findExtremes,ot=Ne("./style").style;function plot(Ne,Ge,Qe){var nt=Ge.layers.backplot.select(".choroplethlayer");rt.makeTraceGroups(nt,Qe,"trace choropleth").each((function(Ge){var Qe=tt.select(this).selectAll("path.choroplethlocation").data(rt.identity);Qe.enter().append("path").classed("choroplethlocation",!0),Qe.exit().remove(),ot(Ne,Ge)}))}function calcGeoJSON(Ne,Ge){for(var Qe=Ne[0].trace,tt=Ge[Qe.geo],rt=tt._subplot,ot=Qe.locationmode,dt=Qe._length,ht="geojson-id"===ot?nt.extractTraceFeature(Ne):at(Qe,rt.topojson),Dt=[],Ot=[],Rt=0;Rt<dt;Rt++){var Zt=Ne[Rt],er="geojson-id"===ot?Zt.fOut:nt.locationToFeature(ot,Zt.loc,ht);if(er){Zt.geojson=er,Zt.ct=er.properties.ct,Zt._polygons=nt.feature2polygons(er);var dr=nt.computeBbox(er);Dt.push(dr[0],dr[2]),Ot.push(dr[1],dr[3])}else Zt.geojson=null}if("geojson"===tt.fitbounds&&"geojson-id"===ot){var mr=nt.computeBbox(nt.getTraceGeojson(Qe));Dt=[mr[0],mr[2]],Ot=[mr[1],mr[3]]}var xr={padded:!0};Qe._extremes.lon=it(tt.lonaxis._ax,Dt,xr),Qe._extremes.lat=it(tt.lataxis._ax,Ot,xr)}Ge.exports={calcGeoJSON:calcGeoJSON,plot:plot}},{"../../lib":778,"../../lib/geo_location_utils":771,"../../lib/topojson_utils":806,"../../plots/cartesian/autorange":827,"./style":997,d3:169}],996:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge){var Qe,tt,rt,nt,at,it=Ne.cd,ot=Ne.xaxis,dt=Ne.yaxis,ht=[];if(!1===Ge)for(Qe=0;Qe<it.length;Qe++)it[Qe].selected=0;else for(Qe=0;Qe<it.length;Qe++)(rt=(tt=it[Qe]).ct)&&(nt=ot.c2p(rt),at=dt.c2p(rt),Ge.contains([nt,at],null,Qe,Ne)?(ht.push({pointNumber:Qe,lon:rt[0],lat:rt[1]}),tt.selected=1):tt.selected=0);return ht}},{}],997:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../components/color"),nt=Ne("../../components/drawing"),at=Ne("../../components/colorscale");function style(Ne,Ge){Ge&&styleTrace(Ne,Ge)}function styleTrace(Ne,Ge){var Qe=Ge[0].trace,it=Ge[0].node3.selectAll(".choroplethlocation"),ot=Qe.marker||{},dt=ot.line||{},ht=at.makeColorScaleFuncFromTrace(Qe);it.each((function(Ne){tt.select(this).attr("fill",ht(Ne.z)).call(rt.stroke,Ne.mlc||dt.color).call(nt.dashLine,"",Ne.mlw||dt.width||0).style("opacity",ot.opacity)})),nt.selectedPointStyle(it,Qe,Ne)}function styleOnSelect(Ne,Ge){var Qe=Ge[0].node3,tt=Ge[0].trace;tt.selectedpoints?nt.selectedPointStyle(Qe.selectAll(".choroplethlocation"),tt,Ne):styleTrace(Ne,Ge)}Ge.exports={style:style,styleOnSelect:styleOnSelect}},{"../../components/color":643,"../../components/colorscale":655,"../../components/drawing":665,d3:169}],998:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../choropleth/attributes"),rt=Ne("../../components/colorscale/attributes"),nt=Ne("../../plots/template_attributes").hovertemplateAttrs,at=Ne("../../plots/attributes"),it=Ne("../../lib/extend").extendFlat;Ge.exports=it({locations:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},geojson:{valType:"any",editType:"calc"},featureidkey:it({},tt.featureidkey,{}),below:{valType:"string",editType:"plot"},text:tt.text,hovertext:tt.hovertext,marker:{line:{color:it({},tt.marker.line.color,{editType:"plot"}),width:it({},tt.marker.line.width,{editType:"plot"}),editType:"calc"},opacity:it({},tt.marker.opacity,{editType:"plot"}),editType:"calc"},selected:{marker:{opacity:it({},tt.selected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},unselected:{marker:{opacity:it({},tt.unselected.marker.opacity,{editType:"plot"}),editType:"plot"},editType:"plot"},hoverinfo:tt.hoverinfo,hovertemplate:nt({},{keys:["properties"]}),showlegend:it({},at.showlegend,{dflt:!1})},rt("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../choropleth/attributes":989}],999:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../lib"),nt=Ne("../../components/colorscale"),at=Ne("../../components/drawing"),it=Ne("../../lib/geojson_utils").makeBlank,ot=Ne("../../lib/geo_location_utils");function convert(Ne){var Ge=Ne[0].trace,Qe=!0===Ge.visible&&0!==Ge._length,at={layout:{visibility:"none"},paint:{}},dt={layout:{visibility:"none"},paint:{}},ht=Ge._opts={fill:at,line:dt,geojson:it()};if(!Qe)return ht;var Dt=ot.extractTraceFeature(Ne);if(!Dt)return ht;var Ot,Rt,Zt,er=nt.makeColorScaleFuncFromTrace(Ge),dr=Ge.marker,mr=dr.line||{};rt.isArrayOrTypedArray(dr.opacity)&&(Ot=function(Ne){var Ge=Ne.mo;return tt(Ge)?+rt.constrain(Ge,0,1):0}),rt.isArrayOrTypedArray(mr.color)&&(Rt=function(Ne){return Ne.mlc}),rt.isArrayOrTypedArray(mr.width)&&(Zt=function(Ne){return Ne.mlw});for(var xr=0;xr<Ne.length;xr++){var br=Ne[xr],Ar=br.fOut;if(Ar){var en=Ar.properties;en.fc=er(br.z),Ot&&(en.mo=Ot(br)),Rt&&(en.mlc=Rt(br)),Zt&&(en.mlw=Zt(br)),br.ct=en.ct,br._polygons=ot.feature2polygons(Ar)}}var mn=Ot?{type:"identity",property:"mo"}:dr.opacity;return rt.extendFlat(at.paint,{"fill-color":{type:"identity",property:"fc"},"fill-opacity":mn}),rt.extendFlat(dt.paint,{"line-color":Rt?{type:"identity",property:"mlc"}:mr.color,"line-width":Zt?{type:"identity",property:"mlw"}:mr.width,"line-opacity":mn}),at.layout.visibility="visible",dt.layout.visibility="visible",ht.geojson={type:"FeatureCollection",features:Dt},convertOnSelect(Ne),ht}function convertOnSelect(Ne){var Ge,Qe=Ne[0].trace,tt=Qe._opts;if(Qe.selectedpoints){for(var nt=at.makeSelectedPointStyleFns(Qe),it=0;it<Ne.length;it++){var ot=Ne[it];ot.fOut&&(ot.fOut.properties.mo2=nt.selectedOpacityFn(ot))}Ge={type:"identity",property:"mo2"}}else Ge=rt.isArrayOrTypedArray(Qe.marker.opacity)?{type:"identity",property:"mo"}:Qe.marker.opacity;return rt.extendFlat(tt.fill.paint,{"fill-opacity":Ge}),rt.extendFlat(tt.line.paint,{"line-opacity":Ge}),tt}Ge.exports={convert:convert,convertOnSelect:convertOnSelect}},{"../../components/colorscale":655,"../../components/drawing":665,"../../lib":778,"../../lib/geo_location_utils":771,"../../lib/geojson_utils":772,"fast-isnumeric":241}],1e3:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../components/colorscale/defaults"),nt=Ne("./attributes");Ge.exports=function(Ne,Ge,Qe,at){function coerce(Qe,rt){return tt.coerce(Ne,Ge,nt,Qe,rt)}var it=coerce("locations"),ot=coerce("z"),dt=coerce("geojson");tt.isArrayOrTypedArray(it)&&it.length&&tt.isArrayOrTypedArray(ot)&&ot.length&&("string"==typeof dt&&""!==dt||tt.isPlainObject(dt))?(coerce("featureidkey"),Ge._length=Math.min(it.length,ot.length),coerce("below"),coerce("text"),coerce("hovertext"),coerce("hovertemplate"),coerce("marker.line.width")&&coerce("marker.line.color"),coerce("marker.opacity"),rt(Ne,Ge,at,coerce,{prefix:"",cLetter:"z"}),tt.coerceSelectionMarkerOpacity(Ge,coerce)):Ge.visible=!1}},{"../../components/colorscale/defaults":653,"../../lib":778,"./attributes":998}],1001:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),colorbar:Ne("../heatmap/colorbar"),calc:Ne("../choropleth/calc"),plot:Ne("./plot"),hoverPoints:Ne("../choropleth/hover"),eventData:Ne("../choropleth/event_data"),selectPoints:Ne("../choropleth/select"),styleOnSelect:function(Ne,Ge){Ge&&Ge[0].trace._glTrace.updateOnSelect(Ge)},getBelow:function(Ne,Ge){for(var Qe=Ge.getMapLayers(),tt=Qe.length-2;tt>=0;tt--){var rt=Qe[tt].id;if("string"==typeof rt&&0===rt.indexOf("water"))for(var nt=tt+1;nt<Qe.length;nt++)if("string"==typeof(rt=Qe[nt].id)&&-1===rt.indexOf("plotly-"))return rt}},moduleType:"trace",name:"choroplethmapbox",basePlotModule:Ne("../../plots/mapbox"),categories:["mapbox","gl","noOpacity","showLegend"],meta:{hr_name:"choropleth_mapbox"}}},{"../../plots/mapbox":885,"../choropleth/calc":990,"../choropleth/event_data":992,"../choropleth/hover":993,"../choropleth/select":996,"../heatmap/colorbar":1068,"./attributes":998,"./defaults":1e3,"./plot":1002}],1002:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./convert").convert,rt=Ne("./convert").convertOnSelect,nt=Ne("../../plots/mapbox/constants").traceLayerPrefix;function ChoroplethMapbox(Ne,Ge){this.type="choroplethmapbox",this.subplot=Ne,this.uid=Ge,this.sourceId="source-"+Ge,this.layerList=[["fill",nt+Ge+"-fill"],["line",nt+Ge+"-line"]],this.below=null}var at=ChoroplethMapbox.prototype;at.update=function(Ne){this._update(tt(Ne))},at.updateOnSelect=function(Ne){this._update(rt(Ne))},at._update=function(Ne){var Ge=this.subplot,Qe=this.layerList,tt=Ge.belowLookup["trace-"+this.uid];Ge.map.getSource(this.sourceId).setData(Ne.geojson),tt!==this.below&&(this._removeLayers(),this._addLayers(Ne,tt),this.below=tt);for(var rt=0;rt<Qe.length;rt++){var nt=Qe[rt],at=nt[0],it=nt[1],ot=Ne[at];Ge.setOptions(it,"setLayoutProperty",ot.layout),"visible"===ot.layout.visibility&&Ge.setOptions(it,"setPaintProperty",ot.paint)}},at._addLayers=function(Ne,Ge){for(var Qe=this.subplot,tt=this.layerList,rt=this.sourceId,nt=0;nt<tt.length;nt++){var at=tt[nt],it=at[0],ot=Ne[it];Qe.addLayer({type:it,id:at[1],source:rt,layout:ot.layout,paint:ot.paint},Ge)}},at._removeLayers=function(){for(var Ne=this.subplot.map,Ge=this.layerList,Qe=Ge.length-1;Qe>=0;Qe--)Ne.removeLayer(Ge[Qe][1])},at.dispose=function(){var Ne=this.subplot.map;this._removeLayers(),Ne.removeSource(this.sourceId)},Ge.exports=function(Ne,Ge){var Qe=Ge[0].trace,rt=new ChoroplethMapbox(Ne,Qe.uid),nt=rt.sourceId,at=tt(Ge),it=rt.below=Ne.belowLookup["trace-"+Qe.uid];return Ne.map.addSource(nt,{type:"geojson",data:at.geojson}),rt._addLayers(at,it),Ge[0].trace._glTrace=rt,rt}},{"../../plots/mapbox/constants":883,"./convert":999}],1003:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/colorscale/attributes"),rt=Ne("../../plots/template_attributes").hovertemplateAttrs,nt=Ne("../mesh3d/attributes"),at=Ne("../../plots/attributes"),it=Ne("../../lib/extend").extendFlat,ot={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},sizemode:{valType:"enumerated",values:["scaled","absolute"],editType:"calc",dflt:"scaled"},sizeref:{valType:"number",editType:"calc",min:0},anchor:{valType:"enumerated",editType:"calc",values:["tip","tail","cm","center"],dflt:"cm"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:rt({editType:"calc"},{keys:["norm"]}),showlegend:it({},at.showlegend,{dflt:!1})};it(ot,tt("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach((function(Ne){ot[Ne]=nt[Ne]})),ot.hoverinfo=it({},at.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","text","name"],dflt:"x+y+z+norm+text+name"}),ot.transforms=void 0,Ge.exports=ot},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../mesh3d/attributes":1128}],1004:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/colorscale/calc");Ge.exports=function(Ne,Ge){for(var Qe=Ge.u,rt=Ge.v,nt=Ge.w,at=Math.min(Ge.x.length,Ge.y.length,Ge.z.length,Qe.length,rt.length,nt.length),it=-1/0,ot=1/0,dt=0;dt<at;dt++){var ht=Qe[dt],Dt=rt[dt],Ot=nt[dt],Rt=Math.sqrt(ht*ht+Dt*Dt+Ot*Ot);it=Math.max(it,Rt),ot=Math.min(ot,Rt)}Ge._len=at,Ge._normMax=it,tt(Ne,Ge,{vals:[ot,it],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":651}],1005:[function(Ne,Ge,Qe){"use strict";var tt=Ne("gl-cone3d"),rt=Ne("gl-cone3d").createConeMesh,nt=Ne("../../lib").simpleMap,at=Ne("../../lib/gl_format_color").parseColorScale,it=Ne("../../components/colorscale").extractOpts,ot=Ne("../../plots/gl3d/zip3");function Cone(Ne,Ge){this.scene=Ne,this.uid=Ge,this.mesh=null,this.data=null}var dt=Cone.prototype;dt.handlePick=function(Ne){if(Ne.object===this.mesh){var Ge=Ne.index=Ne.data.index,Qe=this.data.x[Ge],tt=this.data.y[Ge],rt=this.data.z[Ge],nt=this.data.u[Ge],at=this.data.v[Ge],it=this.data.w[Ge];Ne.traceCoordinate=[Qe,tt,rt,nt,at,it,Math.sqrt(nt*nt+at*at+it*it)];var ot=this.data.hovertext||this.data.text;return Array.isArray(ot)&&void 0!==ot[Ge]?Ne.textLabel=ot[Ge]:ot&&(Ne.textLabel=ot),!0}};var ht={xaxis:0,yaxis:1,zaxis:2},Dt={tip:1,tail:0,cm:.25,center:.5},Ot={tip:1,tail:1,cm:.75,center:.5};function convert(Ne,Ge){var Qe=Ne.fullSceneLayout,rt=Ne.dataScale,dt={};function toDataCoords(Ne,Ge){var tt=Qe[Ge],at=rt[ht[Ge]];return nt(Ne,(function(Ne){return tt.d2l(Ne)*at}))}dt.vectors=ot(toDataCoords(Ge.u,"xaxis"),toDataCoords(Ge.v,"yaxis"),toDataCoords(Ge.w,"zaxis"),Ge._len),dt.positions=ot(toDataCoords(Ge.x,"xaxis"),toDataCoords(Ge.y,"yaxis"),toDataCoords(Ge.z,"zaxis"),Ge._len);var Rt=it(Ge);dt.colormap=at(Ge),dt.vertexIntensityBounds=[Rt.min/Ge._normMax,Rt.max/Ge._normMax],dt.coneOffset=Dt[Ge.anchor],"scaled"===Ge.sizemode?dt.coneSize=Ge.sizeref||.5:dt.coneSize=Ge.sizeref&&Ge._normMax?Ge.sizeref/Ge._normMax:.5;var Zt=tt(dt),er=Ge.lightposition;return Zt.lightPosition=[er.x,er.y,er.z],Zt.ambient=Ge.lighting.ambient,Zt.diffuse=Ge.lighting.diffuse,Zt.specular=Ge.lighting.specular,Zt.roughness=Ge.lighting.roughness,Zt.fresnel=Ge.lighting.fresnel,Zt.opacity=Ge.opacity,Ge._pad=Ot[Ge.anchor]*Zt.vectorScale*Zt.coneScale*Ge._normMax,Zt}function createConeTrace(Ne,Ge){var Qe=Ne.glplot.gl,tt=convert(Ne,Ge),nt=rt(Qe,tt),at=new Cone(Ne,Ge.uid);return at.mesh=nt,at.data=Ge,nt._trace=at,Ne.glplot.add(nt),at}dt.update=function(Ne){this.data=Ne;var Ge=convert(this.scene,Ne);this.mesh.update(Ge)},dt.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},Ge.exports=createConeTrace},{"../../components/colorscale":655,"../../lib":778,"../../lib/gl_format_color":774,"../../plots/gl3d/zip3":881,"gl-cone3d":260}],1006:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../components/colorscale/defaults"),nt=Ne("./attributes");Ge.exports=function(Ne,Ge,Qe,at){function coerce(Qe,rt){return tt.coerce(Ne,Ge,nt,Qe,rt)}var it=coerce("u"),ot=coerce("v"),dt=coerce("w"),ht=coerce("x"),Dt=coerce("y"),Ot=coerce("z");it&&it.length&&ot&&ot.length&&dt&&dt.length&&ht&&ht.length&&Dt&&Dt.length&&Ot&&Ot.length?(coerce("sizeref"),coerce("sizemode"),coerce("anchor"),coerce("lighting.ambient"),coerce("lighting.diffuse"),coerce("lighting.specular"),coerce("lighting.roughness"),coerce("lighting.fresnel"),coerce("lightposition.x"),coerce("lightposition.y"),coerce("lightposition.z"),rt(Ne,Ge,at,coerce,{prefix:"",cLetter:"c"}),coerce("text"),coerce("hovertext"),coerce("hovertemplate"),Ge._length=null):Ge.visible=!1}},{"../../components/colorscale/defaults":653,"../../lib":778,"./attributes":1003}],1007:[function(Ne,Ge,Qe){"use strict";Ge.exports={moduleType:"trace",name:"cone",basePlotModule:Ne("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:Ne("./calc"),plot:Ne("./convert"),eventData:function(Ne,Ge){return Ne.norm=Ge.traceCoordinate[6],Ne},meta:{}}},{"../../plots/gl3d":870,"./attributes":1003,"./calc":1004,"./convert":1005,"./defaults":1006}],1008:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../heatmap/attributes"),rt=Ne("../scatter/attributes"),nt=Ne("../../components/colorscale/attributes"),at=Ne("../../components/drawing/attributes").dash,it=Ne("../../plots/font_attributes"),ot=Ne("../../lib/extend").extendFlat,dt=Ne("../../constants/filter_ops"),ht=dt.COMPARISON_OPS2,Dt=dt.INTERVAL_OPS,Ot=(Ne("../../constants/docs").FORMAT_LINK,rt.line);Ge.exports=ot({z:tt.z,x:tt.x,x0:tt.x0,dx:tt.dx,y:tt.y,y0:tt.y0,dy:tt.dy,xperiod:tt.xperiod,yperiod:tt.yperiod,xperiod0:rt.xperiod0,yperiod0:rt.yperiod0,xperiodalignment:tt.xperiodalignment,yperiodalignment:tt.yperiodalignment,text:tt.text,hovertext:tt.hovertext,transpose:tt.transpose,xtype:tt.xtype,ytype:tt.ytype,zhoverformat:tt.zhoverformat,hovertemplate:tt.hovertemplate,hoverongaps:tt.hoverongaps,connectgaps:ot({},tt.connectgaps,{}),fillcolor:{valType:"color",editType:"calc"},autocontour:{valType:"boolean",dflt:!0,editType:"calc",impliedEdits:{"contours.start":void 0,"contours.end":void 0,"contours.size":void 0}},ncontours:{valType:"integer",dflt:15,min:1,editType:"calc"},contours:{type:{valType:"enumerated",values:["levels","constraint"],dflt:"levels",editType:"calc"},start:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},end:{valType:"number",dflt:null,editType:"plot",impliedEdits:{"^autocontour":!1}},size:{valType:"number",dflt:null,min:0,editType:"plot",impliedEdits:{"^autocontour":!1}},coloring:{valType:"enumerated",values:["fill","heatmap","lines","none"],dflt:"fill",editType:"calc"},showlines:{valType:"boolean",dflt:!0,editType:"plot"},showlabels:{valType:"boolean",dflt:!1,editType:"plot"},labelfont:it({editType:"plot",colorEditType:"style"}),labelformat:{valType:"string",dflt:"",editType:"plot"},operation:{valType:"enumerated",values:[].concat(ht).concat(Dt),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},editType:"calc",impliedEdits:{autocontour:!1}},line:{color:ot({},Ot.color,{editType:"style+colorbars"}),width:{valType:"number",min:0,editType:"style+colorbars"},dash:at,smoothing:ot({},Ot.smoothing,{}),editType:"plot"}},nt("",{cLetter:"z",autoColorDflt:!1,editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":650,"../../components/drawing/attributes":664,"../../constants/docs":748,"../../constants/filter_ops":749,"../../lib/extend":768,"../../plots/font_attributes":856,"../heatmap/attributes":1065,"../scatter/attributes":1187}],1009:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/colorscale"),rt=Ne("../heatmap/calc"),nt=Ne("./set_contours"),at=Ne("./end_plus");Ge.exports=function(Ne,Ge){var Qe=rt(Ne,Ge),it=Qe[0].z;nt(Ge,it);var ot,dt=Ge.contours,ht=tt.extractOpts(Ge);if("heatmap"===dt.coloring&&ht.auto&&!1===Ge.autocontour){var Dt=dt.start,Ot=at(dt),Rt=dt.size||1,Zt=Math.floor((Ot-Dt)/Rt)+1;isFinite(Rt)||(Rt=1,Zt=1);var er=Dt-Rt/2;ot=[er,er+Zt*Rt]}else ot=it;return tt.calc(Ne,Ge,{vals:ot,cLetter:"z"}),Qe}},{"../../components/colorscale":655,"../heatmap/calc":1066,"./end_plus":1019,"./set_contours":1027}],1010:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge){var Qe,tt=Ne[0],rt=tt.z;switch(Ge.type){case"levels":var nt=Math.min(rt[0][0],rt[0][1]);for(Qe=0;Qe<Ne.length;Qe++){var at=Ne[Qe];at.prefixBoundary=!at.edgepaths.length&&(nt>at.level||at.starts.length&&nt===at.level)}break;case"constraint":if(tt.prefixBoundary=!1,tt.edgepaths.length)return;var it=tt.x.length,ot=tt.y.length,dt=-1/0,ht=1/0;for(Qe=0;Qe<ot;Qe++)ht=Math.min(ht,rt[Qe][0]),ht=Math.min(ht,rt[Qe][it-1]),dt=Math.max(dt,rt[Qe][0]),dt=Math.max(dt,rt[Qe][it-1]);for(Qe=1;Qe<it-1;Qe++)ht=Math.min(ht,rt[0][Qe]),ht=Math.min(ht,rt[ot-1][Qe]),dt=Math.max(dt,rt[0][Qe]),dt=Math.max(dt,rt[ot-1][Qe]);var Dt,Ot,Rt=Ge.value;switch(Ge._operation){case">":Rt>dt&&(tt.prefixBoundary=!0);break;case"<":(Rt<ht||tt.starts.length&&Rt===ht)&&(tt.prefixBoundary=!0);break;case"[]":Dt=Math.min(Rt[0],Rt[1]),((Ot=Math.max(Rt[0],Rt[1]))<ht||Dt>dt||tt.starts.length&&Ot===ht)&&(tt.prefixBoundary=!0);break;case"][":Dt=Math.min(Rt[0],Rt[1]),Ot=Math.max(Rt[0],Rt[1]),Dt<ht&&Ot>dt&&(tt.prefixBoundary=!0)}}}},{}],1011:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/colorscale"),rt=Ne("./make_color_map"),nt=Ne("./end_plus");function calc(Ne,Ge,Qe){var at=Ge.contours,it=Ge.line,ot=at.size||1,dt=at.coloring,ht=rt(Ge,{isColorbar:!0});if("heatmap"===dt){var Dt=tt.extractOpts(Ge);Qe._fillgradient=Dt.reversescale?tt.flipScale(Dt.colorscale):Dt.colorscale,Qe._zrange=[Dt.min,Dt.max]}else"fill"===dt&&(Qe._fillcolor=ht);Qe._line={color:"lines"===dt?ht:it.color,width:!1!==at.showlines?it.width:0,dash:it.dash},Qe._levels={start:at.start,end:nt(at),size:ot}}Ge.exports={min:"zmin",max:"zmax",calc:calc}},{"../../components/colorscale":655,"./end_plus":1019,"./make_color_map":1024}],1012:[function(Ne,Ge,Qe){"use strict";Ge.exports={BOTTOMSTART:[1,9,13,104,713],TOPSTART:[4,6,7,104,713],LEFTSTART:[8,12,14,208,1114],RIGHTSTART:[2,3,11,208,1114],NEWDELTA:[null,[-1,0],[0,-1],[-1,0],[1,0],null,[0,-1],[-1,0],[0,1],[0,1],null,[0,1],[1,0],[1,0],[0,-1]],CHOOSESADDLE:{104:[4,1],208:[2,8],713:[7,13],1114:[11,14]},SADDLEREMAINDER:{1:4,2:8,4:1,7:13,8:2,11:14,13:7,14:11},LABELDISTANCE:2,LABELINCREASE:10,LABELMIN:3,LABELMAX:10,LABELOPTIMIZER:{EDGECOST:1,ANGLECOST:1,NEIGHBORCOST:5,SAMELEVELFACTOR:10,SAMELEVELDISTANCE:5,MAXCOST:100,INITIALSEARCHPOINTS:10,ITERATIONS:5}}},{}],1013:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("./label_defaults"),nt=Ne("../../components/color"),at=nt.addOpacity,it=nt.opacity,ot=Ne("../../constants/filter_ops"),dt=ot.CONSTRAINT_REDUCTION,ht=ot.COMPARISON_OPS2;function handleConstraintValueDefaults(Ne,Ge){var Qe;-1===ht.indexOf(Ge.operation)?(Ne("contours.value",[0,1]),Array.isArray(Ge.value)?Ge.value.length>2?Ge.value=Ge.value.slice(2):0===Ge.length?Ge.value=[0,1]:Ge.length<2?(Qe=parseFloat(Ge.value[0]),Ge.value=[Qe,Qe+1]):Ge.value=[parseFloat(Ge.value[0]),parseFloat(Ge.value[1])]:tt(Ge.value)&&(Qe=parseFloat(Ge.value),Ge.value=[Qe,Qe+1])):(Ne("contours.value",0),tt(Ge.value)||(Array.isArray(Ge.value)?Ge.value=parseFloat(Ge.value[0]):Ge.value=0))}Ge.exports=function(Ne,Ge,Qe,tt,nt,ot){var ht,Dt,Ot,Rt=Ge.contours,Zt=Qe("contours.operation");Rt._operation=dt[Zt],handleConstraintValueDefaults(Qe,Rt),"="===Zt?ht=Rt.showlines=!0:(ht=Qe("contours.showlines"),Ot=Qe("fillcolor",at((Ne.line||{}).color||nt,.5))),ht&&(Dt=Qe("line.color",Ot&&it(Ot)?at(Ge.fillcolor,1):nt),Qe("line.width",2),Qe("line.dash")),Qe("line.smoothing"),rt(Qe,tt,Dt,ot)}},{"../../components/color":643,"../../constants/filter_ops":749,"./label_defaults":1023,"fast-isnumeric":241}],1014:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../constants/filter_ops"),rt=Ne("fast-isnumeric");function coerceValue(Ne,Ge){var Qe,nt=Array.isArray(Ge);function coerce(Ne){return rt(Ne)?+Ne:null}return-1!==tt.COMPARISON_OPS2.indexOf(Ne)?Qe=coerce(nt?Ge[0]:Ge):-1!==tt.INTERVAL_OPS.indexOf(Ne)?Qe=nt?[coerce(Ge[0]),coerce(Ge[1])]:[coerce(Ge),coerce(Ge)]:-1!==tt.SET_OPS.indexOf(Ne)&&(Qe=nt?Ge.map(coerce):[coerce(Ge)]),Qe}function makeRangeSettings(Ne){return function(Ge){Ge=coerceValue(Ne,Ge);var Qe=Math.min(Ge[0],Ge[1]),tt=Math.max(Ge[0],Ge[1]);return{start:Qe,end:tt,size:tt-Qe}}}function makeInequalitySettings(Ne){return function(Ge){return{start:Ge=coerceValue(Ne,Ge),end:1/0,size:1/0}}}Ge.exports={"[]":makeRangeSettings("[]"),"][":makeRangeSettings("]["),">":makeInequalitySettings(">"),"<":makeInequalitySettings("<"),"=":makeInequalitySettings("=")}},{"../../constants/filter_ops":749,"fast-isnumeric":241}],1015:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge,Qe,tt){var rt=tt("contours.start"),nt=tt("contours.end"),at=!1===rt||!1===nt,it=Qe("contours.size");!(at?Ge.autocontour=!0:Qe("autocontour",!1))&&it||Qe("ncontours")}},{}],1016:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib");function copyPathinfo(Ne){return tt.extendFlat({},Ne,{edgepaths:tt.extendDeep([],Ne.edgepaths),paths:tt.extendDeep([],Ne.paths),starts:tt.extendDeep([],Ne.starts)})}Ge.exports=function(Ne,Ge){var Qe,rt,nt,op0=function(Ne){return Ne.reverse()},op1=function(Ne){return Ne};switch(Ge){case"=":case"<":return Ne;case">":for(1!==Ne.length&&tt.warn("Contour data invalid for the specified inequality operation."),rt=Ne[0],Qe=0;Qe<rt.edgepaths.length;Qe++)rt.edgepaths[Qe]=op0(rt.edgepaths[Qe]);for(Qe=0;Qe<rt.paths.length;Qe++)rt.paths[Qe]=op0(rt.paths[Qe]);for(Qe=0;Qe<rt.starts.length;Qe++)rt.starts[Qe]=op0(rt.starts[Qe]);return Ne;case"][":var at=op0;op0=op1,op1=at;case"[]":for(2!==Ne.length&&tt.warn("Contour data invalid for the specified inequality range operation."),rt=copyPathinfo(Ne[0]),nt=copyPathinfo(Ne[1]),Qe=0;Qe<rt.edgepaths.length;Qe++)rt.edgepaths[Qe]=op0(rt.edgepaths[Qe]);for(Qe=0;Qe<rt.paths.length;Qe++)rt.paths[Qe]=op0(rt.paths[Qe]);for(Qe=0;Qe<rt.starts.length;Qe++)rt.starts[Qe]=op0(rt.starts[Qe]);for(;nt.edgepaths.length;)rt.edgepaths.push(op1(nt.edgepaths.shift()));for(;nt.paths.length;)rt.paths.push(op1(nt.paths.shift()));for(;nt.starts.length;)rt.starts.push(op1(nt.starts.shift()));return[rt]}}},{"../../lib":778}],1017:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../heatmap/xyz_defaults"),nt=Ne("../scatter/period_defaults"),at=Ne("./constraint_defaults"),it=Ne("./contours_defaults"),ot=Ne("./style_defaults"),dt=Ne("./attributes");Ge.exports=function(Ne,Ge,Qe,ht){function coerce(Qe,rt){return tt.coerce(Ne,Ge,dt,Qe,rt)}function coerce2(Qe){return tt.coerce2(Ne,Ge,dt,Qe)}if(rt(Ne,Ge,coerce,ht)){nt(Ne,Ge,ht,coerce),coerce("text"),coerce("hovertext"),coerce("hovertemplate"),coerce("hoverongaps");var Dt="constraint"===coerce("contours.type");coerce("connectgaps",tt.isArray1D(Ge.z)),Dt?at(Ne,Ge,coerce,ht,Qe):(it(Ne,Ge,coerce,coerce2),ot(Ne,Ge,coerce,ht))}else Ge.visible=!1}},{"../../lib":778,"../heatmap/xyz_defaults":1079,"../scatter/period_defaults":1207,"./attributes":1008,"./constraint_defaults":1013,"./contours_defaults":1015,"./style_defaults":1029}],1018:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./constraint_mapping"),nt=Ne("./end_plus");Ge.exports=function(Ne,Ge,Qe){for(var at="constraint"===Ne.type?rt[Ne._operation](Ne.value):Ne,it=at.size,ot=[],dt=nt(at),ht=Qe.trace._carpetTrace,Dt=ht?{xaxis:ht.aaxis,yaxis:ht.baxis,x:Qe.a,y:Qe.b}:{xaxis:Ge.xaxis,yaxis:Ge.yaxis,x:Qe.x,y:Qe.y},Ot=at.start;Ot<dt;Ot+=it)if(ot.push(tt.extendFlat({level:Ot,crossings:{},starts:[],edgepaths:[],paths:[],z:Qe.z,smoothing:Qe.trace.line.smoothing},Dt)),ot.length>1e3){tt.warn("Too many contours, clipping at 1000",Ne);break}return ot}},{"../../lib":778,"./constraint_mapping":1014,"./end_plus":1019}],1019:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne){return Ne.end+Ne.size/1e6}},{}],1020:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./constants");function equalPts(Ne,Ge,Qe,tt){return Math.abs(Ne[0]-Ge[0])<Qe&&Math.abs(Ne[1]-Ge[1])<tt}function ptDist(Ne,Ge){var Qe=Ne[2]-Ge[2],tt=Ne[3]-Ge[3];return Math.sqrt(Qe*Qe+tt*tt)}function makePath(Ne,Ge,Qe,nt,at){var it,ot=Ge.join(","),dt=Ne.crossings[ot],ht=getStartStep(dt,Qe,Ge),Dt=[getInterpPx(Ne,Ge,[-ht[0],-ht[1]])],Ot=Ne.z.length,Rt=Ne.z[0].length,Zt=Ge.slice(),er=ht.slice();for(it=0;it<1e4;it++){if(dt>20?(dt=rt.CHOOSESADDLE[dt][(ht[0]||ht[1])<0?0:1],Ne.crossings[ot]=rt.SADDLEREMAINDER[dt]):delete Ne.crossings[ot],!(ht=rt.NEWDELTA[dt])){tt.log("Found bad marching index:",dt,Ge,Ne.level);break}Dt.push(getInterpPx(Ne,Ge,ht)),Ge[0]+=ht[0],Ge[1]+=ht[1],ot=Ge.join(","),equalPts(Dt[Dt.length-1],Dt[Dt.length-2],nt,at)&&Dt.pop();var dr=ht[0]&&(Ge[0]<0||Ge[0]>Rt-2)||ht[1]&&(Ge[1]<0||Ge[1]>Ot-2);if(Ge[0]===Zt[0]&&Ge[1]===Zt[1]&&ht[0]===er[0]&&ht[1]===er[1]||Qe&&dr)break;dt=Ne.crossings[ot]}1e4===it&&tt.log("Infinite loop in contour?");var mr,xr,br,Ar,en,mn,xn,kn,Cn,En,Pn,Dn=equalPts(Dt[0],Dt[Dt.length-1],nt,at),In=0,zn=.2*Ne.smoothing,Bn=[],Vn=0;for(it=1;it<Dt.length;it++)In+=xn=ptDist(Dt[it],Dt[it-1]),Bn.push(xn);var Hn=In/Bn.length*zn;function getpt(Ne){return Dt[Ne%Dt.length]}for(it=Dt.length-2;it>=Vn;it--)if((mr=Bn[it])<Hn){for(br=0,xr=it-1;xr>=Vn&&mr+Bn[xr]<Hn;xr--)mr+=Bn[xr];if(Dn&&it===Dt.length-2)for(br=0;br<xr&&mr+Bn[br]<Hn;br++)mr+=Bn[br];en=it-xr+br+1,mn=Math.floor((it+xr+br+2)/2),Ar=Dn||it!==Dt.length-2?Dn||-1!==xr?en%2?getpt(mn):[(getpt(mn)[0]+getpt(mn+1)[0])/2,(getpt(mn)[1]+getpt(mn+1)[1])/2]:Dt[0]:Dt[Dt.length-1],Dt.splice(xr+1,it-xr+1,Ar),it=xr+1,br&&(Vn=br),Dn&&(it===Dt.length-2?Dt[br]=Dt[Dt.length-1]:0===it&&(Dt[Dt.length-1]=Dt[0]))}for(Dt.splice(0,Vn),it=0;it<Dt.length;it++)Dt[it].length=2;if(!(Dt.length<2))if(Dn)Dt.pop(),Ne.paths.push(Dt);else{Qe||tt.log("Unclosed interior contour?",Ne.level,Zt.join(","),Dt.join("L"));var qn=!1;for(kn=0;kn<Ne.edgepaths.length;kn++)if(En=Ne.edgepaths[kn],!qn&&equalPts(En[0],Dt[Dt.length-1],nt,at)){Dt.pop(),qn=!0;var Yn=!1;for(Cn=0;Cn<Ne.edgepaths.length;Cn++)if(equalPts((Pn=Ne.edgepaths[Cn])[Pn.length-1],Dt[0],nt,at)){Yn=!0,Dt.shift(),Ne.edgepaths.splice(kn,1),Cn===kn?Ne.paths.push(Dt.concat(Pn)):(Cn>kn&&Cn--,Ne.edgepaths[Cn]=Pn.concat(Dt,En));break}Yn||(Ne.edgepaths[kn]=Dt.concat(En))}for(kn=0;kn<Ne.edgepaths.length&&!qn;kn++)equalPts((En=Ne.edgepaths[kn])[En.length-1],Dt[0],nt,at)&&(Dt.shift(),Ne.edgepaths[kn]=En.concat(Dt),qn=!0);qn||Ne.edgepaths.push(Dt)}}function getStartStep(Ne,Ge,Qe){var tt=0,nt=0;return Ne>20&&Ge?208===Ne||1114===Ne?tt=0===Qe[0]?1:-1:nt=0===Qe[1]?1:-1:-1!==rt.BOTTOMSTART.indexOf(Ne)?nt=1:-1!==rt.LEFTSTART.indexOf(Ne)?tt=1:-1!==rt.TOPSTART.indexOf(Ne)?nt=-1:tt=-1,[tt,nt]}function getInterpPx(Ne,Ge,Qe){var tt=Ge[0]+Math.max(Qe[0],0),rt=Ge[1]+Math.max(Qe[1],0),nt=Ne.z[rt][tt],at=Ne.xaxis,it=Ne.yaxis;if(Qe[1]){var ot=(Ne.level-nt)/(Ne.z[rt][tt+1]-nt);return[at.c2p((1-ot)*Ne.x[tt]+ot*Ne.x[tt+1],!0),it.c2p(Ne.y[rt],!0),tt+ot,rt]}var dt=(Ne.level-nt)/(Ne.z[rt+1][tt]-nt);return[at.c2p(Ne.x[tt],!0),it.c2p((1-dt)*Ne.y[rt]+dt*Ne.y[rt+1],!0),tt,rt+dt]}Ge.exports=function(Ne,Ge,Qe){var rt,nt,at,it;for(Ge=Ge||.01,Qe=Qe||.01,nt=0;nt<Ne.length;nt++){for(at=Ne[nt],it=0;it<at.starts.length;it++)makePath(at,at.starts[it],"edge",Ge,Qe);for(rt=0;Object.keys(at.crossings).length&&rt<1e4;)rt++,makePath(at,Object.keys(at.crossings)[0].split(",").map(Number),void 0,Ge,Qe);1e4===rt&&tt.log("Infinite loop in contour?")}}},{"../../lib":778,"./constants":1012}],1021:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/color"),rt=Ne("../heatmap/hover");Ge.exports=function(Ne,Ge,Qe,nt,at){var it=rt(Ne,Ge,Qe,nt,at,!0);return it&&it.forEach((function(Ne){var Ge=Ne.trace;"constraint"===Ge.contours.type&&(Ge.fillcolor&&tt.opacity(Ge.fillcolor)?Ne.color=tt.addOpacity(Ge.fillcolor,1):Ge.contours.showlines&&tt.opacity(Ge.line.color)&&(Ne.color=tt.addOpacity(Ge.line.color,1)))})),it}},{"../../components/color":643,"../heatmap/hover":1072}],1022:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),calc:Ne("./calc"),plot:Ne("./plot").plot,style:Ne("./style"),colorbar:Ne("./colorbar"),hoverPoints:Ne("./hover"),moduleType:"trace",name:"contour",basePlotModule:Ne("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","showLegend"],meta:{}}},{"../../plots/cartesian":841,"./attributes":1008,"./calc":1009,"./colorbar":1011,"./defaults":1017,"./hover":1021,"./plot":1026,"./style":1028}],1023:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib");Ge.exports=function(Ne,Ge,Qe,rt){if(rt||(rt={}),Ne("contours.showlabels")){var nt=Ge.font;tt.coerceFont(Ne,"contours.labelfont",{family:nt.family,size:nt.size,color:Qe}),Ne("contours.labelformat")}!1!==rt.hasHover&&Ne("zhoverformat")}},{"../../lib":778}],1024:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../components/colorscale"),nt=Ne("./end_plus");Ge.exports=function(Ne){var Ge=Ne.contours,Qe=Ge.start,at=nt(Ge),it=Ge.size||1,ot=Math.floor((at-Qe)/it)+1,dt="lines"===Ge.coloring?0:1,ht=rt.extractOpts(Ne);isFinite(it)||(it=1,ot=1);var Dt,Ot,Rt=ht.reversescale?rt.flipScale(ht.colorscale):ht.colorscale,Zt=Rt.length,er=new Array(Zt),dr=new Array(Zt);if("heatmap"===Ge.coloring){var mr=ht.min,xr=ht.max;for(Ot=0;Ot<Zt;Ot++)Dt=Rt[Ot],er[Ot]=Dt[0]*(xr-mr)+mr,dr[Ot]=Dt[1];var br=tt.extent([mr,xr,Ge.start,Ge.start+it*(ot-1)]),Ar=br[mr<xr?0:1],en=br[mr<xr?1:0];Ar!==mr&&(er.splice(0,0,Ar),dr.splice(0,0,dr[0])),en!==xr&&(er.push(en),dr.push(dr[dr.length-1]))}else for(Ot=0;Ot<Zt;Ot++)Dt=Rt[Ot],er[Ot]=(Dt[0]*(ot+dt-1)-dt/2)*it+Qe,dr[Ot]=Dt[1];return rt.makeColorScaleFunc({domain:er,range:dr},{noNumericCheck:!0})}},{"../../components/colorscale":655,"./end_plus":1019,d3:169}],1025:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./constants");function getMarchingIndex(Ne,Ge){var Qe=(Ge[0][0]>Ne?0:1)+(Ge[0][1]>Ne?0:2)+(Ge[1][1]>Ne?0:4)+(Ge[1][0]>Ne?0:8);return 5===Qe||10===Qe?Ne>(Ge[0][0]+Ge[0][1]+Ge[1][0]+Ge[1][1])/4?5===Qe?713:1114:5===Qe?104:208:15===Qe?0:Qe}Ge.exports=function(Ne){var Ge,Qe,rt,nt,at,it,ot,dt,ht,Dt=Ne[0].z,Ot=Dt.length,Rt=Dt[0].length,Zt=2===Ot||2===Rt;for(Qe=0;Qe<Ot-1;Qe++)for(nt=[],0===Qe&&(nt=nt.concat(tt.BOTTOMSTART)),Qe===Ot-2&&(nt=nt.concat(tt.TOPSTART)),Ge=0;Ge<Rt-1;Ge++)for(rt=nt.slice(),0===Ge&&(rt=rt.concat(tt.LEFTSTART)),Ge===Rt-2&&(rt=rt.concat(tt.RIGHTSTART)),at=Ge+","+Qe,it=[[Dt[Qe][Ge],Dt[Qe][Ge+1]],[Dt[Qe+1][Ge],Dt[Qe+1][Ge+1]]],ht=0;ht<Ne.length;ht++)(ot=getMarchingIndex((dt=Ne[ht]).level,it))&&(dt.crossings[at]=ot,-1!==rt.indexOf(ot)&&(dt.starts.push([Ge,Qe]),Zt&&-1!==rt.indexOf(ot,rt.indexOf(ot)+1)&&dt.starts.push([Ge,Qe])))}},{"./constants":1012}],1026:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../lib"),nt=Ne("../../components/drawing"),at=Ne("../../components/colorscale"),it=Ne("../../lib/svg_text_utils"),ot=Ne("../../plots/cartesian/axes"),dt=Ne("../../plots/cartesian/set_convert"),ht=Ne("../heatmap/plot"),Dt=Ne("./make_crossings"),Ot=Ne("./find_all_paths"),Rt=Ne("./empty_pathinfo"),Zt=Ne("./convert_to_constraints"),er=Ne("./close_boundaries"),dr=Ne("./constants"),mr=dr.LABELOPTIMIZER;function makeBackground(Ne,Ge,Qe){var tt=rt.ensureSingle(Ne,"g","contourbg").selectAll("path").data("fill"===Qe.coloring?[0]:[]);tt.enter().append("path"),tt.exit().remove(),tt.attr("d","M"+Ge.join("L")+"Z").style("stroke","none")}function makeFills(Ne,Ge,Qe,nt){var at="fill"===nt.coloring||"constraint"===nt.type&&"="!==nt._operation,it="M"+Qe.join("L")+"Z";at&&er(Ge,nt);var ot=rt.ensureSingle(Ne,"g","contourfill").selectAll("path").data(at?Ge:[]);ot.enter().append("path"),ot.exit().remove(),ot.each((function(Ne){var Ge=(Ne.prefixBoundary?it:"")+joinAllPaths(Ne,Qe);Ge?tt.select(this).attr("d",Ge).style("stroke","none"):tt.select(this).remove()}))}function joinAllPaths(Ne,Ge){var Qe,tt,at,it,ot,dt,ht="",Dt=0,Ot=Ne.edgepaths.map((function(Ne,Ge){return Ge})),Rt=!0;function istop(Ne){return Math.abs(Ne[1]-Ge[0][1])<.01}function isbottom(Ne){return Math.abs(Ne[1]-Ge[2][1])<.01}function isleft(Ne){return Math.abs(Ne[0]-Ge[0][0])<.01}function isright(Ne){return Math.abs(Ne[0]-Ge[2][0])<.01}for(;Ot.length;){for(dt=nt.smoothopen(Ne.edgepaths[Dt],Ne.smoothing),ht+=Rt?dt:dt.replace(/^M/,"L"),Ot.splice(Ot.indexOf(Dt),1),Qe=Ne.edgepaths[Dt][Ne.edgepaths[Dt].length-1],it=-1,at=0;at<4;at++){if(!Qe){rt.log("Missing end?",Dt,Ne);break}for(istop(Qe)&&!isright(Qe)?tt=Ge[1]:isleft(Qe)?tt=Ge[0]:isbottom(Qe)?tt=Ge[3]:isright(Qe)&&(tt=Ge[2]),ot=0;ot<Ne.edgepaths.length;ot++){var Zt=Ne.edgepaths[ot][0];Math.abs(Qe[0]-tt[0])<.01?Math.abs(Qe[0]-Zt[0])<.01&&(Zt[1]-Qe[1])*(tt[1]-Zt[1])>=0&&(tt=Zt,it=ot):Math.abs(Qe[1]-tt[1])<.01?Math.abs(Qe[1]-Zt[1])<.01&&(Zt[0]-Qe[0])*(tt[0]-Zt[0])>=0&&(tt=Zt,it=ot):rt.log("endpt to newendpt is not vert. or horz.",Qe,tt,Zt)}if(Qe=tt,it>=0)break;ht+="L"+tt}if(it===Ne.edgepaths.length){rt.log("unclosed perimeter path");break}Dt=it,(Rt=-1===Ot.indexOf(Dt))&&(Dt=Ot[0],ht+="Z")}for(Dt=0;Dt<Ne.paths.length;Dt++)ht+=nt.smoothclosed(Ne.paths[Dt],Ne.smoothing);return ht}function makeLinesAndLabels(Ne,Ge,at,it,ot){var dt=rt.ensureSingle(Ne,"g","contourlines"),ht=!1!==ot.showlines,Dt=ot.showlabels,Ot=ht&&Dt,Rt=Qe.createLines(dt,ht||Dt,Ge),Zt=Qe.createLineClip(dt,Ot,at,it.trace.uid),er=Ne.selectAll("g.contourlabels").data(Dt?[0]:[]);if(er.exit().remove(),er.enter().append("g").classed("contourlabels",!0),Dt){var mr=[],xr=[];rt.clearLocationCache();var br=Qe.labelFormatter(at,it),Ar=nt.tester.append("text").attr("data-notex",1).call(nt.font,ot.labelfont),en=Ge[0].xaxis,mn=Ge[0].yaxis,xn=en._length,kn=mn._length,Cn=en.range,En=mn.range,Pn=rt.aggNums(Math.min,null,it.x),Dn=rt.aggNums(Math.max,null,it.x),In=rt.aggNums(Math.min,null,it.y),zn=rt.aggNums(Math.max,null,it.y),Bn=Math.max(en.c2p(Pn,!0),0),Vn=Math.min(en.c2p(Dn,!0),xn),Hn=Math.max(mn.c2p(zn,!0),0),qn=Math.min(mn.c2p(In,!0),kn),Yn={};Cn[0]<Cn[1]?(Yn.left=Bn,Yn.right=Vn):(Yn.left=Vn,Yn.right=Bn),En[0]<En[1]?(Yn.top=Hn,Yn.bottom=qn):(Yn.top=qn,Yn.bottom=Hn),Yn.middle=(Yn.top+Yn.bottom)/2,Yn.center=(Yn.left+Yn.right)/2,mr.push([[Yn.left,Yn.top],[Yn.right,Yn.top],[Yn.right,Yn.bottom],[Yn.left,Yn.bottom]]);var $n=Math.sqrt(xn*xn+kn*kn),ra=dr.LABELDISTANCE*$n/Math.max(1,Ge.length/dr.LABELINCREASE);Rt.each((function(Ne){var Ge=Qe.calcTextOpts(Ne.level,br,Ar,at);tt.select(this).selectAll("path").each((function(){var Ne=this,tt=rt.getVisibleSegment(Ne,Yn,Ge.height/2);if(tt&&!(tt.len<(Ge.width+Ge.height)*dr.LABELMIN))for(var nt=Math.min(Math.ceil(tt.len/ra),dr.LABELMAX),at=0;at<nt;at++){var it=Qe.findBestTextLocation(Ne,tt,Ge,xr,Yn);if(!it)break;Qe.addLabelData(it,Ge,xr,mr)}}))})),Ar.remove(),Qe.drawLabels(er,xr,at,Zt,Ot?mr:null)}Dt&&!ht&&Rt.remove()}function locationCost(Ne,Ge,Qe,tt){var nt=Ge.width/2,at=Ge.height/2,it=Ne.x,ot=Ne.y,dt=Ne.theta,ht=Math.cos(dt)*nt,Dt=Math.sin(dt)*nt,Ot=(it>tt.center?tt.right-it:it-tt.left)/(ht+Math.abs(Math.sin(dt)*at)),Rt=(ot>tt.middle?tt.bottom-ot:ot-tt.top)/(Math.abs(Dt)+Math.cos(dt)*at);if(Ot<1||Rt<1)return 1/0;var Zt=mr.EDGECOST*(1/(Ot-1)+1/(Rt-1));Zt+=mr.ANGLECOST*dt*dt;for(var er=it-ht,dr=ot-Dt,xr=it+ht,br=ot+Dt,Ar=0;Ar<Qe.length;Ar++){var en=Qe[Ar],mn=Math.cos(en.theta)*en.width/2,xn=Math.sin(en.theta)*en.width/2,kn=2*rt.segmentDistance(er,dr,xr,br,en.x-mn,en.y-xn,en.x+mn,en.y+xn)/(Ge.height+en.height),Cn=en.level===Ge.level,En=Cn?mr.SAMELEVELDISTANCE:1;if(kn<=En)return 1/0;Zt+=mr.NEIGHBORCOST*(Cn?mr.SAMELEVELFACTOR:1)/(kn-En)}return Zt}function clipGaps(Ne,Ge,Qe,tt,at){var it=tt.trace,ot=Qe._fullLayout._clips,dt="clip"+it.uid,ht=ot.selectAll("#"+dt).data(it.connectgaps?[]:[0]);if(ht.enter().append("clipPath").classed("contourclip",!0).attr("id",dt),ht.exit().remove(),!1===it.connectgaps){var Rt={level:.9,crossings:{},starts:[],edgepaths:[],paths:[],xaxis:Ge.xaxis,yaxis:Ge.yaxis,x:tt.x,y:tt.y,z:makeClipMask(tt),smoothing:0};Dt([Rt]),Ot([Rt]),er([Rt],{type:"levels"}),rt.ensureSingle(ht,"path","").attr("d",(Rt.prefixBoundary?"M"+at.join("L")+"Z":"")+joinAllPaths(Rt,at))}else dt=null;nt.setClipUrl(Ne,dt,Qe)}function makeClipMask(Ne){var Ge,Qe,tt=Ne.trace._emptypoints,rt=[],nt=Ne.z.length,at=Ne.z[0].length,it=[];for(Ge=0;Ge<at;Ge++)it.push(1);for(Ge=0;Ge<nt;Ge++)rt.push(it.slice());for(Ge=0;Ge<tt.length;Ge++)rt[(Qe=tt[Ge])[0]][Qe[1]]=0;return Ne.zmask=rt,rt}Qe.plot=function(Ne,Ge,Qe,nt){var at=Ge.xaxis,it=Ge.yaxis;rt.makeTraceGroups(nt,Qe,"contour").each((function(Qe){var nt=tt.select(this),ot=Qe[0],dt=ot.trace,er=ot.x,dr=ot.y,mr=dt.contours,xr=Rt(mr,Ge,ot),br=rt.ensureSingle(nt,"g","heatmapcoloring"),Ar=[];"heatmap"===mr.coloring&&(Ar=[Qe]),ht(Ne,Ge,Ar,br),Dt(xr),Ot(xr);var en=at.c2p(er[0],!0),mn=at.c2p(er[er.length-1],!0),xn=it.c2p(dr[0],!0),kn=it.c2p(dr[dr.length-1],!0),Cn=[[en,kn],[mn,kn],[mn,xn],[en,xn]],En=xr;"constraint"===mr.type&&(En=Zt(xr,mr._operation)),makeBackground(nt,Cn,mr),makeFills(nt,En,Cn,mr),makeLinesAndLabels(nt,xr,Ne,ot,mr),clipGaps(nt,Ge,Ne,ot,Cn)}))},Qe.createLines=function(Ne,Ge,Qe){var tt=Qe[0].smoothing,rt=Ne.selectAll("g.contourlevel").data(Ge?Qe:[]);if(rt.exit().remove(),rt.enter().append("g").classed("contourlevel",!0),Ge){var at=rt.selectAll("path.openline").data((function(Ne){return Ne.pedgepaths||Ne.edgepaths}));at.exit().remove(),at.enter().append("path").classed("openline",!0),at.attr("d",(function(Ne){return nt.smoothopen(Ne,tt)})).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke");var it=rt.selectAll("path.closedline").data((function(Ne){return Ne.ppaths||Ne.paths}));it.exit().remove(),it.enter().append("path").classed("closedline",!0),it.attr("d",(function(Ne){return nt.smoothclosed(Ne,tt)})).style("stroke-miterlimit",1).style("vector-effect","non-scaling-stroke")}return rt},Qe.createLineClip=function(Ne,Ge,Qe,tt){var rt=Ge?"clipline"+tt:null,at=Qe._fullLayout._clips.selectAll("#"+rt).data(Ge?[0]:[]);return at.exit().remove(),at.enter().append("clipPath").classed("contourlineclip",!0).attr("id",rt),nt.setClipUrl(Ne,rt,Qe),at},Qe.labelFormatter=function(Ne,Ge){var Qe=Ne._fullLayout,tt=Ge.trace,rt=tt.contours,nt={type:"linear",_id:"ycontour",showexponent:"all",exponentformat:"B"};if(rt.labelformat)nt.tickformat=rt.labelformat,dt(nt,Qe);else{var it=at.extractOpts(tt);if(it&&it.colorbar&&it.colorbar._axis)nt=it.colorbar._axis;else{if("constraint"===rt.type){var ht=rt.value;Array.isArray(ht)?nt.range=[ht[0],ht[ht.length-1]]:nt.range=[ht,ht]}else nt.range=[rt.start,rt.end],nt.nticks=(rt.end-rt.start)/rt.size;nt.range[0]===nt.range[1]&&(nt.range[1]+=nt.range[0]||1),nt.nticks||(nt.nticks=1e3),dt(nt,Qe),ot.prepTicks(nt),nt._tmin=null,nt._tmax=null}}return function(Ne){return ot.tickText(nt,Ne).text}},Qe.calcTextOpts=function(Ne,Ge,Qe,tt){var rt=Ge(Ne);Qe.text(rt).call(it.convertToTspans,tt);var at=Qe.node(),ot=nt.bBox(at,!0);return{text:rt,width:ot.width,height:ot.height,fontSize:+at.style["font-size"].replace("px",""),level:Ne,dy:(ot.top+ot.bottom)/2}},Qe.findBestTextLocation=function(Ne,Ge,Qe,tt,nt){var at,it,ot,dt,ht,Dt=Qe.width;Ge.isClosed?(it=Ge.len/mr.INITIALSEARCHPOINTS,at=Ge.min+it/2,ot=Ge.max):(it=(Ge.len-Dt)/(mr.INITIALSEARCHPOINTS+1),at=Ge.min+it+Dt/2,ot=Ge.max-(it+Dt)/2);for(var Ot=1/0,Rt=0;Rt<mr.ITERATIONS;Rt++){for(var Zt=at;Zt<ot;Zt+=it){var er=rt.getTextLocation(Ne,Ge.total,Zt,Dt),dr=locationCost(er,Qe,tt,nt);dr<Ot&&(Ot=dr,ht=er,dt=Zt)}if(Ot>2*mr.MAXCOST)break;Rt&&(it/=2),ot=(at=dt-it/2)+1.5*it}if(Ot<=mr.MAXCOST)return ht},Qe.addLabelData=function(Ne,Ge,Qe,tt){var rt=Ge.fontSize,nt=Ge.width+rt/3,at=Math.max(0,Ge.height-rt/3),it=Ne.x,ot=Ne.y,dt=Ne.theta,ht=Math.sin(dt),Dt=Math.cos(dt),rotateXY=function(Ne,Ge){return[it+Ne*Dt-Ge*ht,ot+Ne*ht+Ge*Dt]},Ot=[rotateXY(-nt/2,-at/2),rotateXY(-nt/2,at/2),rotateXY(nt/2,at/2),rotateXY(nt/2,-at/2)];Qe.push({text:Ge.text,x:it,y:ot,dy:Ge.dy,theta:dt,level:Ge.level,width:nt,height:at}),tt.push(Ot)},Qe.drawLabels=function(Ne,Ge,Qe,nt,at){var ot=Ne.selectAll("text").data(Ge,(function(Ne){return Ne.text+","+Ne.x+","+Ne.y+","+Ne.theta}));if(ot.exit().remove(),ot.enter().append("text").attr({"data-notex":1,"text-anchor":"middle"}).each((function(Ne){var Ge=Ne.x+Math.sin(Ne.theta)*Ne.dy,rt=Ne.y-Math.cos(Ne.theta)*Ne.dy;tt.select(this).text(Ne.text).attr({x:Ge,y:rt,transform:"rotate("+180*Ne.theta/Math.PI+" "+Ge+" "+rt+")"}).call(it.convertToTspans,Qe)})),at){for(var dt="",ht=0;ht<at.length;ht++)dt+="M"+at[ht].join("L")+"Z";rt.ensureSingle(nt,"path","").attr("d",dt)}}},{"../../components/colorscale":655,"../../components/drawing":665,"../../lib":778,"../../lib/svg_text_utils":803,"../../plots/cartesian/axes":828,"../../plots/cartesian/set_convert":848,"../heatmap/plot":1076,"./close_boundaries":1010,"./constants":1012,"./convert_to_constraints":1016,"./empty_pathinfo":1018,"./find_all_paths":1020,"./make_crossings":1025,d3:169}],1027:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/cartesian/axes"),rt=Ne("../../lib");function autoContours(Ne,Ge,Qe){var rt={type:"linear",range:[Ne,Ge]};return tt.autoTicks(rt,(Ge-Ne)/(Qe||15)),rt}Ge.exports=function(Ne,Ge){var Qe=Ne.contours;if(Ne.autocontour){var nt=Ne.zmin,at=Ne.zmax;(Ne.zauto||void 0===nt)&&(nt=rt.aggNums(Math.min,null,Ge)),(Ne.zauto||void 0===at)&&(at=rt.aggNums(Math.max,null,Ge));var it=autoContours(nt,at,Ne.ncontours);Qe.size=it.dtick,Qe.start=tt.tickFirst(it),it.range.reverse(),Qe.end=tt.tickFirst(it),Qe.start===nt&&(Qe.start+=Qe.size),Qe.end===at&&(Qe.end-=Qe.size),Qe.start>Qe.end&&(Qe.start=Qe.end=(Qe.start+Qe.end)/2),Ne._input.contours||(Ne._input.contours={}),rt.extendFlat(Ne._input.contours,{start:Qe.start,end:Qe.end,size:Qe.size}),Ne._input.autocontour=!0}else if("constraint"!==Qe.type){var ot,dt=Qe.start,ht=Qe.end,Dt=Ne._input.contours;dt>ht&&(Qe.start=Dt.start=ht,ht=Qe.end=Dt.end=dt,dt=Qe.start),Qe.size>0||(ot=dt===ht?1:autoContours(dt,ht,Ne.ncontours).dtick,Dt.size=Qe.size=ot)}}},{"../../lib":778,"../../plots/cartesian/axes":828}],1028:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../components/drawing"),nt=Ne("../heatmap/style"),at=Ne("./make_color_map");Ge.exports=function(Ne){var Ge=tt.select(Ne).selectAll("g.contour");Ge.style("opacity",(function(Ne){return Ne[0].trace.opacity})),Ge.each((function(Ne){var Ge=tt.select(this),Qe=Ne[0].trace,nt=Qe.contours,it=Qe.line,ot=nt.size||1,dt=nt.start,ht="constraint"===nt.type,Dt=!ht&&"lines"===nt.coloring,Ot=!ht&&"fill"===nt.coloring,Rt=Dt||Ot?at(Qe):null;Ge.selectAll("g.contourlevel").each((function(Ne){tt.select(this).selectAll("path").call(rt.lineGroupStyle,it.width,Dt?Rt(Ne.level):it.color,it.dash)}));var Zt=nt.labelfont;if(Ge.selectAll("g.contourlabels text").each((function(Ne){rt.font(tt.select(this),{family:Zt.family,size:Zt.size,color:Zt.color||(Dt?Rt(Ne.level):it.color)})})),ht)Ge.selectAll("g.contourfill path").style("fill",Qe.fillcolor);else if(Ot){var er;Ge.selectAll("g.contourfill path").style("fill",(function(Ne){return void 0===er&&(er=Ne.level),Rt(Ne.level+.5*ot)})),void 0===er&&(er=dt),Ge.selectAll("g.contourbg path").style("fill",Rt(er-.5*ot))}})),nt(Ne)}},{"../../components/drawing":665,"../heatmap/style":1077,"./make_color_map":1024,d3:169}],1029:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/colorscale/defaults"),rt=Ne("./label_defaults");Ge.exports=function(Ne,Ge,Qe,nt,at){var it,ot=Qe("contours.coloring"),dt="";"fill"===ot&&(it=Qe("contours.showlines")),!1!==it&&("lines"!==ot&&(dt=Qe("line.color","#000")),Qe("line.width",.5),Qe("line.dash")),"none"!==ot&&(!0!==Ne.showlegend&&(Ge.showlegend=!1),Ge._dfltShowLegend=!1,tt(Ne,Ge,nt,Qe,{prefix:"",cLetter:"z"})),Qe("line.smoothing"),rt(Qe,nt,dt,at)}},{"../../components/colorscale/defaults":653,"./label_defaults":1023}],1030:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../heatmap/attributes"),rt=Ne("../contour/attributes"),nt=Ne("../../components/colorscale/attributes"),at=Ne("../../lib/extend").extendFlat,it=rt.contours;Ge.exports=at({carpet:{valType:"string",editType:"calc"},z:tt.z,a:tt.x,a0:tt.x0,da:tt.dx,b:tt.y,b0:tt.y0,db:tt.dy,text:tt.text,hovertext:tt.hovertext,transpose:tt.transpose,atype:tt.xtype,btype:tt.ytype,fillcolor:rt.fillcolor,autocontour:rt.autocontour,ncontours:rt.ncontours,contours:{type:it.type,start:it.start,end:it.end,size:it.size,coloring:{valType:"enumerated",values:["fill","lines","none"],dflt:"fill",editType:"calc"},showlines:it.showlines,showlabels:it.showlabels,labelfont:it.labelfont,labelformat:it.labelformat,operation:it.operation,value:it.value,editType:"calc",impliedEdits:{autocontour:!1}},line:{color:rt.line.color,width:rt.line.width,dash:rt.line.dash,smoothing:rt.line.smoothing,editType:"plot"},transforms:void 0},nt("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../contour/attributes":1008,"../heatmap/attributes":1065}],1031:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/colorscale/calc"),rt=Ne("../../lib"),nt=Ne("../heatmap/convert_column_xyz"),at=Ne("../heatmap/clean_2d_array"),it=Ne("../heatmap/interp2d"),ot=Ne("../heatmap/find_empties"),dt=Ne("../heatmap/make_bound_array"),ht=Ne("./defaults"),Dt=Ne("../carpet/lookup_carpetid"),Ot=Ne("../contour/set_contours");function heatmappishCalc(Ne,Ge){var Qe,ht,Dt,Ot,Rt,Zt,er,dr=Ge._carpetTrace,mr=dr.aaxis,xr=dr.baxis;mr._minDtick=0,xr._minDtick=0,rt.isArray1D(Ge.z)&&nt(Ge,mr,xr,"a","b",["z"]),Qe=Ge._a=Ge._a||Ge.a,Ot=Ge._b=Ge._b||Ge.b,Qe=Qe?mr.makeCalcdata(Ge,"_a"):[],Ot=Ot?xr.makeCalcdata(Ge,"_b"):[],ht=Ge.a0||0,Dt=Ge.da||1,Rt=Ge.b0||0,Zt=Ge.db||1,er=Ge._z=at(Ge._z||Ge.z,Ge.transpose),Ge._emptypoints=ot(er),it(er,Ge._emptypoints);var br=rt.maxRowLength(er),Ar="scaled"===Ge.xtype?"":Qe,en=dt(Ge,Ar,ht,Dt,br,mr),mn="scaled"===Ge.ytype?"":Ot,xn={a:en,b:dt(Ge,mn,Rt,Zt,er.length,xr),z:er};return"levels"===Ge.contours.type&&"none"!==Ge.contours.coloring&&tt(Ne,Ge,{vals:er,containerStr:"",cLetter:"z"}),[xn]}Ge.exports=function(Ne,Ge){var Qe=Ge._carpetTrace=Dt(Ne,Ge);if(Qe&&Qe.visible&&"legendonly"!==Qe.visible){if(!Ge.a||!Ge.b){var tt=Ne.data[Qe.index],rt=Ne.data[Ge.index];rt.a||(rt.a=tt.a),rt.b||(rt.b=tt.b),ht(rt,Ge,Ge._defaultColor,Ne._fullLayout)}var nt=heatmappishCalc(Ne,Ge);return Ot(Ge,Ge._z),nt}}},{"../../components/colorscale/calc":651,"../../lib":778,"../carpet/lookup_carpetid":981,"../contour/set_contours":1027,"../heatmap/clean_2d_array":1067,"../heatmap/convert_column_xyz":1069,"../heatmap/find_empties":1071,"../heatmap/interp2d":1074,"../heatmap/make_bound_array":1075,"./defaults":1032}],1032:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../heatmap/xyz_defaults"),nt=Ne("./attributes"),at=Ne("../contour/constraint_defaults"),it=Ne("../contour/contours_defaults"),ot=Ne("../contour/style_defaults");Ge.exports=function(Ne,Ge,Qe,dt){function coerce(Qe,rt){return tt.coerce(Ne,Ge,nt,Qe,rt)}function coerce2(Qe){return tt.coerce2(Ne,Ge,nt,Qe)}if(coerce("carpet"),Ne.a&&Ne.b){if(!rt(Ne,Ge,coerce,dt,"a","b"))return void(Ge.visible=!1);coerce("text"),"constraint"===coerce("contours.type")?at(Ne,Ge,coerce,dt,Qe,{hasHover:!1}):(it(Ne,Ge,coerce,coerce2),ot(Ne,Ge,coerce,dt,{hasHover:!1}))}else Ge._defaultColor=Qe,Ge._length=null}},{"../../lib":778,"../contour/constraint_defaults":1013,"../contour/contours_defaults":1015,"../contour/style_defaults":1029,"../heatmap/xyz_defaults":1079,"./attributes":1030}],1033:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),colorbar:Ne("../contour/colorbar"),calc:Ne("./calc"),plot:Ne("./plot"),style:Ne("../contour/style"),moduleType:"trace",name:"contourcarpet",basePlotModule:Ne("../../plots/cartesian"),categories:["cartesian","svg","carpet","contour","symbols","showLegend","hasLines","carpetDependent","noHover","noSortingByValue"],meta:{}}},{"../../plots/cartesian":841,"../contour/colorbar":1011,"../contour/style":1028,"./attributes":1030,"./calc":1031,"./defaults":1032,"./plot":1034}],1034:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../carpet/map_1d_array"),nt=Ne("../carpet/makepath"),at=Ne("../../components/drawing"),it=Ne("../../lib"),ot=Ne("../contour/make_crossings"),dt=Ne("../contour/find_all_paths"),ht=Ne("../contour/plot"),Dt=Ne("../contour/constants"),Ot=Ne("../contour/convert_to_constraints"),Rt=Ne("../contour/empty_pathinfo"),Zt=Ne("../contour/close_boundaries"),er=Ne("../carpet/lookup_carpetid"),dr=Ne("../carpet/axis_aligned_line");function mapPathinfo(Ne,Ge){var Qe,tt,rt,nt,at,it,ot,dt,ht;for(Qe=0;Qe<Ne.length;Qe++){for(at=(nt=Ne[Qe]).pedgepaths=[],it=nt.ppaths=[],tt=0;tt<nt.edgepaths.length;tt++){for(ht=nt.edgepaths[tt],ot=[],rt=0;rt<ht.length;rt++)ot[rt]=Ge(ht[rt]);at.push(ot)}for(tt=0;tt<nt.paths.length;tt++){for(ht=nt.paths[tt],dt=[],rt=0;rt<ht.length;rt++)dt[rt]=Ge(ht[rt]);it.push(dt)}}}function makeLinesAndLabels(Ne,Ge,Qe,rt,nt,ot,dt){var Ot=it.ensureSingle(Ne,"g","contourlines"),Rt=!1!==nt.showlines,Zt=nt.showlabels,er=Rt&&Zt,dr=ht.createLines(Ot,Rt||Zt,Ge),mr=ht.createLineClip(Ot,er,Qe,rt.trace.uid),xr=Ne.selectAll("g.contourlabels").data(Zt?[0]:[]);if(xr.exit().remove(),xr.enter().append("g").classed("contourlabels",!0),Zt){var br=ot.xaxis,Ar=ot.yaxis,en=br._length,mn=Ar._length,xn=[[[0,0],[en,0],[en,mn],[0,mn]]],kn=[];it.clearLocationCache();var Cn=ht.labelFormatter(Qe,rt),En=at.tester.append("text").attr("data-notex",1).call(at.font,nt.labelfont),Pn={left:0,right:en,center:en/2,top:0,bottom:mn,middle:mn/2},Dn=Math.sqrt(en*en+mn*mn),In=Dt.LABELDISTANCE*Dn/Math.max(1,Ge.length/Dt.LABELINCREASE);dr.each((function(Ne){var Ge=ht.calcTextOpts(Ne.level,Cn,En,Qe);tt.select(this).selectAll("path").each((function(Qe){var tt=this,rt=it.getVisibleSegment(tt,Pn,Ge.height/2);if(rt&&(constrainToCarpet(tt,Qe,Ne,rt,dt,Ge.height),!(rt.len<(Ge.width+Ge.height)*Dt.LABELMIN)))for(var nt=Math.min(Math.ceil(rt.len/In),Dt.LABELMAX),at=0;at<nt;at++){var ot=ht.findBestTextLocation(tt,rt,Ge,kn,Pn);if(!ot)break;ht.addLabelData(ot,Ge,kn,xn)}}))})),En.remove(),ht.drawLabels(xr,kn,Qe,mr,er?xn:null)}Zt&&!Rt&&dr.remove()}function constrainToCarpet(Ne,Ge,Qe,tt,rt,nt){for(var at,it=0;it<Qe.pedgepaths.length;it++)Ge===Qe.pedgepaths[it]&&(at=Qe.edgepaths[it]);if(at){var ot=rt.a[0],dt=rt.a[rt.a.length-1],ht=rt.b[0],Dt=rt.b[rt.b.length-1],Ot=getUnitVector(Ne,0,1),Rt=getUnitVector(Ne,tt.total,tt.total-1),Zt=getOffset(at[0],Ot),er=tt.total-getOffset(at[at.length-1],Rt);tt.min<Zt&&(tt.min=Zt),tt.max>er&&(tt.max=er),tt.len=tt.max-tt.min}function getOffset(Ne,Ge){var Qe,tt=0,at=.1;return(Math.abs(Ne[0]-ot)<at||Math.abs(Ne[0]-dt)<at)&&(Qe=normalizeVector(rt.dxydb_rough(Ne[0],Ne[1],at)),tt=Math.max(tt,nt*vectorTan(Ge,Qe)/2)),(Math.abs(Ne[1]-ht)<at||Math.abs(Ne[1]-Dt)<at)&&(Qe=normalizeVector(rt.dxyda_rough(Ne[0],Ne[1],at)),tt=Math.max(tt,nt*vectorTan(Ge,Qe)/2)),tt}}function getUnitVector(Ne,Ge,Qe){var tt=Ne.getPointAtLength(Ge),rt=Ne.getPointAtLength(Qe),nt=rt.x-tt.x,at=rt.y-tt.y,it=Math.sqrt(nt*nt+at*at);return[nt/it,at/it]}function normalizeVector(Ne){var Ge=Math.sqrt(Ne[0]*Ne[0]+Ne[1]*Ne[1]);return[Ne[0]/Ge,Ne[1]/Ge]}function vectorTan(Ne,Ge){var Qe=Math.abs(Ne[0]*Ge[0]+Ne[1]*Ge[1]);return Math.sqrt(1-Qe*Qe)/Qe}function makeBackground(Ne,Ge,Qe,tt,at,ot){var dt,ht,Dt,Ot,Rt=it.ensureSingle(Ne,"g","contourbg").selectAll("path").data("fill"!==ot||at?[]:[0]);Rt.enter().append("path"),Rt.exit().remove();var Zt=[];for(Ot=0;Ot<Ge.length;Ot++)dt=Ge[Ot],ht=rt([],dt.x,Qe.c2p),Dt=rt([],dt.y,tt.c2p),Zt.push(nt(ht,Dt,dt.bicubic));Rt.attr("d","M"+Zt.join("L")+"Z").style("stroke","none")}function makeFills(Ne,Ge,Qe,rt,nt,at,ot,dt,ht,Dt,Ot){var Rt="fill"===Dt;Rt&&Zt(nt,Ne.contours);var er=it.ensureSingle(Ge,"g","contourfill").selectAll("path").data(Rt?nt:[]);er.enter().append("path"),er.exit().remove(),er.each((function(Ge){var nt=(Ge.prefixBoundary?Ot:"")+joinAllPaths(Ne,Ge,at,ot,dt,ht,Qe,rt);nt?tt.select(this).attr("d",nt).style("stroke","none"):tt.select(this).remove()}))}function joinAllPaths(Ne,Ge,Qe,tt,rt,nt,ot,dt){var ht,Dt,Ot,Rt,Zt,er,mr,xr="",br=Ge.edgepaths.map((function(Ne,Ge){return Ge})),Ar=!0,en=1e-4*Math.abs(Qe[0][0]-Qe[2][0]),mn=1e-4*Math.abs(Qe[0][1]-Qe[2][1]);function istop(Ne){return Math.abs(Ne[1]-Qe[0][1])<mn}function isbottom(Ne){return Math.abs(Ne[1]-Qe[2][1])<mn}function isleft(Ne){return Math.abs(Ne[0]-Qe[0][0])<en}function isright(Ne){return Math.abs(Ne[0]-Qe[2][0])<en}function pathto(Ne,Ge){var Qe,tt,at,it,ht="";for(istop(Ne)&&!isright(Ne)||isbottom(Ne)&&!isleft(Ne)?(it=rt.aaxis,at=dr(rt,nt,[Ne[0],Ge[0]],.5*(Ne[1]+Ge[1]))):(it=rt.baxis,at=dr(rt,nt,.5*(Ne[0]+Ge[0]),[Ne[1],Ge[1]])),Qe=1;Qe<at.length;Qe++)for(ht+=it.smoothing?"C":"L",tt=0;tt<at[Qe].length;tt++){var Dt=at[Qe][tt];ht+=[ot.c2p(Dt[0]),dt.c2p(Dt[1])]+" "}return ht}for(ht=0,Dt=null;br.length;){var xn=Ge.edgepaths[ht][0];for(Dt&&(xr+=pathto(Dt,xn)),mr=at.smoothopen(Ge.edgepaths[ht].map(tt),Ge.smoothing),xr+=Ar?mr:mr.replace(/^M/,"L"),br.splice(br.indexOf(ht),1),Dt=Ge.edgepaths[ht][Ge.edgepaths[ht].length-1],Zt=-1,Rt=0;Rt<4;Rt++){if(!Dt){it.log("Missing end?",ht,Ge);break}for(istop(Dt)&&!isright(Dt)?Ot=Qe[1]:isleft(Dt)?Ot=Qe[0]:isbottom(Dt)?Ot=Qe[3]:isright(Dt)&&(Ot=Qe[2]),er=0;er<Ge.edgepaths.length;er++){var kn=Ge.edgepaths[er][0];Math.abs(Dt[0]-Ot[0])<en?Math.abs(Dt[0]-kn[0])<en&&(kn[1]-Dt[1])*(Ot[1]-kn[1])>=0&&(Ot=kn,Zt=er):Math.abs(Dt[1]-Ot[1])<mn?Math.abs(Dt[1]-kn[1])<mn&&(kn[0]-Dt[0])*(Ot[0]-kn[0])>=0&&(Ot=kn,Zt=er):it.log("endpt to newendpt is not vert. or horz.",Dt,Ot,kn)}if(Zt>=0)break;xr+=pathto(Dt,Ot),Dt=Ot}if(Zt===Ge.edgepaths.length){it.log("unclosed perimeter path");break}ht=Zt,(Ar=-1===br.indexOf(ht))&&(ht=br[0],xr+=pathto(Dt,Ot)+"Z",Dt=null)}for(ht=0;ht<Ge.paths.length;ht++)xr+=at.smoothclosed(Ge.paths[ht].map(tt),Ge.smoothing);return xr}Ge.exports=function(Ne,Ge,Qe,ht){var Dt=Ge.xaxis,Zt=Ge.yaxis;it.makeTraceGroups(ht,Qe,"contour").each((function(Qe){var it=tt.select(this),ht=Qe[0],dr=ht.trace,mr=dr._carpetTrace=er(Ne,dr),xr=Ne.calcdata[mr.index][0];if(mr.visible&&"legendonly"!==mr.visible){var br=ht.a,Ar=ht.b,en=dr.contours,mn=Rt(en,Ge,ht),xn="constraint"===en.type,kn=en._operation,Cn=xn?"="===kn?"lines":"fill":en.coloring,En=[[br[0],Ar[Ar.length-1]],[br[br.length-1],Ar[Ar.length-1]],[br[br.length-1],Ar[0]],[br[0],Ar[0]]];ot(mn);var Pn=1e-8*(br[br.length-1]-br[0]),Dn=1e-8*(Ar[Ar.length-1]-Ar[0]);dt(mn,Pn,Dn);var In,zn,Bn,Vn,Hn=mn;"constraint"===en.type&&(Hn=Ot(mn,kn)),mapPathinfo(mn,ab2p);var qn=[];for(Vn=xr.clipsegments.length-1;Vn>=0;Vn--)In=xr.clipsegments[Vn],zn=rt([],In.x,Dt.c2p),Bn=rt([],In.y,Zt.c2p),zn.reverse(),Bn.reverse(),qn.push(nt(zn,Bn,In.bicubic));var Yn="M"+qn.join("L")+"Z";makeBackground(it,xr.clipsegments,Dt,Zt,xn,Cn),makeFills(dr,it,Dt,Zt,Hn,En,ab2p,mr,xr,Cn,Yn),makeLinesAndLabels(it,mn,Ne,ht,en,Ge,mr),at.setClipUrl(it,mr._clipPathId,Ne)}function ab2p(Ne){var Ge=mr.ab2xy(Ne[0],Ne[1],!0);return[Dt.c2p(Ge[0]),Zt.c2p(Ge[1])]}}))}},{"../../components/drawing":665,"../../lib":778,"../carpet/axis_aligned_line":965,"../carpet/lookup_carpetid":981,"../carpet/makepath":982,"../carpet/map_1d_array":983,"../contour/close_boundaries":1010,"../contour/constants":1012,"../contour/convert_to_constraints":1016,"../contour/empty_pathinfo":1018,"../contour/find_all_paths":1020,"../contour/make_crossings":1025,"../contour/plot":1026,d3:169}],1035:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/colorscale/attributes"),rt=Ne("../../plots/template_attributes").hovertemplateAttrs,nt=Ne("../../plots/attributes"),at=Ne("../scattermapbox/attributes"),it=Ne("../../lib/extend").extendFlat;Ge.exports=it({lon:at.lon,lat:at.lat,z:{valType:"data_array",editType:"calc"},radius:{valType:"number",editType:"plot",arrayOk:!0,min:1,dflt:30},below:{valType:"string",editType:"plot"},text:at.text,hovertext:at.hovertext,hoverinfo:it({},nt.hoverinfo,{flags:["lon","lat","z","text","name"]}),hovertemplate:rt(),showlegend:it({},nt.showlegend,{dflt:!1})},tt("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../scattermapbox/attributes":1252}],1036:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../lib").isArrayOrTypedArray,nt=Ne("../../constants/numerical").BADNUM,at=Ne("../../components/colorscale/calc"),it=Ne("../../lib")._;Ge.exports=function(Ne,Ge){for(var Qe=Ge._length,ot=new Array(Qe),dt=Ge.z,ht=rt(dt)&&dt.length,Dt=0;Dt<Qe;Dt++){var Ot=ot[Dt]={},Rt=Ge.lon[Dt],Zt=Ge.lat[Dt];if(Ot.lonlat=tt(Rt)&&tt(Zt)?[+Rt,+Zt]:[nt,nt],ht){var er=dt[Dt];Ot.z=tt(er)?er:nt}}return at(Ne,Ge,{vals:ht?dt:[0,1],containerStr:"",cLetter:"z"}),Qe&&(ot[0].t={labels:{lat:it(Ne,"lat:")+" ",lon:it(Ne,"lon:")+" "}}),ot}},{"../../components/colorscale/calc":651,"../../constants/numerical":753,"../../lib":778,"fast-isnumeric":241}],1037:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../lib"),nt=Ne("../../components/color"),at=Ne("../../components/colorscale"),it=Ne("../../constants/numerical").BADNUM,ot=Ne("../../lib/geojson_utils").makeBlank;Ge.exports=function(Ne){var Ge=Ne[0].trace,Qe=!0===Ge.visible&&0!==Ge._length,dt={layout:{visibility:"none"},paint:{}},ht=Ge._opts={heatmap:dt,geojson:ot()};if(!Qe)return ht;var Dt,Ot=[],Rt=Ge.z,Zt=Ge.radius,er=rt.isArrayOrTypedArray(Rt)&&Rt.length,dr=rt.isArrayOrTypedArray(Zt);for(Dt=0;Dt<Ne.length;Dt++){var mr=Ne[Dt],xr=mr.lonlat;if(xr[0]!==it){var br={};if(er){var Ar=mr.z;br.z=Ar!==it?Ar:0}dr&&(br.r=tt(Zt[Dt])&&Zt[Dt]>0?+Zt[Dt]:0),Ot.push({type:"Feature",geometry:{type:"Point",coordinates:xr},properties:br})}}var en=at.extractOpts(Ge),mn=en.reversescale?at.flipScale(en.colorscale):en.colorscale,xn=mn[0][1],kn=["interpolate",["linear"],["heatmap-density"],0,nt.opacity(xn)<1?xn:nt.addOpacity(xn,0)];for(Dt=1;Dt<mn.length;Dt++)kn.push(mn[Dt][0],mn[Dt][1]);var Cn=["interpolate",["linear"],["get","z"],en.min,0,en.max,1];return rt.extendFlat(ht.heatmap.paint,{"heatmap-weight":er?Cn:1/(en.max-en.min),"heatmap-color":kn,"heatmap-radius":dr?{type:"identity",property:"r"}:Ge.radius,"heatmap-opacity":Ge.opacity}),ht.geojson={type:"FeatureCollection",features:Ot},ht.heatmap.layout.visibility="visible",ht}},{"../../components/color":643,"../../components/colorscale":655,"../../constants/numerical":753,"../../lib":778,"../../lib/geojson_utils":772,"fast-isnumeric":241}],1038:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../components/colorscale/defaults"),nt=Ne("./attributes");Ge.exports=function(Ne,Ge,Qe,at){function coerce(Qe,rt){return tt.coerce(Ne,Ge,nt,Qe,rt)}var it=coerce("lon")||[],ot=coerce("lat")||[],dt=Math.min(it.length,ot.length);dt?(Ge._length=dt,coerce("z"),coerce("radius"),coerce("below"),coerce("text"),coerce("hovertext"),coerce("hovertemplate"),rt(Ne,Ge,at,coerce,{prefix:"",cLetter:"z"})):Ge.visible=!1}},{"../../components/colorscale/defaults":653,"../../lib":778,"./attributes":1035}],1039:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge){return Ne.lon=Ge.lon,Ne.lat=Ge.lat,Ne.z=Ge.z,Ne}},{}],1040:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../plots/cartesian/axes"),nt=Ne("../scattermapbox/hover");function getExtraText(Ne,Ge,Qe){if(!Ne.hovertemplate){var rt=(Ge.hi||Ne.hoverinfo).split("+"),nt=-1!==rt.indexOf("all"),at=-1!==rt.indexOf("lon"),it=-1!==rt.indexOf("lat"),ot=Ge.lonlat,dt=[];return nt||at&&it?dt.push("("+format(ot[0])+", "+format(ot[1])+")"):at?dt.push(Qe.lon+format(ot[0])):it&&dt.push(Qe.lat+format(ot[1])),(nt||-1!==rt.indexOf("text"))&&tt.fillText(Ge,Ne,dt),dt.join("<br>")}function format(Ne){return Ne+"Â°"}}Ge.exports=function(Ne,Ge,Qe){var tt=nt(Ne,Ge,Qe);if(tt){var at=tt[0],it=at.cd,ot=it[0].trace,dt=it[at.index];if(delete at.color,"z"in dt){var ht=at.subplot.mockAxis;at.z=dt.z,at.zLabel=rt.tickText(ht,ht.c2l(dt.z),"hover").text}return at.extraText=getExtraText(ot,dt,it[0].t.labels),[at]}}},{"../../lib":778,"../../plots/cartesian/axes":828,"../scattermapbox/hover":1257}],1041:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),colorbar:Ne("../heatmap/colorbar"),formatLabels:Ne("../scattermapbox/format_labels"),calc:Ne("./calc"),plot:Ne("./plot"),hoverPoints:Ne("./hover"),eventData:Ne("./event_data"),getBelow:function(Ne,Ge){for(var Qe=Ge.getMapLayers(),tt=0;tt<Qe.length;tt++){var rt=Qe[tt],nt=rt.id;if("symbol"===rt.type&&"string"==typeof nt&&-1===nt.indexOf("plotly-"))return nt}},moduleType:"trace",name:"densitymapbox",basePlotModule:Ne("../../plots/mapbox"),categories:["mapbox","gl","showLegend"],meta:{hr_name:"density_mapbox"}}},{"../../plots/mapbox":885,"../heatmap/colorbar":1068,"../scattermapbox/format_labels":1256,"./attributes":1035,"./calc":1036,"./defaults":1038,"./event_data":1039,"./hover":1040,"./plot":1042}],1042:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./convert"),rt=Ne("../../plots/mapbox/constants").traceLayerPrefix;function DensityMapbox(Ne,Ge){this.type="densitymapbox",this.subplot=Ne,this.uid=Ge,this.sourceId="source-"+Ge,this.layerList=[["heatmap",rt+Ge+"-heatmap"]],this.below=null}var nt=DensityMapbox.prototype;nt.update=function(Ne){var Ge=this.subplot,Qe=this.layerList,rt=tt(Ne),nt=Ge.belowLookup["trace-"+this.uid];Ge.map.getSource(this.sourceId).setData(rt.geojson),nt!==this.below&&(this._removeLayers(),this._addLayers(rt,nt),this.below=nt);for(var at=0;at<Qe.length;at++){var it=Qe[at],ot=it[0],dt=it[1],ht=rt[ot];Ge.setOptions(dt,"setLayoutProperty",ht.layout),"visible"===ht.layout.visibility&&Ge.setOptions(dt,"setPaintProperty",ht.paint)}},nt._addLayers=function(Ne,Ge){for(var Qe=this.subplot,tt=this.layerList,rt=this.sourceId,nt=0;nt<tt.length;nt++){var at=tt[nt],it=at[0],ot=Ne[it];Qe.addLayer({type:it,id:at[1],source:rt,layout:ot.layout,paint:ot.paint},Ge)}},nt._removeLayers=function(){for(var Ne=this.subplot.map,Ge=this.layerList,Qe=Ge.length-1;Qe>=0;Qe--)Ne.removeLayer(Ge[Qe][1])},nt.dispose=function(){var Ne=this.subplot.map;this._removeLayers(),Ne.removeSource(this.sourceId)},Ge.exports=function(Ne,Ge){var Qe=Ge[0].trace,rt=new DensityMapbox(Ne,Qe.uid),nt=rt.sourceId,at=tt(Ge),it=rt.below=Ne.belowLookup["trace-"+Qe.uid];return Ne.map.addSource(nt,{type:"geojson",data:at.geojson}),rt._addLayers(at,it),rt}},{"../../plots/mapbox/constants":883,"./convert":1037}],1043:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib");Ge.exports=function(Ne,Ge){for(var Qe=0;Qe<Ne.length;Qe++)Ne[Qe].i=Qe;tt.mergeArray(Ge.text,Ne,"tx"),tt.mergeArray(Ge.hovertext,Ne,"htx");var rt=Ge.marker;if(rt){tt.mergeArray(rt.opacity,Ne,"mo"),tt.mergeArray(rt.color,Ne,"mc");var nt=rt.line;nt&&(tt.mergeArray(nt.color,Ne,"mlc"),tt.mergeArrayCastPositive(nt.width,Ne,"mlw"))}}},{"../../lib":778}],1044:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../bar/attributes"),rt=Ne("../scatter/attributes").line,nt=Ne("../../plots/attributes"),at=Ne("../../plots/template_attributes").hovertemplateAttrs,it=Ne("../../plots/template_attributes").texttemplateAttrs,ot=Ne("./constants"),dt=Ne("../../lib/extend").extendFlat,ht=Ne("../../components/color");Ge.exports={x:tt.x,x0:tt.x0,dx:tt.dx,y:tt.y,y0:tt.y0,dy:tt.dy,xperiod:tt.xperiod,yperiod:tt.yperiod,xperiod0:tt.xperiod0,yperiod0:tt.yperiod0,xperiodalignment:tt.xperiodalignment,yperiodalignment:tt.yperiodalignment,hovertext:tt.hovertext,hovertemplate:at({},{keys:ot.eventDataKeys}),hoverinfo:dt({},nt.hoverinfo,{flags:["name","x","y","text","percent initial","percent previous","percent total"]}),textinfo:{valType:"flaglist",flags:["label","text","percent initial","percent previous","percent total","value"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:it({editType:"plot"},{keys:ot.eventDataKeys.concat(["label","value"])}),text:tt.text,textposition:dt({},tt.textposition,{dflt:"auto"}),insidetextanchor:dt({},tt.insidetextanchor,{dflt:"middle"}),textangle:dt({},tt.textangle,{dflt:0}),textfont:tt.textfont,insidetextfont:tt.insidetextfont,outsidetextfont:tt.outsidetextfont,constraintext:tt.constraintext,cliponaxis:tt.cliponaxis,orientation:dt({},tt.orientation,{}),offset:dt({},tt.offset,{arrayOk:!1}),width:dt({},tt.width,{arrayOk:!1}),marker:tt.marker,connector:{fillcolor:{valType:"color",editType:"style"},line:{color:dt({},rt.color,{dflt:ht.defaultLine}),width:dt({},rt.width,{dflt:0,editType:"plot"}),dash:rt.dash,editType:"style"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:tt.offsetgroup,alignmentgroup:tt.alignmentgroup}},{"../../components/color":643,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../bar/attributes":921,"../scatter/attributes":1187,"./constants":1046}],1045:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/cartesian/axes"),rt=Ne("../../plots/cartesian/align_period"),nt=Ne("./arrays_to_calcdata"),at=Ne("../scatter/calc_selection"),it=Ne("../../constants/numerical").BADNUM;function fixNum(Ne){return Ne===it?0:Ne}Ge.exports=function(Ne,Ge){var Qe,ot,dt,ht,Dt,Ot,Rt=tt.getFromId(Ne,Ge.xaxis||"x"),Zt=tt.getFromId(Ne,Ge.yaxis||"y");"h"===Ge.orientation?(Qe=Rt.makeCalcdata(Ge,"x"),dt=Zt.makeCalcdata(Ge,"y"),ot=rt(Ge,Zt,"y",dt),Ot=!!Ge.yperiodalignment):(Qe=Zt.makeCalcdata(Ge,"y"),dt=Rt.makeCalcdata(Ge,"x"),ot=rt(Ge,Rt,"x",dt),Ot=!!Ge.xperiodalignment);var er,dr=Math.min(ot.length,Qe.length),mr=new Array(dr);for(Ge._base=[],ht=0;ht<dr;ht++){Qe[ht]<0&&(Qe[ht]=it);var xr=!1;Qe[ht]!==it&&ht+1<dr&&Qe[ht+1]!==it&&(xr=!0),Dt=mr[ht]={p:ot[ht],s:Qe[ht],cNext:xr},Ge._base[ht]=-.5*Dt.s,Ot&&(mr[ht].orig_p=dt[ht]),Ge.ids&&(Dt.id=String(Ge.ids[ht])),0===ht&&(mr[0].vTotal=0),mr[0].vTotal+=fixNum(Dt.s),Dt.begR=fixNum(Dt.s)/fixNum(mr[0].s)}for(ht=0;ht<dr;ht++)(Dt=mr[ht]).s!==it&&(Dt.sumR=Dt.s/mr[0].vTotal,Dt.difR=void 0!==er?Dt.s/er:1,er=Dt.s);return nt(mr,Ge),at(mr,Ge),mr}},{"../../constants/numerical":753,"../../plots/cartesian/align_period":825,"../../plots/cartesian/axes":828,"../scatter/calc_selection":1189,"./arrays_to_calcdata":1043}],1046:[function(Ne,Ge,Qe){"use strict";Ge.exports={eventDataKeys:["percentInitial","percentPrevious","percentTotal"]}},{}],1047:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../bar/cross_trace_calc").setGroupPositions;Ge.exports=function(Ne,Ge){var Qe,rt,nt=Ne._fullLayout,at=Ne._fullData,it=Ne.calcdata,ot=Ge.xaxis,dt=Ge.yaxis,ht=[],Dt=[],Ot=[];for(rt=0;rt<at.length;rt++){var Rt=at[rt],Zt="h"===Rt.orientation;!0===Rt.visible&&Rt.xaxis===ot._id&&Rt.yaxis===dt._id&&"funnel"===Rt.type&&(Qe=it[rt],Zt?Ot.push(Qe):Dt.push(Qe),ht.push(Qe))}var er={mode:nt.funnelmode,norm:nt.funnelnorm,gap:nt.funnelgap,groupgap:nt.funnelgroupgap};for(tt(Ne,ot,dt,Dt,er),tt(Ne,dt,ot,Ot,er),rt=0;rt<ht.length;rt++){Qe=ht[rt];for(var dr=0;dr<Qe.length;dr++)dr+1<Qe.length&&(Qe[dr].nextP0=Qe[dr+1].p0,Qe[dr].nextS0=Qe[dr+1].s0,Qe[dr].nextP1=Qe[dr+1].p1,Qe[dr].nextS1=Qe[dr+1].s1)}}},{"../bar/cross_trace_calc":924}],1048:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../bar/defaults").handleGroupingDefaults,nt=Ne("../bar/defaults").handleText,at=Ne("../scatter/xy_defaults"),it=Ne("../scatter/period_defaults"),ot=Ne("./attributes"),dt=Ne("../../components/color");function supplyDefaults(Ne,Ge,Qe,rt){function coerce(Qe,rt){return tt.coerce(Ne,Ge,ot,Qe,rt)}if(at(Ne,Ge,rt,coerce)){it(Ne,Ge,rt,coerce),coerce("orientation",Ge.y&&!Ge.x?"v":"h"),coerce("offset"),coerce("width");var ht=coerce("text");coerce("hovertext"),coerce("hovertemplate");var Dt=coerce("textposition");nt(Ne,Ge,rt,coerce,Dt,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),"none"===Ge.textposition||Ge.texttemplate||coerce("textinfo",Array.isArray(ht)?"text+value":"value");var Ot=coerce("marker.color",Qe);coerce("marker.line.color",dt.defaultLine),coerce("marker.line.width"),coerce("connector.visible")&&(coerce("connector.fillcolor",defaultFillColor(Ot)),coerce("connector.line.width")&&(coerce("connector.line.color"),coerce("connector.line.dash")))}else Ge.visible=!1}function defaultFillColor(Ne){var Ge=tt.isArrayOrTypedArray(Ne)?"#000":Ne;return dt.addOpacity(Ge,.5*dt.opacity(Ge))}function crossTraceDefaults(Ne,Ge){var Qe,nt;function coerce(Ne){return tt.coerce(nt._input,nt,ot,Ne)}if("group"===Ge.funnelmode)for(var at=0;at<Ne.length;at++)Qe=(nt=Ne[at])._input,rt(Qe,nt,Ge,coerce)}Ge.exports={supplyDefaults:supplyDefaults,crossTraceDefaults:crossTraceDefaults}},{"../../components/color":643,"../../lib":778,"../bar/defaults":925,"../scatter/period_defaults":1207,"../scatter/xy_defaults":1214,"./attributes":1044}],1049:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge){return Ne.x="xVal"in Ge?Ge.xVal:Ge.x,Ne.y="yVal"in Ge?Ge.yVal:Ge.y,"percentInitial"in Ge&&(Ne.percentInitial=Ge.percentInitial),"percentPrevious"in Ge&&(Ne.percentPrevious=Ge.percentPrevious),"percentTotal"in Ge&&(Ne.percentTotal=Ge.percentTotal),Ge.xa&&(Ne.xaxis=Ge.xa),Ge.ya&&(Ne.yaxis=Ge.ya),Ne}},{}],1050:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/color").opacity,rt=Ne("../bar/hover").hoverOnBars,nt=Ne("../../lib").formatPercent;function getTraceColor(Ne,Ge){var Qe=Ne.marker,rt=Ge.mc||Qe.color,nt=Ge.mlc||Qe.line.color,at=Ge.mlw||Qe.line.width;return tt(rt)?rt:tt(nt)&&at?nt:void 0}Ge.exports=function(Ne,Ge,Qe,tt){var at=rt(Ne,Ge,Qe,tt);if(at){var it=at.cd,ot=it[0].trace,dt="h"===ot.orientation,ht=it[at.index];at[(dt?"x":"y")+"LabelVal"]=ht.s,at.percentInitial=ht.begR,at.percentInitialLabel=nt(ht.begR,1),at.percentPrevious=ht.difR,at.percentPreviousLabel=nt(ht.difR,1),at.percentTotal=ht.sumR,at.percentTotalLabel=nt(ht.sumR,1);var Dt=ht.hi||ot.hoverinfo,Ot=[];if(Dt&&"none"!==Dt&&"skip"!==Dt){var Rt="all"===Dt,Zt=Dt.split("+"),hasFlag=function(Ne){return Rt||-1!==Zt.indexOf(Ne)};hasFlag("percent initial")&&Ot.push(at.percentInitialLabel+" of initial"),hasFlag("percent previous")&&Ot.push(at.percentPreviousLabel+" of previous"),hasFlag("percent total")&&Ot.push(at.percentTotalLabel+" of total")}return at.extraText=Ot.join("<br>"),at.color=getTraceColor(ot,ht),[at]}}},{"../../components/color":643,"../../lib":778,"../bar/hover":928}],1051:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),layoutAttributes:Ne("./layout_attributes"),supplyDefaults:Ne("./defaults").supplyDefaults,crossTraceDefaults:Ne("./defaults").crossTraceDefaults,supplyLayoutDefaults:Ne("./layout_defaults"),calc:Ne("./calc"),crossTraceCalc:Ne("./cross_trace_calc"),plot:Ne("./plot"),style:Ne("./style").style,hoverPoints:Ne("./hover"),eventData:Ne("./event_data"),selectPoints:Ne("../bar/select"),moduleType:"trace",name:"funnel",basePlotModule:Ne("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":841,"../bar/select":933,"./attributes":1044,"./calc":1045,"./cross_trace_calc":1047,"./defaults":1048,"./event_data":1049,"./hover":1050,"./layout_attributes":1052,"./layout_defaults":1053,"./plot":1054,"./style":1055}],1052:[function(Ne,Ge,Qe){"use strict";Ge.exports={funnelmode:{valType:"enumerated",values:["stack","group","overlay"],dflt:"stack",editType:"calc"},funnelgap:{valType:"number",min:0,max:1,editType:"calc"},funnelgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1053:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./layout_attributes");Ge.exports=function(Ne,Ge,Qe){var nt=!1;function coerce(Qe,nt){return tt.coerce(Ne,Ge,rt,Qe,nt)}for(var at=0;at<Qe.length;at++){var it=Qe[at];if(it.visible&&"funnel"===it.type){nt=!0;break}}nt&&(coerce("funnelmode"),coerce("funnelgap",.2),coerce("funnelgroupgap"))}},{"../../lib":778,"./layout_attributes":1052}],1054:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../lib"),nt=Ne("../../components/drawing"),at=Ne("../../constants/numerical").BADNUM,it=Ne("../bar/plot"),ot=Ne("../bar/uniform_text").clearMinTextSize;function plotConnectorRegions(Ne,Ge,Qe,it){var ot=Ge.xaxis,dt=Ge.yaxis;rt.makeTraceGroups(it,Qe,"trace bars").each((function(Qe){var it=tt.select(this),ht=Qe[0].trace,Dt=rt.ensureSingle(it,"g","regions");if(ht.connector&&ht.connector.visible){var Ot="h"===ht.orientation,Rt=Dt.selectAll("g.region").data(rt.identity);Rt.enter().append("g").classed("region",!0),Rt.exit().remove();var Zt=Rt.size();Rt.each((function(Qe,it){if(it===Zt-1||Qe.cNext){var ht=getXY(Qe,ot,dt,Ot),Dt=ht[0],Rt=ht[1],er="";Dt[0]!==at&&Rt[0]!==at&&Dt[1]!==at&&Rt[1]!==at&&Dt[2]!==at&&Rt[2]!==at&&Dt[3]!==at&&Rt[3]!==at&&(er+=Ot?"M"+Dt[0]+","+Rt[1]+"L"+Dt[2]+","+Rt[2]+"H"+Dt[3]+"L"+Dt[1]+","+Rt[1]+"Z":"M"+Dt[1]+","+Rt[1]+"L"+Dt[2]+","+Rt[3]+"V"+Rt[2]+"L"+Dt[1]+","+Rt[0]+"Z"),""===er&&(er="M0,0Z"),rt.ensureSingle(tt.select(this),"path").attr("d",er).call(nt.setClipUrl,Ge.layerClipId,Ne)}}))}else Dt.remove()}))}function plotConnectorLines(Ne,Ge,Qe,at){var it=Ge.xaxis,ot=Ge.yaxis;rt.makeTraceGroups(at,Qe,"trace bars").each((function(Qe){var at=tt.select(this),dt=Qe[0].trace,ht=rt.ensureSingle(at,"g","lines");if(dt.connector&&dt.connector.visible&&dt.connector.line.width){var Dt="h"===dt.orientation,Ot=ht.selectAll("g.line").data(rt.identity);Ot.enter().append("g").classed("line",!0),Ot.exit().remove();var Rt=Ot.size();Ot.each((function(Qe,at){if(at===Rt-1||Qe.cNext){var dt=getXY(Qe,it,ot,Dt),ht=dt[0],Ot=dt[1],Zt="";void 0!==ht[3]&&void 0!==Ot[3]&&(Dt?(Zt+="M"+ht[0]+","+Ot[1]+"L"+ht[2]+","+Ot[2],Zt+="M"+ht[1]+","+Ot[1]+"L"+ht[3]+","+Ot[2]):(Zt+="M"+ht[1]+","+Ot[1]+"L"+ht[2]+","+Ot[3],Zt+="M"+ht[1]+","+Ot[0]+"L"+ht[2]+","+Ot[2])),""===Zt&&(Zt="M0,0Z"),rt.ensureSingle(tt.select(this),"path").attr("d",Zt).call(nt.setClipUrl,Ge.layerClipId,Ne)}}))}else ht.remove()}))}function getXY(Ne,Ge,Qe,tt){var rt=[],nt=[],at=tt?Ge:Qe,it=tt?Qe:Ge;return rt[0]=at.c2p(Ne.s0,!0),nt[0]=it.c2p(Ne.p0,!0),rt[1]=at.c2p(Ne.s1,!0),nt[1]=it.c2p(Ne.p1,!0),rt[2]=at.c2p(Ne.nextS0,!0),nt[2]=it.c2p(Ne.nextP0,!0),rt[3]=at.c2p(Ne.nextS1,!0),nt[3]=it.c2p(Ne.nextP1,!0),tt?[rt,nt]:[nt,rt]}Ge.exports=function(Ne,Ge,Qe,tt){var rt=Ne._fullLayout;ot("funnel",rt),plotConnectorRegions(Ne,Ge,Qe,tt),plotConnectorLines(Ne,Ge,Qe,tt),it.plot(Ne,Ge,Qe,tt,{mode:rt.funnelmode,norm:rt.funnelmode,gap:rt.funnelgap,groupgap:rt.funnelgroupgap})}},{"../../components/drawing":665,"../../constants/numerical":753,"../../lib":778,"../bar/plot":932,"../bar/uniform_text":937,d3:169}],1055:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../components/drawing"),nt=Ne("../../components/color"),at=Ne("../../constants/interactions").DESELECTDIM,it=Ne("../bar/style"),ot=Ne("../bar/uniform_text").resizeText,dt=it.styleTextPoints;function style(Ne,Ge,Qe){var it=Qe||tt.select(Ne).selectAll("g.funnellayer").selectAll("g.trace");ot(Ne,it,"funnel"),it.style("opacity",(function(Ne){return Ne[0].trace.opacity})),it.each((function(Ge){var Qe=tt.select(this),it=Ge[0].trace;Qe.selectAll(".point > path").each((function(Ne){if(!Ne.isBlank){var Ge=it.marker;tt.select(this).call(nt.fill,Ne.mc||Ge.color).call(nt.stroke,Ne.mlc||Ge.line.color).call(rt.dashLine,Ge.line.dash,Ne.mlw||Ge.line.width).style("opacity",it.selectedpoints&&!Ne.selected?at:1)}})),dt(Qe,it,Ne),Qe.selectAll(".regions").each((function(){tt.select(this).selectAll("path").style("stroke-width",0).call(nt.fill,it.connector.fillcolor)})),Qe.selectAll(".lines").each((function(){var Ne=it.connector.line;rt.lineGroupStyle(tt.select(this).selectAll("path"),Ne.width,Ne.color,Ne.dash)}))}))}Ge.exports={style:style}},{"../../components/color":643,"../../components/drawing":665,"../../constants/interactions":752,"../bar/style":935,"../bar/uniform_text":937,d3:169}],1056:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../pie/attributes"),rt=Ne("../../plots/attributes"),nt=Ne("../../plots/domain").attributes,at=Ne("../../plots/template_attributes").hovertemplateAttrs,it=Ne("../../plots/template_attributes").texttemplateAttrs,ot=Ne("../../lib/extend").extendFlat;Ge.exports={labels:tt.labels,label0:tt.label0,dlabel:tt.dlabel,values:tt.values,marker:{colors:tt.marker.colors,line:{color:ot({},tt.marker.line.color,{dflt:null}),width:ot({},tt.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},text:tt.text,hovertext:tt.hovertext,scalegroup:ot({},tt.scalegroup,{}),textinfo:ot({},tt.textinfo,{flags:["label","text","value","percent"]}),texttemplate:it({editType:"plot"},{keys:["label","color","value","text","percent"]}),hoverinfo:ot({},rt.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:at({},{keys:["label","color","value","text","percent"]}),textposition:ot({},tt.textposition,{values:["inside","none"],dflt:"inside"}),textfont:tt.textfont,insidetextfont:tt.insidetextfont,title:{text:tt.title.text,font:tt.title.font,position:ot({},tt.title.position,{values:["top left","top center","top right"],dflt:"top center"}),editType:"plot"},domain:nt({name:"funnelarea",trace:!0,editType:"calc"}),aspectratio:{valType:"number",min:0,dflt:1,editType:"plot"},baseratio:{valType:"number",min:0,max:1,dflt:.333,editType:"plot"}}},{"../../lib/extend":768,"../../plots/attributes":824,"../../plots/domain":855,"../../plots/template_attributes":906,"../pie/attributes":1161}],1057:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/plots");Qe.name="funnelarea",Qe.plot=function(Ne,Ge,rt,nt){tt.plotBasePlot(Qe.name,Ne,Ge,rt,nt)},Qe.clean=function(Ne,Ge,rt,nt){tt.cleanBasePlot(Qe.name,Ne,Ge,rt,nt)}},{"../../plots/plots":891}],1058:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../pie/calc");function calc(Ne,Ge){return tt.calc(Ne,Ge)}function crossTraceCalc(Ne){tt.crossTraceCalc(Ne,{type:"funnelarea"})}Ge.exports={calc:calc,crossTraceCalc:crossTraceCalc}},{"../pie/calc":1163}],1059:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./attributes"),nt=Ne("../../plots/domain").defaults,at=Ne("../bar/defaults").handleText,it=Ne("../pie/defaults").handleLabelsAndValues;Ge.exports=function(Ne,Ge,Qe,ot){function coerce(Qe,nt){return tt.coerce(Ne,Ge,rt,Qe,nt)}var dt=coerce("labels"),ht=coerce("values"),Dt=it(dt,ht),Ot=Dt.len;if(Ge._hasLabels=Dt.hasLabels,Ge._hasValues=Dt.hasValues,!Ge._hasLabels&&Ge._hasValues&&(coerce("label0"),coerce("dlabel")),Ot){Ge._length=Ot,coerce("marker.line.width")&&coerce("marker.line.color",ot.paper_bgcolor),coerce("marker.colors"),coerce("scalegroup");var Rt,Zt=coerce("text"),er=coerce("texttemplate");if(er||(Rt=coerce("textinfo",Array.isArray(Zt)?"text+percent":"percent")),coerce("hovertext"),coerce("hovertemplate"),er||Rt&&"none"!==Rt){var dr=coerce("textposition");at(Ne,Ge,ot,coerce,dr,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1})}nt(Ge,ot,coerce),coerce("title.text")&&(coerce("title.position"),tt.coerceFont(coerce,"title.font",ot.font)),coerce("aspectratio"),coerce("baseratio")}else Ge.visible=!1}},{"../../lib":778,"../../plots/domain":855,"../bar/defaults":925,"../pie/defaults":1164,"./attributes":1056}],1060:[function(Ne,Ge,Qe){"use strict";Ge.exports={moduleType:"trace",name:"funnelarea",basePlotModule:Ne("./base_plot"),categories:["pie-like","funnelarea","showLegend"],attributes:Ne("./attributes"),layoutAttributes:Ne("./layout_attributes"),supplyDefaults:Ne("./defaults"),supplyLayoutDefaults:Ne("./layout_defaults"),calc:Ne("./calc").calc,crossTraceCalc:Ne("./calc").crossTraceCalc,plot:Ne("./plot"),style:Ne("./style"),styleOne:Ne("../pie/style_one"),meta:{}}},{"../pie/style_one":1172,"./attributes":1056,"./base_plot":1057,"./calc":1058,"./defaults":1059,"./layout_attributes":1061,"./layout_defaults":1062,"./plot":1063,"./style":1064}],1061:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../pie/layout_attributes").hiddenlabels;Ge.exports={hiddenlabels:tt,funnelareacolorway:{valType:"colorlist",editType:"calc"},extendfunnelareacolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{"../pie/layout_attributes":1168}],1062:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./layout_attributes");Ge.exports=function(Ne,Ge){function coerce(Qe,nt){return tt.coerce(Ne,Ge,rt,Qe,nt)}coerce("hiddenlabels"),coerce("funnelareacolorway",Ge.colorway),coerce("extendfunnelareacolors")}},{"../../lib":778,"./layout_attributes":1061}],1063:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../components/drawing"),nt=Ne("../../lib"),at=nt.strScale,it=nt.strTranslate,ot=Ne("../../lib/svg_text_utils"),dt=Ne("../bar/plot").toMoveInsideBar,ht=Ne("../bar/uniform_text"),Dt=ht.recordMinTextSize,Ot=ht.clearMinTextSize,Rt=Ne("../pie/helpers"),Zt=Ne("../pie/plot"),er=Zt.attachFxHandlers,dr=Zt.determineInsideTextFont,mr=Zt.layoutAreas,xr=Zt.prerenderTitles,br=Zt.positionTitleOutside,Ar=Zt.formatSliceLabel;function line(Ne,Ge){return"l"+(Ge[0]-Ne[0])+","+(Ge[1]-Ne[1])}function getBetween(Ne,Ge){return[.5*(Ne[0]+Ge[0]),.5*(Ne[1]+Ge[1])]}function setCoords(Ne){if(Ne.length){var Ge=Ne[0],Qe=Ge.trace,tt=Qe.aspectratio,rt=Qe.baseratio;rt>.999&&(rt=.999);var nt,at,it,ot=Math.pow(rt,2),dt=Ge.vTotal,ht=dt,Dt=dt*ot/(1-ot)/dt,Ot=[];for(Ot.push(getPoint()),at=Ne.length-1;at>-1;at--)if(!(it=Ne[at]).hidden){var Rt=it.v/ht;Dt+=Rt,Ot.push(getPoint())}var Zt=1/0,er=-1/0;for(at=0;at<Ot.length;at++)nt=Ot[at],Zt=Math.min(Zt,nt[1]),er=Math.max(er,nt[1]);for(at=0;at<Ot.length;at++)Ot[at][1]-=(er+Zt)/2;var dr=Ot[Ot.length-1][0],mr=Ge.r,xr=(er-Zt)/2,br=mr/dr,Ar=mr/xr*tt;for(Ge.r=Ar*xr,at=0;at<Ot.length;at++)Ot[at][0]*=br,Ot[at][1]*=Ar;var en=[-(nt=Ot[0])[0],nt[1]],mn=[nt[0],nt[1]],xn=0;for(at=Ne.length-1;at>-1;at--)if(!(it=Ne[at]).hidden){var kn=Ot[xn+=1][0],Cn=Ot[xn][1];it.TL=[-kn,Cn],it.TR=[kn,Cn],it.BL=en,it.BR=mn,it.pxmid=getBetween(it.TR,it.BR),en=it.TL,mn=it.TR}}function calcPos(){var Ne=Math.sqrt(Dt);return{x:Ne,y:-Ne}}function getPoint(){var Ne=calcPos();return[Ne.x,Ne.y]}}Ge.exports=function(Ne,Ge){var Qe=Ne._fullLayout;Ot("funnelarea",Qe),xr(Ge,Ne),mr(Ge,Qe._size),nt.makeTraceGroups(Qe._funnelarealayer,Ge,"trace").each((function(Ge){var ht=tt.select(this),Ot=Ge[0],Zt=Ot.trace;setCoords(Ge),ht.each((function(){var ht=tt.select(this).selectAll("g.slice").data(Ge);ht.enter().append("g").classed("slice",!0),ht.exit().remove(),ht.each((function(at,it){if(at.hidden)tt.select(this).selectAll("path,g").remove();else{at.pointNumber=at.i,at.curveNumber=Zt.index;var ht=Ot.cx,mr=Ot.cy,xr=tt.select(this),br=xr.selectAll("path.surface").data([at]);br.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),xr.call(er,Ne,Ge);var en="M"+(ht+at.TR[0])+","+(mr+at.TR[1])+line(at.TR,at.BR)+line(at.BR,at.BL)+line(at.BL,at.TL)+"Z";br.attr("d",en),Ar(Ne,at,Ot);var mn=Rt.castOption(Zt.textposition,at.pts),xn=xr.selectAll("g.slicetext").data(at.text&&"none"!==mn?[0]:[]);xn.enter().append("g").classed("slicetext",!0),xn.exit().remove(),xn.each((function(){var Ot=nt.ensureSingle(tt.select(this),"text","",(function(Ne){Ne.attr("data-notex",1)})),Rt=nt.ensureUniformFontSize(Ne,dr(Zt,at,Qe.font));Ot.text(at.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(rt.font,Rt).call(ot.convertToTspans,Ne);var er,xr,br,Ar=rt.bBox(Ot.node()),en=Math.min(at.BL[1],at.BR[1])+mr,mn=Math.max(at.TL[1],at.TR[1])+mr;xr=Math.max(at.TL[0],at.BL[0])+ht,br=Math.min(at.TR[0],at.BR[0])+ht,(er=dt(xr,br,en,mn,Ar,{isHorizontal:!0,constrained:!0,angle:0,anchor:"middle"})).fontSize=Rt.size,Dt(Zt.type,er,Qe),Ge[it].transform=er,Ot.attr("transform",nt.getTextTransform(er))}))}}));var mr=tt.select(this).selectAll("g.titletext").data(Zt.title.text?[0]:[]);mr.enter().append("g").classed("titletext",!0),mr.exit().remove(),mr.each((function(){var Ge=nt.ensureSingle(tt.select(this),"text","",(function(Ne){Ne.attr("data-notex",1)})),dt=Zt.title.text;Zt._meta&&(dt=nt.templateString(dt,Zt._meta)),Ge.text(dt).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(rt.font,Zt.title.font).call(ot.convertToTspans,Ne);var ht=br(Ot,Qe._size);Ge.attr("transform",it(ht.x,ht.y)+at(Math.min(1,ht.scale))+it(ht.tx,ht.ty))}))}))}))}},{"../../components/drawing":665,"../../lib":778,"../../lib/svg_text_utils":803,"../bar/plot":932,"../bar/uniform_text":937,"../pie/helpers":1166,"../pie/plot":1170,d3:169}],1064:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../pie/style_one"),nt=Ne("../bar/uniform_text").resizeText;Ge.exports=function(Ne){var Ge=Ne._fullLayout._funnelarealayer.selectAll(".trace");nt(Ne,Ge,"funnelarea"),Ge.each((function(Ne){var Ge=Ne[0].trace,Qe=tt.select(this);Qe.style({opacity:Ge.opacity}),Qe.selectAll("path.surface").each((function(Ne){tt.select(this).call(rt,Ne,Ge)}))}))}},{"../bar/uniform_text":937,"../pie/style_one":1172,d3:169}],1065:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../scatter/attributes"),rt=Ne("../../plots/attributes"),nt=Ne("../../plots/template_attributes").hovertemplateAttrs,at=Ne("../../components/colorscale/attributes"),it=(Ne("../../constants/docs").FORMAT_LINK,Ne("../../lib/extend").extendFlat);Ge.exports=it({z:{valType:"data_array",editType:"calc"},x:it({},tt.x,{impliedEdits:{xtype:"array"}}),x0:it({},tt.x0,{impliedEdits:{xtype:"scaled"}}),dx:it({},tt.dx,{impliedEdits:{xtype:"scaled"}}),y:it({},tt.y,{impliedEdits:{ytype:"array"}}),y0:it({},tt.y0,{impliedEdits:{ytype:"scaled"}}),dy:it({},tt.dy,{impliedEdits:{ytype:"scaled"}}),xperiod:it({},tt.xperiod,{impliedEdits:{xtype:"scaled"}}),yperiod:it({},tt.yperiod,{impliedEdits:{ytype:"scaled"}}),xperiod0:it({},tt.xperiod0,{impliedEdits:{xtype:"scaled"}}),yperiod0:it({},tt.yperiod0,{impliedEdits:{ytype:"scaled"}}),xperiodalignment:it({},tt.xperiodalignment,{impliedEdits:{xtype:"scaled"}}),yperiodalignment:it({},tt.yperiodalignment,{impliedEdits:{ytype:"scaled"}}),text:{valType:"data_array",editType:"calc"},hovertext:{valType:"data_array",editType:"calc"},transpose:{valType:"boolean",dflt:!1,editType:"calc"},xtype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},ytype:{valType:"enumerated",values:["array","scaled"],editType:"calc+clearAxisTypes"},zsmooth:{valType:"enumerated",values:["fast","best",!1],dflt:!1,editType:"calc"},hoverongaps:{valType:"boolean",dflt:!0,editType:"none"},connectgaps:{valType:"boolean",editType:"calc"},xgap:{valType:"number",dflt:0,min:0,editType:"plot"},ygap:{valType:"number",dflt:0,min:0,editType:"plot"},zhoverformat:{valType:"string",dflt:"",editType:"none"},hovertemplate:nt(),showlegend:it({},rt.showlegend,{dflt:!1})},{transforms:void 0},at("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":650,"../../constants/docs":748,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../scatter/attributes":1187}],1066:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../registry"),rt=Ne("../../lib"),nt=Ne("../../plots/cartesian/axes"),at=Ne("../../plots/cartesian/align_period"),it=Ne("../histogram2d/calc"),ot=Ne("../../components/colorscale/calc"),dt=Ne("./convert_column_xyz"),ht=Ne("./clean_2d_array"),Dt=Ne("./interp2d"),Ot=Ne("./find_empties"),Rt=Ne("./make_bound_array"),Zt=Ne("../../constants/numerical").BADNUM;function skipBreaks(Ne){for(var Ge=[],Qe=Ne.length,tt=0;tt<Qe;tt++){var rt=Ne[tt];rt!==Zt&&Ge.push(rt)}return Ge}function dropZonBreaks(Ne,Ge,Qe){for(var tt=[],rt=-1,nt=0;nt<Qe.length;nt++)if(Ge[nt]!==Zt){tt[++rt]=[];for(var at=0;at<Qe[nt].length;at++)Ne[at]!==Zt&&tt[rt].push(Qe[nt][at])}return tt}Ge.exports=function(Ne,Ge){var Qe,Zt,er,dr,mr,xr,br,Ar,en,mn,xn,kn=nt.getFromId(Ne,Ge.xaxis||"x"),Cn=nt.getFromId(Ne,Ge.yaxis||"y"),En=tt.traceIs(Ge,"contour"),Pn=tt.traceIs(Ge,"histogram"),Dn=tt.traceIs(Ge,"gl2d"),In=En?"best":Ge.zsmooth;if(kn._minDtick=0,Cn._minDtick=0,Pn)dr=(xn=it(Ne,Ge)).orig_x,Qe=xn.x,Zt=xn.x0,er=xn.dx,Ar=xn.orig_y,mr=xn.y,xr=xn.y0,br=xn.dy,en=xn.z;else{var zn=Ge.z;rt.isArray1D(zn)?(dt(Ge,kn,Cn,"x","y",["z"]),Qe=Ge._x,mr=Ge._y,zn=Ge._z):(dr=Ge.x?kn.makeCalcdata(Ge,"x"):[],Ar=Ge.y?Cn.makeCalcdata(Ge,"y"):[],Qe=at(Ge,kn,"x",dr),mr=at(Ge,Cn,"y",Ar),Ge._x=Qe,Ge._y=mr),Zt=Ge.x0,er=Ge.dx,xr=Ge.y0,br=Ge.dy,en=ht(zn,Ge,kn,Cn)}function noZsmooth(Ne){In=Ge._input.zsmooth=Ge.zsmooth=!1,rt.warn('cannot use zsmooth: "fast": '+Ne)}if((kn.rangebreaks||Cn.rangebreaks)&&(en=dropZonBreaks(Qe,mr,en),Pn||(Qe=skipBreaks(Qe),mr=skipBreaks(mr),Ge._x=Qe,Ge._y=mr)),Pn||!En&&!Ge.connectgaps||(Ge._emptypoints=Ot(en),Dt(en,Ge._emptypoints)),"fast"===In)if("log"===kn.type||"log"===Cn.type)noZsmooth("log axis found");else if(!Pn){if(Qe.length){var Bn=(Qe[Qe.length-1]-Qe[0])/(Qe.length-1),Vn=Math.abs(Bn/100);for(mn=0;mn<Qe.length-1;mn++)if(Math.abs(Qe[mn+1]-Qe[mn]-Bn)>Vn){noZsmooth("x scale is not linear");break}}if(mr.length&&"fast"===In){var Hn=(mr[mr.length-1]-mr[0])/(mr.length-1),qn=Math.abs(Hn/100);for(mn=0;mn<mr.length-1;mn++)if(Math.abs(mr[mn+1]-mr[mn]-Hn)>qn){noZsmooth("y scale is not linear");break}}}var Yn=rt.maxRowLength(en),$n="scaled"===Ge.xtype?"":Qe,ra=Rt(Ge,$n,Zt,er,Yn,kn),oa="scaled"===Ge.ytype?"":mr,pa=Rt(Ge,oa,xr,br,en.length,Cn);Dn||(Ge._extremes[kn._id]=nt.findExtremes(kn,ra),Ge._extremes[Cn._id]=nt.findExtremes(Cn,pa));var ga={x:ra,y:pa,z:en,text:Ge._text||Ge.text,hovertext:Ge._hovertext||Ge.hovertext};if(Ge.xperiodalignment&&dr&&(ga.orig_x=dr),Ge.yperiodalignment&&Ar&&(ga.orig_y=Ar),$n&&$n.length===ra.length-1&&(ga.xCenter=$n),oa&&oa.length===pa.length-1&&(ga.yCenter=oa),Pn&&(ga.xRanges=xn.xRanges,ga.yRanges=xn.yRanges,ga.pts=xn.pts),En||ot(Ne,Ge,{vals:en,cLetter:"z"}),En&&Ge.contours&&"heatmap"===Ge.contours.coloring){var ma={type:"contour"===Ge.type?"heatmap":"histogram2d",xcalendar:Ge.xcalendar,ycalendar:Ge.ycalendar};ga.xfill=Rt(ma,$n,Zt,er,Yn,kn),ga.yfill=Rt(ma,oa,xr,br,en.length,Cn)}return[ga]}},{"../../components/colorscale/calc":651,"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/align_period":825,"../../plots/cartesian/axes":828,"../../registry":911,"../histogram2d/calc":1098,"./clean_2d_array":1067,"./convert_column_xyz":1069,"./find_empties":1071,"./interp2d":1074,"./make_bound_array":1075}],1067:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../lib"),nt=Ne("../../constants/numerical").BADNUM;Ge.exports=function(Ne,Ge,Qe,at){var it,ot,dt,ht,Dt,Ot;function cleanZvalue(Ne){if(tt(Ne))return+Ne}if(Ge&&Ge.transpose){for(it=0,Dt=0;Dt<Ne.length;Dt++)it=Math.max(it,Ne[Dt].length);if(0===it)return!1;dt=function(Ne){return Ne.length},ht=function(Ne,Ge,Qe){return(Ne[Qe]||[])[Ge]}}else it=Ne.length,dt=function(Ne,Ge){return Ne[Ge].length},ht=function(Ne,Ge,Qe){return(Ne[Ge]||[])[Qe]};var padOld2new=function(Ne,Ge,Qe){return Ge===nt||Qe===nt?nt:ht(Ne,Ge,Qe)};function axisMapping(Ne){if(Ge&&"carpet"!==Ge.type&&"contourcarpet"!==Ge.type&&Ne&&"category"===Ne.type&&Ge["_"+Ne._id.charAt(0)].length){var Qe=Ne._id.charAt(0),tt={},at=Ge["_"+Qe+"CategoryMap"]||Ge[Qe];for(Dt=0;Dt<at.length;Dt++)tt[at[Dt]]=Dt;return function(Ge){var Qe=tt[Ne._categories[Ge]];return Qe+1?Qe:nt}}return rt.identity}var Rt=axisMapping(Qe),Zt=axisMapping(at);at&&"category"===at.type&&(it=at._categories.length);var er=new Array(it);for(Dt=0;Dt<it;Dt++)for(ot=Qe&&"category"===Qe.type?Qe._categories.length:dt(Ne,Dt),er[Dt]=new Array(ot),Ot=0;Ot<ot;Ot++)er[Dt][Ot]=cleanZvalue(padOld2new(Ne,Zt(Dt),Rt(Ot)));return er}},{"../../constants/numerical":753,"../../lib":778,"fast-isnumeric":241}],1068:[function(Ne,Ge,Qe){"use strict";Ge.exports={min:"zmin",max:"zmax"}},{}],1069:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../constants/numerical").BADNUM,nt=Ne("../../plots/cartesian/align_period");Ge.exports=function(Ne,Ge,Qe,at,it,ot){var dt=Ne._length,ht=Ge.makeCalcdata(Ne,at),Dt=Qe.makeCalcdata(Ne,it);ht=nt(Ne,Ge,at,ht),Dt=nt(Ne,Qe,it,Dt);var Ot,Rt,Zt,er,dr=Ne.text,mr=void 0!==dr&&tt.isArray1D(dr),xr=Ne.hovertext,br=void 0!==xr&&tt.isArray1D(xr),Ar=tt.distinctVals(ht),en=Ar.vals,mn=tt.distinctVals(Dt),xn=mn.vals,kn=[],Cn=xn.length,En=en.length;for(Ot=0;Ot<ot.length;Ot++)kn[Ot]=tt.init2dArray(Cn,En);mr&&(Zt=tt.init2dArray(Cn,En)),br&&(er=tt.init2dArray(Cn,En));var Pn=tt.init2dArray(Cn,En);for(Ot=0;Ot<dt;Ot++)if(ht[Ot]!==rt&&Dt[Ot]!==rt){var Dn=tt.findBin(ht[Ot]+Ar.minDiff/2,en),In=tt.findBin(Dt[Ot]+mn.minDiff/2,xn);for(Rt=0;Rt<ot.length;Rt++){var zn=Ne[ot[Rt]];kn[Rt][In][Dn]=zn[Ot],Pn[In][Dn]=Ot}mr&&(Zt[In][Dn]=dr[Ot]),br&&(er[In][Dn]=xr[Ot])}for(Ne["_"+at]=en,Ne["_"+it]=xn,Rt=0;Rt<ot.length;Rt++)Ne["_"+ot[Rt]]=kn[Rt];mr&&(Ne._text=Zt),br&&(Ne._hovertext=er),Ge&&"category"===Ge.type&&(Ne["_"+at+"CategoryMap"]=en.map((function(Ne){return Ge._categories[Ne]}))),Qe&&"category"===Qe.type&&(Ne["_"+it+"CategoryMap"]=xn.map((function(Ne){return Qe._categories[Ne]}))),Ne._after2before=Pn}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/align_period":825}],1070:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./xyz_defaults"),nt=Ne("../scatter/period_defaults"),at=Ne("./style_defaults"),it=Ne("../../components/colorscale/defaults"),ot=Ne("./attributes");Ge.exports=function(Ne,Ge,Qe,dt){function coerce(Qe,rt){return tt.coerce(Ne,Ge,ot,Qe,rt)}rt(Ne,Ge,coerce,dt)?(nt(Ne,Ge,dt,coerce),coerce("text"),coerce("hovertext"),coerce("hovertemplate"),at(Ne,Ge,coerce,dt),coerce("hoverongaps"),coerce("connectgaps",tt.isArray1D(Ge.z)&&!1!==Ge.zsmooth),it(Ne,Ge,dt,coerce,{prefix:"",cLetter:"z"})):Ge.visible=!1}},{"../../components/colorscale/defaults":653,"../../lib":778,"../scatter/period_defaults":1207,"./attributes":1065,"./style_defaults":1078,"./xyz_defaults":1079}],1071:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib").maxRowLength;Ge.exports=function(Ne){var Ge,Qe,rt,nt,at,it,ot,dt,ht=[],Dt={},Ot=[],Rt=Ne[0],Zt=[],er=[0,0,0],dr=tt(Ne);for(Qe=0;Qe<Ne.length;Qe++)for(Ge=Zt,Zt=Rt,Rt=Ne[Qe+1]||[],rt=0;rt<dr;rt++)void 0===Zt[rt]&&((it=(void 0!==Zt[rt-1]?1:0)+(void 0!==Zt[rt+1]?1:0)+(void 0!==Ge[rt]?1:0)+(void 0!==Rt[rt]?1:0))?(0===Qe&&it++,0===rt&&it++,Qe===Ne.length-1&&it++,rt===Zt.length-1&&it++,it<4&&(Dt[[Qe,rt]]=[Qe,rt,it]),ht.push([Qe,rt,it])):Ot.push([Qe,rt]));for(;Ot.length;){for(ot={},dt=!1,at=Ot.length-1;at>=0;at--)(it=((Dt[[(Qe=(nt=Ot[at])[0])-1,rt=nt[1]]]||er)[2]+(Dt[[Qe+1,rt]]||er)[2]+(Dt[[Qe,rt-1]]||er)[2]+(Dt[[Qe,rt+1]]||er)[2])/20)&&(ot[nt]=[Qe,rt,it],Ot.splice(at,1),dt=!0);if(!dt)throw"findEmpties iterated with no new neighbors";for(nt in ot)Dt[nt]=ot[nt],ht.push(ot[nt])}return ht.sort((function(Ne,Ge){return Ge[2]-Ne[2]}))}},{"../../lib":778}],1072:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/fx"),rt=Ne("../../lib"),nt=Ne("../../plots/cartesian/axes"),at=Ne("../../components/colorscale").extractOpts;Ge.exports=function(Ne,Ge,Qe,it,ot,dt){var ht,Dt,Ot,Rt,Zt=Ne.cd[0],er=Zt.trace,dr=Ne.xa,mr=Ne.ya,xr=Zt.x,br=Zt.y,Ar=Zt.z,en=Zt.xCenter,mn=Zt.yCenter,xn=Zt.zmask,kn=er.zhoverformat,Cn=xr,En=br;if(!1!==Ne.index){try{Ot=Math.round(Ne.index[1]),Rt=Math.round(Ne.index[0])}catch(Ge){return void rt.error("Error hovering on heatmap, pointNumber must be [row,col], found:",Ne.index)}if(Ot<0||Ot>=Ar[0].length||Rt<0||Rt>Ar.length)return}else{if(tt.inbox(Ge-xr[0],Ge-xr[xr.length-1],0)>0||tt.inbox(Qe-br[0],Qe-br[br.length-1],0)>0)return;if(dt){var Pn;for(Cn=[2*xr[0]-xr[1]],Pn=1;Pn<xr.length;Pn++)Cn.push((xr[Pn]+xr[Pn-1])/2);for(Cn.push([2*xr[xr.length-1]-xr[xr.length-2]]),En=[2*br[0]-br[1]],Pn=1;Pn<br.length;Pn++)En.push((br[Pn]+br[Pn-1])/2);En.push([2*br[br.length-1]-br[br.length-2]])}Ot=Math.max(0,Math.min(Cn.length-2,rt.findBin(Ge,Cn))),Rt=Math.max(0,Math.min(En.length-2,rt.findBin(Qe,En)))}var Dn,In,zn=dr.c2p(xr[Ot]),Bn=dr.c2p(xr[Ot+1]),Vn=mr.c2p(br[Rt]),Hn=mr.c2p(br[Rt+1]);dt?(Dn=Zt.orig_x||xr,In=Zt.orig_y||br,Bn=zn,ht=Dn[Ot],Hn=Vn,Dt=In[Rt]):(Dn=Zt.orig_x||en||xr,In=Zt.orig_y||mn||br,ht=en?Dn[Ot]:(Dn[Ot]+Dn[Ot+1])/2,Dt=mn?In[Rt]:(In[Rt]+In[Rt+1])/2,dr&&"category"===dr.type&&(ht=xr[Ot]),mr&&"category"===mr.type&&(Dt=br[Rt]),er.zsmooth&&(zn=Bn=dr.c2p(ht),Vn=Hn=mr.c2p(Dt)));var qn=Ar[Rt][Ot];if(xn&&!xn[Rt][Ot]&&(qn=void 0),void 0!==qn||er.hoverongaps){var Yn;Array.isArray(Zt.hovertext)&&Array.isArray(Zt.hovertext[Rt])?Yn=Zt.hovertext[Rt][Ot]:Array.isArray(Zt.text)&&Array.isArray(Zt.text[Rt])&&(Yn=Zt.text[Rt][Ot]);var $n=at(er),ra={type:"linear",range:[$n.min,$n.max],hoverformat:kn,_separators:dr._separators,_numFormat:dr._numFormat},oa=nt.tickText(ra,qn,"hover").text;return[rt.extendFlat(Ne,{index:er._after2before?er._after2before[Rt][Ot]:[Rt,Ot],distance:Ne.maxHoverDistance,spikeDistance:Ne.maxSpikeDistance,x0:zn,x1:Bn,y0:Vn,y1:Hn,xLabelVal:ht,yLabelVal:Dt,zLabelVal:qn,zLabel:oa,text:Yn})]}}},{"../../components/colorscale":655,"../../components/fx":683,"../../lib":778,"../../plots/cartesian/axes":828}],1073:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),calc:Ne("./calc"),plot:Ne("./plot"),colorbar:Ne("./colorbar"),style:Ne("./style"),hoverPoints:Ne("./hover"),moduleType:"trace",name:"heatmap",basePlotModule:Ne("../../plots/cartesian"),categories:["cartesian","svg","2dMap","showLegend"],meta:{}}},{"../../plots/cartesian":841,"./attributes":1065,"./calc":1066,"./colorbar":1068,"./defaults":1070,"./hover":1072,"./plot":1076,"./style":1077}],1074:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=.01,nt=[[-1,0],[1,0],[0,-1],[0,1]];function correctionOvershoot(Ne){return.5-.25*Math.min(1,.5*Ne)}function iterateInterp2d(Ne,Ge,Qe){var tt,rt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt,er,dr,mr=0;for(it=0;it<Ge.length;it++){for(rt=(tt=Ge[it])[0],at=tt[1],Zt=Ne[rt][at],Rt=0,Ot=0,ot=0;ot<4;ot++)(ht=Ne[rt+(dt=nt[ot])[0]])&&void 0!==(Dt=ht[at+dt[1]])&&(0===Rt?er=dr=Dt:(er=Math.min(er,Dt),dr=Math.max(dr,Dt)),Ot++,Rt+=Dt);if(0===Ot)throw"iterateInterp2d order is wrong: no defined neighbors";Ne[rt][at]=Rt/Ot,void 0===Zt?Ot<4&&(mr=1):(Ne[rt][at]=(1+Qe)*Ne[rt][at]-Qe*Zt,dr>er&&(mr=Math.max(mr,Math.abs(Ne[rt][at]-Zt)/(dr-er))))}return mr}Ge.exports=function(Ne,Ge){var Qe,nt=1;for(iterateInterp2d(Ne,Ge),Qe=0;Qe<Ge.length&&!(Ge[Qe][2]<4);Qe++);for(Ge=Ge.slice(Qe),Qe=0;Qe<100&&nt>rt;Qe++)nt=iterateInterp2d(Ne,Ge,correctionOvershoot(nt));return nt>rt&&tt.log("interp2d didn't converge quickly",nt),Ne}},{"../../lib":778}],1075:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../registry"),rt=Ne("../../lib").isArrayOrTypedArray;Ge.exports=function(Ne,Ge,Qe,nt,at,it){var ot,dt,ht,Dt=[],Ot=tt.traceIs(Ne,"contour"),Rt=tt.traceIs(Ne,"histogram"),Zt=tt.traceIs(Ne,"gl2d");if(rt(Ge)&&Ge.length>1&&!Rt&&"category"!==it.type){var er=Ge.length;if(!(er<=at))return Ot?Ge.slice(0,at):Ge.slice(0,at+1);if(Ot||Zt)Dt=Ge.slice(0,at);else if(1===at)Dt=[Ge[0]-.5,Ge[0]+.5];else{for(Dt=[1.5*Ge[0]-.5*Ge[1]],ht=1;ht<er;ht++)Dt.push(.5*(Ge[ht-1]+Ge[ht]));Dt.push(1.5*Ge[er-1]-.5*Ge[er-2])}if(er<at){var dr=Dt[Dt.length-1],mr=dr-Dt[Dt.length-2];for(ht=er;ht<at;ht++)dr+=mr,Dt.push(dr)}}else{var xr=Ne[it._id.charAt(0)+"calendar"];for(ot=Rt?it.r2c(Qe,0,xr):rt(Ge)&&1===Ge.length?Ge[0]:void 0===Qe?0:("log"===it.type?it.d2c:it.r2c)(Qe,0,xr),dt=nt||1,ht=Ot||Zt?0:-.5;ht<at;ht++)Dt.push(ot+dt*ht)}return Dt}},{"../../lib":778,"../../registry":911}],1076:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("tinycolor2"),nt=Ne("../../registry"),at=Ne("../../lib"),it=Ne("../../components/colorscale").makeColorScaleFuncFromTrace,ot=Ne("../../constants/xmlns_namespaces");function findInterp(Ne,Ge){var Qe=Ge.length-2,tt=at.constrain(at.findBin(Ne,Ge),0,Qe),rt=Ge[tt],nt=Ge[tt+1],it=at.constrain(tt+(Ne-rt)/(nt-rt)-.5,0,Qe),ot=Math.round(it),dt=Math.abs(it-ot);return it&&it!==Qe&&dt?{bin0:ot,frac:dt,bin1:Math.round(ot+dt/(it-ot))}:{bin0:ot,bin1:ot,frac:0}}function findInterpFromCenters(Ne,Ge){var Qe=Ge.length-1,tt=at.constrain(at.findBin(Ne,Ge),0,Qe),rt=Ge[tt],nt=(Ne-rt)/(Ge[tt+1]-rt)||0;return nt<=0?{bin0:tt,bin1:tt,frac:0}:nt<.5?{bin0:tt,bin1:tt+1,frac:nt}:{bin0:tt+1,bin1:tt,frac:1-nt}}function putColor(Ne,Ge,Qe){Ne[Ge]=Qe[0],Ne[Ge+1]=Qe[1],Ne[Ge+2]=Qe[2],Ne[Ge+3]=Math.round(255*Qe[3])}Ge.exports=function(Ne,Ge,Qe,dt){var ht=Ge.xaxis,Dt=Ge.yaxis;at.makeTraceGroups(dt,Qe,"hm").each((function(Ge){var Qe,dt,Ot,Rt,Zt,er,dr=tt.select(this),mr=Ge[0],xr=mr.trace,br=mr.z,Ar=mr.x,en=mr.y,mn=mr.xCenter,xn=mr.yCenter,kn=nt.traceIs(xr,"contour"),Cn=kn?"best":xr.zsmooth,En=br.length,Pn=at.maxRowLength(br),Dn=!1,In=!1;for(er=0;void 0===Qe&&er<Ar.length-1;)Qe=ht.c2p(Ar[er]),er++;for(er=Ar.length-1;void 0===dt&&er>0;)dt=ht.c2p(Ar[er]),er--;for(dt<Qe&&(Ot=dt,dt=Qe,Qe=Ot,Dn=!0),er=0;void 0===Rt&&er<en.length-1;)Rt=Dt.c2p(en[er]),er++;for(er=en.length-1;void 0===Zt&&er>0;)Zt=Dt.c2p(en[er]),er--;if(Zt<Rt&&(Ot=Rt,Rt=Zt,Zt=Ot,In=!0),kn&&(mn=Ar,xn=en,Ar=mr.xfill,en=mr.yfill),"fast"!==Cn){var zn="best"===Cn?0:.5;Qe=Math.max(-zn*ht._length,Qe),dt=Math.min((1+zn)*ht._length,dt),Rt=Math.max(-zn*Dt._length,Rt),Zt=Math.min((1+zn)*Dt._length,Zt)}var Bn=Math.round(dt-Qe),Vn=Math.round(Zt-Rt);if(Bn<=0||Vn<=0)dr.selectAll("image").data([]).exit().remove();else{var Hn,qn;"fast"===Cn?(Hn=Pn,qn=En):(Hn=Bn,qn=Vn);var Yn=document.createElement("canvas");Yn.width=Hn,Yn.height=qn;var $n,ra,oa=Yn.getContext("2d"),pa=it(xr,{noNumericCheck:!0,returnArray:!0});"fast"===Cn?($n=Dn?function(Ne){return Pn-1-Ne}:at.identity,ra=In?function(Ne){return En-1-Ne}:at.identity):($n=function(Ne){return at.constrain(Math.round(ht.c2p(Ar[Ne])-Qe),0,Bn)},ra=function(Ne){return at.constrain(Math.round(Dt.c2p(en[Ne])-Rt),0,Vn)});var ga,ma,_a,Va,Wa,Qa=ra(0),ti=[Qa,Qa],ni=Dn?0:1,di=In?0:1,ji=0,Hi=0,Yi=0,uo=0;if(Cn){var go,ns=0;try{go=new Uint8Array(Bn*Vn*4)}catch(Ne){go=new Array(Bn*Vn*4)}if("best"===Cn){var as,is,os,ss=mn||Ar,cs=xn||en,ds=new Array(ss.length),ms=new Array(cs.length),vs=new Array(Bn),_s=mn?findInterpFromCenters:findInterp,ws=xn?findInterpFromCenters:findInterp;for(er=0;er<ss.length;er++)ds[er]=Math.round(ht.c2p(ss[er])-Qe);for(er=0;er<cs.length;er++)ms[er]=Math.round(Dt.c2p(cs[er])-Rt);for(er=0;er<Bn;er++)vs[er]=_s(er,ds);for(ma=0;ma<Vn;ma++)for(is=br[(as=ws(ma,ms)).bin0],os=br[as.bin1],er=0;er<Bn;er++,ns+=4)putColor(go,ns,Wa=interpColor(is,os,vs[er],as))}else for(ma=0;ma<En;ma++)for(Va=br[ma],ti=ra(ma),er=0;er<Bn;er++)Wa=setColor(Va[er],1),putColor(go,ns=4*(ti*Bn+$n(er)),Wa);var Ts=oa.createImageData(Bn,Vn);try{Ts.data.set(go)}catch(Ne){var ks=Ts.data,Cs=ks.length;for(ma=0;ma<Cs;ma++)ks[ma]=go[ma]}oa.putImageData(Ts,0,0)}else{var Es=xr.xgap,Ls=xr.ygap,Ps=Math.floor(Es/2),Ds=Math.floor(Ls/2);for(ma=0;ma<En;ma++)if(Va=br[ma],ti.reverse(),ti[di]=ra(ma+1),ti[0]!==ti[1]&&void 0!==ti[0]&&void 0!==ti[1])for(ga=[_a=$n(0),_a],er=0;er<Pn;er++)ga.reverse(),ga[ni]=$n(er+1),ga[0]!==ga[1]&&void 0!==ga[0]&&void 0!==ga[1]&&(Wa=setColor(Va[er],(ga[1]-ga[0])*(ti[1]-ti[0])),oa.fillStyle="rgba("+Wa.join(",")+")",oa.fillRect(ga[0]+Ps,ti[0]+Ds,ga[1]-ga[0]-Es,ti[1]-ti[0]-Ls))}Hi=Math.round(Hi/ji),Yi=Math.round(Yi/ji),uo=Math.round(uo/ji);var Is=rt("rgb("+Hi+","+Yi+","+uo+")");Ne._hmpixcount=(Ne._hmpixcount||0)+ji,Ne._hmlumcount=(Ne._hmlumcount||0)+ji*Is.getLuminance();var Os=dr.selectAll("image").data(Ge);Os.enter().append("svg:image").attr({xmlns:ot.svg,preserveAspectRatio:"none"}),Os.attr({height:Vn,width:Bn,x:Qe,y:Rt,"xlink:href":Yn.toDataURL("image/png")})}function setColor(Ne,Ge){if(void 0!==Ne){var Qe=pa(Ne);return Qe[0]=Math.round(Qe[0]),Qe[1]=Math.round(Qe[1]),Qe[2]=Math.round(Qe[2]),ji+=Ge,Hi+=Qe[0]*Ge,Yi+=Qe[1]*Ge,uo+=Qe[2]*Ge,Qe}return[0,0,0,0]}function interpColor(Ne,Ge,Qe,tt){var rt=Ne[Qe.bin0];if(void 0===rt)return setColor(void 0,1);var nt,at=Ne[Qe.bin1],it=Ge[Qe.bin0],ot=Ge[Qe.bin1],dt=at-rt||0,ht=it-rt||0;return nt=void 0===at?void 0===ot?0:void 0===it?2*(ot-rt):2*(2*ot-it-rt)/3:void 0===ot?void 0===it?0:2*(2*rt-at-it)/3:void 0===it?2*(2*ot-at-rt)/3:ot+rt-at-it,setColor(rt+Qe.frac*dt+tt.frac*(ht+Qe.frac*nt))}}))}},{"../../components/colorscale":655,"../../constants/xmlns_namespaces":754,"../../lib":778,"../../registry":911,d3:169,tinycolor2:576}],1077:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3");Ge.exports=function(Ne){tt.select(Ne).selectAll(".hm image").style("opacity",(function(Ne){return Ne.trace.opacity}))}},{d3:169}],1078:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge,Qe){!1===Qe("zsmooth")&&(Qe("xgap"),Qe("ygap")),Qe("zhoverformat")}},{}],1079:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../lib"),nt=Ne("../../registry");function coordDefaults(Ne,Ge){var Qe=Ge(Ne);return"scaled"===(Qe?Ge(Ne+"type","array"):"scaled")&&(Ge(Ne+"0"),Ge("d"+Ne)),Qe}function isValidZ(Ne){for(var Ge,Qe=!0,nt=!1,at=!1,it=0;it<Ne.length;it++){if(Ge=Ne[it],!rt.isArrayOrTypedArray(Ge)){Qe=!1;break}Ge.length>0&&(nt=!0);for(var ot=0;ot<Ge.length;ot++)if(tt(Ge[ot])){at=!0;break}}return Qe&&nt&&at}Ge.exports=function(Ne,Ge,Qe,tt,at,it){var ot,dt,ht=Qe("z");if(at=at||"x",it=it||"y",void 0===ht||!ht.length)return 0;if(rt.isArray1D(Ne.z)){ot=Qe(at),dt=Qe(it);var Dt=rt.minRowLength(ot),Ot=rt.minRowLength(dt);if(0===Dt||0===Ot)return 0;Ge._length=Math.min(Dt,Ot,ht.length)}else{if(ot=coordDefaults(at,Qe),dt=coordDefaults(it,Qe),!isValidZ(ht))return 0;Qe("transpose"),Ge._length=null}return"heatmapgl"===Ne.type||"contourgl"===Ne.type||nt.getComponentMethod("calendars","handleTraceDefaults")(Ne,Ge,[at,it],tt),!0}},{"../../lib":778,"../../registry":911,"fast-isnumeric":241}],1080:[function(Ne,Ge,Qe){"use strict";for(var tt=Ne("../heatmap/attributes"),rt=Ne("../../components/colorscale/attributes"),nt=Ne("../../lib/extend").extendFlat,at=Ne("../../plot_api/edit_types").overrideAll,it=["z","x","x0","dx","y","y0","dy","text","transpose","xtype","ytype"],ot={},dt=0;dt<it.length;dt++){var ht=it[dt];ot[ht]=tt[ht]}ot.zsmooth={valType:"enumerated",values:["fast",!1],dflt:"fast",editType:"calc"},nt(ot,rt("",{cLetter:"z",autoColorDflt:!1})),Ge.exports=at(ot,"calc","nested")},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plot_api/edit_types":810,"../heatmap/attributes":1065}],1081:[function(Ne,Ge,Qe){"use strict";var tt=Ne("gl-heatmap2d"),rt=Ne("../../plots/cartesian/axes"),nt=Ne("../../lib/str2rgbarray");function Heatmap(Ne,Ge){this.scene=Ne,this.uid=Ge,this.type="heatmapgl",this.name="",this.hoverinfo="all",this.xData=[],this.yData=[],this.zData=[],this.textLabels=[],this.idToIndex=[],this.bounds=[0,0,0,0],this.options={zsmooth:"fast",z:[],x:[],y:[],shape:[0,0],colorLevels:[0],colorValues:[0,0,0,1]},this.heatmap=tt(Ne.glplot,this.options),this.heatmap._trace=this}var at=Heatmap.prototype;function convertColorscale(Ne){for(var Ge=Ne.colorscale,Qe=Ne.zmin,tt=Ne.zmax,rt=Ge.length,at=new Array(rt),it=new Array(4*rt),ot=0;ot<rt;ot++){var dt=Ge[ot],ht=nt(dt[1]);at[ot]=Qe+dt[0]*(tt-Qe);for(var Dt=0;Dt<4;Dt++)it[4*ot+Dt]=ht[Dt]}return{colorLevels:at,colorValues:it}}function createHeatmap(Ne,Ge,Qe){var tt=new Heatmap(Ne,Ge.uid);return tt.update(Ge,Qe),tt}at.handlePick=function(Ne){var Ge=this.options,Qe=Ge.shape,tt=Ne.pointId,rt=tt%Qe[0],nt=Math.floor(tt/Qe[0]),at=tt;return{trace:this,dataCoord:Ne.dataCoord,traceCoord:[Ge.x[rt],Ge.y[nt],Ge.z[at]],textLabel:this.textLabels[tt],name:this.name,pointIndex:[nt,rt],hoverinfo:this.hoverinfo}},at.update=function(Ne,Ge){var Qe=Ge[0];this.index=Ne.index,this.name=Ne.name,this.hoverinfo=Ne.hoverinfo;var tt=Qe.z;this.options.z=[].concat.apply([],tt);var nt=tt[0].length,at=tt.length;this.options.shape=[nt,at],this.options.x=Qe.x,this.options.y=Qe.y,this.options.zsmooth=Ne.zsmooth;var it=convertColorscale(Ne);this.options.colorLevels=it.colorLevels,this.options.colorValues=it.colorValues,this.textLabels=[].concat.apply([],Ne.text),this.heatmap.update(this.options);var ot,dt,ht=this.scene.xaxis,Dt=this.scene.yaxis;!1===Ne.zsmooth&&(ot={ppad:Qe.x[1]-Qe.x[0]},dt={ppad:Qe.y[1]-Qe.y[0]}),Ne._extremes[ht._id]=rt.findExtremes(ht,Qe.x,ot),Ne._extremes[Dt._id]=rt.findExtremes(Dt,Qe.y,dt)},at.dispose=function(){this.heatmap.dispose()},Ge.exports=createHeatmap},{"../../lib/str2rgbarray":802,"../../plots/cartesian/axes":828,"gl-heatmap2d":271}],1082:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../heatmap/xyz_defaults"),nt=Ne("../../components/colorscale/defaults"),at=Ne("./attributes");Ge.exports=function(Ne,Ge,Qe,it){function coerce(Qe,rt){return tt.coerce(Ne,Ge,at,Qe,rt)}rt(Ne,Ge,coerce,it)?(coerce("text"),coerce("zsmooth"),nt(Ne,Ge,it,coerce,{prefix:"",cLetter:"z"})):Ge.visible=!1}},{"../../components/colorscale/defaults":653,"../../lib":778,"../heatmap/xyz_defaults":1079,"./attributes":1080}],1083:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),colorbar:Ne("../heatmap/colorbar"),calc:Ne("../heatmap/calc"),plot:Ne("./convert"),moduleType:"trace",name:"heatmapgl",basePlotModule:Ne("../../plots/gl2d"),categories:["gl","gl2d","2dMap"],meta:{}}},{"../../plots/gl2d":868,"../heatmap/calc":1066,"../heatmap/colorbar":1068,"./attributes":1080,"./convert":1081,"./defaults":1082}],1084:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../bar/attributes"),rt=Ne("../../plots/template_attributes").hovertemplateAttrs,nt=Ne("./bin_attributes"),at=Ne("./constants"),it=Ne("../../lib/extend").extendFlat;Ge.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},text:it({},tt.text,{}),hovertext:it({},tt.hovertext,{}),orientation:tt.orientation,histfunc:{valType:"enumerated",values:["count","sum","avg","min","max"],dflt:"count",editType:"calc"},histnorm:{valType:"enumerated",values:["","percent","probability","density","probability density"],dflt:"",editType:"calc"},cumulative:{enabled:{valType:"boolean",dflt:!1,editType:"calc"},direction:{valType:"enumerated",values:["increasing","decreasing"],dflt:"increasing",editType:"calc"},currentbin:{valType:"enumerated",values:["include","exclude","half"],dflt:"include",editType:"calc"},editType:"calc"},nbinsx:{valType:"integer",min:0,dflt:0,editType:"calc"},xbins:nt("x",!0),nbinsy:{valType:"integer",min:0,dflt:0,editType:"calc"},ybins:nt("y",!0),autobinx:{valType:"boolean",dflt:null,editType:"calc"},autobiny:{valType:"boolean",dflt:null,editType:"calc"},bingroup:{valType:"string",dflt:"",editType:"calc"},hovertemplate:rt({},{keys:at.eventDataKeys}),marker:tt.marker,offsetgroup:tt.offsetgroup,alignmentgroup:tt.alignmentgroup,selected:tt.selected,unselected:tt.unselected,_deprecated:{bardir:tt._deprecated.bardir}}},{"../../lib/extend":768,"../../plots/template_attributes":906,"../bar/attributes":921,"./bin_attributes":1086,"./constants":1090}],1085:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge){for(var Qe=Ne.length,tt=0,rt=0;rt<Qe;rt++)Ge[rt]?(Ne[rt]/=Ge[rt],tt+=Ne[rt]):Ne[rt]=null;return tt}},{}],1086:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge){return{start:{valType:"any",editType:"calc"},end:{valType:"any",editType:"calc"},size:{valType:"any",editType:"calc"},editType:"calc"}}},{}],1087:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric");Ge.exports={count:function(Ne,Ge,Qe){return Qe[Ne]++,1},sum:function(Ne,Ge,Qe,rt){var nt=rt[Ge];return tt(nt)?(nt=Number(nt),Qe[Ne]+=nt,nt):0},avg:function(Ne,Ge,Qe,rt,nt){var at=rt[Ge];return tt(at)&&(at=Number(at),Qe[Ne]+=at,nt[Ne]++),0},min:function(Ne,Ge,Qe,rt){var nt=rt[Ge];if(tt(nt)){if(nt=Number(nt),!tt(Qe[Ne]))return Qe[Ne]=nt,nt;if(Qe[Ne]>nt){var at=nt-Qe[Ne];return Qe[Ne]=nt,at}}return 0},max:function(Ne,Ge,Qe,rt){var nt=rt[Ge];if(tt(nt)){if(nt=Number(nt),!tt(Qe[Ne]))return Qe[Ne]=nt,nt;if(Qe[Ne]<nt){var at=nt-Qe[Ne];return Qe[Ne]=nt,at}}return 0}}},{"fast-isnumeric":241}],1088:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../constants/numerical"),rt=tt.ONEAVGYEAR,nt=tt.ONEAVGMONTH,at=tt.ONEDAY,it=tt.ONEHOUR,ot=tt.ONEMIN,dt=tt.ONESEC,ht=Ne("../../plots/cartesian/axes").tickIncrement;function biggestDigitChanged(Ne,Ge,Qe,tt){if(Ne*Ge<=0)return 1/0;for(var rt=Math.abs(Ge-Ne),nt="date"===Qe.type,at=biggestGuaranteedDigitChanged(rt,nt),it=0;it<10;it++){var ot=biggestGuaranteedDigitChanged(80*at,nt);if(at===ot)break;if(!didDigitChange(ot,Ne,Ge,nt,Qe,tt))break;at=ot}return at}function biggestGuaranteedDigitChanged(Ne,Ge){return Ge&&Ne>dt?Ne>at?Ne>1.1*rt?rt:Ne>1.1*nt?nt:at:Ne>it?it:Ne>ot?ot:dt:Math.pow(10,Math.floor(Math.log(Ne)/Math.LN10))}function didDigitChange(Ne,Ge,Qe,tt,nt,it){if(tt&&Ne>at){var ot=dateParts(Ge,nt,it),dt=dateParts(Qe,nt,it),ht=Ne===rt?0:1;return ot[ht]!==dt[ht]}return Math.floor(Qe/Ne)-Math.floor(Ge/Ne)>.1}function dateParts(Ne,Ge,Qe){var tt=Ge.c2d(Ne,rt,Qe).split("-");return""===tt[0]&&(tt.unshift(),tt[0]="-"+tt[0]),tt}Ge.exports=function(Ne,Ge,Qe,tt,nt){var it,ot,dt=-1.1*Ge,Dt=-.1*Ge,Ot=Ne-Dt,Rt=Qe[0],Zt=Qe[1],er=Math.min(biggestDigitChanged(Rt+Dt,Rt+Ot,tt,nt),biggestDigitChanged(Zt+Dt,Zt+Ot,tt,nt)),dr=Math.min(biggestDigitChanged(Rt+dt,Rt+Dt,tt,nt),biggestDigitChanged(Zt+dt,Zt+Dt,tt,nt));if(er>dr&&dr<Math.abs(Zt-Rt)/4e3?(it=er,ot=!1):(it=Math.min(er,dr),ot=!0),"date"===tt.type&&it>at){var mr=it===rt?1:6,xr=it===rt?"M12":"M1";return function(Ge,Qe){var at=tt.c2d(Ge,rt,nt),it=at.indexOf("-",mr);it>0&&(at=at.substr(0,it));var dt=tt.d2c(at,0,nt);if(dt<Ge){var Dt=ht(dt,xr,!1,nt);(dt+Dt)/2<Ge+Ne&&(dt=Dt)}return Qe&&ot?ht(dt,xr,!0,nt):dt}}return function(Ge,Qe){var tt=it*Math.round(Ge/it);return tt+it/10<Ge&&tt+.9*it<Ge+Ne&&(tt+=it),Qe&&ot&&(tt-=it),tt}}},{"../../constants/numerical":753,"../../plots/cartesian/axes":828}],1089:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../lib"),nt=Ne("../../registry"),at=Ne("../../plots/cartesian/axes"),it=Ne("../bar/arrays_to_calcdata"),ot=Ne("./bin_functions"),dt=Ne("./norm_functions"),ht=Ne("./average"),Dt=Ne("./bin_label_vals");function calc(Ne,Ge){var Qe,nt,Ot,Rt,Zt=[],er=[],dr=at.getFromId(Ne,"h"===Ge.orientation?Ge.yaxis:Ge.xaxis),mr="h"===Ge.orientation?"y":"x",xr={x:"y",y:"x"}[mr],br=Ge[mr+"calendar"],Ar=Ge.cumulative,en=calcAllAutoBins(Ne,Ge,dr,mr),mn=en[0],xn=en[1],kn="string"==typeof mn.size,Cn=[],En=kn?Cn:mn,Pn=[],Dn=[],In=[],zn=0,Bn=Ge.histnorm,Vn=Ge.histfunc,Hn=-1!==Bn.indexOf("density");Ar.enabled&&Hn&&(Bn=Bn.replace(/ ?density$/,""),Hn=!1);var qn,Yn="max"===Vn||"min"===Vn?null:0,$n=ot.count,ra=dt[Bn],oa=!1,pr2c=function(Ne){return dr.r2c(Ne,0,br)};for(rt.isArrayOrTypedArray(Ge[xr])&&"count"!==Vn&&(qn=Ge[xr],oa="avg"===Vn,$n=ot[Vn]),Qe=pr2c(mn.start),Ot=pr2c(mn.end)+(Qe-at.tickIncrement(Qe,mn.size,!1,br))/1e6;Qe<Ot&&Zt.length<1e6&&(nt=at.tickIncrement(Qe,mn.size,!1,br),Zt.push((Qe+nt)/2),er.push(Yn),In.push([]),Cn.push(Qe),Hn&&Pn.push(1/(nt-Qe)),oa&&Dn.push(0),!(nt<=Qe));)Qe=nt;Cn.push(Qe),kn||"date"!==dr.type||(En={start:pr2c(En.start),end:pr2c(En.end),size:En.size}),Ne._fullLayout._roundFnOpts||(Ne._fullLayout._roundFnOpts={});var pa=Ge["_"+mr+"bingroup"],ga={leftGap:1/0,rightGap:1/0};pa&&(Ne._fullLayout._roundFnOpts[pa]||(Ne._fullLayout._roundFnOpts[pa]=ga),ga=Ne._fullLayout._roundFnOpts[pa]);var ma,_a=er.length,Va=!0,Wa=ga.leftGap,Qa=ga.rightGap,ti={};for(Qe=0;Qe<xn.length;Qe++){var ni=xn[Qe];(Rt=rt.findBin(ni,En))>=0&&Rt<_a&&(zn+=$n(Rt,Qe,er,qn,Dn),Va&&In[Rt].length&&ni!==xn[In[Rt][0]]&&(Va=!1),In[Rt].push(Qe),ti[Qe]=Rt,Wa=Math.min(Wa,ni-Cn[Rt]),Qa=Math.min(Qa,Cn[Rt+1]-ni))}ga.leftGap=Wa,ga.rightGap=Qa,Va||(ma=function(Ge,Qe){return function(){var tt=Ne._fullLayout._roundFnOpts[pa];return Dt(tt.leftGap,tt.rightGap,Cn,dr,br)(Ge,Qe)}}),oa&&(zn=ht(er,Dn)),ra&&ra(er,zn,Pn),Ar.enabled&&cdf(er,Ar.direction,Ar.currentbin);var di=Math.min(Zt.length,er.length),ji=[],Hi=0,Yi=di-1;for(Qe=0;Qe<di;Qe++)if(er[Qe]){Hi=Qe;break}for(Qe=di-1;Qe>=Hi;Qe--)if(er[Qe]){Yi=Qe;break}for(Qe=Hi;Qe<=Yi;Qe++)if(tt(Zt[Qe])&&tt(er[Qe])){var uo={p:Zt[Qe],s:er[Qe],b:0};Ar.enabled||(uo.pts=In[Qe],Va?uo.ph0=uo.ph1=In[Qe].length?xn[In[Qe][0]]:Zt[Qe]:(Ge._computePh=!0,uo.ph0=ma(Cn[Qe]),uo.ph1=ma(Cn[Qe+1],!0))),ji.push(uo)}return 1===ji.length&&(ji[0].width1=at.tickIncrement(ji[0].p,mn.size,!1,br)-ji[0].p),it(ji,Ge),rt.isArrayOrTypedArray(Ge.selectedpoints)&&rt.tagSelected(ji,Ge,ti),ji}function calcAllAutoBins(Ne,Ge,Qe,it,ot){var dt,ht,Dt,Ot,Rt,Zt,er,dr=it+"bins",mr=Ne._fullLayout,xr=Ge["_"+it+"bingroup"],br=mr._histogramBinOpts[xr],Ar="overlay"===mr.barmode,r2c=function(Ne){return Qe.r2c(Ne,0,Ot)},c2r=function(Ne){return Qe.c2r(Ne,0,Ot)},en="date"===Qe.type?function(Ne){return Ne||0===Ne?rt.cleanDate(Ne,null,Ot):null}:function(Ne){return tt(Ne)?Number(Ne):null};function setBound(Ne,Ge,Qe){Ge[Ne+"Found"]?(Ge[Ne]=en(Ge[Ne]),null===Ge[Ne]&&(Ge[Ne]=Qe[Ne])):(Zt[Ne]=Ge[Ne]=Qe[Ne],rt.nestedProperty(ht[0],dr+"."+Ne).set(Qe[Ne]))}if(Ge["_"+it+"autoBinFinished"])delete Ge["_"+it+"autoBinFinished"];else{ht=br.traces;var mn=[],xn=!0,kn=!1,Cn=!1;for(dt=0;dt<ht.length;dt++)if((Dt=ht[dt]).visible){var En=br.dirs[dt];Rt=Dt["_"+En+"pos0"]=Qe.makeCalcdata(Dt,En),mn=rt.concat(mn,Rt),delete Dt["_"+it+"autoBinFinished"],!0===Ge.visible&&(xn?xn=!1:(delete Dt._autoBin,Dt["_"+it+"autoBinFinished"]=1),nt.traceIs(Dt,"2dMap")&&(kn=!0),"histogram2dcontour"===Dt.type&&(Cn=!0))}Ot=ht[0][it+"calendar"];var Pn=at.autoBin(mn,Qe,br.nbins,kn,Ot,br.sizeFound&&br.size),Dn=ht[0]._autoBin={};if(Zt=Dn[br.dirs[0]]={},Cn&&(br.size||(Pn.start=c2r(at.tickIncrement(r2c(Pn.start),Pn.size,!0,Ot))),void 0===br.end&&(Pn.end=c2r(at.tickIncrement(r2c(Pn.end),Pn.size,!1,Ot)))),Ar&&!nt.traceIs(Ge,"2dMap")&&0===Pn._dataSpan&&"category"!==Qe.type&&"multicategory"!==Qe.type){if(ot)return[Pn,Rt,!0];Pn=handleSingleValueOverlays(Ne,Ge,Qe,it,dr)}(er=Dt.cumulative||{}).enabled&&"include"!==er.currentbin&&("decreasing"===er.direction?Pn.start=c2r(at.tickIncrement(r2c(Pn.start),Pn.size,!0,Ot)):Pn.end=c2r(at.tickIncrement(r2c(Pn.end),Pn.size,!1,Ot))),br.size=Pn.size,br.sizeFound||(Zt.size=Pn.size,rt.nestedProperty(ht[0],dr+".size").set(Pn.size)),setBound("start",br,Pn),setBound("end",br,Pn)}Rt=Ge["_"+it+"pos0"],delete Ge["_"+it+"pos0"];var In=Ge._input[dr]||{},zn=rt.extendFlat({},br),Bn=br.start,Vn=Qe.r2l(In.start),Hn=void 0!==Vn;if((br.startFound||Hn)&&Vn!==Qe.r2l(Bn)){var qn=Hn?Vn:rt.aggNums(Math.min,null,Rt),Yn={type:"category"===Qe.type||"multicategory"===Qe.type?"linear":Qe.type,r2l:Qe.r2l,dtick:br.size,tick0:Bn,calendar:Ot,range:[qn,at.tickIncrement(qn,br.size,!1,Ot)].map(Qe.l2r)},$n=at.tickFirst(Yn);$n>Qe.r2l(qn)&&($n=at.tickIncrement($n,br.size,!0,Ot)),zn.start=Qe.l2r($n),Hn||rt.nestedProperty(Ge,dr+".start").set(zn.start)}var ra=br.end,oa=Qe.r2l(In.end),pa=void 0!==oa;if((br.endFound||pa)&&oa!==Qe.r2l(ra)){var ga=pa?oa:rt.aggNums(Math.max,null,Rt);zn.end=Qe.l2r(ga),pa||rt.nestedProperty(Ge,dr+".start").set(zn.end)}var ma="autobin"+it;return!1===Ge._input[ma]&&(Ge._input[dr]=rt.extendFlat({},Ge[dr]||{}),delete Ge._input[ma],delete Ge[ma]),[zn,Rt]}function handleSingleValueOverlays(Ne,Ge,Qe,tt,nt){var at,it,ot,dt=Ne._fullLayout,ht=getConnectedHistograms(Ne,Ge),Dt=!1,Ot=1/0,Rt=[Ge];for(at=0;at<ht.length;at++)if((it=ht[at])===Ge)Dt=!0;else if(Dt){var Zt=calcAllAutoBins(Ne,it,Qe,tt,!0),er=Zt[0],dr=Zt[2];it["_"+tt+"autoBinFinished"]=1,it["_"+tt+"pos0"]=Zt[1],dr?Rt.push(it):Ot=Math.min(Ot,er.size)}else ot=dt._histogramBinOpts[it["_"+tt+"bingroup"]],Ot=Math.min(Ot,ot.size||it[nt].size);var mr=new Array(Rt.length);for(at=0;at<Rt.length;at++)for(var xr=Rt[at]["_"+tt+"pos0"],br=0;br<xr.length;br++)if(void 0!==xr[br]){mr[at]=xr[br];break}for(isFinite(Ot)||(Ot=rt.distinctVals(mr).minDiff),at=0;at<Rt.length;at++){var Ar=(it=Rt[at])[tt+"calendar"],en={start:Qe.c2r(mr[at]-Ot/2,0,Ar),end:Qe.c2r(mr[at]+Ot/2,0,Ar),size:Ot};it._input[nt]=it[nt]=en,(ot=dt._histogramBinOpts[it["_"+tt+"bingroup"]])&&rt.extendFlat(ot,en)}return Ge[nt]}function getConnectedHistograms(Ne,Ge){for(var Qe=Ge.xaxis,tt=Ge.yaxis,rt=Ge.orientation,nt=[],at=Ne._fullData,it=0;it<at.length;it++){var ot=at[it];"histogram"===ot.type&&!0===ot.visible&&ot.orientation===rt&&ot.xaxis===Qe&&ot.yaxis===tt&&nt.push(ot)}return nt}function cdf(Ne,Ge,Qe){var tt,rt,nt;function firstHalfPoint(Ge){nt=Ne[Ge],Ne[Ge]/=2}function nextHalfPoint(Ge){rt=Ne[Ge],Ne[Ge]=nt+rt/2,nt+=rt}if("half"===Qe)if("increasing"===Ge)for(firstHalfPoint(0),tt=1;tt<Ne.length;tt++)nextHalfPoint(tt);else for(firstHalfPoint(Ne.length-1),tt=Ne.length-2;tt>=0;tt--)nextHalfPoint(tt);else if("increasing"===Ge){for(tt=1;tt<Ne.length;tt++)Ne[tt]+=Ne[tt-1];"exclude"===Qe&&(Ne.unshift(0),Ne.pop())}else{for(tt=Ne.length-2;tt>=0;tt--)Ne[tt]+=Ne[tt+1];"exclude"===Qe&&(Ne.push(0),Ne.shift())}}Ge.exports={calc:calc,calcAllAutoBins:calcAllAutoBins}},{"../../lib":778,"../../plots/cartesian/axes":828,"../../registry":911,"../bar/arrays_to_calcdata":920,"./average":1085,"./bin_functions":1087,"./bin_label_vals":1088,"./norm_functions":1096,"fast-isnumeric":241}],1090:[function(Ne,Ge,Qe){"use strict";Ge.exports={eventDataKeys:["binNumber"]}},{}],1091:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../plots/cartesian/axis_ids"),nt=Ne("../../registry").traceIs,at=Ne("../bar/defaults").handleGroupingDefaults,it=tt.nestedProperty,ot=Ne("../../plots/cartesian/constraints").getAxisGroup,dt=[{aStr:{x:"xbins.start",y:"ybins.start"},name:"start"},{aStr:{x:"xbins.end",y:"ybins.end"},name:"end"},{aStr:{x:"xbins.size",y:"ybins.size"},name:"size"},{aStr:{x:"nbinsx",y:"nbinsy"},name:"nbins"}],ht=["x","y"];Ge.exports=function(Ne,Ge){var Qe,Dt,Ot,Rt,Zt,er,dr,mr=Ge._histogramBinOpts={},xr=[],br={},Ar=[];function coerce(Ne,Ge){return tt.coerce(Qe._input,Qe,Qe._module.attributes,Ne,Ge)}function orientation2binDir(Ne){return"v"===Ne.orientation?"x":"y"}function getAxisType(Ne,Qe){return rt.getFromTrace({_fullLayout:Ge},Ne,Qe).type}function fillBinOpts(Ne,Ge,Qe){var rt=Ne.uid+"__"+Qe;Ge||(Ge=rt);var nt=getAxisType(Ne,Qe),at=Ne[Qe+"calendar"]||"",it=mr[Ge],ot=!0;it&&(nt===it.axType&&at===it.calendar?(ot=!1,it.traces.push(Ne),it.dirs.push(Qe)):(Ge=rt,nt!==it.axType&&tt.warn(["Attempted to group the bins of trace",Ne.index,"set on a","type:"+nt,"axis","with bins on","type:"+it.axType,"axis."].join(" ")),at!==it.calendar&&tt.warn(["Attempted to group the bins of trace",Ne.index,"set with a",at,"calendar","with bins",it.calendar?"on a "+it.calendar+" calendar":"w/o a set calendar"].join(" ")))),ot&&(mr[Ge]={traces:[Ne],dirs:[Qe],axType:nt,calendar:Ne[Qe+"calendar"]||""}),Ne["_"+Qe+"bingroup"]=Ge}for(Zt=0;Zt<Ne.length;Zt++)Qe=Ne[Zt],nt(Qe,"histogram")&&(xr.push(Qe),delete Qe._xautoBinFinished,delete Qe._yautoBinFinished,nt(Qe,"2dMap")||at(Qe._input,Qe,Ge,coerce));var en=Ge._alignmentOpts||{};for(Zt=0;Zt<xr.length;Zt++){if(Qe=xr[Zt],Ot="",!nt(Qe,"2dMap")){if(Rt=orientation2binDir(Qe),"group"===Ge.barmode&&Qe.alignmentgroup){var mn=Qe[Rt+"axis"],xn=ot(Ge,mn)+Qe.orientation;(en[xn]||{})[Qe.alignmentgroup]&&(Ot=xn)}Ot||"overlay"===Ge.barmode||(Ot=ot(Ge,Qe.xaxis)+ot(Ge,Qe.yaxis)+orientation2binDir(Qe))}Ot?(br[Ot]||(br[Ot]=[]),br[Ot].push(Qe)):Ar.push(Qe)}for(Ot in br)if(1!==(Dt=br[Ot]).length){var kn=!1;for(Dt.length&&(Qe=Dt[0],kn=coerce("bingroup")),Ot=kn||Ot,Zt=0;Zt<Dt.length;Zt++){var Cn=(Qe=Dt[Zt])._input.bingroup;Cn&&Cn!==Ot&&tt.warn(["Trace",Qe.index,"must match","within bingroup",Ot+".","Ignoring its bingroup:",Cn,"setting."].join(" ")),Qe.bingroup=Ot,fillBinOpts(Qe,Ot,orientation2binDir(Qe))}}else Ar.push(Dt[0]);for(Zt=0;Zt<Ar.length;Zt++){Qe=Ar[Zt];var En=coerce("bingroup");if(nt(Qe,"2dMap"))for(dr=0;dr<2;dr++){var Pn=coerce((Rt=ht[dr])+"bingroup",En?En+"__"+Rt:null);fillBinOpts(Qe,Pn,Rt)}else fillBinOpts(Qe,En,orientation2binDir(Qe))}for(Ot in mr){var Dn=mr[Ot];for(Dt=Dn.traces,er=0;er<dt.length;er++){var In,zn,Bn=dt[er],Vn=Bn.name;if("nbins"!==Vn||!Dn.sizeFound){for(Zt=0;Zt<Dt.length;Zt++){if(Qe=Dt[Zt],Rt=Dn.dirs[Zt],In=Bn.aStr[Rt],void 0!==it(Qe._input,In).get()){Dn[Vn]=coerce(In),Dn[Vn+"Found"]=!0;break}(zn=(Qe._autoBin||{})[Rt]||{})[Vn]&&it(Qe,In).set(zn[Vn])}if("start"===Vn||"end"===Vn)for(;Zt<Dt.length;Zt++)(Qe=Dt[Zt])["_"+Rt+"bingroup"]&&coerce(In,(zn=(Qe._autoBin||{})[Rt]||{})[Vn]);"nbins"!==Vn||Dn.sizeFound||Dn.nbinsFound||(Qe=Dt[0],Dn[Vn]=coerce(In))}}}}},{"../../lib":778,"../../plots/cartesian/axis_ids":831,"../../plots/cartesian/constraints":835,"../../registry":911,"../bar/defaults":925}],1092:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../registry"),rt=Ne("../../lib"),nt=Ne("../../components/color"),at=Ne("../bar/style_defaults"),it=Ne("./attributes");Ge.exports=function(Ne,Ge,Qe,ot){function coerce(Qe,tt){return rt.coerce(Ne,Ge,it,Qe,tt)}var dt=coerce("x"),ht=coerce("y");coerce("cumulative.enabled")&&(coerce("cumulative.direction"),coerce("cumulative.currentbin")),coerce("text"),coerce("hovertext"),coerce("hovertemplate");var Dt=coerce("orientation",ht&&!dt?"h":"v"),Ot="v"===Dt?"x":"y",Rt="v"===Dt?"y":"x",Zt=dt&&ht?Math.min(rt.minRowLength(dt)&&rt.minRowLength(ht)):rt.minRowLength(Ge[Ot]||[]);if(Zt){Ge._length=Zt,tt.getComponentMethod("calendars","handleTraceDefaults")(Ne,Ge,["x","y"],ot),Ge[Rt]&&coerce("histfunc"),coerce("histnorm"),coerce("autobin"+Ot),at(Ne,Ge,coerce,Qe,ot),rt.coerceSelectionMarkerOpacity(Ge,coerce);var er=(Ge.marker.line||{}).color,dr=tt.getComponentMethod("errorbars","supplyDefaults");dr(Ne,Ge,er||nt.defaultLine,{axis:"y"}),dr(Ne,Ge,er||nt.defaultLine,{axis:"x",inherit:"y"})}else Ge.visible=!1}},{"../../components/color":643,"../../lib":778,"../../registry":911,"../bar/style_defaults":936,"./attributes":1084}],1093:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge,Qe,tt,rt){if(Ne.x="xVal"in Ge?Ge.xVal:Ge.x,Ne.y="yVal"in Ge?Ge.yVal:Ge.y,"zLabelVal"in Ge&&(Ne.z=Ge.zLabelVal),Ge.xa&&(Ne.xaxis=Ge.xa),Ge.ya&&(Ne.yaxis=Ge.ya),!(Qe.cumulative||{}).enabled){var nt,at=Array.isArray(rt)?tt[0].pts[rt[0]][rt[1]]:tt[rt].pts;if(Ne.pointNumbers=at,Ne.binNumber=Ne.pointNumber,delete Ne.pointNumber,delete Ne.pointIndex,Qe._indexToPoints){nt=[];for(var it=0;it<at.length;it++)nt=nt.concat(Qe._indexToPoints[at[it]])}else nt=at;Ne.pointIndices=nt}return Ne}},{}],1094:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../bar/hover").hoverPoints,rt=Ne("../../plots/cartesian/axes").hoverLabelText;Ge.exports=function(Ne,Ge,Qe,nt){var at=tt(Ne,Ge,Qe,nt);if(at){var it=(Ne=at[0]).cd[Ne.index],ot=Ne.cd[0].trace;if(!ot.cumulative.enabled){var dt="h"===ot.orientation?"y":"x";Ne[dt+"Label"]=rt(Ne[dt+"a"],it.ph0,it.ph1)}return at}}},{"../../plots/cartesian/axes":828,"../bar/hover":928}],1095:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),layoutAttributes:Ne("../bar/layout_attributes"),supplyDefaults:Ne("./defaults"),crossTraceDefaults:Ne("./cross_trace_defaults"),supplyLayoutDefaults:Ne("../bar/layout_defaults"),calc:Ne("./calc").calc,crossTraceCalc:Ne("../bar/cross_trace_calc").crossTraceCalc,plot:Ne("../bar/plot").plot,layerName:"barlayer",style:Ne("../bar/style").style,styleOnSelect:Ne("../bar/style").styleOnSelect,colorbar:Ne("../scatter/marker_colorbar"),hoverPoints:Ne("./hover"),selectPoints:Ne("../bar/select"),eventData:Ne("./event_data"),moduleType:"trace",name:"histogram",basePlotModule:Ne("../../plots/cartesian"),categories:["bar-like","cartesian","svg","bar","histogram","oriented","errorBarsOK","showLegend"],meta:{}}},{"../../plots/cartesian":841,"../bar/cross_trace_calc":924,"../bar/layout_attributes":930,"../bar/layout_defaults":931,"../bar/plot":932,"../bar/select":933,"../bar/style":935,"../scatter/marker_colorbar":1205,"./attributes":1084,"./calc":1089,"./cross_trace_defaults":1091,"./defaults":1092,"./event_data":1093,"./hover":1094}],1096:[function(Ne,Ge,Qe){"use strict";Ge.exports={percent:function(Ne,Ge){for(var Qe=Ne.length,tt=100/Ge,rt=0;rt<Qe;rt++)Ne[rt]*=tt},probability:function(Ne,Ge){for(var Qe=Ne.length,tt=0;tt<Qe;tt++)Ne[tt]/=Ge},density:function(Ne,Ge,Qe,tt){var rt=Ne.length;tt=tt||1;for(var nt=0;nt<rt;nt++)Ne[nt]*=Qe[nt]*tt},"probability density":function(Ne,Ge,Qe,tt){var rt=Ne.length;tt&&(Ge/=tt);for(var nt=0;nt<rt;nt++)Ne[nt]*=Qe[nt]/Ge}}},{}],1097:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../histogram/attributes"),rt=Ne("../histogram/bin_attributes"),nt=Ne("../heatmap/attributes"),at=Ne("../../plots/attributes"),it=Ne("../../plots/template_attributes").hovertemplateAttrs,ot=Ne("../../components/colorscale/attributes"),dt=Ne("../../lib/extend").extendFlat;Ge.exports=dt({x:tt.x,y:tt.y,z:{valType:"data_array",editType:"calc"},marker:{color:{valType:"data_array",editType:"calc"},editType:"calc"},histnorm:tt.histnorm,histfunc:tt.histfunc,nbinsx:tt.nbinsx,xbins:rt("x"),nbinsy:tt.nbinsy,ybins:rt("y"),autobinx:tt.autobinx,autobiny:tt.autobiny,bingroup:dt({},tt.bingroup,{}),xbingroup:dt({},tt.bingroup,{}),ybingroup:dt({},tt.bingroup,{}),xgap:nt.xgap,ygap:nt.ygap,zsmooth:nt.zsmooth,zhoverformat:nt.zhoverformat,hovertemplate:it({},{keys:"z"}),showlegend:dt({},at.showlegend,{dflt:!1})},ot("",{cLetter:"z",autoColorDflt:!1}))},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../heatmap/attributes":1065,"../histogram/attributes":1084,"../histogram/bin_attributes":1086}],1098:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../plots/cartesian/axes"),nt=Ne("../histogram/bin_functions"),at=Ne("../histogram/norm_functions"),it=Ne("../histogram/average"),ot=Ne("../histogram/bin_label_vals"),dt=Ne("../histogram/calc").calcAllAutoBins;function makeIncrements(Ne,Ge,Qe,tt){var rt,nt=new Array(Ne);if(tt)for(rt=0;rt<Ne;rt++)nt[rt]=1/(Ge[rt+1]-Ge[rt]);else{var at=1/Qe;for(rt=0;rt<Ne;rt++)nt[rt]=at}return nt}function binsToCalc(Ne,Ge){return{start:Ne(Ge.start),end:Ne(Ge.end),size:Ge.size}}function getRanges(Ne,Ge,Qe,tt,rt,nt){var at,it=Ne.length-1,dt=new Array(it),ht=ot(Qe,tt,Ne,rt,nt);for(at=0;at<it;at++){var Dt=(Ge||[])[at];dt[at]=void 0===Dt?[ht(Ne[at]),ht(Ne[at+1],!0)]:[Dt,Dt]}return dt}Ge.exports=function(Ne,Ge){var Qe,ot,ht,Dt,Ot=rt.getFromId(Ne,Ge.xaxis),Rt=rt.getFromId(Ne,Ge.yaxis),Zt=Ge.xcalendar,er=Ge.ycalendar,xr2c=function(Ne){return Ot.r2c(Ne,0,Zt)},yr2c=function(Ne){return Rt.r2c(Ne,0,er)},xc2r=function(Ne){return Ot.c2r(Ne,0,Zt)},yc2r=function(Ne){return Rt.c2r(Ne,0,er)},dr=dt(Ne,Ge,Ot,"x"),mr=dr[0],xr=dr[1],br=dt(Ne,Ge,Rt,"y"),Ar=br[0],en=br[1],mn=Ge._length;xr.length>mn&&xr.splice(mn,xr.length-mn),en.length>mn&&en.splice(mn,en.length-mn);var xn=[],kn=[],Cn=[],En="string"==typeof mr.size,Pn="string"==typeof Ar.size,Dn=[],In=[],zn=En?Dn:mr,Bn=Pn?In:Ar,Vn=0,Hn=[],qn=[],Yn=Ge.histnorm,$n=Ge.histfunc,ra=-1!==Yn.indexOf("density"),oa="max"===$n||"min"===$n?null:0,pa=nt.count,ga=at[Yn],ma=!1,_a=[],Va=[],Wa="z"in Ge?Ge.z:"marker"in Ge&&Array.isArray(Ge.marker.color)?Ge.marker.color:"";Wa&&"count"!==$n&&(ma="avg"===$n,pa=nt[$n]);var Qa=mr.size,ti=xr2c(mr.start),ni=xr2c(mr.end)+(ti-rt.tickIncrement(ti,Qa,!1,Zt))/1e6;for(Qe=ti;Qe<ni;Qe=rt.tickIncrement(Qe,Qa,!1,Zt))kn.push(oa),Dn.push(Qe),ma&&Cn.push(0);Dn.push(Qe);var di=kn.length,ji=(Qe-ti)/di,Hi=xc2r(ti+ji/2),Yi=Ar.size,uo=yr2c(Ar.start),go=yr2c(Ar.end)+(uo-rt.tickIncrement(uo,Yi,!1,er))/1e6;for(Qe=uo;Qe<go;Qe=rt.tickIncrement(Qe,Yi,!1,er)){xn.push(kn.slice()),In.push(Qe);var ns=new Array(di);for(ot=0;ot<di;ot++)ns[ot]=[];qn.push(ns),ma&&Hn.push(Cn.slice())}In.push(Qe);var as=xn.length,is=(Qe-uo)/as,os=yc2r(uo+is/2);ra&&(_a=makeIncrements(kn.length,zn,ji,En),Va=makeIncrements(xn.length,Bn,is,Pn)),En||"date"!==Ot.type||(zn=binsToCalc(xr2c,zn)),Pn||"date"!==Rt.type||(Bn=binsToCalc(yr2c,Bn));var ss=!0,cs=!0,ds=new Array(di),ms=new Array(as),vs=1/0,_s=1/0,ws=1/0,Ts=1/0;for(Qe=0;Qe<mn;Qe++){var ks=xr[Qe],Cs=en[Qe];ht=tt.findBin(ks,zn),Dt=tt.findBin(Cs,Bn),ht>=0&&ht<di&&Dt>=0&&Dt<as&&(Vn+=pa(ht,Qe,xn[Dt],Wa,Hn[Dt]),qn[Dt][ht].push(Qe),ss&&(void 0===ds[ht]?ds[ht]=ks:ds[ht]!==ks&&(ss=!1)),cs&&(void 0===ms[Dt]?ms[Dt]=Cs:ms[Dt]!==Cs&&(cs=!1)),vs=Math.min(vs,ks-Dn[ht]),_s=Math.min(_s,Dn[ht+1]-ks),ws=Math.min(ws,Cs-In[Dt]),Ts=Math.min(Ts,In[Dt+1]-Cs))}if(ma)for(Dt=0;Dt<as;Dt++)Vn+=it(xn[Dt],Hn[Dt]);if(ga)for(Dt=0;Dt<as;Dt++)ga(xn[Dt],Vn,_a,Va[Dt]);return{x:xr,xRanges:getRanges(Dn,ss&&ds,vs,_s,Ot,Zt),x0:Hi,dx:ji,y:en,yRanges:getRanges(In,cs&&ms,ws,Ts,Rt,er),y0:os,dy:is,z:xn,pts:qn}}},{"../../lib":778,"../../plots/cartesian/axes":828,"../histogram/average":1085,"../histogram/bin_functions":1087,"../histogram/bin_label_vals":1088,"../histogram/calc":1089,"../histogram/norm_functions":1096}],1099:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./sample_defaults"),nt=Ne("../heatmap/style_defaults"),at=Ne("../../components/colorscale/defaults"),it=Ne("./attributes");Ge.exports=function(Ne,Ge,Qe,ot){function coerce(Qe,rt){return tt.coerce(Ne,Ge,it,Qe,rt)}rt(Ne,Ge,coerce,ot),!1!==Ge.visible&&(nt(Ne,Ge,coerce,ot),at(Ne,Ge,ot,coerce,{prefix:"",cLetter:"z"}),coerce("hovertemplate"))}},{"../../components/colorscale/defaults":653,"../../lib":778,"../heatmap/style_defaults":1078,"./attributes":1097,"./sample_defaults":1102}],1100:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../heatmap/hover"),rt=Ne("../../plots/cartesian/axes").hoverLabelText;Ge.exports=function(Ne,Ge,Qe,nt,at,it){var ot=tt(Ne,Ge,Qe,nt,at,it);if(ot){var dt=(Ne=ot[0]).index,ht=dt[0],Dt=dt[1],Ot=Ne.cd[0],Rt=Ot.xRanges[Dt],Zt=Ot.yRanges[ht];return Ne.xLabel=rt(Ne.xa,Rt[0],Rt[1]),Ne.yLabel=rt(Ne.ya,Zt[0],Zt[1]),ot}}},{"../../plots/cartesian/axes":828,"../heatmap/hover":1072}],1101:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),crossTraceDefaults:Ne("../histogram/cross_trace_defaults"),calc:Ne("../heatmap/calc"),plot:Ne("../heatmap/plot"),layerName:"heatmaplayer",colorbar:Ne("../heatmap/colorbar"),style:Ne("../heatmap/style"),hoverPoints:Ne("./hover"),eventData:Ne("../histogram/event_data"),moduleType:"trace",name:"histogram2d",basePlotModule:Ne("../../plots/cartesian"),categories:["cartesian","svg","2dMap","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":841,"../heatmap/calc":1066,"../heatmap/colorbar":1068,"../heatmap/plot":1076,"../heatmap/style":1077,"../histogram/cross_trace_defaults":1091,"../histogram/event_data":1093,"./attributes":1097,"./defaults":1099,"./hover":1100}],1102:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../registry"),rt=Ne("../../lib");Ge.exports=function(Ne,Ge,Qe,nt){var at=Qe("x"),it=Qe("y"),ot=rt.minRowLength(at),dt=rt.minRowLength(it);ot&&dt?(Ge._length=Math.min(ot,dt),tt.getComponentMethod("calendars","handleTraceDefaults")(Ne,Ge,["x","y"],nt),(Qe("z")||Qe("marker.color"))&&Qe("histfunc"),Qe("histnorm"),Qe("autobinx"),Qe("autobiny")):Ge.visible=!1}},{"../../lib":778,"../../registry":911}],1103:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../histogram2d/attributes"),rt=Ne("../contour/attributes"),nt=Ne("../../components/colorscale/attributes"),at=Ne("../../lib/extend").extendFlat;Ge.exports=at({x:tt.x,y:tt.y,z:tt.z,marker:tt.marker,histnorm:tt.histnorm,histfunc:tt.histfunc,nbinsx:tt.nbinsx,xbins:tt.xbins,nbinsy:tt.nbinsy,ybins:tt.ybins,autobinx:tt.autobinx,autobiny:tt.autobiny,bingroup:tt.bingroup,xbingroup:tt.xbingroup,ybingroup:tt.ybingroup,autocontour:rt.autocontour,ncontours:rt.ncontours,contours:rt.contours,line:{color:rt.line.color,width:at({},rt.line.width,{dflt:.5}),dash:rt.line.dash,smoothing:rt.line.smoothing,editType:"plot"},zhoverformat:tt.zhoverformat,hovertemplate:tt.hovertemplate},nt("",{cLetter:"z",editTypeOverride:"calc"}))},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../contour/attributes":1008,"../histogram2d/attributes":1097}],1104:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../histogram2d/sample_defaults"),nt=Ne("../contour/contours_defaults"),at=Ne("../contour/style_defaults"),it=Ne("./attributes");Ge.exports=function(Ne,Ge,Qe,ot){function coerce(Qe,rt){return tt.coerce(Ne,Ge,it,Qe,rt)}function coerce2(Qe){return tt.coerce2(Ne,Ge,it,Qe)}rt(Ne,Ge,coerce,ot),!1!==Ge.visible&&(nt(Ne,Ge,coerce,coerce2),at(Ne,Ge,coerce,ot),coerce("hovertemplate"))}},{"../../lib":778,"../contour/contours_defaults":1015,"../contour/style_defaults":1029,"../histogram2d/sample_defaults":1102,"./attributes":1103}],1105:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),crossTraceDefaults:Ne("../histogram/cross_trace_defaults"),calc:Ne("../contour/calc"),plot:Ne("../contour/plot").plot,layerName:"contourlayer",style:Ne("../contour/style"),colorbar:Ne("../contour/colorbar"),hoverPoints:Ne("../contour/hover"),moduleType:"trace",name:"histogram2dcontour",basePlotModule:Ne("../../plots/cartesian"),categories:["cartesian","svg","2dMap","contour","histogram","showLegend"],meta:{}}},{"../../plots/cartesian":841,"../contour/calc":1009,"../contour/colorbar":1011,"../contour/hover":1021,"../contour/plot":1026,"../contour/style":1028,"../histogram/cross_trace_defaults":1091,"./attributes":1103,"./defaults":1104}],1106:[function(Ne,Ge,Qe){"use strict";for(var tt=Ne("../../plots/attributes"),rt=Ne("../../plots/template_attributes").hovertemplateAttrs,nt=Ne("../../lib/extend").extendFlat,at=Ne("./constants").colormodel,it=["rgb","rgba","rgba256","hsl","hsla"],ot=[],dt=[],ht=0;ht<it.length;ht++){var Dt=at[it[ht]];ot.push("For the `"+it[ht]+"` colormodel, it is ["+(Dt.zminDflt||Dt.min).join(", ")+"]."),dt.push("For the `"+it[ht]+"` colormodel, it is ["+(Dt.zmaxDflt||Dt.max).join(", ")+"].")}Ge.exports=nt({source:{valType:"string",editType:"calc"},z:{valType:"data_array",editType:"calc"},colormodel:{valType:"enumerated",values:it,editType:"calc"},zmin:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},zmax:{valType:"info_array",items:[{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"},{valType:"number",editType:"calc"}],editType:"calc"},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dx:{valType:"number",dflt:1,editType:"calc"},dy:{valType:"number",dflt:1,editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"data_array",editType:"plot"},hoverinfo:nt({},tt.hoverinfo,{flags:["x","y","z","color","name","text"],dflt:"x+y+z+text+name"}),hovertemplate:rt({},{keys:["z","color","colormodel"]}),transforms:void 0})},{"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"./constants":1108}],1107:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./constants"),nt=Ne("fast-isnumeric"),at=Ne("../../plots/cartesian/axes"),it=Ne("../../lib").maxRowLength,ot=Ne("./helpers").getImageSize;function scale(Ne,Ge,Qe,rt){return function(nt){return tt.constrain((nt-Ne)*Ge,Qe,rt)}}function constrain(Ne,Ge){return function(Qe){return tt.constrain(Qe,Ne,Ge)}}function makeScaler(Ne){var Ge=rt.colormodel[Ne.colormodel],Qe=(Ge.colormodel||Ne.colormodel).length;Ne._sArray=[];for(var tt=0;tt<Qe;tt++)Ge.min[tt]!==Ne.zmin[tt]||Ge.max[tt]!==Ne.zmax[tt]?Ne._sArray.push(scale(Ne.zmin[tt],(Ge.max[tt]-Ge.min[tt])/(Ne.zmax[tt]-Ne.zmin[tt]),Ge.min[tt],Ge.max[tt])):Ne._sArray.push(constrain(Ge.min[tt],Ge.max[tt]));return function(Ge){for(var tt=Ge.slice(0,Qe),rt=0;rt<Qe;rt++){var at=tt[rt];if(!nt(at))return!1;tt[rt]=Ne._sArray[rt](at)}return tt}}Ge.exports=function(Ne,Ge){var Qe,tt;if(Ge._hasZ)Qe=Ge.z.length,tt=it(Ge.z);else if(Ge._hasSource){var rt=ot(Ge.source);Qe=rt.height,tt=rt.width}var nt,dt=at.getFromId(Ne,Ge.xaxis||"x"),ht=at.getFromId(Ne,Ge.yaxis||"y"),Dt=dt.d2c(Ge.x0)-Ge.dx/2,Ot=ht.d2c(Ge.y0)-Ge.dy/2,Rt=[Dt,Dt+tt*Ge.dx],Zt=[Ot,Ot+Qe*Ge.dy];if(dt&&"log"===dt.type)for(nt=0;nt<tt;nt++)Rt.push(Dt+nt*Ge.dx);if(ht&&"log"===ht.type)for(nt=0;nt<Qe;nt++)Zt.push(Ot+nt*Ge.dy);return Ge._extremes[dt._id]=at.findExtremes(dt,Rt),Ge._extremes[ht._id]=at.findExtremes(ht,Zt),Ge._scaler=makeScaler(Ge),[{x0:Dt,y0:Ot,z:Ge.z,w:tt,h:Qe}]}},{"../../lib":778,"../../plots/cartesian/axes":828,"./constants":1108,"./helpers":1111,"fast-isnumeric":241}],1108:[function(Ne,Ge,Qe){"use strict";Ge.exports={colormodel:{rgb:{min:[0,0,0],max:[255,255,255],fmt:function(Ne){return Ne.slice(0,3)},suffix:["","",""]},rgba:{min:[0,0,0,0],max:[255,255,255,1],fmt:function(Ne){return Ne.slice(0,4)},suffix:["","","",""]},rgba256:{colormodel:"rgba",zminDflt:[0,0,0,0],zmaxDflt:[255,255,255,255],min:[0,0,0,0],max:[255,255,255,1],fmt:function(Ne){return Ne.slice(0,4)},suffix:["","","",""]},hsl:{min:[0,0,0],max:[360,100,100],fmt:function(Ne){var Ge=Ne.slice(0,3);return Ge[1]=Ge[1]+"%",Ge[2]=Ge[2]+"%",Ge},suffix:["Â°","%","%"]},hsla:{min:[0,0,0,0],max:[360,100,100,1],fmt:function(Ne){var Ge=Ne.slice(0,4);return Ge[1]=Ge[1]+"%",Ge[2]=Ge[2]+"%",Ge},suffix:["Â°","%","%",""]}}}},{}],1109:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./attributes"),nt=Ne("./constants"),at=Ne("../../snapshot/helpers").IMAGE_URL_PREFIX;Ge.exports=function(Ne,Ge){function coerce(Qe,nt){return tt.coerce(Ne,Ge,rt,Qe,nt)}coerce("source"),Ge.source&&!Ge.source.match(at)&&delete Ge.source,Ge._hasSource=!!Ge.source;var Qe,it=coerce("z");Ge._hasZ=!(void 0===it||!it.length||!it[0]||!it[0].length),Ge._hasZ||Ge._hasSource?(coerce("x0"),coerce("y0"),coerce("dx"),coerce("dy"),Ge._hasZ?(coerce("colormodel","rgb"),coerce("zmin",(Qe=nt.colormodel[Ge.colormodel]).zminDflt||Qe.min),coerce("zmax",Qe.zmaxDflt||Qe.max)):Ge._hasSource&&(Ge.colormodel="rgba256",Qe=nt.colormodel[Ge.colormodel],Ge.zmin=Qe.zminDflt,Ge.zmax=Qe.zmaxDflt),coerce("text"),coerce("hovertext"),coerce("hovertemplate"),Ge._length=null):Ge.visible=!1}},{"../../lib":778,"../../snapshot/helpers":915,"./attributes":1106,"./constants":1108}],1110:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge){return"xVal"in Ge&&(Ne.x=Ge.xVal),"yVal"in Ge&&(Ne.y=Ge.yVal),Ge.xa&&(Ne.xaxis=Ge.xa),Ge.ya&&(Ne.yaxis=Ge.ya),Ne.color=Ge.color,Ne.colormodel=Ge.trace.colormodel,Ne.z||(Ne.z=Ge.color),Ne}},{}],1111:[function(Ne,Ge,Qe){"use strict";var tt=Ne("image-size"),rt=Ne("../../snapshot/helpers").IMAGE_URL_PREFIX,nt=Ne("buffer/").Buffer;Qe.getImageSize=function(Ne){var Ge=Ne.replace(rt,""),Qe=new nt(Ge,"base64");return tt(Qe)}},{"../../snapshot/helpers":915,"buffer/":111,"image-size":444}],1112:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/fx"),rt=Ne("../../lib"),nt=Ne("./constants");Ge.exports=function(Ne,Ge,Qe){var at=Ne.cd[0],it=at.trace,ot=Ne.xa,dt=Ne.ya;if(!(tt.inbox(Ge-at.x0,Ge-(at.x0+at.w*it.dx),0)>0||tt.inbox(Qe-at.y0,Qe-(at.y0+at.h*it.dy),0)>0)){var ht,Dt=Math.floor((Ge-at.x0)/it.dx),Ot=Math.floor(Math.abs(Qe-at.y0)/it.dy);if(it._hasZ?ht=at.z[Ot][Dt]:it._hasSource&&(ht=it._canvas.el.getContext("2d").getImageData(Dt,Ot,1,1).data),ht){var Rt,Zt=at.hi||it.hoverinfo;if(Zt){var er=Zt.split("+");-1!==er.indexOf("all")&&(er=["color"]),-1!==er.indexOf("color")&&(Rt=!0)}var dr,mr=nt.colormodel[it.colormodel],xr=mr.colormodel||it.colormodel,br=xr.length,Ar=it._scaler(ht),en=mr.suffix,mn=[];(it.hovertemplate||Rt)&&(mn.push("["+[Ar[0]+en[0],Ar[1]+en[1],Ar[2]+en[2]].join(", ")),4===br&&mn.push(", "+Ar[3]+en[3]),mn.push("]"),mn=mn.join(""),Ne.extraText=xr.toUpperCase()+": "+mn),Array.isArray(it.hovertext)&&Array.isArray(it.hovertext[Ot])?dr=it.hovertext[Ot][Dt]:Array.isArray(it.text)&&Array.isArray(it.text[Ot])&&(dr=it.text[Ot][Dt]);var xn=dt.c2p(at.y0+(Ot+.5)*it.dy),kn=at.x0+(Dt+.5)*it.dx,Cn=at.y0+(Ot+.5)*it.dy,En="["+ht.slice(0,it.colormodel.length).join(", ")+"]";return[rt.extendFlat(Ne,{index:[Ot,Dt],x0:ot.c2p(at.x0+Dt*it.dx),x1:ot.c2p(at.x0+(Dt+1)*it.dx),y0:xn,y1:xn,color:Ar,xVal:kn,xLabelVal:kn,yVal:Cn,yLabelVal:Cn,zLabelVal:En,text:dr,hovertemplateLabels:{zLabel:En,colorLabel:mn,"color[0]Label":Ar[0]+en[0],"color[1]Label":Ar[1]+en[1],"color[2]Label":Ar[2]+en[2],"color[3]Label":Ar[3]+en[3]}})]}}}},{"../../components/fx":683,"../../lib":778,"./constants":1108}],1113:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),calc:Ne("./calc"),plot:Ne("./plot"),style:Ne("./style"),hoverPoints:Ne("./hover"),eventData:Ne("./event_data"),moduleType:"trace",name:"image",basePlotModule:Ne("../../plots/cartesian"),categories:["cartesian","svg","2dMap","noSortingByValue"],animatable:!1,meta:{}}},{"../../plots/cartesian":841,"./attributes":1106,"./calc":1107,"./defaults":1109,"./event_data":1110,"./hover":1112,"./plot":1114,"./style":1115}],1114:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../lib"),nt=rt.strTranslate,at=Ne("../../constants/xmlns_namespaces"),it=Ne("./constants"),ot=rt.isIOS()||rt.isSafari()||rt.isIE();Ge.exports=function(Ne,Ge,Qe,dt){var ht=Ge.xaxis,Dt=Ge.yaxis,Ot=!(ot||Ne._context._exportedPlot);rt.makeTraceGroups(dt,Qe,"im").each((function(Ge){var Qe=tt.select(this),ot=Ge[0],dt=ot.trace,Rt=Ot&&!dt._hasZ&&dt._hasSource&&"linear"===ht.type&&"linear"===Dt.type;dt._fastImage=Rt;var Zt,er,dr,mr,xr,br,Ar=ot.z,en=ot.x0,mn=ot.y0,xn=ot.w,kn=ot.h,Cn=dt.dx,En=dt.dy;for(br=0;void 0===Zt&&br<xn;)Zt=ht.c2p(en+br*Cn),br++;for(br=xn;void 0===er&&br>0;)er=ht.c2p(en+br*Cn),br--;for(br=0;void 0===mr&&br<kn;)mr=Dt.c2p(mn+br*En),br++;for(br=kn;void 0===xr&&br>0;)xr=Dt.c2p(mn+br*En),br--;if(er<Zt&&(dr=er,er=Zt,Zt=dr),xr<mr&&(dr=mr,mr=xr,xr=dr),!Rt){var Pn=.5;Zt=Math.max(-Pn*ht._length,Zt),er=Math.min((1+Pn)*ht._length,er),mr=Math.max(-Pn*Dt._length,mr),xr=Math.min((1+Pn)*Dt._length,xr)}var Dn=Math.round(er-Zt),In=Math.round(xr-mr);if(Dn<=0||In<=0)Qe.selectAll("image").data([]).exit().remove();else{var zn=Qe.selectAll("image").data([Ge]);zn.enter().append("svg:image").attr({xmlns:at.svg,preserveAspectRatio:"none"}),zn.exit().remove();var Bn="image-rendering: optimizeSpeed; image-rendering: -moz-crisp-edges; image-rendering: -o-crisp-edges; image-rendering: -webkit-optimize-contrast; image-rendering: optimize-contrast; image-rendering: crisp-edges; image-rendering: pixelated;";if(Rt){var Vn=rt.simpleMap(ht.range,ht.r2l),Hn=rt.simpleMap(Dt.range,Dt.r2l),qn=Vn[1]<Vn[0],Yn=Hn[1]>Hn[0];if(qn||Yn){var $n=Zt+Dn/2,ra=mr+In/2;Bn+="transform:"+nt($n+"px",ra+"px")+"scale("+(qn?-1:1)+","+(Yn?-1:1)+")"+nt(-$n+"px",-ra+"px")+";"}}zn.attr("style",Bn);var oa=new Promise((function(Ne){if(dt._hasZ)Ne();else if(dt._hasSource)if(dt._canvas&&dt._canvas.el.width===xn&&dt._canvas.el.height===kn&&dt._canvas.source===dt.source)Ne();else{var Ge=document.createElement("canvas");Ge.width=xn,Ge.height=kn;var Qe=Ge.getContext("2d");dt._image=dt._image||new Image;var tt=dt._image;tt.onload=function(){Qe.drawImage(tt,0,0),dt._canvas={el:Ge,source:dt.source},Ne()},tt.setAttribute("src",dt.source)}})).then((function(){var Ne,Ge;if(dt._hasZ)Ge=drawMagnifiedPixelsOnCanvas((function(Ne,Ge){return Ar[Ge][Ne]})),Ne=Ge.toDataURL("image/png");else if(dt._hasSource)if(Rt)Ne=dt.source;else{var Qe=dt._canvas.el.getContext("2d").getImageData(0,0,xn,kn).data;Ge=drawMagnifiedPixelsOnCanvas((function(Ne,Ge){var tt=4*(Ge*xn+Ne);return[Qe[tt],Qe[tt+1],Qe[tt+2],Qe[tt+3]]})),Ne=Ge.toDataURL("image/png")}zn.attr({"xlink:href":Ne,height:In,width:Dn,x:Zt,y:mr})}));Ne._promises.push(oa)}function drawMagnifiedPixelsOnCanvas(Ne){var Ge=document.createElement("canvas");Ge.width=Dn,Ge.height=In;var Qe,tt=Ge.getContext("2d"),ipx=function(Ne){return rt.constrain(Math.round(ht.c2p(en+Ne*Cn)-Zt),0,Dn)},jpx=function(Ne){return rt.constrain(Math.round(Dt.c2p(mn+Ne*En)-mr),0,In)},nt=it.colormodel[dt.colormodel],at=nt.colormodel||dt.colormodel,Ot=nt.fmt;for(br=0;br<ot.w;br++){var Rt=ipx(br),er=ipx(br+1);if(er!==Rt&&!isNaN(er)&&!isNaN(Rt))for(var dr=0;dr<ot.h;dr++){var xr=jpx(dr),Ar=jpx(dr+1);Ar===xr||isNaN(Ar)||isNaN(xr)||!Ne(br,dr)||(Qe=dt._scaler(Ne(br,dr)),tt.fillStyle=Qe?at+"("+Ot(Qe).join(",")+")":"rgba(0,0,0,0)",tt.fillRect(Rt,xr,er-Rt,Ar-xr))}}return Ge}}))}},{"../../constants/xmlns_namespaces":754,"../../lib":778,"./constants":1108,d3:169}],1115:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3");Ge.exports=function(Ne){tt.select(Ne).selectAll(".im image").style("opacity",(function(Ne){return Ne[0].trace.opacity}))}},{d3:169}],1116:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib/extend").extendFlat,rt=Ne("../../lib/extend").extendDeep,nt=Ne("../../plot_api/edit_types").overrideAll,at=Ne("../../plots/font_attributes"),it=Ne("../../components/color/attributes"),ot=Ne("../../plots/domain").attributes,dt=Ne("../../plots/cartesian/layout_attributes"),ht=Ne("../../plot_api/plot_template").templatedArray,Dt=Ne("../../constants/delta.js"),Ot=(Ne("../../constants/docs").FORMAT_LINK,at({editType:"plot",colorEditType:"plot"})),Rt={color:{valType:"color",editType:"plot"},line:{color:{valType:"color",dflt:it.defaultLine,editType:"plot"},width:{valType:"number",min:0,dflt:0,editType:"plot"},editType:"calc"},thickness:{valType:"number",min:0,max:1,dflt:1,editType:"plot"},editType:"calc"},Zt={valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},er=ht("step",rt({},Rt,{range:Zt}));Ge.exports={mode:{valType:"flaglist",editType:"calc",flags:["number","delta","gauge"],dflt:"number"},value:{valType:"number",editType:"calc",anim:!0},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},domain:ot({name:"indicator",trace:!0,editType:"calc"}),title:{text:{valType:"string",editType:"plot"},align:{valType:"enumerated",values:["left","center","right"],editType:"plot"},font:tt({},Ot,{}),editType:"plot"},number:{valueformat:{valType:"string",dflt:"",editType:"plot"},font:tt({},Ot,{}),prefix:{valType:"string",dflt:"",editType:"plot"},suffix:{valType:"string",dflt:"",editType:"plot"},editType:"plot"},delta:{reference:{valType:"number",editType:"calc"},position:{valType:"enumerated",values:["top","bottom","left","right"],dflt:"bottom",editType:"plot"},relative:{valType:"boolean",editType:"plot",dflt:!1},valueformat:{valType:"string",editType:"plot"},increasing:{symbol:{valType:"string",dflt:Dt.INCREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:Dt.INCREASING.COLOR,editType:"plot"},editType:"plot"},decreasing:{symbol:{valType:"string",dflt:Dt.DECREASING.SYMBOL,editType:"plot"},color:{valType:"color",dflt:Dt.DECREASING.COLOR,editType:"plot"},editType:"plot"},font:tt({},Ot,{}),editType:"calc"},gauge:{shape:{valType:"enumerated",editType:"plot",dflt:"angular",values:["angular","bullet"]},bar:rt({},Rt,{color:{dflt:"green"}}),bgcolor:{valType:"color",editType:"plot"},bordercolor:{valType:"color",dflt:it.defaultLine,editType:"plot"},borderwidth:{valType:"number",min:0,dflt:1,editType:"plot"},axis:nt({range:Zt,visible:tt({},dt.visible,{dflt:!0}),tickmode:dt.tickmode,nticks:dt.nticks,tick0:dt.tick0,dtick:dt.dtick,tickvals:dt.tickvals,ticktext:dt.ticktext,ticks:tt({},dt.ticks,{dflt:"outside"}),ticklen:dt.ticklen,tickwidth:dt.tickwidth,tickcolor:dt.tickcolor,showticklabels:dt.showticklabels,tickfont:at({}),tickangle:dt.tickangle,tickformat:dt.tickformat,tickformatstops:dt.tickformatstops,tickprefix:dt.tickprefix,showtickprefix:dt.showtickprefix,ticksuffix:dt.ticksuffix,showticksuffix:dt.showticksuffix,separatethousands:dt.separatethousands,exponentformat:dt.exponentformat,minexponent:dt.minexponent,showexponent:dt.showexponent,editType:"plot"},"plot"),steps:er,threshold:{line:{color:tt({},Rt.line.color,{}),width:tt({},Rt.line.width,{dflt:1}),editType:"plot"},thickness:tt({},Rt.thickness,{dflt:.85}),value:{valType:"number",editType:"calc",dflt:!1},editType:"plot"},editType:"plot"}}},{"../../components/color/attributes":642,"../../constants/delta.js":747,"../../constants/docs":748,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plot_api/plot_template":817,"../../plots/cartesian/layout_attributes":842,"../../plots/domain":855,"../../plots/font_attributes":856}],1117:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/plots");Qe.name="indicator",Qe.plot=function(Ne,Ge,rt,nt){tt.plotBasePlot(Qe.name,Ne,Ge,rt,nt)},Qe.clean=function(Ne,Ge,rt,nt){tt.cleanBasePlot(Qe.name,Ne,Ge,rt,nt)}},{"../../plots/plots":891}],1118:[function(Ne,Ge,Qe){"use strict";function calc(Ne,Ge){var Qe=[],tt=Ge.value;"number"!=typeof Ge._lastValue&&(Ge._lastValue=Ge.value);var rt=Ge._lastValue,nt=rt;return Ge._hasDelta&&"number"==typeof Ge.delta.reference&&(nt=Ge.delta.reference),Qe[0]={y:tt,lastY:rt,delta:tt-nt,relativeDelta:(tt-nt)/nt},Qe}Ge.exports={calc:calc}},{}],1119:[function(Ne,Ge,Qe){"use strict";Ge.exports={defaultNumberFontSize:80,bulletNumberDomainSize:.25,bulletPadding:.025,innerRadius:.75,valueThickness:.5,titlePadding:5,horizontalPadding:10}},{}],1120:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./attributes"),nt=Ne("../../plots/domain").defaults,at=Ne("../../plot_api/plot_template"),it=Ne("../../plots/array_container_defaults"),ot=Ne("./constants.js"),dt=Ne("../../plots/cartesian/tick_value_defaults"),ht=Ne("../../plots/cartesian/tick_mark_defaults"),Dt=Ne("../../plots/cartesian/tick_label_defaults");function supplyDefaults(Ne,Ge,Qe,Ot){function coerce(Qe,nt){return tt.coerce(Ne,Ge,rt,Qe,nt)}nt(Ge,Ot,coerce),coerce("mode"),Ge._hasNumber=-1!==Ge.mode.indexOf("number"),Ge._hasDelta=-1!==Ge.mode.indexOf("delta"),Ge._hasGauge=-1!==Ge.mode.indexOf("gauge");var Rt=coerce("value");Ge._range=[0,"number"==typeof Rt?1.5*Rt:1];var Zt,er,dr,mr,xr,br,Ar=new Array(2);function coerceGauge(Ne,Ge){return tt.coerce(dr,mr,rt.gauge,Ne,Ge)}function coerceGaugeAxis(Ne,Ge){return tt.coerce(xr,br,rt.gauge.axis,Ne,Ge)}if(Ge._hasNumber&&(coerce("number.valueformat"),coerce("number.font.color",Ot.font.color),coerce("number.font.family",Ot.font.family),coerce("number.font.size"),void 0===Ge.number.font.size&&(Ge.number.font.size=ot.defaultNumberFontSize,Ar[0]=!0),coerce("number.prefix"),coerce("number.suffix"),Zt=Ge.number.font.size),Ge._hasDelta&&(coerce("delta.font.color",Ot.font.color),coerce("delta.font.family",Ot.font.family),coerce("delta.font.size"),void 0===Ge.delta.font.size&&(Ge.delta.font.size=(Ge._hasNumber?.5:1)*(Zt||ot.defaultNumberFontSize),Ar[1]=!0),coerce("delta.reference",Ge.value),coerce("delta.relative"),coerce("delta.valueformat",Ge.delta.relative?"2%":""),coerce("delta.increasing.symbol"),coerce("delta.increasing.color"),coerce("delta.decreasing.symbol"),coerce("delta.decreasing.color"),coerce("delta.position"),er=Ge.delta.font.size),Ge._scaleNumbers=(!Ge._hasNumber||Ar[0])&&(!Ge._hasDelta||Ar[1])||!1,coerce("title.font.color",Ot.font.color),coerce("title.font.family",Ot.font.family),coerce("title.font.size",.25*(Zt||er||ot.defaultNumberFontSize)),coerce("title.text"),Ge._hasGauge){(dr=Ne.gauge)||(dr={}),mr=at.newContainer(Ge,"gauge"),coerceGauge("shape"),(Ge._isBullet="bullet"===Ge.gauge.shape)||coerce("title.align","center"),(Ge._isAngular="angular"===Ge.gauge.shape)||coerce("align","center"),coerceGauge("bgcolor",Ot.paper_bgcolor),coerceGauge("borderwidth"),coerceGauge("bordercolor"),coerceGauge("bar.color"),coerceGauge("bar.line.color"),coerceGauge("bar.line.width"),coerceGauge("bar.thickness",ot.valueThickness*("bullet"===Ge.gauge.shape?.5:1)),it(dr,mr,{name:"steps",handleItemDefaults:stepDefaults}),coerceGauge("threshold.value"),coerceGauge("threshold.thickness"),coerceGauge("threshold.line.width"),coerceGauge("threshold.line.color"),xr={},dr&&(xr=dr.axis||{}),br=at.newContainer(mr,"axis"),coerceGaugeAxis("visible"),Ge._range=coerceGaugeAxis("range",Ge._range);var en={outerTicks:!0};dt(xr,br,coerceGaugeAxis,"linear"),Dt(xr,br,coerceGaugeAxis,"linear",en),ht(xr,br,coerceGaugeAxis,en)}else coerce("title.align","center"),coerce("align","center"),Ge._isAngular=Ge._isBullet=!1;Ge._length=null}function stepDefaults(Ne,Ge){function coerce(Qe,nt){return tt.coerce(Ne,Ge,rt.gauge.steps,Qe,nt)}coerce("color"),coerce("line.color"),coerce("line.width"),coerce("range"),coerce("thickness")}Ge.exports={supplyDefaults:supplyDefaults}},{"../../lib":778,"../../plot_api/plot_template":817,"../../plots/array_container_defaults":823,"../../plots/cartesian/tick_label_defaults":849,"../../plots/cartesian/tick_mark_defaults":850,"../../plots/cartesian/tick_value_defaults":851,"../../plots/domain":855,"./attributes":1116,"./constants.js":1119}],1121:[function(Ne,Ge,Qe){"use strict";Ge.exports={moduleType:"trace",name:"indicator",basePlotModule:Ne("./base_plot"),categories:["svg","noOpacity","noHover"],animatable:!0,attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults").supplyDefaults,calc:Ne("./calc").calc,plot:Ne("./plot"),meta:{}}},{"./attributes":1116,"./base_plot":1117,"./calc":1118,"./defaults":1120,"./plot":1122}],1122:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../lib"),nt=rt.strScale,at=rt.strTranslate,it=rt.rad2deg,ot=Ne("../../constants/alignment").MID_SHIFT,dt=Ne("../../components/drawing"),ht=Ne("./constants"),Dt=Ne("../../lib/svg_text_utils"),Ot=Ne("../../plots/cartesian/axes"),Rt=Ne("../../plots/cartesian/axis_defaults"),Zt=Ne("../../plots/cartesian/position_defaults"),er=Ne("../../plots/cartesian/layout_attributes"),dr=Ne("../../components/color"),mr={left:"start",center:"middle",right:"end"},xr={left:0,center:.5,right:1},br=/[yzafpnÂµmkMGTPEZY]/;function hasTransition(Ne){return Ne&&Ne.duration>0}function drawBulletGauge(Ne,Ge,Qe,tt){var rt,nt,it,ot,dt,Dt=Qe[0].trace,Rt=tt.gauge,Zt=tt.layer,er=tt.gaugeBg,mr=tt.gaugeOutline,xr=tt.size,br=Dt.domain,Ar=tt.transitionOpts,en=tt.onComplete;Rt.enter().append("g").classed("bullet",!0),Rt.attr("transform",at(xr.l,xr.t)),Zt.enter().append("g").classed("bulletaxis",!0).classed("crisp",!0),Zt.selectAll("g.xbulletaxistick,path,text").remove();var mn=xr.h,xn=Dt.gauge.bar.thickness*mn,kn=br.x[0],Cn=br.x[0]+(br.x[1]-br.x[0])*(Dt._hasNumber||Dt._hasDelta?1-ht.bulletNumberDomainSize:1);function drawRect(Ne){Ne.attr("width",(function(Ne){return Math.max(0,rt.c2p(Ne.range[1])-rt.c2p(Ne.range[0]))})).attr("x",(function(Ne){return rt.c2p(Ne.range[0])})).attr("y",(function(Ne){return.5*(1-Ne.thickness)*mn})).attr("height",(function(Ne){return Ne.thickness*mn}))}(rt=mockAxis(Ne,Dt.gauge.axis))._id="xbulletaxis",rt.domain=[kn,Cn],rt.setScale(),nt=Ot.calcTicks(rt),it=Ot.makeTransTickFn(rt),ot=Ot.getTickSigns(rt)[2],dt=xr.t+xr.h,rt.visible&&(Ot.drawTicks(Ne,rt,{vals:"inside"===rt.ticks?Ot.clipEnds(rt,nt):nt,layer:Zt,path:Ot.makeTickPath(rt,dt,ot),transFn:it}),Ot.drawLabels(Ne,rt,{vals:nt,layer:Zt,transFn:it,labelFns:Ot.makeLabelFns(rt,dt)}));var En=[er].concat(Dt.gauge.steps),Pn=Rt.selectAll("g.bg-bullet").data(En);Pn.enter().append("g").classed("bg-bullet",!0).append("rect"),Pn.select("rect").call(drawRect).call(styleShape),Pn.exit().remove();var Dn=Rt.selectAll("g.value-bullet").data([Dt.gauge.bar]);Dn.enter().append("g").classed("value-bullet",!0).append("rect"),Dn.select("rect").attr("height",xn).attr("y",(mn-xn)/2).call(styleShape),hasTransition(Ar)?Dn.select("rect").transition().duration(Ar.duration).ease(Ar.easing).each("end",(function(){en&&en()})).each("interrupt",(function(){en&&en()})).attr("width",Math.max(0,rt.c2p(Math.min(Dt.gauge.axis.range[1],Qe[0].y)))):Dn.select("rect").attr("width","number"==typeof Qe[0].y?Math.max(0,rt.c2p(Math.min(Dt.gauge.axis.range[1],Qe[0].y))):0),Dn.exit().remove();var In=Qe.filter((function(){return Dt.gauge.threshold.value})),zn=Rt.selectAll("g.threshold-bullet").data(In);zn.enter().append("g").classed("threshold-bullet",!0).append("line"),zn.select("line").attr("x1",rt.c2p(Dt.gauge.threshold.value)).attr("x2",rt.c2p(Dt.gauge.threshold.value)).attr("y1",(1-Dt.gauge.threshold.thickness)/2*mn).attr("y2",(1-(1-Dt.gauge.threshold.thickness)/2)*mn).call(dr.stroke,Dt.gauge.threshold.line.color).style("stroke-width",Dt.gauge.threshold.line.width),zn.exit().remove();var Bn=Rt.selectAll("g.gauge-outline").data([mr]);Bn.enter().append("g").classed("gauge-outline",!0).append("rect"),Bn.select("rect").call(drawRect).call(styleShape),Bn.exit().remove()}function drawAngularGauge(Ne,Ge,Qe,rt){var nt,dt,ht,Dt,Rt=Qe[0].trace,Zt=rt.size,er=rt.radius,dr=rt.innerRadius,mr=rt.gaugeBg,xr=rt.gaugeOutline,br=[Zt.l+Zt.w/2,Zt.t+Zt.h/2+er/2],Ar=rt.gauge,en=rt.layer,mn=rt.transitionOpts,xn=rt.onComplete,kn=Math.PI/2;function valueToAngle(Ne){var Ge=Rt.gauge.axis.range[0],Qe=(Ne-Ge)/(Rt.gauge.axis.range[1]-Ge)*Math.PI-kn;return Qe<-kn?-kn:Qe>kn?kn:Qe}function arcPathGenerator(Ne){return tt.svg.arc().innerRadius((dr+er)/2-Ne/2*(er-dr)).outerRadius((dr+er)/2+Ne/2*(er-dr)).startAngle(-kn)}function drawArc(Ne){Ne.attr("d",(function(Ne){return arcPathGenerator(Ne.thickness).startAngle(valueToAngle(Ne.range[0])).endAngle(valueToAngle(Ne.range[1]))()}))}Ar.enter().append("g").classed("angular",!0),Ar.attr("transform",at(br[0],br[1])),en.enter().append("g").classed("angularaxis",!0).classed("crisp",!0),en.selectAll("g.xangularaxistick,path,text").remove(),(nt=mockAxis(Ne,Rt.gauge.axis)).type="linear",nt.range=Rt.gauge.axis.range,nt._id="xangularaxis",nt.setScale();var t2g=function(Ne){return(nt.range[0]-Ne.x)/(nt.range[1]-nt.range[0])*Math.PI+Math.PI},Cn={},En=Ot.makeLabelFns(nt,0).labelStandoff;Cn.xFn=function(Ne){var Ge=t2g(Ne);return Math.cos(Ge)*En},Cn.yFn=function(Ne){var Ge=t2g(Ne),Qe=Math.sin(Ge)>0?.2:1;return-Math.sin(Ge)*(En+Ne.fontSize*Qe)+Math.abs(Math.cos(Ge))*(Ne.fontSize*ot)},Cn.anchorFn=function(Ne){var Ge=t2g(Ne),Qe=Math.cos(Ge);return Math.abs(Qe)<.1?"middle":Qe>0?"start":"end"},Cn.heightFn=function(Ne,Ge,Qe){var tt=t2g(Ne);return-.5*(1+Math.sin(tt))*Qe};var _transFn=function(Ne){return at(br[0]+er*Math.cos(Ne),br[1]-er*Math.sin(Ne))};ht=function(Ne){return _transFn(t2g(Ne))};var transFn2=function(Ne){var Ge=t2g(Ne);return _transFn(Ge)+"rotate("+-it(Ge)+")"};if(dt=Ot.calcTicks(nt),Dt=Ot.getTickSigns(nt)[2],nt.visible){Dt="inside"===nt.ticks?-1:1;var Pn=(nt.linewidth||1)/2;Ot.drawTicks(Ne,nt,{vals:dt,layer:en,path:"M"+Dt*Pn+",0h"+Dt*nt.ticklen,transFn:transFn2}),Ot.drawLabels(Ne,nt,{vals:dt,layer:en,transFn:ht,labelFns:Cn})}var Dn=[mr].concat(Rt.gauge.steps),In=Ar.selectAll("g.bg-arc").data(Dn);In.enter().append("g").classed("bg-arc",!0).append("path"),In.select("path").call(drawArc).call(styleShape),In.exit().remove();var zn=arcPathGenerator(Rt.gauge.bar.thickness),Bn=Ar.selectAll("g.value-arc").data([Rt.gauge.bar]);Bn.enter().append("g").classed("value-arc",!0).append("path");var Vn=Bn.select("path");hasTransition(mn)?(Vn.transition().duration(mn.duration).ease(mn.easing).each("end",(function(){xn&&xn()})).each("interrupt",(function(){xn&&xn()})).attrTween("d",arcTween(zn,valueToAngle(Qe[0].lastY),valueToAngle(Qe[0].y))),Rt._lastValue=Qe[0].y):Vn.attr("d","number"==typeof Qe[0].y?zn.endAngle(valueToAngle(Qe[0].y)):"M0,0Z"),Vn.call(styleShape),Bn.exit().remove(),Dn=[];var Hn=Rt.gauge.threshold.value;Hn&&Dn.push({range:[Hn,Hn],color:Rt.gauge.threshold.color,line:{color:Rt.gauge.threshold.line.color,width:Rt.gauge.threshold.line.width},thickness:Rt.gauge.threshold.thickness});var qn=Ar.selectAll("g.threshold-arc").data(Dn);qn.enter().append("g").classed("threshold-arc",!0).append("path"),qn.select("path").call(drawArc).call(styleShape),qn.exit().remove();var Yn=Ar.selectAll("g.gauge-outline").data([xr]);Yn.enter().append("g").classed("gauge-outline",!0).append("path"),Yn.select("path").call(drawArc).call(styleShape),Yn.exit().remove()}function drawNumbers(Ne,Ge,Qe,it){var ot,ht,Rt,Zt=Qe[0].trace,er=it.numbersX,Ar=it.numbersY,en=Zt.align||"center",mn=mr[en],xn=it.transitionOpts,kn=it.onComplete,Cn=rt.ensureSingle(Ge,"g","numbers"),En=[];Zt._hasNumber&&En.push("number"),Zt._hasDelta&&(En.push("delta"),"left"===Zt.delta.position&&En.reverse());var Pn=Cn.selectAll("text").data(En);function transitionFormat(Ge,Qe,tt,rt){if(!Ge.match("s")||tt>=0==rt>=0||Qe(tt).slice(-1).match(br)||Qe(rt).slice(-1).match(br))return Qe;var nt=Ge.slice().replace("s","f").replace(/\d+/,(function(Ne){return parseInt(Ne)-1})),at=mockAxis(Ne,{tickformat:nt});return function(Ne){return Math.abs(Ne)<1?Ot.tickText(at,Ne).text:Qe(Ne)}}function drawBignumber(){var Ge=mockAxis(Ne,{tickformat:Zt.number.valueformat},Zt._range);Ge.setScale(),Ot.prepTicks(Ge);var fmt=function(Ne){return Ot.tickText(Ge,Ne).text},rt=Zt.number.suffix,nt=Zt.number.prefix,at=Cn.select("text.number");function writeNumber(){var Ge="number"==typeof Qe[0].y?nt+fmt(Qe[0].y)+rt:"-";at.text(Ge).call(dt.font,Zt.number.font).call(Dt.convertToTspans,Ne)}return hasTransition(xn)?at.transition().duration(xn.duration).ease(xn.easing).each("end",(function(){writeNumber(),kn&&kn()})).each("interrupt",(function(){writeNumber(),kn&&kn()})).attrTween("text",(function(){var Ne=tt.select(this),Ge=tt.interpolateNumber(Qe[0].lastY,Qe[0].y);Zt._lastValue=Qe[0].y;var at=transitionFormat(Zt.number.valueformat,fmt,Qe[0].lastY,Qe[0].y);return function(Qe){Ne.text(nt+at(Ge(Qe))+rt)}})):writeNumber(),ot=measureText(nt+fmt(Qe[0].y)+rt,Zt.number.font,mn,Ne),at}function drawDelta(){var Ge=mockAxis(Ne,{tickformat:Zt.delta.valueformat},Zt._range);Ge.setScale(),Ot.prepTicks(Ge);var deltaFmt=function(Ne){return Ot.tickText(Ge,Ne).text},deltaValue=function(Ne){return Zt.delta.relative?Ne.relativeDelta:Ne.delta},deltaFormatText=function(Ne,Ge){return 0===Ne||"number"!=typeof Ne||isNaN(Ne)?"-":(Ne>0?Zt.delta.increasing.symbol:Zt.delta.decreasing.symbol)+Ge(Ne)},deltaFill=function(Ne){return Ne.delta>=0?Zt.delta.increasing.color:Zt.delta.decreasing.color};void 0===Zt._deltaLastValue&&(Zt._deltaLastValue=deltaValue(Qe[0]));var rt=Cn.select("text.delta");function writeDelta(){rt.text(deltaFormatText(deltaValue(Qe[0]),deltaFmt)).call(dr.fill,deltaFill(Qe[0])).call(Dt.convertToTspans,Ne)}return rt.call(dt.font,Zt.delta.font).call(dr.fill,deltaFill({delta:Zt._deltaLastValue})),hasTransition(xn)?rt.transition().duration(xn.duration).ease(xn.easing).tween("text",(function(){var Ne=tt.select(this),Ge=deltaValue(Qe[0]),rt=Zt._deltaLastValue,nt=transitionFormat(Zt.delta.valueformat,deltaFmt,rt,Ge),at=tt.interpolateNumber(rt,Ge);return Zt._deltaLastValue=Ge,function(Ge){Ne.text(deltaFormatText(at(Ge),nt)),Ne.call(dr.fill,deltaFill({delta:at(Ge)}))}})).each("end",(function(){writeDelta(),kn&&kn()})).each("interrupt",(function(){writeDelta(),kn&&kn()})):writeDelta(),ht=measureText(deltaFormatText(deltaValue(Qe[0]),deltaFmt),Zt.delta.font,mn,Ne),rt}Pn.enter().append("text"),Pn.attr("text-anchor",(function(){return mn})).attr("class",(function(Ne){return Ne})).attr("x",null).attr("y",null).attr("dx",null).attr("dy",null),Pn.exit().remove();var Dn,In=Zt.mode+Zt.align;if(Zt._hasDelta&&(Dn=drawDelta(),In+=Zt.delta.position+Zt.delta.font.size+Zt.delta.font.family+Zt.delta.valueformat,In+=Zt.delta.increasing.symbol+Zt.delta.decreasing.symbol,Rt=ht),Zt._hasNumber&&(drawBignumber(),In+=Zt.number.font.size+Zt.number.font.family+Zt.number.valueformat+Zt.number.suffix+Zt.number.prefix,Rt=ot),Zt._hasDelta&&Zt._hasNumber){var zn,Bn,Vn=[(ot.left+ot.right)/2,(ot.top+ot.bottom)/2],Hn=[(ht.left+ht.right)/2,(ht.top+ht.bottom)/2],qn=.75*Zt.delta.font.size;"left"===Zt.delta.position&&(zn=cache(Zt,"deltaPos",0,-1*(ot.width*xr[Zt.align]+ht.width*(1-xr[Zt.align])+qn),In,Math.min),Bn=Vn[1]-Hn[1],Rt={width:ot.width+ht.width+qn,height:Math.max(ot.height,ht.height),left:ht.left+zn,right:ot.right,top:Math.min(ot.top,ht.top+Bn),bottom:Math.max(ot.bottom,ht.bottom+Bn)}),"right"===Zt.delta.position&&(zn=cache(Zt,"deltaPos",0,ot.width*(1-xr[Zt.align])+ht.width*xr[Zt.align]+qn,In,Math.max),Bn=Vn[1]-Hn[1],Rt={width:ot.width+ht.width+qn,height:Math.max(ot.height,ht.height),left:ot.left,right:ht.right+zn,top:Math.min(ot.top,ht.top+Bn),bottom:Math.max(ot.bottom,ht.bottom+Bn)}),"bottom"===Zt.delta.position&&(zn=null,Bn=ht.height,Rt={width:Math.max(ot.width,ht.width),height:ot.height+ht.height,left:Math.min(ot.left,ht.left),right:Math.max(ot.right,ht.right),top:ot.bottom-ot.height,bottom:ot.bottom+ht.height}),"top"===Zt.delta.position&&(zn=null,Bn=ot.top,Rt={width:Math.max(ot.width,ht.width),height:ot.height+ht.height,left:Math.min(ot.left,ht.left),right:Math.max(ot.right,ht.right),top:ot.bottom-ot.height-ht.height,bottom:ot.bottom}),Dn.attr({dx:zn,dy:Bn})}(Zt._hasNumber||Zt._hasDelta)&&Cn.attr("transform",(function(){var Ne=it.numbersScaler(Rt);In+=Ne[2];var Ge,Qe=cache(Zt,"numbersScale",1,Ne[0],In,Math.min);Zt._scaleNumbers||(Qe=1),Ge=Zt._isAngular?Ar-Qe*Rt.bottom:Ar-Qe*(Rt.top+Rt.bottom)/2,Zt._numbersTop=Qe*Rt.top+Ge;var tt=Rt[en];"center"===en&&(tt=(Rt.left+Rt.right)/2);var rt=er-Qe*tt;return rt=cache(Zt,"numbersTranslate",0,rt,In,Math.max),at(rt,Ge)+nt(Qe)}))}function styleShape(Ne){Ne.each((function(Ne){dr.stroke(tt.select(this),Ne.line.color)})).each((function(Ne){dr.fill(tt.select(this),Ne.color)})).style("stroke-width",(function(Ne){return Ne.line.width}))}function arcTween(Ne,Ge,Qe){return function(){var rt=tt.interpolate(Ge,Qe);return function(Ge){return Ne.endAngle(rt(Ge))()}}}function mockAxis(Ne,Ge,Qe){var tt=Ne._fullLayout,nt=rt.extendFlat({type:"linear",ticks:"outside",range:Qe,showline:!0},Ge),at={type:"linear",_id:"x"+Ge._id},it={letter:"x",font:tt.font,noHover:!0,noTickson:!0};function coerce(Ne,Ge){return rt.coerce(nt,at,er,Ne,Ge)}return Rt(nt,at,coerce,it,tt),Zt(nt,at,coerce,it),at}function fitTextInsideBox(Ne,Ge,Qe){return[Math.min(Ge/Ne.width,Qe/Ne.height),Ne,Ge+"x"+Qe]}function fitTextInsideCircle(Ne,Ge){return[Ge/Math.sqrt(Ne.width/2*(Ne.width/2)+Ne.height*Ne.height),Ne,Ge]}function measureText(Ne,Ge,Qe,rt){var nt=document.createElementNS("http://www.w3.org/2000/svg","text"),at=tt.select(nt);return at.text(Ne).attr("x",0).attr("y",0).attr("text-anchor",Qe).attr("data-unformatted",Ne).call(Dt.convertToTspans,rt).call(dt.font,Ge),dt.bBox(at.node())}function cache(Ne,Ge,Qe,tt,nt,at){var it="_cache"+Ge;Ne[it]&&Ne[it].key===nt||(Ne[it]={key:nt,value:Qe});var ot=rt.aggNums(at,null,[Ne[it].value,tt],2);return Ne[it].value=ot,ot}Ge.exports=function(Ne,Ge,Qe,nt){var it,ot=Ne._fullLayout;hasTransition(Qe)&&nt&&(it=nt()),rt.makeTraceGroups(ot._indicatorlayer,Ge,"trace").each((function(Ge){var rt,nt,Ot,Rt,Zt,er=Ge[0].trace,dr=tt.select(this),br=er._hasGauge,Ar=er._isAngular,en=er._isBullet,mn=er.domain,xn={w:ot._size.w*(mn.x[1]-mn.x[0]),h:ot._size.h*(mn.y[1]-mn.y[0]),l:ot._size.l+ot._size.w*mn.x[0],r:ot._size.r+ot._size.w*(1-mn.x[1]),t:ot._size.t+ot._size.h*(1-mn.y[1]),b:ot._size.b+ot._size.h*mn.y[0]},kn=xn.l+xn.w/2,Cn=xn.t+xn.h/2,En=Math.min(xn.w/2,xn.h),Pn=ht.innerRadius*En,Dn=er.align||"center";if(nt=Cn,br){if(Ar&&(rt=kn,nt=Cn+En/2,Ot=function(Ne){return fitTextInsideCircle(Ne,.9*Pn)}),en){var In=ht.bulletPadding,zn=1-ht.bulletNumberDomainSize+In;rt=xn.l+(zn+(1-zn)*xr[Dn])*xn.w,Ot=function(Ne){return fitTextInsideBox(Ne,(ht.bulletNumberDomainSize-In)*xn.w,xn.h)}}}else rt=xn.l+xr[Dn]*xn.w,Ot=function(Ne){return fitTextInsideBox(Ne,xn.w,xn.h)};drawNumbers(Ne,dr,Ge,{numbersX:rt,numbersY:nt,numbersScaler:Ot,transitionOpts:Qe,onComplete:it}),br&&(Rt={range:er.gauge.axis.range,color:er.gauge.bgcolor,line:{color:er.gauge.bordercolor,width:0},thickness:1},Zt={range:er.gauge.axis.range,color:"rgba(0, 0, 0, 0)",line:{color:er.gauge.bordercolor,width:er.gauge.borderwidth},thickness:1});var Bn=dr.selectAll("g.angular").data(Ar?Ge:[]);Bn.exit().remove();var Vn=dr.selectAll("g.angularaxis").data(Ar?Ge:[]);Vn.exit().remove(),Ar&&drawAngularGauge(Ne,dr,Ge,{radius:En,innerRadius:Pn,gauge:Bn,layer:Vn,size:xn,gaugeBg:Rt,gaugeOutline:Zt,transitionOpts:Qe,onComplete:it});var Hn=dr.selectAll("g.bullet").data(en?Ge:[]);Hn.exit().remove();var qn=dr.selectAll("g.bulletaxis").data(en?Ge:[]);qn.exit().remove(),en&&drawBulletGauge(Ne,dr,Ge,{gauge:Hn,layer:qn,size:xn,gaugeBg:Rt,gaugeOutline:Zt,transitionOpts:Qe,onComplete:it});var Yn=dr.selectAll("text.title").data(Ge);Yn.exit().remove(),Yn.enter().append("text").classed("title",!0),Yn.attr("text-anchor",(function(){return en?mr.right:mr[er.title.align]})).text(er.title.text).call(dt.font,er.title.font).call(Dt.convertToTspans,Ne),Yn.attr("transform",(function(){var Ne,Ge=xn.l+xn.w*xr[er.title.align],Qe=ht.titlePadding,tt=dt.bBox(Yn.node());return br?(Ar&&(Ne=er.gauge.axis.visible?dt.bBox(Vn.node()).top-Qe-tt.bottom:xn.t+xn.h/2-En/2-tt.bottom-Qe),en&&(Ne=nt-(tt.top+tt.bottom)/2,Ge=xn.l-ht.bulletPadding*xn.w)):Ne=er._numbersTop-Qe-tt.bottom,at(Ge,Ne)}))}))}},{"../../components/color":643,"../../components/drawing":665,"../../constants/alignment":745,"../../lib":778,"../../lib/svg_text_utils":803,"../../plots/cartesian/axes":828,"../../plots/cartesian/axis_defaults":830,"../../plots/cartesian/layout_attributes":842,"../../plots/cartesian/position_defaults":845,"./constants":1119,d3:169}],1123:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/colorscale/attributes"),rt=Ne("../../plots/template_attributes").hovertemplateAttrs,nt=Ne("../mesh3d/attributes"),at=Ne("../../plots/attributes"),it=Ne("../../lib/extend").extendFlat,ot=Ne("../../plot_api/edit_types").overrideAll;function makeSliceAttr(Ne){return{show:{valType:"boolean",dflt:!1},locations:{valType:"data_array",dflt:[]},fill:{valType:"number",min:0,max:1,dflt:1}}}function makeCapAttr(Ne){return{show:{valType:"boolean",dflt:!0},fill:{valType:"number",min:0,max:1,dflt:1}}}var dt=Ge.exports=ot(it({x:{valType:"data_array"},y:{valType:"data_array"},z:{valType:"data_array"},value:{valType:"data_array"},isomin:{valType:"number"},isomax:{valType:"number"},surface:{show:{valType:"boolean",dflt:!0},count:{valType:"integer",dflt:2,min:1},fill:{valType:"number",min:0,max:1,dflt:1},pattern:{valType:"flaglist",flags:["A","B","C","D","E"],extras:["all","odd","even"],dflt:"all"}},spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:.15}},slices:{x:makeSliceAttr("x"),y:makeSliceAttr("y"),z:makeSliceAttr("z")},caps:{x:makeCapAttr("x"),y:makeCapAttr("y"),z:makeCapAttr("z")},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:rt(),showlegend:it({},at.showlegend,{dflt:!1})},tt("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:nt.opacity,lightposition:nt.lightposition,lighting:nt.lighting,flatshading:nt.flatshading,contour:nt.contour,hoverinfo:it({},at.hoverinfo)}),"calc","nested");dt.flatshading.dflt=!0,dt.lighting.facenormalsepsilon.dflt=0,dt.x.editType=dt.y.editType=dt.z.editType=dt.value.editType="calc+clearAxisTypes",dt.transforms=void 0},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/attributes":824,"../../plots/template_attributes":906,"../mesh3d/attributes":1128}],1124:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/colorscale/calc"),rt=Ne("../streamtube/calc").processGrid,nt=Ne("../streamtube/calc").filter;Ge.exports=function(Ne,Ge){Ge._len=Math.min(Ge.x.length,Ge.y.length,Ge.z.length,Ge.value.length),Ge._x=nt(Ge.x,Ge._len),Ge._y=nt(Ge.y,Ge._len),Ge._z=nt(Ge.z,Ge._len),Ge._value=nt(Ge.value,Ge._len);var Qe=rt(Ge);Ge._gridFill=Qe.fill,Ge._Xs=Qe.Xs,Ge._Ys=Qe.Ys,Ge._Zs=Qe.Zs,Ge._len=Qe.len;for(var at=1/0,it=-1/0,ot=0;ot<Ge._len;ot++){var dt=Ge._value[ot];at=Math.min(at,dt),it=Math.max(it,dt)}Ge._minValues=at,Ge._maxValues=it,Ge._vMin=void 0===Ge.isomin||null===Ge.isomin?at:Ge.isomin,Ge._vMax=void 0===Ge.isomax||null===Ge.isomin?it:Ge.isomax,tt(Ne,Ge,{vals:[Ge._vMin,Ge._vMax],containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":651,"../streamtube/calc":1295}],1125:[function(Ne,Ge,Qe){"use strict";var tt=Ne("gl-mesh3d"),rt=Ne("../../lib/gl_format_color").parseColorScale,nt=Ne("../../lib/str2rgbarray"),at=Ne("../../components/colorscale").extractOpts,it=Ne("../../plots/gl3d/zip3"),findNearestOnAxis=function(Ne,Ge){for(var Qe=Ge.length-1;Qe>0;Qe--){var tt=Math.min(Ge[Qe],Ge[Qe-1]),rt=Math.max(Ge[Qe],Ge[Qe-1]);if(rt>tt&&tt<Ne&&Ne<=rt)return{id:Qe,distRatio:(rt-Ne)/(rt-tt)}}return{id:0,distRatio:0}};function IsosurfaceTrace(Ne,Ge,Qe){this.scene=Ne,this.uid=Qe,this.mesh=Ge,this.name="",this.data=null,this.showContour=!1}var ot=IsosurfaceTrace.prototype;ot.handlePick=function(Ne){if(Ne.object===this.mesh){var Ge=Ne.data.index,Qe=this.data._meshX[Ge],tt=this.data._meshY[Ge],rt=this.data._meshZ[Ge],nt=this.data._Ys.length,at=this.data._Zs.length,it=findNearestOnAxis(Qe,this.data._Xs).id,ot=findNearestOnAxis(tt,this.data._Ys).id,dt=findNearestOnAxis(rt,this.data._Zs).id,ht=Ne.index=dt+at*ot+at*nt*it;Ne.traceCoordinate=[this.data._meshX[ht],this.data._meshY[ht],this.data._meshZ[ht],this.data._value[ht]];var Dt=this.data.hovertext||this.data.text;return Array.isArray(Dt)&&void 0!==Dt[ht]?Ne.textLabel=Dt[ht]:Dt&&(Ne.textLabel=Dt),!0}},ot.update=function(Ne){var Ge=this.scene,Qe=Ge.fullSceneLayout;function toDataCoords(Ne,Ge,Qe,tt){return Ge.map((function(Ge){return Ne.d2l(Ge,0,tt)*Qe}))}this.data=generateIsoMeshes(Ne);var tt={positions:it(toDataCoords(Qe.xaxis,Ne._meshX,Ge.dataScale[0],Ne.xcalendar),toDataCoords(Qe.yaxis,Ne._meshY,Ge.dataScale[1],Ne.ycalendar),toDataCoords(Qe.zaxis,Ne._meshZ,Ge.dataScale[2],Ne.zcalendar)),cells:it(Ne._meshI,Ne._meshJ,Ne._meshK),lightPosition:[Ne.lightposition.x,Ne.lightposition.y,Ne.lightposition.z],ambient:Ne.lighting.ambient,diffuse:Ne.lighting.diffuse,specular:Ne.lighting.specular,roughness:Ne.lighting.roughness,fresnel:Ne.lighting.fresnel,vertexNormalsEpsilon:Ne.lighting.vertexnormalsepsilon,faceNormalsEpsilon:Ne.lighting.facenormalsepsilon,opacity:Ne.opacity,contourEnable:Ne.contour.show,contourColor:nt(Ne.contour.color).slice(0,3),contourWidth:Ne.contour.width,useFacetNormals:Ne.flatshading},ot=at(Ne);tt.vertexIntensity=Ne._meshIntensity,tt.vertexIntensityBounds=[ot.min,ot.max],tt.colormap=rt(Ne),this.mesh.update(tt)},ot.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()};var dt=["xyz","xzy","yxz","yzx","zxy","zyx"];function generateIsoMeshes(Ne){Ne._meshI=[],Ne._meshJ=[],Ne._meshK=[];var Ge,Qe,tt,rt,nt,at,it,ot=Ne.surface.show,ht=Ne.spaceframe.show,Dt=Ne.surface.fill,Ot=Ne.spaceframe.fill,Rt=!1,Zt=!1,er=0,dr=Ne._Xs,mr=Ne._Ys,xr=Ne._Zs,br=dr.length,Ar=mr.length,en=xr.length,mn=dt.indexOf(Ne._gridFill.replace(/-/g,"").replace(/\+/g,"")),getIndex=function(Ne,Ge,Qe){switch(mn){case 5:return Qe+en*Ge+en*Ar*Ne;case 4:return Qe+en*Ne+en*br*Ge;case 3:return Ge+Ar*Qe+Ar*en*Ne;case 2:return Ge+Ar*Ne+Ar*br*Qe;case 1:return Ne+br*Qe+br*en*Ge;default:return Ne+br*Ge+br*Ar*Qe}},xn=Ne._minValues,kn=Ne._maxValues,Cn=Ne._vMin,En=Ne._vMax;function findVertexId(Ne,Ge,it){for(var ot=at.length,dt=Qe;dt<ot;dt++)if(Ne===tt[dt]&&Ge===rt[dt]&&it===nt[dt])return dt;return-1}function beginGroup(){Qe=Ge}function emptyVertices(){tt=[],rt=[],nt=[],at=[],Ge=0,beginGroup()}function addVertex(Ne,Qe,it,ot){return tt.push(Ne),rt.push(Qe),nt.push(it),at.push(ot),++Ge-1}function addFace(Ge,Qe,tt){return Ne._meshI.push(Ge),Ne._meshJ.push(Qe),Ne._meshK.push(tt),++er-1}function getCenter(Ne,Ge,Qe){for(var tt=[],rt=0;rt<Ne.length;rt++)tt[rt]=(Ne[rt]+Ge[rt]+Qe[rt])/3;return tt}function getBetween(Ne,Ge,Qe){for(var tt=[],rt=0;rt<Ne.length;rt++)tt[rt]=Ne[rt]*(1-Qe)+Qe*Ge[rt];return tt}function setFill(Ne){it=Ne}function createOpenTri(Ne,Ge){var Qe=Ne[0],tt=Ne[1],rt=Ne[2],nt=getCenter(Qe,tt,rt),at=Math.sqrt(1-it),ot=getBetween(nt,Qe,at),dt=getBetween(nt,tt,at),ht=getBetween(nt,rt,at),Dt=Ge[0],Ot=Ge[1],Rt=Ge[2];return{xyzv:[[Qe,tt,dt],[dt,ot,Qe],[tt,rt,ht],[ht,dt,tt],[rt,Qe,ot],[ot,ht,rt]],abc:[[Dt,Ot,-1],[-1,-1,Dt],[Ot,Rt,-1],[-1,-1,Ot],[Rt,Dt,-1],[-1,-1,Rt]]}}function styleIncludes(Ne,Ge){return"all"===Ne||null===Ne||Ne.indexOf(Ge)>-1}function mapValue(Ne,Ge){return null===Ne?Ge:Ne}function drawTri(Ne,Ge,Qe){beginGroup();var tt=[Ge],rt=[Qe];if(it>=1)tt=[Ge],rt=[Qe];else if(it>0){var nt=createOpenTri(Ge,Qe);tt=nt.xyzv,rt=nt.abc}for(var at=0;at<tt.length;at++){Ge=tt[at],Qe=rt[at];for(var ot=[],dt=0;dt<3;dt++){var ht=Ge[dt][0],Dt=Ge[dt][1],Ot=Ge[dt][2],Rt=Ge[dt][3],Zt=Qe[dt]>-1?Qe[dt]:findVertexId(ht,Dt,Ot);ot[dt]=Zt>-1?Zt:addVertex(ht,Dt,Ot,mapValue(Ne,Rt))}addFace(ot[0],ot[1],ot[2])}}function drawQuad(Ne,Ge,Qe){var makeTri=function(tt,rt,nt){drawTri(Ne,[Ge[tt],Ge[rt],Ge[nt]],[Qe[tt],Qe[rt],Qe[nt]])};makeTri(0,1,2),makeTri(2,3,0)}function drawTetra(Ne,Ge,Qe){var makeTri=function(tt,rt,nt){drawTri(Ne,[Ge[tt],Ge[rt],Ge[nt]],[Qe[tt],Qe[rt],Qe[nt]])};makeTri(0,1,2),makeTri(3,0,1),makeTri(2,3,0),makeTri(1,2,3)}function calcIntersection(Ne,Ge,Qe,tt){var rt=Ne[3];rt<Qe&&(rt=Qe),rt>tt&&(rt=tt);for(var nt=(Ne[3]-rt)/(Ne[3]-Ge[3]+1e-9),at=[],it=0;it<4;it++)at[it]=(1-nt)*Ne[it]+nt*Ge[it];return at}function inRange(Ne,Ge,Qe){return Ne>=Ge&&Ne<=Qe}function almostInFinalRange(Ne){var Ge=.001*(En-Cn);return Ne>=Cn-Ge&&Ne<=En+Ge}function getXYZV(Ge){for(var Qe=[],tt=0;tt<4;tt++){var rt=Ge[tt];Qe.push([Ne._x[rt],Ne._y[rt],Ne._z[rt],Ne._value[rt]])}return Qe}var Pn=3;function tryCreateTri(Ne,Ge,Qe,tt,rt,nt){nt||(nt=1),Qe=[-1,-1,-1];var at=!1,it=[inRange(Ge[0][3],tt,rt),inRange(Ge[1][3],tt,rt),inRange(Ge[2][3],tt,rt)];if(!it[0]&&!it[1]&&!it[2])return!1;var tryDrawTri=function(Ne,Ge,Qe){return almostInFinalRange(Ge[0][3])&&almostInFinalRange(Ge[1][3])&&almostInFinalRange(Ge[2][3])?(drawTri(Ne,Ge,Qe),!0):nt<Pn&&tryCreateTri(Ne,Ge,Qe,Cn,En,++nt)};if(it[0]&&it[1]&&it[2])return tryDrawTri(Ne,Ge,Qe)||at;var ot=!1;return[[0,1,2],[2,0,1],[1,2,0]].forEach((function(nt){if(it[nt[0]]&&it[nt[1]]&&!it[nt[2]]){var dt=Ge[nt[0]],ht=Ge[nt[1]],Dt=Ge[nt[2]],Ot=calcIntersection(Dt,dt,tt,rt),Rt=calcIntersection(Dt,ht,tt,rt);at=tryDrawTri(Ne,[Rt,Ot,dt],[-1,-1,Qe[nt[0]]])||at,at=tryDrawTri(Ne,[dt,ht,Rt],[Qe[nt[0]],Qe[nt[1]],-1])||at,ot=!0}})),ot||[[0,1,2],[1,2,0],[2,0,1]].forEach((function(nt){if(it[nt[0]]&&!it[nt[1]]&&!it[nt[2]]){var dt=Ge[nt[0]],ht=Ge[nt[1]],Dt=Ge[nt[2]],Ot=calcIntersection(ht,dt,tt,rt),Rt=calcIntersection(Dt,dt,tt,rt);at=tryDrawTri(Ne,[Rt,Ot,dt],[-1,-1,Qe[nt[0]]])||at,ot=!0}})),at}function tryCreateTetra(Ne,Ge,Qe,tt){var rt=!1,nt=getXYZV(Ge),at=[inRange(nt[0][3],Qe,tt),inRange(nt[1][3],Qe,tt),inRange(nt[2][3],Qe,tt),inRange(nt[3][3],Qe,tt)];if(!(at[0]||at[1]||at[2]||at[3]))return rt;if(at[0]&&at[1]&&at[2]&&at[3])return Zt&&(rt=drawTetra(Ne,nt,Ge)||rt),rt;var it=!1;return[[0,1,2,3],[3,0,1,2],[2,3,0,1],[1,2,3,0]].forEach((function(ot){if(at[ot[0]]&&at[ot[1]]&&at[ot[2]]&&!at[ot[3]]){var dt=nt[ot[0]],ht=nt[ot[1]],Dt=nt[ot[2]],Ot=nt[ot[3]];if(Zt)rt=drawTri(Ne,[dt,ht,Dt],[Ge[ot[0]],Ge[ot[1]],Ge[ot[2]]])||rt;else{var Rt=calcIntersection(Ot,dt,Qe,tt),er=calcIntersection(Ot,ht,Qe,tt),dr=calcIntersection(Ot,Dt,Qe,tt);rt=drawTri(null,[Rt,er,dr],[-1,-1,-1])||rt}it=!0}})),it||([[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2],[0,2,3,1],[1,3,2,0]].forEach((function(ot){if(at[ot[0]]&&at[ot[1]]&&!at[ot[2]]&&!at[ot[3]]){var dt=nt[ot[0]],ht=nt[ot[1]],Dt=nt[ot[2]],Ot=nt[ot[3]],Rt=calcIntersection(Dt,dt,Qe,tt),er=calcIntersection(Dt,ht,Qe,tt),dr=calcIntersection(Ot,ht,Qe,tt),mr=calcIntersection(Ot,dt,Qe,tt);Zt?(rt=drawTri(Ne,[dt,mr,Rt],[Ge[ot[0]],-1,-1])||rt,rt=drawTri(Ne,[ht,er,dr],[Ge[ot[1]],-1,-1])||rt):rt=drawQuad(null,[Rt,er,dr,mr],[-1,-1,-1,-1])||rt,it=!0}})),it||[[0,1,2,3],[1,2,3,0],[2,3,0,1],[3,0,1,2]].forEach((function(ot){if(at[ot[0]]&&!at[ot[1]]&&!at[ot[2]]&&!at[ot[3]]){var dt=nt[ot[0]],ht=nt[ot[1]],Dt=nt[ot[2]],Ot=nt[ot[3]],Rt=calcIntersection(ht,dt,Qe,tt),er=calcIntersection(Dt,dt,Qe,tt),dr=calcIntersection(Ot,dt,Qe,tt);Zt?(rt=drawTri(Ne,[dt,Rt,er],[Ge[ot[0]],-1,-1])||rt,rt=drawTri(Ne,[dt,er,dr],[Ge[ot[0]],-1,-1])||rt,rt=drawTri(Ne,[dt,dr,Rt],[Ge[ot[0]],-1,-1])||rt):rt=drawTri(null,[Rt,er,dr],[-1,-1,-1])||rt,it=!0}}))),rt}function addCube(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht){var Dt=!1;return Rt&&(styleIncludes(Ne,"A")&&(Dt=tryCreateTetra(null,[Ge,Qe,tt,nt],dt,ht)||Dt),styleIncludes(Ne,"B")&&(Dt=tryCreateTetra(null,[Qe,tt,rt,ot],dt,ht)||Dt),styleIncludes(Ne,"C")&&(Dt=tryCreateTetra(null,[Qe,nt,at,ot],dt,ht)||Dt),styleIncludes(Ne,"D")&&(Dt=tryCreateTetra(null,[tt,nt,it,ot],dt,ht)||Dt),styleIncludes(Ne,"E")&&(Dt=tryCreateTetra(null,[Qe,tt,nt,ot],dt,ht)||Dt)),Zt&&(Dt=tryCreateTetra(Ne,[Qe,tt,nt,ot],dt,ht)||Dt),Dt}function addRect(Ne,Ge,Qe,tt,rt,nt,at,it){return[!0===it[0]||tryCreateTri(Ne,getXYZV([Ge,Qe,tt]),[Ge,Qe,tt],nt,at),!0===it[1]||tryCreateTri(Ne,getXYZV([tt,rt,Ge]),[tt,rt,Ge],nt,at)]}function begin2dCell(Ne,Ge,Qe,tt,rt,nt,at,it,ot){return it?addRect(Ne,Ge,Qe,rt,tt,nt,at,ot):addRect(Ne,Qe,rt,tt,Ge,nt,at,ot)}function beginSection(Ne,Ge,Qe,tt,rt,nt,at){var it,ot,dt,ht,Dt=!1,makeSection=function(){Dt=tryCreateTri(Ne,[it,ot,dt],[-1,-1,-1],rt,nt)||Dt,Dt=tryCreateTri(Ne,[dt,ht,it],[-1,-1,-1],rt,nt)||Dt},Ot=at[0],Rt=at[1],Zt=at[2];return Ot&&(it=getBetween(getXYZV([getIndex(Ge,Qe-0,tt-0)])[0],getXYZV([getIndex(Ge-1,Qe-0,tt-0)])[0],Ot),ot=getBetween(getXYZV([getIndex(Ge,Qe-0,tt-1)])[0],getXYZV([getIndex(Ge-1,Qe-0,tt-1)])[0],Ot),dt=getBetween(getXYZV([getIndex(Ge,Qe-1,tt-1)])[0],getXYZV([getIndex(Ge-1,Qe-1,tt-1)])[0],Ot),ht=getBetween(getXYZV([getIndex(Ge,Qe-1,tt-0)])[0],getXYZV([getIndex(Ge-1,Qe-1,tt-0)])[0],Ot),makeSection()),Rt&&(it=getBetween(getXYZV([getIndex(Ge-0,Qe,tt-0)])[0],getXYZV([getIndex(Ge-0,Qe-1,tt-0)])[0],Rt),ot=getBetween(getXYZV([getIndex(Ge-0,Qe,tt-1)])[0],getXYZV([getIndex(Ge-0,Qe-1,tt-1)])[0],Rt),dt=getBetween(getXYZV([getIndex(Ge-1,Qe,tt-1)])[0],getXYZV([getIndex(Ge-1,Qe-1,tt-1)])[0],Rt),ht=getBetween(getXYZV([getIndex(Ge-1,Qe,tt-0)])[0],getXYZV([getIndex(Ge-1,Qe-1,tt-0)])[0],Rt),makeSection()),Zt&&(it=getBetween(getXYZV([getIndex(Ge-0,Qe-0,tt)])[0],getXYZV([getIndex(Ge-0,Qe-0,tt-1)])[0],Zt),ot=getBetween(getXYZV([getIndex(Ge-0,Qe-1,tt)])[0],getXYZV([getIndex(Ge-0,Qe-1,tt-1)])[0],Zt),dt=getBetween(getXYZV([getIndex(Ge-1,Qe-1,tt)])[0],getXYZV([getIndex(Ge-1,Qe-1,tt-1)])[0],Zt),ht=getBetween(getXYZV([getIndex(Ge-1,Qe-0,tt)])[0],getXYZV([getIndex(Ge-1,Qe-0,tt-1)])[0],Zt),makeSection()),Dt}function begin3dCell(Ne,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht,Dt){var Ot=Ne;return Dt?(Rt&&"even"===Ne&&(Ot=null),addCube(Ot,Ge,Qe,tt,rt,nt,at,it,ot,dt,ht)):(Rt&&"odd"===Ne&&(Ot=null),addCube(Ot,ot,it,at,nt,rt,tt,Qe,Ge,dt,ht))}function draw2dX(Ne,Ge,Qe,tt,rt){for(var nt=[],at=0,it=0;it<Ge.length;it++)for(var ot=Ge[it],dt=1;dt<en;dt++)for(var ht=1;ht<Ar;ht++)nt.push(begin2dCell(Ne,getIndex(ot,ht-1,dt-1),getIndex(ot,ht-1,dt),getIndex(ot,ht,dt-1),getIndex(ot,ht,dt),Qe,tt,(ot+ht+dt)%2,rt&&rt[at]?rt[at]:[])),at++;return nt}function draw2dY(Ne,Ge,Qe,tt,rt){for(var nt=[],at=0,it=0;it<Ge.length;it++)for(var ot=Ge[it],dt=1;dt<br;dt++)for(var ht=1;ht<en;ht++)nt.push(begin2dCell(Ne,getIndex(dt-1,ot,ht-1),getIndex(dt,ot,ht-1),getIndex(dt-1,ot,ht),getIndex(dt,ot,ht),Qe,tt,(dt+ot+ht)%2,rt&&rt[at]?rt[at]:[])),at++;return nt}function draw2dZ(Ne,Ge,Qe,tt,rt){for(var nt=[],at=0,it=0;it<Ge.length;it++)for(var ot=Ge[it],dt=1;dt<Ar;dt++)for(var ht=1;ht<br;ht++)nt.push(begin2dCell(Ne,getIndex(ht-1,dt-1,ot),getIndex(ht-1,dt,ot),getIndex(ht,dt-1,ot),getIndex(ht,dt,ot),Qe,tt,(ht+dt+ot)%2,rt&&rt[at]?rt[at]:[])),at++;return nt}function draw3d(Ne,Ge,Qe){for(var tt=1;tt<en;tt++)for(var rt=1;rt<Ar;rt++)for(var nt=1;nt<br;nt++)begin3dCell(Ne,getIndex(nt-1,rt-1,tt-1),getIndex(nt-1,rt-1,tt),getIndex(nt-1,rt,tt-1),getIndex(nt-1,rt,tt),getIndex(nt,rt-1,tt-1),getIndex(nt,rt-1,tt),getIndex(nt,rt,tt-1),getIndex(nt,rt,tt),Ge,Qe,(nt+rt+tt)%2)}function drawSpaceframe(Ne,Ge,Qe){Zt=!0,draw3d(Ne,Ge,Qe),Zt=!1}function drawSurface(Ne,Ge,Qe){Rt=!0,draw3d(Ne,Ge,Qe),Rt=!1}function drawSectionX(Ne,Ge,Qe,tt,rt,nt){for(var at=[],it=0,ot=0;ot<Ge.length;ot++)for(var dt=Ge[ot],ht=1;ht<en;ht++)for(var Dt=1;Dt<Ar;Dt++)at.push(beginSection(Ne,dt,Dt,ht,Qe,tt,rt[ot],nt&&nt[it]?nt[it]:[])),it++;return at}function drawSectionY(Ne,Ge,Qe,tt,rt,nt){for(var at=[],it=0,ot=0;ot<Ge.length;ot++)for(var dt=Ge[ot],ht=1;ht<br;ht++)for(var Dt=1;Dt<en;Dt++)at.push(beginSection(Ne,ht,dt,Dt,Qe,tt,rt[ot],nt&&nt[it]?nt[it]:[])),it++;return at}function drawSectionZ(Ne,Ge,Qe,tt,rt,nt){for(var at=[],it=0,ot=0;ot<Ge.length;ot++)for(var dt=Ge[ot],ht=1;ht<Ar;ht++)for(var Dt=1;Dt<br;Dt++)at.push(beginSection(Ne,Dt,ht,dt,Qe,tt,rt[ot],nt&&nt[it]?nt[it]:[])),it++;return at}function createRange(Ne,Ge){for(var Qe=[],tt=Ne;tt<Ge;tt++)Qe.push(tt);return Qe}function insertGridPoints(){for(var Ge=0;Ge<br;Ge++)for(var Qe=0;Qe<Ar;Qe++)for(var tt=0;tt<en;tt++){var rt=getIndex(Ge,Qe,tt);addVertex(Ne._x[rt],Ne._y[rt],Ne._z[rt],Ne._value[rt])}}function drawAll(){emptyVertices(),insertGridPoints();var Ge=null;if(ht&&Ot&&(setFill(Ot),drawSpaceframe(Ge,Cn,En)),ot&&Dt){setFill(Dt);for(var Qe=Ne.surface.pattern,it=Ne.surface.count,dt=0;dt<it;dt++){var Rt=1===it?.5:dt/(it-1),Zt=(1-Rt)*Cn+Rt*En,mn=Math.abs(Zt-xn)>Math.abs(Zt-kn)?[xn,Zt]:[Zt,kn];drawSurface(Qe,mn[0],mn[1])}}var Pn=[[Math.min(Cn,kn),Math.max(Cn,kn)],[Math.min(xn,En),Math.max(xn,En)]];["x","y","z"].forEach((function(Qe){for(var tt=[],rt=0;rt<Pn.length;rt++){var nt=0,at=Pn[rt][0],it=Pn[rt][1],ot=Ne.slices[Qe];if(ot.show&&ot.fill){setFill(ot.fill);var dt=[],ht=[],Dt=[];if(ot.locations.length)for(var Ot=0;Ot<ot.locations.length;Ot++){var Rt=findNearestOnAxis(ot.locations[Ot],"x"===Qe?dr:"y"===Qe?mr:xr);0===Rt.distRatio?dt.push(Rt.id):Rt.id>0&&(ht.push(Rt.id),"x"===Qe?Dt.push([Rt.distRatio,0,0]):"y"===Qe?Dt.push([0,Rt.distRatio,0]):Dt.push([0,0,Rt.distRatio]))}else dt=createRange(1,"x"===Qe?br-1:"y"===Qe?Ar-1:en-1);ht.length>0&&(tt[nt]="x"===Qe?drawSectionX(Ge,ht,at,it,Dt,tt[nt]):"y"===Qe?drawSectionY(Ge,ht,at,it,Dt,tt[nt]):drawSectionZ(Ge,ht,at,it,Dt,tt[nt]),nt++),dt.length>0&&(tt[nt]="x"===Qe?draw2dX(Ge,dt,at,it,tt[nt]):"y"===Qe?draw2dY(Ge,dt,at,it,tt[nt]):draw2dZ(Ge,dt,at,it,tt[nt]),nt++)}var Zt=Ne.caps[Qe];Zt.show&&Zt.fill&&(setFill(Zt.fill),tt[nt]="x"===Qe?draw2dX(Ge,[0,br-1],at,it,tt[nt]):"y"===Qe?draw2dY(Ge,[0,Ar-1],at,it,tt[nt]):draw2dZ(Ge,[0,en-1],at,it,tt[nt]),nt++)}})),0===er&&emptyVertices(),Ne._meshX=tt,Ne._meshY=rt,Ne._meshZ=nt,Ne._meshIntensity=at,Ne._Xs=dr,Ne._Ys=mr,Ne._Zs=xr}return drawAll(),Ne}function createIsosurfaceTrace(Ne,Ge){var Qe=Ne.glplot.gl,rt=tt({gl:Qe}),nt=new IsosurfaceTrace(Ne,rt,Ge.uid);return rt._trace=nt,nt.update(Ge),Ne.glplot.add(rt),nt}Ge.exports={findNearestOnAxis:findNearestOnAxis,generateIsoMeshes:generateIsoMeshes,createIsosurfaceTrace:createIsosurfaceTrace}},{"../../components/colorscale":655,"../../lib/gl_format_color":774,"../../lib/str2rgbarray":802,"../../plots/gl3d/zip3":881,"gl-mesh3d":309}],1126:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../registry"),nt=Ne("./attributes"),at=Ne("../../components/colorscale/defaults");function supplyDefaults(Ne,Ge,Qe,rt){function coerce(Qe,rt){return tt.coerce(Ne,Ge,nt,Qe,rt)}supplyIsoDefaults(Ne,Ge,Qe,rt,coerce)}function supplyIsoDefaults(Ne,Ge,Qe,tt,nt){var it=nt("isomin"),ot=nt("isomax");null!=ot&&null!=it&&it>ot&&(Ge.isomin=null,Ge.isomax=null);var dt=nt("x"),ht=nt("y"),Dt=nt("z"),Ot=nt("value");dt&&dt.length&&ht&&ht.length&&Dt&&Dt.length&&Ot&&Ot.length?(rt.getComponentMethod("calendars","handleTraceDefaults")(Ne,Ge,["x","y","z"],tt),["x","y","z"].forEach((function(Ne){var Ge="caps."+Ne;nt(Ge+".show")&&nt(Ge+".fill");var Qe="slices."+Ne;nt(Qe+".show")&&(nt(Qe+".fill"),nt(Qe+".locations"))})),nt("spaceframe.show")&&nt("spaceframe.fill"),nt("surface.show")&&(nt("surface.count"),nt("surface.fill"),nt("surface.pattern")),nt("contour.show")&&(nt("contour.color"),nt("contour.width")),["text","hovertext","hovertemplate","lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","opacity"].forEach((function(Ne){nt(Ne)})),at(Ne,Ge,tt,nt,{prefix:"",cLetter:"c"}),Ge._length=null):Ge.visible=!1}Ge.exports={supplyDefaults:supplyDefaults,supplyIsoDefaults:supplyIsoDefaults}},{"../../components/colorscale/defaults":653,"../../lib":778,"../../registry":911,"./attributes":1123}],1127:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults").supplyDefaults,calc:Ne("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:Ne("./convert").createIsosurfaceTrace,moduleType:"trace",name:"isosurface",basePlotModule:Ne("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":870,"./attributes":1123,"./calc":1124,"./convert":1125,"./defaults":1126}],1128:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/colorscale/attributes"),rt=Ne("../../plots/template_attributes").hovertemplateAttrs,nt=Ne("../surface/attributes"),at=Ne("../../plots/attributes"),it=Ne("../../lib/extend").extendFlat;Ge.exports=it({x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},i:{valType:"data_array",editType:"calc"},j:{valType:"data_array",editType:"calc"},k:{valType:"data_array",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertemplate:rt({editType:"calc"}),delaunayaxis:{valType:"enumerated",values:["x","y","z"],dflt:"z",editType:"calc"},alphahull:{valType:"number",dflt:-1,editType:"calc"},intensity:{valType:"data_array",editType:"calc"},intensitymode:{valType:"enumerated",values:["vertex","cell"],dflt:"vertex",editType:"calc"},color:{valType:"color",editType:"calc"},vertexcolor:{valType:"data_array",editType:"calc"},facecolor:{valType:"data_array",editType:"calc"},transforms:void 0},tt("",{colorAttr:"`intensity`",showScaleDflt:!0,editTypeOverride:"calc"}),{opacity:nt.opacity,flatshading:{valType:"boolean",dflt:!1,editType:"calc"},contour:{show:it({},nt.contours.x.show,{}),color:nt.contours.x.color,width:nt.contours.x.width,editType:"calc"},lightposition:{x:it({},nt.lightposition.x,{dflt:1e5}),y:it({},nt.lightposition.y,{dflt:1e5}),z:it({},nt.lightposition.z,{dflt:0}),editType:"calc"},lighting:it({vertexnormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-12,editType:"calc"},facenormalsepsilon:{valType:"number",min:0,max:1,dflt:1e-6,editType:"calc"},editType:"calc"},nt.lighting),hoverinfo:it({},at.hoverinfo,{editType:"calc"}),showlegend:it({},at.showlegend,{dflt:!1})})},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../surface/attributes":1311}],1129:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/colorscale/calc");Ge.exports=function(Ne,Ge){Ge.intensity&&tt(Ne,Ge,{vals:Ge.intensity,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":651}],1130:[function(Ne,Ge,Qe){"use strict";var tt=Ne("gl-mesh3d"),rt=Ne("delaunay-triangulate"),nt=Ne("alpha-shape"),at=Ne("convex-hull"),it=Ne("../../lib/gl_format_color").parseColorScale,ot=Ne("../../lib/str2rgbarray"),dt=Ne("../../components/colorscale").extractOpts,ht=Ne("../../plots/gl3d/zip3");function Mesh3DTrace(Ne,Ge,Qe){this.scene=Ne,this.uid=Qe,this.mesh=Ge,this.name="",this.color="#fff",this.data=null,this.showContour=!1}var Dt=Mesh3DTrace.prototype;function parseColorArray(Ne){for(var Ge=[],Qe=Ne.length,tt=0;tt<Qe;tt++)Ge[tt]=ot(Ne[tt]);return Ge}function toDataCoords(Ne,Ge,Qe,tt){for(var rt=[],nt=Ge.length,at=0;at<nt;at++)rt[at]=Ne.d2l(Ge[at],0,tt)*Qe;return rt}function toRoundIndex(Ne){for(var Ge=[],Qe=Ne.length,tt=0;tt<Qe;tt++)Ge[tt]=Math.round(Ne[tt]);return Ge}function delaunayCells(Ne,Ge){for(var Qe=["x","y","z"].indexOf(Ne),tt=[],nt=Ge.length,at=0;at<nt;at++)tt[at]=[Ge[at][(Qe+1)%3],Ge[at][(Qe+2)%3]];return rt(tt)}function hasValidIndices(Ne,Ge){for(var Qe=Ne.length,tt=0;tt<Qe;tt++)if(Ne[tt]<=-.5||Ne[tt]>=Ge-.5)return!1;return!0}function createMesh3DTrace(Ne,Ge){var Qe=Ne.glplot.gl,rt=tt({gl:Qe}),nt=new Mesh3DTrace(Ne,rt,Ge.uid);return rt._trace=nt,nt.update(Ge),Ne.glplot.add(rt),nt}Dt.handlePick=function(Ne){if(Ne.object===this.mesh){var Ge=Ne.index=Ne.data.index;Ne.data._cellCenter?Ne.traceCoordinate=Ne.data.dataCoordinate:Ne.traceCoordinate=[this.data.x[Ge],this.data.y[Ge],this.data.z[Ge]];var Qe=this.data.hovertext||this.data.text;return Array.isArray(Qe)&&void 0!==Qe[Ge]?Ne.textLabel=Qe[Ge]:Qe&&(Ne.textLabel=Qe),!0}},Dt.update=function(Ne){var Ge=this.scene,Qe=Ge.fullSceneLayout;this.data=Ne;var tt,rt=Ne.x.length,Dt=ht(toDataCoords(Qe.xaxis,Ne.x,Ge.dataScale[0],Ne.xcalendar),toDataCoords(Qe.yaxis,Ne.y,Ge.dataScale[1],Ne.ycalendar),toDataCoords(Qe.zaxis,Ne.z,Ge.dataScale[2],Ne.zcalendar));if(Ne.i&&Ne.j&&Ne.k){if(Ne.i.length!==Ne.j.length||Ne.j.length!==Ne.k.length||!hasValidIndices(Ne.i,rt)||!hasValidIndices(Ne.j,rt)||!hasValidIndices(Ne.k,rt))return;tt=ht(toRoundIndex(Ne.i),toRoundIndex(Ne.j),toRoundIndex(Ne.k))}else tt=0===Ne.alphahull?at(Dt):Ne.alphahull>0?nt(Ne.alphahull,Dt):delaunayCells(Ne.delaunayaxis,Dt);var Ot={positions:Dt,cells:tt,lightPosition:[Ne.lightposition.x,Ne.lightposition.y,Ne.lightposition.z],ambient:Ne.lighting.ambient,diffuse:Ne.lighting.diffuse,specular:Ne.lighting.specular,roughness:Ne.lighting.roughness,fresnel:Ne.lighting.fresnel,vertexNormalsEpsilon:Ne.lighting.vertexnormalsepsilon,faceNormalsEpsilon:Ne.lighting.facenormalsepsilon,opacity:Ne.opacity,contourEnable:Ne.contour.show,contourColor:ot(Ne.contour.color).slice(0,3),contourWidth:Ne.contour.width,useFacetNormals:Ne.flatshading};if(Ne.intensity){var Rt=dt(Ne);this.color="#fff";var Zt=Ne.intensitymode;Ot[Zt+"Intensity"]=Ne.intensity,Ot[Zt+"IntensityBounds"]=[Rt.min,Rt.max],Ot.colormap=it(Ne)}else Ne.vertexcolor?(this.color=Ne.vertexcolor[0],Ot.vertexColors=parseColorArray(Ne.vertexcolor)):Ne.facecolor?(this.color=Ne.facecolor[0],Ot.cellColors=parseColorArray(Ne.facecolor)):(this.color=Ne.color,Ot.meshColor=ot(Ne.color));this.mesh.update(Ot)},Dt.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},Ge.exports=createMesh3DTrace},{"../../components/colorscale":655,"../../lib/gl_format_color":774,"../../lib/str2rgbarray":802,"../../plots/gl3d/zip3":881,"alpha-shape":69,"convex-hull":135,"delaunay-triangulate":171,"gl-mesh3d":309}],1131:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../registry"),rt=Ne("../../lib"),nt=Ne("../../components/colorscale/defaults"),at=Ne("./attributes");Ge.exports=function(Ne,Ge,Qe,it){function coerce(Qe,tt){return rt.coerce(Ne,Ge,at,Qe,tt)}function readComponents(Ne){var Ge=Ne.map((function(Ne){var Ge=coerce(Ne);return Ge&&rt.isArrayOrTypedArray(Ge)?Ge:null}));return Ge.every((function(Ne){return Ne&&Ne.length===Ge[0].length}))&&Ge}readComponents(["x","y","z"])?(readComponents(["i","j","k"]),(!Ge.i||Ge.j&&Ge.k)&&(!Ge.j||Ge.k&&Ge.i)&&(!Ge.k||Ge.i&&Ge.j)?(tt.getComponentMethod("calendars","handleTraceDefaults")(Ne,Ge,["x","y","z"],it),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lighting.vertexnormalsepsilon","lighting.facenormalsepsilon","lightposition.x","lightposition.y","lightposition.z","flatshading","alphahull","delaunayaxis","opacity"].forEach((function(Ne){coerce(Ne)})),coerce("contour.show")&&(coerce("contour.color"),coerce("contour.width")),"intensity"in Ne?(coerce("intensity"),coerce("intensitymode"),nt(Ne,Ge,it,coerce,{prefix:"",cLetter:"c"})):(Ge.showscale=!1,"facecolor"in Ne?coerce("facecolor"):"vertexcolor"in Ne?coerce("vertexcolor"):coerce("color",Qe)),coerce("text"),coerce("hovertext"),coerce("hovertemplate"),Ge._length=null):Ge.visible=!1):Ge.visible=!1}},{"../../components/colorscale/defaults":653,"../../lib":778,"../../registry":911,"./attributes":1128}],1132:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),calc:Ne("./calc"),colorbar:{min:"cmin",max:"cmax"},plot:Ne("./convert"),moduleType:"trace",name:"mesh3d",basePlotModule:Ne("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":870,"./attributes":1128,"./calc":1129,"./convert":1130,"./defaults":1131}],1133:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib").extendFlat,rt=Ne("../scatter/attributes"),nt=Ne("../../components/drawing/attributes").dash,at=Ne("../../components/fx/attributes"),it=Ne("../../constants/delta.js"),ot=it.INCREASING.COLOR,dt=it.DECREASING.COLOR,ht=rt.line;function directionAttrs(Ne){return{line:{color:tt({},ht.color,{dflt:Ne}),width:ht.width,dash:nt,editType:"style"},editType:"style"}}Ge.exports={xperiod:rt.xperiod,xperiod0:rt.xperiod0,xperiodalignment:rt.xperiodalignment,x:{valType:"data_array",editType:"calc+clearAxisTypes"},open:{valType:"data_array",editType:"calc"},high:{valType:"data_array",editType:"calc"},low:{valType:"data_array",editType:"calc"},close:{valType:"data_array",editType:"calc"},line:{width:tt({},ht.width,{}),dash:tt({},nt,{}),editType:"style"},increasing:directionAttrs(ot),decreasing:directionAttrs(dt),text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},tickwidth:{valType:"number",min:0,max:.5,dflt:.3,editType:"calc"},hoverlabel:tt({},at.hoverlabel,{split:{valType:"boolean",dflt:!1,editType:"style"}})}},{"../../components/drawing/attributes":664,"../../components/fx/attributes":674,"../../constants/delta.js":747,"../../lib":778,"../scatter/attributes":1187}],1134:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=tt._,nt=Ne("../../plots/cartesian/axes"),at=Ne("../../plots/cartesian/align_period"),it=Ne("../../constants/numerical").BADNUM;function calc(Ne,Ge){var Qe=nt.getFromId(Ne,Ge.xaxis),rt=nt.getFromId(Ne,Ge.yaxis),at=convertTickWidth(Ne,Qe,Ge),it=Ge._minDiff;Ge._minDiff=null;var ot=Ge._origX;Ge._origX=null;var dt=Ge._xcalc;Ge._xcalc=null;var ht=calcCommon(Ne,Ge,ot,dt,rt,ptFunc);return Ge._extremes[Qe._id]=nt.findExtremes(Qe,dt,{vpad:it/2}),ht.length?(tt.extendFlat(ht[0].t,{wHover:it/2,tickLen:at}),ht):[{t:{empty:!0}}]}function ptFunc(Ne,Ge,Qe,tt){return{o:Ne,h:Ge,l:Qe,c:tt}}function calcCommon(Ne,Ge,Qe,at,ot,dt){for(var ht=ot.makeCalcdata(Ge,"open"),Dt=ot.makeCalcdata(Ge,"high"),Ot=ot.makeCalcdata(Ge,"low"),Rt=ot.makeCalcdata(Ge,"close"),Zt=Array.isArray(Ge.text),er=Array.isArray(Ge.hovertext),dr=!0,mr=null,xr=!!Ge.xperiodalignment,br=[],Ar=0;Ar<at.length;Ar++){var en=at[Ar],mn=ht[Ar],xn=Dt[Ar],kn=Ot[Ar],Cn=Rt[Ar];if(en!==it&&mn!==it&&xn!==it&&kn!==it&&Cn!==it){Cn===mn?null!==mr&&Cn!==mr&&(dr=Cn>mr):dr=Cn>mn,mr=Cn;var En=dt(mn,xn,kn,Cn);En.pos=en,En.yc=(mn+Cn)/2,En.i=Ar,En.dir=dr?"increasing":"decreasing",En.x=En.pos,En.y=[kn,xn],xr&&(En.orig_p=Qe[Ar]),Zt&&(En.tx=Ge.text[Ar]),er&&(En.htx=Ge.hovertext[Ar]),br.push(En)}else br.push({pos:en,empty:!0})}return Ge._extremes[ot._id]=nt.findExtremes(ot,tt.concat(Ot,Dt),{padded:!0}),br.length&&(br[0].t={labels:{open:rt(Ne,"open:")+" ",high:rt(Ne,"high:")+" ",low:rt(Ne,"low:")+" ",close:rt(Ne,"close:")+" "}}),br}function convertTickWidth(Ne,Ge,Qe){var rt=Qe._minDiff;if(!rt){var nt,it=Ne._fullData,ot=[];for(rt=1/0,nt=0;nt<it.length;nt++){var dt=it[nt];if("ohlc"===dt.type&&!0===dt.visible&&dt.xaxis===Ge._id){ot.push(dt);var ht=Ge.makeCalcdata(dt,"x");dt._origX=ht;var Dt=at(Qe,Ge,"x",ht);dt._xcalc=Dt;var Ot=tt.distinctVals(Dt).minDiff;Ot&&isFinite(Ot)&&(rt=Math.min(rt,Ot))}}for(rt===1/0&&(rt=1),nt=0;nt<ot.length;nt++)ot[nt]._minDiff=rt}return rt*Qe.tickwidth}Ge.exports={calc:calc,calcCommon:calcCommon}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/align_period":825,"../../plots/cartesian/axes":828}],1135:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./ohlc_defaults"),nt=Ne("../scatter/period_defaults"),at=Ne("./attributes");function handleDirection(Ne,Ge,Qe,tt){Qe(tt+".line.color"),Qe(tt+".line.width",Ge.line.width),Qe(tt+".line.dash",Ge.line.dash)}Ge.exports=function(Ne,Ge,Qe,it){function coerce(Qe,rt){return tt.coerce(Ne,Ge,at,Qe,rt)}rt(Ne,Ge,coerce,it)?(nt(Ne,Ge,it,coerce,{x:!0}),coerce("line.width"),coerce("line.dash"),handleDirection(Ne,Ge,coerce,"increasing"),handleDirection(Ne,Ge,coerce,"decreasing"),coerce("text"),coerce("hovertext"),coerce("tickwidth"),it._requestRangeslider[Ge.xaxis]=!0):Ge.visible=!1}},{"../../lib":778,"../scatter/period_defaults":1207,"./attributes":1133,"./ohlc_defaults":1138}],1136:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/cartesian/axes"),rt=Ne("../../lib"),nt=Ne("../../components/fx"),at=Ne("../../components/color"),it=Ne("../../lib").fillText,ot=Ne("../../constants/delta.js"),dt={increasing:ot.INCREASING.SYMBOL,decreasing:ot.DECREASING.SYMBOL};function hoverPoints(Ne,Ge,Qe,tt){return Ne.cd[0].trace.hoverlabel.split?hoverSplit(Ne,Ge,Qe,tt):hoverOnPoints(Ne,Ge,Qe,tt)}function getClosestPoint(Ne,Ge,Qe,tt){var rt,it,ot=Ne.cd,dt=Ne.xa,ht=ot[0].trace,Dt=ot[0].t,Ot=ht.type,Rt="ohlc"===Ot?"l":"min",Zt="ohlc"===Ot?"h":"max",er=Dt.bPos||0,shiftPos=function(Ne){return Ne.pos+er-Ge},dr=Dt.bdPos||Dt.tickLen,mr=Dt.wHover,xr=Math.min(1,dr/Math.abs(dt.r2c(dt.range[1])-dt.r2c(dt.range[0])));function dx(Ne){var Ge=shiftPos(Ne);return nt.inbox(Ge-mr,Ge+mr,rt)}function dy(Ne){var Ge=Ne[Rt],tt=Ne[Zt];return Ge===tt||nt.inbox(Ge-Qe,tt-Qe,rt)}function dxy(Ne){return(dx(Ne)+dy(Ne))/2}rt=Ne.maxHoverDistance-xr,it=Ne.maxSpikeDistance-xr;var br=nt.getDistanceFunction(tt,dx,dy,dxy);if(nt.getClosest(ot,br,Ne),!1===Ne.index)return null;var Ar=ot[Ne.index];if(Ar.empty)return null;var en=ht[Ar.dir],mn=en.line.color;return at.opacity(mn)&&en.line.width?Ne.color=mn:Ne.color=en.fillcolor,Ne.x0=dt.c2p(Ar.pos+er-dr,!0),Ne.x1=dt.c2p(Ar.pos+er+dr,!0),Ne.xLabelVal=void 0!==Ar.orig_p?Ar.orig_p:Ar.pos,Ne.spikeDistance=dxy(Ar)*it/rt,Ne.xSpike=dt.c2p(Ar.pos,!0),Ne}function hoverSplit(Ne,Ge,Qe,nt){var at=Ne.cd,it=Ne.ya,ot=at[0].trace,dt=at[0].t,ht=[],Dt=getClosestPoint(Ne,Ge,Qe,nt);if(!Dt)return[];var Ot=at[Dt.index].hi||ot.hoverinfo,Rt=Ot.split("+");if("all"!==Ot&&-1===Rt.indexOf("y"))return[];for(var Zt=["high","open","close","low"],er={},dr=0;dr<Zt.length;dr++){var mr,xr=Zt[dr],br=ot[xr][Dt.index],Ar=it.c2p(br,!0);br in er?(mr=er[br]).yLabel+="<br>"+dt.labels[xr]+tt.hoverLabelText(it,br):((mr=rt.extendFlat({},Dt)).y0=mr.y1=Ar,mr.yLabelVal=br,mr.yLabel=dt.labels[xr]+tt.hoverLabelText(it,br),mr.name="",ht.push(mr),er[br]=mr)}return ht}function hoverOnPoints(Ne,Ge,Qe,rt){var nt=Ne.cd,at=Ne.ya,ot=nt[0].trace,ht=nt[0].t,Dt=getClosestPoint(Ne,Ge,Qe,rt);if(!Dt)return[];var Ot=nt[Dt.index],Rt=Dt.index=Ot.i,Zt=Ot.dir;function getLabelLine(Ne){return ht.labels[Ne]+tt.hoverLabelText(at,ot[Ne][Rt])}var er=Ot.hi||ot.hoverinfo,dr=er.split("+"),mr="all"===er,xr=mr||-1!==dr.indexOf("y"),br=mr||-1!==dr.indexOf("text"),Ar=xr?[getLabelLine("open"),getLabelLine("high"),getLabelLine("low"),getLabelLine("close")+"  "+dt[Zt]]:[];return br&&it(Ot,ot,Ar),Dt.extraText=Ar.join("<br>"),Dt.y0=Dt.y1=at.c2p(Ot.yc,!0),[Dt]}Ge.exports={hoverPoints:hoverPoints,hoverSplit:hoverSplit,hoverOnPoints:hoverOnPoints}},{"../../components/color":643,"../../components/fx":683,"../../constants/delta.js":747,"../../lib":778,"../../plots/cartesian/axes":828}],1137:[function(Ne,Ge,Qe){"use strict";Ge.exports={moduleType:"trace",name:"ohlc",basePlotModule:Ne("../../plots/cartesian"),categories:["cartesian","svg","showLegend"],meta:{},attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),calc:Ne("./calc").calc,plot:Ne("./plot"),style:Ne("./style"),hoverPoints:Ne("./hover").hoverPoints,selectPoints:Ne("./select")}},{"../../plots/cartesian":841,"./attributes":1133,"./calc":1134,"./defaults":1135,"./hover":1136,"./plot":1139,"./select":1140,"./style":1141}],1138:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../registry"),rt=Ne("../../lib");Ge.exports=function(Ne,Ge,Qe,nt){var at=Qe("x"),it=Qe("open"),ot=Qe("high"),dt=Qe("low"),ht=Qe("close");if(Qe("hoverlabel.split"),tt.getComponentMethod("calendars","handleTraceDefaults")(Ne,Ge,["x"],nt),it&&ot&&dt&&ht){var Dt=Math.min(it.length,ot.length,dt.length,ht.length);return at&&(Dt=Math.min(Dt,rt.minRowLength(at))),Ge._length=Dt,Dt}}},{"../../lib":778,"../../registry":911}],1139:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../lib");Ge.exports=function(Ne,Ge,Qe,nt){var at=Ge.yaxis,it=Ge.xaxis,ot=!!it.rangebreaks;rt.makeTraceGroups(nt,Qe,"trace ohlc").each((function(Ne){var Ge=tt.select(this),Qe=Ne[0],nt=Qe.t;if(!0!==Qe.trace.visible||nt.empty)Ge.remove();else{var dt=nt.tickLen,ht=Ge.selectAll("path").data(rt.identity);ht.enter().append("path"),ht.exit().remove(),ht.attr("d",(function(Ne){if(Ne.empty)return"M0,0Z";var Ge=it.c2p(Ne.pos-dt,!0),Qe=it.c2p(Ne.pos+dt,!0),tt=ot?(Ge+Qe)/2:it.c2p(Ne.pos,!0);return"M"+Ge+","+at.c2p(Ne.o,!0)+"H"+tt+"M"+tt+","+at.c2p(Ne.h,!0)+"V"+at.c2p(Ne.l,!0)+"M"+Qe+","+at.c2p(Ne.c,!0)+"H"+tt}))}}))}},{"../../lib":778,d3:169}],1140:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge){var Qe,tt=Ne.cd,rt=Ne.xaxis,nt=Ne.yaxis,at=[],it=tt[0].t.bPos||0;if(!1===Ge)for(Qe=0;Qe<tt.length;Qe++)tt[Qe].selected=0;else for(Qe=0;Qe<tt.length;Qe++){var ot=tt[Qe];Ge.contains([rt.c2p(ot.pos+it),nt.c2p(ot.yc)],null,ot.i,Ne)?(at.push({pointNumber:ot.i,x:rt.c2d(ot.pos),y:nt.c2d(ot.yc)}),ot.selected=1):ot.selected=0}return at}},{}],1141:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../components/drawing"),nt=Ne("../../components/color");Ge.exports=function(Ne,Ge,Qe){var at=Qe||tt.select(Ne).selectAll("g.ohlclayer").selectAll("g.trace");at.style("opacity",(function(Ne){return Ne[0].trace.opacity})),at.each((function(Ne){var Ge=Ne[0].trace;tt.select(this).selectAll("path").each((function(Ne){if(!Ne.empty){var Qe=Ge[Ne.dir].line;tt.select(this).style("fill","none").call(nt.stroke,Qe.color).call(rt.dashLine,Qe.dash,Qe.width).style("opacity",Ge.selectedpoints&&!Ne.selected?.3:1)}}))}))}},{"../../components/color":643,"../../components/drawing":665,d3:169}],1142:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib/extend").extendFlat,rt=Ne("../../plots/attributes"),nt=Ne("../../plots/font_attributes"),at=Ne("../../components/colorscale/attributes"),it=Ne("../../plots/template_attributes").hovertemplateAttrs,ot=Ne("../../plots/domain").attributes,dt=tt({editType:"calc"},at("line",{editTypeOverride:"calc"}),{shape:{valType:"enumerated",values:["linear","hspline"],dflt:"linear",editType:"plot"},hovertemplate:it({editType:"plot",arrayOk:!1},{keys:["count","probability"]})});Ge.exports={domain:ot({name:"parcats",trace:!0,editType:"calc"}),hoverinfo:tt({},rt.hoverinfo,{flags:["count","probability"],editType:"plot",arrayOk:!1}),hoveron:{valType:"enumerated",values:["category","color","dimension"],dflt:"category",editType:"plot"},hovertemplate:it({editType:"plot",arrayOk:!1},{keys:["count","probability","category","categorycount","colorcount","bandcolorcount"]}),arrangement:{valType:"enumerated",values:["perpendicular","freeform","fixed"],dflt:"perpendicular",editType:"plot"},bundlecolors:{valType:"boolean",dflt:!0,editType:"plot"},sortpaths:{valType:"enumerated",values:["forward","backward"],dflt:"forward",editType:"plot"},labelfont:nt({editType:"calc"}),tickfont:nt({editType:"calc"}),dimensions:{_isLinkedToArray:"dimension",label:{valType:"string",editType:"calc"},categoryorder:{valType:"enumerated",values:["trace","category ascending","category descending","array"],dflt:"trace",editType:"calc"},categoryarray:{valType:"data_array",editType:"calc"},ticktext:{valType:"data_array",editType:"calc"},values:{valType:"data_array",dflt:[],editType:"calc"},displayindex:{valType:"integer",editType:"calc"},editType:"calc",visible:{valType:"boolean",dflt:!0,editType:"calc"}},line:dt,counts:{valType:"number",min:0,dflt:1,arrayOk:!0,editType:"calc"},customdata:void 0,hoverlabel:void 0,ids:void 0,legendgroup:void 0,opacity:void 0,selectedpoints:void 0,showlegend:void 0}},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/domain":855,"../../plots/font_attributes":856,"../../plots/template_attributes":906}],1143:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/get_data").getModuleCalcData,rt=Ne("./plot"),nt="parcats";Qe.name=nt,Qe.plot=function(Ne,Ge,Qe,at){var it=tt(Ne.calcdata,nt);if(it.length){var ot=it[0];rt(Ne,ot,Qe,at)}},Qe.clean=function(Ne,Ge,Qe,tt){var rt=tt._has&&tt._has("parcats"),nt=Ge._has&&Ge._has("parcats");rt&&!nt&&tt._paperdiv.selectAll(".parcats").remove()}},{"../../plots/get_data":865,"./plot":1148}],1144:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib/gup").wrap,rt=Ne("../../components/colorscale/helpers").hasColorscale,nt=Ne("../../components/colorscale/calc"),at=Ne("../../lib/filter_unique.js"),it=Ne("../../components/drawing"),ot=Ne("../../lib"),dt=Ne("fast-isnumeric");function createParcatsModel(Ne,Ge,Qe){var tt=Ne.map((function(Ne){return Ne.categories.length})).reduce((function(Ne,Ge){return Math.max(Ne,Ge)}));return{dimensions:Ne,paths:Ge,trace:void 0,maxCats:tt,count:Qe}}function createDimensionModel(Ne,Ge,Qe,tt,rt){return{dimensionInd:Ne,containerInd:Ge,displayInd:Qe,dimensionLabel:tt,count:rt,categories:[],dragX:null}}function createCategoryModel(Ne,Ge,Qe,tt){return{dimensionInd:Ne,categoryInd:Ge,categoryValue:Qe,displayInd:Ge,categoryLabel:tt,valueInds:[],count:0,dragY:null}}function updateCategoryModel(Ne,Ge,Qe){Ne.valueInds.push(Ge),Ne.count+=Qe}function createPathModel(Ne,Ge,Qe){return{categoryInds:Ne,color:Ge,rawColor:Qe,valueInds:[],count:0}}function updatePathModel(Ne,Ge,Qe){Ne.valueInds.push(Ge),Ne.count+=Qe}function getUniqueInfo(Ne,Ge){Ge=null==Ge?[]:Ge.map((function(Ne){return Ne}));var Qe={},tt={},rt=[];Ge.forEach((function(Ne,Ge){Qe[Ne]=0,tt[Ne]=Ge}));for(var nt=0;nt<Ne.length;nt++){var at,it=Ne[nt];void 0===Qe[it]?(Qe[it]=1,at=Ge.push(it)-1,tt[it]=at):(Qe[it]++,at=tt[it]),rt.push(at)}var ot=Ge.map((function(Ne){return Qe[Ne]}));return{uniqueValues:Ge,uniqueCounts:ot,inds:rt}}function validateDimensionDisplayInds(Ne){var Ge;if(isRangePermutation(Ne.map((function(Ne){return Ne.displayindex}))))for(Ge=0;Ge<Ne.length;Ge++)Ne[Ge]._displayindex=Ne[Ge].displayindex;else for(Ge=0;Ge<Ne.length;Ge++)Ne[Ge]._displayindex=Ge}function validateCategoryProperties(Ne,Ge){Ne._categoryarray=Ge.uniqueValues,null===Ne.ticktext||void 0===Ne.ticktext?Ne._ticktext=[]:Ne._ticktext=Ne.ticktext.slice();for(var Qe=Ne._ticktext.length;Qe<Ge.uniqueValues.length;Qe++)Ne._ticktext.push(Ge.uniqueValues[Qe])}function isRangePermutation(Ne){for(var Ge=new Array(Ne.length),Qe=0;Qe<Ne.length;Qe++){if(Ne[Qe]<0||Ne[Qe]>=Ne.length)return!1;if(void 0!==Ge[Ne[Qe]])return!1;Ge[Ne[Qe]]=!0}return!0}Ge.exports=function(Ne,Ge){var Qe=ot.filterVisible(Ge.dimensions);if(0===Qe.length)return[];var ht,Dt,Ot,Rt=Qe.map((function(Ne){var Ge;if("trace"===Ne.categoryorder)Ge=null;else if("array"===Ne.categoryorder)Ge=Ne.categoryarray;else{Ge=at(Ne.values);for(var Qe=!0,tt=0;tt<Ge.length;tt++)if(!dt(Ge[tt])){Qe=!1;break}Ge.sort(Qe?ot.sorterAsc:void 0),"category descending"===Ne.categoryorder&&(Ge=Ge.reverse())}return getUniqueInfo(Ne.values,Ge)}));ht=ot.isArrayOrTypedArray(Ge.counts)?Ge.counts:[Ge.counts],validateDimensionDisplayInds(Qe),Qe.forEach((function(Ne,Ge){validateCategoryProperties(Ne,Rt[Ge])}));var Zt,er=Ge.line;function getMarkerColorInfo(Ne){var Ge,Qe;return ot.isArrayOrTypedArray(er.color)?Qe=Ge=er.color[Ne%er.color.length]:Ge=er.color,{color:Zt(Ge),rawColor:Qe}}er?(rt(Ge,"line")&&nt(Ne,Ge,{vals:Ge.line.color,containerStr:"line",cLetter:"c"}),Zt=it.tryColorscale(er)):Zt=ot.identity;var dr,mr,xr=Qe[0].values.length,br={},Ar=Rt.map((function(Ne){return Ne.inds}));for(Ot=0,dr=0;dr<xr;dr++){var en=[];for(mr=0;mr<Ar.length;mr++)en.push(Ar[mr][dr]);Dt=ht[dr%ht.length],Ot+=Dt;var mn=getMarkerColorInfo(dr),xn=en+"-"+mn.rawColor;void 0===br[xn]&&(br[xn]=createPathModel(en,mn.color,mn.rawColor)),updatePathModel(br[xn],dr,Dt)}var kn=Qe.map((function(Ne,Ge){return createDimensionModel(Ge,Ne._index,Ne._displayindex,Ne.label,Ot)}));for(dr=0;dr<xr;dr++)for(Dt=ht[dr%ht.length],mr=0;mr<kn.length;mr++){var Cn=kn[mr].containerInd,En=Rt[mr].inds[dr],Pn=kn[mr].categories;if(void 0===Pn[En]){var Dn=Ge.dimensions[Cn]._categoryarray[En],In=Ge.dimensions[Cn]._ticktext[En];Pn[En]=createCategoryModel(mr,En,Dn,In)}updateCategoryModel(Pn[En],dr,Dt)}return tt(createParcatsModel(kn,br,Ot))}},{"../../components/colorscale/calc":651,"../../components/colorscale/helpers":654,"../../components/drawing":665,"../../lib":778,"../../lib/filter_unique.js":769,"../../lib/gup":775,"fast-isnumeric":241}],1145:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../components/colorscale/helpers").hasColorscale,nt=Ne("../../components/colorscale/defaults"),at=Ne("../../plots/domain").defaults,it=Ne("../../plots/array_container_defaults"),ot=Ne("./attributes"),dt=Ne("../parcoords/merge_length");function handleLineDefaults(Ne,Ge,Qe,at,it){it("line.shape"),it("line.hovertemplate");var ot=it("line.color",at.colorway[0]);if(rt(Ne,"line")&&tt.isArrayOrTypedArray(ot)){if(ot.length)return it("line.colorscale"),nt(Ne,Ge,at,it,{prefix:"line.",cLetter:"c"}),ot.length;Ge.line.color=Qe}return 1/0}function dimensionDefaults(Ne,Ge){function coerce(Qe,rt){return tt.coerce(Ne,Ge,ot.dimensions,Qe,rt)}var Qe=coerce("values"),rt=coerce("visible");if(Qe&&Qe.length||(rt=Ge.visible=!1),rt){coerce("label"),coerce("displayindex",Ge._index);var nt,at=Ne.categoryarray,it=Array.isArray(at)&&at.length>0;it&&(nt="array");var dt=coerce("categoryorder",nt);"array"===dt?(coerce("categoryarray"),coerce("ticktext")):(delete Ne.categoryarray,delete Ne.ticktext),it||"array"!==dt||(Ge.categoryorder="trace")}}Ge.exports=function(Ne,Ge,Qe,rt){function coerce(Qe,rt){return tt.coerce(Ne,Ge,ot,Qe,rt)}var nt=it(Ne,Ge,{name:"dimensions",handleItemDefaults:dimensionDefaults}),ht=handleLineDefaults(Ne,Ge,Qe,rt,coerce);at(Ge,rt,coerce),Array.isArray(nt)&&nt.length||(Ge.visible=!1),dt(Ge,nt,"values",ht),coerce("hoveron"),coerce("hovertemplate"),coerce("arrangement"),coerce("bundlecolors"),coerce("sortpaths"),coerce("counts");var Dt={family:rt.font.family,size:Math.round(rt.font.size),color:rt.font.color};tt.coerceFont(coerce,"labelfont",Dt);var Ot={family:rt.font.family,size:Math.round(rt.font.size/1.2),color:rt.font.color};tt.coerceFont(coerce,"tickfont",Ot)}},{"../../components/colorscale/defaults":653,"../../components/colorscale/helpers":654,"../../lib":778,"../../plots/array_container_defaults":823,"../../plots/domain":855,"../parcoords/merge_length":1158,"./attributes":1142}],1146:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),calc:Ne("./calc"),plot:Ne("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcats",basePlotModule:Ne("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1142,"./base_plot":1143,"./calc":1144,"./defaults":1145,"./plot":1148}],1147:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../plot_api/plot_api"),nt=Ne("../../components/fx"),at=Ne("../../lib"),it=at.strTranslate,ot=Ne("../../components/drawing"),dt=Ne("tinycolor2"),ht=Ne("../../lib/svg_text_utils");function performPlot(Ne,Ge,Qe,rt){var nt=Ne.map(createParcatsViewModel.bind(0,Ge,Qe)),dt=rt.selectAll("g.parcatslayer").data([null]);dt.enter().append("g").attr("class","parcatslayer").style("pointer-events","all");var Dt=dt.selectAll("g.trace.parcats").data(nt,key),Ot=Dt.enter().append("g").attr("class","trace parcats");Dt.attr("transform",(function(Ne){return it(Ne.x,Ne.y)})),Ot.append("g").attr("class","paths");var Rt=Dt.select("g.paths").selectAll("path.path").data((function(Ne){return Ne.paths}),key);Rt.attr("fill",(function(Ne){return Ne.model.color}));var Zt=Rt.enter().append("path").attr("class","path").attr("stroke-opacity",0).attr("fill",(function(Ne){return Ne.model.color})).attr("fill-opacity",0);stylePathsNoHover(Zt),Rt.attr("d",(function(Ne){return Ne.svgD})),Zt.empty()||Rt.sort(compareRawColor),Rt.exit().remove(),Rt.on("mouseover",mouseoverPath).on("mouseout",mouseoutPath).on("click",clickPath),Ot.append("g").attr("class","dimensions");var er=Dt.select("g.dimensions").selectAll("g.dimension").data((function(Ne){return Ne.dimensions}),key);er.enter().append("g").attr("class","dimension"),er.attr("transform",(function(Ne){return it(Ne.x,0)})),er.exit().remove();var dr=er.selectAll("g.category").data((function(Ne){return Ne.categories}),key),mr=dr.enter().append("g").attr("class","category");dr.attr("transform",(function(Ne){return it(0,Ne.y)})),mr.append("rect").attr("class","catrect").attr("pointer-events","none"),dr.select("rect.catrect").attr("fill","none").attr("width",(function(Ne){return Ne.width})).attr("height",(function(Ne){return Ne.height})),styleCategoriesNoHover(mr);var xr=dr.selectAll("rect.bandrect").data((function(Ne){return Ne.bands}),key);xr.each((function(){at.raiseToTop(this)})),xr.attr("fill",(function(Ne){return Ne.color}));var br=xr.enter().append("rect").attr("class","bandrect").attr("stroke-opacity",0).attr("fill",(function(Ne){return Ne.color})).attr("fill-opacity",0);xr.attr("fill",(function(Ne){return Ne.color})).attr("width",(function(Ne){return Ne.width})).attr("height",(function(Ne){return Ne.height})).attr("y",(function(Ne){return Ne.y})).attr("cursor",(function(Ne){return"fixed"===Ne.parcatsViewModel.arrangement?"default":"perpendicular"===Ne.parcatsViewModel.arrangement?"ns-resize":"move"})),styleBandsNoHover(br),xr.exit().remove(),mr.append("text").attr("class","catlabel").attr("pointer-events","none");var Ar=Ge._fullLayout.paper_bgcolor;dr.select("text.catlabel").attr("text-anchor",(function(Ne){return catInRightDim(Ne)?"start":"end"})).attr("alignment-baseline","middle").style("text-shadow",Ar+" -1px  1px 2px, "+Ar+" 1px  1px 2px, "+Ar+"  1px -1px 2px, "+Ar+" -1px -1px 2px").style("fill","rgb(0, 0, 0)").attr("x",(function(Ne){return catInRightDim(Ne)?Ne.width+5:-5})).attr("y",(function(Ne){return Ne.height/2})).text((function(Ne){return Ne.model.categoryLabel})).each((function(Ne){ot.font(tt.select(this),Ne.parcatsViewModel.categorylabelfont),ht.convertToTspans(tt.select(this),Ge)})),mr.append("text").attr("class","dimlabel"),dr.select("text.dimlabel").attr("text-anchor","middle").attr("alignment-baseline","baseline").attr("cursor",(function(Ne){return"fixed"===Ne.parcatsViewModel.arrangement?"default":"ew-resize"})).attr("x",(function(Ne){return Ne.width/2})).attr("y",-5).text((function(Ne,Ge){return 0===Ge?Ne.parcatsViewModel.model.dimensions[Ne.model.dimensionInd].dimensionLabel:null})).each((function(Ne){ot.font(tt.select(this),Ne.parcatsViewModel.labelfont)})),dr.selectAll("rect.bandrect").on("mouseover",mouseoverCategoryBand).on("mouseout",mouseoutCategory),dr.exit().remove(),er.call(tt.behavior.drag().origin((function(Ne){return{x:Ne.x,y:0}})).on("dragstart",dragDimensionStart).on("drag",dragDimension).on("dragend",dragDimensionEnd)),Dt.each((function(Ne){Ne.traceSelection=tt.select(this),Ne.pathSelection=tt.select(this).selectAll("g.paths").selectAll("path.path"),Ne.dimensionSelection=tt.select(this).selectAll("g.dimensions").selectAll("g.dimension")})),Dt.exit().remove()}function key(Ne){return Ne.key}function catInRightDim(Ne){var Ge=Ne.parcatsViewModel.dimensions.length,Qe=Ne.parcatsViewModel.dimensions[Ge-1].model.dimensionInd;return Ne.model.dimensionInd===Qe}function compareRawColor(Ne,Ge){return Ne.model.rawColor>Ge.model.rawColor?1:Ne.model.rawColor<Ge.model.rawColor?-1:0}function mouseoverPath(Ne){if(!Ne.parcatsViewModel.dragDimension&&-1===Ne.parcatsViewModel.hoverinfoItems.indexOf("skip")){at.raiseToTop(this),stylePathsHover(tt.select(this));var Ge=buildPointsArrayForPath(Ne),Qe=buildConstraintsForPath(Ne);if(Ne.parcatsViewModel.graphDiv.emit("plotly_hover",{points:Ge,event:tt.event,constraints:Qe}),-1===Ne.parcatsViewModel.hoverinfoItems.indexOf("none")){var rt,it,ot,ht=tt.mouse(this)[0],Dt=Ne.parcatsViewModel.graphDiv,Ot=Ne.parcatsViewModel.trace,Rt=Dt._fullLayout,Zt=Rt._paperdiv.node().getBoundingClientRect(),er=Ne.parcatsViewModel.graphDiv.getBoundingClientRect();for(ot=0;ot<Ne.leftXs.length-1;ot++)if(Ne.leftXs[ot]+Ne.dimWidths[ot]-2<=ht&&ht<=Ne.leftXs[ot+1]+2){var dr=Ne.parcatsViewModel.dimensions[ot],mr=Ne.parcatsViewModel.dimensions[ot+1];rt=(dr.x+dr.width+mr.x)/2,it=(Ne.topYs[ot]+Ne.topYs[ot+1]+Ne.height)/2;break}var xr=Ne.parcatsViewModel.x+rt,br=Ne.parcatsViewModel.y+it,Ar=dt.mostReadable(Ne.model.color,["black","white"]),en=Ne.model.count,mn=en/Ne.parcatsViewModel.model.count,xn={countLabel:en,probabilityLabel:mn.toFixed(3)},kn=[];-1!==Ne.parcatsViewModel.hoverinfoItems.indexOf("count")&&kn.push(["Count:",xn.countLabel].join(" ")),-1!==Ne.parcatsViewModel.hoverinfoItems.indexOf("probability")&&kn.push(["P:",xn.probabilityLabel].join(" "));var Cn=kn.join("<br>"),En=tt.mouse(Dt)[0];nt.loneHover({trace:Ot,x:xr-Zt.left+er.left,y:br-Zt.top+er.top,text:Cn,color:Ne.model.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:10,fontColor:Ar,idealAlign:En<xr?"right":"left",hovertemplate:(Ot.line||{}).hovertemplate,hovertemplateLabels:xn,eventData:[{data:Ot._input,fullData:Ot,count:en,probability:mn}]},{container:Rt._hoverlayer.node(),outerContainer:Rt._paper.node(),gd:Dt})}}}function mouseoutPath(Ne){if(!Ne.parcatsViewModel.dragDimension&&(stylePathsNoHover(tt.select(this)),nt.loneUnhover(Ne.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()),Ne.parcatsViewModel.pathSelection.sort(compareRawColor),-1===Ne.parcatsViewModel.hoverinfoItems.indexOf("skip"))){var Ge=buildPointsArrayForPath(Ne),Qe=buildConstraintsForPath(Ne);Ne.parcatsViewModel.graphDiv.emit("plotly_unhover",{points:Ge,event:tt.event,constraints:Qe})}}function buildPointsArrayForPath(Ne){for(var Ge=[],Qe=getTraceIndex(Ne.parcatsViewModel),tt=0;tt<Ne.model.valueInds.length;tt++){var rt=Ne.model.valueInds[tt];Ge.push({curveNumber:Qe,pointNumber:rt})}return Ge}function buildConstraintsForPath(Ne){for(var Ge={},Qe=Ne.parcatsViewModel.model.dimensions,tt=0;tt<Qe.length;tt++){var rt=Qe[tt],nt=rt.categories[Ne.model.categoryInds[tt]];Ge[rt.containerInd]=nt.categoryValue}return void 0!==Ne.model.rawColor&&(Ge.color=Ne.model.rawColor),Ge}function clickPath(Ne){if(-1===Ne.parcatsViewModel.hoverinfoItems.indexOf("skip")){var Ge=buildPointsArrayForPath(Ne),Qe=buildConstraintsForPath(Ne);Ne.parcatsViewModel.graphDiv.emit("plotly_click",{points:Ge,event:tt.event,constraints:Qe})}}function stylePathsNoHover(Ne){Ne.attr("fill",(function(Ne){return Ne.model.color})).attr("fill-opacity",.6).attr("stroke","lightgray").attr("stroke-width",.2).attr("stroke-opacity",1)}function stylePathsHover(Ne){Ne.attr("fill-opacity",.8).attr("stroke",(function(Ne){return dt.mostReadable(Ne.model.color,["black","white"])})).attr("stroke-width",.3)}function styleCategoryHover(Ne){Ne.select("rect.catrect").attr("stroke","black").attr("stroke-width",2.5)}function styleCategoriesNoHover(Ne){Ne.select("rect.catrect").attr("stroke","black").attr("stroke-width",1).attr("stroke-opacity",1)}function styleBandsHover(Ne){Ne.attr("stroke","black").attr("stroke-width",1.5)}function styleBandsNoHover(Ne){Ne.attr("stroke","black").attr("stroke-width",.2).attr("stroke-opacity",1).attr("fill-opacity",1)}function selectPathsThroughCategoryBandColor(Ne){var Ge=Ne.parcatsViewModel.pathSelection,Qe=Ne.categoryViewModel.model.dimensionInd,tt=Ne.categoryViewModel.model.categoryInd;return Ge.filter((function(Ge){return Ge.model.categoryInds[Qe]===tt&&Ge.model.color===Ne.color}))}function styleForCategoryHovermode(Ne){tt.select(Ne.parentNode).selectAll("rect.bandrect").each((function(Ne){var Ge=selectPathsThroughCategoryBandColor(Ne);stylePathsHover(Ge),Ge.each((function(){at.raiseToTop(this)}))})),styleCategoryHover(tt.select(Ne.parentNode))}function styleForColorHovermode(Ne){var Ge=tt.select(Ne).datum(),Qe=selectPathsThroughCategoryBandColor(Ge);stylePathsHover(Qe),Qe.each((function(){at.raiseToTop(this)})),tt.select(Ne.parentNode).selectAll("rect.bandrect").filter((function(Ne){return Ne.color===Ge.color})).each((function(){at.raiseToTop(this),styleBandsHover(tt.select(this))}))}function emitPointsEventCategoryHovermode(Ne,Ge,Qe){var rt=tt.select(Ne).datum(),nt=rt.categoryViewModel.model,at=rt.parcatsViewModel.graphDiv,it=tt.select(Ne.parentNode).selectAll("rect.bandrect"),ot=[];it.each((function(Ne){selectPathsThroughCategoryBandColor(Ne).each((function(Ne){Array.prototype.push.apply(ot,buildPointsArrayForPath(Ne))}))}));var dt={};dt[nt.dimensionInd]=nt.categoryValue,at.emit(Ge,{points:ot,event:Qe,constraints:dt})}function emitPointsEventColorHovermode(Ne,Ge,Qe){var rt=tt.select(Ne).datum(),nt=rt.categoryViewModel.model,at=rt.parcatsViewModel.graphDiv,it=selectPathsThroughCategoryBandColor(rt),ot=[];it.each((function(Ne){Array.prototype.push.apply(ot,buildPointsArrayForPath(Ne))}));var dt={};dt[nt.dimensionInd]=nt.categoryValue,void 0!==rt.rawColor&&(dt.color=rt.rawColor),at.emit(Ge,{points:ot,event:Qe,constraints:dt})}function createHoverLabelForCategoryHovermode(Ne,Ge,Qe){Ne._fullLayout._calcInverseTransform(Ne);var rt,nt,at=Ne._fullLayout._invScaleX,it=Ne._fullLayout._invScaleY,ot=tt.select(Qe.parentNode).select("rect.catrect"),dt=ot.node().getBoundingClientRect(),ht=ot.datum(),Dt=ht.parcatsViewModel,Ot=Dt.model.dimensions[ht.model.dimensionInd],Rt=Dt.trace,Zt=dt.top+dt.height/2;Dt.dimensions.length>1&&Ot.displayInd===Dt.dimensions.length-1?(rt=dt.left,nt="left"):(rt=dt.left+dt.width,nt="right");var er=ht.model.count,dr=ht.model.categoryLabel,mr=er/ht.parcatsViewModel.model.count,xr={countLabel:er,categoryLabel:dr,probabilityLabel:mr.toFixed(3)},br=[];-1!==ht.parcatsViewModel.hoverinfoItems.indexOf("count")&&br.push(["Count:",xr.countLabel].join(" ")),-1!==ht.parcatsViewModel.hoverinfoItems.indexOf("probability")&&br.push(["P("+xr.categoryLabel+"):",xr.probabilityLabel].join(" "));var Ar=br.join("<br>");return{trace:Rt,x:at*(rt-Ge.left),y:it*(Zt-Ge.top),text:Ar,color:"lightgray",borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontSize:12,fontColor:"black",idealAlign:nt,hovertemplate:Rt.hovertemplate,hovertemplateLabels:xr,eventData:[{data:Rt._input,fullData:Rt,count:er,category:dr,probability:mr}]}}function createHoverLabelForDimensionHovermode(Ne,Ge,Qe){var rt=[];return tt.select(Qe.parentNode.parentNode).selectAll("g.category").select("rect.catrect").each((function(){var Qe=this;rt.push(createHoverLabelForCategoryHovermode(Ne,Ge,Qe))})),rt}function createHoverLabelForColorHovermode(Ne,Ge,Qe){Ne._fullLayout._calcInverseTransform(Ne);var rt,nt,at=Ne._fullLayout._invScaleX,it=Ne._fullLayout._invScaleY,ot=Qe.getBoundingClientRect(),ht=tt.select(Qe).datum(),Dt=ht.categoryViewModel,Ot=Dt.parcatsViewModel,Rt=Ot.model.dimensions[Dt.model.dimensionInd],Zt=Ot.trace,er=ot.y+ot.height/2;Ot.dimensions.length>1&&Rt.displayInd===Ot.dimensions.length-1?(rt=ot.left,nt="left"):(rt=ot.left+ot.width,nt="right");var dr=Dt.model.categoryLabel,mr=ht.parcatsViewModel.model.count,xr=0;ht.categoryViewModel.bands.forEach((function(Ne){Ne.color===ht.color&&(xr+=Ne.count)}));var br=Dt.model.count,Ar=0;Ot.pathSelection.each((function(Ne){Ne.model.color===ht.color&&(Ar+=Ne.model.count)}));var en=xr/mr,mn=xr/Ar,xn=xr/br,kn={countLabel:mr,categoryLabel:dr,probabilityLabel:en.toFixed(3)},Cn=[];-1!==Dt.parcatsViewModel.hoverinfoItems.indexOf("count")&&Cn.push(["Count:",kn.countLabel].join(" ")),-1!==Dt.parcatsViewModel.hoverinfoItems.indexOf("probability")&&(Cn.push("P(color â© "+dr+"): "+kn.probabilityLabel),Cn.push("P("+dr+" | color): "+mn.toFixed(3)),Cn.push("P(color | "+dr+"): "+xn.toFixed(3)));var En=Cn.join("<br>"),Pn=dt.mostReadable(ht.color,["black","white"]);return{trace:Zt,x:at*(rt-Ge.left),y:it*(er-Ge.top),text:En,color:ht.color,borderColor:"black",fontFamily:'Monaco, "Courier New", monospace',fontColor:Pn,fontSize:10,idealAlign:nt,hovertemplate:Zt.hovertemplate,hovertemplateLabels:kn,eventData:[{data:Zt._input,fullData:Zt,category:dr,count:mr,probability:en,categorycount:br,colorcount:Ar,bandcolorcount:xr}]}}function mouseoverCategoryBand(Ne){if(!Ne.parcatsViewModel.dragDimension&&-1===Ne.parcatsViewModel.hoverinfoItems.indexOf("skip")){if(tt.mouse(this)[1]<-1)return;var Ge,Qe=Ne.parcatsViewModel.graphDiv,rt=Qe._fullLayout,at=rt._paperdiv.node().getBoundingClientRect(),it=Ne.parcatsViewModel.hoveron,ot=this;"color"===it?(styleForColorHovermode(ot),emitPointsEventColorHovermode(ot,"plotly_hover",tt.event)):(styleForCategoryHovermode(ot),emitPointsEventCategoryHovermode(ot,"plotly_hover",tt.event)),-1===Ne.parcatsViewModel.hoverinfoItems.indexOf("none")&&("category"===it?Ge=createHoverLabelForCategoryHovermode(Qe,at,ot):"color"===it?Ge=createHoverLabelForColorHovermode(Qe,at,ot):"dimension"===it&&(Ge=createHoverLabelForDimensionHovermode(Qe,at,ot)),Ge&&nt.loneHover(Ge,{container:rt._hoverlayer.node(),outerContainer:rt._paper.node(),gd:Qe}))}}function mouseoutCategory(Ne){var Ge=Ne.parcatsViewModel;if(!Ge.dragDimension&&(stylePathsNoHover(Ge.pathSelection),styleCategoriesNoHover(Ge.dimensionSelection.selectAll("g.category")),styleBandsNoHover(Ge.dimensionSelection.selectAll("g.category").selectAll("rect.bandrect")),nt.loneUnhover(Ge.graphDiv._fullLayout._hoverlayer.node()),Ge.pathSelection.sort(compareRawColor),-1===Ge.hoverinfoItems.indexOf("skip"))){var Qe=this;"color"===Ne.parcatsViewModel.hoveron?emitPointsEventColorHovermode(Qe,"plotly_unhover",tt.event):emitPointsEventCategoryHovermode(Qe,"plotly_unhover",tt.event)}}function dragDimensionStart(Ne){"fixed"!==Ne.parcatsViewModel.arrangement&&(Ne.dragDimensionDisplayInd=Ne.model.displayInd,Ne.initialDragDimensionDisplayInds=Ne.parcatsViewModel.model.dimensions.map((function(Ne){return Ne.displayInd})),Ne.dragHasMoved=!1,Ne.dragCategoryDisplayInd=null,tt.select(this).selectAll("g.category").select("rect.catrect").each((function(Ge){var Qe=tt.mouse(this)[0],rt=tt.mouse(this)[1];-2<=Qe&&Qe<=Ge.width+2&&-2<=rt&&rt<=Ge.height+2&&(Ne.dragCategoryDisplayInd=Ge.model.displayInd,Ne.initialDragCategoryDisplayInds=Ne.model.categories.map((function(Ne){return Ne.displayInd})),Ge.model.dragY=Ge.y,at.raiseToTop(this.parentNode),tt.select(this.parentNode).selectAll("rect.bandrect").each((function(Ge){Ge.y<rt&&rt<=Ge.y+Ge.height&&(Ne.potentialClickBand=this)})))})),Ne.parcatsViewModel.dragDimension=Ne,nt.loneUnhover(Ne.parcatsViewModel.graphDiv._fullLayout._hoverlayer.node()))}function dragDimension(Ne){if("fixed"!==Ne.parcatsViewModel.arrangement&&(Ne.dragHasMoved=!0,null!==Ne.dragDimensionDisplayInd)){var Ge=Ne.dragDimensionDisplayInd,Qe=Ge-1,rt=Ge+1,nt=Ne.parcatsViewModel.dimensions[Ge];if(null!==Ne.dragCategoryDisplayInd){var at=nt.categories[Ne.dragCategoryDisplayInd];at.model.dragY+=tt.event.dy;var it=at.model.dragY,ot=at.model.displayInd,dt=nt.categories,ht=dt[ot-1],Dt=dt[ot+1];void 0!==ht&&it<ht.y+ht.height/2&&(at.model.displayInd=ht.model.displayInd,ht.model.displayInd=ot),void 0!==Dt&&it+at.height>Dt.y+Dt.height/2&&(at.model.displayInd=Dt.model.displayInd,Dt.model.displayInd=ot),Ne.dragCategoryDisplayInd=at.model.displayInd}if(null===Ne.dragCategoryDisplayInd||"freeform"===Ne.parcatsViewModel.arrangement){nt.model.dragX=tt.event.x;var Ot=Ne.parcatsViewModel.dimensions[Qe],Rt=Ne.parcatsViewModel.dimensions[rt];void 0!==Ot&&nt.model.dragX<Ot.x+Ot.width&&(nt.model.displayInd=Ot.model.displayInd,Ot.model.displayInd=Ge),void 0!==Rt&&nt.model.dragX+nt.width>Rt.x&&(nt.model.displayInd=Rt.model.displayInd,Rt.model.displayInd=Ne.dragDimensionDisplayInd),Ne.dragDimensionDisplayInd=nt.model.displayInd}updateDimensionViewModels(Ne.parcatsViewModel),updatePathViewModels(Ne.parcatsViewModel),updateSvgCategories(Ne.parcatsViewModel),updateSvgPaths(Ne.parcatsViewModel)}}function dragDimensionEnd(Ne){if("fixed"!==Ne.parcatsViewModel.arrangement&&null!==Ne.dragDimensionDisplayInd){tt.select(this).selectAll("text").attr("font-weight","normal");var Ge={},Qe=getTraceIndex(Ne.parcatsViewModel),nt=Ne.parcatsViewModel.model.dimensions.map((function(Ne){return Ne.displayInd})),at=Ne.initialDragDimensionDisplayInds.some((function(Ne,Ge){return Ne!==nt[Ge]}));at&&nt.forEach((function(Qe,tt){var rt=Ne.parcatsViewModel.model.dimensions[tt].containerInd;Ge["dimensions["+rt+"].displayindex"]=Qe}));var it=!1;if(null!==Ne.dragCategoryDisplayInd){var ot=Ne.model.categories.map((function(Ne){return Ne.displayInd}));if(it=Ne.initialDragCategoryDisplayInds.some((function(Ne,Ge){return Ne!==ot[Ge]}))){var dt=Ne.model.categories.slice().sort((function(Ne,Ge){return Ne.displayInd-Ge.displayInd})),ht=dt.map((function(Ne){return Ne.categoryValue})),Dt=dt.map((function(Ne){return Ne.categoryLabel}));Ge["dimensions["+Ne.model.containerInd+"].categoryarray"]=[ht],Ge["dimensions["+Ne.model.containerInd+"].ticktext"]=[Dt],Ge["dimensions["+Ne.model.containerInd+"].categoryorder"]="array"}}-1===Ne.parcatsViewModel.hoverinfoItems.indexOf("skip")&&!Ne.dragHasMoved&&Ne.potentialClickBand&&("color"===Ne.parcatsViewModel.hoveron?emitPointsEventColorHovermode(Ne.potentialClickBand,"plotly_click",tt.event.sourceEvent):emitPointsEventCategoryHovermode(Ne.potentialClickBand,"plotly_click",tt.event.sourceEvent)),Ne.model.dragX=null,null!==Ne.dragCategoryDisplayInd&&(Ne.parcatsViewModel.dimensions[Ne.dragDimensionDisplayInd].categories[Ne.dragCategoryDisplayInd].model.dragY=null,Ne.dragCategoryDisplayInd=null),Ne.dragDimensionDisplayInd=null,Ne.parcatsViewModel.dragDimension=null,Ne.dragHasMoved=null,Ne.potentialClickBand=null,updateDimensionViewModels(Ne.parcatsViewModel),updatePathViewModels(Ne.parcatsViewModel),tt.transition().duration(300).ease("cubic-in-out").each((function(){updateSvgCategories(Ne.parcatsViewModel,!0),updateSvgPaths(Ne.parcatsViewModel,!0)})).each("end",(function(){(at||it)&&rt.restyle(Ne.parcatsViewModel.graphDiv,Ge,[Qe])}))}}function getTraceIndex(Ne){for(var Ge,Qe=Ne.graphDiv._fullData,tt=0;tt<Qe.length;tt++)if(Ne.key===Qe[tt].uid){Ge=tt;break}return Ge}function updateSvgPaths(Ne,Ge){function transition(Ne){return Ge?Ne.transition():Ne}void 0===Ge&&(Ge=!1),Ne.pathSelection.data((function(Ne){return Ne.paths}),key),transition(Ne.pathSelection).attr("d",(function(Ne){return Ne.svgD}))}function updateSvgCategories(Ne,Ge){function transition(Ne){return Ge?Ne.transition():Ne}void 0===Ge&&(Ge=!1),Ne.dimensionSelection.data((function(Ne){return Ne.dimensions}),key);var Qe=Ne.dimensionSelection.selectAll("g.category").data((function(Ne){return Ne.categories}),key);transition(Ne.dimensionSelection).attr("transform",(function(Ne){return it(Ne.x,0)})),transition(Qe).attr("transform",(function(Ne){return it(0,Ne.y)})),Qe.select(".dimlabel").text((function(Ne,Ge){return 0===Ge?Ne.parcatsViewModel.model.dimensions[Ne.model.dimensionInd].dimensionLabel:null})),Qe.select(".catlabel").attr("text-anchor",(function(Ne){return catInRightDim(Ne)?"start":"end"})).attr("x",(function(Ne){return catInRightDim(Ne)?Ne.width+5:-5})).each((function(Ne){var Ge,Qe;catInRightDim(Ne)?(Ge=Ne.width+5,Qe="start"):(Ge=-5,Qe="end"),tt.select(this).selectAll("tspan").attr("x",Ge).attr("text-anchor",Qe)}));var rt=Qe.selectAll("rect.bandrect").data((function(Ne){return Ne.bands}),key),nt=rt.enter().append("rect").attr("class","bandrect").attr("cursor","move").attr("stroke-opacity",0).attr("fill",(function(Ne){return Ne.color})).attr("fill-opacity",0);rt.attr("fill",(function(Ne){return Ne.color})).attr("width",(function(Ne){return Ne.width})).attr("height",(function(Ne){return Ne.height})).attr("y",(function(Ne){return Ne.y})),styleBandsNoHover(nt),rt.each((function(){at.raiseToTop(this)})),rt.exit().remove()}function createParcatsViewModel(Ne,Ge,Qe){var tt,rt=Qe[0],nt=Ge.margin||{l:80,r:80,t:100,b:80},at=rt.trace,it=at.domain,ot=Ge.width,dt=Ge.height,ht=Math.floor(ot*(it.x[1]-it.x[0])),Dt=Math.floor(dt*(it.y[1]-it.y[0])),Ot=it.x[0]*ot+nt.l,Rt=Ge.height-it.y[1]*Ge.height+nt.t,Zt=at.line.shape;tt="all"===at.hoverinfo?["count","probability"]:(at.hoverinfo||"").split("+");var er={trace:at,key:at.uid,model:rt,x:Ot,y:Rt,width:ht,height:Dt,hoveron:at.hoveron,hoverinfoItems:tt,arrangement:at.arrangement,bundlecolors:at.bundlecolors,sortpaths:at.sortpaths,labelfont:at.labelfont,categorylabelfont:at.tickfont,pathShape:Zt,dragDimension:null,margin:nt,paths:[],dimensions:[],graphDiv:Ne,traceSelection:null,pathSelection:null,dimensionSelection:null};return rt.dimensions&&(updateDimensionViewModels(er),updatePathViewModels(er)),er}function buildSvgPath(Ne,Ge,Qe,rt,nt){var at,it,ot=[],dt=[];for(it=0;it<Qe.length-1;it++)at=tt.interpolateNumber(Qe[it]+Ne[it],Ne[it+1]),ot.push(at(nt)),dt.push(at(1-nt));var ht="M "+Ne[0]+","+Ge[0];for(ht+="l"+Qe[0]+",0 ",it=1;it<Qe.length;it++)ht+="C"+ot[it-1]+","+Ge[it-1]+" "+dt[it-1]+","+Ge[it]+" "+Ne[it]+","+Ge[it],ht+="l"+Qe[it]+",0 ";for(ht+="l0,"+rt+" ",ht+="l -"+Qe[Qe.length-1]+",0 ",it=Qe.length-2;it>=0;it--)ht+="C"+dt[it]+","+(Ge[it+1]+rt)+" "+ot[it]+","+(Ge[it]+rt)+" "+(Ne[it]+Qe[it])+","+(Ge[it]+rt),ht+="l-"+Qe[it]+",0 ";return ht+="Z"}function updatePathViewModels(Ne){var Ge=Ne.dimensions,Qe=Ne.model,tt=Ge.map((function(Ne){return Ne.categories.map((function(Ne){return Ne.y}))})),rt=Ne.model.dimensions.map((function(Ne){return Ne.categories.map((function(Ne){return Ne.displayInd}))})),nt=Ne.model.dimensions.map((function(Ne){return Ne.displayInd})),at=Ne.dimensions.map((function(Ne){return Ne.model.dimensionInd})),it=Ge.map((function(Ne){return Ne.x})),ot=Ge.map((function(Ne){return Ne.width})),dt=[];for(var ht in Qe.paths)Qe.paths.hasOwnProperty(ht)&&dt.push(Qe.paths[ht]);function pathDisplayCategoryInds(Ne){var Ge=Ne.categoryInds.map((function(Ne,Ge){return rt[Ge][Ne]}));return at.map((function(Ne){return Ge[Ne]}))}dt.sort((function(Ge,Qe){var tt=pathDisplayCategoryInds(Ge),rt=pathDisplayCategoryInds(Qe);return"backward"===Ne.sortpaths&&(tt.reverse(),rt.reverse()),tt.push(Ge.valueInds[0]),rt.push(Qe.valueInds[0]),Ne.bundlecolors&&(tt.unshift(Ge.rawColor),rt.unshift(Qe.rawColor)),tt<rt?-1:tt>rt?1:0}));for(var Dt=new Array(dt.length),Ot=Ge[0].model.count,Rt=Ge[0].categories.map((function(Ne){return Ne.height})).reduce((function(Ne,Ge){return Ne+Ge})),Zt=0;Zt<dt.length;Zt++){var er,dr=dt[Zt];er=Ot>0?Rt*(dr.count/Ot):0;for(var mr,xr=new Array(tt.length),br=0;br<dr.categoryInds.length;br++){var Ar=dr.categoryInds[br],en=rt[br][Ar],mn=nt[br];xr[mn]=tt[mn][en],tt[mn][en]+=er;var xn=Ne.dimensions[mn].categories[en],kn=xn.bands.length,Cn=xn.bands[kn-1];if(void 0===Cn||dr.rawColor!==Cn.rawColor){var En=void 0===Cn?0:Cn.y+Cn.height;xn.bands.push({key:En,color:dr.color,rawColor:dr.rawColor,height:er,width:xn.width,count:dr.count,y:En,categoryViewModel:xn,parcatsViewModel:Ne})}else{var Pn=xn.bands[kn-1];Pn.height+=er,Pn.count+=dr.count}}mr="hspline"===Ne.pathShape?buildSvgPath(it,xr,ot,er,.5):buildSvgPath(it,xr,ot,er,0),Dt[Zt]={key:dr.valueInds[0],model:dr,height:er,leftXs:it,topYs:xr,dimWidths:ot,svgD:mr,parcatsViewModel:Ne}}Ne.paths=Dt}function updateDimensionViewModels(Ne){var Ge=Ne.model.dimensions.map((function(Ne){return{displayInd:Ne.displayInd,dimensionInd:Ne.dimensionInd}}));Ge.sort((function(Ne,Ge){return Ne.displayInd-Ge.displayInd}));var Qe=[];for(var tt in Ge){var rt=Ge[tt].dimensionInd,nt=Ne.model.dimensions[rt];Qe.push(createDimensionViewModel(Ne,nt))}Ne.dimensions=Qe}function createDimensionViewModel(Ne,Ge){var Qe,tt=40,rt=16,nt=Ne.model.dimensions.length,at=Ge.displayInd;Qe=tt+(nt>1?(Ne.width-2*tt-rt)/(nt-1):0)*at;var it,ot,dt,ht,Dt,Ot=[],Rt=Ne.model.maxCats,Zt=Ge.categories.length,er=8,dr=Ge.count,mr=Ne.height-er*(Rt-1),xr=(Rt-Zt)*er/2,br=Ge.categories.map((function(Ne){return{displayInd:Ne.displayInd,categoryInd:Ne.categoryInd}}));for(br.sort((function(Ne,Ge){return Ne.displayInd-Ge.displayInd})),Dt=0;Dt<Zt;Dt++)ht=br[Dt].categoryInd,ot=Ge.categories[ht],it=dr>0?ot.count/dr*mr:0,dt={key:ot.valueInds[0],model:ot,width:rt,height:it,y:null!==ot.dragY?ot.dragY:xr,bands:[],parcatsViewModel:Ne},xr=xr+it+er,Ot.push(dt);return{key:Ge.dimensionInd,x:null!==Ge.dragX?Ge.dragX:Qe,y:0,width:rt,model:Ge,categories:Ot,parcatsViewModel:Ne,dragCategoryDisplayInd:null,dragDimensionDisplayInd:null,initialDragDimensionDisplayInds:null,initialDragCategoryDisplayInds:null,dragHasMoved:null,potentialClickBand:null}}Ge.exports=function(Ne,Ge,Qe,tt){performPlot(Qe,Ne,tt,Ge)}},{"../../components/drawing":665,"../../components/fx":683,"../../lib":778,"../../lib/svg_text_utils":803,"../../plot_api/plot_api":814,d3:169,tinycolor2:576}],1148:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./parcats");Ge.exports=function(Ne,Ge,Qe,rt){var nt=Ne._fullLayout,at=nt._paper,it=nt._size;tt(Ne,at,Ge,{width:it.w,height:it.h,margin:{t:it.t,r:it.r,b:it.b,l:it.l}},Qe,rt)}},{"./parcats":1147}],1149:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/colorscale/attributes"),rt=Ne("../../plots/cartesian/layout_attributes"),nt=Ne("../../plots/font_attributes"),at=Ne("../../plots/domain").attributes,it=Ne("../../lib/extend").extendFlat,ot=Ne("../../plot_api/plot_template").templatedArray;Ge.exports={domain:at({name:"parcoords",trace:!0,editType:"plot"}),labelangle:{valType:"angle",dflt:0,editType:"plot"},labelside:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},labelfont:nt({editType:"plot"}),tickfont:nt({editType:"plot"}),rangefont:nt({editType:"plot"}),dimensions:ot("dimension",{label:{valType:"string",editType:"plot"},tickvals:it({},rt.tickvals,{editType:"plot"}),ticktext:it({},rt.ticktext,{editType:"plot"}),tickformat:it({},rt.tickformat,{editType:"plot"}),visible:{valType:"boolean",dflt:!0,editType:"plot"},range:{valType:"info_array",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},constraintrange:{valType:"info_array",freeLength:!0,dimensions:"1-2",items:[{valType:"number",editType:"plot"},{valType:"number",editType:"plot"}],editType:"plot"},multiselect:{valType:"boolean",dflt:!0,editType:"plot"},values:{valType:"data_array",editType:"calc"},editType:"calc"}),line:it({editType:"calc"},tt("line",{colorscaleDflt:"Viridis",autoColorDflt:!1,editTypeOverride:"calc"}))}},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plot_api/plot_template":817,"../../plots/cartesian/layout_attributes":842,"../../plots/domain":855,"../../plots/font_attributes":856}],1150:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./constants"),rt=Ne("d3"),nt=Ne("../../lib/gup").keyFun,at=Ne("../../lib/gup").repeat,it=Ne("../../lib").sorterAsc,ot=Ne("../../lib").strTranslate,dt=tt.bar.snapRatio;function snapOvershoot(Ne,Ge){return Ne*(1-dt)+Ge*dt}var ht=tt.bar.snapClose;function closeToCovering(Ne,Ge){return Ne*(1-ht)+Ge*ht}function ordinalScaleSnap(Ne,Ge,Qe,tt){if(overlappingExisting(Qe,tt))return Qe;var rt=Ne?-1:1,nt=0,at=Ge.length-1;if(rt<0){var it=nt;nt=at,at=it}for(var ot=Ge[nt],dt=ot,ht=nt;rt*ht<rt*at;ht+=rt){var Dt=ht+rt,Ot=Ge[Dt];if(rt*Qe<rt*closeToCovering(ot,Ot))return snapOvershoot(ot,dt);if(rt*Qe<rt*Ot||Dt===at)return snapOvershoot(Ot,ot);dt=ot,ot=Ot}}function overlappingExisting(Ne,Ge){for(var Qe=0;Qe<Ge.length;Qe++)if(Ne>=Ge[Qe][0]&&Ne<=Ge[Qe][1])return!0;return!1}function barHorizontalSetup(Ne){Ne.attr("x",-tt.bar.captureWidth/2).attr("width",tt.bar.captureWidth)}function backgroundBarHorizontalSetup(Ne){Ne.attr("visibility","visible").style("visibility","visible").attr("fill","yellow").attr("opacity",0)}function setHighlight(Ne){if(!Ne.brush.filterSpecified)return"0,"+Ne.height;for(var Ge,Qe,tt,rt=unitToPx(Ne.brush.filter.getConsolidated(),Ne.height),nt=[0],at=rt.length?rt[0][0]:null,it=0;it<rt.length;it++)Qe=(Ge=rt[it])[1]-Ge[0],nt.push(at),nt.push(Qe),(tt=it+1)<rt.length&&(at=rt[tt][0]-Ge[1]);return nt.push(Ne.height),nt}function unitToPx(Ne,Ge){return Ne.map((function(Ne){return Ne.map((function(Ne){return Math.max(0,Ne*Ge)})).sort(it)}))}function getRegion(Ne,Ge){var Qe=tt.bar.handleHeight;if(!(Ge>Ne[1]+Qe||Ge<Ne[0]-Qe))return Ge>=.9*Ne[1]+.1*Ne[0]?"n":Ge<=.9*Ne[0]+.1*Ne[1]?"s":"ns"}function clearCursor(){rt.select(document.body).style("cursor",null)}function styleHighlight(Ne){Ne.attr("stroke-dasharray",setHighlight)}function renderHighlight(Ne,Ge){var Qe=rt.select(Ne).selectAll(".highlight, .highlight-shadow");styleHighlight(Ge?Qe.transition().duration(tt.bar.snapDuration).each("end",Ge):Qe)}function getInterval(Ne,Ge){var Qe,tt=Ne.brush,rt=NaN,nt={};if(tt.filterSpecified){var at=Ne.height,it=tt.filter.getConsolidated(),ot=unitToPx(it,at),dt=NaN,ht=NaN,Dt=NaN;for(Qe=0;Qe<=ot.length;Qe++){var Ot=ot[Qe];if(Ot&&Ot[0]<=Ge&&Ge<=Ot[1]){dt=Qe;break}if(ht=Qe?Qe-1:NaN,Ot&&Ot[0]>Ge){Dt=Qe;break}}if(rt=dt,isNaN(rt)&&(rt=isNaN(ht)||isNaN(Dt)?isNaN(ht)?Dt:ht:Ge-ot[ht][1]<ot[Dt][0]-Ge?ht:Dt),!isNaN(rt)){var Rt=ot[rt],Zt=getRegion(Rt,Ge);Zt&&(nt.interval=it[rt],nt.intervalPix=Rt,nt.region=Zt)}}if(Ne.ordinal&&!nt.region){var er=Ne.unitTickvals,dr=Ne.unitToPaddedPx.invert(Ge);for(Qe=0;Qe<er.length;Qe++){var mr=[.25*er[Math.max(Qe-1,0)]+.75*er[Qe],.25*er[Math.min(Qe+1,er.length-1)]+.75*er[Qe]];if(dr>=mr[0]&&dr<=mr[1]){nt.clickableOrdinalRange=mr;break}}}return nt}function dragstart(Ne,Ge){rt.event.sourceEvent.stopPropagation();var Qe=Ge.height-rt.mouse(Ne)[1]-2*tt.verticalPadding,nt=Ge.unitToPaddedPx.invert(Qe),at=Ge.brush,it=getInterval(Ge,Qe),ot=it.interval,dt=at.svgBrush;if(dt.wasDragged=!1,dt.grabbingBar="ns"===it.region,dt.grabbingBar){var ht=ot.map(Ge.unitToPaddedPx);dt.grabPoint=Qe-ht[0]-tt.verticalPadding,dt.barLength=ht[1]-ht[0]}dt.clickableOrdinalRange=it.clickableOrdinalRange,dt.stayingIntervals=Ge.multiselect&&at.filterSpecified?at.filter.getConsolidated():[],ot&&(dt.stayingIntervals=dt.stayingIntervals.filter((function(Ne){return Ne[0]!==ot[0]&&Ne[1]!==ot[1]}))),dt.startExtent=it.region?ot["s"===it.region?1:0]:nt,Ge.parent.inBrushDrag=!0,dt.brushStartCallback()}function drag(Ne,Ge){rt.event.sourceEvent.stopPropagation();var Qe=Ge.height-rt.mouse(Ne)[1]-2*tt.verticalPadding,nt=Ge.brush.svgBrush;nt.wasDragged=!0,nt._dragging=!0,nt.grabbingBar?nt.newExtent=[Qe-nt.grabPoint,Qe+nt.barLength-nt.grabPoint].map(Ge.unitToPaddedPx.invert):nt.newExtent=[nt.startExtent,Ge.unitToPaddedPx.invert(Qe)].sort(it),Ge.brush.filterSpecified=!0,nt.extent=nt.stayingIntervals.concat([nt.newExtent]),nt.brushCallback(Ge),renderHighlight(Ne.parentNode)}function dragend(Ne,Ge){var Qe=Ge.brush,tt=Qe.filter,nt=Qe.svgBrush;nt._dragging||(mousemove(Ne,Ge),drag(Ne,Ge),Ge.brush.svgBrush.wasDragged=!1),nt._dragging=!1,rt.event.sourceEvent.stopPropagation();var at=nt.grabbingBar;if(nt.grabbingBar=!1,nt.grabLocation=void 0,Ge.parent.inBrushDrag=!1,clearCursor(),!nt.wasDragged)return nt.wasDragged=void 0,nt.clickableOrdinalRange?Qe.filterSpecified&&Ge.multiselect?nt.extent.push(nt.clickableOrdinalRange):(nt.extent=[nt.clickableOrdinalRange],Qe.filterSpecified=!0):at?(nt.extent=nt.stayingIntervals,0===nt.extent.length&&brushClear(Qe)):brushClear(Qe),nt.brushCallback(Ge),renderHighlight(Ne.parentNode),void nt.brushEndCallback(Qe.filterSpecified?tt.getConsolidated():[]);var mergeIntervals=function(){tt.set(tt.getConsolidated())};if(Ge.ordinal){var it=Ge.unitTickvals;it[it.length-1]<it[0]&&it.reverse(),nt.newExtent=[ordinalScaleSnap(0,it,nt.newExtent[0],nt.stayingIntervals),ordinalScaleSnap(1,it,nt.newExtent[1],nt.stayingIntervals)];var ot=nt.newExtent[1]>nt.newExtent[0];nt.extent=nt.stayingIntervals.concat(ot?[nt.newExtent]:[]),nt.extent.length||brushClear(Qe),nt.brushCallback(Ge),ot?renderHighlight(Ne.parentNode,mergeIntervals):(mergeIntervals(),renderHighlight(Ne.parentNode))}else mergeIntervals();nt.brushEndCallback(Qe.filterSpecified?tt.getConsolidated():[])}function mousemove(Ne,Ge){var Qe=getInterval(Ge,Ge.height-rt.mouse(Ne)[1]-2*tt.verticalPadding),nt="crosshair";Qe.clickableOrdinalRange?nt="pointer":Qe.region&&(nt=Qe.region+"-resize"),rt.select(document.body).style("cursor",nt)}function attachDragBehavior(Ne){Ne.on("mousemove",(function(Ne){rt.event.preventDefault(),Ne.parent.inBrushDrag||mousemove(this,Ne)})).on("mouseleave",(function(Ne){Ne.parent.inBrushDrag||clearCursor()})).call(rt.behavior.drag().on("dragstart",(function(Ne){dragstart(this,Ne)})).on("drag",(function(Ne){drag(this,Ne)})).on("dragend",(function(Ne){dragend(this,Ne)})))}function startAsc(Ne,Ge){return Ne[0]-Ge[0]}function renderAxisBrush(Ne){var Ge=Ne.selectAll(".background").data(at);Ge.enter().append("rect").classed("background",!0).call(barHorizontalSetup).call(backgroundBarHorizontalSetup).style("pointer-events","auto").attr("transform",ot(0,tt.verticalPadding)),Ge.call(attachDragBehavior).attr("height",(function(Ne){return Ne.height-tt.verticalPadding}));var Qe=Ne.selectAll(".highlight-shadow").data(at);Qe.enter().append("line").classed("highlight-shadow",!0).attr("x",-tt.bar.width/2).attr("stroke-width",tt.bar.width+tt.bar.strokeWidth).attr("stroke",tt.bar.strokeColor).attr("opacity",tt.bar.strokeOpacity).attr("stroke-linecap","butt"),Qe.attr("y1",(function(Ne){return Ne.height})).call(styleHighlight);var rt=Ne.selectAll(".highlight").data(at);rt.enter().append("line").classed("highlight",!0).attr("x",-tt.bar.width/2).attr("stroke-width",tt.bar.width-tt.bar.strokeWidth).attr("stroke",tt.bar.fillColor).attr("opacity",tt.bar.fillOpacity).attr("stroke-linecap","butt"),rt.attr("y1",(function(Ne){return Ne.height})).call(styleHighlight)}function ensureAxisBrush(Ne){var Ge=Ne.selectAll("."+tt.cn.axisBrush).data(at,nt);Ge.enter().append("g").classed(tt.cn.axisBrush,!0),renderAxisBrush(Ge)}function getBrushExtent(Ne){return Ne.svgBrush.extent.map((function(Ne){return Ne.slice()}))}function brushClear(Ne){Ne.filterSpecified=!1,Ne.svgBrush.extent=[[-1/0,1/0]]}function axisBrushMoved(Ne){return function(Ge){var Qe=Ge.brush,tt=getBrushExtent(Qe).slice();Qe.filter.set(tt),Ne()}}function dedupeRealRanges(Ne){for(var Ge,Qe=Ne.slice(),tt=[],rt=Qe.shift();rt;){for(Ge=rt.slice();(rt=Qe.shift())&&rt[0]<=Ge[1];)Ge[1]=Math.max(Ge[1],rt[1]);tt.push(Ge)}return 1===tt.length&&tt[0][0]>tt[0][1]&&(tt=[]),tt}function makeFilter(){var Ne,Ge,Qe=[];return{set:function(tt){1===(Qe=tt.map((function(Ne){return Ne.slice().sort(it)})).sort(startAsc)).length&&Qe[0][0]===-1/0&&Qe[0][1]===1/0&&(Qe=[[0,-1]]),Ne=dedupeRealRanges(Qe),Ge=Qe.reduce((function(Ne,Ge){return[Math.min(Ne[0],Ge[0]),Math.max(Ne[1],Ge[1])]}),[1/0,-1/0])},get:function(){return Qe.slice()},getConsolidated:function(){return Ne},getBounds:function(){return Ge}}}function makeBrush(Ne,Ge,Qe,tt,rt,nt){var at=makeFilter();return at.set(Qe),{filter:at,filterSpecified:Ge,svgBrush:{extent:[],brushStartCallback:tt,brushCallback:axisBrushMoved(rt),brushEndCallback:nt}}}function cleanRanges(Ne,Ge){if(Array.isArray(Ne[0])?(Ne=Ne.map((function(Ne){return Ne.sort(it)})),Ne=Ge.multiselect?dedupeRealRanges(Ne.sort(startAsc)):[Ne[0]]):Ne=[Ne.sort(it)],Ge.tickvals){var Qe=Ge.tickvals.slice().sort(it);if(!(Ne=Ne.map((function(Ne){var Ge=[ordinalScaleSnap(0,Qe,Ne[0],[]),ordinalScaleSnap(1,Qe,Ne[1],[])];if(Ge[1]>Ge[0])return Ge})).filter((function(Ne){return Ne}))).length)return}return Ne.length>1?Ne:Ne[0]}Ge.exports={makeBrush:makeBrush,ensureAxisBrush:ensureAxisBrush,cleanRanges:cleanRanges}},{"../../lib":778,"../../lib/gup":775,"./constants":1153,d3:169}],1151:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../plots/get_data").getModuleCalcData,nt=Ne("./plot"),at=Ne("../../constants/xmlns_namespaces");Qe.name="parcoords",Qe.plot=function(Ne){var Ge=rt(Ne.calcdata,"parcoords")[0];Ge.length&&nt(Ne,Ge)},Qe.clean=function(Ne,Ge,Qe,tt){var rt=tt._has&&tt._has("parcoords"),nt=Ge._has&&Ge._has("parcoords");rt&&!nt&&(tt._paperdiv.selectAll(".parcoords").remove(),tt._glimages.selectAll("*").remove())},Qe.toSVG=function(Ne){var Ge=Ne._fullLayout._glimages,Qe=tt.select(Ne).selectAll(".svg-container");function canvasToImage(){var Ne=this,Qe=Ne.toDataURL("image/png");Ge.append("svg:image").attr({xmlns:at.svg,"xlink:href":Qe,preserveAspectRatio:"none",x:0,y:0,width:Ne.width,height:Ne.height})}Qe.filter((function(Ne,Ge){return Ge===Qe.size()-1})).selectAll(".gl-canvas-context, .gl-canvas-focus").each(canvasToImage),window.setTimeout((function(){tt.selectAll("#filterBarPattern").attr("id","filterBarPattern")}),60)}},{"../../constants/xmlns_namespaces":754,"../../plots/get_data":865,"./plot":1160,d3:169}],1152:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib").isArrayOrTypedArray,rt=Ne("../../components/colorscale"),nt=Ne("../../lib/gup").wrap;function constHalf(Ne){for(var Ge=new Array(Ne),Qe=0;Qe<Ne;Qe++)Ge[Qe]=.5;return Ge}Ge.exports=function(Ne,Ge){var Qe,at;return rt.hasColorscale(Ge,"line")&&tt(Ge.line.color)?(Qe=Ge.line.color,at=rt.extractOpts(Ge.line).colorscale,rt.calc(Ne,Ge,{vals:Qe,containerStr:"line",cLetter:"c"})):(Qe=constHalf(Ge._length),at=[[0,Ge.line.color],[1,Ge.line.color]]),nt({lineColor:Qe,cscale:at})}},{"../../components/colorscale":655,"../../lib":778,"../../lib/gup":775}],1153:[function(Ne,Ge,Qe){"use strict";Ge.exports={maxDimensionCount:60,overdrag:45,verticalPadding:2,tickDistance:50,canvasPixelRatio:1,blockLineCount:5e3,layers:["contextLineLayer","focusLineLayer","pickLineLayer"],axisTitleOffset:28,axisExtentOffset:10,deselectedLineColor:"#777",bar:{width:4,captureWidth:10,fillColor:"magenta",fillOpacity:1,snapDuration:150,snapRatio:.25,snapClose:.01,strokeColor:"white",strokeOpacity:1,strokeWidth:1,handleHeight:8,handleOpacity:1,handleOverlap:0},cn:{axisExtentText:"axis-extent-text",parcoordsLineLayers:"parcoords-line-layers",parcoordsLineLayer:"parcoords-lines",parcoords:"parcoords",parcoordsControlView:"parcoords-control-view",yAxis:"y-axis",axisOverlays:"axis-overlays",axis:"axis",axisHeading:"axis-heading",axisTitle:"axis-title",axisExtent:"axis-extent",axisExtentTop:"axis-extent-top",axisExtentTopText:"axis-extent-top-text",axisExtentBottom:"axis-extent-bottom",axisExtentBottomText:"axis-extent-bottom-text",axisBrush:"axis-brush"},id:{filterBarPattern:"filter-bar-pattern"}}},{}],1154:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../components/colorscale/helpers").hasColorscale,nt=Ne("../../components/colorscale/defaults"),at=Ne("../../plots/domain").defaults,it=Ne("../../plots/array_container_defaults"),ot=Ne("../../plots/cartesian/axes"),dt=Ne("./attributes"),ht=Ne("./axisbrush"),Dt=Ne("./constants").maxDimensionCount,Ot=Ne("./merge_length");function handleLineDefaults(Ne,Ge,Qe,at,it){var ot=it("line.color",Qe);if(rt(Ne,"line")&&tt.isArrayOrTypedArray(ot)){if(ot.length)return it("line.colorscale"),nt(Ne,Ge,at,it,{prefix:"line.",cLetter:"c"}),ot.length;Ge.line.color=Qe}return 1/0}function dimensionDefaults(Ne,Ge,Qe,rt){function coerce(Qe,rt){return tt.coerce(Ne,Ge,dt.dimensions,Qe,rt)}var nt=coerce("values"),at=coerce("visible");if(nt&&nt.length||(at=Ge.visible=!1),at){coerce("label"),coerce("tickvals"),coerce("ticktext"),coerce("tickformat");var it=coerce("range");Ge._ax={_id:"y",type:"linear",showexponent:"all",exponentformat:"B",range:it},ot.setConvert(Ge._ax,rt.layout),coerce("multiselect");var Dt=coerce("constraintrange");Dt&&(Ge.constraintrange=ht.cleanRanges(Dt,Ge))}}Ge.exports=function(Ne,Ge,Qe,rt){function coerce(Qe,rt){return tt.coerce(Ne,Ge,dt,Qe,rt)}var nt=Ne.dimensions;Array.isArray(nt)&&nt.length>Dt&&(tt.log("parcoords traces support up to "+Dt+" dimensions at the moment"),nt.splice(Dt));var ot=it(Ne,Ge,{name:"dimensions",layout:rt,handleItemDefaults:dimensionDefaults}),ht=handleLineDefaults(Ne,Ge,Qe,rt,coerce);at(Ge,rt,coerce),Array.isArray(ot)&&ot.length||(Ge.visible=!1),Ot(Ge,ot,"values",ht);var Rt={family:rt.font.family,size:Math.round(rt.font.size/1.2),color:rt.font.color};tt.coerceFont(coerce,"labelfont",Rt),tt.coerceFont(coerce,"tickfont",Rt),tt.coerceFont(coerce,"rangefont",Rt),coerce("labelangle"),coerce("labelside")}},{"../../components/colorscale/defaults":653,"../../components/colorscale/helpers":654,"../../lib":778,"../../plots/array_container_defaults":823,"../../plots/cartesian/axes":828,"../../plots/domain":855,"./attributes":1149,"./axisbrush":1150,"./constants":1153,"./merge_length":1158}],1155:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib").isTypedArray;Qe.convertTypedArray=function(Ne){return tt(Ne)?Array.prototype.slice.call(Ne):Ne},Qe.isOrdinal=function(Ne){return!!Ne.tickvals},Qe.isVisible=function(Ne){return Ne.visible||!("visible"in Ne)}},{"../../lib":778}],1156:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),calc:Ne("./calc"),plot:Ne("./plot"),colorbar:{container:"line",min:"cmin",max:"cmax"},moduleType:"trace",name:"parcoords",basePlotModule:Ne("./base_plot"),categories:["gl","regl","noOpacity","noHover"],meta:{}}},{"./attributes":1149,"./base_plot":1151,"./calc":1152,"./defaults":1154,"./plot":1160}],1157:[function(Ne,Ge,Qe){"use strict";var tt=Ne("glslify"),rt=tt(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nattribute vec4 p01_04, p05_08, p09_12, p13_16,\n               p17_20, p21_24, p25_28, p29_32,\n               p33_36, p37_40, p41_44, p45_48,\n               p49_52, p53_56, p57_60, colors;\n\nuniform mat4 dim0A, dim1A, dim0B, dim1B, dim0C, dim1C, dim0D, dim1D,\n             loA, hiA, loB, hiB, loC, hiC, loD, hiD;\n\nuniform vec2 resolution, viewBoxPos, viewBoxSize;\nuniform sampler2D mask, palette;\nuniform float maskHeight;\nuniform float drwLayer; // 0: context, 1: focus, 2: pick\nuniform vec4 contextColor;\n\nbool isPick    = (drwLayer > 1.5);\nbool isContext = (drwLayer < 0.5);\n\nconst vec4 ZEROS = vec4(0.0, 0.0, 0.0, 0.0);\nconst vec4 UNITS = vec4(1.0, 1.0, 1.0, 1.0);\n\nfloat val(mat4 p, mat4 v) {\n    return dot(matrixCompMult(p, v) * UNITS, UNITS);\n}\n\nfloat axisY(float ratio, mat4 A, mat4 B, mat4 C, mat4 D) {\n    float y1 = val(A, dim0A) + val(B, dim0B) + val(C, dim0C) + val(D, dim0D);\n    float y2 = val(A, dim1A) + val(B, dim1B) + val(C, dim1C) + val(D, dim1D);\n    return y1 * (1.0 - ratio) + y2 * ratio;\n}\n\nint iMod(int a, int b) {\n    return a - b * (a / b);\n}\n\nbool fOutside(float p, float lo, float hi) {\n    return (lo < hi) && (lo > p || p > hi);\n}\n\nbool vOutside(vec4 p, vec4 lo, vec4 hi) {\n    return (\n        fOutside(p[0], lo[0], hi[0]) ||\n        fOutside(p[1], lo[1], hi[1]) ||\n        fOutside(p[2], lo[2], hi[2]) ||\n        fOutside(p[3], lo[3], hi[3])\n    );\n}\n\nbool mOutside(mat4 p, mat4 lo, mat4 hi) {\n    return (\n        vOutside(p[0], lo[0], hi[0]) ||\n        vOutside(p[1], lo[1], hi[1]) ||\n        vOutside(p[2], lo[2], hi[2]) ||\n        vOutside(p[3], lo[3], hi[3])\n    );\n}\n\nbool outsideBoundingBox(mat4 A, mat4 B, mat4 C, mat4 D) {\n    return mOutside(A, loA, hiA) ||\n           mOutside(B, loB, hiB) ||\n           mOutside(C, loC, hiC) ||\n           mOutside(D, loD, hiD);\n}\n\nbool outsideRasterMask(mat4 A, mat4 B, mat4 C, mat4 D) {\n    mat4 pnts[4];\n    pnts[0] = A;\n    pnts[1] = B;\n    pnts[2] = C;\n    pnts[3] = D;\n\n    for(int i = 0; i < 4; ++i) {\n        for(int j = 0; j < 4; ++j) {\n            for(int k = 0; k < 4; ++k) {\n                if(0 == iMod(\n                    int(255.0 * texture2D(mask,\n                        vec2(\n                            (float(i * 2 + j / 2) + 0.5) / 8.0,\n                            (pnts[i][j][k] * (maskHeight - 1.0) + 1.0) / maskHeight\n                        ))[3]\n                    ) / int(pow(2.0, float(iMod(j * 4 + k, 8)))),\n                    2\n                )) return true;\n            }\n        }\n    }\n    return false;\n}\n\nvec4 position(bool isContext, float v, mat4 A, mat4 B, mat4 C, mat4 D) {\n    float x = 0.5 * sign(v) + 0.5;\n    float y = axisY(x, A, B, C, D);\n    float z = 1.0 - abs(v);\n\n    z += isContext ? 0.0 : 2.0 * float(\n        outsideBoundingBox(A, B, C, D) ||\n        outsideRasterMask(A, B, C, D)\n    );\n\n    return vec4(\n        2.0 * (vec2(x, y) * viewBoxSize + viewBoxPos) / resolution - 1.0,\n        z,\n        1.0\n    );\n}\n\nvoid main() {\n    mat4 A = mat4(p01_04, p05_08, p09_12, p13_16);\n    mat4 B = mat4(p17_20, p21_24, p25_28, p29_32);\n    mat4 C = mat4(p33_36, p37_40, p41_44, p45_48);\n    mat4 D = mat4(p49_52, p53_56, p57_60, ZEROS);\n\n    float v = colors[3];\n\n    gl_Position = position(isContext, v, A, B, C, D);\n\n    fragColor =\n        isContext ? vec4(contextColor) :\n        isPick ? vec4(colors.rgb, 1.0) : texture2D(palette, vec2(abs(v), 0.5));\n}\n"]),nt=tt(["precision highp float;\n#define GLSLIFY 1\n\nvarying vec4 fragColor;\n\nvoid main() {\n    gl_FragColor = fragColor;\n}\n"]),at=Ne("./constants").maxDimensionCount,it=Ne("../../lib"),ot=1e-6,dt=2048,ht=new Uint8Array(4),Dt=new Uint8Array(4),Ot={shape:[256,1],format:"rgba",type:"uint8",mag:"nearest",min:"nearest"};function ensureDraw(Ne){Ne.read({x:0,y:0,width:1,height:1,data:ht})}function clear(Ne,Ge,Qe,tt,rt){var nt=Ne._gl;nt.enable(nt.SCISSOR_TEST),nt.scissor(Ge,Qe,tt,rt),Ne.clear({color:[0,0,0,0],depth:1})}function renderBlock(Ne,Ge,Qe,tt,rt,nt){var at=nt.key;function render(it){var ot=Math.min(tt,rt-it*tt);0===it&&(window.cancelAnimationFrame(Qe.currentRafs[at]),delete Qe.currentRafs[at],clear(Ne,nt.scissorX,nt.scissorY,nt.scissorWidth,nt.viewBoxSize[1])),Qe.clearOnly||(nt.count=2*ot,nt.offset=2*it*tt,Ge(nt),it*tt+ot<rt&&(Qe.currentRafs[at]=window.requestAnimationFrame((function(){render(it+1)}))),Qe.drawCompleted=!1)}Qe.drawCompleted||(ensureDraw(Ne),Qe.drawCompleted=!0),render(0)}function adjustDepth(Ne){return Math.max(ot,Math.min(1-ot,Ne))}function palette(Ne,Ge){for(var Qe=new Array(256),tt=0;tt<256;tt++)Qe[tt]=Ne(tt/255).concat(Ge);return Qe}function calcPickColor(Ne,Ge){return(Ne>>>8*Ge)%256/255}function makePoints(Ne,Ge,Qe){for(var tt=new Array(Ne*(at+4)),rt=0,nt=0;nt<Ne;nt++){for(var it=0;it<at;it++)tt[rt++]=it<Ge.length?Ge[it].paddedUnitValues[nt]:.5;tt[rt++]=calcPickColor(nt,2),tt[rt++]=calcPickColor(nt,1),tt[rt++]=calcPickColor(nt,0),tt[rt++]=adjustDepth(Qe[nt])}return tt}function makeVecAttr(Ne,Ge,Qe){for(var tt=new Array(8*Ge),rt=0,nt=0;nt<Ge;nt++)for(var at=0;at<2;at++)for(var it=0;it<4;it++){var ot=4*Ne+it,dt=Qe[64*nt+ot];63===ot&&0===at&&(dt*=-1),tt[rt++]=dt}return tt}function pad2(Ne){var Ge="0"+Ne;return Ge.substr(Ge.length-2)}function getAttrName(Ne){return Ne<at?"p"+pad2(Ne+1)+"_"+pad2(Ne+4):"colors"}function setAttributes(Ne,Ge,Qe){for(var tt=0;tt<=at;tt+=4)Ne[getAttrName(tt)](makeVecAttr(tt/4,Ge,Qe))}function emptyAttributes(Ne){for(var Ge={},Qe=0;Qe<=at;Qe+=4)Ge[getAttrName(Qe)]=Ne.buffer({usage:"dynamic",type:"float",data:new Uint8Array(0)});return Ge}function makeItem(Ne,Ge,Qe,tt,rt,nt,at,ot,dt,ht,Dt,Ot,Rt){for(var Zt=[[],[]],er=0;er<64;er++)Zt[0][er]=er===rt?1:0,Zt[1][er]=er===nt?1:0;var dr=Ne.lines.canvasOverdrag,mr=Ne.domain,xr=Ne.canvasWidth,br=Ne.canvasHeight,Ar=Ne.deselectedLines.color;return it.extendFlat({key:Dt,resolution:[xr,br],viewBoxPos:[at+dr,ot],viewBoxSize:[dt,ht],i0:rt,i1:nt,dim0A:Zt[0].slice(0,16),dim0B:Zt[0].slice(16,32),dim0C:Zt[0].slice(32,48),dim0D:Zt[0].slice(48,64),dim1A:Zt[1].slice(0,16),dim1B:Zt[1].slice(16,32),dim1C:Zt[1].slice(32,48),dim1D:Zt[1].slice(48,64),drwLayer:Ot,contextColor:[Ar[0]/255,Ar[1]/255,Ar[2]/255,Ar[3]<1?Ar[3]:Math.max(1/255,Math.pow(1/Ne.lines.color.length,1/3))],scissorX:(tt===Ge?0:at+dr)+(Ne.pad.l-dr)+Ne.layoutWidth*mr.x[0],scissorWidth:(tt===Qe?xr-at+dr:dt+.5)+(tt===Ge?at+dr:0),scissorY:ot+Ne.pad.b+Ne.layoutHeight*mr.y[0],scissorHeight:ht,viewportX:Ne.pad.l-dr+Ne.layoutWidth*mr.x[0],viewportY:Ne.pad.b+Ne.layoutHeight*mr.y[0],viewportWidth:xr,viewportHeight:br},Rt)}function expandedPixelRange(Ne){var Ge=dt-1,Qe=Math.max(0,Math.floor(Ne[0]*Ge),0),tt=Math.min(Ge,Math.ceil(Ne[1]*Ge),Ge);return[Math.min(Qe,tt),Math.max(Qe,tt)]}Ge.exports=function(Ne,Ge){var Qe,tt,at,ot,ht,Rt=Ge.context,Zt=Ge.pick,er=Ge.regl,dr={currentRafs:{},drawCompleted:!0,clearOnly:!1},mr=emptyAttributes(er),xr=er.texture(Ot),br=[];update(Ge);var Ar=er({profile:!1,blend:{enable:Rt,func:{srcRGB:"src alpha",dstRGB:"one minus src alpha",srcAlpha:1,dstAlpha:1},equation:{rgb:"add",alpha:"add"},color:[0,0,0,0]},depth:{enable:!Rt,mask:!0,func:"less",range:[0,1]},cull:{enable:!0,face:"back"},scissor:{enable:!0,box:{x:er.prop("scissorX"),y:er.prop("scissorY"),width:er.prop("scissorWidth"),height:er.prop("scissorHeight")}},viewport:{x:er.prop("viewportX"),y:er.prop("viewportY"),width:er.prop("viewportWidth"),height:er.prop("viewportHeight")},dither:!1,vert:rt,frag:nt,primitive:"lines",lineWidth:1,attributes:mr,uniforms:{resolution:er.prop("resolution"),viewBoxPos:er.prop("viewBoxPos"),viewBoxSize:er.prop("viewBoxSize"),dim0A:er.prop("dim0A"),dim1A:er.prop("dim1A"),dim0B:er.prop("dim0B"),dim1B:er.prop("dim1B"),dim0C:er.prop("dim0C"),dim1C:er.prop("dim1C"),dim0D:er.prop("dim0D"),dim1D:er.prop("dim1D"),loA:er.prop("loA"),hiA:er.prop("hiA"),loB:er.prop("loB"),hiB:er.prop("hiB"),loC:er.prop("loC"),hiC:er.prop("hiC"),loD:er.prop("loD"),hiD:er.prop("hiD"),palette:xr,contextColor:er.prop("contextColor"),mask:er.prop("maskTexture"),drwLayer:er.prop("drwLayer"),maskHeight:er.prop("maskHeight")},offset:er.prop("offset"),count:er.prop("count")});function update(Ne){Qe=Ne.model,tt=Ne.viewModel,at=tt.dimensions.slice(),ot=at[0]?at[0].values.length:0;var Ge=Qe.lines,rt=Zt?Ge.color.map((function(Ne,Qe){return Qe/Ge.color.length})):Ge.color,nt=makePoints(ot,at,rt);setAttributes(mr,ot,nt),Rt||Zt||(xr=er.texture(it.extendFlat({data:palette(Qe.unitToColor,255)},Ot)))}function makeConstraints(Ne){var Ge,Qe,tt,rt=[[],[]];for(tt=0;tt<64;tt++){var nt=!Ne&&tt<at.length?at[tt].brush.filter.getBounds():[-1/0,1/0];rt[0][tt]=nt[0],rt[1][tt]=nt[1]}var it=8*dt,ot=new Array(it);for(Ge=0;Ge<it;Ge++)ot[Ge]=255;if(!Ne)for(Ge=0;Ge<at.length;Ge++){var Dt=Ge%8,Ot=(Ge-Dt)/8,Rt=Math.pow(2,Dt),Zt=at[Ge].brush.filter.get();if(!(Zt.length<2)){var dr=expandedPixelRange(Zt[0])[1];for(Qe=1;Qe<Zt.length;Qe++){var mr=expandedPixelRange(Zt[Qe]);for(tt=dr+1;tt<mr[0];tt++)ot[8*tt+Ot]&=~Rt;dr=Math.max(dr,mr[1])}}}var xr={shape:[8,dt],format:"alpha",type:"uint8",mag:"nearest",min:"nearest",data:ot};return ht?ht(xr):ht=er.texture(xr),{maskTexture:ht,maskHeight:dt,loA:rt[0].slice(0,16),loB:rt[0].slice(16,32),loC:rt[0].slice(32,48),loD:rt[0].slice(48,64),hiA:rt[1].slice(0,16),hiB:rt[1].slice(16,32),hiC:rt[1].slice(32,48),hiD:rt[1].slice(48,64)}}function renderGLParcoords(Ne,Ge,tt){var rt,nt,at,it=Ne.length,dt=1/0,ht=-1/0;for(rt=0;rt<it;rt++)Ne[rt].dim0.canvasX<dt&&(dt=Ne[rt].dim0.canvasX,nt=rt),Ne[rt].dim1.canvasX>ht&&(ht=Ne[rt].dim1.canvasX,at=rt);0===it&&clear(er,0,0,Qe.canvasWidth,Qe.canvasHeight);var Dt=makeConstraints(Rt);for(rt=0;rt<it;rt++){var Ot=Ne[rt],mr=Ot.dim0.crossfilterDimensionIndex,xr=Ot.dim1.crossfilterDimensionIndex,en=Ot.canvasX,mn=Ot.canvasY,xn=en+Ot.panelSizeX;if(Ge||!br[mr]||br[mr][0]!==en||br[mr][1]!==xn){br[mr]=[en,xn];var kn=makeItem(Qe,nt,at,rt,mr,xr,en,mn,Ot.panelSizeX,Ot.panelSizeY,Ot.dim0.crossfilterDimensionIndex,Rt?0:Zt?2:1,Dt);dr.clearOnly=tt;var Cn=Ge?Qe.lines.blockLineCount:ot;renderBlock(er,Ar,dr,Cn,ot,kn)}}}function readPixel(Ne,Ge){return er.read({x:Ne,y:Ge,width:1,height:1,data:Dt}),Dt}function readPixels(Ne,Ge,Qe,tt){var rt=new Uint8Array(4*Qe*tt);return er.read({x:Ne,y:Ge,width:Qe,height:tt,data:rt}),rt}function destroy(){for(var Ge in Ne.style["pointer-events"]="none",xr.destroy(),ht&&ht.destroy(),mr)mr[Ge].destroy()}return{render:renderGLParcoords,readPixel:readPixel,readPixels:readPixels,destroy:destroy,update:update}}},{"../../lib":778,"./constants":1153,glslify:439}],1158:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge,Qe,tt){var rt,nt;for(tt||(tt=1/0),rt=0;rt<Ge.length;rt++)(nt=Ge[rt]).visible&&(tt=Math.min(tt,nt[Qe].length));for(tt===1/0&&(tt=0),Ne._length=tt,rt=0;rt<Ge.length;rt++)(nt=Ge[rt]).visible&&(nt._length=tt);return tt}},{}],1159:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("color-rgba"),nt=Ne("../../plots/cartesian/axes"),at=Ne("../../lib"),it=at.strRotate,ot=at.strTranslate,dt=Ne("../../lib/svg_text_utils"),ht=Ne("../../components/drawing"),Dt=Ne("../../components/colorscale"),Ot=Ne("../../lib/gup"),Rt=Ot.keyFun,Zt=Ot.repeat,er=Ot.unwrap,dr=Ne("./helpers"),mr=Ne("./constants"),xr=Ne("./axisbrush"),br=Ne("./lines");function findExtreme(Ne,Ge,Qe){return at.aggNums(Ne,null,Ge,Qe)}function findExtremes(Ne,Ge){return fixExtremes(findExtreme(Math.min,Ne,Ge),findExtreme(Math.max,Ne,Ge))}function dimensionExtent(Ne){var Ge=Ne.range;return Ge?fixExtremes(Ge[0],Ge[1]):findExtremes(Ne.values,Ne._length)}function fixExtremes(Ne,Ge){return!isNaN(Ne)&&isFinite(Ne)||(Ne=0),!isNaN(Ge)&&isFinite(Ge)||(Ge=0),Ne===Ge&&(0===Ne?(Ne-=1,Ge+=1):(Ne*=.9,Ge*=1.1)),[Ne,Ge]}function toText(Ne,Ge){return Ge?function(Qe,tt){var rt=Ge[tt];return null==rt?Ne(Qe):rt}:Ne}function domainScale(Ne,Ge,Qe,rt,nt){var at=dimensionExtent(Qe);return rt?tt.scale.ordinal().domain(rt.map(toText(tt.format(Qe.tickformat),nt))).range(rt.map((function(Qe){var tt=(Qe-at[0])/(at[1]-at[0]);return Ne-Ge+tt*(2*Ge-Ne)}))):tt.scale.linear().domain(at).range([Ne-Ge,Ge])}function unitToPaddedPx(Ne,Ge){return tt.scale.linear().range([Ge,Ne-Ge])}function domainToPaddedUnitScale(Ne,Ge){return tt.scale.linear().domain(dimensionExtent(Ne)).range([Ge,1-Ge])}function ordinalScale(Ne){if(Ne.tickvals){var Ge=dimensionExtent(Ne);return tt.scale.ordinal().domain(Ne.tickvals).range(Ne.tickvals.map((function(Ne){return(Ne-Ge[0])/(Ge[1]-Ge[0])})))}}function unitToColorScale(Ne){var Ge=Ne.map((function(Ne){return Ne[0]})),Qe=Ne.map((function(Ne){var Ge=rt(Ne[1]);return tt.rgb("rgb("+Ge[0]+","+Ge[1]+","+Ge[2]+")")})),prop=function(Ne){return function(Ge){return Ge[Ne]}},nt="rgb".split("").map((function(Ne){return tt.scale.linear().clamp(!0).domain(Ge).range(Qe.map(prop(Ne)))}));return function(Ne){return nt.map((function(Ge){return Ge(Ne)}))}}function someFiltersActive(Ne){return Ne.dimensions.some((function(Ne){return Ne.brush.filterSpecified}))}function model(Ne,Ge,Qe){var nt=er(Ge),it=nt.trace,ot=dr.convertTypedArray(nt.lineColor),dt=it.line,ht={color:rt(mr.deselectedLineColor)},Ot=Dt.extractOpts(dt),Rt=Ot.reversescale?Dt.flipScale(nt.cscale):nt.cscale,Zt=it.domain,xr=it.dimensions,br=Ne.width,Ar=it.labelangle,en=it.labelside,mn=it.labelfont,xn=it.tickfont,kn=it.rangefont,Cn=at.extendDeepNoArrays({},dt,{color:ot.map(tt.scale.linear().domain(dimensionExtent({values:ot,range:[Ot.min,Ot.max],_length:it._length}))),blockLineCount:mr.blockLineCount,canvasOverdrag:mr.overdrag*mr.canvasPixelRatio}),En=Math.floor(br*(Zt.x[1]-Zt.x[0])),Pn=Math.floor(Ne.height*(Zt.y[1]-Zt.y[0])),Dn=Ne.margin||{l:80,r:80,t:100,b:80},In=En,zn=Pn;return{key:Qe,colCount:xr.filter(dr.isVisible).length,dimensions:xr,tickDistance:mr.tickDistance,unitToColor:unitToColorScale(Rt),lines:Cn,deselectedLines:ht,labelAngle:Ar,labelSide:en,labelFont:mn,tickFont:xn,rangeFont:kn,layoutWidth:br,layoutHeight:Ne.height,domain:Zt,translateX:Zt.x[0]*br,translateY:Ne.height-Zt.y[1]*Ne.height,pad:Dn,canvasWidth:In*mr.canvasPixelRatio+2*Cn.canvasOverdrag,canvasHeight:zn*mr.canvasPixelRatio,width:In,height:zn,canvasPixelRatio:mr.canvasPixelRatio}}function viewModel(Ne,Ge,Qe){var rt=Qe.width,nt=Qe.height,it=Qe.dimensions,ot=Qe.canvasPixelRatio,xScale=function(Ne){return rt*Ne/Math.max(1,Qe.colCount-1)},dt=mr.verticalPadding/nt,ht=unitToPaddedPx(nt,mr.verticalPadding),Dt={key:Qe.key,xScale:xScale,model:Qe,inBrushDrag:!1},Ot={};return Dt.dimensions=it.filter(dr.isVisible).map((function(rt,it){var Rt=domainToPaddedUnitScale(rt,dt),Zt=Ot[rt.label];Ot[rt.label]=(Zt||0)+1;var er=rt.label+(Zt?"__"+Zt:""),br=rt.constraintrange,Ar=br&&br.length;Ar&&!Array.isArray(br[0])&&(br=[br]);var en=Ar?br.map((function(Ne){return Ne.map(Rt)})):[[-1/0,1/0]],brushMove=function(){var Ge=Dt;Ge.focusLayer&&Ge.focusLayer.render(Ge.panels,!0);var Qe=someFiltersActive(Ge);!Ne.contextShown()&&Qe?(Ge.contextLayer&&Ge.contextLayer.render(Ge.panels,!0),Ne.contextShown(!0)):Ne.contextShown()&&!Qe&&(Ge.contextLayer&&Ge.contextLayer.render(Ge.panels,!0,!0),Ne.contextShown(!1))},mn=rt.values;mn.length>rt._length&&(mn=mn.slice(0,rt._length));var xn,kn=rt.tickvals;function makeTickItem(Ne,Ge){return{val:Ne,text:xn[Ge]}}function sortTickItem(Ne,Ge){return Ne.val-Ge.val}if(Array.isArray(kn)&&kn.length){xn=rt.ticktext,Array.isArray(xn)&&xn.length?xn.length>kn.length?xn=xn.slice(0,kn.length):kn.length>xn.length&&(kn=kn.slice(0,xn.length)):xn=kn.map(tt.format(rt.tickformat));for(var Cn=1;Cn<kn.length;Cn++)if(kn[Cn]<kn[Cn-1]){for(var En=kn.map(makeTickItem).sort(sortTickItem),Pn=0;Pn<kn.length;Pn++)kn[Pn]=En[Pn].val,xn[Pn]=En[Pn].text;break}}else kn=void 0;return mn=dr.convertTypedArray(mn),{key:er,label:rt.label,tickFormat:rt.tickformat,tickvals:kn,ticktext:xn,ordinal:dr.isOrdinal(rt),multiselect:rt.multiselect,xIndex:it,crossfilterDimensionIndex:it,visibleIndex:rt._index,height:nt,values:mn,paddedUnitValues:mn.map(Rt),unitTickvals:kn&&kn.map(Rt),xScale:xScale,x:xScale(it),canvasX:xScale(it)*ot,unitToPaddedPx:ht,domainScale:domainScale(nt,mr.verticalPadding,rt,kn,xn),ordinalScale:ordinalScale(rt),parent:Dt,model:Qe,brush:xr.makeBrush(Ne,Ar,en,(function(){Ne.linePickActive(!1)}),brushMove,(function(Qe){if(Dt.focusLayer.render(Dt.panels,!0),Dt.pickLayer&&Dt.pickLayer.render(Dt.panels,!0),Ne.linePickActive(!0),Ge&&Ge.filterChanged){var tt=Rt.invert,nt=Qe.map((function(Ne){return Ne.map(tt).sort(at.sorterAsc)})).sort((function(Ne,Ge){return Ne[0]-Ge[0]}));Ge.filterChanged(Dt.key,rt._index,nt)}}))}})),Dt}function styleExtentTexts(Ne){Ne.classed(mr.cn.axisExtentText,!0).attr("text-anchor","middle").style("cursor","default")}function parcoordsInteractionState(){var Ne=!0,Ge=!1;return{linePickActive:function(Ge){return arguments.length?Ne=!!Ge:Ne},contextShown:function(Ne){return arguments.length?Ge=!!Ne:Ge}}}function calcTilt(Ne,Ge){var Qe="top"===Ge?1:-1,tt=Ne*Math.PI/180;return{dir:Qe,dx:Math.sin(tt),dy:Math.cos(tt),degrees:Ne}}function updatePanelLayout(Ne,Ge){for(var Qe=Ge.panels||(Ge.panels=[]),tt=Ne.data(),rt=0;rt<tt.length-1;rt++){var nt=Qe[rt]||(Qe[rt]={}),at=tt[rt],it=tt[rt+1];nt.dim0=at,nt.dim1=it,nt.canvasX=at.canvasX,nt.panelSizeX=it.canvasX-at.canvasX,nt.panelSizeY=Ge.model.canvasHeight,nt.y=0,nt.canvasY=0}}function calcAllTicks(Ne){for(var Ge=0;Ge<Ne.length;Ge++)for(var Qe=0;Qe<Ne[Ge].length;Qe++)for(var tt=Ne[Ge][Qe].trace,rt=tt.dimensions,at=0;at<rt.length;at++){var it=rt[at].values,ot=rt[at]._ax;ot&&(ot.range?ot.range=fixExtremes(ot.range[0],ot.range[1]):ot.range=findExtremes(it,tt._length),ot.dtick||(ot.dtick=.01*(Math.abs(ot.range[1]-ot.range[0])||1)),ot.tickformat=rt[at].tickformat,nt.calcTicks(ot),ot.cleanRange())}}function linearFormat(Ne,Ge){return nt.tickText(Ne._ax,Ge,!1).text}function extremeText(Ne,Ge){if(Ne.ordinal)return"";var Qe=Ne.domainScale.domain(),tt=Qe[Ge?Qe.length-1:0];return linearFormat(Ne.model.dimensions[Ne.visibleIndex],tt)}Ge.exports=function(Ne,Ge,Qe,rt){var nt=Ne._fullLayout,Dt=nt._toppaper,Ot=nt._glcontainer;calcAllTicks(Ge);var Ar=parcoordsInteractionState(),en=Ge.filter((function(Ne){return er(Ne).trace.visible})).map(model.bind(0,Qe)).map(viewModel.bind(0,Ar,rt));Ot.each((function(Ne,Ge){return at.extendFlat(Ne,en[Ge])}));var mn=Ot.selectAll(".gl-canvas").each((function(Ne){Ne.viewModel=en[0],Ne.model=Ne.viewModel?Ne.viewModel.model:null})),xn=null;mn.filter((function(Ne){return Ne.pick})).style("pointer-events","auto").on("mousemove",(function(Ne){if(Ar.linePickActive()&&Ne.lineLayer&&rt&&rt.hover){var Ge=tt.event,Qe=this.width,nt=this.height,at=tt.mouse(this),it=at[0],ot=at[1];if(it<0||ot<0||it>=Qe||ot>=nt)return;var dt=Ne.lineLayer.readPixel(it,nt-1-ot),ht=0!==dt[3],Dt=ht?dt[2]+256*(dt[1]+256*dt[0]):null,Ot={x:it,y:ot,clientX:Ge.clientX,clientY:Ge.clientY,dataIndex:Ne.model.key,curveNumber:Dt};Dt!==xn&&(ht?rt.hover(Ot):rt.unhover&&rt.unhover(Ot),xn=Dt)}})),mn.style("opacity",(function(Ne){return Ne.pick?0:1})),Dt.style("background","rgba(255, 255, 255, 0)");var kn=Dt.selectAll("."+mr.cn.parcoords).data(en,Rt);kn.exit().remove(),kn.enter().append("g").classed(mr.cn.parcoords,!0).style("shape-rendering","crispEdges").style("pointer-events","none"),kn.attr("transform",(function(Ne){return ot(Ne.model.translateX,Ne.model.translateY)}));var Cn=kn.selectAll("."+mr.cn.parcoordsControlView).data(Zt,Rt);Cn.enter().append("g").classed(mr.cn.parcoordsControlView,!0),Cn.attr("transform",(function(Ne){return ot(Ne.model.pad.l,Ne.model.pad.t)}));var En=Cn.selectAll("."+mr.cn.yAxis).data((function(Ne){return Ne.dimensions}),Rt);En.enter().append("g").classed(mr.cn.yAxis,!0),Cn.each((function(Ne){updatePanelLayout(En,Ne)})),mn.each((function(Ne){if(Ne.viewModel){!Ne.lineLayer||rt?Ne.lineLayer=br(this,Ne):Ne.lineLayer.update(Ne),(Ne.key||0===Ne.key)&&(Ne.viewModel[Ne.key]=Ne.lineLayer);var Ge=!Ne.context||rt;Ne.lineLayer.render(Ne.viewModel.panels,Ge)}})),En.attr("transform",(function(Ne){return ot(Ne.xScale(Ne.xIndex),0)})),En.call(tt.behavior.drag().origin((function(Ne){return Ne})).on("drag",(function(Ne){var Ge=Ne.parent;Ar.linePickActive(!1),Ne.x=Math.max(-mr.overdrag,Math.min(Ne.model.width+mr.overdrag,tt.event.x)),Ne.canvasX=Ne.x*Ne.model.canvasPixelRatio,En.sort((function(Ne,Ge){return Ne.x-Ge.x})).each((function(Ge,Qe){Ge.xIndex=Qe,Ge.x=Ne===Ge?Ge.x:Ge.xScale(Ge.xIndex),Ge.canvasX=Ge.x*Ge.model.canvasPixelRatio})),updatePanelLayout(En,Ge),En.filter((function(Ge){return 0!==Math.abs(Ne.xIndex-Ge.xIndex)})).attr("transform",(function(Ne){return ot(Ne.xScale(Ne.xIndex),0)})),tt.select(this).attr("transform",ot(Ne.x,0)),En.each((function(Qe,tt,rt){rt===Ne.parent.key&&(Ge.dimensions[tt]=Qe)})),Ge.contextLayer&&Ge.contextLayer.render(Ge.panels,!1,!someFiltersActive(Ge)),Ge.focusLayer.render&&Ge.focusLayer.render(Ge.panels)})).on("dragend",(function(Ne){var Ge=Ne.parent;Ne.x=Ne.xScale(Ne.xIndex),Ne.canvasX=Ne.x*Ne.model.canvasPixelRatio,updatePanelLayout(En,Ge),tt.select(this).attr("transform",(function(Ne){return ot(Ne.x,0)})),Ge.contextLayer&&Ge.contextLayer.render(Ge.panels,!1,!someFiltersActive(Ge)),Ge.focusLayer&&Ge.focusLayer.render(Ge.panels),Ge.pickLayer&&Ge.pickLayer.render(Ge.panels,!0),Ar.linePickActive(!0),rt&&rt.axesMoved&&rt.axesMoved(Ge.key,Ge.dimensions.map((function(Ne){return Ne.crossfilterDimensionIndex})))}))),En.exit().remove();var Pn=En.selectAll("."+mr.cn.axisOverlays).data(Zt,Rt);Pn.enter().append("g").classed(mr.cn.axisOverlays,!0),Pn.selectAll("."+mr.cn.axis).remove();var Dn=Pn.selectAll("."+mr.cn.axis).data(Zt,Rt);Dn.enter().append("g").classed(mr.cn.axis,!0),Dn.each((function(Ne){var Ge=Ne.model.height/Ne.model.tickDistance,Qe=Ne.domainScale,rt=Qe.domain();tt.select(this).call(tt.svg.axis().orient("left").tickSize(4).outerTickSize(2).ticks(Ge,Ne.tickFormat).tickValues(Ne.ordinal?rt:null).tickFormat((function(Ge){return dr.isOrdinal(Ne)?Ge:linearFormat(Ne.model.dimensions[Ne.visibleIndex],Ge)})).scale(Qe)),ht.font(Dn.selectAll("text"),Ne.model.tickFont)})),Dn.selectAll(".domain, .tick>line").attr("fill","none").attr("stroke","black").attr("stroke-opacity",.25).attr("stroke-width","1px"),Dn.selectAll("text").style("text-shadow","1px 1px 1px #fff, -1px -1px 1px #fff, 1px -1px 1px #fff, -1px 1px 1px #fff").style("cursor","default");var In=Pn.selectAll("."+mr.cn.axisHeading).data(Zt,Rt);In.enter().append("g").classed(mr.cn.axisHeading,!0);var zn=In.selectAll("."+mr.cn.axisTitle).data(Zt,Rt);zn.enter().append("text").classed(mr.cn.axisTitle,!0).attr("text-anchor","middle").style("cursor","ew-resize").style("pointer-events","auto"),zn.text((function(Ne){return Ne.label})).each((function(Ge){var Qe=tt.select(this);ht.font(Qe,Ge.model.labelFont),dt.convertToTspans(Qe,Ne)})).attr("transform",(function(Ne){var Ge=calcTilt(Ne.model.labelAngle,Ne.model.labelSide),Qe=mr.axisTitleOffset;return(Ge.dir>0?"":ot(0,2*Qe+Ne.model.height))+it(Ge.degrees)+ot(-Qe*Ge.dx,-Qe*Ge.dy)})).attr("text-anchor",(function(Ne){var Ge=calcTilt(Ne.model.labelAngle,Ne.model.labelSide);return 2*Math.abs(Ge.dx)>Math.abs(Ge.dy)?Ge.dir*Ge.dx<0?"start":"end":"middle"}));var Bn=Pn.selectAll("."+mr.cn.axisExtent).data(Zt,Rt);Bn.enter().append("g").classed(mr.cn.axisExtent,!0);var Vn=Bn.selectAll("."+mr.cn.axisExtentTop).data(Zt,Rt);Vn.enter().append("g").classed(mr.cn.axisExtentTop,!0),Vn.attr("transform",ot(0,-mr.axisExtentOffset));var Hn=Vn.selectAll("."+mr.cn.axisExtentTopText).data(Zt,Rt);Hn.enter().append("text").classed(mr.cn.axisExtentTopText,!0).call(styleExtentTexts),Hn.text((function(Ne){return extremeText(Ne,!0)})).each((function(Ne){ht.font(tt.select(this),Ne.model.rangeFont)}));var qn=Bn.selectAll("."+mr.cn.axisExtentBottom).data(Zt,Rt);qn.enter().append("g").classed(mr.cn.axisExtentBottom,!0),qn.attr("transform",(function(Ne){return ot(0,Ne.model.height+mr.axisExtentOffset)}));var Yn=qn.selectAll("."+mr.cn.axisExtentBottomText).data(Zt,Rt);Yn.enter().append("text").classed(mr.cn.axisExtentBottomText,!0).attr("dy","0.75em").call(styleExtentTexts),Yn.text((function(Ne){return extremeText(Ne,!1)})).each((function(Ne){ht.font(tt.select(this),Ne.model.rangeFont)})),xr.ensureAxisBrush(Pn)}},{"../../components/colorscale":655,"../../components/drawing":665,"../../lib":778,"../../lib/gup":775,"../../lib/svg_text_utils":803,"../../plots/cartesian/axes":828,"./axisbrush":1150,"./constants":1153,"./helpers":1155,"./lines":1157,"color-rgba":127,d3:169}],1160:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./parcoords"),rt=Ne("../../lib/prepare_regl"),nt=Ne("./helpers").isVisible;function newIndex(Ne,Ge,Qe){var tt=Ge.indexOf(Qe),rt=Ne.indexOf(tt);return-1===rt&&(rt+=Ge.length),rt}function sorter(Ne,Ge){return function(Qe,tt){return newIndex(Ne,Ge,Qe)-newIndex(Ne,Ge,tt)}}Ge.exports=function(Ne,Ge){var Qe=Ne._fullLayout;if(rt(Ne)){var at={},it={},ot={},dt={},ht=Qe._size;Ge.forEach((function(Ge,Qe){var tt=Ge[0].trace;ot[Qe]=tt.index;var rt=dt[Qe]=tt._fullInput.index;at[Qe]=Ne.data[rt].dimensions,it[Qe]=Ne.data[rt].dimensions.slice()}));var filterChanged=function(Ge,tt,rt){var nt=it[Ge][tt],at=rt.map((function(Ne){return Ne.slice()})),ht="dimensions["+tt+"].constraintrange",Dt=Qe._tracePreGUI[Ne._fullData[ot[Ge]]._fullInput.uid];if(void 0===Dt[ht]){var Ot=nt.constraintrange;Dt[ht]=Ot||null}var Rt=Ne._fullData[ot[Ge]].dimensions[tt];at.length?(1===at.length&&(at=at[0]),nt.constraintrange=at,Rt.constraintrange=at.slice(),at=[at]):(delete nt.constraintrange,delete Rt.constraintrange,at=null);var Zt={};Zt[ht]=at,Ne.emit("plotly_restyle",[Zt,[dt[Ge]]])},hover=function(Ge){Ne.emit("plotly_hover",Ge)},unhover=function(Ge){Ne.emit("plotly_unhover",Ge)},axesMoved=function(Ge,Qe){var tt=sorter(Qe,it[Ge].filter(nt));at[Ge].sort(tt),it[Ge].filter((function(Ne){return!nt(Ne)})).sort((function(Ne){return it[Ge].indexOf(Ne)})).forEach((function(Ne){at[Ge].splice(at[Ge].indexOf(Ne),1),at[Ge].splice(it[Ge].indexOf(Ne),0,Ne)})),Ne.emit("plotly_restyle",[{dimensions:[at[Ge]]},[dt[Ge]]])};tt(Ne,Ge,{width:ht.w,height:ht.h,margin:{t:ht.t,r:ht.r,b:ht.b,l:ht.l}},{filterChanged:filterChanged,hover:hover,unhover:unhover,axesMoved:axesMoved})}}},{"../../lib/prepare_regl":791,"./helpers":1155,"./parcoords":1159}],1161:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/attributes"),rt=Ne("../../plots/domain").attributes,nt=Ne("../../plots/font_attributes"),at=Ne("../../components/color/attributes"),it=Ne("../../plots/template_attributes").hovertemplateAttrs,ot=Ne("../../plots/template_attributes").texttemplateAttrs,dt=Ne("../../lib/extend").extendFlat,ht=nt({editType:"plot",arrayOk:!0,colorEditType:"plot"});Ge.exports={labels:{valType:"data_array",editType:"calc"},label0:{valType:"number",dflt:0,editType:"calc"},dlabel:{valType:"number",dflt:1,editType:"calc"},values:{valType:"data_array",editType:"calc"},marker:{colors:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:at.defaultLine,arrayOk:!0,editType:"style"},width:{valType:"number",min:0,dflt:0,arrayOk:!0,editType:"style"},editType:"calc"},editType:"calc"},text:{valType:"data_array",editType:"plot"},hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},scalegroup:{valType:"string",dflt:"",editType:"calc"},textinfo:{valType:"flaglist",flags:["label","text","value","percent"],extras:["none"],editType:"calc"},hoverinfo:dt({},tt.hoverinfo,{flags:["label","text","value","percent","name"]}),hovertemplate:it({},{keys:["label","color","value","percent","text"]}),texttemplate:ot({editType:"plot"},{keys:["label","color","value","percent","text"]}),textposition:{valType:"enumerated",values:["inside","outside","auto","none"],dflt:"auto",arrayOk:!0,editType:"plot"},textfont:dt({},ht,{}),insidetextorientation:{valType:"enumerated",values:["horizontal","radial","tangential","auto"],dflt:"auto",editType:"plot"},insidetextfont:dt({},ht,{}),outsidetextfont:dt({},ht,{}),automargin:{valType:"boolean",dflt:!1,editType:"plot"},title:{text:{valType:"string",dflt:"",editType:"plot"},font:dt({},ht,{}),position:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"plot"},editType:"plot"},domain:rt({name:"pie",trace:!0,editType:"calc"}),hole:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},sort:{valType:"boolean",dflt:!0,editType:"calc"},direction:{valType:"enumerated",values:["clockwise","counterclockwise"],dflt:"counterclockwise",editType:"calc"},rotation:{valType:"number",min:-360,max:360,dflt:0,editType:"calc"},pull:{valType:"number",min:0,max:1,dflt:0,arrayOk:!0,editType:"calc"},_deprecated:{title:{valType:"string",dflt:"",editType:"calc"},titlefont:dt({},ht,{}),titleposition:{valType:"enumerated",values:["top left","top center","top right","middle center","bottom left","bottom center","bottom right"],editType:"calc"}}}},{"../../components/color/attributes":642,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/domain":855,"../../plots/font_attributes":856,"../../plots/template_attributes":906}],1162:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/plots");Qe.name="pie",Qe.plot=function(Ne,Ge,rt,nt){tt.plotBasePlot(Qe.name,Ne,Ge,rt,nt)},Qe.clean=function(Ne,Ge,rt,nt){tt.cleanBasePlot(Qe.name,Ne,Ge,rt,nt)}},{"../../plots/plots":891}],1163:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("tinycolor2"),nt=Ne("../../components/color"),at={};function calc(Ne,Ge){var Qe,rt,nt=[],at=Ne._fullLayout,it=at.hiddenlabels||[],ot=Ge.labels,dt=Ge.marker.colors||[],ht=Ge.values,Dt=Ge._length,Ot=Ge._hasValues&&Dt;if(Ge.dlabel)for(ot=new Array(Dt),Qe=0;Qe<Dt;Qe++)ot[Qe]=String(Ge.label0+Qe*Ge.dlabel);var Rt={},Zt=makePullColorFn(at["_"+Ge.type+"colormap"]),er=0,dr=!1;for(Qe=0;Qe<Dt;Qe++){var mr,xr,br;if(Ot){if(mr=ht[Qe],!tt(mr))continue;if((mr=+mr)<0)continue}else mr=1;void 0!==(xr=ot[Qe])&&""!==xr||(xr=Qe);var Ar=Rt[xr=String(xr)];void 0===Ar?(Rt[xr]=nt.length,(br=-1!==it.indexOf(xr))||(er+=mr),nt.push({v:mr,label:xr,color:Zt(dt[Qe],xr),i:Qe,pts:[Qe],hidden:br})):(dr=!0,(rt=nt[Ar]).v+=mr,rt.pts.push(Qe),rt.hidden||(er+=mr),!1===rt.color&&dt[Qe]&&(rt.color=Zt(dt[Qe],xr)))}return("funnelarea"===Ge.type?dr:Ge.sort)&&nt.sort((function(Ne,Ge){return Ge.v-Ne.v})),nt[0]&&(nt[0].vTotal=er),nt}function makePullColorFn(Ne){return function(Ge,Qe){return!!Ge&&!!(Ge=rt(Ge)).isValid()&&(Ge=nt.addOpacity(Ge,Ge.getAlpha()),Ne[Qe]||(Ne[Qe]=Ge),Ge)}}function crossTraceCalc(Ne,Ge){var Qe=(Ge||{}).type;Qe||(Qe="pie");var tt=Ne._fullLayout,rt=Ne.calcdata,nt=tt[Qe+"colorway"],it=tt["_"+Qe+"colormap"];tt["extend"+Qe+"colors"]&&(nt=generateExtendedColors(nt,at));for(var ot=0,dt=0;dt<rt.length;dt++){var ht=rt[dt];if(ht[0].trace.type===Qe)for(var Dt=0;Dt<ht.length;Dt++){var Ot=ht[Dt];!1===Ot.color&&(it[Ot.label]?Ot.color=it[Ot.label]:(it[Ot.label]=Ot.color=nt[ot%nt.length],ot++))}}}function generateExtendedColors(Ne,Ge){var Qe,tt=JSON.stringify(Ne),nt=Ge[tt];if(!nt){for(nt=Ne.slice(),Qe=0;Qe<Ne.length;Qe++)nt.push(rt(Ne[Qe]).lighten(20).toHexString());for(Qe=0;Qe<Ne.length;Qe++)nt.push(rt(Ne[Qe]).darken(20).toHexString());Ge[tt]=nt}return nt}Ge.exports={calc:calc,crossTraceCalc:crossTraceCalc,makePullColorFn:makePullColorFn,generateExtendedColors:generateExtendedColors}},{"../../components/color":643,"fast-isnumeric":241,tinycolor2:576}],1164:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../lib"),nt=Ne("./attributes"),at=Ne("../../plots/domain").defaults,it=Ne("../bar/defaults").handleText;function handleLabelsAndValues(Ne,Ge){var Qe=Array.isArray(Ne),nt=rt.isArrayOrTypedArray(Ge),at=Math.min(Qe?Ne.length:1/0,nt?Ge.length:1/0);if(isFinite(at)||(at=0),at&&nt){for(var it,ot=0;ot<at;ot++){var dt=Ge[ot];if(tt(dt)&&dt>0){it=!0;break}}it||(at=0)}return{hasLabels:Qe,hasValues:nt,len:at}}function supplyDefaults(Ne,Ge,Qe,tt){function coerce(Qe,tt){return rt.coerce(Ne,Ge,nt,Qe,tt)}var ot=handleLabelsAndValues(coerce("labels"),coerce("values")),dt=ot.len;if(Ge._hasLabels=ot.hasLabels,Ge._hasValues=ot.hasValues,!Ge._hasLabels&&Ge._hasValues&&(coerce("label0"),coerce("dlabel")),dt){Ge._length=dt,coerce("marker.line.width")&&coerce("marker.line.color"),coerce("marker.colors"),coerce("scalegroup");var ht,Dt=coerce("text"),Ot=coerce("texttemplate");if(Ot||(ht=coerce("textinfo",Array.isArray(Dt)?"text+percent":"percent")),coerce("hovertext"),coerce("hovertemplate"),Ot||ht&&"none"!==ht){var Rt=coerce("textposition");it(Ne,Ge,tt,coerce,Rt,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),(Array.isArray(Rt)||"auto"===Rt||"outside"===Rt)&&coerce("automargin"),("inside"===Rt||"auto"===Rt||Array.isArray(Rt))&&coerce("insidetextorientation")}at(Ge,tt,coerce);var Zt=coerce("hole");if(coerce("title.text")){var er=coerce("title.position",Zt?"middle center":"top center");Zt||"middle center"!==er||(Ge.title.position="top center"),rt.coerceFont(coerce,"title.font",tt.font)}coerce("sort"),coerce("direction"),coerce("rotation"),coerce("pull")}else Ge.visible=!1}Ge.exports={handleLabelsAndValues:handleLabelsAndValues,supplyDefaults:supplyDefaults}},{"../../lib":778,"../../plots/domain":855,"../bar/defaults":925,"./attributes":1161,"fast-isnumeric":241}],1165:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/fx/helpers").appendArrayMultiPointValues;Ge.exports=function(Ne,Ge){var Qe={curveNumber:Ge.index,pointNumbers:Ne.pts,data:Ge._input,fullData:Ge,label:Ne.label,color:Ne.color,value:Ne.v,percent:Ne.percent,text:Ne.text,v:Ne.v};return 1===Ne.pts.length&&(Qe.pointNumber=Qe.i=Ne.pts[0]),tt(Qe,Ge,Ne.pts),"funnelarea"===Ge.type&&(delete Qe.v,delete Qe.i),Qe}},{"../../components/fx/helpers":679}],1166:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib");function format(Ne){return-1!==Ne.indexOf("e")?Ne.replace(/[.]?0+e/,"e"):-1!==Ne.indexOf(".")?Ne.replace(/[.]?0+$/,""):Ne}Qe.formatPiePercent=function(Ne,Ge){var Qe=format((100*Ne).toPrecision(3));return tt.numSeparate(Qe,Ge)+"%"},Qe.formatPieValue=function(Ne,Ge){var Qe=format(Ne.toPrecision(10));return tt.numSeparate(Qe,Ge)},Qe.getFirstFilled=function(Ne,Ge){if(Array.isArray(Ne))for(var Qe=0;Qe<Ge.length;Qe++){var tt=Ne[Ge[Qe]];if(tt||0===tt||""===tt)return tt}},Qe.castOption=function(Ne,Ge){return Array.isArray(Ne)?Qe.getFirstFilled(Ne,Ge):Ne||void 0},Qe.getRotationAngle=function(Ne){return("auto"===Ne?0:Ne)*Math.PI/180}},{"../../lib":778}],1167:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults").supplyDefaults,supplyLayoutDefaults:Ne("./layout_defaults"),layoutAttributes:Ne("./layout_attributes"),calc:Ne("./calc").calc,crossTraceCalc:Ne("./calc").crossTraceCalc,plot:Ne("./plot").plot,style:Ne("./style"),styleOne:Ne("./style_one"),moduleType:"trace",name:"pie",basePlotModule:Ne("./base_plot"),categories:["pie-like","pie","showLegend"],meta:{}}},{"./attributes":1161,"./base_plot":1162,"./calc":1163,"./defaults":1164,"./layout_attributes":1168,"./layout_defaults":1169,"./plot":1170,"./style":1171,"./style_one":1172}],1168:[function(Ne,Ge,Qe){"use strict";Ge.exports={hiddenlabels:{valType:"data_array",editType:"calc"},piecolorway:{valType:"colorlist",editType:"calc"},extendpiecolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1169:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./layout_attributes");Ge.exports=function(Ne,Ge){function coerce(Qe,nt){return tt.coerce(Ne,Ge,rt,Qe,nt)}coerce("hiddenlabels"),coerce("piecolorway",Ge.colorway),coerce("extendpiecolors")}},{"../../lib":778,"./layout_attributes":1168}],1170:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../plots/plots"),nt=Ne("../../components/fx"),at=Ne("../../components/color"),it=Ne("../../components/drawing"),ot=Ne("../../lib"),dt=ot.strScale,ht=ot.strTranslate,Dt=Ne("../../lib/svg_text_utils"),Ot=Ne("../bar/uniform_text"),Rt=Ot.recordMinTextSize,Zt=Ot.clearMinTextSize,er=Ne("../bar/constants").TEXTPAD,dr=Ne("./helpers"),mr=Ne("./event_data"),xr=Ne("../../lib").isValidTextValue;function plot(Ne,Ge){var Qe=Ne._fullLayout,nt=Qe._size;Zt("pie",Qe),prerenderTitles(Ge,Ne),layoutAreas(Ge,nt);var at=ot.makeTraceGroups(Qe._pielayer,Ge,"trace").each((function(Ge){var at=tt.select(this),Ot=Ge[0],Zt=Ot.trace;setCoords(Ge),at.attr("stroke-linejoin","round"),at.each((function(){var er=tt.select(this).selectAll("g.slice").data(Ge);er.enter().append("g").classed("slice",!0),er.exit().remove();var mr=[[[],[]],[[],[]]],xr=!1;er.each((function(rt,nt){if(rt.hidden)tt.select(this).selectAll("path,g").remove();else{rt.pointNumber=rt.i,rt.curveNumber=Zt.index,mr[rt.pxmid[1]<0?0:1][rt.pxmid[0]<0?0:1].push(rt);var at=Ot.cx,dt=Ot.cy,ht=tt.select(this),er=ht.selectAll("path.surface").data([rt]);if(er.enter().append("path").classed("surface",!0).style({"pointer-events":"all"}),ht.call(attachFxHandlers,Ne,Ge),Zt.pull){var br=+dr.castOption(Zt.pull,rt.pts)||0;br>0&&(at+=br*rt.pxmid[0],dt+=br*rt.pxmid[1])}rt.cxFinal=at,rt.cyFinal=dt;var Ar=Zt.hole;if(rt.v===Ot.vTotal){var en="M"+(at+rt.px0[0])+","+(dt+rt.px0[1])+arc(rt.px0,rt.pxmid,!0,1)+arc(rt.pxmid,rt.px0,!0,1)+"Z";Ar?er.attr("d","M"+(at+Ar*rt.px0[0])+","+(dt+Ar*rt.px0[1])+arc(rt.px0,rt.pxmid,!1,Ar)+arc(rt.pxmid,rt.px0,!1,Ar)+"Z"+en):er.attr("d",en)}else{var mn=arc(rt.px0,rt.px1,!0,1);if(Ar){var xn=1-Ar;er.attr("d","M"+(at+Ar*rt.px1[0])+","+(dt+Ar*rt.px1[1])+arc(rt.px1,rt.px0,!1,Ar)+"l"+xn*rt.px0[0]+","+xn*rt.px0[1]+mn+"Z")}else er.attr("d","M"+at+","+dt+"l"+rt.px0[0]+","+rt.px0[1]+mn+"Z")}formatSliceLabel(Ne,rt,Ot);var kn=dr.castOption(Zt.textposition,rt.pts),Cn=ht.selectAll("g.slicetext").data(rt.text&&"none"!==kn?[0]:[]);Cn.enter().append("g").classed("slicetext",!0),Cn.exit().remove(),Cn.each((function(){var ht=ot.ensureSingle(tt.select(this),"text","",(function(Ne){Ne.attr("data-notex",1)})),er=ot.ensureUniformFontSize(Ne,"outside"===kn?determineOutsideTextFont(Zt,rt,Qe.font):determineInsideTextFont(Zt,rt,Qe.font));ht.text(rt.text).attr({class:"slicetext",transform:"","text-anchor":"middle"}).call(it.font,er).call(Dt.convertToTspans,Ne);var dr,mr=it.bBox(ht.node());if("outside"===kn)dr=transformOutsideText(mr,rt);else if(dr=transformInsideText(mr,rt,Ot),"auto"===kn&&dr.scale<1){var br=ot.ensureUniformFontSize(Ne,Zt.outsidetextfont);ht.call(it.font,br),dr=transformOutsideText(mr=it.bBox(ht.node()),rt)}var Ar=dr.textPosAngle,en=void 0===Ar?rt.pxmid:getCoords(Ot.r,Ar);if(dr.targetX=at+en[0]*dr.rCenter+(dr.x||0),dr.targetY=dt+en[1]*dr.rCenter+(dr.y||0),computeTransform(dr,mr),dr.outside){var mn=dr.targetY;rt.yLabelMin=mn-mr.height/2,rt.yLabelMid=mn,rt.yLabelMax=mn+mr.height/2,rt.labelExtraX=0,rt.labelExtraY=0,xr=!0}dr.fontSize=er.size,Rt(Zt.type,dr,Qe),Ge[nt].transform=dr,ht.attr("transform",ot.getTextTransform(dr))}))}function arc(Ne,Ge,Qe,tt){var nt=tt*(Ge[0]-Ne[0]),at=tt*(Ge[1]-Ne[1]);return"a"+tt*Ot.r+","+tt*Ot.r+" 0 "+rt.largeArc+(Qe?" 1 ":" 0 ")+nt+","+at}}));var br=tt.select(this).selectAll("g.titletext").data(Zt.title.text?[0]:[]);if(br.enter().append("g").classed("titletext",!0),br.exit().remove(),br.each((function(){var Ge,Qe=ot.ensureSingle(tt.select(this),"text","",(function(Ne){Ne.attr("data-notex",1)})),rt=Zt.title.text;Zt._meta&&(rt=ot.templateString(rt,Zt._meta)),Qe.text(rt).attr({class:"titletext",transform:"","text-anchor":"middle"}).call(it.font,Zt.title.font).call(Dt.convertToTspans,Ne),Ge="middle center"===Zt.title.position?positionTitleInside(Ot):positionTitleOutside(Ot,nt),Qe.attr("transform",ht(Ge.x,Ge.y)+dt(Math.min(1,Ge.scale))+ht(Ge.tx,Ge.ty))})),xr&&scootLabels(mr,Zt),plotTextLines(er,Zt),xr&&Zt.automargin){var Ar=it.bBox(at.node()),en=Zt.domain,mn=nt.w*(en.x[1]-en.x[0]),xn=nt.h*(en.y[1]-en.y[0]),kn=(.5*mn-Ot.r)/nt.w,Cn=(.5*xn-Ot.r)/nt.h;rt.autoMargin(Ne,"pie."+Zt.uid+".automargin",{xl:en.x[0]-kn,xr:en.x[1]+kn,yb:en.y[0]-Cn,yt:en.y[1]+Cn,l:Math.max(Ot.cx-Ot.r-Ar.left,0),r:Math.max(Ar.right-(Ot.cx+Ot.r),0),b:Math.max(Ar.bottom-(Ot.cy+Ot.r),0),t:Math.max(Ot.cy-Ot.r-Ar.top,0),pad:5})}}))}));setTimeout((function(){at.selectAll("tspan").each((function(){var Ne=tt.select(this);Ne.attr("dy")&&Ne.attr("dy",Ne.attr("dy"))}))}),0)}function plotTextLines(Ne,Ge){Ne.each((function(Ne){var Qe=tt.select(this);if(Ne.labelExtraX||Ne.labelExtraY){var rt=Qe.select("g.slicetext text");Ne.transform.targetX+=Ne.labelExtraX,Ne.transform.targetY+=Ne.labelExtraY,rt.attr("transform",ot.getTextTransform(Ne.transform));var nt=Ne.cxFinal+Ne.pxmid[0],it="M"+nt+","+(Ne.cyFinal+Ne.pxmid[1]),dt=(Ne.yLabelMax-Ne.yLabelMin)*(Ne.pxmid[0]<0?-1:1)/4;if(Ne.labelExtraX){var ht=Ne.labelExtraX*Ne.pxmid[1]/Ne.pxmid[0],Dt=Ne.yLabelMid+Ne.labelExtraY-(Ne.cyFinal+Ne.pxmid[1]);Math.abs(ht)>Math.abs(Dt)?it+="l"+Dt*Ne.pxmid[0]/Ne.pxmid[1]+","+Dt+"H"+(nt+Ne.labelExtraX+dt):it+="l"+Ne.labelExtraX+","+ht+"v"+(Dt-ht)+"h"+dt}else it+="V"+(Ne.yLabelMid+Ne.labelExtraY)+"h"+dt;ot.ensureSingle(Qe,"path","textline").call(at.stroke,Ge.outsidetextfont.color).attr({"stroke-width":Math.min(2,Ge.outsidetextfont.size/8),d:it,fill:"none"})}else Qe.select("path.textline").remove()}))}function attachFxHandlers(Ne,Ge,Qe){var rt=Qe[0],at=rt.trace,it=rt.cx,dt=rt.cy;"_hasHoverLabel"in at||(at._hasHoverLabel=!1),"_hasHoverEvent"in at||(at._hasHoverEvent=!1),Ne.on("mouseover",(function(Ne){var Qe=Ge._fullLayout,ht=Ge._fullData[at.index];if(!Ge._dragging&&!1!==Qe.hovermode){var Dt=ht.hoverinfo;if(Array.isArray(Dt)&&(Dt=nt.castHoverinfo({hoverinfo:[dr.castOption(Dt,Ne.pts)],_module:at._module},Qe,0)),"all"===Dt&&(Dt="label+text+value+percent+name"),ht.hovertemplate||"none"!==Dt&&"skip"!==Dt&&Dt){var Ot=Ne.rInscribed||0,Rt=it+Ne.pxmid[0]*(1-Ot),Zt=dt+Ne.pxmid[1]*(1-Ot),er=Qe.separators,xr=[];if(Dt&&-1!==Dt.indexOf("label")&&xr.push(Ne.label),Ne.text=dr.castOption(ht.hovertext||ht.text,Ne.pts),Dt&&-1!==Dt.indexOf("text")){var br=Ne.text;ot.isValidTextValue(br)&&xr.push(br)}Ne.value=Ne.v,Ne.valueLabel=dr.formatPieValue(Ne.v,er),Dt&&-1!==Dt.indexOf("value")&&xr.push(Ne.valueLabel),Ne.percent=Ne.v/rt.vTotal,Ne.percentLabel=dr.formatPiePercent(Ne.percent,er),Dt&&-1!==Dt.indexOf("percent")&&xr.push(Ne.percentLabel);var Ar=ht.hoverlabel,en=Ar.font;nt.loneHover({trace:at,x0:Rt-Ot*rt.r,x1:Rt+Ot*rt.r,y:Zt,text:xr.join("<br>"),name:ht.hovertemplate||-1!==Dt.indexOf("name")?ht.name:void 0,idealAlign:Ne.pxmid[0]<0?"left":"right",color:dr.castOption(Ar.bgcolor,Ne.pts)||Ne.color,borderColor:dr.castOption(Ar.bordercolor,Ne.pts),fontFamily:dr.castOption(en.family,Ne.pts),fontSize:dr.castOption(en.size,Ne.pts),fontColor:dr.castOption(en.color,Ne.pts),nameLength:dr.castOption(Ar.namelength,Ne.pts),textAlign:dr.castOption(Ar.align,Ne.pts),hovertemplate:dr.castOption(ht.hovertemplate,Ne.pts),hovertemplateLabels:Ne,eventData:[mr(Ne,ht)]},{container:Qe._hoverlayer.node(),outerContainer:Qe._paper.node(),gd:Ge}),at._hasHoverLabel=!0}at._hasHoverEvent=!0,Ge.emit("plotly_hover",{points:[mr(Ne,ht)],event:tt.event})}})),Ne.on("mouseout",(function(Ne){var Qe=Ge._fullLayout,rt=Ge._fullData[at.index],it=tt.select(this).datum();at._hasHoverEvent&&(Ne.originalEvent=tt.event,Ge.emit("plotly_unhover",{points:[mr(it,rt)],event:tt.event}),at._hasHoverEvent=!1),at._hasHoverLabel&&(nt.loneUnhover(Qe._hoverlayer.node()),at._hasHoverLabel=!1)})),Ne.on("click",(function(Ne){var Qe=Ge._fullLayout,rt=Ge._fullData[at.index];Ge._dragging||!1===Qe.hovermode||(Ge._hoverdata=[mr(Ne,rt)],nt.click(Ge,tt.event))}))}function determineOutsideTextFont(Ne,Ge,Qe){return{color:dr.castOption(Ne.outsidetextfont.color,Ge.pts)||dr.castOption(Ne.textfont.color,Ge.pts)||Qe.color,family:dr.castOption(Ne.outsidetextfont.family,Ge.pts)||dr.castOption(Ne.textfont.family,Ge.pts)||Qe.family,size:dr.castOption(Ne.outsidetextfont.size,Ge.pts)||dr.castOption(Ne.textfont.size,Ge.pts)||Qe.size}}function determineInsideTextFont(Ne,Ge,Qe){var tt=dr.castOption(Ne.insidetextfont.color,Ge.pts);!tt&&Ne._input.textfont&&(tt=dr.castOption(Ne._input.textfont.color,Ge.pts));var rt=dr.castOption(Ne.insidetextfont.family,Ge.pts)||dr.castOption(Ne.textfont.family,Ge.pts)||Qe.family,nt=dr.castOption(Ne.insidetextfont.size,Ge.pts)||dr.castOption(Ne.textfont.size,Ge.pts)||Qe.size;return{color:tt||at.contrast(Ge.color),family:rt,size:nt}}function prerenderTitles(Ne,Ge){for(var Qe,tt,rt=0;rt<Ne.length;rt++)if((tt=(Qe=Ne[rt][0]).trace).title.text){var nt=tt.title.text;tt._meta&&(nt=ot.templateString(nt,tt._meta));var at=it.tester.append("text").attr("data-notex",1).text(nt).call(it.font,tt.title.font).call(Dt.convertToTspans,Ge),dt=it.bBox(at.node(),!0);Qe.titleBox={width:dt.width,height:dt.height},at.remove()}}function transformInsideText(Ne,Ge,Qe){var tt=Qe.r||Ge.rpx1,rt=Ge.rInscribed;if(Ge.startangle===Ge.stopangle)return{rCenter:1-rt,scale:0,rotate:0,textPosAngle:0};var nt,at=Ge.ring,it=1===at&&Math.abs(Ge.startangle-Ge.stopangle)===2*Math.PI,ot=Ge.halfangle,dt=Ge.midangle,ht=Qe.trace.insidetextorientation,Dt="horizontal"===ht,Ot="tangential"===ht,Rt="radial"===ht,Zt="auto"===ht,er=[];if(!Zt){var dr,considerCrossing=function(Qe,rt){if(isCrossing(Ge,Qe)){var it=Math.abs(Qe-Ge.startangle),ot=Math.abs(Qe-Ge.stopangle),dt=it<ot?it:ot;(nt="tan"===rt?calcTanTransform(Ne,tt,at,dt,0):calcRadTransform(Ne,tt,at,dt,Math.PI/2)).textPosAngle=Qe,er.push(nt)}};if(Dt||Ot){for(dr=4;dr>=-4;dr-=2)considerCrossing(Math.PI*dr,"tan");for(dr=4;dr>=-4;dr-=2)considerCrossing(Math.PI*(dr+1),"tan")}if(Dt||Rt){for(dr=4;dr>=-4;dr-=2)considerCrossing(Math.PI*(dr+1.5),"rad");for(dr=4;dr>=-4;dr-=2)considerCrossing(Math.PI*(dr+.5),"rad")}}if(it||Zt||Dt){var mr=Math.sqrt(Ne.width*Ne.width+Ne.height*Ne.height);if((nt={scale:rt*tt*2/mr,rCenter:1-rt,rotate:0}).textPosAngle=(Ge.startangle+Ge.stopangle)/2,nt.scale>=1)return nt;er.push(nt)}(Zt||Rt)&&((nt=calcRadTransform(Ne,tt,at,ot,dt)).textPosAngle=(Ge.startangle+Ge.stopangle)/2,er.push(nt)),(Zt||Ot)&&((nt=calcTanTransform(Ne,tt,at,ot,dt)).textPosAngle=(Ge.startangle+Ge.stopangle)/2,er.push(nt));for(var xr=0,br=0,Ar=0;Ar<er.length;Ar++){var en=er[Ar].scale;if(br<en&&(br=en,xr=Ar),!Zt&&br>=1)break}return er[xr]}function isCrossing(Ne,Ge){var Qe=Ne.startangle,tt=Ne.stopangle;return Qe>Ge&&Ge>tt||Qe<Ge&&Ge<tt}function calcRadTransform(Ne,Ge,Qe,tt,rt){Ge=Math.max(0,Ge-2*er);var nt=Ne.width/Ne.height,at=calcMaxHalfSize(nt,tt,Ge,Qe);return{scale:2*at/Ne.height,rCenter:calcRCenter(nt,at/Ge),rotate:calcRotate(rt)}}function calcTanTransform(Ne,Ge,Qe,tt,rt){Ge=Math.max(0,Ge-2*er);var nt=Ne.height/Ne.width,at=calcMaxHalfSize(nt,tt,Ge,Qe);return{scale:2*at/Ne.width,rCenter:calcRCenter(nt,at/Ge),rotate:calcRotate(rt+Math.PI/2)}}function calcRCenter(Ne,Ge){return Math.cos(Ge)-Ne*Ge}function calcRotate(Ne){return(180/Math.PI*Ne+720)%180-90}function calcMaxHalfSize(Ne,Ge,Qe,tt){var rt=Ne+1/(2*Math.tan(Ge));return Qe*Math.min(1/(Math.sqrt(rt*rt+.5)+rt),tt/(Math.sqrt(Ne*Ne+tt/2)+Ne))}function getInscribedRadiusFraction(Ne,Ge){return Ne.v!==Ge.vTotal||Ge.trace.hole?Math.min(1/(1+1/Math.sin(Ne.halfangle)),Ne.ring/2):1}function transformOutsideText(Ne,Ge){var Qe=Ge.pxmid[0],tt=Ge.pxmid[1],rt=Ne.width/2,nt=Ne.height/2;return Qe<0&&(rt*=-1),tt<0&&(nt*=-1),{scale:1,rCenter:1,rotate:0,x:rt+Math.abs(nt)*(rt>0?1:-1)/2,y:nt/(1+Qe*Qe/(tt*tt)),outside:!0}}function positionTitleInside(Ne){var Ge=Math.sqrt(Ne.titleBox.width*Ne.titleBox.width+Ne.titleBox.height*Ne.titleBox.height);return{x:Ne.cx,y:Ne.cy,scale:Ne.trace.hole*Ne.r*2/Ge,tx:0,ty:-Ne.titleBox.height/2+Ne.trace.title.font.size}}function positionTitleOutside(Ne,Ge){var Qe,tt=1,rt=1,nt=Ne.trace,at={x:Ne.cx,y:Ne.cy},it={tx:0,ty:0};it.ty+=nt.title.font.size,Qe=getMaxPull(nt),-1!==nt.title.position.indexOf("top")?(at.y-=(1+Qe)*Ne.r,it.ty-=Ne.titleBox.height):-1!==nt.title.position.indexOf("bottom")&&(at.y+=(1+Qe)*Ne.r);var ot=applyAspectRatio(Ne.r,Ne.trace.aspectratio),dt=Ge.w*(nt.domain.x[1]-nt.domain.x[0])/2;return-1!==nt.title.position.indexOf("left")?(dt+=ot,at.x-=(1+Qe)*ot,it.tx+=Ne.titleBox.width/2):-1!==nt.title.position.indexOf("center")?dt*=2:-1!==nt.title.position.indexOf("right")&&(dt+=ot,at.x+=(1+Qe)*ot,it.tx-=Ne.titleBox.width/2),tt=dt/Ne.titleBox.width,rt=getTitleSpace(Ne,Ge)/Ne.titleBox.height,{x:at.x,y:at.y,scale:Math.min(tt,rt),tx:it.tx,ty:it.ty}}function applyAspectRatio(Ne,Ge){return Ne/(void 0===Ge?1:Ge)}function getTitleSpace(Ne,Ge){var Qe=Ne.trace,tt=Ge.h*(Qe.domain.y[1]-Qe.domain.y[0]);return Math.min(Ne.titleBox.height,tt/2)}function getMaxPull(Ne){var Ge,Qe=Ne.pull;if(!Qe)return 0;if(Array.isArray(Qe))for(Qe=0,Ge=0;Ge<Ne.pull.length;Ge++)Ne.pull[Ge]>Qe&&(Qe=Ne.pull[Ge]);return Qe}function scootLabels(Ne,Ge){var Qe,tt,rt,nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt;function topFirst(Ne,Ge){return Ne.pxmid[1]-Ge.pxmid[1]}function bottomFirst(Ne,Ge){return Ge.pxmid[1]-Ne.pxmid[1]}function scootOneLabel(Ne,Qe){Qe||(Qe={});var rt,dt,ht,Ot,Rt=Qe.labelExtraY+(tt?Qe.yLabelMax:Qe.yLabelMin),Zt=tt?Ne.yLabelMin:Ne.yLabelMax,er=tt?Ne.yLabelMax:Ne.yLabelMin,mr=Ne.cyFinal+at(Ne.px0[1],Ne.px1[1]),xr=Rt-Zt;if(xr*ot>0&&(Ne.labelExtraY=xr),Array.isArray(Ge.pull))for(dt=0;dt<Dt.length;dt++)(ht=Dt[dt])===Ne||(dr.castOption(Ge.pull,Ne.pts)||0)>=(dr.castOption(Ge.pull,ht.pts)||0)||((Ne.pxmid[1]-ht.pxmid[1])*ot>0?(xr=ht.cyFinal+at(ht.px0[1],ht.px1[1])-Zt-Ne.labelExtraY)*ot>0&&(Ne.labelExtraY+=xr):(er+Ne.labelExtraY-mr)*ot>0&&(rt=3*it*Math.abs(dt-Dt.indexOf(Ne)),(Ot=ht.cxFinal+nt(ht.px0[0],ht.px1[0])+rt-(Ne.cxFinal+Ne.pxmid[0])-Ne.labelExtraX)*it>0&&(Ne.labelExtraX+=Ot)))}for(tt=0;tt<2;tt++)for(rt=tt?topFirst:bottomFirst,at=tt?Math.max:Math.min,ot=tt?1:-1,Qe=0;Qe<2;Qe++){for(nt=Qe?Math.max:Math.min,it=Qe?1:-1,(dt=Ne[tt][Qe]).sort(rt),ht=Ne[1-tt][Qe],Dt=ht.concat(dt),Rt=[],Ot=0;Ot<dt.length;Ot++)void 0!==dt[Ot].yLabelMid&&Rt.push(dt[Ot]);for(Zt=!1,Ot=0;tt&&Ot<ht.length;Ot++)if(void 0!==ht[Ot].yLabelMid){Zt=ht[Ot];break}for(Ot=0;Ot<Rt.length;Ot++){var er=Ot&&Rt[Ot-1];Zt&&!Ot&&(er=Zt),scootOneLabel(Rt[Ot],er)}}}function layoutAreas(Ne,Ge){for(var Qe=[],tt=0;tt<Ne.length;tt++){var rt=Ne[tt][0],nt=rt.trace,at=nt.domain,it=Ge.w*(at.x[1]-at.x[0]),ot=Ge.h*(at.y[1]-at.y[0]);nt.title.text&&"middle center"!==nt.title.position&&(ot-=getTitleSpace(rt,Ge));var dt=it/2,ht=ot/2;"funnelarea"!==nt.type||nt.scalegroup||(ht/=nt.aspectratio),rt.r=Math.min(dt,ht)/(1+getMaxPull(nt)),rt.cx=Ge.l+Ge.w*(nt.domain.x[1]+nt.domain.x[0])/2,rt.cy=Ge.t+Ge.h*(1-nt.domain.y[0])-ot/2,nt.title.text&&-1!==nt.title.position.indexOf("bottom")&&(rt.cy-=getTitleSpace(rt,Ge)),nt.scalegroup&&-1===Qe.indexOf(nt.scalegroup)&&Qe.push(nt.scalegroup)}groupScale(Ne,Qe)}function groupScale(Ne,Ge){for(var Qe,tt,rt,nt=0;nt<Ge.length;nt++){var at=1/0,it=Ge[nt];for(tt=0;tt<Ne.length;tt++)if((rt=(Qe=Ne[tt][0]).trace).scalegroup===it){var ot;if("pie"===rt.type)ot=Qe.r*Qe.r;else if("funnelarea"===rt.type){var dt,ht;rt.aspectratio>1?ht=(dt=Qe.r)/rt.aspectratio:dt=(ht=Qe.r)*rt.aspectratio,ot=(dt*=(1+rt.baseratio)/2)*ht}at=Math.min(at,ot/Qe.vTotal)}for(tt=0;tt<Ne.length;tt++)if((rt=(Qe=Ne[tt][0]).trace).scalegroup===it){var Dt=at*Qe.vTotal;"funnelarea"===rt.type&&(Dt/=(1+rt.baseratio)/2,Dt/=rt.aspectratio),Qe.r=Math.sqrt(Dt)}}}function setCoords(Ne){var Ge,Qe,tt,rt=Ne[0],nt=rt.r,at=rt.trace,it=dr.getRotationAngle(at.rotation),ot=2*Math.PI/rt.vTotal,dt="px0",ht="px1";if("counterclockwise"===at.direction){for(Ge=0;Ge<Ne.length&&Ne[Ge].hidden;Ge++);if(Ge===Ne.length)return;it+=ot*Ne[Ge].v,ot*=-1,dt="px1",ht="px0"}for(tt=getCoords(nt,it),Ge=0;Ge<Ne.length;Ge++)(Qe=Ne[Ge]).hidden||(Qe[dt]=tt,Qe.startangle=it,it+=ot*Qe.v/2,Qe.pxmid=getCoords(nt,it),Qe.midangle=it,tt=getCoords(nt,it+=ot*Qe.v/2),Qe.stopangle=it,Qe[ht]=tt,Qe.largeArc=Qe.v>rt.vTotal/2?1:0,Qe.halfangle=Math.PI*Math.min(Qe.v/rt.vTotal,.5),Qe.ring=1-at.hole,Qe.rInscribed=getInscribedRadiusFraction(Qe,rt))}function getCoords(Ne,Ge){return[Ne*Math.sin(Ge),-Ne*Math.cos(Ge)]}function formatSliceLabel(Ne,Ge,Qe){var tt=Ne._fullLayout,rt=Qe.trace,nt=rt.texttemplate,at=rt.textinfo;if(!nt&&at&&"none"!==at){var it,dt=at.split("+"),hasFlag=function(Ne){return-1!==dt.indexOf(Ne)},ht=hasFlag("label"),Dt=hasFlag("text"),Ot=hasFlag("value"),Rt=hasFlag("percent"),Zt=tt.separators;if(it=ht?[Ge.label]:[],Dt){var er=dr.getFirstFilled(rt.text,Ge.pts);xr(er)&&it.push(er)}Ot&&it.push(dr.formatPieValue(Ge.v,Zt)),Rt&&it.push(dr.formatPiePercent(Ge.v/Qe.vTotal,Zt)),Ge.text=it.join("<br>")}function makeTemplateVariables(Ne){return{label:Ne.label,value:Ne.v,valueLabel:dr.formatPieValue(Ne.v,tt.separators),percent:Ne.v/Qe.vTotal,percentLabel:dr.formatPiePercent(Ne.v/Qe.vTotal,tt.separators),color:Ne.color,text:Ne.text,customdata:ot.castOption(rt,Ne.i,"customdata")}}if(nt){var mr=ot.castOption(rt,Ge.i,"texttemplate");if(mr){var br=makeTemplateVariables(Ge),Ar=dr.getFirstFilled(rt.text,Ge.pts);(xr(Ar)||""===Ar)&&(br.text=Ar),Ge.text=ot.texttemplateString(mr,br,Ne._fullLayout._d3locale,br,rt._meta||{})}else Ge.text=""}}function computeTransform(Ne,Ge){var Qe=Ne.rotate*Math.PI/180,tt=Math.cos(Qe),rt=Math.sin(Qe),nt=(Ge.left+Ge.right)/2,at=(Ge.top+Ge.bottom)/2;Ne.textX=nt*tt-at*rt,Ne.textY=nt*rt+at*tt,Ne.noCenter=!0}Ge.exports={plot:plot,formatSliceLabel:formatSliceLabel,transformInsideText:transformInsideText,determineInsideTextFont:determineInsideTextFont,positionTitleOutside:positionTitleOutside,prerenderTitles:prerenderTitles,layoutAreas:layoutAreas,attachFxHandlers:attachFxHandlers,computeTransform:computeTransform}},{"../../components/color":643,"../../components/drawing":665,"../../components/fx":683,"../../lib":778,"../../lib/svg_text_utils":803,"../../plots/plots":891,"../bar/constants":923,"../bar/uniform_text":937,"./event_data":1165,"./helpers":1166,d3:169}],1171:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("./style_one"),nt=Ne("../bar/uniform_text").resizeText;Ge.exports=function(Ne){var Ge=Ne._fullLayout._pielayer.selectAll(".trace");nt(Ne,Ge,"pie"),Ge.each((function(Ne){var Ge=Ne[0].trace,Qe=tt.select(this);Qe.style({opacity:Ge.opacity}),Qe.selectAll("path.surface").each((function(Ne){tt.select(this).call(rt,Ne,Ge)}))}))}},{"../bar/uniform_text":937,"./style_one":1172,d3:169}],1172:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/color"),rt=Ne("./helpers").castOption;Ge.exports=function(Ne,Ge,Qe){var nt=Qe.marker.line,at=rt(nt.color,Ge.pts)||tt.defaultLine,it=rt(nt.width,Ge.pts)||0;Ne.style("stroke-width",it).call(tt.fill,Ge.color).call(tt.stroke,at)}},{"../../components/color":643,"./helpers":1166}],1173:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../scatter/attributes");Ge.exports={x:tt.x,y:tt.y,xy:{valType:"data_array",editType:"calc"},indices:{valType:"data_array",editType:"calc"},xbounds:{valType:"data_array",editType:"calc"},ybounds:{valType:"data_array",editType:"calc"},text:tt.text,marker:{color:{valType:"color",arrayOk:!1,editType:"calc"},opacity:{valType:"number",min:0,max:1,dflt:1,arrayOk:!1,editType:"calc"},blend:{valType:"boolean",dflt:null,editType:"calc"},sizemin:{valType:"number",min:.1,max:2,dflt:.5,editType:"calc"},sizemax:{valType:"number",min:.1,dflt:20,editType:"calc"},border:{color:{valType:"color",arrayOk:!1,editType:"calc"},arearatio:{valType:"number",min:0,max:1,dflt:0,editType:"calc"},editType:"calc"},editType:"calc"},transforms:void 0}},{"../scatter/attributes":1187}],1174:[function(Ne,Ge,Qe){"use strict";var tt=Ne("gl-pointcloud2d"),rt=Ne("../../lib/str2rgbarray"),nt=Ne("../../plots/cartesian/autorange").findExtremes,at=Ne("../scatter/get_trace_color");function Pointcloud(Ne,Ge){this.scene=Ne,this.uid=Ge,this.type="pointcloud",this.pickXData=[],this.pickYData=[],this.xData=[],this.yData=[],this.textLabels=[],this.color="rgb(0, 0, 0)",this.name="",this.hoverinfo="all",this.idToIndex=new Int32Array(0),this.bounds=[0,0,0,0],this.pointcloudOptions={positions:new Float32Array(0),idToIndex:this.idToIndex,sizemin:.5,sizemax:12,color:[0,0,0,1],areaRatio:1,borderColor:[0,0,0,1]},this.pointcloud=tt(Ne.glplot,this.pointcloudOptions),this.pointcloud._trace=this}var it=Pointcloud.prototype;function createPointcloud(Ne,Ge){var Qe=new Pointcloud(Ne,Ge.uid);return Qe.update(Ge),Qe}it.handlePick=function(Ne){var Ge=this.idToIndex[Ne.pointId];return{trace:this,dataCoord:Ne.dataCoord,traceCoord:this.pickXYData?[this.pickXYData[2*Ge],this.pickXYData[2*Ge+1]]:[this.pickXData[Ge],this.pickYData[Ge]],textLabel:Array.isArray(this.textLabels)?this.textLabels[Ge]:this.textLabels,color:this.color,name:this.name,pointIndex:Ge,hoverinfo:this.hoverinfo}},it.update=function(Ne){this.index=Ne.index,this.textLabels=Ne.text,this.name=Ne.name,this.hoverinfo=Ne.hoverinfo,this.bounds=[1/0,1/0,-1/0,-1/0],this.updateFast(Ne),this.color=at(Ne,{})},it.updateFast=function(Ne){var Ge,Qe,tt,at,it,ot,dt=this.xData=this.pickXData=Ne.x,ht=this.yData=this.pickYData=Ne.y,Dt=this.pickXYData=Ne.xy,Ot=Ne.xbounds&&Ne.ybounds,Rt=Ne.indices,Zt=this.bounds;if(Dt){if(tt=Dt,Ge=Dt.length>>>1,Ot)Zt[0]=Ne.xbounds[0],Zt[2]=Ne.xbounds[1],Zt[1]=Ne.ybounds[0],Zt[3]=Ne.ybounds[1];else for(ot=0;ot<Ge;ot++)at=tt[2*ot],it=tt[2*ot+1],at<Zt[0]&&(Zt[0]=at),at>Zt[2]&&(Zt[2]=at),it<Zt[1]&&(Zt[1]=it),it>Zt[3]&&(Zt[3]=it);if(Rt)Qe=Rt;else for(Qe=new Int32Array(Ge),ot=0;ot<Ge;ot++)Qe[ot]=ot}else for(Ge=dt.length,tt=new Float32Array(2*Ge),Qe=new Int32Array(Ge),ot=0;ot<Ge;ot++)at=dt[ot],it=ht[ot],Qe[ot]=ot,tt[2*ot]=at,tt[2*ot+1]=it,at<Zt[0]&&(Zt[0]=at),at>Zt[2]&&(Zt[2]=at),it<Zt[1]&&(Zt[1]=it),it>Zt[3]&&(Zt[3]=it);this.idToIndex=Qe,this.pointcloudOptions.idToIndex=Qe,this.pointcloudOptions.positions=tt;var er=rt(Ne.marker.color),dr=rt(Ne.marker.border.color),mr=Ne.opacity*Ne.marker.opacity;er[3]*=mr,this.pointcloudOptions.color=er;var xr=Ne.marker.blend;if(null===xr){var br=100;xr=dt.length<br||ht.length<br}this.pointcloudOptions.blend=xr,dr[3]*=mr,this.pointcloudOptions.borderColor=dr;var Ar=Ne.marker.sizemin,en=Math.max(Ne.marker.sizemax,Ne.marker.sizemin);this.pointcloudOptions.sizeMin=Ar,this.pointcloudOptions.sizeMax=en,this.pointcloudOptions.areaRatio=Ne.marker.border.arearatio,this.pointcloud.update(this.pointcloudOptions);var mn=this.scene.xaxis,xn=this.scene.yaxis,kn=en/2||.5;Ne._extremes[mn._id]=nt(mn,[Zt[0],Zt[2]],{ppad:kn}),Ne._extremes[xn._id]=nt(xn,[Zt[1],Zt[3]],{ppad:kn})},it.dispose=function(){this.pointcloud.dispose()},Ge.exports=createPointcloud},{"../../lib/str2rgbarray":802,"../../plots/cartesian/autorange":827,"../scatter/get_trace_color":1197,"gl-pointcloud2d":324}],1175:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./attributes");Ge.exports=function(Ne,Ge,Qe){function coerce(Qe,nt){return tt.coerce(Ne,Ge,rt,Qe,nt)}coerce("x"),coerce("y"),coerce("xbounds"),coerce("ybounds"),Ne.xy&&Ne.xy instanceof Float32Array&&(Ge.xy=Ne.xy),Ne.indices&&Ne.indices instanceof Int32Array&&(Ge.indices=Ne.indices),coerce("text"),coerce("marker.color",Qe),coerce("marker.opacity"),coerce("marker.blend"),coerce("marker.sizemin"),coerce("marker.sizemax"),coerce("marker.border.color",Qe),coerce("marker.border.arearatio"),Ge._length=null}},{"../../lib":778,"./attributes":1173}],1176:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),calc:Ne("../scatter3d/calc"),plot:Ne("./convert"),moduleType:"trace",name:"pointcloud",basePlotModule:Ne("../../plots/gl2d"),categories:["gl","gl2d","showLegend"],meta:{}}},{"../../plots/gl2d":868,"../scatter3d/calc":1216,"./attributes":1173,"./convert":1174,"./defaults":1175}],1177:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/font_attributes"),rt=Ne("../../plots/attributes"),nt=Ne("../../components/color/attributes"),at=Ne("../../components/fx/attributes"),it=Ne("../../plots/domain").attributes,ot=Ne("../../plots/template_attributes").hovertemplateAttrs,dt=Ne("../../components/colorscale/attributes"),ht=Ne("../../plot_api/plot_template").templatedArray,Dt=Ne("../../lib/extend").extendFlat,Ot=Ne("../../plot_api/edit_types").overrideAll;Ne("../../constants/docs").FORMAT_LINK,(Ge.exports=Ot({hoverinfo:Dt({},rt.hoverinfo,{flags:[],arrayOk:!1}),hoverlabel:at.hoverlabel,domain:it({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h"},valueformat:{valType:"string",dflt:".3s"},valuesuffix:{valType:"string",dflt:""},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap"},textfont:tt({}),customdata:void 0,node:{label:{valType:"data_array",dflt:[]},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:!0,dflt:[],items:{valType:"number",editType:"calc"}},x:{valType:"data_array",dflt:[]},y:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:nt.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:.5,arrayOk:!0}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:at.hoverlabel,hovertemplate:ot({},{keys:["value","label"]})},link:{label:{valType:"data_array",dflt:[]},color:{valType:"color",arrayOk:!0},customdata:{valType:"data_array",editType:"calc"},line:{color:{valType:"color",dflt:nt.defaultLine,arrayOk:!0},width:{valType:"number",min:0,dflt:0,arrayOk:!0}},source:{valType:"data_array",dflt:[]},target:{valType:"data_array",dflt:[]},value:{valType:"data_array",dflt:[]},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all"},hoverlabel:at.hoverlabel,hovertemplate:ot({},{keys:["value","label"]}),colorscales:ht("concentrationscales",{editType:"calc",label:{valType:"string",editType:"calc",dflt:""},cmax:{valType:"number",editType:"calc",dflt:1},cmin:{valType:"number",editType:"calc",dflt:0},colorscale:Dt(dt().colorscale,{dflt:[[0,"white"],[1,"black"]]})})}},"calc","nested")).transforms=void 0},{"../../components/color/attributes":642,"../../components/colorscale/attributes":650,"../../components/fx/attributes":674,"../../constants/docs":748,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plot_api/plot_template":817,"../../plots/attributes":824,"../../plots/domain":855,"../../plots/font_attributes":856,"../../plots/template_attributes":906}],1178:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plot_api/edit_types").overrideAll,rt=Ne("../../plots/get_data").getModuleCalcData,nt=Ne("./plot"),at=Ne("../../components/fx/layout_attributes"),it=Ne("../../lib/setcursor"),ot=Ne("../../components/dragelement"),dt=Ne("../../plots/cartesian/select").prepSelect,ht=Ne("../../lib"),Dt=Ne("../../registry"),Ot="sankey";function subplotUpdateFx(Ne,Ge){var Qe=Ne._fullData[Ge],tt=Ne._fullLayout,rt=tt.dragmode,nt="pan"===tt.dragmode?"move":"crosshair",at=Qe._bgRect;if("pan"!==rt&&"zoom"!==rt){it(at,nt);var Ot={_id:"x",c2p:ht.identity,_offset:Qe._sankey.translateX,_length:Qe._sankey.width},Rt={_id:"y",c2p:ht.identity,_offset:Qe._sankey.translateY,_length:Qe._sankey.height},Zt={gd:Ne,element:at.node(),plotinfo:{id:Ge,xaxis:Ot,yaxis:Rt,fillRangeItems:ht.noop},subplot:Ge,xaxes:[Ot],yaxes:[Rt],doneFnCompleted:function(Qe){var tt,rt=Ne._fullData[Ge],nt=rt.node.groups.slice(),at=[];function findNode(Ne){for(var Ge=rt._sankey.graph.nodes,Qe=0;Qe<Ge.length;Qe++)if(Ge[Qe].pointNumber===Ne)return Ge[Qe]}for(var it=0;it<Qe.length;it++){var ot=findNode(Qe[it].pointNumber);if(ot)if(ot.group){for(var dt=0;dt<ot.childrenNodes.length;dt++)at.push(ot.childrenNodes[dt].pointNumber);nt[ot.pointNumber-rt.node._count]=!1}else at.push(ot.pointNumber)}tt=nt.filter(Boolean).concat([at]),Dt.call("_guiRestyle",Ne,{"node.groups":[tt]},Ge)},prepFn:function(Ne,Ge,Qe){dt(Ne,Ge,Qe,Zt,rt)}};ot.init(Zt)}}Qe.name=Ot,Qe.baseLayoutAttrOverrides=tt({hoverlabel:at.hoverlabel},"plot","nested"),Qe.plot=function(Ne){var Ge=rt(Ne.calcdata,Ot)[0];nt(Ne,Ge),Qe.updateFx(Ne)},Qe.clean=function(Ne,Ge,Qe,tt){var rt=tt._has&&tt._has(Ot),nt=Ge._has&&Ge._has(Ot);rt&&!nt&&(tt._paperdiv.selectAll(".sankey").remove(),tt._paperdiv.selectAll(".bgsankey").remove())},Qe.updateFx=function(Ne){for(var Ge=0;Ge<Ne._fullData.length;Ge++)subplotUpdateFx(Ne,Ge)}},{"../../components/dragelement":662,"../../components/fx/layout_attributes":684,"../../lib":778,"../../lib/setcursor":799,"../../plot_api/edit_types":810,"../../plots/cartesian/select":847,"../../plots/get_data":865,"../../registry":911,"./plot":1183}],1179:[function(Ne,Ge,Qe){"use strict";var tt=Ne("strongly-connected-components"),rt=Ne("../../lib"),nt=Ne("../../lib/gup").wrap,at=rt.isArrayOrTypedArray,it=rt.isIndex,ot=Ne("../../components/colorscale");function convertToD3Sankey(Ne){var Ge,Qe=Ne.node,tt=Ne.link,nt=[],dt=at(tt.color),ht=at(tt.customdata),Dt={},Ot={},Rt=tt.colorscales.length;for(Ge=0;Ge<Rt;Ge++){var Zt=tt.colorscales[Ge],er=ot.extractScale(Zt,{cLetter:"c"}),dr=ot.makeColorScaleFunc(er);Ot[Zt.label]=dr}var mr=0;for(Ge=0;Ge<tt.value.length;Ge++)tt.source[Ge]>mr&&(mr=tt.source[Ge]),tt.target[Ge]>mr&&(mr=tt.target[Ge]);var xr,br=mr+1;Ne.node._count=br;var Ar=Ne.node.groups,en={};for(Ge=0;Ge<Ar.length;Ge++){var mn=Ar[Ge];for(xr=0;xr<mn.length;xr++){var xn=mn[xr],kn=br+Ge;en.hasOwnProperty(xn)?rt.warn("Node "+xn+" is already part of a group."):en[xn]=kn}}var Cn={source:[],target:[]};for(Ge=0;Ge<tt.value.length;Ge++){var En=tt.value[Ge],Pn=tt.source[Ge],Dn=tt.target[Ge];if(En>0&&it(Pn,br)&&it(Dn,br)&&(!en.hasOwnProperty(Pn)||!en.hasOwnProperty(Dn)||en[Pn]!==en[Dn])){en.hasOwnProperty(Dn)&&(Dn=en[Dn]),en.hasOwnProperty(Pn)&&(Pn=en[Pn]),Dn=+Dn,Dt[Pn=+Pn]=Dt[Dn]=!0;var In="";tt.label&&tt.label[Ge]&&(In=tt.label[Ge]);var zn=null;In&&Ot.hasOwnProperty(In)&&(zn=Ot[In]),nt.push({pointNumber:Ge,label:In,color:dt?tt.color[Ge]:tt.color,customdata:ht?tt.customdata[Ge]:tt.customdata,concentrationscale:zn,source:Pn,target:Dn,value:+En}),Cn.source.push(Pn),Cn.target.push(Dn)}}var Bn=br+Ar.length,Vn=at(Qe.color),Hn=at(Qe.customdata),qn=[];for(Ge=0;Ge<Bn;Ge++)if(Dt[Ge]){var Yn=Qe.label[Ge];qn.push({group:Ge>br-1,childrenNodes:[],pointNumber:Ge,label:Yn,color:Vn?Qe.color[Ge]:Qe.color,customdata:Hn?Qe.customdata[Ge]:Qe.customdata})}var $n=!1;return circularityPresent(Bn,Cn.source,Cn.target)&&($n=!0),{circular:$n,links:nt,nodes:qn,groups:Ar,groupLookup:en}}function circularityPresent(Ne,Ge,Qe){for(var nt=rt.init2dArray(Ne,0),at=0;at<Math.min(Ge.length,Qe.length);at++)if(rt.isIndex(Ge[at],Ne)&&rt.isIndex(Qe[at],Ne)){if(Ge[at]===Qe[at])return!0;nt[Ge[at]].push(Qe[at])}return tt(nt).components.some((function(Ne){return Ne.length>1}))}Ge.exports=function(Ne,Ge){var Qe=convertToD3Sankey(Ge);return nt({circular:Qe.circular,_nodes:Qe.nodes,_links:Qe.links,_groups:Qe.groups,_groupLookup:Qe.groupLookup})}},{"../../components/colorscale":655,"../../lib":778,"../../lib/gup":775,"strongly-connected-components":569}],1180:[function(Ne,Ge,Qe){"use strict";Ge.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeCapture:"node-capture",nodeCentered:"node-entered",nodeLabelGuide:"node-label-guide",nodeLabel:"node-label",nodeLabelTextPath:"node-label-text-path"}}},{}],1181:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./attributes"),nt=Ne("../../components/color"),at=Ne("tinycolor2"),it=Ne("../../plots/domain").defaults,ot=Ne("../../components/fx/hoverlabel_defaults"),dt=Ne("../../plot_api/plot_template"),ht=Ne("../../plots/array_container_defaults");function concentrationscalesDefaults(Ne,Ge){function coerce(Qe,nt){return tt.coerce(Ne,Ge,rt.link.colorscales,Qe,nt)}coerce("label"),coerce("cmin"),coerce("cmax"),coerce("colorscale")}Ge.exports=function(Ne,Ge,Qe,Dt){function coerce(Qe,nt){return tt.coerce(Ne,Ge,rt,Qe,nt)}var Ot=tt.extendDeep(Dt.hoverlabel,Ne.hoverlabel),Rt=Ne.node,Zt=dt.newContainer(Ge,"node");function coerceNode(Ne,Ge){return tt.coerce(Rt,Zt,rt.node,Ne,Ge)}coerceNode("label"),coerceNode("groups"),coerceNode("x"),coerceNode("y"),coerceNode("pad"),coerceNode("thickness"),coerceNode("line.color"),coerceNode("line.width"),coerceNode("hoverinfo",Ne.hoverinfo),ot(Rt,Zt,coerceNode,Ot),coerceNode("hovertemplate");var er=Dt.colorway,defaultNodePalette=function(Ne){return er[Ne%er.length]};coerceNode("color",Zt.label.map((function(Ne,Ge){return nt.addOpacity(defaultNodePalette(Ge),.8)}))),coerceNode("customdata");var dr=Ne.link||{},mr=dt.newContainer(Ge,"link");function coerceLink(Ne,Ge){return tt.coerce(dr,mr,rt.link,Ne,Ge)}coerceLink("label"),coerceLink("source"),coerceLink("target"),coerceLink("value"),coerceLink("line.color"),coerceLink("line.width"),coerceLink("hoverinfo",Ne.hoverinfo),ot(dr,mr,coerceLink,Ot),coerceLink("hovertemplate");var xr,br=at(Dt.paper_bgcolor).getLuminance()<.333?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";coerceLink("color",tt.repeat(br,mr.value.length)),coerceLink("customdata"),ht(dr,mr,{name:"colorscales",handleItemDefaults:concentrationscalesDefaults}),it(Ge,Dt,coerce),coerce("orientation"),coerce("valueformat"),coerce("valuesuffix"),Zt.x.length&&Zt.y.length&&(xr="freeform"),coerce("arrangement",xr),tt.coerceFont(coerce,"textfont",tt.extendFlat({},Dt.font)),Ge._length=null}},{"../../components/color":643,"../../components/fx/hoverlabel_defaults":681,"../../lib":778,"../../plot_api/plot_template":817,"../../plots/array_container_defaults":823,"../../plots/domain":855,"./attributes":1177,tinycolor2:576}],1182:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),calc:Ne("./calc"),plot:Ne("./plot"),moduleType:"trace",name:"sankey",basePlotModule:Ne("./base_plot"),selectPoints:Ne("./select.js"),categories:["noOpacity"],meta:{}}},{"./attributes":1177,"./base_plot":1178,"./calc":1179,"./defaults":1181,"./plot":1183,"./select.js":1185}],1183:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("./render"),nt=Ne("../../components/fx"),at=Ne("../../components/color"),it=Ne("../../lib"),ot=Ne("./constants").cn,dt=it._;function renderableValuePresent(Ne){return""!==Ne}function ownTrace(Ne,Ge){return Ne.filter((function(Ne){return Ne.key===Ge.traceId}))}function makeTranslucent(Ne,Ge){tt.select(Ne).select("path").style("fill-opacity",Ge),tt.select(Ne).select("rect").style("fill-opacity",Ge)}function makeTextContrasty(Ne){tt.select(Ne).select("text.name").style("fill","black")}function relatedLinks(Ne){return function(Ge){return-1!==Ne.node.sourceLinks.indexOf(Ge.link)||-1!==Ne.node.targetLinks.indexOf(Ge.link)}}function relatedNodes(Ne){return function(Ge){return-1!==Ge.node.sourceLinks.indexOf(Ne.link)||-1!==Ge.node.targetLinks.indexOf(Ne.link)}}function nodeHoveredStyle(Ne,Ge,Qe){Ge&&Qe&&ownTrace(Qe,Ge).selectAll("."+ot.sankeyLink).filter(relatedLinks(Ge)).call(linkHoveredStyle.bind(0,Ge,Qe,!1))}function nodeNonHoveredStyle(Ne,Ge,Qe){Ge&&Qe&&ownTrace(Qe,Ge).selectAll("."+ot.sankeyLink).filter(relatedLinks(Ge)).call(linkNonHoveredStyle.bind(0,Ge,Qe,!1))}function linkHoveredStyle(Ne,Ge,Qe,tt){var rt=tt.datum().link.label;tt.style("fill-opacity",(function(Ne){if(!Ne.link.concentrationscale)return.4})),rt&&ownTrace(Ge,Ne).selectAll("."+ot.sankeyLink).filter((function(Ne){return Ne.link.label===rt})).style("fill-opacity",(function(Ne){if(!Ne.link.concentrationscale)return.4})),Qe&&ownTrace(Ge,Ne).selectAll("."+ot.sankeyNode).filter(relatedNodes(Ne)).call(nodeHoveredStyle)}function linkNonHoveredStyle(Ne,Ge,Qe,tt){var rt=tt.datum().link.label;tt.style("fill-opacity",(function(Ne){return Ne.tinyColorAlpha})),rt&&ownTrace(Ge,Ne).selectAll("."+ot.sankeyLink).filter((function(Ne){return Ne.link.label===rt})).style("fill-opacity",(function(Ne){return Ne.tinyColorAlpha})),Qe&&ownTrace(Ge,Ne).selectAll(ot.sankeyNode).filter(relatedNodes(Ne)).call(nodeNonHoveredStyle)}function castHoverOption(Ne,Ge){var Qe=Ne.hoverlabel||{},tt=it.nestedProperty(Qe,Ge).get();return!Array.isArray(tt)&&tt}Ge.exports=function(Ne,Ge){for(var Qe=Ne._fullLayout,it=Qe._paper,ht=Qe._size,Dt=0;Dt<Ne._fullData.length;Dt++)if(Ne._fullData[Dt].visible&&Ne._fullData[Dt].type===ot.sankey&&!Ne._fullData[Dt]._viewInitial){var Ot=Ne._fullData[Dt].node;Ne._fullData[Dt]._viewInitial={node:{groups:Ot.groups.slice(),x:Ot.x.slice(),y:Ot.y.slice()}}}var linkSelect=function(Ge,Qe){var rt=Qe.link;rt.originalEvent=tt.event,Ne._hoverdata=[rt],nt.click(Ne,{target:!0})},linkHover=function(Ge,Qe,rt){!1!==Ne._fullLayout.hovermode&&(tt.select(Ge).call(linkHoveredStyle.bind(0,Qe,rt,!0)),"skip"!==Qe.link.trace.link.hoverinfo&&(Qe.link.fullData=Qe.link.trace,Ne.emit("plotly_hover",{event:tt.event,points:[Qe.link]})))},Rt=dt(Ne,"source:")+" ",Zt=dt(Ne,"target:")+" ",er=dt(Ne,"concentration:")+" ",dr=dt(Ne,"incoming flow count:")+" ",mr=dt(Ne,"outgoing flow count:")+" ",linkHoverFollow=function(Ge,rt){if(!1!==Ne._fullLayout.hovermode){var it=rt.link.trace.link;if("none"!==it.hoverinfo&&"skip"!==it.hoverinfo){for(var ot=[],dt=0,ht=0;ht<rt.flow.links.length;ht++){var Dt=rt.flow.links[ht];if("closest"!==Ne._fullLayout.hovermode||rt.link.pointNumber===Dt.pointNumber){rt.link.pointNumber===Dt.pointNumber&&(dt=ht),Dt.fullData=Dt.trace,it=rt.link.trace.link;var Ot=hoverCenterPosition(Dt),dr={valueLabel:tt.format(rt.valueFormat)(Dt.value)+rt.valueSuffix};ot.push({x:Ot[0],y:Ot[1],name:dr.valueLabel,text:[Dt.label||"",Rt+Dt.source.label,Zt+Dt.target.label,Dt.concentrationscale?er+tt.format("%0.2f")(Dt.flow.labelConcentration):""].filter(renderableValuePresent).join("<br>"),color:castHoverOption(it,"bgcolor")||at.addOpacity(Dt.color,1),borderColor:castHoverOption(it,"bordercolor"),fontFamily:castHoverOption(it,"font.family"),fontSize:castHoverOption(it,"font.size"),fontColor:castHoverOption(it,"font.color"),nameLength:castHoverOption(it,"namelength"),textAlign:castHoverOption(it,"align"),idealAlign:tt.event.x<Ot[0]?"right":"left",hovertemplate:it.hovertemplate,hovertemplateLabels:dr,eventData:[Dt]})}}nt.loneHover(ot,{container:Qe._hoverlayer.node(),outerContainer:Qe._paper.node(),gd:Ne,anchorIndex:dt}).each((function(){var Ne=this;rt.link.concentrationscale||makeTranslucent(Ne,.65),makeTextContrasty(Ne)}))}}function hoverCenterPosition(Ne){var Ge,Qe;Ne.circular?(Ge=(Ne.circularPathData.leftInnerExtent+Ne.circularPathData.rightInnerExtent)/2,Qe=Ne.circularPathData.verticalFullExtent):(Ge=(Ne.source.x1+Ne.target.x0)/2,Qe=(Ne.y0+Ne.y1)/2);var tt=[Ge,Qe];return"v"===Ne.trace.orientation&&tt.reverse(),tt[0]+=rt.parent.translateX,tt[1]+=rt.parent.translateY,tt}},linkUnhover=function(Ge,rt,at){!1!==Ne._fullLayout.hovermode&&(tt.select(Ge).call(linkNonHoveredStyle.bind(0,rt,at,!0)),"skip"!==rt.link.trace.link.hoverinfo&&(rt.link.fullData=rt.link.trace,Ne.emit("plotly_unhover",{event:tt.event,points:[rt.link]})),nt.loneUnhover(Qe._hoverlayer.node()))},nodeSelect=function(Ge,Qe,rt){var at=Qe.node;at.originalEvent=tt.event,Ne._hoverdata=[at],tt.select(Ge).call(nodeNonHoveredStyle,Qe,rt),nt.click(Ne,{target:!0})},nodeHover=function(Ge,Qe,rt){!1!==Ne._fullLayout.hovermode&&(tt.select(Ge).call(nodeHoveredStyle,Qe,rt),"skip"!==Qe.node.trace.node.hoverinfo&&(Qe.node.fullData=Qe.node.trace,Ne.emit("plotly_hover",{event:tt.event,points:[Qe.node]})))},nodeHoverFollow=function(Ge,rt){if(!1!==Ne._fullLayout.hovermode){var at=rt.node.trace.node;if("none"!==at.hoverinfo&&"skip"!==at.hoverinfo){var it=tt.select(Ge).select("."+ot.nodeRect),dt=Ne._fullLayout._paperdiv.node().getBoundingClientRect(),ht=it.node().getBoundingClientRect(),Dt=ht.left-2-dt.left,Ot=ht.right+2-dt.left,Rt=ht.top+ht.height/4-dt.top,Zt={valueLabel:tt.format(rt.valueFormat)(rt.node.value)+rt.valueSuffix};rt.node.fullData=rt.node.trace,Ne._fullLayout._calcInverseTransform(Ne);var er=Ne._fullLayout._invScaleX,xr=Ne._fullLayout._invScaleY,br=nt.loneHover({x0:er*Dt,x1:er*Ot,y:xr*Rt,name:tt.format(rt.valueFormat)(rt.node.value)+rt.valueSuffix,text:[rt.node.label,dr+rt.node.targetLinks.length,mr+rt.node.sourceLinks.length].filter(renderableValuePresent).join("<br>"),color:castHoverOption(at,"bgcolor")||rt.tinyColorHue,borderColor:castHoverOption(at,"bordercolor"),fontFamily:castHoverOption(at,"font.family"),fontSize:castHoverOption(at,"font.size"),fontColor:castHoverOption(at,"font.color"),nameLength:castHoverOption(at,"namelength"),textAlign:castHoverOption(at,"align"),idealAlign:"left",hovertemplate:at.hovertemplate,hovertemplateLabels:Zt,eventData:[rt.node]},{container:Qe._hoverlayer.node(),outerContainer:Qe._paper.node(),gd:Ne});makeTranslucent(br,.85),makeTextContrasty(br)}}},nodeUnhover=function(Ge,rt,at){!1!==Ne._fullLayout.hovermode&&(tt.select(Ge).call(nodeNonHoveredStyle,rt,at),"skip"!==rt.node.trace.node.hoverinfo&&(rt.node.fullData=rt.node.trace,Ne.emit("plotly_unhover",{event:tt.event,points:[rt.node]})),nt.loneUnhover(Qe._hoverlayer.node()))};rt(Ne,it,Ge,{width:ht.w,height:ht.h,margin:{t:ht.t,r:ht.r,b:ht.b,l:ht.l}},{linkEvents:{hover:linkHover,follow:linkHoverFollow,unhover:linkUnhover,select:linkSelect},nodeEvents:{hover:nodeHover,follow:nodeHoverFollow,unhover:nodeUnhover,select:nodeSelect}})}},{"../../components/color":643,"../../components/fx":683,"../../lib":778,"./constants":1180,"./render":1184,d3:169}],1184:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./constants"),rt=Ne("d3"),nt=Ne("tinycolor2"),at=Ne("../../components/color"),it=Ne("../../components/drawing"),ot=Ne("@plotly/d3-sankey"),dt=Ne("@plotly/d3-sankey-circular"),ht=Ne("d3-force"),Dt=Ne("../../lib"),Ot=Dt.strTranslate,Rt=Ne("../../lib/gup"),Zt=Rt.keyFun,er=Rt.repeat,dr=Rt.unwrap,mr=Ne("d3-interpolate").interpolateNumber,xr=Ne("../../registry");function sankeyModel(Ne,Ge,Qe){var rt,at=dr(Ge),it=at.trace,ht=it.domain,Ot="h"===it.orientation,Rt=it.node.pad,Zt=it.node.thickness,er=Ne.width*(ht.x[1]-ht.x[0]),mr=Ne.height*(ht.y[1]-ht.y[0]),xr=at._nodes,br=at._links,Ar=at.circular;(rt=Ar?dt.sankeyCircular().circularLinkGap(0):ot.sankey()).iterations(tt.sankeyIterations).size(Ot?[er,mr]:[mr,er]).nodeWidth(Zt).nodePadding(Rt).nodeId((function(Ne){return Ne.pointNumber})).nodes(xr).links(br);var en,mn,xn,kn=rt();for(var Cn in rt.nodePadding()<Rt&&Dt.warn("node.pad was reduced to ",rt.nodePadding()," to fit within the figure."),at._groupLookup){var En,Pn=parseInt(at._groupLookup[Cn]);for(en=0;en<kn.nodes.length;en++)if(kn.nodes[en].pointNumber===Pn){En=kn.nodes[en];break}if(En){var Dn={pointNumber:parseInt(Cn),x0:En.x0,x1:En.x1,y0:En.y0,y1:En.y1,partOfGroup:!0,sourceLinks:[],targetLinks:[]};kn.nodes.unshift(Dn),En.childrenNodes.unshift(Dn)}}function computeLinkConcentrations(){for(en=0;en<kn.nodes.length;en++){var Ne,Ge,Qe=kn.nodes[en],tt={};for(mn=0;mn<Qe.targetLinks.length;mn++)Ne=(Ge=Qe.targetLinks[mn]).source.pointNumber+":"+Ge.target.pointNumber,tt.hasOwnProperty(Ne)||(tt[Ne]=[]),tt[Ne].push(Ge);var rt=Object.keys(tt);for(mn=0;mn<rt.length;mn++){var at=tt[Ne=rt[mn]],it=0,ot={};for(xn=0;xn<at.length;xn++)ot[(Ge=at[xn]).label]||(ot[Ge.label]=0),ot[Ge.label]+=Ge.value,it+=Ge.value;for(xn=0;xn<at.length;xn++)(Ge=at[xn]).flow={value:it,labelConcentration:ot[Ge.label]/it,concentration:Ge.value/it,links:at},Ge.concentrationscale&&(Ge.color=nt(Ge.concentrationscale(Ge.flow.labelConcentration)))}var dt=0;for(mn=0;mn<Qe.sourceLinks.length;mn++)dt+=Qe.sourceLinks[mn].value;for(mn=0;mn<Qe.sourceLinks.length;mn++)(Ge=Qe.sourceLinks[mn]).concentrationOut=Ge.value/dt;var ht=0;for(mn=0;mn<Qe.targetLinks.length;mn++)ht+=Qe.targetLinks[mn].value;for(mn=0;mn<Qe.targetLinks.length;mn++)(Ge=Qe.targetLinks[mn]).concenrationIn=Ge.value/ht}}function resolveCollisionsTopToBottom(Ne){Ne.forEach((function(Ne){var Ge,Qe,tt,rt=0,nt=Ne.length;for(Ne.sort((function(Ne,Ge){return Ne.y0-Ge.y0})),tt=0;tt<nt;++tt)(Ge=Ne[tt]).y0>=rt||(Qe=rt-Ge.y0)>1e-6&&(Ge.y0+=Qe,Ge.y1+=Qe),rt=Ge.y1+Rt}))}function snapToColumns(Ne){var Ge,Qe,tt=Ne.map((function(Ne,Ge){return{x0:Ne.x0,index:Ge}})).sort((function(Ne,Ge){return Ne.x0-Ge.x0})),rt=[],nt=-1,at=-1/0;for(en=0;en<tt.length;en++){var it=Ne[tt[en].index];it.x0>at+Zt&&(nt+=1,Ge=it.x0),at=it.x0,rt[nt]||(rt[nt]=[]),rt[nt].push(it),Qe=Ge-it.x0,it.x0+=Qe,it.x1+=Qe}return rt}if(computeLinkConcentrations(),it.node.x.length&&it.node.y.length){for(en=0;en<Math.min(it.node.x.length,it.node.y.length,kn.nodes.length);en++)if(it.node.x[en]&&it.node.y[en]){var In=[it.node.x[en]*er,it.node.y[en]*mr];kn.nodes[en].x0=In[0]-Zt/2,kn.nodes[en].x1=In[0]+Zt/2;var zn=kn.nodes[en].y1-kn.nodes[en].y0;kn.nodes[en].y0=In[1]-zn/2,kn.nodes[en].y1=In[1]+zn/2}"snap"===it.arrangement&&resolveCollisionsTopToBottom(snapToColumns(xr=kn.nodes)),rt.update(kn)}return{circular:Ar,key:Qe,trace:it,guid:Dt.randstr(),horizontal:Ot,width:er,height:mr,nodePad:it.node.pad,nodeLineColor:it.node.line.color,nodeLineWidth:it.node.line.width,linkLineColor:it.link.line.color,linkLineWidth:it.link.line.width,valueFormat:it.valueformat,valueSuffix:it.valuesuffix,textFont:it.textfont,translateX:ht.x[0]*Ne.width+Ne.margin.l,translateY:Ne.height-ht.y[1]*Ne.height+Ne.margin.t,dragParallel:Ot?mr:er,dragPerpendicular:Ot?er:mr,arrangement:it.arrangement,sankey:rt,graph:kn,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}function linkModel(Ne,Ge,Qe){var tt=nt(Ge.color),rt=Ge.source.label+"|"+Ge.target.label+"__"+Qe;return Ge.trace=Ne.trace,Ge.curveNumber=Ne.trace.index,{circular:Ne.circular,key:rt,traceId:Ne.key,pointNumber:Ge.pointNumber,link:Ge,tinyColorHue:at.tinyRGB(tt),tinyColorAlpha:tt.getAlpha(),linkPath:linkPath,linkLineColor:Ne.linkLineColor,linkLineWidth:Ne.linkLineWidth,valueFormat:Ne.valueFormat,valueSuffix:Ne.valueSuffix,sankey:Ne.sankey,parent:Ne,interactionState:Ne.interactionState,flow:Ge.flow}}function createCircularClosedPathString(Ne){var Ge=Ne.width/2,Qe=Ne.circularPathData;return"top"===Ne.circularLinkType?"M "+Qe.targetX+" "+(Qe.targetY+Ge)+" L"+Qe.rightInnerExtent+" "+(Qe.targetY+Ge)+"A"+(Qe.rightLargeArcRadius+Ge)+" "+(Qe.rightSmallArcRadius+Ge)+" 0 0 1 "+(Qe.rightFullExtent-Ge)+" "+(Qe.targetY-Qe.rightSmallArcRadius)+"L"+(Qe.rightFullExtent-Ge)+" "+Qe.verticalRightInnerExtent+"A"+(Qe.rightLargeArcRadius+Ge)+" "+(Qe.rightLargeArcRadius+Ge)+" 0 0 1 "+Qe.rightInnerExtent+" "+(Qe.verticalFullExtent-Ge)+"L"+Qe.leftInnerExtent+" "+(Qe.verticalFullExtent-Ge)+"A"+(Qe.leftLargeArcRadius+Ge)+" "+(Qe.leftLargeArcRadius+Ge)+" 0 0 1 "+(Qe.leftFullExtent+Ge)+" "+Qe.verticalLeftInnerExtent+"L"+(Qe.leftFullExtent+Ge)+" "+(Qe.sourceY-Qe.leftSmallArcRadius)+"A"+(Qe.leftLargeArcRadius+Ge)+" "+(Qe.leftSmallArcRadius+Ge)+" 0 0 1 "+Qe.leftInnerExtent+" "+(Qe.sourceY+Ge)+"L"+Qe.sourceX+" "+(Qe.sourceY+Ge)+"L"+Qe.sourceX+" "+(Qe.sourceY-Ge)+"L"+Qe.leftInnerExtent+" "+(Qe.sourceY-Ge)+"A"+(Qe.leftLargeArcRadius-Ge)+" "+(Qe.leftSmallArcRadius-Ge)+" 0 0 0 "+(Qe.leftFullExtent-Ge)+" "+(Qe.sourceY-Qe.leftSmallArcRadius)+"L"+(Qe.leftFullExtent-Ge)+" "+Qe.verticalLeftInnerExtent+"A"+(Qe.leftLargeArcRadius-Ge)+" "+(Qe.leftLargeArcRadius-Ge)+" 0 0 0 "+Qe.leftInnerExtent+" "+(Qe.verticalFullExtent+Ge)+"L"+Qe.rightInnerExtent+" "+(Qe.verticalFullExtent+Ge)+"A"+(Qe.rightLargeArcRadius-Ge)+" "+(Qe.rightLargeArcRadius-Ge)+" 0 0 0 "+(Qe.rightFullExtent+Ge)+" "+Qe.verticalRightInnerExtent+"L"+(Qe.rightFullExtent+Ge)+" "+(Qe.targetY-Qe.rightSmallArcRadius)+"A"+(Qe.rightLargeArcRadius-Ge)+" "+(Qe.rightSmallArcRadius-Ge)+" 0 0 0 "+Qe.rightInnerExtent+" "+(Qe.targetY-Ge)+"L"+Qe.targetX+" "+(Qe.targetY-Ge)+"Z":"M "+Qe.targetX+" "+(Qe.targetY-Ge)+" L"+Qe.rightInnerExtent+" "+(Qe.targetY-Ge)+"A"+(Qe.rightLargeArcRadius+Ge)+" "+(Qe.rightSmallArcRadius+Ge)+" 0 0 0 "+(Qe.rightFullExtent-Ge)+" "+(Qe.targetY+Qe.rightSmallArcRadius)+"L"+(Qe.rightFullExtent-Ge)+" "+Qe.verticalRightInnerExtent+"A"+(Qe.rightLargeArcRadius+Ge)+" "+(Qe.rightLargeArcRadius+Ge)+" 0 0 0 "+Qe.rightInnerExtent+" "+(Qe.verticalFullExtent+Ge)+"L"+Qe.leftInnerExtent+" "+(Qe.verticalFullExtent+Ge)+"A"+(Qe.leftLargeArcRadius+Ge)+" "+(Qe.leftLargeArcRadius+Ge)+" 0 0 0 "+(Qe.leftFullExtent+Ge)+" "+Qe.verticalLeftInnerExtent+"L"+(Qe.leftFullExtent+Ge)+" "+(Qe.sourceY+Qe.leftSmallArcRadius)+"A"+(Qe.leftLargeArcRadius+Ge)+" "+(Qe.leftSmallArcRadius+Ge)+" 0 0 0 "+Qe.leftInnerExtent+" "+(Qe.sourceY-Ge)+"L"+Qe.sourceX+" "+(Qe.sourceY-Ge)+"L"+Qe.sourceX+" "+(Qe.sourceY+Ge)+"L"+Qe.leftInnerExtent+" "+(Qe.sourceY+Ge)+"A"+(Qe.leftLargeArcRadius-Ge)+" "+(Qe.leftSmallArcRadius-Ge)+" 0 0 1 "+(Qe.leftFullExtent-Ge)+" "+(Qe.sourceY+Qe.leftSmallArcRadius)+"L"+(Qe.leftFullExtent-Ge)+" "+Qe.verticalLeftInnerExtent+"A"+(Qe.leftLargeArcRadius-Ge)+" "+(Qe.leftLargeArcRadius-Ge)+" 0 0 1 "+Qe.leftInnerExtent+" "+(Qe.verticalFullExtent-Ge)+"L"+Qe.rightInnerExtent+" "+(Qe.verticalFullExtent-Ge)+"A"+(Qe.rightLargeArcRadius-Ge)+" "+(Qe.rightLargeArcRadius-Ge)+" 0 0 1 "+(Qe.rightFullExtent+Ge)+" "+Qe.verticalRightInnerExtent+"L"+(Qe.rightFullExtent+Ge)+" "+(Qe.targetY+Qe.rightSmallArcRadius)+"A"+(Qe.rightLargeArcRadius-Ge)+" "+(Qe.rightSmallArcRadius-Ge)+" 0 0 1 "+Qe.rightInnerExtent+" "+(Qe.targetY+Ge)+"L"+Qe.targetX+" "+(Qe.targetY+Ge)+"Z"}function linkPath(){var Ne=.5;function path(Ge){if(Ge.link.circular)return createCircularClosedPathString(Ge.link);var Qe=Ge.link.source.x1,tt=Ge.link.target.x0,rt=mr(Qe,tt),nt=rt(Ne),at=rt(1-Ne),it=Ge.link.y0-Ge.link.width/2,ot=Ge.link.y0+Ge.link.width/2,dt=Ge.link.y1-Ge.link.width/2,ht=Ge.link.y1+Ge.link.width/2;return"M"+Qe+","+it+"C"+nt+","+it+" "+at+","+dt+" "+tt+","+dt+"L"+tt+","+ht+"C"+at+","+ht+" "+nt+","+ot+" "+Qe+","+ot+"Z"}return path}function nodeModel(Ne,Ge){var Qe=nt(Ge.color),rt=tt.nodePadAcross,it=Ne.nodePad/2;Ge.dx=Ge.x1-Ge.x0,Ge.dy=Ge.y1-Ge.y0;var ot=Ge.dx,dt=Math.max(.5,Ge.dy),ht="node_"+Ge.pointNumber;return Ge.group&&(ht=Dt.randstr()),Ge.trace=Ne.trace,Ge.curveNumber=Ne.trace.index,{index:Ge.pointNumber,key:ht,partOfGroup:Ge.partOfGroup||!1,group:Ge.group,traceId:Ne.key,trace:Ne.trace,node:Ge,nodePad:Ne.nodePad,nodeLineColor:Ne.nodeLineColor,nodeLineWidth:Ne.nodeLineWidth,textFont:Ne.textFont,size:Ne.horizontal?Ne.height:Ne.width,visibleWidth:Math.ceil(ot),visibleHeight:dt,zoneX:-rt,zoneY:-it,zoneWidth:ot+2*rt,zoneHeight:dt+2*it,labelY:Ne.horizontal?Ge.dy/2+1:Ge.dx/2+1,left:1===Ge.originalLayer,sizeAcross:Ne.width,forceLayouts:Ne.forceLayouts,horizontal:Ne.horizontal,darkBackground:Qe.getBrightness()<=128,tinyColorHue:at.tinyRGB(Qe),tinyColorAlpha:Qe.getAlpha(),valueFormat:Ne.valueFormat,valueSuffix:Ne.valueSuffix,sankey:Ne.sankey,graph:Ne.graph,arrangement:Ne.arrangement,uniqueNodeLabelPathId:[Ne.guid,Ne.key,ht].join("_"),interactionState:Ne.interactionState,figure:Ne}}function updateNodePositions(Ne){Ne.attr("transform",(function(Ne){return Ot(Ne.node.x0.toFixed(3),Ne.node.y0.toFixed(3))}))}function updateNodeShapes(Ne){Ne.call(updateNodePositions)}function updateShapes(Ne,Ge){Ne.call(updateNodeShapes),Ge.attr("d",linkPath())}function sizeNode(Ne){Ne.attr("width",(function(Ne){return Ne.node.x1-Ne.node.x0})).attr("height",(function(Ne){return Ne.visibleHeight}))}function salientEnough(Ne){return Ne.link.width>1||Ne.linkLineWidth>0}function sankeyTransform(Ne){return Ot(Ne.translateX,Ne.translateY)+(Ne.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function nodeCentering(Ne){return Ot(Ne.horizontal?0:Ne.labelY,Ne.horizontal?Ne.labelY:0)}function textGuidePath(Ne){return rt.svg.line()([[Ne.horizontal?Ne.left?-Ne.sizeAcross:Ne.visibleWidth+tt.nodeTextOffsetHorizontal:tt.nodeTextOffsetHorizontal,0],[Ne.horizontal?Ne.left?-tt.nodeTextOffsetHorizontal:Ne.sizeAcross:Ne.visibleHeight-tt.nodeTextOffsetHorizontal,0]])}function sankeyInverseTransform(Ne){return Ne.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)"}function textFlip(Ne){return Ne.horizontal?"scale(1 1)":"scale(-1 1)"}function nodeTextColor(Ne){return Ne.darkBackground&&!Ne.horizontal?"rgb(255,255,255)":"rgb(0,0,0)"}function nodeTextOffset(Ne){return Ne.horizontal&&Ne.left?"100%":"0%"}function attachPointerEvents(Ne,Ge,Qe){Ne.on(".basic",null).on("mouseover.basic",(function(Ne){Ne.interactionState.dragInProgress||Ne.partOfGroup||(Qe.hover(this,Ne,Ge),Ne.interactionState.hovered=[this,Ne])})).on("mousemove.basic",(function(Ne){Ne.interactionState.dragInProgress||Ne.partOfGroup||(Qe.follow(this,Ne),Ne.interactionState.hovered=[this,Ne])})).on("mouseout.basic",(function(Ne){Ne.interactionState.dragInProgress||Ne.partOfGroup||(Qe.unhover(this,Ne,Ge),Ne.interactionState.hovered=!1)})).on("click.basic",(function(Ne){Ne.interactionState.hovered&&(Qe.unhover(this,Ne,Ge),Ne.interactionState.hovered=!1),Ne.interactionState.dragInProgress||Ne.partOfGroup||Qe.select(this,Ne,Ge)}))}function attachDragHandler(Ne,Ge,Qe,tt){var nt=rt.behavior.drag().origin((function(Ne){return{x:Ne.node.x0+Ne.visibleWidth/2,y:Ne.node.y0+Ne.visibleHeight/2}})).on("dragstart",(function(rt){if("fixed"!==rt.arrangement&&(Dt.ensureSingle(tt._fullLayout._infolayer,"g","dragcover",(function(Ne){tt._fullLayout._dragCover=Ne})),Dt.raiseToTop(this),rt.interactionState.dragInProgress=rt.node,saveCurrentDragPosition(rt.node),rt.interactionState.hovered&&(Qe.nodeEvents.unhover.apply(0,rt.interactionState.hovered),rt.interactionState.hovered=!1),"snap"===rt.arrangement)){var nt=rt.traceId+"|"+rt.key;rt.forceLayouts[nt]?rt.forceLayouts[nt].alpha(1):attachForce(Ne,nt,rt,tt),startForce(Ne,Ge,rt,nt,tt)}})).on("drag",(function(Qe){if("fixed"!==Qe.arrangement){var tt=rt.event.x,nt=rt.event.y;"snap"===Qe.arrangement?(Qe.node.x0=tt-Qe.visibleWidth/2,Qe.node.x1=tt+Qe.visibleWidth/2,Qe.node.y0=nt-Qe.visibleHeight/2,Qe.node.y1=nt+Qe.visibleHeight/2):("freeform"===Qe.arrangement&&(Qe.node.x0=tt-Qe.visibleWidth/2,Qe.node.x1=tt+Qe.visibleWidth/2),nt=Math.max(0,Math.min(Qe.size-Qe.visibleHeight/2,nt)),Qe.node.y0=nt-Qe.visibleHeight/2,Qe.node.y1=nt+Qe.visibleHeight/2),saveCurrentDragPosition(Qe.node),"snap"!==Qe.arrangement&&(Qe.sankey.update(Qe.graph),updateShapes(Ne.filter(sameLayer(Qe)),Ge))}})).on("dragend",(function(Ne){if("fixed"!==Ne.arrangement){Ne.interactionState.dragInProgress=!1;for(var Ge=0;Ge<Ne.node.childrenNodes.length;Ge++)Ne.node.childrenNodes[Ge].x=Ne.node.x,Ne.node.childrenNodes[Ge].y=Ne.node.y;"snap"!==Ne.arrangement&&persistFinalNodePositions(Ne,tt)}}));Ne.on(".drag",null).call(nt)}function attachForce(Ne,Ge,Qe,rt){switchToForceFormat(Qe.graph.nodes);var nt=Qe.graph.nodes.filter((function(Ne){return Ne.originalX===Qe.node.originalX})).filter((function(Ne){return!Ne.partOfGroup}));Qe.forceLayouts[Ge]=ht.forceSimulation(nt).alphaDecay(0).force("collide",ht.forceCollide().radius((function(Ne){return Ne.dy/2+Qe.nodePad/2})).strength(1).iterations(tt.forceIterations)).force("constrain",snappingForce(Ne,Ge,nt,Qe,rt)).stop()}function startForce(Ne,Ge,Qe,rt,nt){window.requestAnimationFrame((function faster(){var at;for(at=0;at<tt.forceTicksPerFrame;at++)Qe.forceLayouts[rt].tick();if(switchToSankeyFormat(Qe.graph.nodes),Qe.sankey.update(Qe.graph),updateShapes(Ne.filter(sameLayer(Qe)),Ge),Qe.forceLayouts[rt].alpha()>0)window.requestAnimationFrame(faster);else{var it=Qe.node.originalX;Qe.node.x0=it-Qe.visibleWidth/2,Qe.node.x1=it+Qe.visibleWidth/2,persistFinalNodePositions(Qe,nt)}}))}function snappingForce(Ne,Ge,Qe,rt){return function(){for(var Ne=0,nt=0;nt<Qe.length;nt++){var at=Qe[nt];at===rt.interactionState.dragInProgress?(at.x=at.lastDraggedX,at.y=at.lastDraggedY):(at.vx=(at.originalX-at.x)/tt.forceTicksPerFrame,at.y=Math.min(rt.size-at.dy/2,Math.max(at.dy/2,at.y))),Ne=Math.max(Ne,Math.abs(at.vx),Math.abs(at.vy))}!rt.interactionState.dragInProgress&&Ne<.1&&rt.forceLayouts[Ge].alpha()>0&&rt.forceLayouts[Ge].alpha(0)}}function persistFinalNodePositions(Ne,Ge){for(var Qe=[],tt=[],rt=0;rt<Ne.graph.nodes.length;rt++){var nt=(Ne.graph.nodes[rt].x0+Ne.graph.nodes[rt].x1)/2,at=(Ne.graph.nodes[rt].y0+Ne.graph.nodes[rt].y1)/2;Qe.push(nt/Ne.figure.width),tt.push(at/Ne.figure.height)}xr.call("_guiRestyle",Ge,{"node.x":[Qe],"node.y":[tt]},Ne.trace.index).then((function(){Ge._fullLayout._dragCover&&Ge._fullLayout._dragCover.remove()}))}function persistOriginalPlace(Ne){var Ge,Qe=[];for(Ge=0;Ge<Ne.length;Ge++)Ne[Ge].originalX=(Ne[Ge].x0+Ne[Ge].x1)/2,Ne[Ge].originalY=(Ne[Ge].y0+Ne[Ge].y1)/2,-1===Qe.indexOf(Ne[Ge].originalX)&&Qe.push(Ne[Ge].originalX);for(Qe.sort((function(Ne,Ge){return Ne-Ge})),Ge=0;Ge<Ne.length;Ge++)Ne[Ge].originalLayerIndex=Qe.indexOf(Ne[Ge].originalX),Ne[Ge].originalLayer=Ne[Ge].originalLayerIndex/(Qe.length-1)}function saveCurrentDragPosition(Ne){Ne.lastDraggedX=Ne.x0+Ne.dx/2,Ne.lastDraggedY=Ne.y0+Ne.dy/2}function sameLayer(Ne){return function(Ge){return Ge.node.originalX===Ne.node.originalX}}function switchToForceFormat(Ne){for(var Ge=0;Ge<Ne.length;Ge++)Ne[Ge].y=(Ne[Ge].y0+Ne[Ge].y1)/2,Ne[Ge].x=(Ne[Ge].x0+Ne[Ge].x1)/2}function switchToSankeyFormat(Ne){for(var Ge=0;Ge<Ne.length;Ge++)Ne[Ge].y0=Ne[Ge].y-Ne[Ge].dy/2,Ne[Ge].y1=Ne[Ge].y0+Ne[Ge].dy,Ne[Ge].x0=Ne[Ge].x-Ne[Ge].dx/2,Ne[Ge].x1=Ne[Ge].x0+Ne[Ge].dx}Ge.exports=function(Ne,Ge,Qe,ot,dt){var ht=!1;Dt.ensureSingle(Ne._fullLayout._infolayer,"g","first-render",(function(){ht=!0}));var Ot=Ne._fullLayout._dragCover,Rt=Qe.filter((function(Ne){return dr(Ne).trace.visible})).map(sankeyModel.bind(null,ot)),mr=Ge.selectAll("."+tt.cn.sankey).data(Rt,Zt);mr.exit().remove(),mr.enter().append("g").classed(tt.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events","auto").attr("transform",sankeyTransform),mr.each((function(Ge,Qe){Ne._fullData[Qe]._sankey=Ge;var tt="bgsankey-"+Ge.trace.uid+"-"+Qe;Dt.ensureSingle(Ne._fullLayout._draggers,"rect",tt),Ne._fullData[Qe]._bgRect=rt.select("."+tt),Ne._fullData[Qe]._bgRect.style("pointer-events","all").attr("width",Ge.width).attr("height",Ge.height).attr("x",Ge.translateX).attr("y",Ge.translateY).classed("bgsankey",!0).style({fill:"transparent","stroke-width":0})})),mr.transition().ease(tt.ease).duration(tt.duration).attr("transform",sankeyTransform);var xr=mr.selectAll("."+tt.cn.sankeyLinks).data(er,Zt);xr.enter().append("g").classed(tt.cn.sankeyLinks,!0).style("fill","none");var br=xr.selectAll("."+tt.cn.sankeyLink).data((function(Ne){return Ne.graph.links.filter((function(Ne){return Ne.value})).map(linkModel.bind(null,Ne))}),Zt);br.enter().append("path").classed(tt.cn.sankeyLink,!0).call(attachPointerEvents,mr,dt.linkEvents),br.style("stroke",(function(Ne){return salientEnough(Ne)?at.tinyRGB(nt(Ne.linkLineColor)):Ne.tinyColorHue})).style("stroke-opacity",(function(Ne){return salientEnough(Ne)?at.opacity(Ne.linkLineColor):Ne.tinyColorAlpha})).style("fill",(function(Ne){return Ne.tinyColorHue})).style("fill-opacity",(function(Ne){return Ne.tinyColorAlpha})).style("stroke-width",(function(Ne){return salientEnough(Ne)?Ne.linkLineWidth:1})).attr("d",linkPath()),br.style("opacity",(function(){return Ne._context.staticPlot||ht||Ot?1:0})).transition().ease(tt.ease).duration(tt.duration).style("opacity",1),br.exit().transition().ease(tt.ease).duration(tt.duration).style("opacity",0).remove();var Ar=mr.selectAll("."+tt.cn.sankeyNodeSet).data(er,Zt);Ar.enter().append("g").classed(tt.cn.sankeyNodeSet,!0),Ar.style("cursor",(function(Ne){switch(Ne.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}}));var en=Ar.selectAll("."+tt.cn.sankeyNode).data((function(Ne){var Ge=Ne.graph.nodes;return persistOriginalPlace(Ge),Ge.map(nodeModel.bind(null,Ne))}),Zt);en.enter().append("g").classed(tt.cn.sankeyNode,!0).call(updateNodePositions).style("opacity",(function(Ge){return!Ne._context.staticPlot&&!ht||Ge.partOfGroup?0:1})),en.call(attachPointerEvents,mr,dt.nodeEvents).call(attachDragHandler,br,dt,Ne),en.transition().ease(tt.ease).duration(tt.duration).call(updateNodePositions).style("opacity",(function(Ne){return Ne.partOfGroup?0:1})),en.exit().transition().ease(tt.ease).duration(tt.duration).style("opacity",0).remove();var mn=en.selectAll("."+tt.cn.nodeRect).data(er);mn.enter().append("rect").classed(tt.cn.nodeRect,!0).call(sizeNode),mn.style("stroke-width",(function(Ne){return Ne.nodeLineWidth})).style("stroke",(function(Ne){return at.tinyRGB(nt(Ne.nodeLineColor))})).style("stroke-opacity",(function(Ne){return at.opacity(Ne.nodeLineColor)})).style("fill",(function(Ne){return Ne.tinyColorHue})).style("fill-opacity",(function(Ne){return Ne.tinyColorAlpha})),mn.transition().ease(tt.ease).duration(tt.duration).call(sizeNode);var xn=en.selectAll("."+tt.cn.nodeCapture).data(er);xn.enter().append("rect").classed(tt.cn.nodeCapture,!0).style("fill-opacity",0),xn.attr("x",(function(Ne){return Ne.zoneX})).attr("y",(function(Ne){return Ne.zoneY})).attr("width",(function(Ne){return Ne.zoneWidth})).attr("height",(function(Ne){return Ne.zoneHeight}));var kn=en.selectAll("."+tt.cn.nodeCentered).data(er);kn.enter().append("g").classed(tt.cn.nodeCentered,!0).attr("transform",nodeCentering),kn.transition().ease(tt.ease).duration(tt.duration).attr("transform",nodeCentering);var Cn=kn.selectAll("."+tt.cn.nodeLabelGuide).data(er);Cn.enter().append("path").classed(tt.cn.nodeLabelGuide,!0).attr("id",(function(Ne){return Ne.uniqueNodeLabelPathId})).attr("d",textGuidePath).attr("transform",sankeyInverseTransform),Cn.transition().ease(tt.ease).duration(tt.duration).attr("d",textGuidePath).attr("transform",sankeyInverseTransform);var En=kn.selectAll("."+tt.cn.nodeLabel).data(er);En.enter().append("text").classed(tt.cn.nodeLabel,!0).attr("transform",textFlip).style("cursor","default").style("fill","black"),En.style("text-shadow",(function(Ne){return Ne.horizontal?"-1px 1px 1px #fff, 1px 1px 1px #fff, 1px -1px 1px #fff, -1px -1px 1px #fff":"none"})).each((function(Ne){it.font(En,Ne.textFont)})),En.transition().ease(tt.ease).duration(tt.duration).attr("transform",textFlip);var Pn=En.selectAll("."+tt.cn.nodeLabelTextPath).data(er);Pn.enter().append("textPath").classed(tt.cn.nodeLabelTextPath,!0).attr("alignment-baseline","middle").attr("xlink:href",(function(Ne){return"#"+Ne.uniqueNodeLabelPathId})).attr("startOffset",nodeTextOffset).style("fill",nodeTextColor),Pn.text((function(Ne){return Ne.horizontal||Ne.node.dy>5?Ne.node.label:""})).attr("text-anchor",(function(Ne){return Ne.horizontal&&Ne.left?"end":"start"})),Pn.transition().ease(tt.ease).duration(tt.duration).attr("startOffset",nodeTextOffset).style("fill",nodeTextColor)}},{"../../components/color":643,"../../components/drawing":665,"../../lib":778,"../../lib/gup":775,"../../registry":911,"./constants":1180,"@plotly/d3-sankey":56,"@plotly/d3-sankey-circular":55,d3:169,"d3-force":160,"d3-interpolate":162,tinycolor2:576}],1185:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge){for(var Qe=[],tt=Ne.cd[0].trace,rt=tt._sankey.graph.nodes,nt=0;nt<rt.length;nt++){var at=rt[nt];if(!at.partOfGroup){var it=[(at.x0+at.x1)/2,(at.y0+at.y1)/2];"v"===tt.orientation&&it.reverse(),Ge&&Ge.contains(it,!1,nt,Ne)&&Qe.push({pointNumber:at.pointNumber})}}return Qe}},{}],1186:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib");Ge.exports=function(Ne,Ge){for(var Qe=0;Qe<Ne.length;Qe++)Ne[Qe].i=Qe;tt.mergeArray(Ge.text,Ne,"tx"),tt.mergeArray(Ge.texttemplate,Ne,"txt"),tt.mergeArray(Ge.hovertext,Ne,"htx"),tt.mergeArray(Ge.customdata,Ne,"data"),tt.mergeArray(Ge.textposition,Ne,"tp"),Ge.textfont&&(tt.mergeArrayCastPositive(Ge.textfont.size,Ne,"ts"),tt.mergeArray(Ge.textfont.color,Ne,"tc"),tt.mergeArray(Ge.textfont.family,Ne,"tf"));var rt=Ge.marker;if(rt){tt.mergeArrayCastPositive(rt.size,Ne,"ms"),tt.mergeArrayCastPositive(rt.opacity,Ne,"mo"),tt.mergeArray(rt.symbol,Ne,"mx"),tt.mergeArray(rt.color,Ne,"mc");var nt=rt.line;rt.line&&(tt.mergeArray(nt.color,Ne,"mlc"),tt.mergeArrayCastPositive(nt.width,Ne,"mlw"));var at=rt.gradient;at&&"none"!==at.type&&(tt.mergeArray(at.type,Ne,"mgt"),tt.mergeArray(at.color,Ne,"mgc"))}}},{"../../lib":778}],1187:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/template_attributes").texttemplateAttrs,rt=Ne("../../plots/template_attributes").hovertemplateAttrs,nt=Ne("../../components/colorscale/attributes"),at=Ne("../../plots/font_attributes"),it=Ne("../../components/drawing/attributes").dash,ot=Ne("../../components/drawing"),dt=Ne("./constants"),ht=Ne("../../lib/extend").extendFlat;function axisPeriod(Ne){return{valType:"any",dflt:0,editType:"calc"}}function axisPeriod0(Ne){return{valType:"any",editType:"calc"}}function axisPeriodAlignment(Ne){return{valType:"enumerated",values:["start","middle","end"],dflt:"middle",editType:"calc"}}Ge.exports={x:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},x0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dx:{valType:"number",dflt:1,editType:"calc",anim:!0},y:{valType:"data_array",editType:"calc+clearAxisTypes",anim:!0},y0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes",anim:!0},dy:{valType:"number",dflt:1,editType:"calc",anim:!0},xperiod:axisPeriod("x"),yperiod:axisPeriod("y"),xperiod0:axisPeriod0("x0"),yperiod0:axisPeriod0("y0"),xperiodalignment:axisPeriodAlignment("x"),yperiodalignment:axisPeriodAlignment("y"),stackgroup:{valType:"string",dflt:"",editType:"calc"},orientation:{valType:"enumerated",values:["v","h"],editType:"calc"},groupnorm:{valType:"enumerated",values:["","fraction","percent"],dflt:"",editType:"calc"},stackgaps:{valType:"enumerated",values:["infer zero","interpolate"],dflt:"infer zero",editType:"calc"},text:{valType:"string",dflt:"",arrayOk:!0,editType:"calc"},texttemplate:tt({},{}),hovertext:{valType:"string",dflt:"",arrayOk:!0,editType:"style"},mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"],editType:"calc"},hoveron:{valType:"flaglist",flags:["points","fills"],editType:"style"},hovertemplate:rt({},{keys:dt.eventDataKeys}),line:{color:{valType:"color",editType:"style",anim:!0},width:{valType:"number",min:0,dflt:2,editType:"style",anim:!0},shape:{valType:"enumerated",values:["linear","spline","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},smoothing:{valType:"number",min:0,max:1.3,dflt:1,editType:"plot"},dash:ht({},it,{editType:"style"}),simplify:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},cliponaxis:{valType:"boolean",dflt:!0,editType:"plot"},fill:{valType:"enumerated",values:["none","tozeroy","tozerox","tonexty","tonextx","toself","tonext"],editType:"calc"},fillcolor:{valType:"color",editType:"style",anim:!0},marker:ht({symbol:{valType:"enumerated",values:ot.symbolList,dflt:"circle",arrayOk:!0,editType:"style"},opacity:{valType:"number",min:0,max:1,arrayOk:!0,editType:"style",anim:!0},size:{valType:"number",min:0,dflt:6,arrayOk:!0,editType:"calc",anim:!0},maxdisplayed:{valType:"number",min:0,dflt:0,editType:"plot"},sizeref:{valType:"number",dflt:1,editType:"calc"},sizemin:{valType:"number",min:0,dflt:0,editType:"calc"},sizemode:{valType:"enumerated",values:["diameter","area"],dflt:"diameter",editType:"calc"},line:ht({width:{valType:"number",min:0,arrayOk:!0,editType:"style",anim:!0},editType:"calc"},nt("marker.line",{anim:!0})),gradient:{type:{valType:"enumerated",values:["radial","horizontal","vertical","none"],arrayOk:!0,dflt:"none",editType:"calc"},color:{valType:"color",arrayOk:!0,editType:"calc"},editType:"calc"},editType:"calc"},nt("marker",{anim:!0})),selected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},unselected:{marker:{opacity:{valType:"number",min:0,max:1,editType:"style"},color:{valType:"color",editType:"style"},size:{valType:"number",min:0,editType:"style"},editType:"style"},textfont:{color:{valType:"color",editType:"style"},editType:"style"},editType:"style"},textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"middle center",arrayOk:!0,editType:"calc"},textfont:at({editType:"calc",colorEditType:"style",arrayOk:!0}),r:{valType:"data_array",editType:"calc"},t:{valType:"data_array",editType:"calc"}}},{"../../components/colorscale/attributes":650,"../../components/drawing":665,"../../components/drawing/attributes":664,"../../lib/extend":768,"../../plots/font_attributes":856,"../../plots/template_attributes":906,"./constants":1191}],1188:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../lib"),nt=Ne("../../plots/cartesian/axes"),at=Ne("../../plots/cartesian/align_period"),it=Ne("../../constants/numerical").BADNUM,ot=Ne("./subtypes"),dt=Ne("./colorscale_calc"),ht=Ne("./arrays_to_calcdata"),Dt=Ne("./calc_selection");function calc(Ne,Ge){var Qe,ot,Ot,Rt,Zt,er,dr=Ne._fullLayout,mr=nt.getFromId(Ne,Ge.xaxis||"x"),xr=nt.getFromId(Ne,Ge.yaxis||"y"),br=mr.makeCalcdata(Ge,"x"),Ar=xr.makeCalcdata(Ge,"y"),en=at(Ge,mr,"x",br),mn=at(Ge,xr,"y",Ar),xn=Ge._length,kn=new Array(xn),Cn=Ge.ids,En=getStackOpts(Ge,dr,mr,xr),Pn=!1;setFirstScatter(dr,Ge);var Dn,In="x",zn="y";En?(rt.pushUnique(En.traceIndices,Ge._expandedIndex),(Qe="v"===En.orientation)?(zn="s",Dn="x"):(In="s",Dn="y"),Zt="interpolate"===En.stackgaps):calcAxisExpansion(Ne,Ge,mr,xr,en,mn,calcMarkerSize(Ge,xn));var Bn=!!Ge.xperiodalignment,Vn=!!Ge.yperiodalignment;for(ot=0;ot<xn;ot++){var Hn=kn[ot]={},qn=tt(en[ot]),Yn=tt(mn[ot]);qn&&Yn?(Hn[In]=en[ot],Hn[zn]=mn[ot],Bn&&(Hn.orig_x=br[ot]),Vn&&(Hn.orig_y=Ar[ot])):En&&(Qe?qn:Yn)?(Hn[Dn]=Qe?en[ot]:mn[ot],Hn.gap=!0,Zt?(Hn.s=it,Pn=!0):Hn.s=0):Hn[In]=Hn[zn]=it,Cn&&(Hn.id=String(Cn[ot]))}if(ht(kn,Ge),dt(Ne,Ge),Dt(kn,Ge),En){for(ot=0;ot<kn.length;)kn[ot][Dn]===it?kn.splice(ot,1):ot++;if(rt.sort(kn,(function(Ne,Ge){return Ne[Dn]-Ge[Dn]||Ne.i-Ge.i})),Pn){for(ot=0;ot<kn.length-1&&kn[ot].gap;)ot++;for((er=kn[ot].s)||(er=kn[ot].s=0),Ot=0;Ot<ot;Ot++)kn[Ot].s=er;for(Rt=kn.length-1;Rt>ot&&kn[Rt].gap;)Rt--;for(er=kn[Rt].s,Ot=kn.length-1;Ot>Rt;Ot--)kn[Ot].s=er;for(;ot<Rt;)if(kn[++ot].gap){for(Ot=ot+1;kn[Ot].gap;)Ot++;for(var $n=kn[ot-1][Dn],ra=kn[ot-1].s,oa=(kn[Ot].s-ra)/(kn[Ot][Dn]-$n);ot<Ot;)kn[ot].s=ra+(kn[ot][Dn]-$n)*oa,ot++}}}return kn}function calcAxisExpansion(Ne,Ge,Qe,tt,rt,at,it){var dt=Ge._length,ht=Ne._fullLayout,Dt=Qe._id,Ot=tt._id,Rt=ht._firstScatter[firstScatterGroup(Ge)]===Ge.uid,Zt=(getStackOpts(Ge,ht,Qe,tt)||{}).orientation,er=Ge.fill;Qe._minDtick=0,tt._minDtick=0;var dr={padded:!0},mr={padded:!0};it&&(dr.ppad=mr.ppad=it);var xr=dt<2||rt[0]!==rt[dt-1]||at[0]!==at[dt-1];xr&&("tozerox"===er||"tonextx"===er&&(Rt||"h"===Zt))?dr.tozero=!0:(Ge.error_y||{}).visible||"tonexty"!==er&&"tozeroy"!==er&&(ot.hasMarkers(Ge)||ot.hasText(Ge))||(dr.padded=!1,dr.ppad=0),xr&&("tozeroy"===er||"tonexty"===er&&(Rt||"v"===Zt))?mr.tozero=!0:"tonextx"!==er&&"tozerox"!==er||(mr.padded=!1),Dt&&(Ge._extremes[Dt]=nt.findExtremes(Qe,rt,dr)),Ot&&(Ge._extremes[Ot]=nt.findExtremes(tt,at,mr))}function calcMarkerSize(Ne,Ge){if(ot.hasMarkers(Ne)){var Qe,tt=Ne.marker,at=1.6*(Ne.marker.sizeref||1);if(Qe="area"===Ne.marker.sizemode?function(Ne){return Math.max(Math.sqrt((Ne||0)/at),3)}:function(Ne){return Math.max((Ne||0)/at,3)},rt.isArrayOrTypedArray(tt.size)){var it={type:"linear"};nt.setConvert(it);for(var dt=it.makeCalcdata(Ne.marker,"size"),ht=new Array(Ge),Dt=0;Dt<Ge;Dt++)ht[Dt]=Qe(dt[Dt]);return ht}return Qe(tt.size)}}function setFirstScatter(Ne,Ge){var Qe=firstScatterGroup(Ge),tt=Ne._firstScatter;tt[Qe]||(tt[Qe]=Ge.uid)}function firstScatterGroup(Ne){var Ge=Ne.stackgroup;return Ne.xaxis+Ne.yaxis+Ne.type+(Ge?"-"+Ge:"")}function getStackOpts(Ne,Ge,Qe,tt){var rt=Ne.stackgroup;if(rt){var nt=Ge._scatterStackOpts[Qe._id+tt._id][rt],at="v"===nt.orientation?tt:Qe;return"linear"===at.type||"log"===at.type?nt:void 0}}Ge.exports={calc:calc,calcMarkerSize:calcMarkerSize,calcAxisExpansion:calcAxisExpansion,setFirstScatter:setFirstScatter,getStackOpts:getStackOpts}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/align_period":825,"../../plots/cartesian/axes":828,"./arrays_to_calcdata":1186,"./calc_selection":1189,"./colorscale_calc":1190,"./subtypes":1212,"fast-isnumeric":241}],1189:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib");Ge.exports=function(Ne,Ge){tt.isArrayOrTypedArray(Ge.selectedpoints)&&tt.tagSelected(Ne,Ge)}},{"../../lib":778}],1190:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/colorscale/helpers").hasColorscale,rt=Ne("../../components/colorscale/calc"),nt=Ne("./subtypes");Ge.exports=function(Ne,Ge){nt.hasLines(Ge)&&tt(Ge,"line")&&rt(Ne,Ge,{vals:Ge.line.color,containerStr:"line",cLetter:"c"}),nt.hasMarkers(Ge)&&(tt(Ge,"marker")&&rt(Ne,Ge,{vals:Ge.marker.color,containerStr:"marker",cLetter:"c"}),tt(Ge,"marker.line")&&rt(Ne,Ge,{vals:Ge.marker.line.color,containerStr:"marker.line",cLetter:"c"}))}},{"../../components/colorscale/calc":651,"../../components/colorscale/helpers":654,"./subtypes":1212}],1191:[function(Ne,Ge,Qe){"use strict";Ge.exports={PTS_LINESONLY:20,minTolerance:.2,toleranceGrowth:10,maxScreensAway:20,eventDataKeys:[]}},{}],1192:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./calc");function insertBlank(Ne,Ge,Qe,tt,rt,nt,at){rt[tt]=!0;var it={i:null,gap:!0,s:0};if(it[at]=Qe,Ne.splice(Ge,0,it),Ge&&Qe===Ne[Ge-1][at]){var ot=Ne[Ge-1];it.s=ot.s,it.i=ot.i,it.gap=ot.gap}else nt&&(it.s=getInterp(Ne,Ge,Qe,at));Ge||(Ne[0].t=Ne[1].t,Ne[0].trace=Ne[1].trace,delete Ne[1].t,delete Ne[1].trace)}function getInterp(Ne,Ge,Qe,tt){var rt=Ne[Ge-1],nt=Ne[Ge+1];return nt?rt?rt.s+(nt.s-rt.s)*(Qe-rt[tt])/(nt[tt]-rt[tt]):nt.s:rt.s}Ge.exports=function(Ne,Ge){var Qe=Ge.xaxis,rt=Ge.yaxis,nt=Qe._id+rt._id,at=Ne._fullLayout._scatterStackOpts[nt];if(at){var it,ot,dt,ht,Dt,Ot,Rt,Zt,er,dr,mr,xr,br,Ar,en,mn=Ne.calcdata;for(var xn in at){var kn=(dr=at[xn]).traceIndices;if(kn.length){for(mr="interpolate"===dr.stackgaps,xr=dr.groupnorm,"v"===dr.orientation?(br="x",Ar="y"):(br="y",Ar="x"),en=new Array(kn.length),it=0;it<en.length;it++)en[it]=!1;Ot=mn[kn[0]];var Cn=new Array(Ot.length);for(it=0;it<Ot.length;it++)Cn[it]=Ot[it][br];for(it=1;it<kn.length;it++){for(Dt=mn[kn[it]],ot=dt=0;ot<Dt.length;ot++){for(Rt=Dt[ot][br];Rt>Cn[dt]&&dt<Cn.length;dt++)insertBlank(Dt,ot,Cn[dt],it,en,mr,br),ot++;if(Rt!==Cn[dt]){for(ht=0;ht<it;ht++)insertBlank(mn[kn[ht]],dt,Rt,ht,en,mr,br);Cn.splice(dt,0,Rt)}dt++}for(;dt<Cn.length;dt++)insertBlank(Dt,ot,Cn[dt],it,en,mr,br),ot++}var En=Cn.length;for(ot=0;ot<Ot.length;ot++){for(Zt=Ot[ot][Ar]=Ot[ot].s,it=1;it<kn.length;it++)(Dt=mn[kn[it]])[0].trace._rawLength=Dt[0].trace._length,Dt[0].trace._length=En,Zt+=Dt[ot].s,Dt[ot][Ar]=Zt;if(xr)for(er=("fraction"===xr?Zt:Zt/100)||1,it=0;it<kn.length;it++){var Pn=mn[kn[it]][ot];Pn[Ar]/=er,Pn.sNorm=Pn.s/er}}for(it=0;it<kn.length;it++){var Dn=(Dt=mn[kn[it]])[0].trace,In=tt.calcMarkerSize(Dn,Dn._rawLength),zn=Array.isArray(In);if(In&&en[it]||zn){var Bn=In;for(In=new Array(En),ot=0;ot<En;ot++)In[ot]=Dt[ot].gap?0:zn?Bn[Dt[ot].i]:Bn}var Vn=new Array(En),Hn=new Array(En);for(ot=0;ot<En;ot++)Vn[ot]=Dt[ot].x,Hn[ot]=Dt[ot].y;tt.calcAxisExpansion(Ne,Dn,Qe,rt,Vn,Hn,In),Dt[0].t.orientation=dr.orientation}}}}}},{"./calc":1188}],1193:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne){for(var Ge=0;Ge<Ne.length;Ge++){var Qe=Ne[Ge];if("scatter"===Qe.type){var tt=Qe.fill;if("none"!==tt&&"toself"!==tt&&(Qe.opacity=void 0,"tonexty"===tt||"tonextx"===tt))for(var rt=Ge-1;rt>=0;rt--){var nt=Ne[rt];if("scatter"===nt.type&&nt.xaxis===Qe.xaxis&&nt.yaxis===Qe.yaxis){nt.opacity=void 0;break}}}}}},{}],1194:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../registry"),nt=Ne("./attributes"),at=Ne("./constants"),it=Ne("./subtypes"),ot=Ne("./xy_defaults"),dt=Ne("./period_defaults"),ht=Ne("./stack_defaults"),Dt=Ne("./marker_defaults"),Ot=Ne("./line_defaults"),Rt=Ne("./line_shape_defaults"),Zt=Ne("./text_defaults"),er=Ne("./fillcolor_defaults");Ge.exports=function(Ne,Ge,Qe,dr){function coerce(Qe,rt){return tt.coerce(Ne,Ge,nt,Qe,rt)}var mr=ot(Ne,Ge,dr,coerce);if(mr||(Ge.visible=!1),Ge.visible){dt(Ne,Ge,dr,coerce);var xr=ht(Ne,Ge,dr,coerce),br=!xr&&mr<at.PTS_LINESONLY?"lines+markers":"lines";coerce("text"),coerce("hovertext"),coerce("mode",br),it.hasLines(Ge)&&(Ot(Ne,Ge,Qe,dr,coerce),Rt(Ne,Ge,coerce),coerce("connectgaps"),coerce("line.simplify")),it.hasMarkers(Ge)&&Dt(Ne,Ge,Qe,dr,coerce,{gradient:!0}),it.hasText(Ge)&&(coerce("texttemplate"),Zt(Ne,Ge,dr,coerce));var Ar=[];(it.hasMarkers(Ge)||it.hasText(Ge))&&(coerce("cliponaxis"),coerce("marker.maxdisplayed"),Ar.push("points")),coerce("fill",xr?xr.fillDflt:"none"),"none"!==Ge.fill&&(er(Ne,Ge,Qe,coerce),it.hasLines(Ge)||Rt(Ne,Ge,coerce));var en=(Ge.line||{}).color,mn=(Ge.marker||{}).color;"tonext"!==Ge.fill&&"toself"!==Ge.fill||Ar.push("fills"),coerce("hoveron",Ar.join("+")||"points"),"fills"!==Ge.hoveron&&coerce("hovertemplate");var xn=rt.getComponentMethod("errorbars","supplyDefaults");xn(Ne,Ge,en||mn||Qe,{axis:"y"}),xn(Ne,Ge,en||mn||Qe,{axis:"x",inherit:"y"}),tt.coerceSelectionMarkerOpacity(Ge,coerce)}}},{"../../lib":778,"../../registry":911,"./attributes":1187,"./constants":1191,"./fillcolor_defaults":1195,"./line_defaults":1200,"./line_shape_defaults":1202,"./marker_defaults":1206,"./period_defaults":1207,"./stack_defaults":1210,"./subtypes":1212,"./text_defaults":1213,"./xy_defaults":1214}],1195:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/color"),rt=Ne("../../lib").isArrayOrTypedArray;Ge.exports=function(Ne,Ge,Qe,nt){var at=!1;if(Ge.marker){var it=Ge.marker.color,ot=(Ge.marker.line||{}).color;it&&!rt(it)?at=it:ot&&!rt(ot)&&(at=ot)}nt("fillcolor",tt.addOpacity((Ge.line||{}).color||at||Qe,.5))}},{"../../components/color":643,"../../lib":778}],1196:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/cartesian/axes");Ge.exports=function(Ne,Ge,Qe){var rt={},nt={_fullLayout:Qe},at=tt.getFromTrace(nt,Ge,"x"),it=tt.getFromTrace(nt,Ge,"y");return rt.xLabel=tt.tickText(at,Ne.x,!0).text,rt.yLabel=tt.tickText(it,Ne.y,!0).text,rt}},{"../../plots/cartesian/axes":828}],1197:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/color"),rt=Ne("./subtypes");Ge.exports=function(Ne,Ge){var Qe,nt;if("lines"===Ne.mode)return(Qe=Ne.line.color)&&tt.opacity(Qe)?Qe:Ne.fillcolor;if("none"===Ne.mode)return Ne.fill?Ne.fillcolor:"";var at=Ge.mcc||(Ne.marker||{}).color,it=Ge.mlcc||((Ne.marker||{}).line||{}).color;return(nt=at&&tt.opacity(at)?at:it&&tt.opacity(it)&&(Ge.mlw||((Ne.marker||{}).line||{}).width)?it:"")?tt.opacity(nt)<.3?tt.addOpacity(nt,.3):nt:(Qe=(Ne.line||{}).color)&&tt.opacity(Qe)&&rt.hasLines(Ne)&&Ne.line.width?Qe:Ne.fillcolor}},{"../../components/color":643,"./subtypes":1212}],1198:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../components/fx"),nt=Ne("../../registry"),at=Ne("./get_trace_color"),it=Ne("../../components/color"),ot=tt.fillText;Ge.exports=function(Ne,Ge,Qe,dt){var ht=Ne.cd,Dt=ht[0].trace,Ot=Ne.xa,Rt=Ne.ya,Zt=Ot.c2p(Ge),er=Rt.c2p(Qe),dr=[Zt,er],mr=Dt.hoveron||"",xr=-1!==Dt.mode.indexOf("markers")?3:.5;if(-1!==mr.indexOf("points")){var dx=function(Ne){var Ge=Math.max(3,Ne.mrc||0),Qe=1-1/Ge,tt=Math.abs(Ot.c2p(Ne.x)-Zt);return tt<Ge?Qe*tt/Ge:tt-Ge+Qe},dy=function(Ne){var Ge=Math.max(3,Ne.mrc||0),Qe=1-1/Ge,tt=Math.abs(Rt.c2p(Ne.y)-er);return tt<Ge?Qe*tt/Ge:tt-Ge+Qe},dxy=function(Ne){var Ge=Math.max(xr,Ne.mrc||0),Qe=Ot.c2p(Ne.x)-Zt,tt=Rt.c2p(Ne.y)-er;return Math.max(Math.sqrt(Qe*Qe+tt*tt)-Ge,1-xr/Ge)},br=rt.getDistanceFunction(dt,dx,dy,dxy);if(rt.getClosest(ht,br,Ne),!1!==Ne.index){var Ar=ht[Ne.index],en=Ot.c2p(Ar.x,!0),mn=Rt.c2p(Ar.y,!0),xn=Ar.mrc||1;Ne.index=Ar.i;var kn=ht[0].t.orientation,Cn=kn&&(Ar.sNorm||Ar.s),En="h"===kn?Cn:void 0!==Ar.orig_x?Ar.orig_x:Ar.x,Pn="v"===kn?Cn:void 0!==Ar.orig_y?Ar.orig_y:Ar.y;return tt.extendFlat(Ne,{color:at(Dt,Ar),x0:en-xn,x1:en+xn,xLabelVal:En,y0:mn-xn,y1:mn+xn,yLabelVal:Pn,spikeDistance:dxy(Ar),hovertemplate:Dt.hovertemplate}),ot(Ar,Dt,Ne),nt.getComponentMethod("errorbars","hoverInfo")(Ar,Dt,Ne),[Ne]}}if(-1!==mr.indexOf("fills")&&Dt._polygons){var Dn,In,zn,Bn,Vn,Hn,qn,Yn,$n,ra=Dt._polygons,oa=[],pa=!1,ga=1/0,ma=-1/0,_a=1/0,Va=-1/0;for(Dn=0;Dn<ra.length;Dn++)(zn=ra[Dn]).contains(dr)&&(pa=!pa,oa.push(zn),_a=Math.min(_a,zn.ymin),Va=Math.max(Va,zn.ymax));if(pa){var Wa=((_a=Math.max(_a,0))+(Va=Math.min(Va,Rt._length)))/2;for(Dn=0;Dn<oa.length;Dn++)for(Bn=oa[Dn].pts,In=1;In<Bn.length;In++)(Yn=Bn[In-1][1])>Wa!=($n=Bn[In][1])>=Wa&&(Hn=Bn[In-1][0],qn=Bn[In][0],$n-Yn&&(Vn=Hn+(qn-Hn)*(Wa-Yn)/($n-Yn),ga=Math.min(ga,Vn),ma=Math.max(ma,Vn)));ga=Math.max(ga,0),ma=Math.min(ma,Ot._length);var Qa=it.defaultLine;return it.opacity(Dt.fillcolor)?Qa=Dt.fillcolor:it.opacity((Dt.line||{}).color)&&(Qa=Dt.line.color),tt.extendFlat(Ne,{distance:Ne.maxHoverDistance,x0:ga,x1:ma,y0:Wa,y1:Wa,color:Qa,hovertemplate:!1}),delete Ne.index,Dt.text&&!Array.isArray(Dt.text)?Ne.text=String(Dt.text):Ne.text=Dt.name,[Ne]}}}},{"../../components/color":643,"../../components/fx":683,"../../lib":778,"../../registry":911,"./get_trace_color":1197}],1199:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./subtypes");Ge.exports={hasLines:tt.hasLines,hasMarkers:tt.hasMarkers,hasText:tt.hasText,isBubble:tt.isBubble,attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),crossTraceDefaults:Ne("./cross_trace_defaults"),calc:Ne("./calc").calc,crossTraceCalc:Ne("./cross_trace_calc"),arraysToCalcdata:Ne("./arrays_to_calcdata"),plot:Ne("./plot"),colorbar:Ne("./marker_colorbar"),formatLabels:Ne("./format_labels"),style:Ne("./style").style,styleOnSelect:Ne("./style").styleOnSelect,hoverPoints:Ne("./hover"),selectPoints:Ne("./select"),animatable:!0,moduleType:"trace",name:"scatter",basePlotModule:Ne("../../plots/cartesian"),categories:["cartesian","svg","symbols","errorBarsOK","showLegend","scatter-like","zoomScale"],meta:{}}},{"../../plots/cartesian":841,"./arrays_to_calcdata":1186,"./attributes":1187,"./calc":1188,"./cross_trace_calc":1192,"./cross_trace_defaults":1193,"./defaults":1194,"./format_labels":1196,"./hover":1198,"./marker_colorbar":1205,"./plot":1208,"./select":1209,"./style":1211,"./subtypes":1212}],1200:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib").isArrayOrTypedArray,rt=Ne("../../components/colorscale/helpers").hasColorscale,nt=Ne("../../components/colorscale/defaults");Ge.exports=function(Ne,Ge,Qe,at,it,ot){var dt=(Ne.marker||{}).color;it("line.color",Qe),rt(Ne,"line")?nt(Ne,Ge,at,it,{prefix:"line.",cLetter:"c"}):it("line.color",!tt(dt)&&dt||Qe),it("line.width"),(ot||{}).noDash||it("line.dash")}},{"../../components/colorscale/defaults":653,"../../components/colorscale/helpers":654,"../../lib":778}],1201:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../constants/numerical"),rt=tt.BADNUM,nt=tt.LOG_CLIP,at=nt+.5,it=nt-.5,ot=Ne("../../lib"),dt=ot.segmentsIntersect,ht=ot.constrain,Dt=Ne("./constants");Ge.exports=function(Ne,Ge){var Qe,tt,nt,Ot,Rt,Zt,er,dr,mr,xr,br,Ar,en,mn,xn,kn,Cn,En,Pn=Ge.xaxis,Dn=Ge.yaxis,In="log"===Pn.type,zn="log"===Dn.type,Bn=Pn._length,Vn=Dn._length,Hn=Ge.connectGaps,qn=Ge.baseTolerance,Yn=Ge.shape,$n="linear"===Yn,ra=Ge.fill&&"none"!==Ge.fill,oa=[],pa=Dt.minTolerance,ga=Ne.length,ma=new Array(ga),_a=0;function getPt(Qe){var tt=Ne[Qe];if(!tt)return!1;var nt=Ge.linearized?Pn.l2p(tt.x):Pn.c2p(tt.x),ot=Ge.linearized?Dn.l2p(tt.y):Dn.c2p(tt.y);if(nt===rt){if(In&&(nt=Pn.c2p(tt.x,!0)),nt===rt)return!1;zn&&ot===rt&&(nt*=Math.abs(Pn._m*Vn*(Pn._m>0?at:it)/(Dn._m*Bn*(Dn._m>0?at:it)))),nt*=1e3}if(ot===rt){if(zn&&(ot=Dn.c2p(tt.y,!0)),ot===rt)return!1;ot*=1e3}return[nt,ot]}function crossesViewport(Ne,Ge,Qe,tt){var rt=Qe-Ne,nt=tt-Ge,at=.5-Ne,it=.5-Ge,ot=rt*rt+nt*nt,dt=rt*at+nt*it;if(dt>0&&dt<ot){var ht=at*nt-it*rt;if(ht*ht<ot)return!0}}function getTolerance(Ne,Ge){var Qe=Ne[0]/Bn,tt=Ne[1]/Vn,rt=Math.max(0,-Qe,Qe-1,-tt,tt-1);return rt&&void 0!==Cn&&crossesViewport(Qe,tt,Cn,En)&&(rt=0),rt&&Ge&&crossesViewport(Qe,tt,Ge[0]/Bn,Ge[1]/Vn)&&(rt=0),(1+Dt.toleranceGrowth*rt)*qn}function ptDist(Ne,Ge){var Qe=Ne[0]-Ge[0],tt=Ne[1]-Ge[1];return Math.sqrt(Qe*Qe+tt*tt)}var Va,Wa,Qa,ti,ni,di,ji,Hi=Dt.maxScreensAway,Yi=-Bn*Hi,uo=Bn*(1+Hi),go=-Vn*Hi,ns=Vn*(1+Hi),as=[[Yi,go,uo,go],[uo,go,uo,ns],[uo,ns,Yi,ns],[Yi,ns,Yi,go]];function getLinearEdgeIntersections(Ne,Ge){for(var Qe=[],tt=0,rt=0;rt<4;rt++){var nt=as[rt],at=dt(Ne[0],Ne[1],Ge[0],Ge[1],nt[0],nt[1],nt[2],nt[3]);at&&(!tt||Math.abs(at.x-Qe[0][0])>1||Math.abs(at.y-Qe[0][1])>1)&&(at=[at.x,at.y],tt&&ptDist(at,Ne)<ptDist(Qe[0],Ne)?Qe.unshift(at):Qe.push(at),tt++)}return Qe}function onlyConstrainedPoint(Ne){if(Ne[0]<Yi||Ne[0]>uo||Ne[1]<go||Ne[1]>ns)return[ht(Ne[0],Yi,uo),ht(Ne[1],go,ns)]}function sameEdge(Ne,Ge){return Ne[0]===Ge[0]&&(Ne[0]===Yi||Ne[0]===uo)||Ne[1]===Ge[1]&&(Ne[1]===go||Ne[1]===ns)||void 0}function getHVEdgeIntersections(Ne,Ge){var Qe=[],tt=onlyConstrainedPoint(Ne),rt=onlyConstrainedPoint(Ge);return tt&&rt&&sameEdge(tt,rt)||(tt&&Qe.push(tt),rt&&Qe.push(rt)),Qe}function getABAEdgeIntersections(Ne,Ge,Qe){return function(tt,rt){var nt=onlyConstrainedPoint(tt),at=onlyConstrainedPoint(rt),it=[];if(nt&&at&&sameEdge(nt,at))return it;nt&&it.push(nt),at&&it.push(at);var dt=2*ot.constrain((tt[Ne]+rt[Ne])/2,Ge,Qe)-((nt||tt)[Ne]+(at||rt)[Ne]);return dt&&((nt&&at?dt>0==nt[Ne]>at[Ne]?nt:at:nt||at)[Ne]+=dt),it}}function getClosestCorner(Ne,Ge){var Qe=Ge[0]-Ne[0],tt=(Ge[1]-Ne[1])/Qe;return(Ne[1]*Ge[0]-Ge[1]*Ne[0])/Qe>0?[tt>0?Yi:uo,ns]:[tt>0?uo:Yi,go]}function updateEdge(Ne){var Ge=Ne[0],Qe=Ne[1],tt=Ge===ma[_a-1][0],rt=Qe===ma[_a-1][1];if(!tt||!rt)if(_a>1){var nt=Ge===ma[_a-2][0],at=Qe===ma[_a-2][1];tt&&(Ge===Yi||Ge===uo)&&nt?at?_a--:ma[_a-1]=Ne:rt&&(Qe===go||Qe===ns)&&at?nt?_a--:ma[_a-1]=Ne:ma[_a++]=Ne}else ma[_a++]=Ne}function updateEdgesForReentry(Ne){ma[_a-1][0]!==Ne[0]&&ma[_a-1][1]!==Ne[1]&&updateEdge([Qa,ti]),updateEdge(Ne),ni=null,Qa=ti=0}function addPt(Ne){if(Cn=Ne[0]/Bn,En=Ne[1]/Vn,Va=Ne[0]<Yi?Yi:Ne[0]>uo?uo:0,Wa=Ne[1]<go?go:Ne[1]>ns?ns:0,Va||Wa){if(_a)if(ni){var Ge=ji(ni,Ne);Ge.length>1&&(updateEdgesForReentry(Ge[0]),ma[_a++]=Ge[1])}else di=ji(ma[_a-1],Ne)[0],ma[_a++]=di;else ma[_a++]=[Va||Ne[0],Wa||Ne[1]];var Qe=ma[_a-1];Va&&Wa&&(Qe[0]!==Va||Qe[1]!==Wa)?(ni&&(Qa!==Va&&ti!==Wa?updateEdge(Qa&&ti?getClosestCorner(ni,Ne):[Qa||Va,ti||Wa]):Qa&&ti&&updateEdge([Qa,ti])),updateEdge([Va,Wa])):Qa-Va&&ti-Wa&&updateEdge([Va||Qa,Wa||ti]),ni=Ne,Qa=Va,ti=Wa}else ni&&updateEdgesForReentry(ji(ni,Ne)[0]),ma[_a++]=Ne}for("linear"===Yn||"spline"===Yn?ji=getLinearEdgeIntersections:"hv"===Yn||"vh"===Yn?ji=getHVEdgeIntersections:"hvh"===Yn?ji=getABAEdgeIntersections(0,Yi,uo):"vhv"===Yn&&(ji=getABAEdgeIntersections(1,go,ns)),Qe=0;Qe<ga;Qe++)if(tt=getPt(Qe)){for(_a=0,ni=null,addPt(tt),Qe++;Qe<ga;Qe++){if(!(Ot=getPt(Qe))){if(Hn)continue;break}if($n&&Ge.simplify){var is=getPt(Qe+1);if(xr=ptDist(Ot,tt),ra&&(0===_a||_a===ga-1)||!(xr<getTolerance(Ot,is)*pa)){for(dr=[(Ot[0]-tt[0])/xr,(Ot[1]-tt[1])/xr],Rt=tt,br=xr,Ar=mn=xn=0,er=!1,nt=Ot,Qe++;Qe<Ne.length;Qe++){if(Zt=is,is=getPt(Qe+1),!Zt){if(Hn)continue;break}if(kn=(mr=[Zt[0]-tt[0],Zt[1]-tt[1]])[0]*dr[1]-mr[1]*dr[0],mn=Math.min(mn,kn),(xn=Math.max(xn,kn))-mn>getTolerance(Zt,is))break;nt=Zt,(en=mr[0]*dr[0]+mr[1]*dr[1])>br?(br=en,Ot=Zt,er=!1):en<Ar&&(Ar=en,Rt=Zt,er=!0)}if(er?(addPt(Ot),nt!==Rt&&addPt(Rt)):(Rt!==tt&&addPt(Rt),nt!==Ot&&addPt(Ot)),addPt(nt),Qe>=Ne.length||!Zt)break;addPt(Zt),tt=Zt}}else addPt(Ot)}ni&&updateEdge([Qa||ni[0],ti||ni[1]]),oa.push(ma.slice(0,_a))}return oa}},{"../../constants/numerical":753,"../../lib":778,"./constants":1191}],1202:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge,Qe){"spline"===Qe("line.shape")&&Qe("line.smoothing")}},{}],1203:[function(Ne,Ge,Qe){"use strict";var tt={tonextx:1,tonexty:1,tonext:1};Ge.exports=function(Ne,Ge,Qe){var rt,nt,at,it,ot,dt={},ht=!1,Dt=-1,Ot=0,Rt=-1;for(nt=0;nt<Qe.length;nt++)(at=(rt=Qe[nt][0].trace).stackgroup||"")?at in dt?ot=dt[at]:(ot=dt[at]=Ot,Ot++):rt.fill in tt&&Rt>=0?ot=Rt:(ot=Rt=Ot,Ot++),ot<Dt&&(ht=!0),rt._groupIndex=Dt=ot;var Zt=Qe.slice();ht&&Zt.sort((function(Ne,Ge){var Qe=Ne[0].trace,tt=Ge[0].trace;return Qe._groupIndex-tt._groupIndex||Qe.index-tt.index}));var er={};for(nt=0;nt<Zt.length;nt++)at=(rt=Zt[nt][0].trace).stackgroup||"",!0===rt.visible?(rt._nexttrace=null,rt.fill in tt&&(it=er[at],rt._prevtrace=it||null,it&&(it._nexttrace=rt)),rt._ownfill=rt.fill&&("tozero"===rt.fill.substr(0,6)||"toself"===rt.fill||"to"===rt.fill.substr(0,2)&&!rt._prevtrace),er[at]=rt):rt._prevtrace=rt._nexttrace=rt._ownfill=null;return Zt}},{}],1204:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric");Ge.exports=function(Ne){var Ge=Ne.marker,Qe=Ge.sizeref||1,rt=Ge.sizemin||0,nt="area"===Ge.sizemode?function(Ne){return Math.sqrt(Ne/Qe)}:function(Ne){return Ne/Qe};return function(Ne){var Ge=nt(Ne/2);return tt(Ge)&&Ge>0?Math.max(Ge,rt):0}}},{"fast-isnumeric":241}],1205:[function(Ne,Ge,Qe){"use strict";Ge.exports={container:"marker",min:"cmin",max:"cmax"}},{}],1206:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/color"),rt=Ne("../../components/colorscale/helpers").hasColorscale,nt=Ne("../../components/colorscale/defaults"),at=Ne("./subtypes");Ge.exports=function(Ne,Ge,Qe,it,ot,dt){var ht=at.isBubble(Ne),Dt=(Ne.line||{}).color;dt=dt||{},Dt&&(Qe=Dt),ot("marker.symbol"),ot("marker.opacity",ht?.7:1),ot("marker.size"),ot("marker.color",Qe),rt(Ne,"marker")&&nt(Ne,Ge,it,ot,{prefix:"marker.",cLetter:"c"}),dt.noSelect||(ot("selected.marker.color"),ot("unselected.marker.color"),ot("selected.marker.size"),ot("unselected.marker.size")),dt.noLine||(ot("marker.line.color",Dt&&!Array.isArray(Dt)&&Ge.marker.color!==Dt?Dt:ht?tt.background:tt.defaultLine),rt(Ne,"marker.line")&&nt(Ne,Ge,it,ot,{prefix:"marker.line.",cLetter:"c"}),ot("marker.line.width",ht?1:0)),ht&&(ot("marker.sizeref"),ot("marker.sizemin"),ot("marker.sizemode")),dt.gradient&&"none"!==ot("marker.gradient.type")&&ot("marker.gradient.color")}},{"../../components/color":643,"../../components/colorscale/defaults":653,"../../components/colorscale/helpers":654,"./subtypes":1212}],1207:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib").dateTick0,rt=Ne("../../constants/numerical").ONEWEEK;function getPeriod0Dflt(Ne,Ge){return tt(Ge,Ne%rt==0?1:0)}Ge.exports=function(Ne,Ge,Qe,tt,rt){if(rt||(rt={x:!0,y:!0}),rt.x){var nt=tt("xperiod");nt&&(tt("xperiod0",getPeriod0Dflt(nt,Ge.xcalendar)),tt("xperiodalignment"))}if(rt.y){var at=tt("yperiod");at&&(tt("yperiod0",getPeriod0Dflt(at,Ge.ycalendar)),tt("yperiodalignment"))}}},{"../../constants/numerical":753,"../../lib":778}],1208:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../registry"),nt=Ne("../../lib"),at=nt.ensureSingle,it=nt.identity,ot=Ne("../../components/drawing"),dt=Ne("./subtypes"),ht=Ne("./line_points"),Dt=Ne("./link_traces"),Ot=Ne("../../lib/polygon").tester;function createFills(Ne,Ge,Qe){Ge.each((function(Ge){var rt=at(tt.select(this),"g","fills");ot.setClipUrl(rt,Qe.layerClipId,Ne);var nt=Ge[0].trace,dt=[];nt._ownfill&&dt.push("_ownFill"),nt._nexttrace&&dt.push("_nextFill");var ht=rt.selectAll("g").data(dt,it);ht.enter().append("g"),ht.exit().each((function(Ne){nt[Ne]=null})).remove(),ht.order().each((function(Ne){nt[Ne]=at(tt.select(this),"path","js-fill")}))}))}function plotOne(Ne,Ge,Qe,Dt,Rt,Zt,er){var dr;selectMarkers(Ne,Ge,Qe,Dt,Rt);var mr=!!er&&er.duration>0;function transition(Ne){return mr?Ne.transition():Ne}var xr=Qe.xaxis,br=Qe.yaxis,Ar=Dt[0].trace,en=Ar.line,mn=tt.select(Zt),xn=at(mn,"g","errorbars"),kn=at(mn,"g","lines"),Cn=at(mn,"g","points"),En=at(mn,"g","text");if(rt.getComponentMethod("errorbars","plot")(Ne,xn,Qe,er),!0===Ar.visible){var Pn,Dn;transition(mn).style("opacity",Ar.opacity);var In=Ar.fill.charAt(Ar.fill.length-1);"x"!==In&&"y"!==In&&(In=""),Dt[0][Qe.isRangePlot?"nodeRangePlot3":"node3"]=mn;var zn,Bn,Vn="",Hn=[],qn=Ar._prevtrace;qn&&(Vn=qn._prevRevpath||"",Dn=qn._nextFill,Hn=qn._polygons);var Yn,$n,ra,oa,pa,ga,ma,_a="",Va="",Wa=[],Qa=nt.noop;if(Pn=Ar._ownFill,dt.hasLines(Ar)||"none"!==Ar.fill){for(Dn&&Dn.datum(Dt),-1!==["hv","vh","hvh","vhv"].indexOf(en.shape)?(Yn=ot.steps(en.shape),$n=ot.steps(en.shape.split("").reverse().join(""))):Yn=$n="spline"===en.shape?function(Ne){var Ge=Ne[Ne.length-1];return Ne.length>1&&Ne[0][0]===Ge[0]&&Ne[0][1]===Ge[1]?ot.smoothclosed(Ne.slice(1),en.smoothing):ot.smoothopen(Ne,en.smoothing)}:function(Ne){return"M"+Ne.join("L")},ra=function(Ne){return $n(Ne.reverse())},Wa=ht(Dt,{xaxis:xr,yaxis:br,connectGaps:Ar.connectgaps,baseTolerance:Math.max(en.width||1,3)/4,shape:en.shape,simplify:en.simplify,fill:Ar.fill}),ma=Ar._polygons=new Array(Wa.length),dr=0;dr<Wa.length;dr++)Ar._polygons[dr]=Ot(Wa[dr]);Wa.length&&(oa=Wa[0][0],ga=(pa=Wa[Wa.length-1])[pa.length-1]),Qa=function(Ne){return function(Ge){if(zn=Yn(Ge),Bn=ra(Ge),_a?In?(_a+="L"+zn.substr(1),Va=Bn+"L"+Va.substr(1)):(_a+="Z"+zn,Va=Bn+"Z"+Va):(_a=zn,Va=Bn),dt.hasLines(Ar)&&Ge.length>1){var Qe=tt.select(this);if(Qe.datum(Dt),Ne)transition(Qe.style("opacity",0).attr("d",zn).call(ot.lineGroupStyle)).style("opacity",1);else{var rt=transition(Qe);rt.attr("d",zn),ot.singleLineStyle(Dt,rt)}}}}}var ti=kn.selectAll(".js-line").data(Wa);transition(ti.exit()).style("opacity",0).remove(),ti.each(Qa(!1)),ti.enter().append("path").classed("js-line",!0).style("vector-effect","non-scaling-stroke").call(ot.lineGroupStyle).each(Qa(!0)),ot.setClipUrl(ti,Qe.layerClipId,Ne),Wa.length?(Pn?(Pn.datum(Dt),oa&&ga&&(In?("y"===In?oa[1]=ga[1]=br.c2p(0,!0):"x"===In&&(oa[0]=ga[0]=xr.c2p(0,!0)),transition(Pn).attr("d","M"+ga+"L"+oa+"L"+_a.substr(1)).call(ot.singleFillStyle)):transition(Pn).attr("d",_a+"Z").call(ot.singleFillStyle))):Dn&&("tonext"===Ar.fill.substr(0,6)&&_a&&Vn?("tonext"===Ar.fill?transition(Dn).attr("d",_a+"Z"+Vn+"Z").call(ot.singleFillStyle):transition(Dn).attr("d",_a+"L"+Vn.substr(1)+"Z").call(ot.singleFillStyle),Ar._polygons=Ar._polygons.concat(Hn)):(clearFill(Dn),Ar._polygons=null)),Ar._prevRevpath=Va,Ar._prevPolygons=ma):(Pn?clearFill(Pn):Dn&&clearFill(Dn),Ar._polygons=Ar._prevRevpath=Ar._prevPolygons=null),Cn.datum(Dt),En.datum(Dt),makePoints(Cn,En,Dt);var ni=!1===Ar.cliponaxis?null:Qe.layerClipId;ot.setClipUrl(Cn,ni,Ne),ot.setClipUrl(En,ni,Ne)}function clearFill(Ne){transition(Ne).attr("d","M0,0Z")}function visFilter(Ne){return Ne.filter((function(Ne){return!Ne.gap&&Ne.vis}))}function visFilterWithGaps(Ne){return Ne.filter((function(Ne){return Ne.vis}))}function gapFilter(Ne){return Ne.filter((function(Ne){return!Ne.gap}))}function keyFunc(Ne){return Ne.id}function getKeyFunc(Ne){if(Ne.ids)return keyFunc}function hideFilter(){return!1}function makePoints(Ge,rt,nt){var at,ht=nt[0].trace,Dt=dt.hasMarkers(ht),Ot=dt.hasText(ht),Rt=getKeyFunc(ht),Zt=hideFilter,er=hideFilter;if(Dt||Ot){var dr=it,Ar=ht.stackgroup,en=Ar&&"infer zero"===Ne._fullLayout._scatterStackOpts[xr._id+br._id][Ar].stackgaps;ht.marker.maxdisplayed||ht._needsCull?dr=en?visFilterWithGaps:visFilter:Ar&&!en&&(dr=gapFilter),Dt&&(Zt=dr),Ot&&(er=dr)}var mn,xn=(at=Ge.selectAll("path.point").data(Zt,Rt)).enter().append("path").classed("point",!0);mr&&xn.call(ot.pointStyle,ht,Ne).call(ot.translatePoints,xr,br).style("opacity",0).transition().style("opacity",1),at.order(),Dt&&(mn=ot.makePointStyleFns(ht)),at.each((function(Ge){var rt=tt.select(this),nt=transition(rt);ot.translatePoint(Ge,nt,xr,br)?(ot.singlePointStyle(Ge,nt,ht,mn,Ne),Qe.layerClipId&&ot.hideOutsideRangePoint(Ge,nt,xr,br,ht.xcalendar,ht.ycalendar),ht.customdata&&rt.classed("plotly-customdata",null!==Ge.data&&void 0!==Ge.data)):nt.remove()})),mr?at.exit().transition().style("opacity",0).remove():at.exit().remove(),(at=rt.selectAll("g").data(er,Rt)).enter().append("g").classed("textpoint",!0).append("text"),at.order(),at.each((function(Ne){var Ge=tt.select(this),rt=transition(Ge.select("text"));ot.translatePoint(Ne,rt,xr,br)?Qe.layerClipId&&ot.hideOutsideRangePoint(Ne,Ge,xr,br,ht.xcalendar,ht.ycalendar):Ge.remove()})),at.selectAll("text").call(ot.textPointStyle,ht,Ne).each((function(Ne){var Ge=xr.c2p(Ne.x),Qe=br.c2p(Ne.y);tt.select(this).selectAll("tspan.line").each((function(){transition(tt.select(this)).attr({x:Ge,y:Qe})}))})),at.exit().remove()}}function selectMarkers(Ne,Ge,Qe,rt,at){var it=Qe.xaxis,ot=Qe.yaxis,ht=tt.extent(nt.simpleMap(it.range,it.r2c)),Dt=tt.extent(nt.simpleMap(ot.range,ot.r2c)),Ot=rt[0].trace;if(dt.hasMarkers(Ot)){var Rt=Ot.marker.maxdisplayed;if(0!==Rt){var Zt=rt.filter((function(Ne){return Ne.x>=ht[0]&&Ne.x<=ht[1]&&Ne.y>=Dt[0]&&Ne.y<=Dt[1]})),er=Math.ceil(Zt.length/Rt),dr=0;at.forEach((function(Ne,Qe){var tt=Ne[0].trace;dt.hasMarkers(tt)&&tt.marker.maxdisplayed>0&&Qe<Ge&&dr++}));var mr=Math.round(dr*er/3+Math.floor(dr/3)*er/7.1);rt.forEach((function(Ne){delete Ne.vis})),Zt.forEach((function(Ne,Ge){0===Math.round((Ge+mr)%er)&&(Ne.vis=!0)}))}}}Ge.exports=function(Ne,Ge,Qe,rt,nt,at){var it,ot,dt=!nt,ht=!!nt&&nt.duration>0,Ot=Dt(Ne,Ge,Qe);(it=rt.selectAll("g.trace").data(Ot,(function(Ne){return Ne[0].trace.uid}))).enter().append("g").attr("class",(function(Ne){return"trace scatter trace"+Ne[0].trace.uid})).style("stroke-miterlimit",2),it.order(),createFills(Ne,it,Ge),ht?(at&&(ot=at()),tt.transition().duration(nt.duration).ease(nt.easing).each("end",(function(){ot&&ot()})).each("interrupt",(function(){ot&&ot()})).each((function(){rt.selectAll("g.trace").each((function(Qe,tt){plotOne(Ne,tt,Ge,Qe,Ot,this,nt)}))}))):it.each((function(Qe,tt){plotOne(Ne,tt,Ge,Qe,Ot,this,nt)})),dt&&it.exit().remove(),rt.selectAll("path:not([d])").remove()}},{"../../components/drawing":665,"../../lib":778,"../../lib/polygon":790,"../../registry":911,"./line_points":1201,"./link_traces":1203,"./subtypes":1212,d3:169}],1209:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./subtypes");Ge.exports=function(Ne,Ge){var Qe,rt,nt,at,it=Ne.cd,ot=Ne.xaxis,dt=Ne.yaxis,ht=[],Dt=it[0].trace;if(!tt.hasMarkers(Dt)&&!tt.hasText(Dt))return[];if(!1===Ge)for(Qe=0;Qe<it.length;Qe++)it[Qe].selected=0;else for(Qe=0;Qe<it.length;Qe++)rt=it[Qe],nt=ot.c2p(rt.x),at=dt.c2p(rt.y),null!==rt.i&&Ge.contains([nt,at],!1,Qe,Ne)?(ht.push({pointNumber:rt.i,x:ot.c2d(rt.x),y:dt.c2d(rt.y)}),rt.selected=1):rt.selected=0;return ht}},{"./subtypes":1212}],1210:[function(Ne,Ge,Qe){"use strict";var tt=["orientation","groupnorm","stackgaps"];Ge.exports=function(Ne,Ge,Qe,rt){var nt=Qe._scatterStackOpts,at=rt("stackgroup");if(at){var it=Ge.xaxis+Ge.yaxis,ot=nt[it];ot||(ot=nt[it]={});var dt=ot[at],ht=!1;dt?dt.traces.push(Ge):(dt=ot[at]={traceIndices:[],traces:[Ge]},ht=!0);for(var Dt={orientation:Ge.x&&!Ge.y?"h":"v"},Ot=0;Ot<tt.length;Ot++){var Rt=tt[Ot],Zt=Rt+"Found";if(!dt[Zt]){var er=void 0!==Ne[Rt],dr="orientation"===Rt;if((er||ht)&&(dt[Rt]=rt(Rt,Dt[Rt]),dr&&(dt.fillDflt="h"===dt[Rt]?"tonextx":"tonexty"),er&&(dt[Zt]=!0,!ht&&(delete dt.traces[0][Rt],dr))))for(var mr=0;mr<dt.traces.length-1;mr++){var xr=dt.traces[mr];xr._input.fill!==xr.fill&&(xr.fill=dt.fillDflt)}}}return dt}}},{}],1211:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../components/drawing"),nt=Ne("../../registry");function style(Ne){var Ge=tt.select(Ne).selectAll("g.trace.scatter");Ge.style("opacity",(function(Ne){return Ne[0].trace.opacity})),Ge.selectAll("g.points").each((function(Ge){stylePoints(tt.select(this),Ge.trace||Ge[0].trace,Ne)})),Ge.selectAll("g.text").each((function(Ge){styleText(tt.select(this),Ge.trace||Ge[0].trace,Ne)})),Ge.selectAll("g.trace path.js-line").call(rt.lineGroupStyle),Ge.selectAll("g.trace path.js-fill").call(rt.fillGroupStyle),nt.getComponentMethod("errorbars","style")(Ge)}function stylePoints(Ne,Ge,Qe){rt.pointStyle(Ne.selectAll("path.point"),Ge,Qe)}function styleText(Ne,Ge,Qe){rt.textPointStyle(Ne.selectAll("text"),Ge,Qe)}function styleOnSelect(Ne,Ge,Qe){var tt=Ge[0].trace;tt.selectedpoints?(rt.selectedPointStyle(Qe.selectAll("path.point"),tt),rt.selectedTextStyle(Qe.selectAll("text"),tt)):(stylePoints(Qe,tt,Ne),styleText(Qe,tt,Ne))}Ge.exports={style:style,stylePoints:stylePoints,styleText:styleText,styleOnSelect:styleOnSelect}},{"../../components/drawing":665,"../../registry":911,d3:169}],1212:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib");Ge.exports={hasLines:function(Ne){return Ne.visible&&Ne.mode&&-1!==Ne.mode.indexOf("lines")},hasMarkers:function(Ne){return Ne.visible&&(Ne.mode&&-1!==Ne.mode.indexOf("markers")||"splom"===Ne.type)},hasText:function(Ne){return Ne.visible&&Ne.mode&&-1!==Ne.mode.indexOf("text")},isBubble:function(Ne){return tt.isPlainObject(Ne.marker)&&tt.isArrayOrTypedArray(Ne.marker.size)}}},{"../../lib":778}],1213:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib");Ge.exports=function(Ne,Ge,Qe,rt,nt){nt=nt||{},rt("textposition"),tt.coerceFont(rt,"textfont",Qe.font),nt.noSelect||(rt("selected.textfont.color"),rt("unselected.textfont.color"))}},{"../../lib":778}],1214:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../registry");Ge.exports=function(Ne,Ge,Qe,nt){var at,it=nt("x"),ot=nt("y");if(rt.getComponentMethod("calendars","handleTraceDefaults")(Ne,Ge,["x","y"],Qe),it){var dt=tt.minRowLength(it);ot?at=Math.min(dt,tt.minRowLength(ot)):(at=dt,nt("y0"),nt("dy"))}else{if(!ot)return 0;at=tt.minRowLength(ot),nt("x0"),nt("dx")}return Ge._length=at,at}},{"../../lib":778,"../../registry":911}],1215:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../scatter/attributes"),rt=Ne("../../components/colorscale/attributes"),nt=Ne("../../plots/template_attributes").hovertemplateAttrs,at=Ne("../../plots/template_attributes").texttemplateAttrs,it=Ne("../../plots/attributes"),ot=Ne("../../constants/gl3d_dashes"),dt=Ne("../../constants/gl3d_markers"),ht=Ne("../../lib/extend").extendFlat,Dt=Ne("../../plot_api/edit_types").overrideAll,Ot=tt.line,Rt=tt.marker,Zt=Rt.line,er=ht({width:Ot.width,dash:{valType:"enumerated",values:Object.keys(ot),dflt:"solid"}},rt("line"));function makeProjectionAttr(Ne){return{show:{valType:"boolean",dflt:!1},opacity:{valType:"number",min:0,max:1,dflt:1},scale:{valType:"number",min:0,max:10,dflt:2/3}}}var dr=Ge.exports=Dt({x:tt.x,y:tt.y,z:{valType:"data_array"},text:ht({},tt.text,{}),texttemplate:at({},{}),hovertext:ht({},tt.hovertext,{}),hovertemplate:nt(),mode:ht({},tt.mode,{dflt:"lines+markers"}),surfaceaxis:{valType:"enumerated",values:[-1,0,1,2],dflt:-1},surfacecolor:{valType:"color"},projection:{x:makeProjectionAttr("x"),y:makeProjectionAttr("y"),z:makeProjectionAttr("z")},connectgaps:tt.connectgaps,line:er,marker:ht({symbol:{valType:"enumerated",values:Object.keys(dt),dflt:"circle",arrayOk:!0},size:ht({},Rt.size,{dflt:8}),sizeref:Rt.sizeref,sizemin:Rt.sizemin,sizemode:Rt.sizemode,opacity:ht({},Rt.opacity,{arrayOk:!1}),colorbar:Rt.colorbar,line:ht({width:ht({},Zt.width,{arrayOk:!1})},rt("marker.line"))},rt("marker")),textposition:ht({},tt.textposition,{dflt:"top center"}),textfont:{color:tt.textfont.color,size:tt.textfont.size,family:ht({},tt.textfont.family,{arrayOk:!1})},hoverinfo:ht({},it.hoverinfo)},"calc","nested");dr.x.editType=dr.y.editType=dr.z.editType="calc+clearAxisTypes"},{"../../components/colorscale/attributes":650,"../../constants/gl3d_dashes":750,"../../constants/gl3d_markers":751,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/attributes":824,"../../plots/template_attributes":906,"../scatter/attributes":1187}],1216:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../scatter/arrays_to_calcdata"),rt=Ne("../scatter/colorscale_calc");Ge.exports=function(Ne,Ge){var Qe=[{x:!1,y:!1,trace:Ge,t:{}}];return tt(Qe,Ge),rt(Ne,Ge),Qe}},{"../scatter/arrays_to_calcdata":1186,"../scatter/colorscale_calc":1190}],1217:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../registry");function calculateAxisErrors(Ne,Ge,Qe,rt){if(!Ge||!Ge.visible)return null;for(var nt=tt.getComponentMethod("errorbars","makeComputeError")(Ge),at=new Array(Ne.length),it=0;it<Ne.length;it++){var ot=nt(+Ne[it],it);if("log"===rt.type){var dt=rt.c2l(Ne[it]),ht=Ne[it]-ot[0],Dt=Ne[it]+ot[1];if(at[it]=[(rt.c2l(ht,!0)-dt)*Qe,(rt.c2l(Dt,!0)-dt)*Qe],ht>0){var Ot=rt.c2l(ht);rt._lowerLogErrorBound||(rt._lowerLogErrorBound=Ot),rt._lowerErrorBound=Math.min(rt._lowerLogErrorBound,Ot)}}else at[it]=[-ot[0]*Qe,ot[1]*Qe]}return at}function dataLength(Ne){for(var Ge=0;Ge<Ne.length;Ge++)if(Ne[Ge])return Ne[Ge].length;return 0}function calculateErrors(Ne,Ge,Qe){var tt=[calculateAxisErrors(Ne.x,Ne.error_x,Ge[0],Qe.xaxis),calculateAxisErrors(Ne.y,Ne.error_y,Ge[1],Qe.yaxis),calculateAxisErrors(Ne.z,Ne.error_z,Ge[2],Qe.zaxis)],rt=dataLength(tt);if(0===rt)return null;for(var nt=new Array(rt),at=0;at<rt;at++){for(var it=[[0,0,0],[0,0,0]],ot=0;ot<3;ot++)if(tt[ot])for(var dt=0;dt<2;dt++)it[dt][ot]=tt[ot][at][dt];nt[at]=it}return nt}Ge.exports=calculateErrors},{"../../registry":911}],1218:[function(Ne,Ge,Qe){"use strict";var tt=Ne("gl-line3d"),rt=Ne("gl-scatter3d"),nt=Ne("gl-error3d"),at=Ne("gl-mesh3d"),it=Ne("delaunay-triangulate"),ot=Ne("../../lib"),dt=Ne("../../lib/str2rgbarray"),ht=Ne("../../lib/gl_format_color").formatColor,Dt=Ne("../scatter/make_bubble_size_func"),Ot=Ne("../../constants/gl3d_dashes"),Rt=Ne("../../constants/gl3d_markers"),Zt=Ne("../../plots/cartesian/axes"),er=Ne("../../components/fx/helpers").appendArrayPointValue,dr=Ne("./calc_errors");function LineWithMarkers(Ne,Ge){this.scene=Ne,this.uid=Ge,this.linePlot=null,this.scatterPlot=null,this.errorBars=null,this.textMarkers=null,this.delaunayMesh=null,this.color=null,this.mode="",this.dataPoints=[],this.axesBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.textLabels=null,this.data=null}var mr=LineWithMarkers.prototype;function constructDelaunay(Ne,Ge,Qe){var tt,rt=(Qe+1)%3,nt=(Qe+2)%3,at=[],ot=[];for(tt=0;tt<Ne.length;++tt){var dt=Ne[tt];!isNaN(dt[rt])&&isFinite(dt[rt])&&!isNaN(dt[nt])&&isFinite(dt[nt])&&(at.push([dt[rt],dt[nt]]),ot.push(tt))}var ht=it(at);for(tt=0;tt<ht.length;++tt)for(var Dt=ht[tt],Ot=0;Ot<Dt.length;++Ot)Dt[Ot]=ot[Dt[Ot]];return{positions:Ne,cells:ht,meshColor:Ge}}function calculateErrorParams(Ne){for(var Ge=[0,0,0],Qe=[[0,0,0],[0,0,0],[0,0,0]],tt=[1,1,1],rt=0;rt<3;rt++){var nt=Ne[rt];nt&&!1!==nt.copy_zstyle&&!1!==Ne[2].visible&&(nt=Ne[2]),nt&&nt.visible&&(Ge[rt]=nt.width/2,Qe[rt]=dt(nt.color),tt[rt]=nt.thickness)}return{capSize:Ge,color:Qe,lineWidth:tt}}function parseAlignmentX(Ne){return null==Ne?0:Ne.indexOf("left")>-1?-1:Ne.indexOf("right")>-1?1:0}function parseAlignmentY(Ne){return null==Ne?0:Ne.indexOf("top")>-1?-1:Ne.indexOf("bottom")>-1?1:0}function calculateTextOffset(Ne){var Ge=0,Qe=0,tt=[Ge,Qe];if(Array.isArray(Ne))for(var rt=0;rt<Ne.length;rt++)tt[rt]=[Ge,Qe],Ne[rt]&&(tt[rt][0]=parseAlignmentX(Ne[rt]),tt[rt][1]=parseAlignmentY(Ne[rt]));else tt[0]=parseAlignmentX(Ne),tt[1]=parseAlignmentY(Ne);return tt}function calculateSize(Ne,Ge){return Ge(4*Ne)}function calculateSymbol(Ne){return Rt[Ne]}function formatParam(Ne,Ge,Qe,tt,rt){var nt=null;if(ot.isArrayOrTypedArray(Ne)){nt=[];for(var at=0;at<Ge;at++)void 0===Ne[at]?nt[at]=tt:nt[at]=Qe(Ne[at],rt)}else nt=Qe(Ne,ot.identity);return nt}function convertPlotlyOptions(Ne,Ge){var Qe,tt,rt,nt,at,it,Ot=[],Rt=Ne.fullSceneLayout,mr=Ne.dataScale,xr=Rt.xaxis,br=Rt.yaxis,Ar=Rt.zaxis,en=Ge.marker,mn=Ge.line,xn=Ge.x||[],kn=Ge.y||[],Cn=Ge.z||[],En=xn.length,Pn=Ge.xcalendar,Dn=Ge.ycalendar,In=Ge.zcalendar;for(at=0;at<En;at++)Qe=xr.d2l(xn[at],0,Pn)*mr[0],tt=br.d2l(kn[at],0,Dn)*mr[1],rt=Ar.d2l(Cn[at],0,In)*mr[2],Ot[at]=[Qe,tt,rt];if(Array.isArray(Ge.text))it=Ge.text;else if(void 0!==Ge.text)for(it=new Array(En),at=0;at<En;at++)it[at]=Ge.text;function formatter(Ne,Ge){var Qe=Rt[Ne];return Zt.tickText(Qe,Qe.d2l(Ge),!0).text}var zn=Ge.texttemplate;if(zn){var Bn=Ne.fullLayout._d3locale,Vn=Array.isArray(zn),Hn=Vn?Math.min(zn.length,En):En,qn=Vn?function(Ne){return zn[Ne]}:function(){return zn};for(it=new Array(Hn),at=0;at<Hn;at++){var Yn={x:xn[at],y:kn[at],z:Cn[at]},$n={xLabel:formatter("xaxis",xn[at]),yLabel:formatter("yaxis",kn[at]),zLabel:formatter("zaxis",Cn[at])},ra={};er(ra,Ge,at);var oa=Ge._meta||{};it[at]=ot.texttemplateString(qn(at),$n,Bn,ra,Yn,oa)}}if(nt={position:Ot,mode:Ge.mode,text:it},"line"in Ge&&(nt.lineColor=ht(mn,1,En),nt.lineWidth=mn.width,nt.lineDashes=mn.dash),"marker"in Ge){var pa=Dt(Ge);nt.scatterColor=ht(en,1,En),nt.scatterSize=formatParam(en.size,En,calculateSize,20,pa),nt.scatterMarker=formatParam(en.symbol,En,calculateSymbol,"â"),nt.scatterLineWidth=en.line.width,nt.scatterLineColor=ht(en.line,1,En),nt.scatterAngle=0}"textposition"in Ge&&(nt.textOffset=calculateTextOffset(Ge.textposition),nt.textColor=ht(Ge.textfont,1,En),nt.textSize=formatParam(Ge.textfont.size,En,ot.identity,12),nt.textFont=Ge.textfont.family,nt.textAngle=0);var ga=["x","y","z"];for(nt.project=[!1,!1,!1],nt.projectScale=[1,1,1],nt.projectOpacity=[1,1,1],at=0;at<3;++at){var ma=Ge.projection[ga[at]];(nt.project[at]=ma.show)&&(nt.projectOpacity[at]=ma.opacity,nt.projectScale[at]=ma.scale)}nt.errorBounds=dr(Ge,mr,Rt);var _a=calculateErrorParams([Ge.error_x,Ge.error_y,Ge.error_z]);return nt.errorColor=_a.color,nt.errorLineWidth=_a.lineWidth,nt.errorCapSize=_a.capSize,nt.delaunayAxis=Ge.surfaceaxis,nt.delaunayColor=dt(Ge.surfacecolor),nt}function _arrayToColor(Ne){if(ot.isArrayOrTypedArray(Ne)){var Ge=Ne[0];return ot.isArrayOrTypedArray(Ge)&&(Ne=Ge),"rgb("+Ne.slice(0,3).map((function(Ne){return Math.round(255*Ne)}))+")"}return null}function arrayToColor(Ne){return ot.isArrayOrTypedArray(Ne)?4===Ne.length&&"number"==typeof Ne[0]?_arrayToColor(Ne):Ne.map(_arrayToColor):null}function createLineWithMarkers(Ne,Ge){var Qe=new LineWithMarkers(Ne,Ge.uid);return Qe.update(Ge),Qe}mr.handlePick=function(Ne){if(Ne.object&&(Ne.object===this.linePlot||Ne.object===this.delaunayMesh||Ne.object===this.textMarkers||Ne.object===this.scatterPlot)){var Ge=Ne.index=Ne.data.index;return Ne.object.highlight&&Ne.object.highlight(null),this.scatterPlot&&(Ne.object=this.scatterPlot,this.scatterPlot.highlight(Ne.data)),Ne.textLabel="",this.textLabels&&(Array.isArray(this.textLabels)?(this.textLabels[Ge]||0===this.textLabels[Ge])&&(Ne.textLabel=this.textLabels[Ge]):Ne.textLabel=this.textLabels),Ne.traceCoordinate=[this.data.x[Ge],this.data.y[Ge],this.data.z[Ge]],!0}},mr.update=function(Ne){var Ge,Qe,it,ot,dt=this.scene.glplot.gl,ht=Ot.solid;this.data=Ne;var Dt=convertPlotlyOptions(this.scene,Ne);"mode"in Dt&&(this.mode=Dt.mode),"lineDashes"in Dt&&Dt.lineDashes in Ot&&(ht=Ot[Dt.lineDashes]),this.color=arrayToColor(Dt.scatterColor)||arrayToColor(Dt.lineColor),this.dataPoints=Dt.position,Ge={gl:this.scene.glplot.gl,position:Dt.position,color:Dt.lineColor,lineWidth:Dt.lineWidth||1,dashes:ht[0],dashScale:ht[1],opacity:Ne.opacity,connectGaps:Ne.connectgaps},-1!==this.mode.indexOf("lines")?this.linePlot?this.linePlot.update(Ge):(this.linePlot=tt(Ge),this.linePlot._trace=this,this.scene.glplot.add(this.linePlot)):this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose(),this.linePlot=null);var Rt=Ne.opacity;if(Ne.marker&&Ne.marker.opacity&&(Rt*=Ne.marker.opacity),Qe={gl:this.scene.glplot.gl,position:Dt.position,color:Dt.scatterColor,size:Dt.scatterSize,glyph:Dt.scatterMarker,opacity:Rt,orthographic:!0,lineWidth:Dt.scatterLineWidth,lineColor:Dt.scatterLineColor,project:Dt.project,projectScale:Dt.projectScale,projectOpacity:Dt.projectOpacity},-1!==this.mode.indexOf("markers")?this.scatterPlot?this.scatterPlot.update(Qe):(this.scatterPlot=rt(Qe),this.scatterPlot._trace=this,this.scatterPlot.highlightScale=1,this.scene.glplot.add(this.scatterPlot)):this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose(),this.scatterPlot=null),ot={gl:this.scene.glplot.gl,position:Dt.position,glyph:Dt.text,color:Dt.textColor,size:Dt.textSize,angle:Dt.textAngle,alignment:Dt.textOffset,font:Dt.textFont,orthographic:!0,lineWidth:0,project:!1,opacity:Ne.opacity},this.textLabels=Ne.hovertext||Ne.text,-1!==this.mode.indexOf("text")?this.textMarkers?this.textMarkers.update(ot):(this.textMarkers=rt(ot),this.textMarkers._trace=this,this.textMarkers.highlightScale=1,this.scene.glplot.add(this.textMarkers)):this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose(),this.textMarkers=null),it={gl:this.scene.glplot.gl,position:Dt.position,color:Dt.errorColor,error:Dt.errorBounds,lineWidth:Dt.errorLineWidth,capSize:Dt.errorCapSize,opacity:Ne.opacity},this.errorBars?Dt.errorBounds?this.errorBars.update(it):(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose(),this.errorBars=null):Dt.errorBounds&&(this.errorBars=nt(it),this.errorBars._trace=this,this.scene.glplot.add(this.errorBars)),Dt.delaunayAxis>=0){var Zt=constructDelaunay(Dt.position,Dt.delaunayColor,Dt.delaunayAxis);Zt.opacity=Ne.opacity,this.delaunayMesh?this.delaunayMesh.update(Zt):(Zt.gl=dt,this.delaunayMesh=at(Zt),this.delaunayMesh._trace=this,this.scene.glplot.add(this.delaunayMesh))}else this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose(),this.delaunayMesh=null)},mr.dispose=function(){this.linePlot&&(this.scene.glplot.remove(this.linePlot),this.linePlot.dispose()),this.scatterPlot&&(this.scene.glplot.remove(this.scatterPlot),this.scatterPlot.dispose()),this.errorBars&&(this.scene.glplot.remove(this.errorBars),this.errorBars.dispose()),this.textMarkers&&(this.scene.glplot.remove(this.textMarkers),this.textMarkers.dispose()),this.delaunayMesh&&(this.scene.glplot.remove(this.delaunayMesh),this.delaunayMesh.dispose())},Ge.exports=createLineWithMarkers},{"../../components/fx/helpers":679,"../../constants/gl3d_dashes":750,"../../constants/gl3d_markers":751,"../../lib":778,"../../lib/gl_format_color":774,"../../lib/str2rgbarray":802,"../../plots/cartesian/axes":828,"../scatter/make_bubble_size_func":1204,"./calc_errors":1217,"delaunay-triangulate":171,"gl-error3d":266,"gl-line3d":275,"gl-mesh3d":309,"gl-scatter3d":330}],1219:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../registry"),rt=Ne("../../lib"),nt=Ne("../scatter/subtypes"),at=Ne("../scatter/marker_defaults"),it=Ne("../scatter/line_defaults"),ot=Ne("../scatter/text_defaults"),dt=Ne("./attributes");function handleXYZDefaults(Ne,Ge,Qe,rt){var nt=0,at=Qe("x"),it=Qe("y"),ot=Qe("z");return tt.getComponentMethod("calendars","handleTraceDefaults")(Ne,Ge,["x","y","z"],rt),at&&it&&ot&&(nt=Math.min(at.length,it.length,ot.length),Ge._length=Ge._xlength=Ge._ylength=Ge._zlength=nt),nt}Ge.exports=function(Ne,Ge,Qe,ht){function coerce(Qe,tt){return rt.coerce(Ne,Ge,dt,Qe,tt)}if(handleXYZDefaults(Ne,Ge,coerce,ht)){coerce("text"),coerce("hovertext"),coerce("hovertemplate"),coerce("mode"),nt.hasLines(Ge)&&(coerce("connectgaps"),it(Ne,Ge,Qe,ht,coerce)),nt.hasMarkers(Ge)&&at(Ne,Ge,Qe,ht,coerce,{noSelect:!0}),nt.hasText(Ge)&&(coerce("texttemplate"),ot(Ne,Ge,ht,coerce,{noSelect:!0}));var Dt=(Ge.line||{}).color,Ot=(Ge.marker||{}).color;coerce("surfaceaxis")>=0&&coerce("surfacecolor",Dt||Ot);for(var Rt=["x","y","z"],Zt=0;Zt<3;++Zt){var er="projection."+Rt[Zt];coerce(er+".show")&&(coerce(er+".opacity"),coerce(er+".scale"))}var dr=tt.getComponentMethod("errorbars","supplyDefaults");dr(Ne,Ge,Dt||Ot||Qe,{axis:"z"}),dr(Ne,Ge,Dt||Ot||Qe,{axis:"y",inherit:"z"}),dr(Ne,Ge,Dt||Ot||Qe,{axis:"x",inherit:"z"})}else Ge.visible=!1}},{"../../lib":778,"../../registry":911,"../scatter/line_defaults":1200,"../scatter/marker_defaults":1206,"../scatter/subtypes":1212,"../scatter/text_defaults":1213,"./attributes":1215}],1220:[function(Ne,Ge,Qe){"use strict";Ge.exports={plot:Ne("./convert"),attributes:Ne("./attributes"),markerSymbols:Ne("../../constants/gl3d_markers"),supplyDefaults:Ne("./defaults"),colorbar:[{container:"marker",min:"cmin",max:"cmax"},{container:"line",min:"cmin",max:"cmax"}],calc:Ne("./calc"),moduleType:"trace",name:"scatter3d",basePlotModule:Ne("../../plots/gl3d"),categories:["gl3d","symbols","showLegend","scatter-like"],meta:{}}},{"../../constants/gl3d_markers":751,"../../plots/gl3d":870,"./attributes":1215,"./calc":1216,"./convert":1218,"./defaults":1219}],1221:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../scatter/attributes"),rt=Ne("../../plots/attributes"),nt=Ne("../../plots/template_attributes").hovertemplateAttrs,at=Ne("../../plots/template_attributes").texttemplateAttrs,it=Ne("../../components/colorscale/attributes"),ot=Ne("../../lib/extend").extendFlat,dt=tt.marker,ht=tt.line,Dt=dt.line;Ge.exports={carpet:{valType:"string",editType:"calc"},a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},mode:ot({},tt.mode,{dflt:"markers"}),text:ot({},tt.text,{}),texttemplate:at({editType:"plot"},{keys:["a","b","text"]}),hovertext:ot({},tt.hovertext,{}),line:{color:ht.color,width:ht.width,dash:ht.dash,shape:ot({},ht.shape,{values:["linear","spline"]}),smoothing:ht.smoothing,editType:"calc"},connectgaps:tt.connectgaps,fill:ot({},tt.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:tt.fillcolor,marker:ot({symbol:dt.symbol,opacity:dt.opacity,maxdisplayed:dt.maxdisplayed,size:dt.size,sizeref:dt.sizeref,sizemin:dt.sizemin,sizemode:dt.sizemode,line:ot({width:Dt.width,editType:"calc"},it("marker.line")),gradient:dt.gradient,editType:"calc"},it("marker")),textfont:tt.textfont,textposition:tt.textposition,selected:tt.selected,unselected:tt.unselected,hoverinfo:ot({},rt.hoverinfo,{flags:["a","b","text","name"]}),hoveron:tt.hoveron,hovertemplate:nt()}},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../scatter/attributes":1187}],1222:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../scatter/colorscale_calc"),nt=Ne("../scatter/arrays_to_calcdata"),at=Ne("../scatter/calc_selection"),it=Ne("../scatter/calc").calcMarkerSize,ot=Ne("../carpet/lookup_carpetid");Ge.exports=function(Ne,Ge){var Qe=Ge._carpetTrace=ot(Ne,Ge);if(Qe&&Qe.visible&&"legendonly"!==Qe.visible){var dt;Ge.xaxis=Qe.xaxis,Ge.yaxis=Qe.yaxis;var ht,Dt,Ot=Ge._length,Rt=new Array(Ot),Zt=!1;for(dt=0;dt<Ot;dt++)if(ht=Ge.a[dt],Dt=Ge.b[dt],tt(ht)&&tt(Dt)){var er=Qe.ab2xy(+ht,+Dt,!0),dr=Qe.isVisible(+ht,+Dt);dr||(Zt=!0),Rt[dt]={x:er[0],y:er[1],a:ht,b:Dt,vis:dr}}else Rt[dt]={x:!1,y:!1};return Ge._needsCull=Zt,Rt[0].carpet=Qe,Rt[0].trace=Ge,it(Ge,Ot),rt(Ne,Ge),nt(Rt,Ge),at(Rt,Ge),Rt}}},{"../carpet/lookup_carpetid":981,"../scatter/arrays_to_calcdata":1186,"../scatter/calc":1188,"../scatter/calc_selection":1189,"../scatter/colorscale_calc":1190,"fast-isnumeric":241}],1223:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../scatter/constants"),nt=Ne("../scatter/subtypes"),at=Ne("../scatter/marker_defaults"),it=Ne("../scatter/line_defaults"),ot=Ne("../scatter/line_shape_defaults"),dt=Ne("../scatter/text_defaults"),ht=Ne("../scatter/fillcolor_defaults"),Dt=Ne("./attributes");Ge.exports=function(Ne,Ge,Qe,Ot){function coerce(Qe,rt){return tt.coerce(Ne,Ge,Dt,Qe,rt)}coerce("carpet"),Ge.xaxis="x",Ge.yaxis="y";var Rt=coerce("a"),Zt=coerce("b"),er=Math.min(Rt.length,Zt.length);if(er){Ge._length=er,coerce("text"),coerce("texttemplate"),coerce("hovertext"),coerce("mode",er<rt.PTS_LINESONLY?"lines+markers":"lines"),nt.hasLines(Ge)&&(it(Ne,Ge,Qe,Ot,coerce),ot(Ne,Ge,coerce),coerce("connectgaps")),nt.hasMarkers(Ge)&&at(Ne,Ge,Qe,Ot,coerce,{gradient:!0}),nt.hasText(Ge)&&dt(Ne,Ge,Ot,coerce);var dr=[];(nt.hasMarkers(Ge)||nt.hasText(Ge))&&(coerce("marker.maxdisplayed"),dr.push("points")),coerce("fill"),"none"!==Ge.fill&&(ht(Ne,Ge,Qe,coerce),nt.hasLines(Ge)||ot(Ne,Ge,coerce)),"tonext"!==Ge.fill&&"toself"!==Ge.fill||dr.push("fills"),"fills"!==coerce("hoveron",dr.join("+")||"points")&&coerce("hovertemplate"),tt.coerceSelectionMarkerOpacity(Ge,coerce)}else Ge.visible=!1}},{"../../lib":778,"../scatter/constants":1191,"../scatter/fillcolor_defaults":1195,"../scatter/line_defaults":1200,"../scatter/line_shape_defaults":1202,"../scatter/marker_defaults":1206,"../scatter/subtypes":1212,"../scatter/text_defaults":1213,"./attributes":1221}],1224:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge,Qe,tt,rt){var nt=tt[rt];return Ne.a=nt.a,Ne.b=nt.b,Ne.y=nt.y,Ne}},{}],1225:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge){var Qe={},tt=Ge._carpet,rt=tt.ab2ij([Ne.a,Ne.b]),nt=Math.floor(rt[0]),at=rt[0]-nt,it=Math.floor(rt[1]),ot=rt[1]-it,dt=tt.evalxy([],nt,it,at,ot);return Qe.yLabel=dt[1].toFixed(3),Qe}},{}],1226:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../scatter/hover"),rt=Ne("../../lib").fillText;Ge.exports=function(Ne,Ge,Qe,nt){var at=tt(Ne,Ge,Qe,nt);if(at&&!1!==at[0].index){var it=at[0];if(void 0===it.index){var ot=1-it.y0/Ne.ya._length,dt=Ne.xa._length,ht=dt*ot/2,Dt=dt-ht;return it.x0=Math.max(Math.min(it.x0,Dt),ht),it.x1=Math.max(Math.min(it.x1,Dt),ht),at}var Ot=it.cd[it.index];it.a=Ot.a,it.b=Ot.b,it.xLabelVal=void 0,it.yLabelVal=void 0;var Rt=it.trace,Zt=Rt._carpet,er=Rt._module.formatLabels(Ot,Rt);it.yLabel=er.yLabel,delete it.text;var dr=[];if(!Rt.hovertemplate){var mr=(Ot.hi||Rt.hoverinfo).split("+");-1!==mr.indexOf("all")&&(mr=["a","b","text"]),-1!==mr.indexOf("a")&&textPart(Zt.aaxis,Ot.a),-1!==mr.indexOf("b")&&textPart(Zt.baxis,Ot.b),dr.push("y: "+it.yLabel),-1!==mr.indexOf("text")&&rt(Ot,Rt,dr),it.extraText=dr.join("<br>")}return at}function textPart(Ne,Ge){var Qe;Qe=Ne.labelprefix&&Ne.labelprefix.length>0?Ne.labelprefix.replace(/ = $/,""):Ne._hovertitle,dr.push(Qe+": "+Ge.toFixed(3)+Ne.labelsuffix)}}},{"../../lib":778,"../scatter/hover":1198}],1227:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),colorbar:Ne("../scatter/marker_colorbar"),formatLabels:Ne("./format_labels"),calc:Ne("./calc"),plot:Ne("./plot"),style:Ne("../scatter/style").style,styleOnSelect:Ne("../scatter/style").styleOnSelect,hoverPoints:Ne("./hover"),selectPoints:Ne("../scatter/select"),eventData:Ne("./event_data"),moduleType:"trace",name:"scattercarpet",basePlotModule:Ne("../../plots/cartesian"),categories:["svg","carpet","symbols","showLegend","carpetDependent","zoomScale"],meta:{}}},{"../../plots/cartesian":841,"../scatter/marker_colorbar":1205,"../scatter/select":1209,"../scatter/style":1211,"./attributes":1221,"./calc":1222,"./defaults":1223,"./event_data":1224,"./format_labels":1225,"./hover":1226,"./plot":1228}],1228:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../scatter/plot"),rt=Ne("../../plots/cartesian/axes"),nt=Ne("../../components/drawing");Ge.exports=function(Ne,Ge,Qe,at){var it,ot,dt,ht=Qe[0][0].carpet,Dt={xaxis:rt.getFromId(Ne,ht.xaxis||"x"),yaxis:rt.getFromId(Ne,ht.yaxis||"y"),plot:Ge.plot};for(tt(Ne,Dt,Qe,at),it=0;it<Qe.length;it++)ot=Qe[it][0].trace,dt=at.selectAll("g.trace"+ot.uid+" .js-line"),nt.setClipUrl(dt,Qe[it][0].carpet._clipPathId,Ne)}},{"../../components/drawing":665,"../../plots/cartesian/axes":828,"../scatter/plot":1208}],1229:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/template_attributes").hovertemplateAttrs,rt=Ne("../../plots/template_attributes").texttemplateAttrs,nt=Ne("../scatter/attributes"),at=Ne("../../plots/attributes"),it=Ne("../../components/colorscale/attributes"),ot=Ne("../../components/drawing/attributes").dash,dt=Ne("../../lib/extend").extendFlat,ht=Ne("../../plot_api/edit_types").overrideAll,Dt=nt.marker,Ot=nt.line,Rt=Dt.line;Ge.exports=ht({lon:{valType:"data_array"},lat:{valType:"data_array"},locations:{valType:"data_array"},locationmode:{valType:"enumerated",values:["ISO-3","USA-states","country names","geojson-id"],dflt:"ISO-3"},geojson:{valType:"any",editType:"calc"},featureidkey:{valType:"string",editType:"calc",dflt:"id"},mode:dt({},nt.mode,{dflt:"markers"}),text:dt({},nt.text,{}),texttemplate:rt({editType:"plot"},{keys:["lat","lon","location","text"]}),hovertext:dt({},nt.hovertext,{}),textfont:nt.textfont,textposition:nt.textposition,line:{color:Ot.color,width:Ot.width,dash:ot},connectgaps:nt.connectgaps,marker:dt({symbol:Dt.symbol,opacity:Dt.opacity,size:Dt.size,sizeref:Dt.sizeref,sizemin:Dt.sizemin,sizemode:Dt.sizemode,colorbar:Dt.colorbar,line:dt({width:Rt.width},it("marker.line")),gradient:Dt.gradient},it("marker")),fill:{valType:"enumerated",values:["none","toself"],dflt:"none"},fillcolor:nt.fillcolor,selected:nt.selected,unselected:nt.unselected,hoverinfo:dt({},at.hoverinfo,{flags:["lon","lat","location","text","name"]}),hovertemplate:tt()},"calc","nested")},{"../../components/colorscale/attributes":650,"../../components/drawing/attributes":664,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/attributes":824,"../../plots/template_attributes":906,"../scatter/attributes":1187}],1230:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../constants/numerical").BADNUM,nt=Ne("../scatter/colorscale_calc"),at=Ne("../scatter/arrays_to_calcdata"),it=Ne("../scatter/calc_selection"),ot=Ne("../../lib")._;function isNonBlankString(Ne){return Ne&&"string"==typeof Ne}Ge.exports=function(Ne,Ge){var Qe,dt=Array.isArray(Ge.locations),ht=dt?Ge.locations.length:Ge._length,Dt=new Array(ht);Qe=Ge.geojson?function(Ne){return isNonBlankString(Ne)||tt(Ne)}:isNonBlankString;for(var Ot=0;Ot<ht;Ot++){var Rt=Dt[Ot]={};if(dt){var Zt=Ge.locations[Ot];Rt.loc=Qe(Zt)?Zt:null}else{var er=Ge.lon[Ot],dr=Ge.lat[Ot];tt(er)&&tt(dr)?Rt.lonlat=[+er,+dr]:Rt.lonlat=[rt,rt]}}return at(Dt,Ge),nt(Ne,Ge),it(Dt,Ge),ht&&(Dt[0].t={labels:{lat:ot(Ne,"lat:")+" ",lon:ot(Ne,"lon:")+" "}}),Dt}},{"../../constants/numerical":753,"../../lib":778,"../scatter/arrays_to_calcdata":1186,"../scatter/calc_selection":1189,"../scatter/colorscale_calc":1190,"fast-isnumeric":241}],1231:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../scatter/subtypes"),nt=Ne("../scatter/marker_defaults"),at=Ne("../scatter/line_defaults"),it=Ne("../scatter/text_defaults"),ot=Ne("../scatter/fillcolor_defaults"),dt=Ne("./attributes");Ge.exports=function(Ne,Ge,Qe,ht){function coerce(Qe,rt){return tt.coerce(Ne,Ge,dt,Qe,rt)}var Dt,Ot=coerce("locations");if(Ot&&Ot.length){var Rt,Zt=coerce("geojson");("string"==typeof Zt&&""!==Zt||tt.isPlainObject(Zt))&&(Rt="geojson-id"),"geojson-id"===coerce("locationmode",Rt)&&coerce("featureidkey"),Dt=Ot.length}else{var er=coerce("lon")||[],dr=coerce("lat")||[];Dt=Math.min(er.length,dr.length)}Dt?(Ge._length=Dt,coerce("text"),coerce("hovertext"),coerce("hovertemplate"),coerce("mode"),rt.hasLines(Ge)&&(at(Ne,Ge,Qe,ht,coerce),coerce("connectgaps")),rt.hasMarkers(Ge)&&nt(Ne,Ge,Qe,ht,coerce,{gradient:!0}),rt.hasText(Ge)&&(coerce("texttemplate"),it(Ne,Ge,ht,coerce)),coerce("fill"),"none"!==Ge.fill&&ot(Ne,Ge,Qe,coerce),tt.coerceSelectionMarkerOpacity(Ge,coerce)):Ge.visible=!1}},{"../../lib":778,"../scatter/fillcolor_defaults":1195,"../scatter/line_defaults":1200,"../scatter/marker_defaults":1206,"../scatter/subtypes":1212,"../scatter/text_defaults":1213,"./attributes":1229}],1232:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge,Qe,tt,rt){Ne.lon=Ge.lon,Ne.lat=Ge.lat,Ne.location=Ge.loc?Ge.loc:null;var nt=tt[rt];return nt.fIn&&nt.fIn.properties&&(Ne.properties=nt.fIn.properties),Ne}},{}],1233:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/cartesian/axes");Ge.exports=function(Ne,Ge,Qe){var rt={},nt=Qe[Ge.geo]._subplot.mockAxis,at=Ne.lonlat;return rt.lonLabel=tt.tickText(nt,nt.c2l(at[0]),!0).text,rt.latLabel=tt.tickText(nt,nt.c2l(at[1]),!0).text,rt}},{"../../plots/cartesian/axes":828}],1234:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/fx"),rt=Ne("../../constants/numerical").BADNUM,nt=Ne("../scatter/get_trace_color"),at=Ne("../../lib").fillText,it=Ne("./attributes");function getExtraText(Ne,Ge,Qe,tt){if(!Ne.hovertemplate){var rt=Ge.hi||Ne.hoverinfo,nt="all"===rt?it.hoverinfo.flags:rt.split("+"),ot=-1!==nt.indexOf("location")&&Array.isArray(Ne.locations),dt=-1!==nt.indexOf("lon"),ht=-1!==nt.indexOf("lat"),Dt=-1!==nt.indexOf("text"),Ot=[];return ot?Ot.push(Ge.loc):dt&&ht?Ot.push("("+format(Qe.lonLabel)+", "+format(Qe.latLabel)+")"):dt?Ot.push(tt.lon+format(Qe.lonLabel)):ht&&Ot.push(tt.lat+format(Qe.latLabel)),Dt&&at(Ge,Ne,Ot),Ot.join("<br>")}function format(Ne){return Ne+"Â°"}}Ge.exports=function(Ne,Ge,Qe){var at=Ne.cd,it=at[0].trace,ot=Ne.xa,dt=Ne.ya,ht=Ne.subplot,Dt=ht.projection.isLonLatOverEdges,Ot=ht.project;function distFn(Ne){var tt=Ne.lonlat;if(tt[0]===rt)return 1/0;if(Dt(tt))return 1/0;var nt=Ot(tt),at=Ot([Ge,Qe]),it=Math.abs(nt[0]-at[0]),ot=Math.abs(nt[1]-at[1]),dt=Math.max(3,Ne.mrc||0);return Math.max(Math.sqrt(it*it+ot*ot)-dt,1-3/dt)}if(tt.getClosest(at,distFn,Ne),!1!==Ne.index){var Rt=at[Ne.index],Zt=Rt.lonlat,er=[ot.c2p(Zt),dt.c2p(Zt)],dr=Rt.mrc||1;Ne.x0=er[0]-dr,Ne.x1=er[0]+dr,Ne.y0=er[1]-dr,Ne.y1=er[1]+dr,Ne.loc=Rt.loc,Ne.lon=Zt[0],Ne.lat=Zt[1];var mr={};mr[it.geo]={_subplot:ht};var xr=it._module.formatLabels(Rt,it,mr);return Ne.lonLabel=xr.lonLabel,Ne.latLabel=xr.latLabel,Ne.color=nt(it,Rt),Ne.extraText=getExtraText(it,Rt,Ne,at[0].t.labels),Ne.hovertemplate=it.hovertemplate,[Ne]}}},{"../../components/fx":683,"../../constants/numerical":753,"../../lib":778,"../scatter/get_trace_color":1197,"./attributes":1229}],1235:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),colorbar:Ne("../scatter/marker_colorbar"),formatLabels:Ne("./format_labels"),calc:Ne("./calc"),calcGeoJSON:Ne("./plot").calcGeoJSON,plot:Ne("./plot").plot,style:Ne("./style"),styleOnSelect:Ne("../scatter/style").styleOnSelect,hoverPoints:Ne("./hover"),eventData:Ne("./event_data"),selectPoints:Ne("./select"),moduleType:"trace",name:"scattergeo",basePlotModule:Ne("../../plots/geo"),categories:["geo","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/geo":860,"../scatter/marker_colorbar":1205,"../scatter/style":1211,"./attributes":1229,"./calc":1230,"./defaults":1231,"./event_data":1232,"./format_labels":1233,"./hover":1234,"./plot":1236,"./select":1237,"./style":1238}],1236:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../lib"),nt=Ne("../../lib/topojson_utils").getTopojsonFeatures,at=Ne("../../lib/geojson_utils"),it=Ne("../../lib/geo_location_utils"),ot=Ne("../../plots/cartesian/autorange").findExtremes,dt=Ne("../../constants/numerical").BADNUM,ht=Ne("../scatter/calc").calcMarkerSize,Dt=Ne("../scatter/subtypes"),Ot=Ne("./style");function plot(Ne,Ge,Qe){var nt=Ge.layers.frontplot.select(".scatterlayer"),it=rt.makeTraceGroups(nt,Qe,"trace scattergeo");function removeBADNUM(Ne,Ge){Ne.lonlat[0]===dt&&tt.select(Ge).remove()}it.selectAll("*").remove(),it.each((function(Ge){var Qe=tt.select(this),nt=Ge[0].trace;if(Dt.hasLines(nt)||"none"!==nt.fill){var it=at.calcTraceToLineCoords(Ge),ot="none"!==nt.fill?at.makePolygon(it):at.makeLine(it);Qe.selectAll("path.js-line").data([{geojson:ot,trace:nt}]).enter().append("path").classed("js-line",!0).style("stroke-miterlimit",2)}Dt.hasMarkers(nt)&&Qe.selectAll("path.point").data(rt.identity).enter().append("path").classed("point",!0).each((function(Ne){removeBADNUM(Ne,this)})),Dt.hasText(nt)&&Qe.selectAll("g").data(rt.identity).enter().append("g").append("text").each((function(Ne){removeBADNUM(Ne,this)})),Ot(Ne,Ge)}))}function calcGeoJSON(Ne,Ge){var Qe,tt,rt=Ne[0].trace,at=Ge[rt.geo],Dt=at._subplot,Ot=rt._length;if(Array.isArray(rt.locations)){var Rt=rt.locationmode,Zt="geojson-id"===Rt?it.extractTraceFeature(Ne):nt(rt,Dt.topojson);for(Qe=0;Qe<Ot;Qe++){tt=Ne[Qe];var er="geojson-id"===Rt?tt.fOut:it.locationToFeature(Rt,tt.loc,Zt);tt.lonlat=er?er.properties.ct:[dt,dt]}}var dr,mr,xr={padded:!0};if("geojson"===at.fitbounds&&"geojson-id"===rt.locationmode){var br=it.computeBbox(it.getTraceGeojson(rt));dr=[br[0],br[2]],mr=[br[1],br[3]]}else{for(dr=new Array(Ot),mr=new Array(Ot),Qe=0;Qe<Ot;Qe++)tt=Ne[Qe],dr[Qe]=tt.lonlat[0],mr[Qe]=tt.lonlat[1];xr.ppad=ht(rt,Ot)}rt._extremes.lon=ot(at.lonaxis._ax,dr,xr),rt._extremes.lat=ot(at.lataxis._ax,mr,xr)}Ge.exports={calcGeoJSON:calcGeoJSON,plot:plot}},{"../../constants/numerical":753,"../../lib":778,"../../lib/geo_location_utils":771,"../../lib/geojson_utils":772,"../../lib/topojson_utils":806,"../../plots/cartesian/autorange":827,"../scatter/calc":1188,"../scatter/subtypes":1212,"./style":1238,d3:169}],1237:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../scatter/subtypes"),rt=Ne("../../constants/numerical").BADNUM;Ge.exports=function(Ne,Ge){var Qe,nt,at,it,ot,dt=Ne.cd,ht=Ne.xaxis,Dt=Ne.yaxis,Ot=[],Rt=dt[0].trace;if(!tt.hasMarkers(Rt)&&!tt.hasText(Rt))return[];if(!1===Ge)for(ot=0;ot<dt.length;ot++)dt[ot].selected=0;else for(ot=0;ot<dt.length;ot++)(nt=(Qe=dt[ot]).lonlat)[0]!==rt&&(at=ht.c2p(nt),it=Dt.c2p(nt),Ge.contains([at,it],null,ot,Ne)?(Ot.push({pointNumber:ot,lon:nt[0],lat:nt[1]}),Qe.selected=1):Qe.selected=0);return Ot}},{"../../constants/numerical":753,"../scatter/subtypes":1212}],1238:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../components/drawing"),nt=Ne("../../components/color"),at=Ne("../scatter/style"),it=at.stylePoints,ot=at.styleText;function styleTrace(Ne,Ge){var Qe=Ge[0].trace,at=Ge[0].node3;at.style("opacity",Ge[0].trace.opacity),it(at,Qe,Ne),ot(at,Qe,Ne),at.selectAll("path.js-line").style("fill","none").each((function(Ne){var Ge=tt.select(this),Qe=Ne.trace,at=Qe.line||{};Ge.call(nt.stroke,at.color).call(rt.dashLine,at.dash||"",at.width||0),"none"!==Qe.fill&&Ge.call(nt.fill,Qe.fillcolor)}))}Ge.exports=function(Ne,Ge){Ge&&styleTrace(Ne,Ge)}},{"../../components/color":643,"../../components/drawing":665,"../scatter/style":1211,d3:169}],1239:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/attributes"),rt=Ne("../scatter/attributes"),nt=Ne("../../components/colorscale/attributes"),at=Ne("../../lib/extend").extendFlat,it=Ne("../../plot_api/edit_types").overrideAll,ot=Ne("./constants").DASHES,dt=rt.line,ht=rt.marker,Dt=ht.line,Ot=Ge.exports=it({x:rt.x,x0:rt.x0,dx:rt.dx,y:rt.y,y0:rt.y0,dy:rt.dy,xperiod:rt.xperiod,yperiod:rt.yperiod,xperiod0:rt.xperiod0,yperiod0:rt.yperiod0,xperiodalignment:rt.xperiodalignment,yperiodalignment:rt.yperiodalignment,text:rt.text,hovertext:rt.hovertext,textposition:rt.textposition,textfont:rt.textfont,mode:{valType:"flaglist",flags:["lines","markers","text"],extras:["none"]},line:{color:dt.color,width:dt.width,shape:{valType:"enumerated",values:["linear","hv","vh","hvh","vhv"],dflt:"linear",editType:"plot"},dash:{valType:"enumerated",values:Object.keys(ot),dflt:"solid"}},marker:at({},nt("marker"),{symbol:ht.symbol,size:ht.size,sizeref:ht.sizeref,sizemin:ht.sizemin,sizemode:ht.sizemode,opacity:ht.opacity,colorbar:ht.colorbar,line:at({},nt("marker.line"),{width:Dt.width})}),connectgaps:rt.connectgaps,fill:at({},rt.fill,{dflt:"none"}),fillcolor:rt.fillcolor,selected:{marker:rt.selected.marker,textfont:rt.selected.textfont},unselected:{marker:rt.unselected.marker,textfont:rt.unselected.textfont},opacity:tt.opacity},"calc","nested");Ot.x.editType=Ot.y.editType=Ot.x0.editType=Ot.y0.editType="calc+clearAxisTypes",Ot.hovertemplate=rt.hovertemplate,Ot.texttemplate=rt.texttemplate},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/attributes":824,"../scatter/attributes":1187,"./constants":1241}],1240:[function(Ne,Ge,Qe){"use strict";var tt=Ne("@plotly/point-cluster"),rt=Ne("../../lib"),nt=Ne("../../plots/cartesian/axis_ids"),at=Ne("../../plots/cartesian/autorange").findExtremes,it=Ne("../../plots/cartesian/align_period"),ot=Ne("../scatter/calc"),dt=ot.calcMarkerSize,ht=ot.calcAxisExpansion,Dt=ot.setFirstScatter,Ot=Ne("../scatter/colorscale_calc"),Rt=Ne("./convert"),Zt=Ne("./scene_update"),er=Ne("../../constants/numerical").BADNUM,dr=Ne("./constants").TOO_MANY_POINTS;function expandForErrorBars(Ne,Ge,Qe){var tt=Ne._extremes[Ge._id],rt=at(Ge,Qe._bnds,{padded:!0});tt.min=tt.min.concat(rt.min),tt.max=tt.max.concat(rt.max)}function sceneOptions(Ne,Ge,Qe,tt,nt,at){var it=Rt.style(Ne,Qe);if(it.marker&&(it.marker.positions=tt),it.line&&tt.length>1&&rt.extendFlat(it.line,Rt.linePositions(Ne,Qe,tt)),it.errorX||it.errorY){var ot=Rt.errorBarPositions(Ne,Qe,tt,nt,at);it.errorX&&rt.extendFlat(it.errorX,ot.x),it.errorY&&rt.extendFlat(it.errorY,ot.y)}return it.text&&(rt.extendFlat(it.text,{positions:tt},Rt.textPosition(Ne,Qe,it.text,it.marker)),rt.extendFlat(it.textSel,{positions:tt},Rt.textPosition(Ne,Qe,it.text,it.markerSel)),rt.extendFlat(it.textUnsel,{positions:tt},Rt.textPosition(Ne,Qe,it.text,it.markerUnsel))),it}Ge.exports=function(Ne,Ge){var Qe,rt,at,ot=Ne._fullLayout,Rt=nt.getFromId(Ne,Ge.xaxis),mr=nt.getFromId(Ne,Ge.yaxis),xr=ot._plots[Ge.xaxis+Ge.yaxis],br=Ge._length,Ar=br>=dr,en=2*br,mn={},xn=Rt.makeCalcdata(Ge,"x"),kn=mr.makeCalcdata(Ge,"y"),Cn=it(Ge,Rt,"x",xn),En=it(Ge,mr,"y",kn);Ge._x=Cn,Ge._y=En,Ge.xperiodalignment&&(Ge._origX=xn),Ge.yperiodalignment&&(Ge._origY=kn);var Pn=new Array(en);for(Qe=0;Qe<br;Qe++)rt=Cn[Qe],at=En[Qe],Pn[2*Qe]=rt===er?NaN:rt,Pn[2*Qe+1]=at===er?NaN:at;if("log"===Rt.type)for(Qe=0;Qe<en;Qe+=2)Pn[Qe]=Rt.c2l(Pn[Qe]);if("log"===mr.type)for(Qe=1;Qe<en;Qe+=2)Pn[Qe]=mr.c2l(Pn[Qe]);if(Ar&&"log"!==Rt.type&&"log"!==mr.type)mn.tree=tt(Pn);else{var Dn=mn.ids=new Array(br);for(Qe=0;Qe<br;Qe++)Dn[Qe]=Qe}Ot(Ne,Ge);var In,zn=sceneOptions(Ne,xr,Ge,Pn,Cn,En),Bn=Zt(Ne,xr);return Dt(ot,Ge),Ar?zn.marker&&(In=2*(zn.marker.sizeAvg||Math.max(zn.marker.size,3))):In=dt(Ge,br),ht(Ne,Ge,Rt,mr,Cn,En,In),zn.errorX&&expandForErrorBars(Ge,Rt,zn.errorX),zn.errorY&&expandForErrorBars(Ge,mr,zn.errorY),zn.fill&&!Bn.fill2d&&(Bn.fill2d=!0),zn.marker&&!Bn.scatter2d&&(Bn.scatter2d=!0),zn.line&&!Bn.line2d&&(Bn.line2d=!0),!zn.errorX&&!zn.errorY||Bn.error2d||(Bn.error2d=!0),zn.text&&!Bn.glText&&(Bn.glText=!0),zn.marker&&(zn.marker.snap=br),Bn.lineOptions.push(zn.line),Bn.errorXOptions.push(zn.errorX),Bn.errorYOptions.push(zn.errorY),Bn.fillOptions.push(zn.fill),Bn.markerOptions.push(zn.marker),Bn.markerSelectedOptions.push(zn.markerSel),Bn.markerUnselectedOptions.push(zn.markerUnsel),Bn.textOptions.push(zn.text),Bn.textSelectedOptions.push(zn.textSel),Bn.textUnselectedOptions.push(zn.textUnsel),Bn.selectBatch.push([]),Bn.unselectBatch.push([]),mn._scene=Bn,mn.index=Bn.count,mn.x=Cn,mn.y=En,mn.positions=Pn,Bn.count++,[{x:!1,y:!1,t:mn,trace:Ge}]}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/align_period":825,"../../plots/cartesian/autorange":827,"../../plots/cartesian/axis_ids":831,"../scatter/calc":1188,"../scatter/colorscale_calc":1190,"./constants":1241,"./convert":1242,"./scene_update":1250,"@plotly/point-cluster":57}],1241:[function(Ne,Ge,Qe){"use strict";var tt=20;Ge.exports={TOO_MANY_POINTS:1e5,SYMBOL_SDF_SIZE:200,SYMBOL_SIZE:tt,SYMBOL_STROKE:tt/20,DOT_RE:/-dot/,OPEN_RE:/-open/,DASHES:{solid:[1],dot:[1,1],dash:[4,1],longdash:[8,1],dashdot:[4,1,1,1],longdashdot:[8,1,1,1]}}},{}],1242:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("svg-path-sdf"),nt=Ne("color-normalize"),at=Ne("../../registry"),it=Ne("../../lib"),ot=Ne("../../components/drawing"),dt=Ne("../../plots/cartesian/axis_ids"),ht=Ne("../../lib/gl_format_color").formatColor,Dt=Ne("../scatter/subtypes"),Ot=Ne("../scatter/make_bubble_size_func"),Rt=Ne("./helpers"),Zt=Ne("./constants"),er=Ne("../../constants/interactions").DESELECTDIM,dr={start:1,left:1,end:-1,right:-1,middle:0,center:0,bottom:1,top:-1},mr=Ne("../../components/fx/helpers").appendArrayPointValue;function convertStyle(Ne,Ge){var Qe,tt={marker:void 0,markerSel:void 0,markerUnsel:void 0,line:void 0,fill:void 0,errorX:void 0,errorY:void 0,text:void 0,textSel:void 0,textUnsel:void 0};if(!0!==Ge.visible)return tt;if(Dt.hasText(Ge)&&(tt.text=convertTextStyle(Ne,Ge),tt.textSel=convertTextSelection(Ne,Ge,Ge.selected),tt.textUnsel=convertTextSelection(Ne,Ge,Ge.unselected)),Dt.hasMarkers(Ge)&&(tt.marker=convertMarkerStyle(Ge),tt.markerSel=convertMarkerSelection(Ge,Ge.selected),tt.markerUnsel=convertMarkerSelection(Ge,Ge.unselected),!Ge.unselected&&it.isArrayOrTypedArray(Ge.marker.opacity))){var rt=Ge.marker.opacity;for(tt.markerUnsel.opacity=new Array(rt.length),Qe=0;Qe<rt.length;Qe++)tt.markerUnsel.opacity[Qe]=er*rt[Qe]}if(Dt.hasLines(Ge)){tt.line={overlay:!0,thickness:Ge.line.width,color:Ge.line.color,opacity:Ge.opacity};var nt=(Zt.DASHES[Ge.line.dash]||[1]).slice();for(Qe=0;Qe<nt.length;++Qe)nt[Qe]*=Ge.line.width;tt.line.dashes=nt}return Ge.error_x&&Ge.error_x.visible&&(tt.errorX=convertErrorBarStyle(Ge,Ge.error_x)),Ge.error_y&&Ge.error_y.visible&&(tt.errorY=convertErrorBarStyle(Ge,Ge.error_y)),Ge.fill&&"none"!==Ge.fill&&(tt.fill={closed:!0,fill:Ge.fillcolor,thickness:0}),tt}function convertTextStyle(Ne,Ge){var Qe,rt=Ne._fullLayout,nt=Ge._length,at=Ge.textfont,ot=Ge.textposition,dt=Array.isArray(ot)?ot:[ot],ht=at.color,Dt=at.size,Ot=at.family,Rt={},Zt=Ge.texttemplate;if(Zt){Rt.text=[];var er=rt._d3locale,dr=Array.isArray(Zt),xr=dr?Math.min(Zt.length,nt):nt,br=dr?function(Ne){return Zt[Ne]}:function(){return Zt};for(Qe=0;Qe<xr;Qe++){var Ar={i:Qe},en=Ge._module.formatLabels(Ar,Ge,rt),mn={};mr(mn,Ge,Qe);var xn=Ge._meta||{};Rt.text.push(it.texttemplateString(br(Qe),en,er,mn,Ar,xn))}}else Array.isArray(Ge.text)&&Ge.text.length<nt?Rt.text=Ge.text.slice():Rt.text=Ge.text;if(Array.isArray(Rt.text))for(Qe=Rt.text.length;Qe<nt;Qe++)Rt.text[Qe]="";for(Rt.opacity=Ge.opacity,Rt.font={},Rt.align=[],Rt.baseline=[],Qe=0;Qe<dt.length;Qe++){var kn=dt[Qe].split(/\s+/);switch(kn[1]){case"left":Rt.align.push("right");break;case"right":Rt.align.push("left");break;default:Rt.align.push(kn[1])}switch(kn[0]){case"top":Rt.baseline.push("bottom");break;case"bottom":Rt.baseline.push("top");break;default:Rt.baseline.push(kn[0])}}if(Array.isArray(ht))for(Rt.color=new Array(nt),Qe=0;Qe<nt;Qe++)Rt.color[Qe]=ht[Qe];else Rt.color=ht;if(it.isArrayOrTypedArray(Dt)||Array.isArray(Ot))for(Rt.font=new Array(nt),Qe=0;Qe<nt;Qe++){var Cn=Rt.font[Qe]={};Cn.size=it.isTypedArray(Dt)?Dt[Qe]:Array.isArray(Dt)?tt(Dt[Qe])?Dt[Qe]:0:Dt,Cn.family=Array.isArray(Ot)?Ot[Qe]:Ot}else Rt.font={size:Dt,family:Ot};return Rt}function convertMarkerStyle(Ne){var Ge,Qe,tt=Ne._length,rt=Ne.marker,at={},ot=it.isArrayOrTypedArray(rt.symbol),dt=it.isArrayOrTypedArray(rt.color),Dt=it.isArrayOrTypedArray(rt.line.color),Zt=it.isArrayOrTypedArray(rt.opacity),er=it.isArrayOrTypedArray(rt.size),dr=it.isArrayOrTypedArray(rt.line.width);if(ot||(Qe=Rt.isOpenSymbol(rt.symbol)),ot||dt||Dt||Zt){at.colors=new Array(tt),at.borderColors=new Array(tt);var mr=ht(rt,rt.opacity,tt),xr=ht(rt.line,rt.opacity,tt);if(!Array.isArray(xr[0])){var br=xr;for(xr=Array(tt),Ge=0;Ge<tt;Ge++)xr[Ge]=br}if(!Array.isArray(mr[0])){var Ar=mr;for(mr=Array(tt),Ge=0;Ge<tt;Ge++)mr[Ge]=Ar}for(at.colors=mr,at.borderColors=xr,Ge=0;Ge<tt;Ge++){if(ot){var en=rt.symbol[Ge];Qe=Rt.isOpenSymbol(en)}Qe&&(xr[Ge]=mr[Ge].slice(),mr[Ge]=mr[Ge].slice(),mr[Ge][3]=0)}at.opacity=Ne.opacity}else Qe?(at.color=nt(rt.color,"uint8"),at.color[3]=0,at.borderColor=nt(rt.color,"uint8")):(at.color=nt(rt.color,"uint8"),at.borderColor=nt(rt.line.color,"uint8")),at.opacity=Ne.opacity*rt.opacity;if(ot)for(at.markers=new Array(tt),Ge=0;Ge<tt;Ge++)at.markers[Ge]=getSymbolSdf(rt.symbol[Ge]);else at.marker=getSymbolSdf(rt.symbol);var mn,xn=Ot(Ne);if(er||dr){var kn,Cn=at.sizes=new Array(tt),En=at.borderSizes=new Array(tt),Pn=0;if(er){for(Ge=0;Ge<tt;Ge++)Cn[Ge]=xn(rt.size[Ge]),Pn+=Cn[Ge];kn=Pn/tt}else for(mn=xn(rt.size),Ge=0;Ge<tt;Ge++)Cn[Ge]=mn;if(dr)for(Ge=0;Ge<tt;Ge++)En[Ge]=rt.line.width[Ge]/2;else for(mn=rt.line.width/2,Ge=0;Ge<tt;Ge++)En[Ge]=mn;at.sizeAvg=kn}else at.size=xn(rt&&rt.size||10),at.borderSizes=xn(rt.line.width);return at}function convertMarkerSelection(Ne,Ge){var Qe=Ne.marker,tt={};return Ge?(Ge.marker&&Ge.marker.symbol?tt=convertMarkerStyle(it.extendFlat({},Qe,Ge.marker)):Ge.marker&&(Ge.marker.size&&(tt.size=Ge.marker.size/2),Ge.marker.color&&(tt.colors=Ge.marker.color),void 0!==Ge.marker.opacity&&(tt.opacity=Ge.marker.opacity)),tt):tt}function convertTextSelection(Ne,Ge,Qe){var tt={};if(!Qe)return tt;if(Qe.textfont){var rt={opacity:1,text:Ge.text,texttemplate:Ge.texttemplate,textposition:Ge.textposition,textfont:it.extendFlat({},Ge.textfont)};Qe.textfont&&it.extendFlat(rt.textfont,Qe.textfont),tt=convertTextStyle(Ne,rt)}return tt}function convertErrorBarStyle(Ne,Ge){var Qe={capSize:2*Ge.width,lineWidth:Ge.thickness,color:Ge.color};return Ge.copy_ystyle&&(Qe=Ne.error_y),Qe}var xr=Zt.SYMBOL_SDF_SIZE,br=Zt.SYMBOL_SIZE,Ar=Zt.SYMBOL_STROKE,en={},mn=ot.symbolFuncs[0](.05*br);function getSymbolSdf(Ne){if("circle"===Ne)return null;var Ge,Qe,tt=ot.symbolNumber(Ne),nt=ot.symbolFuncs[tt%100],at=!!ot.symbolNoDot[tt%100],it=!!ot.symbolNoFill[tt%100],dt=Rt.isDotSymbol(Ne);return en[Ne]?en[Ne]:(Ge=dt&&!at?nt(1.1*br)+mn:nt(br),Qe=rt(Ge,{w:xr,h:xr,viewBox:[-br,-br,br,br],stroke:it?Ar:-Ar}),en[Ne]=Qe,Qe||null)}function convertLinePositions(Ne,Ge,Qe){var tt,rt,nt=Qe.length,at=nt/2;if(Dt.hasLines(Ge)&&at)if("hv"===Ge.line.shape){for(tt=[],rt=0;rt<at-1;rt++)isNaN(Qe[2*rt])||isNaN(Qe[2*rt+1])?tt.push(NaN,NaN,NaN,NaN):(tt.push(Qe[2*rt],Qe[2*rt+1]),isNaN(Qe[2*rt+2])||isNaN(Qe[2*rt+3])?tt.push(NaN,NaN):tt.push(Qe[2*rt+2],Qe[2*rt+1]));tt.push(Qe[nt-2],Qe[nt-1])}else if("hvh"===Ge.line.shape){for(tt=[],rt=0;rt<at-1;rt++)if(isNaN(Qe[2*rt])||isNaN(Qe[2*rt+1])||isNaN(Qe[2*rt+2])||isNaN(Qe[2*rt+3]))isNaN(Qe[2*rt])||isNaN(Qe[2*rt+1])?tt.push(NaN,NaN):tt.push(Qe[2*rt],Qe[2*rt+1]),tt.push(NaN,NaN);else{var it=(Qe[2*rt]+Qe[2*rt+2])/2;tt.push(Qe[2*rt],Qe[2*rt+1],it,Qe[2*rt+1],it,Qe[2*rt+3])}tt.push(Qe[nt-2],Qe[nt-1])}else if("vhv"===Ge.line.shape){for(tt=[],rt=0;rt<at-1;rt++)if(isNaN(Qe[2*rt])||isNaN(Qe[2*rt+1])||isNaN(Qe[2*rt+2])||isNaN(Qe[2*rt+3]))isNaN(Qe[2*rt])||isNaN(Qe[2*rt+1])?tt.push(NaN,NaN):tt.push(Qe[2*rt],Qe[2*rt+1]),tt.push(NaN,NaN);else{var ot=(Qe[2*rt+1]+Qe[2*rt+3])/2;tt.push(Qe[2*rt],Qe[2*rt+1],Qe[2*rt],ot,Qe[2*rt+2],ot)}tt.push(Qe[nt-2],Qe[nt-1])}else if("vh"===Ge.line.shape){for(tt=[],rt=0;rt<at-1;rt++)isNaN(Qe[2*rt])||isNaN(Qe[2*rt+1])?tt.push(NaN,NaN,NaN,NaN):(tt.push(Qe[2*rt],Qe[2*rt+1]),isNaN(Qe[2*rt+2])||isNaN(Qe[2*rt+3])?tt.push(NaN,NaN):tt.push(Qe[2*rt],Qe[2*rt+3]));tt.push(Qe[nt-2],Qe[nt-1])}else tt=Qe;var dt=!1;for(rt=0;rt<tt.length;rt++)if(isNaN(tt[rt])){dt=!0;break}var ht=dt||tt.length>Zt.TOO_MANY_POINTS||Dt.hasMarkers(Ge)?"rect":"round";if(dt&&Ge.connectgaps){var Ot=tt[0],Rt=tt[1];for(rt=0;rt<tt.length;rt+=2)isNaN(tt[rt])||isNaN(tt[rt+1])?(tt[rt]=Ot,tt[rt+1]=Rt):(Ot=tt[rt],Rt=tt[rt+1])}return{join:ht,positions:tt}}function convertErrorBarPositions(Ne,Ge,Qe,rt,nt){var it=at.getComponentMethod("errorbars","makeComputeError"),ot=dt.getFromId(Ne,Ge.xaxis),ht=dt.getFromId(Ne,Ge.yaxis),Dt=Qe.length/2,Ot={};function convertOneAxis(Ne,rt){var nt=rt._id.charAt(0),at=Ge["error_"+nt];if(at&&at.visible&&("linear"===rt.type||"log"===rt.type)){for(var ot=it(at),dt={x:0,y:1}[nt],ht={x:[0,1,2,3],y:[2,3,0,1]}[nt],Rt=new Float64Array(4*Dt),Zt=1/0,er=-1/0,dr=0,mr=0;dr<Dt;dr++,mr+=4){var xr=Ne[dr];if(tt(xr)){var br=Qe[2*dr+dt],Ar=ot(xr,dr),en=Ar[0],mn=Ar[1];if(tt(en)&&tt(mn)){var xn=xr-en,kn=xr+mn;Rt[mr+ht[0]]=br-rt.c2l(xn),Rt[mr+ht[1]]=rt.c2l(kn)-br,Rt[mr+ht[2]]=0,Rt[mr+ht[3]]=0,Zt=Math.min(Zt,xr-en),er=Math.max(er,xr+mn)}}}Ot[nt]={positions:Qe,errors:Rt,_bnds:[Zt,er]}}}return convertOneAxis(rt,ot),convertOneAxis(nt,ht),Ot}function convertTextPosition(Ne,Ge,Qe,tt){var rt,nt=Ge._length,at={};if(Dt.hasMarkers(Ge)){var it=Qe.font,ot=Qe.align,dt=Qe.baseline;for(at.offset=new Array(nt),rt=0;rt<nt;rt++){var ht=tt.sizes?tt.sizes[rt]:tt.size,Ot=Array.isArray(it)?it[rt].size:it.size,Rt=Array.isArray(ot)?ot.length>1?ot[rt]:ot[0]:ot,Zt=Array.isArray(dt)?dt.length>1?dt[rt]:dt[0]:dt,er=dr[Rt],mr=dr[Zt],xr=ht?ht/.8+1:0,br=-mr*xr-.5*mr;at.offset[rt]=[er*xr/Ot,br/Ot]}}return at}Ge.exports={style:convertStyle,markerStyle:convertMarkerStyle,markerSelection:convertMarkerSelection,linePositions:convertLinePositions,errorBarPositions:convertErrorBarPositions,textPosition:convertTextPosition}},{"../../components/drawing":665,"../../components/fx/helpers":679,"../../constants/interactions":752,"../../lib":778,"../../lib/gl_format_color":774,"../../plots/cartesian/axis_ids":831,"../../registry":911,"../scatter/make_bubble_size_func":1204,"../scatter/subtypes":1212,"./constants":1241,"./helpers":1246,"color-normalize":125,"fast-isnumeric":241,"svg-path-sdf":574}],1243:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../registry"),nt=Ne("./helpers"),at=Ne("./attributes"),it=Ne("../scatter/constants"),ot=Ne("../scatter/subtypes"),dt=Ne("../scatter/xy_defaults"),ht=Ne("../scatter/period_defaults"),Dt=Ne("../scatter/marker_defaults"),Ot=Ne("../scatter/line_defaults"),Rt=Ne("../scatter/fillcolor_defaults"),Zt=Ne("../scatter/text_defaults");Ge.exports=function(Ne,Ge,Qe,er){function coerce(Qe,rt){return tt.coerce(Ne,Ge,at,Qe,rt)}var dr=!!Ne.marker&&nt.isOpenSymbol(Ne.marker.symbol),mr=ot.isBubble(Ne),xr=dt(Ne,Ge,er,coerce);if(xr){ht(Ne,Ge,er,coerce);var br=xr<it.PTS_LINESONLY?"lines+markers":"lines";coerce("text"),coerce("hovertext"),coerce("hovertemplate"),coerce("mode",br),ot.hasLines(Ge)&&(coerce("connectgaps"),Ot(Ne,Ge,Qe,er,coerce),coerce("line.shape")),ot.hasMarkers(Ge)&&(Dt(Ne,Ge,Qe,er,coerce),coerce("marker.line.width",dr||mr?1:0)),ot.hasText(Ge)&&(coerce("texttemplate"),Zt(Ne,Ge,er,coerce));var Ar=(Ge.line||{}).color,en=(Ge.marker||{}).color;coerce("fill"),"none"!==Ge.fill&&Rt(Ne,Ge,Qe,coerce);var mn=rt.getComponentMethod("errorbars","supplyDefaults");mn(Ne,Ge,Ar||en||Qe,{axis:"y"}),mn(Ne,Ge,Ar||en||Qe,{axis:"x",inherit:"y"}),tt.coerceSelectionMarkerOpacity(Ge,coerce)}else Ge.visible=!1}},{"../../lib":778,"../../registry":911,"../scatter/constants":1191,"../scatter/fillcolor_defaults":1195,"../scatter/line_defaults":1200,"../scatter/marker_defaults":1206,"../scatter/period_defaults":1207,"../scatter/subtypes":1212,"../scatter/text_defaults":1213,"../scatter/xy_defaults":1214,"./attributes":1239,"./helpers":1246}],1244:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../components/color"),nt=Ne("../../constants/interactions").DESELECTDIM;function styleTextSelection(Ne){var Ge,Qe,at=Ne[0],it=at.trace,ot=at.t,dt=ot._scene,ht=ot.index,Dt=dt.selectBatch[ht],Ot=dt.unselectBatch[ht],Rt=dt.textOptions[ht],Zt=dt.textSelectedOptions[ht]||{},er=dt.textUnselectedOptions[ht]||{},dr=tt.extendFlat({},Rt);if(Dt.length||Ot.length){var mr=Zt.color,xr=er.color,br=Rt.color,Ar=Array.isArray(br);for(dr.color=new Array(it._length),Ge=0;Ge<Dt.length;Ge++)Qe=Dt[Ge],dr.color[Qe]=mr||(Ar?br[Qe]:br);for(Ge=0;Ge<Ot.length;Ge++){Qe=Ot[Ge];var en=Ar?br[Qe]:br;dr.color[Qe]=xr||(mr?en:rt.addOpacity(en,nt))}}dt.glText[ht].update(dr)}Ge.exports={styleTextSelection:styleTextSelection}},{"../../components/color":643,"../../constants/interactions":752,"../../lib":778}],1245:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../scatter/format_labels");Ge.exports=function(Ne,Ge,Qe){var rt=Ne.i;return"x"in Ne||(Ne.x=Ge._x[rt]),"y"in Ne||(Ne.y=Ge._y[rt]),tt(Ne,Ge,Qe)}},{"../scatter/format_labels":1196}],1246:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./constants");Qe.isOpenSymbol=function(Ne){return"string"==typeof Ne?tt.OPEN_RE.test(Ne):Ne%200>100},Qe.isDotSymbol=function(Ne){return"string"==typeof Ne?tt.DOT_RE.test(Ne):Ne>200}},{"./constants":1241}],1247:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../registry"),rt=Ne("../../lib"),nt=Ne("../scatter/get_trace_color");function hoverPoints(Ne,Ge,Qe,tt){var rt,nt,at,it,ot,dt,ht,Dt,Ot,Rt=Ne.cd,Zt=Rt[0].t,er=Rt[0].trace,dr=Ne.xa,mr=Ne.ya,xr=Zt.x,br=Zt.y,Ar=dr.c2p(Ge),en=mr.c2p(Qe),mn=Ne.distance;if(Zt.tree){var xn=dr.p2c(Ar-mn),kn=dr.p2c(Ar+mn),Cn=mr.p2c(en-mn),En=mr.p2c(en+mn);rt="x"===tt?Zt.tree.range(Math.min(xn,kn),Math.min(mr._rl[0],mr._rl[1]),Math.max(xn,kn),Math.max(mr._rl[0],mr._rl[1])):Zt.tree.range(Math.min(xn,kn),Math.min(Cn,En),Math.max(xn,kn),Math.max(Cn,En))}else rt=Zt.ids;var Pn=mn;if("x"===tt)for(ot=0;ot<rt.length;ot++)at=xr[rt[ot]],(dt=Math.abs(dr.c2p(at)-Ar))<Pn&&(Pn=dt,ht=mr.c2p(br[rt[ot]])-en,Ot=Math.sqrt(dt*dt+ht*ht),nt=rt[ot]);else for(ot=rt.length-1;ot>-1;ot--)at=xr[rt[ot]],it=br[rt[ot]],dt=dr.c2p(at)-Ar,ht=mr.c2p(it)-en,(Dt=Math.sqrt(dt*dt+ht*ht))<Pn&&(Pn=Ot=Dt,nt=rt[ot]);return Ne.index=nt,Ne.distance=Pn,Ne.dxy=Ot,void 0===nt?[Ne]:[calcHover(Ne,xr,br,er)]}function calcHover(Ne,Ge,Qe,at){var it=Ne.xa,ot=Ne.ya,dt=Ne.distance,ht=Ne.dxy,Dt=Ne.index,Ot={pointNumber:Dt,x:Ge[Dt],y:Qe[Dt]};Ot.tx=Array.isArray(at.text)?at.text[Dt]:at.text,Ot.htx=Array.isArray(at.hovertext)?at.hovertext[Dt]:at.hovertext,Ot.data=Array.isArray(at.customdata)?at.customdata[Dt]:at.customdata,Ot.tp=Array.isArray(at.textposition)?at.textposition[Dt]:at.textposition;var Rt=at.textfont;Rt&&(Ot.ts=rt.isArrayOrTypedArray(Rt.size)?Rt.size[Dt]:Rt.size,Ot.tc=Array.isArray(Rt.color)?Rt.color[Dt]:Rt.color,Ot.tf=Array.isArray(Rt.family)?Rt.family[Dt]:Rt.family);var Zt=at.marker;Zt&&(Ot.ms=rt.isArrayOrTypedArray(Zt.size)?Zt.size[Dt]:Zt.size,Ot.mo=rt.isArrayOrTypedArray(Zt.opacity)?Zt.opacity[Dt]:Zt.opacity,Ot.mx=rt.isArrayOrTypedArray(Zt.symbol)?Zt.symbol[Dt]:Zt.symbol,Ot.mc=rt.isArrayOrTypedArray(Zt.color)?Zt.color[Dt]:Zt.color);var er=Zt&&Zt.line;er&&(Ot.mlc=Array.isArray(er.color)?er.color[Dt]:er.color,Ot.mlw=rt.isArrayOrTypedArray(er.width)?er.width[Dt]:er.width);var dr=Zt&&Zt.gradient;dr&&"none"!==dr.type&&(Ot.mgt=Array.isArray(dr.type)?dr.type[Dt]:dr.type,Ot.mgc=Array.isArray(dr.color)?dr.color[Dt]:dr.color);var mr=it.c2p(Ot.x,!0),xr=ot.c2p(Ot.y,!0),br=Ot.mrc||1,Ar=at.hoverlabel;Ar&&(Ot.hbg=Array.isArray(Ar.bgcolor)?Ar.bgcolor[Dt]:Ar.bgcolor,Ot.hbc=Array.isArray(Ar.bordercolor)?Ar.bordercolor[Dt]:Ar.bordercolor,Ot.hts=rt.isArrayOrTypedArray(Ar.font.size)?Ar.font.size[Dt]:Ar.font.size,Ot.htc=Array.isArray(Ar.font.color)?Ar.font.color[Dt]:Ar.font.color,Ot.htf=Array.isArray(Ar.font.family)?Ar.font.family[Dt]:Ar.font.family,Ot.hnl=rt.isArrayOrTypedArray(Ar.namelength)?Ar.namelength[Dt]:Ar.namelength);var en=at.hoverinfo;en&&(Ot.hi=Array.isArray(en)?en[Dt]:en);var mn=at.hovertemplate;mn&&(Ot.ht=Array.isArray(mn)?mn[Dt]:mn);var xn={};xn[Ne.index]=Ot;var kn=at._origX,Cn=at._origY,En=rt.extendFlat({},Ne,{color:nt(at,Ot),x0:mr-br,x1:mr+br,xLabelVal:kn?kn[Dt]:Ot.x,y0:xr-br,y1:xr+br,yLabelVal:Cn?Cn[Dt]:Ot.y,cd:xn,distance:dt,spikeDistance:ht,hovertemplate:Ot.ht});return Ot.htx?En.text=Ot.htx:Ot.tx?En.text=Ot.tx:at.text&&(En.text=at.text),rt.fillText(Ot,at,En),tt.getComponentMethod("errorbars","hoverInfo")(Ot,at,En),En}Ge.exports={hoverPoints:hoverPoints,calcHover:calcHover}},{"../../lib":778,"../../registry":911,"../scatter/get_trace_color":1197}],1248:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./hover");Ge.exports={moduleType:"trace",name:"scattergl",basePlotModule:Ne("../../plots/cartesian"),categories:["gl","regl","cartesian","symbols","errorBarsOK","showLegend","scatter-like"],attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),crossTraceDefaults:Ne("../scatter/cross_trace_defaults"),colorbar:Ne("../scatter/marker_colorbar"),formatLabels:Ne("./format_labels"),calc:Ne("./calc"),plot:Ne("./plot"),hoverPoints:tt.hoverPoints,selectPoints:Ne("./select"),meta:{}}},{"../../plots/cartesian":841,"../scatter/cross_trace_defaults":1193,"../scatter/marker_colorbar":1205,"./attributes":1239,"./calc":1240,"./defaults":1243,"./format_labels":1245,"./hover":1247,"./plot":1249,"./select":1251}],1249:[function(Ne,Ge,Qe){"use strict";var tt=Ne("regl-scatter2d"),rt=Ne("regl-line2d"),nt=Ne("regl-error2d"),at=Ne("gl-text"),it=Ne("../../lib"),ot=Ne("../../components/dragelement/helpers").selectMode,dt=Ne("../../lib/prepare_regl"),ht=Ne("../scatter/subtypes"),Dt=Ne("../scatter/link_traces"),Ot=Ne("./edit_style").styleTextSelection;function getViewport(Ne,Ge,Qe){var tt=Ne._size,rt=Ne.width,nt=Ne.height;return[tt.l+Ge.domain[0]*tt.w,tt.b+Qe.domain[0]*tt.h,rt-tt.r-(1-Ge.domain[1])*tt.w,nt-tt.t-(1-Qe.domain[1])*tt.h]}Ge.exports=function(Ne,Ge,Qe){if(Qe.length){var Rt,Zt,er=Ne._fullLayout,dr=Ge._scene,mr=Ge.xaxis,xr=Ge.yaxis;if(dr)if(dt(Ne,["ANGLE_instanced_arrays","OES_element_index_uint"])){var br=dr.count,Ar=er._glcanvas.data()[0].regl;if(Dt(Ne,Ge,Qe),dr.dirty){if(!0===dr.error2d&&(dr.error2d=nt(Ar)),!0===dr.line2d&&(dr.line2d=rt(Ar)),!0===dr.scatter2d&&(dr.scatter2d=tt(Ar,{constPointSize:!0})),!0===dr.fill2d&&(dr.fill2d=rt(Ar)),!0===dr.glText)for(dr.glText=new Array(br),Rt=0;Rt<br;Rt++)dr.glText[Rt]=new at(Ar);if(dr.glText){if(br>dr.glText.length){var en=br-dr.glText.length;for(Rt=0;Rt<en;Rt++)dr.glText.push(new at(Ar))}else if(br<dr.glText.length){var mn=dr.glText.length-br;dr.glText.splice(br,mn).forEach((function(Ne){Ne.destroy()}))}for(Rt=0;Rt<br;Rt++)dr.glText[Rt].update(dr.textOptions[Rt])}if(dr.line2d&&(dr.line2d.update(dr.lineOptions),dr.lineOptions=dr.lineOptions.map((function(Ne){if(Ne&&Ne.positions){for(var Ge=Ne.positions,Qe=0;Qe<Ge.length&&(isNaN(Ge[Qe])||isNaN(Ge[Qe+1]));)Qe+=2;for(var tt=Ge.length-2;tt>Qe&&(isNaN(Ge[tt])||isNaN(Ge[tt+1]));)tt-=2;Ne.positions=Ge.slice(Qe,tt+2)}return Ne})),dr.line2d.update(dr.lineOptions)),dr.error2d){var xn=(dr.errorXOptions||[]).concat(dr.errorYOptions||[]);dr.error2d.update(xn)}dr.scatter2d&&dr.scatter2d.update(dr.markerOptions),dr.fillOrder=it.repeat(null,br),dr.fill2d&&(dr.fillOptions=dr.fillOptions.map((function(Ne,Ge){var tt=Qe[Ge];if(Ne&&tt&&tt[0]&&tt[0].trace){var rt,nt,at=tt[0],it=at.trace,ot=at.t,dt=dr.lineOptions[Ge],ht=[];it._ownfill&&ht.push(Ge),it._nexttrace&&ht.push(Ge+1),ht.length&&(dr.fillOrder[Ge]=ht);var Dt,Ot,Rt=[],Zt=dt&&dt.positions||ot.positions;if("tozeroy"===it.fill){for(Dt=0;Dt<Zt.length&&isNaN(Zt[Dt+1]);)Dt+=2;for(Ot=Zt.length-2;Ot>Dt&&isNaN(Zt[Ot+1]);)Ot-=2;0!==Zt[Dt+1]&&(Rt=[Zt[Dt],0]),Rt=Rt.concat(Zt.slice(Dt,Ot+2)),0!==Zt[Ot+1]&&(Rt=Rt.concat([Zt[Ot],0]))}else if("tozerox"===it.fill){for(Dt=0;Dt<Zt.length&&isNaN(Zt[Dt]);)Dt+=2;for(Ot=Zt.length-2;Ot>Dt&&isNaN(Zt[Ot]);)Ot-=2;0!==Zt[Dt]&&(Rt=[0,Zt[Dt+1]]),Rt=Rt.concat(Zt.slice(Dt,Ot+2)),0!==Zt[Ot]&&(Rt=Rt.concat([0,Zt[Ot+1]]))}else if("toself"===it.fill||"tonext"===it.fill){for(Rt=[],rt=0,nt=0;nt<Zt.length;nt+=2)(isNaN(Zt[nt])||isNaN(Zt[nt+1]))&&((Rt=Rt.concat(Zt.slice(rt,nt))).push(Zt[rt],Zt[rt+1]),rt=nt+2);Rt=Rt.concat(Zt.slice(rt)),rt&&Rt.push(Zt[rt],Zt[rt+1])}else{var er=it._nexttrace;if(er){var mr=dr.lineOptions[Ge+1];if(mr){var xr=mr.positions;if("tonexty"===it.fill){for(Rt=Zt.slice(),Ge=Math.floor(xr.length/2);Ge--;){var br=xr[2*Ge],Ar=xr[2*Ge+1];isNaN(br)||isNaN(Ar)||Rt.push(br,Ar)}Ne.fill=er.fillcolor}}}}if(it._prevtrace&&"tonext"===it._prevtrace.fill){var en=dr.lineOptions[Ge-1].positions,mn=Rt.length/2,xn=[rt=mn];for(nt=0;nt<en.length;nt+=2)(isNaN(en[nt])||isNaN(en[nt+1]))&&(xn.push(nt/2+mn+1),rt=nt+2);Rt=Rt.concat(en),Ne.hole=xn}return Ne.fillmode=it.fill,Ne.opacity=it.opacity,Ne.positions=Rt,Ne}})),dr.fill2d.update(dr.fillOptions))}var kn=er.dragmode,Cn=ot(kn),En=er.clickmode.indexOf("select")>-1;for(Rt=0;Rt<br;Rt++){var Pn=Qe[Rt][0],Dn=Pn.trace,In=Pn.t,zn=In.index,Bn=Dn._length,Vn=In.x,Hn=In.y;if(Dn.selectedpoints||Cn||En){if(Cn||(Cn=!0),Dn.selectedpoints){var qn=dr.selectBatch[zn]=it.selIndices2selPoints(Dn),Yn={};for(Zt=0;Zt<qn.length;Zt++)Yn[qn[Zt]]=1;var $n=[];for(Zt=0;Zt<Bn;Zt++)Yn[Zt]||$n.push(Zt);dr.unselectBatch[zn]=$n}var ra=In.xpx=new Array(Bn),oa=In.ypx=new Array(Bn);for(Zt=0;Zt<Bn;Zt++)ra[Zt]=mr.c2p(Vn[Zt]),oa[Zt]=xr.c2p(Hn[Zt])}else In.xpx=In.ypx=null}if(Cn){if(dr.select2d||(dr.select2d=tt(er._glcanvas.data()[1].regl)),dr.scatter2d){var pa=new Array(br);for(Rt=0;Rt<br;Rt++)pa[Rt]=dr.selectBatch[Rt].length||dr.unselectBatch[Rt].length?dr.markerUnselectedOptions[Rt]:{};dr.scatter2d.update(pa)}dr.select2d&&(dr.select2d.update(dr.markerOptions),dr.select2d.update(dr.markerSelectedOptions)),dr.glText&&Qe.forEach((function(Ne){var Ge=((Ne||[])[0]||{}).trace||{};ht.hasText(Ge)&&Ot(Ne)}))}else dr.scatter2d&&dr.scatter2d.update(dr.markerOptions);var ga={viewport:getViewport(er,mr,xr),range:[(mr._rl||mr.range)[0],(xr._rl||xr.range)[0],(mr._rl||mr.range)[1],(xr._rl||xr.range)[1]]},ma=it.repeat(ga,dr.count);dr.fill2d&&dr.fill2d.update(ma),dr.line2d&&dr.line2d.update(ma),dr.error2d&&dr.error2d.update(ma.concat(ma)),dr.scatter2d&&dr.scatter2d.update(ma),dr.select2d&&dr.select2d.update(ma),dr.glText&&dr.glText.forEach((function(Ne){Ne.update(ga)}))}else dr.init()}}},{"../../components/dragelement/helpers":661,"../../lib":778,"../../lib/prepare_regl":791,"../scatter/link_traces":1203,"../scatter/subtypes":1212,"./edit_style":1244,"gl-text":352,"regl-error2d":534,"regl-line2d":535,"regl-scatter2d":537}],1250:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib");Ge.exports=function(Ne,Ge){var Qe=Ge._scene,rt={count:0,dirty:!0,lineOptions:[],fillOptions:[],markerOptions:[],markerSelectedOptions:[],markerUnselectedOptions:[],errorXOptions:[],errorYOptions:[],textOptions:[],textSelectedOptions:[],textUnselectedOptions:[],selectBatch:[],unselectBatch:[]},nt={fill2d:!1,scatter2d:!1,error2d:!1,line2d:!1,glText:!1,select2d:!1};return Ge._scene||((Qe=Ge._scene={}).init=function(){tt.extendFlat(Qe,nt,rt)},Qe.init(),Qe.update=function(Ne){var Ge=tt.repeat(Ne,Qe.count);if(Qe.fill2d&&Qe.fill2d.update(Ge),Qe.scatter2d&&Qe.scatter2d.update(Ge),Qe.line2d&&Qe.line2d.update(Ge),Qe.error2d&&Qe.error2d.update(Ge.concat(Ge)),Qe.select2d&&Qe.select2d.update(Ge),Qe.glText)for(var rt=0;rt<Qe.count;rt++)Qe.glText[rt].update(Ne)},Qe.draw=function(){for(var Ne=Qe.count,Ge=Qe.fill2d,rt=Qe.error2d,nt=Qe.line2d,at=Qe.scatter2d,it=Qe.glText,ot=Qe.select2d,dt=Qe.selectBatch,ht=Qe.unselectBatch,Dt=0;Dt<Ne;Dt++){if(Ge&&Qe.fillOrder[Dt]&&Ge.draw(Qe.fillOrder[Dt]),nt&&Qe.lineOptions[Dt]&&nt.draw(Dt),rt&&(Qe.errorXOptions[Dt]&&rt.draw(Dt),Qe.errorYOptions[Dt]&&rt.draw(Dt+Ne)),at&&Qe.markerOptions[Dt])if(ht[Dt].length){var Ot=tt.repeat([],Qe.count);Ot[Dt]=ht[Dt],at.draw(Ot)}else dt[Dt].length||at.draw(Dt);it[Dt]&&Qe.textOptions[Dt]&&it[Dt].render()}ot&&ot.draw(dt),Qe.dirty=!1},Qe.destroy=function(){Qe.fill2d&&Qe.fill2d.destroy&&Qe.fill2d.destroy(),Qe.scatter2d&&Qe.scatter2d.destroy&&Qe.scatter2d.destroy(),Qe.error2d&&Qe.error2d.destroy&&Qe.error2d.destroy(),Qe.line2d&&Qe.line2d.destroy&&Qe.line2d.destroy(),Qe.select2d&&Qe.select2d.destroy&&Qe.select2d.destroy(),Qe.glText&&Qe.glText.forEach((function(Ne){Ne.destroy&&Ne.destroy()})),Qe.lineOptions=null,Qe.fillOptions=null,Qe.markerOptions=null,Qe.markerSelectedOptions=null,Qe.markerUnselectedOptions=null,Qe.errorXOptions=null,Qe.errorYOptions=null,Qe.textOptions=null,Qe.textSelectedOptions=null,Qe.textUnselectedOptions=null,Qe.selectBatch=null,Qe.unselectBatch=null,Ge._scene=null}),Qe.dirty||tt.extendFlat(Qe,rt),Qe}},{"../../lib":778}],1251:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../scatter/subtypes"),rt=Ne("./edit_style").styleTextSelection;Ge.exports=function(Ne,Ge){var Qe=Ne.cd,nt=[],at=Qe[0].trace,it=Qe[0].t,ot=at._length,dt=it.x,ht=it.y,Dt=it._scene,Ot=it.index;if(!Dt)return nt;var Rt=tt.hasText(at),Zt=tt.hasMarkers(at),er=!Zt&&!Rt;if(!0!==at.visible||er)return nt;var dr=[],mr=[];if(!1!==Ge&&!Ge.degenerate)for(var xr=0;xr<ot;xr++)Ge.contains([it.xpx[xr],it.ypx[xr]],!1,xr,Ne)?(dr.push(xr),nt.push({pointNumber:xr,x:dt[xr],y:ht[xr]})):mr.push(xr);if(Zt){var br=Dt.scatter2d;if(dr.length||mr.length){if(!Dt.selectBatch[Ot].length&&!Dt.unselectBatch[Ot].length){var Ar=new Array(Dt.count);Ar[Ot]=Dt.markerUnselectedOptions[Ot],br.update.apply(br,Ar)}}else{var en=new Array(Dt.count);en[Ot]=Dt.markerOptions[Ot],br.update.apply(br,en)}}return Dt.selectBatch[Ot]=dr,Dt.unselectBatch[Ot]=mr,Rt&&rt(Qe),nt}},{"../scatter/subtypes":1212,"./edit_style":1244}],1252:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/template_attributes").hovertemplateAttrs,rt=Ne("../../plots/template_attributes").texttemplateAttrs,nt=Ne("../scattergeo/attributes"),at=Ne("../scatter/attributes"),it=Ne("../../plots/mapbox/layout_attributes"),ot=Ne("../../plots/attributes"),dt=Ne("../../components/colorscale/attributes"),ht=Ne("../../lib/extend").extendFlat,Dt=Ne("../../plot_api/edit_types").overrideAll,Ot=nt.line,Rt=nt.marker;Ge.exports=Dt({lon:nt.lon,lat:nt.lat,mode:ht({},at.mode,{dflt:"markers"}),text:ht({},at.text,{}),texttemplate:rt({editType:"plot"},{keys:["lat","lon","text"]}),hovertext:ht({},at.hovertext,{}),line:{color:Ot.color,width:Ot.width},connectgaps:at.connectgaps,marker:ht({symbol:{valType:"string",dflt:"circle",arrayOk:!0},angle:{valType:"number",dflt:"auto",arrayOk:!0},allowoverlap:{valType:"boolean",dflt:!1},opacity:Rt.opacity,size:Rt.size,sizeref:Rt.sizeref,sizemin:Rt.sizemin,sizemode:Rt.sizemode},dt("marker")),fill:nt.fill,fillcolor:at.fillcolor,textfont:it.layers.symbol.textfont,textposition:it.layers.symbol.textposition,below:{valType:"string"},selected:{marker:at.selected.marker},unselected:{marker:at.unselected.marker},hoverinfo:ht({},ot.hoverinfo,{flags:["lon","lat","text","name"]}),hovertemplate:tt()},"calc","nested")},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/attributes":824,"../../plots/mapbox/layout_attributes":887,"../../plots/template_attributes":906,"../scatter/attributes":1187,"../scattergeo/attributes":1229}],1253:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../lib"),nt=Ne("../../constants/numerical").BADNUM,at=Ne("../../lib/geojson_utils"),it=Ne("../../components/colorscale"),ot=Ne("../../components/drawing"),dt=Ne("../scatter/make_bubble_size_func"),ht=Ne("../scatter/subtypes"),Dt=Ne("../../plots/mapbox/convert_text_opts"),Ot=Ne("../../components/fx/helpers").appendArrayPointValue,Rt=Ne("../../lib/svg_text_utils").NEWLINES,Zt=Ne("../../lib/svg_text_utils").BR_TAG_ALL;function initContainer(){return{geojson:at.makeBlank(),layout:{visibility:"none"},paint:{}}}function makeCircleOpts(Ne){var Ge,Qe,nt,at,ht=Ne[0].trace,Dt=ht.marker,Ot=ht.selectedpoints,Rt=rt.isArrayOrTypedArray(Dt.color),Zt=rt.isArrayOrTypedArray(Dt.size),er=rt.isArrayOrTypedArray(Dt.opacity);function addTraceOpacity(Ne){return ht.opacity*Ne}function size2radius(Ne){return Ne/2}Rt&&(Qe=it.hasColorscale(ht,"marker")?it.makeColorScaleFuncFromTrace(Dt):rt.identity),Zt&&(nt=dt(ht)),er&&(at=function(Ne){return addTraceOpacity(tt(Ne)?+rt.constrain(Ne,0,1):0)});var dr,mr=[];for(Ge=0;Ge<Ne.length;Ge++){var xr=Ne[Ge],br=xr.lonlat;if(!isBADNUM(br)){var Ar={};Qe&&(Ar.mcc=xr.mcc=Qe(xr.mc)),nt&&(Ar.mrc=xr.mrc=nt(xr.ms)),at&&(Ar.mo=at(xr.mo)),Ot&&(Ar.selected=xr.selected||0),mr.push({type:"Feature",geometry:{type:"Point",coordinates:br},properties:Ar})}}if(Ot)for(dr=ot.makeSelectedPointStyleFns(ht),Ge=0;Ge<mr.length;Ge++){var en=mr[Ge].properties;dr.selectedOpacityFn&&(en.mo=addTraceOpacity(dr.selectedOpacityFn(en))),dr.selectedColorFn&&(en.mcc=dr.selectedColorFn(en)),dr.selectedSizeFn&&(en.mrc=dr.selectedSizeFn(en))}return{geojson:{type:"FeatureCollection",features:mr},mcc:Rt||dr&&dr.selectedColorFn?{type:"identity",property:"mcc"}:Dt.color,mrc:Zt||dr&&dr.selectedSizeFn?{type:"identity",property:"mrc"}:size2radius(Dt.size),mo:er||dr&&dr.selectedOpacityFn?{type:"identity",property:"mo"}:addTraceOpacity(Dt.opacity)}}function makeSymbolGeoJSON(Ne,Ge){for(var Qe=Ge._fullLayout,tt=Ne[0].trace,nt=tt.marker||{},at=nt.symbol,it=nt.angle,ot="circle"!==at?getFillFunc(at):blankFillFunc,dt="auto"!==it?getFillFunc(it,!0):blankFillFunc,Dt=ht.hasText(tt)?getFillFunc(tt.text):blankFillFunc,er=[],dr=0;dr<Ne.length;dr++){var mr=Ne[dr];if(!isBADNUM(mr.lonlat)){var xr,br=tt.texttemplate;if(br){var Ar=Array.isArray(br)?br[dr]||"":br,en=tt._module.formatLabels(mr,tt,Qe),mn={};Ot(mn,tt,mr.i);var xn=tt._meta||{};xr=rt.texttemplateString(Ar,en,Qe._d3locale,mn,mr,xn)}else xr=Dt(dr);xr&&(xr=xr.replace(Rt,"").replace(Zt,"\n")),er.push({type:"Feature",geometry:{type:"Point",coordinates:mr.lonlat},properties:{symbol:ot(dr),angle:dt(dr),text:xr}})}}return{type:"FeatureCollection",features:er}}function getFillFunc(Ne,Ge){return rt.isArrayOrTypedArray(Ne)?Ge?function(Ge){return tt(Ne[Ge])?+Ne[Ge]:0}:function(Ge){return Ne[Ge]}:Ne?function(){return Ne}:blankFillFunc}function blankFillFunc(){return""}function isBADNUM(Ne){return Ne[0]===nt}Ge.exports=function(Ne,Ge){var Qe,tt=Ge[0].trace,nt=!0===tt.visible&&0!==tt._length,it="none"!==tt.fill,ot=ht.hasLines(tt),dt=ht.hasMarkers(tt),Ot=ht.hasText(tt),Rt=dt&&"circle"===tt.marker.symbol,Zt=dt&&"circle"!==tt.marker.symbol,er=initContainer(),dr=initContainer(),mr=initContainer(),xr=initContainer(),br={fill:er,line:dr,circle:mr,symbol:xr};if(!nt)return br;if((it||ot)&&(Qe=at.calcTraceToLineCoords(Ge)),it&&(er.geojson=at.makePolygon(Qe),er.layout.visibility="visible",rt.extendFlat(er.paint,{"fill-color":tt.fillcolor})),ot&&(dr.geojson=at.makeLine(Qe),dr.layout.visibility="visible",rt.extendFlat(dr.paint,{"line-width":tt.line.width,"line-color":tt.line.color,"line-opacity":tt.opacity})),Rt){var Ar=makeCircleOpts(Ge);mr.geojson=Ar.geojson,mr.layout.visibility="visible",rt.extendFlat(mr.paint,{"circle-color":Ar.mcc,"circle-radius":Ar.mrc,"circle-opacity":Ar.mo})}if((Zt||Ot)&&(xr.geojson=makeSymbolGeoJSON(Ge,Ne),rt.extendFlat(xr.layout,{visibility:"visible","icon-image":"{symbol}-15","text-field":"{text}"}),Zt&&(rt.extendFlat(xr.layout,{"icon-size":tt.marker.size/10}),"angle"in tt.marker&&"auto"!==tt.marker.angle&&rt.extendFlat(xr.layout,{"icon-rotate":{type:"identity",property:"angle"},"icon-rotation-alignment":"map"}),xr.layout["icon-allow-overlap"]=tt.marker.allowoverlap,rt.extendFlat(xr.paint,{"icon-opacity":tt.opacity*tt.marker.opacity,"icon-color":tt.marker.color})),Ot)){var en=(tt.marker||{}).size,mn=Dt(tt.textposition,en);rt.extendFlat(xr.layout,{"text-size":tt.textfont.size,"text-anchor":mn.anchor,"text-offset":mn.offset}),rt.extendFlat(xr.paint,{"text-color":tt.textfont.color,"text-opacity":tt.opacity})}return br}},{"../../components/colorscale":655,"../../components/drawing":665,"../../components/fx/helpers":679,"../../constants/numerical":753,"../../lib":778,"../../lib/geojson_utils":772,"../../lib/svg_text_utils":803,"../../plots/mapbox/convert_text_opts":884,"../scatter/make_bubble_size_func":1204,"../scatter/subtypes":1212,"fast-isnumeric":241}],1254:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../scatter/subtypes"),nt=Ne("../scatter/marker_defaults"),at=Ne("../scatter/line_defaults"),it=Ne("../scatter/text_defaults"),ot=Ne("../scatter/fillcolor_defaults"),dt=Ne("./attributes");function handleLonLatDefaults(Ne,Ge,Qe){var tt=Qe("lon")||[],rt=Qe("lat")||[],nt=Math.min(tt.length,rt.length);return Ge._length=nt,nt}Ge.exports=function(Ne,Ge,Qe,ht){function coerce(Qe,rt){return tt.coerce(Ne,Ge,dt,Qe,rt)}if(handleLonLatDefaults(Ne,Ge,coerce)){if(coerce("text"),coerce("texttemplate"),coerce("hovertext"),coerce("hovertemplate"),coerce("mode"),coerce("below"),rt.hasLines(Ge)&&(at(Ne,Ge,Qe,ht,coerce,{noDash:!0}),coerce("connectgaps")),rt.hasMarkers(Ge)){nt(Ne,Ge,Qe,ht,coerce,{noLine:!0}),coerce("marker.allowoverlap"),coerce("marker.angle");var Dt=Ge.marker;"circle"!==Dt.symbol&&(tt.isArrayOrTypedArray(Dt.size)&&(Dt.size=Dt.size[0]),tt.isArrayOrTypedArray(Dt.color)&&(Dt.color=Dt.color[0]))}rt.hasText(Ge)&&it(Ne,Ge,ht,coerce,{noSelect:!0}),coerce("fill"),"none"!==Ge.fill&&ot(Ne,Ge,Qe,coerce),tt.coerceSelectionMarkerOpacity(Ge,coerce)}else Ge.visible=!1}},{"../../lib":778,"../scatter/fillcolor_defaults":1195,"../scatter/line_defaults":1200,"../scatter/marker_defaults":1206,"../scatter/subtypes":1212,"../scatter/text_defaults":1213,"./attributes":1252}],1255:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge){return Ne.lon=Ge.lon,Ne.lat=Ge.lat,Ne}},{}],1256:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/cartesian/axes");Ge.exports=function(Ne,Ge,Qe){var rt={},nt=Qe[Ge.subplot]._subplot.mockAxis,at=Ne.lonlat;return rt.lonLabel=tt.tickText(nt,nt.c2l(at[0]),!0).text,rt.latLabel=tt.tickText(nt,nt.c2l(at[1]),!0).text,rt}},{"../../plots/cartesian/axes":828}],1257:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/fx"),rt=Ne("../../lib"),nt=Ne("../scatter/get_trace_color"),at=rt.fillText,it=Ne("../../constants/numerical").BADNUM;function getExtraText(Ne,Ge,Qe){if(!Ne.hovertemplate){var tt=(Ge.hi||Ne.hoverinfo).split("+"),rt=-1!==tt.indexOf("all"),nt=-1!==tt.indexOf("lon"),it=-1!==tt.indexOf("lat"),ot=Ge.lonlat,dt=[];return rt||nt&&it?dt.push("("+format(ot[0])+", "+format(ot[1])+")"):nt?dt.push(Qe.lon+format(ot[0])):it&&dt.push(Qe.lat+format(ot[1])),(rt||-1!==tt.indexOf("text"))&&at(Ge,Ne,dt),dt.join("<br>")}function format(Ne){return Ne+"Â°"}}Ge.exports=function(Ne,Ge,Qe){var at=Ne.cd,ot=at[0].trace,dt=Ne.xa,ht=Ne.ya,Dt=Ne.subplot,Ot=360*(Ge>=0?Math.floor((Ge+180)/360):Math.ceil((Ge-180)/360)),Rt=Ge-Ot;function distFn(Ne){var Ge=Ne.lonlat;if(Ge[0]===it)return 1/0;var tt=rt.modHalf(Ge[0],360),nt=Ge[1],at=Dt.project([tt,nt]),ot=at.x-dt.c2p([Rt,nt]),Ot=at.y-ht.c2p([tt,Qe]),Zt=Math.max(3,Ne.mrc||0);return Math.max(Math.sqrt(ot*ot+Ot*Ot)-Zt,1-3/Zt)}if(tt.getClosest(at,distFn,Ne),!1!==Ne.index){var Zt=at[Ne.index],er=Zt.lonlat,dr=[rt.modHalf(er[0],360)+Ot,er[1]],mr=dt.c2p(dr),xr=ht.c2p(dr),br=Zt.mrc||1;Ne.x0=mr-br,Ne.x1=mr+br,Ne.y0=xr-br,Ne.y1=xr+br;var Ar={};Ar[ot.subplot]={_subplot:Dt};var en=ot._module.formatLabels(Zt,ot,Ar);return Ne.lonLabel=en.lonLabel,Ne.latLabel=en.latLabel,Ne.color=nt(ot,Zt),Ne.extraText=getExtraText(ot,Zt,at[0].t.labels),Ne.hovertemplate=ot.hovertemplate,[Ne]}}},{"../../components/fx":683,"../../constants/numerical":753,"../../lib":778,"../scatter/get_trace_color":1197}],1258:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),colorbar:Ne("../scatter/marker_colorbar"),formatLabels:Ne("./format_labels"),calc:Ne("../scattergeo/calc"),plot:Ne("./plot"),hoverPoints:Ne("./hover"),eventData:Ne("./event_data"),selectPoints:Ne("./select"),styleOnSelect:function(Ne,Ge){Ge&&Ge[0].trace._glTrace.update(Ge)},moduleType:"trace",name:"scattermapbox",basePlotModule:Ne("../../plots/mapbox"),categories:["mapbox","gl","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/mapbox":885,"../scatter/marker_colorbar":1205,"../scattergeo/calc":1230,"./attributes":1252,"./defaults":1254,"./event_data":1255,"./format_labels":1256,"./hover":1257,"./plot":1259,"./select":1260}],1259:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./convert"),rt=Ne("../../plots/mapbox/constants").traceLayerPrefix,nt=["fill","line","circle","symbol"];function ScatterMapbox(Ne,Ge){this.type="scattermapbox",this.subplot=Ne,this.uid=Ge,this.sourceIds={fill:"source-"+Ge+"-fill",line:"source-"+Ge+"-line",circle:"source-"+Ge+"-circle",symbol:"source-"+Ge+"-symbol"},this.layerIds={fill:rt+Ge+"-fill",line:rt+Ge+"-line",circle:rt+Ge+"-circle",symbol:rt+Ge+"-symbol"},this.below=null}var at=ScatterMapbox.prototype;at.addSource=function(Ne,Ge){this.subplot.map.addSource(this.sourceIds[Ne],{type:"geojson",data:Ge.geojson})},at.setSourceData=function(Ne,Ge){this.subplot.map.getSource(this.sourceIds[Ne]).setData(Ge.geojson)},at.addLayer=function(Ne,Ge,Qe){this.subplot.addLayer({type:Ne,id:this.layerIds[Ne],source:this.sourceIds[Ne],layout:Ge.layout,paint:Ge.paint},Qe)},at.update=function(Ne){var Ge,Qe,rt,at=this.subplot,it=at.map,ot=tt(at.gd,Ne),dt=at.belowLookup["trace-"+this.uid];if(dt!==this.below){for(Ge=nt.length-1;Ge>=0;Ge--)Qe=nt[Ge],it.removeLayer(this.layerIds[Qe]);for(Ge=0;Ge<nt.length;Ge++)rt=ot[Qe=nt[Ge]],this.addLayer(Qe,rt,dt);this.below=dt}for(Ge=0;Ge<nt.length;Ge++)rt=ot[Qe=nt[Ge]],at.setOptions(this.layerIds[Qe],"setLayoutProperty",rt.layout),"visible"===rt.layout.visibility&&(this.setSourceData(Qe,rt),at.setOptions(this.layerIds[Qe],"setPaintProperty",rt.paint));Ne[0].trace._glTrace=this},at.dispose=function(){for(var Ne=this.subplot.map,Ge=nt.length-1;Ge>=0;Ge--){var Qe=nt[Ge];Ne.removeLayer(this.layerIds[Qe]),Ne.removeSource(this.sourceIds[Qe])}},Ge.exports=function(Ne,Ge){for(var Qe=Ge[0].trace,rt=new ScatterMapbox(Ne,Qe.uid),at=tt(Ne.gd,Ge),it=rt.below=Ne.belowLookup["trace-"+Qe.uid],ot=0;ot<nt.length;ot++){var dt=nt[ot],ht=at[dt];rt.addSource(dt,ht),rt.addLayer(dt,ht,it)}return Ge[0].trace._glTrace=rt,rt}},{"../../plots/mapbox/constants":883,"./convert":1253}],1260:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../scatter/subtypes"),nt=Ne("../../constants/numerical").BADNUM;Ge.exports=function(Ne,Ge){var Qe,at=Ne.cd,it=Ne.xaxis,ot=Ne.yaxis,dt=[],ht=at[0].trace;if(!rt.hasMarkers(ht))return[];if(!1===Ge)for(Qe=0;Qe<at.length;Qe++)at[Qe].selected=0;else for(Qe=0;Qe<at.length;Qe++){var Dt=at[Qe],Ot=Dt.lonlat;if(Ot[0]!==nt){var Rt=[tt.modHalf(Ot[0],360),Ot[1]],Zt=[it.c2p(Rt),ot.c2p(Rt)];Ge.contains(Zt,null,Qe,Ne)?(dt.push({pointNumber:Qe,lon:Ot[0],lat:Ot[1]}),Dt.selected=1):Dt.selected=0}}return dt}},{"../../constants/numerical":753,"../../lib":778,"../scatter/subtypes":1212}],1261:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/template_attributes").hovertemplateAttrs,rt=Ne("../../plots/template_attributes").texttemplateAttrs,nt=Ne("../../lib/extend").extendFlat,at=Ne("../scatter/attributes"),it=Ne("../../plots/attributes"),ot=at.line;Ge.exports={mode:at.mode,r:{valType:"data_array",editType:"calc+clearAxisTypes"},theta:{valType:"data_array",editType:"calc+clearAxisTypes"},r0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dr:{valType:"number",dflt:1,editType:"calc"},theta0:{valType:"any",dflt:0,editType:"calc+clearAxisTypes"},dtheta:{valType:"number",editType:"calc"},thetaunit:{valType:"enumerated",values:["radians","degrees","gradians"],dflt:"degrees",editType:"calc+clearAxisTypes"},text:at.text,texttemplate:rt({editType:"plot"},{keys:["r","theta","text"]}),hovertext:at.hovertext,line:{color:ot.color,width:ot.width,dash:ot.dash,shape:nt({},ot.shape,{values:["linear","spline"]}),smoothing:ot.smoothing,editType:"calc"},connectgaps:at.connectgaps,marker:at.marker,cliponaxis:nt({},at.cliponaxis,{dflt:!1}),textposition:at.textposition,textfont:at.textfont,fill:nt({},at.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:at.fillcolor,hoverinfo:nt({},it.hoverinfo,{flags:["r","theta","text","name"]}),hoveron:at.hoveron,hovertemplate:tt(),selected:at.selected,unselected:at.unselected}},{"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../scatter/attributes":1187}],1262:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../../constants/numerical").BADNUM,nt=Ne("../../plots/cartesian/axes"),at=Ne("../scatter/colorscale_calc"),it=Ne("../scatter/arrays_to_calcdata"),ot=Ne("../scatter/calc_selection"),dt=Ne("../scatter/calc").calcMarkerSize;Ge.exports=function(Ne,Ge){for(var Qe=Ne._fullLayout,ht=Ge.subplot,Dt=Qe[ht].radialaxis,Ot=Qe[ht].angularaxis,Rt=Dt.makeCalcdata(Ge,"r"),Zt=Ot.makeCalcdata(Ge,"theta"),er=Ge._length,dr=new Array(er),mr=0;mr<er;mr++){var xr=Rt[mr],br=Zt[mr],Ar=dr[mr]={};tt(xr)&&tt(br)?(Ar.r=xr,Ar.theta=br):Ar.r=rt}var en=dt(Ge,er);return Ge._extremes.x=nt.findExtremes(Dt,Rt,{ppad:en}),at(Ne,Ge),it(dr,Ge),ot(dr,Ge),dr}},{"../../constants/numerical":753,"../../plots/cartesian/axes":828,"../scatter/arrays_to_calcdata":1186,"../scatter/calc":1188,"../scatter/calc_selection":1189,"../scatter/colorscale_calc":1190,"fast-isnumeric":241}],1263:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../scatter/subtypes"),nt=Ne("../scatter/marker_defaults"),at=Ne("../scatter/line_defaults"),it=Ne("../scatter/line_shape_defaults"),ot=Ne("../scatter/text_defaults"),dt=Ne("../scatter/fillcolor_defaults"),ht=Ne("../scatter/constants").PTS_LINESONLY,Dt=Ne("./attributes");function supplyDefaults(Ne,Ge,Qe,Ot){function coerce(Qe,rt){return tt.coerce(Ne,Ge,Dt,Qe,rt)}var Rt=handleRThetaDefaults(Ne,Ge,Ot,coerce);if(Rt){coerce("thetaunit"),coerce("mode",Rt<ht?"lines+markers":"lines"),coerce("text"),coerce("hovertext"),"fills"!==Ge.hoveron&&coerce("hovertemplate"),rt.hasLines(Ge)&&(at(Ne,Ge,Qe,Ot,coerce),it(Ne,Ge,coerce),coerce("connectgaps")),rt.hasMarkers(Ge)&&nt(Ne,Ge,Qe,Ot,coerce,{gradient:!0}),rt.hasText(Ge)&&(coerce("texttemplate"),ot(Ne,Ge,Ot,coerce));var Zt=[];(rt.hasMarkers(Ge)||rt.hasText(Ge))&&(coerce("cliponaxis"),coerce("marker.maxdisplayed"),Zt.push("points")),coerce("fill"),"none"!==Ge.fill&&(dt(Ne,Ge,Qe,coerce),rt.hasLines(Ge)||it(Ne,Ge,coerce)),"tonext"!==Ge.fill&&"toself"!==Ge.fill||Zt.push("fills"),coerce("hoveron",Zt.join("+")||"points"),tt.coerceSelectionMarkerOpacity(Ge,coerce)}else Ge.visible=!1}function handleRThetaDefaults(Ne,Ge,Qe,tt){var rt,nt=tt("r"),at=tt("theta");if(nt)at?rt=Math.min(nt.length,at.length):(rt=nt.length,tt("theta0"),tt("dtheta"));else{if(!at)return 0;rt=Ge.theta.length,tt("r0"),tt("dr")}return Ge._length=rt,rt}Ge.exports={handleRThetaDefaults:handleRThetaDefaults,supplyDefaults:supplyDefaults}},{"../../lib":778,"../scatter/constants":1191,"../scatter/fillcolor_defaults":1195,"../scatter/line_defaults":1200,"../scatter/line_shape_defaults":1202,"../scatter/marker_defaults":1206,"../scatter/subtypes":1212,"../scatter/text_defaults":1213,"./attributes":1261}],1264:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../plots/cartesian/axes");Ge.exports=function(Ne,Ge,Qe){var nt,at,it={},ot=Qe[Ge.subplot]._subplot;ot?(nt=ot.radialAxis,at=ot.angularAxis):(nt=(ot=Qe[Ge.subplot]).radialaxis,at=ot.angularaxis);var dt=nt.c2l(Ne.r);it.rLabel=rt.tickText(nt,dt,!0).text;var ht="degrees"===at.thetaunit?tt.rad2deg(Ne.theta):Ne.theta;return it.thetaLabel=rt.tickText(at,ht,!0).text,it}},{"../../lib":778,"../../plots/cartesian/axes":828}],1265:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../scatter/hover");function hoverPoints(Ne,Ge,Qe,rt){var nt=tt(Ne,Ge,Qe,rt);if(nt&&!1!==nt[0].index){var at=nt[0];if(void 0===at.index)return nt;var it=Ne.subplot,ot=at.cd[at.index],dt=at.trace;if(it.isPtInside(ot))return at.xLabelVal=void 0,at.yLabelVal=void 0,makeHoverPointText(ot,dt,it,at),at.hovertemplate=dt.hovertemplate,nt}}function makeHoverPointText(Ne,Ge,Qe,tt){var rt=Qe.radialAxis,nt=Qe.angularAxis;rt._hovertitle="r",nt._hovertitle="Î¸";var at={};at[Ge.subplot]={_subplot:Qe};var it=Ge._module.formatLabels(Ne,Ge,at);tt.rLabel=it.rLabel,tt.thetaLabel=it.thetaLabel;var ot=Ne.hi||Ge.hoverinfo,dt=[];function textPart(Ne,Ge){dt.push(Ne._hovertitle+": "+Ge)}if(!Ge.hovertemplate){var ht=ot.split("+");-1!==ht.indexOf("all")&&(ht=["r","theta","text"]),-1!==ht.indexOf("r")&&textPart(rt,tt.rLabel),-1!==ht.indexOf("theta")&&textPart(nt,tt.thetaLabel),-1!==ht.indexOf("text")&&tt.text&&(dt.push(tt.text),delete tt.text),tt.extraText=dt.join("<br>")}}Ge.exports={hoverPoints:hoverPoints,makeHoverPointText:makeHoverPointText}},{"../scatter/hover":1198}],1266:[function(Ne,Ge,Qe){"use strict";Ge.exports={moduleType:"trace",name:"scatterpolar",basePlotModule:Ne("../../plots/polar"),categories:["polar","symbols","showLegend","scatter-like"],attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults").supplyDefaults,colorbar:Ne("../scatter/marker_colorbar"),formatLabels:Ne("./format_labels"),calc:Ne("./calc"),plot:Ne("./plot"),style:Ne("../scatter/style").style,styleOnSelect:Ne("../scatter/style").styleOnSelect,hoverPoints:Ne("./hover").hoverPoints,selectPoints:Ne("../scatter/select"),meta:{}}},{"../../plots/polar":894,"../scatter/marker_colorbar":1205,"../scatter/select":1209,"../scatter/style":1211,"./attributes":1261,"./calc":1262,"./defaults":1263,"./format_labels":1264,"./hover":1265,"./plot":1267}],1267:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../scatter/plot"),rt=Ne("../../constants/numerical").BADNUM;Ge.exports=function(Ne,Ge,Qe){for(var nt=Ge.layers.frontplot.select("g.scatterlayer"),at={xaxis:Ge.xaxis,yaxis:Ge.yaxis,plot:Ge.framework,layerClipId:Ge._hasClipOnAxisFalse?Ge.clipIds.forTraces:null},it=Ge.radialAxis,ot=Ge.angularAxis,dt=0;dt<Qe.length;dt++)for(var ht=Qe[dt],Dt=0;Dt<ht.length;Dt++){var Ot=ht[Dt],Rt=Ot.r;if(Rt===rt)Ot.x=Ot.y=rt;else{var Zt=it.c2g(Rt),er=ot.c2g(Ot.theta);Ot.x=Zt*Math.cos(er),Ot.y=Zt*Math.sin(er)}}tt(Ne,at,Qe,nt)}},{"../../constants/numerical":753,"../scatter/plot":1208}],1268:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../scatterpolar/attributes"),rt=Ne("../scattergl/attributes"),nt=Ne("../../plots/template_attributes").texttemplateAttrs;Ge.exports={mode:tt.mode,r:tt.r,theta:tt.theta,r0:tt.r0,dr:tt.dr,theta0:tt.theta0,dtheta:tt.dtheta,thetaunit:tt.thetaunit,text:tt.text,texttemplate:nt({editType:"plot"},{keys:["r","theta","text"]}),hovertext:tt.hovertext,hovertemplate:tt.hovertemplate,line:rt.line,connectgaps:rt.connectgaps,marker:rt.marker,fill:rt.fill,fillcolor:rt.fillcolor,textposition:rt.textposition,textfont:rt.textfont,hoverinfo:tt.hoverinfo,selected:tt.selected,unselected:tt.unselected}},{"../../plots/template_attributes":906,"../scattergl/attributes":1239,"../scatterpolar/attributes":1261}],1269:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../scatter/colorscale_calc"),rt=Ne("../scatter/calc").calcMarkerSize,nt=Ne("../scattergl/convert"),at=Ne("../../plots/cartesian/axes"),it=Ne("../scattergl/constants").TOO_MANY_POINTS;Ge.exports=function(Ne,Ge){var Qe=Ne._fullLayout,ot=Ge.subplot,dt=Qe[ot].radialaxis,ht=Qe[ot].angularaxis,Dt=Ge._r=dt.makeCalcdata(Ge,"r"),Ot=Ge._theta=ht.makeCalcdata(Ge,"theta"),Rt=Ge._length,Zt={};Rt<Dt.length&&(Dt=Dt.slice(0,Rt)),Rt<Ot.length&&(Ot=Ot.slice(0,Rt)),Zt.r=Dt,Zt.theta=Ot,tt(Ne,Ge);var er,dr=Zt.opts=nt.style(Ne,Ge);return Rt<it?er=rt(Ge,Rt):dr.marker&&(er=2*(dr.marker.sizeAvg||Math.max(dr.marker.size,3))),Ge._extremes.x=at.findExtremes(dt,Dt,{ppad:er}),[{x:!1,y:!1,t:Zt,trace:Ge}]}},{"../../plots/cartesian/axes":828,"../scatter/calc":1188,"../scatter/colorscale_calc":1190,"../scattergl/constants":1241,"../scattergl/convert":1242}],1270:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../scatter/subtypes"),nt=Ne("../scatterpolar/defaults").handleRThetaDefaults,at=Ne("../scatter/marker_defaults"),it=Ne("../scatter/line_defaults"),ot=Ne("../scatter/text_defaults"),dt=Ne("../scatter/fillcolor_defaults"),ht=Ne("../scatter/constants").PTS_LINESONLY,Dt=Ne("./attributes");Ge.exports=function(Ne,Ge,Qe,Ot){function coerce(Qe,rt){return tt.coerce(Ne,Ge,Dt,Qe,rt)}var Rt=nt(Ne,Ge,Ot,coerce);Rt?(coerce("thetaunit"),coerce("mode",Rt<ht?"lines+markers":"lines"),coerce("text"),coerce("hovertext"),"fills"!==Ge.hoveron&&coerce("hovertemplate"),rt.hasLines(Ge)&&(it(Ne,Ge,Qe,Ot,coerce),coerce("connectgaps")),rt.hasMarkers(Ge)&&at(Ne,Ge,Qe,Ot,coerce),rt.hasText(Ge)&&(coerce("texttemplate"),ot(Ne,Ge,Ot,coerce)),coerce("fill"),"none"!==Ge.fill&&dt(Ne,Ge,Qe,coerce),tt.coerceSelectionMarkerOpacity(Ge,coerce)):Ge.visible=!1}},{"../../lib":778,"../scatter/constants":1191,"../scatter/fillcolor_defaults":1195,"../scatter/line_defaults":1200,"../scatter/marker_defaults":1206,"../scatter/subtypes":1212,"../scatter/text_defaults":1213,"../scatterpolar/defaults":1263,"./attributes":1268}],1271:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../scatterpolar/format_labels");Ge.exports=function(Ne,Ge,Qe){var rt=Ne.i;return"r"in Ne||(Ne.r=Ge._r[rt]),"theta"in Ne||(Ne.theta=Ge._theta[rt]),tt(Ne,Ge,Qe)}},{"../scatterpolar/format_labels":1264}],1272:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../scattergl/hover"),rt=Ne("../scatterpolar/hover").makeHoverPointText;function hoverPoints(Ne,Ge,Qe,nt){var at=Ne.cd[0].t,it=at.r,ot=at.theta,dt=tt.hoverPoints(Ne,Ge,Qe,nt);if(dt&&!1!==dt[0].index){var ht=dt[0];if(void 0===ht.index)return dt;var Dt=Ne.subplot,Ot=ht.cd[ht.index],Rt=ht.trace;if(Ot.r=it[ht.index],Ot.theta=ot[ht.index],Dt.isPtInside(Ot))return ht.xLabelVal=void 0,ht.yLabelVal=void 0,rt(Ot,Rt,Dt,ht),dt}}Ge.exports={hoverPoints:hoverPoints}},{"../scattergl/hover":1247,"../scatterpolar/hover":1265}],1273:[function(Ne,Ge,Qe){"use strict";Ge.exports={moduleType:"trace",name:"scatterpolargl",basePlotModule:Ne("../../plots/polar"),categories:["gl","regl","polar","symbols","showLegend","scatter-like"],attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),colorbar:Ne("../scatter/marker_colorbar"),formatLabels:Ne("./format_labels"),calc:Ne("./calc"),plot:Ne("./plot"),hoverPoints:Ne("./hover").hoverPoints,selectPoints:Ne("../scattergl/select"),meta:{}}},{"../../plots/polar":894,"../scatter/marker_colorbar":1205,"../scattergl/select":1251,"./attributes":1268,"./calc":1269,"./defaults":1270,"./format_labels":1271,"./hover":1272,"./plot":1274}],1274:[function(Ne,Ge,Qe){"use strict";var tt=Ne("@plotly/point-cluster"),rt=Ne("fast-isnumeric"),nt=Ne("../scattergl/plot"),at=Ne("../scattergl/scene_update"),it=Ne("../scattergl/convert"),ot=Ne("../../lib"),dt=Ne("../scattergl/constants").TOO_MANY_POINTS;Ge.exports=function(Ne,Ge,Qe){if(Qe.length){var ht=Ge.radialAxis,Dt=Ge.angularAxis,Ot=at(Ne,Ge);return Qe.forEach((function(Qe){if(Qe&&Qe[0]&&Qe[0].trace){var nt,at=Qe[0],Rt=at.trace,Zt=at.t,er=Rt._length,dr=Zt.r,mr=Zt.theta,xr=Zt.opts,br=dr.slice(),Ar=mr.slice();for(nt=0;nt<dr.length;nt++)Ge.isPtInside({r:dr[nt],theta:mr[nt]})||(br[nt]=NaN,Ar[nt]=NaN);var en=new Array(2*er),mn=Array(er),xn=Array(er);for(nt=0;nt<er;nt++){var kn,Cn,En=br[nt];if(rt(En)){var Pn=ht.c2g(En),Dn=Dt.c2g(Ar[nt],Rt.thetaunit);kn=Pn*Math.cos(Dn),Cn=Pn*Math.sin(Dn)}else kn=Cn=NaN;mn[nt]=en[2*nt]=kn,xn[nt]=en[2*nt+1]=Cn}Zt.tree=tt(en),xr.marker&&er>=dt&&(xr.marker.cluster=Zt.tree),xr.marker&&(xr.markerSel.positions=xr.markerUnsel.positions=xr.marker.positions=en),xr.line&&en.length>1&&ot.extendFlat(xr.line,it.linePositions(Ne,Rt,en)),xr.text&&(ot.extendFlat(xr.text,{positions:en},it.textPosition(Ne,Rt,xr.text,xr.marker)),ot.extendFlat(xr.textSel,{positions:en},it.textPosition(Ne,Rt,xr.text,xr.markerSel)),ot.extendFlat(xr.textUnsel,{positions:en},it.textPosition(Ne,Rt,xr.text,xr.markerUnsel))),xr.fill&&!Ot.fill2d&&(Ot.fill2d=!0),xr.marker&&!Ot.scatter2d&&(Ot.scatter2d=!0),xr.line&&!Ot.line2d&&(Ot.line2d=!0),xr.text&&!Ot.glText&&(Ot.glText=!0),Ot.lineOptions.push(xr.line),Ot.fillOptions.push(xr.fill),Ot.markerOptions.push(xr.marker),Ot.markerSelectedOptions.push(xr.markerSel),Ot.markerUnselectedOptions.push(xr.markerUnsel),Ot.textOptions.push(xr.text),Ot.textSelectedOptions.push(xr.textSel),Ot.textUnselectedOptions.push(xr.textUnsel),Ot.selectBatch.push([]),Ot.unselectBatch.push([]),Zt.x=mn,Zt.y=xn,Zt.rawx=mn,Zt.rawy=xn,Zt.r=dr,Zt.theta=mr,Zt.positions=en,Zt._scene=Ot,Zt.index=Ot.count,Ot.count++}})),nt(Ne,Ge,Qe)}}},{"../../lib":778,"../scattergl/constants":1241,"../scattergl/convert":1242,"../scattergl/plot":1249,"../scattergl/scene_update":1250,"@plotly/point-cluster":57,"fast-isnumeric":241}],1275:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/template_attributes").hovertemplateAttrs,rt=Ne("../../plots/template_attributes").texttemplateAttrs,nt=Ne("../scatter/attributes"),at=Ne("../../plots/attributes"),it=Ne("../../components/colorscale/attributes"),ot=Ne("../../components/drawing/attributes").dash,dt=Ne("../../lib/extend").extendFlat,ht=nt.marker,Dt=nt.line,Ot=ht.line;Ge.exports={a:{valType:"data_array",editType:"calc"},b:{valType:"data_array",editType:"calc"},c:{valType:"data_array",editType:"calc"},sum:{valType:"number",dflt:0,min:0,editType:"calc"},mode:dt({},nt.mode,{dflt:"markers"}),text:dt({},nt.text,{}),texttemplate:rt({editType:"plot"},{keys:["a","b","c","text"]}),hovertext:dt({},nt.hovertext,{}),line:{color:Dt.color,width:Dt.width,dash:ot,shape:dt({},Dt.shape,{values:["linear","spline"]}),smoothing:Dt.smoothing,editType:"calc"},connectgaps:nt.connectgaps,cliponaxis:nt.cliponaxis,fill:dt({},nt.fill,{values:["none","toself","tonext"],dflt:"none"}),fillcolor:nt.fillcolor,marker:dt({symbol:ht.symbol,opacity:ht.opacity,maxdisplayed:ht.maxdisplayed,size:ht.size,sizeref:ht.sizeref,sizemin:ht.sizemin,sizemode:ht.sizemode,line:dt({width:Ot.width,editType:"calc"},it("marker.line")),gradient:ht.gradient,editType:"calc"},it("marker")),textfont:nt.textfont,textposition:nt.textposition,selected:nt.selected,unselected:nt.unselected,hoverinfo:dt({},at.hoverinfo,{flags:["a","b","c","text","name"]}),hoveron:nt.hoveron,hovertemplate:tt()}},{"../../components/colorscale/attributes":650,"../../components/drawing/attributes":664,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../scatter/attributes":1187}],1276:[function(Ne,Ge,Qe){"use strict";var tt=Ne("fast-isnumeric"),rt=Ne("../scatter/colorscale_calc"),nt=Ne("../scatter/arrays_to_calcdata"),at=Ne("../scatter/calc_selection"),it=Ne("../scatter/calc").calcMarkerSize,ot=["a","b","c"],dt={a:["b","c"],b:["a","c"],c:["a","b"]};Ge.exports=function(Ne,Ge){var Qe,ht,Dt,Ot,Rt,Zt,er=Ne._fullLayout[Ge.subplot].sum,dr=Ge.sum||er,mr={a:Ge.a,b:Ge.b,c:Ge.c};for(Qe=0;Qe<ot.length;Qe++)if(!mr[Dt=ot[Qe]]){for(Rt=mr[dt[Dt][0]],Zt=mr[dt[Dt][1]],Ot=new Array(Rt.length),ht=0;ht<Rt.length;ht++)Ot[ht]=dr-Rt[ht]-Zt[ht];mr[Dt]=Ot}var xr,br,Ar,en,mn,xn,kn=Ge._length,Cn=new Array(kn);for(Qe=0;Qe<kn;Qe++)xr=mr.a[Qe],br=mr.b[Qe],Ar=mr.c[Qe],tt(xr)&&tt(br)&&tt(Ar)?(1!=(en=er/((xr=+xr)+(br=+br)+(Ar=+Ar)))&&(xr*=en,br*=en,Ar*=en),xn=xr,mn=Ar-br,Cn[Qe]={x:mn,y:xn,a:xr,b:br,c:Ar}):Cn[Qe]={x:!1,y:!1};return it(Ge,kn),rt(Ne,Ge),nt(Cn,Ge),at(Cn,Ge),Cn}},{"../scatter/arrays_to_calcdata":1186,"../scatter/calc":1188,"../scatter/calc_selection":1189,"../scatter/colorscale_calc":1190,"fast-isnumeric":241}],1277:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../scatter/constants"),nt=Ne("../scatter/subtypes"),at=Ne("../scatter/marker_defaults"),it=Ne("../scatter/line_defaults"),ot=Ne("../scatter/line_shape_defaults"),dt=Ne("../scatter/text_defaults"),ht=Ne("../scatter/fillcolor_defaults"),Dt=Ne("./attributes");Ge.exports=function(Ne,Ge,Qe,Ot){function coerce(Qe,rt){return tt.coerce(Ne,Ge,Dt,Qe,rt)}var Rt,Zt=coerce("a"),er=coerce("b"),dr=coerce("c");if(Zt?(Rt=Zt.length,er?(Rt=Math.min(Rt,er.length),dr&&(Rt=Math.min(Rt,dr.length))):Rt=dr?Math.min(Rt,dr.length):0):er&&dr&&(Rt=Math.min(er.length,dr.length)),Rt){Ge._length=Rt,coerce("sum"),coerce("text"),coerce("hovertext"),"fills"!==Ge.hoveron&&coerce("hovertemplate"),coerce("mode",Rt<rt.PTS_LINESONLY?"lines+markers":"lines"),nt.hasLines(Ge)&&(it(Ne,Ge,Qe,Ot,coerce),ot(Ne,Ge,coerce),coerce("connectgaps")),nt.hasMarkers(Ge)&&at(Ne,Ge,Qe,Ot,coerce,{gradient:!0}),nt.hasText(Ge)&&(coerce("texttemplate"),dt(Ne,Ge,Ot,coerce));var mr=[];(nt.hasMarkers(Ge)||nt.hasText(Ge))&&(coerce("cliponaxis"),coerce("marker.maxdisplayed"),mr.push("points")),coerce("fill"),"none"!==Ge.fill&&(ht(Ne,Ge,Qe,coerce),nt.hasLines(Ge)||ot(Ne,Ge,coerce)),"tonext"!==Ge.fill&&"toself"!==Ge.fill||mr.push("fills"),coerce("hoveron",mr.join("+")||"points"),tt.coerceSelectionMarkerOpacity(Ge,coerce)}else Ge.visible=!1}},{"../../lib":778,"../scatter/constants":1191,"../scatter/fillcolor_defaults":1195,"../scatter/line_defaults":1200,"../scatter/line_shape_defaults":1202,"../scatter/marker_defaults":1206,"../scatter/subtypes":1212,"../scatter/text_defaults":1213,"./attributes":1275}],1278:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge,Qe,tt,rt){if(Ge.xa&&(Ne.xaxis=Ge.xa),Ge.ya&&(Ne.yaxis=Ge.ya),tt[rt]){var nt=tt[rt];Ne.a=nt.a,Ne.b=nt.b,Ne.c=nt.c}else Ne.a=Ge.a,Ne.b=Ge.b,Ne.c=Ge.c;return Ne}},{}],1279:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/cartesian/axes");Ge.exports=function(Ne,Ge,Qe){var rt={},nt=Qe[Ge.subplot]._subplot;return rt.aLabel=tt.tickText(nt.aaxis,Ne.a,!0).text,rt.bLabel=tt.tickText(nt.baxis,Ne.b,!0).text,rt.cLabel=tt.tickText(nt.caxis,Ne.c,!0).text,rt}},{"../../plots/cartesian/axes":828}],1280:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../scatter/hover");Ge.exports=function(Ne,Ge,Qe,rt){var nt=tt(Ne,Ge,Qe,rt);if(nt&&!1!==nt[0].index){var at=nt[0];if(void 0===at.index){var it=1-at.y0/Ne.ya._length,ot=Ne.xa._length,dt=ot*it/2,ht=ot-dt;return at.x0=Math.max(Math.min(at.x0,ht),dt),at.x1=Math.max(Math.min(at.x1,ht),dt),nt}var Dt=at.cd[at.index],Ot=at.trace,Rt=at.subplot;at.a=Dt.a,at.b=Dt.b,at.c=Dt.c,at.xLabelVal=void 0,at.yLabelVal=void 0;var Zt={};Zt[Ot.subplot]={_subplot:Rt};var er=Ot._module.formatLabels(Dt,Ot,Zt);at.aLabel=er.aLabel,at.bLabel=er.bLabel,at.cLabel=er.cLabel;var dr=Dt.hi||Ot.hoverinfo,mr=[];if(!Ot.hovertemplate){var xr=dr.split("+");-1!==xr.indexOf("all")&&(xr=["a","b","c"]),-1!==xr.indexOf("a")&&textPart(Rt.aaxis,at.aLabel),-1!==xr.indexOf("b")&&textPart(Rt.baxis,at.bLabel),-1!==xr.indexOf("c")&&textPart(Rt.caxis,at.cLabel)}return at.extraText=mr.join("<br>"),at.hovertemplate=Ot.hovertemplate,nt}function textPart(Ne,Ge){mr.push(Ne._hovertitle+": "+Ge)}}},{"../scatter/hover":1198}],1281:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),colorbar:Ne("../scatter/marker_colorbar"),formatLabels:Ne("./format_labels"),calc:Ne("./calc"),plot:Ne("./plot"),style:Ne("../scatter/style").style,styleOnSelect:Ne("../scatter/style").styleOnSelect,hoverPoints:Ne("./hover"),selectPoints:Ne("../scatter/select"),eventData:Ne("./event_data"),moduleType:"trace",name:"scatterternary",basePlotModule:Ne("../../plots/ternary"),categories:["ternary","symbols","showLegend","scatter-like"],meta:{}}},{"../../plots/ternary":907,"../scatter/marker_colorbar":1205,"../scatter/select":1209,"../scatter/style":1211,"./attributes":1275,"./calc":1276,"./defaults":1277,"./event_data":1278,"./format_labels":1279,"./hover":1280,"./plot":1282}],1282:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../scatter/plot");Ge.exports=function(Ne,Ge,Qe){var rt=Ge.plotContainer;rt.select(".scatterlayer").selectAll("*").remove();var nt={xaxis:Ge.xaxis,yaxis:Ge.yaxis,plot:rt,layerClipId:Ge._hasClipOnAxisFalse?Ge.clipIdRelative:null},at=Ge.layers.frontplot.select("g.scatterlayer");tt(Ne,nt,Qe,at)}},{"../scatter/plot":1208}],1283:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../scatter/attributes"),rt=Ne("../../components/colorscale/attributes"),nt=Ne("../../plots/template_attributes").hovertemplateAttrs,at=Ne("../scattergl/attributes"),it=Ne("../../plots/cartesian/constants").idRegex,ot=Ne("../../plot_api/plot_template").templatedArray,dt=Ne("../../lib/extend").extendFlat,ht=tt.marker,Dt=ht.line,Ot=dt(rt("marker.line",{editTypeOverride:"calc"}),{width:dt({},Dt.width,{editType:"calc"}),editType:"calc"}),Rt=dt(rt("marker"),{symbol:ht.symbol,size:dt({},ht.size,{editType:"markerSize"}),sizeref:ht.sizeref,sizemin:ht.sizemin,sizemode:ht.sizemode,opacity:ht.opacity,colorbar:ht.colorbar,line:Ot,editType:"calc"});function makeAxesValObject(Ne){return{valType:"info_array",freeLength:!0,editType:"calc",items:{valType:"subplotid",regex:it[Ne],editType:"plot"}}}Rt.color.editType=Rt.cmin.editType=Rt.cmax.editType="style",Ge.exports={dimensions:ot("dimension",{visible:{valType:"boolean",dflt:!0,editType:"calc"},label:{valType:"string",editType:"calc"},values:{valType:"data_array",editType:"calc+clearAxisTypes"},axis:{type:{valType:"enumerated",values:["linear","log","date","category"],editType:"calc+clearAxisTypes"},matches:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc+clearAxisTypes"},editType:"calc+clearAxisTypes"}),text:dt({},at.text,{}),hovertext:dt({},at.hovertext,{}),hovertemplate:nt(),marker:Rt,xaxes:makeAxesValObject("x"),yaxes:makeAxesValObject("y"),diagonal:{visible:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},showupperhalf:{valType:"boolean",dflt:!0,editType:"calc"},showlowerhalf:{valType:"boolean",dflt:!0,editType:"calc"},selected:{marker:at.selected.marker,editType:"calc"},unselected:{marker:at.unselected.marker,editType:"calc"},opacity:at.opacity}},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plot_api/plot_template":817,"../../plots/cartesian/constants":834,"../../plots/template_attributes":906,"../scatter/attributes":1187,"../scattergl/attributes":1239}],1284:[function(Ne,Ge,Qe){"use strict";var tt=Ne("regl-line2d"),rt=Ne("../../registry"),nt=Ne("../../lib/prepare_regl"),at=Ne("../../plots/get_data").getModuleCalcData,it=Ne("../../plots/cartesian"),ot=Ne("../../plots/cartesian/axis_ids").getFromId,dt=Ne("../../plots/cartesian/axes").shouldShowZeroLine,ht="splom";function plot(Ne){var Ge=Ne._fullLayout,Qe=rt.getModule(ht),tt=at(Ne.calcdata,Qe)[0];nt(Ne,["ANGLE_instanced_arrays","OES_element_index_uint"])&&(Ge._hasOnlyLargeSploms&&updateGrid(Ne),Qe.plot(Ne,{},tt))}function drag(Ne){var Ge=Ne.calcdata,Qe=Ne._fullLayout;Qe._hasOnlyLargeSploms&&updateGrid(Ne);for(var tt=0;tt<Ge.length;tt++){var rt=Ge[tt][0].trace,nt=Qe._splomScenes[rt.uid];"splom"===rt.type&&nt&&nt.matrix&&dragOne(Ne,rt,nt)}}function dragOne(Ne,Ge,Qe){for(var tt=Qe.matrixOptions.data.length,rt=Ge._visibleDims,nt=Qe.viewOpts.ranges=new Array(tt),at=0;at<rt.length;at++){var it=rt[at],dt=nt[at]=new Array(4),ht=ot(Ne,Ge._diag[it][0]);ht&&(dt[0]=ht.r2l(ht.range[0]),dt[2]=ht.r2l(ht.range[1]));var Dt=ot(Ne,Ge._diag[it][1]);Dt&&(dt[1]=Dt.r2l(Dt.range[0]),dt[3]=Dt.r2l(Dt.range[1]))}Qe.selectBatch.length||Qe.unselectBatch.length?Qe.matrix.update({ranges:nt},{ranges:nt}):Qe.matrix.update({ranges:nt})}function updateGrid(Ne){var Ge=Ne._fullLayout,Qe=Ge._glcanvas.data()[0].regl,rt=Ge._splomGrid;rt||(rt=Ge._splomGrid=tt(Qe)),rt.update(makeGridData(Ne))}function makeGridData(Ne){var Ge,Qe=Ne._fullLayout,tt=Qe._size,rt=[0,0,Qe.width,Qe.height],nt={};function push(Ne,Ge,Qe,tt,at,it){var ot=Ge[Ne+"color"],dt=Ge[Ne+"width"],ht=String(ot+dt);ht in nt?nt[ht].data.push(NaN,NaN,Qe,tt,at,it):nt[ht]={data:[Qe,tt,at,it],join:"rect",thickness:dt,color:ot,viewport:rt,range:rt,overlay:!1}}for(Ge in Qe._splomSubplots){var at,it,ot=Qe._plots[Ge],ht=ot.xaxis,Dt=ot.yaxis,Ot=ht._gridVals,Rt=Dt._gridVals,Zt=tt.b+Dt.domain[0]*tt.h,er=-Dt._m,dr=-er*Dt.r2l(Dt.range[0],Dt.calendar);if(ht.showgrid)for(Ge=0;Ge<Ot.length;Ge++)at=ht._offset+ht.l2p(Ot[Ge].x),push("grid",ht,at,Zt,at,Zt+Dt._length);if(Dt.showgrid)for(Ge=0;Ge<Rt.length;Ge++)it=Zt+dr+er*Rt[Ge].x,push("grid",Dt,ht._offset,it,ht._offset+ht._length,it);dt(Ne,ht,Dt)&&(at=ht._offset+ht.l2p(0),push("zeroline",ht,at,Zt,at,Zt+Dt._length)),dt(Ne,Dt,ht)&&(it=Zt+dr+0,push("zeroline",Dt,ht._offset,it,ht._offset+ht._length,it))}var mr=[];for(Ge in nt)mr.push(nt[Ge]);return mr}function clean(Ne,Ge,Qe,tt){var rt,nt={};if(tt._splomScenes){for(rt=0;rt<Ne.length;rt++){var at=Ne[rt];"splom"===at.type&&(nt[at.uid]=1)}for(rt=0;rt<Qe.length;rt++){var ot=Qe[rt];if(!nt[ot.uid]){var dt=tt._splomScenes[ot.uid];dt&&dt.destroy&&dt.destroy(),tt._splomScenes[ot.uid]=null,delete tt._splomScenes[ot.uid]}}}0===Object.keys(tt._splomScenes||{}).length&&delete tt._splomScenes,tt._splomGrid&&!Ge._hasOnlyLargeSploms&&tt._hasOnlyLargeSploms&&(tt._splomGrid.destroy(),tt._splomGrid=null,delete tt._splomGrid),it.clean(Ne,Ge,Qe,tt)}Ge.exports={name:ht,attr:it.attr,attrRegex:it.attrRegex,layoutAttributes:it.layoutAttributes,supplyLayoutDefaults:it.supplyLayoutDefaults,drawFramework:it.drawFramework,plot:plot,drag:drag,updateGrid:updateGrid,clean:clean,updateFx:it.updateFx,toSVG:it.toSVG}},{"../../lib/prepare_regl":791,"../../plots/cartesian":841,"../../plots/cartesian/axes":828,"../../plots/cartesian/axis_ids":831,"../../plots/get_data":865,"../../registry":911,"regl-line2d":535}],1285:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../plots/cartesian/axis_ids"),nt=Ne("../scatter/calc").calcMarkerSize,at=Ne("../scatter/calc").calcAxisExpansion,it=Ne("../scatter/colorscale_calc"),ot=Ne("../scattergl/convert").markerSelection,dt=Ne("../scattergl/convert").markerStyle,ht=Ne("./scene_update"),Dt=Ne("../../constants/numerical").BADNUM,Ot=Ne("../scattergl/constants").TOO_MANY_POINTS;Ge.exports=function(Ne,Ge){var Qe,Rt,Zt,er,dr,mr,xr=Ge.dimensions,br=Ge._length,Ar={},en=Ar.cdata=[],mn=Ar.data=[],xn=Ge._visibleDims=[];function makeCalcdata(Ne,Qe){for(var rt=Ne.makeCalcdata({v:Qe.values,vcalendar:Ge.calendar},"v"),nt=0;nt<rt.length;nt++)rt[nt]=rt[nt]===Dt?NaN:rt[nt];en.push(rt),mn.push("log"===Ne.type?tt.simpleMap(rt,Ne.c2l):rt)}for(Qe=0;Qe<xr.length;Qe++)if((Zt=xr[Qe]).visible){if(er=rt.getFromId(Ne,Ge._diag[Qe][0]),dr=rt.getFromId(Ne,Ge._diag[Qe][1]),er&&dr&&er.type!==dr.type){tt.log("Skipping splom dimension "+Qe+" with conflicting axis types");continue}er?(makeCalcdata(er,Zt),dr&&"category"===dr.type&&(dr._categories=er._categories.slice())):makeCalcdata(dr,Zt),xn.push(Qe)}for(it(Ne,Ge),tt.extendFlat(Ar,dt(Ge)),mr=en.length*br>Ot?2*(Ar.sizeAvg||Math.max(Ar.size,3)):nt(Ge,br),Rt=0;Rt<xn.length;Rt++)Zt=xr[Qe=xn[Rt]],er=rt.getFromId(Ne,Ge._diag[Qe][0])||{},dr=rt.getFromId(Ne,Ge._diag[Qe][1])||{},at(Ne,Ge,er,dr,en[Rt],en[Rt],mr);var kn=ht(Ne,Ge);return kn.matrix||(kn.matrix=!0),kn.matrixOptions=Ar,kn.selectedOptions=ot(Ge,Ge.selected),kn.unselectedOptions=ot(Ge,Ge.unselected),[{x:!1,y:!1,t:{},trace:Ge}]}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/axis_ids":831,"../scatter/calc":1188,"../scatter/colorscale_calc":1190,"../scattergl/constants":1241,"../scattergl/convert":1242,"./scene_update":1292}],1286:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../plots/array_container_defaults"),nt=Ne("./attributes"),at=Ne("../scatter/subtypes"),it=Ne("../scatter/marker_defaults"),ot=Ne("../parcoords/merge_length"),dt=Ne("../scattergl/helpers").isOpenSymbol;function dimensionDefaults(Ne,Ge){function coerce(Qe,rt){return tt.coerce(Ne,Ge,nt.dimensions,Qe,rt)}coerce("label");var Qe=coerce("values");Qe&&Qe.length?coerce("visible"):Ge.visible=!1,coerce("axis.type"),coerce("axis.matches")}function handleAxisDefaults(Ne,Ge,Qe,tt){var rt,nt,at=Ge.dimensions,it=at.length,ot=Ge.showupperhalf,dt=Ge.showlowerhalf,ht=Ge.diagonal.visible,Dt=new Array(it),Ot=new Array(it);for(rt=0;rt<it;rt++){var Rt=rt?rt+1:"";Dt[rt]="x"+Rt,Ot[rt]="y"+Rt}var Zt=tt("xaxes",Dt),er=tt("yaxes",Ot),dr=Ge._diag=new Array(it);Ge._xaxes={},Ge._yaxes={};var mr=[],xr=[];function fillAxisStashes(Ne,tt,rt,nt){if(Ne){var at=Ne.charAt(0),it=Qe._splomAxes[at];if(Ge["_"+at+"axes"][Ne]=1,nt.push(Ne),!(Ne in it)){var ot=it[Ne]={};rt&&(ot.label=rt.label||"",rt.visible&&rt.axis&&(rt.axis.type&&(ot.type=rt.axis.type),rt.axis.matches&&(ot.matches=tt)))}}}var br=!ht&&!dt,Ar=!ht&&!ot;for(Ge._axesDim={},rt=0;rt<it;rt++){var en=at[rt],mn=0===rt,xn=rt===it-1,kn=mn&&br||xn&&Ar?void 0:Zt[rt],Cn=mn&&Ar||xn&&br?void 0:er[rt];fillAxisStashes(kn,Cn,en,mr),fillAxisStashes(Cn,kn,en,xr),dr[rt]=[kn,Cn],Ge._axesDim[kn]=rt,Ge._axesDim[Cn]=rt}for(rt=0;rt<mr.length;rt++)for(nt=0;nt<xr.length;nt++){var En=mr[rt]+xr[nt];rt>nt&&ot||rt<nt&&dt?Qe._splomSubplots[En]=1:rt!==nt||!ht&&dt&&ot||(Qe._splomSubplots[En]=1)}(!dt||!ht&&ot&&dt)&&(Qe._splomGridDflt.xside="bottom",Qe._splomGridDflt.yside="left")}Ge.exports=function(Ne,Ge,Qe,ht){function coerce(Qe,rt){return tt.coerce(Ne,Ge,nt,Qe,rt)}var Dt=rt(Ne,Ge,{name:"dimensions",handleItemDefaults:dimensionDefaults}),Ot=coerce("diagonal.visible"),Rt=coerce("showupperhalf"),Zt=coerce("showlowerhalf");if(ot(Ge,Dt,"values")&&(Ot||Rt||Zt)){coerce("text"),coerce("hovertext"),coerce("hovertemplate"),it(Ne,Ge,Qe,ht,coerce);var er=dt(Ge.marker.symbol),dr=at.isBubble(Ge);coerce("marker.line.width",er||dr?1:0),handleAxisDefaults(Ne,Ge,ht,coerce),tt.coerceSelectionMarkerOpacity(Ge,coerce)}else Ge.visible=!1}},{"../../lib":778,"../../plots/array_container_defaults":823,"../parcoords/merge_length":1158,"../scatter/marker_defaults":1206,"../scatter/subtypes":1212,"../scattergl/helpers":1246,"./attributes":1283}],1287:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../scatter/colorscale_calc"),nt=Ne("../scattergl/convert").markerStyle;Ge.exports=function(Ne,Ge){var Qe=Ge.trace,at=Ne._fullLayout._splomScenes[Qe.uid];if(at){rt(Ne,Qe),tt.extendFlat(at.matrixOptions,nt(Qe));var it=tt.extendFlat({},at.matrixOptions,at.viewOpts);at.matrix.update(it,null)}}},{"../../lib":778,"../scatter/colorscale_calc":1190,"../scattergl/convert":1242}],1288:[function(Ne,Ge,Qe){"use strict";Qe.getDimIndex=function(Ne,Ge){for(var Qe=Ge._id,tt={x:0,y:1}[Qe.charAt(0)],rt=Ne._visibleDims,nt=0;nt<rt.length;nt++){var at=rt[nt];if(Ne._diag[at][tt]===Qe)return nt}return!1}},{}],1289:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./helpers"),rt=Ne("../scattergl/hover").calcHover;function hoverPoints(Ne,Ge,Qe){var nt=Ne.cd[0].trace,at=Ne.scene.matrixOptions.cdata,it=Ne.xa,ot=Ne.ya,dt=it.c2p(Ge),ht=ot.c2p(Qe),Dt=Ne.distance,Ot=tt.getDimIndex(nt,it),Rt=tt.getDimIndex(nt,ot);if(!1===Ot||!1===Rt)return[Ne];for(var Zt,er,dr=at[Ot],mr=at[Rt],xr=Dt,br=0;br<dr.length;br++){var Ar=dr[br],en=mr[br],mn=it.c2p(Ar)-dt,xn=ot.c2p(en)-ht,kn=Math.sqrt(mn*mn+xn*xn);kn<xr&&(xr=er=kn,Zt=br)}return Ne.index=Zt,Ne.distance=xr,Ne.dxy=er,void 0===Zt?[Ne]:[rt(Ne,dr,mr,nt)]}Ge.exports={hoverPoints:hoverPoints}},{"../scattergl/hover":1247,"./helpers":1288}],1290:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../registry"),rt=Ne("../../components/grid");Ge.exports={moduleType:"trace",name:"splom",basePlotModule:Ne("./base_plot"),categories:["gl","regl","cartesian","symbols","showLegend","scatter-like"],attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),colorbar:Ne("../scatter/marker_colorbar"),calc:Ne("./calc"),plot:Ne("./plot"),hoverPoints:Ne("./hover").hoverPoints,selectPoints:Ne("./select"),editStyle:Ne("./edit_style"),meta:{}},tt.register(rt)},{"../../components/grid":687,"../../registry":911,"../scatter/marker_colorbar":1205,"./attributes":1283,"./base_plot":1284,"./calc":1285,"./defaults":1286,"./edit_style":1287,"./hover":1289,"./plot":1291,"./select":1293}],1291:[function(Ne,Ge,Qe){"use strict";var tt=Ne("regl-splom"),rt=Ne("../../lib"),nt=Ne("../../plots/cartesian/axis_ids"),at=Ne("../../components/dragelement/helpers").selectMode;function plotOne(Ne,Ge){var Qe,it,ot,dt,ht,Dt=Ne._fullLayout,Ot=Dt._size,Rt=Ge.trace,Zt=Ge.t,er=Dt._splomScenes[Rt.uid],dr=er.matrixOptions,mr=dr.cdata,xr=Dt._glcanvas.data()[0].regl,br=Dt.dragmode;if(0!==mr.length){dr.lower=Rt.showupperhalf,dr.upper=Rt.showlowerhalf,dr.diagonal=Rt.diagonal.visible;var Ar=Rt._visibleDims,en=mr.length,mn=er.viewOpts={};for(mn.ranges=new Array(en),mn.domains=new Array(en),ht=0;ht<Ar.length;ht++){ot=Ar[ht];var xn=mn.ranges[ht]=new Array(4),kn=mn.domains[ht]=new Array(4);(Qe=nt.getFromId(Ne,Rt._diag[ot][0]))&&(xn[0]=Qe._rl[0],xn[2]=Qe._rl[1],kn[0]=Qe.domain[0],kn[2]=Qe.domain[1]),(it=nt.getFromId(Ne,Rt._diag[ot][1]))&&(xn[1]=it._rl[0],xn[3]=it._rl[1],kn[1]=it.domain[0],kn[3]=it.domain[1])}mn.viewport=[Ot.l,Ot.b,Ot.w+Ot.l,Ot.h+Ot.b],!0===er.matrix&&(er.matrix=tt(xr));var Cn=Dt.clickmode.indexOf("select")>-1,En=!0;if(at(br)||Rt.selectedpoints||Cn){var Pn=Rt._length;if(Rt.selectedpoints){er.selectBatch=Rt.selectedpoints;var Dn=Rt.selectedpoints,In={};for(ot=0;ot<Dn.length;ot++)In[Dn[ot]]=!0;var zn=[];for(ot=0;ot<Pn;ot++)In[ot]||zn.push(ot);er.unselectBatch=zn}var Bn=Zt.xpx=new Array(en),Vn=Zt.ypx=new Array(en);for(ht=0;ht<Ar.length;ht++){if(ot=Ar[ht],Qe=nt.getFromId(Ne,Rt._diag[ot][0]))for(Bn[ht]=new Array(Pn),dt=0;dt<Pn;dt++)Bn[ht][dt]=Qe.c2p(mr[ht][dt]);if(it=nt.getFromId(Ne,Rt._diag[ot][1]))for(Vn[ht]=new Array(Pn),dt=0;dt<Pn;dt++)Vn[ht][dt]=it.c2p(mr[ht][dt])}if(er.selectBatch.length||er.unselectBatch.length){var Hn=rt.extendFlat({},dr,er.unselectedOptions,mn),qn=rt.extendFlat({},dr,er.selectedOptions,mn);er.matrix.update(Hn,qn),En=!1}}else Zt.xpx=Zt.ypx=null;if(En){var Yn=rt.extendFlat({},dr,mn);er.matrix.update(Yn,null)}}}Ge.exports=function(Ne,Ge,Qe){if(Qe.length)for(var tt=0;tt<Qe.length;tt++)plotOne(Ne,Qe[tt][0])}},{"../../components/dragelement/helpers":661,"../../lib":778,"../../plots/cartesian/axis_ids":831,"regl-splom":539}],1292:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib");Ge.exports=function(Ne,Ge){var Qe=Ne._fullLayout,rt=Ge.uid,nt=Qe._splomScenes;nt||(nt=Qe._splomScenes={});var at={dirty:!0,selectBatch:[],unselectBatch:[]},it={matrix:!1,selectBatch:[],unselectBatch:[]},ot=nt[Ge.uid];return ot||((ot=nt[rt]=tt.extendFlat({},at,it)).draw=function(){ot.matrix&&ot.matrix.draw&&(ot.selectBatch.length||ot.unselectBatch.length?ot.matrix.draw(ot.unselectBatch,ot.selectBatch):ot.matrix.draw()),ot.dirty=!1},ot.destroy=function(){ot.matrix&&ot.matrix.destroy&&ot.matrix.destroy(),ot.matrixOptions=null,ot.selectBatch=null,ot.unselectBatch=null,ot=null}),ot.dirty||tt.extendFlat(ot,at),ot}},{"../../lib":778}],1293:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../scatter/subtypes"),nt=Ne("./helpers");Ge.exports=function(Ne,Ge){var Qe=Ne.cd,at=Qe[0].trace,it=Qe[0].t,ot=Ne.scene,dt=ot.matrixOptions.cdata,ht=Ne.xaxis,Dt=Ne.yaxis,Ot=[];if(!ot)return Ot;var Rt=!rt.hasMarkers(at)&&!rt.hasText(at);if(!0!==at.visible||Rt)return Ot;var Zt=nt.getDimIndex(at,ht),er=nt.getDimIndex(at,Dt);if(!1===Zt||!1===er)return Ot;var dr=it.xpx[Zt],mr=it.ypx[er],xr=dt[Zt],br=dt[er],Ar=[],en=[];if(!1!==Ge&&!Ge.degenerate)for(var mn=0;mn<xr.length;mn++)Ge.contains([dr[mn],mr[mn]],null,mn,Ne)?(Ar.push(mn),Ot.push({pointNumber:mn,x:xr[mn],y:br[mn]})):en.push(mn);var xn=ot.matrixOptions;return Ar.length||en.length?ot.selectBatch.length||ot.unselectBatch.length||ot.matrix.update(ot.unselectedOptions,tt.extendFlat({},xn,ot.selectedOptions,ot.viewOpts)):ot.matrix.update(xn,null),ot.selectBatch=Ar,ot.unselectBatch=en,Ot}},{"../../lib":778,"../scatter/subtypes":1212,"./helpers":1288}],1294:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/colorscale/attributes"),rt=Ne("../../plots/template_attributes").hovertemplateAttrs,nt=Ne("../mesh3d/attributes"),at=Ne("../../plots/attributes"),it=Ne("../../lib/extend").extendFlat,ot={x:{valType:"data_array",editType:"calc+clearAxisTypes"},y:{valType:"data_array",editType:"calc+clearAxisTypes"},z:{valType:"data_array",editType:"calc+clearAxisTypes"},u:{valType:"data_array",editType:"calc"},v:{valType:"data_array",editType:"calc"},w:{valType:"data_array",editType:"calc"},starts:{x:{valType:"data_array",editType:"calc"},y:{valType:"data_array",editType:"calc"},z:{valType:"data_array",editType:"calc"},editType:"calc"},maxdisplayed:{valType:"integer",min:0,dflt:1e3,editType:"calc"},sizeref:{valType:"number",editType:"calc",min:0,dflt:1},text:{valType:"string",dflt:"",editType:"calc"},hovertext:{valType:"string",dflt:"",editType:"calc"},hovertemplate:rt({editType:"calc"},{keys:["tubex","tubey","tubez","tubeu","tubev","tubew","norm","divergence"]}),showlegend:it({},at.showlegend,{dflt:!1})};it(ot,tt("",{colorAttr:"u/v/w norm",showScaleDflt:!0,editTypeOverride:"calc"})),["opacity","lightposition","lighting"].forEach((function(Ne){ot[Ne]=nt[Ne]})),ot.hoverinfo=it({},at.hoverinfo,{editType:"calc",flags:["x","y","z","u","v","w","norm","divergence","text","name"],dflt:"x+y+z+norm+text+name"}),ot.transforms=void 0,Ge.exports=ot},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../mesh3d/attributes":1128}],1295:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../components/colorscale/calc");function calc(Ne,Ge){Ge._len=Math.min(Ge.u.length,Ge.v.length,Ge.w.length,Ge.x.length,Ge.y.length,Ge.z.length),Ge._u=filter(Ge.u,Ge._len),Ge._v=filter(Ge.v,Ge._len),Ge._w=filter(Ge.w,Ge._len),Ge._x=filter(Ge.x,Ge._len),Ge._y=filter(Ge.y,Ge._len),Ge._z=filter(Ge.z,Ge._len);var Qe=processGrid(Ge);Ge._gridFill=Qe.fill,Ge._Xs=Qe.Xs,Ge._Ys=Qe.Ys,Ge._Zs=Qe.Zs,Ge._len=Qe.len;var tt,nt,at,it=0;Ge.starts&&(tt=filter(Ge.starts.x||[]),nt=filter(Ge.starts.y||[]),at=filter(Ge.starts.z||[]),it=Math.min(tt.length,nt.length,at.length)),Ge._startsX=tt||[],Ge._startsY=nt||[],Ge._startsZ=at||[];var ot,dt=0,ht=1/0;for(ot=0;ot<Ge._len;ot++){var Dt=Ge._u[ot],Ot=Ge._v[ot],Rt=Ge._w[ot],Zt=Math.sqrt(Dt*Dt+Ot*Ot+Rt*Rt);dt=Math.max(dt,Zt),ht=Math.min(ht,Zt)}for(rt(Ne,Ge,{vals:[ht,dt],containerStr:"",cLetter:"c"}),ot=0;ot<it;ot++){var er=tt[ot];Qe.xMax=Math.max(Qe.xMax,er),Qe.xMin=Math.min(Qe.xMin,er);var dr=nt[ot];Qe.yMax=Math.max(Qe.yMax,dr),Qe.yMin=Math.min(Qe.yMin,dr);var mr=at[ot];Qe.zMax=Math.max(Qe.zMax,mr),Qe.zMin=Math.min(Qe.zMin,mr)}Ge._slen=it,Ge._normMax=dt,Ge._xbnds=[Qe.xMin,Qe.xMax],Ge._ybnds=[Qe.yMin,Qe.yMax],Ge._zbnds=[Qe.zMin,Qe.zMax]}function processGrid(Ne){var Ge,Qe,rt,nt,at,it,ot,dt,ht,Dt,Ot,Rt,Zt=Ne._x,er=Ne._y,dr=Ne._z,mr=Ne._len,xr=-1/0,br=1/0,Ar=-1/0,en=1/0,mn=-1/0,xn=1/0,kn="";for(mr&&(ot=Zt[0],ht=er[0],Ot=dr[0]),mr>1&&(dt=Zt[mr-1],Dt=er[mr-1],Rt=dr[mr-1]),Ge=0;Ge<mr;Ge++)xr=Math.max(xr,Zt[Ge]),br=Math.min(br,Zt[Ge]),Ar=Math.max(Ar,er[Ge]),en=Math.min(en,er[Ge]),mn=Math.max(mn,dr[Ge]),xn=Math.min(xn,dr[Ge]),nt||Zt[Ge]===ot||(nt=!0,kn+="x"),at||er[Ge]===ht||(at=!0,kn+="y"),it||dr[Ge]===Ot||(it=!0,kn+="z");nt||(kn+="x"),at||(kn+="y"),it||(kn+="z");var Cn=distinctVals(Ne._x),En=distinctVals(Ne._y),Pn=distinctVals(Ne._z);kn=(kn=(kn=kn.replace("x",(ot>dt?"-":"+")+"x")).replace("y",(ht>Dt?"-":"+")+"y")).replace("z",(Ot>Rt?"-":"+")+"z");var empty=function(){mr=0,Cn=[],En=[],Pn=[]};(!mr||mr<Cn.length*En.length*Pn.length)&&empty();var getArray=function(Ne){return"x"===Ne?Zt:"y"===Ne?er:dr},getVals=function(Ne){return"x"===Ne?Cn:"y"===Ne?En:Pn},getDir=function(Ne){return Ne[mr-1]<Ne[0]?-1:1},Dn=getArray(kn[1]),In=getArray(kn[3]),zn=getArray(kn[5]),Bn=getVals(kn[1]).length,Vn=getVals(kn[3]).length,Hn=getVals(kn[5]).length,qn=!1,getIndex=function(Ne,Ge,Qe){return Bn*(Vn*Ne+Ge)+Qe},Yn=getDir(getArray(kn[1])),$n=getDir(getArray(kn[3])),ra=getDir(getArray(kn[5]));for(Ge=0;Ge<Hn-1;Ge++){for(Qe=0;Qe<Vn-1;Qe++){for(rt=0;rt<Bn-1;rt++){var oa=getIndex(Ge,Qe,rt),pa=getIndex(Ge,Qe,rt+1),ga=getIndex(Ge,Qe+1,rt),ma=getIndex(Ge+1,Qe,rt);if(Dn[oa]*Yn<Dn[pa]*Yn&&In[oa]*$n<In[ga]*$n&&zn[oa]*ra<zn[ma]*ra||(qn=!0),qn)break}if(qn)break}if(qn)break}return qn&&(tt.warn("Encountered arbitrary coordinates! Unable to input data grid."),empty()),{xMin:br,yMin:en,zMin:xn,xMax:xr,yMax:Ar,zMax:mn,Xs:Cn,Ys:En,Zs:Pn,len:mr,fill:kn}}function distinctVals(Ne){return tt.distinctVals(Ne).vals}function filter(Ne,Ge){if(void 0===Ge&&(Ge=Ne.length),tt.isTypedArray(Ne))return Ne.subarray(0,Ge);for(var Qe=[],rt=0;rt<Ge;rt++)Qe[rt]=+Ne[rt];return Qe}Ge.exports={calc:calc,filter:filter,processGrid:processGrid}},{"../../components/colorscale/calc":651,"../../lib":778}],1296:[function(Ne,Ge,Qe){"use strict";var tt=Ne("gl-streamtube3d"),rt=tt.createTubeMesh,nt=Ne("../../lib"),at=Ne("../../lib/gl_format_color").parseColorScale,it=Ne("../../components/colorscale").extractOpts,ot=Ne("../../plots/gl3d/zip3"),dt={xaxis:0,yaxis:1,zaxis:2};function Streamtube(Ne,Ge){this.scene=Ne,this.uid=Ge,this.mesh=null,this.data=null}var ht=Streamtube.prototype;function getDfltStartingPositions(Ne){var Ge=Ne.length;return Ge>2?Ne.slice(1,Ge-1):2===Ge?[(Ne[0]+Ne[1])/2]:Ne}function getBoundPads(Ne){var Ge=Ne.length;return 1===Ge?[.5,.5]:[Ne[1]-Ne[0],Ne[Ge-1]-Ne[Ge-2]]}function convert(Ne,Ge){var Qe=Ne.fullSceneLayout,rt=Ne.dataScale,ht=Ge._len,Dt={};function toDataCoords(Ne,Ge){var tt=Qe[Ge],at=rt[dt[Ge]];return nt.simpleMap(Ne,(function(Ne){return tt.d2l(Ne)*at}))}if(Dt.vectors=ot(toDataCoords(Ge._u,"xaxis"),toDataCoords(Ge._v,"yaxis"),toDataCoords(Ge._w,"zaxis"),ht),!ht)return{positions:[],cells:[]};var Ot=toDataCoords(Ge._Xs,"xaxis"),Rt=toDataCoords(Ge._Ys,"yaxis"),Zt=toDataCoords(Ge._Zs,"zaxis");if(Dt.meshgrid=[Ot,Rt,Zt],Dt.gridFill=Ge._gridFill,Ge._slen)Dt.startingPositions=ot(toDataCoords(Ge._startsX,"xaxis"),toDataCoords(Ge._startsY,"yaxis"),toDataCoords(Ge._startsZ,"zaxis"));else{for(var er=Rt[0],dr=getDfltStartingPositions(Ot),mr=getDfltStartingPositions(Zt),xr=new Array(dr.length*mr.length),br=0,Ar=0;Ar<dr.length;Ar++)for(var en=0;en<mr.length;en++)xr[br++]=[dr[Ar],er,mr[en]];Dt.startingPositions=xr}Dt.colormap=at(Ge),Dt.tubeSize=Ge.sizeref,Dt.maxLength=Ge.maxdisplayed;var mn=toDataCoords(Ge._xbnds,"xaxis"),xn=toDataCoords(Ge._ybnds,"yaxis"),kn=toDataCoords(Ge._zbnds,"zaxis"),Cn=getBoundPads(Ot),En=getBoundPads(Rt),Pn=getBoundPads(Zt),Dn=[[mn[0]-Cn[0],xn[0]-En[0],kn[0]-Pn[0]],[mn[1]+Cn[1],xn[1]+En[1],kn[1]+Pn[1]]],In=tt(Dt,Dn),zn=it(Ge);In.vertexIntensityBounds=[zn.min/Ge._normMax,zn.max/Ge._normMax];var Bn=Ge.lightposition;return In.lightPosition=[Bn.x,Bn.y,Bn.z],In.ambient=Ge.lighting.ambient,In.diffuse=Ge.lighting.diffuse,In.specular=Ge.lighting.specular,In.roughness=Ge.lighting.roughness,In.fresnel=Ge.lighting.fresnel,In.opacity=Ge.opacity,Ge._pad=In.tubeScale*Ge.sizeref*2,In}function createStreamtubeTrace(Ne,Ge){var Qe=Ne.glplot.gl,tt=convert(Ne,Ge),nt=rt(Qe,tt),at=new Streamtube(Ne,Ge.uid);return at.mesh=nt,at.data=Ge,nt._trace=at,Ne.glplot.add(nt),at}ht.handlePick=function(Ne){var Ge=this.scene.fullSceneLayout,Qe=this.scene.dataScale;function fromDataScale(Ne,tt){var rt=Ge[tt],nt=Qe[dt[tt]];return rt.l2c(Ne)/nt}if(Ne.object===this.mesh){var tt=Ne.data.position,rt=Ne.data.velocity;return Ne.traceCoordinate=[fromDataScale(tt[0],"xaxis"),fromDataScale(tt[1],"yaxis"),fromDataScale(tt[2],"zaxis"),fromDataScale(rt[0],"xaxis"),fromDataScale(rt[1],"yaxis"),fromDataScale(rt[2],"zaxis"),Ne.data.intensity*this.data._normMax,Ne.data.divergence],Ne.textLabel=this.data.hovertext||this.data.text,!0}},ht.update=function(Ne){this.data=Ne;var Ge=convert(this.scene,Ne);this.mesh.update(Ge)},ht.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},Ge.exports=createStreamtubeTrace},{"../../components/colorscale":655,"../../lib":778,"../../lib/gl_format_color":774,"../../plots/gl3d/zip3":881,"gl-streamtube3d":348}],1297:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../components/colorscale/defaults"),nt=Ne("./attributes");Ge.exports=function(Ne,Ge,Qe,at){function coerce(Qe,rt){return tt.coerce(Ne,Ge,nt,Qe,rt)}var it=coerce("u"),ot=coerce("v"),dt=coerce("w"),ht=coerce("x"),Dt=coerce("y"),Ot=coerce("z");it&&it.length&&ot&&ot.length&&dt&&dt.length&&ht&&ht.length&&Dt&&Dt.length&&Ot&&Ot.length?(coerce("starts.x"),coerce("starts.y"),coerce("starts.z"),coerce("maxdisplayed"),coerce("sizeref"),coerce("lighting.ambient"),coerce("lighting.diffuse"),coerce("lighting.specular"),coerce("lighting.roughness"),coerce("lighting.fresnel"),coerce("lightposition.x"),coerce("lightposition.y"),coerce("lightposition.z"),rt(Ne,Ge,at,coerce,{prefix:"",cLetter:"c"}),coerce("text"),coerce("hovertext"),coerce("hovertemplate"),Ge._length=null):Ge.visible=!1}},{"../../components/colorscale/defaults":653,"../../lib":778,"./attributes":1294}],1298:[function(Ne,Ge,Qe){"use strict";Ge.exports={moduleType:"trace",name:"streamtube",basePlotModule:Ne("../../plots/gl3d"),categories:["gl3d","showLegend"],attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),colorbar:{min:"cmin",max:"cmax"},calc:Ne("./calc").calc,plot:Ne("./convert"),eventData:function(Ne,Ge){return Ne.tubex=Ne.x,Ne.tubey=Ne.y,Ne.tubez=Ne.z,Ne.tubeu=Ge.traceCoordinate[3],Ne.tubev=Ge.traceCoordinate[4],Ne.tubew=Ge.traceCoordinate[5],Ne.norm=Ge.traceCoordinate[6],Ne.divergence=Ge.traceCoordinate[7],delete Ne.x,delete Ne.y,delete Ne.z,Ne},meta:{}}},{"../../plots/gl3d":870,"./attributes":1294,"./calc":1295,"./convert":1296,"./defaults":1297}],1299:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/attributes"),rt=Ne("../../plots/template_attributes").hovertemplateAttrs,nt=Ne("../../plots/template_attributes").texttemplateAttrs,at=Ne("../../components/colorscale/attributes"),it=Ne("../../plots/domain").attributes,ot=Ne("../pie/attributes"),dt=Ne("./constants"),ht=Ne("../../lib/extend").extendFlat;Ge.exports={labels:{valType:"data_array",editType:"calc"},parents:{valType:"data_array",editType:"calc"},values:{valType:"data_array",editType:"calc"},branchvalues:{valType:"enumerated",values:["remainder","total"],dflt:"remainder",editType:"calc"},count:{valType:"flaglist",flags:["branches","leaves"],dflt:"leaves",editType:"calc"},level:{valType:"any",editType:"plot",anim:!0},maxdepth:{valType:"integer",editType:"plot",dflt:-1},marker:ht({colors:{valType:"data_array",editType:"calc"},line:{color:ht({},ot.marker.line.color,{dflt:null}),width:ht({},ot.marker.line.width,{dflt:1}),editType:"calc"},editType:"calc"},at("marker",{colorAttr:"colors",anim:!1})),leaf:{opacity:{valType:"number",editType:"style",min:0,max:1},editType:"plot"},text:ot.text,textinfo:{valType:"flaglist",flags:["label","text","value","current path","percent root","percent entry","percent parent"],extras:["none"],editType:"plot"},texttemplate:nt({editType:"plot"},{keys:dt.eventDataKeys.concat(["label","value"])}),hovertext:ot.hovertext,hoverinfo:ht({},tt.hoverinfo,{flags:["label","text","value","name","current path","percent root","percent entry","percent parent"],dflt:"label+text+value+name"}),hovertemplate:rt({},{keys:dt.eventDataKeys}),textfont:ot.textfont,insidetextorientation:ot.insidetextorientation,insidetextfont:ot.insidetextfont,outsidetextfont:ht({},ot.outsidetextfont,{}),rotation:{valType:"angle",dflt:0,editType:"plot"},sort:ot.sort,root:{color:{valType:"color",editType:"calc",dflt:"rgba(0,0,0,0)"},editType:"calc"},domain:it({name:"sunburst",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/domain":855,"../../plots/template_attributes":906,"../pie/attributes":1161,"./constants":1302}],1300:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/plots");Qe.name="sunburst",Qe.plot=function(Ne,Ge,rt,nt){tt.plotBasePlot(Qe.name,Ne,Ge,rt,nt)},Qe.clean=function(Ne,Ge,rt,nt){tt.cleanBasePlot(Qe.name,Ne,Ge,rt,nt)}},{"../../plots/plots":891}],1301:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3-hierarchy"),rt=Ne("fast-isnumeric"),nt=Ne("../../lib"),at=Ne("../../components/colorscale").makeColorScaleFuncFromTrace,it=Ne("../pie/calc").makePullColorFn,ot=Ne("../pie/calc").generateExtendedColors,dt=Ne("../../components/colorscale").calc,ht=Ne("../../constants/numerical").ALMOST_EQUAL,Dt={},Ot={};function countDescendants(Ne,Ge,Qe){var tt=0,rt=Ne.children;if(rt){for(var nt=rt.length,at=0;at<nt;at++)tt+=countDescendants(rt[at],Ge,Qe);Qe.branches&&tt++}else Qe.leaves&&tt++;return Ne.value=Ne.data.data.value=tt,Ge._values||(Ge._values=[]),Ge._values[Ne.data.data.i]=tt,tt}Qe.calc=function(Ne,Ge){var Qe,ot,Dt,Ot,Rt=Ne._fullLayout,Zt=Ge.ids,er=nt.isArrayOrTypedArray(Zt),dr=Ge.labels,mr=Ge.parents,xr=Ge.values,br=nt.isArrayOrTypedArray(xr),Ar=[],en={},mn={},addToLookup=function(Ne,Ge){en[Ne]?en[Ne].push(Ge):en[Ne]=[Ge],mn[Ge]=1},isValidKey=function(Ne){return Ne||"number"==typeof Ne},isValidVal=function(Ne){return!br||rt(xr[Ne])&&xr[Ne]>=0};er?(Qe=Math.min(Zt.length,mr.length),ot=function(Ne){return isValidKey(Zt[Ne])&&isValidVal(Ne)},Dt=function(Ne){return String(Zt[Ne])}):(Qe=Math.min(dr.length,mr.length),ot=function(Ne){return isValidKey(dr[Ne])&&isValidVal(Ne)},Dt=function(Ne){return String(dr[Ne])}),br&&(Qe=Math.min(Qe,xr.length));for(var xn=0;xn<Qe;xn++)if(ot(xn)){var kn=Dt(xn),Cn=isValidKey(mr[xn])?String(mr[xn]):"",En={i:xn,id:kn,pid:Cn,label:isValidKey(dr[xn])?String(dr[xn]):""};br&&(En.v=+xr[xn]),Ar.push(En),addToLookup(Cn,kn)}if(en[""]){if(en[""].length>1){for(var Pn=nt.randstr(),Dn=0;Dn<Ar.length;Dn++)""===Ar[Dn].pid&&(Ar[Dn].pid=Pn);Ar.unshift({hasMultipleRoots:!0,id:Pn,pid:"",label:""})}}else{var In,zn=[];for(In in en)mn[In]||zn.push(In);if(1!==zn.length)return nt.warn(["Multiple implied roots, cannot build",Ge.type,"hierarchy of",Ge.name+".","These roots include:",zn.join(", ")].join(" "));In=zn[0],Ar.unshift({hasImpliedRoot:!0,id:In,pid:"",label:In})}try{Ot=tt.stratify().id((function(Ne){return Ne.id})).parentId((function(Ne){return Ne.pid}))(Ar)}catch(Ne){return nt.warn(["Failed to build",Ge.type,"hierarchy of",Ge.name+".","Error:",Ne.message].join(" "))}var Bn=tt.hierarchy(Ot),Vn=!1;if(br)switch(Ge.branchvalues){case"remainder":Bn.sum((function(Ne){return Ne.data.v}));break;case"total":Bn.each((function(Ne){var Qe=Ne.data.data,tt=Qe.v;if(Ne.children){var rt=Ne.children.reduce((function(Ne,Ge){return Ne+Ge.data.data.v}),0);if((Qe.hasImpliedRoot||Qe.hasMultipleRoots)&&(tt=rt),tt<rt*ht)return Vn=!0,nt.warn(["Total value for node",Ne.data.data.id,"of",Ge.name,"is smaller than the sum of its children.","\nparent value =",tt,"\nchildren sum =",rt].join(" "))}Ne.value=tt}))}else countDescendants(Bn,Ge,{branches:-1!==Ge.count.indexOf("branches"),leaves:-1!==Ge.count.indexOf("leaves")});if(!Vn){var Hn,qn;Ge.sort&&Bn.sort((function(Ne,Ge){return Ge.value-Ne.value}));var Yn=Ge.marker.colors||[],$n=!!Yn.length;return Ge._hasColorscale?($n||(Yn=br?Ge.values:Ge._values),dt(Ne,Ge,{vals:Yn,containerStr:"marker",cLetter:"c"}),qn=at(Ge.marker)):Hn=it(Rt["_"+Ge.type+"colormap"]),Bn.each((function(Ne){var Qe=Ne.data.data;Qe.color=Ge._hasColorscale?qn(Yn[Qe.i]):Hn(Yn[Qe.i],Qe.id)})),Ar[0].hierarchy=Bn,Ar}},Qe._runCrossTraceCalc=function(Ne,Ge){var Qe=Ge._fullLayout,tt=Ge.calcdata,rt=Qe[Ne+"colorway"],nt=Qe["_"+Ne+"colormap"];Qe["extend"+Ne+"colors"]&&(rt=ot(rt,"treemap"===Ne?Ot:Dt));var at,it=0;function pickColor(Ne){var Ge=Ne.data.data,Qe=Ge.id;!1===Ge.color&&(nt[Qe]?Ge.color=nt[Qe]:Ne.parent?Ne.parent.parent?Ge.color=Ne.parent.data.data.color:(nt[Qe]=Ge.color=rt[it%rt.length],it++):Ge.color=at)}for(var dt=0;dt<tt.length;dt++){var ht=tt[dt][0];ht.trace.type===Ne&&ht.hierarchy&&(at=ht.trace.root.color,ht.hierarchy.each(pickColor))}},Qe.crossTraceCalc=function(Ne){return Qe._runCrossTraceCalc("sunburst",Ne)}},{"../../components/colorscale":655,"../../constants/numerical":753,"../../lib":778,"../pie/calc":1163,"d3-hierarchy":161,"fast-isnumeric":241}],1302:[function(Ne,Ge,Qe){"use strict";Ge.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"linear",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"]}},{}],1303:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./attributes"),nt=Ne("../../plots/domain").defaults,at=Ne("../bar/defaults").handleText,it=Ne("../../components/colorscale"),ot=it.hasColorscale,dt=it.handleDefaults;Ge.exports=function(Ne,Ge,Qe,it){function coerce(Qe,nt){return tt.coerce(Ne,Ge,rt,Qe,nt)}var ht=coerce("labels"),Dt=coerce("parents");if(ht&&ht.length&&Dt&&Dt.length){var Ot=coerce("values");Ot&&Ot.length?coerce("branchvalues"):coerce("count"),coerce("level"),coerce("maxdepth"),coerce("marker.line.width")&&coerce("marker.line.color",it.paper_bgcolor),coerce("marker.colors");var Rt=Ge._hasColorscale=ot(Ne,"marker","colors")||(Ne.marker||{}).coloraxis;Rt&&dt(Ne,Ge,it,coerce,{prefix:"marker.",cLetter:"c"}),coerce("leaf.opacity",Rt?1:.7);var Zt=coerce("text");coerce("texttemplate"),Ge.texttemplate||coerce("textinfo",Array.isArray(Zt)?"text+label":"label"),coerce("hovertext"),coerce("hovertemplate"),at(Ne,Ge,it,coerce,"auto",{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),coerce("insidetextorientation"),coerce("sort"),coerce("rotation"),coerce("root.color"),nt(Ge,it,coerce),Ge._length=null}else Ge.visible=!1}},{"../../components/colorscale":655,"../../lib":778,"../../plots/domain":855,"../bar/defaults":925,"./attributes":1299}],1304:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../registry"),nt=Ne("../../components/fx/helpers").appendArrayPointValue,at=Ne("../../components/fx"),it=Ne("../../lib"),ot=Ne("../../lib/events"),dt=Ne("./helpers"),ht=Ne("../pie/helpers").formatPieValue;function makeEventData(Ne,Ge,Qe){for(var tt=Ne.data.data,rt={curveNumber:Ge.index,pointNumber:tt.i,data:Ge._input,fullData:Ge},at=0;at<Qe.length;at++){var it=Qe[at];it in Ne&&(rt[it]=Ne[it])}return"parentString"in Ne&&!dt.isHierarchyRoot(Ne)&&(rt.parent=Ne.parentString),nt(rt,Ge,tt.i),rt}Ge.exports=function(Ne,Ge,Qe,nt,Dt){var Ot=nt[0],Rt=Ot.trace,Zt=Ot.hierarchy,er="sunburst"===Rt.type,dr="treemap"===Rt.type;"_hasHoverLabel"in Rt||(Rt._hasHoverLabel=!1),"_hasHoverEvent"in Rt||(Rt._hasHoverEvent=!1);var onMouseOver=function(rt){var nt=Qe._fullLayout;if(!Qe._dragging&&!1!==nt.hovermode){var ot=Qe._fullData[Rt.index],mr=rt.data.data,xr=mr.i,br=dt.isHierarchyRoot(rt),Ar=dt.getParent(Zt,rt),en=dt.getValue(rt),_cast=function(Ne){return it.castOption(ot,xr,Ne)},mn=_cast("hovertemplate"),xn=at.castHoverinfo(ot,nt,xr),kn=nt.separators;if(mn||xn&&"none"!==xn&&"skip"!==xn){var Cn,En;er&&(Cn=Ot.cx+rt.pxmid[0]*(1-rt.rInscribed),En=Ot.cy+rt.pxmid[1]*(1-rt.rInscribed)),dr&&(Cn=rt._hoverX,En=rt._hoverY);var Pn,Dn={},In=[],zn=[],hasFlag=function(Ne){return-1!==In.indexOf(Ne)};xn&&(In="all"===xn?ot._module.attributes.hoverinfo.flags:xn.split("+")),Dn.label=mr.label,hasFlag("label")&&Dn.label&&zn.push(Dn.label),mr.hasOwnProperty("v")&&(Dn.value=mr.v,Dn.valueLabel=ht(Dn.value,kn),hasFlag("value")&&zn.push(Dn.valueLabel)),Dn.currentPath=rt.currentPath=dt.getPath(rt.data),hasFlag("current path")&&!br&&zn.push(Dn.currentPath);var Bn=[],insertPercent=function(){-1===Bn.indexOf(Pn)&&(zn.push(Pn),Bn.push(Pn))};Dn.percentParent=rt.percentParent=en/dt.getValue(Ar),Dn.parent=rt.parentString=dt.getPtLabel(Ar),hasFlag("percent parent")&&(Pn=dt.formatPercent(Dn.percentParent,kn)+" of "+Dn.parent,insertPercent()),Dn.percentEntry=rt.percentEntry=en/dt.getValue(Ge),Dn.entry=rt.entry=dt.getPtLabel(Ge),!hasFlag("percent entry")||br||rt.onPathbar||(Pn=dt.formatPercent(Dn.percentEntry,kn)+" of "+Dn.entry,insertPercent()),Dn.percentRoot=rt.percentRoot=en/dt.getValue(Zt),Dn.root=rt.root=dt.getPtLabel(Zt),hasFlag("percent root")&&!br&&(Pn=dt.formatPercent(Dn.percentRoot,kn)+" of "+Dn.root,insertPercent()),Dn.text=_cast("hovertext")||_cast("text"),hasFlag("text")&&(Pn=Dn.text,it.isValidTextValue(Pn)&&zn.push(Pn));var Vn={trace:ot,y:En,text:zn.join("<br>"),name:mn||hasFlag("name")?ot.name:void 0,color:_cast("hoverlabel.bgcolor")||mr.color,borderColor:_cast("hoverlabel.bordercolor"),fontFamily:_cast("hoverlabel.font.family"),fontSize:_cast("hoverlabel.font.size"),fontColor:_cast("hoverlabel.font.color"),nameLength:_cast("hoverlabel.namelength"),textAlign:_cast("hoverlabel.align"),hovertemplate:mn,hovertemplateLabels:Dn,eventData:[makeEventData(rt,ot,Dt.eventDataKeys)]};er&&(Vn.x0=Cn-rt.rInscribed*rt.rpx1,Vn.x1=Cn+rt.rInscribed*rt.rpx1,Vn.idealAlign=rt.pxmid[0]<0?"left":"right"),dr&&(Vn.x=Cn,Vn.idealAlign=Cn<0?"left":"right"),at.loneHover(Vn,{container:nt._hoverlayer.node(),outerContainer:nt._paper.node(),gd:Qe}),Rt._hasHoverLabel=!0}if(dr){var Hn=Ne.select("path.surface");Dt.styleOne(Hn,rt,ot,{hovered:!0})}Rt._hasHoverEvent=!0,Qe.emit("plotly_hover",{points:[makeEventData(rt,ot,Dt.eventDataKeys)],event:tt.event})}},onMouseOut=function(Ge){var rt=Qe._fullLayout,nt=Qe._fullData[Rt.index],it=tt.select(this).datum();if(Rt._hasHoverEvent&&(Ge.originalEvent=tt.event,Qe.emit("plotly_unhover",{points:[makeEventData(it,nt,Dt.eventDataKeys)],event:tt.event}),Rt._hasHoverEvent=!1),Rt._hasHoverLabel&&(at.loneUnhover(rt._hoverlayer.node()),Rt._hasHoverLabel=!1),dr){var ot=Ne.select("path.surface");Dt.styleOne(ot,it,nt,{hovered:!1})}},onClick=function(Ne){var Ge=Qe._fullLayout,nt=Qe._fullData[Rt.index],it=er&&(dt.isHierarchyRoot(Ne)||dt.isLeaf(Ne)),ht=dt.getPtId(Ne),Ot=dt.isEntry(Ne)?dt.findEntryWithChild(Zt,ht):dt.findEntryWithLevel(Zt,ht),dr=dt.getPtId(Ot),mr={points:[makeEventData(Ne,nt,Dt.eventDataKeys)],event:tt.event};it||(mr.nextLevel=dr);var xr=ot.triggerHandler(Qe,"plotly_"+Rt.type+"click",mr);if(!1!==xr&&Ge.hovermode&&(Qe._hoverdata=[makeEventData(Ne,nt,Dt.eventDataKeys)],at.click(Qe,tt.event)),!it&&!1!==xr&&!Qe._dragging&&!Qe._transitioning){rt.call("_storeDirectGUIEdit",nt,Ge._tracePreGUI[nt.uid],{level:nt.level});var br={data:[{level:dr}],traces:[Rt.index]},Ar={frame:{redraw:!1,duration:Dt.transitionTime},transition:{duration:Dt.transitionTime,easing:Dt.transitionEasing},mode:"immediate",fromcurrent:!0};at.loneUnhover(Ge._hoverlayer.node()),rt.call("animate",Qe,br,Ar)}};Ne.on("mouseover",onMouseOver),Ne.on("mouseout",onMouseOut),Ne.on("click",onClick)}},{"../../components/fx":683,"../../components/fx/helpers":679,"../../lib":778,"../../lib/events":767,"../../registry":911,"../pie/helpers":1166,"./helpers":1305,d3:169}],1305:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../components/color"),nt=Ne("../../lib/setcursor"),at=Ne("../pie/helpers");function determineOutsideTextFont(Ne,Ge,tt){return{color:Qe.getOutsideTextFontKey("color",Ne,Ge,tt),family:Qe.getOutsideTextFontKey("family",Ne,Ge,tt),size:Qe.getOutsideTextFontKey("size",Ne,Ge,tt)}}function determineInsideTextFont(Ne,Ge,nt,at){var it=(at||{}).onPathbar,ot=Ge.data.data,dt=ot.i,ht=tt.castOption(Ne,dt,(it?"pathbar.textfont":"insidetextfont")+".color");return!ht&&Ne._input.textfont&&(ht=tt.castOption(Ne._input,dt,"textfont.color")),{color:ht||rt.contrast(ot.color),family:Qe.getInsideTextFontKey("family",Ne,Ge,nt,at),size:Qe.getInsideTextFontKey("size",Ne,Ge,nt,at)}}function getParentId(Ne){return Ne.data.data.pid}Qe.findEntryWithLevel=function(Ne,Ge){var tt;return Ge&&Ne.eachAfter((function(Ne){if(Qe.getPtId(Ne)===Ge)return tt=Ne.copy()})),tt||Ne},Qe.findEntryWithChild=function(Ne,Ge){var tt;return Ne.eachAfter((function(Ne){for(var rt=Ne.children||[],nt=0;nt<rt.length;nt++){var at=rt[nt];if(Qe.getPtId(at)===Ge)return tt=Ne.copy()}})),tt||Ne},Qe.isEntry=function(Ne){return!Ne.parent},Qe.isLeaf=function(Ne){return!Ne.children},Qe.getPtId=function(Ne){return Ne.data.data.id},Qe.getPtLabel=function(Ne){return Ne.data.data.label},Qe.getValue=function(Ne){return Ne.value},Qe.isHierarchyRoot=function(Ne){return""===getParentId(Ne)},Qe.setSliceCursor=function(Ne,Ge,tt){var rt=tt.isTransitioning;if(!rt){var at=Ne.datum();rt=tt.hideOnRoot&&Qe.isHierarchyRoot(at)||tt.hideOnLeaves&&Qe.isLeaf(at)}nt(Ne,rt?null:"pointer")},Qe.getInsideTextFontKey=function(Ne,Ge,Qe,rt,nt){var at=(nt||{}).onPathbar?"pathbar.textfont":"insidetextfont",it=Qe.data.data.i;return tt.castOption(Ge,it,at+"."+Ne)||tt.castOption(Ge,it,"textfont."+Ne)||rt.size},Qe.getOutsideTextFontKey=function(Ne,Ge,Qe,rt){var nt=Qe.data.data.i;return tt.castOption(Ge,nt,"outsidetextfont."+Ne)||tt.castOption(Ge,nt,"textfont."+Ne)||rt.size},Qe.isOutsideText=function(Ne,Ge){return!Ne._hasColorscale&&Qe.isHierarchyRoot(Ge)},Qe.determineTextFont=function(Ne,Ge,tt,rt){return Qe.isOutsideText(Ne,Ge)?determineOutsideTextFont(Ne,Ge,tt):determineInsideTextFont(Ne,Ge,tt,rt)},Qe.hasTransition=function(Ne){return!!(Ne&&Ne.duration>0)},Qe.getMaxDepth=function(Ne){return Ne.maxdepth>=0?Ne.maxdepth:1/0},Qe.isHeader=function(Ne,Ge){return!(Qe.isLeaf(Ne)||Ne.depth===Ge._maxDepth-1)},Qe.getParent=function(Ne,Ge){return Qe.findEntryWithLevel(Ne,getParentId(Ge))},Qe.listPath=function(Ne,Ge){var tt=Ne.parent;if(!tt)return[];var rt=Ge?[tt.data[Ge]]:[tt];return Qe.listPath(tt,Ge).concat(rt)},Qe.getPath=function(Ne){return Qe.listPath(Ne,"label").join("/")+"/"},Qe.formatValue=at.formatPieValue,Qe.formatPercent=function(Ne,Ge){var Qe=tt.formatPercent(Ne,0);return"0%"===Qe&&(Qe=at.formatPiePercent(Ne,Ge)),Qe}},{"../../components/color":643,"../../lib":778,"../../lib/setcursor":799,"../pie/helpers":1166}],1306:[function(Ne,Ge,Qe){"use strict";Ge.exports={moduleType:"trace",name:"sunburst",basePlotModule:Ne("./base_plot"),categories:[],animatable:!0,attributes:Ne("./attributes"),layoutAttributes:Ne("./layout_attributes"),supplyDefaults:Ne("./defaults"),supplyLayoutDefaults:Ne("./layout_defaults"),calc:Ne("./calc").calc,crossTraceCalc:Ne("./calc").crossTraceCalc,plot:Ne("./plot").plot,style:Ne("./style").style,colorbar:Ne("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":1205,"./attributes":1299,"./base_plot":1300,"./calc":1301,"./defaults":1303,"./layout_attributes":1307,"./layout_defaults":1308,"./plot":1309,"./style":1310}],1307:[function(Ne,Ge,Qe){"use strict";Ge.exports={sunburstcolorway:{valType:"colorlist",editType:"calc"},extendsunburstcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1308:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./layout_attributes");Ge.exports=function(Ne,Ge){function coerce(Qe,nt){return tt.coerce(Ne,Ge,rt,Qe,nt)}coerce("sunburstcolorway",Ge.colorway),coerce("extendsunburstcolors")}},{"../../lib":778,"./layout_attributes":1307}],1309:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("d3-hierarchy"),nt=Ne("../../components/drawing"),at=Ne("../../lib"),it=Ne("../../lib/svg_text_utils"),ot=Ne("../bar/uniform_text"),dt=ot.recordMinTextSize,ht=ot.clearMinTextSize,Dt=Ne("../pie/plot"),Ot=Ne("../pie/helpers").getRotationAngle,Rt=Dt.computeTransform,Zt=Dt.transformInsideText,er=Ne("./style").styleOne,dr=Ne("../bar/style").resizeText,mr=Ne("./fx"),xr=Ne("./constants"),br=Ne("./helpers");function plotOne(Ne,Ge,rt,ot){var ht=Ne._fullLayout,Dt=!ht.uniformtext.mode&&br.hasTransition(ot),dr=tt.select(rt).selectAll("g.slice"),Ar=Ge[0],en=Ar.trace,mn=Ar.hierarchy,xn=br.findEntryWithLevel(mn,en.level),kn=br.getMaxDepth(en),Cn=ht._size,En=en.domain,Pn=Cn.w*(En.x[1]-En.x[0]),Dn=Cn.h*(En.y[1]-En.y[0]),In=.5*Math.min(Pn,Dn),zn=Ar.cx=Cn.l+Cn.w*(En.x[1]+En.x[0])/2,Bn=Ar.cy=Cn.t+Cn.h*(1-En.y[0])-Dn/2;if(!xn)return dr.remove();var Vn=null,Hn={};Dt&&dr.each((function(Ne){Hn[br.getPtId(Ne)]={rpx0:Ne.rpx0,rpx1:Ne.rpx1,x0:Ne.x0,x1:Ne.x1,transform:Ne.transform},!Vn&&br.isEntry(Ne)&&(Vn=Ne)}));var qn=partition(xn).descendants(),Yn=xn.height+1,$n=0,ra=kn;Ar.hasMultipleRoots&&br.isHierarchyRoot(xn)&&(qn=qn.slice(1),Yn-=1,$n=1,ra+=1),qn=qn.filter((function(Ne){return Ne.y1<=ra}));var oa=Ot(en.rotation);oa&&qn.forEach((function(Ne){Ne.x0+=oa,Ne.x1+=oa}));var pa=Math.min(Yn,kn),y2rpx=function(Ne){return(Ne-$n)/pa*In},rx2px=function(Ne,Ge){return[Ne*Math.cos(Ge),-Ne*Math.sin(Ge)]},pathSlice=function(Ne){return at.pathAnnulus(Ne.rpx0,Ne.rpx1,Ne.x0,Ne.x1,zn,Bn)},getTargetX=function(Ne){return zn+getTextXY(Ne)[0]*(Ne.transform.rCenter||0)+(Ne.transform.x||0)},getTargetY=function(Ne){return Bn+getTextXY(Ne)[1]*(Ne.transform.rCenter||0)+(Ne.transform.y||0)};(dr=dr.data(qn,br.getPtId)).enter().append("g").classed("slice",!0),Dt?dr.exit().transition().each((function(){var Ne=tt.select(this);Ne.select("path.surface").transition().attrTween("d",(function(Ne){var Ge=makeExitSliceInterpolator(Ne);return function(Ne){return pathSlice(Ge(Ne))}})),Ne.select("g.slicetext").attr("opacity",0)})).remove():dr.exit().remove(),dr.order();var ga=null;if(Dt&&Vn){var ma=br.getPtId(Vn);dr.each((function(Ne){null===ga&&br.getPtId(Ne)===ma&&(ga=Ne.x1)}))}var _a=dr;function makeExitSliceInterpolator(Ne){var Ge,Qe=br.getPtId(Ne),rt=Hn[Qe],nt=Hn[br.getPtId(xn)];if(nt){var at=(Ne.x1>nt.x1?2*Math.PI:0)+oa;Ge=Ne.rpx1<nt.rpx1?{rpx0:0,rpx1:0}:{x0:at,x1:at}}else{var it,ot=br.getPtId(Ne.parent);dr.each((function(Ne){if(br.getPtId(Ne)===ot)return it=Ne}));var dt,ht=it.children;ht.forEach((function(Ne,Ge){if(br.getPtId(Ne)===Qe)return dt=Ge}));var Dt=ht.length,Ot=tt.interpolate(it.x0,it.x1);Ge={rpx0:In,rpx1:In,x0:Ot(dt/Dt),x1:Ot((dt+1)/Dt)}}return tt.interpolate(rt,Ge)}function makeUpdateSliceInterpolator(Ne){var Ge,Qe=Hn[br.getPtId(Ne)],rt={x0:Ne.x0,x1:Ne.x1,rpx0:Ne.rpx0,rpx1:Ne.rpx1};if(Qe)Ge=Qe;else if(Vn)if(Ne.parent)if(ga){var nt=(Ne.x1>ga?2*Math.PI:0)+oa;Ge={x0:nt,x1:nt}}else Ge={rpx0:In,rpx1:In},at.extendFlat(Ge,interpX0X1FromParent(Ne));else Ge={rpx0:0,rpx1:0};else Ge={x0:oa,x1:oa};return tt.interpolate(Ge,rt)}function makeUpdateTextInterpolator(Ne){var Ge,Qe=Hn[br.getPtId(Ne)],rt=Ne.transform;if(Qe)Ge=Qe;else if(Ge={rpx1:Ne.rpx1,transform:{textPosAngle:rt.textPosAngle,scale:0,rotate:rt.rotate,rCenter:rt.rCenter,x:rt.x,y:rt.y}},Vn)if(Ne.parent)if(ga){var nt=Ne.x1>ga?2*Math.PI:0;Ge.x0=Ge.x1=nt}else at.extendFlat(Ge,interpX0X1FromParent(Ne));else Ge.x0=Ge.x1=oa;else Ge.x0=Ge.x1=oa;var it=tt.interpolate(Ge.transform.textPosAngle,Ne.transform.textPosAngle),ot=tt.interpolate(Ge.rpx1,Ne.rpx1),Dt=tt.interpolate(Ge.x0,Ne.x0),Ot=tt.interpolate(Ge.x1,Ne.x1),Rt=tt.interpolate(Ge.transform.scale,rt.scale),Zt=tt.interpolate(Ge.transform.rotate,rt.rotate),er=0===rt.rCenter?3:0===Ge.transform.rCenter?1/3:1,dr=tt.interpolate(Ge.transform.rCenter,rt.rCenter),rCenterFn=function(Ne){return dr(Math.pow(Ne,er))};return function(Ne){var Ge=ot(Ne),Qe=Dt(Ne),tt=Ot(Ne),nt=rCenterFn(Ne),at={pxmid:rx2px(Ge,(Qe+tt)/2),rpx1:Ge,transform:{textPosAngle:it(Ne),rCenter:nt,x:rt.x,y:rt.y}};return dt(en.type,rt,ht),{transform:{targetX:getTargetX(at),targetY:getTargetY(at),scale:Rt(Ne),rotate:Zt(Ne),rCenter:nt}}}}function interpX0X1FromParent(Ne){var Ge=Ne.parent,Qe=Hn[br.getPtId(Ge)],rt={};if(Qe){var nt=Ge.children,at=nt.indexOf(Ne),it=nt.length,ot=tt.interpolate(Qe.x0,Qe.x1);rt.x0=ot(at/it),rt.x1=ot(at/it)}else rt.x0=rt.x1=0;return rt}Dt&&(_a=_a.transition().each("end",(function(){var Ge=tt.select(this);br.setSliceCursor(Ge,Ne,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:!1})}))),_a.each((function(rt){var ot=tt.select(this),Ot=at.ensureSingle(ot,"path","surface",(function(Ne){Ne.style("pointer-events","all")}));rt.rpx0=y2rpx(rt.y0),rt.rpx1=y2rpx(rt.y1),rt.xmid=(rt.x0+rt.x1)/2,rt.pxmid=rx2px(rt.rpx1,rt.xmid),rt.midangle=-(rt.xmid-Math.PI/2),rt.startangle=-(rt.x0-Math.PI/2),rt.stopangle=-(rt.x1-Math.PI/2),rt.halfangle=.5*Math.min(at.angleDelta(rt.x0,rt.x1)||Math.PI,Math.PI),rt.ring=1-rt.rpx0/rt.rpx1,rt.rInscribed=getInscribedRadiusFraction(rt,en),Dt?Ot.transition().attrTween("d",(function(Ne){var Ge=makeUpdateSliceInterpolator(Ne);return function(Ne){return pathSlice(Ge(Ne))}})):Ot.attr("d",pathSlice),ot.call(mr,xn,Ne,Ge,{eventDataKeys:xr.eventDataKeys,transitionTime:xr.CLICK_TRANSITION_TIME,transitionEasing:xr.CLICK_TRANSITION_EASING}).call(br.setSliceCursor,Ne,{hideOnRoot:!0,hideOnLeaves:!0,isTransitioning:Ne._transitioning}),Ot.call(er,rt,en);var dr=at.ensureSingle(ot,"g","slicetext"),mn=at.ensureSingle(dr,"text","",(function(Ne){Ne.attr("data-notex",1)})),kn=at.ensureUniformFontSize(Ne,br.determineTextFont(en,rt,ht.font));mn.text(Qe.formatSliceLabel(rt,xn,en,Ge,ht)).classed("slicetext",!0).attr("text-anchor","middle").call(nt.font,kn).call(it.convertToTspans,Ne);var Cn=nt.bBox(mn.node());rt.transform=Zt(Cn,rt,Ar),rt.transform.targetX=getTargetX(rt),rt.transform.targetY=getTargetY(rt);var strTransform=function(Ne,Ge){var Qe=Ne.transform;return Rt(Qe,Ge),Qe.fontSize=kn.size,dt(en.type,Qe,ht),at.getTextTransform(Qe)};Dt?mn.transition().attrTween("transform",(function(Ne){var Ge=makeUpdateTextInterpolator(Ne);return function(Ne){return strTransform(Ge(Ne),Cn)}})):mn.attr("transform",strTransform(rt,Cn))}))}function partition(Ne){return rt.partition().size([2*Math.PI,Ne.height+1])(Ne)}function getInscribedRadiusFraction(Ne){return 0===Ne.rpx0&&at.isFullCircle([Ne.x0,Ne.x1])?1:Math.max(0,Math.min(1/(1+1/Math.sin(Ne.halfangle)),Ne.ring/2))}function getTextXY(Ne){return getCoords(Ne.rpx1,Ne.transform.textPosAngle)}function getCoords(Ne,Ge){return[Ne*Math.sin(Ge),-Ne*Math.cos(Ge)]}Qe.plot=function(Ne,Ge,Qe,rt){var nt,at,it=Ne._fullLayout,ot=it._sunburstlayer,dt=!Qe,Dt=!it.uniformtext.mode&&br.hasTransition(Qe);ht("sunburst",it),(nt=ot.selectAll("g.trace.sunburst").data(Ge,(function(Ne){return Ne[0].trace.uid}))).enter().append("g").classed("trace",!0).classed("sunburst",!0).attr("stroke-linejoin","round"),nt.order(),Dt?(rt&&(at=rt()),tt.transition().duration(Qe.duration).ease(Qe.easing).each("end",(function(){at&&at()})).each("interrupt",(function(){at&&at()})).each((function(){ot.selectAll("g.trace").each((function(Ge){plotOne(Ne,Ge,this,Qe)}))}))):(nt.each((function(Ge){plotOne(Ne,Ge,this,Qe)})),it.uniformtext.mode&&dr(Ne,it._sunburstlayer.selectAll(".trace"),"sunburst")),dt&&nt.exit().remove()},Qe.formatSliceLabel=function(Ne,Ge,Qe,tt,rt){var nt=Qe.texttemplate,it=Qe.textinfo;if(!(nt||it&&"none"!==it))return"";var ot=rt.separators,dt=tt[0],ht=Ne.data.data,Dt=dt.hierarchy,Ot=br.isHierarchyRoot(Ne),Rt=br.getParent(Dt,Ne),Zt=br.getValue(Ne);if(!nt){var er,dr=it.split("+"),hasFlag=function(Ne){return-1!==dr.indexOf(Ne)},mr=[];if(hasFlag("label")&&ht.label&&mr.push(ht.label),ht.hasOwnProperty("v")&&hasFlag("value")&&mr.push(br.formatValue(ht.v,ot)),!Ot){hasFlag("current path")&&mr.push(br.getPath(Ne.data));var xr=0;hasFlag("percent parent")&&xr++,hasFlag("percent entry")&&xr++,hasFlag("percent root")&&xr++;var Ar=xr>1;if(xr){var en,addPercent=function(Ne){er=br.formatPercent(en,ot),Ar&&(er+=" of "+Ne),mr.push(er)};hasFlag("percent parent")&&!Ot&&(en=Zt/br.getValue(Rt),addPercent("parent")),hasFlag("percent entry")&&(en=Zt/br.getValue(Ge),addPercent("entry")),hasFlag("percent root")&&(en=Zt/br.getValue(Dt),addPercent("root"))}}return hasFlag("text")&&(er=at.castOption(Qe,ht.i,"text"),at.isValidTextValue(er)&&mr.push(er)),mr.join("<br>")}var mn=at.castOption(Qe,ht.i,"texttemplate");if(!mn)return"";var xn={};ht.label&&(xn.label=ht.label),ht.hasOwnProperty("v")&&(xn.value=ht.v,xn.valueLabel=br.formatValue(ht.v,ot)),xn.currentPath=br.getPath(Ne.data),Ot||(xn.percentParent=Zt/br.getValue(Rt),xn.percentParentLabel=br.formatPercent(xn.percentParent,ot),xn.parent=br.getPtLabel(Rt)),xn.percentEntry=Zt/br.getValue(Ge),xn.percentEntryLabel=br.formatPercent(xn.percentEntry,ot),xn.entry=br.getPtLabel(Ge),xn.percentRoot=Zt/br.getValue(Dt),xn.percentRootLabel=br.formatPercent(xn.percentRoot,ot),xn.root=br.getPtLabel(Dt),ht.hasOwnProperty("color")&&(xn.color=ht.color);var kn=at.castOption(Qe,ht.i,"text");return(at.isValidTextValue(kn)||""===kn)&&(xn.text=kn),xn.customdata=at.castOption(Qe,ht.i,"customdata"),at.texttemplateString(mn,xn,rt._d3locale,xn,Qe._meta||{})}},{"../../components/drawing":665,"../../lib":778,"../../lib/svg_text_utils":803,"../bar/style":935,"../bar/uniform_text":937,"../pie/helpers":1166,"../pie/plot":1170,"./constants":1302,"./fx":1304,"./helpers":1305,"./style":1310,d3:169,"d3-hierarchy":161}],1310:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../components/color"),nt=Ne("../../lib"),at=Ne("../bar/uniform_text").resizeText;function style(Ne){var Ge=Ne._fullLayout._sunburstlayer.selectAll(".trace");at(Ne,Ge,"sunburst"),Ge.each((function(Ne){var Ge=tt.select(this),Qe=Ne[0].trace;Ge.style("opacity",Qe.opacity),Ge.selectAll("path.surface").each((function(Ne){tt.select(this).call(styleOne,Ne,Qe)}))}))}function styleOne(Ne,Ge,Qe){var tt=Ge.data.data,at=!Ge.children,it=tt.i,ot=nt.castOption(Qe,it,"marker.line.color")||rt.defaultLine,dt=nt.castOption(Qe,it,"marker.line.width")||0;Ne.style("stroke-width",dt).call(rt.fill,tt.color).call(rt.stroke,ot).style("opacity",at?Qe.leaf.opacity:null)}Ge.exports={style:style,styleOne:styleOne}},{"../../components/color":643,"../../lib":778,"../bar/uniform_text":937,d3:169}],1311:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/color"),rt=Ne("../../components/colorscale/attributes"),nt=Ne("../../plots/template_attributes").hovertemplateAttrs,at=Ne("../../plots/attributes"),it=Ne("../../lib/extend").extendFlat,ot=Ne("../../plot_api/edit_types").overrideAll;function makeContourProjAttr(Ne){return{valType:"boolean",dflt:!1}}function makeContourAttr(Ne){return{show:{valType:"boolean",dflt:!1},start:{valType:"number",dflt:null,editType:"plot"},end:{valType:"number",dflt:null,editType:"plot"},size:{valType:"number",dflt:null,min:0,editType:"plot"},project:{x:makeContourProjAttr("x"),y:makeContourProjAttr("y"),z:makeContourProjAttr("z")},color:{valType:"color",dflt:tt.defaultLine},usecolormap:{valType:"boolean",dflt:!1},width:{valType:"number",min:1,max:16,dflt:2},highlight:{valType:"boolean",dflt:!0},highlightcolor:{valType:"color",dflt:tt.defaultLine},highlightwidth:{valType:"number",min:1,max:16,dflt:2}}}var dt=Ge.exports=ot(it({z:{valType:"data_array"},x:{valType:"data_array"},y:{valType:"data_array"},text:{valType:"string",dflt:"",arrayOk:!0},hovertext:{valType:"string",dflt:"",arrayOk:!0},hovertemplate:nt(),connectgaps:{valType:"boolean",dflt:!1,editType:"calc"},surfacecolor:{valType:"data_array"}},rt("",{colorAttr:"z or surfacecolor",showScaleDflt:!0,autoColorDflt:!1,editTypeOverride:"calc"}),{contours:{x:makeContourAttr("x"),y:makeContourAttr("y"),z:makeContourAttr("z")},hidesurface:{valType:"boolean",dflt:!1},lightposition:{x:{valType:"number",min:-1e5,max:1e5,dflt:10},y:{valType:"number",min:-1e5,max:1e5,dflt:1e4},z:{valType:"number",min:-1e5,max:1e5,dflt:0}},lighting:{ambient:{valType:"number",min:0,max:1,dflt:.8},diffuse:{valType:"number",min:0,max:1,dflt:.8},specular:{valType:"number",min:0,max:2,dflt:.05},roughness:{valType:"number",min:0,max:1,dflt:.5},fresnel:{valType:"number",min:0,max:5,dflt:.2}},opacity:{valType:"number",min:0,max:1,dflt:1},opacityscale:{valType:"any",editType:"calc"},_deprecated:{zauto:it({},rt.zauto,{}),zmin:it({},rt.zmin,{}),zmax:it({},rt.zmax,{})},hoverinfo:it({},at.hoverinfo),showlegend:it({},at.showlegend,{dflt:!1})}),"calc","nested");dt.x.editType=dt.y.editType=dt.z.editType="calc+clearAxisTypes",dt.transforms=void 0},{"../../components/color":643,"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/attributes":824,"../../plots/template_attributes":906}],1312:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/colorscale/calc");Ge.exports=function(Ne,Ge){Ge.surfacecolor?tt(Ne,Ge,{vals:Ge.surfacecolor,containerStr:"",cLetter:"c"}):tt(Ne,Ge,{vals:Ge.z,containerStr:"",cLetter:"c"})}},{"../../components/colorscale/calc":651}],1313:[function(Ne,Ge,Qe){"use strict";var tt=Ne("gl-surface3d"),rt=Ne("ndarray"),nt=Ne("ndarray-linear-interpolate").d2,at=Ne("../heatmap/interp2d"),it=Ne("../heatmap/find_empties"),ot=Ne("../../lib").isArrayOrTypedArray,dt=Ne("../../lib/gl_format_color").parseColorScale,ht=Ne("../../lib/str2rgbarray"),Dt=Ne("../../components/colorscale").extractOpts;function SurfaceTrace(Ne,Ge,Qe){this.scene=Ne,this.uid=Qe,this.surface=Ge,this.data=null,this.showContour=[!1,!1,!1],this.contourStart=[null,null,null],this.contourEnd=[null,null,null],this.contourSize=[0,0,0],this.minValues=[1/0,1/0,1/0],this.maxValues=[-1/0,-1/0,-1/0],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0,this.objectOffset=[0,0,0]}var Ot=SurfaceTrace.prototype;function isColormapCircular(Ne){var Ge=Ne[0].rgb,Qe=Ne[Ne.length-1].rgb;return Ge[0]===Qe[0]&&Ge[1]===Qe[1]&&Ge[2]===Qe[2]&&Ge[3]===Qe[3]}Ot.getXat=function(Ne,Ge,Qe,tt){var rt=ot(this.data.x)?ot(this.data.x[0])?this.data.x[Ge][Ne]:this.data.x[Ne]:Ne;return void 0===Qe?rt:tt.d2l(rt,0,Qe)},Ot.getYat=function(Ne,Ge,Qe,tt){var rt=ot(this.data.y)?ot(this.data.y[0])?this.data.y[Ge][Ne]:this.data.y[Ge]:Ge;return void 0===Qe?rt:tt.d2l(rt,0,Qe)},Ot.getZat=function(Ne,Ge,Qe,tt){var rt=this.data.z[Ge][Ne];return null===rt&&this.data.connectgaps&&this.data._interpolatedZ&&(rt=this.data._interpolatedZ[Ge][Ne]),void 0===Qe?rt:tt.d2l(rt,0,Qe)},Ot.handlePick=function(Ne){if(Ne.object===this.surface){var Ge=(Ne.data.index[0]-1)/this.dataScaleX-1,Qe=(Ne.data.index[1]-1)/this.dataScaleY-1,tt=Math.max(Math.min(Math.round(Ge),this.data.z[0].length-1),0),rt=Math.max(Math.min(Math.round(Qe),this.data._ylength-1),0);Ne.index=[tt,rt],Ne.traceCoordinate=[this.getXat(tt,rt),this.getYat(tt,rt),this.getZat(tt,rt)],Ne.dataCoordinate=[this.getXat(tt,rt,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(tt,rt,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(tt,rt,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var nt=0;nt<3;nt++){var at=Ne.dataCoordinate[nt];null!=at&&(Ne.dataCoordinate[nt]*=this.scene.dataScale[nt])}var it=this.data.hovertext||this.data.text;return Array.isArray(it)&&it[rt]&&void 0!==it[rt][tt]?Ne.textLabel=it[rt][tt]:Ne.textLabel=it||"",Ne.data.dataCoordinate=Ne.dataCoordinate.slice(),this.surface.highlight(Ne.data),this.scene.glplot.spikes.position=Ne.dataCoordinate,!0}};var Rt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];function getPow(Ne,Ge){if(Ne<Ge)return 0;for(var Qe=0;0===Math.floor(Ne%Ge);)Ne/=Ge,Qe++;return Qe}function getFactors(Ne){for(var Ge=[],Qe=0;Qe<Rt.length;Qe++){var tt=Rt[Qe];Ge.push(getPow(Ne,tt))}return Ge}function smallestDivisor(Ne){for(var Ge=getFactors(Ne),Qe=Ne,tt=0;tt<Rt.length;tt++)if(Ge[tt]>0){Qe=Rt[tt];break}return Qe}function leastCommonMultiple(Ne,Ge){if(!(Ne<1||Ge<1)){for(var Qe=getFactors(Ne),tt=getFactors(Ge),rt=1,nt=0;nt<Rt.length;nt++)rt*=Math.pow(Rt[nt],Math.max(Qe[nt],tt[nt]));return rt}}function arrayLCM(Ne){if(0!==Ne.length){for(var Ge=1,Qe=0;Qe<Ne.length;Qe++)Ge=leastCommonMultiple(Ge,Ne[Qe]);return Ge}}Ot.calcXnums=function(Ne){var Ge,Qe=[];for(Ge=1;Ge<Ne;Ge++){var tt=this.getXat(Ge-1,0),rt=this.getXat(Ge,0);Qe[Ge-1]=rt!==tt&&null!=tt&&null!=rt?Math.abs(rt-tt):0}var nt=0;for(Ge=1;Ge<Ne;Ge++)nt+=Qe[Ge-1];for(Ge=1;Ge<Ne;Ge++)0===Qe[Ge-1]?Qe[Ge-1]=1:Qe[Ge-1]=Math.round(nt/Qe[Ge-1]);return Qe},Ot.calcYnums=function(Ne){var Ge,Qe=[];for(Ge=1;Ge<Ne;Ge++){var tt=this.getYat(0,Ge-1),rt=this.getYat(0,Ge);Qe[Ge-1]=rt!==tt&&null!=tt&&null!=rt?Math.abs(rt-tt):0}var nt=0;for(Ge=1;Ge<Ne;Ge++)nt+=Qe[Ge-1];for(Ge=1;Ge<Ne;Ge++)0===Qe[Ge-1]?Qe[Ge-1]=1:Qe[Ge-1]=Math.round(nt/Qe[Ge-1]);return Qe};var Zt=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260],er=Zt[9],dr=Zt[13];function fnHomography(Ne,Ge,Qe){var tt=Qe[8]+Qe[2]*Ge[0]+Qe[5]*Ge[1];return Ne[0]=(Qe[6]+Qe[0]*Ge[0]+Qe[3]*Ge[1])/tt,Ne[1]=(Qe[7]+Qe[1]*Ge[0]+Qe[4]*Ge[1])/tt,Ne}function homography(Ne,Ge,Qe){return warp(Ne,Ge,fnHomography,Qe),Ne}function warp(Ne,Ge,Qe,tt){for(var rt=[0,0],at=Ne.shape[0],it=Ne.shape[1],ot=0;ot<at;ot++)for(var dt=0;dt<it;dt++)Qe(rt,[ot,dt],tt),Ne.set(ot,dt,nt(Ge,rt[0],rt[1]));return Ne}function insertIfNewLevel(Ne,Ge){for(var Qe=!1,tt=0;tt<Ne.length;tt++)if(Ge===Ne[tt]){Qe=!0;break}!1===Qe&&Ne.push(Ge)}function createSurfaceTrace(Ne,Ge){var Qe=Ne.glplot.gl,rt=tt({gl:Qe}),nt=new SurfaceTrace(Ne,rt,Ge.uid);return rt._trace=nt,nt.update(Ge),Ne.glplot.add(rt),nt}Ot.estimateScale=function(Ne,Ge){for(var Qe=1+arrayLCM(0===Ge?this.calcXnums(Ne):this.calcYnums(Ne));Qe<er;)Qe*=2;for(;Qe>dr;)Qe--,Qe/=smallestDivisor(Qe),++Qe<er&&(Qe=dr);var tt=Math.round(Qe/Ne);return tt>1?tt:1},Ot.refineCoords=function(Ne){for(var Ge=this.dataScaleX,Qe=this.dataScaleY,tt=Ne[0].shape[0],nt=Ne[0].shape[1],at=0|Math.floor(Ne[0].shape[0]*Ge+1),it=0|Math.floor(Ne[0].shape[1]*Qe+1),ot=1+tt+1,dt=1+nt+1,ht=rt(new Float32Array(ot*dt),[ot,dt]),Dt=[1/Ge,0,0,0,1/Qe,0,0,0,1],Ot=0;Ot<Ne.length;++Ot){this.surface.padField(ht,Ne[Ot]);var Rt=rt(new Float32Array(at*it),[at,it]);homography(Rt,ht,Dt),Ne[Ot]=Rt}},Ot.setContourLevels=function(){var Ne,Ge,Qe,tt=[[],[],[]],rt=[!1,!1,!1],nt=!1;for(Ne=0;Ne<3;++Ne)if(this.showContour[Ne]&&(nt=!0,this.contourSize[Ne]>0&&null!==this.contourStart[Ne]&&null!==this.contourEnd[Ne]&&this.contourEnd[Ne]>this.contourStart[Ne]))for(rt[Ne]=!0,Ge=this.contourStart[Ne];Ge<this.contourEnd[Ne];Ge+=this.contourSize[Ne])Qe=Ge*this.scene.dataScale[Ne],insertIfNewLevel(tt[Ne],Qe);if(nt){var at=[[],[],[]];for(Ne=0;Ne<3;++Ne)this.showContour[Ne]&&(at[Ne]=rt[Ne]?tt[Ne]:this.scene.contourLevels[Ne]);this.surface.update({levels:at})}},Ot.update=function(Ne){var Ge,Qe,tt,nt,ot=this.scene,Ot=ot.fullSceneLayout,Rt=this.surface,Zt=dt(Ne),er=ot.dataScale,mr=Ne.z[0].length,xr=Ne._ylength,br=ot.contourLevels;this.data=Ne;var Ar=[];for(Ge=0;Ge<3;Ge++)for(Ar[Ge]=[],Qe=0;Qe<mr;Qe++)Ar[Ge][Qe]=[];for(Qe=0;Qe<mr;Qe++)for(tt=0;tt<xr;tt++)Ar[0][Qe][tt]=this.getXat(Qe,tt,Ne.xcalendar,Ot.xaxis),Ar[1][Qe][tt]=this.getYat(Qe,tt,Ne.ycalendar,Ot.yaxis),Ar[2][Qe][tt]=this.getZat(Qe,tt,Ne.zcalendar,Ot.zaxis);if(Ne.connectgaps)for(Ne._emptypoints=it(Ar[2]),at(Ar[2],Ne._emptypoints),Ne._interpolatedZ=[],Qe=0;Qe<mr;Qe++)for(Ne._interpolatedZ[Qe]=[],tt=0;tt<xr;tt++)Ne._interpolatedZ[Qe][tt]=Ar[2][Qe][tt];for(Ge=0;Ge<3;Ge++)for(Qe=0;Qe<mr;Qe++)for(tt=0;tt<xr;tt++)null==(nt=Ar[Ge][Qe][tt])?Ar[Ge][Qe][tt]=NaN:nt=Ar[Ge][Qe][tt]*=er[Ge];for(Ge=0;Ge<3;Ge++)for(Qe=0;Qe<mr;Qe++)for(tt=0;tt<xr;tt++)null!=(nt=Ar[Ge][Qe][tt])&&(this.minValues[Ge]>nt&&(this.minValues[Ge]=nt),this.maxValues[Ge]<nt&&(this.maxValues[Ge]=nt));for(Ge=0;Ge<3;Ge++)this.objectOffset[Ge]=.5*(this.minValues[Ge]+this.maxValues[Ge]);for(Ge=0;Ge<3;Ge++)for(Qe=0;Qe<mr;Qe++)for(tt=0;tt<xr;tt++)null!=(nt=Ar[Ge][Qe][tt])&&(Ar[Ge][Qe][tt]-=this.objectOffset[Ge]);var en=[rt(new Float32Array(mr*xr),[mr,xr]),rt(new Float32Array(mr*xr),[mr,xr]),rt(new Float32Array(mr*xr),[mr,xr])];for(Ge=0;Ge<3;Ge++)for(Qe=0;Qe<mr;Qe++)for(tt=0;tt<xr;tt++)en[Ge].set(Qe,tt,Ar[Ge][Qe][tt]);Ar=[];var mn={colormap:Zt,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!Ne.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacityscale:Ne.opacityscale,opacity:Ne.opacity},xn=Dt(Ne);if(mn.intensityBounds=[xn.min,xn.max],Ne.surfacecolor){var kn=rt(new Float32Array(mr*xr),[mr,xr]);for(Qe=0;Qe<mr;Qe++)for(tt=0;tt<xr;tt++)kn.set(Qe,tt,Ne.surfacecolor[tt][Qe]);en.push(kn)}else mn.intensityBounds[0]*=er[2],mn.intensityBounds[1]*=er[2];(dr<en[0].shape[0]||dr<en[0].shape[1])&&(this.refineData=!1),!0===this.refineData&&(this.dataScaleX=this.estimateScale(en[0].shape[0],0),this.dataScaleY=this.estimateScale(en[0].shape[1],1),1===this.dataScaleX&&1===this.dataScaleY||this.refineCoords(en)),Ne.surfacecolor&&(mn.intensity=en.pop());var Cn=[!0,!0,!0],En=["x","y","z"];for(Ge=0;Ge<3;++Ge){var Pn=Ne.contours[En[Ge]];Cn[Ge]=Pn.highlight,mn.showContour[Ge]=Pn.show||Pn.highlight,mn.showContour[Ge]&&(mn.contourProject[Ge]=[Pn.project.x,Pn.project.y,Pn.project.z],Pn.show?(this.showContour[Ge]=!0,mn.levels[Ge]=br[Ge],Rt.highlightColor[Ge]=mn.contourColor[Ge]=ht(Pn.color),Pn.usecolormap?Rt.highlightTint[Ge]=mn.contourTint[Ge]=0:Rt.highlightTint[Ge]=mn.contourTint[Ge]=1,mn.contourWidth[Ge]=Pn.width,this.contourStart[Ge]=Pn.start,this.contourEnd[Ge]=Pn.end,this.contourSize[Ge]=Pn.size):(this.showContour[Ge]=!1,this.contourStart[Ge]=null,this.contourEnd[Ge]=null,this.contourSize[Ge]=0),Pn.highlight&&(mn.dynamicColor[Ge]=ht(Pn.highlightcolor),mn.dynamicWidth[Ge]=Pn.highlightwidth))}isColormapCircular(Zt)&&(mn.vertexColor=!0),mn.objectOffset=this.objectOffset,mn.coords=en,Rt.update(mn),Rt.visible=Ne.visible,Rt.enableDynamic=Cn,Rt.enableHighlight=Cn,Rt.snapToData=!0,"lighting"in Ne&&(Rt.ambientLight=Ne.lighting.ambient,Rt.diffuseLight=Ne.lighting.diffuse,Rt.specularLight=Ne.lighting.specular,Rt.roughness=Ne.lighting.roughness,Rt.fresnel=Ne.lighting.fresnel),"lightposition"in Ne&&(Rt.lightPosition=[Ne.lightposition.x,Ne.lightposition.y,Ne.lightposition.z])},Ot.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()},Ge.exports=createSurfaceTrace},{"../../components/colorscale":655,"../../lib":778,"../../lib/gl_format_color":774,"../../lib/str2rgbarray":802,"../heatmap/find_empties":1071,"../heatmap/interp2d":1074,"gl-surface3d":351,ndarray:495,"ndarray-linear-interpolate":489}],1314:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../registry"),rt=Ne("../../lib"),nt=Ne("../../components/colorscale/defaults"),at=Ne("./attributes"),it=.1;function createWave(Ne,Ge){for(var Qe=[],tt=32,rt=0;rt<tt;rt++){var nt=rt/(tt-1),at=Ge+(1-Ge)*(1-Math.pow(Math.sin(Ne*nt*Math.PI),2));Qe.push([nt,Math.max(0,Math.min(1,at))])}return Qe}function isValidScaleArray(Ne){var Ge=0;if(!Array.isArray(Ne)||Ne.length<2)return!1;if(!Ne[0]||!Ne[Ne.length-1])return!1;if(0!=+Ne[0][0]||1!=+Ne[Ne.length-1][0])return!1;for(var Qe=0;Qe<Ne.length;Qe++){var tt=Ne[Qe];if(2!==tt.length||+tt[0]<Ge)return!1;Ge=+tt[0]}return!0}function supplyDefaults(Ne,Ge,Qe,it){var ot,dt;function coerce(Qe,tt){return rt.coerce(Ne,Ge,at,Qe,tt)}var ht=coerce("x"),Dt=coerce("y"),Ot=coerce("z");if(!Ot||!Ot.length||ht&&ht.length<1||Dt&&Dt.length<1)Ge.visible=!1;else{Ge._xlength=Array.isArray(ht)&&rt.isArrayOrTypedArray(ht[0])?Ot.length:Ot[0].length,Ge._ylength=Ot.length,tt.getComponentMethod("calendars","handleTraceDefaults")(Ne,Ge,["x","y","z"],it),coerce("text"),coerce("hovertext"),coerce("hovertemplate"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach((function(Ne){coerce(Ne)}));var Rt=coerce("surfacecolor"),Zt=["x","y","z"];for(ot=0;ot<3;++ot){var er="contours."+Zt[ot],dr=coerce(er+".show"),mr=coerce(er+".highlight");if(dr||mr)for(dt=0;dt<3;++dt)coerce(er+".project."+Zt[dt]);dr&&(coerce(er+".color"),coerce(er+".width"),coerce(er+".usecolormap")),mr&&(coerce(er+".highlightcolor"),coerce(er+".highlightwidth")),coerce(er+".start"),coerce(er+".end"),coerce(er+".size")}Rt||(mapLegacy(Ne,"zmin","cmin"),mapLegacy(Ne,"zmax","cmax"),mapLegacy(Ne,"zauto","cauto")),nt(Ne,Ge,it,coerce,{prefix:"",cLetter:"c"}),opacityscaleDefaults(Ne,Ge,it,coerce),Ge._length=null}}function opacityscaleDefaults(Ne,Ge,Qe,tt){var rt=tt("opacityscale");"max"===rt?Ge.opacityscale=[[0,it],[1,1]]:"min"===rt?Ge.opacityscale=[[0,1],[1,it]]:"extremes"===rt?Ge.opacityscale=createWave(1,it):isValidScaleArray(rt)||(Ge.opacityscale=void 0)}function mapLegacy(Ne,Ge,Qe){Ge in Ne&&!(Qe in Ne)&&(Ne[Qe]=Ne[Ge])}Ge.exports={supplyDefaults:supplyDefaults,opacityscaleDefaults:opacityscaleDefaults}},{"../../components/colorscale/defaults":653,"../../lib":778,"../../registry":911,"./attributes":1311}],1315:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults").supplyDefaults,colorbar:{min:"cmin",max:"cmax"},calc:Ne("./calc"),plot:Ne("./convert"),moduleType:"trace",name:"surface",basePlotModule:Ne("../../plots/gl3d"),categories:["gl3d","2dMap","showLegend"],meta:{}}},{"../../plots/gl3d":870,"./attributes":1311,"./calc":1312,"./convert":1313,"./defaults":1314}],1316:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/annotations/attributes"),rt=Ne("../../lib/extend").extendFlat,nt=Ne("../../plot_api/edit_types").overrideAll,at=Ne("../../plots/font_attributes"),it=Ne("../../plots/domain").attributes;Ne("../../constants/docs").FORMAT_LINK,(Ge.exports=nt({domain:it({name:"table",trace:!0}),columnwidth:{valType:"number",arrayOk:!0,dflt:null},columnorder:{valType:"data_array"},header:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[]},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:28},align:rt({},tt.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:rt({},at({arrayOk:!0}))},cells:{values:{valType:"data_array",dflt:[]},format:{valType:"data_array",dflt:[]},prefix:{valType:"string",arrayOk:!0,dflt:null},suffix:{valType:"string",arrayOk:!0,dflt:null},height:{valType:"number",dflt:20},align:rt({},tt.align,{arrayOk:!0}),line:{width:{valType:"number",arrayOk:!0,dflt:1},color:{valType:"color",arrayOk:!0,dflt:"grey"}},fill:{color:{valType:"color",arrayOk:!0,dflt:"white"}},font:rt({},at({arrayOk:!0}))}},"calc","from-root")).transforms=void 0},{"../../components/annotations/attributes":626,"../../constants/docs":748,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/domain":855,"../../plots/font_attributes":856}],1317:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/get_data").getModuleCalcData,rt=Ne("./plot"),nt="table";Qe.name=nt,Qe.plot=function(Ne){var Ge=tt(Ne.calcdata,nt)[0];Ge.length&&rt(Ne,Ge)},Qe.clean=function(Ne,Ge,Qe,tt){var rt=tt._has&&tt._has(nt),at=Ge._has&&Ge._has(nt);rt&&!at&&tt._paperdiv.selectAll(".table").remove()}},{"../../plots/get_data":865,"./plot":1324}],1318:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib/gup").wrap;Ge.exports=function(){return tt({})}},{"../../lib/gup":775}],1319:[function(Ne,Ge,Qe){"use strict";Ge.exports={cellPad:8,columnExtentOffset:10,columnTitleOffset:28,emptyHeaderHeight:16,latexCheck:/^\$.*\$$/,goldenRatio:1.618,lineBreaker:"<br>",maxDimensionCount:60,overdrag:45,releaseTransitionDuration:120,releaseTransitionEase:"cubic-out",scrollbarCaptureWidth:18,scrollbarHideDelay:1e3,scrollbarHideDuration:1e3,scrollbarOffset:5,scrollbarWidth:8,transitionDuration:100,transitionEase:"cubic-out",uplift:5,wrapSpacer:" ",wrapSplitCharacter:" ",cn:{table:"table",tableControlView:"table-control-view",scrollBackground:"scroll-background",yColumn:"y-column",columnBlock:"column-block",scrollAreaClip:"scroll-area-clip",scrollAreaClipRect:"scroll-area-clip-rect",columnBoundary:"column-boundary",columnBoundaryClippath:"column-boundary-clippath",columnBoundaryRect:"column-boundary-rect",columnCells:"column-cells",columnCell:"column-cell",cellRect:"cell-rect",cellText:"cell-text",cellTextHolder:"cell-text-holder",scrollbarKit:"scrollbar-kit",scrollbar:"scrollbar",scrollbarSlider:"scrollbar-slider",scrollbarGlyph:"scrollbar-glyph",scrollbarCaptureZone:"scrollbar-capture-zone"}}},{}],1320:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./constants"),rt=Ne("../../lib/extend").extendFlat,nt=Ne("fast-isnumeric");function arrayMax(Ne){if(Array.isArray(Ne)){for(var Ge=0,Qe=0;Qe<Ne.length;Qe++)Ge=Math.max(Ge,arrayMax(Ne[Qe]));return Ge}return Ne}function sum(Ne,Ge){return Ne+Ge}function squareStringMatrix(Ne){var Ge,Qe=Ne.slice(),tt=1/0,rt=0;for(Ge=0;Ge<Qe.length;Ge++)Array.isArray(Qe[Ge])||(Qe[Ge]=[Qe[Ge]]),tt=Math.min(tt,Qe[Ge].length),rt=Math.max(rt,Qe[Ge].length);if(tt!==rt)for(Ge=0;Ge<Qe.length;Ge++){var nt=rt-Qe[Ge].length;nt&&(Qe[Ge]=Qe[Ge].concat(emptyStrings(nt)))}return Qe}function emptyStrings(Ne){for(var Ge=new Array(Ne),Qe=0;Qe<Ne;Qe++)Ge[Qe]="";return Ge}function xScale(Ne){return Ne.calcdata.columns.reduce((function(Ge,Qe){return Qe.xIndex<Ne.xIndex?Ge+Qe.columnWidth:Ge}),0)}function makeRowBlock(Ne,Ge){return Object.keys(Ne).map((function(Qe){return rt({},Ne[Qe],{auxiliaryBlocks:Ge})}))}function makeAnchorToRowBlock(Ne,Ge){for(var Qe,tt={},rt=0,nt=0,at=makeIdentity(),it=0,ot=0,dt=0;dt<Ne.length;dt++)Qe=Ne[dt],at.rows.push({rowIndex:dt,rowHeight:Qe}),((nt+=Qe)>=Ge||dt===Ne.length-1)&&(tt[rt]=at,at.key=ot++,at.firstRowIndex=it,at.lastRowIndex=dt,at=makeIdentity(),rt+=nt,it=dt+1,nt=0);return tt}function makeIdentity(){return{firstRowIndex:null,lastRowIndex:null,rows:[]}}Ge.exports=function(Ne,Ge){var Qe=squareStringMatrix(Ge.cells.values),slicer=function(Ne){return Ne.slice(Ge.header.values.length,Ne.length)},at=squareStringMatrix(Ge.header.values);at.length&&!at[0].length&&(at[0]=[""],at=squareStringMatrix(at));var it=at.concat(slicer(Qe).map((function(){return emptyStrings((at[0]||[""]).length)}))),ot=Ge.domain,dt=Math.floor(Ne._fullLayout._size.w*(ot.x[1]-ot.x[0])),ht=Math.floor(Ne._fullLayout._size.h*(ot.y[1]-ot.y[0])),Dt=Ge.header.values.length?it[0].map((function(){return Ge.header.height})):[tt.emptyHeaderHeight],Ot=Qe.length?Qe[0].map((function(){return Ge.cells.height})):[],Rt=Dt.reduce(sum,0),Zt=makeAnchorToRowBlock(Ot,ht-Rt+tt.uplift),er=makeRowBlock(makeAnchorToRowBlock(Dt,Rt),[]),dr=makeRowBlock(Zt,er),mr={},xr=Ge._fullInput.columnorder.concat(slicer(Qe.map((function(Ne,Ge){return Ge})))),br=it.map((function(Ne,Qe){var tt=Array.isArray(Ge.columnwidth)?Ge.columnwidth[Math.min(Qe,Ge.columnwidth.length-1)]:Ge.columnwidth;return nt(tt)?Number(tt):1})),Ar=br.reduce(sum,0);br=br.map((function(Ne){return Ne/Ar*dt}));var en=Math.max(arrayMax(Ge.header.line.width),arrayMax(Ge.cells.line.width)),mn={key:Ge.uid+Ne._context.staticPlot,translateX:ot.x[0]*Ne._fullLayout._size.w,translateY:Ne._fullLayout._size.h*(1-ot.y[1]),size:Ne._fullLayout._size,width:dt,maxLineWidth:en,height:ht,columnOrder:xr,groupHeight:ht,rowBlocks:dr,headerRowBlocks:er,scrollY:0,cells:rt({},Ge.cells,{values:Qe}),headerCells:rt({},Ge.header,{values:it}),gdColumns:it.map((function(Ne){return Ne[0]})),gdColumnsOriginalOrder:it.map((function(Ne){return Ne[0]})),prevPages:[0,0],scrollbarState:{scrollbarScrollInProgress:!1},columns:it.map((function(Ne,Ge){var Qe=mr[Ne];return mr[Ne]=(Qe||0)+1,{key:Ne+"__"+mr[Ne],label:Ne,specIndex:Ge,xIndex:xr[Ge],xScale:xScale,x:void 0,calcdata:void 0,columnWidth:br[Ge]}}))};return mn.columns.forEach((function(Ne){Ne.calcdata=mn,Ne.x=xScale(Ne)})),mn}},{"../../lib/extend":768,"./constants":1319,"fast-isnumeric":241}],1321:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib/extend").extendFlat;function rowFromTo(Ne){var Ge=Ne.rowBlocks[Ne.page],Qe=Ge?Ge.rows[0].rowIndex:0;return[Qe,Ge?Qe+Ge.rows.length:0]}Qe.splitToPanels=function(Ne){var Ge=[0,0],Qe=tt({},Ne,{key:"header",type:"header",page:0,prevPages:Ge,currentRepaint:[null,null],dragHandle:!0,values:Ne.calcdata.headerCells.values[Ne.specIndex],rowBlocks:Ne.calcdata.headerRowBlocks,calcdata:tt({},Ne.calcdata,{cells:Ne.calcdata.headerCells})});return[tt({},Ne,{key:"cells1",type:"cells",page:0,prevPages:Ge,currentRepaint:[null,null],dragHandle:!1,values:Ne.calcdata.cells.values[Ne.specIndex],rowBlocks:Ne.calcdata.rowBlocks}),tt({},Ne,{key:"cells2",type:"cells",page:1,prevPages:Ge,currentRepaint:[null,null],dragHandle:!1,values:Ne.calcdata.cells.values[Ne.specIndex],rowBlocks:Ne.calcdata.rowBlocks}),Qe]},Qe.splitToCells=function(Ne){var Ge=rowFromTo(Ne);return(Ne.values||[]).slice(Ge[0],Ge[1]).map((function(Qe,tt){return{keyWithinBlock:tt+("string"==typeof Qe&&Qe.match(/[<$&> ]/)?"_keybuster_"+Math.random():""),key:Ge[0]+tt,column:Ne,calcdata:Ne.calcdata,page:Ne.page,rowBlocks:Ne.rowBlocks,value:Qe}}))}},{"../../lib/extend":768}],1322:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./attributes"),nt=Ne("../../plots/domain").defaults;function defaultColumnOrder(Ne,Ge){for(var Qe=Ne.columnorder||[],tt=Ne.header.values.length,rt=Qe.slice(0,tt),nt=rt.slice().sort((function(Ne,Ge){return Ne-Ge})),at=rt.map((function(Ne){return nt.indexOf(Ne)})),it=at.length;it<tt;it++)at.push(it);Ge("columnorder",at)}Ge.exports=function(Ne,Ge,Qe,at){function coerce(Qe,nt){return tt.coerce(Ne,Ge,rt,Qe,nt)}nt(Ge,at,coerce),coerce("columnwidth"),coerce("header.values"),coerce("header.format"),coerce("header.align"),coerce("header.prefix"),coerce("header.suffix"),coerce("header.height"),coerce("header.line.width"),coerce("header.line.color"),coerce("header.fill.color"),tt.coerceFont(coerce,"header.font",tt.extendFlat({},at.font)),defaultColumnOrder(Ge,coerce),coerce("cells.values"),coerce("cells.format"),coerce("cells.align"),coerce("cells.prefix"),coerce("cells.suffix"),coerce("cells.height"),coerce("cells.line.width"),coerce("cells.line.color"),coerce("cells.fill.color"),tt.coerceFont(coerce,"cells.font",tt.extendFlat({},at.font)),Ge._length=null}},{"../../lib":778,"../../plots/domain":855,"./attributes":1316}],1323:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),calc:Ne("./calc"),plot:Ne("./plot"),moduleType:"trace",name:"table",basePlotModule:Ne("./base_plot"),categories:["noOpacity"],meta:{}}},{"./attributes":1316,"./base_plot":1317,"./calc":1318,"./defaults":1322,"./plot":1324}],1324:[function(Ne,Ge,Qe){"use strict";var tt=Ne("./constants"),rt=Ne("d3"),nt=Ne("../../lib/gup"),at=Ne("../../components/drawing"),it=Ne("../../lib/svg_text_utils"),ot=Ne("../../lib").raiseToTop,dt=Ne("../../lib").strTranslate,ht=Ne("../../lib").cancelTransition,Dt=Ne("./data_preparation_helper"),Ot=Ne("./data_split_helpers"),Rt=Ne("../../components/color");function roundHalfWidth(Ne){return Math.ceil(Ne.calcdata.maxLineWidth/2)}function scrollAreaBottomClipKey(Ne,Ge){return"clip"+Ne._fullLayout._uid+"_scrollAreaBottomClip_"+Ge.key}function columnBoundaryClipKey(Ne,Ge){return"clip"+Ne._fullLayout._uid+"_columnBoundaryClippath_"+Ge.calcdata.key+"_"+Ge.specIndex}function flatData(Ne){return[].concat.apply([],Ne.map((function(Ne){return Ne}))).map((function(Ne){return Ne.__data__}))}function renderScrollbarKit(Ne,Ge,Qe){function calcTotalHeight(Ne){var Ge=Ne.rowBlocks;return firstRowAnchor(Ge,Ge.length-1)+(Ge.length?rowsHeight(Ge[Ge.length-1],1/0):1)}var at=Ne.selectAll("."+tt.cn.scrollbarKit).data(nt.repeat,nt.keyFun);at.enter().append("g").classed(tt.cn.scrollbarKit,!0).style("shape-rendering","geometricPrecision"),at.each((function(Ne){var Ge=Ne.scrollbarState;Ge.totalHeight=calcTotalHeight(Ne),Ge.scrollableAreaHeight=Ne.groupHeight-headerHeight(Ne),Ge.currentlyVisibleHeight=Math.min(Ge.totalHeight,Ge.scrollableAreaHeight),Ge.ratio=Ge.currentlyVisibleHeight/Ge.totalHeight,Ge.barLength=Math.max(Ge.ratio*Ge.currentlyVisibleHeight,tt.goldenRatio*tt.scrollbarWidth),Ge.barWiggleRoom=Ge.currentlyVisibleHeight-Ge.barLength,Ge.wiggleRoom=Math.max(0,Ge.totalHeight-Ge.scrollableAreaHeight),Ge.topY=0===Ge.barWiggleRoom?0:Ne.scrollY/Ge.wiggleRoom*Ge.barWiggleRoom,Ge.bottomY=Ge.topY+Ge.barLength,Ge.dragMultiplier=Ge.wiggleRoom/Ge.barWiggleRoom})).attr("transform",(function(Ne){var Ge=Ne.width+tt.scrollbarWidth/2+tt.scrollbarOffset;return dt(Ge,headerHeight(Ne))}));var it=at.selectAll("."+tt.cn.scrollbar).data(nt.repeat,nt.keyFun);it.enter().append("g").classed(tt.cn.scrollbar,!0);var ot=it.selectAll("."+tt.cn.scrollbarSlider).data(nt.repeat,nt.keyFun);ot.enter().append("g").classed(tt.cn.scrollbarSlider,!0),ot.attr("transform",(function(Ne){return dt(0,Ne.scrollbarState.topY||0)}));var ht=ot.selectAll("."+tt.cn.scrollbarGlyph).data(nt.repeat,nt.keyFun);ht.enter().append("line").classed(tt.cn.scrollbarGlyph,!0).attr("stroke","black").attr("stroke-width",tt.scrollbarWidth).attr("stroke-linecap","round").attr("y1",tt.scrollbarWidth/2),ht.attr("y2",(function(Ne){return Ne.scrollbarState.barLength-tt.scrollbarWidth/2})).attr("stroke-opacity",(function(Ne){return Ne.columnDragInProgress||!Ne.scrollbarState.barWiggleRoom||Qe?0:.4})),ht.transition().delay(0).duration(0),ht.transition().delay(tt.scrollbarHideDelay).duration(tt.scrollbarHideDuration).attr("stroke-opacity",0);var Dt=it.selectAll("."+tt.cn.scrollbarCaptureZone).data(nt.repeat,nt.keyFun);Dt.enter().append("line").classed(tt.cn.scrollbarCaptureZone,!0).attr("stroke","white").attr("stroke-opacity",.01).attr("stroke-width",tt.scrollbarCaptureWidth).attr("stroke-linecap","butt").attr("y1",0).on("mousedown",(function(Qe){var tt=rt.event.y,nt=this.getBoundingClientRect(),at=Qe.scrollbarState,it=tt-nt.top,ot=rt.scale.linear().domain([0,at.scrollableAreaHeight]).range([0,at.totalHeight]).clamp(!0);at.topY<=it&&it<=at.bottomY||makeDragRow(Ge,Ne,null,ot(it-at.barLength/2))(Qe)})).call(rt.behavior.drag().origin((function(Ne){return rt.event.stopPropagation(),Ne.scrollbarState.scrollbarScrollInProgress=!0,Ne})).on("drag",makeDragRow(Ge,Ne)).on("dragend",(function(){}))),Dt.attr("y2",(function(Ne){return Ne.scrollbarState.scrollableAreaHeight})),Ge._context.staticPlot&&(ht.remove(),Dt.remove())}function renderColumnCellTree(Ne,Ge,Qe,tt){var rt=renderColumnCell(renderColumnCells(Qe));supplyStylingValues(rt),sizeAndStyleRect(renderCellRect(rt));var nt=renderCellText(renderCellTextHolder(rt));setFont(nt),populateCellText(nt,Ge,tt,Ne),setCellHeightAndPositionY(rt)}function renderColumnCells(Ne){var Ge=Ne.selectAll("."+tt.cn.columnCells).data(nt.repeat,nt.keyFun);return Ge.enter().append("g").classed(tt.cn.columnCells,!0),Ge.exit().remove(),Ge}function renderColumnCell(Ne){var Ge=Ne.selectAll("."+tt.cn.columnCell).data(Ot.splitToCells,(function(Ne){return Ne.keyWithinBlock}));return Ge.enter().append("g").classed(tt.cn.columnCell,!0),Ge.exit().remove(),Ge}function renderCellRect(Ne){var Ge=Ne.selectAll("."+tt.cn.cellRect).data(nt.repeat,(function(Ne){return Ne.keyWithinBlock}));return Ge.enter().append("rect").classed(tt.cn.cellRect,!0),Ge}function renderCellText(Ne){var Ge=Ne.selectAll("."+tt.cn.cellText).data(nt.repeat,(function(Ne){return Ne.keyWithinBlock}));return Ge.enter().append("text").classed(tt.cn.cellText,!0).style("cursor",(function(){return"auto"})).on("mousedown",(function(){rt.event.stopPropagation()})),Ge}function renderCellTextHolder(Ne){var Ge=Ne.selectAll("."+tt.cn.cellTextHolder).data(nt.repeat,(function(Ne){return Ne.keyWithinBlock}));return Ge.enter().append("g").classed(tt.cn.cellTextHolder,!0).style("shape-rendering","geometricPrecision"),Ge}function supplyStylingValues(Ne){Ne.each((function(Ne,Ge){var Qe=Ne.calcdata.cells.font,tt=Ne.column.specIndex,rt={size:gridPick(Qe.size,tt,Ge),color:gridPick(Qe.color,tt,Ge),family:gridPick(Qe.family,tt,Ge)};Ne.rowNumber=Ne.key,Ne.align=gridPick(Ne.calcdata.cells.align,tt,Ge),Ne.cellBorderWidth=gridPick(Ne.calcdata.cells.line.width,tt,Ge),Ne.font=rt}))}function setFont(Ne){Ne.each((function(Ne){at.font(rt.select(this),Ne.font)}))}function sizeAndStyleRect(Ne){Ne.attr("width",(function(Ne){return Ne.column.columnWidth})).attr("stroke-width",(function(Ne){return Ne.cellBorderWidth})).each((function(Ne){var Ge=rt.select(this);Rt.stroke(Ge,gridPick(Ne.calcdata.cells.line.color,Ne.column.specIndex,Ne.rowNumber)),Rt.fill(Ge,gridPick(Ne.calcdata.cells.fill.color,Ne.column.specIndex,Ne.rowNumber))}))}function populateCellText(Ne,Ge,Qe,nt){Ne.text((function(Ne){var Ge=Ne.column.specIndex,Qe=Ne.rowNumber,nt=Ne.value,at="string"==typeof nt,it=at&&nt.match(/<br>/i),ot=!at||it;Ne.mayHaveMarkup=at&&nt.match(/[<&>]/);var dt=isLatex(nt);Ne.latex=dt;var ht,Dt,Ot=dt?"":gridPick(Ne.calcdata.cells.prefix,Ge,Qe)||"",Rt=dt?"":gridPick(Ne.calcdata.cells.suffix,Ge,Qe)||"",Zt=dt?null:gridPick(Ne.calcdata.cells.format,Ge,Qe)||null,er=Ot+(Zt?rt.format(Zt)(Ne.value):Ne.value)+Rt;if(Ne.wrappingNeeded=!Ne.wrapped&&!ot&&!dt&&(ht=hasWrapCharacter(er)),Ne.cellHeightMayIncrease=it||dt||Ne.mayHaveMarkup||(void 0===ht?hasWrapCharacter(er):ht),Ne.needsConvertToTspans=Ne.mayHaveMarkup||Ne.wrappingNeeded||Ne.latex,Ne.wrappingNeeded){var dr=(" "===tt.wrapSplitCharacter?er.replace(/<a href=/gi,"<a_href="):er).split(tt.wrapSplitCharacter),mr=" "===tt.wrapSplitCharacter?dr.map((function(Ne){return Ne.replace(/<a_href=/gi,"<a href=")})):dr;Ne.fragments=mr.map((function(Ne){return{text:Ne,width:null}})),Ne.fragments.push({fragment:tt.wrapSpacer,width:null}),Dt=mr.join(tt.lineBreaker)+tt.lineBreaker+tt.wrapSpacer}else delete Ne.fragments,Dt=er;return Dt})).attr("dy",(function(Ne){return Ne.needsConvertToTspans?0:"0.75em"})).each((function(Ne){var at=this,ot=rt.select(at),ht=Ne.wrappingNeeded?wrapTextMaker:updateYPositionMaker;Ne.needsConvertToTspans?it.convertToTspans(ot,nt,ht(Qe,at,Ge,nt,Ne)):rt.select(at.parentNode).attr("transform",(function(Ne){return dt(xPosition(Ne),tt.cellPad)})).attr("text-anchor",(function(Ne){return{left:"start",center:"middle",right:"end"}[Ne.align]}))}))}function isLatex(Ne){return"string"==typeof Ne&&Ne.match(tt.latexCheck)}function hasWrapCharacter(Ne){return-1!==Ne.indexOf(tt.wrapSplitCharacter)}function columnMoved(Ne,Ge,Qe){var tt=Ge.gdColumnsOriginalOrder;Ge.gdColumns.sort((function(Ne,Ge){return Qe[tt.indexOf(Ne)]-Qe[tt.indexOf(Ge)]})),Ge.columnorder=Qe,Ne.emit("plotly_restyle")}function gridPick(Ne,Ge,Qe){if(Array.isArray(Ne)){var tt=Ne[Math.min(Ge,Ne.length-1)];return Array.isArray(tt)?tt[Math.min(Qe,tt.length-1)]:tt}return Ne}function easeColumn(Ne,Ge,Qe){Ne.transition().ease(tt.releaseTransitionEase).duration(tt.releaseTransitionDuration).attr("transform",dt(Ge.x,Qe))}function cellsBlock(Ne){return"cells"===Ne.type}function headerBlock(Ne){return"header"===Ne.type}function headerHeight(Ne){return(Ne.rowBlocks.length?Ne.rowBlocks[0].auxiliaryBlocks:[]).reduce((function(Ne,Ge){return Ne+rowsHeight(Ge,1/0)}),0)}function findPagesAndCacheHeights(Ne,Ge,Qe){for(var tt=[],rt=0,nt=0;nt<Ne.length;nt++){for(var at=Ne[nt],it=at.rows,ot=0,dt=0;dt<it.length;dt++)ot+=it[dt].rowHeight;at.allRowsHeight=ot,Ge<rt+ot&&Ge+Qe>rt&&tt.push(nt),rt+=ot}return tt}function updateBlockYPosition(Ne,Ge,Qe){var tt=flatData(Ge)[0];if(void 0!==tt){var rt=tt.rowBlocks,nt=tt.calcdata,at=firstRowAnchor(rt,rt.length),it=tt.calcdata.groupHeight-headerHeight(tt),ot=nt.scrollY=Math.max(0,Math.min(at-it,nt.scrollY)),ht=findPagesAndCacheHeights(rt,ot,it);1===ht.length&&(ht[0]===rt.length-1?ht.unshift(ht[0]-1):ht.push(ht[0]+1)),ht[0]%2&&ht.reverse(),Ge.each((function(Ne,Ge){Ne.page=ht[Ge],Ne.scrollY=ot})),Ge.attr("transform",(function(Ne){var Ge=firstRowAnchor(Ne.rowBlocks,Ne.page)-Ne.scrollY;return dt(0,Ge)})),Ne&&(conditionalPanelRerender(Ne,Qe,Ge,ht,tt.prevPages,tt,0),conditionalPanelRerender(Ne,Qe,Ge,ht,tt.prevPages,tt,1),renderScrollbarKit(Qe,Ne))}}function makeDragRow(Ne,Ge,Qe,nt){return function(at){var it=at.calcdata?at.calcdata:at,ot=Ge.filter((function(Ne){return it.key===Ne.key})),dt=Qe||it.scrollbarState.dragMultiplier,ht=it.scrollY;it.scrollY=void 0===nt?it.scrollY+dt*rt.event.dy:nt;var Dt=ot.selectAll("."+tt.cn.yColumn).selectAll("."+tt.cn.columnBlock).filter(cellsBlock);return updateBlockYPosition(Ne,Dt,ot),it.scrollY===ht}}function conditionalPanelRerender(Ne,Ge,Qe,tt,rt,nt,at){tt[at]!==rt[at]&&(clearTimeout(nt.currentRepaint[at]),nt.currentRepaint[at]=setTimeout((function(){var nt=Qe.filter((function(Ne,Ge){return Ge===at&&tt[Ge]!==rt[Ge]}));renderColumnCellTree(Ne,Ge,nt,Qe),rt[at]=tt[at]})))}function wrapTextMaker(Ne,Ge,Qe,nt){return function(){var at=rt.select(Ge.parentNode);at.each((function(Ne){var Ge=Ne.fragments;at.selectAll("tspan.line").each((function(Ne,Qe){Ge[Qe].width=this.getComputedTextLength()}));var Qe,rt,nt=Ge[Ge.length-1].width,it=Ge.slice(0,-1),ot=[],dt=0,ht=Ne.column.columnWidth-2*tt.cellPad;for(Ne.value="";it.length;)dt+(rt=(Qe=it.shift()).width+nt)>ht&&(Ne.value+=ot.join(tt.wrapSpacer)+tt.lineBreaker,ot=[],dt=0),ot.push(Qe.text),dt+=rt;dt&&(Ne.value+=ot.join(tt.wrapSpacer)),Ne.wrapped=!0})),at.selectAll("tspan.line").remove(),populateCellText(at.select("."+tt.cn.cellText),Qe,Ne,nt),rt.select(Ge.parentNode.parentNode).call(setCellHeightAndPositionY)}}function updateYPositionMaker(Ne,Ge,Qe,nt,at){return function(){if(!at.settledY){var it=rt.select(Ge.parentNode),ot=getBlock(at),ht=at.key-ot.firstRowIndex,Dt=ot.rows[ht].rowHeight,Ot=at.cellHeightMayIncrease?Ge.parentNode.getBoundingClientRect().height+2*tt.cellPad:Dt,Rt=Math.max(Ot,Dt);Rt-ot.rows[ht].rowHeight&&(ot.rows[ht].rowHeight=Rt,Ne.selectAll("."+tt.cn.columnCell).call(setCellHeightAndPositionY),updateBlockYPosition(null,Ne.filter(cellsBlock),0),renderScrollbarKit(Qe,nt,!0)),it.attr("transform",(function(){var Ne=this,Ge=Ne.parentNode.getBoundingClientRect(),Qe=rt.select(Ne.parentNode).select("."+tt.cn.cellRect).node().getBoundingClientRect(),nt=Ne.transform.baseVal.consolidate(),it=Qe.top-Ge.top+(nt?nt.matrix.f:tt.cellPad);return dt(xPosition(at,rt.select(Ne.parentNode).select("."+tt.cn.cellTextHolder).node().getBoundingClientRect().width),it)})),at.settledY=!0}}}function xPosition(Ne,Ge){switch(Ne.align){case"left":default:return tt.cellPad;case"right":return Ne.column.columnWidth-(Ge||0)-tt.cellPad;case"center":return(Ne.column.columnWidth-(Ge||0))/2}}function setCellHeightAndPositionY(Ne){Ne.attr("transform",(function(Ne){var Ge=Ne.rowBlocks[0].auxiliaryBlocks.reduce((function(Ne,Ge){return Ne+rowsHeight(Ge,1/0)}),0),Qe=rowsHeight(getBlock(Ne),Ne.key);return dt(0,Qe+Ge)})).selectAll("."+tt.cn.cellRect).attr("height",(function(Ne){return getRow(getBlock(Ne),Ne.key).rowHeight}))}function firstRowAnchor(Ne,Ge){for(var Qe=0,tt=Ge-1;tt>=0;tt--)Qe+=allRowsHeight(Ne[tt]);return Qe}function rowsHeight(Ne,Ge){for(var Qe=0,tt=0;tt<Ne.rows.length&&Ne.rows[tt].rowIndex<Ge;tt++)Qe+=Ne.rows[tt].rowHeight;return Qe}function allRowsHeight(Ne){var Ge=Ne.allRowsHeight;if(void 0!==Ge)return Ge;for(var Qe=0,tt=0;tt<Ne.rows.length;tt++)Qe+=Ne.rows[tt].rowHeight;return Ne.allRowsHeight=Qe,Qe}function getBlock(Ne){return Ne.rowBlocks[Ne.page]}function getRow(Ne,Ge){return Ne.rows[Ge-Ne.firstRowIndex]}Ge.exports=function(Ne,Ge){var Qe=!Ne._context.staticPlot,it=Ne._fullLayout._paper.selectAll("."+tt.cn.table).data(Ge.map((function(Ge){var Qe=nt.unwrap(Ge).trace;return Dt(Ne,Qe)})),nt.keyFun);it.exit().remove(),it.enter().append("g").classed(tt.cn.table,!0).attr("overflow","visible").style("box-sizing","content-box").style("position","absolute").style("left",0).style("overflow","visible").style("shape-rendering","crispEdges").style("pointer-events","all"),it.attr("width",(function(Ne){return Ne.width+Ne.size.l+Ne.size.r})).attr("height",(function(Ne){return Ne.height+Ne.size.t+Ne.size.b})).attr("transform",(function(Ne){return dt(Ne.translateX,Ne.translateY)}));var Rt=it.selectAll("."+tt.cn.tableControlView).data(nt.repeat,nt.keyFun),Zt=Rt.enter().append("g").classed(tt.cn.tableControlView,!0).style("box-sizing","content-box");if(Qe){var er="onwheel"in document?"wheel":"mousewheel";Zt.on("mousemove",(function(Ge){Rt.filter((function(Ne){return Ge===Ne})).call(renderScrollbarKit,Ne)})).on(er,(function(Ge){if(!Ge.scrollbarState.wheeling){Ge.scrollbarState.wheeling=!0;var Qe=Ge.scrollY+rt.event.deltaY;makeDragRow(Ne,Rt,null,Qe)(Ge)||(rt.event.stopPropagation(),rt.event.preventDefault()),Ge.scrollbarState.wheeling=!1}})).call(renderScrollbarKit,Ne,!0)}Rt.attr("transform",(function(Ne){return dt(Ne.size.l,Ne.size.t)}));var dr=Rt.selectAll("."+tt.cn.scrollBackground).data(nt.repeat,nt.keyFun);dr.enter().append("rect").classed(tt.cn.scrollBackground,!0).attr("fill","none"),dr.attr("width",(function(Ne){return Ne.width})).attr("height",(function(Ne){return Ne.height})),Rt.each((function(Ge){at.setClipUrl(rt.select(this),scrollAreaBottomClipKey(Ne,Ge),Ne)}));var mr=Rt.selectAll("."+tt.cn.yColumn).data((function(Ne){return Ne.columns}),nt.keyFun);mr.enter().append("g").classed(tt.cn.yColumn,!0),mr.exit().remove(),mr.attr("transform",(function(Ne){return dt(Ne.x,0)})),Qe&&mr.call(rt.behavior.drag().origin((function(Ge){return easeColumn(rt.select(this),Ge,-tt.uplift),ot(this),Ge.calcdata.columnDragInProgress=!0,renderScrollbarKit(Rt.filter((function(Ne){return Ge.calcdata.key===Ne.key})),Ne),Ge})).on("drag",(function(Ne){var Ge=rt.select(this),getter=function(Ge){return(Ne===Ge?rt.event.x:Ge.x)+Ge.columnWidth/2};Ne.x=Math.max(-tt.overdrag,Math.min(Ne.calcdata.width+tt.overdrag-Ne.columnWidth,rt.event.x)),flatData(mr).filter((function(Ge){return Ge.calcdata.key===Ne.calcdata.key})).sort((function(Ne,Ge){return getter(Ne)-getter(Ge)})).forEach((function(Ge,Qe){Ge.xIndex=Qe,Ge.x=Ne===Ge?Ge.x:Ge.xScale(Ge)})),mr.filter((function(Ge){return Ne!==Ge})).transition().ease(tt.transitionEase).duration(tt.transitionDuration).attr("transform",(function(Ne){return dt(Ne.x,0)})),Ge.call(ht).attr("transform",dt(Ne.x,-tt.uplift))})).on("dragend",(function(Ge){var Qe=rt.select(this),tt=Ge.calcdata;Ge.x=Ge.xScale(Ge),Ge.calcdata.columnDragInProgress=!1,easeColumn(Qe,Ge,0),columnMoved(Ne,tt,tt.columns.map((function(Ne){return Ne.xIndex})))}))),mr.each((function(Ge){at.setClipUrl(rt.select(this),columnBoundaryClipKey(Ne,Ge),Ne)}));var xr=mr.selectAll("."+tt.cn.columnBlock).data(Ot.splitToPanels,nt.keyFun);xr.enter().append("g").classed(tt.cn.columnBlock,!0).attr("id",(function(Ne){return Ne.key})),xr.style("cursor",(function(Ne){return Ne.dragHandle?"ew-resize":Ne.calcdata.scrollbarState.barWiggleRoom?"ns-resize":"default"}));var br=xr.filter(headerBlock),Ar=xr.filter(cellsBlock);Qe&&Ar.call(rt.behavior.drag().origin((function(Ne){return rt.event.stopPropagation(),Ne})).on("drag",makeDragRow(Ne,Rt,-1)).on("dragend",(function(){}))),renderColumnCellTree(Ne,Rt,br,xr),renderColumnCellTree(Ne,Rt,Ar,xr);var en=Rt.selectAll("."+tt.cn.scrollAreaClip).data(nt.repeat,nt.keyFun);en.enter().append("clipPath").classed(tt.cn.scrollAreaClip,!0).attr("id",(function(Ge){return scrollAreaBottomClipKey(Ne,Ge)}));var mn=en.selectAll("."+tt.cn.scrollAreaClipRect).data(nt.repeat,nt.keyFun);mn.enter().append("rect").classed(tt.cn.scrollAreaClipRect,!0).attr("x",-tt.overdrag).attr("y",-tt.uplift).attr("fill","none"),mn.attr("width",(function(Ne){return Ne.width+2*tt.overdrag})).attr("height",(function(Ne){return Ne.height+tt.uplift})),mr.selectAll("."+tt.cn.columnBoundary).data(nt.repeat,nt.keyFun).enter().append("g").classed(tt.cn.columnBoundary,!0);var xn=mr.selectAll("."+tt.cn.columnBoundaryClippath).data(nt.repeat,nt.keyFun);xn.enter().append("clipPath").classed(tt.cn.columnBoundaryClippath,!0),xn.attr("id",(function(Ge){return columnBoundaryClipKey(Ne,Ge)}));var kn=xn.selectAll("."+tt.cn.columnBoundaryRect).data(nt.repeat,nt.keyFun);kn.enter().append("rect").classed(tt.cn.columnBoundaryRect,!0).attr("fill","none"),kn.attr("width",(function(Ne){return Ne.columnWidth+2*roundHalfWidth(Ne)})).attr("height",(function(Ne){return Ne.calcdata.height+2*roundHalfWidth(Ne)+tt.uplift})).attr("x",(function(Ne){return-roundHalfWidth(Ne)})).attr("y",(function(Ne){return-roundHalfWidth(Ne)})),updateBlockYPosition(null,Ar,Rt)}},{"../../components/color":643,"../../components/drawing":665,"../../lib":778,"../../lib/gup":775,"../../lib/svg_text_utils":803,"./constants":1319,"./data_preparation_helper":1320,"./data_split_helpers":1321,d3:169}],1325:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/template_attributes").hovertemplateAttrs,rt=Ne("../../plots/template_attributes").texttemplateAttrs,nt=Ne("../../components/colorscale/attributes"),at=Ne("../../plots/domain").attributes,it=Ne("../pie/attributes"),ot=Ne("../sunburst/attributes"),dt=Ne("./constants"),ht=Ne("../../lib/extend").extendFlat;Ge.exports={labels:ot.labels,parents:ot.parents,values:ot.values,branchvalues:ot.branchvalues,count:ot.count,level:ot.level,maxdepth:ot.maxdepth,tiling:{packing:{valType:"enumerated",values:["squarify","binary","dice","slice","slice-dice","dice-slice"],dflt:"squarify",editType:"plot"},squarifyratio:{valType:"number",min:1,dflt:1,editType:"plot"},flip:{valType:"flaglist",flags:["x","y"],dflt:"",editType:"plot"},pad:{valType:"number",min:0,dflt:3,editType:"plot"},editType:"calc"},marker:ht({pad:{t:{valType:"number",min:0,editType:"plot"},l:{valType:"number",min:0,editType:"plot"},r:{valType:"number",min:0,editType:"plot"},b:{valType:"number",min:0,editType:"plot"},editType:"calc"},colors:ot.marker.colors,depthfade:{valType:"enumerated",values:[!0,!1,"reversed"],editType:"style"},line:ot.marker.line,editType:"calc"},nt("marker",{colorAttr:"colors",anim:!1})),pathbar:{visible:{valType:"boolean",dflt:!0,editType:"plot"},side:{valType:"enumerated",values:["top","bottom"],dflt:"top",editType:"plot"},edgeshape:{valType:"enumerated",values:[">","<","|","/","\\"],dflt:">",editType:"plot"},thickness:{valType:"number",min:12,editType:"plot"},textfont:ht({},it.textfont,{}),editType:"calc"},text:it.text,textinfo:ot.textinfo,texttemplate:rt({editType:"plot"},{keys:dt.eventDataKeys.concat(["label","value"])}),hovertext:it.hovertext,hoverinfo:ot.hoverinfo,hovertemplate:tt({},{keys:dt.eventDataKeys}),textfont:it.textfont,insidetextfont:it.insidetextfont,outsidetextfont:ht({},it.outsidetextfont,{}),textposition:{valType:"enumerated",values:["top left","top center","top right","middle left","middle center","middle right","bottom left","bottom center","bottom right"],dflt:"top left",editType:"plot"},sort:it.sort,root:ot.root,domain:at({name:"treemap",trace:!0,editType:"calc"})}},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plots/domain":855,"../../plots/template_attributes":906,"../pie/attributes":1161,"../sunburst/attributes":1299,"./constants":1328}],1326:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/plots");Qe.name="treemap",Qe.plot=function(Ne,Ge,rt,nt){tt.plotBasePlot(Qe.name,Ne,Ge,rt,nt)},Qe.clean=function(Ne,Ge,rt,nt){tt.cleanBasePlot(Qe.name,Ne,Ge,rt,nt)}},{"../../plots/plots":891}],1327:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../sunburst/calc");Qe.calc=function(Ne,Ge){return tt.calc(Ne,Ge)},Qe.crossTraceCalc=function(Ne){return tt._runCrossTraceCalc("treemap",Ne)}},{"../sunburst/calc":1301}],1328:[function(Ne,Ge,Qe){"use strict";Ge.exports={CLICK_TRANSITION_TIME:750,CLICK_TRANSITION_EASING:"poly",eventDataKeys:["currentPath","root","entry","percentRoot","percentEntry","percentParent"],gapWithPathbar:1}},{}],1329:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./attributes"),nt=Ne("../../components/color"),at=Ne("../../plots/domain").defaults,it=Ne("../bar/defaults").handleText,ot=Ne("../bar/constants").TEXTPAD,dt=Ne("../../components/colorscale"),ht=dt.hasColorscale,Dt=dt.handleDefaults;Ge.exports=function(Ne,Ge,Qe,dt){function coerce(Qe,nt){return tt.coerce(Ne,Ge,rt,Qe,nt)}var Ot=coerce("labels"),Rt=coerce("parents");if(Ot&&Ot.length&&Rt&&Rt.length){var Zt=coerce("values");Zt&&Zt.length?coerce("branchvalues"):coerce("count"),coerce("level"),coerce("maxdepth"),"squarify"===coerce("tiling.packing")&&coerce("tiling.squarifyratio"),coerce("tiling.flip"),coerce("tiling.pad");var er=coerce("text");coerce("texttemplate"),Ge.texttemplate||coerce("textinfo",Array.isArray(er)?"text+label":"label"),coerce("hovertext"),coerce("hovertemplate");var dr=coerce("pathbar.visible");it(Ne,Ge,dt,coerce,"auto",{hasPathbar:dr,moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!1,moduleHasCliponaxis:!1,moduleHasTextangle:!1,moduleHasInsideanchor:!1}),coerce("textposition");var mr=-1!==Ge.textposition.indexOf("bottom");coerce("marker.line.width")&&coerce("marker.line.color",dt.paper_bgcolor);var xr=coerce("marker.colors"),br=Ge._hasColorscale=ht(Ne,"marker","colors")||(Ne.marker||{}).coloraxis;br?Dt(Ne,Ge,dt,coerce,{prefix:"marker.",cLetter:"c"}):coerce("marker.depthfade",!(xr||[]).length);var Ar=2*Ge.textfont.size;coerce("marker.pad.t",mr?Ar/4:Ar),coerce("marker.pad.l",Ar/4),coerce("marker.pad.r",Ar/4),coerce("marker.pad.b",mr?Ar:Ar/4),br&&Dt(Ne,Ge,dt,coerce,{prefix:"marker.",cLetter:"c"}),Ge._hovered={marker:{line:{width:2,color:nt.contrast(dt.paper_bgcolor)}}},dr&&(coerce("pathbar.thickness",Ge.pathbar.textfont.size+2*ot),coerce("pathbar.side"),coerce("pathbar.edgeshape")),coerce("sort"),coerce("root.color"),at(Ge,dt,coerce),Ge._length=null}else Ge.visible=!1}},{"../../components/color":643,"../../components/colorscale":655,"../../lib":778,"../../plots/domain":855,"../bar/constants":923,"../bar/defaults":925,"./attributes":1325}],1330:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../lib"),nt=Ne("../../components/drawing"),at=Ne("../../lib/svg_text_utils"),it=Ne("./partition"),ot=Ne("./style").styleOne,dt=Ne("./constants"),ht=Ne("../sunburst/helpers"),Dt=Ne("../sunburst/fx"),Ot=!0;Ge.exports=function(Ne,Ge,Qe,Rt,Zt){var er=Zt.barDifY,dr=Zt.width,mr=Zt.height,xr=Zt.viewX,br=Zt.viewY,Ar=Zt.pathSlice,en=Zt.toMoveInsideSlice,mn=Zt.strTransform,xn=Zt.hasTransition,kn=Zt.handleSlicesExit,Cn=Zt.makeUpdateSliceInterpolator,En=Zt.makeUpdateTextInterpolator,Pn={},Dn=Ne._fullLayout,In=Ge[0],zn=In.trace,Bn=In.hierarchy,Vn=dr/zn._entryDepth,Hn=ht.listPath(Qe.data,"id"),qn=it(Bn.copy(),[dr,mr],{packing:"dice",pad:{inner:0,top:0,left:0,right:0,bottom:0}}).descendants();(qn=qn.filter((function(Ne){var Ge=Hn.indexOf(Ne.data.id);return-1!==Ge&&(Ne.x0=Vn*Ge,Ne.x1=Vn*(Ge+1),Ne.y0=er,Ne.y1=er+mr,Ne.onPathbar=!0,!0)}))).reverse(),(Rt=Rt.data(qn,ht.getPtId)).enter().append("g").classed("pathbar",!0),kn(Rt,Ot,Pn,[dr,mr],Ar),Rt.order();var Yn=Rt;xn&&(Yn=Yn.transition().each("end",(function(){var Ge=tt.select(this);ht.setSliceCursor(Ge,Ne,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:!1})}))),Yn.each((function(it){it._hoverX=xr(it.x1-Math.min(dr,mr)/2),it._hoverY=br(it.y1-mr/2);var Rt=tt.select(this),Zt=rt.ensureSingle(Rt,"path","surface",(function(Ne){Ne.style("pointer-events","all")}));xn?Zt.transition().attrTween("d",(function(Ne){var Ge=Cn(Ne,Ot,Pn,[dr,mr]);return function(Ne){return Ar(Ge(Ne))}})):Zt.attr("d",Ar),Rt.call(Dt,Qe,Ne,Ge,{styleOne:ot,eventDataKeys:dt.eventDataKeys,transitionTime:dt.CLICK_TRANSITION_TIME,transitionEasing:dt.CLICK_TRANSITION_EASING}).call(ht.setSliceCursor,Ne,{hideOnRoot:!1,hideOnLeaves:!1,isTransitioning:Ne._transitioning}),Zt.call(ot,it,zn,{hovered:!1}),it._text=(ht.getPtLabel(it)||"").split("<br>").join(" ")||"";var er=rt.ensureSingle(Rt,"g","slicetext"),kn=rt.ensureSingle(er,"text","",(function(Ne){Ne.attr("data-notex",1)})),In=rt.ensureUniformFontSize(Ne,ht.determineTextFont(zn,it,Dn.font,{onPathbar:!0}));kn.text(it._text||" ").classed("slicetext",!0).attr("text-anchor","start").call(nt.font,In).call(at.convertToTspans,Ne),it.textBB=nt.bBox(kn.node()),it.transform=en(it,{fontSize:In.size,onPathbar:!0}),it.transform.fontSize=In.size,xn?kn.transition().attrTween("transform",(function(Ne){var Ge=En(Ne,Ot,Pn,[dr,mr]);return function(Ne){return mn(Ge(Ne))}})):kn.attr("transform",mn(it))}))}},{"../../components/drawing":665,"../../lib":778,"../../lib/svg_text_utils":803,"../sunburst/fx":1304,"../sunburst/helpers":1305,"./constants":1328,"./partition":1335,"./style":1337,d3:169}],1331:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../lib"),nt=Ne("../../components/drawing"),at=Ne("../../lib/svg_text_utils"),it=Ne("./partition"),ot=Ne("./style").styleOne,dt=Ne("./constants"),ht=Ne("../sunburst/helpers"),Dt=Ne("../sunburst/fx"),Ot=Ne("../sunburst/plot").formatSliceLabel,Rt=!1;Ge.exports=function(Ne,Ge,Qe,Zt,er){var dr=er.width,mr=er.height,xr=er.viewX,br=er.viewY,Ar=er.pathSlice,en=er.toMoveInsideSlice,mn=er.strTransform,xn=er.hasTransition,kn=er.handleSlicesExit,Cn=er.makeUpdateSliceInterpolator,En=er.makeUpdateTextInterpolator,Pn=er.prevEntry,Dn={},In=Ne._fullLayout,zn=Ge[0].trace,Bn=-1!==zn.textposition.indexOf("left"),Vn=-1!==zn.textposition.indexOf("right"),Hn=-1!==zn.textposition.indexOf("bottom"),qn=!Hn&&!zn.marker.pad.t||Hn&&!zn.marker.pad.b,Yn=it(Qe,[dr,mr],{packing:zn.tiling.packing,squarifyratio:zn.tiling.squarifyratio,flipX:zn.tiling.flip.indexOf("x")>-1,flipY:zn.tiling.flip.indexOf("y")>-1,pad:{inner:zn.tiling.pad,top:zn.marker.pad.t,left:zn.marker.pad.l,right:zn.marker.pad.r,bottom:zn.marker.pad.b}}).descendants(),$n=1/0,ra=-1/0;Yn.forEach((function(Ne){var Ge=Ne.depth;Ge>=zn._maxDepth?(Ne.x0=Ne.x1=(Ne.x0+Ne.x1)/2,Ne.y0=Ne.y1=(Ne.y0+Ne.y1)/2):($n=Math.min($n,Ge),ra=Math.max(ra,Ge))})),Zt=Zt.data(Yn,ht.getPtId),zn._maxVisibleLayers=isFinite(ra)?ra-$n+1:0,Zt.enter().append("g").classed("slice",!0),kn(Zt,Rt,Dn,[dr,mr],Ar),Zt.order();var oa=null;if(xn&&Pn){var pa=ht.getPtId(Pn);Zt.each((function(Ne){null===oa&&ht.getPtId(Ne)===pa&&(oa={x0:Ne.x0,x1:Ne.x1,y0:Ne.y0,y1:Ne.y1})}))}var getRefRect=function(){return oa||{x0:0,x1:dr,y0:0,y1:mr}},ga=Zt;return xn&&(ga=ga.transition().each("end",(function(){var Ge=tt.select(this);ht.setSliceCursor(Ge,Ne,{hideOnRoot:!0,hideOnLeaves:!1,isTransitioning:!1})}))),ga.each((function(it){var Zt=ht.isHeader(it,zn);it._hoverX=xr(it.x1-zn.marker.pad.r),it._hoverY=br(Hn?it.y1-zn.marker.pad.b/2:it.y0+zn.marker.pad.t/2);var er=tt.select(this),kn=rt.ensureSingle(er,"path","surface",(function(Ne){Ne.style("pointer-events","all")}));xn?kn.transition().attrTween("d",(function(Ne){var Ge=Cn(Ne,Rt,getRefRect(),[dr,mr]);return function(Ne){return Ar(Ge(Ne))}})):kn.attr("d",Ar),er.call(Dt,Qe,Ne,Ge,{styleOne:ot,eventDataKeys:dt.eventDataKeys,transitionTime:dt.CLICK_TRANSITION_TIME,transitionEasing:dt.CLICK_TRANSITION_EASING}).call(ht.setSliceCursor,Ne,{isTransitioning:Ne._transitioning}),kn.call(ot,it,zn,{hovered:!1}),it.x0===it.x1||it.y0===it.y1?it._text="":it._text=Zt?qn?"":ht.getPtLabel(it)||"":Ot(it,Qe,zn,Ge,In)||"";var Pn=rt.ensureSingle(er,"g","slicetext"),Dn=rt.ensureSingle(Pn,"text","",(function(Ne){Ne.attr("data-notex",1)})),Yn=rt.ensureUniformFontSize(Ne,ht.determineTextFont(zn,it,In.font));Dn.text(it._text||" ").classed("slicetext",!0).attr("text-anchor",Vn?"end":Bn||Zt?"start":"middle").call(nt.font,Yn).call(at.convertToTspans,Ne),it.textBB=nt.bBox(Dn.node()),it.transform=en(it,{fontSize:Yn.size,isHeader:Zt}),it.transform.fontSize=Yn.size,xn?Dn.transition().attrTween("transform",(function(Ne){var Ge=En(Ne,Rt,getRefRect(),[dr,mr]);return function(Ne){return mn(Ge(Ne))}})):Dn.attr("transform",mn(it))})),oa}},{"../../components/drawing":665,"../../lib":778,"../../lib/svg_text_utils":803,"../sunburst/fx":1304,"../sunburst/helpers":1305,"../sunburst/plot":1309,"./constants":1328,"./partition":1335,"./style":1337,d3:169}],1332:[function(Ne,Ge,Qe){"use strict";Ge.exports={moduleType:"trace",name:"treemap",basePlotModule:Ne("./base_plot"),categories:[],animatable:!0,attributes:Ne("./attributes"),layoutAttributes:Ne("./layout_attributes"),supplyDefaults:Ne("./defaults"),supplyLayoutDefaults:Ne("./layout_defaults"),calc:Ne("./calc").calc,crossTraceCalc:Ne("./calc").crossTraceCalc,plot:Ne("./plot"),style:Ne("./style").style,colorbar:Ne("../scatter/marker_colorbar"),meta:{}}},{"../scatter/marker_colorbar":1205,"./attributes":1325,"./base_plot":1326,"./calc":1327,"./defaults":1329,"./layout_attributes":1333,"./layout_defaults":1334,"./plot":1336,"./style":1337}],1333:[function(Ne,Ge,Qe){"use strict";Ge.exports={treemapcolorway:{valType:"colorlist",editType:"calc"},extendtreemapcolors:{valType:"boolean",dflt:!0,editType:"calc"}}},{}],1334:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./layout_attributes");Ge.exports=function(Ne,Ge){function coerce(Qe,nt){return tt.coerce(Ne,Ge,rt,Qe,nt)}coerce("treemapcolorway",Ge.colorway),coerce("extendtreemapcolors")}},{"../../lib":778,"./layout_attributes":1333}],1335:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3-hierarchy");function getTilingMethod(Ne,Ge){switch(Ne){case"squarify":return tt.treemapSquarify.ratio(Ge);case"binary":return tt.treemapBinary;case"dice":return tt.treemapDice;case"slice":return tt.treemapSlice;default:return tt.treemapSliceDice}}function flipTree(Ne,Ge,Qe){var tt;Qe.swapXY&&(tt=Ne.x0,Ne.x0=Ne.y0,Ne.y0=tt,tt=Ne.x1,Ne.x1=Ne.y1,Ne.y1=tt),Qe.flipX&&(tt=Ne.x0,Ne.x0=Ge[0]-Ne.x1,Ne.x1=Ge[0]-tt),Qe.flipY&&(tt=Ne.y0,Ne.y0=Ge[1]-Ne.y1,Ne.y1=Ge[1]-tt);var rt=Ne.children;if(rt)for(var nt=0;nt<rt.length;nt++)flipTree(rt[nt],Ge,Qe)}Ge.exports=function(Ne,Ge,Qe){var rt,nt=Qe.flipX,at=Qe.flipY,it="dice-slice"===Qe.packing,ot=Qe.pad[at?"bottom":"top"],dt=Qe.pad[nt?"right":"left"],ht=Qe.pad[nt?"left":"right"],Dt=Qe.pad[at?"top":"bottom"];it&&(rt=dt,dt=ot,ot=rt,rt=ht,ht=Dt,Dt=rt);var Ot=tt.treemap().tile(getTilingMethod(Qe.packing,Qe.squarifyratio)).paddingInner(Qe.pad.inner).paddingLeft(dt).paddingRight(ht).paddingTop(ot).paddingBottom(Dt).size(it?[Ge[1],Ge[0]]:Ge)(Ne);return(it||nt||at)&&flipTree(Ot,Ge,{swapXY:it,flipX:nt,flipY:at}),Ot}},{"d3-hierarchy":161}],1336:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../sunburst/helpers"),nt=Ne("../../lib"),at=Ne("../bar/constants").TEXTPAD,it=Ne("../bar/plot").toMoveInsideBar,ot=Ne("../bar/uniform_text"),dt=ot.recordMinTextSize,ht=ot.clearMinTextSize,Dt=Ne("../bar/style").resizeText,Ot=Ne("./constants"),Rt=Ne("./draw_descendants"),Zt=Ne("./draw_ancestors");function getKey(Ne){return rt.isHierarchyRoot(Ne)?"":rt.getPtId(Ne)}function plotOne(Ne,Ge,Qe,ot){var ht=Ne._fullLayout,Dt=Ge[0],er=Dt.trace,dr=Dt.hierarchy,mr=rt.findEntryWithLevel(dr,er.level),xr=tt.select(Qe),br=xr.selectAll("g.pathbar"),Ar=xr.selectAll("g.slice");if(!mr)return br.remove(),void Ar.remove();var en=rt.isHierarchyRoot(mr),mn=!ht.uniformtext.mode&&rt.hasTransition(ot),xn=rt.getMaxDepth(er),hasVisibleDepth=function(Ne){return Ne.data.depth-mr.data.depth<xn},kn=ht._size,Cn=er.domain,En=kn.w*(Cn.x[1]-Cn.x[0]),Pn=kn.h*(Cn.y[1]-Cn.y[0]),Dn=En,In=er.pathbar.thickness,zn=er.marker.line.width+Ot.gapWithPathbar,Bn=er.pathbar.visible?er.pathbar.side.indexOf("bottom")>-1?Pn+zn:-(In+zn):0,Vn={x0:Dn,x1:Dn,y0:Bn,y1:Bn+In},findClosestEdge=function(Ne,Ge,Qe){var tt=er.tiling.pad,isLeftOfRect=function(Ne){return Ne-tt<=Ge.x0},isRightOfRect=function(Ne){return Ne+tt>=Ge.x1},isBottomOfRect=function(Ne){return Ne-tt<=Ge.y0},isTopOfRect=function(Ne){return Ne+tt>=Ge.y1};return{x0:isLeftOfRect(Ne.x0-tt)?0:isRightOfRect(Ne.x0-tt)?Qe[0]:Ne.x0,x1:isLeftOfRect(Ne.x1+tt)?0:isRightOfRect(Ne.x1+tt)?Qe[0]:Ne.x1,y0:isBottomOfRect(Ne.y0-tt)?0:isTopOfRect(Ne.y0-tt)?Qe[1]:Ne.y0,y1:isBottomOfRect(Ne.y1+tt)?0:isTopOfRect(Ne.y1+tt)?Qe[1]:Ne.y1}},Hn=null,qn={},Yn={},$n=null,getPrev=function(Ne,Ge){return Ge?qn[getKey(Ne)]:Yn[getKey(Ne)]},getOrigin=function(Ne,Ge,Qe,tt){if(Ge)return qn[getKey(dr)]||Vn;var rt=Yn[er.level]||Qe;return hasVisibleDepth(Ne)?findClosestEdge(Ne,rt,tt):{}};Dt.hasMultipleRoots&&en&&xn++,er._maxDepth=xn,er._backgroundColor=ht.paper_bgcolor,er._entryDepth=mr.data.depth,er._atRootLevel=en;var ra=-En/2+kn.l+kn.w*(Cn.x[1]+Cn.x[0])/2,oa=-Pn/2+kn.t+kn.h*(1-(Cn.y[1]+Cn.y[0])/2),viewMapX=function(Ne){return ra+Ne},viewMapY=function(Ne){return oa+Ne},pa=viewMapY(0),ga=viewMapX(0),viewBarX=function(Ne){return ga+Ne},viewBarY=function(Ne){return pa+Ne};function pos(Ne,Ge){return Ne+","+Ge}var ma=viewBarX(0),limitX0=function(Ne){Ne.x=Math.max(ma,Ne.x)},_a=er.pathbar.edgeshape,pathAncestor=function(Ne){var Ge=viewBarX(Math.max(Math.min(Ne.x0,Ne.x0),0)),Qe=viewBarX(Math.min(Math.max(Ne.x1,Ne.x1),Dn)),tt=viewBarY(Ne.y0),rt=viewBarY(Ne.y1),nt=In/2,at={},it={};at.x=Ge,it.x=Qe,at.y=it.y=(tt+rt)/2;var ot={x:Ge,y:tt},dt={x:Qe,y:tt},ht={x:Qe,y:rt},Dt={x:Ge,y:rt};return">"===_a?(ot.x-=nt,dt.x-=nt,ht.x-=nt,Dt.x-=nt):"/"===_a?(ht.x-=nt,Dt.x-=nt,at.x-=nt/2,it.x-=nt/2):"\\"===_a?(ot.x-=nt,dt.x-=nt,at.x-=nt/2,it.x-=nt/2):"<"===_a&&(at.x-=nt,it.x-=nt),limitX0(ot),limitX0(Dt),limitX0(at),limitX0(dt),limitX0(ht),limitX0(it),"M"+pos(ot.x,ot.y)+"L"+pos(dt.x,dt.y)+"L"+pos(it.x,it.y)+"L"+pos(ht.x,ht.y)+"L"+pos(Dt.x,Dt.y)+"L"+pos(at.x,at.y)+"Z"},pathDescendant=function(Ne){var Ge=viewMapX(Ne.x0),Qe=viewMapX(Ne.x1),tt=viewMapY(Ne.y0),rt=viewMapY(Ne.y1),nt=Qe-Ge,at=rt-tt;if(!nt||!at)return"";var it=0,ot=nt>2*it&&at>2*it?it:0,arc=function(Ne,Ge){return ot?"a"+pos(ot,ot)+" 0 0 1 "+pos(Ne,Ge):""};return"M"+pos(Ge,tt+ot)+arc(ot,-ot)+"L"+pos(Qe-ot,tt)+arc(ot,ot)+"L"+pos(Qe,rt-ot)+arc(-ot,ot)+"L"+pos(Ge+ot,rt)+arc(-ot,-ot)+"Z"},toMoveInsideSlice=function(Ne,Ge){var Qe=Ne.x0,tt=Ne.x1,rt=Ne.y0,nt=Ne.y1,ot=Ne.textBB,hasFlag=function(Ne){return-1!==er.textposition.indexOf(Ne)},Dt=hasFlag("bottom"),Ot=hasFlag("top")||Ge.isHeader&&!Dt?"start":Dt?"end":"middle",Rt=hasFlag("right"),Zt=hasFlag("left")||Ge.onPathbar?-1:Rt?1:0,dr=er.marker.pad;if(Ge.isHeader){if((Qe+=dr.l-at)>=(tt-=dr.r-at)){var mr=(Qe+tt)/2;Qe=mr,tt=mr}var xr;Dt?rt<(xr=nt-dr.b)&&xr<nt&&(rt=xr):rt<(xr=rt+dr.t)&&xr<nt&&(nt=xr)}var br=it(Qe,tt,rt,nt,ot,{isHorizontal:!1,constrained:!0,angle:0,anchor:Ot,leftToRight:Zt});return br.fontSize=Ge.fontSize,br.targetX=viewMapX(br.targetX),br.targetY=viewMapY(br.targetY),isNaN(br.targetX)||isNaN(br.targetY)?{}:(Qe!==tt&&rt!==nt&&dt(er.type,br,ht),{scale:br.scale,rotate:br.rotate,textX:br.textX,textY:br.textY,anchorX:br.anchorX,anchorY:br.anchorY,targetX:br.targetX,targetY:br.targetY})},interpFromParent=function(Ne,Ge){for(var Qe,tt=0,rt=Ne;!Qe&&tt<xn;)tt++,(rt=rt.parent)?Qe=getPrev(rt,Ge):tt=xn;return Qe||{}},makeExitSliceInterpolator=function(Ne,Ge,Qe,rt){var nt,at=getPrev(Ne,Ge);if(Ge)nt=Vn;else{var it=getPrev(mr,Ge);nt=it?findClosestEdge(Ne,it,rt):{}}return tt.interpolate(at,nt)},makeUpdateSliceInterpolator=function(Ne,Ge,Qe,rt){var at,it=getPrev(Ne,Ge);if(it)at=it;else if(Ge)at=Vn;else if(Hn)if(Ne.parent){var ot=$n||Qe;ot&&!Ge?at=findClosestEdge(Ne,ot,rt):(at={},nt.extendFlat(at,interpFromParent(Ne,Ge)))}else at=Ne;else at={};return tt.interpolate(at,{x0:Ne.x0,x1:Ne.x1,y0:Ne.y0,y1:Ne.y1})},makeUpdateTextInterpolator=function(Ne,Ge,Qe,at){var it=getPrev(Ne,Ge),ot={},Dt=getOrigin(Ne,Ge,Qe,at);nt.extendFlat(ot,{transform:toMoveInsideSlice({x0:Dt.x0,x1:Dt.x1,y0:Dt.y0,y1:Dt.y1,textBB:Ne.textBB,_text:Ne._text},{isHeader:rt.isHeader(Ne,er)})}),it?ot=it:Ne.parent&&nt.extendFlat(ot,interpFromParent(Ne,Ge));var Ot=Ne.transform;return Ne.x0!==Ne.x1&&Ne.y0!==Ne.y1&&dt(er.type,Ot,ht),tt.interpolate(ot,{transform:{scale:Ot.scale,rotate:Ot.rotate,textX:Ot.textX,textY:Ot.textY,anchorX:Ot.anchorX,anchorY:Ot.anchorY,targetX:Ot.targetX,targetY:Ot.targetY}})},handleSlicesExit=function(Ne,Ge,Qe,rt,nt){var at=rt[0],it=rt[1];mn?Ne.exit().transition().each((function(){var Ne=tt.select(this);Ne.select("path.surface").transition().attrTween("d",(function(Ne){var tt=makeExitSliceInterpolator(Ne,Ge,Qe,[at,it]);return function(Ne){return nt(tt(Ne))}})),Ne.select("g.slicetext").attr("opacity",0)})).remove():Ne.exit().remove()},strTransform=function(Ne){var Ge=Ne.transform;return Ne.x0!==Ne.x1&&Ne.y0!==Ne.y1&&dt(er.type,Ge,ht),nt.getTextTransform({textX:Ge.textX,textY:Ge.textY,anchorX:Ge.anchorX,anchorY:Ge.anchorY,targetX:Ge.targetX,targetY:Ge.targetY,scale:Ge.scale,rotate:Ge.rotate})};mn&&(br.each((function(Ne){qn[getKey(Ne)]={x0:Ne.x0,x1:Ne.x1,y0:Ne.y0,y1:Ne.y1},Ne.transform&&(qn[getKey(Ne)].transform={textX:Ne.transform.textX,textY:Ne.transform.textY,anchorX:Ne.transform.anchorX,anchorY:Ne.transform.anchorY,targetX:Ne.transform.targetX,targetY:Ne.transform.targetY,scale:Ne.transform.scale,rotate:Ne.transform.rotate})})),Ar.each((function(Ne){Yn[getKey(Ne)]={x0:Ne.x0,x1:Ne.x1,y0:Ne.y0,y1:Ne.y1},Ne.transform&&(Yn[getKey(Ne)].transform={textX:Ne.transform.textX,textY:Ne.transform.textY,anchorX:Ne.transform.anchorX,anchorY:Ne.transform.anchorY,targetX:Ne.transform.targetX,targetY:Ne.transform.targetY,scale:Ne.transform.scale,rotate:Ne.transform.rotate}),!Hn&&rt.isEntry(Ne)&&(Hn=Ne)}))),$n=Rt(Ne,Ge,mr,Ar,{width:En,height:Pn,viewX:viewMapX,viewY:viewMapY,pathSlice:pathDescendant,toMoveInsideSlice:toMoveInsideSlice,prevEntry:Hn,makeUpdateSliceInterpolator:makeUpdateSliceInterpolator,makeUpdateTextInterpolator:makeUpdateTextInterpolator,handleSlicesExit:handleSlicesExit,hasTransition:mn,strTransform:strTransform}),er.pathbar.visible?Zt(Ne,Ge,mr,br,{barDifY:Bn,width:Dn,height:In,viewX:viewBarX,viewY:viewBarY,pathSlice:pathAncestor,toMoveInsideSlice:toMoveInsideSlice,makeUpdateSliceInterpolator:makeUpdateSliceInterpolator,makeUpdateTextInterpolator:makeUpdateTextInterpolator,handleSlicesExit:handleSlicesExit,hasTransition:mn,strTransform:strTransform}):br.remove()}Ge.exports=function(Ne,Ge,Qe,nt){var at,it,ot=Ne._fullLayout,dt=ot._treemaplayer,Ot=!Qe;ht("treemap",ot),(at=dt.selectAll("g.trace.treemap").data(Ge,(function(Ne){return Ne[0].trace.uid}))).enter().append("g").classed("trace",!0).classed("treemap",!0),at.order(),!ot.uniformtext.mode&&rt.hasTransition(Qe)?(nt&&(it=nt()),tt.transition().duration(Qe.duration).ease(Qe.easing).each("end",(function(){it&&it()})).each("interrupt",(function(){it&&it()})).each((function(){dt.selectAll("g.trace").each((function(Ge){plotOne(Ne,Ge,this,Qe)}))}))):(at.each((function(Ge){plotOne(Ne,Ge,this,Qe)})),ot.uniformtext.mode&&Dt(Ne,ot._treemaplayer.selectAll(".trace"),"treemap")),Ot&&at.exit().remove()}},{"../../lib":778,"../bar/constants":923,"../bar/plot":932,"../bar/style":935,"../bar/uniform_text":937,"../sunburst/helpers":1305,"./constants":1328,"./draw_ancestors":1330,"./draw_descendants":1331,d3:169}],1337:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../components/color"),nt=Ne("../../lib"),at=Ne("../sunburst/helpers"),it=Ne("../bar/uniform_text").resizeText;function style(Ne){var Ge=Ne._fullLayout._treemaplayer.selectAll(".trace");it(Ne,Ge,"treemap"),Ge.each((function(Ne){var Ge=tt.select(this),Qe=Ne[0].trace;Ge.style("opacity",Qe.opacity),Ge.selectAll("path.surface").each((function(Ne){tt.select(this).call(styleOne,Ne,Qe,{hovered:!1})}))}))}function styleOne(Ne,Ge,Qe,tt){var it,ot,dt=(tt||{}).hovered,ht=Ge.data.data,Dt=ht.i,Ot=ht.color,Rt=at.isHierarchyRoot(Ge),Zt=1;if(dt)it=Qe._hovered.marker.line.color,ot=Qe._hovered.marker.line.width;else if(Rt&&Ot===Qe.root.color)Zt=100,it="rgba(0,0,0,0)",ot=0;else if(it=nt.castOption(Qe,Dt,"marker.line.color")||rt.defaultLine,ot=nt.castOption(Qe,Dt,"marker.line.width")||0,!Qe._hasColorscale&&!Ge.onPathbar){var er=Qe.marker.depthfade;if(er){var dr,mr=rt.combine(rt.addOpacity(Qe._backgroundColor,.75),Ot);if(!0===er){var xr=at.getMaxDepth(Qe);dr=isFinite(xr)?at.isLeaf(Ge)?0:Qe._maxVisibleLayers-(Ge.data.depth-Qe._entryDepth):Ge.data.height+1}else dr=Ge.data.depth-Qe._entryDepth,Qe._atRootLevel||dr++;if(dr>0)for(var br=0;br<dr;br++){var Ar=.5*br/dr;Ot=rt.combine(rt.addOpacity(mr,Ar),Ot)}}}Ne.style("stroke-width",ot).call(rt.fill,Ot).call(rt.stroke,it).style("opacity",Zt)}Ge.exports={style:style,styleOne:styleOne}},{"../../components/color":643,"../../lib":778,"../bar/uniform_text":937,"../sunburst/helpers":1305,d3:169}],1338:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../box/attributes"),rt=Ne("../../lib/extend").extendFlat;Ge.exports={y:tt.y,x:tt.x,x0:tt.x0,y0:tt.y0,name:rt({},tt.name,{}),orientation:rt({},tt.orientation,{}),bandwidth:{valType:"number",min:0,editType:"calc"},scalegroup:{valType:"string",dflt:"",editType:"calc"},scalemode:{valType:"enumerated",values:["width","count"],dflt:"width",editType:"calc"},spanmode:{valType:"enumerated",values:["soft","hard","manual"],dflt:"soft",editType:"calc"},span:{valType:"info_array",items:[{valType:"any",editType:"calc"},{valType:"any",editType:"calc"}],editType:"calc"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,dflt:2,editType:"style"},editType:"plot"},fillcolor:tt.fillcolor,points:rt({},tt.boxpoints,{}),jitter:rt({},tt.jitter,{}),pointpos:rt({},tt.pointpos,{}),width:rt({},tt.width,{}),marker:tt.marker,text:tt.text,hovertext:tt.hovertext,hovertemplate:tt.hovertemplate,box:{visible:{valType:"boolean",dflt:!1,editType:"plot"},width:{valType:"number",min:0,max:1,dflt:.25,editType:"plot"},fillcolor:{valType:"color",editType:"style"},line:{color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"style"},editType:"plot"},meanline:{visible:{valType:"boolean",dflt:!1,editType:"plot"},color:{valType:"color",editType:"style"},width:{valType:"number",min:0,editType:"style"},editType:"plot"},side:{valType:"enumerated",values:["both","positive","negative"],dflt:"both",editType:"calc"},offsetgroup:tt.offsetgroup,alignmentgroup:tt.alignmentgroup,selected:tt.selected,unselected:tt.unselected,hoveron:{valType:"flaglist",flags:["violins","points","kde"],dflt:"violins+points+kde",extras:["all"],editType:"style"}}},{"../../lib/extend":768,"../box/attributes":946}],1339:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../plots/cartesian/axes"),nt=Ne("../box/calc"),at=Ne("./helpers"),it=Ne("../../constants/numerical").BADNUM;function silvermanRule(Ne,Ge,Qe){return 1.059*Math.min(Ge,Qe/1.349)*Math.pow(Ne,-.2)}function calcBandwidth(Ne,Ge,Qe){var rt=Ge.max-Ge.min;if(!rt)return Ne.bandwidth?Ne.bandwidth:0;if(Ne.bandwidth)return Math.max(Ne.bandwidth,rt/1e4);var nt=Qe.length,at=tt.stdev(Qe,nt-1,Ge.mean);return Math.max(silvermanRule(nt,at,Ge.q3-Ge.q1),rt/100)}function calcSpan(Ne,Ge,Qe,tt){var nt,at=Ne.spanmode,ot=Ne.span||[],dt=[Ge.min,Ge.max],ht=[Ge.min-2*tt,Ge.max+2*tt];function calcSpanItem(tt){var rt=ot[tt],nt="multicategory"===Qe.type?Qe.r2c(rt):Qe.d2c(rt,0,Ne[Ge.valLetter+"calendar"]);return nt===it?ht[tt]:nt}var Dt={type:"linear",range:nt="soft"===at?ht:"hard"===at?dt:[calcSpanItem(0),calcSpanItem(1)]};return rt.setConvert(Dt),Dt.cleanRange(),nt}Ge.exports=function(Ne,Ge){var Qe=nt(Ne,Ge);if(Qe[0].t.empty)return Qe;for(var it=Ne._fullLayout,ot=rt.getFromId(Ne,Ge["h"===Ge.orientation?"xaxis":"yaxis"]),dt=1/0,ht=-1/0,Dt=0,Ot=0,Rt=0;Rt<Qe.length;Rt++){var Zt=Qe[Rt],er=Zt.pts.map(at.extractVal),dr=Zt.bandwidth=calcBandwidth(Ge,Zt,er),mr=Zt.span=calcSpan(Ge,Zt,ot,dr);if(Zt.min===Zt.max&&0===dr)mr=Zt.span=[Zt.min,Zt.max],Zt.density=[{v:1,t:mr[0]}],Zt.bandwidth=dr,Dt=Math.max(Dt,1);else{var xr=mr[1]-mr[0],br=Math.ceil(xr/(dr/3)),Ar=xr/br;if(!isFinite(Ar)||!isFinite(br))return tt.error("Something went wrong with computing the violin span"),Qe[0].t.empty=!0,Qe;var en=at.makeKDE(Zt,Ge,er);Zt.density=new Array(br);for(var mn=0,xn=mr[0];xn<mr[1]+Ar/2;mn++,xn+=Ar){var kn=en(xn);Zt.density[mn]={v:kn,t:xn},Dt=Math.max(Dt,kn)}}Ot=Math.max(Ot,er.length),dt=Math.min(dt,mr[0]),ht=Math.max(ht,mr[1])}var Cn=rt.findExtremes(ot,[dt,ht],{padded:!0});if(Ge._extremes[ot._id]=Cn,Ge.width)Qe[0].t.maxKDE=Dt;else{var En=it._violinScaleGroupStats,Pn=Ge.scalegroup,Dn=En[Pn];Dn?(Dn.maxKDE=Math.max(Dn.maxKDE,Dt),Dn.maxCount=Math.max(Dn.maxCount,Ot)):En[Pn]={maxKDE:Dt,maxCount:Ot}}return Qe[0].t.labels.kde=tt._(Ne,"kde:"),Qe}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/axes":828,"../box/calc":947,"./helpers":1342}],1340:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../box/cross_trace_calc").setPositionOffset,rt=["v","h"];Ge.exports=function(Ne,Ge){for(var Qe=Ne.calcdata,nt=Ge.xaxis,at=Ge.yaxis,it=0;it<rt.length;it++){for(var ot=rt[it],dt="h"===ot?at:nt,ht=[],Dt=0;Dt<Qe.length;Dt++){var Ot=Qe[Dt],Rt=Ot[0].t,Zt=Ot[0].trace;!0!==Zt.visible||"violin"!==Zt.type||Rt.empty||Zt.orientation!==ot||Zt.xaxis!==nt._id||Zt.yaxis!==at._id||ht.push(Dt)}tt("violin",Ne,ht,dt)}}},{"../box/cross_trace_calc":948}],1341:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../components/color"),nt=Ne("../box/defaults"),at=Ne("./attributes");Ge.exports=function(Ne,Ge,Qe,it){function coerce(Qe,rt){return tt.coerce(Ne,Ge,at,Qe,rt)}function coerce2(Qe,rt){return tt.coerce2(Ne,Ge,at,Qe,rt)}if(nt.handleSampleDefaults(Ne,Ge,coerce,it),!1!==Ge.visible){coerce("bandwidth"),coerce("side"),coerce("width")||(coerce("scalegroup",Ge.name),coerce("scalemode"));var ot,dt=coerce("span");Array.isArray(dt)&&(ot="manual"),coerce("spanmode",ot);var ht=coerce("line.color",(Ne.marker||{}).color||Qe),Dt=coerce("line.width"),Ot=coerce("fillcolor",rt.addOpacity(Ge.line.color,.5));nt.handlePointsDefaults(Ne,Ge,coerce,{prefix:""});var Rt=coerce2("box.width"),Zt=coerce2("box.fillcolor",Ot),er=coerce2("box.line.color",ht),dr=coerce2("box.line.width",Dt);coerce("box.visible",Boolean(Rt||Zt||er||dr))||(Ge.box={visible:!1});var mr=coerce2("meanline.color",ht),xr=coerce2("meanline.width",Dt);coerce("meanline.visible",Boolean(mr||xr))||(Ge.meanline={visible:!1})}}},{"../../components/color":643,"../../lib":778,"../box/defaults":949,"./attributes":1338}],1342:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt={gaussian:function(Ne){return 1/Math.sqrt(2*Math.PI)*Math.exp(-.5*Ne*Ne)}};Qe.makeKDE=function(Ne,Ge,Qe){var tt=Qe.length,nt=rt.gaussian,at=Ne.bandwidth,it=1/(tt*at);return function(Ne){for(var Ge=0,rt=0;rt<tt;rt++)Ge+=nt((Ne-Qe[rt])/at);return it*Ge}},Qe.getPositionOnKdePath=function(Ne,Ge,Qe){var rt,nt;"h"===Ge.orientation?(rt="y",nt="x"):(rt="x",nt="y");var at=tt.findPointOnPath(Ne.path,Qe,nt,{pathLength:Ne.pathLength}),it=Ne.posCenterPx,ot=at[rt];return[ot,"both"===Ge.side?2*it-ot:it]},Qe.getKdeValue=function(Ne,Ge,tt){var rt=Ne.pts.map(Qe.extractVal);return Qe.makeKDE(Ne,Ge,rt)(tt)/Ne.posDensityScale},Qe.extractVal=function(Ne){return Ne.v}},{"../../lib":778}],1343:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../../plots/cartesian/axes"),nt=Ne("../box/hover"),at=Ne("./helpers");Ge.exports=function(Ne,Ge,Qe,it,ot){var dt,ht,Dt=Ne.cd,Ot=Dt[0].trace,Rt=Ot.hoveron,Zt=-1!==Rt.indexOf("violins"),er=-1!==Rt.indexOf("kde"),dr=[];if(Zt||er){var mr=nt.hoverOnBoxes(Ne,Ge,Qe,it);if(er&&mr.length>0){var xr,br,Ar,en,mn,xn=Ne.xa,kn=Ne.ya;"h"===Ot.orientation?(mn=Ge,xr="y",Ar=kn,br="x",en=xn):(mn=Qe,xr="x",Ar=xn,br="y",en=kn);var Cn=Dt[Ne.index];if(mn>=Cn.span[0]&&mn<=Cn.span[1]){var En=tt.extendFlat({},Ne),Pn=en.c2p(mn,!0),Dn=at.getKdeValue(Cn,Ot,mn),In=at.getPositionOnKdePath(Cn,Ot,Pn),zn=Ar._offset,Bn=Ar._length;En[xr+"0"]=In[0],En[xr+"1"]=In[1],En[br+"0"]=En[br+"1"]=Pn,En[br+"Label"]=br+": "+rt.hoverLabelText(en,mn)+", "+Dt[0].t.labels.kde+" "+Dn.toFixed(3),En.spikeDistance=mr[0].spikeDistance;var Vn=xr+"Spike";En[Vn]=mr[0][Vn],mr[0].spikeDistance=void 0,mr[0][Vn]=void 0,En.hovertemplate=!1,dr.push(En),(ht={stroke:Ne.color})[xr+"1"]=tt.constrain(zn+In[0],zn,zn+Bn),ht[xr+"2"]=tt.constrain(zn+In[1],zn,zn+Bn),ht[br+"1"]=ht[br+"2"]=en._offset+Pn}}Zt&&(dr=dr.concat(mr))}-1!==Rt.indexOf("points")&&(dt=nt.hoverOnPoints(Ne,Ge,Qe));var Hn=ot.selectAll(".violinline-"+Ot.uid).data(ht?[0]:[]);return Hn.enter().append("line").classed("violinline-"+Ot.uid,!0).attr("stroke-width",1.5),Hn.exit().remove(),Hn.attr(ht),"closest"===it?dt?[dt]:dr:dt?(dr.push(dt),dr):dr}},{"../../lib":778,"../../plots/cartesian/axes":828,"../box/hover":951,"./helpers":1342}],1344:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),layoutAttributes:Ne("./layout_attributes"),supplyDefaults:Ne("./defaults"),crossTraceDefaults:Ne("../box/defaults").crossTraceDefaults,supplyLayoutDefaults:Ne("./layout_defaults"),calc:Ne("./calc"),crossTraceCalc:Ne("./cross_trace_calc"),plot:Ne("./plot"),style:Ne("./style"),styleOnSelect:Ne("../scatter/style").styleOnSelect,hoverPoints:Ne("./hover"),selectPoints:Ne("../box/select"),moduleType:"trace",name:"violin",basePlotModule:Ne("../../plots/cartesian"),categories:["cartesian","svg","symbols","oriented","box-violin","showLegend","violinLayout","zoomScale"],meta:{}}},{"../../plots/cartesian":841,"../box/defaults":949,"../box/select":956,"../scatter/style":1211,"./attributes":1338,"./calc":1339,"./cross_trace_calc":1340,"./defaults":1341,"./hover":1343,"./layout_attributes":1345,"./layout_defaults":1346,"./plot":1347,"./style":1348}],1345:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../box/layout_attributes"),rt=Ne("../../lib").extendFlat;Ge.exports={violinmode:rt({},tt.boxmode,{}),violingap:rt({},tt.boxgap,{}),violingroupgap:rt({},tt.boxgroupgap,{})}},{"../../lib":778,"../box/layout_attributes":953}],1346:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./layout_attributes"),nt=Ne("../box/layout_defaults");Ge.exports=function(Ne,Ge,Qe){function coerce(Qe,nt){return tt.coerce(Ne,Ge,rt,Qe,nt)}nt._supply(Ne,Ge,Qe,coerce,"violin")}},{"../../lib":778,"../box/layout_defaults":954,"./layout_attributes":1345}],1347:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../lib"),nt=Ne("../../components/drawing"),at=Ne("../box/plot"),it=Ne("../scatter/line_points"),ot=Ne("./helpers");Ge.exports=function(Ne,Ge,Qe,dt){var ht=Ne._fullLayout,Dt=Ge.xaxis,Ot=Ge.yaxis;function makePath(Ne){var Ge=it(Ne,{xaxis:Dt,yaxis:Ot,connectGaps:!0,baseTolerance:.75,shape:"spline",simplify:!0,linearized:!0});return nt.smoothopen(Ge[0],1)}rt.makeTraceGroups(dt,Qe,"trace violins").each((function(Ne){var Qe=tt.select(this),nt=Ne[0],it=nt.t,dt=nt.trace;if(!0!==dt.visible||it.empty)Qe.remove();else{var Rt=it.bPos,Zt=it.bdPos,er=Ge[it.valLetter+"axis"],dr=Ge[it.posLetter+"axis"],mr="both"===dt.side,xr=mr||"positive"===dt.side,br=mr||"negative"===dt.side,Ar=Qe.selectAll("path.violin").data(rt.identity);Ar.enter().append("path").style("vector-effect","non-scaling-stroke").attr("class","violin"),Ar.exit().remove(),Ar.each((function(Ne){var Ge,Qe,rt,nt,at,ot,Dt,Ot,Ar=tt.select(this),en=Ne.density,mn=en.length,xn=dr.c2l(Ne.pos+Rt,!0),kn=dr.l2p(xn);if(dt.width)Ge=it.maxKDE/Zt;else{var Cn=ht._violinScaleGroupStats[dt.scalegroup];Ge="count"===dt.scalemode?Cn.maxKDE/Zt*(Cn.maxCount/Ne.pts.length):Cn.maxKDE/Zt}if(xr){for(Dt=new Array(mn),at=0;at<mn;at++)(Ot=Dt[at]={})[it.posLetter]=xn+en[at].v/Ge,Ot[it.valLetter]=er.c2l(en[at].t,!0);Qe=makePath(Dt)}if(br){for(Dt=new Array(mn),ot=0,at=mn-1;ot<mn;ot++,at--)(Ot=Dt[ot]={})[it.posLetter]=xn-en[at].v/Ge,Ot[it.valLetter]=er.c2l(en[at].t,!0);rt=makePath(Dt)}if(mr)nt=Qe+"L"+rt.substr(1)+"Z";else{var En=[kn,er.c2p(en[0].t)],Pn=[kn,er.c2p(en[mn-1].t)];"h"===dt.orientation&&(En.reverse(),Pn.reverse()),nt=xr?"M"+En+"L"+Qe.substr(1)+"L"+Pn:"M"+Pn+"L"+rt.substr(1)+"L"+En}Ar.attr("d",nt),Ne.posCenterPx=kn,Ne.posDensityScale=Ge*Zt,Ne.path=Ar.node(),Ne.pathLength=Ne.path.getTotalLength()/(mr?2:1)}));var en,mn,xn,kn=dt.box,Cn=kn.width,En=(kn.line||{}).width;mr?(en=Zt*Cn,mn=0):xr?(en=[0,Zt*Cn/2],mn=En*{x:1,y:-1}[it.posLetter]):(en=[Zt*Cn/2,0],mn=En*{x:-1,y:1}[it.posLetter]),at.plotBoxAndWhiskers(Qe,{pos:dr,val:er},dt,{bPos:Rt,bdPos:en,bPosPxOffset:mn}),at.plotBoxMean(Qe,{pos:dr,val:er},dt,{bPos:Rt,bdPos:en,bPosPxOffset:mn}),!dt.box.visible&&dt.meanline.visible&&(xn=rt.identity);var Pn=Qe.selectAll("path.meanline").data(xn||[]);Pn.enter().append("path").attr("class","meanline").style("fill","none").style("vector-effect","non-scaling-stroke"),Pn.exit().remove(),Pn.each((function(Ne){var Ge=er.c2p(Ne.mean,!0),Qe=ot.getPositionOnKdePath(Ne,dt,Ge);tt.select(this).attr("d","h"===dt.orientation?"M"+Ge+","+Qe[0]+"V"+Qe[1]:"M"+Qe[0]+","+Ge+"H"+Qe[1])})),at.plotPoints(Qe,{x:Dt,y:Ot},dt,it)}}))}},{"../../components/drawing":665,"../../lib":778,"../box/plot":955,"../scatter/line_points":1201,"./helpers":1342,d3:169}],1348:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../components/color"),nt=Ne("../scatter/style").stylePoints;Ge.exports=function(Ne){var Ge=tt.select(Ne).selectAll("g.trace.violins");Ge.style("opacity",(function(Ne){return Ne[0].trace.opacity})),Ge.each((function(Ge){var Qe=Ge[0].trace,at=tt.select(this),it=Qe.box||{},ot=it.line||{},dt=Qe.meanline||{},ht=dt.width;at.selectAll("path.violin").style("stroke-width",Qe.line.width+"px").call(rt.stroke,Qe.line.color).call(rt.fill,Qe.fillcolor),at.selectAll("path.box").style("stroke-width",ot.width+"px").call(rt.stroke,ot.color).call(rt.fill,it.fillcolor);var Dt={"stroke-width":ht+"px","stroke-dasharray":2*ht+"px,"+ht+"px"};at.selectAll("path.mean").style(Dt).call(rt.stroke,dt.color),at.selectAll("path.meanline").style(Dt).call(rt.stroke,dt.color),nt(at,Qe,Ne)}))}},{"../../components/color":643,"../scatter/style":1211,d3:169}],1349:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../components/colorscale/attributes"),rt=Ne("../isosurface/attributes"),nt=Ne("../surface/attributes"),at=Ne("../../plots/attributes"),it=Ne("../../lib/extend").extendFlat,ot=Ne("../../plot_api/edit_types").overrideAll,dt=Ge.exports=ot(it({x:rt.x,y:rt.y,z:rt.z,value:rt.value,isomin:rt.isomin,isomax:rt.isomax,surface:rt.surface,spaceframe:{show:{valType:"boolean",dflt:!1},fill:{valType:"number",min:0,max:1,dflt:1}},slices:rt.slices,caps:rt.caps,text:rt.text,hovertext:rt.hovertext,hovertemplate:rt.hovertemplate},tt("",{colorAttr:"`value`",showScaleDflt:!0,editTypeOverride:"calc"}),{colorbar:rt.colorbar,opacity:rt.opacity,opacityscale:nt.opacityscale,lightposition:rt.lightposition,lighting:rt.lighting,flatshading:rt.flatshading,contour:rt.contour,hoverinfo:it({},at.hoverinfo),showlegend:it({},at.showlegend,{dflt:!1})}),"calc","nested");dt.x.editType=dt.y.editType=dt.z.editType=dt.value.editType="calc+clearAxisTypes",dt.transforms=void 0},{"../../components/colorscale/attributes":650,"../../lib/extend":768,"../../plot_api/edit_types":810,"../../plots/attributes":824,"../isosurface/attributes":1123,"../surface/attributes":1311}],1350:[function(Ne,Ge,Qe){"use strict";var tt=Ne("gl-mesh3d"),rt=Ne("../../lib/gl_format_color").parseColorScale,nt=Ne("../../lib/str2rgbarray"),at=Ne("../../components/colorscale").extractOpts,it=Ne("../../plots/gl3d/zip3"),ot=Ne("../isosurface/convert").findNearestOnAxis,dt=Ne("../isosurface/convert").generateIsoMeshes;function VolumeTrace(Ne,Ge,Qe){this.scene=Ne,this.uid=Qe,this.mesh=Ge,this.name="",this.data=null,this.showContour=!1}var ht=VolumeTrace.prototype;function createVolumeTrace(Ne,Ge){var Qe=Ne.glplot.gl,rt=tt({gl:Qe}),nt=new VolumeTrace(Ne,rt,Ge.uid);return rt._trace=nt,nt.update(Ge),Ne.glplot.add(rt),nt}ht.handlePick=function(Ne){if(Ne.object===this.mesh){var Ge=Ne.data.index,Qe=this.data._meshX[Ge],tt=this.data._meshY[Ge],rt=this.data._meshZ[Ge],nt=this.data._Ys.length,at=this.data._Zs.length,it=ot(Qe,this.data._Xs).id,dt=ot(tt,this.data._Ys).id,ht=ot(rt,this.data._Zs).id,Dt=Ne.index=ht+at*dt+at*nt*it;Ne.traceCoordinate=[this.data._meshX[Dt],this.data._meshY[Dt],this.data._meshZ[Dt],this.data._value[Dt]];var Ot=this.data.hovertext||this.data.text;return Array.isArray(Ot)&&void 0!==Ot[Dt]?Ne.textLabel=Ot[Dt]:Ot&&(Ne.textLabel=Ot),!0}},ht.update=function(Ne){var Ge=this.scene,Qe=Ge.fullSceneLayout;function toDataCoords(Ne,Ge,Qe,tt){return Ge.map((function(Ge){return Ne.d2l(Ge,0,tt)*Qe}))}this.data=dt(Ne);var tt={positions:it(toDataCoords(Qe.xaxis,Ne._meshX,Ge.dataScale[0],Ne.xcalendar),toDataCoords(Qe.yaxis,Ne._meshY,Ge.dataScale[1],Ne.ycalendar),toDataCoords(Qe.zaxis,Ne._meshZ,Ge.dataScale[2],Ne.zcalendar)),cells:it(Ne._meshI,Ne._meshJ,Ne._meshK),lightPosition:[Ne.lightposition.x,Ne.lightposition.y,Ne.lightposition.z],ambient:Ne.lighting.ambient,diffuse:Ne.lighting.diffuse,specular:Ne.lighting.specular,roughness:Ne.lighting.roughness,fresnel:Ne.lighting.fresnel,vertexNormalsEpsilon:Ne.lighting.vertexnormalsepsilon,faceNormalsEpsilon:Ne.lighting.facenormalsepsilon,opacity:Ne.opacity,opacityscale:Ne.opacityscale,contourEnable:Ne.contour.show,contourColor:nt(Ne.contour.color).slice(0,3),contourWidth:Ne.contour.width,useFacetNormals:Ne.flatshading},ot=at(Ne);tt.vertexIntensity=Ne._meshIntensity,tt.vertexIntensityBounds=[ot.min,ot.max],tt.colormap=rt(Ne),this.mesh.update(tt)},ht.dispose=function(){this.scene.glplot.remove(this.mesh),this.mesh.dispose()},Ge.exports=createVolumeTrace},{"../../components/colorscale":655,"../../lib/gl_format_color":774,"../../lib/str2rgbarray":802,"../../plots/gl3d/zip3":881,"../isosurface/convert":1125,"gl-mesh3d":309}],1351:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./attributes"),nt=Ne("../isosurface/defaults").supplyIsoDefaults,at=Ne("../surface/defaults").opacityscaleDefaults;Ge.exports=function(Ne,Ge,Qe,it){function coerce(Qe,nt){return tt.coerce(Ne,Ge,rt,Qe,nt)}nt(Ne,Ge,Qe,it,coerce),at(Ne,Ge,it,coerce)}},{"../../lib":778,"../isosurface/defaults":1126,"../surface/defaults":1314,"./attributes":1349}],1352:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),supplyDefaults:Ne("./defaults"),calc:Ne("../isosurface/calc"),colorbar:{min:"cmin",max:"cmax"},plot:Ne("./convert"),moduleType:"trace",name:"volume",basePlotModule:Ne("../../plots/gl3d"),categories:["gl3d","showLegend"],meta:{}}},{"../../plots/gl3d":870,"../isosurface/calc":1124,"./attributes":1349,"./convert":1350,"./defaults":1351}],1353:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../bar/attributes"),rt=Ne("../scatter/attributes").line,nt=Ne("../../plots/attributes"),at=Ne("../../plots/template_attributes").hovertemplateAttrs,it=Ne("../../plots/template_attributes").texttemplateAttrs,ot=Ne("./constants"),dt=Ne("../../lib/extend").extendFlat,ht=Ne("../../components/color");function directionAttrs(Ne){return{marker:{color:dt({},tt.marker.color,{arrayOk:!1,editType:"style"}),line:{color:dt({},tt.marker.line.color,{arrayOk:!1,editType:"style"}),width:dt({},tt.marker.line.width,{arrayOk:!1,editType:"style"}),editType:"style"},editType:"style"},editType:"style"}}Ge.exports={measure:{valType:"data_array",dflt:[],editType:"calc"},base:{valType:"number",dflt:null,arrayOk:!1,editType:"calc"},x:tt.x,x0:tt.x0,dx:tt.dx,y:tt.y,y0:tt.y0,dy:tt.dy,xperiod:tt.xperiod,yperiod:tt.yperiod,xperiod0:tt.xperiod0,yperiod0:tt.yperiod0,xperiodalignment:tt.xperiodalignment,yperiodalignment:tt.yperiodalignment,hovertext:tt.hovertext,hovertemplate:at({},{keys:ot.eventDataKeys}),hoverinfo:dt({},nt.hoverinfo,{flags:["name","x","y","text","initial","delta","final"]}),textinfo:{valType:"flaglist",flags:["label","text","initial","delta","final"],extras:["none"],editType:"plot",arrayOk:!1},texttemplate:it({editType:"plot"},{keys:ot.eventDataKeys.concat(["label"])}),text:tt.text,textposition:tt.textposition,insidetextanchor:tt.insidetextanchor,textangle:tt.textangle,textfont:tt.textfont,insidetextfont:tt.insidetextfont,outsidetextfont:tt.outsidetextfont,constraintext:tt.constraintext,cliponaxis:tt.cliponaxis,orientation:tt.orientation,offset:tt.offset,width:tt.width,increasing:directionAttrs("increasing"),decreasing:directionAttrs("decreasing"),totals:directionAttrs("intermediate sums and total"),connector:{line:{color:dt({},rt.color,{dflt:ht.defaultLine}),width:dt({},rt.width,{editType:"plot"}),dash:rt.dash,editType:"plot"},mode:{valType:"enumerated",values:["spanning","between"],dflt:"between",editType:"plot"},visible:{valType:"boolean",dflt:!0,editType:"plot"},editType:"plot"},offsetgroup:tt.offsetgroup,alignmentgroup:tt.alignmentgroup}},{"../../components/color":643,"../../lib/extend":768,"../../plots/attributes":824,"../../plots/template_attributes":906,"../bar/attributes":921,"../scatter/attributes":1187,"./constants":1355}],1354:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/cartesian/axes"),rt=Ne("../../plots/cartesian/align_period"),nt=Ne("../../lib").mergeArray,at=Ne("../scatter/calc_selection"),it=Ne("../../constants/numerical").BADNUM;function isAbsolute(Ne){return"a"===Ne||"absolute"===Ne}function isTotal(Ne){return"t"===Ne||"total"===Ne}Ge.exports=function(Ne,Ge){var Qe,ot,dt,ht,Dt=tt.getFromId(Ne,Ge.xaxis||"x"),Ot=tt.getFromId(Ne,Ge.yaxis||"y");"h"===Ge.orientation?(Qe=Dt.makeCalcdata(Ge,"x"),dt=Ot.makeCalcdata(Ge,"y"),ot=rt(Ge,Ot,"y",dt),ht=!!Ge.yperiodalignment):(Qe=Ot.makeCalcdata(Ge,"y"),dt=Dt.makeCalcdata(Ge,"x"),ot=rt(Ge,Dt,"x",dt),ht=!!Ge.xperiodalignment);for(var Rt,Zt=Math.min(ot.length,Qe.length),er=new Array(Zt),dr=0,mr=!1,xr=0;xr<Zt;xr++){var br=Qe[xr]||0,Ar=!1;(Qe[xr]!==it||isTotal(Ge.measure[xr])||isAbsolute(Ge.measure[xr]))&&xr+1<Zt&&(Qe[xr+1]!==it||isTotal(Ge.measure[xr+1])||isAbsolute(Ge.measure[xr+1]))&&(Ar=!0);var en=er[xr]={i:xr,p:ot[xr],s:br,rawS:br,cNext:Ar};isAbsolute(Ge.measure[xr])?(dr=en.s,en.isSum=!0,en.dir="totals",en.s=dr):isTotal(Ge.measure[xr])?(en.isSum=!0,en.dir="totals",en.s=dr):(en.isSum=!1,en.dir=en.rawS<0?"decreasing":"increasing",Rt=en.s,en.s=dr+Rt,dr+=Rt),"totals"===en.dir&&(mr=!0),ht&&(er[xr].orig_p=dt[xr]),Ge.ids&&(en.id=String(Ge.ids[xr])),en.v=(Ge.base||0)+dr}return er.length&&(er[0].hasTotals=mr),nt(Ge.text,er,"tx"),nt(Ge.hovertext,er,"htx"),at(er,Ge),er}},{"../../constants/numerical":753,"../../lib":778,"../../plots/cartesian/align_period":825,"../../plots/cartesian/axes":828,"../scatter/calc_selection":1189}],1355:[function(Ne,Ge,Qe){"use strict";Ge.exports={eventDataKeys:["initial","delta","final"]}},{}],1356:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../bar/cross_trace_calc").setGroupPositions;Ge.exports=function(Ne,Ge){var Qe,rt,nt=Ne._fullLayout,at=Ne._fullData,it=Ne.calcdata,ot=Ge.xaxis,dt=Ge.yaxis,ht=[],Dt=[],Ot=[];for(rt=0;rt<at.length;rt++){var Rt=at[rt];!0===Rt.visible&&Rt.xaxis===ot._id&&Rt.yaxis===dt._id&&"waterfall"===Rt.type&&(Qe=it[rt],"h"===Rt.orientation?Ot.push(Qe):Dt.push(Qe),ht.push(Qe))}var Zt={mode:nt.waterfallmode,norm:nt.waterfallnorm,gap:nt.waterfallgap,groupgap:nt.waterfallgroupgap};for(tt(Ne,ot,dt,Dt,Zt),tt(Ne,dt,ot,Ot,Zt),rt=0;rt<ht.length;rt++){Qe=ht[rt];for(var er=0;er<Qe.length;er++){var dr=Qe[er];!1===dr.isSum&&(dr.s0+=0===er?0:Qe[er-1].s),er+1<Qe.length&&(Qe[er].nextP0=Qe[er+1].p0,Qe[er].nextS0=Qe[er+1].s0)}}}},{"../bar/cross_trace_calc":924}],1357:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("../bar/defaults").handleGroupingDefaults,nt=Ne("../bar/defaults").handleText,at=Ne("../scatter/xy_defaults"),it=Ne("../scatter/period_defaults"),ot=Ne("./attributes"),dt=Ne("../../components/color"),ht=Ne("../../constants/delta.js"),Dt=ht.INCREASING.COLOR,Ot=ht.DECREASING.COLOR,Rt="#4499FF";function handleDirection(Ne,Ge,Qe){Ne(Ge+".marker.color",Qe),Ne(Ge+".marker.line.color",dt.defaultLine),Ne(Ge+".marker.line.width")}function supplyDefaults(Ne,Ge,Qe,rt){function coerce(Qe,rt){return tt.coerce(Ne,Ge,ot,Qe,rt)}if(at(Ne,Ge,rt,coerce)){it(Ne,Ge,rt,coerce),coerce("measure"),coerce("orientation",Ge.x&&!Ge.y?"h":"v"),coerce("base"),coerce("offset"),coerce("width"),coerce("text"),coerce("hovertext"),coerce("hovertemplate");var dt=coerce("textposition");nt(Ne,Ge,rt,coerce,dt,{moduleHasSelected:!1,moduleHasUnselected:!1,moduleHasConstrain:!0,moduleHasCliponaxis:!0,moduleHasTextangle:!0,moduleHasInsideanchor:!0}),"none"!==Ge.textposition&&(coerce("texttemplate"),Ge.texttemplate||coerce("textinfo")),handleDirection(coerce,"increasing",Dt),handleDirection(coerce,"decreasing",Ot),handleDirection(coerce,"totals",Rt),coerce("connector.visible")&&(coerce("connector.mode"),coerce("connector.line.width")&&(coerce("connector.line.color"),coerce("connector.line.dash")))}else Ge.visible=!1}function crossTraceDefaults(Ne,Ge){var Qe,nt;function coerce(Ne){return tt.coerce(nt._input,nt,ot,Ne)}if("group"===Ge.waterfallmode)for(var at=0;at<Ne.length;at++)Qe=(nt=Ne[at])._input,rt(Qe,nt,Ge,coerce)}Ge.exports={supplyDefaults:supplyDefaults,crossTraceDefaults:crossTraceDefaults}},{"../../components/color":643,"../../constants/delta.js":747,"../../lib":778,"../bar/defaults":925,"../scatter/period_defaults":1207,"../scatter/xy_defaults":1214,"./attributes":1353}],1358:[function(Ne,Ge,Qe){"use strict";Ge.exports=function(Ne,Ge){return Ne.x="xVal"in Ge?Ge.xVal:Ge.x,Ne.y="yVal"in Ge?Ge.yVal:Ge.y,"initial"in Ge&&(Ne.initial=Ge.initial),"delta"in Ge&&(Ne.delta=Ge.delta),"final"in Ge&&(Ne.final=Ge.final),Ge.xa&&(Ne.xaxis=Ge.xa),Ge.ya&&(Ne.yaxis=Ge.ya),Ne}},{}],1359:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../plots/cartesian/axes").hoverLabelText,rt=Ne("../../components/color").opacity,nt=Ne("../bar/hover").hoverOnBars,at=Ne("../../constants/delta.js"),it={increasing:at.INCREASING.SYMBOL,decreasing:at.DECREASING.SYMBOL};function getTraceColor(Ne,Ge){var Qe=Ne[Ge.dir].marker,tt=Qe.color,nt=Qe.line.color,at=Qe.line.width;return rt(tt)?tt:rt(nt)&&at?nt:void 0}Ge.exports=function(Ne,Ge,Qe,rt){var at=nt(Ne,Ge,Qe,rt);if(at){var ot=at.cd,dt=ot[0].trace,ht="h"===dt.orientation,Dt=ht?Ne.xa:Ne.ya,Ot=ot[at.index],Rt=Ot.isSum?Ot.b+Ot.s:Ot.rawS;if(!Ot.isSum){at.initial=Ot.b+Ot.s-Rt,at.delta=Rt,at.final=at.initial+at.delta;var Zt=formatNumber(Math.abs(at.delta));at.deltaLabel=Rt<0?"("+Zt+")":Zt,at.finalLabel=formatNumber(at.final),at.initialLabel=formatNumber(at.initial)}var er=Ot.hi||dt.hoverinfo,dr=[];if(er&&"none"!==er&&"skip"!==er){var mr="all"===er,xr=er.split("+"),hasFlag=function(Ne){return mr||-1!==xr.indexOf(Ne)};Ot.isSum||(!hasFlag("final")||hasFlag(ht?"x":"y")||dr.push(at.finalLabel),hasFlag("delta")&&(Rt<0?dr.push(at.deltaLabel+" "+it.decreasing):dr.push(at.deltaLabel+" "+it.increasing)),hasFlag("initial")&&dr.push("Initial: "+at.initialLabel))}return dr.length&&(at.extraText=dr.join("<br>")),at.color=getTraceColor(dt,Ot),[at]}function formatNumber(Ne){return tt(Dt,Ne)}}},{"../../components/color":643,"../../constants/delta.js":747,"../../plots/cartesian/axes":828,"../bar/hover":928}],1360:[function(Ne,Ge,Qe){"use strict";Ge.exports={attributes:Ne("./attributes"),layoutAttributes:Ne("./layout_attributes"),supplyDefaults:Ne("./defaults").supplyDefaults,crossTraceDefaults:Ne("./defaults").crossTraceDefaults,supplyLayoutDefaults:Ne("./layout_defaults"),calc:Ne("./calc"),crossTraceCalc:Ne("./cross_trace_calc"),plot:Ne("./plot"),style:Ne("./style").style,hoverPoints:Ne("./hover"),eventData:Ne("./event_data"),selectPoints:Ne("../bar/select"),moduleType:"trace",name:"waterfall",basePlotModule:Ne("../../plots/cartesian"),categories:["bar-like","cartesian","svg","oriented","showLegend","zoomScale"],meta:{}}},{"../../plots/cartesian":841,"../bar/select":933,"./attributes":1353,"./calc":1354,"./cross_trace_calc":1356,"./defaults":1357,"./event_data":1358,"./hover":1359,"./layout_attributes":1361,"./layout_defaults":1362,"./plot":1363,"./style":1364}],1361:[function(Ne,Ge,Qe){"use strict";Ge.exports={waterfallmode:{valType:"enumerated",values:["group","overlay"],dflt:"group",editType:"calc"},waterfallgap:{valType:"number",min:0,max:1,editType:"calc"},waterfallgroupgap:{valType:"number",min:0,max:1,dflt:0,editType:"calc"}}},{}],1362:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../../lib"),rt=Ne("./layout_attributes");Ge.exports=function(Ne,Ge,Qe){var nt=!1;function coerce(Qe,nt){return tt.coerce(Ne,Ge,rt,Qe,nt)}for(var at=0;at<Qe.length;at++){var it=Qe[at];if(it.visible&&"waterfall"===it.type){nt=!0;break}}nt&&(coerce("waterfallmode"),coerce("waterfallgap",.2),coerce("waterfallgroupgap"))}},{"../../lib":778,"./layout_attributes":1361}],1363:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../lib"),nt=Ne("../../components/drawing"),at=Ne("../../constants/numerical").BADNUM,it=Ne("../bar/plot"),ot=Ne("../bar/uniform_text").clearMinTextSize;function plotConnectors(Ne,Ge,Qe,it){var ot=Ge.xaxis,dt=Ge.yaxis;rt.makeTraceGroups(it,Qe,"trace bars").each((function(Qe){var it=tt.select(this),ht=Qe[0].trace,Dt=rt.ensureSingle(it,"g","lines");if(ht.connector&&ht.connector.visible){var Ot="h"===ht.orientation,Rt=ht.connector.mode,Zt=Dt.selectAll("g.line").data(rt.identity);Zt.enter().append("g").classed("line",!0),Zt.exit().remove();var er=Zt.size();Zt.each((function(Qe,it){if(it===er-1||Qe.cNext){var ht=getXY(Qe,ot,dt,Ot),Dt=ht[0],Zt=ht[1],dr="";Dt[0]!==at&&Zt[0]!==at&&Dt[1]!==at&&Zt[1]!==at&&("spanning"===Rt&&!Qe.isSum&&it>0&&(dr+=Ot?"M"+Dt[0]+","+Zt[1]+"V"+Zt[0]:"M"+Dt[1]+","+Zt[0]+"H"+Dt[0]),"between"!==Rt&&(Qe.isSum||it<er-1)&&(dr+=Ot?"M"+Dt[1]+","+Zt[0]+"V"+Zt[1]:"M"+Dt[0]+","+Zt[1]+"H"+Dt[1]),Dt[2]!==at&&Zt[2]!==at&&(dr+=Ot?"M"+Dt[1]+","+Zt[1]+"V"+Zt[2]:"M"+Dt[1]+","+Zt[1]+"H"+Dt[2])),""===dr&&(dr="M0,0Z"),rt.ensureSingle(tt.select(this),"path").attr("d",dr).call(nt.setClipUrl,Ge.layerClipId,Ne)}}))}else Dt.remove()}))}function getXY(Ne,Ge,Qe,tt){var rt=[],nt=[],at=tt?Ge:Qe,it=tt?Qe:Ge;return rt[0]=at.c2p(Ne.s0,!0),nt[0]=it.c2p(Ne.p0,!0),rt[1]=at.c2p(Ne.s1,!0),nt[1]=it.c2p(Ne.p1,!0),rt[2]=at.c2p(Ne.nextS0,!0),nt[2]=it.c2p(Ne.nextP0,!0),tt?[rt,nt]:[nt,rt]}Ge.exports=function(Ne,Ge,Qe,tt){var rt=Ne._fullLayout;ot("waterfall",rt),it.plot(Ne,Ge,Qe,tt,{mode:rt.waterfallmode,norm:rt.waterfallmode,gap:rt.waterfallgap,groupgap:rt.waterfallgroupgap}),plotConnectors(Ne,Ge,Qe,tt)}},{"../../components/drawing":665,"../../constants/numerical":753,"../../lib":778,"../bar/plot":932,"../bar/uniform_text":937,d3:169}],1364:[function(Ne,Ge,Qe){"use strict";var tt=Ne("d3"),rt=Ne("../../components/drawing"),nt=Ne("../../components/color"),at=Ne("../../constants/interactions").DESELECTDIM,it=Ne("../bar/style"),ot=Ne("../bar/uniform_text").resizeText,dt=it.styleTextPoints;function style(Ne,Ge,Qe){var it=Qe||tt.select(Ne).selectAll("g.waterfalllayer").selectAll("g.trace");ot(Ne,it,"waterfall"),it.style("opacity",(function(Ne){return Ne[0].trace.opacity})),it.each((function(Ge){var Qe=tt.select(this),it=Ge[0].trace;Qe.selectAll(".point > path").each((function(Ne){if(!Ne.isBlank){var Ge=it[Ne.dir].marker;tt.select(this).call(nt.fill,Ge.color).call(nt.stroke,Ge.line.color).call(rt.dashLine,Ge.line.dash,Ge.line.width).style("opacity",it.selectedpoints&&!Ne.selected?at:1)}})),dt(Qe,it,Ne),Qe.selectAll(".lines").each((function(){var Ne=it.connector.line;rt.lineGroupStyle(tt.select(this).selectAll("path"),Ne.width,Ne.color,Ne.dash)}))}))}Ge.exports={style:style}},{"../../components/color":643,"../../components/drawing":665,"../../constants/interactions":752,"../bar/style":935,"../bar/uniform_text":937,d3:169}],1365:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../plots/cartesian/axes"),rt=Ne("../lib"),nt=Ne("../plot_api/plot_schema"),at=Ne("./helpers").pointsAccessorFunction,it=Ne("../constants/numerical").BADNUM;Qe.moduleType="transform",Qe.name="aggregate";var ot=Qe.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},aggregations:{_isLinkedToArray:"aggregation",target:{valType:"string",editType:"calc"},func:{valType:"enumerated",values:["count","sum","avg","median","mode","rms","stddev","min","max","first","last","change","range"],dflt:"first",editType:"calc"},funcmode:{valType:"enumerated",values:["sample","population"],dflt:"sample",editType:"calc"},enabled:{valType:"boolean",dflt:!0,editType:"calc"},editType:"calc"},editType:"calc"},dt=ot.aggregations;function aggregateOneArray(Ne,Ge,Qe,nt){if(nt.enabled){for(var at=nt.target,it=rt.nestedProperty(Ge,at),ot=it.get(),dt=getAggregateFunction(nt,tt.getDataConversions(Ne,Ge,at,ot)),ht=new Array(Qe.length),Dt=0;Dt<Qe.length;Dt++)ht[Dt]=dt(ot,Qe[Dt]);it.set(ht),"count"===nt.func&&rt.pushUnique(Ge._arrayAttrs,at)}}function getAggregateFunction(Ne,Ge){var Qe=Ne.func,tt=Ge.d2c,nt=Ge.c2d;switch(Qe){case"count":return count;case"first":return first;case"last":return last;case"sum":return function(Ne,Ge){for(var Qe=0,rt=0;rt<Ge.length;rt++){var at=tt(Ne[Ge[rt]]);at!==it&&(Qe+=at)}return nt(Qe)};case"avg":return function(Ne,Ge){for(var Qe=0,rt=0,at=0;at<Ge.length;at++){var ot=tt(Ne[Ge[at]]);ot!==it&&(Qe+=ot,rt++)}return rt?nt(Qe/rt):it};case"min":return function(Ne,Ge){for(var Qe=1/0,rt=0;rt<Ge.length;rt++){var at=tt(Ne[Ge[rt]]);at!==it&&(Qe=Math.min(Qe,at))}return Qe===1/0?it:nt(Qe)};case"max":return function(Ne,Ge){for(var Qe=-1/0,rt=0;rt<Ge.length;rt++){var at=tt(Ne[Ge[rt]]);at!==it&&(Qe=Math.max(Qe,at))}return Qe===-1/0?it:nt(Qe)};case"range":return function(Ne,Ge){for(var Qe=1/0,rt=-1/0,at=0;at<Ge.length;at++){var ot=tt(Ne[Ge[at]]);ot!==it&&(Qe=Math.min(Qe,ot),rt=Math.max(rt,ot))}return rt===-1/0||Qe===1/0?it:nt(rt-Qe)};case"change":return function(Ne,Ge){var Qe=tt(Ne[Ge[0]]),rt=tt(Ne[Ge[Ge.length-1]]);return Qe===it||rt===it?it:nt(rt-Qe)};case"median":return function(Ne,Ge){for(var Qe=[],at=0;at<Ge.length;at++){var ot=tt(Ne[Ge[at]]);ot!==it&&Qe.push(ot)}if(!Qe.length)return it;Qe.sort(rt.sorterAsc);var dt=(Qe.length-1)/2;return nt((Qe[Math.floor(dt)]+Qe[Math.ceil(dt)])/2)};case"mode":return function(Ne,Ge){for(var Qe={},rt=0,at=it,ot=0;ot<Ge.length;ot++){var dt=tt(Ne[Ge[ot]]);if(dt!==it){var ht=Qe[dt]=(Qe[dt]||0)+1;ht>rt&&(rt=ht,at=dt)}}return rt?nt(at):it};case"rms":return function(Ne,Ge){for(var Qe=0,rt=0,at=0;at<Ge.length;at++){var ot=tt(Ne[Ge[at]]);ot!==it&&(Qe+=ot*ot,rt++)}return rt?nt(Math.sqrt(Qe/rt)):it};case"stddev":return function(Ge,Qe){var rt,nt=0,at=0,ot=1,dt=it;for(rt=0;rt<Qe.length&&dt===it;rt++)dt=tt(Ge[Qe[rt]]);if(dt===it)return it;for(;rt<Qe.length;rt++){var ht=tt(Ge[Qe[rt]]);if(ht!==it){var Dt=ht-dt;nt+=Dt,at+=Dt*Dt,ot++}}var Ot="sample"===Ne.funcmode?ot-1:ot;return Ot?Math.sqrt((at-nt*nt/ot)/Ot):0}}}function count(Ne,Ge){return Ge.length}function first(Ne,Ge){return Ne[Ge[0]]}function last(Ne,Ge){return Ne[Ge[Ge.length-1]]}Qe.supplyDefaults=function(Ne,Ge){var Qe,tt={};function coerce(Ge,Qe){return rt.coerce(Ne,tt,ot,Ge,Qe)}if(!coerce("enabled"))return tt;var at=nt.findArrayAttributes(Ge),it={};for(Qe=0;Qe<at.length;Qe++)it[at[Qe]]=1;var ht=coerce("groups");if(!Array.isArray(ht)){if(!it[ht])return tt.enabled=!1,tt;it[ht]=0}var Dt,Ot=Ne.aggregations||[],Rt=tt.aggregations=new Array(Ot.length);function coercei(Ne,Ge){return rt.coerce(Ot[Qe],Dt,dt,Ne,Ge)}for(Qe=0;Qe<Ot.length;Qe++){Dt={_index:Qe};var Zt=coercei("target"),er=coercei("func");coercei("enabled")&&Zt&&(it[Zt]||"count"===er&&void 0===it[Zt])?("stddev"===er&&coercei("funcmode"),it[Zt]=0,Rt[Qe]=Dt):Rt[Qe]={enabled:!1,_index:Qe}}for(Qe=0;Qe<at.length;Qe++)it[at[Qe]]&&Rt.push({target:at[Qe],func:dt.func.dflt,enabled:!0,_index:-1});return tt},Qe.calcTransform=function(Ne,Ge,Qe){if(Qe.enabled){var tt=Qe.groups,nt=rt.getTargetArray(Ge,{target:tt});if(nt){var it,ot,dt,ht,Dt={},Ot={},Rt=[],Zt=at(Ge.transforms,Qe),er=nt.length;for(Ge._length&&(er=Math.min(er,Ge._length)),it=0;it<er;it++)void 0===(dt=Dt[ot=nt[it]])?(Dt[ot]=Rt.length,ht=[it],Rt.push(ht),Ot[Dt[ot]]=Zt(it)):(Rt[dt].push(it),Ot[Dt[ot]]=(Ot[Dt[ot]]||[]).concat(Zt(it)));Qe._indexToPoints=Ot;var dr=Qe.aggregations;for(it=0;it<dr.length;it++)aggregateOneArray(Ne,Ge,Rt,dr[it]);"string"==typeof tt&&aggregateOneArray(Ne,Ge,Rt,{target:tt,func:"first",enabled:!0}),Ge._length=Rt.length}}}},{"../constants/numerical":753,"../lib":778,"../plot_api/plot_schema":816,"../plots/cartesian/axes":828,"./helpers":1368}],1366:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../lib"),rt=Ne("../registry"),nt=Ne("../plots/cartesian/axes"),at=Ne("./helpers").pointsAccessorFunction,it=Ne("../constants/filter_ops"),ot=it.COMPARISON_OPS,dt=it.INTERVAL_OPS,ht=it.SET_OPS;function getFilterFunc(Ne,Ge,Qe){var tt=Ne.operation,rt=Ne.value,nt=Array.isArray(rt);function isOperationIn(Ne){return-1!==Ne.indexOf(tt)}var at,d2cValue=function(Qe){return Ge(Qe,0,Ne.valuecalendar)},d2cTarget=function(Ne){return Ge(Ne,0,Qe)};switch(isOperationIn(ot)?at=d2cValue(nt?rt[0]:rt):isOperationIn(dt)?at=nt?[d2cValue(rt[0]),d2cValue(rt[1])]:[d2cValue(rt),d2cValue(rt)]:isOperationIn(ht)&&(at=nt?rt.map(d2cValue):[d2cValue(rt)]),tt){case"=":return function(Ne){return d2cTarget(Ne)===at};case"!=":return function(Ne){return d2cTarget(Ne)!==at};case"<":return function(Ne){return d2cTarget(Ne)<at};case"<=":return function(Ne){return d2cTarget(Ne)<=at};case">":return function(Ne){return d2cTarget(Ne)>at};case">=":return function(Ne){return d2cTarget(Ne)>=at};case"[]":return function(Ne){var Ge=d2cTarget(Ne);return Ge>=at[0]&&Ge<=at[1]};case"()":return function(Ne){var Ge=d2cTarget(Ne);return Ge>at[0]&&Ge<at[1]};case"[)":return function(Ne){var Ge=d2cTarget(Ne);return Ge>=at[0]&&Ge<at[1]};case"(]":return function(Ne){var Ge=d2cTarget(Ne);return Ge>at[0]&&Ge<=at[1]};case"][":return function(Ne){var Ge=d2cTarget(Ne);return Ge<=at[0]||Ge>=at[1]};case")(":return function(Ne){var Ge=d2cTarget(Ne);return Ge<at[0]||Ge>at[1]};case"](":return function(Ne){var Ge=d2cTarget(Ne);return Ge<=at[0]||Ge>at[1]};case")[":return function(Ne){var Ge=d2cTarget(Ne);return Ge<at[0]||Ge>=at[1]};case"{}":return function(Ne){return-1!==at.indexOf(d2cTarget(Ne))};case"}{":return function(Ne){return-1===at.indexOf(d2cTarget(Ne))}}}Qe.moduleType="transform",Qe.name="filter",Qe.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},operation:{valType:"enumerated",values:[].concat(ot).concat(dt).concat(ht),dflt:"=",editType:"calc"},value:{valType:"any",dflt:0,editType:"calc"},preservegaps:{valType:"boolean",dflt:!1,editType:"calc"},editType:"calc"},Qe.supplyDefaults=function(Ne){var Ge={};function coerce(rt,nt){return tt.coerce(Ne,Ge,Qe.attributes,rt,nt)}if(coerce("enabled")){var nt=coerce("target");if(tt.isArrayOrTypedArray(nt)&&0===nt.length)return Ge.enabled=!1,Ge;coerce("preservegaps"),coerce("operation"),coerce("value");var at=rt.getComponentMethod("calendars","handleDefaults");at(Ne,Ge,"valuecalendar",null),at(Ne,Ge,"targetcalendar",null)}return Ge},Qe.calcTransform=function(Ne,Ge,Qe){if(Qe.enabled){var rt=tt.getTargetArray(Ge,Qe);if(rt){var it=Qe.target,ot=rt.length;Ge._length&&(ot=Math.min(ot,Ge._length));var dt=Qe.targetcalendar,ht=Ge._arrayAttrs,Dt=Qe.preservegaps;if("string"==typeof it){var Ot=tt.nestedProperty(Ge,it+"calendar").get();Ot&&(dt=Ot)}var Rt,Zt,er=getFilterFunc(Qe,nt.getDataToCoordFunc(Ne,Ge,it,rt),dt),dr={},mr={},xr=0;Dt?(Rt=function(Ne){dr[Ne.astr]=tt.extendDeep([],Ne.get()),Ne.set(new Array(ot))},Zt=function(Ne,Ge){var Qe=dr[Ne.astr][Ge];Ne.get()[Ge]=Qe}):(Rt=function(Ne){dr[Ne.astr]=tt.extendDeep([],Ne.get()),Ne.set([])},Zt=function(Ne,Ge){var Qe=dr[Ne.astr][Ge];Ne.get().push(Qe)}),forAllAttrs(Rt);for(var br=at(Ge.transforms,Qe),Ar=0;Ar<ot;Ar++)er(rt[Ar])?(forAllAttrs(Zt,Ar),mr[xr++]=br(Ar)):Dt&&xr++;Qe._indexToPoints=mr,Ge._length=xr}}function forAllAttrs(Ne,Qe){for(var rt=0;rt<ht.length;rt++)Ne(tt.nestedProperty(Ge,ht[rt]),Qe)}}},{"../constants/filter_ops":749,"../lib":778,"../plots/cartesian/axes":828,"../registry":911,"./helpers":1368}],1367:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../lib"),rt=Ne("../plot_api/plot_schema"),nt=Ne("../plots/plots"),at=Ne("./helpers").pointsAccessorFunction;function transformOne(Ne,Ge){var Qe,it,ot,dt,ht,Dt,Ot,Rt,Zt,er,dr=Ge.transform,mr=Ge.transformIndex,xr=Ne.transforms[mr].groups,br=at(Ne.transforms,dr);if(!tt.isArrayOrTypedArray(xr)||0===xr.length)return[Ne];var Ar=tt.filterUnique(xr),en=new Array(Ar.length),mn=xr.length,xn=rt.findArrayAttributes(Ne),kn=dr.styles||[],Cn={};for(Qe=0;Qe<kn.length;Qe++)Cn[kn[Qe].target]=kn[Qe].value;dr.styles&&(er=tt.keyedContainer(dr,"styles","target","value.name"));var En={},Pn={};for(Qe=0;Qe<Ar.length;Qe++){En[Dt=Ar[Qe]]=Qe,Pn[Dt]=0,(Ot=en[Qe]=tt.extendDeepNoArrays({},Ne))._group=Dt,Ot.transforms[mr]._indexToPoints={};var Dn=null;for(er&&(Dn=er.get(Dt)),Ot.name=Dn||""===Dn?Dn:tt.templateString(dr.nameformat,{trace:Ne.name,group:Dt}),Rt=Ot.transforms,Ot.transforms=[],it=0;it<Rt.length;it++)Ot.transforms[it]=tt.extendDeepNoArrays({},Rt[it]);for(it=0;it<xn.length;it++)tt.nestedProperty(Ot,xn[it]).set([])}for(ot=0;ot<xn.length;ot++){for(dt=xn[ot],it=0,Zt=[];it<Ar.length;it++)Zt[it]=tt.nestedProperty(en[it],dt).get();for(ht=tt.nestedProperty(Ne,dt).get(),it=0;it<mn;it++)Zt[En[xr[it]]].push(ht[it])}for(it=0;it<mn;it++)(Ot=en[En[xr[it]]]).transforms[mr]._indexToPoints[Pn[xr[it]]]=br(it),Pn[xr[it]]++;for(Qe=0;Qe<Ar.length;Qe++)Dt=Ar[Qe],Ot=en[Qe],nt.clearExpandedTraceDefaultColors(Ot),Ot=tt.extendDeepNoArrays(Ot,Cn[Dt]||{});return en}Qe.moduleType="transform",Qe.name="groupby",Qe.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},groups:{valType:"data_array",dflt:[],editType:"calc"},nameformat:{valType:"string",editType:"calc"},styles:{_isLinkedToArray:"style",target:{valType:"string",editType:"calc"},value:{valType:"any",dflt:{},editType:"calc",_compareAsJSON:!0},editType:"calc"},editType:"calc"},Qe.supplyDefaults=function(Ne,Ge,rt){var nt,at={};function coerce(Ge,rt){return tt.coerce(Ne,at,Qe.attributes,Ge,rt)}if(!coerce("enabled"))return at;coerce("groups"),coerce("nameformat",rt._dataLength>1?"%{group} (%{trace})":"%{group}");var it=Ne.styles,ot=at.styles=[];if(it)for(nt=0;nt<it.length;nt++){var dt=ot[nt]={};tt.coerce(it[nt],ot[nt],Qe.attributes.styles,"target");var ht=tt.coerce(it[nt],ot[nt],Qe.attributes.styles,"value");tt.isPlainObject(ht)?dt.value=tt.extendDeep({},ht):ht&&delete dt.value}return at},Qe.transform=function(Ne,Ge){var Qe,tt,rt,nt=[];for(tt=0;tt<Ne.length;tt++)for(Qe=transformOne(Ne[tt],Ge),rt=0;rt<Qe.length;rt++)nt.push(Qe[rt]);return nt}},{"../lib":778,"../plot_api/plot_schema":816,"../plots/plots":891,"./helpers":1368}],1368:[function(Ne,Ge,Qe){"use strict";Qe.pointsAccessorFunction=function(Ne,Ge){for(var Qe,tt,rt=0;rt<Ne.length&&(Qe=Ne[rt])!==Ge;rt++)Qe._indexToPoints&&!1!==Qe.enabled&&(tt=Qe._indexToPoints);var nt=tt?function(Ne){return tt[Ne]}:function(Ne){return[Ne]};return nt}},{}],1369:[function(Ne,Ge,Qe){"use strict";var tt=Ne("../lib"),rt=Ne("../plots/cartesian/axes"),nt=Ne("./helpers").pointsAccessorFunction,at=Ne("../constants/numerical").BADNUM;function getIndices(Ne,Ge,Qe,tt){var rt,nt=new Array(tt),at=new Array(tt);for(rt=0;rt<tt;rt++)nt[rt]={v:Ge[rt],i:rt};for(nt.sort(getSortFunc(Ne,Qe)),rt=0;rt<tt;rt++)at[rt]=nt[rt].i;return at}function getSortFunc(Ne,Ge){switch(Ne.order){case"ascending":return function(Ne,Qe){var tt=Ge(Ne.v),rt=Ge(Qe.v);return tt===at?1:rt===at?-1:tt-rt};case"descending":return function(Ne,Qe){var tt=Ge(Ne.v),rt=Ge(Qe.v);return tt===at?1:rt===at?-1:rt-tt}}}Qe.moduleType="transform",Qe.name="sort",Qe.attributes={enabled:{valType:"boolean",dflt:!0,editType:"calc"},target:{valType:"string",strict:!0,noBlank:!0,arrayOk:!0,dflt:"x",editType:"calc"},order:{valType:"enumerated",values:["ascending","descending"],dflt:"ascending",editType:"calc"},editType:"calc"},Qe.supplyDefaults=function(Ne){var Ge={};function coerce(rt,nt){return tt.coerce(Ne,Ge,Qe.attributes,rt,nt)}return coerce("enabled")&&(coerce("target"),coerce("order")),Ge},Qe.calcTransform=function(Ne,Ge,Qe){if(Qe.enabled){var at=tt.getTargetArray(Ge,Qe);if(at){var it=Qe.target,ot=at.length;Ge._length&&(ot=Math.min(ot,Ge._length));var dt,ht,Dt=Ge._arrayAttrs,Ot=getIndices(Qe,at,rt.getDataToCoordFunc(Ne,Ge,it,at),ot),Rt=nt(Ge.transforms,Qe),Zt={};for(dt=0;dt<Dt.length;dt++){var er=tt.nestedProperty(Ge,Dt[dt]),dr=er.get(),mr=new Array(ot);for(ht=0;ht<ot;ht++)mr[ht]=dr[Ot[ht]];er.set(mr)}for(ht=0;ht<ot;ht++)Zt[ht]=Rt(Ot[ht]);Qe._indexToPoints=Zt,Ge._length=ot}}}},{"../constants/numerical":753,"../lib":778,"../plots/cartesian/axes":828,"./helpers":1368}],1370:[function(Ne,Ge,Qe){"use strict";Qe.version="1.58.5"},{}]},{},[26])(26)}},Ge={};function __webpack_require__(Qe){var tt=Ge[Qe];if(void 0!==tt)return tt.exports;var rt=Ge[Qe]={exports:{}};return Ne[Qe].call(rt.exports,rt,rt.exports,__webpack_require__),rt.exports}return __webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(Ne){if("object"==typeof window)return window}}(),__webpack_require__(10352)}()}));