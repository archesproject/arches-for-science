(self.webpackChunkarches=self.webpackChunkarches||[]).push([[5453],{40501:function(e,t,a){var i,n;i=[a(86564),a(20198)],void 0===(n=function(e,t){return e.Model.extend({read:function(e,t){return this._doRequest({type:"GET",data:{format:"json"},url:this._getURL("GET")},e,t,"read")},save:function(e,t){var a="POST";return this._doRequest({type:a,url:this._getURL(a),data:JSON.stringify(this.toJSON())},e,t,"save")},delete:function(e,t){var a="DELETE";return this._doRequest({type:a,url:this._getURL(a),data:JSON.stringify(this.toJSON())},e,t,"delete")},_getURL:function(e){var t=this.get("id");return t||(t=""),this.url.indexOf("aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa")>-1?this.url.replace("aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa",t):this.url+t},_doRequest:function(e,a,i,n){var l=this;return i||(i=l),t.ajax(t.extend({complete:function(e,t){"function"==typeof a&&a.call(i,e,t,l),"success"===t&&l.trigger(n,l)}},e))}})}.apply(t,i))||(e.exports=n)},23420:function(e,t,a){var i,n;i=[a(46186),a(40501)],void 0===(n=function(e,t){return t.extend({url:e.urls.concept_manage_parents,defaults:{id:"",added:[],deleted:[]}})}.apply(t,i))||(e.exports=n)},47076:function(e,t,a){var i,n;i=[a(46186),a(40501)],void 0===(n=function(e,t){return t.extend({url:e.urls.concept,defaults:{id:"",legacyoid:"",nodetype:"",relationshiptype:"",values:[],subconcepts:[],parentconcepts:[],relatedconcepts:[]},reset:function(){var e=this.get("id"),t=this.get("legacyoid"),a=this.get("nodetype");this.clear(),this.set("id",e),this.set("legacyoid",t),this.set("nodetype",a)},makeCollection:function(t,a){return this._doRequest({type:"GET",url:e.urls.concept_make_collection.replace("aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa",this.get("id")),data:{}},t,a,"collection_created")}})}.apply(t,i))||(e.exports=n)},72825:function(e,t,a){var i,n;i=[a(46186),a(40501)],void 0===(n=function(e,t){return t.extend({url:e.urls.concept_value,defaults:{id:"",value:"",type:"",category:"",language:"",conceptid:""}})}.apply(t,i))||(e.exports=n)},20346:function(e,t,a){var i,n;i=[a(54922),a(46186)],void 0===(n=function(e,t){var getPropertyOrDefaultMessage=function(e,t){return void 0===e?t:e};return function(a,i,n,l){var o=this;this.active=e.observable(!0),this.close=function(){o.active(!1)},i=function(e){return(e=function(e){return void 0===e&&(e={}),e}(e)).title=getPropertyOrDefaultMessage(e.title,t.translations.requestFailed.title),e.message=getPropertyOrDefaultMessage(e.message,t.translations.requestFailed.text),e}(i),this.type=e.observable(a),this.title=e.observable(i.title),this.text=e.observable(i.message),this.ok=!1,this.cancel=!1,"function"==typeof l&&(this.ok=function(){o.close(),l()}),"function"==typeof n&&(this.cancel=function(){o.close(),n()})}}.apply(t,i))||(e.exports=n)},93256:function(e,t,a){var i,n;i=[a(20198),a(84490),a(86564),a(16950),a(46186)],void 0===(n=function(e,t,a,i,n){return a.View.extend({initialize:function(t){e.extend(this,t),this.render()},render:function(){var a=this;this.searchbox=this.$el.find("input.concept_search_widget").select2({multiple:!1,maximumselectionsize:1,minimumInputLength:2,ajax:{url:this.getUrl(),dataType:"json",data:function(e,t){return{q:e,page_limit:30}},results:function(t,a){var i=[];return e.each(t.hits.hits,(function(){i.push({id:this._source.conceptid,text:this._source.value,scheme_id:this._type,scheme:this.in_scheme_name})}),this),{results:i}}},formatResult:function(e,a,i,n){var l=[];return window.Select2.util.markMatch(e.text,i.term,l,n),e.scheme=e.scheme?"("+t.escape(e.scheme)+")":"",'<span class="concept_result">'+l.join("")+'</span><i class="concept_result_schemaname">'+e.scheme+"</i>"},escapeMarkup:function(e){return e}}).on("select2-selecting",(function(e,t){a.trigger("select2-selecting",e,t)}))},getUrl:function(){return n.urls.concept_search}})}.apply(t,i))||(e.exports=n)},80039:function(e,t,a){var i,n;i=[a(20198),a(86564),a(46186),a(47076),a(72825),a(23420),a(73187),a(42150),a(63146),a(86163),a(16207),a(22049),a(7744),a(62666),a(20346)],void 0===(n=function(e,t,a,i,n,l,o,d,r,s,c,u,m,h,p){return t.View.extend({events:{'click .concept-report-content *[data-action="viewconcept"]':"conceptSelected",'click .concept-report-content *[data-action="viewddconcept"]':"dropdownConceptSelected",'click .concept-report-content *[data-action="delete-relationship"]':"deleteClicked",'click .concept-report-content *[data-action="delete-value"]':"deleteClicked",'click .concept-report-content *[data-action="delete-concept"]':"deleteClicked","click a.add-image-link":"addImageClicked","click a.edit-value":"editValueClicked","click .confirm-delete-yes":"deleteConfirmed",'click a[data-toggle="#related-concept-form"]':"addRelatedConceptClicked",'click a[data-toggle="#related-member-form"]':"addRelatedMemberClicked",'click a[data-toggle="#add-concept-form"]':"addChildConcept",'click a[data-toggle="#add-top-concept-form"]':"addChildConcept",'click a[data-toggle="#manage-parent-form"]':"manageParentConcepts",'click a[data-toggle="#import-concept-form"]':"importConcept",'click a[data-toggle="#make-collection"]':"makeCollection"},initialize:function(e){this.viewModel=e.viewModel,this.render()},render:function(){var t=this,i=this.model.get("id"),n=t.$el.find(".concept-graph").is(":visible");t.$el.find(".concept-report-loading").removeClass("hidden"),t.$el.find(".concept-report-content").addClass("hidden"),this.xhr&&this.xhr.abort(),this.xhr=e.ajax({url:a.urls.concept.replace("aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa",i),data:{f:"html",mode:this.mode},success:function(e){t.$el.find(".concept-report-loading").addClass("hidden"),t.$el.html(e);var a=t.$el.find('div[name="modeldata"]').data();t.model.set(a),t.model.get("id")&&t.$el.find(".concept-graph").length>0&&(t.$el.find(".graph-toggle").click((function(){t.$el.find(".concept-tree").toggle(300),t.$el.find(".concept-graph").toggle(300),t.$el.find(".graph-toggle").toggle()})),n&&(t.$el.find(".graph-toggle").toggle(),t.$el.find(".concept-tree").toggle(0),t.$el.find(".concept-graph").toggle(0)))}})},deleteClicked:function(t){var i=this,n=e(t.target).data();this.confirm_delete_modal=this.$el.find(".confirm-delete-modal"),this.confirm_delete_modal_yes=this.confirm_delete_modal.find(".confirm-delete-yes"),this.confirm_delete_modal_yes.removeAttr("disabled"),this.confirm_delete_modal_yes.data("id",n.id),this.confirm_delete_modal_yes.data("nodetype",n.nodetype),this.confirm_delete_modal_yes.data("action",n.action),this.confirm_delete_modal_yes.data("category",n.category),this.confirm_delete_modal.find(".modal-title").text(e(t.target).attr("title")),this.confirm_delete_modal.find('.modal-body [name="warning-text"]').text(n.message),this.confirm_delete_modal.find('.modal-body [name="additional-info"]').text(""),this.confirm_delete_modal.modal("show"),"delete-concept"===n.action&&(this.confirm_delete_modal_yes.attr("disabled","disabled"),e.ajax({url:a.urls.confirm_delete.replace("aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa",n.id),success:function(e){i.confirm_delete_modal_yes.removeAttr("disabled"),i.confirm_delete_modal.find('.modal-body [name="additional-info"]').html(e)}}))},conceptSelected:function(t){var a=e(t.target).data();this.trigger("conceptSelected",a.conceptid)},dropdownConceptSelected:function(t){var a=e(t.target).data();this.trigger("dropdownConceptSelected",a.conceptid)},addChildConcept:function(t){this.model.reset(),new u({el:e("#add-child-form")[0],model:this.model}).modal.modal("show")},addRelatedConceptClicked:function(t){this.model.reset(),new d({el:e("#related-concept-form")[0],model:this.model}).modal.modal("show")},addRelatedMemberClicked:function(t){this.model.reset(),new r({el:e("#related-member-form")[0],model:this.model}).modal.modal("show")},manageParentConcepts:function(t){var a=this,i=new l;i.set("id",this.model.get("id")),new s({el:e("#manage-parent-form")[0],model:i}).modal.modal("show"),i.on({save:function(){a.trigger("parentsChanged")}})},makeCollection:function(e){this.model.makeCollection((function(e,t){"success"===t&&this.viewModel.alert(new h("ep-alert-blue",e.responseJSON.title,e.responseJSON.message)),"error"===t&&this.viewModel.alert(new p("ep-alert-red",e.responseJSON))}),this)},importConcept:function(t){var a=this;this.model.reset();var i=new c({el:e("#import-concept-form")[0],model:this.model});i.modal.modal("show"),i.on({conceptsImported:function(){a.trigger("conceptsImported")}})},addImageClicked:function(e){this.model.reset();var t=this;new m({el:this.$el.find("#add-image-form")[0],model:this.model}).on("dataChanged",(function(){t.render()}))},editValueClicked:function(t){this.model.reset();var a=e.extend({conceptid:this.model.get("id")},e(t.target).data());this.model.set("values",[new n(a)]);new o({el:this.$el.find("#value-form")[0],model:this.model})},deleteConfirmed:function(t){var a=this,l=e(t.target).data(),o=a.$el.find(".confirm-delete-modal"),d=o.find(".modal-title").text();if(this.model.reset(),"delete-concept"===l.action){o.find("h4").text(" "+d),o.find(".modal-title").addClass("loading");var r=new i(l);a.model.set("subconcepts",[r]),a.model.delete((function(t,i){o.find("h4").text(d),o.find(".modal-title").removeClass("loading"),o.modal("hide"),e(".modal-backdrop.fade.in").remove(),t.responseJSON.in_use&&a.viewModel.alert(new h("ep-alert-blue",t.responseJSON.title,t.responseJSON.message))}),a)}else o.on("hidden.bs.modal",(function(){var e;"delete-value"===l.action&&(e=new n(l)).delete(a.render,a),"delete-relationship"===l.action&&(e=new i(l),a.model.set("relatedconcepts",[e]),a.model.delete())})),o.modal("hide")}})}.apply(t,i))||(e.exports=n)},42026:function(e,t,a){var i,n;i=[a(20198),a(86564),a(46186),a(69134)],void 0===(n=function(e,t,a){return t.View.extend({events:{"tree.click":"treeClick","tree.move":"moveNode"},initialize:function(t){this.model=t.model,this.tree=this.$el.tree({dragAndDrop:!0,dataUrl:t.url,data:[],autoOpen:!1,rtl:"rtl"==e("body").attr("dir")}),this.render()},render:function(){if(!this._doNotRender){var t=this,a=t.$el.tree("getNodeById",this.model.get("id"));a&&(a.load_on_demand||t.$el.tree("toggle",a),e(a.element).addClass("jqtree-loading")),t.$el.tree("loadDataFromUrl",null,(function(){var e;""!==t.model.get("id")&&(e=t.$el.tree("getNodeById",t.model.get("id")))&&(t.$el.tree("selectNode",e),t.$el.tree("scrollToNode",e))}))}},treeClick:function(e){var t=e.node;t.load_on_demand||this.$el.tree("toggle",t),this.model.get("id")!==t.id?this.trigger("conceptSelected",t.id):e.preventDefault()},moveNode:function(t){var i=this,n=t.move_info;"inside"!==n.position&&n.previous_parent.id===n.target_node.parent.id||"inside"===n.position&&n.previous_parent.id===n.target_node.id||(t.preventDefault(),e.ajax({type:"POST",url:a.urls.concept_relation.replace("aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa",n.moved_node.id),data:JSON.stringify({target_parent_conceptid:"inside"===n.position?n.target_node.id:n.target_node.parent.id,current_parent_conceptid:n.previous_parent.id}),success:function(){var e=JSON.parse(this.data);t.move_info.do_move(),i.trigger("conceptMoved",e.conceptid)}}))}})}.apply(t,i))||(e.exports=n)},22049:function(e,t,a){var i,n;i=[a(20198),a(86564),a(93256),a(47076),a(72825)],void 0===(n=function(e,t,a,i,n){return t.View.extend({initialize:function(t){var a=this;this.modal=this.$el.find("form"),this.modal.on("hidden.bs.modal",(function(){a.$el.find("input[type=text], textarea").val("")})),this.modal.find(".select2").attr("id")||(this.select2=this.modal.find(".select2").select2()),this.modal.validate({ignore:null,rules:{label:"required",language_dd:"required"},submitHandler:function(t){var l=new n({value:e(t).find("[name=label]").val(),language:e(t).find("[name=language_dd]").val(),category:"label",type:"prefLabel"}),o=new n({value:e(t).find("[name=note]").val(),language:e(t).find("[name=language_dd]").val(),category:"note",type:"scopeNote"}),d=new i({values:[l,o],relationshiptype:e(t).find("[name=relationshiptype_dd]").val(),nodetype:"Concept"});a.model.set("values",[]),a.model.set("subconcepts",[d]),a.modal.on("hidden.bs.modal",(function(){a.model.save()})),a.modal.modal("hide")}})}})}.apply(t,i))||(e.exports=n)},32163:function(e,t,a){var i,n;i=[a(20198),a(86564),a(47076),a(72825)],void 0===(n=function(e,t,a,i){return t.View.extend({initialize:function(t){var n=this;this.modal=this.$el.find(".modal"),this.modal.on("hidden.bs.modal",(function(){n.$el.find("input[type=text], textarea").val("")})),this.select2=this.$el.find("[name=language_dd]").select2({minimumResultsForSearch:-1}),this.modal.validate({ignore:null,rules:{label:"required",language_dd:"required",scheme_group_dd:"required"},submitHandler:function(t){var l=new i({value:e(t).find("[name=label]").val(),language:e(t).find("[name=language_dd]").val(),category:"label",type:"prefLabel"}),o=new a({legacyoid:e(t).find("[name=label]").val(),values:[l],nodetype:"Collection"});return n.modal.on("hidden.bs.modal",(function(e){o.save((function(e,t){n.trigger("collectionAdded",e.responseJSON)}),n)})),n.modal.modal("hide"),!1}})}})}.apply(t,i))||(e.exports=n)},7744:function(e,t,a){var i,n;i=[a(20198),a(46186),a(86564),a(46562),a(3942),a(91248)],void 0===(n=function(e,t,a,i,n){return a.View.extend({events:{"click button":"close"},initialize:function(e){var a=this,l=this.$el.find(".dropzone");l.hasClass("dz-clickable")||new i(l[0],{url:t.urls.concept.replace("aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa",this.model.get("id")),acceptedFiles:"image/*",headers:{"X-CSRFToken":n.get("csrftoken")}}).on("addedfile",(function(e){a.changed=!0})),this.$el.find(".modal").modal("show")},close:function(){var e=this,t=this.$el.find(".modal");this.changed&&t.on("hidden.bs.modal",(function(){e.trigger("dataChanged")})),t.modal("hide")}})}.apply(t,i))||(e.exports=n)},54955:function(e,t,a){var i,n;i=[a(20198),a(86564),a(47076),a(72825)],void 0===(n=function(e,t,a,i){return t.View.extend({initialize:function(t){var n=this;this.modal=this.$el.find(".modal"),this.modal.on("hidden.bs.modal",(function(){n.$el.find("input[type=text], textarea").val("")})),this.select2=this.$el.find("[name=language_dd]").select2({minimumResultsForSearch:-1}),this.modal.validate({ignore:null,rules:{label:"required",language_dd:"required",scheme_group_dd:"required"},submitHandler:function(t){var l=new i({value:e(t).find("[name=label]").val(),language:e(t).find("[name=language_dd]").val(),category:"label",type:"prefLabel"}),o=new i({value:e(t).find("[name=note]").val(),language:e(t).find("[name=language_dd]").val(),category:"note",type:"scopeNote"}),d=new a({legacyoid:e(t).find("[name=label]").val(),values:[l,o],nodetype:"ConceptScheme"});return n.modal.on("hidden.bs.modal",(function(e){d.save((function(e,t){n.trigger("conceptSchemeAdded",e.responseJSON)}),n)})),n.modal.modal("hide"),!1}})}})}.apply(t,i))||(e.exports=n)},8329:function(e,t,a){var i,n;i=[a(20198),a(86564),a(46186),a(47076),a(72825)],void 0===(n=function(e,t,a,i,n){return t.View.extend({initialize:function(t){var n=this;this.modal=this.$el.find(".modal"),this.title=this.modal.find("h4").text(),this.$el.find(".select2").attr("id")||(this.collectiondropdown=this.$el.find(".select2").select2().on("select2-selecting",(function(t,i){e.ajax({url:a.urls.confirm_delete.replace("aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa",t.val),success:function(e){n.modal.find('.modal-body [name="additional-info"]').html(e)}})}))),this.modal.validate({ignore:null,rules:{scheme_dd:"required"},submitHandler:function(e){n.modal.find("h4").text(" "+n.title),n.modal.find(".modal-title").addClass("loading"),n.model=new i({id:n.collectiondropdown.val(),nodetype:"Collection",delete_self:!0}),n.model.delete((function(){n.modal.find("h4").text(n.title),n.modal.find(".modal-title").removeClass("loading"),n.modal.modal("hide"),n.trigger("collectionDeleted")}),n)}})}})}.apply(t,i))||(e.exports=n)},5107:function(e,t,a){var i,n;i=[a(20198),a(86564),a(46186),a(47076),a(72825)],void 0===(n=function(e,t,a,i,n){return t.View.extend({initialize:function(t){var n=this;this.modal=this.$el.find(".modal"),this.viewModel=t.viewModel,this.$el.find(".select2").attr("id")||(this.schemedropdown=this.$el.find(".select2").select2().on("select2-selecting",(function(t,i){e.ajax({url:a.urls.confirm_delete.replace("aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa",t.val),success:function(e){n.modal.find('.modal-body [name="additional-info"]').html(e)}})}))),this.modal.validate({ignore:null,rules:{scheme_dd:"required"},submitHandler:function(e){n.viewModel.loading(!0),n.model=new i({id:n.schemedropdown.val(),nodetype:"ConceptScheme",delete_self:!0}),n.model.delete((function(){n.modal.modal("hide"),n.viewModel.loading(!0),n.trigger("conceptSchemeDeleted")}),n)}})}})}.apply(t,i))||(e.exports=n)},36046:function(e,t,a){var i,n;i=[a(20198),a(86564),a(46186),a(72825)],void 0===(n=function(e,t,a){return t.View.extend({initialize:function(e){this.rendered||this.render()},render:function(){var t=this;this.rendered=!0,this.modal=this.$el.find(".modal"),this.$el.find(".select2").attr("id")||(this.schemedropdown=this.$el.find(".select2").select2()),this.modal.validate({ignore:null,rules:{scheme_dd:"required"},submitHandler:function(i){var n=e(i).find("[name=scheme_dd]").val();window.open(a.urls.export_concept.replace("aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa",n),"_blank"),t.modal.modal("hide")}})}})}.apply(t,i))||(e.exports=n)},16207:function(e,t,a){var i,n;i=[a(20198),a(86564),a(46186),a(47076)],void 0===(n=function(e,t,a,i){return t.View.extend({initialize:function(){var t=this;t.$el.find("#error_text").closest(".row").addClass("hidden"),t.$el.find("[name=concept_identifiers]").val(""),this.endpoint=this.$el.find("#sparql_endpoint").select2({minimumResultsForSearch:-1}),this.$el.find("input.concept_import").select2({minimumInputLength:2,id:function(e){return e.Subject.value},ajax:{url:a.urls.search_sparql_endpoint,dataType:"json",data:function(e,a){return{terms:e,endpoint:t.endpoint.val()}},results:function(e,t){return{results:e.results.bindings}}},formatResult:function(e,t,a,i){var n=[];return window.Select2.util.markMatch(e.Term.value,a.term,n,i),e.ScopeNote||(e.ScopeNote={value:""}),'<span class="concept_result">'+n.join("")+'</span> - <a href="'+e.Subject.value+'" target="_blank">'+e.Subject.value+'</a><div><i class="concept_result_schemaname">('+e.ScopeNote.value+")</i></div>"},escapeMarkup:function(e){return e}}).on("select2-selecting",(function(e,a){t.trigger("select2-selecting",e,a),t.$el.find("[name=concept_identifiers]").val(e.val)})),this.modal=this.$el.find("form"),this.modal.validate({ignore:null,rules:{concept_identifiers:"required"},submitHandler:function(i){var n={ids:t.$el.find("[name=concept_identifiers]").val(),endpoint:t.endpoint.val(),model:t.model.toJSON()};return t.$el.find("#error_text").closest(".row").addClass("hidden"),e.ajax({type:"POST",url:a.urls.from_sparql_endpoint.replace("aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa",t.model.get("id")),data:JSON.stringify(n),success:function(){t.modal.on("hidden.bs.modal",(function(e){t.trigger("conceptsImported")})),t.modal.modal("hide")},error:function(e){var a=t.$el.find("#error_text");a.closest(".row").removeClass("hidden"),a.html(e.responseText)}}),!1}})}})}.apply(t,i))||(e.exports=n)},57649:function(e,t,a){var i,n;i=[a(20198),a(86564),a(46186)],void 0===(n=function(e,t,a){return t.View.extend({initialize:function(t){var i=this;this.modal=this.$el.find(".modal"),this.viewModel=t.viewModel,this.select2=this.$el.find("[name=language_dd]").select2({minimumResultsForSearch:-1}),this.modal.validate({ignore:null,rules:{skosfile:"required",overwrite_options:"required"},submitHandler:function(t){var n=new FormData(t);return i.viewModel.loading(!0),e.ajax({url:a.urls.concept.replace("aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaaa",""),type:"POST",data:n,processData:!1,contentType:!1,complete:function(e,t){i.modal.modal("hide"),i.viewModel.loading(!1),i.trigger("conceptSchemeAdded",e,t)}}),!1}})}})}.apply(t,i))||(e.exports=n)},86163:function(e,t,a){var i,n;i=[a(20198),a(86564),a(46186),a(93256),a(47076)],void 0===(n=function(e,t,a,i,n){return t.View.extend({events:{"click .modal-footer .savebtn":"save","click .modal-footer .btn-u-default":"cancel","click a":"removeRelationship"},initialize:function(){var e=this;this.conceptsearch=new i({el:this.$el,getUrl:function(){return a.urls.concept_search+"?removechildren="+e.model.get("id")}}),this.modal=this.$el.find(".modal"),this.relationshiptype=this.modal.find("#parent-relation-type").select2({minimumResultsForSearch:10,maximumSelectionSize:1}),this.numberOfParents=this.$el.find("#number_of_parents").val(),this.deletedrelationships=[]},save:function(){var t=this;if(""!==this.conceptsearch.searchbox.val()){var a=new n({id:this.conceptsearch.searchbox.val(),relationshiptype:this.relationshiptype.val()});this.model.set("added",[a.toJSON()])}var i=[];e.each(this.deletedrelationships,(function(){var e=new n({id:this});i.push(e)})),t.model.set("deleted",i),this.modal.on("hidden.bs.modal",(function(e){t.model.save((function(){t.cleanup()}),this)})),this.modal.modal("hide")},cancel:function(){this.cleanup()},removeRelationship:function(t){var a=e(t.target).data();this.deletedrelationships.push(a.id),this.$el.find('[data-id="'+a.id+'"]').toggle(300)},cleanup:function(){var t=this;e.each(this.deletedrelationships,(function(){t.$el.find('[data-id="'+this+'"]').toggle(300)})),this.model.set("deleted",[]),this.model.set("added",[]),this.$el.find("a").show(300),this.undelegateEvents()}})}.apply(t,i))||(e.exports=n)},42150:function(e,t,a){var i,n;i=[a(20198),a(86564),a(93256),a(47076)],n=function(e,t,a,i){return a.extend({initialize:function(){a.prototype.initialize.apply(this,arguments);var e=this;this.modal=this.$el.find("form"),this.relationshiptype=this.modal.find("#related-relation-type").select2({minimumResultsForSearch:10,maximumSelectionSize:1}),this.modal.validate({ignore:null,rules:{concept_search_box:"required",relationtype_dd:"required"},submitHandler:function(t){var a=new i({id:e.searchbox.val(),relationshiptype:e.relationshiptype.val()});e.model.set("relatedconcepts",[a]),e.modal.on("hidden.bs.modal",(function(t){e.model.save()})),e.modal.modal("hide")}})}})}.apply(t,i),void 0===n||(e.exports=n)},63146:function(e,t,a){var i,n;i=[a(20198),a(86564),a(93256),a(47076)],n=function(e,t,a,i){return a.extend({events:{"click .modal-footer .savebtn":"save"},initialize:function(){a.prototype.initialize.apply(this,arguments),this.modal=this.$el.find(".modal"),this.relationshiptype=this.modal.find("#related-relation-type").select2({minimumResultsForSearch:10,maximumSelectionSize:1})},save:function(){var e=this;if(""!==this.searchbox.val()){var t=new i({id:this.searchbox.val(),relationshiptype:this.relationshiptype.val()});this.model.set("relatedconcepts",[t]),this.modal.on("hidden.bs.modal",(function(t){e.model.save()})),this.modal.modal("hide")}}})}.apply(t,i),void 0===n||(e.exports=n)},73187:function(e,t,a){var i,n;i=[a(20198),a(86564),a(91248),a(16950)],void 0===(n=function(e,t){return t.View.extend({initialize:function(t){var a,i,n,l=this,o={},d={},r={};switch(this.$el.find(".pref-label-data").each((function(t,a){var i=e(a).data();"prefLabel"===i.type&&(d[i.language]=i.id)})),this.$el.find(".note-data").each((function(t,a){var i=e(a).data();r[i.valuetype]||(r[i.valuetype]={}),r[i.valuetype][i.language]=i.id})),this.$el.find(".sortorder-data").each((function(t,i){a=e(i).data().id})),this.valuemodel=this.model.get("values")[0],this.valuemodel.get("category")){case"label":i=this.$el.find("#labelmodal");break;case"note":i=this.$el.find("#notemodal");break;default:i=this.$el.find("#related_valuemodal")}n=i.find(".modal-title").data(),i.find(".modal-title").text(n[this.valuemodel.get("id")?"editTitle":"addTitle"]),this.valueInput=i.find(".value-input"),this.idInput=i.find(".id-input"),this.valueTypeInput=i.find("select.value-type-input"),this.languageInput=i.find("select.language-input"),this.languageInput.select2({minimumResultsForSearch:10,maximumSelectionSize:1}),this.valueTypeInput.select2({minimumResultsForSearch:10,maximumSelectionSize:1}),e.validator.addMethod("prefLabel",(function(e,t){return!!this.optional(t)||("label"!=l.valuemodel.get("category")||"prefLabel"!=e||!d[l.languageInput.val()]||d[l.languageInput.val()]===l.valuemodel.get("id"))}),l.$el.find(".pref-label-validation-message").html()),e.validator.addMethod("notes",(function(e,t){return!!this.optional(t)||("note"!=l.valuemodel.get("category")||!r[e]||!r[e][l.languageInput.val()]||r[e][l.languageInput.val()]===l.valuemodel.get("id"))}),l.$el.find(".note-validation-message").html()),e.validator.addMethod("sortorder",(function(e,t){return!!this.optional(t)||(!(!l.valuemodel.get("category")&&"sortorder"===e&&a)||a===l.valuemodel.get("id"))}),l.$el.find(".sortorder-validation-message").html()),o[this.valueTypeInput.attr("id")]={required:!0,sortorder:!0,notes:!0,prefLabel:!0},o[this.valueInput.attr("id")]="required",o[this.languageInput.attr("id")]="required",i.validate({ignore:null,rules:o,submitHandler:function(e){l.valuemodel.set({value:l.valueInput.val(),id:l.idInput.val(),type:l.valueTypeInput.select2("val"),language:l.languageInput.select2("val")}),l.model.set("values",[l.valuemodel]),i.on("hidden.bs.modal",(function(){l.model.save((function(){l.model.set("values",[])}))})),i.modal("hide")}}),this.render(),i.modal("show")},render:function(){this.valueInput.val(this.valuemodel.get("value")),this.idInput.val(this.valuemodel.get("id")),""!==this.valuemodel.get("type")&&this.valueTypeInput.select2("val",this.valuemodel.get("type")),""!==this.valuemodel.get("language")&&this.languageInput.select2("val",this.valuemodel.get("language"))}})}.apply(t,i))||(e.exports=n)}}]);